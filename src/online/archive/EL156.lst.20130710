* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44******************************************************************
    45
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page   3
* EL156.cbl
    47 ENVIRONMENT DIVISION.
    48
    49 DATA DIVISION.
    50
    51 WORKING-STORAGE SECTION.
    52 01  DFH-START PIC X(04).
    53
    54 77  FILLER  PIC X(32)  VALUE '********************************'.
    55 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    56 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    57 77  WS-SSN  PIC X(9) VALUE ZEROS.
    58 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    59
    60*    COPY ELCSCTM.
    61******************************************************************
    62*                                                                *
    63*                                                                *
    64*                            ELCSCTM                             *
    65*                            VMOD=2.001                          *
    66*                                                                *
    67*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    68*                                                                *
    69******************************************************************
    70 01  SECURITY-MESSAGE.
    71     12  FILLER                          PIC X(30)
    72            VALUE '** LOGIC SECURITY VIOLATION -'.
    73     12  SM-READ                         PIC X(6).
    74     12  FILLER                          PIC X(5)
    75            VALUE ' PGM='.
    76     12  SM-PGM                          PIC X(6).
    77     12  FILLER                          PIC X(5)
    78            VALUE ' OPR='.
    79     12  SM-PROCESSOR-ID                 PIC X(4).
    80     12  FILLER                          PIC X(6)
    81            VALUE ' TERM='.
    82     12  SM-TERMID                       PIC X(4).
    83     12  FILLER                          PIC XX   VALUE SPACE.
    84     12  SM-JUL-DATE                     PIC 9(5).
    85     12  FILLER                          PIC X    VALUE SPACE.
    86     12  SM-TIME                         PIC 99.99.
    87
    88
    89*    COPY ELCSCRTY.
    90******************************************************************
    91*                                                                *
    92*                                                                *
    93*                            ELCSCRTY                            *
    94*                            VMOD=2.001                          *
    95*                                                                *
    96*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    97*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    98*        SAVED IN PI-SECURITY-ADDRESS.                           *
    99*                                                                *
   100******************************************************************
   101 01  SECURITY-CONTROL.
   102     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   103     12  FILLER                       PIC XX    VALUE 'SC'.
   104     12  SC-CREDIT-CODES.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page   4
* EL156.cbl
   105         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   106             20  SC-CREDIT-DISPLAY    PIC X.
   107             20  SC-CREDIT-UPDATE     PIC X.
   108     12  SC-CLAIMS-CODES.
   109         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   110             20  SC-CLAIMS-DISPLAY    PIC X.
   111             20  SC-CLAIMS-UPDATE     PIC X.
   112
   113 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   114 01  WS-DATE-AREA.
   115     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   116     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   117     12  SAVE-DATE-CCYYMMDD.
   118         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   119         16  SAVE-DATE-YMD.
   120             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   121             20  FILLER              PIC X(04)   VALUE SPACES.
   122
   123 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   124 01  STANDARD-AREAS.
   125     12  WS-RESPONSE         PIC S9(8)   COMP.
   126         88  WS-RESP-NORMAL              VALUE +00.
   127         88  WS-RESP-ERROR               VALUE +01.
   128         88  WS-RESP-NOTFND              VALUE +13.
   129         88  WS-RESP-DUPREC              VALUE +14.
   130         88  WS-RESP-ENDFILE             VALUE +20.
   131     12  PMT-HEAD-A.
   132         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   133         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   134         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   135-        '     RESERVES  TYPE    AMOUNT'.
   136     12  PMT-HEAD-B.
   137         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   138         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   139         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   140     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   141     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   142     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   143     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   144     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   145     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   146     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   147     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   148     12  PGM-NAME            PIC X(8).
   149     12  TIME-IN             PIC S9(7).
   150     12  TIME-OUT-R  REDEFINES TIME-IN.
   151         16  FILLER          PIC X.
   152         16  TIME-OUT        PIC 99V99.
   153         16  FILLER          PIC XX.
   154     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   155     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   156     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   157     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   158     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   159     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   160     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   161     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   162     12  LINK-001            PIC X(8)    VALUE 'EL001'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page   5
* EL156.cbl
   163     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   164     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   165     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   166     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   167     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   168     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   169     12  WS-BLANK            PIC X       VALUE ' '.
   170
   171 01  MISC-WORK-AREAS.
   172     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   173     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   174     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   175     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   176     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   177     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   178     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   179     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   180     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   181     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   182     12  W-CALLED-NAME           PIC X(08).
   183     12  W-EOB-CODES.
   184         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   185             20  W-EOB-CODE      PIC XXX.
   186             20  W-EOB-FILLER    PIC X.
   187     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   188     12  W-NAME-LAST             PIC X(15).
   189     12  W-NAME-FIRST            PIC X(15).
   190     12  W-NAME-MIDDLE.
   191         16  FILLER              PIC X.
   192         16  W-NAME-MIDDLE-2     PIC X.
   193         16  FILLER              PIC X(13).
   194     12  W-DMD-CHECK-NO.
   195         16  W-DMD-CHECK-NO-1    PIC X(4).
   196         16  W-DMD-CHECK-NO-2    PIC X.
   197         16  W-DMD-CHECK-NO-3    PIC XX.
   198
   199     12  WS-COMPUTE-FROM-DT  PIC XX.
   200     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   201     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   202     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   203     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   204     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   205     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   206         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   207         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   208     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   209         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   210     12  WS-UPDATE-SW        PIC X VALUE ' '.
   211     12  WS-GROUPING.
   212         16  WS-GROUP-1      PIC X VALUE SPACES.
   213         16  FILLER          PIC X(05) VALUE SPACES.
   214     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   215     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   216     12  WS-WORK-STATE-ACCT.
   217         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   218         16  FILLER          PIC X       VALUE '/'.
   219         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   220     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page   6
* EL156.cbl
   221     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   222     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   223     12  QID.
   224         16  QID-TERM        PIC X(4)    VALUE SPACES.
   225         16  FILLER          PIC X(4)    VALUE '156A'.
   226     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   227     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   228     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   229     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   230     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   231     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   232     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   233     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   234     12  WS-STATUS           PIC X       VALUE SPACES.
   235     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   236     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   237     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   238     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   239     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   240     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   241     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   242     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   243     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   244     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   245     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   246     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   247     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   248     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   249     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   250     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   251     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   252     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   253     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   254     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   255     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   256     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   257     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   258     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   259     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   260     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   261     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   262     12  WORK-DATE-FROM.
   263         16  WDF-MONTH       PIC 99        VALUE ZERO.
   264         16  WDF-DAY         PIC 99        VALUE ZERO.
   265         16  WDF-YEAR        PIC 99        VALUE ZERO.
   266     12  WORK-DATE-THRU.
   267         16  WDT-MONTH       PIC 99        VALUE ZERO.
   268         16  WDT-DAY         PIC 99        VALUE ZERO.
   269         16  WDT-YEAR        PIC 99        VALUE ZERO.
   270     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   271     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   272     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   273     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   274     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   275     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   276     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   277     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   278     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page   7
* EL156.cbl
   279     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   280     12  WS-PY-WK REDEFINES WS-PY-WORK.
   281         16  WS-PY-NUM       PIC S9(7)V99.
   282         16  WS-PY-SIGN      PIC X.
   283     12  WS-DY-WORK          PIC S9(5).
   284     12  WS-DY-WK REDEFINES WS-DY-WORK.
   285         16  WS-DY-NUM       PIC S9(4).
   286         16  WS-DY-SIGN      PIC X.
   287     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   288         88  COMP-REC-FOUND              VALUE 'Y'.
   289     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   290         88  BENEFIT-FOUND       VALUE 'Y'.
   291         88  NO-BENEFIT-FOUND    VALUE 'N'.
   292     12  WS-TERMS.
   293         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   294         16  FILLER          PIC X       VALUE '/'.
   295         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   296         16  WST-REM-DAYS-GRP.
   297             20  WST-SLASH   PIC X       VALUE '/'.
   298             20  WST-REM-DAYS
   299                             PIC --9.
   300     12  WS-ACCESS.
   301         16  FILLER          PIC XX      VALUE SPACES.
   302         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   303     12  WS-STATE-ACCESS.
   304         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   305         16  FILLER          PIC XX      VALUE SPACES.
   306     12  WS-CARR-ACCESS.
   307         16  FILLER          PIC X(3)    VALUE SPACES.
   308         16  WS-CARR         PIC X       VALUE SPACES.
   309     12  DATE-WORK.
   310         16  FILLER          PIC XX      VALUE SPACES.
   311         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   312     12  WS-SAVE-INPUT.
   313         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   314         16  WS-PAYEE        PIC XX      VALUE SPACE.
   315         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   316         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   317         16  WS-OFFLINE      PIC X       VALUE SPACE.
   318         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   319         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   320         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   321         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   322         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   323         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   324         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   325         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   326         16  WS-ETYPE        PIC X       VALUE SPACE.
   327         16  WS-CASH         PIC X       VALUE SPACE.
   328         16  WS-GROUPED      PIC X       VALUE SPACE.
   329         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   330         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   331         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   332         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   333         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   334         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   335         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   336     12  LAST-ERROR-LINE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page   8
* EL156.cbl
   337         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   338         16  FILLER              PIC X(30)
   339             VALUE ' FATAL ERRORS ENCOUNTERED'.
   340         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   341         16  FILLER              PIC X(28)
   342             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   343     12  WS-CHECK-AREA.
   344         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   345         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   346     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   347     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   348         16  FILLER              PIC XX.
   349         16  WS-A-CHECK-NUM-5    PIC 9(5).
   350     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   351         16  FILLER              PIC X.
   352         16  WS-A-CHECK-NUM-6    PIC 9(6).
   353     12  OPTION-1-SAVE-AREA.
   354         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   355         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   356     12  WS-WORK-ZIP.
   357         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   358         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   359     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   360                                 PIC 9(9).
   361     12  WS-FLI-PMTNOTE.
   362         16  WS-PMTOPTION        PIC XX.
   363         16  WS-DOCNAME          PIC X(28).
   364         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   365             20  WS-AMOUNT       PIC X(8).
   366             20  FILLER          PIC X(20).
   367         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   368             20  WS-NUM-AMT      PIC 9(6)V99.
   369             20  FILLER          PIC X(20).
   370
   371     12  WS-HAN-PMTNOTE.
   372         16  WS-HAN-PMT-CODE     PIC X.
   373         16  WS-HAN-PMT-NOTE     PIC X(39).
   374
   375     12  WS-NCL-PMT-OPTION       PIC XX.
   376         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   377
   378     12  WS-CLAIM-SEQUENCE.
   379         16  FILLER              PIC X VALUE '('.
   380         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   381         16  FILLER              PIC X(04) VALUE ' OF '.
   382         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   383         16  FILLER              PIC X VALUE ')'.
   384
   385     12  WS-REFUND-AMT           PIC Z(7).99.
   386     12  WS-CALC-INT             PIC S9(7)V99.
   387     12  WS-CRIT-PERIOD-DAYS     PIC S9(4)V999 VALUE +0  COMP-3.
   388
   389     12  SUB                     PIC 99 VALUE ZEROS.
   390
   391     12  WS-BOANOTE1.
   392         16  WS-BOANOTE1-DESC    PIC X(11).
   393         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   394         16  FILLER              PIC X(17).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page   9
* EL156.cbl
   395     12  WS-BOANOTE2.
   396         16  WS-BOANOTE2-DESC    PIC X(11).
   397         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   398         16  FILLER              PIC X(17).
   399
   400     12  WS-NCLNOTE1.
   401         16  WS-NCLNOTE1-DESC    PIC X(11).
   402         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   403         16  FILLER              PIC X(17).
   404     12  WS-NCLNOTE2.
   405         16  WS-NCLNOTE2-DESC    PIC X(11).
   406         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   407         16  FILLER              PIC X(17).
   408
   409     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   410     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   411     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   412     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   413     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   414     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   415     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   416     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   417     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   418     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   419
   420     12  WS-AIG-WORK-AREAS.
   421         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   422             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   423         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   424             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   425         16  WS-FROM-DATE-MDY.
   426             20  WS-FROM-MO      PIC 99.
   427             20  WS-FROM-DA      PIC 99.
   428             20  WS-FROM-YR      PIC 99.
   429         16  WS-TEMP-DATE-MDY.
   430             20  WS-TEMP-MO      PIC 99.
   431             20  WS-TEMP-DA      PIC 99.
   432             20  WS-TEMP-YR      PIC 99.
   433         16  WS-BIN-FROM-DT      PIC XX.
   434         16  WS-TEMP-INC-MDY.
   435             20  WS-TEMP-INC-MO  PIC 99.
   436             20  WS-TEMP-INC-DA  PIC 99.
   437             20  WS-TEMP-INC-YR  PIC 99.
   438         16  WS-PMT-DUE-MDY.
   439             20  WS-PMT-DUE-MO   PIC 99.
   440             20  WS-PMT-DUE-DA   PIC 99.
   441             20  WS-PMT-DUE-YR   PIC 99.
   442         16  WS-PMT-DUE-DT       PIC XX.
   443         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   444         16  WS-RETRO-ELIM-DT    PIC XX.
   445         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   446             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   447         16  WS-SAVE-DUE-DA      PIC 99.
   448         16  WS-CDAYS            PIC S9(05).
   449         16  WS-DAYS-OFF         PIC S9(05).
   450         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   451             88  ELIM-SATISFIED            VALUE 'Y'.
   452         16  WS-AIG-CHECKNO.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  10
* EL156.cbl
   453             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   454             20  WS-A-CHECKNO-3-7.
   455                 24  FILLER              PIC X(3)    VALUE SPACES.
   456                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   457                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   458         16  WS-AIG-GROUPING.
   459             20  WS-A-BENE               PIC XXX.
   460             20  FILLER                  PIC XXX.
   461         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   462             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   463             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   464         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   465                 VALUE 'UNEMPLOYMENT PAYMENT'.
   466         16  WS-CHK-THRU-DT              PIC XX.
   467         16  WS-HOLD-BIN-DATE-1          PIC XX.
   468
   469 01  MISC-CSO-AREA.
   470     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   471         88  APPROVAL-NEEDED                        VALUE 'Y'.
   472     12  WS-APPROV-NOTE                  PIC X(43)
   473         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   474     12  WS-REAUDIT-NOTE                 PIC X(43)
   475         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   476     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   477     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   478     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   479     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   480     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   481     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   482     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   483         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   484     12  WS-PAYEE-CITY-STATE     PIC X(30).
   485     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   486         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   487     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   488     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   489     12  WS-WORK-NAME            PIC X(30).
   490     12  FILLER  REDEFINES WS-WORK-NAME.
   491         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   492     12  WS-INSURED-NAME         PIC X(30).
   493     12  FILLER  REDEFINES WS-INSURED-NAME.
   494         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   495     12  WS-PAYEE-NAME           PIC X(30).
   496     12  FILLER  REDEFINES WS-PAYEE-NAME.
   497         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   498
   499 01  ERROR-MESSAGES.
   500     12  ER-0000                 PIC X(4)  VALUE '0000'.
   501     12  ER-0004                 PIC X(4)  VALUE '0004'.
   502     12  ER-0008                 PIC X(4)  VALUE '0008'.
   503     12  ER-0019                 PIC X(4)  VALUE '0019'.
   504     12  ER-0029                 PIC X(4)  VALUE '0029'.
   505     12  ER-0042                 PIC X(4)  VALUE '0042'.
   506     12  ER-0070                 PIC X(4)  VALUE '0070'.
   507     12  ER-0130                 PIC X(4)  VALUE '0130'.
   508     12  ER-0149                 PIC X(4)  VALUE '0149'.
   509     12  ER-0154                 PIC X(4)  VALUE '0154'.
   510     12  ER-0168                 PIC X(4)  VALUE '0168'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  11
* EL156.cbl
   511     12  ER-0169                 PIC X(4)  VALUE '0169'.
   512     12  ER-0172                 PIC X(4)  VALUE '0174'.
   513     12  ER-0198                 PIC X(4)  VALUE '0198'.
   514     12  ER-0204                 PIC X(4)  VALUE '0204'.
   515     12  ER-0206                 PIC X(4)  VALUE '0206'.
   516     12  ER-0252                 PIC X(4)  VALUE '0252'.
   517     12  ER-0254                 PIC X(4)  VALUE '0254'.
   518     12  ER-0282                 PIC X(4)  VALUE '0282'.
   519     12  ER-0283                 PIC X(4)  VALUE '0283'.
   520     12  ER-0294                 PIC X(4)  VALUE '0294'.
   521     12  ER-0338                 PIC X(4)  VALUE '0338'.
   522     12  ER-0419                 PIC X(4)  VALUE '0419'.
   523     12  ER-0420                 PIC X(4)  VALUE '0420'.
   524     12  ER-0421                 PIC X(4)  VALUE '0421'.
   525     12  ER-0422                 PIC X(4)  VALUE '0422'.
   526     12  ER-0433                 PIC X(4)  VALUE '0433'.
   527     12  ER-0436                 PIC X(4)  VALUE '0436'.
   528     12  ER-0437                 PIC X(4)  VALUE '0437'.
   529     12  ER-0438                 PIC X(4)  VALUE '0438'.
   530     12  ER-0439                 PIC X(4)  VALUE '0439'.
   531     12  ER-0440                 PIC X(4)  VALUE '0440'.
   532     12  ER-0441                 PIC X(4)  VALUE '0441'.
   533     12  ER-0442                 PIC X(4)  VALUE '0442'.
   534     12  ER-0443                 PIC X(4)  VALUE '0443'.
   535     12  ER-0444                 PIC X(4)  VALUE '0444'.
   536     12  ER-0445                 PIC X(4)  VALUE '0445'.
   537     12  ER-0446                 PIC X(4)  VALUE '0446'.
   538     12  ER-0447                 PIC X(4)  VALUE '0447'.
   539     12  ER-0448                 PIC X(4)  VALUE '0448'.
   540     12  ER-0449                 PIC X(4)  VALUE '0449'.
   541     12  ER-0452                 PIC X(4)  VALUE '0452'.
   542     12  ER-0458                 PIC X(4)  VALUE '0458'.
   543     12  ER-0459                 PIC X(4)  VALUE '0459'.
   544     12  ER-0460                 PIC X(4)  VALUE '0460'.
   545     12  ER-0461                 PIC X(4)  VALUE '0461'.
   546     12  ER-0462                 PIC X(4)  VALUE '0462'.
   547     12  ER-0463                 PIC X(4)  VALUE '0463'.
   548     12  ER-0464                 PIC X(4)  VALUE '0464'.
   549     12  ER-0465                 PIC X(4)  VALUE '0465'.
   550     12  ER-0466                 PIC X(4)  VALUE '0466'.
   551     12  ER-0467                 PIC X(4)  VALUE '0467'.
   552     12  ER-0468                 PIC X(4)  VALUE '0468'.
   553     12  ER-0469                 PIC X(4)  VALUE '0469'.
   554     12  ER-0473                 PIC X(4)  VALUE '0473'.
   555     12  ER-0474                 PIC X(4)  VALUE '0474'.
   556     12  ER-0475                 PIC X(4)  VALUE '0475'.
   557     12  ER-0476                 PIC X(4)  VALUE '0476'.
   558     12  ER-0477                 PIC X(4)  VALUE '0477'.
   559     12  ER-0478                 PIC X(4)  VALUE '0478'.
   560     12  ER-0479                 PIC X(4)  VALUE '0479'.
   561     12  ER-0481                 PIC X(4)  VALUE '0481'.
   562     12  ER-0491                 PIC X(4)  VALUE '0491'.
   563     12  ER-0492                 PIC X(4)  VALUE '0492'.
   564     12  ER-0493                 PIC X(4)  VALUE '0493'.
   565     12  ER-0494                 PIC X(4)  VALUE '0494'.
   566     12  ER-0495                 PIC X(4)  VALUE '0495'.
   567     12  ER-0499                 PIC X(4)  VALUE '0499'.
   568     12  ER-0500                 PIC X(4)  VALUE '0500'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  12
* EL156.cbl
   569     12  ER-0501                 PIC X(4)  VALUE '0501'.
   570     12  ER-0502                 PIC X(4)  VALUE '0502'.
   571     12  ER-0508                 PIC X(4)  VALUE '0508'.
   572     12  ER-0513                 PIC X(4)  VALUE '0513'.
   573     12  ER-0518                 PIC X(4)  VALUE '0518'.
   574     12  ER-0524                 PIC X(4)  VALUE '0524'.
   575     12  ER-0525                 PIC X(4)  VALUE '0525'.
   576     12  ER-0526                 PIC X(4)  VALUE '0526'.
   577     12  ER-0530                 PIC X(4)  VALUE '0530'.
   578     12  ER-0540                 PIC X(4)  VALUE '0540'.
   579     12  ER-0541                 PIC X(4)  VALUE '0541'.
   580     12  ER-0542                 PIC X(4)  VALUE '0542'.
   581     12  ER-0543                 PIC X(4)  VALUE '0543'.
   582     12  ER-0545                 PIC X(4)  VALUE '0545'.
   583     12  ER-0552                 PIC X(4)  VALUE '0552'.
   584     12  ER-0555                 PIC X(4)  VALUE '0555'.
   585     12  ER-0556                 PIC X(4)  VALUE '0556'.
   586     12  ER-0557                 PIC X(4)  VALUE '0557'.
   587     12  ER-0572                 PIC X(4)  VALUE '0572'.
   588     12  ER-0573                 PIC X(4)  VALUE '0573'.
   589     12  ER-0594                 PIC X(4)  VALUE '0594'.
   590     12  ER-0616                 PIC X(4)  VALUE '0616'.
   591     12  ER-0617                 PIC X(4)  VALUE '0617'.
   592     12  ER-0618                 PIC X(4)  VALUE '0618'.
   593     12  ER-0657                 PIC X(4)  VALUE '0657'.
   594     12  ER-0658                 PIC X(4)  VALUE '0658'.
   595     12  ER-0699                 PIC X(4)  VALUE '0699'.
   596     12  ER-0730                 PIC X(4)  VALUE '0730'.
   597     12  ER-0737                 PIC X(4)  VALUE '0737'.
   598     12  ER-0760                 PIC X(4)  VALUE '0760'.
   599     12  ER-0768                 PIC X(4)  VALUE '0768'.
   600     12  ER-0769                 PIC X(4)  VALUE '0769'.
   601     12  ER-0770                 PIC X(4)  VALUE '0770'.
   602     12  ER-0802                 PIC X(4)  VALUE '0802'.
   603     12  ER-0803                 PIC X(4)  VALUE '0803'.
   604     12  ER-0819                 PIC X(4)  VALUE '0819'.
   605     12  ER-0834                 PIC X(4)  VALUE '0834'.
   606     12  ER-0836                 PIC X(4)  VALUE '0836'.
   607     12  ER-0844                 PIC X(4)  VALUE '0844'.
   608     12  ER-0845                 PIC X(4)  VALUE '0845'.
   609     12  ER-0846                 PIC X(4)  VALUE '0846'.
   610     12  ER-0849                 PIC X(4)  VALUE '0849'.
   611     12  ER-0851                 PIC X(4)  VALUE '0851'.
   612     12  ER-0872                 PIC X(4)  VALUE '0872'.
   613     12  ER-0873                 PIC X(4)  VALUE '0873'.
   614     12  ER-0874                 PIC X(4)  VALUE '0874'.
   615     12  ER-0879                 PIC X(4)  VALUE '0879'.
   616     12  ER-0919                 PIC X(4)  VALUE '0919'.
   617     12  ER-0921                 PIC X(4)  VALUE '0921'.
   618     12  ER-0923                 PIC X(4)  VALUE '0923'.
   619     12  ER-0925                 PIC X(4)  VALUE '0925'.
   620     12  ER-0944                 PIC X(4)  VALUE '0944'.
   621     12  ER-0945                 PIC X(4)  VALUE '0945'.
   622     12  ER-0946                 PIC X(4)  VALUE '0946'.
   623     12  ER-0947                 PIC X(4)  VALUE '0947'.
   624     12  ER-0948                 PIC X(4)  VALUE '0948'.
   625     12  ER-0949                 PIC X(4)  VALUE '0949'.
   626     12  ER-0950                 PIC X(4)  VALUE '0950'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  13
* EL156.cbl
   627     12  ER-0951                 PIC X(4)  VALUE '0951'.
   628     12  ER-0954                 PIC X(4)  VALUE '0954'.
   629     12  ER-0956                 PIC X(4)  VALUE '0956'.
   630     12  ER-0967                 PIC X(4)  VALUE '0967'.
   631     12  ER-0968                 PIC X(4)  VALUE '0968'.
   632     12  ER-0974                 PIC X(4)  VALUE '0974'.
   633     12  ER-0975                 PIC X(4)  VALUE '0975'.
   634     12  ER-1561                 PIC X(4)  VALUE '1561'.
   635     12  ER-1566                 PIC X(4)  VALUE '1566'.
   636     12  ER-1567                 PIC X(4)  VALUE '1567'.
   637     12  ER-1775                 PIC X(4)  VALUE '1775'.
   638     12  ER-1880                 PIC X(4)  VALUE '1880'.
   639     12  ER-2044                 PIC X(4)  VALUE '2044'.
   640     12  ER-3140                 PIC X(4)  VALUE '3140'.
   641     12  ER-3141                 PIC X(4)  VALUE '3141'.
   642     12  ER-3255                 PIC X(4)  VALUE '3255'.
   643     12  ER-3516                 PIC X(4)  VALUE '3516'.
   644     12  ER-3527                 PIC X(4)  VALUE '3527'.
   645     12  ER-3528                 PIC X(4)  VALUE '3528'.
   646     12  ER-3529                 PIC X(4)  VALUE '3529'.
   647     12  ER-3530                 PIC X(4)  VALUE '3530'.
   648     12  ER-3531                 PIC X(4)  VALUE '3531'.
   649     12  ER-3532                 PIC X(4)  VALUE '3532'.
   650     12  ER-3533                 PIC X(4)  VALUE '3533'.
   651     12  ER-3534                 PIC X(4)  VALUE '3534'.
   652     12  ER-3535                 PIC X(4)  VALUE '3535'.
   653     12  ER-3536                 PIC X(4)  VALUE '3536'.
   654     12  ER-3537                 PIC X(4)  VALUE '3537'.
   655     12  ER-3538                 PIC X(4)  VALUE '3538'.
   656     12  ER-3539                 PIC X(4)  VALUE '3539'.
   657     12  ER-3540                 PIC X(4)  VALUE '3540'.
   658     12  ER-3541                 PIC X(4)  VALUE '3541'.
   659     12  ER-3542                 PIC X(4)  VALUE '3542'.
   660     12  ER-3543                 PIC X(4)  VALUE '3543'.
   661     12  ER-3546                 PIC X(4)  VALUE '3546'.
   662     12  ER-3549                 PIC X(4)  VALUE '3549'.
   663     12  ER-3818                 PIC X(4)  VALUE '3818'.
   664     12  ER-7540                 PIC X(4)  VALUE '7540'.
   665     12  ER-7576                 PIC X(4)  VALUE '7576'.
   666     12  ER-7579                 PIC X(4)  VALUE '7579'.
   667     12  ER-7830                 PIC X(4)  VALUE '7830'.
   668     12  ER-7831                 PIC X(4)  VALUE '7831'.
   669     12  ER-7832                 PIC X(4)  VALUE '7832'.
   670     12  ER-7833                 PIC X(4)  VALUE '7833'.
   671     12  ER-7834                 PIC X(4)  VALUE '7834'.
   672     12  ER-7835                 PIC X(4)  VALUE '7835'.
   673     12  ER-7836                 PIC X(4)  VALUE '7836'.
   674     12  ER-7837                 PIC X(4)  VALUE '7837'.
   675     12  ER-7838                 PIC X(4)  VALUE '7838'.
   676     12  ER-7841                 PIC X(4)  VALUE '7841'.
   677     12  ER-7844                 PIC X(4)  VALUE '7844'.
   678     12  ER-7845                 PIC X(4)  VALUE '7845'.
   679     12  ER-8000                 PIC X(4)  VALUE '8000'.
   680     12  ER-8051                 PIC X(4)  VALUE '8051'.
   681     12  ER-8052                 PIC X(4)  VALUE '8052'.
   682     12  ER-8053                 PIC X(4)  VALUE '8053'.
   683     12  ER-8054                 PIC X(4)  VALUE '8054'.
   684     12  ER-8055                 PIC X(4)  VALUE '8055'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  14
* EL156.cbl
   685     12  ER-8056                 PIC X(4)  VALUE '8056'.
   686     12  ER-8057                 PIC X(4)  VALUE '8057'.
   687     12  ER-8058                 PIC X(4)  VALUE '8058'.
   688     12  ER-8059                 PIC X(4)  VALUE '8059'.
   689     12  ER-8060                 PIC X(4)  VALUE '8060'.
   690     12  ER-8061                 PIC X(4)  VALUE '8061'.
   691     12  ER-8062                 PIC X(4)  VALUE '8062'.
   692     12  ER-8063                 PIC X(4)  VALUE '8063'.
   693     12  ER-8064                 PIC X(4)  VALUE '8064'.
   694     12  ER-8065                 PIC X(4)  VALUE '8065'.
   695     12  ER-8066                 PIC X(4)  VALUE '8066'.
   696     12  ER-8146                 PIC X(4)  VALUE '8146'.
   697     12  ER-8147                 PIC X(4)  VALUE '8147'.
   698     12  ER-8152                 PIC X(4)  VALUE '8152'.
   699     12  ER-8153                 PIC X(4)  VALUE '8153'.
   700     12  ER-8154                 PIC X(4)  VALUE '8154'.
   701     12  ER-8155                 PIC X(4)  VALUE '8155'.
   702     12  ER-8310                 PIC X(4)  VALUE '8310'.
   703     12  ER-8311                 PIC X(4)  VALUE '8311'.
   704     12  ER-8312                 PIC X(4)  VALUE '8312'.
   705     12  ER-8313                 PIC X(4)  VALUE '8313'.
   706     12  ER-8314                 PIC X(4)  VALUE '8314'.
   707     12  ER-8315                 PIC X(4)  VALUE '8315'.
   708     12  ER-8316                 PIC X(4)  VALUE '8316'.
   709     12  ER-8317                 PIC X(4)  VALUE '8317'.
   710
   711 01  CSO-WORK-FIELDS.
   712     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   713       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   714
   715     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   716     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   717         88  CERT-NOTE-ADDED           VALUE 'Y'.
   718     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   719         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   720     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   721
   722     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   723
   724 01  SC-NP6-CERT-NOTE.
   725     12  FILLER                  PIC X(12)
   726               VALUE 'REM BENEFIT '.
   727     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   728     12  FILLER                  PIC X(8)
   729               VALUE ' + 6 MO '.
   730     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   731     12  FILLER                  PIC X(12)
   732               VALUE ' = AMT PAID '.
   733     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   734
   735 01  SC-NP6-ORIG-NOTE.
   736     12  FILLER                  PIC X(63)  VALUE
   737         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   738
   739 01  ACCESS-KEYS.
   740     12  ELARCH-KEY.
   741         16  ARCH-CO             PIC X.
   742         16  ARCH-NUMBER         PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  15
* EL156.cbl
   743         16  ARCH-REC-TYPE       PIC X.
   744         16  ARCH-SEQ            PIC S9(04) COMP.
   745     12  ELMSTR-KEY.
   746         16  MSTR-COMP-CD        PIC X.
   747         16  MSTR-CARRIER        PIC X.
   748         16  MSTR-CLAIM-NO       PIC X(7).
   749         16  MSTR-CERT-NO        PIC X(11).
   750     12  ELCNTL-KEY.
   751         16  CNTL-COMP-ID        PIC X(3).
   752         16  CNTL-REC-TYPE       PIC X.
   753         16  CNTL-ACCESS         PIC X(4).
   754         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   755     12  ELCERT-KEY.
   756         16  CERT-COMP-CD        PIC X.
   757         16  CERT-CARRIER        PIC X.
   758         16  CERT-GROUPING       PIC X(6).
   759         16  CERT-STATE          PIC XX.
   760         16  CERT-ACCOUNT        PIC X(10).
   761         16  CERT-EFF-DT         PIC XX.
   762         16  CERT-CERT-NO        PIC X(11).
   763     12  ELTRLR-KEY.
   764         16  TRLR-COMP-CD        PIC X.
   765         16  TRLR-CARRIER        PIC X.
   766         16  TRLR-CLAIM-NO       PIC X(7).
   767         16  TRLR-CERT-NO        PIC X(11).
   768         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   769     12  ELACTQ-KEY.
   770         16  ACTQ-COMP-CD        PIC X.
   771         16  ACTQ-CARRIER        PIC X.
   772         16  ACTQ-CLAIM-NO       PIC X(7).
   773         16  ACTQ-CERT-NO        PIC X(11).
   774     12  W-NOTE-KEY.
   775         16  W-NOTE-COMP-CD      PIC X.
   776         16  W-NOTE-CERT-KEY.
   777             20  W-NOTE-CARRIER  PIC X.
   778             20  W-NOTE-GROUPING PIC X(6).
   779             20  W-NOTE-STATE    PIC XX.
   780             20  W-NOTE-ACCOUNT  PIC X(10).
   781             20  W-NOTE-EFF-DT   PIC XX.
   782             20  W-NOTE-CERT-NO  PIC X(11).
   783     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   784     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   785     12  ERACCT-KEY.
   786         16  ERACCT-PARTIAL-KEY.
   787             20  ACCT-COMP-CD    PIC X.
   788             20  ACCT-CARRIER    PIC X.
   789             20  ACCT-GROUPING   PIC X(6).
   790             20  ACCT-STATE      PIC XX.
   791             20  ACCT-ACCOUNT    PIC X(10).
   792         16  ACCT-EXP-DT         PIC XX.
   793         16  FILLER              PIC X(4) VALUE SPACES.
   794     12  ELCHKQ-KEY.
   795         16  CHKQ-COMP-CD        PIC X.
   796         16  CHKQ-CONTROL        PIC S9(8) COMP.
   797         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   798     12  ELBENE-KEY.
   799         16  BENE-COMP-CD         PIC X.
   800         16  BENE-RECORD-TYPE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  16
* EL156.cbl
   801         16  BENE-NUMBER          PIC X(10).
   802     12  ERCOMP-KEY.
   803         16  COMP-COMP-CD        PIC X.
   804         16  COMP-CARRIER        PIC X.
   805         16  COMP-GROUP          PIC X(06).
   806         16  COMP-FIN-RESP       PIC X(10).
   807         16  COMP-ACCOUNT        PIC X(10).
   808         16  COMP-TYPE           PIC X.
   809
   810     12  DLO035-KEY.
   811         16  DL35-PROCESS-TYPE   PIC X.
   812         16  DL35-CREDIT-CARD    PIC X(20).
   813         16  DL35-BEN-TYPE       PIC XX.
   814         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   815         16  DL35-RETURN-CODE    PIC XX.
   816
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  17
* EL156.cbl
   818*    COPY ELCDATE.
   819******************************************************************
   820*                                                                *
   821*                                                                *
   822*                            ELCDATE.                            *
   823*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   824*                            VMOD=2.003
   825*                                                                *
   826*                                                                *
   827*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   828*                 LENGTH = 200                                   *
   829******************************************************************
   830
   831 01  DATE-CONVERSION-DATA.
   832     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   833     12  DC-OPTION-CODE                PIC X.
   834         88  BIN-TO-GREG                VALUE ' '.
   835         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   836         88  EDIT-GREG-TO-BIN           VALUE '2'.
   837         88  YMD-GREG-TO-BIN            VALUE '3'.
   838         88  MDY-GREG-TO-BIN            VALUE '4'.
   839         88  JULIAN-TO-BIN              VALUE '5'.
   840         88  BIN-PLUS-ELAPSED           VALUE '6'.
   841         88  FIND-CENTURY               VALUE '7'.
   842         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   843         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   844         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   845         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   846         88  JULIAN-TO-BIN-3            VALUE 'C'.
   847         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   848         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   849         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   850         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   851         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   852         88  CHECK-LEAP-YEAR            VALUE 'H'.
   853         88  BIN-3-TO-GREG              VALUE 'I'.
   854         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   855         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   856         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   857         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   858         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   859         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   860         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   861         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   862         88  THREE-CHARACTER-BIN
   863                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   864         88  GREGORIAN-TO-BIN
   865                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   866         88  BIN-TO-GREGORIAN
   867                  VALUES ' ' '1' 'I' '8' 'G'.
   868         88  JULIAN-TO-BINARY
   869                  VALUES '5' 'C' 'E' 'F'.
   870     12  DC-ERROR-CODE                 PIC X.
   871         88  NO-CONVERSION-ERROR        VALUE ' '.
   872         88  DATE-CONVERSION-ERROR
   873                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   874         88  DATE-IS-ZERO               VALUE '1'.
   875         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  18
* EL156.cbl
   876         88  DATE-IS-INVALID            VALUE '3'.
   877         88  DATE1-GREATER-DATE2        VALUE '4'.
   878         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   879         88  DATE-INVALID-OPTION        VALUE '9'.
   880         88  INVALID-CENTURY            VALUE 'A'.
   881         88  ONLY-CENTURY               VALUE 'B'.
   882         88  ONLY-LEAP-YEAR             VALUE 'C'.
   883         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   884     12  DC-END-OF-MONTH               PIC X.
   885         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   886     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   887         88  USE-NORMAL-PROCESS         VALUE ' '.
   888         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   889         88  ADJUST-UP-100-YRS          VALUE '2'.
   890     12  FILLER                        PIC X.
   891     12  DC-CONVERSION-DATES.
   892         16  DC-BIN-DATE-1             PIC XX.
   893         16  DC-BIN-DATE-2             PIC XX.
   894         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   895         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   896                       DC-GREG-DATE-1-EDIT.
   897             20  DC-EDIT1-MONTH        PIC 99.
   898             20  SLASH1-1              PIC X.
   899             20  DC-EDIT1-DAY          PIC 99.
   900             20  SLASH1-2              PIC X.
   901             20  DC-EDIT1-YEAR         PIC 99.
   902         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   903         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   904                     DC-GREG-DATE-2-EDIT.
   905             20  DC-EDIT2-MONTH        PIC 99.
   906             20  SLASH2-1              PIC X.
   907             20  DC-EDIT2-DAY          PIC 99.
   908             20  SLASH2-2              PIC X.
   909             20  DC-EDIT2-YEAR         PIC 99.
   910         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   911         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   912                     DC-GREG-DATE-1-YMD.
   913             20  DC-YMD-YEAR           PIC 99.
   914             20  DC-YMD-MONTH          PIC 99.
   915             20  DC-YMD-DAY            PIC 99.
   916         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   917         16  DC-GREG-DATE-1-MDY-R REDEFINES
   918                      DC-GREG-DATE-1-MDY.
   919             20  DC-MDY-MONTH          PIC 99.
   920             20  DC-MDY-DAY            PIC 99.
   921             20  DC-MDY-YEAR           PIC 99.
   922         16  DC-GREG-DATE-1-ALPHA.
   923             20  DC-ALPHA-MONTH        PIC X(10).
   924             20  DC-ALPHA-DAY          PIC 99.
   925             20  FILLER                PIC XX.
   926             20  DC-ALPHA-CENTURY.
   927                 24 DC-ALPHA-CEN-N     PIC 99.
   928             20  DC-ALPHA-YEAR         PIC 99.
   929         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   930         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   931         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   932         16  DC-JULIAN-DATE            PIC 9(05).
   933         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  19
* EL156.cbl
   934                                       PIC 9(05).
   935         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   936             20  DC-JULIAN-YEAR        PIC 99.
   937             20  DC-JULIAN-DAYS        PIC 999.
   938         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   939         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   940         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   941     12  DATE-CONVERSION-VARIBLES.
   942         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   943         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   944             20  FILLER                PIC 9(3).
   945             20  HOLD-CEN-1-CCYY.
   946                 24  HOLD-CEN-1-CC     PIC 99.
   947                 24  HOLD-CEN-1-YY     PIC 99.
   948             20  HOLD-CEN-1-MO         PIC 99.
   949             20  HOLD-CEN-1-DA         PIC 99.
   950         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   951             20  HOLD-CEN-1-R-MO       PIC 99.
   952             20  HOLD-CEN-1-R-DA       PIC 99.
   953             20  HOLD-CEN-1-R-CCYY.
   954                 24  HOLD-CEN-1-R-CC   PIC 99.
   955                 24  HOLD-CEN-1-R-YY   PIC 99.
   956             20  FILLER                PIC 9(3).
   957         16  HOLD-CENTURY-1-X.
   958             20  FILLER                PIC X(3)  VALUE SPACES.
   959             20  HOLD-CEN-1-X-CCYY.
   960                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   961                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   962             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   963             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   964         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   965             20  HOLD-CEN-1-R-X-MO     PIC XX.
   966             20  HOLD-CEN-1-R-X-DA     PIC XX.
   967             20  HOLD-CEN-1-R-X-CCYY.
   968                 24  HOLD-CEN-1-R-X-CC PIC XX.
   969                 24  HOLD-CEN-1-R-X-YY PIC XX.
   970             20  FILLER                PIC XXX.
   971         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   972         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   973         16  DC-JULIAN-DATE-1          PIC 9(07).
   974         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   975             20  DC-JULIAN-1-CCYY.
   976                 24  DC-JULIAN-1-CC    PIC 99.
   977                 24  DC-JULIAN-1-YR    PIC 99.
   978             20  DC-JULIAN-DA-1        PIC 999.
   979         16  DC-JULIAN-DATE-2          PIC 9(07).
   980         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   981             20  DC-JULIAN-2-CCYY.
   982                 24  DC-JULIAN-2-CC    PIC 99.
   983                 24  DC-JULIAN-2-YR    PIC 99.
   984             20  DC-JULIAN-DA-2        PIC 999.
   985         16  DC-GREG-DATE-A-EDIT.
   986             20  DC-EDITA-MONTH        PIC 99.
   987             20  SLASHA-1              PIC X VALUE '/'.
   988             20  DC-EDITA-DAY          PIC 99.
   989             20  SLASHA-2              PIC X VALUE '/'.
   990             20  DC-EDITA-CCYY.
   991                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  20
* EL156.cbl
   992                 24  DC-EDITA-YEAR     PIC 99.
   993         16  DC-GREG-DATE-B-EDIT.
   994             20  DC-EDITB-MONTH        PIC 99.
   995             20  SLASHB-1              PIC X VALUE '/'.
   996             20  DC-EDITB-DAY          PIC 99.
   997             20  SLASHB-2              PIC X VALUE '/'.
   998             20  DC-EDITB-CCYY.
   999                 24  DC-EDITB-CENT     PIC 99.
  1000                 24  DC-EDITB-YEAR     PIC 99.
  1001         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1002         16  DC-GREG-DATE-CYMD-R REDEFINES
  1003                              DC-GREG-DATE-CYMD.
  1004             20  DC-CYMD-CEN           PIC 99.
  1005             20  DC-CYMD-YEAR          PIC 99.
  1006             20  DC-CYMD-MONTH         PIC 99.
  1007             20  DC-CYMD-DAY           PIC 99.
  1008         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1009         16  DC-GREG-DATE-MDCY-R REDEFINES
  1010                              DC-GREG-DATE-MDCY.
  1011             20  DC-MDCY-MONTH         PIC 99.
  1012             20  DC-MDCY-DAY           PIC 99.
  1013             20  DC-MDCY-CEN           PIC 99.
  1014             20  DC-MDCY-YEAR          PIC 99.
  1015    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1016        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1017    12  DC-EL310-DATE                  PIC X(21).
  1018    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  21
* EL156.cbl
  1020*    COPY ELCLOGOF.
  1021******************************************************************
  1022*                                                                *
  1023*                                                                *
  1024*                            ELCLOGOF.                           *
  1025*                            VMOD=2.001                          *
  1026*                                                                *
  1027*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1028*                                                                *
  1029******************************************************************
  1030 01  CLASIC-LOGOFF.
  1031     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1032     12  LOGOFF-TEXT.
  1033         16  FILLER          PIC X(5)    VALUE SPACES.
  1034         16  LOGOFF-MSG.
  1035             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1036             20  FILLER      PIC X       VALUE SPACES.
  1037             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1038         16  FILLER          PIC X(80)
  1039           VALUE '* YOU ARE NOW LOGGED OFF'.
  1040         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1041         16  FILLER          PIC X       VALUE QUOTE.
  1042         16  LOGOFF-SYS-MSG  PIC X(17)
  1043           VALUE 'S CLAS-IC SYSTEM '.
  1044     12  TEXT-MESSAGES.
  1045         16  UNACCESS-MSG    PIC X(29)
  1046             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1047         16  PGMIDERR-MSG    PIC X(17)
  1048             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  22
* EL156.cbl
  1050*    COPY ELCCALC.
  1051******************************************************************
  1052*                                                                *
  1053*                           ELCCALC.                            *
  1054*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1055*                            VMOD=2.025                          *
  1056*                                                                *
  1057*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1058*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1059*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1060*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1061*                                                                *
  1062*  PASSED TO ELRTRM                                              *
  1063*  -----------------                                             *
  1064*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1065*  ORIGINAL TERM                                                 *
  1066*  BEGINNING DATE                                                *
  1067*  ENDING DATE                                                   *
  1068*  COMPANY I.D.                                                  *
  1069*  ACCOUNT MASTER USER FIELD                                     *
  1070*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1071*  FREE LOOK DAYS                                                *
  1072*                                                                *
  1073*  RETURNED FROM ELRTRM                                          *
  1074*  ---------------------                                         *
  1075*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1076*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1077*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1078*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1079*----------------------------------------------------------------*
  1080*  PASSED TO ELRAMT                                              *
  1081*  ----------------                                              *
  1082*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1083*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1084*  ORIGINAL AMOUNT                                               *
  1085*  ALTERNATE BENEFIT (BALLON)                                    *
  1086*  A.P.R. - NET PAY ONLY                                         *
  1087*  METHOD
  1088*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1089*  COMPANY I.D.                                                  *
  1090*  BENEFIT TYPE                                                  *
  1091*                                                                *
  1092*  RETURNED FROM ELRAMT                                          *
  1093*  --------------------                                          *
  1094*  REMAINING AMOUNT 1 - CURRENT                                  *
  1095*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1096*  REMAINING AMOUNT FACTOR
  1097*----------------------------------------------------------------*
  1098*  PASSED TO ELRESV                                              *
  1099*  -----------------                                             *
  1100*  CERTIFICATE EFFECTIVE DATE                                    *
  1101*  VALUATION DATE                                                *
  1102*  PAID THRU DATE                                                *
  1103*  BENEFIT                                                       *
  1104*  INCURRED DATE                                                 *
  1105*  REPORTED DATE                                                 *
  1106*  ISSUE AGE                                                     *
  1107*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  23
* EL156.cbl
  1108*  CDT PERCENT                                                   *
  1109*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1110* *CLAIM TYPE (LIFE, A/H)                                        *
  1111* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1112* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1113*                                                                *
  1114*  RETURNED FROM ELRESV                                          *
  1115*  --------------------                                          *
  1116*  CDT TABLE USED                                                *
  1117*  CDT FACTOR USED                                               *
  1118*  PAY TO CURRENT RESERVE                                        *
  1119*  I.B.N.R. - A/H ONLY                                           *
  1120*  FUTURE (ACCRUED) AH ONLY                                      *
  1121*----------------------------------------------------------------*
  1122*  PASSED TO ELRATE                                              *
  1123*  ----------------                                              *
  1124*  CERT ISSUE DATE                                               *
  1125*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1126*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1127*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1128*  STATE CODE (CLIENT DEFINED)                                   *
  1129*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1130*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1131*  DEVIATION CODE                                                *
  1132*  ISSUE AGE                                                     *
  1133*  ORIGINAL BENEFIT AMOUNT                                       *
  1134*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1135*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1136*  BENEFIT KIND (LIFE OR A/H)                                    *
  1137*  A.P.R.                                                        *
  1138*  METHOD
  1139*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1140*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1141*  COMPANY I.D. (3 CHARACTER)                                    *
  1142*  BENEFIT CODE                                                  *
  1143*  BENEFIT OVERRIDE CODE                                         *
  1144*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1145*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1146*  JOINT INDICATOR (CSL ONLY)                                    *
  1147*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1148*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1149*                                                                *
  1150*  RETURNED FROM ELRATE                                          *
  1151*  --------------------                                          *
  1152*  CALCULATED PREMIUM                                            *
  1153*  PREMIUM RATE                                                  *
  1154*  MORTALITY CODE                                                *
  1155*  MAX ATTAINED AGE                                              *
  1156*  MAX AGE                                                       *
  1157*  MAX TERM                                                      *
  1158*  MAX MONTHLY BENEFIT                                           *
  1159*  MAX TOTAL BENIFIT                                             *
  1160*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1161*----------------------------------------------------------------*
  1162*  PASSED TO ELRFND                                              *
  1163*  ----------------                                              *
  1164*  CERT ISSUE DATE                                               *
  1165*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  24
* EL156.cbl
  1166*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1167*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1168*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1169*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1170*  STATE CODE (CLIENT DEFINED)                                   *
  1171*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1172*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1173*  DEVIATION CODE                                                *
  1174*  ISSUE AGE                                                     *
  1175*  ORIGINAL BENEFIT AMOUNT                                       *
  1176*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1177*  PROCESS TYPE (CANCEL)                                         *
  1178*  BENEFIT KIND (LIFE OR A/H)                                    *
  1179*  A.P.R.                                                        *
  1180*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1181*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1182*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1183*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1184*  COMPANY I.D. (3 CHARACTER)                                    *
  1185*  BENEFIT CODE                                                  *
  1186*  BENEFIT OVERRIDE CODE                                         *
  1187*                                                                *
  1188*  RETURNED FROM ELRFND                                          *
  1189*  --------------------                                          *
  1190*  CALCULATED REFUND                                             *
  1191*----------------------------------------------------------------*
  1192*  PASSED TO ELEARN                                              *
  1193*  ----------------                                              *
  1194*  CERT ISSUE DATE                                               *
  1195*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1196*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1197*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1198*  STATE CODE (CLIENT DEFINED)                                   *
  1199*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1200*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1201*  DEVIATION CODE                                                *
  1202*  ISSUE AGE                                                     *
  1203*  ORIGINAL BENEFIT AMOUNT                                       *
  1204*  BENEFIT KIND (LIFE OR A/H)                                    *
  1205*  A.P.R.                                                        *
  1206*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1207*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1208*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1209*  COMPANY I.D. (3 CHARACTER)                                    *
  1210*  BENEFIT CODE                                                  *
  1211*  BENEFIT OVERRIDE CODE                                         *
  1212*                                                                *
  1213*  RETURNED FROM ELEARN                                          *
  1214*  --------------------                                          *
  1215*  INDICATED  EARNINGS                                           *
  1216*----------------------------------------------------------------*
  1217*                 LENGTH = 450                                   *
  1218*                                                                *
  1219******************************************************************
  1220******************************************************************
  1221*                   C H A N G E   L O G
  1222*
  1223* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  25
* EL156.cbl
  1224*-----------------------------------------------------------------
  1225*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1226* EFFECTIVE    NUMBER
  1227*-----------------------------------------------------------------
  1228* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1229* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1230* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1231* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1232* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1233* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1234* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1235* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1236* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1237******************************************************************
  1238
  1239 01  CALCULATION-PASS-AREA.
  1240     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1241                                     COMP.
  1242
  1243     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1244       88  NO-CP-ERROR                             VALUE ZERO.
  1245       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1246                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1247       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1248       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1249       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1250       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1251       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1252       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1253       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1254       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1255       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1256       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1257       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1258       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1259       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1260       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1261       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1262       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1263       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1264
  1265     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1266       88  NO-CP-ERROR-2                           VALUE ZERO.
  1267***********************  INPUT AREAS ****************************
  1268
  1269     12  CP-CALCULATION-AREA.
  1270         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1271         16  CP-CERT-EFF-DT        PIC XX.
  1272         16  CP-VALUATION-DT       PIC XX.
  1273         16  CP-PAID-THRU-DT       PIC XX.
  1274         16  CP-BENEFIT-TYPE       PIC X.
  1275           88  CP-AH                               VALUE 'A' 'D'
  1276                                                   'I' 'U'.
  1277           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1278           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1279         16  CP-INCURRED-DT        PIC XX.
  1280         16  CP-REPORTED-DT        PIC XX.
  1281         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  26
* EL156.cbl
  1282         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1283         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1284                                     COMP-3.
  1285         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1286                                     COMP-3.
  1287         16  CP-CDT-METHOD         PIC X.
  1288           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1289           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1290           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1291         16  CP-CLAIM-TYPE         PIC X.
  1292           88  CP-AH-CLAIM                         VALUE 'A'.
  1293           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1294         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1295                                     COMP-3.
  1296         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1297                                     COMP-3.
  1298         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1299                                     COMP-3.
  1300         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1301                                     COMP-3.
  1302         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1303                                     COMP-3.
  1304         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1305                                     COMP-3.
  1306         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1307                                     COMP-3.
  1308         16  CP-REM-TERM-METHOD    PIC X.
  1309           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1310           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1311           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1312           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1313           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1314           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1315           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1316         16  CP-EARNING-METHOD     PIC X.
  1317           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1318           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1319           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1320           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1321           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1322           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1323           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1324           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1325           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1326           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1327           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1328           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1329           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1330           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1331         16  CP-PROCESS-TYPE       PIC X.
  1332           88  CP-CLAIM                            VALUE '1'.
  1333           88  CP-CANCEL                           VALUE '2'.
  1334           88  CP-ISSUE                            VALUE '3'.
  1335         16  CP-SPECIAL-CALC-CD    PIC X.
  1336           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1337           88  CP-1-MTH-INTEREST               VALUE ' '.
  1338           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1339           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  27
* EL156.cbl
  1340           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1341           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1342           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1343           88  CP-FARM-PLAN                    VALUE 'F'.
  1344           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1345           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1346           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1347           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1348           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1349           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1350           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1351           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1352           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1353           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1354                                                     'W' 'X'.
  1355           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1356           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1357           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1358           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1359           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1360           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1361           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1362           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1363           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1364           88  CP-CSL-METH-1                   VALUE '5'.
  1365           88  CP-CSL-METH-2                   VALUE '6'.
  1366           88  CP-CSL-METH-3                   VALUE '7'.
  1367           88  CP-CSL-METH-4                   VALUE '8'.
  1368
  1369         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1370                                     COMP-3.
  1371         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1372         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1373         16  CP-STATE              PIC XX          VALUE SPACE.
  1374         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1375         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1376           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1377               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1378         16  CP-R78-OPTION         PIC X.
  1379           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1380           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1381
  1382         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1383         16  CP-IBNR-RESERVE-SW    PIC X.
  1384         16  CP-CLAIM-STATUS       PIC X.
  1385         16  CP-RATE-FILE          PIC X.
  1386         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1387                                     COMP-3.
  1388
  1389         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1390         16  CP-AH-OVERRIDE-CODE   PIC X.
  1391
  1392         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1393                                     COMP-3.
  1394         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1395                                   PIC S9(5)V99 COMP-3.
  1396         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1397                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  28
* EL156.cbl
  1398         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1399                                     COMP-3.
  1400         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1401                                     COMP-3.
  1402         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1403                                  PIC S9(7)V99 COMP-3.
  1404
  1405         16  CP-PAID-FROM-DATE     PIC X(02).
  1406         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1407         16  CP-EXT-DAYS-CALC      PIC X.
  1408           88  CP-EXT-NO-CHG                   VALUE ' '.
  1409           88  CP-EXT-CHG-LF                   VALUE '1'.
  1410           88  CP-EXT-CHG-AH                   VALUE '2'.
  1411           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1412         16  CP-DOMICILE-STATE     PIC XX.
  1413         16  CP-CARRIER            PIC X.
  1414         16  CP-REIN-FLAG          PIC X.
  1415         16  CP-REM-TRM-CALC-OPTION PIC X.
  1416           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1417                      '2' '3' '4' '5'.
  1418           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1419           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1420           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1421           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1422           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1423           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1424           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1425           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1426         16  CP-SIG-SWITCH         PIC X.
  1427         16  CP-RATING-METHOD      PIC X.
  1428           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1429           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1430           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1431           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1432           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1433           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1434           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1435           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1436           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1437         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1438                                     COMP-3.
  1439         16  CP-BEN-CATEGORY       PIC X.
  1440         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1441         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1442                                   PIC S99V9(5) COMP-3.
  1443         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1444         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1445                                   PIC S99V9(5) COMP-3.
  1446         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1447         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1448         16  CP-EXPIRE-DT          PIC XX.
  1449         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1450         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1451         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1452         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1453         16  CP-DDF-SPEC-CALC      PIC X.
  1454             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1455             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  29
* EL156.cbl
  1456         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1457         16  CP-CANCEL-REASON      PIC X.
  1458         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1459         16  CP-PMT-MODE           PIC X.
  1460         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1461         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1462         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1463         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1464         16  FILLER                PIC X.
  1465
  1466***************    OUTPUT FROM ELRESV   ************************
  1467
  1468         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1469
  1470         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1471                                     COMP-3.
  1472         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1473                                     COMP-3.
  1474         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1475                                     COMP-3.
  1476         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1477                                     COMP-3.
  1478         16  FILLER                PIC X(09).
  1479***************    OUTPUT FROM ELRTRM   *************************
  1480
  1481         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1482                                     COMP-3.
  1483         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1484                                     COMP-3.
  1485         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1486                                     COMP-3.
  1487         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1488                                     COMP-3.
  1489         16  FILLER                PIC X(12).
  1490
  1491***************    OUTPUT FROM ELRAMT   *************************
  1492
  1493         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1494                                     COMP-3.
  1495         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1496                                     COMP-3.
  1497         16  FILLER                PIC X(12).
  1498
  1499***************    OUTPUT FROM ELRATE   *************************
  1500
  1501         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1502                                     COMP-3.
  1503         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1504                                     COMP-3.
  1505         16  CP-MORTALITY-CODE     PIC X(4).
  1506         16  CP-RATE-EDIT-FLAG     PIC X.
  1507             88  CP-RATES-NEED-APR                  VALUE '1'.
  1508         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1509                                     COMP-3.
  1510         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1511         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1512         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1513                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  30
* EL156.cbl
  1514         16  FILLER                PIC X(07).
  1515
  1516***************    OUTPUT FROM ELRFND   *************************
  1517
  1518         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1519                                     COMP-3.
  1520         16  CP-REFUND-TYPE-USED   PIC X.
  1521           88  CP-R-AS-R78                         VALUE '1'.
  1522           88  CP-R-AS-PRORATA                     VALUE '2'.
  1523           88  CP-R-AS-CALIF                       VALUE '3'.
  1524           88  CP-R-AS-TEXAS                       VALUE '4'.
  1525           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1526           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1527           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1528           88  CP-R-AS-MEAN                        VALUE '8'.
  1529           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1530           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1531           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1532           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1533           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1534           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1535         16  FILLER                PIC X(12).
  1536
  1537***************    OUTPUT FROM ELEARN   *************************
  1538
  1539         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1540                                     COMP-3.
  1541         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1542                                     COMP-3.
  1543         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1544                                     COMP-3.
  1545         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1546                                     COMP-3.
  1547         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1548                                     COMP-3.
  1549         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1550                                     COMP-3.
  1551         16  CP-EARNING-TYPE-USED  PIC X.
  1552           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1553           88  CP-E-AS-R78                         VALUE '1'.
  1554           88  CP-E-AS-PRORATA                     VALUE '2'.
  1555           88  CP-E-AS-TEXAS                       VALUE '4'.
  1556           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1557           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1558           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1559           88  CP-E-AS-MEAN                        VALUE '8'.
  1560           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1561         16  FILLER                PIC X(12).
  1562
  1563***************    OUTPUT FROM ELPMNT   *************************
  1564
  1565         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1566                                     COMP-3.
  1567         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1568                                     COMP-3.
  1569         16  FILLER                PIC X(12).
  1570
  1571***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  31
* EL156.cbl
  1572         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1573                                     COMP-3.
  1574         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1575                                     COMP-3.
  1576         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1577                                     COMP-3.
  1578         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1579                                     COMP-3.
  1580         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1581                                     COMP-3.
  1582         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1583                                     COMP-3.
  1584         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1585             88  OPEN-RATE-FILE                   VALUE 'O'.
  1586             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1587             88  IO-ERROR                         VALUE 'E'.
  1588
  1589         16  CP-FIRST-PAY-DATE     PIC XX.
  1590
  1591         16  CP-JOINT-INDICATOR    PIC X.
  1592
  1593         16  CP-RESERVE-REMAINING-TERM
  1594                                   PIC S9(4)V9    VALUE ZERO
  1595                                     COMP-3.
  1596
  1597         16  CP-INSURED-BIRTH-DT   PIC XX.
  1598
  1599         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1600                                     COMP-3.
  1601
  1602         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1603                                     COMP-3.
  1604
  1605         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1606                                     COMP-3.
  1607
  1608         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1609                                     COMP-3.
  1610
  1611         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1612                                     COMP-3.
  1613
  1614         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1615                                     COMP-3.
  1616
  1617         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1618                                     COMP-3.
  1619
  1620         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1621             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1622
  1623         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1624                                     COMP-3.
  1625         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1626                                     COMP-3.
  1627         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1628         16  FILLER                PIC X(15).
  1629******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  32
* EL156.cbl
  1630*    COPY ELCICALC.
  1631******************************************************************
  1632*                                                                *
  1633*                           ELCCICALC.                           *
  1634*                            VMOD=2.001                          *
  1635*                                                                *
  1636*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1637*                 CALCULATION MODULE                             *
  1638*                                                                *
  1639*  PASSED TO ELCLMI                                              *
  1640*  -----------------                                             *
  1641*  STATE                                                         *
  1642*  PRODUCT                                                       *
  1643*  COVERAGE                                                      *
  1644*  EFFECTIVE DATE                                                *
  1645*  INCURRED DATE                                                 *
  1646*  ESTABLISHED DATE                                              *
  1647*  LAST PAID DATE                                                *
  1648*  REPORTED DATE                                                 *
  1649*  CLAIM PAYMENT AMOUNT                                          *
  1650*                                                                *
  1651*  RETURNED FROM ELRTRM                                          *
  1652*  ---------------------                                         *
  1653*  RETURN CODE                                                   *
  1654*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1655*  CLAIM INTEREST AMOUNT                                         *
  1656*----------------------------------------------------------------*
  1657*----------------------------------------------------------------*
  1658*                 LENGTH = 100                                   *
  1659*                                                                *
  1660******************************************************************
  1661******************************************************************
  1662*                   C H A N G E   L O G
  1663*
  1664* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1665*-----------------------------------------------------------------
  1666*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1667* EFFECTIVE    NUMBER
  1668*-----------------------------------------------------------------
  1669* 120905    2004040700004  PEMA  NEW COPYBOOK
  1670* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1671******************************************************************
  1672
  1673 01  CLAIM-INT-PASS-AREA.
  1674     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1675                                     COMP.
  1676
  1677     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1678       88  NO-CI-ERROR                             VALUE ZERO.
  1679       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1680       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1681       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1682       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1683       88  CP-AMT-LT-5000                          VALUE '4'.
  1684       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1685       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1686       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1687       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  33
* EL156.cbl
  1688***********************  INPUT AREAS ****************************
  1689
  1690     12  CP-CALCULATION-AREA.
  1691         16  CP-COMPANY-CD         PIC X.
  1692         16  CP-STATE              PIC XX.
  1693         16  CP-PRODUCT            PIC XX.
  1694         16  CP-COVERAGE           PIC XX.
  1695         16  CP-INC-DT             PIC XX.
  1696         16  CP-EST-DT             PIC XX.
  1697         16  CP-LSTPD-DT           PIC XX.
  1698         16  CP-RPT-DT             PIC XX.
  1699         16  CP-PRF-DT             PIC XX.
  1700         16  CP-EFF-DT             PIC XX.
  1701         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1702         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1703         16  FILLER                PIC X(37).
  1704
  1705***************    OUTPUT FROM ELCLMI   ************************
  1706
  1707         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1708
  1709         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1710         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1711         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1712         16  FILLER                PIC X(19).
  1713******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  34
* EL156.cbl
  1715*    COPY ELCATTR.
  1716******************************************************************
  1717*                                                                *
  1718*                            ELCATTR.                            *
  1719*                            VMOD=2.001                          *
  1720*                                                                *
  1721*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1722*                                                                *
  1723*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1724*                                                                *
  1725*                   POS 1   P=PROTECTED                          *
  1726*                           U=UNPROTECTED                        *
  1727*                           S=ASKIP                              *
  1728*                   POS 2   A=ALPHA/NUMERIC                      *
  1729*                           N=NUMERIC                            *
  1730*                   POS 3   N=NORMAL                             *
  1731*                           B=BRIGHT                             *
  1732*                           D=DARK                               *
  1733*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1734*                           OF=MODIFIED DATA TAG OFF             *
  1735*                                                                *
  1736*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1737******************************************************************
  1738 01  ATTRIBUTE-LIST.
  1739     12  AL-PABOF            PIC X       VALUE 'Y'.
  1740     12  AL-PABON            PIC X       VALUE 'Z'.
  1741     12  AL-PADOF            PIC X       VALUE '%'.
  1742     12  AL-PADON            PIC X       VALUE '_'.
  1743     12  AL-PANOF            PIC X       VALUE '-'.
  1744     12  AL-PANON            PIC X       VALUE '/'.
  1745     12  AL-SABOF            PIC X       VALUE '8'.
  1746     12  AL-SABON            PIC X       VALUE '9'.
  1747     12  AL-SADOF            PIC X       VALUE '@'.
  1748     12  AL-SADON            PIC X       VALUE QUOTE.
  1749     12  AL-SANOF            PIC X       VALUE '0'.
  1750     12  AL-SANON            PIC X       VALUE '1'.
  1751     12  AL-UABOF            PIC X       VALUE 'H'.
  1752     12  AL-UABON            PIC X       VALUE 'I'.
  1753     12  AL-UADOF            PIC X       VALUE '<'.
  1754     12  AL-UADON            PIC X       VALUE '('.
  1755     12  AL-UANOF            PIC X       VALUE ' '.
  1756     12  AL-UANON            PIC X       VALUE 'A'.
  1757     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1758     12  AL-UNBON            PIC X       VALUE 'R'.
  1759     12  AL-UNDOF            PIC X       VALUE '*'.
  1760     12  AL-UNDON            PIC X       VALUE ')'.
  1761     12  AL-UNNOF            PIC X       VALUE '&'.
  1762     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  35
* EL156.cbl
  1764*    COPY ELCEMIB.
  1765******************************************************************
  1766*                                                                *
  1767*                                                                *
  1768*                            ELCEMIB.                            *
  1769*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1770*                            VMOD=2.005                          *
  1771*                                                                *
  1772*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1773*                                                                *
  1774******************************************************************
  1775 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1776     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1777     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1778     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1779     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1780     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1781     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1782     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1783     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1784     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1785         88  EMI-NO-ERRORS                    VALUE '1'.
  1786         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1787         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1788     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1789         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1790     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1791         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1792         88  EMI-AREA1-FULL                   VALUE '2'.
  1793     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1794         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1795         88  EMI-AREA2-FULL                   VALUE '2'.
  1796     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1797         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1798         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1799         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1800         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1801         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1802     12  EMI-ERROR-LINES.
  1803         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1804         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1805         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1806         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1807             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1808                 24  EMI-ERR-NUM         PIC X(4).
  1809                 24  EMI-FILLER          PIC X.
  1810                 24  EMI-SEV             PIC X.
  1811                 24  FILLER              PIC X.
  1812             20  FILLER                  PIC X(02).
  1813     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1814         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1815             20  EMI-ERROR-NUMBER    PIC X(4).
  1816             20  EMI-FILL            PIC X.
  1817             20  EMI-SEVERITY        PIC X.
  1818             20  FILLER              PIC X.
  1819             20  EMI-ERROR-TEXT.
  1820                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1821                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  36
* EL156.cbl
  1822     12  EMI-SEVERITY-SAVE           PIC X.
  1823         88  EMI-NOTE                    VALUE 'N'.
  1824         88  EMI-WARNING                 VALUE 'W'.
  1825         88  EMI-FORCABLE                VALUE 'F'.
  1826         88  EMI-FATAL                   VALUE 'X'.
  1827     12  EMI-MESSAGE-FLAG            PIC X.
  1828         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1829         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1830     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1831     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1832         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1833         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1834         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1835     12  FILLER                      PIC X(137)  VALUE SPACES.
  1836     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1837     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1838     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1839     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  37
* EL156.cbl
  1841*    COPY ELCLNKLT.
  1842******************************************************************
  1843*                                                                *
  1844*                                                                *
  1845*                           ELCLNKLT                             *
  1846*                            VMOD=2.003                          *
  1847*                                                                *
  1848*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1849*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1850*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1851*                                                                *
  1852*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1853*   COMPLETING THE REQUIRED FIELDS.                              *
  1854*                                                                *
  1855*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1856*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1857*                              9999 INDICATES AN UNKNOWN ABEND   *
  1858*                                   WAS DETECTED.                *
  1859*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1860*                              CODES FOUND IN THE ERROR FILE.    *
  1861******************************************************************
  1862 01  W-1523-LINKDATA.
  1863     12  W-1523-COMMON-PI-DATA.
  1864         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1865         16  FILLER              PIC  X(67).
  1866         16  W-1523-COMPANY-CD   PIC  X(01).
  1867         16  FILLER              PIC  X(10).
  1868         16  W-1523-CONTROL-IN-PROGRESS.
  1869             20  W-1523-CARRIER  PIC  X(01).
  1870             20  W-1523-GROUPING PIC  X(06).
  1871             20  W-1523-STATE    PIC  X(02).
  1872             20  W-1523-ACCOUNT  PIC  X(10).
  1873             20  W-1523-CLAIM-CERT-GRP.
  1874                 24  W-1523-CLAIM-NO
  1875                                 PIC  X(07).
  1876                 24  W-1523-CERT-NO.
  1877                     28  W-1523-CERT-PRIME
  1878                                 PIC  X(10).
  1879                     28  W-1523-CERT-SFX
  1880                                 PIC  X(01).
  1881                 24  W-1523-CERT-EFF-DT
  1882                                 PIC  X(02).
  1883         16  FILLER              PIC X(265).
  1884
  1885     12  W-1523-WORK-AREA.
  1886         16  W-1523-FORM-NUMBER  PIC  X(04).
  1887         16  W-1523-NUMBER-COPIES
  1888                                 PIC  9(01).
  1889         16  W-1523-ADDR-TYPE    PIC  X(02).
  1890         16  W-1523-FOLLOW-UP-DATE
  1891                                 PIC  X(02).
  1892         16  W-1523-RESEND-DATE  PIC  X(02).
  1893         16  W-1523-ERROR-CODE   PIC  9(04).
  1894             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1895             88  W-1523-FATAL-ERROR
  1896                                    VALUES  0006 0013 0042
  1897                                            0154 0168 0169
  1898                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  38
* EL156.cbl
  1899                                            0179 0186 0281
  1900                                            0332 2055 3697
  1901                                            3698 3699 3770
  1902                                            3771 3772 7675
  1903                                            9106 9808 9883
  1904                                            9887.
  1905             88  W-1523-STOP-ERRORS
  1906                                    VALUES  0013 0042 0154
  1907                                            0168 0169 0172
  1908                                            0281 0332 2055
  1909                                            3698 3699 7675
  1910                                            9106 9808 9883
  1911                                            9999.
  1912         16  W-1523-REASON       PIC  X(70).
  1913         16  W-1523-ARCHIVE-NUMBER
  1914                                 PIC  9(08).
  1915     12  W-1523-POINTER-AREA.
  1916         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1917         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1918         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1919         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1920         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  39
* EL156.cbl
  1922*    COPY ELCNWA.
  1923*****************************************************************
  1924*                                                               *
  1925*                                                               *
  1926*                            ELCNWA.                            *
  1927*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1928*                            VMOD=2.003                         *
  1929*                                                               *
  1930*            M O V E   N A M E   W O R K   A R E A.             *
  1931*                                                               *
  1932*****************************************************************.
  1933
  1934 01  WS-NAME-WORK-AREA.
  1935     05  WS-INSURED-LAST-NAME        PIC X(15).
  1936     05  WS-INSURED-1ST-NAME         PIC X(12).
  1937     05  WS-INSURED-MID-INIT         PIC X.
  1938
  1939     05  WS-NAME-WORK.
  1940         10  WS-NW                   PIC X
  1941             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1942
  1943     05  WS-NAME-WORK2.
  1944         10  WS-NW2                  PIC X
  1945             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1946                                        NWA-INDEX0.
  1947
  1948     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1949                                     COMP-3.
  1950
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  40
* EL156.cbl
  1952*    COPY ELCDMO.
  1953******************************************************************
  1954*                                                                *
  1955*                                                                *
  1956*                            ELCDMO.                             *
  1957*                            VMOD=2.004                          *
  1958*                                                                *
  1959*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  1960*        COMMUNICATION AREA                                      *
  1961*   FILE TYPE = NA                                               *
  1962*   RECORD SIZE = 110    RECFORM = FIXED                         *
  1963*                                                                *
  1964******************************************************************
  1965 01  DMO-COMMUNICATION-AREA.
  1966     12  DM-RECORD-TYPE                  PIC  X(02).
  1967             88  DM-ISSUE-TRAN                VALUE 'CC'.
  1968             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  1969             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  1970     12  DM-DIST-CODE                    PIC  X(04).
  1971     12  DM-MAIL-CODE                    PIC  X(05).
  1972     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  1973     12  DM-INSURED-NAME                 PIC  X(30).
  1974     12  DM-CLAIM-NO                     PIC  X(07).
  1975     12  DM-CLAIM-TYPE                   PIC  X.
  1976
  1977     12  DM-STATUS-DATA-AREA.
  1978         16  DM-CLAIM-STATUS             PIC  X.
  1979             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  1980             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  1981             88  DM-CLOSED                        VALUE '3'.
  1982             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  1983             88  DM-DEFAULT                       VALUE '9'.
  1984         16  DM-STATUS-DATE              PIC  X(08).
  1985******YYYYMMDD
  1986         16  DM-STAT-CHANGE-TYPE         PIC  X.
  1987             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  1988             88  DM-CLAIM-DENIED                  VALUE 'D'.
  1989             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  1990             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  1991             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  1992             88  DM-RE-OPENED                     VALUE 'R'.
  1993             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  1994             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  1995             88  DM-CLAIM-DELETED                 VALUE 'X'.
  1996         16  DM-STAT-CARRIER             PIC X.
  1997
  1998     12  DM-DRAFT-DATA-AREA.
  1999         16  DM-PAYMENT-TYPE             PIC  X.
  2000             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2001         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2002         16  DM-PAYMENT-DATE             PIC  X(08).
  2003******YYYYMMDD
  2004         16  DM-CERT-NO                  PIC  X(11).
  2005         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2006         16  DM-CARRIER                  PIC  X.
  2007
  2008     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  41
* EL156.cbl
  2010*    COPY ELCDMDCD.
  2011******************************************************************
  2012*                                                                *
  2013*                                                                *
  2014*                            ELCDMDCD.                           *
  2015*                            VMOD=2.001                          *
  2016*                                                                *
  2017*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2018*       COMMUNICATIONS AREA                                      *
  2019*                                                                *
  2020******************************************************************
  2021 01  CD-COMMUNICATION-AREA.
  2022     12  CD-SYSTEM-ID            PIC  X(02).
  2023         88 CD-CLAIMS                      VALUE 'CL'.
  2024         88 CD-CREDIT                      VALUE 'CR'.
  2025     12  CD-RECORD-TYPE          PIC  X(02).
  2026         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2027         88 CD-EOB-CODE                    VALUE 'EO'.
  2028         88 CD-ICD9-CODE                   VALUE 'I9'.
  2029         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2030         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2031         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2032         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2033         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2034     12  CD-RECORD-KEY           PIC  X(06).
  2035         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2036     12  CD-RETURN-CODE          PIC  X(02).
  2037     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2038     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2039     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2040     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  42
* EL156.cbl
  2042*    COPY ELCDCTB.
  2043******************************************************************
  2044*                                                                *
  2045*                                                                *
  2046*                            ELCDCTB.                            *
  2047*                            VMOD=2.002                          *
  2048*                                                                *
  2049*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2050*       COMMUNICATIONS AREA                                      *
  2051*                                                                *
  2052******************************************************************
  2053 01  DCT-COMMUNICATION-AREA.
  2054     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2055     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2056     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2057     12  DCT-PRODUCT-CODE         PIC  X(02).
  2058     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2059     12  DCT-RETURN-CODE          PIC  X(02).
  2060     12  DCT-MAIL-CODE            PIC  X(05).
  2061     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2062     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  43
* EL156.cbl
  2064 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2065 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2066 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2067 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  44
* EL156.cbl
  2069*    COPY ELCINTF.
  2070******************************************************************
  2071*                                                                *
  2072*                                                                *
  2073*                            ELCINTF.                            *
  2074*                            VMOD=2.017                          *
  2075*                                                                *
  2076*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2077*                                                                *
  2078*       LENGTH = 1024                                            *
  2079*                                                                *
  2080******************************************************************
  2081*                   C H A N G E   L O G
  2082*
  2083* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2084*-----------------------------------------------------------------
  2085*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2086* EFFECTIVE    NUMBER
  2087*-----------------------------------------------------------------
  2088* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2089******************************************************************
  2090 01  PROGRAM-INTERFACE-BLOCK.
  2091     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2092     12  PI-CALLING-PROGRAM              PIC X(8).
  2093     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2094     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2095     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2096     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2097     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2098     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2099     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2100     12  PI-COMPANY-ID                   PIC XXX.
  2101     12  PI-COMPANY-CD                   PIC X.
  2102
  2103     12  PI-COMPANY-PASSWORD             PIC X(8).
  2104
  2105     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2106
  2107     12  PI-CONTROL-IN-PROGRESS.
  2108         16  PI-CARRIER                  PIC X.
  2109         16  PI-GROUPING                 PIC X(6).
  2110         16  PI-STATE                    PIC XX.
  2111         16  PI-ACCOUNT                  PIC X(10).
  2112         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2113                                         PIC X(10).
  2114         16  PI-CLAIM-CERT-GRP.
  2115             20  PI-CLAIM-NO             PIC X(7).
  2116             20  PI-CERT-NO.
  2117                 25  PI-CERT-PRIME       PIC X(10).
  2118                 25  PI-CERT-SFX         PIC X.
  2119             20  PI-CERT-EFF-DT          PIC XX.
  2120         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2121             20  PI-PLAN-CODE            PIC X(2).
  2122             20  PI-REVISION-NUMBER      PIC X(3).
  2123             20  PI-PLAN-EFF-DT          PIC X(2).
  2124             20  PI-PLAN-EXP-DT          PIC X(2).
  2125             20  FILLER                  PIC X(11).
  2126         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  45
* EL156.cbl
  2127             20  PI-OE-REFERENCE-1.
  2128                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2129                 25  PI-OE-REF-1-SUFF    PIC XX.
  2130
  2131     12  PI-SESSION-IN-PROGRESS          PIC X.
  2132         88  CLAIM-SESSION                   VALUE '1'.
  2133         88  CREDIT-SESSION                  VALUE '2'.
  2134         88  WARRANTY-SESSION                VALUE '3'.
  2135         88  MORTGAGE-SESSION                VALUE '4'.
  2136         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2137
  2138
  2139*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2140
  2141     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2142     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2143
  2144     12  PI-CREDIT-USER                  PIC X.
  2145         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2146         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2147
  2148     12  PI-CLAIM-USER                   PIC X.
  2149         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2150         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2151
  2152     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2153         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2154         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2155         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2156         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2157         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2158
  2159     12  PI-PROCESSOR-ID                 PIC X(4).
  2160
  2161     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2162
  2163     12  PI-MEMBER-CAPTION               PIC X(10).
  2164
  2165     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2166         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2167
  2168     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2169     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2170     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2171     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2172
  2173     12  PI-AH-OVERRIDE-L1               PIC X.
  2174     12  PI-AH-OVERRIDE-L2               PIC XX.
  2175     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2176     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2177
  2178     12  PI-NEW-SYSTEM                   PIC X(2).
  2179
  2180     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2181     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2182         88  PI-USES-PAID-TO                 VALUE '1'.
  2183     12  PI-CRDTCRD-SYSTEM.
  2184         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  46
* EL156.cbl
  2185             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2186             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2187         16  PI-CC-MONTH-END-DT          PIC XX.
  2188     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2189
  2190     12  PI-OE-REFERENCE-2.
  2191         16  PI-OE-REF-2-PRIME           PIC X(10).
  2192         16  PI-OE-REF-2-SUFF            PIC X.
  2193
  2194     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2195
  2196     12  PI-LANGUAGE-TYPE                PIC X.
  2197             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2198             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2199             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2200
  2201     12  PI-POLICY-LINKAGE-IND           PIC X.
  2202         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2203         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2204                                                   LOW-VALUES.
  2205
  2206     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2207     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2208         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2209         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2210
  2211     12  PI-PROCESSOR-CSR-IND            PIC X.
  2212         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2213         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2214
  2215     12  FILLER                          PIC X(3).
  2216
  2217     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2218
  2219     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2220         PI-SYSTEM-LEVEL.
  2221
  2222         16  PI-ENTRY-CODES.
  2223             20  PI-ENTRY-CD-1           PIC X.
  2224             20  PI-ENTRY-CD-2           PIC X.
  2225
  2226         16  PI-RETURN-CODES.
  2227             20  PI-RETURN-CD-1          PIC X.
  2228             20  PI-RETURN-CD-2          PIC X.
  2229
  2230         16  PI-UPDATE-STATUS-SAVE.
  2231             20  PI-UPDATE-BY            PIC X(4).
  2232             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2233
  2234         16  PI-LOWER-CASE-LETTERS       PIC X.
  2235             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2236
  2237*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2238*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2239*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2240
  2241         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2242             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  47
* EL156.cbl
  2243             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2244             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2245             88  ACCNT-CNTL                  VALUE '3'.
  2246             88  CARR-ACCNT-CNTL             VALUE '4'.
  2247
  2248         16  PI-PROCESSOR-CAP-LIST.
  2249             20  PI-SYSTEM-CONTROLS.
  2250                24 PI-SYSTEM-DISPLAY     PIC X.
  2251                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2252                24 PI-SYSTEM-MODIFY      PIC X.
  2253                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2254             20  FILLER                  PIC XX.
  2255             20  PI-DISPLAY-CAP          PIC X.
  2256                 88  DISPLAY-CAP             VALUE 'Y'.
  2257             20  PI-MODIFY-CAP           PIC X.
  2258                 88  MODIFY-CAP              VALUE 'Y'.
  2259             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2260                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2261             20  PI-FORCE-CAP            PIC X.
  2262                 88  FORCE-CAP               VALUE 'Y'.
  2263
  2264         16  PI-PROGRAM-CONTROLS.
  2265             20  PI-PGM-PRINT-OPT        PIC X.
  2266             20  PI-PGM-FORMAT-OPT       PIC X.
  2267             20  PI-PGM-PROCESS-OPT      PIC X.
  2268             20  PI-PGM-TOTALS-OPT       PIC X.
  2269
  2270         16  PI-HELP-INTERFACE.
  2271             20  PI-LAST-ERROR-NO        PIC X(4).
  2272             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2273
  2274         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2275             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2276
  2277         16  PI-CR-CONTROL-IN-PROGRESS.
  2278             20  PI-CR-CARRIER           PIC X.
  2279             20  PI-CR-GROUPING          PIC X(6).
  2280             20  PI-CR-STATE             PIC XX.
  2281             20  PI-CR-ACCOUNT           PIC X(10).
  2282             20  PI-CR-FIN-RESP          PIC X(10).
  2283             20  PI-CR-TYPE              PIC X.
  2284
  2285         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2286
  2287         16  PI-CR-MONTH-END-DT          PIC XX.
  2288
  2289         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2290             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2291             88  PI-ZERO-CARRIER             VALUE '1'.
  2292             88  PI-ZERO-GROUPING            VALUE '2'.
  2293             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2294
  2295         16  PI-CARRIER-SECURITY         PIC X.
  2296             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2297
  2298         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2299             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2300             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  48
* EL156.cbl
  2301
  2302         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2303             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2304                                         INDEXED BY PI-ACCESS-NDX
  2305                                         PIC X.
  2306
  2307         16  PI-GA-BILLING-CONTROL       PIC X.
  2308             88  PI-GA-BILLING               VALUE '1'.
  2309
  2310         16  PI-MAIL-PROCESSING          PIC X.
  2311             88  PI-MAIL-YES                 VALUE 'Y'.
  2312
  2313         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2314
  2315         16  PI-AR-SYSTEM.
  2316             20  PI-AR-PROCESSING-CNTL   PIC X.
  2317                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2318             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2319             20  PI-AR-MONTH-END-DT      PIC XX.
  2320
  2321         16  PI-MP-SYSTEM.
  2322             20  PI-MORTGAGE-USER            PIC X.
  2323                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2324                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2325             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2326                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2327                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2328                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2329                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2330                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2331             20  PI-MP-MONTH-END-DT          PIC XX.
  2332             20  PI-MP-REFERENCE-NO.
  2333                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2334                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2335
  2336         16  PI-LABEL-CONTROL            PIC X(01).
  2337             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2338             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2339
  2340         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2341             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2342
  2343         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2344             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2345             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2346
  2347         16  FILLER                      PIC X(14).
  2348
  2349     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2350******************************************************************
  2351     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2352         16  PI-SAVE-FORM        PIC X(12).
  2353         16  PI-ACCT-KEY         PIC X(26).
  2354         16  PI-PAYEE-NAME       PIC X(30).
  2355         16  PI-DAILY-RATE       PIC S9(3)V99.
  2356         16  PI-MONTH-END-SAVE   PIC XX.
  2357         16  PI-BENEFIT-SAVE.
  2358             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  49
* EL156.cbl
  2359             20  PI-BEN-TYPE     PIC X.
  2360         16  PI-MANUAL-SW        PIC 9.
  2361         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2362         16  PI-PASS-SW          PIC X.
  2363         16  PI-PFKEY-USED       PIC X.
  2364         16  PI-CK-ASSIGN        PIC X.
  2365         16  PI-FATAL-COUNT      PIC 99.
  2366         16  PI-FORCE-COUNT      PIC 99.
  2367         16  PI-SAVE-INPUT.
  2368             20  PI-PMTTYPE      PIC X.
  2369             20  PI-PAYEE.
  2370                 24  PI-PAYEE-TYPE PIC X.
  2371                 24  PI-PAYEE-SEQ  PIC X.
  2372                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2373                   PI-PAYEE-SEQ    PIC S9.
  2374             20  PI-PMTNOTE1     PIC X(60).
  2375             20  PI-PMTNOTE2     PIC X(60).
  2376             20  PI-OFFLINE      PIC X.
  2377             20  PI-ECHECKNO     PIC X(7).
  2378             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2379                 28  PI-ECHECKNO-N     PIC X.
  2380                 28  PI-ECHECKNO-6     PIC X(6).
  2381             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2382                 24  PI-ECHECKNO-CR    PIC XX.
  2383                 24  PI-ECHECKNO-5     PIC X(5).
  2384             20  PI-HOLDTIL      PIC 9(6).
  2385             20  PI-EPYFROM      PIC 9(6).
  2386             20  PI-EPYTHRU      PIC 9(6).
  2387             20  PI-EDAYS        PIC S9(5).
  2388             20  PI-EPYAMT       PIC S9(7)V99.
  2389             20  PI-ERESV        PIC S9(7)V99.
  2390             20  PI-EEXPENS      PIC 9(6)V99.
  2391             20  PI-ETYPE        PIC X.
  2392             20  PI-CASH         PIC X.
  2393             20  PI-GROUPED      PIC X.
  2394             20  PI-INT-RATE     PIC S99V9(5).
  2395             20  PI-AIGFROM      PIC 9(6).
  2396             20  PI-LOAN-NO      PIC X(20).
  2397             20  PI-PROOF-DATE   PIC 9(6).
  2398             20  PI-PRINT-EOB-YN PIC X.
  2399             20  PI-PRINT-CLM-FRM-YN PIC X.
  2400             20  PI-PRINT-SURVEY-YN PIC X.
  2401         16  PI-SAVE-COMPUTED.
  2402             20  PI-CCHECKNO     PIC X(7).
  2403             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2404                 28  PI-CCHECKNO-N     PIC X.
  2405                 28  PI-CCHECKNO-6     PIC X(6).
  2406             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2407                 24  PI-CCHECKNO-CR    PIC XX.
  2408                 24  PI-CCHECKNO-5     PIC X(5).
  2409             20  PI-CPYFROM      PIC XX.
  2410             20  PI-CPYTHRU      PIC XX.
  2411             20  PI-CDAYS        PIC S9(5).
  2412             20  PI-CPYAMT       PIC S9(7)V99.
  2413             20  PI-CRESV        PIC 9(6)V99.
  2414             20  PI-CEXPENS      PIC 9(6)V99.
  2415             20  PI-PMT-APPR-SW  PIC X.
  2416                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  50
* EL156.cbl
  2417                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2418                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2419         16  PI-PREV-CLMNO       PIC X(7).
  2420         16  PI-LF-COVERAGE-TYPE PIC X.
  2421         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2422         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2423         16  PI-PROVISIONAL-IND  PIC X.
  2424             88 PI-PROV-PMT      VALUE 'P'.
  2425         16  PI-PREV-TRLR-KEY    PIC X(22).
  2426         16  PI-SPLIT-PMT-SW     PIC X.
  2427         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2428         16  PI-ACTIVITY-CODE    PIC 99.
  2429         16  PI-RESET-SW         PIC X.
  2430         16  PI-SPECIAL-BEN-SW   PIC X.
  2431             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2432         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2433         16  PI-EXP-DT           PIC XX.
  2434         16  PI-LOAN-DUE-DAY     PIC 99.
  2435         16  PI-3RD-PARTY-SW     PIC X.
  2436         16  PI-LOAN-UPDATE-SW   PIC X.
  2437
  2438         16  PI-DMD-DATA.
  2439             20  PI-SV-CERT-KEY       PIC X(21).
  2440             20  PI-SV-CERT-NO        PIC X(11).
  2441             20  PI-SV-BEN            PIC X(10).
  2442             20  PI-SV-CCN            PIC X(16).
  2443             20  PI-INTEREST-PAID-IND PIC X.
  2444                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2445             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2446             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2447             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2448             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2449         16  PI-AT-EOB-CODES.
  2450             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2451         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2452         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2453         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2454         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2455         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2456         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2457         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2458         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2459         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2460         16  PI-LF-BENEFIT-CD         PIC X(2).
  2461         16  PI-EOB-CODES-EXIST PIC X.
  2462         16  PI-SET-NOTE2-MDT   PIC X.
  2463         16  PI-VFY-2ND-BENE          PIC X.
  2464         16  PI-CLM-TYPE              PIC X.
  2465         16  PI-APPROVAL-LEVEL        PIC X.
  2466         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2467         16  PI-REAUDIT-NEEDED        PIC X.
  2468*00781          16  FILLER                   PIC X(176).
  2469*052506         16  FILLER                   PIC X(161).
  2470*031808         16  FILLER                   PIC X(154).
  2471*091808         16  FILLER                   PIC X(152).
  2472*041710         16  FILLER                   PIC X(94).
  2473         16  FILLER                   PIC X(87).
  2474
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  51
* EL156.cbl
  2476*    COPY ELCJPFX.
  2477******************************************************************
  2478*                                                                *
  2479*                                                                *
  2480*                            ELCJPFX.                            *
  2481*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2482*                            VMOD=2.002                          *
  2483*                                                                *
  2484*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2485*                                                                *
  2486*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2487*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2488*        ELCNTL - CONTROL FILE                                   *
  2489*        ELMSTR - CLAIM MASTERS                                  *
  2490*        ELTRLR - ACTIVITY TRAILERS                              *
  2491*        ELCHKQ - CHECK QUE                                      *
  2492******************************************************************
  2493 01  JOURNAL-RECORD.
  2494     12  JP-USER-ID                  PIC X(4).
  2495     12  JP-FILE-ID                  PIC X(8).
  2496     12  JP-PROGRAM-ID               PIC X(8).
  2497     12  JP-RECORD-TYPE              PIC X.
  2498         88 JP-ADD              VALUE 'A'.
  2499         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2500         88 JP-AFTER-CHANGE     VALUE 'C'.
  2501         88 JP-DELETE           VALUE 'D'.
  2502         88 JP-GENERIC-DELETE   VALUE 'G'.
  2503         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2504         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2505     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2506     12  JP-RECORD-AREA
  2507
  2508
  2509                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  52
* EL156.cbl
  2511*    COPY ELCAID.
  2512******************************************************************
  2513*                                                                *
  2514*                            ELCAID.                             *
  2515*                            VMOD=2.001                          *
  2516*                                                                *
  2517*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2518*                                                                *
  2519*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2520*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2521******************************************************************
  2522
  2523 01  DFHAID.
  2524   02  DFHNULL   PIC  X  VALUE  ' '.
  2525   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2526   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2527   02  DFHPEN    PIC  X  VALUE  '='.
  2528   02  DFHOPID   PIC  X  VALUE  'W'.
  2529   02  DFHPA1    PIC  X  VALUE  '%'.
  2530   02  DFHPA2    PIC  X  VALUE  '>'.
  2531   02  DFHPA3    PIC  X  VALUE  ','.
  2532   02  DFHPF1    PIC  X  VALUE  '1'.
  2533   02  DFHPF2    PIC  X  VALUE  '2'.
  2534   02  DFHPF3    PIC  X  VALUE  '3'.
  2535   02  DFHPF4    PIC  X  VALUE  '4'.
  2536   02  DFHPF5    PIC  X  VALUE  '5'.
  2537   02  DFHPF6    PIC  X  VALUE  '6'.
  2538   02  DFHPF7    PIC  X  VALUE  '7'.
  2539   02  DFHPF8    PIC  X  VALUE  '8'.
  2540   02  DFHPF9    PIC  X  VALUE  '9'.
  2541   02  DFHPF10   PIC  X  VALUE  ':'.
  2542   02  DFHPF11   PIC  X  VALUE  '#'.
  2543   02  DFHPF12   PIC  X  VALUE  '@'.
  2544   02  DFHPF13   PIC  X  VALUE  'A'.
  2545   02  DFHPF14   PIC  X  VALUE  'B'.
  2546   02  DFHPF15   PIC  X  VALUE  'C'.
  2547   02  DFHPF16   PIC  X  VALUE  'D'.
  2548   02  DFHPF17   PIC  X  VALUE  'E'.
  2549   02  DFHPF18   PIC  X  VALUE  'F'.
  2550   02  DFHPF19   PIC  X  VALUE  'G'.
  2551   02  DFHPF20   PIC  X  VALUE  'H'.
  2552   02  DFHPF21   PIC  X  VALUE  'I'.
  2553*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2554   02  DFHPF22   PIC  X  VALUE  '['.
  2555   02  DFHPF23   PIC  X  VALUE  '.'.
  2556   02  DFHPF24   PIC  X  VALUE  '<'.
  2557   02  DFHMSRE   PIC  X  VALUE  'X'.
  2558   02  DFHSTRF   PIC  X  VALUE  'h'.
  2559   02  DFHTRIG   PIC  X  VALUE  '"'.
  2560 01  FILLER    REDEFINES DFHAID.
  2561     12  FILLER              PIC X(8).
  2562     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  53
* EL156.cbl
  2564*    COPY EL156S.
  2565 01  EL156AI.
  2566     05  FILLER            PIC  X(0012).
  2567*    -------------------------------
  2568     05  RUNDTEAL PIC S9(0004) COMP.
  2569     05  RUNDTEAF PIC  X(0001).
  2570     05  FILLER REDEFINES RUNDTEAF.
  2571         10  RUNDTEAA PIC  X(0001).
  2572     05  RUNDTEAI PIC  X(0008).
  2573*    -------------------------------
  2574     05  RUNTIMAL PIC S9(0004) COMP.
  2575     05  RUNTIMAF PIC  X(0001).
  2576     05  FILLER REDEFINES RUNTIMAF.
  2577         10  RUNTIMAA PIC  X(0001).
  2578     05  RUNTIMAI PIC  X(0005).
  2579*    -------------------------------
  2580     05  SEQUL PIC S9(0004) COMP.
  2581     05  SEQUF PIC  X(0001).
  2582     05  FILLER REDEFINES SEQUF.
  2583         10  SEQUA PIC  X(0001).
  2584     05  SEQUI PIC  X(0010).
  2585*    -------------------------------
  2586     05  CLMNOL PIC S9(0004) COMP.
  2587     05  CLMNOF PIC  X(0001).
  2588     05  FILLER REDEFINES CLMNOF.
  2589         10  CLMNOA PIC  X(0001).
  2590     05  CLMNOI PIC  X(0007).
  2591*    -------------------------------
  2592     05  CARRL PIC S9(0004) COMP.
  2593     05  CARRF PIC  X(0001).
  2594     05  FILLER REDEFINES CARRF.
  2595         10  CARRA PIC  X(0001).
  2596     05  CARRI PIC  X(0001).
  2597*    -------------------------------
  2598     05  CERTNOL PIC S9(0004) COMP.
  2599     05  CERTNOF PIC  X(0001).
  2600     05  FILLER REDEFINES CERTNOF.
  2601         10  CERTNOA PIC  X(0001).
  2602     05  CERTNOI PIC  X(0010).
  2603*    -------------------------------
  2604     05  SUFXL PIC S9(0004) COMP.
  2605     05  SUFXF PIC  X(0001).
  2606     05  FILLER REDEFINES SUFXF.
  2607         10  SUFXA PIC  X(0001).
  2608     05  SUFXI PIC  X(0001).
  2609*    -------------------------------
  2610     05  CLMTYPL PIC S9(0004) COMP.
  2611     05  CLMTYPF PIC  X(0001).
  2612     05  FILLER REDEFINES CLMTYPF.
  2613         10  CLMTYPA PIC  X(0001).
  2614     05  CLMTYPI PIC  X(0006).
  2615*    -------------------------------
  2616     05  CLMSTATL PIC S9(0004) COMP.
  2617     05  CLMSTATF PIC  X(0001).
  2618     05  FILLER REDEFINES CLMSTATF.
  2619         10  CLMSTATA PIC  X(0001).
  2620     05  CLMSTATI PIC  X(0006).
  2621*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  54
* EL156.cbl
  2622     05  LSTNMEL PIC S9(0004) COMP.
  2623     05  LSTNMEF PIC  X(0001).
  2624     05  FILLER REDEFINES LSTNMEF.
  2625         10  LSTNMEA PIC  X(0001).
  2626     05  LSTNMEI PIC  X(0015).
  2627*    -------------------------------
  2628     05  FSTNMEL PIC S9(0004) COMP.
  2629     05  FSTNMEF PIC  X(0001).
  2630     05  FILLER REDEFINES FSTNMEF.
  2631         10  FSTNMEA PIC  X(0001).
  2632     05  FSTNMEI PIC  X(0012).
  2633*    -------------------------------
  2634     05  MINITL PIC S9(0004) COMP.
  2635     05  MINITF PIC  X(0001).
  2636     05  FILLER REDEFINES MINITF.
  2637         10  MINITA PIC  X(0001).
  2638     05  MINITI PIC  X(0001).
  2639*    -------------------------------
  2640     05  PRIMHDGL PIC S9(0004) COMP.
  2641     05  PRIMHDGF PIC  X(0001).
  2642     05  FILLER REDEFINES PRIMHDGF.
  2643         10  PRIMHDGA PIC  X(0001).
  2644     05  PRIMHDGI PIC  X(0012).
  2645*    -------------------------------
  2646     05  PCERTNOL PIC S9(0004) COMP.
  2647     05  PCERTNOF PIC  X(0001).
  2648     05  FILLER REDEFINES PCERTNOF.
  2649         10  PCERTNOA PIC  X(0001).
  2650     05  PCERTNOI PIC  X(0010).
  2651*    -------------------------------
  2652     05  PSUFXL PIC S9(0004) COMP.
  2653     05  PSUFXF PIC  X(0001).
  2654     05  FILLER REDEFINES PSUFXF.
  2655         10  PSUFXA PIC  X(0001).
  2656     05  PSUFXI PIC  X(0001).
  2657*    -------------------------------
  2658     05  STATUSL PIC S9(0004) COMP.
  2659     05  STATUSF PIC  X(0001).
  2660     05  FILLER REDEFINES STATUSF.
  2661         10  STATUSA PIC  X(0001).
  2662     05  STATUSI PIC  X(0010).
  2663*    -------------------------------
  2664     05  LOANHL PIC S9(0004) COMP.
  2665     05  LOANHF PIC  X(0001).
  2666     05  FILLER REDEFINES LOANHF.
  2667         10  LOANHA PIC  X(0001).
  2668     05  LOANHI PIC  X(0014).
  2669*    -------------------------------
  2670     05  LOANNOL PIC S9(0004) COMP.
  2671     05  LOANNOF PIC  X(0001).
  2672     05  FILLER REDEFINES LOANNOF.
  2673         10  LOANNOA PIC  X(0001).
  2674     05  LOANNOI PIC  X(0025).
  2675*    -------------------------------
  2676     05  DUEDAYHL PIC S9(0004) COMP.
  2677     05  DUEDAYHF PIC  X(0001).
  2678     05  FILLER REDEFINES DUEDAYHF.
  2679         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  55
* EL156.cbl
  2680     05  DUEDAYHI PIC  X(0008).
  2681*    -------------------------------
  2682     05  DUEDAYL PIC S9(0004) COMP.
  2683     05  DUEDAYF PIC  X(0001).
  2684     05  FILLER REDEFINES DUEDAYF.
  2685         10  DUEDAYA PIC  X(0001).
  2686     05  DUEDAYI PIC  X(0002).
  2687*    -------------------------------
  2688     05  ZINTHL PIC S9(0004) COMP.
  2689     05  ZINTHF PIC  X(0001).
  2690     05  FILLER REDEFINES ZINTHF.
  2691         10  ZINTHA PIC  X(0001).
  2692     05  ZINTHI PIC  X(0009).
  2693*    -------------------------------
  2694     05  ZINTL PIC S9(0004) COMP.
  2695     05  ZINTF PIC  X(0001).
  2696     05  FILLER REDEFINES ZINTF.
  2697         10  ZINTA PIC  X(0001).
  2698     05  ZINTI PIC  99V99999.
  2699*    -------------------------------
  2700     05  PTHRHDGL PIC S9(0004) COMP.
  2701     05  PTHRHDGF PIC  X(0001).
  2702     05  FILLER REDEFINES PTHRHDGF.
  2703         10  PTHRHDGA PIC  X(0001).
  2704     05  PTHRHDGI PIC  X(0014).
  2705*    -------------------------------
  2706     05  PDTHRUL PIC S9(0004) COMP.
  2707     05  PDTHRUF PIC  X(0001).
  2708     05  FILLER REDEFINES PDTHRUF.
  2709         10  PDTHRUA PIC  X(0001).
  2710     05  PDTHRUI PIC  X(0008).
  2711*    -------------------------------
  2712     05  TOTPAIDL PIC S9(0004) COMP.
  2713     05  TOTPAIDF PIC  X(0001).
  2714     05  FILLER REDEFINES TOTPAIDF.
  2715         10  TOTPAIDA PIC  X(0001).
  2716     05  TOTPAIDI PIC  X(0010).
  2717*    -------------------------------
  2718     05  COVERL PIC S9(0004) COMP.
  2719     05  COVERF PIC  X(0001).
  2720     05  FILLER REDEFINES COVERF.
  2721         10  COVERA PIC  X(0001).
  2722     05  COVERI PIC  X(0010).
  2723*    -------------------------------
  2724     05  INCURL PIC S9(0004) COMP.
  2725     05  INCURF PIC  X(0001).
  2726     05  FILLER REDEFINES INCURF.
  2727         10  INCURA PIC  X(0001).
  2728     05  INCURI PIC  X(0008).
  2729*    -------------------------------
  2730     05  LSTDTEL PIC S9(0004) COMP.
  2731     05  LSTDTEF PIC  X(0001).
  2732     05  FILLER REDEFINES LSTDTEF.
  2733         10  LSTDTEA PIC  X(0001).
  2734     05  LSTDTEI PIC  X(0008).
  2735*    -------------------------------
  2736     05  CRTSTATL PIC S9(0004) COMP.
  2737     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  56
* EL156.cbl
  2738     05  FILLER REDEFINES CRTSTATF.
  2739         10  CRTSTATA PIC  X(0001).
  2740     05  CRTSTATI PIC  X(0010).
  2741*    -------------------------------
  2742     05  EFFECTL PIC S9(0004) COMP.
  2743     05  EFFECTF PIC  X(0001).
  2744     05  FILLER REDEFINES EFFECTF.
  2745         10  EFFECTA PIC  X(0001).
  2746     05  EFFECTI PIC  X(0008).
  2747*    -------------------------------
  2748     05  TERMSL PIC S9(0004) COMP.
  2749     05  TERMSF PIC  X(0001).
  2750     05  FILLER REDEFINES TERMSF.
  2751         10  TERMSA PIC  X(0001).
  2752     05  TERMSI PIC  X(0011).
  2753*    -------------------------------
  2754     05  STACCTL PIC S9(0004) COMP.
  2755     05  STACCTF PIC  X(0001).
  2756     05  FILLER REDEFINES STACCTF.
  2757         10  STACCTA PIC  X(0001).
  2758     05  STACCTI PIC  X(0013).
  2759*    -------------------------------
  2760     05  EXPDTEHL PIC S9(0004) COMP.
  2761     05  EXPDTEHF PIC  X(0001).
  2762     05  FILLER REDEFINES EXPDTEHF.
  2763         10  EXPDTEHA PIC  X(0001).
  2764     05  EXPDTEHI PIC  X(0014).
  2765*    -------------------------------
  2766     05  EXPDTEL PIC S9(0004) COMP.
  2767     05  EXPDTEF PIC  X(0001).
  2768     05  FILLER REDEFINES EXPDTEF.
  2769         10  EXPDTEA PIC  X(0001).
  2770     05  EXPDTEI PIC  X(0008).
  2771*    -------------------------------
  2772     05  BENECAPL PIC S9(0004) COMP.
  2773     05  BENECAPF PIC  X(0001).
  2774     05  FILLER REDEFINES BENECAPF.
  2775         10  BENECAPA PIC  X(0001).
  2776     05  BENECAPI PIC  X(0013).
  2777*    -------------------------------
  2778     05  BENEL PIC S9(0004) COMP.
  2779     05  BENEF PIC  X(0001).
  2780     05  FILLER REDEFINES BENEF.
  2781         10  BENEA PIC  X(0001).
  2782     05  BENEI PIC  X(0009).
  2783*    -------------------------------
  2784     05  FORMTYPL PIC S9(0004) COMP.
  2785     05  FORMTYPF PIC  X(0001).
  2786     05  FILLER REDEFINES FORMTYPF.
  2787         10  FORMTYPA PIC  X(0001).
  2788     05  FORMTYPI PIC  X(0001).
  2789*    -------------------------------
  2790     05  PMTTYPEL PIC S9(0004) COMP.
  2791     05  PMTTYPEF PIC  X(0001).
  2792     05  FILLER REDEFINES PMTTYPEF.
  2793         10  PMTTYPEA PIC  X(0001).
  2794     05  PMTTYPEI PIC  X(0001).
  2795*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  57
* EL156.cbl
  2796     05  PAYEEL PIC S9(0004) COMP.
  2797     05  PAYEEF PIC  X(0001).
  2798     05  FILLER REDEFINES PAYEEF.
  2799         10  PAYEEA PIC  X(0001).
  2800     05  PAYEEI PIC  X(0002).
  2801*    -------------------------------
  2802     05  CHECKNOL PIC S9(0004) COMP.
  2803     05  CHECKNOF PIC  X(0001).
  2804     05  FILLER REDEFINES CHECKNOF.
  2805         10  CHECKNOA PIC  X(0001).
  2806     05  CHECKNOI PIC  X(0007).
  2807*    -------------------------------
  2808     05  OFFLINEL PIC S9(0004) COMP.
  2809     05  OFFLINEF PIC  X(0001).
  2810     05  FILLER REDEFINES OFFLINEF.
  2811         10  OFFLINEA PIC  X(0001).
  2812     05  OFFLINEI PIC  X(0001).
  2813*    -------------------------------
  2814     05  HOLDTILL PIC S9(0004) COMP.
  2815     05  HOLDTILF PIC  X(0001).
  2816     05  FILLER REDEFINES HOLDTILF.
  2817         10  HOLDTILA PIC  X(0001).
  2818     05  HOLDTILI PIC  X(0008).
  2819*    -------------------------------
  2820     05  NOTE1L PIC S9(0004) COMP.
  2821     05  NOTE1F PIC  X(0001).
  2822     05  FILLER REDEFINES NOTE1F.
  2823         10  NOTE1A PIC  X(0001).
  2824     05  NOTE1I PIC  X(0060).
  2825*    -------------------------------
  2826     05  NOTE2L PIC S9(0004) COMP.
  2827     05  NOTE2F PIC  X(0001).
  2828     05  FILLER REDEFINES NOTE2F.
  2829         10  NOTE2A PIC  X(0001).
  2830     05  NOTE2I PIC  X(0060).
  2831*    -------------------------------
  2832     05  EOBYNL PIC S9(0004) COMP.
  2833     05  EOBYNF PIC  X(0001).
  2834     05  FILLER REDEFINES EOBYNF.
  2835         10  EOBYNA PIC  X(0001).
  2836     05  EOBYNI PIC  X(0001).
  2837*    -------------------------------
  2838     05  CLMFMYNL PIC S9(0004) COMP.
  2839     05  CLMFMYNF PIC  X(0001).
  2840     05  FILLER REDEFINES CLMFMYNF.
  2841         10  CLMFMYNA PIC  X(0001).
  2842     05  CLMFMYNI PIC  X(0001).
  2843*    -------------------------------
  2844     05  SURVYYNL PIC S9(0004) COMP.
  2845     05  SURVYYNF PIC  X(0001).
  2846     05  FILLER REDEFINES SURVYYNF.
  2847         10  SURVYYNA PIC  X(0001).
  2848     05  SURVYYNI PIC  X(0001).
  2849*    -------------------------------
  2850     05  PINTHL PIC S9(0004) COMP.
  2851     05  PINTHF PIC  X(0001).
  2852     05  FILLER REDEFINES PINTHF.
  2853         10  PINTHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  58
* EL156.cbl
  2854     05  PINTHI PIC  X(0004).
  2855*    -------------------------------
  2856     05  PINTL PIC S9(0004) COMP.
  2857     05  PINTF PIC  X(0001).
  2858     05  FILLER REDEFINES PINTF.
  2859         10  PINTA PIC  X(0001).
  2860     05  PINTI PIC  X(0008).
  2861*    -------------------------------
  2862     05  PROOFDTL PIC S9(0004) COMP.
  2863     05  PROOFDTF PIC  X(0001).
  2864     05  FILLER REDEFINES PROOFDTF.
  2865         10  PROOFDTA PIC  X(0001).
  2866     05  PROOFDTI PIC  X(0008).
  2867*    -------------------------------
  2868     05  AIGFRMHL PIC S9(0004) COMP.
  2869     05  AIGFRMHF PIC  X(0001).
  2870     05  FILLER REDEFINES AIGFRMHF.
  2871         10  AIGFRMHA PIC  X(0001).
  2872     05  AIGFRMHI PIC  X(0012).
  2873*    -------------------------------
  2874     05  AIGFROML PIC S9(0004) COMP.
  2875     05  AIGFROMF PIC  X(0001).
  2876     05  FILLER REDEFINES AIGFROMF.
  2877         10  AIGFROMA PIC  X(0001).
  2878     05  AIGFROMI PIC  X(0008).
  2879*    -------------------------------
  2880     05  PMTHDGAL PIC S9(0004) COMP.
  2881     05  PMTHDGAF PIC  X(0001).
  2882     05  FILLER REDEFINES PMTHDGAF.
  2883         10  PMTHDGAA PIC  X(0001).
  2884     05  PMTHDGAI PIC  X(0066).
  2885*    -------------------------------
  2886     05  EPYFROML PIC S9(0004) COMP.
  2887     05  EPYFROMF PIC  X(0001).
  2888     05  FILLER REDEFINES EPYFROMF.
  2889         10  EPYFROMA PIC  X(0001).
  2890     05  EPYFROMI PIC  X(0008).
  2891*    -------------------------------
  2892     05  EPYTHRUL PIC S9(0004) COMP.
  2893     05  EPYTHRUF PIC  X(0001).
  2894     05  FILLER REDEFINES EPYTHRUF.
  2895         10  EPYTHRUA PIC  X(0001).
  2896     05  EPYTHRUI PIC  X(0008).
  2897*    -------------------------------
  2898     05  EDAYSL PIC S9(0004) COMP.
  2899     05  EDAYSF PIC  X(0001).
  2900     05  FILLER REDEFINES EDAYSF.
  2901         10  EDAYSA PIC  X(0001).
  2902     05  EDAYSI PIC  S9(6).
  2903*    -------------------------------
  2904     05  EPYAMTL PIC S9(0004) COMP.
  2905     05  EPYAMTF PIC  X(0001).
  2906     05  FILLER REDEFINES EPYAMTF.
  2907         10  EPYAMTA PIC  X(0001).
  2908     05  EPYAMTI PIC  S9(8)V99.
  2909*    -------------------------------
  2910     05  ERESVL PIC S9(0004) COMP.
  2911     05  ERESVF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  59
* EL156.cbl
  2912     05  FILLER REDEFINES ERESVF.
  2913         10  ERESVA PIC  X(0001).
  2914     05  ERESVI PIC  S9(7)V99.
  2915*    -------------------------------
  2916     05  ETYPEL PIC S9(0004) COMP.
  2917     05  ETYPEF PIC  X(0001).
  2918     05  FILLER REDEFINES ETYPEF.
  2919         10  ETYPEA PIC  X(0001).
  2920     05  ETYPEI PIC  X(0001).
  2921*    -------------------------------
  2922     05  EEXPENSL PIC S9(0004) COMP.
  2923     05  EEXPENSF PIC  X(0001).
  2924     05  FILLER REDEFINES EEXPENSF.
  2925         10  EEXPENSA PIC  X(0001).
  2926     05  EEXPENSI PIC  9(6)V99.
  2927*    -------------------------------
  2928     05  CPYFROML PIC S9(0004) COMP.
  2929     05  CPYFROMF PIC  X(0001).
  2930     05  FILLER REDEFINES CPYFROMF.
  2931         10  CPYFROMA PIC  X(0001).
  2932     05  CPYFROMI PIC  X(0008).
  2933*    -------------------------------
  2934     05  CPYTHRUL PIC S9(0004) COMP.
  2935     05  CPYTHRUF PIC  X(0001).
  2936     05  FILLER REDEFINES CPYTHRUF.
  2937         10  CPYTHRUA PIC  X(0001).
  2938     05  CPYTHRUI PIC  X(0008).
  2939*    -------------------------------
  2940     05  CDAYSL PIC S9(0004) COMP.
  2941     05  CDAYSF PIC  X(0001).
  2942     05  FILLER REDEFINES CDAYSF.
  2943         10  CDAYSA PIC  X(0001).
  2944     05  CDAYSI PIC  9(6).
  2945*    -------------------------------
  2946     05  CPYAMTL PIC S9(0004) COMP.
  2947     05  CPYAMTF PIC  X(0001).
  2948     05  FILLER REDEFINES CPYAMTF.
  2949         10  CPYAMTA PIC  X(0001).
  2950     05  CPYAMTI PIC  S9(8)V99.
  2951*    -------------------------------
  2952     05  CRESVL PIC S9(0004) COMP.
  2953     05  CRESVF PIC  X(0001).
  2954     05  FILLER REDEFINES CRESVF.
  2955         10  CRESVA PIC  X(0001).
  2956     05  CRESVI PIC  9(6)V99.
  2957*    -------------------------------
  2958     05  CEXPENSL PIC S9(0004) COMP.
  2959     05  CEXPENSF PIC  X(0001).
  2960     05  FILLER REDEFINES CEXPENSF.
  2961         10  CEXPENSA PIC  X(0001).
  2962     05  CEXPENSI PIC  9(6)V99.
  2963*    -------------------------------
  2964     05  ERRMSG0L PIC S9(0004) COMP.
  2965     05  ERRMSG0F PIC  X(0001).
  2966     05  FILLER REDEFINES ERRMSG0F.
  2967         10  ERRMSG0A PIC  X(0001).
  2968     05  ERRMSG0I PIC  X(0072).
  2969*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  60
* EL156.cbl
  2970     05  ERRMSG1L PIC S9(0004) COMP.
  2971     05  ERRMSG1F PIC  X(0001).
  2972     05  FILLER REDEFINES ERRMSG1F.
  2973         10  ERRMSG1A PIC  X(0001).
  2974     05  ERRMSG1I PIC  X(0072).
  2975*    -------------------------------
  2976     05  ERRMSG2L PIC S9(0004) COMP.
  2977     05  ERRMSG2F PIC  X(0001).
  2978     05  FILLER REDEFINES ERRMSG2F.
  2979         10  ERRMSG2A PIC  X(0001).
  2980     05  ERRMSG2I PIC  X(0072).
  2981*    -------------------------------
  2982     05  ENTERPFL PIC S9(0004) COMP.
  2983     05  ENTERPFF PIC  X(0001).
  2984     05  FILLER REDEFINES ENTERPFF.
  2985         10  ENTERPFA PIC  X(0001).
  2986     05  ENTERPFI PIC  99.
  2987*    -------------------------------
  2988     05  PF6TITL PIC S9(0004) COMP.
  2989     05  PF6TITF PIC  X(0001).
  2990     05  FILLER REDEFINES PF6TITF.
  2991         10  PF6TITA PIC  X(0001).
  2992     05  PF6TITI PIC  X(0016).
  2993 01  EL156AO REDEFINES EL156AI.
  2994     05  FILLER            PIC  X(0012).
  2995*    -------------------------------
  2996     05  FILLER            PIC  X(0003).
  2997     05  RUNDTEAO PIC  X(0008).
  2998*    -------------------------------
  2999     05  FILLER            PIC  X(0003).
  3000     05  RUNTIMAO PIC  99.99.
  3001*    -------------------------------
  3002     05  FILLER            PIC  X(0003).
  3003     05  SEQUO PIC  X(0010).
  3004*    -------------------------------
  3005     05  FILLER            PIC  X(0003).
  3006     05  CLMNOO PIC  X(0007).
  3007*    -------------------------------
  3008     05  FILLER            PIC  X(0003).
  3009     05  CARRO PIC  X(0001).
  3010*    -------------------------------
  3011     05  FILLER            PIC  X(0003).
  3012     05  CERTNOO PIC  X(0010).
  3013*    -------------------------------
  3014     05  FILLER            PIC  X(0003).
  3015     05  SUFXO PIC  X(0001).
  3016*    -------------------------------
  3017     05  FILLER            PIC  X(0003).
  3018     05  CLMTYPO PIC  X(0006).
  3019*    -------------------------------
  3020     05  FILLER            PIC  X(0003).
  3021     05  CLMSTATO PIC  X(0006).
  3022*    -------------------------------
  3023     05  FILLER            PIC  X(0003).
  3024     05  LSTNMEO PIC  X(0015).
  3025*    -------------------------------
  3026     05  FILLER            PIC  X(0003).
  3027     05  FSTNMEO PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  61
* EL156.cbl
  3028*    -------------------------------
  3029     05  FILLER            PIC  X(0003).
  3030     05  MINITO PIC  X(0001).
  3031*    -------------------------------
  3032     05  FILLER            PIC  X(0003).
  3033     05  PRIMHDGO PIC  X(0012).
  3034*    -------------------------------
  3035     05  FILLER            PIC  X(0003).
  3036     05  PCERTNOO PIC  X(0010).
  3037*    -------------------------------
  3038     05  FILLER            PIC  X(0003).
  3039     05  PSUFXO PIC  X(0001).
  3040*    -------------------------------
  3041     05  FILLER            PIC  X(0003).
  3042     05  STATUSO PIC  X(0010).
  3043*    -------------------------------
  3044     05  FILLER            PIC  X(0003).
  3045     05  LOANHO PIC  X(0014).
  3046*    -------------------------------
  3047     05  FILLER            PIC  X(0003).
  3048     05  LOANNOO PIC  X(0025).
  3049*    -------------------------------
  3050     05  FILLER            PIC  X(0003).
  3051     05  DUEDAYHO PIC  X(0008).
  3052*    -------------------------------
  3053     05  FILLER            PIC  X(0003).
  3054     05  DUEDAYO PIC  X(0002).
  3055*    -------------------------------
  3056     05  FILLER            PIC  X(0003).
  3057     05  ZINTHO PIC  X(0009).
  3058*    -------------------------------
  3059     05  FILLER            PIC  X(0003).
  3060     05  ZINTO PIC  9.99999.
  3061*    -------------------------------
  3062     05  FILLER            PIC  X(0003).
  3063     05  PTHRHDGO PIC  X(0014).
  3064*    -------------------------------
  3065     05  FILLER            PIC  X(0003).
  3066     05  PDTHRUO PIC  X(0008).
  3067*    -------------------------------
  3068     05  FILLER            PIC  X(0003).
  3069     05  TOTPAIDO PIC  Z(6).99-.
  3070*    -------------------------------
  3071     05  FILLER            PIC  X(0003).
  3072     05  COVERO PIC  X(0010).
  3073*    -------------------------------
  3074     05  FILLER            PIC  X(0003).
  3075     05  INCURO PIC  X(0008).
  3076*    -------------------------------
  3077     05  FILLER            PIC  X(0003).
  3078     05  LSTDTEO PIC  X(0008).
  3079*    -------------------------------
  3080     05  FILLER            PIC  X(0003).
  3081     05  CRTSTATO PIC  X(0010).
  3082*    -------------------------------
  3083     05  FILLER            PIC  X(0003).
  3084     05  EFFECTO PIC  X(0008).
  3085*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  62
* EL156.cbl
  3086     05  FILLER            PIC  X(0003).
  3087     05  TERMSO PIC  X(0011).
  3088*    -------------------------------
  3089     05  FILLER            PIC  X(0003).
  3090     05  STACCTO PIC  X(0013).
  3091*    -------------------------------
  3092     05  FILLER            PIC  X(0003).
  3093     05  EXPDTEHO PIC  X(0014).
  3094*    -------------------------------
  3095     05  FILLER            PIC  X(0003).
  3096     05  EXPDTEO PIC  X(0008).
  3097*    -------------------------------
  3098     05  FILLER            PIC  X(0003).
  3099     05  BENECAPO PIC  X(0013).
  3100*    -------------------------------
  3101     05  FILLER            PIC  X(0003).
  3102     05  BENEO PIC  Z(6).99.
  3103*    -------------------------------
  3104     05  FILLER            PIC  X(0003).
  3105     05  FORMTYPO PIC  X(0001).
  3106*    -------------------------------
  3107     05  FILLER            PIC  X(0003).
  3108     05  PMTTYPEO PIC  X(0001).
  3109*    -------------------------------
  3110     05  FILLER            PIC  X(0003).
  3111     05  PAYEEO PIC  X(0002).
  3112*    -------------------------------
  3113     05  FILLER            PIC  X(0003).
  3114     05  CHECKNOO PIC  X(0007).
  3115*    -------------------------------
  3116     05  FILLER            PIC  X(0003).
  3117     05  OFFLINEO PIC  X(0001).
  3118*    -------------------------------
  3119     05  FILLER            PIC  X(0003).
  3120     05  HOLDTILO PIC  99B99B99.
  3121*    -------------------------------
  3122     05  FILLER            PIC  X(0003).
  3123     05  NOTE1O PIC  X(0060).
  3124*    -------------------------------
  3125     05  FILLER            PIC  X(0003).
  3126     05  NOTE2O PIC  X(0060).
  3127*    -------------------------------
  3128     05  FILLER            PIC  X(0003).
  3129     05  EOBYNO PIC  X(0001).
  3130*    -------------------------------
  3131     05  FILLER            PIC  X(0003).
  3132     05  CLMFMYNO PIC  X(0001).
  3133*    -------------------------------
  3134     05  FILLER            PIC  X(0003).
  3135     05  SURVYYNO PIC  X(0001).
  3136*    -------------------------------
  3137     05  FILLER            PIC  X(0003).
  3138     05  PINTHO PIC  X(0004).
  3139*    -------------------------------
  3140     05  FILLER            PIC  X(0003).
  3141     05  PINTO PIC  Z,ZZ9.99.
  3142*    -------------------------------
  3143     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  63
* EL156.cbl
  3144     05  PROOFDTO PIC  99B99B99.
  3145*    -------------------------------
  3146     05  FILLER            PIC  X(0003).
  3147     05  AIGFRMHO PIC  X(0012).
  3148*    -------------------------------
  3149     05  FILLER            PIC  X(0003).
  3150     05  AIGFROMO PIC  99B99B99.
  3151*    -------------------------------
  3152     05  FILLER            PIC  X(0003).
  3153     05  PMTHDGAO PIC  X(0066).
  3154*    -------------------------------
  3155     05  FILLER            PIC  X(0003).
  3156     05  EPYFROMO PIC  99B99B99.
  3157*    -------------------------------
  3158     05  FILLER            PIC  X(0003).
  3159     05  EPYTHRUO PIC  99B99B99.
  3160*    -------------------------------
  3161     05  FILLER            PIC  X(0003).
  3162     05  EDAYSO PIC  Z(4)9-.
  3163*    -------------------------------
  3164     05  FILLER            PIC  X(0003).
  3165     05  EPYAMTO PIC  Z(6).99-.
  3166*    -------------------------------
  3167     05  FILLER            PIC  X(0003).
  3168     05  ERESVO PIC  Z(5).99-.
  3169*    -------------------------------
  3170     05  FILLER            PIC  X(0003).
  3171     05  ETYPEO PIC  X(0001).
  3172*    -------------------------------
  3173     05  FILLER            PIC  X(0003).
  3174     05  EEXPENSO PIC  Z(5).99.
  3175*    -------------------------------
  3176     05  FILLER            PIC  X(0003).
  3177     05  CPYFROMO PIC  99B99B99.
  3178*    -------------------------------
  3179     05  FILLER            PIC  X(0003).
  3180     05  CPYTHRUO PIC  99B99B99.
  3181*    -------------------------------
  3182     05  FILLER            PIC  X(0003).
  3183     05  CDAYSO PIC  Z(4)9-.
  3184*    -------------------------------
  3185     05  FILLER            PIC  X(0003).
  3186     05  CPYAMTO PIC  Z(6).99-.
  3187*    -------------------------------
  3188     05  FILLER            PIC  X(0003).
  3189     05  CRESVO PIC  Z(5).99.
  3190*    -------------------------------
  3191     05  FILLER            PIC  X(0003).
  3192     05  CEXPENSO PIC  Z(5).99.
  3193*    -------------------------------
  3194     05  FILLER            PIC  X(0003).
  3195     05  ERRMSG0O PIC  X(0072).
  3196*    -------------------------------
  3197     05  FILLER            PIC  X(0003).
  3198     05  ERRMSG1O PIC  X(0072).
  3199*    -------------------------------
  3200     05  FILLER            PIC  X(0003).
  3201     05  ERRMSG2O PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  64
* EL156.cbl
  3202*    -------------------------------
  3203     05  FILLER            PIC  X(0003).
  3204     05  ENTERPFO PIC  X(0002).
  3205*    -------------------------------
  3206     05  FILLER            PIC  X(0003).
  3207     05  PF6TITO PIC  X(0016).
  3208*    -------------------------------
  3209 01  EL156BI REDEFINES EL156AI.
  3210     05  FILLER            PIC  X(0012).
  3211*    -------------------------------
  3212     05  RUNDTEBL PIC S9(0004) COMP.
  3213     05  RUNDTEBF PIC  X(0001).
  3214     05  FILLER REDEFINES RUNDTEBF.
  3215         10  RUNDTEBA PIC  X(0001).
  3216     05  RUNDTEBI PIC  X(0008).
  3217*    -------------------------------
  3218     05  RUNTIMBL PIC S9(0004) COMP.
  3219     05  RUNTIMBF PIC  X(0001).
  3220     05  FILLER REDEFINES RUNTIMBF.
  3221         10  RUNTIMBA PIC  X(0001).
  3222     05  RUNTIMBI PIC  X(0005).
  3223*    -------------------------------
  3224     05  PAYDTBL PIC S9(0004) COMP.
  3225     05  PAYDTBF PIC  X(0001).
  3226     05  FILLER REDEFINES PAYDTBF.
  3227         10  PAYDTBA PIC  X(0001).
  3228     05  PAYDTBI PIC  X(0008).
  3229*    -------------------------------
  3230     05  PAYTYPBL PIC S9(0004) COMP.
  3231     05  PAYTYPBF PIC  X(0001).
  3232     05  FILLER REDEFINES PAYTYPBF.
  3233         10  PAYTYPBA PIC  X(0001).
  3234     05  PAYTYPBI PIC  X(0015).
  3235*    -------------------------------
  3236     05  PAYAMTBL PIC S9(0004) COMP.
  3237     05  PAYAMTBF PIC  X(0001).
  3238     05  FILLER REDEFINES PAYAMTBF.
  3239         10  PAYAMTBA PIC  X(0001).
  3240     05  PAYAMTBI PIC  X(0011).
  3241*    -------------------------------
  3242     05  LOANHBL PIC S9(0004) COMP.
  3243     05  LOANHBF PIC  X(0001).
  3244     05  FILLER REDEFINES LOANHBF.
  3245         10  LOANHBA PIC  X(0001).
  3246     05  LOANHBI PIC  X(0012).
  3247*    -------------------------------
  3248     05  LOANNBL PIC S9(0004) COMP.
  3249     05  LOANNBF PIC  X(0001).
  3250     05  FILLER REDEFINES LOANNBF.
  3251         10  LOANNBA PIC  X(0001).
  3252     05  LOANNBI PIC  X(0025).
  3253*    -------------------------------
  3254     05  CKNUMHDL PIC S9(0004) COMP.
  3255     05  CKNUMHDF PIC  X(0001).
  3256     05  FILLER REDEFINES CKNUMHDF.
  3257         10  CKNUMHDA PIC  X(0001).
  3258     05  CKNUMHDI PIC  X(0012).
  3259*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  65
* EL156.cbl
  3260     05  CKNUMBL PIC S9(0004) COMP.
  3261     05  CKNUMBF PIC  X(0001).
  3262     05  FILLER REDEFINES CKNUMBF.
  3263         10  CKNUMBA PIC  X(0001).
  3264     05  CKNUMBI PIC  X(0007).
  3265*    -------------------------------
  3266     05  AGTHDGL PIC S9(0004) COMP.
  3267     05  AGTHDGF PIC  X(0001).
  3268     05  FILLER REDEFINES AGTHDGF.
  3269         10  AGTHDGA PIC  X(0001).
  3270     05  AGTHDGI PIC  X(0016).
  3271*    -------------------------------
  3272     05  NAMEBL PIC S9(0004) COMP.
  3273     05  NAMEBF PIC  X(0001).
  3274     05  FILLER REDEFINES NAMEBF.
  3275         10  NAMEBA PIC  X(0001).
  3276     05  NAMEBI PIC  X(0030).
  3277*    -------------------------------
  3278     05  NAMEB2L PIC S9(0004) COMP.
  3279     05  NAMEB2F PIC  X(0001).
  3280     05  FILLER REDEFINES NAMEB2F.
  3281         10  NAMEB2A PIC  X(0001).
  3282     05  NAMEB2I PIC  X(0030).
  3283*    -------------------------------
  3284     05  ADDR1BL PIC S9(0004) COMP.
  3285     05  ADDR1BF PIC  X(0001).
  3286     05  FILLER REDEFINES ADDR1BF.
  3287         10  ADDR1BA PIC  X(0001).
  3288     05  ADDR1BI PIC  X(0030).
  3289*    -------------------------------
  3290     05  ADDR1B2L PIC S9(0004) COMP.
  3291     05  ADDR1B2F PIC  X(0001).
  3292     05  FILLER REDEFINES ADDR1B2F.
  3293         10  ADDR1B2A PIC  X(0001).
  3294     05  ADDR1B2I PIC  X(0030).
  3295*    -------------------------------
  3296     05  ADDR2BL PIC S9(0004) COMP.
  3297     05  ADDR2BF PIC  X(0001).
  3298     05  FILLER REDEFINES ADDR2BF.
  3299         10  ADDR2BA PIC  X(0001).
  3300     05  ADDR2BI PIC  X(0030).
  3301*    -------------------------------
  3302     05  ADDR2B2L PIC S9(0004) COMP.
  3303     05  ADDR2B2F PIC  X(0001).
  3304     05  FILLER REDEFINES ADDR2B2F.
  3305         10  ADDR2B2A PIC  X(0001).
  3306     05  ADDR2B2I PIC  X(0030).
  3307*    -------------------------------
  3308     05  CITYSTBL PIC S9(0004) COMP.
  3309     05  CITYSTBF PIC  X(0001).
  3310     05  FILLER REDEFINES CITYSTBF.
  3311         10  CITYSTBA PIC  X(0001).
  3312     05  CITYSTBI PIC  X(0030).
  3313*    -------------------------------
  3314     05  CITYST2L PIC S9(0004) COMP.
  3315     05  CITYST2F PIC  X(0001).
  3316     05  FILLER REDEFINES CITYST2F.
  3317         10  CITYST2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  66
* EL156.cbl
  3318     05  CITYST2I PIC  X(0030).
  3319*    -------------------------------
  3320     05  ZIPBL PIC S9(0004) COMP.
  3321     05  ZIPBF PIC  X(0001).
  3322     05  FILLER REDEFINES ZIPBF.
  3323         10  ZIPBA PIC  X(0001).
  3324     05  ZIPBI PIC  X(0009).
  3325*    -------------------------------
  3326     05  ZIPB2L PIC S9(0004) COMP.
  3327     05  ZIPB2F PIC  X(0001).
  3328     05  FILLER REDEFINES ZIPB2F.
  3329         10  ZIPB2A PIC  X(0001).
  3330     05  ZIPB2I PIC  X(0009).
  3331*    -------------------------------
  3332     05  INTHDBL PIC S9(0004) COMP.
  3333     05  INTHDBF PIC  X(0001).
  3334     05  FILLER REDEFINES INTHDBF.
  3335         10  INTHDBA PIC  X(0001).
  3336     05  INTHDBI PIC  X(0012).
  3337*    -------------------------------
  3338     05  INTAMTBL PIC S9(0004) COMP.
  3339     05  INTAMTBF PIC  X(0001).
  3340     05  FILLER REDEFINES INTAMTBF.
  3341         10  INTAMTBA PIC  X(0001).
  3342     05  INTAMTBI PIC  X(0011).
  3343*    -------------------------------
  3344     05  PMTHDGBL PIC S9(0004) COMP.
  3345     05  PMTHDGBF PIC  X(0001).
  3346     05  FILLER REDEFINES PMTHDGBF.
  3347         10  PMTHDGBA PIC  X(0001).
  3348     05  PMTHDGBI PIC  X(0034).
  3349*    -------------------------------
  3350     05  CLMNOBL PIC S9(0004) COMP.
  3351     05  CLMNOBF PIC  X(0001).
  3352     05  FILLER REDEFINES CLMNOBF.
  3353         10  CLMNOBA PIC  X(0001).
  3354     05  CLMNOBI PIC  X(0007).
  3355*    -------------------------------
  3356     05  CARRBL PIC S9(0004) COMP.
  3357     05  CARRBF PIC  X(0001).
  3358     05  FILLER REDEFINES CARRBF.
  3359         10  CARRBA PIC  X(0001).
  3360     05  CARRBI PIC  X(0001).
  3361*    -------------------------------
  3362     05  CERTNOBL PIC S9(0004) COMP.
  3363     05  CERTNOBF PIC  X(0001).
  3364     05  FILLER REDEFINES CERTNOBF.
  3365         10  CERTNOBA PIC  X(0001).
  3366     05  CERTNOBI PIC  X(0010).
  3367*    -------------------------------
  3368     05  SUFXBL PIC S9(0004) COMP.
  3369     05  SUFXBF PIC  X(0001).
  3370     05  FILLER REDEFINES SUFXBF.
  3371         10  SUFXBA PIC  X(0001).
  3372     05  SUFXBI PIC  X(0001).
  3373*    -------------------------------
  3374     05  CLMTYPBL PIC S9(0004) COMP.
  3375     05  CLMTYPBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  67
* EL156.cbl
  3376     05  FILLER REDEFINES CLMTYPBF.
  3377         10  CLMTYPBA PIC  X(0001).
  3378     05  CLMTYPBI PIC  X(0006).
  3379*    -------------------------------
  3380     05  INCURBL PIC S9(0004) COMP.
  3381     05  INCURBF PIC  X(0001).
  3382     05  FILLER REDEFINES INCURBF.
  3383         10  INCURBA PIC  X(0001).
  3384     05  INCURBI PIC  X(0008).
  3385*    -------------------------------
  3386     05  PYFROMBL PIC S9(0004) COMP.
  3387     05  PYFROMBF PIC  X(0001).
  3388     05  FILLER REDEFINES PYFROMBF.
  3389         10  PYFROMBA PIC  X(0001).
  3390     05  PYFROMBI PIC  X(0008).
  3391*    -------------------------------
  3392     05  PYTHRUBL PIC S9(0004) COMP.
  3393     05  PYTHRUBF PIC  X(0001).
  3394     05  FILLER REDEFINES PYTHRUBF.
  3395         10  PYTHRUBA PIC  X(0001).
  3396     05  PYTHRUBI PIC  X(0008).
  3397*    -------------------------------
  3398     05  DAYSBL PIC S9(0004) COMP.
  3399     05  DAYSBF PIC  X(0001).
  3400     05  FILLER REDEFINES DAYSBF.
  3401         10  DAYSBA PIC  X(0001).
  3402     05  DAYSBI PIC  X(0005).
  3403*    -------------------------------
  3404     05  BYBL PIC S9(0004) COMP.
  3405     05  BYBF PIC  X(0001).
  3406     05  FILLER REDEFINES BYBF.
  3407         10  BYBA PIC  X(0001).
  3408     05  BYBI PIC  X(0004).
  3409*    -------------------------------
  3410     05  PROOFDBL PIC S9(0004) COMP.
  3411     05  PROOFDBF PIC  X(0001).
  3412     05  FILLER REDEFINES PROOFDBF.
  3413         10  PROOFDBA PIC  X(0001).
  3414     05  PROOFDBI PIC  X(0008).
  3415*    -------------------------------
  3416     05  ACCTBL PIC S9(0004) COMP.
  3417     05  ACCTBF PIC  X(0001).
  3418     05  FILLER REDEFINES ACCTBF.
  3419         10  ACCTBA PIC  X(0001).
  3420     05  ACCTBI PIC  X(0010).
  3421*    -------------------------------
  3422     05  STATEBL PIC S9(0004) COMP.
  3423     05  STATEBF PIC  X(0001).
  3424     05  FILLER REDEFINES STATEBF.
  3425         10  STATEBA PIC  X(0001).
  3426     05  STATEBI PIC  X(0002).
  3427*    -------------------------------
  3428     05  GROUPBL PIC S9(0004) COMP.
  3429     05  GROUPBF PIC  X(0001).
  3430     05  FILLER REDEFINES GROUPBF.
  3431         10  GROUPBA PIC  X(0001).
  3432     05  GROUPBI PIC  X(0006).
  3433*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  68
* EL156.cbl
  3434     05  ACARRBL PIC S9(0004) COMP.
  3435     05  ACARRBF PIC  X(0001).
  3436     05  FILLER REDEFINES ACARRBF.
  3437         10  ACARRBA PIC  X(0001).
  3438     05  ACARRBI PIC  X(0001).
  3439*    -------------------------------
  3440     05  ACCTNMBL PIC S9(0004) COMP.
  3441     05  ACCTNMBF PIC  X(0001).
  3442     05  FILLER REDEFINES ACCTNMBF.
  3443         10  ACCTNMBA PIC  X(0001).
  3444     05  ACCTNMBI PIC  X(0030).
  3445*    -------------------------------
  3446     05  UNDISBL PIC S9(0004) COMP.
  3447     05  UNDISBF PIC  X(0001).
  3448     05  FILLER REDEFINES UNDISBF.
  3449         10  UNDISBA PIC  X(0001).
  3450     05  UNDISBI PIC  X(0010).
  3451*    -------------------------------
  3452     05  RATEBL PIC S9(0004) COMP.
  3453     05  RATEBF PIC  X(0001).
  3454     05  FILLER REDEFINES RATEBF.
  3455         10  RATEBA PIC  X(0001).
  3456     05  RATEBI PIC  X(0006).
  3457*    -------------------------------
  3458     05  ERMSG1BL PIC S9(0004) COMP.
  3459     05  ERMSG1BF PIC  X(0001).
  3460     05  FILLER REDEFINES ERMSG1BF.
  3461         10  ERMSG1BA PIC  X(0001).
  3462     05  ERMSG1BI PIC  X(0072).
  3463*    -------------------------------
  3464     05  ENTPFBL PIC S9(0004) COMP.
  3465     05  ENTPFBF PIC  X(0001).
  3466     05  FILLER REDEFINES ENTPFBF.
  3467         10  ENTPFBA PIC  X(0001).
  3468     05  ENTPFBI PIC  99.
  3469 01  EL156BO REDEFINES EL156AI.
  3470     05  FILLER            PIC  X(0012).
  3471*    -------------------------------
  3472     05  FILLER            PIC  X(0003).
  3473     05  RUNDTEBO PIC  X(0008).
  3474*    -------------------------------
  3475     05  FILLER            PIC  X(0003).
  3476     05  RUNTIMBO PIC  99.99.
  3477*    -------------------------------
  3478     05  FILLER            PIC  X(0003).
  3479     05  PAYDTBO PIC  99B99B99.
  3480*    -------------------------------
  3481     05  FILLER            PIC  X(0003).
  3482     05  PAYTYPBO PIC  X(0015).
  3483*    -------------------------------
  3484     05  FILLER            PIC  X(0003).
  3485     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3486*    -------------------------------
  3487     05  FILLER            PIC  X(0003).
  3488     05  LOANHBO PIC  X(0012).
  3489*    -------------------------------
  3490     05  FILLER            PIC  X(0003).
  3491     05  LOANNBO PIC  X(0025).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  69
* EL156.cbl
  3492*    -------------------------------
  3493     05  FILLER            PIC  X(0003).
  3494     05  CKNUMHDO PIC  X(0012).
  3495*    -------------------------------
  3496     05  FILLER            PIC  X(0003).
  3497     05  CKNUMBO PIC  X(0007).
  3498*    -------------------------------
  3499     05  FILLER            PIC  X(0003).
  3500     05  AGTHDGO PIC  X(0016).
  3501*    -------------------------------
  3502     05  FILLER            PIC  X(0003).
  3503     05  NAMEBO PIC  X(0030).
  3504*    -------------------------------
  3505     05  FILLER            PIC  X(0003).
  3506     05  NAMEB2O PIC  X(0030).
  3507*    -------------------------------
  3508     05  FILLER            PIC  X(0003).
  3509     05  ADDR1BO PIC  X(0030).
  3510*    -------------------------------
  3511     05  FILLER            PIC  X(0003).
  3512     05  ADDR1B2O PIC  X(0030).
  3513*    -------------------------------
  3514     05  FILLER            PIC  X(0003).
  3515     05  ADDR2BO PIC  X(0030).
  3516*    -------------------------------
  3517     05  FILLER            PIC  X(0003).
  3518     05  ADDR2B2O PIC  X(0030).
  3519*    -------------------------------
  3520     05  FILLER            PIC  X(0003).
  3521     05  CITYSTBO PIC  X(0030).
  3522*    -------------------------------
  3523     05  FILLER            PIC  X(0003).
  3524     05  CITYST2O PIC  X(0030).
  3525*    -------------------------------
  3526     05  FILLER            PIC  X(0003).
  3527     05  ZIPBO PIC  ZZZZ99999.
  3528*    -------------------------------
  3529     05  FILLER            PIC  X(0003).
  3530     05  ZIPB2O PIC  ZZZZZZZZZ.
  3531*    -------------------------------
  3532     05  FILLER            PIC  X(0003).
  3533     05  INTHDBO PIC  X(0012).
  3534*    -------------------------------
  3535     05  FILLER            PIC  X(0003).
  3536     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3537*    -------------------------------
  3538     05  FILLER            PIC  X(0003).
  3539     05  PMTHDGBO PIC  X(0034).
  3540*    -------------------------------
  3541     05  FILLER            PIC  X(0003).
  3542     05  CLMNOBO PIC  X(0007).
  3543*    -------------------------------
  3544     05  FILLER            PIC  X(0003).
  3545     05  CARRBO PIC  X(0001).
  3546*    -------------------------------
  3547     05  FILLER            PIC  X(0003).
  3548     05  CERTNOBO PIC  X(0010).
  3549*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  70
* EL156.cbl
  3550     05  FILLER            PIC  X(0003).
  3551     05  SUFXBO PIC  X(0001).
  3552*    -------------------------------
  3553     05  FILLER            PIC  X(0003).
  3554     05  CLMTYPBO PIC  X(0006).
  3555*    -------------------------------
  3556     05  FILLER            PIC  X(0003).
  3557     05  INCURBO PIC  X(0008).
  3558*    -------------------------------
  3559     05  FILLER            PIC  X(0003).
  3560     05  PYFROMBO PIC  99B99B99.
  3561*    -------------------------------
  3562     05  FILLER            PIC  X(0003).
  3563     05  PYTHRUBO PIC  99B99B99.
  3564*    -------------------------------
  3565     05  FILLER            PIC  X(0003).
  3566     05  DAYSBO PIC  X(0005).
  3567*    -------------------------------
  3568     05  FILLER            PIC  X(0003).
  3569     05  BYBO PIC  X(0004).
  3570*    -------------------------------
  3571     05  FILLER            PIC  X(0003).
  3572     05  PROOFDBO PIC  99B99B99.
  3573*    -------------------------------
  3574     05  FILLER            PIC  X(0003).
  3575     05  ACCTBO PIC  X(0010).
  3576*    -------------------------------
  3577     05  FILLER            PIC  X(0003).
  3578     05  STATEBO PIC  X(0002).
  3579*    -------------------------------
  3580     05  FILLER            PIC  X(0003).
  3581     05  GROUPBO PIC  X(0006).
  3582*    -------------------------------
  3583     05  FILLER            PIC  X(0003).
  3584     05  ACARRBO PIC  X(0001).
  3585*    -------------------------------
  3586     05  FILLER            PIC  X(0003).
  3587     05  ACCTNMBO PIC  X(0030).
  3588*    -------------------------------
  3589     05  FILLER            PIC  X(0003).
  3590     05  UNDISBO PIC  ZZZ,Z99.99.
  3591*    -------------------------------
  3592     05  FILLER            PIC  X(0003).
  3593     05  RATEBO PIC  ZZZ.99.
  3594*    -------------------------------
  3595     05  FILLER            PIC  X(0003).
  3596     05  ERMSG1BO PIC  X(0072).
  3597*    -------------------------------
  3598     05  FILLER            PIC  X(0003).
  3599     05  ENTPFBO PIC  X(0002).
  3600*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  71
* EL156.cbl
  3602****************************************************************
  3603*
  3604* Copyright (c) 2007 by Clerity Solutions, Inc.
  3605* All rights reserved.
  3606*
  3607****************************************************************
  3608 01  DFHEIV.
  3609   02  DFHEIV0               PIC X(35).
  3610   02  DFHEIV1               PIC X(08).
  3611   02  DFHEIV2               PIC X(08).
  3612   02  DFHEIV3               PIC X(08).
  3613   02  DFHEIV4               PIC X(06).
  3614   02  DFHEIV5               PIC X(04).
  3615   02  DFHEIV6               PIC X(04).
  3616   02  DFHEIV7               PIC X(02).
  3617   02  DFHEIV8               PIC X(02).
  3618   02  DFHEIV9               PIC X(01).
  3619   02  DFHEIV10              PIC S9(7) COMP-3.
  3620   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3621   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3622   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3623   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3624   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3625   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3626   02  DFHEIV17              PIC X(04).
  3627   02  DFHEIV18              PIC X(04).
  3628   02  DFHEIV19              PIC X(04).
  3629   02  DFHEIV20              USAGE IS POINTER.
  3630   02  DFHEIV21              USAGE IS POINTER.
  3631   02  DFHEIV22              USAGE IS POINTER.
  3632   02  DFHEIV23              USAGE IS POINTER.
  3633   02  DFHEIV24              USAGE IS POINTER.
  3634   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3635   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3636   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3637   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3638   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3639   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3640   02  FILLER                PIC X(02).
  3641   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3642   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3643   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3644   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3645   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3646 LINKAGE  SECTION.
  3647*****************************************************************
  3648*                                                               *
  3649* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3650* All rights reserved.                                          *
  3651*                                                               *
  3652*****************************************************************
  3653 01  dfheiblk.
  3654     02  eibtime          pic s9(7) comp-3.
  3655     02  eibdate          pic s9(7) comp-3.
  3656     02  eibtrnid         pic x(4).
  3657     02  eibtaskn         pic s9(7) comp-3.
  3658     02  eibtrmid         pic x(4).
  3659     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  72
* EL156.cbl
  3660     02  eibcposn         pic s9(4) comp.
  3661     02  eibcalen         pic s9(4) comp.
  3662     02  eibaid           pic x(1).
  3663     02  eibfiller1       pic x(1).
  3664     02  eibfn            pic x(2).
  3665     02  eibfiller2       pic x(2).
  3666     02  eibrcode         pic x(6).
  3667     02  eibfiller3       pic x(2).
  3668     02  eibds            pic x(8).
  3669     02  eibreqid         pic x(8).
  3670     02  eibrsrce         pic x(8).
  3671     02  eibsync          pic x(1).
  3672     02  eibfree          pic x(1).
  3673     02  eibrecv          pic x(1).
  3674     02  eibsend          pic x(1).
  3675     02  eibatt           pic x(1).
  3676     02  eibeoc           pic x(1).
  3677     02  eibfmh           pic x(1).
  3678     02  eibcompl         pic x(1).
  3679     02  eibsig           pic x(1).
  3680     02  eibconf          pic x(1).
  3681     02  eiberr           pic x(1).
  3682     02  eibrldbk         pic x(1).
  3683     02  eiberrcd         pic x(4).
  3684     02  eibsynrb         pic x(1).
  3685     02  eibnodat         pic x(1).
  3686     02  eibfiller5       pic x(2).
  3687     02  eibresp          pic 9(09) comp.
  3688     02  eibresp2         pic 9(09) comp.
  3689     02  dfheigdj         pic s9(4) comp.
  3690     02  dfheigdk         pic s9(4) comp.
  3691 01  DFHCOMMAREA             PIC X(1024).
  3692
  3693*    COPY ELCMSTR.
  3694******************************************************************
  3695*                                                                *
  3696*                            ELCMSTR.                            *
  3697*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3698*                            VMOD=2.012                          *
  3699*                                                                *
  3700*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3701*                                                                *
  3702*   FILE TYPE = VSAM,KSDS                                        *
  3703*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3704*                                                                *
  3705*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3706*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3707*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3708*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3709*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3710*                                                 RKP=75,LEN=21  *
  3711*                                                                *
  3712*   **** NOTE ****                                               *
  3713*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3714*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3715*                                                                *
  3716*   LOG = YES                                                    *
  3717*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  73
* EL156.cbl
  3718******************************************************************
  3719*                   C H A N G E   L O G
  3720*
  3721* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3722*-----------------------------------------------------------------
  3723*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3724* EFFECTIVE    NUMBER
  3725*-----------------------------------------------------------------
  3726* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3727* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3728******************************************************************
  3729 01  CLAIM-MASTER.
  3730     12  CL-RECORD-ID                PIC XX.
  3731         88  VALID-CL-ID         VALUE 'CL'.
  3732
  3733     12  CL-CONTROL-PRIMARY.
  3734         16  CL-COMPANY-CD           PIC X.
  3735         16  CL-CARRIER              PIC X.
  3736         16  CL-CLAIM-NO             PIC X(7).
  3737         16  CL-CERT-NO.
  3738             20  CL-CERT-PRIME       PIC X(10).
  3739             20  CL-CERT-SFX         PIC X.
  3740
  3741     12  CL-CONTROL-BY-NAME.
  3742         16  CL-COMPANY-CD-A1        PIC X.
  3743         16  CL-INSURED-LAST-NAME    PIC X(15).
  3744         16  CL-INSURED-NAME.
  3745             20  CL-INSURED-1ST-NAME PIC X(12).
  3746             20  CL-INSURED-MID-INIT PIC X.
  3747
  3748     12  CL-CONTROL-BY-SSN.
  3749         16  CL-COMPANY-CD-A2        PIC X.
  3750         16  CL-SOC-SEC-NO.
  3751             20  CL-SSN-STATE        PIC XX.
  3752             20  CL-SSN-ACCOUNT      PIC X(6).
  3753             20  CL-SSN-LN3          PIC X(3).
  3754
  3755     12  CL-CONTROL-BY-CERT-NO.
  3756         16  CL-COMPANY-CD-A4        PIC X.
  3757         16  CL-CERT-NO-A4.
  3758             20  CL-CERT-A4-PRIME    PIC X(10).
  3759             20  CL-CERT-A4-SFX      PIC X.
  3760
  3761     12  CL-CONTROL-BY-CCN.
  3762         16  CL-COMPANY-CD-A5        PIC X.
  3763         16  CL-CCN-A5.
  3764             20  CL-CCN.
  3765                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3766                 24  CL-CCN-PRIME-A5 PIC X(12).
  3767             20  CL-CCN-FILLER-A5    PIC X(4).
  3768
  3769     12  CL-INSURED-PROFILE-DATA.
  3770         16  CL-INSURED-BIRTH-DT     PIC XX.
  3771         16  CL-INSURED-SEX-CD       PIC X.
  3772             88  INSURED-IS-MALE        VALUE 'M'.
  3773             88  INSURED-IS-FEMALE      VALUE 'F'.
  3774             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3775         16  CL-INSURED-OCC-CD       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  74
* EL156.cbl
  3776         16  FILLER                  PIC X(5).
  3777
  3778     12  CL-PROCESSING-INFO.
  3779         16  CL-PROCESSOR-ID         PIC X(4).
  3780         16  CL-CLAIM-STATUS         PIC X.
  3781             88  CLAIM-IS-OPEN          VALUE 'O'.
  3782             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3783         16  CL-CLAIM-TYPE           PIC X.
  3784*            88  AH-CLAIM               VALUE 'A'.
  3785*            88  LIFE-CLAIM             VALUE 'L'.
  3786*            88  PROPERTY-CLAIM         VALUE 'P'.
  3787*            88  IUI-CLAIM              VALUE 'I'.
  3788*            88  GAP-CLAIM              VALUE 'G'.
  3789         16  CL-CLAIM-PREM-TYPE      PIC X.
  3790             88  SINGLE-PREMIUM         VALUE '1'.
  3791             88  O-B-COVERAGE           VALUE '2'.
  3792             88  OPEN-END-COVERAGE      VALUE '3'.
  3793         16  CL-INCURRED-DT          PIC XX.
  3794         16  CL-REPORTED-DT          PIC XX.
  3795         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3796         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3797         16  CL-LAST-PMT-DT          PIC XX.
  3798         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3799         16  CL-PAID-THRU-DT         PIC XX.
  3800         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3801         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3802         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3803         16  CL-PMT-CALC-METHOD      PIC X.
  3804             88  CL-360-DAY-YR          VALUE '1'.
  3805             88  CL-365-DAY-YR          VALUE '2'.
  3806             88  CL-FULL-MONTHS         VALUE '3'.
  3807         16  CL-CAUSE-CD             PIC X(6).
  3808
  3809         16  CL-PRIME-CERT-NO.
  3810             20  CL-PRIME-CERT-PRIME PIC X(10).
  3811             20  CL-PRIME-CERT-SFX   PIC X.
  3812
  3813         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3814             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3815             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3816
  3817         16  CL-MICROFILM-NO         PIC X(10).
  3818         16  CL-PROG-FORM-TYPE       PIC X.
  3819         16  CL-LAST-ADD-ON-DT       PIC XX.
  3820
  3821         16  CL-LAST-REOPEN-DT       PIC XX.
  3822         16  CL-LAST-CLOSE-DT        PIC XX.
  3823         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3824             88  FINAL-PAID             VALUE '1'.
  3825             88  CLAIM-DENIED           VALUE '2'.
  3826             88  AUTO-CLOSE             VALUE '3'.
  3827             88  MANUAL-CLOSE           VALUE '4'.
  3828             88  BENEFITS-CHANGED       VALUE 'C'.
  3829             88  SETUP-ERRORS           VALUE 'E'.
  3830         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3831         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3832         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3833             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  75
* EL156.cbl
  3834         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3835         16  FILLER                  PIC X.
  3836
  3837     12  CL-CERTIFICATE-DATA.
  3838         16  CL-CERT-ORIGIN          PIC X.
  3839             88  CERT-WAS-ONLINE        VALUE '1'.
  3840             88  CERT-WAS-CREATED       VALUE '2'.
  3841             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3842         16  CL-CERT-KEY-DATA.
  3843             20  CL-CERT-CARRIER     PIC X.
  3844             20  CL-CERT-GROUPING    PIC X(6).
  3845             20  CL-CERT-STATE       PIC XX.
  3846             20  CL-CERT-ACCOUNT.
  3847                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3848                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3849             20  CL-CERT-EFF-DT      PIC XX.
  3850
  3851     12  CL-STATUS-CONTROLS.
  3852         16  CL-PRIORITY-CD          PIC X.
  3853             88  CONFIDENTIAL-DATA      VALUE '8'.
  3854             88  HIGHEST-PRIORITY       VALUE '9'.
  3855         16  CL-SUPV-ATTN-CD         PIC X.
  3856             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3857             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3858         16  CL-PURGED-DT            PIC XX.
  3859         16  CL-RESTORED-DT          PIC XX.
  3860         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3861         16  CL-NEXT-RESEND-DT       PIC XX.
  3862         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3863         16  FILLER                  PIC XX.
  3864         16  CL-LAST-MAINT-DT        PIC XX.
  3865         16  CL-LAST-MAINT-USER      PIC X(4).
  3866         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3867         16  CL-LAST-MAINT-TYPE      PIC X.
  3868             88  CLAIM-SET-UP           VALUE ' '.
  3869             88  PAYMENT-MADE           VALUE '1'.
  3870             88  LETTER-SENT            VALUE '2'.
  3871             88  MASTER-WAS-ALTERED     VALUE '3'.
  3872             88  MASTER-WAS-RESTORED    VALUE '4'.
  3873             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3874             88  FILE-CONVERTED         VALUE '6'.
  3875             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3876             88  ERROR-CORRECTION       VALUE 'E'.
  3877         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3878         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3879         16  CL-BENEFICIARY          PIC X(10).
  3880         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3881         16  CL-DENIAL-TYPE          PIC X.
  3882             88  CL-TYPE-DENIAL          VALUE '1'.
  3883             88  CL-TYPE-RESCISSION      VALUE '2'.
  3884             88  CL-TYPE-REFORMATION     VALUE '3'.
  3885             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3886             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3887         16  FILLER                  PIC X(5).
  3888
  3889     12  CL-TRAILER-CONTROLS.
  3890         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3891             88  CL-1ST-TRL-AVAIL       VALUE +4095.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  76
* EL156.cbl
  3892             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3893             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3894         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3895         16  FILLER                  PIC XX.
  3896         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3897         16  CL-ADDRESS-TRAILER-CNT.
  3898             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3899                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3900             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3901                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3902             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3903                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3904             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3905                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3906             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3907                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3908             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3909                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3910             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3911                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3912
  3913     12  CL-CV-REFERENCE-NO.
  3914         16  CL-CV-REFNO-PRIME       PIC X(18).
  3915         16  CL-CV-REFNO-SFX         PIC XX.
  3916
  3917     12  CL-FILE-LOCATION            PIC X(4).
  3918
  3919     12  CL-PROCESS-ERRORS.
  3920         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3921             88  NO-FATAL-ERRORS        VALUE ZERO.
  3922         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3923             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3924
  3925     12  CL-PRODUCT-CD               PIC X.
  3926
  3927     12  CL-CURRENT-KEY-DATA.
  3928         16  CL-CURRENT-CARRIER      PIC X.
  3929         16  CL-CURRENT-GROUPING     PIC X(6).
  3930         16  CL-CURRENT-STATE        PIC XX.
  3931         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3932
  3933     12  CL-ASSOCIATES               PIC X.
  3934         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3935         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3936         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3937         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3938
  3939     12  CL-ACTIVITY-CODE            PIC 99.
  3940     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3941     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3942
  3943     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3944     12  CL-LAG-REPORT-CODE          PIC 9.
  3945     12  CL-LOAN-TYPE                PIC XX.
  3946     12  CL-LEGAL-STATE              PIC XX.
  3947
  3948*    12  FILLER                      PIC X(5).
  3949     12  CL-YESNOSW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  77
* EL156.cbl
  3950     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  78
* EL156.cbl
  3952*    COPY ELCCNTL.
  3953******************************************************************
  3954*                                                                *
  3955*                                                                *
  3956*                            ELCCNTL.                            *
  3957*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3958*                            VMOD=2.059                          *
  3959*                                                                *
  3960*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3961*                                                                *
  3962*   FILE TYPE = VSAM,KSDS                                        *
  3963*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3964*                                                                *
  3965*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3966*       ALTERNATE INDEX = NONE                                   *
  3967*                                                                *
  3968*   LOG = YES                                                    *
  3969*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3970******************************************************************
  3971*                   C H A N G E   L O G
  3972*
  3973* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3974*-----------------------------------------------------------------
  3975*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3976* EFFECTIVE    NUMBER
  3977*-----------------------------------------------------------------
  3978* 082503                   PEMA  ADD BENEFIT GROUP
  3979* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3980* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3981* 092705    2005050300006  PEMA  ADD SPP LEASES
  3982* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3983* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3984* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3985* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3986* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3987* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3988* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3989* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3990******************************************************************
  3991*
  3992 01  CONTROL-FILE.
  3993     12  CF-RECORD-ID                       PIC XX.
  3994         88  VALID-CF-ID                        VALUE 'CF'.
  3995
  3996     12  CF-CONTROL-PRIMARY.
  3997         16  CF-COMPANY-ID                  PIC XXX.
  3998         16  CF-RECORD-TYPE                 PIC X.
  3999             88  CF-COMPANY-MASTER              VALUE '1'.
  4000             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4001             88  CF-STATE-MASTER                VALUE '3'.
  4002             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4003             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4004             88  CF-CARRIER-MASTER              VALUE '6'.
  4005             88  CF-MORTALITY-MASTER            VALUE '7'.
  4006             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4007             88  CF-TERMINAL-MASTER             VALUE '9'.
  4008             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4009             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  79
* EL156.cbl
  4010             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4011             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4012             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4013             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4014             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4015             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4016             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4017         16  CF-ACCESS-CD-GENL              PIC X(4).
  4018         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4019             20  CF-PROCESSOR               PIC X(4).
  4020         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4021             20  CF-STATE-CODE              PIC XX.
  4022             20  FILLER                     PIC XX.
  4023         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4024             20  FILLER                     PIC XX.
  4025             20  CF-HI-BEN-IN-REC           PIC XX.
  4026         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4027             20  FILLER                     PIC XXX.
  4028             20  CF-CARRIER-CNTL            PIC X.
  4029         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4030             20  FILLER                     PIC XX.
  4031             20  CF-HI-TYPE-IN-REC          PIC 99.
  4032         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4033             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4034                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4035             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4036             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4037         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4038             20  FILLER                     PIC X.
  4039             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4040         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4041             20  FILLER                     PIC XX.
  4042             20  CF-MORTGAGE-PLAN           PIC XX.
  4043         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4044
  4045     12  CF-LAST-MAINT-DT                   PIC XX.
  4046     12  CF-LAST-MAINT-BY                   PIC X(4).
  4047     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4048
  4049     12  CF-RECORD-BODY                     PIC X(728).
  4050
  4051
  4052****************************************************************
  4053*             COMPANY MASTER RECORD                            *
  4054****************************************************************
  4055
  4056     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4057         16  CF-COMPANY-ADDRESS.
  4058             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4059             20  CF-CL-IN-CARE-OF           PIC X(30).
  4060             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4061             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4062             20  CF-CL-CITY-STATE           PIC X(30).
  4063             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4064             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4065         16  CF-COMPANY-CD                  PIC X.
  4066         16  CF-COMPANY-PASSWORD            PIC X(8).
  4067         16  CF-SECURITY-OPTION             PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  80
* EL156.cbl
  4068             88  ALL-SECURITY                   VALUE '1'.
  4069             88  COMPANY-VERIFY                 VALUE '2'.
  4070             88  PROCESSOR-VERIFY               VALUE '3'.
  4071             88  NO-SECURITY                    VALUE '4'.
  4072             88  ALL-BUT-TERM                   VALUE '5'.
  4073         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4074             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4075         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4076             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4077         16  CF-INFORCE-LOCATION            PIC X.
  4078             88  CERTS-ARE-ONLINE               VALUE '1'.
  4079             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4080             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4081         16  CF-LOWER-CASE-LETTERS          PIC X.
  4082         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4083             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4084             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4085             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4086             88  CF-ACCNT-CNTL                  VALUE '3'.
  4087             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4088
  4089         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4090         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4091
  4092         16  CF-LGX-CREDIT-USER             PIC X.
  4093             88  CO-IS-NOT-USER                 VALUE 'N'.
  4094             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4095
  4096         16 CF-CREDIT-CALC-CODES.
  4097             20  CF-CR-REM-TERM-CALC PIC X.
  4098               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4099               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4100               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4101               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4102               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4103               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4104               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4105             20  CF-CR-R78-METHOD           PIC X.
  4106               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4107               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4108
  4109         16  CF-CLAIM-CONTROL-COUNTS.
  4110             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4111                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4112
  4113             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4114                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4115
  4116             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4117                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4118
  4119             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4120                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4121
  4122         16  CF-CURRENT-MONTH-END           PIC XX.
  4123
  4124         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4125             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  81
* EL156.cbl
  4126             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4127             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4128             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4129                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4130                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4131             20  CF-CO-PREM-REJECT-SW       PIC X.
  4132                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4133                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4134             20  CF-CO-REF-REJECT-SW        PIC X.
  4135                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4136                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4137
  4138         16  CF-CO-REPORTING-DT             PIC XX.
  4139         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4140         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4141           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4142           88  CF-CO-MONTH-END                  VALUE '1'.
  4143
  4144         16  CF-LGX-CLAIM-USER              PIC X.
  4145             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4146             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4147
  4148         16  CF-CREDIT-EDIT-CONTROLS.
  4149             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4150             20  CF-MIN-AGE                 PIC 99.
  4151             20  CF-DEFAULT-AGE             PIC 99.
  4152             20  CF-MIN-TERM                PIC S999      COMP-3.
  4153             20  CF-MAX-TERM                PIC S999      COMP-3.
  4154             20  CF-DEFAULT-SEX             PIC X.
  4155             20  CF-JOINT-AGE-INPUT         PIC X.
  4156                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4157             20  CF-BIRTH-DATE-INPUT        PIC X.
  4158                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4159             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4160                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4161                 88  CF-ZERO-CARRIER            VALUE '1'.
  4162                 88  CF-ZERO-GROUPING           VALUE '2'.
  4163                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4164             20  CF-EDIT-SW                 PIC X.
  4165                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4166             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4167             20  CF-CR-PR-METHOD            PIC X.
  4168               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4169               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4170             20  FILLER                     PIC X.
  4171
  4172         16  CF-CREDIT-MISC-CONTROLS.
  4173             20  CF-REIN-TABLE-SW           PIC X.
  4174                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4175             20  CF-COMP-TABLE-SW           PIC X.
  4176                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4177             20  CF-EXPERIENCE-RETENTION-AGE
  4178                                            PIC S9        COMP-3.
  4179             20  CF-CONVERSION-DT           PIC XX.
  4180             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4181             20  CF-RUN-FREQUENCY-SW        PIC X.
  4182                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4183                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  82
* EL156.cbl
  4184
  4185             20  CF-CR-CHECK-NO-CONTROL.
  4186                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4187                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4188                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4189                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4190                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4191                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4192
  4193                 24  CF-CR-CHECK-COUNT       REDEFINES
  4194                     CF-CR-CHECK-COUNTER      PIC X(4).
  4195
  4196                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4197                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4198
  4199                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4200                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4201                 24  CF-MAIL-PROCESSING       PIC X.
  4202                     88  MAIL-PROCESSING          VALUE 'Y'.
  4203
  4204         16  CF-MISC-SYSTEM-CONTROL.
  4205             20  CF-SYSTEM-C                 PIC X.
  4206                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4207             20  CF-SYSTEM-D                 PIC X.
  4208                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4209             20  CF-SOC-SEC-NO-SW            PIC X.
  4210                 88  SOC-SEC-NO-USED             VALUE '1'.
  4211             20  CF-MEMBER-NO-SW             PIC X.
  4212                 88  MEMBER-NO-USED              VALUE '1'.
  4213             20  CF-TAX-ID-NUMBER            PIC X(11).
  4214             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4215             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4216                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4217                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4218                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4219                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4220             20  CF-SYSTEM-E                 PIC X.
  4221                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4222
  4223         16  CF-LGX-LIFE-USER               PIC X.
  4224             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4225             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4226
  4227         16  CF-CR-MONTH-END-DT             PIC XX.
  4228
  4229         16  CF-FILE-MAINT-DATES.
  4230             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4231                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4232             20  CF-LAST-BATCH       REDEFINES
  4233                 CF-LAST-BATCH-NO               PIC X(4).
  4234             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4235             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4236             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4237             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4238             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4239             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4240             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4241             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  83
* EL156.cbl
  4242             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4243             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4244
  4245         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4246         16  FILLER                         PIC X.
  4247
  4248         16  CF-ALT-MORT-CODE               PIC X(4).
  4249         16  CF-MEMBER-CAPTION              PIC X(10).
  4250
  4251         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4252             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4253             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4254             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4255             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4256             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4257
  4258         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4259
  4260         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4261         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4262         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4263         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4264
  4265         16  CF-AH-OVERRIDE-L1              PIC X.
  4266         16  CF-AH-OVERRIDE-L2              PIC XX.
  4267         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4268         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4269
  4270         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4271         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4272
  4273         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4274         16  CF-AR-LAST-EL860-DT            PIC XX.
  4275         16  CF-MP-MONTH-END-DT             PIC XX.
  4276
  4277         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4278         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4279             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4280
  4281         16  CF-AR-MONTH-END-DT             PIC XX.
  4282
  4283         16  CF-CRDTCRD-USER                PIC X.
  4284             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4285             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4286
  4287         16  CF-CC-MONTH-END-DT             PIC XX.
  4288
  4289         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4290
  4291         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4292             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4293             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4294             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4295         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4296         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4297         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4298         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4299             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  84
* EL156.cbl
  4300             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4301         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4302         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4303         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4304             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4305         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4306
  4307         16  CF-CL-ZIP-CODE.
  4308             20  CF-CL-ZIP-PRIME.
  4309                 24  CF-CL-ZIP-1ST          PIC X.
  4310                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4311                 24  FILLER                 PIC X(4).
  4312             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4313         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4314             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4315             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4316             20  FILLER                     PIC XXX.
  4317
  4318         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4319         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4320         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4321         16  CF-CO-OPTION-START-DATE        PIC XX.
  4322         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4323           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4324                                                      '3' '4'.
  4325           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4326           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4327           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4328           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4329           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4330           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4331
  4332         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4333
  4334         16  CF-PAYMENT-APPROVAL-LEVELS.
  4335             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4336             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4337             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4338             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4339             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4340             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4341
  4342         16  CF-END-USER-REPORTING-USER     PIC X.
  4343             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4344             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4345
  4346         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4347             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4348             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4349
  4350         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4351
  4352         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4353         16  FILLER                         PIC X.
  4354
  4355         16  CF-CREDIT-ARCHIVE-CNTL.
  4356             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4357             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  85
* EL156.cbl
  4358             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4359
  4360         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4361
  4362         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4363             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4364             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4365
  4366         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4367             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4368             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4369
  4370         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4371
  4372         16  CF-CO-ACH-ID-CODE              PIC  X.
  4373             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4374             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4375             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4376         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4377         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4378         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4379         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4380         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4381         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4382         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4383         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4384         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4385                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4386         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4387                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4388
  4389         16  CF-CO-OVER-SHORT.
  4390             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4391             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4392
  4393*         16  FILLER                         PIC X(102).
  4394         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4395             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4396             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4397
  4398         16  CF-AH-APPROVAL-DAYS.
  4399             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4400             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4401             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4402             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4403
  4404         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4405
  4406         16  FILLER                         PIC X(79).
  4407****************************************************************
  4408*             PROCESSOR/USER RECORD                            *
  4409****************************************************************
  4410
  4411     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4412         16  CF-PROCESSOR-NAME              PIC X(30).
  4413         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4414         16  CF-PROCESSOR-TITLE             PIC X(26).
  4415         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  86
* EL156.cbl
  4416                 88  MESSAGE-YES                VALUE 'Y'.
  4417                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4418
  4419*****************************************************
  4420****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4421****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4422****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4423****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4424*****************************************************
  4425
  4426         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4427             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4428             20  CF-APPLICATION-FORCE       PIC X.
  4429             20  CF-INDIVIDUAL-APP.
  4430                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4431                     28  CF-BROWSE-APP      PIC X.
  4432                     28  CF-UPDATE-APP      PIC X.
  4433
  4434         16  CF-CURRENT-TERM-ON             PIC X(4).
  4435         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4436             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4437             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4438             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4439             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4440             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4441             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4442             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4443         16  CF-PROCESSOR-CARRIER           PIC X.
  4444             88  NO-CARRIER-SECURITY            VALUE ' '.
  4445         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4446             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4447         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4448             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4449         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4450             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4451
  4452         16  CF-PROC-SYS-ACCESS-SW.
  4453             20  CF-PROC-CREDIT-CLAIMS-SW.
  4454                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4455                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4456                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4457                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4458             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4459                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4460                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4461             20  CF-PROC-LIFE-GNRLDGR-SW.
  4462                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4463                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4464                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4465                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4466             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4467                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4468                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4469         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4470             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4471             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4472         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4473
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  87
* EL156.cbl
  4474         16  CF-APPROVAL-LEVEL                  PIC X.
  4475             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4476             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4477             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4478             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4479
  4480         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4481
  4482         16  CF-LANGUAGE-TYPE                   PIC X.
  4483             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4484             88  CF-LANG-IS-FR                      VALUE 'F'.
  4485
  4486         16  CF-CSR-IND                         PIC X.
  4487         16  FILLER                             PIC X(239).
  4488
  4489****************************************************************
  4490*             PROCESSOR/REMINDERS RECORD                       *
  4491****************************************************************
  4492
  4493     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4494         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4495             20  CF-START-REMIND-DT         PIC XX.
  4496             20  CF-END-REMIND-DT           PIC XX.
  4497             20  CF-REMINDER-TEXT           PIC X(50).
  4498         16  FILLER                         PIC X(296).
  4499
  4500
  4501****************************************************************
  4502*             STATE MASTER RECORD                              *
  4503****************************************************************
  4504
  4505     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4506         16  CF-STATE-ABBREVIATION          PIC XX.
  4507         16  CF-STATE-NAME                  PIC X(25).
  4508         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4509         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4510             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4511             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4512             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4513             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4514                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4515                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4516             20  CF-ST-PREM-REJECT-SW       PIC X.
  4517                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4518                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4519             20  CF-ST-REF-REJECT-SW        PIC X.
  4520                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4521                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4522         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4523         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4524         16  CF-ST-REFUND-RULES.
  4525             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4526             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4527             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4528         16  CF-ST-FST-PMT-EXTENSION.
  4529             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4530             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4531                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  88
* EL156.cbl
  4532                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4533                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4534                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4535         16  CF-ST-STATE-CALL.
  4536             20  CF-ST-CALL-UNEARNED        PIC X.
  4537             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4538             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4539         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4540             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4541             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4542         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4543         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4544         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4545         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4546         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4547         16  FILLER                         PIC X.
  4548         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4549             20  CF-ST-BENEFIT-CD           PIC XX.
  4550             20  CF-ST-BENEFIT-KIND         PIC X.
  4551                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4552                 88  CF-ST-AH-KIND              VALUE 'A'.
  4553             20  CF-ST-REM-TERM-CALC        PIC X.
  4554                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4555                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4556                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4557                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4558                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4559                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4560                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4561                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4562
  4563             20  CF-ST-REFUND-CALC          PIC X.
  4564                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4565                 88  ST-REFD-BY-R78             VALUE '1'.
  4566                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4567                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4568                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4569                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4570                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4571                 88  ST-REFD-UTAH               VALUE '7'.
  4572                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4573                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4574                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4575
  4576             20  CF-ST-EARNING-CALC         PIC X.
  4577                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4578                 88  ST-EARN-BY-R78             VALUE '1'.
  4579                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4580                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4581                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4582                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4583                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4584                 88  ST-EARN-MEAN               VALUE '8'.
  4585                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4586
  4587             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4588                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4589                 88  ST-OVRD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  89
* EL156.cbl
  4590                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4591                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4592                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4593                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4594                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4595                 88  ST-OVRD-MEAN               VALUE '8'.
  4596                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4597             20  FILLER                     PIC X.
  4598
  4599         16  CF-ST-COMMISSION-CAPS.
  4600             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4601             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4602             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4603             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4604         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4605                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4606
  4607         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4608
  4609         16  CF-ST-STATUTORY-INTEREST.
  4610             20  CF-ST-STAT-DATE-FROM       PIC X.
  4611                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4612                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4613             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4614             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4615             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4616             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4617             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4618
  4619         16  CF-ST-OVER-SHORT.
  4620             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4621             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4622
  4623         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4624
  4625         16  CF-ST-RT-CALC                  PIC X.
  4626
  4627         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4628         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4629         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4630         16  CF-ST-RF-LR-CALC               PIC X.
  4631         16  CF-ST-RF-LL-CALC               PIC X.
  4632         16  CF-ST-RF-LN-CALC               PIC X.
  4633         16  CF-ST-RF-AH-CALC               PIC X.
  4634         16  CF-ST-RF-CP-CALC               PIC X.
  4635*        16  FILLER                         PIC X(206).
  4636*CIDMOD         16  FILLER                         PIC X(192).
  4637         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4638             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4639         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4640         16  CF-ST-VFY-2ND-BENE             PIC X.
  4641         16  CF-ST-CAUSAL-STATE             PIC X.
  4642         16  FILLER                         PIC X(185).
  4643
  4644****************************************************************
  4645*             BENEFIT MASTER RECORD                            *
  4646****************************************************************
  4647
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  90
* EL156.cbl
  4648     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4649         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4650             20  CF-BENEFIT-CODE            PIC XX.
  4651             20  CF-BENEFIT-NUMERIC  REDEFINES
  4652                 CF-BENEFIT-CODE            PIC XX.
  4653             20  CF-BENEFIT-ALPHA           PIC XXX.
  4654             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4655             20  CF-BENEFIT-COMMENT         PIC X(10).
  4656
  4657             20  CF-LF-COVERAGE-TYPE        PIC X.
  4658                 88  CF-REDUCING                VALUE 'R'.
  4659                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4660
  4661             20  CF-SPECIAL-CALC-CD         PIC X.
  4662                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4663                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4664                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4665                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4666                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4667                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4668                 88  CF-FARM-PLAN               VALUE 'F'.
  4669                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4670                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4671                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4672                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4673                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4674                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4675                 88  CF-PRUDENTIAL              VALUE 'P'.
  4676                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4677                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4678                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4679                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4680                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4681                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4682
  4683             20  CF-JOINT-INDICATOR         PIC X.
  4684                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4685
  4686*            20  FILLER                     PIC X(12).
  4687             20  FILLER                     PIC X(11).
  4688             20  CF-BENEFIT-CATEGORY        PIC X.
  4689             20  CF-LOAN-TYPE               PIC X(8).
  4690
  4691             20  CF-CO-REM-TERM-CALC        PIC X.
  4692                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4693                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4694                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4695                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4696                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4697
  4698             20  CF-CO-EARNINGS-CALC        PIC X.
  4699                 88  CO-EARN-BY-R78             VALUE '1'.
  4700                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4701                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4702                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4703                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4704                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4705                 88  CO-EARN-AS-MEAN            VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  91
* EL156.cbl
  4706                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4707
  4708             20  CF-CO-REFUND-CALC          PIC X.
  4709                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4710                 88  CO-REFD-BY-R78             VALUE '1'.
  4711                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4712                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4713                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4714                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4715                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4716                 88  CO-REFD-MEAN               VALUE '8'.
  4717                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4718                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4719                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4720
  4721             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4722                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4723                 88  CO-OVRD-BY-R78             VALUE '1'.
  4724                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4725                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4726                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4727                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4728                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4729                 88  CO-OVRD-MEAN               VALUE '8'.
  4730                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4731
  4732             20  CF-CO-BEN-I-G-CD           PIC X.
  4733                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4734                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4735                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4736
  4737         16  FILLER                         PIC X(304).
  4738
  4739
  4740****************************************************************
  4741*             CARRIER MASTER RECORD                            *
  4742****************************************************************
  4743
  4744     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4745         16  CF-ADDRESS-DATA.
  4746             20  CF-MAIL-TO-NAME            PIC X(30).
  4747             20  CF-IN-CARE-OF              PIC X(30).
  4748             20  CF-ADDRESS-LINE-1          PIC X(30).
  4749             20  CF-ADDRESS-LINE-2          PIC X(30).
  4750             20  CF-CITY-STATE              PIC X(30).
  4751             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4752             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4753
  4754         16  CF-CLAIM-NO-CONTROL.
  4755             20  CF-CLAIM-NO-METHOD         PIC X.
  4756                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4757                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4758                 88  CLAIM-NO-SEQ               VALUE '3'.
  4759                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4760             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4761                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4762                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4763                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  92
* EL156.cbl
  4764
  4765         16  CF-CHECK-NO-CONTROL.
  4766             20  CF-CHECK-NO-METHOD         PIC X.
  4767                 88  CHECK-NO-MANUAL            VALUE '1'.
  4768                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4769                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4770                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4771             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4772                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4773
  4774         16  CF-DOMICILE-STATE              PIC XX.
  4775
  4776         16  CF-EXPENSE-CONTROLS.
  4777             20  CF-EXPENSE-METHOD          PIC X.
  4778                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4779                 88  DOLLARS-PER-PMT            VALUE '2'.
  4780                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4781                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4782             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4783             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4784
  4785         16  CF-CORRESPONDENCE-CONTROL.
  4786             20  CF-LETTER-RESEND-OPT       PIC X.
  4787                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4788                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4789             20  FILLER                     PIC X(4).
  4790
  4791         16  CF-RESERVE-CONTROLS.
  4792             20  CF-MANUAL-SW               PIC X.
  4793                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4794             20  CF-FUTURE-SW               PIC X.
  4795                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4796             20  CF-PTC-SW                  PIC X.
  4797                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4798             20  CF-IBNR-SW                 PIC X.
  4799                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4800             20  CF-PTC-LF-SW               PIC X.
  4801                 88  CF-LF-PTC-USED             VALUE '1'.
  4802             20  CF-CDT-ACCESS-METHOD       PIC X.
  4803                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4804                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4805                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4806             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4807
  4808         16  CF-CLAIM-CALC-METHOD           PIC X.
  4809             88  360-PLUS-MONTHS                VALUE '1'.
  4810             88  365-PLUS-MONTHS                VALUE '2'.
  4811             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4812             88  360-DAILY                      VALUE '4'.
  4813             88  365-DAILY                      VALUE '5'.
  4814
  4815         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4816         16  FILLER                         PIC X(11).
  4817
  4818         16  CF-LIMIT-AMOUNTS.
  4819             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4820             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4821             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  93
* EL156.cbl
  4822             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4823             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4824             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4825             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4826             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4827             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4828             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4829
  4830         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4831         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4832         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4833
  4834         16  CF-ZIP-CODE.
  4835             20  CF-ZIP-PRIME.
  4836                 24  CF-ZIP-1ST             PIC X.
  4837                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4838                 24  FILLER                 PIC X(4).
  4839             20  CF-ZIP-PLUS4               PIC X(4).
  4840         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4841             20  CF-CAN-POSTAL-1            PIC XXX.
  4842             20  CF-CAN-POSTAL-2            PIC XXX.
  4843             20  FILLER                     PIC XXX.
  4844
  4845         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4846         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4847         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4848
  4849         16  CF-RATING-SWITCH               PIC X.
  4850             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4851             88  CF-NO-RATING                   VALUE 'N'.
  4852
  4853         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4854
  4855         16  CF-CARRIER-OVER-SHORT.
  4856             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4857             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4858
  4859         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4860         16  CF-SECPAY-SWITCH               PIC X.
  4861             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4862             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4863         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4864         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4865         16  FILLER                         PIC X(444).
  4866*        16  FILLER                         PIC X(452).
  4867
  4868
  4869****************************************************************
  4870*             MORTALITY MASTER RECORD                          *
  4871****************************************************************
  4872
  4873     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4874         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4875                                INDEXED BY CF-MORT-NDX.
  4876             20  CF-MORT-TABLE              PIC X(5).
  4877             20  CF-MORT-TABLE-TYPE         PIC X.
  4878                 88  CF-MORT-JOINT              VALUE 'J'.
  4879                 88  CF-MORT-SINGLE             VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  94
* EL156.cbl
  4880                 88  CF-MORT-COMBINED           VALUE 'C'.
  4881                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4882                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4883             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4884             20  CF-MORT-AGE-METHOD         PIC XX.
  4885                 88  CF-AGE-LAST                VALUE 'AL'.
  4886                 88  CF-AGE-NEAR                VALUE 'AN'.
  4887             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4888             20  CF-MORT-ADJUSTMENT-DIRECTION
  4889                                            PIC X.
  4890                 88  CF-MINUS                   VALUE '-'.
  4891                 88  CF-PLUS                    VALUE '+'.
  4892             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4893             20  CF-MORT-JOINT-CODE         PIC X.
  4894                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4895             20  CF-MORT-PC-Q               PIC X.
  4896                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4897             20  CF-MORT-TABLE-CODE         PIC X(4).
  4898             20  CF-MORT-COMMENTS           PIC X(15).
  4899             20  FILLER                     PIC X(14).
  4900
  4901         16  FILLER                         PIC X(251).
  4902
  4903
  4904****************************************************************
  4905*             BUSSINESS TYPE MASTER RECORD                     *
  4906****************************************************************
  4907
  4908     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4909* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4910* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4911* AND RECORD 05 IS TYPES 81-99
  4912         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4913             20  CF-BUSINESS-TITLE          PIC  X(19).
  4914             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4915                                            PIC S9V9(4) COMP-3.
  4916             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4917             20  FILLER                     PIC  X.
  4918         16  FILLER                         PIC  X(248).
  4919
  4920
  4921****************************************************************
  4922*             TERMINAL MASTER RECORD                           *
  4923****************************************************************
  4924
  4925     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4926
  4927         16  CF-COMPANY-TERMINALS.
  4928             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4929                                  PIC X(4).
  4930         16  FILLER               PIC X(248).
  4931
  4932
  4933****************************************************************
  4934*             LIFE EDIT MASTER RECORD                          *
  4935****************************************************************
  4936
  4937     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  95
* EL156.cbl
  4938         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4939             20  CF-LIFE-CODE-IN            PIC XX.
  4940             20  CF-LIFE-CODE-OUT           PIC XX.
  4941         16  FILLER                         PIC X(248).
  4942
  4943
  4944****************************************************************
  4945*             AH EDIT MASTER RECORD                            *
  4946****************************************************************
  4947
  4948     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4949         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4950             20  CF-AH-CODE-IN              PIC XXX.
  4951             20  CF-AH-CODE-OUT             PIC XX.
  4952         16  FILLER                         PIC X(248).
  4953
  4954
  4955****************************************************************
  4956*             CREDIBILITY TABLES                               *
  4957****************************************************************
  4958
  4959     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4960         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4961                             INDEXED BY CF-CRDB-NDX.
  4962             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4963             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4964             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4965         16  FILLER                         PIC  X(332).
  4966
  4967
  4968****************************************************************
  4969*             REPORT CUSTOMIZATION RECORD                      *
  4970****************************************************************
  4971
  4972     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4973         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4974             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4975             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4976             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4977**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4978****       A T-TRANSFER.                                   ****
  4979             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4980
  4981         16  FILLER                         PIC XX.
  4982
  4983         16  CF-CARRIER-CNTL-OPT.
  4984             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4985                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4986                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4987             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4988                                            PIC X.
  4989         16  CF-GROUP-CNTL-OPT.
  4990             20  CF-GROUP-OPT-SEQ           PIC 9.
  4991                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4992                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4993             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4994                                            PIC X(6).
  4995         16  CF-STATE-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  96
* EL156.cbl
  4996             20  CF-STATE-OPT-SEQ           PIC 9.
  4997                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4998                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4999             20  CF-STATE-SELECT OCCURS 3 TIMES
  5000                                            PIC XX.
  5001         16  CF-ACCOUNT-CNTL-OPT.
  5002             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5003                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5004                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5005             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5006                                            PIC X(10).
  5007         16  CF-BUS-TYP-CNTL-OPT.
  5008             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5009                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5010                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5011             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5012                                            PIC XX.
  5013         16  CF-LF-TYP-CNTL-OPT.
  5014             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5015                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5016                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5017             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5018                                            PIC XX.
  5019         16  CF-AH-TYP-CNTL-OPT.
  5020             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5021                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5022                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5023             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5024                                            PIC XX.
  5025         16  CF-REPTCD1-CNTL-OPT.
  5026             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5027                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5028                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5029             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5030                                            PIC X(10).
  5031         16  CF-REPTCD2-CNTL-OPT.
  5032             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5033                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5034                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5035             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5036                                            PIC X(10).
  5037         16  CF-USER1-CNTL-OPT.
  5038             20  CF-USER1-OPT-SEQ           PIC 9.
  5039                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5040                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5041             20  CF-USER1-SELECT OCCURS 3 TIMES
  5042                                            PIC X(10).
  5043         16  CF-USER2-CNTL-OPT.
  5044             20  CF-USER2-OPT-SEQ           PIC 9.
  5045                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5046                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5047             20  CF-USER2-SELECT OCCURS 3 TIMES
  5048                                            PIC X(10).
  5049         16  CF-USER3-CNTL-OPT.
  5050             20  CF-USER3-OPT-SEQ           PIC 9.
  5051                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5052                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5053             20  CF-USER3-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  97
* EL156.cbl
  5054                                            PIC X(10).
  5055         16  CF-USER4-CNTL-OPT.
  5056             20  CF-USER4-OPT-SEQ           PIC 9.
  5057                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5058                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5059             20  CF-USER4-SELECT OCCURS 3 TIMES
  5060                                            PIC X(10).
  5061         16  CF-USER5-CNTL-OPT.
  5062             20  CF-USER5-OPT-SEQ           PIC 9.
  5063                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5064                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5065             20  CF-USER5-SELECT OCCURS 3 TIMES
  5066                                            PIC X(10).
  5067         16  CF-REINS-CNTL-OPT.
  5068             20  CF-REINS-OPT-SEQ           PIC 9.
  5069                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5070                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5071             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5072                 24  CF-REINS-PRIME         PIC XXX.
  5073                 24  CF-REINS-SUB           PIC XXX.
  5074
  5075         16  CF-AGENT-CNTL-OPT.
  5076             20  CF-AGENT-OPT-SEQ           PIC 9.
  5077                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5078                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5079             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5080                                            PIC X(10).
  5081
  5082         16  FILLER                         PIC X(43).
  5083
  5084         16  CF-LOSS-RATIO-SELECT.
  5085             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5086             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5087         16  CF-ENTRY-DATE-SELECT.
  5088             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5089             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5090         16  CF-EFFECTIVE-DATE-SELECT.
  5091             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5092             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5093
  5094         16  CF-EXCEPTION-LIST-IND          PIC X.
  5095             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5096
  5097         16  FILLER                         PIC X(318).
  5098
  5099****************************************************************
  5100*                  EXCEPTION REPORTING RECORD                  *
  5101****************************************************************
  5102
  5103     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5104         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5105             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5106
  5107         16  CF-COMBINED-LIFE-AH-OPT.
  5108             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5109             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5110             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5111             20  CF-CANCELLATION-RATIO      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  98
* EL156.cbl
  5112
  5113         16  CF-LIFE-OPT.
  5114             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5115             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5116             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5117             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5118             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5119             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5120             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5121             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5122             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5123             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5124
  5125         16  CF-AH-OPT.
  5126             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5127             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5128             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5129             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5130             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5131             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5132             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5133             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5134             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5135             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5136
  5137         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5138             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5139             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5140             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5141
  5142         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5143
  5144         16  FILLER                         PIC X(673).
  5145
  5146
  5147****************************************************************
  5148*             MORTGAGE SYSTEM PLAN RECORD                      *
  5149****************************************************************
  5150
  5151     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5152         16  CF-PLAN-TYPE                   PIC X.
  5153             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5154             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5155             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5156         16  CF-PLAN-ABBREV                 PIC XXX.
  5157         16  CF-PLAN-DESCRIPT               PIC X(10).
  5158         16  CF-PLAN-NOTES                  PIC X(20).
  5159         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5160         16  CF-PLAN-UNDERWRITING.
  5161             20  CF-PLAN-TERM-DATA.
  5162                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5163                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5164             20  CF-PLAN-AGE-DATA.
  5165                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5166                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5167                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5168             20  CF-PLAN-BENEFIT-DATA.
  5169                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page  99
* EL156.cbl
  5170                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5171                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5172                                            PIC S9(7)V99  COMP-3.
  5173         16  CF-PLAN-POLICY-FORMS.
  5174             20  CF-POLICY-FORM             PIC X(12).
  5175             20  CF-MASTER-APPLICATION      PIC X(12).
  5176             20  CF-MASTER-POLICY           PIC X(12).
  5177         16  CF-PLAN-RATING.
  5178             20  CF-RATE-CODE               PIC X(5).
  5179             20  CF-SEX-RATING              PIC X.
  5180                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5181                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5182             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5183             20  CF-SUB-STD-TYPE            PIC X.
  5184                 88  CF-PCT-OF-PREM            VALUE '1'.
  5185                 88  CF-PCT-OF-BENE            VALUE '2'.
  5186         16  CF-PLAN-PREM-TOLERANCES.
  5187             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5188             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5189         16  CF-PLAN-PYMT-TOLERANCES.
  5190             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5191             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5192         16  CF-PLAN-MISC-DATA.
  5193             20  FILLER                     PIC X.
  5194             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5195             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5196         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5197         16  CF-PLAN-IND-GRP                PIC X.
  5198             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5199                                                     '1'.
  5200             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5201                                                     '2'.
  5202         16  CF-MIB-SEARCH-SW               PIC X.
  5203             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5204             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5205             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5206             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5207         16  CF-ALPHA-SEARCH-SW             PIC X.
  5208             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5209             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5210             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5211             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5212             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5213             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5214             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5215             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5216             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5217             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5218                                                     'A' 'B' 'C'
  5219                                                     'X' 'Y' 'Z'.
  5220         16  CF-EFF-DT-RULE-SW              PIC X.
  5221             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5222             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5223             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5224             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5225             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5226         16  FILLER                         PIC X(4).
  5227         16  CF-HEALTH-QUESTIONS            PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 100
* EL156.cbl
  5228             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5229         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5230         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5231         16  CF-PLAN-SNGL-JNT               PIC X.
  5232             88  CF-COMBINED-PLAN              VALUE 'C'.
  5233             88  CF-JNT-PLAN                   VALUE 'J'.
  5234             88  CF-SNGL-PLAN                  VALUE 'S'.
  5235         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5236         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5237         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5238         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5239         16  CF-RERATE-CNTL                 PIC  X.
  5240             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5241             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5242             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5243             88  CF-AUTO-RECALC                 VALUE '4'.
  5244         16  CF-BENEFIT-TYPE                PIC  X.
  5245             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5246             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5247         16  CF-POLICY-FEE                  PIC S999V99
  5248                                                    COMP-3.
  5249         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5250         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5251         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5252         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5253         16  FILLER                         PIC  X(32).
  5254         16  CF-TERMINATION-FORM            PIC  X(04).
  5255         16  FILLER                         PIC  X(08).
  5256         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5257                                                       COMP-3.
  5258         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5259         16  CF-ISSUE-LETTER                PIC  X(4).
  5260         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5261         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5262             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5263             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5264         16  CF-MP-REFUND-CALC              PIC X.
  5265             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5266             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5267             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5268             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5269             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5270             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5271             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5272             88  CF-MP-REFD-MEAN                VALUE '8'.
  5273         16  CF-ALT-RATE-CODE               PIC  X(5).
  5274
  5275
  5276         16  FILLER                         PIC X(498).
  5277****************************************************************
  5278*             MORTGAGE COMPANY MASTER RECORD                   *
  5279****************************************************************
  5280
  5281     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5282         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5283         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5284             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5285             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 101
* EL156.cbl
  5286             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5287             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5288             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5289
  5290         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5291         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5292         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5293         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5294         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5295
  5296         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5297             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5298         16  CF-MP-RECON-USE-IND            PIC X(1).
  5299             88  CF-MP-USE-RECON             VALUE 'Y'.
  5300         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5301             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5302         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5303             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5304             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5305         16  FILLER                         PIC X(1).
  5306         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5307             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5308         16  CF-MORTG-MIB-VERSION           PIC X.
  5309             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5310             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5311             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5312         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5313             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5314                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5315             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5316                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5317             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5318                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5319             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5320                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5321             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5322                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5323             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5324                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5325         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5326         16  FILLER                         PIC X(7).
  5327         16  CF-MORTG-DESTINATION-SYMBOL.
  5328             20  CF-MORTG-MIB-COMM          PIC X(5).
  5329             20  CF-MORTG-MIB-TERM          PIC X(5).
  5330         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5331             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5332         16  FILLER                         PIC X(03).
  5333         16  CF-MP-CHECK-NO-CONTROL.
  5334             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5335                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5336                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5337                                                ' ' LOW-VALUES.
  5338                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5339                                               VALUE '3'.
  5340         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5341         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5342         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5343             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 102
* EL156.cbl
  5344                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5345             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5346                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5347             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5348                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5349             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5350                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5351             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5352                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5353             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5354                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5355         16  CF-MORTG-BILLING-AREA.
  5356             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5357                                            PIC X.
  5358         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5359         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5360         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5361         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5362             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5363             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5364         16  FILLER                         PIC X.
  5365         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5366             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5367             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5368         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5369         16  FILLER                         PIC X(8).
  5370         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5371         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5372         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5373         16  CF-ACH-COMPANY-ID.
  5374             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5375                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5376                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5377                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5378             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5379         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5380             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5381         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5382             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5383             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5384         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5385         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5386         16  FILLER                         PIC X(536).
  5387
  5388****************************************************************
  5389*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5390****************************************************************
  5391
  5392     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5393         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5394             20  CF-FEMALE-HEIGHT.
  5395                 24  CF-FEMALE-FT           PIC 99.
  5396                 24  CF-FEMALE-IN           PIC 99.
  5397             20  CF-FEMALE-MIN-WT           PIC 999.
  5398             20  CF-FEMALE-MAX-WT           PIC 999.
  5399         16  FILLER                         PIC X(428).
  5400
  5401     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 103
* EL156.cbl
  5402         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5403             20  CF-MALE-HEIGHT.
  5404                 24  CF-MALE-FT             PIC 99.
  5405                 24  CF-MALE-IN             PIC 99.
  5406             20  CF-MALE-MIN-WT             PIC 999.
  5407             20  CF-MALE-MAX-WT             PIC 999.
  5408         16  FILLER                         PIC X(428).
  5409******************************************************************
  5410*             AUTOMATIC ACTIVITY RECORD                          *
  5411******************************************************************
  5412     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5413         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5414             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5415             20  CF-SYS-LETTER-ID           PIC X(04).
  5416             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5417             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5418             20  CF-SYS-RESET-SW            PIC X(01).
  5419             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5420             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5421
  5422         16  FILLER                         PIC X(50).
  5423
  5424         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5425             20  CF-USER-ACTIVE-SW          PIC X(01).
  5426             20  CF-USER-LETTER-ID          PIC X(04).
  5427             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5428             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5429             20  CF-USER-RESET-SW           PIC X(01).
  5430             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5431             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5432             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5433
  5434         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 104
* EL156.cbl
  5436*    COPY ELCCERT.
  5437******************************************************************
  5438*                                                                *
  5439*                            ELCCERT.                            *
  5440*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5441*                            VMOD=2.013                          *
  5442*                                                                *
  5443*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5444*                                                                *
  5445*   FILE TYPE = VSAM,KSDS                                        *
  5446*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5447*                                                                *
  5448*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5449*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5450*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5451*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5452*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5453*                                                                *
  5454*   LOG = YES                                                    *
  5455*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5456******************************************************************
  5457*                   C H A N G E   L O G
  5458*
  5459* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5460*-----------------------------------------------------------------
  5461*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5462* EFFECTIVE    NUMBER
  5463*-----------------------------------------------------------------
  5464* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5465* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5466* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5467* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5468* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5469* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5470* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5471* 032612  CR2011110200001  PEMA  AHL CHANGES
  5472******************************************************************
  5473
  5474 01  CERTIFICATE-MASTER.
  5475     12  CM-RECORD-ID                      PIC XX.
  5476         88  VALID-CM-ID                      VALUE 'CM'.
  5477
  5478     12  CM-CONTROL-PRIMARY.
  5479         16  CM-COMPANY-CD                 PIC X.
  5480         16  CM-CARRIER                    PIC X.
  5481         16  CM-GROUPING.
  5482             20  CM-GROUPING-PREFIX        PIC X(3).
  5483             20  CM-GROUPING-PRIME         PIC X(3).
  5484         16  CM-STATE                      PIC XX.
  5485         16  CM-ACCOUNT.
  5486             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5487             20  CM-ACCOUNT-PRIME          PIC X(6).
  5488         16  CM-CERT-EFF-DT                PIC XX.
  5489         16  CM-CERT-NO.
  5490             20  CM-CERT-PRIME             PIC X(10).
  5491             20  CM-CERT-SFX               PIC X.
  5492
  5493     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 105
* EL156.cbl
  5494         16  CM-COMPANY-CD-A1              PIC X.
  5495         16  CM-INSURED-LAST-NAME          PIC X(15).
  5496         16  CM-INSURED-INITIALS.
  5497             20  CM-INSURED-INITIAL1       PIC X.
  5498             20  CM-INSURED-INITIAL2       PIC X.
  5499
  5500     12  CM-CONTROL-BY-SSN.
  5501         16  CM-COMPANY-CD-A2              PIC X.
  5502         16  CM-SOC-SEC-NO.
  5503             20  CM-SSN-STATE              PIC XX.
  5504             20  CM-SSN-ACCOUNT            PIC X(6).
  5505             20  CM-SSN-LN3.
  5506                 25  CM-INSURED-INITIALS-A2.
  5507                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5508                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5509                 25 CM-PART-LAST-NAME-A2         PIC X.
  5510
  5511     12  CM-CONTROL-BY-CERT-NO.
  5512         16  CM-COMPANY-CD-A4              PIC X.
  5513         16  CM-CERT-NO-A4                 PIC X(11).
  5514
  5515     12  CM-CONTROL-BY-MEMB.
  5516         16  CM-COMPANY-CD-A5              PIC X.
  5517         16  CM-MEMBER-NO.
  5518             20  CM-MEMB-STATE             PIC XX.
  5519             20  CM-MEMB-ACCOUNT           PIC X(6).
  5520             20  CM-MEMB-LN4.
  5521                 25  CM-INSURED-INITIALS-A5.
  5522                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5523                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5524                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5525
  5526     12  CM-INSURED-PROFILE-DATA.
  5527         16  CM-INSURED-FIRST-NAME.
  5528             20  CM-INSURED-1ST-INIT       PIC X.
  5529             20  FILLER                    PIC X(9).
  5530         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5531         16  CM-INSURED-SEX                PIC X.
  5532             88  CM-SEX-MALE                  VALUE 'M'.
  5533             88  CM-SEX-FEMAL                 VALUE 'F'.
  5534         16  CM-INSURED-JOINT-AGE          PIC 99.
  5535         16  CM-JOINT-INSURED-NAME.
  5536             20  CM-JT-LAST-NAME           PIC X(15).
  5537             20  CM-JT-FIRST-NAME.
  5538                 24  CM-JT-1ST-INIT        PIC X.
  5539                 24  FILLER                PIC X(9).
  5540             20  CM-JT-INITIAL             PIC X.
  5541
  5542     12  CM-LIFE-DATA.
  5543         16  CM-LF-BENEFIT-CD              PIC XX.
  5544         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5545         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5546         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5547         16  CM-LF-DEV-CODE                PIC XXX.
  5548         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5549         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5550         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5551         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 106
* EL156.cbl
  5552         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5553         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5554         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5555         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5556         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5557         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5558         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5559         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5560         16  FILLER                        PIC XX.
  5561
  5562     12  CM-AH-DATA.
  5563         16  CM-AH-BENEFIT-CD              PIC XX.
  5564         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5565         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5566         16  CM-AH-DEV-CODE                PIC XXX.
  5567         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5568         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5569         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5570         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5571         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5572         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5573         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5574         16  CM-AH-PAID-THRU-DT            PIC XX.
  5575             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5576         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5577         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5578         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5579         16  FILLER                        PIC X.
  5580
  5581     12  CM-LOAN-INFORMATION.
  5582         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5583         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5584                                           PIC S9(5)V99  COMP-3.
  5585         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5586         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5587         16  CM-PAY-FREQUENCY              PIC S99.
  5588         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5589         16  CM-RATE-CLASS                 PIC XX.
  5590         16  CM-BENEFICIARY                PIC X(25).
  5591         16  CM-POLICY-FORM-NO             PIC X(12).
  5592         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5593         16  CM-LAST-ADD-ON-DT             PIC XX.
  5594         16  CM-DEDUCTIBLE-AMOUNTS.
  5595             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5596             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5597         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5598             20  CM-RESIDENT-STATE         PIC XX.
  5599             20  CM-RATE-CODE              PIC X(4).
  5600             20  FILLER                    PIC XX.
  5601         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5602             20  CM-LOAN-OFFICER           PIC X(5).
  5603             20  FILLER                    PIC XXX.
  5604         16  CM-CSR-CODE                   PIC XXX.
  5605         16  CM-UNDERWRITING-CODE          PIC X.
  5606             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5607         16  CM-POST-CARD-IND              PIC X.
  5608         16  CM-NH-INTERFACE-SW            PIC X.
  5609         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 107
* EL156.cbl
  5610             88  CM-SING-PRM                  VALUE '1'.
  5611             88  CM-O-B-COVERAGE              VALUE '2'.
  5612             88  CM-OPEN-END                  VALUE '3'.
  5613         16  CM-IND-GRP-TYPE               PIC X.
  5614             88  CM-INDIVIDUAL                VALUE 'I'.
  5615             88  CM-GROUP                     VALUE 'G'.
  5616         16  CM-SKIP-CODE                  PIC X.
  5617             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5618             88  SKIP-JULY                    VALUE '1'.
  5619             88  SKIP-AUGUST                  VALUE '2'.
  5620             88  SKIP-SEPTEMBER               VALUE '3'.
  5621             88  SKIP-JULY-AUG                VALUE '4'.
  5622             88  SKIP-AUG-SEPT                VALUE '5'.
  5623             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5624             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5625             88  SKIP-JUNE                    VALUE '8'.
  5626             88  SKIP-JUNE-JULY               VALUE '9'.
  5627             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5628             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5629         16  CM-PAYMENT-MODE               PIC X.
  5630             88  PAY-MONTHLY                  VALUE SPACE.
  5631             88  PAY-WEEKLY                   VALUE '1'.
  5632             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5633             88  PAY-BI-WEEKLY                VALUE '3'.
  5634             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5635         16  CM-LOAN-NUMBER                PIC X(8).
  5636         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5637         16  CM-OLD-LOF                    PIC XXX.
  5638*        16  CM-LOAN-OFFICER               PIC XXX.
  5639         16  CM-REIN-TABLE                 PIC XXX.
  5640         16  CM-SPECIAL-REIN-CODE          PIC X.
  5641         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5642         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5643         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5644
  5645     12  CM-STATUS-DATA.
  5646         16  CM-ENTRY-STATUS               PIC X.
  5647         16  CM-ENTRY-DT                   PIC XX.
  5648
  5649         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5650         16  CM-LF-CANCEL-DT               PIC XX.
  5651         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5652
  5653         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5654         16  CM-LF-DEATH-DT                PIC XX.
  5655         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5656
  5657         16  CM-LF-CURRENT-STATUS          PIC X.
  5658             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5659                                                'M' '4' '5' '9'.
  5660             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5661             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5662             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5663             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5664             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5665             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5666             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5667             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 108
* EL156.cbl
  5668             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5669             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5670             88  CM-LF-DECLINED               VALUE 'D'.
  5671             88  CM-LF-VOIDED                 VALUE 'V'.
  5672
  5673         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5674         16  CM-AH-CANCEL-DT               PIC XX.
  5675         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5676
  5677         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5678         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5679         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5680
  5681         16  CM-AH-CURRENT-STATUS          PIC X.
  5682             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5683                                                'M' '4' '5' '9'.
  5684             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5685             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5686             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5687             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5688             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5689             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5690             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5691             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5692             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5693             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5694             88  CM-AH-DECLINED               VALUE 'D'.
  5695             88  CM-AH-VOIDED                 VALUE 'V'.
  5696
  5697         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5698             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5699             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5700             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5701         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5702
  5703         16  CM-ENTRY-BATCH                PIC X(6).
  5704         16  CM-LF-EXIT-BATCH              PIC X(6).
  5705         16  CM-AH-EXIT-BATCH              PIC X(6).
  5706         16  CM-LAST-MONTH-END             PIC XX.
  5707
  5708     12  CM-NOTE-SW                        PIC X.
  5709         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5710         88  CERT-NOTES-PRESENT               VALUE '1'.
  5711         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5712         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5713         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5714         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5715         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5716         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5717     12  CM-COMP-EXCP-SW                   PIC X.
  5718         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5719         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5720     12  CM-INSURED-ADDRESS-SW             PIC X.
  5721         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5722         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5723
  5724*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5725     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 109
* EL156.cbl
  5726     12  FILLER                            PIC X.
  5727
  5728*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5729     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5730     12  FILLER                            PIC X.
  5731*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5732     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5733
  5734     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5735         88  CERT-ADDED-BATCH                 VALUE ' '.
  5736         88  CERT-ADDED-ONLINE                VALUE '1'.
  5737         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5738         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5739         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5740     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5741         88  CERT-AS-LOADED                   VALUE ' '.
  5742         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5743         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5744         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5745         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5746         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5747         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5748         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5749
  5750     12  CM-ACCOUNT-COMM-PCTS.
  5751         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5752         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5753
  5754     12  CM-USER-FIELD                     PIC X.
  5755     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5756     12  CM-CLP-STATE                      PIC XX.
  5757     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5758     12  CM-USER-RESERVED                  PIC XXX.
  5759     12  FILLER REDEFINES CM-USER-RESERVED.
  5760         16  CM-AH-CLASS-CD                PIC XX.
  5761         16  F                             PIC X.
  5762******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 110
* EL156.cbl
  5764*    COPY ELCTRLR.
  5765******************************************************************
  5766*                                                                *
  5767*                            ELCTRLR.                            *
  5768*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5769*                            VMOD=2.014                          *
  5770*                                                                *
  5771*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5772*                                                                *
  5773*   FILE TYPE = VSAM,KSDS                                        *
  5774*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5775*                                                                *
  5776*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5777*       ALTERNATE INDEX = NONE                                   *
  5778*                                                                *
  5779*   LOG = YES                                                    *
  5780*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5781******************************************************************
  5782*                   C H A N G E   L O G
  5783*
  5784* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5785*-----------------------------------------------------------------
  5786*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5787* EFFECTIVE    NUMBER
  5788*-----------------------------------------------------------------
  5789* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5790* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5791* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5792* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5793* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5794* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5795* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5796* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5797* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5798* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5799* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5800* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5801* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5802* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5803* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5804******************************************************************
  5805 01  ACTIVITY-TRAILERS.
  5806     12  AT-RECORD-ID                    PIC XX.
  5807         88  VALID-AT-ID                       VALUE 'AT'.
  5808
  5809     12  AT-CONTROL-PRIMARY.
  5810         16  AT-COMPANY-CD               PIC X.
  5811         16  AT-CARRIER                  PIC X.
  5812         16  AT-CLAIM-NO                 PIC X(7).
  5813         16  AT-CERT-NO.
  5814             20  AT-CERT-PRIME           PIC X(10).
  5815             20  AT-CERT-SFX             PIC X.
  5816         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5817             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5818             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5819             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5820             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5821             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 111
* EL156.cbl
  5822             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5823             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5824             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5825             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5826             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5827             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5828             88  AT-BENEFICIARY-TRL           VALUE +91.
  5829             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5830             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5831             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5832
  5833     12  AT-TRAILER-TYPE                 PIC X.
  5834         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5835         88  PAYMENT-TR                       VALUE '2'.
  5836         88  AUTO-PAY-TR                      VALUE '3'.
  5837         88  CORRESPONDENCE-TR                VALUE '4'.
  5838         88  ADDRESS-TR                       VALUE '5'.
  5839         88  GENERAL-INFO-TR                  VALUE '6'.
  5840         88  AUTO-PROMPT-TR                   VALUE '7'.
  5841         88  DENIAL-TR                        VALUE '8'.
  5842         88  INCURRED-CHG-TR                  VALUE '9'.
  5843         88  FORM-CONTROL-TR                  VALUE 'A'.
  5844
  5845     12  AT-RECORDED-DT                  PIC XX.
  5846     12  AT-RECORDED-BY                  PIC X(4).
  5847     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5848
  5849     12  AT-TRAILER-BODY                 PIC X(165).
  5850
  5851     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5852         16  AT-RESERVE-CONTROLS.
  5853             20  AT-MANUAL-SW            PIC X.
  5854                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5855             20  AT-FUTURE-SW            PIC X.
  5856                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5857             20  AT-PTC-SW               PIC X.
  5858                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5859             20  AT-IBNR-SW              PIC X.
  5860                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5861             20  AT-PTC-LF-SW            PIC X.
  5862                 88  AT-LF-PTC-USED          VALUE '1'.
  5863             20  AT-CDT-ACCESS-METHOD    PIC X.
  5864                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5865                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5866                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5867             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5868         16  AT-LAST-COMPUTED-DT         PIC XX.
  5869         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5870         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5871         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5872         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5873         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5874         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5875         16  AT-EXPENSE-CONTROLS.
  5876             20  AT-EXPENSE-METHOD       PIC X.
  5877                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5878                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5879                 88  PERCENT-OF-PMT           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 112
* EL156.cbl
  5880                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5881             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5882             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5883         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5884         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5885
  5886         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5887         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5888
  5889*        16  FILLER                      PIC X(53).
  5890         16  FILLER                      PIC X(47).
  5891
  5892         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5893         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5894
  5895         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5896             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5897             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5898*                    C = CLOSED
  5899*                    O = OPEN
  5900             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5901*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5902
  5903     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5904         16  AT-PAYMENT-TYPE             PIC X.
  5905             88  PARTIAL-PAYMENT                VALUE '1'.
  5906             88  FINAL-PAYMENT                  VALUE '2'.
  5907             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5908             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5909             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5910             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5911             88  VOIDED-PAYMENT                 VALUE '9'.
  5912             88  TRANSFER                       VALUE 'T'.
  5913             88  LIFE-INTEREST                  VALUE 'I'.
  5914
  5915         16  AT-CLAIM-TYPE               PIC X.
  5916             88  PAID-FOR-AH                    VALUE 'A'.
  5917             88  PAID-FOR-LIFE                  VALUE 'L'.
  5918             88  PAID-FOR-IUI                   VALUE 'I'.
  5919             88  PAID-FOR-GAP                   VALUE 'G'.
  5920         16  AT-CLAIM-PREM-TYPE          PIC X.
  5921             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5922             88  AT-O-B-COVERAGE                VALUE '2'.
  5923             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5924         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5925         16  AT-CHECK-NO                 PIC X(7).
  5926         16  AT-PAID-FROM-DT             PIC XX.
  5927         16  AT-PAID-THRU-DT             PIC XX.
  5928         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5929         16  FILLER                      PIC X.
  5930         16  AT-PAYEES-NAME              PIC X(30).
  5931         16  AT-PAYMENT-ORIGIN           PIC X.
  5932             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5933             88  ONLINE-AUTO-PMT                VALUE '2'.
  5934             88  OFFLINE-PMT                    VALUE '3'.
  5935         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5936         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5937         16  AT-VOID-DATA.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 113
* EL156.cbl
  5938             20  AT-VOID-DT              PIC XX.
  5939*00144       20  AT-VOID-REASON          PIC X(30).
  5940             20  AT-VOID-REASON          PIC X(26).
  5941         16  AT-PMT-APPROVED-BY          PIC X(04).
  5942         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5943         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5944         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5945                                         PIC S99V9(5)  COMP-3.
  5946         16  AT-CREDIT-INTERFACE.
  5947             20  AT-PMT-SELECT-DT        PIC XX.
  5948                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5949             20  AT-PMT-ACCEPT-DT        PIC XX.
  5950                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5951             20  AT-VOID-SELECT-DT       PIC XX.
  5952                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5953             20  AT-VOID-ACCEPT-DT       PIC XX.
  5954                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5955
  5956         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5957                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5958                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5959         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5960
  5961         16  AT-FORCE-CONTROL            PIC X.
  5962             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5963         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5964         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5965         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5966         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5967         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5968         16  AT-BENEFIT-TYPE             PIC X.
  5969
  5970         16  AT-EXPENSE-TYPE             PIC X.
  5971         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5972
  5973         16  AT-PAYEE-TYPE-CD.
  5974             20  AT-PAYEE-TYPE           PIC X.
  5975                 88  INSURED-PAID           VALUE 'I'.
  5976                 88  BENEFICIARY-PAID       VALUE 'B'.
  5977                 88  ACCOUNT-PAID           VALUE 'A'.
  5978                 88  OTHER-1-PAID           VALUE 'O'.
  5979                 88  OTHER-2-PAID           VALUE 'Q'.
  5980                 88  DOCTOR-PAID            VALUE 'P'.
  5981                 88  EMPLOYER-PAID          VALUE 'E'.
  5982             20  AT-PAYEE-SEQ            PIC X.
  5983
  5984         16  AT-CASH-PAYMENT             PIC X.
  5985         16  AT-GROUPED-PAYMENT          PIC X.
  5986         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5987         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5988         16  AT-APPROVED-LEVEL           PIC X.
  5989         16  AT-VOID-TYPE                PIC X.
  5990             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5991             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5992         16  AT-AIG-UNEMP-IND            PIC X.
  5993             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5994         16  AT-ASSOCIATES               PIC X.
  5995             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 114
* EL156.cbl
  5996             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5997
  5998         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  5999         16  AT-CV-PMT-CODE              PIC X.
  6000             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6001             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6002             88  FULL-ADD-PAYMENT           VALUE '3'.
  6003             88  HALF-ADD-PAYMENT           VALUE '4'.
  6004             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6005             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6006             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6007             88  ADDL-PAYMENT               VALUE '8'.
  6008
  6009         16  AT-EOB-CODE1                PIC XXX.
  6010         16  AT-EOB-CODE2                PIC XXX.
  6011         16  AT-EOB-CODE3                PIC XXX.
  6012         16  FILLER REDEFINES AT-EOB-CODE3.
  6013             20  AT-PRINT-CLM-FORM       PIC X.
  6014             20  AT-PRINT-SURVEY         PIC X.
  6015             20  FILLER                  PIC X.
  6016         16  AT-EOB-CODE4                PIC XXX.
  6017         16  FILLER REDEFINES AT-EOB-CODE4.
  6018             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6019             20  FILLER                  PIC X.
  6020         16  AT-EOB-CODE5                PIC XXX.
  6021         16  FILLER REDEFINES AT-EOB-CODE5.
  6022             20  AT-PMT-PROOF-DT         PIC XX.
  6023             20  FILLER                  PIC X.
  6024
  6025         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6026             88  AT-PRINT-EOB            VALUE 'Y'.
  6027
  6028         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6029         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6030
  6031     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6032         16  AT-SCHEDULE-START-DT        PIC XX.
  6033         16  AT-SCHEDULE-END-DT          PIC XX.
  6034         16  AT-TERMINATED-DT            PIC XX.
  6035         16  AT-LAST-PMT-TYPE            PIC X.
  6036             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6037             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6038         16  AT-FIRST-PMT-DATA.
  6039             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6040             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6041             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6042         16  AT-REGULAR-PMT-DATA.
  6043             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6044             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6045             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6046         16  AT-AUTO-PAYEE-CD.
  6047             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6048                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6049                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6050                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6051                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6052                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6053             20  AT-AUTO-PAYEE-SEQ       PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 115
* EL156.cbl
  6054         16  AT-AUTO-PAY-DAY             PIC 99.
  6055         16  AT-AUTO-CASH                PIC X.
  6056             88  AT-CASH                      VALUE 'Y'.
  6057             88  AT-NON-CASH                  VALUE 'N'.
  6058*        16  FILLER                      PIC X(129).
  6059         16  AT-AUTO-END-LETTER          PIC X(4).
  6060         16  FILLER                      PIC X(125).
  6061
  6062         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6063         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6064
  6065     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6066         16  AT-LETTER-SENT-DT           PIC XX.
  6067         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6068         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6069         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6070         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6071         16  AT-LETTER-ORIGIN            PIC X.
  6072             88  ONLINE-CREATION              VALUE '1' '3'.
  6073             88  OFFLINE-CREATION             VALUE '2' '4'.
  6074             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6075             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6076         16  AT-STD-LETTER-FORM          PIC X(4).
  6077         16  AT-REASON-TEXT              PIC X(70).
  6078         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6079         16  AT-ADDRESEE-TYPE            PIC X.
  6080              88  INSURED-ADDRESEE            VALUE 'I'.
  6081              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6082              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6083              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6084              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6085              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6086              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6087         16  AT-ADDRESSEE-NAME           PIC X(30).
  6088         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6089         16  AT-RESEND-PRINT-DATE        PIC XX.
  6090         16  AT-CORR-SOL-UNSOL           PIC X.
  6091         16  AT-LETTER-PURGED-DT         PIC XX.
  6092*
  6093*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6094*
  6095         16  AT-CSO-REDEFINITION.
  6096             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6097             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6098             20  AT-LETTER-TO-BENE       PIC X(1).
  6099             20  AT-STOP-LETTER-DT       PIC X(2).
  6100             20  FILLER                  PIC X(19).
  6101*             20  FILLER                  PIC X(27).
  6102             20  AT-CSO-LETTER-STATUS    PIC X.
  6103                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6104                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6105                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6106             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6107             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6108*
  6109*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6110*
  6111*        16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 116
* EL156.cbl
  6112*
  6113*        16  AT-DMD-BSR-CODE             PIC X.
  6114*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6115*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6116*
  6117*        16  AT-DMD-LETTER-STATUS        PIC X.
  6118*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6119*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6120*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6121*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6122*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6123
  6124         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6125         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6126
  6127     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6128         16  AT-ADDRESS-TYPE             PIC X.
  6129             88  INSURED-ADDRESS               VALUE 'I'.
  6130             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6131             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6132             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6133             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6134             88  OTHER-ADDRESS-1               VALUE 'O'.
  6135             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6136         16  AT-MAIL-TO-NAME             PIC X(30).
  6137         16  AT-ADDRESS-LINE-1           PIC X(30).
  6138         16  AT-ADDRESS-LINE-2           PIC X(30).
  6139         16  AT-CITY-STATE.
  6140             20  AT-CITY                 PIC X(28).
  6141             20  AT-STATE                PIC XX.
  6142         16  AT-ZIP.
  6143             20  AT-ZIP-CODE.
  6144                 24  AT-ZIP-1ST          PIC X.
  6145                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6146                 24  FILLER              PIC X(4).
  6147             20  AT-ZIP-PLUS4            PIC X(4).
  6148         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6149             20  AT-CAN-POSTAL-1         PIC XXX.
  6150             20  AT-CAN-POSTAL-2         PIC XXX.
  6151             20  FILLER                  PIC XXX.
  6152         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6153*         16  FILLER                      PIC X(23).
  6154         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6155         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6156         16  FILLER                      PIC X(13).
  6157         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6158         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6159
  6160     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6161         16  AT-INFO-LINE-1              PIC X(60).
  6162         16  AT-INFO-LINE-2              PIC X(60).
  6163         16  AT-INFO-TRAILER-TYPE        PIC X.
  6164             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6165             88  AT-CALL-NOTE            VALUE 'C'.
  6166             88  AT-MAINT-NOTE           VALUE 'M'.
  6167             88  AT-CERT-CHANGE          VALUE 'X'.
  6168             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6169             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 117
* EL156.cbl
  6170         16  AT-CALL-TYPE                PIC X.
  6171             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6172             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6173         16  AT-NOTE-CONTINUATION        PIC X.
  6174             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6175         16  AT-EOB-CODES-EXIST          PIC X.
  6176             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6177         16  FILLER                      PIC X(35).
  6178         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6179         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6180
  6181     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6182         16  AT-PROMPT-LINE-1            PIC X(60).
  6183         16  AT-PROMPT-LINE-2            PIC X(60).
  6184         16  AT-PROMPT-START-DT          PIC XX.
  6185         16  AT-PROMPT-END-DT            PIC XX.
  6186         16  FILLER                      PIC X(35).
  6187         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6188         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6189
  6190     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6191         16  AT-DENIAL-INFO-1            PIC X(60).
  6192         16  AT-DENIAL-INFO-2            PIC X(60).
  6193         16  AT-DENIAL-DT                PIC XX.
  6194         16  AT-RETRACTION-DT            PIC XX.
  6195         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6196*         16  FILLER                      PIC X(31).
  6197         16  AT-DENIAL-PROOF-DT          PIC XX.
  6198         16  FILLER                      PIC X(29).
  6199         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6200         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6201
  6202     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6203         16  AT-OLD-INCURRED-DT          PIC XX.
  6204         16  AT-OLD-REPORTED-DT          PIC XX.
  6205         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6206         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6207         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6208         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6209         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6210         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6211         16  FILLER                      PIC X(26).
  6212         16  AT-OLD-DIAG-CODE            PIC X(6).
  6213         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6214         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6215         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6216         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6217         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6218         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6219         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6220         16  FILLER                      PIC X(25).
  6221         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6222
  6223     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6224         16  AT-FORM-SEND-ON-DT          PIC XX.
  6225         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6226         16  AT-FORM-RE-SEND-DT          PIC XX.
  6227         16  AT-FORM-ANSWERED-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 118
* EL156.cbl
  6228         16  AT-FORM-PRINTED-DT          PIC XX.
  6229         16  AT-FORM-REPRINT-DT          PIC XX.
  6230         16  AT-FORM-TYPE                PIC X.
  6231             88  INITIAL-FORM                  VALUE '1'.
  6232             88  PROGRESS-FORM                 VALUE '2'.
  6233         16  AT-INSTRUCT-LN-1            PIC X(28).
  6234         16  AT-INSTRUCT-LN-2            PIC X(28).
  6235         16  AT-INSTRUCT-LN-3            PIC X(28).
  6236         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6237         16  AT-FORM-ADDRESS             PIC X.
  6238             88  FORM-TO-INSURED              VALUE 'I'.
  6239             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6240             88  FORM-TO-OTHER-1              VALUE 'O'.
  6241             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6242         16  AT-RELATED-1.
  6243             20 AT-REL-CARR-1            PIC X.
  6244             20 AT-REL-CLAIM-1           PIC X(7).
  6245             20 AT-REL-CERT-1            PIC X(11).
  6246         16  AT-RELATED-2.
  6247             20 AT-REL-CARR-2            PIC X.
  6248             20 AT-REL-CLAIM-2           PIC X(7).
  6249             20 AT-REL-CERT-2            PIC X(11).
  6250         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6251         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6252         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6253         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6254         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6255         16  AT-STOP-FORM-DT             PIC X(2).
  6256
  6257         16  FILLER                      PIC X(09).
  6258         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6259         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6260******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 119
* EL156.cbl
  6262*    COPY ELCACTQ.
  6263******************************************************************
  6264*                                                                *
  6265*                            ELCACTQ.                            *
  6266*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6267*                            VMOD=2.004                          *
  6268*                                                                *
  6269*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6270*                                                                *
  6271*   FILE TYPE = VSAM,KSDS                                        *
  6272*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6273*                                                                *
  6274*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6275*       ALTERNATE INDEX = NONE                                   *
  6276*                                                                *
  6277*   LOG = YES                                                    *
  6278*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6279*                                                                *
  6280*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6281******************************************************************
  6282
  6283 01  ACTIVITY-QUE.
  6284     12  AQ-RECORD-ID                PIC XX.
  6285         88  VALID-AQ-ID                VALUE 'AQ'.
  6286
  6287     12  AQ-CONTROL-PRIMARY.
  6288         16  AQ-COMPANY-CD           PIC X.
  6289         16  AQ-CARRIER              PIC X.
  6290         16  AQ-CLAIM-NO             PIC X(7).
  6291         16  AQ-CERT-NO.
  6292             20  AQ-CERT-PRIME       PIC X(10).
  6293             20  AQ-CERT-SFX         PIC X.
  6294
  6295     12  AQ-PENDING-ACTIVITY-FLAGS.
  6296         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6297         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6298             88  PENDING-PAYMENTS       VALUE '1'.
  6299         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6300             88  PENDING-FULL-PRINT     VALUE '1'.
  6301             88  PENDING-PART-PRINT     VALUE '2'.
  6302         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6303             88  PENDING-LETTERS        VALUE '1'.
  6304         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6305             88  PENDING-RESTORE        VALUE 'C'.
  6306             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6307
  6308     12  FILLER                      PIC X(20).
  6309
  6310     12  AQ-RESEND-DATE              PIC XX.
  6311     12  AQ-FOLLOWUP-DATE            PIC XX.
  6312     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6313     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6314     12  AQ-AUTO-LETTER              PIC X(4).
  6315     12  FILLER                      PIC XX.
  6316     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6317*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 120
* EL156.cbl
  6319*    COPY ERCACCT.
  6320******************************************************************
  6321*                                                                *
  6322*                                                                *
  6323*                            ERCACCT                             *
  6324*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6325*                            VMOD=2.031                          *
  6326*                                                                *
  6327*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6328*                                                                *
  6329*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6330*   VSAM ACCOUNT MASTER FILES.                                   *
  6331*                                                                *
  6332*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6333*                                                                *
  6334*   FILE TYPE = VSAM,KSDS                                        *
  6335*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6336*                                                                *
  6337*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6338*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6339*                                                                *
  6340*   LOG = NO                                                     *
  6341*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6342*                                                                *
  6343*                                                                *
  6344******************************************************************
  6345*                   C H A N G E   L O G
  6346*
  6347* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6348*-----------------------------------------------------------------
  6349*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6350* EFFECTIVE    NUMBER
  6351*-----------------------------------------------------------------
  6352* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6353* 092705    2005050300006  PEMA  ADD SPP LEASES
  6354* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6355* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6356* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6357* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6358* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6359******************************************************************
  6360
  6361 01  ACCOUNT-MASTER.
  6362     12  AM-RECORD-ID                      PIC XX.
  6363         88  VALID-AM-ID                      VALUE 'AM'.
  6364
  6365     12  AM-CONTROL-PRIMARY.
  6366         16  AM-COMPANY-CD                 PIC X.
  6367         16  AM-MSTR-CNTRL.
  6368             20  AM-CONTROL-A.
  6369                 24  AM-CARRIER            PIC X.
  6370                 24  AM-GROUPING.
  6371                     28 AM-GROUPING-PREFIX PIC XXX.
  6372                     28 AM-GROUPING-PRIME  PIC XXX.
  6373                 24  AM-STATE              PIC XX.
  6374                 24  AM-ACCOUNT.
  6375                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6376                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 121
* EL156.cbl
  6377             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6378                                           PIC X(19).
  6379             20  AM-CNTRL-B.
  6380                 24  AM-EXPIRATION-DT      PIC XX.
  6381                 24  FILLER                PIC X(4).
  6382             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6383                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6384
  6385     12  AM-CONTROL-BY-VAR-GRP.
  6386         16  AM-COMPANY-CD-A1              PIC X.
  6387         16  AM-VG-CARRIER                 PIC X.
  6388         16  AM-VG-GROUPING                PIC X(6).
  6389         16  AM-VG-STATE                   PIC XX.
  6390         16  AM-VG-ACCOUNT                 PIC X(10).
  6391         16  AM-VG-DATE.
  6392             20  AM-VG-EXPIRATION-DT       PIC XX.
  6393             20  FILLER                    PIC X(4).
  6394         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6395                                           PIC 9(11)      COMP-3.
  6396     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6397         16  FILLER                        PIC X(10).
  6398         16  AM-VG-KEY3.
  6399             20  AM-VG3-ACCOUNT            PIC X(10).
  6400             20  AM-VG3-EXP-DT             PIC XX.
  6401         16  FILLER                        PIC X(4).
  6402     12  AM-MAINT-INFORMATION.
  6403         16  AM-LAST-MAINT-DT              PIC XX.
  6404         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6405         16  AM-LAST-MAINT-USER            PIC X(4).
  6406         16  FILLER                        PIC XX.
  6407
  6408     12  AM-EFFECTIVE-DT                   PIC XX.
  6409     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6410
  6411     12  AM-PREV-DATES  COMP-3.
  6412         16  AM-PREV-EXP-DT                PIC 9(11).
  6413         16  AM-PREV-EFF-DT                PIC 9(11).
  6414
  6415     12  AM-REPORT-CODE-1                  PIC X(10).
  6416     12  AM-REPORT-CODE-2                  PIC X(10).
  6417
  6418     12  AM-CITY-CODE                      PIC X(4).
  6419     12  AM-COUNTY-PARISH                  PIC X(6).
  6420
  6421     12  AM-NAME                           PIC X(30).
  6422     12  AM-PERSON                         PIC X(30).
  6423     12  AM-ADDRS                          PIC X(30).
  6424     12  AM-CITY.
  6425         16  AM-ADDR-CITY                  PIC X(28).
  6426         16  AM-ADDR-STATE                 PIC XX.
  6427     12  AM-ZIP.
  6428         16  AM-ZIP-PRIME.
  6429             20  AM-ZIP-PRI-1ST            PIC X.
  6430                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6431             20  FILLER                    PIC X(4).
  6432         16  AM-ZIP-PLUS4                  PIC X(4).
  6433     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6434         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 122
* EL156.cbl
  6435         16  AM-CAN-POSTAL-2               PIC XXX.
  6436         16  FILLER                        PIC XXX.
  6437     12  AM-TEL-NO.
  6438         16  AM-AREA-CODE                  PIC 999.
  6439         16  AM-TEL-PRE                    PIC 999.
  6440         16  AM-TEL-NBR                    PIC 9(4).
  6441     12  AM-TEL-LOC                        PIC X.
  6442         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6443         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6444
  6445     12  AM-COMM-STRUCTURE.
  6446         16  AM-DEFN-1.
  6447             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6448                 24  AM-AGT.
  6449                     28  AM-AGT-PREFIX     PIC X(4).
  6450                     28  AM-AGT-PRIME      PIC X(6).
  6451                 24  AM-COM-TYP            PIC X.
  6452                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6453                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6454                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6455                 24  AM-RECALC-LV-INDIC    PIC X.
  6456                 24  AM-RETRO-LV-INDIC     PIC X.
  6457                 24  AM-GL-CODES           PIC X.
  6458                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6459                 24  FILLER                PIC X(01).
  6460         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6461             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6462                 24  FILLER                PIC X(11).
  6463                 24  AM-L-COMA             PIC XXX.
  6464                 24  AM-J-COMA             PIC XXX.
  6465                 24  AM-A-COMA             PIC XXX.
  6466                 24  FILLER                PIC X(6).
  6467
  6468     12  AM-COMM-CHANGE-STATUS             PIC X.
  6469         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6470
  6471     12  AM-CSR-CODE                       PIC X(4).
  6472
  6473     12  AM-BILLING-STATUS                 PIC X.
  6474         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6475         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6476     12  AM-AUTO-REFUND-SW                 PIC X.
  6477         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6478         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6479     12  AM-GPCD                           PIC 99.
  6480     12  AM-IG                             PIC X.
  6481         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6482         88  AM-HAS-GROUP                     VALUE '2'.
  6483     12  AM-STATUS                         PIC X.
  6484         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6485         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6486         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6487         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6488         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6489         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6490     12  AM-REMIT-TO                       PIC 99.
  6491     12  AM-ID-NO                          PIC X(11).
  6492
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 123
* EL156.cbl
  6493     12  AM-CAL-TABLE                      PIC XX.
  6494     12  AM-LF-DEVIATION                   PIC XXX.
  6495     12  AM-AH-DEVIATION                   PIC XXX.
  6496     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6497     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6498     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6499     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6500     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6501     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6502
  6503     12  AM-USER-FIELDS.
  6504         16  AM-FLD-1                      PIC XX.
  6505         16  AM-FLD-2                      PIC XX.
  6506         16  AM-FLD-3                      PIC XX.
  6507         16  AM-FLD-4                      PIC XX.
  6508         16  AM-FLD-5                      PIC XX.
  6509
  6510     12  AM-1ST-PROD-DATE.
  6511         16  AM-1ST-PROD-YR                PIC XX.
  6512         16  AM-1ST-PROD-MO                PIC XX.
  6513         16  AM-1ST-PROD-DA                PIC XX.
  6514     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6515     12  AM-CERTS-PURGED-DATE.
  6516         16  AM-PUR-YR                     PIC XX.
  6517         16  AM-PUR-MO                     PIC XX.
  6518         16  AM-PUR-DA                     PIC XX.
  6519     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6520     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6521     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6522     12  AM-INACTIVE-DATE.
  6523         16  AM-INA-MO                     PIC 99.
  6524         16  AM-INA-DA                     PIC 99.
  6525         16  AM-INA-YR                     PIC 99.
  6526     12  AM-AR-HI-CERT-DATE                PIC XX.
  6527
  6528     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6529     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6530
  6531     12  AM-OB-PAYMENT-MODE                PIC X.
  6532         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6533         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6534         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6535         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6536
  6537     12  AM-AH-ONLY-INDICATOR              PIC X.
  6538         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6539         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6540
  6541     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6542
  6543     12  AM-OVER-SHORT.
  6544         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6545         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6546
  6547     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6548     12  AM-DCC-CLP-STATE                  PIC XX.
  6549
  6550     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 124
* EL156.cbl
  6551     12  AM-RECALC-REIN                    PIC X.
  6552
  6553     12  AM-REI-TABLE                      PIC XXX.
  6554     12  AM-REI-ET-LF                      PIC X.
  6555     12  AM-REI-ET-AH                      PIC X.
  6556     12  AM-REI-PE-LF                      PIC X.
  6557     12  AM-REI-PE-AH                      PIC X.
  6558     12  AM-REI-PRT-ST                     PIC X.
  6559     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6560     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6561     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6562     12  AM-REI-GROUP-A                    PIC X(6).
  6563     12  AM-REI-MORT                       PIC X(4).
  6564     12  AM-REI-PRT-OW                     PIC X.
  6565     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6566     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6567     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6568     12  AM-REI-GROUP-B                    PIC X(6).
  6569
  6570     12  AM-TRUST-TYPE                     PIC X(2).
  6571
  6572     12  AM-EMPLOYER-STMT-USED             PIC X.
  6573     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6574
  6575     12  AM-STD-AH-TYPE                    PIC XX.
  6576     12  AM-EARN-METHODS.
  6577         16  AM-EARN-METHOD-R              PIC X.
  6578             88 AM-REF-RL-R78                 VALUE 'R'.
  6579             88 AM-REF-RL-PR                  VALUE 'P'.
  6580             88 AM-REF-RL-MEAN                VALUE 'M'.
  6581             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6582         16  AM-EARN-METHOD-L              PIC X.
  6583             88 AM-REF-LL-R78                 VALUE 'R'.
  6584             88 AM-REF-LL-PR                  VALUE 'P'.
  6585             88 AM-REF-LL-MEAN                VALUE 'M'.
  6586             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6587         16  AM-EARN-METHOD-A              PIC X.
  6588             88 AM-REF-AH-R78                 VALUE 'R'.
  6589             88 AM-REF-AH-PR                  VALUE 'P'.
  6590             88 AM-REF-AH-MEAN                VALUE 'M'.
  6591             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6592             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6593             88 AM-REF-AH-NET                 VALUE 'N'.
  6594
  6595     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6596     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6597     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6598
  6599     12  AM-RET-Y-N                        PIC X.
  6600     12  AM-RET-P-E                        PIC X.
  6601     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6602     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6603     12  AM-RET-GRP                        PIC X(6).
  6604     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6605         16  AM-POOL-PRIME                 PIC XXX.
  6606         16  AM-POOL-SUB                   PIC XXX.
  6607     12  AM-RETRO-EARNINGS.
  6608         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 125
* EL156.cbl
  6609         16  AM-RET-EARN-L                 PIC X.
  6610         16  AM-RET-EARN-A                 PIC X.
  6611     12  AM-RET-ST-TAX-USE                 PIC X.
  6612         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6613         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6614     12  AM-RETRO-BEG-EARNINGS.
  6615         16  AM-RET-BEG-EARN-R             PIC X.
  6616         16  AM-RET-BEG-EARN-L             PIC X.
  6617         16  AM-RET-BEG-EARN-A             PIC X.
  6618     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6619     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6620
  6621     12  AM-USER-SELECT-OPTIONS.
  6622         16  AM-USER-SELECT-1              PIC X(10).
  6623         16  AM-USER-SELECT-2              PIC X(10).
  6624         16  AM-USER-SELECT-3              PIC X(10).
  6625         16  AM-USER-SELECT-4              PIC X(10).
  6626         16  AM-USER-SELECT-5              PIC X(10).
  6627
  6628     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6629
  6630     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6631
  6632     12  AM-RPT045A-SWITCH                 PIC X.
  6633         88  RPT045A-OFF                   VALUE 'N'.
  6634
  6635     12  AM-INSURANCE-LIMITS.
  6636         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6637         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6638
  6639     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6640         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6641
  6642     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6643         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6644         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6645
  6646     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6647
  6648     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6649     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6650     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6651     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6652     12  AM-DCC-UEF-STATE                  PIC XX.
  6653     12  FILLER                            PIC XXX.
  6654     12  AM-REPORT-CODE-3                  PIC X(10).
  6655*    12  FILLER                            PIC X(22).
  6656
  6657     12  AM-RESERVE-DATE.
  6658         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6659         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6660         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6661
  6662     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6663     12  AM-NOTIFICATION-TYPES.
  6664         16  AM-NOTIF-OF-LETTERS           PIC X.
  6665         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6666         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 126
* EL156.cbl
  6667         16  AM-NOTIF-OF-STATUS            PIC X.
  6668
  6669     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6670         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6671         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6672         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6673         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6674
  6675     12  AM-BENEFIT-CONTROLS.
  6676         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6677             20  AM-BENEFIT-CODE           PIC XX.
  6678             20  AM-BENEFIT-TYPE           PIC X.
  6679             20  AM-BENEFIT-REVISION       PIC XXX.
  6680             20  AM-BENEFIT-REM-TERM       PIC X.
  6681             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6682             20  FILLER                    PIC XX.
  6683         16  FILLER                        PIC X(80).
  6684
  6685     12  AM-TRANSFER-DATA.
  6686         16  AM-TRANSFERRED-FROM.
  6687             20  AM-TRNFROM-CARRIER        PIC X.
  6688             20  AM-TRNFROM-GROUPING.
  6689                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6690                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6691             20  AM-TRNFROM-STATE          PIC XX.
  6692             20  AM-TRNFROM-ACCOUNT.
  6693                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6694                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6695             20  AM-TRNFROM-DTE            PIC XX.
  6696         16  AM-TRANSFERRED-TO.
  6697             20  AM-TRNTO-CARRIER          PIC X.
  6698             20  AM-TRNTO-GROUPING.
  6699                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6700                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6701             20  AM-TRNTO-STATE            PIC XX.
  6702             20  AM-TRNTO-ACCOUNT.
  6703                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6704                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6705             20  AM-TRNTO-DTE              PIC XX.
  6706         16  FILLER                        PIC X(10).
  6707
  6708     12  AM-SAVED-REMIT-TO                 PIC 99.
  6709
  6710     12  AM-COMM-STRUCTURE-SAVED.
  6711         16  AM-DEFN-1-SAVED.
  6712             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6713                 24  AM-AGT-SV             PIC X(10).
  6714                 24  AM-COM-TYP-SV         PIC X.
  6715                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6716                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6717                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6718                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6719                 24  FILLER                PIC X.
  6720                 24  AM-GL-CODES-SV        PIC X.
  6721                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6722                 24  FILLER                PIC X.
  6723         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6724             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 127
* EL156.cbl
  6725                 24  FILLER                PIC X(11).
  6726                 24  AM-L-COMA-SV          PIC XXX.
  6727                 24  AM-J-COMA-SV          PIC XXX.
  6728                 24  AM-A-COMA-SV          PIC XXX.
  6729                 24  FILLER                PIC X(6).
  6730
  6731     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6732         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6733            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6734            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6735            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6736
  6737     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6738     12  FILLER                            PIC X(120).
  6739
  6740     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6741         16  AM-CONTROL-NAME               PIC X(30).
  6742         16  AM-EXECUTIVE-ONE.
  6743             20  AM-EXEC1-NAME             PIC X(15).
  6744             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6745                                                          COMP-3.
  6746             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6747                                                          COMP-3.
  6748         16  AM-EXECUTIVE-TWO.
  6749             20  AM-EXEC2-NAME             PIC X(15).
  6750             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6751                                                          COMP-3.
  6752             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6753                                                          COMP-3.
  6754
  6755     12  AM-RETRO-ADDITIONAL-DATA.
  6756         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6757         16  AM-RETRO-PREM-P-E             PIC X.
  6758         16  AM-RETRO-CLMS-P-I             PIC X.
  6759         16  AM-RETRO-RET-BRACKET-LF.
  6760             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6761                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6762                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6763             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6764                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6765                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6766             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6767                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6768                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6769         16  AM-RETRO-RET-BRACKET-AH.
  6770             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6771                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6772                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6773                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6774             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6775                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6776                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6777             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6778                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6779                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6780
  6781     12  AM-COMMENTS.
  6782         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 128
* EL156.cbl
  6783
  6784     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6785         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6786         16  AM-FLI-BILLING-CODE           PIC X.
  6787         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6788         16  AM-FLI-UNITED-IDENT           PIC X.
  6789         16  AM-FLI-INTEREST-LOST-DATA.
  6790             20  AM-FLI-BANK-NO            PIC X(5).
  6791             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6792             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6793             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6794         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6795             20  AM-FLI-AGT                PIC X(9).
  6796             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6797             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6798         16  FILLER                        PIC X(102).
  6799
  6800     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6801         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6802             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6803             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6804             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6805             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6806             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6807         16  FILLER                          PIC X(10).
  6808******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 129
* EL156.cbl
  6810*    COPY ELCCHKQ.
  6811******************************************************************
  6812*                                                                *
  6813*                                                                *
  6814*                            ELCCHKQ.                            *
  6815*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6816*                            VMOD=2.007                          *
  6817*                                                                *
  6818*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6819*                                                                *
  6820*   FILE TYPE = VSAM,KSDS                                        *
  6821*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6822*                                                                *
  6823*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6824*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6825*                                                                *
  6826*   LOG = YES                                                    *
  6827*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6828******************************************************************
  6829 01  CHECK-QUE.
  6830     12  CQ-RECORD-ID                PIC XX.
  6831         88  VALID-CQ-ID         VALUE 'CQ'.
  6832
  6833     12  CQ-CONTROL-PRIMARY.
  6834         16  CQ-COMPANY-CD           PIC X.
  6835         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6836         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6837
  6838     12  CQ-CONTROL-BY-PAYEE.
  6839         16  CQ-CONTROL-BY-NUMBER.
  6840             20  CQ-COMPANY-CD-A1     PIC X.
  6841             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6842         16  CQ-PAYEE-CARRIER        PIC X.
  6843         16  CQ-PAYEE-GROUPING       PIC X(6).
  6844         16  CQ-PAYEE-STATE          PIC XX.
  6845         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6846         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6847
  6848     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6849         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6850         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6851         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6852         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6853         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6854         16  FILLER                  PIC X(3).
  6855
  6856     12  CQ-ENTRY-TYPE               PIC X.
  6857             88  CHECK-ON-QUE           VALUE 'Q'.
  6858             88  ALIGNMENT-CHECK        VALUE 'A'.
  6859             88  SPOILED-CHECK          VALUE 'S'.
  6860             88  PAYMENT-ABORTED        VALUE 'X'.
  6861
  6862     12  CQ-CLAIM-MAST-CNTL.
  6863         16  CQ-CARRIER              PIC X.
  6864         16  CQ-CLAIM-NO             PIC X(7).
  6865         16  CQ-CERT-NO.
  6866             20  CQ-CERT-PRIME       PIC X(10).
  6867             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 130
* EL156.cbl
  6868         16  CQ-CLAIM-TYPE           PIC X.
  6869             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6870             88  CQ-AH-CLAIM            VALUE 'A'.
  6871         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6872             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6873             88  CQ-O-B-COVERAGE        VALUE '2'.
  6874             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6875
  6876     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6877     12  CQ-CHECK-NUMBER             PIC X(7).
  6878     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6879     12  CQ-PAYMENT-TYPE             PIC X.
  6880             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6881             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6882             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6883             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6884             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6885             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6886             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6887             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6888     12  CQ-VOID-INDICATOR           PIC X.
  6889             88  CHECK-IS-STOPPED          VALUE 'S'.
  6890             88  CHECK-IS-VOID             VALUE 'V'.
  6891     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6892     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6893     12  CQ-CHECK-BY-USER            PIC X(4).
  6894     12  CQ-PRE-NUMBERING-SW         PIC X.
  6895       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6896       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6897
  6898     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6899     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6900     12  CQ-LEDGER-FLAG              PIC X(01).
  6901     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6902     12  CQ-LAST-UPDATED-DT          PIC XX.
  6903     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6904     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6905
  6906     12  FILLER                      PIC X(04).
  6907
  6908******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 131
* EL156.cbl
  6910*    COPY ELCBENE.
  6911******************************************************************
  6912*                                                                *
  6913*                            ELCBENE.                            *
  6914*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6915*                            VMOD=2.006                          *
  6916*                                                                *
  6917*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6918*                                                                *
  6919*   FILE TYPE = VSAM,KSDS                                        *
  6920*   RECORD SIZE = 500   RECFORM = FIX                            *
  6921*                                                                *
  6922*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6923*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6924*                                                                *
  6925*   LOG = YES                                                    *
  6926*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6927*                                                                *
  6928*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6929******************************************************************
  6930
  6931 01  BENEFICIARY-MASTER.
  6932     12  BE-RECORD-ID                PIC XX.
  6933         88  VALID-BE-ID                VALUE 'BE'.
  6934
  6935     12  BE-CONTROL-PRIMARY.
  6936         16  BE-COMPANY-CD           PIC X.
  6937         16  BE-RECORD-TYPE          PIC X.
  6938             88  BENEFICIARY-RECORD  VALUE 'B'.
  6939             88  ADJUSTOR-RECORD     VALUE 'A'.
  6940         16  BE-BENEFICIARY          PIC X(10).
  6941     12  BE-CONTROL-BY-NAME.
  6942         16  BE-COMPANY-CD-A1        PIC X.
  6943         16  BE-RECORD-TYPE-A1       PIC X.
  6944         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6945         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6946
  6947     12  BE-LAST-MAINT-DT            PIC XX.
  6948     12  BE-LAST-MAINT-BY            PIC X(4).
  6949     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6950
  6951     12  BE-ADDRESS-DATA.
  6952         16  BE-MAIL-TO-NAME         PIC X(30).
  6953         16  BE-ADDRESS-LINE-1       PIC X(30).
  6954         16  BE-ADDRESS-LINE-2       PIC X(30).
  6955         16  BE-ADDRESS-LINE-3       PIC X(30).
  6956         16  BE-CITY-STATE.
  6957             20  BE-CITY             PIC X(28).
  6958             20  BE-STATE            PIC XX.
  6959         16  BE-ZIP-CODE.
  6960             20  BE-ZIP-PRIME.
  6961                 24  BE-ZIP-1ST      PIC X.
  6962                     88  BE-CANADIAN-POST-CODE
  6963                                         VALUE 'A' THRU 'Z'.
  6964                 24  FILLER          PIC X(4).
  6965             20  BE-ZIP-PLUS4        PIC X(4).
  6966         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6967             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 132
* EL156.cbl
  6968             20  BE-CAN-POSTAL-2     PIC XXX.
  6969             20  FILLER              PIC XXX.
  6970         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6971         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6972
  6973******************************************************************
  6974*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6975*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6976******************************************************************
  6977     12  BE-CARRIER                  PIC X.
  6978
  6979     12  BE-ADDRESS-DATA2.
  6980         16  BE-MAIL-TO-NAME2        PIC X(30).
  6981         16  BE-ADDRESS-LINE-12      PIC X(30).
  6982         16  BE-ADDRESS-LINE-22      PIC X(30).
  6983         16  BE-ADDRESS-LINE-32      PIC X(30).
  6984         16  BE-CITY-STATE2.
  6985             20  BE-CITY2            PIC X(28).
  6986             20  BE-STATE2           PIC XX.
  6987         16  BE-ZIP-CODE2.
  6988             20  BE-ZIP-PRIME2.
  6989                 24  BE-ZIP-1ST2     PIC X.
  6990                     88  BE-CANADIAN-POST-CODE2
  6991                                         VALUE 'A' THRU 'Z'.
  6992                 24  FILLER          PIC X(4).
  6993             20  BE-ZIP-PLUS42       PIC X(4).
  6994         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6995             20  BE-CAN-POSTAL-12    PIC XXX.
  6996             20  BE-CAN-POSTAL-22    PIC XXX.
  6997             20  FILLER              PIC XXX.
  6998         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6999         16  BE-BILLING-STMT-DATA.
  7000             20  BE-BSR              PIC X.
  7001                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7002                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7003             20  BE-BSR-FROM         PIC X(30).
  7004             20  BE-BSR-DEPT         PIC X(30).
  7005             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7006             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7007             20  BE-OUTPUT-TYPE      PIC X.
  7008                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7009                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7010
  7011     12  FILLER                      PIC X(28).
  7012******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 133
* EL156.cbl
  7014*    COPY ELCARCH.
  7015******************************************************************
  7016*                                                                *
  7017*                            ELCARCH.                            *
  7018*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7019*                            VMOD=2.007                          *
  7020*                                                                *
  7021*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7022*                                                                *
  7023*   FILE TYPE = VSAM,KSDS                                        *
  7024*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7025*                                                                *
  7026*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7027*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7028*                                                                *
  7029*   LOG = NO                                                     *
  7030*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7031*                                                                *
  7032*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7033******************************************************************
  7034 01  LETTER-ARCHIVE.
  7035     12  LA-RECORD-ID                PIC XX.
  7036         88  VALID-LA-ID                VALUE 'LA'.
  7037
  7038     12  LA-CONTROL-PRIMARY.
  7039         16  LA-COMPANY-CD           PIC X.
  7040         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7041         16  LA-RECORD-TYPE          PIC X.
  7042             88  LA-HEADER-DATA         VALUE '1'.
  7043             88  LA-ADDRESS-DATA        VALUE '2'.
  7044             88  LA-TEXT-DATA           VALUE '3'.
  7045             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7046         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7047
  7048     12  LA-CONTROL-BY-TYPE.
  7049         16  LA-COMPANY-CD-A1        PIC X.
  7050         16  LA-RECORD-TYPE-A1       PIC X.
  7051         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7052         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7053
  7054     12  LA-TEXT-RECORD.
  7055         16  LA-SKIP-CONTROL         PIC XX.
  7056             88  NO-LINES-SKIPPED       VALUE SPACES.
  7057             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7058         16  LA-TEXT-LINE            PIC X(70).
  7059
  7060     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7061         16  FILLER                  PIC XX.
  7062         16  LA-ADDRESS-LINE         PIC X(30).
  7063         16  FILLER                  PIC X(40).
  7064
  7065     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7066         16  FILLER                  PIC XX.
  7067         16  LA-CARRIER              PIC X.
  7068         16  LA-CLAIM-NO             PIC X(7).
  7069         16  LA-CERT-NO.
  7070             20  LA-CERT-PRIME       PIC X(10).
  7071             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 134
* EL156.cbl
  7072         16  LA-NO-OF-COPIES         PIC S9.
  7073         16  LA-RESEND-DATE          PIC XX.
  7074         16  LA-PROCESSOR-CD         PIC X(4).
  7075         16  LA-CREATION-DT          PIC XX.
  7076         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7077         16  LA-RESEND-PRINT-DATE    PIC XX.
  7078         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7079         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7080*
  7081* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7082*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7083*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7084*   I        20  LA-DMD-RES-ST           PIC XX.
  7085*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7086*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7087*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7088*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7089*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7090*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7091*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7092*   I        20  LA-DMD-UND-CODE         PIC XX.
  7093*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7094*   V    16  FILLER                  PIC X(15).
  7095* -----
  7096*
  7097* REINSERTED  CSO  MODS
  7098*
  7099         16  FILLER.
  7100             20  FILLER                  PIC X(29).
  7101             20  LA-CSO-LETTER-STATUS    PIC X.
  7102                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7103                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7104                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7105             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7106             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7107*
  7108
  7109     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7110         16  FILLER                  PIC XX.
  7111         16  LA4-CARRIER             PIC X.
  7112         16  LA4-CLAIM-NO            PIC X(7).
  7113         16  LA4-CERT-NO.
  7114             20  LA4-CERT-PRIME      PIC X(10).
  7115             20  LA4-CERT-SFX        PIC X.
  7116         16  LA4-NO-OF-COPIES        PIC S9.
  7117         16  LA4-RESEND-DATE         PIC XX.
  7118         16  LA4-PROCESSOR-CD        PIC X(4).
  7119         16  LA4-CREATION-DT         PIC XX.
  7120         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7121         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7122         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7123         16  LA4-FORM-TYPE           PIC X.
  7124             88  LA4-INITIAL-FORM    VALUE '1'.
  7125             88  LA4-PROGRESS-FORM   VALUE '2'.
  7126         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7127         16  LA4-STATE               PIC X(02).
  7128         16  FILLER                  PIC X(31).
  7129******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 135
* EL156.cbl
  7131*    COPY ELCDAR.
  7132******************************************************************
  7133*                                                                *
  7134*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7135*   FILE TYPE = VSAM,KSDS                                        *
  7136*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7137*   BASE CLUSTER = DLYACTV                                       *
  7138*   LOG = YES                                                    *
  7139*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7140*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7141*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7142*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7143*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7144*               BY PROGRAM "LGINFCE".                            *
  7145*                                                                *
  7146******************************************************************
  7147 01  DAILY-ACTIVITY-RECORD.
  7148     05  DA-KEY.
  7149         10  DA-COMP-CD          PIC X.
  7150         10  DA-CARRIER          PIC X.
  7151         10  DA-CLAIM-NO         PIC X(7).
  7152         10  DA-CERT-NO.
  7153             15  DA-CERT-PRIME   PIC X(10).
  7154             15  DA-CERT-SFX     PIC X.
  7155     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7156     05  DA-RECORD-TYPE          PIC X.
  7157     05  FILLER                  PIC X(2).
  7158******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 136
* EL156.cbl
  7160*    COPY ERCCOMP.
  7161******************************************************************
  7162*                                                                *
  7163*                                                                *
  7164*                            ERCCOMP                             *
  7165*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7166*                            VMOD=2.019                          *
  7167*                                                                *
  7168*   ONLINE CREDIT SYSTEM                                         *
  7169*                                                                *
  7170*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7171*                                                                *
  7172*   FILE TYPE = VSAM,KSDS                                        *
  7173*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7174*                                                                *
  7175*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7176*       ALTERNATE PATH = NONE                                    *
  7177*                                                                *
  7178*   LOG = NO                                                     *
  7179*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7180*                                                                *
  7181******************************************************************
  7182*                   C H A N G E   L O G
  7183*
  7184* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7185*-----------------------------------------------------------------
  7186*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7187* EFFECTIVE    NUMBER
  7188*-----------------------------------------------------------------
  7189* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7190* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7191* 092205    2005050300006  PEMA  ADD LEASE FEE
  7192* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7193* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7194* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7195* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7196* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7197* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7198******************************************************************
  7199
  7200 01  COMPENSATION-MASTER.
  7201     12  CO-RECORD-ID                          PIC XX.
  7202         88  VALID-CO-ID                          VALUE 'CO'.
  7203
  7204     12  CO-CONTROL-PRIMARY.
  7205         16  CO-COMPANY-CD                     PIC X.
  7206         16  CO-CONTROL.
  7207             20  CO-CTL-1.
  7208                 24  CO-CARR-GROUP.
  7209                     28  CO-CARRIER            PIC X.
  7210                     28  CO-GROUPING.
  7211                         32  CO-GROUP-PREFIX   PIC XXX.
  7212                         32  CO-GROUP-PRIME    PIC XXX.
  7213                 24  CO-RESP-NO.
  7214                     28  CO-RESP-PREFIX        PIC X(4).
  7215                     28  CO-RESP-PRIME         PIC X(6).
  7216             20  CO-CTL-2.
  7217                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 137
* EL156.cbl
  7218                     28  CO-ACCT-PREFIX        PIC X(4).
  7219                     28  CO-ACCT-PRIME         PIC X(6).
  7220         16  CO-TYPE                           PIC X.
  7221             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7222             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7223             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7224
  7225     12  CO-MAINT-INFORMATION.
  7226         16  CO-LAST-MAINT-DT                  PIC XX.
  7227         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7228         16  CO-LAST-MAINT-USER                PIC X(4).
  7229     12  FILLER                                PIC XX.
  7230     12  CO-STMT-TYPE                          PIC XXX.
  7231     12  CO-COMP-TYPE                          PIC X.
  7232         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7233     12  CO-STMT-OWNER                         PIC X(4).
  7234     12  CO-BALANCE-CONTROL                    PIC X.
  7235         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7236         88  CO-NO-BALANCE                        VALUE 'N'.
  7237
  7238     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7239         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7240         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7241         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7242
  7243     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7244         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7245         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7246
  7247     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7248     12  CO-GA-DIRECT-DEP                      PIC X.
  7249     12  CO-FUTURE-SPACE                       PIC X.
  7250         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7251
  7252     12  CO-ACCT-NAME                          PIC X(30).
  7253     12  CO-MAIL-NAME                          PIC X(30).
  7254     12  CO-ADDR-1                             PIC X(30).
  7255     12  CO-ADDR-2                             PIC X(30).
  7256     12  CO-ADDR-3.
  7257         16  CO-ADDR-CITY                      PIC X(27).
  7258         16  CO-ADDR-STATE                     PIC XX.
  7259     12  CO-CSO-1099                           PIC X.
  7260     12  CO-ZIP.
  7261         16  CO-ZIP-PRIME.
  7262             20  CO-ZIP-PRI-1ST                PIC X.
  7263                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7264             20  FILLER                        PIC X(4).
  7265         16  CO-ZIP-PLUS4                      PIC X(4).
  7266     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7267         16  CO-CAN-POSTAL-1                   PIC XXX.
  7268         16  CO-CAN-POSTAL-2                   PIC XXX.
  7269         16  FILLER                            PIC XXX.
  7270     12  CO-SOC-SEC                            PIC X(13).
  7271     12  CO-TELEPHONE.
  7272         16  CO-AREA-CODE                      PIC XXX.
  7273         16  CO-PREFIX                         PIC XXX.
  7274         16  CO-PHONE                          PIC X(4).
  7275
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 138
* EL156.cbl
  7276     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7277
  7278     12  CO-AR-BAL-LEVEL                       PIC X.
  7279         88  CO-AR-REF-LVL                        VALUE '1'.
  7280         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7281         88  CO-AR-BILL-LVL                       VALUE '2'.
  7282         88  CO-AR-AGT-LVL                        VALUE '3'.
  7283         88  CO-AR-FR-LVL                         VALUE '4'.
  7284
  7285     12  CO-AR-NORMAL-PRINT                    PIC X.
  7286         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7287         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7288
  7289     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7290
  7291     12  CO-AR-REPORTING                       PIC X.
  7292         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7293         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7294
  7295     12  CO-AR-PULL-CHECK                      PIC X.
  7296         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7297         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7298
  7299     12  CO-AR-BALANCE-PRINT                   PIC X.
  7300         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7301
  7302     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7303         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7304         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7305         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7306
  7307     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7308
  7309     12  CO-USER-CODE                          PIC X.
  7310     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7311
  7312******************************************************************
  7313*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7314*    THE LAST MONTH END RUN.
  7315******************************************************************
  7316
  7317     12  CO-LAST-ACTIVITY-DATE.
  7318         16  CO-ACT-YEAR                       PIC 99.
  7319         16  CO-ACT-MONTH                      PIC 99.
  7320         16  CO-ACT-DAY                        PIC 99.
  7321
  7322     12  CO-LAST-STMT-DT.
  7323         16  CO-LAST-STMT-YEAR                 PIC 99.
  7324         16  CO-LAST-STMT-MONTH                PIC 99.
  7325         16  CO-LAST-STMT-DAY                  PIC 99.
  7326
  7327     12  CO-MO-END-TOTALS.
  7328         16  CO-MONTHLY-TOTALS.
  7329             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7330             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7331             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7332             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7333             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 139
* EL156.cbl
  7334
  7335         16  CO-AGING-TOTALS.
  7336             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7337             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7338             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7339             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7340
  7341         16  CO-YTD-TOTALS.
  7342             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7343             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7344
  7345         16  CO-OVER-UNDER-TOTALS.
  7346             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7347             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7348
  7349     12  CO-MISCELLANEOUS-TOTALS.
  7350         16  CO-FICA-TOTALS.
  7351             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7352             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7353
  7354         16  CO-CLAIM-TOTALS.
  7355             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7356             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7357
  7358******************************************************************
  7359*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7360*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7361******************************************************************
  7362
  7363     12  CO-CURRENT-TOTALS.
  7364         16  CO-CURRENT-LAST-STMT-DT.
  7365             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7366             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7367             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7368
  7369         16  CO-CURRENT-MONTHLY-TOTALS.
  7370             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7371             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7372             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7373             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7374             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7375
  7376         16  CO-CURRENT-AGING-TOTALS.
  7377             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7378             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7379             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7380             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7381
  7382         16  CO-CURRENT-YTD-TOTALS.
  7383             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7384             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7385
  7386     12  CO-PAID-COMM-TOTALS.
  7387         16  CO-YTD-PAID-COMMS.
  7388             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7389             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7390
  7391     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 140
* EL156.cbl
  7392         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7393         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7394
  7395     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7396         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7397         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7398         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7399         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7400         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7401         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7402         88  CO-FINAL-LETTER                  VALUE 'F'.
  7403         88  CO-RECONCILING                   VALUE 'R'.
  7404         88  CO-PHONE-CALL                    VALUE 'P'.
  7405         88  CO-LEGAL                         VALUE 'L'.
  7406         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7407         88  CO-WRITE-OFF                     VALUE 'W'.
  7408         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7409
  7410     12  CO-CSR-CODE                       PIC X(4).
  7411
  7412     12  CO-GA-STATUS-INFO.
  7413         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7414         16  CO-GA-TERMINATION-DT          PIC XX.
  7415         16  CO-GA-STATUS-CODE             PIC X.
  7416             88  CO-GA-ACTIVE                 VALUE 'A'.
  7417             88  CO-GA-INACTIVE               VALUE 'I'.
  7418             88  CO-GA-PENDING                VALUE 'P'.
  7419         16  CO-GA-COMMENTS.
  7420             20  CO-GA-COMMENT-1           PIC X(40).
  7421             20  CO-GA-COMMENT-2           PIC X(40).
  7422             20  CO-GA-COMMENT-3           PIC X(40).
  7423             20  CO-GA-COMMENT-4           PIC X(40).
  7424
  7425     12  CO-RPTCD2                         PIC X(10).
  7426     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7427         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7428         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7429
  7430     12  CO-TYPE-AGENT                     PIC X(01).
  7431         88  CO-CORPORATION                   VALUE 'C'.
  7432         88  CO-PARTNERSHIP                   VALUE 'P'.
  7433         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7434         88  CO-TRUST                         VALUE 'T'.
  7435         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7436
  7437     12  CO-FAXNO.
  7438         16  CO-FAX-AREA-CODE                  PIC XXX.
  7439         16  CO-FAX-PREFIX                     PIC XXX.
  7440         16  CO-FAX-PHONE                      PIC X(4).
  7441
  7442     12  CO-BANK-INFORMATION.
  7443         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7444         16  CO-BANK-TRANSIT-NON REDEFINES
  7445             CO-BANK-TRANSIT-NO                PIC 9(8).
  7446
  7447         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7448     12  CO-MISC-DEDUCT-INFO REDEFINES
  7449                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 141
* EL156.cbl
  7450         16  CO-MD-GL-ACCT                     PIC X(10).
  7451         16  CO-MD-DIV                         PIC XX.
  7452         16  CO-MD-CENTER                      PIC X(4).
  7453         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7454         16  CO-CREATE-AP-CHECK                PIC X.
  7455         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7456         16  FILLER                            PIC XXX.
  7457     12  CO-ACH-STATUS                         PIC X.
  7458         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7459         88  CO-ACH-PENDING                        VALUE 'P'.
  7460
  7461     12  CO-BILL-SW                            PIC X.
  7462     12  CO-CONTROL-NAME                       PIC X(30).
  7463     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7464     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7465     12  CO-CLP-STATE                          PIC XX.
  7466     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7467     12  CO-SPP-REFUND-EDIT                    PIC X.
  7468
  7469******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 142
* EL156.cbl
  7471*    COPY ERCDMDNT.
  7472******************************************************************
  7473*                                                                *
  7474*                            ERCDMDNT                            *
  7475*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7476*                            VMOD=2.005                          *
  7477*                                                                *
  7478*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7479*                                                                *
  7480*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7481*                                                                *
  7482*        FILE TYPE= VSAM,KSDS                                    *
  7483*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7484*                                                                *
  7485*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7486*                                                                *
  7487*        LOG = YES                                               *
  7488*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7489*                                                                *
  7490******************************************************************
  7491
  7492 01  CERTIFICATE-NOTE.
  7493     12  CN-RECORD-ID                     PIC  XX.
  7494         88  VALID-CN-ID                      VALUE 'CN'.
  7495
  7496     12  CN-CONTROL-PRIMARY.
  7497         16  CN-COMPANY-CD                PIC X.
  7498         16  CN-CERT-KEY.
  7499             20  CN-CARRIER               PIC X.
  7500             20  CN-GROUPING.
  7501                 24  CN-GROUPING-PREFIX   PIC XXX.
  7502                 24  CN-GROUPING-PRIME    PIC XXX.
  7503             20  CN-STATE                 PIC XX.
  7504             20  CN-ACCOUNT.
  7505                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7506                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7507             20  CN-CERT-EFF-DT           PIC XX.
  7508             20  CN-CERT-NO.
  7509                 24  CN-CERT-PRIME        PIC X(10).
  7510                 24  CN-CERT-SFX          PIC X.
  7511
  7512     12  CN-BILLING-START-LINE-NO         PIC 99.
  7513     12  CN-BILLING-END-LINE-NO           PIC 99.
  7514
  7515     12  CN-LINES.
  7516         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7517
  7518     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7519         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7520         16  CN-CSI-GENERAL-DATA-AREA.
  7521             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7522
  7523         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7524             CN-CSI-GENERAL-DATA-AREA.
  7525             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7526             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7527             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7528             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 143
* EL156.cbl
  7529             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7530             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7531             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7532             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7533             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7534             20  FILLER                       PIC XX.
  7535             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7536             20  FILLER                       PIC X(38).
  7537
  7538         16  CN-CSI-PRODUCT-DATA-AREA.
  7539             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7540
  7541         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7542             CN-CSI-PRODUCT-DATA-AREA.
  7543             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7544             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7545             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7546             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7547             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7548             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7549             20  FILLER                   PIC XX.
  7550             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7551             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7552             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7553             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7554             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7555             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7556             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7557             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7558             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7559             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7560             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7561             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7562             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7563             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7564             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7565             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7566             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7567             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7568             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7569             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7570             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7571             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7572             20  FILLER                   PIC X(25).
  7573
  7574         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7575             CN-CSI-CREDIT-CARD-DATA.
  7576             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7577             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7578             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7579             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7580             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7581             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7582             20  FILLER                   PIC XX.
  7583             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7584             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7585             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7586             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 144
* EL156.cbl
  7587             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7588             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7589             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7590             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7591             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7592             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7593             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7594             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7595             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7596             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7597             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7598             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7599             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7600             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7601             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7602             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7603             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7604             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7605             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7606             20  FILLER                   PIC X(17).
  7607
  7608         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7609             CN-CSI-FAMILY-LEAVE-DATA.
  7610             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7611             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7612             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7613             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7614             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7615             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7616             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7617             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7618             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7619             20  CN-CSI-SL-INT-ON-PROCEEDS
  7620                                          PIC S9(5)V99  COMP-3.
  7621             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7622             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7623             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7624             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7625             20  CN-CSI-SL-POLICY-BENEFITS
  7626                                          PIC S9(5)V99  COMP-3.
  7627             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7628             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7629             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7630             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7631             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7632             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7633             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7634             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7635             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7636             20  CN-CSI-SL-STATE-NOT      PIC X.
  7637             20  FILLER                   PIC XX.
  7638
  7639         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7640             CN-CSI-SENIOR-LIFE-DATA.
  7641             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7642             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7643             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7644                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 145
* EL156.cbl
  7645             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7646             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7647             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7648             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7649             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7650             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7651             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7652             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7653             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7654             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7655             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7656             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7657             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7658             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7659             20  CN-CSI-PP-REPAIR         PIC X.
  7660             20  CN-CSI-PP-REPLACE        PIC X.
  7661             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7662             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7663             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7664             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7665             20  FILLER                   PIC X(5).
  7666
  7667         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7668             CN-CSI-PURCH-PROP-DATA.
  7669             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7670             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7671             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7672             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7673             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7674             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7675             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7676             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7677             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7678             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7679             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7680             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7681             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7682             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7683             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7684             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7685             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7686             20  CN-CSI-EW-REPLACE        PIC X.
  7687             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7688             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7689             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7690             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7691             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7692             20  FILLER                   PIC X(4).
  7693
  7694     12  CN-LAST-MAINT-DT                 PIC XX.
  7695     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7696     12  CN-LAST-MAINT-USER               PIC X(4).
  7697     12  FILLER                           PIC X(6).
  7698
  7699******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 146
* EL156.cbl
  7701*    COPY ERCCNOT.
  7702******************************************************************
  7703*                                                                *
  7704*                            ERCCNOT                             *
  7705*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7706*                            VMOD=2.003                          *
  7707*                                                                *
  7708*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7709*                                                                *
  7710*        FILE TYPE= VSAM,KSDS                                    *
  7711*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7712*                                                                *
  7713*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7714*                                                                *
  7715*        LOG = YES                                               *
  7716*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7717*                                                                *
  7718******************************************************************
  7719*                   C H A N G E   L O G
  7720*
  7721* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7722*-----------------------------------------------------------------
  7723*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7724* EFFECTIVE    NUMBER
  7725*-----------------------------------------------------------------
  7726* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7727******************************************************************
  7728
  7729 01  CERT-NOTE-FILE.
  7730     12  CZ-RECORD-ID                PIC  XX.
  7731         88  VALID-CZ-ID                  VALUE 'CZ'.
  7732
  7733     12  CZ-CONTROL-PRIMARY.
  7734         16  CZ-COMPANY-CD           PIC X.
  7735         16  CZ-CARRIER              PIC X.
  7736         16  CZ-GROUPING.
  7737             20 CZ-GROUPING-PREFIX   PIC XXX.
  7738             20 CZ-GROUPING-PRIME    PIC XXX.
  7739         16  CZ-STATE                PIC XX.
  7740         16  CZ-ACCOUNT.
  7741             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7742             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7743         16  CZ-CERT-EFF-DT          PIC XX.
  7744         16  CZ-CERT-NO.
  7745             20  CZ-CERT-PRIME       PIC X(10).
  7746             20  CZ-CERT-SFX         PIC X.
  7747         16  CZ-RECORD-TYPE          PIC X.
  7748             88  CERT-NOTE           VALUE '1'.
  7749             88  CLAIM-CERT-NOTE     VALUE '2'.
  7750         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7751
  7752     12  CZ-LAST-MAINT-DT            PIC XX.
  7753     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7754     12  CZ-LAST-MAINT-USER          PIC X(4).
  7755
  7756     12  CZ-NOTE-INFORMATION.
  7757         16  CZ-NOTE                 PIC X(63).
  7758         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 147
* EL156.cbl
  7759******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 148
* EL156.cbl
  7761 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7762                          CONTROL-FILE CERTIFICATE-MASTER
  7763                          ACTIVITY-TRAILERS ACTIVITY-QUE
  7764                          ACCOUNT-MASTER CHECK-QUE
  7765                          BENEFICIARY-MASTER LETTER-ARCHIVE
  7766                          DAILY-ACTIVITY-RECORD
  7767                          COMPENSATION-MASTER CERTIFICATE-NOTE
  7768                          CERT-NOTE-FILE.
  7769 0000-DFHEXIT SECTION.
  7770     MOVE '9#                    $   ' TO DFHEIV0.
  7771     MOVE 'EL156' TO DFHEIV1.
  7772     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7773
  7774     IF EIBCALEN = 0
  7775         GO TO 8800-UNAUTHORIZED-ACCESS.
  7776
  7777     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7778     MOVE EIBTRMID               TO QID-TERM.
  7779     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7780     MOVE '2'                    TO EMI-SWITCH2.
  7781     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7782     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7783
  7784     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7785     MOVE '5'                    TO DC-OPTION-CODE.
  7786     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7787     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  7788                                    SAVE-BIN-DATE.
  7789     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  7790     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  7791
  7792     IF SAVE-DATE-YY > 70
  7793         MOVE 19                 TO SAVE-DATE-CC
  7794     ELSE
  7795         MOVE 20                 TO SAVE-DATE-CC.
  7796
  7797     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  7798         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  7799     END-IF.
  7800
  7801     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  7802        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  7803     ELSE
  7804        MOVE 'N'                 TO WS-PRINT-EOB-YN
  7805     END-IF
  7806
  7807     IF PI-PRINT-CLM-FRM-YN = 'N'
  7808         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  7809     ELSE
  7810         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  7811     END-IF
  7812
  7813     IF PI-PRINT-SURVEY-YN = 'N'
  7814         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  7815     ELSE
  7816         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  7817     END-IF
  7818
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 149
* EL156.cbl
  7819* EXEC CICS HANDLE CONDITION
  7820*        NOTOPEN   (9990-ABEND)
  7821*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  7822*        MAPFAIL   (0400-FIRST-TIME)
  7823*        DUPREC    (6180-DUPREC)
  7824*        ERROR     (9990-ABEND)
  7825*    END-EXEC.
  7826*    MOVE '"$JL?%.               ! " #00007814' TO DFHEIV0
  7827     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  7828     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7829     MOVE X'2220233030303037383134' TO DFHEIV0(25:11)
  7830     CALL 'kxdfhei1' USING DFHEIV0
  7831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7832
  7833
  7834     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7835         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  7836
  7837     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7838         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7839             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7840             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7841             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7842             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7843             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7844             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7845             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7846             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7847             MOVE LOW-VALUES           TO EL156AI
  7848             MOVE 'Y'                  TO FIRST-ENTRY
  7849         ELSE
  7850             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7851             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7852             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7853             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7854             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7855             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7856             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7857             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  7858
  7859     IF RETURNED-FROM NOT = SPACES
  7860        IF (RETURNED-FROM = 'EL614')
  7861           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  7862           IF WS-SAVED-EOB-CODES NOT = SPACES
  7863              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  7864           ELSE
  7865              MOVE 'N'                TO WS-SET-NOTE2-MDT
  7866           END-IF
  7867        END-IF
  7868         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  7869            MOVE 'Y'             TO FIRST-ENTRY
  7870            IF RETURNED-FROM = 'EL614'
  7871               AND (PI-PASS-SW NOT = 'C')
  7872               IF WS-SAVED-EOB-CODES NOT = SPACES
  7873                  MOVE WS-SAVED-EOB-CODES
  7874                                 TO PI-PMTNOTE2
  7875                                    WS-PMTNOTE2
  7876                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 150
* EL156.cbl
  7877               ELSE
  7878                  MOVE SPACES    TO PI-PMTNOTE2
  7879                                    WS-PMTNOTE2
  7880                                    PI-EOB-CODES-EXIST
  7881               END-IF
  7882            END-IF
  7883            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  7884            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  7885            IF RETURNED-FROM = 'EL614'
  7886               GO TO 1000-EDIT-DATA
  7887            END-IF
  7888            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  7889               (PAYEEI   = LOW-VALUES OR SPACES)
  7890               GO TO 8100-SEND-INITIAL-MAP
  7891            ELSE
  7892               GO TO 1000-EDIT-DATA.
  7893
  7894     IF EIBTRNID NOT = TRANS-ID
  7895         GO TO 0400-FIRST-TIME.
  7896
  7897     IF EIBAID = DFHCLEAR
  7898        IF PI-PASS-SW = 'C'
  7899           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  7900           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  7901           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  7902           MOVE 'Y'            TO RETURNED-FROM-B
  7903           GO TO 1000-EDIT-DATA
  7904        ELSE
  7905           GO TO 9400-CLEAR.
  7906
  7907     IF PI-PASS-SW = 'C'
  7908         MOVE MAP-NAMEB          TO MAP-NAME
  7909         IF EIBAID = DFHPF1 OR DFHPF13
  7910             GO TO 5000-UPDATE
  7911           ELSE
  7912             IF EIBAID NOT = DFHENTER
  7913                 MOVE LOW-VALUES TO EL156BI
  7914                 MOVE MAP-NAMEB  TO MAP-NAME
  7915                 MOVE ER-0029    TO EMI-ERROR
  7916                 MOVE -1         TO  ENTPFBL
  7917                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7918                 GO TO 8200-SEND-DATAONLY.
  7919
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 151
* EL156.cbl
  7921 0200-RECEIVE.
  7922     MOVE LOW-VALUES             TO EL156AI.
  7923     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7924         MOVE ER-0008            TO EMI-ERROR
  7925         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7926         IF PI-PASS-SW = 'C'
  7927             MOVE -1             TO ENTPFBL
  7928             GO TO 8200-SEND-DATAONLY
  7929         ELSE
  7930             MOVE -1             TO PMTTYPEL
  7931             GO TO 8200-SEND-DATAONLY.
  7932
  7933     IF PI-COMPANY-ID = 'DMD'
  7934         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  7935
  7936     IF PI-PASS-SW = 'C'
  7937         MOVE MAP-NAMEB          TO MAP-NAME.
  7938
  7939
  7940* EXEC CICS RECEIVE
  7941*        MAP   (MAP-NAME)
  7942*        MAPSET(MAPSET-NAME)
  7943*        ASIS
  7944*        INTO  (EL156AI)
  7945*    END-EXEC.
  7946     MOVE LENGTH OF
  7947      EL156AI
  7948       TO DFHEIV11
  7949*    MOVE '8"TAI  L              ''   #00007927' TO DFHEIV0
  7950     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  7951     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7952     MOVE X'2020233030303037393237' TO DFHEIV0(25:11)
  7953     CALL 'kxdfhei1' USING DFHEIV0,
  7954           MAP-NAME,
  7955           EL156AI,
  7956           DFHEIV11,
  7957           MAPSET-NAME,
  7958           DFHEIV99,
  7959           DFHEIV99
  7960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7961
  7962
  7963     IF PI-PASS-SW NOT = 'C'
  7964         GO TO 0250-MAPA.
  7965
  7966     IF ENTPFBL NOT > ZERO
  7967         MOVE MAP-NAMEB          TO MAP-NAME
  7968         MOVE ER-0029            TO EMI-ERROR
  7969         MOVE -1                 TO  ENTPFBL
  7970         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7971         GO TO 8200-SEND-DATAONLY.
  7972
  7973     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  7974         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  7975       ELSE
  7976         MOVE MAP-NAMEB           TO MAP-NAME
  7977         MOVE ER-0029             TO EMI-ERROR
  7978         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 152
* EL156.cbl
  7979         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7980         GO TO 8200-SEND-DATAONLY.
  7981
  7982     IF EIBAID = DFHPF1 OR DFHPF13
  7983         IF MODIFY-CAP
  7984            GO TO 5000-UPDATE
  7985          ELSE
  7986            MOVE 'UPDATE'           TO SM-READ
  7987            PERFORM 9995-SECURITY-VIOLATION
  7988            MOVE MAP-NAMEB          TO MAP-NAME
  7989            MOVE ER-0070            TO EMI-ERROR
  7990            MOVE -1                 TO  ENTPFBL
  7991            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7992            GO TO 8200-SEND-DATAONLY.
  7993
  7994 0250-MAPA.
  7995     IF ENTERPFL = 0
  7996         GO TO 0300-CHECK-PFKEYS.
  7997
  7998     IF EIBAID NOT = DFHENTER
  7999         MOVE ER-0004            TO EMI-ERROR
  8000         GO TO 0320-INPUT-ERROR.
  8001
  8002     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8003         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8004     ELSE
  8005         MOVE ER-0029            TO EMI-ERROR
  8006         GO TO 0320-INPUT-ERROR.
  8007
  8008 0300-CHECK-PFKEYS.
  8009     IF EIBAID = DFHPF7 OR DFHPF8
  8010         GO TO 8820-PF7-8.
  8011
  8012     IF EIBAID = DFHPF23
  8013         GO TO 8810-PF23.
  8014
  8015     IF EIBAID = DFHPF24
  8016         GO TO 9200-RETURN-MAIN-MENU.
  8017
  8018     IF EIBAID = DFHPF12
  8019         GO TO 9500-PF12.
  8020
  8021     IF EIBAID = DFHPF1
  8022        IF PI-PASS-SW = 'A' OR 'B'
  8023          GO TO 0330-BROWSE-FORWARD.
  8024
  8025     IF EIBAID = DFHPF2
  8026        IF PI-PASS-SW = 'A' OR 'B'
  8027          GO TO 0350-BROWSE-BACKWARD.
  8028
  8029     IF EIBAID = DFHPF6
  8030        IF PI-EOB-CODES-EXIST = 'Y'
  8031           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8032        ELSE
  8033           MOVE SPACES              TO WS-PMTNOTE2
  8034        END-IF
  8035         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8036         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 153
* EL156.cbl
  8037            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8038         END-IF
  8039         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8040         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8041             MOVE 'EL614'        TO PGM-NAME
  8042             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8043             GO TO 9300-XCTL
  8044         ELSE
  8045             MOVE XCTL-157       TO PGM-NAME
  8046             GO TO 9300-XCTL.
  8047
  8048     IF EIBAID = DFHPF9
  8049        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8050        MOVE XCTL-141            TO PGM-NAME
  8051        GO TO 9300-XCTL.
  8052
  8053     IF EIBAID = DFHPF10
  8054        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8055        MOVE XCTL-155            TO PGM-NAME
  8056        GO TO 9300-XCTL.
  8057
  8058     MOVE SPACES                 TO ERRMSG0O
  8059                                    ERRMSG1O
  8060                                    ERRMSG2O.
  8061
  8062     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8063         IF PI-PASS-SW NOT = 'B'
  8064             MOVE ER-0422        TO EMI-ERROR
  8065             GO TO 0320-INPUT-ERROR
  8066           ELSE
  8067             GO TO 0700-TEST-FOR-CHANGES.
  8068
  8069     IF EIBAID = DFHPF11
  8070        IF PI-PASS-SW = 'C'
  8071           MOVE ER-0029          TO EMI-ERROR
  8072           GO TO 0320-INPUT-ERROR.
  8073
  8074     IF EIBAID = DFHENTER OR DFHPF11
  8075        NEXT SENTENCE
  8076     ELSE
  8077        MOVE ER-0029             TO EMI-ERROR
  8078        GO TO 0320-INPUT-ERROR.
  8079
  8080     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8081
  8082     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8083         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8084         GO TO 1000-EDIT-DATA
  8085     ELSE
  8086         IF PI-FATAL-COUNT NOT = 0 OR
  8087            PI-FORCE-COUNT NOT = 0
  8088             GO TO 1000-EDIT-DATA
  8089         ELSE
  8090             GO TO 2000-EDIT-DONE.
  8091
  8092 0320-INPUT-ERROR.
  8093     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8094
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 154
* EL156.cbl
  8095     IF ENTERPFL = 0
  8096         MOVE -1                 TO PMTTYPEL
  8097     ELSE
  8098         MOVE AL-UNBON           TO ENTERPFA
  8099         MOVE -1                 TO ENTERPFL.
  8100
  8101     GO TO 8200-SEND-DATAONLY.
  8102
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 155
* EL156.cbl
  8104 0330-BROWSE-FORWARD.
  8105
  8106     MOVE CLMNOI            TO PI-CLAIM-NO.
  8107     MOVE CARRI             TO PI-CARRIER.
  8108     MOVE CERTNOI           TO PI-CERT-PRIME.
  8109     MOVE SUFXI             TO PI-CERT-SFX.
  8110
  8111     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8112     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8113     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8114     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8115
  8116     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8117
  8118
  8119* EXEC CICS HANDLE CONDITION
  8120*         NOTFND   (0380-CLAIM-END-FILE)
  8121*         ENDFILE  (0380-CLAIM-END-FILE)
  8122*    END-EXEC.
  8123*    MOVE '"$I''                  ! # #00008089' TO DFHEIV0
  8124     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8125     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8126     MOVE X'2320233030303038303839' TO DFHEIV0(25:11)
  8127     CALL 'kxdfhei1' USING DFHEIV0
  8128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8129
  8130
  8131
  8132* EXEC CICS STARTBR
  8133*         DATASET    ('ELMSTR')
  8134*         RIDFLD     (ELMSTR-KEY)
  8135*         GTEQ
  8136*    END-EXEC.
  8137     MOVE 'ELMSTR' TO DFHEIV1
  8138     MOVE 0
  8139       TO DFHEIV11
  8140*    MOVE '&,         G          &   #00008094' TO DFHEIV0
  8141     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8142     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8143     MOVE X'2020233030303038303934' TO DFHEIV0(25:11)
  8144     CALL 'kxdfhei1' USING DFHEIV0,
  8145           DFHEIV1,
  8146           ELMSTR-KEY,
  8147           DFHEIV99,
  8148           DFHEIV11,
  8149           DFHEIV99
  8150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8151
  8152
  8153     MOVE 'Y' TO WS-BROWSE-START-SW.
  8154
  8155 0335-READNEXT.
  8156
  8157
  8158* EXEC CICS READNEXT
  8159*         DATASET    ('ELMSTR')
  8160*         RIDFLD     (ELMSTR-KEY)
  8161*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 156
* EL156.cbl
  8162*    END-EXEC.
  8163     MOVE 'ELMSTR' TO DFHEIV1
  8164     MOVE 0
  8165       TO DFHEIV11
  8166*    MOVE '&.S                   )   #00008104' TO DFHEIV0
  8167     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8168     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8169     MOVE X'2020233030303038313034' TO DFHEIV0(25:11)
  8170     CALL 'kxdfhei1' USING DFHEIV0,
  8171           DFHEIV1,
  8172           DFHEIV20,
  8173           DFHEIV99,
  8174           ELMSTR-KEY,
  8175           DFHEIV99,
  8176           DFHEIV11,
  8177           DFHEIV99,
  8178           DFHEIV99
  8179     SET ADDRESS OF CLAIM-MASTER TO
  8180         DFHEIV20
  8181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8182
  8183
  8184     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8185        GO TO 0380-CLAIM-END-FILE.
  8186
  8187     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8188        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8189        GO TO 0335-READNEXT.
  8190
  8191     IF PI-COMPANY-ID = 'CRI'
  8192         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8193            GO TO 0380-CLAIM-END-FILE.
  8194
  8195     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8196         GO TO 0335-READNEXT.
  8197
  8198     IF PI-CARRIER-SECURITY > SPACES
  8199         IF CL-CARRIER = PI-CARRIER-SECURITY
  8200             NEXT SENTENCE
  8201         ELSE
  8202             GO TO 0335-READNEXT.
  8203
  8204     IF PI-ACCOUNT-SECURITY > SPACES
  8205         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8206             NEXT SENTENCE
  8207         ELSE
  8208             GO TO 0335-READNEXT.
  8209
  8210     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8211     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8212     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8213
  8214     GO TO 0400-FIRST-TIME.
  8215
  8216 0350-BROWSE-BACKWARD.
  8217
  8218     MOVE CLMNOI            TO PI-CLAIM-NO
  8219                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 157
* EL156.cbl
  8220     MOVE CARRI             TO PI-CARRIER.
  8221     MOVE CERTNOI           TO PI-CERT-PRIME.
  8222     MOVE SUFXI             TO PI-CERT-SFX.
  8223
  8224     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8225
  8226     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8227     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8228     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8229
  8230
  8231* EXEC CICS HANDLE CONDITION
  8232*         NOTFND   (0380-CLAIM-END-FILE)
  8233*         ENDFILE  (0380-CLAIM-END-FILE)
  8234*    END-EXEC.
  8235*    MOVE '"$I''                  ! $ #00008156' TO DFHEIV0
  8236     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8237     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8238     MOVE X'2420233030303038313536' TO DFHEIV0(25:11)
  8239     CALL 'kxdfhei1' USING DFHEIV0
  8240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8241
  8242
  8243
  8244* EXEC CICS STARTBR
  8245*         DATASET    ('ELMSTR')
  8246*         RIDFLD     (ELMSTR-KEY)
  8247*         GTEQ
  8248*    END-EXEC.
  8249     MOVE 'ELMSTR' TO DFHEIV1
  8250     MOVE 0
  8251       TO DFHEIV11
  8252*    MOVE '&,         G          &   #00008161' TO DFHEIV0
  8253     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8254     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8255     MOVE X'2020233030303038313631' TO DFHEIV0(25:11)
  8256     CALL 'kxdfhei1' USING DFHEIV0,
  8257           DFHEIV1,
  8258           ELMSTR-KEY,
  8259           DFHEIV99,
  8260           DFHEIV11,
  8261           DFHEIV99
  8262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8263
  8264
  8265     MOVE 'Y' TO WS-BROWSE-START-SW.
  8266
  8267
  8268* EXEC CICS READNEXT
  8269*         DATASET    ('ELMSTR')
  8270*         RIDFLD     (ELMSTR-KEY)
  8271*         SET        (ADDRESS OF CLAIM-MASTER)
  8272*    END-EXEC.
  8273     MOVE 'ELMSTR' TO DFHEIV1
  8274     MOVE 0
  8275       TO DFHEIV11
  8276*    MOVE '&.S                   )   #00008169' TO DFHEIV0
  8277     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 158
* EL156.cbl
  8278     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8279     MOVE X'2020233030303038313639' TO DFHEIV0(25:11)
  8280     CALL 'kxdfhei1' USING DFHEIV0,
  8281           DFHEIV1,
  8282           DFHEIV20,
  8283           DFHEIV99,
  8284           ELMSTR-KEY,
  8285           DFHEIV99,
  8286           DFHEIV11,
  8287           DFHEIV99,
  8288           DFHEIV99
  8289     SET ADDRESS OF CLAIM-MASTER TO
  8290         DFHEIV20
  8291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8292
  8293
  8294
  8295* EXEC CICS READPREV
  8296*         DATASET    ('ELMSTR')
  8297*         RIDFLD     (ELMSTR-KEY)
  8298*         SET        (ADDRESS OF CLAIM-MASTER)
  8299*    END-EXEC.
  8300     MOVE 'ELMSTR' TO DFHEIV1
  8301     MOVE 0
  8302       TO DFHEIV11
  8303*    MOVE '&0S                   )   #00008175' TO DFHEIV0
  8304     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8305     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8306     MOVE X'2020233030303038313735' TO DFHEIV0(25:11)
  8307     CALL 'kxdfhei1' USING DFHEIV0,
  8308           DFHEIV1,
  8309           DFHEIV20,
  8310           DFHEIV99,
  8311           ELMSTR-KEY,
  8312           DFHEIV99,
  8313           DFHEIV11,
  8314           DFHEIV99,
  8315           DFHEIV99
  8316     SET ADDRESS OF CLAIM-MASTER TO
  8317         DFHEIV20
  8318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8319
  8320
  8321 0360-BROWSE-BACKWARD.
  8322
  8323
  8324* EXEC CICS READPREV
  8325*         DATASET    ('ELMSTR')
  8326*         RIDFLD     (ELMSTR-KEY)
  8327*         SET        (ADDRESS OF CLAIM-MASTER)
  8328*    END-EXEC.
  8329     MOVE 'ELMSTR' TO DFHEIV1
  8330     MOVE 0
  8331       TO DFHEIV11
  8332*    MOVE '&0S                   )   #00008183' TO DFHEIV0
  8333     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8334     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8335     MOVE X'2020233030303038313833' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 159
* EL156.cbl
  8336     CALL 'kxdfhei1' USING DFHEIV0,
  8337           DFHEIV1,
  8338           DFHEIV20,
  8339           DFHEIV99,
  8340           ELMSTR-KEY,
  8341           DFHEIV99,
  8342           DFHEIV11,
  8343           DFHEIV99,
  8344           DFHEIV99
  8345     SET ADDRESS OF CLAIM-MASTER TO
  8346         DFHEIV20
  8347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8348
  8349
  8350     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8351        GO TO 0380-CLAIM-END-FILE.
  8352
  8353     IF PI-COMPANY-ID = 'CRI'
  8354         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8355            GO TO 0380-CLAIM-END-FILE.
  8356
  8357     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8358         GO TO 0360-BROWSE-BACKWARD.
  8359
  8360     IF PI-CARRIER-SECURITY > SPACES
  8361         IF CL-CARRIER = PI-CARRIER-SECURITY
  8362             NEXT SENTENCE
  8363         ELSE
  8364             GO TO 0360-BROWSE-BACKWARD.
  8365
  8366     IF PI-ACCOUNT-SECURITY > SPACES
  8367         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8368             NEXT SENTENCE
  8369         ELSE
  8370             GO TO 0360-BROWSE-BACKWARD.
  8371
  8372     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8373     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8374     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8375
  8376     GO TO 0400-FIRST-TIME.
  8377
  8378 0380-CLAIM-END-FILE.
  8379
  8380     MOVE ER-0130     TO EMI-ERROR.
  8381     MOVE -1          TO CLMNOL.
  8382     MOVE AL-UABON    TO CARRA
  8383                         CLMNOA
  8384                         CERTNOA
  8385                         SUFXA.
  8386
  8387     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8388
  8389     GO TO 8200-SEND-DATAONLY.
  8390
  8391 0400-FIRST-TIME.
  8392
  8393     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 160
* EL156.cbl
  8394        MOVE 'N'         TO WS-BROWSE-START-SW
  8395
  8396* EXEC CICS ENDBR
  8397*            DATASET    ('ELMSTR')
  8398*       END-EXEC.
  8399     MOVE 'ELMSTR' TO DFHEIV1
  8400     MOVE 0
  8401       TO DFHEIV11
  8402*    MOVE '&2                    $   #00008234' TO DFHEIV0
  8403     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8404     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8405     MOVE X'2020233030303038323334' TO DFHEIV0(25:11)
  8406     CALL 'kxdfhei1' USING DFHEIV0,
  8407           DFHEIV1,
  8408           DFHEIV11,
  8409           DFHEIV99
  8410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8411
  8412
  8413     IF PI-PROCESSOR-ID = 'LGXX'
  8414         NEXT SENTENCE
  8415     ELSE
  8416
  8417* EXEC CICS READQ TS
  8418*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8419*            INTO    (SECURITY-CONTROL)
  8420*            LENGTH  (SC-COMM-LENGTH)
  8421*            ITEM    (SC-ITEM)
  8422*        END-EXEC
  8423*    MOVE '*$II   L              ''   #00008241' TO DFHEIV0
  8424     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8425     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8426     MOVE X'2020233030303038323431' TO DFHEIV0(25:11)
  8427     CALL 'kxdfhei1' USING DFHEIV0,
  8428           PI-SECURITY-TEMP-STORE-ID,
  8429           SECURITY-CONTROL,
  8430           SC-COMM-LENGTH,
  8431           SC-ITEM,
  8432           DFHEIV99,
  8433           DFHEIV99
  8434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8435         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8436         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8437
  8438     MOVE LOW-VALUES             TO EL156AI.
  8439     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8440     MOVE 'Y'                    TO FIRST-ENTRY.
  8441     GO TO 7000-SHOW-CLAIM.
  8442
  8443 0500-CREATE-TEMP-STORAGE.
  8444     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8445
  8446
  8447* EXEC CICS WRITEQ TS
  8448*        QUEUE (QID)
  8449*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8450*        LENGTH(PI-COMM-LENGTH)
  8451*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 161
* EL156.cbl
  8452*    MOVE '*"                    ''   #00008258' TO DFHEIV0
  8453     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8454     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8455     MOVE X'2020233030303038323538' TO DFHEIV0(25:11)
  8456     CALL 'kxdfhei1' USING DFHEIV0,
  8457           QID,
  8458           PROGRAM-INTERFACE-BLOCK,
  8459           PI-COMM-LENGTH,
  8460           DFHEIV99,
  8461           DFHEIV99,
  8462           DFHEIV99
  8463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8464
  8465
  8466
  8467* EXEC CICS WRITEQ TS
  8468*        QUEUE (QID)
  8469*        FROM  (EL156AI)
  8470*        LENGTH(MAP-LENGTH)
  8471*    END-EXEC.
  8472*    MOVE '*"                    ''   #00008264' TO DFHEIV0
  8473     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8474     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8475     MOVE X'2020233030303038323634' TO DFHEIV0(25:11)
  8476     CALL 'kxdfhei1' USING DFHEIV0,
  8477           QID,
  8478           EL156AI,
  8479           MAP-LENGTH,
  8480           DFHEIV99,
  8481           DFHEIV99,
  8482           DFHEIV99
  8483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8484
  8485
  8486 0599-EXIT.
  8487      EXIT.
  8488
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 162
* EL156.cbl
  8490 0600-RECOVER-TEMP-STORAGE.
  8491
  8492* EXEC CICS READQ TS
  8493*        QUEUE (QID)
  8494*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8495*        LENGTH(PI-COMM-LENGTH)
  8496*    END-EXEC.
  8497*    MOVE '*$I    L              ''   #00008275' TO DFHEIV0
  8498     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8499     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8500     MOVE X'2020233030303038323735' TO DFHEIV0(25:11)
  8501     CALL 'kxdfhei1' USING DFHEIV0,
  8502           QID,
  8503           PROGRAM-INTERFACE-BLOCK,
  8504           PI-COMM-LENGTH,
  8505           DFHEIV99,
  8506           DFHEIV99,
  8507           DFHEIV99
  8508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8509
  8510
  8511
  8512* EXEC CICS READQ TS
  8513*        QUEUE (QID)
  8514*        INTO  (EL156AI)
  8515*        LENGTH(MAP-LENGTH)
  8516*    END-EXEC.
  8517*    MOVE '*$I    L              ''   #00008281' TO DFHEIV0
  8518     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8519     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8520     MOVE X'2020233030303038323831' TO DFHEIV0(25:11)
  8521     CALL 'kxdfhei1' USING DFHEIV0,
  8522           QID,
  8523           EL156AI,
  8524           MAP-LENGTH,
  8525           DFHEIV99,
  8526           DFHEIV99,
  8527           DFHEIV99
  8528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8529
  8530
  8531     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8532
  8533     IF PMTTYPEI NOT = LOW-VALUES
  8534         MOVE AL-UANON           TO PMTTYPEA.
  8535
  8536     IF PAYEEI NOT = LOW-VALUES
  8537         MOVE AL-UANON           TO PAYEEA.
  8538
  8539     IF NOTE1I NOT = LOW-VALUES
  8540         MOVE AL-UANON           TO NOTE1A.
  8541
  8542     IF (RETURNED-FROM = 'EL614')
  8543        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8544     END-IF
  8545*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8546*       AND (PI-EOB-CODES-EXIST = 'Y')
  8547*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 163
* EL156.cbl
  8548*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8549     IF PI-SET-NOTE2-MDT = 'Y'
  8550         MOVE AL-SANON           TO NOTE2A
  8551     END-IF
  8552
  8553     IF OFFLINEI NOT = LOW-VALUES
  8554         MOVE AL-UANON           TO OFFLINEA.
  8555
  8556*01299      IF GROUPEDI NOT = LOW-VALUES
  8557*01300          MOVE AL-UANON           TO GROUPEDA.
  8558
  8559*01302      IF CASHI NOT = LOW-VALUES
  8560*01303          MOVE AL-UANON           TO CASHA.
  8561
  8562     IF CHECKNOI NOT = LOW-VALUES
  8563         MOVE AL-UANON           TO CHECKNOA.
  8564
  8565     IF HOLDTILI NOT = LOW-VALUES
  8566         MOVE AL-UANON           TO HOLDTILA.
  8567
  8568     IF EPYFROMI NOT = LOW-VALUES
  8569         MOVE AL-UANON           TO EPYFROMA.
  8570
  8571     IF AIGFROMI NOT = LOW-VALUES
  8572         MOVE AL-UANON           TO AIGFROMA.
  8573
  8574     IF EPYTHRUI NOT = LOW-VALUES
  8575         MOVE AL-UANON           TO EPYTHRUA.
  8576
  8577     IF EDAYSI NOT = LOW-VALUES
  8578         MOVE AL-UNNON           TO EDAYSA.
  8579
  8580     IF EPYAMTL NOT = +0
  8581         MOVE AL-UNNON           TO EPYAMTA.
  8582
  8583     IF ERESVL NOT = +0
  8584         MOVE AL-UNNON           TO ERESVA.
  8585
  8586     IF EEXPENSL NOT = +0
  8587         MOVE AL-UNNON           TO EEXPENSA.
  8588
  8589     IF ETYPEI NOT = LOW-VALUES
  8590         MOVE AL-UNNON           TO ETYPEA.
  8591
  8592     IF PROOFDTI NOT = 0
  8593         MOVE AL-UNNON           TO PROOFDTA.
  8594
  8595     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8596        MOVE AL-UANON            TO EOBYNA
  8597     END-IF
  8598     IF CLMFMYNI = 'Y' OR 'N'
  8599        MOVE AL-UANON            TO CLMFMYNA
  8600     END-IF
  8601
  8602     IF SURVYYNI = 'Y' OR 'N'
  8603        IF PI-APPROVAL-LEVEL = '4'
  8604           MOVE AL-UANON         TO SURVYYNA
  8605        END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 164
* EL156.cbl
  8606     END-IF
  8607
  8608     .
  8609 0699-EXIT.
  8610      EXIT.
  8611
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 165
* EL156.cbl
  8613 0700-TEST-FOR-CHANGES.
  8614     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8615         MOVE ER-0433            TO EMI-ERROR
  8616         GO TO 0750-FUNCTION-ERROR.
  8617
  8618     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8619
  8620     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8621         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8622         MOVE 'A'                TO PI-PASS-SW
  8623         GO TO 1000-EDIT-DATA.
  8624
  8625     IF PI-FATAL-COUNT NOT = 0
  8626         MOVE ER-0499            TO EMI-ERROR
  8627         GO TO 0750-FUNCTION-ERROR.
  8628
  8629     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8630         MOVE ER-0500            TO EMI-ERROR
  8631         GO TO 0750-FUNCTION-ERROR.
  8632
  8633     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8634        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8635           MOVE ER-0542          TO EMI-ERROR
  8636           MOVE -1               TO EPYAMTL
  8637           GO TO 0750-FUNCTION-ERROR.
  8638
  8639     IF PI-OFFLINE = 'Y'  OR
  8640        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8641        MOVE EIBAID              TO PI-PFKEY-USED
  8642        GO TO 5000-UPDATE.
  8643
  8644     GO TO 6000-BUILD-SCREEN-B.
  8645
  8646 0750-FUNCTION-ERROR.
  8647     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8648
  8649     IF ENTERPFL > 0
  8650         MOVE -1                 TO ENTERPFL
  8651         MOVE AL-UNBON           TO ENTERPFA
  8652         GO TO 8200-SEND-DATAONLY
  8653     ELSE
  8654         MOVE -1                 TO ENTERPFL
  8655         MOVE AL-UNNOF           TO ENTERPFA
  8656         GO TO 8200-SEND-DATAONLY.
  8657
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 166
* EL156.cbl
  8659 0800-DELETE-TS.
  8660
  8661* EXEC CICS HANDLE CONDITION
  8662*        QIDERR(0800-EXIT)
  8663*    END-EXEC.
  8664*    MOVE '"$N                   ! % #00008416' TO DFHEIV0
  8665     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8666     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8667     MOVE X'2520233030303038343136' TO DFHEIV0(25:11)
  8668     CALL 'kxdfhei1' USING DFHEIV0
  8669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8670
  8671
  8672
  8673* EXEC CICS DELETEQ TS
  8674*        QUEUE(QID)
  8675*    END-EXEC.
  8676*    MOVE '*&                    #   #00008420' TO DFHEIV0
  8677     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8678     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8679     MOVE X'2020233030303038343230' TO DFHEIV0(25:11)
  8680     CALL 'kxdfhei1' USING DFHEIV0,
  8681           QID,
  8682           DFHEIV99
  8683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8684
  8685
  8686 0800-EXIT.
  8687      EXIT.
  8688
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 167
* EL156.cbl
  8690 1000-EDIT-DATA.
  8691
  8692     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  8693         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  8694         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  8695
  8696     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  8697
  8698     IF NOT MODIFY-CAP
  8699         MOVE ER-0070            TO EMI-ERROR
  8700         MOVE -1                 TO PMTTYPEL
  8701         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8702         GO TO 2000-EDIT-DONE.
  8703
  8704     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  8705                         '5' AND '6'
  8706         MOVE ER-0420            TO EMI-ERROR
  8707         MOVE -1                 TO PMTTYPEL
  8708         MOVE AL-UABON           TO PMTTYPEA
  8709         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8710     ELSE
  8711         MOVE AL-UANON           TO PMTTYPEA.
  8712
  8713*01420      IF PI-OFFLINE = 'Y'
  8714*01421         IF PI-GROUPED = 'Y'
  8715*01422            MOVE ER-1880         TO EMI-ERROR
  8716*01423            MOVE -1              TO GROUPEDL
  8717*01424            MOVE AL-UABON        TO GROUPEDA
  8718*01425            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8719*01426
  8720*01427      IF GROUPEDL > +0
  8721*01428         IF PI-GROUPED = 'Y' OR 'N'
  8722*01429            MOVE AL-UANON TO GROUPEDA
  8723*01430         ELSE
  8724*01431            MOVE ER-3140            TO EMI-ERROR
  8725*01432            MOVE -1                 TO GROUPEDL
  8726*01433            MOVE AL-UABON           TO GROUPEDA
  8727*01434            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8728*01435
  8729*01436      IF CASHL > +0
  8730*01437         IF PI-CASH = 'Y' OR 'N'
  8731*01438            MOVE AL-UANON           TO CASHA
  8732*01439         ELSE
  8733*01440            MOVE ER-3141            TO EMI-ERROR
  8734*01441            MOVE -1                 TO CASHL
  8735*01442            MOVE AL-UABON           TO CASHA
  8736*01443            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8737
  8738     IF LOANNOL > +0
  8739         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  8740
  8741 1000-EDIT-PAYEE.
  8742
  8743     IF PI-PAYEE-SEQ NOT NUMERIC
  8744         MOVE ER-0294            TO  EMI-ERROR
  8745         MOVE -1                 TO  PAYEEL
  8746         MOVE AL-UABON           TO  PAYEEA
  8747         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 168
* EL156.cbl
  8748         GO TO 1000-CONT-EDIT.
  8749
  8750     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  8751                         'E' OR 'O' OR 'Q'
  8752         NEXT SENTENCE
  8753     ELSE
  8754         MOVE ER-0294            TO  EMI-ERROR
  8755         MOVE -1                 TO  PAYEEL
  8756         MOVE AL-UABON           TO  PAYEEA
  8757         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8758         GO TO 1000-CONT-EDIT.
  8759
  8760     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  8761        (PI-PAYEE-SEQ NOT < '1' AND
  8762         PI-PAYEE-SEQ NOT > '9'))
  8763      OR
  8764        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  8765         (PI-PAYEE-SEQ NOT > '9'))
  8766         MOVE AL-UANON            TO PAYEEA
  8767     ELSE
  8768         MOVE ER-0294            TO EMI-ERROR
  8769         MOVE -1                 TO PAYEEL
  8770         MOVE AL-UABON           TO PAYEEA
  8771         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8772
  8773     IF PI-COMPANY-ID = 'DMD'
  8774         IF PI-PAYEE-TYPE = 'B' AND
  8775            PI-PAYEE-SEQ NOT = '0'
  8776               MOVE ER-7841            TO EMI-ERROR
  8777               MOVE -1                 TO PAYEEL
  8778               MOVE AL-UABON           TO PAYEEA
  8779               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8780
  8781     IF PI-COMPANY-ID = 'JHL'
  8782         IF PI-PAYEE = 'B0'
  8783             NEXT SENTENCE
  8784           ELSE
  8785
  8786* EXEC CICS HANDLE CONDITION
  8787*            ENDFILE(1950-NOT-FOUND)
  8788*            NOTFND (1950-NOT-FOUND)
  8789*        END-EXEC
  8790*    MOVE '"$''I                  ! & #00008523' TO DFHEIV0
  8791     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8792     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8793     MOVE X'2620233030303038353233' TO DFHEIV0(25:11)
  8794     CALL 'kxdfhei1' USING DFHEIV0
  8795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8796         MOVE 'N'                    TO FOUND-TOL-SW
  8797         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  8798         MOVE '2'                    TO CNTL-REC-TYPE
  8799         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  8800         MOVE +0                     TO CNTL-SEQ-NO
  8801         MOVE 'PROC'                 TO FILE-SWITCH
  8802         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  8803         IF PI-PAYEE = 'I1' AND
  8804            APPROVAL-LEVEL-2
  8805             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 169
* EL156.cbl
  8806           ELSE
  8807         IF NOT PI-USER-ALMIGHTY-YES
  8808             MOVE ER-3546        TO EMI-ERROR
  8809             MOVE -1             TO PAYEEL
  8810             MOVE AL-UABON       TO PAYEEA
  8811             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8812
  8813     IF PI-PAYEE-TYPE = 'E'
  8814        IF PI-PMTTYPE = '5' OR '6'
  8815            NEXT SENTENCE
  8816        ELSE
  8817            MOVE ER-3539            TO EMI-ERROR
  8818            MOVE -1                 TO PAYEEL
  8819            MOVE AL-UABON           TO PAYEEA
  8820            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8821
  8822 1000-CONT-EDIT.
  8823
  8824     IF PI-OFFLINE NOT = 'Y' AND 'N'
  8825        IF PI-EPYAMT NOT NEGATIVE
  8826            MOVE ER-0421         TO EMI-ERROR
  8827            MOVE -1              TO OFFLINEL
  8828            MOVE AL-UABON        TO OFFLINEA
  8829            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8830        ELSE
  8831            MOVE AL-UANON        TO OFFLINEA.
  8832
  8833     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8834        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  8835           CONTINUE
  8836        ELSE
  8837        IF PI-PRINT-EOB-YN = 'S' AND
  8838           PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  8839             CONTINUE
  8840        ELSE
  8841           MOVE ER-1561          TO EMI-ERROR
  8842           MOVE -1               TO EOBYNL
  8843           MOVE AL-UABON         TO EOBYNA
  8844           PERFORM 9900-ERROR-FORMAT
  8845                                 THRU 9900-EXIT
  8846        END-IF
  8847        END-IF
  8848
  8849        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  8850            MOVE ER-1566        TO EMI-ERROR
  8851            MOVE -1             TO CLMFMYNL
  8852            MOVE AL-UABON       TO CLMFMYNA
  8853            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8854        END-IF
  8855
  8856        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  8857            MOVE ER-1567        TO EMI-ERROR
  8858            MOVE -1             TO SURVYYNL
  8859            MOVE AL-UABON       TO SURVYYNA
  8860            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8861        END-IF
  8862
  8863     END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 170
* EL156.cbl
  8864     IF PI-EPYAMT IS NEGATIVE
  8865         IF PI-OFFLINE NOT = 'Y'
  8866             MOVE ER-0836        TO  EMI-ERROR
  8867             MOVE -1             TO  OFFLINEL
  8868             MOVE AL-UABON       TO  OFFLINEA
  8869             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8870
  8871     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  8872        MOVE ER-0872             TO EMI-ERROR
  8873        MOVE -1                  TO PROOFDTL
  8874        MOVE AL-UABON            TO PROOFDTA
  8875        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8876     ELSE
  8877        MOVE '4'                TO DC-OPTION-CODE
  8878        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  8879        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  8880        IF DATE-CONVERSION-ERROR
  8881            MOVE ER-0873        TO EMI-ERROR
  8882            MOVE -1                  TO PROOFDTL
  8883            MOVE AL-UABON            TO PROOFDTA
  8884            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8885        ELSE
  8886            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  8887            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  8888                MOVE ER-0873    TO EMI-ERROR
  8889                MOVE -1                  TO PROOFDTL
  8890                MOVE AL-UABON            TO PROOFDTA
  8891                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8892            END-IF
  8893        END-IF
  8894     END-IF.
  8895
  8896     IF PI-COMPANY-ID = 'DMD'
  8897        IF NOTE1L NOT = ZEROS
  8898            MOVE ER-7844        TO  EMI-ERROR
  8899            MOVE -1             TO  NOTE1L
  8900            MOVE AL-UABON       TO  NOTE1A
  8901            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8902
  8903     IF PI-COMPANY-ID = 'DMD'
  8904        IF NOTE2L NOT = ZEROS
  8905          GO TO 1004-DMD-EOB-CHECKS.
  8906
  8907     IF NOTE1L NOT > +0
  8908         GO TO 1005-CHECK-ERRORS.
  8909
  8910     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  8911         GO TO 1005-CHECK-ERRORS.
  8912
  8913     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  8914         GO TO 1003-HAN-PMT-NOTES.
  8915
  8916     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
  8917
  8918     IF WS-PMTOPTION NUMERIC
  8919        IF WS-PMTOPTION > '00' AND < '17'
  8920           NEXT SENTENCE
  8921        ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 171
* EL156.cbl
  8922           MOVE ER-0618          TO EMI-ERROR
  8923           MOVE -1               TO NOTE1L
  8924           MOVE AL-UABON         TO NOTE1A
  8925           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8926     ELSE
  8927        GO TO 1005-CHECK-ERRORS.
  8928
  8929     IF WS-PMTOPTION = '05' AND
  8930        WS-DOCNAME = SPACES
  8931          MOVE ER-0616             TO EMI-ERROR
  8932          MOVE -1                  TO NOTE1L
  8933          MOVE AL-UABON            TO NOTE1A
  8934          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8935
  8936     IF WS-PMTOPTION = '15' OR '16'
  8937
  8938* EXEC CICS BIF DEEDIT
  8939*            FIELD (WS-AMOUNT)
  8940*            LENGTH(08)
  8941*        END-EXEC
  8942     MOVE 08
  8943       TO DFHEIV11
  8944*    MOVE '@"L                   #   #00008668' TO DFHEIV0
  8945     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8946     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8947     MOVE X'2020233030303038363638' TO DFHEIV0(25:11)
  8948     CALL 'kxdfhei1' USING DFHEIV0,
  8949           WS-AMOUNT,
  8950           DFHEIV11
  8951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8952        IF (WS-NUM-AMT = ZEROS) OR
  8953           (WS-AMOUNT NOT NUMERIC)
  8954           MOVE ER-0617          TO EMI-ERROR
  8955           MOVE -1               TO NOTE1L
  8956           MOVE AL-UABON         TO NOTE1A
  8957           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8958
  8959     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  8960
  8961     GO TO 1005-CHECK-ERRORS.
  8962
  8963 1003-HAN-PMT-NOTES.
  8964
  8965     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  8966
  8967     IF WS-HAN-PMT-CODE = SPACE
  8968         MOVE SPACES             TO WS-HAN-PMT-NOTE
  8969     ELSE
  8970     IF WS-HAN-PMT-CODE = 'A'
  8971         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  8972                                 TO WS-HAN-PMT-NOTE
  8973     ELSE
  8974     IF WS-HAN-PMT-CODE = 'B'
  8975         MOVE ':FINAL PAYMENT / DECEASED'
  8976                                 TO WS-HAN-PMT-NOTE
  8977     ELSE
  8978     IF WS-HAN-PMT-CODE = 'C'
  8979         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 172
* EL156.cbl
  8980                                 TO WS-HAN-PMT-NOTE
  8981     ELSE
  8982     IF WS-HAN-PMT-CODE = 'D'
  8983         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  8984                                 TO WS-HAN-PMT-NOTE
  8985     ELSE
  8986     IF WS-HAN-PMT-CODE = 'E'
  8987         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  8988                                 TO WS-HAN-PMT-NOTE
  8989     ELSE
  8990     IF WS-HAN-PMT-CODE = 'F'
  8991         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  8992                                 TO WS-HAN-PMT-NOTE
  8993     ELSE
  8994     IF WS-HAN-PMT-CODE = 'P'
  8995         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  8996
  8997     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  8998     GO TO 1005-CHECK-ERRORS.
  8999
  9000 1004-DMD-EOB-CHECKS.
  9001
  9002     INITIALIZE PI-AT-EOB-CODES.
  9003
  9004     IF NOTE2I (20:21) > SPACES
  9005         MOVE ER-7845          TO EMI-ERROR
  9006         MOVE -1               TO NOTE2L
  9007         MOVE AL-UABON         TO NOTE2A
  9008         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9009         GO TO 1005-CHECK-ERRORS
  9010      ELSE
  9011         MOVE NOTE2I             TO W-EOB-CODES.
  9012
  9013     MOVE +1                     TO W-EOB-NDX.
  9014
  9015 1004-CHECK-EACH-EOB.
  9016
  9017     IF W-EOB-NDX > +5
  9018             OR
  9019        W-EOB-CODE (W-EOB-NDX) = SPACES
  9020         GO TO 1004-CHECK-DUP-EOB.
  9021
  9022     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9023         MOVE ER-0956            TO EMI-ERROR
  9024         MOVE -1                 TO NOTE2L
  9025         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9026         GO TO 1005-CHECK-ERRORS.
  9027
  9028     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9029     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9030     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9031     MOVE 'DLO023'               TO PGM-NAME.
  9032
  9033
  9034* EXEC CICS LINK
  9035*        PROGRAM    (PGM-NAME)
  9036*        COMMAREA   (CD-COMMUNICATION-AREA)
  9037*        LENGTH     (CD-RCRD-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 173
* EL156.cbl
  9038*    END-EXEC.
  9039*    MOVE '."C                   (   #00008753' TO DFHEIV0
  9040     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9041     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9042     MOVE X'2020233030303038373533' TO DFHEIV0(25:11)
  9043     CALL 'kxdfhei1' USING DFHEIV0,
  9044           PGM-NAME,
  9045           CD-COMMUNICATION-AREA,
  9046           CD-RCRD-LENGTH,
  9047           DFHEIV99,
  9048           DFHEIV99,
  9049           DFHEIV99,
  9050           DFHEIV99
  9051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9052
  9053
  9054     IF CD-RETURN-CODE = 'OK'
  9055         GO TO 1004-CONT.
  9056
  9057     MOVE -1                     TO NOTE2L.
  9058
  9059     IF CD-RETURN-CODE = '01'
  9060         MOVE ER-8310            TO EMI-ERROR
  9061         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9062         GO TO 1005-CHECK-ERRORS.
  9063
  9064     IF CD-RETURN-CODE = '02'
  9065         MOVE ER-8311            TO EMI-ERROR
  9066         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9067         GO TO 1005-CHECK-ERRORS.
  9068
  9069     IF CD-RETURN-CODE = '03'
  9070         MOVE ER-8312            TO EMI-ERROR
  9071         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9072         GO TO 1005-CHECK-ERRORS.
  9073
  9074     IF CD-RETURN-CODE = '04'
  9075         MOVE ER-8313            TO EMI-ERROR
  9076         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9077         GO TO 1005-CHECK-ERRORS.
  9078
  9079     IF CD-RETURN-CODE = '05'
  9080         MOVE ER-8314            TO EMI-ERROR
  9081         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9082         GO TO 1005-CHECK-ERRORS.
  9083
  9084     IF CD-RETURN-CODE = '06'
  9085         MOVE ER-8315            TO EMI-ERROR
  9086         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9087         GO TO 1005-CHECK-ERRORS.
  9088
  9089     IF CD-RETURN-CODE = 'E1'
  9090         MOVE ER-8316            TO EMI-ERROR
  9091         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9092         GO TO 1005-CHECK-ERRORS.
  9093
  9094     IF CD-RETURN-CODE = 'N1'
  9095         MOVE ER-8317            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 174
* EL156.cbl
  9096         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9097         GO TO 1005-CHECK-ERRORS.
  9098
  9099 1004-CONT.
  9100     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9101
  9102     ADD +1 TO W-EOB-NDX.
  9103     GO TO 1004-CHECK-EACH-EOB.
  9104
  9105 1004-CHECK-DUP-EOB.
  9106     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9107         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9108                               PI-AT-EOB-CODE (3) OR
  9109                               PI-AT-EOB-CODE (4) OR
  9110                               PI-AT-EOB-CODE (5)))
  9111                  OR
  9112        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9113         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9114                               PI-AT-EOB-CODE (4) OR
  9115                               PI-AT-EOB-CODE (5)))
  9116                  OR
  9117        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9118         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9119                               PI-AT-EOB-CODE (5)))
  9120                  OR
  9121        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9122         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9123            MOVE ER-8000            TO EMI-ERROR
  9124            MOVE AL-UABON           TO NOTE2A
  9125            MOVE -1                 TO NOTE2L
  9126            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9127            GO TO 1005-CHECK-ERRORS.
  9128
  9129 1005-CHECK-ERRORS.
  9130*    IF PI-COMPANY-ID NOT = 'DMD'
  9131        GO TO 1006-CHECK-ERRORS.
  9132
  9133*********  DMD CODE START ******************
  9134*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9135*       GO TO 1006-CHECK-ERRORS.
  9136*
  9137*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9138*
  9139*    COMPUTE W-PAYMENT-TOTAL
  9140*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9141*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9142*               AND
  9143*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9144*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9145*          MOVE ER-0967    TO EMI-ERROR
  9146*          MOVE -1         TO PMTTYPEL
  9147*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9148*
  9149*    GO TO 1006-CHECK-ERRORS.
  9150*********  DMD CODE END ******************
  9151
  9152 1006-CHECK-ERRORS.
  9153     IF NOT EMI-NO-ERRORS
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 175
* EL156.cbl
  9154        GO TO 2000-EDIT-DONE.
  9155
  9156
  9157* EXEC CICS HANDLE CONDITION
  9158*        NOTFND(1950-NOT-FOUND)
  9159*    END-EXEC.
  9160*    MOVE '"$I                   ! '' #00008861' TO DFHEIV0
  9161     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9162     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9163     MOVE X'2720233030303038383631' TO DFHEIV0(25:11)
  9164     CALL 'kxdfhei1' USING DFHEIV0
  9165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9166
  9167
  9168     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9169     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9170     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9171     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9172     MOVE 'MSTR'                 TO FILE-SWITCH.
  9173
  9174     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9175
  9176     IF PI-COMPANY-ID = 'DMD'
  9177         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9178
  9179     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9180        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9181           MOVE ER-0873    TO EMI-ERROR
  9182           MOVE -1                  TO PROOFDTL
  9183           MOVE AL-UABON            TO PROOFDTA
  9184           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9185        END-IF
  9186     END-IF
  9187     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9188         IF PI-PMTTYPE = '5' OR '6'
  9189             NEXT SENTENCE
  9190         ELSE
  9191             MOVE ER-0555             TO EMI-ERROR
  9192             MOVE -1                  TO PMTTYPEL
  9193             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9194
  9195     IF CL-LAST-CLOSE-REASON = '2'
  9196         IF CL-CLAIM-STATUS = 'C'
  9197             MOVE ER-0760        TO  EMI-ERROR
  9198             MOVE -1             TO  PMTTYPEL
  9199             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9200
  9201     IF PI-ACTIVITY-CODE = 9
  9202         MOVE ER-3538            TO  EMI-ERROR
  9203         MOVE -1                 TO  PMTTYPEL
  9204         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9205
  9206     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9207         GO TO 1008-READ-CERT.
  9208**********************AIG LOGIC STARTS *********************
  9209     IF CL-CERT-PRIME = 'INCOMPLETE'
  9210         MOVE ER-3540            TO  EMI-ERROR
  9211         MOVE -1                 TO  PMTTYPEL
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 176
* EL156.cbl
  9212         MOVE AL-UABON           TO  PMTTYPEA
  9213         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9214         GO TO 2000-EDIT-DONE.
  9215
  9216     IF PI-PMTTYPE = '4'
  9217         IF PI-EPYAMT IS NEGATIVE
  9218             IF PI-ECHECKNO-CR = 'CR'
  9219                 NEXT SENTENCE
  9220             ELSE
  9221                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9222
  9223     IF PI-PMTTYPE = '4'
  9224         IF PI-ECHECKNO-CR = 'CR'
  9225             IF PI-EPYAMT IS NEGATIVE
  9226                 NEXT SENTENCE
  9227             ELSE
  9228                 MOVE ER-0834    TO  EMI-ERROR
  9229                 MOVE -1         TO  EPYAMTL
  9230                 MOVE AL-UNBON   TO  EPYAMTA
  9231                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9232
  9233     IF PI-PMTTYPE = '4'
  9234         IF PI-EPYAMT IS NEGATIVE
  9235             IF PI-OFFLINE = 'Y'
  9236                 NEXT SENTENCE
  9237             ELSE
  9238                 MOVE 'Y'        TO  PI-OFFLINE
  9239                                     WS-OFFLINE
  9240                                     OFFLINEO
  9241                 MOVE AL-UANON   TO  OFFLINEA.
  9242
  9243*01845      IF PI-PMTTYPE = '4'
  9244*01846          IF PI-EPYAMT IS NEGATIVE
  9245*01847              IF PI-CASH = 'Y'
  9246*01848                  NEXT SENTENCE
  9247*01849              ELSE
  9248*01850                  MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9249*01851                  MOVE AL-UANON   TO  CASHA
  9250*01852                  GO TO 1007-DEFAULT-AIG-CHECKNO.
  9251*01853
  9252*01854      IF PI-CASH NOT = 'Y' AND 'N'
  9253*01855           IF PI-OFFLINE = 'Y'  AND
  9254*01856              PI-ECHECKNO-CR = 'CR'
  9255*01857                MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9256*01858                MOVE AL-UANON     TO  CASHA
  9257*01859                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9258*01860
  9259*01861      IF PI-CASH NOT = 'Y' AND 'N'
  9260*01862          IF PI-PMTTYPE = '5' OR '6'
  9261*01863              MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9262*01864              MOVE AL-UANON       TO  CASHA
  9263*01865              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9264*01866
  9265*01867      IF PI-CASH NOT = 'Y' AND 'N'
  9266*01868         IF CL-ASSOCIATES = 'N' OR 'A'
  9267*01869             MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9268*01870             MOVE AL-UANON        TO  CASHA
  9269*01871         ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 177
* EL156.cbl
  9270*01872             MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9271*01873             MOVE AL-UANON        TO  CASHA.
  9272*01874
  9273*01875      IF PI-PMTTYPE = '5' OR '6'
  9274*01876          IF PI-CASH = 'N'
  9275*01877              MOVE ER-0819        TO  EMI-ERROR
  9276*01878              MOVE AL-UANON       TO  CASHA
  9277*01879              MOVE -1             TO  CASHL
  9278*01880              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9279*01881
  9280*01882      IF CL-ASSOCIATES = 'N' OR 'A'
  9281*01883         IF CASHI = 'N'
  9282*01884          MOVE ER-3537            TO  EMI-ERROR
  9283*01885          MOVE AL-UANON           TO  CASHA
  9284*01886          MOVE -1                 TO  CASHL
  9285*01887          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9286
  9287 1007-DEFAULT-AIG-CHECKNO.
  9288
  9289     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9290         MOVE ER-3532            TO  EMI-ERROR
  9291         MOVE -1                 TO  PMTTYPEL
  9292         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9293**********************AIG LOGIC ENDS ***********************
  9294
  9295 1008-READ-CERT.
  9296
  9297     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9298     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9299     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9300     MOVE CL-CERT-STATE          TO CERT-STATE.
  9301     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9302     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9303     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9304     MOVE 'CERT'                 TO FILE-SWITCH.
  9305
  9306     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9307
  9308     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9309         MOVE CM-LF-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT
  9310     ELSE
  9311         MOVE CM-AH-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT.
  9312
  9313*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9314*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9315
  9316     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9317         MOVE ER-0458            TO EMI-ERROR
  9318         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9319
  9320     IF CL-INCURRED-DT NOT < WS-EXP-DT
  9321         MOVE ER-0459            TO EMI-ERROR
  9322         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9323
  9324     IF CL-REPORTED-DT = LOW-VALUES
  9325        MOVE ER-0530             TO EMI-ERROR
  9326        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9327
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 178
* EL156.cbl
  9328     IF PI-COMPANY-ID = 'NCL'
  9329        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9330            MOVE ER-0770            TO EMI-ERROR
  9331            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9332
  9333     IF PI-COMPANY-ID = 'NCL'
  9334        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9335            MOVE ER-0737            TO EMI-ERROR
  9336            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9337
  9338     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9339         MOVE ER-0768            TO  EMI-ERROR
  9340         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9341
  9342     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9343         MOVE ER-0769            TO  EMI-ERROR
  9344         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9345
  9346     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9347         GO TO 1020-DO-LIFE-EDITS
  9348     ELSE
  9349         GO TO 1030-DO-AH-EDITS.
  9350
  9351 1010-GENERAL-ERROR.
  9352     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9353
  9354     IF EMI-MESSAGE-FORMATTED
  9355         MOVE -1                 TO PMTTYPEL.
  9356
  9357 1010-EXIT.
  9358     EXIT.
  9359
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 179
* EL156.cbl
  9361 1020-DO-LIFE-EDITS.
  9362     IF CM-LF-BENEFIT-CD = '00'
  9363         IF PI-PMTTYPE = '5' OR '6'
  9364             MOVE ER-0658        TO EMI-ERROR
  9365             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9366         ELSE
  9367             MOVE ER-1775        TO EMI-ERROR
  9368             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9369
  9370     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9371         MOVE ER-0460            TO EMI-ERROR
  9372         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9373
  9374     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9375     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9376     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9377     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9378     MOVE '4'                    TO  CNTL-REC-TYPE.
  9379     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9380     MOVE 'BENE'                 TO  FILE-SWITCH.
  9381     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9382     IF NO-BENEFIT-FOUND
  9383         GO TO 1950-NOT-FOUND.
  9384
  9385     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9386
  9387     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9388         IF PI-PMTTYPE = '4'
  9389             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9390                PI-LF-COVERAGE-TYPE = 'P'
  9391                 NEXT SENTENCE
  9392             ELSE
  9393                 MOVE ER-0461        TO EMI-ERROR
  9394                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9395         ELSE
  9396            NEXT SENTENCE
  9397     ELSE
  9398         IF PI-PMTTYPE = '2'
  9399            IF NOT CM-O-B-COVERAGE
  9400              AND CM-LF-CURRENT-STATUS = '7'
  9401                MOVE ER-0462     TO EMI-ERROR
  9402                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9403
  9404     IF PI-PMTTYPE = '2'
  9405         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9406            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9407             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9408             MOVE ER-0730            TO  EMI-ERROR
  9409             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9410             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
  9411
  9412     IF PI-PMTTYPE = '2'
  9413         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9414            PI-LF-COVERAGE-TYPE = 'P'
  9415             IF CL-PAID-THRU-DT = CL-INCURRED-DT
  9416                 MOVE ER-0462    TO  EMI-ERROR
  9417                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9418
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 180
* EL156.cbl
  9419     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  9420       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
  9421         MOVE ER-0466            TO EMI-ERROR
  9422         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9423
  9424     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
  9425         IF PI-PMTTYPE = '3'
  9426             MOVE 0436           TO EMI-ERROR
  9427             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9428             GO TO 1045-EDIT-PAYEE-ADDR
  9429         ELSE
  9430             GO TO 1045-EDIT-PAYEE-ADDR.
  9431
  9432     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9433        PI-LF-COVERAGE-TYPE = 'P'
  9434         IF PI-PMTTYPE = '3'
  9435             MOVE ER-0436          TO  EMI-ERROR
  9436             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9437         ELSE
  9438             NEXT SENTENCE
  9439     ELSE
  9440         IF PI-PMTTYPE = '1' OR '3'
  9441             MOVE ER-0436            TO EMI-ERROR
  9442             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9443*
  9444     IF PI-COMPANY-ID = 'CID' AND
  9445        CL-CERT-STATE = 'SC'  AND
  9446        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  9447           MOVE ER-0879    TO  EMI-ERROR
  9448           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9449     END-IF.
  9450     IF PI-COMPANY-ID = 'AHL' AND
  9451        CL-CERT-STATE = 'SC'  AND
  9452        (CM-LF-BENEFIT-CD = '5I' OR '6J')
  9453           MOVE ER-0879    TO  EMI-ERROR
  9454           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9455     END-IF.
  9456
  9457     GO TO 1045-EDIT-PAYEE-ADDR.
  9458
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 181
* EL156.cbl
  9460 1030-DO-AH-EDITS.
  9461     IF CM-AH-BENEFIT-CD = '00'
  9462         IF PI-PMTTYPE = '5' OR '6'
  9463             MOVE ER-0658        TO EMI-ERROR
  9464             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9465         ELSE
  9466             MOVE ER-1775        TO EMI-ERROR
  9467             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9468
  9469     IF CL-TOTAL-PAID-AMT = ZEROS
  9470         IF PI-PMTTYPE = '4'
  9471             MOVE ER-0438        TO EMI-ERROR
  9472             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9473
  9474     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
  9475         IF PI-PMTTYPE = '3'
  9476             MOVE ER-0463        TO EMI-ERROR
  9477             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9478         ELSE
  9479             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
  9480              AND CM-LF-CURRENT-STATUS = '7'
  9481                 MOVE ER-0465    TO EMI-ERROR
  9482                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9483
  9484     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9485         IF PI-PMTTYPE = '3'
  9486             MOVE ER-0464        TO EMI-ERROR
  9487             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9488         ELSE
  9489             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
  9490                 MOVE ER-0469    TO EMI-ERROR
  9491                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9492
  9493     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9494         IF PI-PMTTYPE = '3'
  9495             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
  9496                 MOVE ER-0467    TO EMI-ERROR
  9497                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9498             ELSE
  9499                 NEXT SENTENCE
  9500         ELSE
  9501             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
  9502                 MOVE ER-0468    TO EMI-ERROR
  9503                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9504
  9505     GO TO 1045-EDIT-PAYEE-ADDR.
  9506
  9507 1040-PMTTYPE-ERROR.
  9508     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9509
  9510     IF EMI-MESSAGE-FORMATTED
  9511         MOVE -1                 TO PMTTYPEL
  9512         MOVE AL-UABON           TO PMTTYPEA.
  9513
  9514 1040-EXIT.
  9515     EXIT.
  9516
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 182
* EL156.cbl
  9518 1045-EDIT-PAYEE-ADDR.
  9519
  9520     IF PI-OFFLINE = 'N' AND
  9521        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
  9522           < PI-PAYEE-SEQ-NUM)
  9523        OR
  9524         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
  9525         (PI-PAYEE-TYPE = 'B')                 AND
  9526         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
  9527        OR
  9528         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
  9529           < PI-PAYEE-SEQ-NUM)
  9530        OR
  9531         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
  9532           < PI-PAYEE-SEQ-NUM)
  9533        OR
  9534         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
  9535           < PI-PAYEE-SEQ-NUM)
  9536        OR
  9537         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
  9538           < PI-PAYEE-SEQ-NUM)
  9539        OR
  9540         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
  9541           < PI-PAYEE-SEQ-NUM))
  9542             MOVE ER-0437        TO EMI-ERROR
  9543             MOVE -1             TO PAYEEL
  9544             MOVE AL-UABON       TO PAYEEA
  9545             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9546
  9547     IF PI-OFFLINE    = 'N' AND
  9548        PI-PAYEE-TYPE = 'B' AND
  9549        PI-PAYEE-SEQ  = '0'
  9550         PERFORM 7920-READ-BENE THRU 7920-EXIT
  9551         IF BENE-FOUND-SW = 'N'
  9552             MOVE ER-0437        TO EMI-ERROR
  9553             MOVE -1             TO PAYEEL
  9554             MOVE AL-UABON       TO PAYEEA
  9555             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9556
  9557     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9558        IF PI-OFFLINE    = 'N'  AND
  9559           PI-PAYEE-TYPE = 'B'  AND
  9560           PI-PAYEE-SEQ  = '9'
  9561             PERFORM 7920-READ-BENE THRU 7920-EXIT
  9562             IF BENE-FOUND-SW = 'N'
  9563                MOVE ER-0437        TO EMI-ERROR
  9564                MOVE -1             TO PAYEEL
  9565                MOVE AL-UABON       TO PAYEEA
  9566                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9567
  9568*    IF PI-COMPANY-ID = 'CRI'
  9569*        IF CL-CLAIM-TYPE = 'L'
  9570*            MOVE 'N'                TO  WS-GROUPED
  9571*                                        PI-GROUPED
  9572*                                        GROUPEDI
  9573*            MOVE AL-UANON           TO  GROUPEDA
  9574*            GO TO 1050-EDIT-CHECK-NO
  9575*        ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 183
* EL156.cbl
  9576*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
  9577*            IF WS-GROUP-1 = 'C'
  9578*                NEXT SENTENCE
  9579*            ELSE
  9580*                MOVE 'N'            TO  WS-GROUPED
  9581*                                        PI-GROUPED
  9582*                                        GROUPEDI
  9583*                MOVE AL-UANON       TO  GROUPEDA
  9584*                GO TO 1050-EDIT-CHECK-NO.
  9585
  9586*02174      IF PI-GROUPED = 'Y'
  9587*02175         IF PI-PAYEE-TYPE = 'B' OR 'A'
  9588*02176            NEXT SENTENCE
  9589*02177         ELSE
  9590*02178            MOVE ER-0437        TO EMI-ERROR
  9591*02179            MOVE -1             TO PAYEEL
  9592*020413*02180            MOVE AL-UABON       TO PAYEEA
  9593*02181            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9594*02182
  9595*02183      IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
  9596*02184         (PI-GROUPED    = ' ')
  9597*02185         NEXT SENTENCE
  9598*02186      ELSE
  9599*
  9600        GO TO 1050-EDIT-CHECK-NO.
  9601
  9602*02189      IF PI-COMPANY-ID = 'CRI'
  9603*02190         MOVE 'N'           TO GROUPEDI
  9604*02191                               PI-GROUPED
  9605*02192                               WS-GROUPED
  9606*02193         MOVE AL-UANON      TO GROUPEDA.
  9607*02194
  9608*02195      IF PI-COMPANY-ID = 'CRI'
  9609*02196         IF PI-PAYEE-TYPE = 'B'
  9610*02197            IF BENE-FOUND-SW = 'Y'
  9611*02198               IF BE-GROUP-CHECKS-Y-N = 'Y'
  9612*02199                  MOVE 'Y'           TO GROUPEDI
  9613*02200                                        PI-GROUPED
  9614*02201                                        WS-GROUPED
  9615*02202                  MOVE AL-UANON      TO GROUPEDA
  9616*02203               ELSE
  9617*02204                  NEXT SENTENCE
  9618*02205            ELSE
  9619*02206               PERFORM 7920-READ-BENE THRU 7920-EXIT
  9620*02207               IF BENE-FOUND-SW = 'Y'
  9621*02208                  IF BE-GROUP-CHECKS-Y-N = 'Y'
  9622*02209                     MOVE 'Y'      TO GROUPEDI
  9623*02210                                      PI-GROUPED
  9624*02211                                      WS-GROUPED
  9625*02212                     MOVE AL-UANON TO GROUPEDA.
  9626*02213
  9627     IF PI-COMPANY-ID NOT = 'CRI'
  9628        GO TO 1050-EDIT-CHECK-NO.
  9629
  9630*************** CRI CODE START ******************
  9631     IF PI-PAYEE-TYPE NOT = 'A'
  9632        GO TO 1050-EDIT-CHECK-NO.
  9633
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 184
* EL156.cbl
  9634     MOVE LOW-VALUES             TO ERACCT-KEY.
  9635     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9636     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9637     MOVE PI-GROUPING            TO ACCT-GROUPING.
  9638     MOVE PI-STATE               TO ACCT-STATE.
  9639     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9640     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
  9641     MOVE 'ACCT'                 TO FILE-SWITCH.
  9642
  9643     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
  9644     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
  9645
  9646
  9647* EXEC CICS HANDLE CONDITION
  9648*         NOTFND   (1950-NOT-FOUND)
  9649*         ENDFILE  (1950-NOT-FOUND)
  9650*    END-EXEC.
  9651*    MOVE '"$I''                  ! ( #00009343' TO DFHEIV0
  9652     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9653     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9654     MOVE X'2820233030303039333433' TO DFHEIV0(25:11)
  9655     CALL 'kxdfhei1' USING DFHEIV0
  9656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9657
  9658
  9659
  9660* EXEC CICS STARTBR
  9661*         DATASET   ('ERACCT')
  9662*         RIDFLD    (ERACCT-KEY)
  9663*         GTEQ
  9664*    END-EXEC.
  9665     MOVE 'ERACCT' TO DFHEIV1
  9666     MOVE 0
  9667       TO DFHEIV11
  9668*    MOVE '&,         G          &   #00009348' TO DFHEIV0
  9669     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9670     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9671     MOVE X'2020233030303039333438' TO DFHEIV0(25:11)
  9672     CALL 'kxdfhei1' USING DFHEIV0,
  9673           DFHEIV1,
  9674           ERACCT-KEY,
  9675           DFHEIV99,
  9676           DFHEIV11,
  9677           DFHEIV99
  9678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9679
  9680
  9681 1046-READNEXT-ERACCT.
  9682
  9683
  9684* EXEC CICS READNEXT
  9685*         DATASET   ('ERACCT')
  9686*         RIDFLD    (ERACCT-KEY)
  9687*         SET       (ADDRESS OF ACCOUNT-MASTER)
  9688*    END-EXEC.
  9689     MOVE 'ERACCT' TO DFHEIV1
  9690     MOVE 0
  9691       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 185
* EL156.cbl
  9692*    MOVE '&.S                   )   #00009356' TO DFHEIV0
  9693     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9694     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9695     MOVE X'2020233030303039333536' TO DFHEIV0(25:11)
  9696     CALL 'kxdfhei1' USING DFHEIV0,
  9697           DFHEIV1,
  9698           DFHEIV20,
  9699           DFHEIV99,
  9700           ERACCT-KEY,
  9701           DFHEIV99,
  9702           DFHEIV11,
  9703           DFHEIV99,
  9704           DFHEIV99
  9705     SET ADDRESS OF ACCOUNT-MASTER TO
  9706         DFHEIV20
  9707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9708
  9709
  9710     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
  9711        IF WS-ERACCT-HOLD-RECORD = SPACES
  9712           GO TO 1950-NOT-FOUND
  9713        ELSE
  9714           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
  9715           GO TO 1048-CONTINUE.
  9716
  9717     IF ACCT-EXP-DT = HIGH-VALUES
  9718        NEXT SENTENCE
  9719     ELSE
  9720        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
  9721        GO TO 1046-READNEXT-ERACCT.
  9722
  9723 1048-CONTINUE.
  9724
  9725*02267      IF AM-GROUPED-CHECKS-Y-N = 'Y'
  9726*02268         MOVE 'Y'                 TO GROUPEDI
  9727*02269                                     PI-GROUPED
  9728*02270                                     WS-GROUPED
  9729*02271         MOVE AL-UANON            TO GROUPEDA.
  9730*************** CRI CODE END ******************
  9731
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 186
* EL156.cbl
  9733 1050-EDIT-CHECK-NO.
  9734
  9735     IF PI-OFFLINE = 'Y'
  9736         IF PI-ECHECKNO = SPACES
  9737              MOVE ER-0439        TO EMI-ERROR
  9738              GO TO 1090-CHECK-NO-ERROR
  9739           ELSE
  9740*02282          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9741*02283             IF PI-ECHECKNO-N = 'N' AND
  9742*02284                PI-CASH       = 'Y'
  9743*02285                  MOVE ER-3535        TO EMI-ERROR
  9744*02286                  GO TO 1090-CHECK-NO-ERROR
  9745*02287               ELSE
  9746*02288                  MOVE AL-UANON    TO CHECKNOA
  9747*02289                  GO TO 1100-EDIT-HOLDTIL
  9748*02290           ELSE
  9749            MOVE AL-UANON    TO CHECKNOA
  9750            GO TO 1100-EDIT-HOLDTIL.
  9751
  9752     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9753     MOVE '6'                    TO CNTL-REC-TYPE.
  9754
  9755     IF CONTROL-IS-ACTUAL-CARRIER
  9756         MOVE PI-CARRIER         TO WS-CARR
  9757     ELSE
  9758         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
  9759
  9760     IF PI-COMPANY-ID = 'FIA'
  9761         MOVE PI-CARRIER         TO WS-CARR.
  9762
  9763     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9764     MOVE 0                      TO CNTL-SEQ-NO.
  9765     MOVE 'CARR'                 TO FILE-SWITCH.
  9766
  9767     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
  9768
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 187
* EL156.cbl
  9770     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9771         GO TO 1051-EDIT-CHECKNO-CONT.
  9772
  9773**********************AIG LOGIC STARTS**********************
  9774     IF PI-ECHECKNO = SPACES
  9775         IF CHECK-NO-MANUAL
  9776             MOVE ER-0441        TO EMI-ERROR
  9777             GO TO 1090-CHECK-NO-ERROR
  9778         ELSE
  9779             MOVE AL-UANOF       TO CHECKNOA
  9780             GO TO 1100-EDIT-HOLDTIL.
  9781
  9782     IF PI-ECHECKNO NOT = SPACES
  9783         IF CHECK-NO-MANUAL
  9784             MOVE AL-UANON       TO CHECKNOA
  9785             GO TO 1100-EDIT-HOLDTIL.
  9786
  9787     IF PI-ECHECKNO-CR = 'CR'
  9788        IF PI-OFFLINE = 'Y'
  9789            MOVE AL-UANON       TO CHECKNOA
  9790            GO TO 1100-EDIT-HOLDTIL
  9791        ELSE
  9792            MOVE ER-3534        TO EMI-ERROR
  9793            GO TO 1090-CHECK-NO-ERROR.
  9794
  9795     IF PI-ECHECKNO-N = 'N'
  9796        IF PI-CASH = 'N'
  9797            MOVE AL-UANON       TO CHECKNOA
  9798            GO TO 1100-EDIT-HOLDTIL
  9799        ELSE
  9800            MOVE ER-3535          TO EMI-ERROR
  9801            GO TO 1090-CHECK-NO-ERROR.
  9802
  9803     MOVE ER-0442        TO EMI-ERROR
  9804     GO TO 1090-CHECK-NO-ERROR.
  9805**********************AIG LOGIC ENDS************************
  9806
  9807 1051-EDIT-CHECKNO-CONT.
  9808
  9809     IF PI-COMPANY-ID = 'DMD'
  9810        IF PI-ECHECKNO NOT = SPACES
  9811           IF PI-ECHECKNO (6:2) NOT = 'TP'
  9812              MOVE ER-0442        TO EMI-ERROR
  9813              GO TO 1090-CHECK-NO-ERROR
  9814            ELSE
  9815              GO TO 1100-EDIT-HOLDTIL
  9816          ELSE
  9817           GO TO 1100-EDIT-HOLDTIL.
  9818
  9819     IF PI-ECHECKNO = SPACES
  9820         IF CHECK-NO-MANUAL
  9821             MOVE ER-0441        TO EMI-ERROR
  9822             GO TO 1090-CHECK-NO-ERROR
  9823         ELSE
  9824             MOVE AL-UANOF       TO CHECKNOA
  9825             GO TO 1100-EDIT-HOLDTIL
  9826     ELSE
  9827         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 188
* EL156.cbl
  9828             MOVE AL-UANON       TO CHECKNOA
  9829             GO TO 1100-EDIT-HOLDTIL
  9830         ELSE
  9831             MOVE ER-0442        TO EMI-ERROR
  9832             GO TO 1090-CHECK-NO-ERROR.
  9833
  9834 1090-CHECK-NO-ERROR.
  9835     MOVE -1                     TO CHECKNOL.
  9836     MOVE AL-UABON               TO CHECKNOA.
  9837     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9838
  9839     GO TO 2000-EDIT-DONE.
  9840
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 189
* EL156.cbl
  9842 1100-EDIT-HOLDTIL.
  9843     MOVE AL-UANON               TO HOLDTILA.
  9844
  9845     IF PI-HOLDTIL = ZEROS
  9846        IF PI-OFFLINE = 'Y'
  9847           MOVE ER-0572          TO EMI-ERROR
  9848           GO TO 1105-HOLDTIL-ERROR
  9849        ELSE
  9850           GO TO 1110-EDIT-PAID-FROM.
  9851
  9852     MOVE '4'                    TO DC-OPTION-CODE.
  9853     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
  9854     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9855
  9856     IF DATE-CONVERSION-ERROR
  9857         MOVE ER-0446            TO EMI-ERROR
  9858         GO TO 1105-HOLDTIL-ERROR
  9859     END-IF
  9860     IF PI-OFFLINE = 'Y'
  9861        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
  9862           MOVE ER-0446            TO EMI-ERROR
  9863           GO TO 1105-HOLDTIL-ERROR
  9864        END-IF
  9865     END-IF
  9866
  9867     IF PI-OFFLINE = 'Y'
  9868        GO TO 1110-EDIT-PAID-FROM.
  9869
  9870     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
  9871     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
  9872     MOVE '1'                    TO DC-OPTION-CODE.
  9873     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9874
  9875     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
  9876         MOVE ER-0447            TO EMI-ERROR
  9877         GO TO 1105-HOLDTIL-ERROR.
  9878
  9879     GO TO 1110-EDIT-PAID-FROM.
  9880
  9881 1105-HOLDTIL-ERROR.
  9882     MOVE -1                     TO HOLDTILL.
  9883     MOVE AL-UNBON               TO HOLDTILA.
  9884     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9885
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 190
* EL156.cbl
  9887 1110-EDIT-PAID-FROM.
  9888     MOVE AL-UANON               TO EPYFROMA.
  9889
  9890     IF PI-EPYFROM = ZEROS
  9891         GO TO 1120-CALCULATE-PAID-FROM.
  9892
  9893     IF PI-PMTTYPE = '5' OR '6'
  9894         MOVE ER-0448            TO EMI-ERROR
  9895         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9896         MOVE AL-UNBON           TO EPYFROMA
  9897         MOVE -1                 TO EPYFROML
  9898         GO TO 1150-EDIT-PAID-THRU.
  9899
  9900     MOVE '4'                    TO DC-OPTION-CODE.
  9901     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
  9902     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9903
  9904     IF DATE-CONVERSION-ERROR
  9905         MOVE ER-0449            TO EMI-ERROR
  9906         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9907         MOVE AL-UNBON           TO EPYFROMA
  9908         MOVE -1                 TO EPYFROML
  9909     ELSE
  9910         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
  9911
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 191
* EL156.cbl
  9913 1120-CALCULATE-PAID-FROM.
  9914     IF PI-PMTTYPE = '5' OR '6'
  9915         GO TO 1150-EDIT-PAID-THRU.
  9916
  9917*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9918*       IF PI-PMTTYPE = '4'
  9919*         GO TO 1150-EDIT-PAID-THRU.
  9920
  9921     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9922         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
  9923         MOVE ' '                TO DC-OPTION-CODE
  9924         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9925         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
  9926         GO TO 1145-TEST-PAID-FROM.
  9927
  9928     IF PI-PMTTYPE = '4'
  9929        GO TO 1150-EDIT-PAID-THRU.
  9930
  9931     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
  9932     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9933     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9934     MOVE '5'                    TO CNTL-REC-TYPE.
  9935     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9936     MOVE 'BENE'                 TO FILE-SWITCH.
  9937
  9938     IF WS-BEN-CD = ZEROS
  9939         GO TO 1950-NOT-FOUND.
  9940
  9941     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9942
  9943     IF NO-BENEFIT-FOUND
  9944         GO TO 1950-NOT-FOUND.
  9945
  9946     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
  9947     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
  9948
  9949     IF PI-BEN-DAYS NOT NUMERIC
  9950        MOVE ZEROS               TO PI-BEN-DAYS.
  9951
  9952     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
  9953
  9954     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
  9955        (CL-TOTAL-PAID-AMT > ZEROS)
  9956         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  9957         MOVE '6'                 TO DC-OPTION-CODE
  9958         MOVE +0                  TO DC-ELAPSED-MONTHS
  9959         MOVE +1                  TO DC-ELAPSED-DAYS
  9960         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9961         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
  9962         GO TO 1145-TEST-PAID-FROM.
  9963
  9964******************************************************************
  9965****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
  9966****** SPECIAL ENTERED DATE.
  9967******************************************************************
  9968
  9969     IF PI-AIGFROM = ZEROS
  9970         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 192
* EL156.cbl
  9971
  9972     MOVE AL-UANON TO AIGFROMA.
  9973
  9974     MOVE '4'                    TO DC-OPTION-CODE.
  9975     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
  9976     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9977
  9978     IF DATE-CONVERSION-ERROR
  9979         MOVE ER-0449            TO EMI-ERROR
  9980         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9981         MOVE AL-UNBON           TO AIGFROMA
  9982         MOVE -1                 TO AIGFROML
  9983         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
  9984     ELSE
  9985         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
  9986         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
  9987
  9988     GO TO 1140-CONTINUE-PAID-FROM.
  9989
  9990 1130-CONTINUE-PAID-FROM.
  9991
  9992     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
  9993        (CL-TOTAL-PAID-AMT = ZEROS)
  9994           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
  9995
  9996 1140-CONTINUE-PAID-FROM.
  9997
  9998     IF PI-BEN-TYPE = 'R'
  9999         IF PI-BEN-DAYS = ZEROS
 10000             NEXT SENTENCE
 10001         ELSE
 10002         IF PI-COMPANY-ID NOT = 'DMD'
 10003             SUBTRACT 1 FROM PI-BEN-DAYS.
 10004
 10005     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10006
 10007     IF PI-COMPANY-ID = 'DMD'
 10008         MOVE -1                 TO DC-ELAPSED-DAYS
 10009         MOVE +0                 TO DC-ELAPSED-MONTHS
 10010         MOVE '6'                TO DC-OPTION-CODE
 10011         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10012         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10013         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10014                               REMAINDER DC-ELAPSED-DAYS
 10015      ELSE
 10016         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10017         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10018
 10019     MOVE '6'                    TO DC-OPTION-CODE.
 10020     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10021     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10022
 10023     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10024
 10025     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10026         MOVE ER-0541            TO EMI-ERROR
 10027         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10028         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 193
* EL156.cbl
 10029         MOVE AL-UNBON           TO EPYFROMA.
 10030
 10031     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10032        (PI-BENEFIT-SAVE = '60E')
 10033        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10034           (CL-TOTAL-PAID-AMT = ZEROS)
 10035             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10036             MOVE 30                  TO DC-ELAPSED-DAYS
 10037             MOVE +0                  TO DC-ELAPSED-MONTHS
 10038             MOVE '6'                 TO DC-OPTION-CODE
 10039             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10040
 10041     IF PI-BEN-TYPE = 'R'
 10042         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10043     ELSE
 10044         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10045         IF WS-SV-EPYFROM = LOW-VALUES
 10046            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10047
 10048     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10049         IF WS-USE-AIG-PAYFROM   OR
 10050            WS-AIG-RECALC-PAYFROM
 10051              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10052                                      DC-BIN-DATE-1
 10053              MOVE ' '            TO  DC-OPTION-CODE
 10054              MOVE +0             TO  DC-ELAPSED-MONTHS
 10055                                      DC-ELAPSED-DAYS
 10056              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10057              IF NO-CONVERSION-ERROR
 10058                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10059
 10060     IF PI-CPYFROM < CL-INCURRED-DT
 10061        MOVE -1                  TO EPYFROML
 10062        MOVE ER-3542             TO EMI-ERROR
 10063        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10064
 10065     IF CM-ENTRY-DT < CL-INCURRED-DT
 10066        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10067        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10068        MOVE +0                     TO DC-ELAPSED-DAYS
 10069        MOVE +0                     TO DC-ELAPSED-MONTHS
 10070        MOVE '1'                    TO DC-OPTION-CODE
 10071        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10072        ELSE
 10073        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10074
 10075     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10076         NEXT SENTENCE
 10077     ELSE
 10078         IF DC-ELAPSED-MONTHS < 2
 10079             MOVE ER-3255        TO EMI-ERROR
 10080             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10081
 10082 1145-TEST-PAID-FROM.
 10083     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10084         GO TO 1150-EDIT-PAID-THRU.
 10085
 10086     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 194
* EL156.cbl
 10087         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10088         MOVE ' '                TO DC-OPTION-CODE
 10089         MOVE +0                 TO DC-ELAPSED-MONTHS
 10090                                    DC-ELAPSED-DAYS
 10091         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10092         IF NO-CONVERSION-ERROR
 10093             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10094         ELSE
 10095             MOVE SPACES             TO EMI-DATE-FIELD.
 10096
 10097     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10098         IF CL-TOTAL-PAID-AMT = ZEROS
 10099             MOVE ER-3543            TO EMI-ERROR
 10100             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10101             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10102             IF EMI-MESSAGE-FORMATTED
 10103                MOVE -1             TO EPYFROML
 10104                MOVE AL-UNBON       TO EPYFROMA
 10105             ELSE
 10106                NEXT SENTENCE
 10107         ELSE
 10108             MOVE ER-0452            TO EMI-ERROR
 10109             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10110             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10111             IF EMI-MESSAGE-FORMATTED
 10112                MOVE -1             TO EPYFROML
 10113                MOVE AL-UNBON       TO EPYFROMA.
 10114
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 195
* EL156.cbl
 10116 1150-EDIT-PAID-THRU.
 10117
 10118     MOVE AL-UANON               TO EPYTHRUA.
 10119
 10120     IF PI-EPYTHRU = ZEROS
 10121         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10122             GO TO 1200-EDIT-FIND-TOLERANCES
 10123         ELSE
 10124            IF (PI-PMTTYPE = '3') OR
 10125               (PI-PMTTYPE = '2' AND
 10126                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10127               GO TO 1152-CHECK-TYPE
 10128            ELSE
 10129               MOVE ER-0473      TO EMI-ERROR
 10130               GO TO 1170-PAID-THRU-FATAL-ERROR
 10131     ELSE
 10132         IF PI-PMTTYPE = '5' OR '6'
 10133             MOVE ER-0474        TO EMI-ERROR
 10134             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10135
 10136     MOVE '4'                    TO DC-OPTION-CODE.
 10137     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10138     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10139
 10140     IF DATE-CONVERSION-ERROR
 10141         MOVE ER-0475            TO EMI-ERROR
 10142         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10143
 10144     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10145
 10146     IF PI-COMPANY-ID = 'DMD'
 10147         IF PI-PMTTYPE NOT = '2'
 10148                 AND
 10149            WS-EXP-DT > WS-SV-EPYTHRU
 10150             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10151             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10152             MOVE '1'              TO DC-OPTION-CODE
 10153             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10154             IF DATE-CONVERSION-ERROR
 10155                 MOVE ER-0944      TO EMI-ERROR
 10156                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10157             ELSE
 10158                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10159                    DC-ELAPSED-DAYS   = 1
 10160                     MOVE ER-0945  TO EMI-ERROR
 10161                     MOVE -1       TO EPYTHRUL
 10162                     MOVE AL-UABON TO EPYTHRUA
 10163                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10164
 10165     IF PI-PMTTYPE = '4'
 10166         NEXT SENTENCE
 10167     ELSE
 10168         IF WS-SV-EPYTHRU = WS-EXP-DT
 10169             IF PI-PMTTYPE NOT = '2' AND '3'
 10170                 MOVE ER-3541    TO EMI-ERROR
 10171                 MOVE -1         TO PMTTYPEL
 10172                 MOVE AL-UABON   TO PMTTYPEA
 10173                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 196
* EL156.cbl
 10174
 10175     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10176         MOVE ER-0501            TO EMI-ERROR
 10177         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10178
 10179     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10180        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 10181*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10182*              MOVE ER-0540         TO EMI-ERROR
 10183*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10184*              MOVE -1              TO EPYTHRUL
 10185*              MOVE AL-UNBON        TO EPYTHRUA
 10186*          ELSE
 10187*          IF PI-COMPANY-ID = 'DMD'
 10188*              MOVE ER-7540         TO EMI-ERROR
 10189*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10190*              MOVE -1              TO EPYTHRUL
 10191*              MOVE AL-UNBON        TO EPYTHRUA
 10192*          ELSE
 10193               IF PI-PMTTYPE NOT = '2' AND '3'
 10194                  IF PI-COMPANY-ID = '???'
 10195                      MOVE ER-7540  TO EMI-ERROR
 10196                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10197                      MOVE -1       TO EPYTHRUL
 10198                      MOVE AL-UNBON TO EPYTHRUA
 10199                  ELSE
 10200                      MOVE ER-0540  TO EMI-ERROR
 10201                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10202                      MOVE -1       TO EPYTHRUL
 10203                      MOVE AL-UNBON TO EPYTHRUA.
 10204
 10205     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10206            OR
 10207        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10208         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10209            OR
 10210        (PI-CPYFROM NOT = LOW-VALUES AND
 10211         PI-CPYFROM < CL-PAID-THRU-DT)
 10212        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10213
 10214 1152-CHECK-TYPE.
 10215     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10216        OR (PI-PMTTYPE = '5' OR '6')
 10217         GO TO 1160-EDIT-PAID-THRU-AH.
 10218
 10219 1155-EDIT-PAID-THRU-LIFE.
 10220     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10221     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10222     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10223     MOVE '4'                    TO CNTL-REC-TYPE.
 10224     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10225     MOVE 'BENE'                 TO FILE-SWITCH.
 10226
 10227     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10228
 10229     IF NO-BENEFIT-FOUND
 10230         GO TO 1950-NOT-FOUND.
 10231
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 197
* EL156.cbl
 10232     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10233
 10234     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10235
 10236     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10237        PI-LF-COVERAGE-TYPE = 'P'
 10238         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10239         GO TO 1200-EDIT-FIND-TOLERANCES.
 10240
 10241     IF PI-EPYTHRU = ZEROS
 10242        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10243
 10244     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10245         MOVE ER-0476            TO EMI-ERROR
 10246         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10247
 10248     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10249     MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10250     MOVE +0                    TO DC-ELAPSED-DAYS.
 10251     MOVE '6'                   TO DC-OPTION-CODE.
 10252     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10253
 10254     IF (NO-CONVERSION-ERROR AND
 10255         WS-SPECIAL-CALC-CD = 'C')
 10256        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10257            MOVE ER-0657 TO EMI-ERROR
 10258            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10259
 10260     IF PI-COMPANY-ID = 'NCL'
 10261         IF WS-SPECIAL-CALC-CD = 'C' AND
 10262            CM-LF-CRITICAL-PERIOD = +0
 10263             MOVE ER-0844       TO EMI-ERROR
 10264             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10265
 10266     GO TO 1200-EDIT-FIND-TOLERANCES.
 10267
 10268 1160-EDIT-PAID-THRU-AH.
 10269     IF PI-EPYTHRU = ZEROS
 10270        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10271                                    WS-SV-EPYTHRU
 10272     ELSE
 10273        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10274
 10275     IF WS-SV-EPYTHRU < PI-CPYFROM
 10276         MOVE ER-0508            TO EMI-ERROR
 10277         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10278
 10279     IF PI-PMTTYPE = '3'
 10280        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10281         IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10282             MOVE ER-0477        TO EMI-ERROR
 10283             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 10284         ELSE
 10285             NEXT SENTENCE
 10286     ELSE
 10287         IF WS-SV-EPYTHRU > WS-EXP-DT
 10288             MOVE ER-0557        TO EMI-ERROR
 10289             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 198
* EL156.cbl
 10290
 10291     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10292         PI-PMTTYPE NOT = '3'
 10293         MOVE ER-0541        TO EMI-ERROR
 10294         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10295
 10296     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 10297        (PI-PMTTYPE NOT = '3')
 10298         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10299             MOVE ER-0478        TO EMI-ERROR
 10300             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10301
 10302     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10303        (PI-PMTTYPE NOT = '4')
 10304         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10305             MOVE ER-0479        TO EMI-ERROR
 10306             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10307
 10308     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10309         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10310             MOVE ER-0545        TO EMI-ERROR
 10311             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10312
 10313     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10314         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10315             MOVE ER-0481        TO EMI-ERROR
 10316             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10317
 10318*    IF PI-COMPANY-ID = 'NCL'
 10319*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10320*           CM-AH-CRITICAL-PERIOD = +0
 10321*            MOVE ER-0844        TO  EMI-ERROR
 10322*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10323
 10324     IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10325        (WS-SPECIAL-CALC-CD NOT = 'C')
 10326          GO TO 1200-EDIT-FIND-TOLERANCES.
 10327
 10328     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10329     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10330     MOVE '1'        TO DC-OPTION-CODE.
 10331     MOVE +0         TO DC-ELAPSED-DAYS
 10332                        DC-ELAPSED-MONTHS.
 10333     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10334
 10335*    IF NO-CONVERSION-ERROR
 10336*       COMPUTE WS-CRIT-PERIOD-DAYS =
 10337*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10338*       IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 10339*           MOVE ER-0657 TO EMI-ERROR
 10340*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10341
 10342     GO TO 1200-EDIT-FIND-TOLERANCES.
 10343
 10344 1165-PAID-THRU-ERROR.
 10345     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10346
 10347     IF EMI-MESSAGE-FORMATTED
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 199
* EL156.cbl
 10348         MOVE -1                 TO EPYTHRUL
 10349         MOVE AL-UNBON           TO EPYTHRUA.
 10350
 10351 1165-EXIT.
 10352     EXIT.
 10353
 10354 1166-CHECK-ALL-TRLRS.
 10355
 10356     IF PI-PMTTYPE = '4'
 10357        GO TO 1166-TRLR-EXIT.
 10358
 10359     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 10360
 10361     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 10362        WS-SV-EPYFROM = LOW-VALUES
 10363          GO TO 1166-END-CHECK.
 10364
 10365
 10366* EXEC CICS HANDLE CONDITION
 10367*        ENDFILE   (1166-END-CHECK)
 10368*        NOTFND    (1166-END-CHECK)
 10369*    END-EXEC.
 10370*    MOVE '"$''I                  ! ) #00010017' TO DFHEIV0
 10371     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10372     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10373     MOVE X'2920233030303130303137' TO DFHEIV0(25:11)
 10374     CALL 'kxdfhei1' USING DFHEIV0
 10375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10376
 10377
 10378     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 10379     MOVE +100                   TO TRLR-SEQ-NO.
 10380
 10381
 10382* EXEC CICS STARTBR
 10383*         DATASET    ('ELTRLR')
 10384*         RIDFLD     (ELTRLR-KEY)
 10385*         GTEQ
 10386*    END-EXEC.
 10387     MOVE 'ELTRLR' TO DFHEIV1
 10388     MOVE 0
 10389       TO DFHEIV11
 10390*    MOVE '&,         G          &   #00010025' TO DFHEIV0
 10391     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10392     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10393     MOVE X'2020233030303130303235' TO DFHEIV0(25:11)
 10394     CALL 'kxdfhei1' USING DFHEIV0,
 10395           DFHEIV1,
 10396           ELTRLR-KEY,
 10397           DFHEIV99,
 10398           DFHEIV11,
 10399           DFHEIV99
 10400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10401
 10402
 10403     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10404
 10405 1166-READ-TRLR-NEXT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 200
* EL156.cbl
 10406
 10407
 10408* EXEC CICS READNEXT
 10409*         DATASET    ('ELTRLR')
 10410*         RIDFLD     (ELTRLR-KEY)
 10411*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10412*    END-EXEC.
 10413     MOVE 'ELTRLR' TO DFHEIV1
 10414     MOVE 0
 10415       TO DFHEIV11
 10416*    MOVE '&.S                   )   #00010035' TO DFHEIV0
 10417     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10418     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10419     MOVE X'2020233030303130303335' TO DFHEIV0(25:11)
 10420     CALL 'kxdfhei1' USING DFHEIV0,
 10421           DFHEIV1,
 10422           DFHEIV20,
 10423           DFHEIV99,
 10424           ELTRLR-KEY,
 10425           DFHEIV99,
 10426           DFHEIV11,
 10427           DFHEIV99,
 10428           DFHEIV99
 10429     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10430         DFHEIV20
 10431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10432
 10433
 10434     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 10435        TRLR-CARRIER  = MSTR-CARRIER  AND
 10436        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 10437        TRLR-CERT-NO  = MSTR-CERT-NO
 10438          NEXT SENTENCE
 10439      ELSE
 10440          GO TO 1166-END-CHECK.
 10441
 10442* **  BYPASS ALL NON-PAYMENT TRAILERS
 10443
 10444     IF AT-TRAILER-TYPE = '2'
 10445        NEXT SENTENCE
 10446     ELSE
 10447        GO TO 1166-READ-TRLR-NEXT.
 10448
 10449* **  BYPASS ALL NON-PARTIAL PAYMENTS
 10450
 10451     IF AT-PAYMENT-TYPE = '1' OR '2'
 10452        NEXT SENTENCE
 10453     ELSE
 10454        GO TO 1166-READ-TRLR-NEXT.
 10455
 10456* **  BYPASS ALL VOID PAYMENTS
 10457
 10458     IF AT-VOID-DT NOT = LOW-VALUES
 10459        GO TO 1166-READ-TRLR-NEXT.
 10460
 10461     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 10462        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 10463          GO TO 1166-READ-TRLR-NEXT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 201
* EL156.cbl
 10464
 10465     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 10466         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 10467            OR
 10468        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 10469         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 10470        NEXT SENTENCE
 10471     ELSE
 10472         IF CL-TOTAL-PAID-AMT > ZEROS
 10473             MOVE ER-0502            TO EMI-ERROR
 10474             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10475             MOVE -1                 TO EPYTHRUL
 10476             MOVE AL-UNBON           TO EPYTHRUA.
 10477
 10478     GO TO 1166-READ-TRLR-NEXT.
 10479
 10480 1166-END-CHECK.
 10481
 10482     IF WS-BROWSE-TRLR-SW = 'Y'
 10483
 10484* EXEC CICS ENDBR
 10485*            DATASET   ('ELTRLR')
 10486*       END-EXEC.
 10487     MOVE 'ELTRLR' TO DFHEIV1
 10488     MOVE 0
 10489       TO DFHEIV11
 10490*    MOVE '&2                    $   #00010090' TO DFHEIV0
 10491     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10492     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10493     MOVE X'2020233030303130303930' TO DFHEIV0(25:11)
 10494     CALL 'kxdfhei1' USING DFHEIV0,
 10495           DFHEIV1,
 10496           DFHEIV11,
 10497           DFHEIV99
 10498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10499
 10500
 10501     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10502
 10503 1166-TRLR-EXIT.
 10504     EXIT.
 10505
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 202
* EL156.cbl
 10507 1170-PAID-THRU-FATAL-ERROR.
 10508     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10509
 10510     MOVE -1                     TO EPYTHRUL.
 10511     MOVE AL-UNBON               TO EPYTHRUA.
 10512
 10513 1200-EDIT-FIND-TOLERANCES.
 10514
 10515* EXEC CICS HANDLE CONDITION
 10516*        ENDFILE(1950-NOT-FOUND)
 10517*        NOTFND (1950-NOT-FOUND)
 10518*    END-EXEC.
 10519*    MOVE '"$''I                  ! * #00010107' TO DFHEIV0
 10520     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10522     MOVE X'2A20233030303130313037' TO DFHEIV0(25:11)
 10523     CALL 'kxdfhei1' USING DFHEIV0
 10524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10525
 10526
 10527     IF PI-PROCESSOR-ID = 'LGXX'
 10528        GO TO 1240-FIND-ACCT-TOLERANCES.
 10529
 10530     MOVE 'N'                    TO FOUND-TOL-SW.
 10531     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10532     MOVE '2'                    TO CNTL-REC-TYPE.
 10533     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 10534     MOVE +0                     TO CNTL-SEQ-NO.
 10535     MOVE 'PROC'                 TO FILE-SWITCH.
 10536
 10537     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10538
 10539     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 10540     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 10541                                    PI-MAX-PMT-TOL.
 10542     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 10543
 10544     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 10545         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 10546
 10547     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 10548     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 10549                                    PI-MAX-LF-PMT-TOL.
 10550
 10551     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 10552         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 10553
 10554     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 10555                                    PI-MAX-EXP-PMT.
 10556
 10557 1240-FIND-ACCT-TOLERANCES.
 10558
 10559     IF WS-PMT-TOL NOT = +0
 10560         MOVE 'Y'                TO FOUND-TOL-SW.
 10561
 10562     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10563         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 10564         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 203
* EL156.cbl
 10565         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 10566         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 10567         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 10568         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 10569     ELSE
 10570         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 10571         MOVE PI-CARRIER             TO ACCT-CARRIER
 10572         MOVE PI-GROUPING            TO ACCT-GROUPING
 10573         MOVE PI-STATE               TO ACCT-STATE
 10574         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 10575         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10576
 10577     MOVE 'ACCT'                 TO FILE-SWITCH.
 10578
 10579     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10580     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10581
 10582
 10583* EXEC CICS HANDLE CONDITION
 10584*         NOTFND   (1950-NOT-FOUND)
 10585*         ENDFILE  (1950-NOT-FOUND)
 10586*    END-EXEC.
 10587*    MOVE '"$I''                  ! + #00010167' TO DFHEIV0
 10588     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10589     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10590     MOVE X'2B20233030303130313637' TO DFHEIV0(25:11)
 10591     CALL 'kxdfhei1' USING DFHEIV0
 10592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10593
 10594
 10595
 10596* EXEC CICS STARTBR
 10597*        DATASET('ERACCT')
 10598*        RIDFLD (ERACCT-KEY)
 10599*        GTEQ
 10600*    END-EXEC.
 10601     MOVE 'ERACCT' TO DFHEIV1
 10602     MOVE 0
 10603       TO DFHEIV11
 10604*    MOVE '&,         G          &   #00010172' TO DFHEIV0
 10605     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10606     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10607     MOVE X'2020233030303130313732' TO DFHEIV0(25:11)
 10608     CALL 'kxdfhei1' USING DFHEIV0,
 10609           DFHEIV1,
 10610           ERACCT-KEY,
 10611           DFHEIV99,
 10612           DFHEIV11,
 10613           DFHEIV99
 10614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10615
 10616
 10617 1245-FIND-ACCT-TOLERANCES-LOOP.
 10618
 10619
 10620* EXEC CICS READNEXT
 10621*        DATASET('ERACCT')
 10622*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 204
* EL156.cbl
 10623*        RIDFLD (ERACCT-KEY)
 10624*    END-EXEC.
 10625     MOVE 'ERACCT' TO DFHEIV1
 10626     MOVE 0
 10627       TO DFHEIV11
 10628*    MOVE '&.S                   )   #00010180' TO DFHEIV0
 10629     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10630     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10631     MOVE X'2020233030303130313830' TO DFHEIV0(25:11)
 10632     CALL 'kxdfhei1' USING DFHEIV0,
 10633           DFHEIV1,
 10634           DFHEIV20,
 10635           DFHEIV99,
 10636           ERACCT-KEY,
 10637           DFHEIV99,
 10638           DFHEIV11,
 10639           DFHEIV99,
 10640           DFHEIV99
 10641     SET ADDRESS OF ACCOUNT-MASTER TO
 10642         DFHEIV20
 10643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10644
 10645
 10646     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10647        IF WS-ERACCT-HOLD-RECORD = SPACES
 10648           GO TO 1950-NOT-FOUND
 10649        ELSE
 10650           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10651           GO TO 1250-CONTINUE.
 10652
 10653     IF ACCT-EXP-DT = HIGH-VALUES
 10654        NEXT SENTENCE
 10655     ELSE
 10656        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10657        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 10658
 10659 1250-CONTINUE.
 10660
 10661     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 10662
 10663     IF FOUND-TOL-SW = 'N'
 10664         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 10665
 10666********* 1260-FIND-STATE-TOLERANCES.
 10667
 10668     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10669     MOVE PI-STATE               TO WS-ST-ACCESS.
 10670     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 10671     MOVE '3'                    TO CNTL-REC-TYPE.
 10672     MOVE +0                     TO CNTL-SEQ-NO.
 10673     MOVE 'STAT'                 TO FILE-SWITCH.
 10674
 10675     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10676
 10677     IF WS-PMT-TOL = +0
 10678         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 10679
 10680     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 205
* EL156.cbl
 10681     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 10682     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 10683     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 10684     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 10685
 10686****USE THIS ROUTINE TO CHECK PAYEE NAME EQUAL TO DECEASED
 10687     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 AND
 10688*        PI-VFY-2ND-BENE = 'Y' AND
 10689        PI-PAYEE-TYPE <> 'B'
 10690           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 10691     END-IF.
 10692
 10693     IF PI-PMTTYPE      = '2'  AND
 10694        PI-SPLIT-PMT-SW = 'Y'  AND
 10695        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 10696          MOVE ER-3530                TO EMI-ERROR
 10697          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10698
 10699********* 1280-FIND-BENEFIT-TOLERANCES.
 10700
 10701     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10702        OR (PI-PMTTYPE = '5' OR '6')
 10703         GO TO 1300-FIND-CARR-TOLERANCES.
 10704
 10705     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10706     MOVE '4'                    TO CNTL-REC-TYPE.
 10707     MOVE +0                     TO CNTL-SEQ-NO.
 10708     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10709     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10710     MOVE 'BENE'                 TO FILE-SWITCH.
 10711
 10712     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10713
 10714     IF NO-BENEFIT-FOUND
 10715         GO TO 1950-NOT-FOUND.
 10716
 10717     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 10718     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 10719     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 10720
 10721
 10722* EXEC CICS HANDLE CONDITION
 10723*        NOTFND(1950-NOT-FOUND)
 10724*    END-EXEC.
 10725*    MOVE '"$I                   ! , #00010261' TO DFHEIV0
 10726     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10727     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10728     MOVE X'2C20233030303130323631' TO DFHEIV0(25:11)
 10729     CALL 'kxdfhei1' USING DFHEIV0
 10730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10731
 10732
 10733 1300-FIND-CARR-TOLERANCES.
 10734     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10735     MOVE '6'                    TO CNTL-REC-TYPE.
 10736
 10737     IF CONTROL-IS-ACTUAL-CARRIER
 10738         MOVE PI-CARRIER               TO WS-CARR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 206
* EL156.cbl
 10739     ELSE
 10740         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10741
 10742     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10743     MOVE +0                     TO CNTL-SEQ-NO.
 10744     MOVE 'CARR'                 TO FILE-SWITCH.
 10745
 10746     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 10747
 10748     IF WS-DAYS-TOL = +0
 10749         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 10750
 10751     IF WS-PMT-TOL = +0
 10752         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 10753
 10754     IF WS-MAX-DAYS-TOL = +0
 10755         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 10756
 10757     IF WS-MAX-PMT-TOL = +0
 10758         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 10759                                    PI-MAX-PMT-TOL.
 10760
 10761     IF WS-MAX-LF-PMT-TOL = +0
 10762        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 10763                                    PI-MAX-LF-PMT-TOL.
 10764
 10765     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 10766
 10767********* 1320-FIND-COMP-TOLERANCES.
 10768
 10769     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10770     MOVE '1'                    TO CNTL-REC-TYPE.
 10771     MOVE SPACES                 TO CNTL-ACCESS.
 10772     MOVE +0                     TO CNTL-SEQ-NO.
 10773     MOVE 'COMP'                 TO FILE-SWITCH.
 10774
 10775     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10776
 10777     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 10778     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 10779
 10780     IF WS-PMT-TOL NOT = +0
 10781        IF WS-TOL-SEVERITY NOT = ' '
 10782         GO TO 1360-EDIT-DAYS.
 10783
 10784     IF WS-PMT-TOL = +0
 10785         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 10786
 10787     IF WS-TOL-SEVERITY = ' '
 10788         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 10789
 10790 1360-EDIT-DAYS.
 10791     IF PI-PMTTYPE NOT = '4'
 10792        IF PI-EDAYS NEGATIVE OR
 10793           PI-EPYAMT NEGATIVE
 10794          MOVE ER-0513             TO EMI-ERROR
 10795          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10796          MOVE -1                  TO PMTTYPEL.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 207
* EL156.cbl
 10797
 10798     IF PI-PMTTYPE = '5' OR '6'
 10799        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 10800
 10801     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10802        IF PI-PMTTYPE = '4'
 10803          MOVE PI-EDAYS          TO PI-CDAYS.
 10804
 10805     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10806         GO TO 1440-COMPUTE-LIFE-REMAINING.
 10807
 10808     IF PI-PMTTYPE = '4'
 10809        MOVE PI-EDAYS            TO PI-CDAYS
 10810        GO TO 1400-EDIT-PAYMENT.
 10811
 10812     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 10813        GO TO 1500-EDIT-EXPENSES.
 10814
 10815*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10816*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 10817*          CM-AH-BENEFIT-CD = '23'              AND
 10818*          CL-CERT-STATE    = '04'              AND
 10819*         (PI-PMTTYPE = '1' OR '2' OR '3')
 10820*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 10821*            GO TO 1362-CHECK-MAX-DAYS.
 10822
 10823     IF PI-EDAYS = ZEROS
 10824*        IF PI-COMPANY-ID = 'DMD'
 10825*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 10826*            MOVE -1             TO DC-ELAPSED-DAYS
 10827*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 10828*            MOVE '6'            TO DC-OPTION-CODE
 10829*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10830*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 10831*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 10832*            MOVE '1'            TO DC-OPTION-CODE
 10833*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10834*            IF NO-CONVERSION-ERROR
 10835*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 10836*                                 + DC-ODD-DAYS-OVER
 10837*               MOVE 6           TO EDAYSL
 10838*               MOVE AL-UNNON    TO EDAYSA
 10839*            ELSE
 10840*                NEXT SENTENCE
 10841*       ELSE
 10842            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 10843            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 10844            MOVE '1'             TO DC-OPTION-CODE
 10845            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10846            IF NO-CONVERSION-ERROR
 10847                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 10848                ADD 1                 TO PI-EDAYS
 10849                MOVE AL-UNNON         TO EDAYSA.
 10850
 10851*    IF PI-COMPANY-ID = 'DMD'
 10852*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10853*        MOVE -1                 TO DC-ELAPSED-DAYS
 10854*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 208
* EL156.cbl
 10855*        MOVE '6'                TO DC-OPTION-CODE
 10856*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10857*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10858*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 10859*        MOVE '1'                TO DC-OPTION-CODE
 10860*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10861*    ELSE
 10862         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 10863         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 10864         MOVE '1'                TO DC-OPTION-CODE.
 10865         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10866
 10867     IF NO-CONVERSION-ERROR
 10868        IF PI-COMPANY-ID = 'DMD'
 10869            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 10870                             + DC-ODD-DAYS-OVER
 10871        ELSE
 10872            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 10873            ADD 1                TO PI-CDAYS.
 10874
 10875     IF DC-ODD-DAYS-OVER NOT = ZEROS
 10876        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 10877        ADD 1                    TO EXPENSE-MONTH-SAVE.
 10878
 10879     IF PI-EDAYS NOT NUMERIC
 10880         MOVE ER-0491            TO EMI-ERROR
 10881         GO TO 1370-DAYS-ERROR.
 10882
 10883     IF CL-NO-OF-PMTS-MADE = 0
 10884        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 10885        AND CL-CERT-STATE = 'MI'
 10886        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 10887            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 10888     END-IF.
 10889
 10890 1362-CHECK-MAX-DAYS.
 10891
 10892     IF WS-MAX-DAYS-TOL = +999
 10893         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 10894
 10895     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 10896         IF PI-EDAYS = ZEROS
 10897             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 10898         ELSE
 10899             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 10900
 10901     IF WS-MAX-DAYS-TOL NOT = ZERO
 10902        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 10903           PI-CDAYS > WS-MAX-DAYS-TOL
 10904             MOVE ER-0492          TO EMI-ERROR
 10905             GO TO 1370-DAYS-ERROR.
 10906
 10907 1365-SKIP-MAX-DAYS-EDIT.
 10908     IF PI-EDAYS = ZEROS
 10909        GO TO 1400-EDIT-PAYMENT.
 10910
 10911     IF WS-DAYS-TOL NOT = ZERO
 10912        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 209
* EL156.cbl
 10913           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
 10914                MOVE ER-0493     TO EMI-ERROR
 10915                GO TO 1370-DAYS-ERROR.
 10916
 10917     GO TO 1400-EDIT-PAYMENT.
 10918
 10919 1370-DAYS-ERROR.
 10920     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10921
 10922     IF EMI-MESSAGE-FORMATTED
 10923         MOVE -1                 TO EDAYSL
 10924         MOVE AL-UABON           TO EDAYSA.
 10925
 10926     GO TO 1400-EDIT-PAYMENT.
 10927
 10928 1380-EDIT-EXPENSE-PMT-AMT.
 10929     IF PI-PMTTYPE = '5' OR '6'
 10930         NEXT SENTENCE
 10931     ELSE
 10932         GO TO 1400-EDIT-PAYMENT.
 10933
 10934     IF WS-MAX-EXP-PMT NOT = ZEROS
 10935        IF PI-EPYAMT > WS-MAX-EXP-PMT
 10936            MOVE ER-3529            TO EMI-ERROR
 10937            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 10938
 10939     GO TO 1500-EDIT-EXPENSES.
 10940
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 210
* EL156.cbl
 10942
 10943 1390-CHECK-PAYMENT-DAYS.
 10944
 10945     IF PI-EDAYS = 0
 10946         MOVE PI-CDAYS TO WS-PD-DAYS
 10947     ELSE
 10948         MOVE PI-EDAYS TO WS-PD-DAYS
 10949     END-IF.
 10950
 10951     IF CM-AH-BENEFIT-CD = '20' OR '21'
 10952         IF WS-PD-DAYS = 14
 10953            GO TO 1390-EXIT
 10954         END-IF
 10955     END-IF.
 10956
 10957     IF PI-COMPANY-ID = 'AHL'  AND
 10958        CM-AH-BENEFIT-CD = '1K'
 10959         IF WS-PD-DAYS = 14
 10960            GO TO 1390-EXIT
 10961         END-IF
 10962     END-IF.
 10963
 10964     IF WS-PD-DAYS < 30
 10965         MOVE ER-3549              TO EMI-ERROR
 10966         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 10967     END-IF.
 10968
 10969 1390-EXIT.
 10970      EXIT.
 10971
 10972 1400-EDIT-PAYMENT.
 10973*    IF PI-COMPANY-ID = 'DMD'
 10974*       IF CL-CERT-NO (5:2) = '69' OR '70'
 10975*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 10976
 10977     IF PI-PMTTYPE NOT = '4'
 10978        GO TO 1405-CALC-PAYMENT.
 10979
 10980     IF PI-EDAYS NOT NUMERIC
 10981         MOVE PI-EPYAMT           TO PI-CPYAMT
 10982         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 10983         GO TO 1430-CHECK-AH-TOLERANCE.
 10984
 10985*    IF PI-COMPANY-ID = 'FIA'
 10986*       IF CERT-ACCOUNT = '0000011043'
 10987*        COMPUTE PI-DAILY-RATE ROUNDED =
 10988*                      (CM-AH-BENEFIT-AMT * 13) / 365
 10989*        COMPUTE PI-CPYAMT ROUNDED =
 10990*                          PI-DAILY-RATE * PI-EDAYS
 10991*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 10992*        GO TO 1430-CHECK-AH-TOLERANCE.
 10993
 10994     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 10995         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 10996         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 10997         GO TO 1420-CHECK-AIG-BENEFIT.
 10998
 10999     IF WS-CALC-METHOD = '2' OR  '5'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 211
* EL156.cbl
 11000         COMPUTE PI-DAILY-RATE ROUNDED =
 11001                        (CM-AH-BENEFIT-AMT * 12) / 365
 11002         COMPUTE PI-CPYAMT ROUNDED =
 11003                           PI-DAILY-RATE * PI-EDAYS
 11004        GO TO 1420-CHECK-AIG-BENEFIT.
 11005
 11006     IF WS-CALC-METHOD = '3'
 11007         COMPUTE PI-DAILY-RATE =
 11008                         (CM-AH-BENEFIT-AMT * 12) / 365
 11009         COMPUTE PI-CPYAMT ROUNDED =
 11010                           PI-DAILY-RATE * PI-EDAYS
 11011        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 212
* EL156.cbl
 11013*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11014
 11015****************************************************************
 11016****************************************************************
 11017*                  CALCULATED FROM      PAYMENT      PAYMENT
 11018*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11019* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11020*1-01-83  1-15-83    0    15     15        15           15
 11021*1-01-83  1-30-83    0    30     30        30           30
 11022*1-01-83  1-31-83    1     0     31        30           30
 11023*1-01-83  2-01-83    1     1     32        31           31
 11024*1-01-83  2-15-83    1    15     46        45           45
 11025*1-01-83  2-28-83    2     0     59        60           60
 11026*1-01-83  3-01-83    2     1     60        61           61
 11027*1-01-83  3-31-83    3     0     90        90           90
 11028*1-15-83  1-31-83    0    17     17        17           16
 11029*1-15-83  2-01-83    0    18     18        18           17
 11030*1-15-83  2-28-83    1    14     45        44           46
 11031*1-21-83  3-09-83    1    20     48        50           49
 11032*2-05-83  3-06-83    1     2     30        32           32
 11033*2-05-83  3-23-83    1    19     47        49           49
 11034*2-15-83  2-28-83    0    14     14        14           16
 11035*2-15-83  3-01-83    0    15     15        15           17
 11036*2-21-83  3-19-83    0    27     27        27           29
 11037*2-21-83  3-20-83    1     0     28        30           30
 11038*2-21-83  4-10-83    1    18     49        30           50
 11039*2-21-83  5-19-83    2    27     88        87           89
 11040*2-21-83  5-22-83    3     2     91        92           92
 11041*3-21-83  5-19-83    1    30     60        60           59
 11042****************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 213
* EL156.cbl
 11044 1405-CALC-PAYMENT.
 11045     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11046     MOVE ' '                    TO DC-OPTION-CODE.
 11047     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11048     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11049     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11050
 11051     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11052     MOVE ' '                    TO DC-OPTION-CODE.
 11053     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11054     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11055     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11056
 11057     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11058     MOVE -1                     TO DC-ELAPSED-DAYS.
 11059     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11060     MOVE '6'                    TO DC-OPTION-CODE.
 11061     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11062     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11063
 11064     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11065     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11066     MOVE '1'                    TO DC-OPTION-CODE.
 11067     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11068
 11069     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11070     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11071     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11072
 11073******************************************************************
 11074*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11075*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11076*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11077******************************************************************
 11078
 11079     IF WS-CALC-METHOD = '1'           AND
 11080        DC-ELAPSED-MONTHS > ZERO AND
 11081        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11082        WDF-DAY > WDT-DAY
 11083          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11084          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11085          MOVE -1                  TO DC-ELAPSED-MONTHS
 11086          MOVE '6'                 TO DC-OPTION-CODE
 11087          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11088          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11089          COMPUTE WS-SAVE-ODD-DAYS =
 11090          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11091          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11092
 11093     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11094     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11095     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11096
 11097     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11098     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11099
 11100*    IF PI-COMPANY-ID = 'FIA'
 11101*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 214
* EL156.cbl
 11102*        COMPUTE PI-DAILY-RATE ROUNDED =
 11103*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11104*        COMPUTE PI-CPYAMT ROUNDED =
 11105*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11106*        GO TO 1420-CHECK-AIG-BENEFIT.
 11107
 11108*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11109*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11110*          CM-AH-BENEFIT-CD = '23'               AND
 11111*          CL-CERT-STATE    = '04'               AND
 11112*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11113*            COMPUTE WS-DAILY-RATE ROUNDED =
 11114*                               CM-AH-BENEFIT-AMT / 30
 11115*            COMPUTE PI-CPYAMT ROUNDED =
 11116*                               (WS-DAILY-RATE * PI-CDAYS)
 11117*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11118*            GO TO 1420-CHECK-AIG-BENEFIT.
 11119
 11120     IF WS-CALC-METHOD = '1'
 11121         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11122         COMPUTE PI-CPYAMT ROUNDED =
 11123             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11124             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11125         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11126         GO TO 1420-CHECK-AIG-BENEFIT.
 11127
 11128     IF WS-CALC-METHOD = '2'
 11129         COMPUTE PI-DAILY-RATE ROUNDED =
 11130                          (CM-AH-BENEFIT-AMT * 12) / 365
 11131         COMPUTE PI-CPYAMT ROUNDED =
 11132             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11133             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11134         GO TO 1420-CHECK-AIG-BENEFIT.
 11135
 11136     IF WS-CALC-METHOD = '4'
 11137         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11138         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11139         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11140         COMPUTE PI-CPYAMT ROUNDED =
 11141                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11142         GO TO 1420-CHECK-AIG-BENEFIT.
 11143
 11144     IF WS-CALC-METHOD = '5'
 11145         COMPUTE PI-DAILY-RATE ROUNDED =
 11146                            (CM-AH-BENEFIT-AMT * 12) / 365
 11147         COMPUTE PI-CPYAMT ROUNDED =
 11148                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11149         GO TO 1420-CHECK-AIG-BENEFIT.
 11150
 11151     IF WS-CALC-METHOD NOT = '3'
 11152        GO TO 1410-CHECK-PAYMENT.
 11153
 11154******   CALCULATION METHOD  3  ROUTINE
 11155     COMPUTE PI-DAILY-RATE =
 11156                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11157
 11158******CHECK TO SEE IF WITHIN SAME MONTH
 11159     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 215
* EL156.cbl
 11160        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11161                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11162         GO TO 1420-CHECK-AIG-BENEFIT.
 11163
 11164******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11165     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11166             SAVE-ODD-DAYS-OVER = ZEROS
 11167      COMPUTE PI-CPYAMT  ROUNDED =
 11168                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11169      GO TO 1420-CHECK-AIG-BENEFIT.
 11170
 11171******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11172******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11173     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11174        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11175        IF WDF-MONTH > 12
 11176           ADD 1                 TO WDF-YEAR
 11177           SUBTRACT 12         FROM WDF-MONTH.
 11178
 11179******CONVERT THE NEW FROM MONTH TO BINARY
 11180     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11181        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11182        MOVE '4'              TO DC-OPTION-CODE
 11183        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11184        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11185
 11186     IF WDF-MONTH = WDT-MONTH AND
 11187        WDF-YEAR  = WDT-YEAR
 11188          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11189                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11190                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11191        ELSE
 11192          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11193          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11194          COMPUTE PI-CPYAMT ROUNDED =
 11195       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11196       +
 11197       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11198       +
 11199       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11200
 11201     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 216
* EL156.cbl
 11203 1410-CHECK-PAYMENT.
 11204******PAYMENT OPTION 6
 11205******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11206     IF SAVE-ELAPSED-MONTHS > ZERO
 11207        IF SAVE-ODD-DAYS-OVER = ZEROS
 11208           GO TO 1412-CHECK-TO-DAY
 11209        ELSE
 11210           IF WDF-DAY > WDT-DAY
 11211              IF WDF-MONTH = 02
 11212                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11213                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11214                  GO TO 1412-CHECK-TO-DAY
 11215              ELSE
 11216                  IF FROM-DAYS-IN-MONTH = 31
 11217                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11218                     GO TO 1412-CHECK-TO-DAY
 11219                  ELSE
 11220                     GO TO 1412-CHECK-TO-DAY
 11221           ELSE
 11222               GO TO 1412-CHECK-TO-DAY.
 11223
 11224     IF WDF-MONTH NOT = WDT-MONTH
 11225        IF WDF-MONTH = 02
 11226           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11227           IF WDF-DAY = 29
 11228              ADD 1              TO SAVE-ODD-DAYS-OVER
 11229           ELSE
 11230              ADD 2              TO SAVE-ODD-DAYS-OVER
 11231        ELSE
 11232           IF FROM-DAYS-IN-MONTH = 31
 11233              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11234
 11235 1412-CHECK-TO-DAY.
 11236        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11237           IF WDT-DAY = 28
 11238              ADD 2              TO SAVE-ODD-DAYS-OVER
 11239           ELSE
 11240              IF WDT-DAY = 29
 11241                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11242              ELSE
 11243                 NEXT SENTENCE
 11244        ELSE
 11245           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11246              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11247
 11248     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11249     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11250     COMPUTE PI-CPYAMT ROUNDED =
 11251         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11252         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11253
 11254     GO TO 1420-CHECK-AIG-BENEFIT.
 11255
 11256 1415-CHECK-LEAP-YEAR.
 11257     IF FROM-DAYS-IN-MONTH = 29
 11258        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11259
 11260 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 217
* EL156.cbl
 11261     EXIT.
 11262
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 218
* EL156.cbl
 11264 1420-CHECK-AIG-BENEFIT.
 11265
 11266     IF WS-SPECIAL-CALC-CD = 'Q'
 11267         GO TO 1425-CHECK-WHOLE-MONTH.
 11268
 11269*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11270*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11271*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11272*       (PI-PMTTYPE = '1' OR '2')
 11273*        NEXT SENTENCE
 11274*    ELSE
 11275         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11276         GO TO 1430-CHECK-AH-TOLERANCE.
 11277
 11278******************AIG LOGIC STARTS**********************
 11279*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 11280*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 11281*    MOVE ER-3533      TO EMI-ERROR.
 11282*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11283*    GO TO 1430-CHECK-AH-TOLERANCE.
 11284******************AIG LOGIC ENDS************************
 11285
 11286 1425-CHECK-WHOLE-MONTH.
 11287******************************************************************
 11288****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 11289****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 11290****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 11291****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 11292****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 11293****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 11294****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 11295****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 11296****          PAID * MONTHLY BENEFIT.                         ****
 11297******************************************************************
 11298
 11299     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 11300
 11301     IF CL-NO-OF-PMTS-MADE > +0
 11302         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 11303
 11304     IF PI-CDAYS < WS-BEN-DAYS
 11305         GO TO 1430-CHECK-AH-TOLERANCE.
 11306
 11307     IF PI-CDAYS = WS-BEN-DAYS
 11308         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 11309         GO TO 1430-CHECK-AH-TOLERANCE.
 11310
 11311*    IF PI-COMPANY-ID = 'ACM'
 11312*       NEXT SENTENCE
 11313*    ELSE
 11314        GO TO 1425-NOT-ACM-W15C.
 11315
 11316*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 11317*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 11318*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 11319*    MOVE '6'                    TO  DC-OPTION-CODE.
 11320*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11321*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 219
* EL156.cbl
 11322*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 11323*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 11324*       MOVE '1'                 TO  DC-OPTION-CODE
 11325*       MOVE +0                  TO  DC-ELAPSED-DAYS
 11326*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 11327*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11328*       IF NO-CONVERSION-ERROR
 11329*          IF (DC-ELAPSED-MONTHS > +0) OR
 11330*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 11331*             NEXT SENTENCE
 11332*          ELSE
 11333*             MOVE +0            TO  PI-CPYAMT
 11334*             MOVE ER-0846       TO  EMI-ERROR
 11335*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11336*             GO TO 1430-CHECK-AH-TOLERANCE
 11337*       ELSE
 11338*           MOVE ER-0846         TO  EMI-ERROR
 11339*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11340*           GO TO 1430-CHECK-AH-TOLERANCE.
 11341*
 11342*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 11343*       ADD +1 TO DC-ELAPSED-MONTHS.
 11344*
 11345*    COMPUTE PI-CPYAMT ROUNDED =
 11346*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11347*
 11348*    GO TO 1430-CHECK-AH-TOLERANCE.
 11349
 11350 1425-NOT-ACM-W15C.
 11351
 11352     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 11353     MOVE '6'                        TO  DC-OPTION-CODE.
 11354     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11355     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 11356
 11357     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11358     IF NO-CONVERSION-ERROR
 11359         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 11360     ELSE
 11361         MOVE ER-0846                TO  EMI-ERROR
 11362         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11363         GO TO 1430-CHECK-AH-TOLERANCE.
 11364
 11365     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 11366     MOVE '1'                        TO  DC-OPTION-CODE.
 11367     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11368     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11369     IF NO-CONVERSION-ERROR
 11370         IF DC-ODD-DAYS-OVER = +0
 11371             NEXT SENTENCE
 11372         ELSE
 11373             MOVE ER-0846            TO  EMI-ERROR
 11374             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11375             GO TO 1430-CHECK-AH-TOLERANCE
 11376     ELSE
 11377         MOVE ER-0846                TO  EMI-ERROR
 11378         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11379         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 220
* EL156.cbl
 11380
 11381     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 11382         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 11383
 11384     GO TO 1430-CHECK-AH-TOLERANCE.
 11385
 11386 1425-CONT-WHOLE-MONTH-PMTS.
 11387******************************************************************
 11388****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 11389****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 11390****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 11391******************************************************************
 11392
 11393     IF PI-COMPANY-ID = 'ACM'
 11394        NEXT SENTENCE
 11395     ELSE
 11396        IF DC-ODD-DAYS-OVER = +0
 11397            NEXT SENTENCE
 11398        ELSE
 11399            MOVE ER-0845            TO  EMI-ERROR
 11400            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11401            GO TO 1430-CHECK-AH-TOLERANCE.
 11402
 11403     COMPUTE PI-CPYAMT ROUNDED =
 11404                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11405
 11406 1430-CHECK-AH-TOLERANCE.
 11407     IF PI-PMT-APPR-SW = 'G'
 11408         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 11409
 11410*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11411*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 11412*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 11413*
 11414*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11415*      IF WDF-MONTH = 02
 11416*        IF SAVE-ELAPSED-MONTHS = 0
 11417*          NEXT SENTENCE
 11418*        ELSE
 11419*          IF SAVE-ODD-DAYS-OVER > 0
 11420*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11421*            COMPUTE WS-PMT-MOS ROUNDED =
 11422*                (SAVE-ODD-DAYS-OVER / +30) + .005
 11423*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11424*                                     WS-PMT-MOS
 11425*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 11426*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 11427*          ELSE
 11428*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11429*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 11430*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11431*                                     WS-PMT-MOS.
 11432
 11433     IF WS-MAX-PMT-TOL NOT = ZERO
 11434        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 11435           (PI-CPYAMT > WS-MAX-PMT-TOL)
 11436            MOVE ER-0494         TO  EMI-ERROR
 11437            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 221
* EL156.cbl
 11438            GO TO 1500-EDIT-EXPENSES.
 11439
 11440 1430-CONT-CHECK-AH-TOLERANCE.
 11441
 11442     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 11443        GO TO 1500-EDIT-EXPENSES.
 11444
 11445     IF CM-O-B-COVERAGE
 11446        GO TO 1500-EDIT-EXPENSES.
 11447
 11448     IF PI-COMPANY-ID = 'NCL'
 11449       IF FOUND-TOL-SW = 'Y'
 11450         IF WS-PMT-TOL NOT = ZERO
 11451           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11452              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11453                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 11454                  IF WS-NCL-PMT-OPTION = SPACES
 11455                      MOVE ER-0699 TO EMI-ERROR
 11456                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11457                  ELSE
 11458                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 11459                      NEXT SENTENCE
 11460                  ELSE
 11461                  IF NOT WS-VALID-NCL-OPTION
 11462                      MOVE ER-0699 TO EMI-ERROR
 11463                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11464
 11465     IF WS-PMT-TOL NOT = ZERO
 11466        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11467           ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11468                MOVE ER-0495     TO EMI-ERROR
 11469                PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11470
 11471     GO TO 1500-EDIT-EXPENSES.
 11472
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 222
* EL156.cbl
 11474 1440-COMPUTE-LIFE-REMAINING.
 11475
 11476     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11477        IF PI-PMTTYPE = '4'
 11478          MOVE PI-EPYAMT TO PI-CPYAMT
 11479          GO TO 1460-TEST-TYPE.
 11480
 11481     IF WS-LF-COVERAGE-TYPE = 'L'
 11482        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 11483                          - CL-TOTAL-PAID-AMT
 11484        GO TO 1450-CHECK-MAX.
 11485
 11486     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11487        PI-LF-COVERAGE-TYPE = 'P'
 11488          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 11489                              CM-LF-ITD-DEATH-AMT
 11490          GO TO 1450-CHECK-MAX.
 11491
 11492     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 11493     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 11494     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 11495     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 11496     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 11497     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 11498     MOVE '4'                    TO CP-REM-TERM-METHOD.
 11499     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 11500     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 11501
 11502     PERFORM 9800-LINK-REM-TERM.
 11503
 11504     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 11505     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 11506     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 11507     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 11508     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 11509     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 11510     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 11511     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 11512     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 11513     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 11514     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 11515     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 11516     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 11517     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 11518     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 11519     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 11520
 11521
 11522* EXEC CICS LINK
 11523*       PROGRAM  (LINK-REMAMT)
 11524*       COMMAREA (CALCULATION-PASS-AREA)
 11525*       LENGTH   (CP-COMM-LENGTH)
 11526*    END-EXEC.
 11527*    MOVE '."C                   (   #00011053' TO DFHEIV0
 11528     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11529     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11530     MOVE X'2020233030303131303533' TO DFHEIV0(25:11)
 11531     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 223
* EL156.cbl
 11532           LINK-REMAMT,
 11533           CALCULATION-PASS-AREA,
 11534           CP-COMM-LENGTH,
 11535           DFHEIV99,
 11536           DFHEIV99,
 11537           DFHEIV99,
 11538           DFHEIV99
 11539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11540
 11541
 11542     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 11543
 11544     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 11545     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 11546
 11547     IF PI-COMPANY-ID = 'BOA' AND
 11548        PI-PMTTYPE    = '2'   AND
 11549        PI-OFFLINE    = 'N'
 11550           GO TO 1441-COMPUTE-BOA-INTEREST.
 11551
 11552     IF PI-COMPANY-ID = 'NCL' AND
 11553        PI-PMTTYPE    = '2'   AND
 11554        PI-OFFLINE    = 'N'
 11555          GO TO 1442-COMPUTE-NCL-INTEREST
 11556       ELSE
 11557          GO TO 1445-CONTINUE.
 11558
 11559 1441-COMPUTE-BOA-INTEREST.
 11560     MOVE +0             TO WS-CALC-INT.
 11561
 11562     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 11563     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 11564     MOVE +0             TO DC-ELAPSED-MONTHS
 11565                            DC-ELAPSED-DAYS.
 11566     MOVE '1'            TO DC-OPTION-CODE.
 11567     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11568     IF NO-CONVERSION-ERROR
 11569         NEXT SENTENCE
 11570     ELSE
 11571         GO TO 1445-CONTINUE.
 11572
 11573     IF (PI-INT-RATE NOT > ZEROS)  AND
 11574        (DC-ELAPSED-DAYS > +30)
 11575         MOVE ER-3531            TO EMI-ERROR
 11576         MOVE -1                 TO PINTL
 11577         MOVE AL-UNBON           TO PINTA
 11578         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11579
 11580     IF PI-EPYAMT NOT > ZEROS
 11581         GO TO 1445-CONTINUE.
 11582
 11583     IF (PI-INT-RATE NOT > ZEROS)  OR
 11584        (DC-ELAPSED-DAYS NOT > +30)
 11585         MOVE PI-EPYAMT TO PI-CPYAMT
 11586         GO TO 1441-FORMAT-NOTE.
 11587
 11588     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 11589                                 *  PI-INT-RATE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 224
* EL156.cbl
 11590                                 *  DC-ELAPSED-DAYS
 11591                                 /  365
 11592                                 /  100.
 11593
 11594     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 11595
 11596 1441-FORMAT-NOTE.
 11597
 11598     MOVE SPACES        TO WS-BOANOTE1.
 11599     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 11600     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 11601     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 11602     MOVE AL-UANON      TO NOTE1A.
 11603
 11604     IF WS-CALC-INT > ZEROS
 11605         MOVE SPACES        TO WS-BOANOTE2
 11606         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 11607         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 11608         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 11609         MOVE AL-UANON      TO NOTE2A.
 11610
 11611     GO TO 1445-CONTINUE.
 11612
 11613 1442-COMPUTE-NCL-INTEREST.
 11614     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11615     MOVE PI-STATE               TO WS-ST-ACCESS.
 11616     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11617     MOVE '3'                    TO CNTL-REC-TYPE.
 11618     MOVE +0                     TO CNTL-SEQ-NO.
 11619     MOVE 'STAT'                 TO FILE-SWITCH.
 11620
 11621     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11622
 11623     MOVE +0                 TO WS-CALC-INT.
 11624
 11625     IF ST-STAT-FROM-INCURRED
 11626         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 11627       ELSE
 11628     IF ST-STAT-FROM-REPORTED
 11629         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 11630       ELSE
 11631         GO TO 1445-CONTINUE.
 11632
 11633     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 11634     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 11635     MOVE +0                 TO DC-ELAPSED-MONTHS
 11636                                DC-ELAPSED-DAYS.
 11637     MOVE '1'                TO DC-OPTION-CODE.
 11638     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11639     IF NO-CONVERSION-ERROR
 11640         NEXT SENTENCE
 11641     ELSE
 11642         GO TO 1445-CONTINUE.
 11643
 11644     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 11645        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 11646         GO TO 1445-CONTINUE.
 11647
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 225
* EL156.cbl
 11648     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 11649                                 *  CF-ST-STAT-INTEREST.
 11650
 11651     MOVE SPACES              TO WS-NCLNOTE1.
 11652     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 11653     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 11654     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 11655                                 PI-PMTNOTE1
 11656                                 NOTE1I.
 11657     MOVE AL-UANON            TO NOTE1A.
 11658
 11659     IF WS-CALC-INT > ZEROS
 11660         MOVE SPACES          TO WS-NCLNOTE2
 11661         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 11662         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 11663         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 11664                                 PI-PMTNOTE2
 11665                                 NOTE2I
 11666         MOVE AL-UANON        TO NOTE2A.
 11667
 11668     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 11669
 11670 1445-CONTINUE.
 11671
 11672     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 11673        GO TO 1460-TEST-TYPE.
 11674
 11675     IF CM-O-B-COVERAGE
 11676        GO TO 1460-TEST-TYPE.
 11677
 11678     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 11679         GO TO 1450-CHECK-MAX.
 11680
 11681     IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 11682                      > PI-EPYAMT)
 11683                      OR
 11684        (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 11685                      < PI-EPYAMT)
 11686         MOVE ER-0594            TO EMI-ERROR
 11687         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11688         GO TO 1460-TEST-TYPE.
 11689
 11690 1450-CHECK-MAX.
 11691
 11692     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11693        PI-LF-COVERAGE-TYPE = 'P'
 11694         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 11695                                   CM-LF-ITD-DEATH-AMT
 11696     ELSE
 11697         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 11698                                   CL-TOTAL-PAID-AMT.
 11699
 11700     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 11701          MOVE ER-0543           TO EMI-ERROR
 11702          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11703
 11704 1460-TEST-TYPE.
 11705
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 226
* EL156.cbl
 11706     IF PI-PMT-APPR-SW = 'G'
 11707       NEXT SENTENCE
 11708     ELSE
 11709       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 11710         IF PI-EPYAMT = ZERO
 11711             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 11712                 MOVE ER-0494    TO  EMI-ERROR
 11713                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11714                 GO TO 1500-EDIT-EXPENSES
 11715             ELSE
 11716                 NEXT SENTENCE
 11717         ELSE
 11718             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 11719                 MOVE ER-0494    TO  EMI-ERROR
 11720                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11721                 GO TO 1500-EDIT-EXPENSES.
 11722
 11723     IF PI-PMTTYPE NOT = '2' OR
 11724        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 11725         GO TO 1500-EDIT-EXPENSES.
 11726
 11727     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 11728     MOVE ER-0526                TO EMI-ERROR.
 11729     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11730
 11731     IF EMI-ERROR-NUMBER (1) = '0526'
 11732        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 11733
 11734     IF EMI-ERROR-NUMBER (2) = '0526'
 11735        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 11736
 11737     GO TO 1500-EDIT-EXPENSES.
 11738
 11739 1490-PAYMENT-ERROR.
 11740     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11741
 11742     IF EMI-MESSAGE-FORMATTED
 11743         MOVE -1                 TO EPYAMTL
 11744         MOVE AL-UNBON           TO EPYAMTA.
 11745
 11746 1490-EXIT.
 11747      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 227
* EL156.cbl
 11749 1500-EDIT-EXPENSES.
 11750     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 11751         GO TO 1500-SKIP-ERROR-0556.
 11752
 11753 1500-CONTINUE-ON.
 11754
 11755     IF CM-O-B-COVERAGE
 11756        MOVE ER-0556             TO EMI-ERROR
 11757        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11758
 11759 1500-SKIP-ERROR-0556.
 11760     IF PI-PMTTYPE = '4' OR '5' OR '6'
 11761        IF PI-EEXPENS NOT = ZEROS
 11762           MOVE ER-0524          TO EMI-ERROR
 11763           GO TO 1590-EXPENSE-ERROR
 11764        ELSE
 11765           GO TO 1600-EDIT-RESERVES.
 11766
 11767     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11768     MOVE '6'                    TO CNTL-REC-TYPE.
 11769
 11770     IF CONTROL-IS-ACTUAL-CARRIER
 11771         MOVE PI-CARRIER         TO WS-CARR
 11772     ELSE
 11773         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11774
 11775     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11776     MOVE +0                     TO CNTL-SEQ-NO.
 11777     MOVE 'CARR'                 TO FILE-SWITCH.
 11778
 11779     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11780
 11781     IF EXPENSE-CALC-MANUAL
 11782        GO TO 1600-EDIT-RESERVES.
 11783
 11784     IF DOLLARS-PER-PMT
 11785        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 11786        GO TO 1600-EDIT-RESERVES.
 11787
 11788     IF DOLLARS-PER-MONTH AND
 11789        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 11790       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 11791       GO TO 1600-EDIT-RESERVES.
 11792
 11793     IF PERCENT-OF-PAYMENT
 11794        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 11795
 11796     GO TO 1600-EDIT-RESERVES.
 11797
 11798 1590-EXPENSE-ERROR.
 11799     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11800
 11801     IF EMI-MESSAGE-FORMATTED
 11802        MOVE -1                  TO EEXPENSL
 11803        MOVE AL-UNBON            TO EEXPENSA.
 11804
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 228
* EL156.cbl
 11806 1600-EDIT-RESERVES.
 11807     IF PI-PMTTYPE = '4' OR '5' OR '6'
 11808        IF PI-ERESV = ZEROS
 11809           GO TO 1700-EDIT-EXPENSE-TYPE
 11810        ELSE
 11811           MOVE ER-0525          TO EMI-ERROR
 11812           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 11813           GO TO 1700-EDIT-EXPENSE-TYPE.
 11814
 11815     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11816     MOVE ZEROS                  TO TRLR-SEQ-NO.
 11817     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 11818
 11819     IF NOT AT-MANUAL-RESERVES-USED
 11820        IF PI-ERESV NOT = ZEROS
 11821           MOVE ER-0518          TO EMI-ERROR
 11822           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 11823
 11824     IF AT-MANUAL-RESERVES-USED
 11825        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 11826        GO TO 1700-EDIT-EXPENSE-TYPE.
 11827
 11828     IF AT-FUTURE-RESERVES-USED
 11829        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 11830
 11831     IF AT-FUTURE-RESERVES-USED
 11832        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 11833
 11834     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 11835        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 11836
 11837     IF AT-IBNR-RESERVES-USED
 11838        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 11839
 11840     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 11841     GO TO 1700-EDIT-EXPENSE-TYPE.
 11842
 11843 1690-RESERVE-ERROR.
 11844     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11845
 11846     IF EMI-MESSAGE-FORMATTED
 11847        MOVE AL-UNBON            TO ERESVA
 11848        MOVE -1                  TO ERESVL.
 11849
 11850 1690-EXIT.
 11851      EXIT.
 11852
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 229
* EL156.cbl
 11854 1700-EDIT-EXPENSE-TYPE.
 11855     IF PI-PMTTYPE NOT = '5' AND '6'
 11856        GO TO 2000-EDIT-DONE.
 11857
 11858     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 11859                   '6' OR '7' OR '8' OR '9'
 11860        GO TO 2000-EDIT-DONE.
 11861
 11862 1705-EXPENSE-ERROR.
 11863     MOVE ER-0573                TO EMI-ERROR.
 11864     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11865
 11866     IF EMI-MESSAGE-FORMATTED
 11867        MOVE AL-UABON            TO ETYPEA
 11868        MOVE -1                  TO ETYPEL.
 11869
 11870     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 230
* EL156.cbl
 11872 1950-NOT-FOUND.
 11873     IF FILE-SWITCH = 'MSTR'
 11874        MOVE ER-0204             TO EMI-ERROR.
 11875
 11876     IF FILE-SWITCH = 'CARR'
 11877        MOVE ER-0252             TO EMI-ERROR.
 11878
 11879     IF FILE-SWITCH = 'COMP'
 11880        MOVE ER-0254             TO EMI-ERROR.
 11881
 11882     IF FILE-SWITCH = 'STAT'
 11883        MOVE ER-0149             TO EMI-ERROR.
 11884
 11885     IF FILE-SWITCH = 'PROC'
 11886        MOVE ER-0019             TO EMI-ERROR.
 11887
 11888     IF FILE-SWITCH = 'ACCT'
 11889        MOVE ER-0198             TO EMI-ERROR.
 11890
 11891     IF FILE-SWITCH = 'BENE'
 11892        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11893           MOVE ER-0282          TO EMI-ERROR
 11894        ELSE
 11895           MOVE ER-0283          TO EMI-ERROR.
 11896
 11897     MOVE -1                     TO PMTTYPEL.
 11898     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11899
 11900     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 11901                                     WS-FORCE-CTR.
 11902
 11903     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 11904                                     WS-FATAL-CTR.
 11905
 11906     GO TO 8200-SEND-DATAONLY.
 11907
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 231
* EL156.cbl
 11909 2000-EDIT-DONE.
 11910     IF (WS-SPECIAL-CALC-CD = 'C')
 11911        AND (CM-AH-CRITICAL-PERIOD) > 0
 11912        IF CM-AH-BENEFIT-AMT NOT = ZERO
 11913           IF PI-EPYAMT > ZEROS
 11914              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 11915                 PI-EPYAMT) / CM-AH-BENEFIT-AMT
 11916           ELSE
 11917              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 11918                 PI-CPYAMT) / CM-AH-BENEFIT-AMT
 11919           END-IF
 11920           IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 11921              MOVE ER-0657          TO EMI-ERROR
 11922              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11923           END-IF
 11924        END-IF
 11925     END-IF
 11926     IF PI-HOLDTIL NOT = ZEROS
 11927        MOVE PI-HOLDTIL          TO HOLDTILO
 11928        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 11929
 11930     IF PI-EPYFROM NOT = ZEROS
 11931        MOVE PI-EPYFROM          TO EPYFROMO
 11932        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 11933
 11934     IF PI-EPYTHRU NOT = ZEROS
 11935        MOVE PI-EPYTHRU            TO EPYTHRUO
 11936        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 11937        IF PI-USES-PAID-TO
 11938           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 11939           MOVE '4'                TO DC-OPTION-CODE
 11940           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11941           IF NO-CONVERSION-ERROR
 11942              MOVE +1              TO DC-ELAPSED-DAYS
 11943              MOVE +0              TO DC-ELAPSED-MONTHS
 11944              MOVE '6'             TO DC-OPTION-CODE
 11945              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11946              IF NO-CONVERSION-ERROR
 11947                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 11948
 11949     MOVE PI-EDAYS               TO EDAYSO.
 11950
 11951     IF PI-AIGFROM NOT = ZEROS
 11952        MOVE PI-AIGFROM          TO AIGFROMO
 11953        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 11954
 11955     MOVE PI-EPYAMT              TO EPYAMTO.
 11956     MOVE PI-ERESV               TO ERESVO.
 11957     MOVE PI-EEXPENS             TO EEXPENSO.
 11958
 11959     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11960     MOVE SPACES                 TO DC-OPTION-CODE.
 11961     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11962
 11963     IF DATE-CONVERSION-ERROR
 11964        MOVE SPACES              TO CPYFROMI
 11965     ELSE
 11966        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 232
* EL156.cbl
 11967        IF PI-EPYFROM = ZEROS
 11968           MOVE AL-UANON             TO EPYFROMA
 11969           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 11970           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 11971
 11972     IF PI-USES-PAID-TO
 11973        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 11974        MOVE +1                            TO DC-ELAPSED-DAYS
 11975        MOVE +0                            TO DC-ELAPSED-MONTHS
 11976        MOVE '6'                           TO DC-OPTION-CODE
 11977        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11978        IF NO-CONVERSION-ERROR
 11979           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 11980           IF PI-EPYTHRU = ZEROS
 11981              MOVE AL-UANON                TO EPYTHRUA
 11982              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 11983              MOVE ' '                     TO DC-OPTION-CODE
 11984              MOVE +0                      TO DC-ELAPSED-DAYS
 11985                                              DC-ELAPSED-MONTHS
 11986              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11987              IF NO-CONVERSION-ERROR
 11988                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 11989                  GO TO 2001-CONTINUE
 11990              ELSE
 11991                  GO TO 2001-CONTINUE
 11992           ELSE
 11993              GO TO 2001-CONTINUE.
 11994
 11995     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11996     MOVE SPACES                 TO DC-OPTION-CODE.
 11997     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11998
 11999     IF DATE-CONVERSION-ERROR
 12000        MOVE SPACES              TO CPYTHRUI
 12001     ELSE
 12002        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12003        IF PI-EPYTHRU = ZEROS
 12004           MOVE AL-UANON TO EPYTHRUA
 12005           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12006           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12007
 12008 2001-CONTINUE.
 12009
 12010     MOVE PI-CDAYS               TO CDAYSO.
 12011
 12012     IF PI-EDAYS = ZEROS
 12013        MOVE AL-UNNON TO EDAYSA
 12014        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12015
 12016     MOVE PI-CPYAMT              TO CPYAMTO.
 12017
 12018     IF PI-EPYAMT = ZEROS
 12019        MOVE AL-UNNON            TO EPYAMTA
 12020        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 12021
 12022     MOVE PI-CRESV               TO CRESVO.
 12023     MOVE PI-CEXPENS             TO CEXPENSO.
 12024
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 233
* EL156.cbl
 12025     IF PI-EEXPENS = ZEROS
 12026        MOVE AL-UNNON TO EEXPENSA
 12027        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12028
 12029     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12030        AND (CL-CLAIM-TYPE = 'L')
 12031        AND (PI-OFFLINE NOT EQUAL 'Y')
 12032        IF PI-PMTTYPE = '2' OR '4'
 12033           PERFORM 2200-CALC-INTEREST
 12034                                 THRU 2200-EXIT
 12035        END-IF
 12036     END-IF
 12037     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12038     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12039     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12040
 12041     IF EMI-FATAL-CTR = ZEROS
 12042        MOVE 'B'                 TO PI-PASS-SW.
 12043
 12044     IF NOT EMI-MESSAGE-FORMATTED
 12045         MOVE -1                 TO EPYFROML
 12046     ELSE
 12047         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12048            EMI-ERROR-NUMBER (2) = SPACES
 12049             MOVE -1             TO EPYFROML.
 12050
 12051     GO TO 8200-SEND-DATAONLY.
 12052
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 234
* EL156.cbl
 12054 2200-CALC-INTEREST.
 12055     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12056        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12057        MOVE '4'                 TO DC-OPTION-CODE
 12058        PERFORM 9700-LINK-DATE-CONVERT
 12059        IF DATE-CONVERSION-ERROR
 12060            MOVE LOW-VALUES      TO CP-PRF-DT
 12061        ELSE
 12062           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12063        END-IF
 12064     END-IF
 12065     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12066        IN CLAIM-INT-PASS-AREA
 12067     MOVE CL-CERT-STATE          TO CP-STATE
 12068        IN CLAIM-INT-PASS-AREA
 12069     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12070     MOVE 'LF'                   TO CP-COVERAGE
 12071     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12072     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12073     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12074     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12075     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12076     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12077
 12078* EXEC CICS LINK
 12079*       PROGRAM   ('ELCLMI')
 12080*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12081*       LENGTH    (CP-CLAIM-LENGTH)
 12082*    END-EXEC
 12083     MOVE 'ELCLMI' TO DFHEIV1
 12084*    MOVE '."C                   (   #00011594' TO DFHEIV0
 12085     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12086     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12087     MOVE X'2020233030303131353934' TO DFHEIV0(25:11)
 12088     CALL 'kxdfhei1' USING DFHEIV0,
 12089           DFHEIV1,
 12090           CLAIM-INT-PASS-AREA,
 12091           CP-CLAIM-LENGTH,
 12092           DFHEIV99,
 12093           DFHEIV99,
 12094           DFHEIV99,
 12095           DFHEIV99
 12096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12097     MOVE AL-PANOF               TO PINTHA
 12098                                    PINTA
 12099     IF NO-CI-ERROR
 12100        MOVE CP-CLM-INT-AMT      TO PINTO
 12101                                    PI-INT-AMT
 12102        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12103        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12104        MOVE AL-PANOF            TO PINTHA
 12105                                    PINTA
 12106     ELSE
 12107        IF CI-RETURN-CODE = '8'
 12108           MOVE ER-3818          TO EMI-ERROR
 12109           MOVE -1               TO ZINTL
 12110           PERFORM 9900-ERROR-FORMAT
 12111                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 235
* EL156.cbl
 12112           GO TO 2200-EXIT
 12113        ELSE
 12114           MOVE ZEROS            TO PINTO
 12115                                    PI-INT-AMT
 12116                                    PI-INT-DAYS
 12117                                    PI-INT-RATE-USED
 12118        END-IF
 12119     END-IF
 12120     IF PI-INT-AMT NOT = ZEROS
 12121        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12122           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12123           CONTINUE
 12124        ELSE
 12125           MOVE CL-SOC-SEC-NO (1:3)
 12126                                 TO WS-SSN (1:3)
 12127           MOVE CL-SOC-SEC-NO (5:2)
 12128                                 TO WS-SSN (4:2)
 12129           MOVE CL-SOC-SEC-NO (8:4)
 12130                                 TO WS-SSN (6:4)
 12131           IF (WS-SSN NUMERIC)
 12132              AND (WS-SSN NOT = ZEROS)
 12133              CONTINUE
 12134           ELSE
 12135              MOVE ER-2044       TO EMI-ERROR
 12136              PERFORM 9900-ERROR-FORMAT
 12137                                 THRU 9900-EXIT
 12138           END-IF
 12139        END-IF
 12140        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12141        MOVE +51                 TO TRLR-SEQ-NO
 12142
 12143* EXEC CICS READ
 12144*          DATASET  ('ELTRLR')
 12145*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12146*          RIDFLD   (ELTRLR-KEY)
 12147*          RESP     (WS-RESPONSE)
 12148*       END-EXEC
 12149     MOVE 'ELTRLR' TO DFHEIV1
 12150*    MOVE '&"S        E          (  N#00011644' TO DFHEIV0
 12151     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12152     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12153     MOVE X'204E233030303131363434' TO DFHEIV0(25:11)
 12154     CALL 'kxdfhei1' USING DFHEIV0,
 12155           DFHEIV1,
 12156           DFHEIV20,
 12157           DFHEIV99,
 12158           ELTRLR-KEY,
 12159           DFHEIV99,
 12160           DFHEIV99,
 12161           DFHEIV99
 12162     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12163         DFHEIV20
 12164     MOVE EIBRESP  TO WS-RESPONSE
 12165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12166        IF (NOT WS-RESP-NORMAL)
 12167                    OR
 12168           ((WS-RESP-NORMAL)
 12169           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 236
* EL156.cbl
 12170           OR (AT-CITY-STATE = SPACES)))
 12171           MOVE ER-0874          TO EMI-ERROR
 12172           PERFORM 9900-ERROR-FORMAT
 12173                                 THRU 9900-EXIT
 12174        END-IF
 12175     END-IF
 12176     .
 12177 2200-EXIT.
 12178     EXIT.
 12179 3000-MOVE-INPUT-TO-SAVE-AREA.
 12180     IF PMTTYPEL > 0
 12181         MOVE PMTTYPEI           TO WS-PMTTYPE.
 12182
 12183     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 12184
 12185     IF WS-PMTTYPE = '9'
 12186         MOVE 'P'                TO PI-PROVISIONAL-IND
 12187         MOVE '1'                TO WS-PMTTYPE.
 12188
 12189     IF PAYEEL > 0
 12190         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 12191         MOVE PAYEEI             TO WS-PAYEE.
 12192
 12193     IF NOTE1L > +0
 12194         MOVE NOTE1I             TO WS-PMTNOTE1
 12195                                    WS-FLI-PMTNOTE
 12196                                    WS-HAN-PMTNOTE.
 12197
 12198     IF NOTE2L > +0
 12199         MOVE NOTE2I             TO WS-PMTNOTE2.
 12200
 12201     IF OFFLINEL > 0
 12202         MOVE OFFLINEI           TO WS-OFFLINE.
 12203
 12204     IF PROOFDTL > 0
 12205         MOVE PROOFDTI            TO DATE-WORK
 12206         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12207         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 12208         MOVE '4'                 TO DC-OPTION-CODE
 12209         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 12210         IF NO-CONVERSION-ERROR
 12211            MOVE NUM-WORK         TO PROOFDTO
 12212            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 12213            MOVE NUM-WORK         TO WS-PROOF-DATE
 12214         ELSE
 12215            MOVE ZEROS            TO WS-PROOF-DATE
 12216         END-IF
 12217     END-IF.
 12218
 12219     IF EOBYNL > +0
 12220         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 12221         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 12222     END-IF
 12223
 12224     IF CLMFMYNL > +0
 12225         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 12226         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 12227     END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 237
* EL156.cbl
 12228
 12229     IF SURVYYNL > +0
 12230         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 12231         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 12232     END-IF
 12233*04400      IF GROUPEDL > +0
 12234*04401          MOVE GROUPEDI           TO WS-GROUPED.
 12235*04402
 12236*04403      IF CASHL > +0
 12237*04404         MOVE CASHI               TO WS-CASH.
 12238
 12239     IF LOANNOL > +0
 12240         MOVE LOANNOI            TO WS-LOAN-NO.
 12241
 12242     IF CHECKNOL > 0
 12243         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 12244
 12245     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12246         IF WS-AIG-CREDIT-ENTERED
 12247             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 12248             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 12249             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 12250             MOVE AL-UANON         TO CHECKNOA.
 12251
 12252     IF HOLDTILL > 0
 12253         MOVE HOLDTILI           TO DATE-WORK
 12254         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12255         MOVE NUM-WORK           TO WS-HOLDTIL.
 12256
 12257     IF ZINTL > +0
 12258
 12259* EXEC CICS BIF DEEDIT
 12260*           FIELD   (ZINTI)
 12261*           LENGTH  (07)
 12262*       END-EXEC
 12263     MOVE 07
 12264       TO DFHEIV11
 12265*    MOVE '@"L                   #   #00011742' TO DFHEIV0
 12266     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12267     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12268     MOVE X'2020233030303131373432' TO DFHEIV0(25:11)
 12269     CALL 'kxdfhei1' USING DFHEIV0,
 12270           ZINTI,
 12271           DFHEIV11
 12272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12273        IF ZINTI NOT NUMERIC
 12274           MOVE ER-0419          TO EMI-ERROR
 12275           PERFORM 9900-ERROR-FORMAT
 12276           MOVE AL-UABON         TO ZINTA
 12277           MOVE -1               TO ZINTL
 12278        ELSE
 12279           MOVE ZINTI            TO CP-INT-RATE
 12280                                    WS-INT-RATE
 12281           MOVE CP-INT-RATE      TO ZINTO
 12282           MOVE AL-UNNON         TO ZINTA
 12283        END-IF
 12284     ELSE
 12285        MOVE ZEROS               TO CP-INT-RATE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 238
* EL156.cbl
 12286     END-IF
 12287     IF EPYFROML > 0
 12288         MOVE EPYFROMI           TO DATE-WORK
 12289         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12290         MOVE NUM-WORK           TO WS-EPYFROM.
 12291
 12292     IF AIGFROML > 0
 12293         MOVE AIGFROMI           TO DATE-WORK
 12294         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12295         MOVE NUM-WORK           TO WS-AIGFROM
 12296     ELSE
 12297         IF (AIGFROMI = LOW-VALUES) AND
 12298            (PI-AIGFROM NOT = ZEROS)
 12299              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 12300
 12301     IF EPYTHRUL > +0
 12302        MOVE EPYTHRUI           TO DATE-WORK
 12303        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12304        MOVE NUM-WORK           TO WS-EPYTHRU
 12305        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12306        MOVE '4'                TO DC-OPTION-CODE
 12307        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12308        IF NO-CONVERSION-ERROR
 12309           IF PI-USES-PAID-TO
 12310              MOVE '6'                TO DC-OPTION-CODE
 12311              MOVE -1                 TO DC-ELAPSED-DAYS
 12312              MOVE +0                 TO DC-ELAPSED-MONTHS
 12313              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12314              IF NO-CONVERSION-ERROR
 12315                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 12316                 MOVE ' '             TO DC-OPTION-CODE
 12317                 MOVE +0              TO DC-ELAPSED-DAYS
 12318                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12319              IF NO-CONVERSION-ERROR
 12320                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 12321
 12322*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 12323*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 12324     IF EDAYSL > 0
 12325
 12326* EXEC CICS BIF DEEDIT
 12327*            FIELD(EDAYSI)
 12328*            LENGTH(6)
 12329*        END-EXEC
 12330     MOVE 6
 12331       TO DFHEIV11
 12332*    MOVE '@"L                   #   #00011798' TO DFHEIV0
 12333     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12334     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12335     MOVE X'2020233030303131373938' TO DFHEIV0(25:11)
 12336     CALL 'kxdfhei1' USING DFHEIV0,
 12337           EDAYSI,
 12338           DFHEIV11
 12339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12340         MOVE EDAYSI             TO WS-DY-WORK
 12341         IF WS-DY-SIGN = SPACES
 12342            MOVE WS-DY-NUM       TO WS-EDAYS
 12343            ADD 0                TO WS-EDAYS
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 239
* EL156.cbl
 12344         ELSE
 12345            MOVE EDAYSI          TO WS-EDAYS
 12346            ADD 0                TO WS-EDAYS.
 12347
 12348*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 12349*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 12350     IF EPYAMTL > 0
 12351
 12352* EXEC CICS BIF DEEDIT
 12353*            FIELD(EPYAMTI)
 12354*            LENGTH(10)
 12355*        END-EXEC
 12356     MOVE 10
 12357       TO DFHEIV11
 12358*    MOVE '@"L                   #   #00011813' TO DFHEIV0
 12359     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12360     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12361     MOVE X'2020233030303131383133' TO DFHEIV0(25:11)
 12362     CALL 'kxdfhei1' USING DFHEIV0,
 12363           EPYAMTI,
 12364           DFHEIV11
 12365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12366         MOVE EPYAMTI            TO WS-PY-WORK
 12367         IF WS-PY-SIGN = SPACES
 12368            MOVE WS-PY-NUM       TO WS-EPYAMT
 12369            ADD 0                TO WS-EPYAMT
 12370         ELSE
 12371            MOVE EPYAMTI         TO WS-EPYAMT
 12372            ADD 0                TO WS-EPYAMT.
 12373
 12374     IF ERESVL > 0
 12375
 12376* EXEC CICS BIF DEEDIT
 12377*            FIELD(ERESVI)
 12378*            LENGTH(9)
 12379*        END-EXEC
 12380     MOVE 9
 12381       TO DFHEIV11
 12382*    MOVE '@"L                   #   #00011826' TO DFHEIV0
 12383     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12384     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12385     MOVE X'2020233030303131383236' TO DFHEIV0(25:11)
 12386     CALL 'kxdfhei1' USING DFHEIV0,
 12387           ERESVI,
 12388           DFHEIV11
 12389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12390         MOVE ERESVI TO WS-ERESV.
 12391
 12392     IF EEXPENSL > 0
 12393
 12394* EXEC CICS BIF DEEDIT
 12395*            FIELD(EEXPENSI)
 12396*            LENGTH(8)
 12397*        END-EXEC
 12398     MOVE 8
 12399       TO DFHEIV11
 12400*    MOVE '@"L                   #   #00011833' TO DFHEIV0
 12401     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 240
* EL156.cbl
 12402     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12403     MOVE X'2020233030303131383333' TO DFHEIV0(25:11)
 12404     CALL 'kxdfhei1' USING DFHEIV0,
 12405           EEXPENSI,
 12406           DFHEIV11
 12407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12408         MOVE EEXPENSI           TO WS-EEXPENS.
 12409
 12410     IF ETYPEL > ZEROS
 12411         MOVE ETYPEI             TO WS-ETYPE.
 12412
 12413     IF PI-COMPANY-ID = 'BOA'
 12414        IF PINTL > ZEROS
 12415
 12416* EXEC CICS BIF DEEDIT
 12417*            FIELD (PINTI)
 12418*            LENGTH(05)
 12419*          END-EXEC
 12420     MOVE 05
 12421       TO DFHEIV11
 12422*    MOVE '@"L                   #   #00011844' TO DFHEIV0
 12423     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12424     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12425     MOVE X'2020233030303131383434' TO DFHEIV0(25:11)
 12426     CALL 'kxdfhei1' USING DFHEIV0,
 12427           PINTI,
 12428           DFHEIV11
 12429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12430           IF PINTI NUMERIC
 12431               MOVE AL-UNNON     TO PINTA
 12432               MOVE PINTI        TO WS-INT-RATE
 12433               MOVE WS-INT-RATE  TO PINTO.
 12434
 12435 3000-EXIT.
 12436     EXIT.
 12437
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 241
* EL156.cbl
 12439 3050-REBUILD-ENTERED.
 12440
 12441     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 12442
 12443     IF PI-PROV-PMT
 12444         MOVE '9'           TO PMTTYPEO
 12445     ELSE
 12446         MOVE PI-PMTTYPE    TO PMTTYPEO.
 12447
 12448     MOVE PI-PAYEE          TO PAYEEO.
 12449     MOVE PI-PMTNOTE1       TO NOTE1O.
 12450     MOVE PI-PMTNOTE2       TO NOTE2O.
 12451     MOVE PI-OFFLINE        TO OFFLINEO.
 12452     IF PI-PROOF-DATE NOT = ZEROS
 12453         MOVE PI-PROOF-DATE TO PROOFDTO
 12454         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 12455     END-IF.
 12456*04534      MOVE PI-GROUPED        TO GROUPEDO.
 12457*04535
 12458*04536      MOVE PI-CASH           TO CASHO.
 12459
 12460     IF PI-INT-RATE > ZEROS
 12461         MOVE PI-INT-RATE   TO PINTO.
 12462
 12463     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12464        IF PI-INT-AMT > ZEROS
 12465           MOVE PI-INT-AMT       TO PINTO
 12466           MOVE AL-PANOF         TO PINTA
 12467                                    PINTHA
 12468        END-IF
 12469     END-IF
 12470     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 12471     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 12472     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 12473     IF PI-HOLDTIL NOT = ZEROS
 12474        MOVE PI-HOLDTIL          TO HOLDTILO
 12475        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12476
 12477     IF PI-EPYFROM NOT = ZEROS
 12478        MOVE PI-EPYFROM          TO EPYFROMO
 12479        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 12480
 12481     IF PI-AIGFROM NOT = ZEROS
 12482        MOVE PI-AIGFROM          TO AIGFROMO
 12483        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12484
 12485     IF PI-EPYTHRU NOT = ZEROS
 12486        MOVE PI-EPYTHRU          TO EPYTHRUO
 12487        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 12488        IF PI-USES-PAID-TO
 12489           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12490           MOVE '4'                TO DC-OPTION-CODE
 12491           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12492           IF NO-CONVERSION-ERROR
 12493              MOVE +1 TO DC-ELAPSED-DAYS
 12494              MOVE +0 TO DC-ELAPSED-MONTHS
 12495              MOVE '6' TO DC-OPTION-CODE
 12496              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 242
* EL156.cbl
 12497              IF NO-CONVERSION-ERROR
 12498                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12499
 12500     IF PI-EDAYS NOT = ZEROS
 12501        MOVE PI-EDAYS TO EDAYSO.
 12502
 12503     IF PI-EPYAMT NOT = ZEROS
 12504        MOVE PI-EPYAMT TO EPYAMTO.
 12505
 12506     IF PI-ERESV NOT = ZEROS
 12507        MOVE PI-ERESV TO ERESVO.
 12508
 12509     IF PI-EEXPENS NOT = ZEROS
 12510        MOVE PI-EEXPENS TO EEXPENSO.
 12511
 12512     MOVE PI-ETYPE TO ETYPEO.
 12513
 12514     IF PI-ECHECKNO NOT = SPACES
 12515        MOVE PI-ECHECKNO         TO CHECKNOO
 12516     ELSE
 12517        MOVE PI-CCHECKNO         TO CHECKNOO.
 12518
 12519     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12520     MOVE SPACES                 TO DC-OPTION-CODE.
 12521     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12522
 12523     IF DATE-CONVERSION-ERROR
 12524        MOVE SPACES              TO CPYFROMI
 12525     ELSE
 12526        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 12527
 12528     IF PI-USES-PAID-TO
 12529        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 12530        MOVE +1                  TO DC-ELAPSED-DAYS
 12531        MOVE +0                  TO DC-ELAPSED-MONTHS
 12532        MOVE '6'                 TO DC-OPTION-CODE
 12533        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12534        IF NO-CONVERSION-ERROR
 12535           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12536           GO TO 3051-CONTINUE.
 12537
 12538     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12539     MOVE SPACES                 TO DC-OPTION-CODE.
 12540     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12541
 12542     IF DATE-CONVERSION-ERROR
 12543        MOVE SPACES              TO CPYTHRUI
 12544     ELSE
 12545        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 12546
 12547 3051-CONTINUE.
 12548
 12549     IF PI-CDAYS NOT = ZEROS
 12550        MOVE PI-CDAYS TO CDAYSO.
 12551
 12552     IF PI-CPYAMT NOT = ZEROS
 12553        MOVE PI-CPYAMT TO CPYAMTO.
 12554
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 243
* EL156.cbl
 12555     IF PI-CRESV NOT = ZEROS
 12556        MOVE PI-CRESV TO CRESVO.
 12557
 12558     IF PI-CEXPENS NOT = ZEROS
 12559        MOVE PI-CEXPENS TO CEXPENSO.
 12560
 12561 3059-EXIT.
 12562     EXIT.
 12563
 12564 3100-DEEDIT-DATE.
 12565
 12566* EXEC CICS BIF DEEDIT
 12567*        FIELD(DATE-WORK)
 12568*        LENGTH(8)
 12569*    END-EXEC.
 12570     MOVE 8
 12571       TO DFHEIV11
 12572*    MOVE '@"L                   #   #00011983' TO DFHEIV0
 12573     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12574     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12575     MOVE X'2020233030303131393833' TO DFHEIV0(25:11)
 12576     CALL 'kxdfhei1' USING DFHEIV0,
 12577           DATE-WORK,
 12578           DFHEIV11
 12579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12580
 12581
 12582 3100-EXIT.
 12583     EXIT.
 12584
 12585 3200-CALC-AIG-DAYS.
 12586
 12587     MOVE 'N'                    TO WS-DUE-DAY-SW.
 12588
 12589     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 12590     MOVE ' '                    TO DC-OPTION-CODE.
 12591     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12592     IF NO-CONVERSION-ERROR
 12593         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 12594     ELSE
 12595         GO TO 3290-ERROR.
 12596
 12597     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12598         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12599                                WS-BIN-FROM-DT
 12600     ELSE
 12601         IF CL-TOTAL-PAID-AMT > ZEROS
 12602             IF WS-SV-EPYFROM = LOW-VALUES
 12603                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 12604                                        WS-BIN-FROM-DT
 12605             ELSE
 12606                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 12607                                        WS-BIN-FROM-DT
 12608         ELSE
 12609             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 12610                                        WS-BIN-FROM-DT.
 12611
 12612 3210-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 244
* EL156.cbl
 12613
 12614     MOVE ' '                    TO DC-OPTION-CODE.
 12615     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12616     IF DATE-CONVERSION-ERROR
 12617         GO TO 3290-ERROR.
 12618
 12619     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 12620
 12621     IF PI-LOAN-DUE-DAY = 31
 12622         MOVE 30              TO WS-PMT-DUE-DA
 12623                                 WS-SAVE-DUE-DA
 12624     ELSE
 12625         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 12626                                 WS-SAVE-DUE-DA.
 12627
 12628     IF (PI-LOAN-DUE-DAY > 28) AND
 12629        (WS-PMT-DUE-MO = 2)
 12630         MOVE 'Y'                TO WS-DUE-DAY-SW
 12631         MOVE 28                 TO WS-PMT-DUE-DA.
 12632
 12633     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 12634     MOVE '4'                    TO DC-OPTION-CODE.
 12635     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12636     IF NO-CONVERSION-ERROR
 12637         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 12638     ELSE
 12639         GO TO 3290-ERROR.
 12640
 12641*--------------------------------------------------------------*
 12642*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 12643*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 12644*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 12645*                                                              *
 12646*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 12647*             INCURRED DATE      - 04/15/91                    *
 12648*             PMT DUE DATE       - 04/03/91                    *
 12649*             PMT DUE DATE       - 05/03/91                    *
 12650*--------------------------------------------------------------*
 12651
 12652     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 12653        (WS-SV-AIGFROM = LOW-VALUES)
 12654         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 12655            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 12656             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 12657             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 12658             IF NO-CONVERSION-ERROR
 12659                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12660                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12661             ELSE
 12662                 GO TO 3290-ERROR.
 12663
 12664     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 12665        (WS-SV-AIGFROM = LOW-VALUES)
 12666         GO TO 3205-CONT-CALC-PMT.
 12667
 12668     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 12669     MOVE ' '                    TO DC-OPTION-CODE.
 12670     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 245
* EL156.cbl
 12671     IF NO-CONVERSION-ERROR
 12672         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 12673     ELSE
 12674         GO TO 3290-ERROR.
 12675
 12676     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 12677        (WS-PMT-DUE-DA < WS-FROM-DA)
 12678          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 12679          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 12680          IF NO-CONVERSION-ERROR
 12681              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12682              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12683          ELSE
 12684              GO TO 3290-ERROR.
 12685
 12686 3205-CONT-CALC-PMT.
 12687
 12688*--------------------------------------------------------------*
 12689*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 12690*    BETWEEN THE PAY FROM / THRU DATES.                        *
 12691*--------------------------------------------------------------*
 12692
 12693     IF CL-TOTAL-PAID-AMT = ZEROS AND
 12694        PI-PMTTYPE = '2'
 12695          NEXT SENTENCE
 12696     ELSE
 12697        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 12698           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 12699             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 12700             MOVE ER-3527            TO EMI-ERROR
 12701             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12702             MOVE -1                 TO EPYTHRUL
 12703             MOVE AL-UNBON           TO EPYTHRUA
 12704                                        EPYFROMA
 12705             GO TO 3299-EXIT.
 12706
 12707*--------------------------------------------------------------*
 12708*    CALCULATE RETRO ELIMINATION DATE                          *
 12709*--------------------------------------------------------------*
 12710
 12711     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12712         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12713     ELSE
 12714         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12715
 12716     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 12717     MOVE +0             TO DC-ELAPSED-MONTHS.
 12718     MOVE '6'            TO DC-OPTION-CODE.
 12719     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12720     IF NO-CONVERSION-ERROR
 12721         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 12722     ELSE
 12723         GO TO 3290-ERROR.
 12724
 12725 3210-CHECK-PMT-DATE.
 12726
 12727*--------------------------------------------------------------*
 12728*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 246
* EL156.cbl
 12729*    THE ENTERED PAY FROM DATE                                 *
 12730*--------------------------------------------------------------*
 12731
 12732     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 12733         NEXT SENTENCE
 12734     ELSE
 12735         GO TO 3220-COMPUTE-DAYS.
 12736
 12737     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 12738     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 12739     IF NO-CONVERSION-ERROR
 12740         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12741         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12742         GO TO 3210-CHECK-PMT-DATE
 12743     ELSE
 12744         GO TO 3290-ERROR.
 12745
 12746 3220-COMPUTE-DAYS.
 12747
 12748     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 12749     MOVE ZEROS         TO WS-CDAYS.
 12750     MOVE 'N'           TO WS-ELIMINATION-SW.
 12751
 12752*--------------------------------------------------------------*
 12753*    COMPUTE CALIFORNIA DUE DAYS                               *
 12754*--------------------------------------------------------------*
 12755
 12756     IF CL-TOTAL-PAID-AMT > ZEROS
 12757         MOVE 'Y' TO WS-ELIMINATION-SW
 12758         GO TO 3240-FIRST-PMT-DUE
 12759     ELSE
 12760        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 12761            NEXT SENTENCE
 12762        ELSE
 12763            GO TO 3240-FIRST-PMT-DUE.
 12764
 12765 3230-NEXT-PMT-DUE.
 12766
 12767     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 12768     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 12769     IF NO-CONVERSION-ERROR
 12770         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 12771         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12772     ELSE
 12773         GO TO 3290-ERROR.
 12774
 12775 3240-FIRST-PMT-DUE.
 12776
 12777     IF CL-TOTAL-PAID-AMT > ZEROS
 12778         NEXT SENTENCE
 12779     ELSE
 12780        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 12781            GO TO 3230-NEXT-PMT-DUE.
 12782
 12783     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 12784         GO TO 3250-VERIFY-ELIMINATION.
 12785
 12786     ADD +30 TO WS-CDAYS.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 247
* EL156.cbl
 12787     MOVE 'Y' TO WS-ELIMINATION-SW.
 12788     GO TO 3230-NEXT-PMT-DUE.
 12789
 12790 3250-VERIFY-ELIMINATION.
 12791
 12792     IF ELIM-SATISFIED
 12793         GO TO 3260-END-CALC.
 12794
 12795     IF PI-PMTTYPE = '1'
 12796         MOVE ZEROS TO WS-CDAYS
 12797         GO TO 3260-END-CALC.
 12798
 12799     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12800         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12801     ELSE
 12802         IF CL-TOTAL-PAID-AMT > ZEROS
 12803             IF WS-SV-EPYFROM = LOW-VALUES
 12804                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 12805             ELSE
 12806                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 12807         ELSE
 12808             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 12809
 12810     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 12811     MOVE '1'                    TO DC-OPTION-CODE.
 12812     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12813     IF NO-CONVERSION-ERROR
 12814         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 12815     ELSE
 12816         GO TO 3290-ERROR.
 12817
 12818     IF CL-TOTAL-PAID-AMT > ZEROS
 12819         MOVE WS-DAYS-OFF TO WS-CDAYS
 12820     ELSE
 12821         IF PI-BEN-DAYS > WS-DAYS-OFF
 12822             MOVE ZEROS TO WS-CDAYS
 12823         ELSE
 12824             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 12825
 12826 3260-END-CALC.
 12827
 12828     MOVE WS-CDAYS TO PI-CDAYS.
 12829
 12830     IF PI-EDAYS = ZEROS
 12831         MOVE PI-CDAYS TO PI-EDAYS
 12832         MOVE AL-UNNON TO EDAYSA.
 12833
 12834     GO TO 3299-EXIT.
 12835
 12836 3290-ERROR.
 12837
 12838     MOVE ER-3528            TO EMI-ERROR.
 12839     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12840     MOVE -1                 TO CDAYSL.
 12841     MOVE AL-UNBON           TO CDAYSA.
 12842
 12843 3299-EXIT.
 12844     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 248
* EL156.cbl
 12845
 12846 3300-BUMP-DATE.
 12847
 12848     IF WS-RESTORE-DUE-DAY
 12849         MOVE 'N'              TO WS-DUE-DAY-SW
 12850         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 12851         ADD 1                 TO WS-PMT-DUE-MO
 12852         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 12853         MOVE '4'              TO DC-OPTION-CODE
 12854         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12855         IF NO-CONVERSION-ERROR
 12856             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12857             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 12858             GO TO 3399-EXIT
 12859         ELSE
 12860             MOVE '9'          TO DC-ERROR-CODE
 12861             GO TO 3399-EXIT.
 12862
 12863     IF (WS-PMT-DUE-MO = 1) AND
 12864        (WS-SAVE-DUE-DA > 28)
 12865           MOVE 'Y' TO WS-DUE-DAY-SW.
 12866
 12867     MOVE +0                 TO DC-ELAPSED-DAYS.
 12868     MOVE +1                 TO DC-ELAPSED-MONTHS.
 12869     MOVE '6'                TO DC-OPTION-CODE.
 12870     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12871
 12872 3399-EXIT.
 12873     EXIT.
 12874
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 249
* EL156.cbl
 12876 3400-COMPUTE-EXPIRY.
 12877
 12878     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 12879     MOVE +0                    TO DC-ELAPSED-DAYS
 12880                                   DC-ODD-DAYS-OVER.
 12881     MOVE '1'                   TO DC-END-OF-MONTH.
 12882     MOVE '6'                   TO DC-OPTION-CODE.
 12883
 12884     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12885         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 12886     ELSE
 12887         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 12888
 12889     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12890     IF NO-CONVERSION-ERROR
 12891         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 12892     ELSE
 12893         GO TO 3390-CONTINUE.
 12894
 12895     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 12896         GO TO 3390-CONTINUE.
 12897
 12898     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12899     MOVE '4'                    TO CNTL-REC-TYPE.
 12900     MOVE +0                     TO CNTL-SEQ-NO.
 12901     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 12902     MOVE WS-ACCESS              TO CNTL-ACCESS.
 12903     MOVE 'BENE'                 TO FILE-SWITCH.
 12904
 12905     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 12906
 12907     IF NO-BENEFIT-FOUND
 12908         GO TO 3390-CONTINUE.
 12909
 12910     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 12911        IF (PI-OFFLINE = 'Y') OR
 12912           (PI-PMTTYPE = '7')
 12913           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 12914                                     THRU 9870-EXIT
 12915           IF ERROR-ON-OUTPUT
 12916             MOVE -1                 TO ENTERPFL
 12917             MOVE AL-UANON           TO ENTERPFA
 12918             MOVE MAP-NAMEA          TO MAP-NAME
 12919             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12920             GO TO 8200-SEND-DATAONLY.
 12921
 12922     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 12923        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 12924        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 12925          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 12926          MOVE +0        TO DC-ELAPSED-DAYS
 12927          MOVE +1        TO DC-ELAPSED-MONTHS
 12928          MOVE 6         TO DC-OPTION-CODE
 12929          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12930          IF NO-CONVERSION-ERROR
 12931              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 12932
 12933 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 250
* EL156.cbl
 12934
 12935      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12936         MOVE CM-AH-LOAN-EXPIRE-DT
 12937                                 TO DC-BIN-DATE-1
 12938      ELSE
 12939         MOVE CM-LF-LOAN-EXPIRE-DT
 12940                                 TO DC-BIN-DATE-1
 12941      END-IF
 12942
 12943      MOVE ' '                    TO DC-OPTION-CODE.
 12944      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12945      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 12946      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 12947
 12948 3499-EXIT.
 12949     EXIT.
 12950
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 251
* EL156.cbl
 12952
 12953 3600-CHECK-VERIFICATION.
 12954
 12955     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12956
 12957     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 12958
 12959     IF PI-PAYEE-TYPE = 'I'
 12960        GO TO 3600-READ-TRAILER.
 12961
 12962     IF PI-PAYEE-TYPE = 'B'
 12963        ADD +10                  TO TRLR-SEQ-NO
 12964        GO TO 3600-READ-TRAILER.
 12965
 12966     IF PI-PAYEE-TYPE = 'A'
 12967        ADD +20                  TO TRLR-SEQ-NO
 12968        GO TO 3600-READ-TRAILER.
 12969
 12970     IF PI-PAYEE-TYPE = 'O'
 12971        ADD +50                  TO TRLR-SEQ-NO
 12972        GO TO 3600-READ-TRAILER.
 12973
 12974     IF PI-PAYEE-TYPE = 'Q'
 12975        ADD +60                  TO TRLR-SEQ-NO
 12976        GO TO 3600-READ-TRAILER.
 12977
 12978     IF PI-PAYEE-TYPE = 'P'
 12979        ADD +30                  TO TRLR-SEQ-NO
 12980        GO TO 3600-READ-TRAILER.
 12981
 12982     IF PI-PAYEE-TYPE = 'E'
 12983        ADD +40                  TO TRLR-SEQ-NO.
 12984
 12985 3600-READ-TRAILER.
 12986
 12987
 12988* EXEC CICS HANDLE CONDITION
 12989*         NOTFND(3600-CONTINUE)
 12990*    END-EXEC.
 12991*    MOVE '"$I                   ! - #00012393' TO DFHEIV0
 12992     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12994     MOVE X'2D20233030303132333933' TO DFHEIV0(25:11)
 12995     CALL 'kxdfhei1' USING DFHEIV0
 12996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12997
 12998
 12999     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13000
 13001 3600-CONTINUE.
 13002
 13003     IF PI-VFY-2ND-BENE = 'Y'
 13004       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 13005         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 13006           MOVE ER-7576            TO EMI-ERROR
 13007           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13008           MOVE -1                 TO PAYEEL
 13009           MOVE AL-UABON           TO PAYEEA
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 252
* EL156.cbl
 13010           GO TO 3600-EXIT
 13011         END-IF
 13012       END-IF
 13013     END-IF.
 13014
 13015     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 13016     MOVE 1 TO WS-SUB2
 13017     MOVE SPACES TO WS-PAYEE-NAME
 13018     PERFORM VARYING WS-SUB FROM 1 BY 1
 13019             UNTIL WS-SUB > 30
 13020         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 13021            MOVE WS-WORK-NAME-X (WS-SUB) TO
 13022                 WS-PAYEE-NAME-X (WS-SUB2)
 13023            ADD +1 TO WS-SUB2
 13024         END-IF
 13025     END-PERFORM.
 13026
 13027     STRING CL-INSURED-1ST-NAME
 13028            CL-INSURED-MID-INIT
 13029            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 13030     MOVE 1 TO WS-SUB2
 13031     MOVE SPACES TO WS-INSURED-NAME
 13032     PERFORM VARYING WS-SUB FROM 1 BY 1
 13033             UNTIL WS-SUB > 30
 13034         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 13035            MOVE WS-WORK-NAME-X (WS-SUB) TO
 13036                 WS-INSURED-NAME-X (WS-SUB2)
 13037            ADD +1 TO WS-SUB2
 13038         END-IF
 13039     END-PERFORM.
 13040
 13041     IF WS-PAYEE-NAME = WS-INSURED-NAME
 13042        MOVE ER-7579            TO EMI-ERROR
 13043        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13044        MOVE -1                 TO PAYEEL
 13045        MOVE AL-UABON           TO PAYEEA
 13046     END-IF.
 13047
 13048 3600-EXIT.
 13049     EXIT.
 13050
 13051 5000-UPDATE.
 13052
 13053     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 13054
 13055     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 13056
 13057     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 13058        PI-OFFLINE = 'Y'
 13059        NEXT SENTENCE
 13060     ELSE
 13061        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 13062
 13063*    IF PI-COMPANY-ID = 'CRI'
 13064*       IF PI-PMTTYPE = '1' OR  '2'
 13065*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13066*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 13067*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 253
* EL156.cbl
 13068
 13069*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 13070*       IF PI-PMTTYPE = '1'
 13071*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13072*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 13073
 13074     IF PI-PMTTYPE      = '2' AND
 13075        PI-SPLIT-PMT-SW = 'Y' AND
 13076        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 13077          MOVE ER-3530                TO EMI-ERROR
 13078          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13079
 13080     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13081        AND (CL-CLAIM-TYPE = 'L')
 13082        IF PI-PMTTYPE = '2' OR '4'
 13083           IF PI-INT-AMT NOT = ZEROS
 13084              PERFORM 7110-BUILD-PMT-TRLR
 13085                                 THRU 7130-EXIT
 13086           ELSE
 13087              IF PI-PMTTYPE = '2'
 13088                 PERFORM 7140-BUILD-NOTE-TRLR
 13089                                 THRU 7170-EXIT
 13090              END-IF
 13091           END-IF
 13092        END-IF
 13093     END-IF
 13094*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13095*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13096*            MOVE 'N'                 TO  WS-LETTER-SW.
 13097
 13098*    IF PI-COMPANY-ID = 'DMD'
 13099*        IF CL-NO-OF-PMTS-MADE = +1
 13100*                OR
 13101*           PI-PMTTYPE = '2'
 13102*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 13103
 13104     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 13105
 13106*    IF PI-COMPANY-ID = 'DMD'
 13107*       IF CL-CERT-NO (5:2) = '69' OR '70'
 13108*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 13109
 13110
 13111* EXEC CICS REWRITE
 13112*         DATASET('ELMSTR')
 13113*         FROM(CLAIM-MASTER)
 13114*     END-EXEC.
 13115     MOVE LENGTH OF
 13116      CLAIM-MASTER
 13117       TO DFHEIV11
 13118     MOVE 'ELMSTR' TO DFHEIV1
 13119*    MOVE '&& L                  %   #00012508' TO DFHEIV0
 13120     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13121     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13122     MOVE X'2020233030303132353038' TO DFHEIV0(25:11)
 13123     CALL 'kxdfhei1' USING DFHEIV0,
 13124           DFHEIV1,
 13125           CLAIM-MASTER,
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 254
* EL156.cbl
 13126           DFHEIV11,
 13127           DFHEIV99
 13128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13129
 13130
 13131     IF WS-LETTER-SW = 'N'
 13132         GO TO 5000-END-UPDATE.
 13133
 13134 5000-GENERATE-AUTO-LETTER.
 13135
 13136
 13137* EXEC CICS LINK
 13138*        PROGRAM    (LINK-1523)
 13139*        COMMAREA   (W-1523-LINKDATA)
 13140*        LENGTH     (W-1523-COMM-LENGTH)
 13141*    END-EXEC.
 13142*    MOVE '."C                   (   #00012518' TO DFHEIV0
 13143     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13144     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13145     MOVE X'2020233030303132353138' TO DFHEIV0(25:11)
 13146     CALL 'kxdfhei1' USING DFHEIV0,
 13147           LINK-1523,
 13148           W-1523-LINKDATA,
 13149           W-1523-COMM-LENGTH,
 13150           DFHEIV99,
 13151           DFHEIV99,
 13152           DFHEIV99,
 13153           DFHEIV99
 13154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13155
 13156
 13157     IF W-1523-FATAL-ERROR
 13158         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 13159         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13160         MOVE ER-0802                TO  EMI-ERROR
 13161         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13162
 13163     IF W-1523-ERROR-CODE = 0191
 13164         MOVE ER-0803                TO  EMI-ERROR
 13165         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13166
 13167     IF PI-COMPANY-ID      = 'HAN' AND
 13168        PI-PMTTYPE         = '1'   AND
 13169        PI-3RD-PARTY-SW    = 'Y'   AND
 13170        W-1523-FORM-NUMBER = 'EOB1'
 13171           MOVE LOW-VALUES              TO W-1523-LINKDATA
 13172           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 13173           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 13174           GO TO 5000-GENERATE-AUTO-LETTER.
 13175
 13176 5000-END-UPDATE.
 13177
 13178     MOVE ER-0000                TO EMI-ERROR.
 13179     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13180     GO TO 7000-SHOW-CLAIM.
 13181
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 255
* EL156.cbl
 13183 5000-MOVE-NAME.
 13184     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 13185     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 13186     MOVE CL-INSURED-MID-INIT    TO MINITO.
 13187
 13188 5000-EXIT.
 13189     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 256
* EL156.cbl
 13191 5300-CREATE-DMO.
 13192
 13193     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 13194     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 13195     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 13196
 13197
 13198* EXEC CICS HANDLE CONDITION
 13199*         NOTFND   (5300-NOTE-NOT-FOUND)
 13200*    END-EXEC.
 13201*    MOVE '"$I                   ! . #00012564' TO DFHEIV0
 13202     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13203     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13204     MOVE X'2E20233030303132353634' TO DFHEIV0(25:11)
 13205     CALL 'kxdfhei1' USING DFHEIV0
 13206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13207
 13208
 13209
 13210* EXEC CICS READ
 13211*         DATASET('ERNOTE')
 13212*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 13213*         RIDFLD (W-NOTE-KEY)
 13214*    END-EXEC.
 13215     MOVE 'ERNOTE' TO DFHEIV1
 13216*    MOVE '&"S        E          (   #00012568' TO DFHEIV0
 13217     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13218     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13219     MOVE X'2020233030303132353638' TO DFHEIV0(25:11)
 13220     CALL 'kxdfhei1' USING DFHEIV0,
 13221           DFHEIV1,
 13222           DFHEIV20,
 13223           DFHEIV99,
 13224           W-NOTE-KEY,
 13225           DFHEIV99,
 13226           DFHEIV99,
 13227           DFHEIV99
 13228     SET ADDRESS OF CERTIFICATE-NOTE TO
 13229         DFHEIV20
 13230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13231
 13232
 13233     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 13234     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 13235     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 13236
 13237     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 13238         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 13239     ELSE
 13240         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 13241
 13242     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 13243     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 13244     MOVE 'DLO006'               TO PGM-NAME.
 13245
 13246
 13247* EXEC CICS LINK
 13248*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 257
* EL156.cbl
 13249*        COMMAREA   (DCT-COMMUNICATION-AREA)
 13250*        LENGTH     (DCT-RCRD-LENGTH)
 13251*    END-EXEC.
 13252*    MOVE '."C                   (   #00012587' TO DFHEIV0
 13253     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13254     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13255     MOVE X'2020233030303132353837' TO DFHEIV0(25:11)
 13256     CALL 'kxdfhei1' USING DFHEIV0,
 13257           PGM-NAME,
 13258           DCT-COMMUNICATION-AREA,
 13259           DCT-RCRD-LENGTH,
 13260           DFHEIV99,
 13261           DFHEIV99,
 13262           DFHEIV99,
 13263           DFHEIV99
 13264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13265
 13266
 13267     IF DCT-RETURN-CODE = 'OK'
 13268         GO TO 5300-CONT.
 13269
 13270     IF DCT-RETURN-CODE = '01' OR '02'
 13271         GO TO 5300-EXIT.
 13272
 13273     IF DCT-RETURN-CODE = '03'
 13274         MOVE ER-0951            TO EMI-ERROR
 13275         GO TO 5300-BAD-EXIT.
 13276
 13277     IF DCT-RETURN-CODE = '04'
 13278         MOVE ER-0946            TO EMI-ERROR
 13279         GO TO 5300-BAD-EXIT.
 13280
 13281     IF DCT-RETURN-CODE = '05'
 13282         MOVE ER-0947            TO EMI-ERROR
 13283         GO TO 5300-BAD-EXIT.
 13284
 13285     IF DCT-RETURN-CODE = '06'
 13286         MOVE ER-0921            TO EMI-ERROR
 13287         GO TO 5300-BAD-EXIT.
 13288
 13289     IF DCT-RETURN-CODE = '07'
 13290         MOVE ER-0849            TO EMI-ERROR
 13291         GO TO 5300-BAD-EXIT.
 13292
 13293     IF DCT-RETURN-CODE = '08'
 13294         MOVE ER-0948            TO EMI-ERROR
 13295         GO TO 5300-BAD-EXIT.
 13296
 13297     IF DCT-RETURN-CODE = 'N1'
 13298         MOVE ER-0950            TO EMI-ERROR
 13299         GO TO 5300-BAD-EXIT.
 13300
 13301     IF DCT-RETURN-CODE = 'E1'
 13302         MOVE ER-0974            TO EMI-ERROR
 13303         GO TO 5300-BAD-EXIT.
 13304
 13305     IF DCT-RETURN-CODE = 'E2'
 13306         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 258
* EL156.cbl
 13307         GO TO 5300-BAD-EXIT.
 13308
 13309     IF DCT-RETURN-CODE NOT = 'OK'
 13310         MOVE ER-0949            TO EMI-ERROR
 13311         GO TO 5300-BAD-EXIT.
 13312
 13313 5300-CONT.
 13314
 13315     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 13316     MOVE 'CS'                   TO DM-RECORD-TYPE.
 13317     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 13318     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 13319     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 13320     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 13321     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 13322     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 13323
 13324     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 13325     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 13326     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 13327     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 13328     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 13329
 13330     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 13331
 13332     IF PI-PMTTYPE = '2'
 13333         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 13334         MOVE '4'                TO DM-CLAIM-STATUS
 13335     ELSE
 13336         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 13337         MOVE '2'                TO DM-CLAIM-STATUS.
 13338
 13339     MOVE 'DLO025'               TO PGM-NAME.
 13340
 13341
 13342* EXEC CICS LINK
 13343*        PROGRAM    (PGM-NAME)
 13344*        COMMAREA   (DMO-COMMUNICATION-AREA)
 13345*        LENGTH     (DM-DMO-LENGTH)
 13346*    END-EXEC.
 13347*    MOVE '."C                   (   #00012667' TO DFHEIV0
 13348     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13349     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13350     MOVE X'2020233030303132363637' TO DFHEIV0(25:11)
 13351     CALL 'kxdfhei1' USING DFHEIV0,
 13352           PGM-NAME,
 13353           DMO-COMMUNICATION-AREA,
 13354           DM-DMO-LENGTH,
 13355           DFHEIV99,
 13356           DFHEIV99,
 13357           DFHEIV99,
 13358           DFHEIV99
 13359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13360
 13361
 13362     IF DM-RETURN-CODE = 'OK'
 13363         GO TO 5300-EXIT.
 13364
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 259
* EL156.cbl
 13365     IF DM-RETURN-CODE = '01'
 13366         MOVE ER-8051            TO EMI-ERROR
 13367         GO TO 5300-BAD-EXIT.
 13368
 13369     IF DM-RETURN-CODE = '02'
 13370         MOVE ER-8052            TO EMI-ERROR
 13371         GO TO 5300-BAD-EXIT.
 13372
 13373     IF DM-RETURN-CODE = '03'
 13374         MOVE ER-8053            TO EMI-ERROR
 13375         GO TO 5300-BAD-EXIT.
 13376
 13377     IF DM-RETURN-CODE = '04'
 13378         MOVE ER-8054            TO EMI-ERROR
 13379         GO TO 5300-BAD-EXIT.
 13380
 13381     IF DM-RETURN-CODE = '05'
 13382         MOVE ER-8055            TO EMI-ERROR
 13383         GO TO 5300-BAD-EXIT.
 13384
 13385     IF DM-RETURN-CODE = '06'
 13386         MOVE ER-8056            TO EMI-ERROR
 13387         GO TO 5300-BAD-EXIT.
 13388
 13389     IF DM-RETURN-CODE = '07'
 13390         MOVE ER-8057            TO EMI-ERROR
 13391         GO TO 5300-BAD-EXIT.
 13392
 13393     IF DM-RETURN-CODE = '08'
 13394         MOVE ER-8058            TO EMI-ERROR
 13395         GO TO 5300-BAD-EXIT.
 13396
 13397     IF DM-RETURN-CODE = '09'
 13398         MOVE ER-8059            TO EMI-ERROR
 13399         GO TO 5300-BAD-EXIT.
 13400
 13401     IF DM-RETURN-CODE = '10'
 13402         MOVE ER-8060            TO EMI-ERROR
 13403         GO TO 5300-BAD-EXIT.
 13404
 13405     IF DM-RETURN-CODE = '11'
 13406         MOVE ER-8061            TO EMI-ERROR
 13407         GO TO 5300-BAD-EXIT.
 13408
 13409     IF DM-RETURN-CODE = '12'
 13410         MOVE ER-8062            TO EMI-ERROR
 13411         GO TO 5300-BAD-EXIT.
 13412
 13413     IF DM-RETURN-CODE = '13'
 13414         MOVE ER-8063            TO EMI-ERROR
 13415         GO TO 5300-BAD-EXIT.
 13416
 13417     IF DM-RETURN-CODE = '14'
 13418         MOVE ER-8064            TO EMI-ERROR
 13419         GO TO 5300-BAD-EXIT.
 13420
 13421     IF DM-RETURN-CODE = '15'
 13422         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 260
* EL156.cbl
 13423         GO TO 5300-BAD-EXIT.
 13424
 13425     IF DM-RETURN-CODE = '16'
 13426         MOVE ER-8154            TO EMI-ERROR
 13427         GO TO 5300-BAD-EXIT.
 13428
 13429     IF DM-RETURN-CODE = '17'
 13430         MOVE ER-8155            TO EMI-ERROR
 13431         GO TO 5300-BAD-EXIT.
 13432
 13433     IF DM-RETURN-CODE = 'N1'
 13434         MOVE ER-8152            TO EMI-ERROR
 13435         GO TO 5300-BAD-EXIT.
 13436
 13437     IF DM-RETURN-CODE = 'E1'
 13438         MOVE ER-8153            TO EMI-ERROR
 13439         GO TO 5300-BAD-EXIT.
 13440
 13441     MOVE ER-8066            TO EMI-ERROR.
 13442     GO TO 5300-BAD-EXIT.
 13443
 13444 5300-NOTE-NOT-FOUND.
 13445
 13446     MOVE ER-0954                TO EMI-ERROR.
 13447     GO TO 5300-BAD-EXIT.
 13448
 13449 5300-BAD-EXIT.
 13450
 13451* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 13452*    MOVE '6"R                   !   #00012761' TO DFHEIV0
 13453     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 13454     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13455     MOVE X'2020233030303132373631' TO DFHEIV0(25:11)
 13456     CALL 'kxdfhei1' USING DFHEIV0
 13457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13458
 13459     IF MAP-NAME = 'EL156A'
 13460         MOVE -1             TO ENTERPFL
 13461       ELSE
 13462         MOVE LOW-VALUES     TO EL156BI
 13463         MOVE -1             TO ENTPFBL.
 13464
 13465     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13466     GO TO 8200-SEND-DATAONLY.
 13467
 13468 5300-EXIT.
 13469     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 261
* EL156.cbl
 13471 5350-FORMAT-LAST-NAME-1ST.
 13472*****************************************************************
 13473*             M O V E   N A M E   R O U T I N E                 *
 13474*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 13475*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 13476*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 13477*                  FIELD                   VALUE                *
 13478*           W-NAME-LAST    (CL15)      SMITH                    *
 13479*           W-NAME-FIRST   (CL15)      JOHN                     *
 13480*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 13481*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 13482*     CONTAIN                                                   *
 13483*                SMITH, JOHN ALLEN                              *
 13484*     OR                                                        *
 13485*                SMITH, JOHN A.                                 *
 13486*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 13487*     COPYBOOK, ELCNWA.                                         *
 13488*****************************************************************.
 13489
 13490     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 13491     MOVE ZERO                   TO  WS-NAME-SW.
 13492     SET NWA-INDEX               TO +1.
 13493
 13494     IF W-NAME-LAST   = SPACES AND
 13495        W-NAME-MIDDLE = SPACES
 13496         MOVE +1                 TO WS-NAME-SW.
 13497
 13498     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 13499     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13500
 13501     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 13502     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13503
 13504     SET NWA-INDEX UP BY +1.
 13505
 13506     IF W-NAME-MIDDLE NOT = SPACES
 13507         IF W-NAME-MIDDLE-2 = SPACES
 13508             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 13509             SET NWA-INDEX UP BY +1
 13510             MOVE '.'            TO WS-NW (NWA-INDEX)
 13511             SET NWA-INDEX UP BY +2
 13512         ELSE
 13513             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 13514             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13515
 13516 5350-EXIT.
 13517     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 262
* EL156.cbl
 13519 5360-MOVE-NAME.
 13520
 13521     IF WS-NAME-SW > +1
 13522         GO TO 5360-EXIT.
 13523
 13524     IF WS-NAME-WORK2 = SPACES
 13525         GO TO 5360-EXIT.
 13526
 13527     SET NWA-INDEX2            TO +1.
 13528     SET NWA-INDEX3            TO +2.
 13529
 13530 5360-MOVE-NAME-CYCLE.
 13531
 13532     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 13533
 13534     IF NWA-INDEX < +30
 13535         SET NWA-INDEX UP BY +1
 13536     ELSE
 13537         ADD +2                TO  WS-NAME-SW
 13538         GO TO 5360-EXIT.
 13539
 13540     IF NWA-INDEX2 < +20
 13541         SET NWA-INDEX3 UP BY +1
 13542         SET NWA-INDEX2 UP BY +1.
 13543
 13544     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 13545        WS-NW2 (NWA-INDEX3) = SPACES
 13546         IF WS-NAME-SW = ZERO
 13547             MOVE ','            TO  WS-NW (NWA-INDEX)
 13548             SET NWA-INDEX UP BY +2
 13549             MOVE +1             TO  WS-NAME-SW
 13550             GO TO 5360-EXIT
 13551         ELSE
 13552             GO TO 5360-EXIT.
 13553
 13554     GO TO 5360-MOVE-NAME-CYCLE.
 13555
 13556 5360-EXIT.
 13557     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 263
* EL156.cbl
 13559 6000-BUILD-SCREEN-B.
 13560     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 13561     MOVE PI-CARRIER             TO MSTR-CARRIER.
 13562     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 13563     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 13564
 13565     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 13566
 13567 6050-BUILD-SCREEN.
 13568     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 13569     MOVE LOW-VALUES             TO EL156BI.
 13570     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 13571
 13572     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 13573
 13574     IF PI-PAYEE-TYPE = 'I'
 13575        GO TO 6060-READ-TRAILER.
 13576
 13577     IF PI-PAYEE-TYPE = 'B'
 13578        ADD +10                  TO TRLR-SEQ-NO
 13579        GO TO 6060-READ-TRAILER.
 13580
 13581     IF PI-PAYEE-TYPE = 'A'
 13582        ADD +20                  TO TRLR-SEQ-NO
 13583        GO TO 6060-READ-TRAILER.
 13584
 13585     IF PI-PAYEE-TYPE = 'O'
 13586        ADD +50                  TO TRLR-SEQ-NO
 13587        GO TO 6060-READ-TRAILER.
 13588
 13589     IF PI-PAYEE-TYPE = 'Q'
 13590        ADD +60                  TO TRLR-SEQ-NO
 13591        GO TO 6060-READ-TRAILER.
 13592
 13593     IF PI-PAYEE-TYPE = 'P'
 13594        ADD +30                  TO TRLR-SEQ-NO
 13595        GO TO 6060-READ-TRAILER.
 13596
 13597     IF PI-PAYEE-TYPE = 'E'
 13598        ADD +40                  TO TRLR-SEQ-NO.
 13599
 13600 6060-READ-TRAILER.
 13601
 13602     IF PI-PAYEE-TYPE    = 'A' AND
 13603        PI-PAYEE-SEQ-NUM = 0
 13604          GO TO 6061-READ-ACCOUNT.
 13605
 13606     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 13607        (PI-PAYEE-TYPE    = 'B')             AND
 13608        (PI-PAYEE-SEQ-NUM = 9)
 13609          PERFORM 7920-READ-BENE THRU 7920-EXIT
 13610          IF BENE-FOUND-SW = 'N'
 13611            GO TO 6065-NOT-FOUND
 13612          ELSE
 13613            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 13614            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 13615            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 13616*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 264
* EL156.cbl
 13617            STRING BE-CITY ' ' BE-STATE
 13618               DELIMITED BY '  ' INTO CITYSTBO
 13619            END-STRING
 13620            MOVE BE-ZIP-CODE       TO ZIPBO
 13621            GO TO 6061-READ-ACCOUNT.
 13622
 13623     IF PI-PAYEE-TYPE    = 'B' AND
 13624        PI-PAYEE-SEQ-NUM = 0
 13625          PERFORM 7920-READ-BENE THRU 7920-EXIT
 13626          IF BENE-FOUND-SW = 'N'
 13627            GO TO 6065-NOT-FOUND
 13628          ELSE
 13629            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 13630            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 13631            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 13632*           MOVE BE-CITY-STATE     TO CITYSTBO
 13633            STRING BE-CITY ' ' BE-STATE
 13634               DELIMITED BY '  ' INTO CITYSTBO
 13635            END-STRING
 13636            MOVE BE-ZIP-CODE       TO ZIPBO
 13637            GO TO 6061-READ-ACCOUNT.
 13638
 13639
 13640* EXEC CICS HANDLE CONDITION
 13641*         NOTFND(6065-NOT-FOUND)
 13642*     END-EXEC.
 13643*    MOVE '"$I                   ! / #00012942' TO DFHEIV0
 13644     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13645     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13646     MOVE X'2F20233030303132393432' TO DFHEIV0(25:11)
 13647     CALL 'kxdfhei1' USING DFHEIV0
 13648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13649
 13650
 13651     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13652
 13653     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 13654     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 13655     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 13656     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 13657*    MOVE AT-CITY-STATE          TO CITYSTBO.
 13658     STRING AT-CITY ' ' AT-STATE
 13659        DELIMITED BY '  ' INTO CITYSTBO
 13660     END-STRING
 13661     MOVE AT-ZIP-CODE            TO ZIPBO.
 13662
 13663 6061-READ-ACCOUNT.
 13664
 13665* EXEC CICS HANDLE CONDITION
 13666*         NOTFND(6068-ACCT-NOT-FND)
 13667*     END-EXEC.
 13668*    MOVE '"$I                   ! 0 #00012959' TO DFHEIV0
 13669     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13670     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13671     MOVE X'3020233030303132393539' TO DFHEIV0(25:11)
 13672     CALL 'kxdfhei1' USING DFHEIV0
 13673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13674
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 265
* EL156.cbl
 13675
 13676
 13677* EXEC CICS READ
 13678*         DATASET('ERACCT')
 13679*         SET    (ADDRESS OF ACCOUNT-MASTER)
 13680*         RIDFLD (PI-ACCT-KEY)
 13681*     END-EXEC.
 13682     MOVE 'ERACCT' TO DFHEIV1
 13683*    MOVE '&"S        E          (   #00012963' TO DFHEIV0
 13684     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13685     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13686     MOVE X'2020233030303132393633' TO DFHEIV0(25:11)
 13687     CALL 'kxdfhei1' USING DFHEIV0,
 13688           DFHEIV1,
 13689           DFHEIV20,
 13690           DFHEIV99,
 13691           PI-ACCT-KEY,
 13692           DFHEIV99,
 13693           DFHEIV99,
 13694           DFHEIV99
 13695     SET ADDRESS OF ACCOUNT-MASTER TO
 13696         DFHEIV20
 13697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13698
 13699
 13700     MOVE AM-CARRIER             TO ACARRBO.
 13701     MOVE AM-GROUPING            TO GROUPBO.
 13702     MOVE AM-STATE               TO STATEBO.
 13703     MOVE AM-ACCOUNT             TO ACCTBO.
 13704     MOVE AM-NAME                TO ACCTNMBO.
 13705
 13706     IF PI-PAYEE-TYPE = 'A' AND
 13707        PI-PAYEE-SEQ-NUM = 0
 13708          MOVE AM-NAME             TO NAMEBO
 13709                                      PI-PAYEE-NAME
 13710          MOVE AM-ADDRS            TO ADDR1BO
 13711          MOVE SPACES              TO ADDR2BO
 13712*         MOVE AM-CITY             TO CITYSTBO
 13713          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 13714             DELIMITED BY '  ' INTO CITYSTBO
 13715          END-STRING
 13716          MOVE AM-ZIP-PRIME        TO WS-ZIP
 13717          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 13718          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 13719          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 13720
 13721     IF CITYSTBO EQUAL SPACES
 13722         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13723         GO TO 6070-FORMAT-DATA
 13724     END-IF.
 13725
 13726     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 13727     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 13728     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 13729     PERFORM VARYING WS-SUB FROM 30 BY -1
 13730          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 13731        IF WS-END-SUB = 0  AND
 13732           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES OR '.')
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 266
* EL156.cbl
 13733            CONTINUE
 13734        ELSE
 13735            IF WS-END-SUB = 0
 13736                MOVE WS-SUB TO WS-END-SUB
 13737            ELSE
 13738                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 13739                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 13740                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 13741                END-IF
 13742            END-IF
 13743        END-IF
 13744        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 13745            COMPUTE WS-BEG-SUB = WS-SUB + 1
 13746            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 13747        END-IF
 13748     END-PERFORM.
 13749
 13750     IF WS-BEG-SUB > 0
 13751         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 13752         IF WS-STATE-LENGTH = 2
 13753             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 13754                  TO PI-CHECK-STATE-FOR-AK
 13755         ELSE
 13756             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 13757                'ALASKA'
 13758                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 13759             ELSE
 13760                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13761             END-IF
 13762         END-IF
 13763     ELSE
 13764         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13765     END-IF.
 13766
 13767     GO TO 6070-FORMAT-DATA.
 13768
 13769 6065-NOT-FOUND.
 13770     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 13771     GO TO 6061-READ-ACCOUNT.
 13772
 13773 6068-ACCT-NOT-FND.
 13774     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 13775
 13776 6070-FORMAT-DATA.
 13777     IF PI-HOLDTIL = ZEROS
 13778        MOVE SAVE-DATE           TO PAYDTBI
 13779       ELSE
 13780        MOVE PI-HOLDTIL          TO PAYDTBO
 13781        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 13782
 13783     MOVE PI-PROOF-DATE          TO PROOFDBO.
 13784     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 13785
 13786     IF EIBAID = DFHPF3 OR DFHPF4
 13787        NEXT SENTENCE
 13788     ELSE
 13789       GO TO 6071-CONTINUE.
 13790
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 267
* EL156.cbl
 13791     MOVE PI-EPYFROM          TO PYFROMBO.
 13792     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 13793
 13794     IF NOT PI-USES-PAID-TO
 13795        MOVE PI-EPYTHRU          TO PYTHRUBO
 13796        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 13797     ELSE
 13798        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 13799        MOVE '4'              TO DC-OPTION-CODE
 13800        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13801        IF NO-CONVERSION-ERROR
 13802           MOVE +1            TO DC-ELAPSED-DAYS
 13803           MOVE +0            TO DC-ELAPSED-MONTHS
 13804           MOVE '6'           TO DC-OPTION-CODE
 13805           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13806           IF NO-CONVERSION-ERROR
 13807              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 13808
 13809     MOVE PI-EDAYS            TO DAYSBO.
 13810     MOVE PI-EPYAMT           TO PAYAMTBO.
 13811     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13812        IF PI-INT-AMT > ZEROS
 13813           MOVE PI-INT-AMT       TO INTAMTBO
 13814        END-IF
 13815     END-IF
 13816     GO TO 6072-SET-TYPE.
 13817
 13818 6071-CONTINUE.
 13819
 13820     IF PI-CPYFROM NOT = LOW-VALUES
 13821        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 13822        MOVE SPACES              TO DC-OPTION-CODE
 13823        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13824        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 13825
 13826     IF PI-CPYTHRU NOT = LOW-VALUES
 13827        IF NOT PI-USES-PAID-TO
 13828           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 13829           MOVE SPACES             TO DC-OPTION-CODE
 13830           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13831           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 13832        ELSE
 13833           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 13834           MOVE '6'                TO DC-OPTION-CODE
 13835           MOVE +1                 TO DC-ELAPSED-DAYS
 13836           MOVE +0                 TO DC-ELAPSED-MONTHS
 13837           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13838           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 13839
 13840     MOVE PI-CDAYS               TO DAYSBO.
 13841     MOVE PI-CPYAMT              TO PAYAMTBO.
 13842     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13843        IF PI-INT-AMT > ZEROS
 13844           MOVE PI-INT-AMT       TO INTAMTBO
 13845        END-IF
 13846     END-IF
 13847     .
 13848 6072-SET-TYPE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 268
* EL156.cbl
 13849     IF PI-PMTTYPE = '1'
 13850        MOVE 'PARTIAL'           TO PAYTYPBO.
 13851
 13852     IF PI-PMTTYPE = '2'
 13853        MOVE 'FINAL'             TO PAYTYPBO.
 13854
 13855     IF PI-PMTTYPE = '3'
 13856        MOVE 'LUMP SUM'          TO PAYTYPBO.
 13857
 13858     IF PI-PMTTYPE = '4'
 13859        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 13860
 13861     IF PI-PMTTYPE = '5'
 13862        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 13863
 13864     IF PI-PMTTYPE = '6'
 13865        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 13866
 13867     IF PI-PROV-PMT
 13868        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 13869
 13870     IF PI-ECHECKNO NOT = SPACES
 13871        MOVE PI-ECHECKNO         TO CKNUMBO
 13872     ELSE
 13873        MOVE PI-CCHECKNO         TO CKNUMBO.
 13874
 13875     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 13876        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 13877        MOVE +91                 TO  TRLR-SEQ-NO
 13878
 13879* EXEC CICS READ
 13880*           DATASET  ('ELTRLR')
 13881*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13882*           RIDFLD   (ELTRLR-KEY)
 13883*           RESP     (WS-RESPONSE)
 13884*       END-EXEC
 13885     MOVE 'ELTRLR' TO DFHEIV1
 13886*    MOVE '&"S        E          (  N#00013147' TO DFHEIV0
 13887     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13888     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13889     MOVE X'204E233030303133313437' TO DFHEIV0(25:11)
 13890     CALL 'kxdfhei1' USING DFHEIV0,
 13891           DFHEIV1,
 13892           DFHEIV20,
 13893           DFHEIV99,
 13894           ELTRLR-KEY,
 13895           DFHEIV99,
 13896           DFHEIV99,
 13897           DFHEIV99
 13898     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13899         DFHEIV20
 13900     MOVE EIBRESP  TO WS-RESPONSE
 13901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13902
 13903        IF WS-RESP-NORMAL
 13904           MOVE AT-INFO-LINE-1   TO  LOANNBO
 13905        ELSE
 13906           MOVE SPACES           TO  LOANNBO
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 269
* EL156.cbl
 13907        END-IF
 13908     END-IF
 13909
 13910*       MOVE PI-LOAN-NO          TO LOANNBO
 13911
 13912     IF CKNUMBO = SPACES
 13913         MOVE SPACES             TO CKNUMHDO.
 13914
 13915     MOVE CL-CLAIM-NO            TO CLMNOBO.
 13916     MOVE CL-CARRIER             TO CARRBO.
 13917     MOVE CL-CERT-PRIME          TO CERTNOBO.
 13918     MOVE CL-CERT-SFX            TO SUFXBO.
 13919
 13920     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13921        EVALUATE CL-CLAIM-TYPE
 13922           WHEN 'I'
 13923              MOVE '  IU  '      TO CLMTYPBO
 13924           WHEN 'G'
 13925              MOVE ' GAP  '      TO CLMTYPBO
 13926           WHEN OTHER
 13927              MOVE PI-AH-OVERRIDE-L6
 13928                                 TO CLMTYPBO
 13929        END-EVALUATE
 13930        MOVE ZEROS               TO UNDISBO
 13931*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 13932        IF PI-PMTTYPE = '5' OR '6'
 13933           GO TO 6073-GET-NOTIFY-DATA
 13934        ELSE
 13935           MOVE PI-DAILY-RATE    TO RATEBO
 13936           GO TO 6073-GET-NOTIFY-DATA.
 13937
 13938     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 13939
 13940     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 13941        MOVE ZEROS               TO UNDISBO
 13942     ELSE
 13943        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 13944
 13945 6073-GET-NOTIFY-DATA.
 13946
 13947     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 13948
 13949     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 13950         MOVE SPACES             TO  NAMEB2O
 13951                                     ADDR1B2O
 13952                                     ADDR2B2O
 13953                                     CITYST2O
 13954                                     AGTHDGO
 13955         MOVE ZEROS              TO  ZIPB2O
 13956         GO TO 6080-SET-INCURRED.
 13957
 13958     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 13959     MOVE +29                    TO  TRLR-SEQ-NO.
 13960
 13961
 13962* EXEC CICS HANDLE CONDITION
 13963*        NOTFND   (6074-GET-COMP-DATA)
 13964*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 270
* EL156.cbl
 13965*    MOVE '"$I                   ! 1 #00013212' TO DFHEIV0
 13966     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13967     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13968     MOVE X'3120233030303133323132' TO DFHEIV0(25:11)
 13969     CALL 'kxdfhei1' USING DFHEIV0
 13970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13971
 13972
 13973     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13974
 13975     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 13976     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 13977     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 13978*    MOVE AT-CITY-STATE          TO  CITYST2O.
 13979     STRING AT-CITY ' ' AT-STATE
 13980        DELIMITED BY '  ' INTO CITYST2O
 13981     END-STRING
 13982     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 13983     GO TO 6080-SET-INCURRED.
 13984
 13985 6074-GET-COMP-DATA.
 13986
 13987     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 13988         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 13989
 13990     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 13991         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 13992                                         ADDR1B2O
 13993                                         ADDR2B2O
 13994                                         CITYST2O
 13995         MOVE ZEROS                  TO  ZIPB2O
 13996         GO TO 6080-SET-INCURRED.
 13997
 13998     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 13999     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 14000     MOVE AM-CARRIER             TO  COMP-CARRIER.
 14001     MOVE AM-GROUPING            TO  COMP-GROUP.
 14002     MOVE 'A'                    TO  COMP-TYPE.
 14003     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 14004                                 TO  COMP-FIN-RESP.
 14005
 14006     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 14007         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 14008                                       'G' OR 'B'
 14009             MOVE 'G'            TO  COMP-TYPE
 14010             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 14011         ELSE
 14012             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 14013                                 TO  COMP-ACCOUNT
 14014     ELSE
 14015         MOVE 'G'                TO  COMP-TYPE
 14016         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 14017
 14018     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 14019
 14020     IF COMP-REC-FOUND
 14021         MOVE CO-ACCT-NAME       TO  NAMEB2O
 14022         MOVE CO-ADDR-1          TO  ADDR1B2O
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 271
* EL156.cbl
 14023         MOVE CO-ADDR-2          TO  ADDR2B2O
 14024*        MOVE CO-ADDR-3          TO  CITYST2O
 14025         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14026            DELIMITED BY '  ' INTO CITYST2O
 14027         END-STRING
 14028         MOVE CO-ZIP             TO  ZIPB2O
 14029     ELSE
 14030         MOVE 'NO COMP ADDRESS AVAILABLE'
 14031                                 TO  NAMEB2O
 14032                                     ADDR1B2O
 14033                                     ADDR2B2O
 14034                                     CITYST2O
 14035         MOVE ZEROS               TO ZIPB2O.
 14036
 14037 6080-SET-INCURRED.
 14038     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14039     MOVE SPACES                 TO DC-OPTION-CODE.
 14040     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14041     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 14042     MOVE PI-PROCESSOR-ID        TO BYBO.
 14043     MOVE MAP-NAMEB              TO MAP-NAME.
 14044     MOVE 'C'                    TO PI-PASS-SW.
 14045     MOVE EIBAID                 TO PI-PFKEY-USED.
 14046     MOVE -1                     TO ENTPFBL.
 14047     GO TO 8100-SEND-INITIAL-MAP.
 14048
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 272
* EL156.cbl
 14050 6100-BUILD-PAYMENT-TRAILER.
 14051
 14052     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 14053       (PI-COMPANY-ID = 'CID' OR 'AHL')
 14054         GO TO 6105-STATE-CHECK-NUMBER
 14055     END-IF.
 14056
 14057     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14058     MOVE '6'                    TO CNTL-REC-TYPE.
 14059
 14060     IF CONTROL-IS-ACTUAL-CARRIER
 14061         MOVE PI-CARRIER         TO WS-CARR
 14062     ELSE
 14063         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 14064
 14065     IF PI-COMPANY-ID = 'FIA'
 14066         MOVE PI-CARRIER         TO  WS-CARR.
 14067
 14068     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 14069     MOVE 0                      TO CNTL-SEQ-NO.
 14070     MOVE 'CARR'                 TO FILE-SWITCH.
 14071
 14072     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 14073
 14074     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14075         IF PI-OFFLINE     = 'Y' AND
 14076            PI-ECHECKNO-CR = 'CR'
 14077              GO TO 6110-READ-CONTROL
 14078         ELSE
 14079            IF PI-CASH = 'N'
 14080                GO TO 6110-READ-CONTROL.
 14081
 14082     IF CHECK-NO-MANUAL    OR
 14083        CHECK-NO-AT-PRINT  OR
 14084        PI-OFFLINE = 'Y'
 14085          GO TO 6130-BUILD-TRAILER.
 14086
 14087     IF PI-COMPANY-ID = 'FIA'
 14088         NEXT SENTENCE
 14089     ELSE
 14090         IF NOT CONTROL-IS-ACTUAL-CARRIER
 14091             GO TO 6110-READ-CONTROL.
 14092
 14093     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14094
 14095     IF CHECK-CNT-RESET-VALUE
 14096        MOVE +1                  TO CF-CHECK-COUNTER
 14097     ELSE
 14098        ADD +1                   TO CF-CHECK-COUNTER.
 14099
 14100     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 14101
 14102     IF CHECK-NO-CARR-SEQ
 14103        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 14104
 14105     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 14106
 14107     MOVE 'N' TO PI-REAUDIT-NEEDED.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 273
* EL156.cbl
 14108     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 14109        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 14110         MOVE 'Y' TO PI-REAUDIT-NEEDED
 14111         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 14112            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 14113         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 14114                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 14115     END-IF.
 14116
 14117     GO TO 6120-REWRITE.
 14118
 14119 6105-STATE-CHECK-NUMBER.
 14120     IF CHECK-NO-MANUAL    OR
 14121        CHECK-NO-AT-PRINT  OR
 14122        PI-OFFLINE = 'Y'
 14123           GO TO 6130-BUILD-TRAILER
 14124     END-IF.
 14125
 14126     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 14127     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 14128     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 14129     MOVE '3'                TO CNTL-REC-TYPE.
 14130     MOVE +0                 TO CNTL-SEQ-NO.
 14131     MOVE 'STAT'             TO FILE-SWITCH.
 14132     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14133
 14134     IF CF-ST-CHECK-CNT-RESET
 14135         MOVE +1             TO CF-ST-CHECK-COUNTER
 14136     ELSE
 14137         ADD +1              TO CF-ST-CHECK-COUNTER
 14138     END-IF.
 14139
 14140     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 14141     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 14142     GO TO 6120-REWRITE.
 14143
 14144 6110-READ-CONTROL.
 14145     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14146     MOVE '1'                    TO CNTL-REC-TYPE.
 14147     MOVE SPACES                 TO CNTL-ACCESS.
 14148     MOVE 0                      TO CNTL-SEQ-NO.
 14149
 14150     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14151
 14152     IF CO-CHECK-COUNT-RESET
 14153        MOVE +1                  TO CF-CO-CHECK-COUNTER
 14154     ELSE
 14155        ADD +1                   TO CF-CO-CHECK-COUNTER.
 14156
 14157     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 14158
 14159     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14160         IF PI-OFFLINE     = 'Y'  AND
 14161            PI-ECHECKNO-CR = 'CR'
 14162              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 14163              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 14164              MOVE AL-UANON           TO CHECKNOA
 14165              GO TO 6120-REWRITE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 274
* EL156.cbl
 14166         ELSE
 14167         IF PI-CASH = 'N'
 14168             MOVE 'N'                TO PI-ECHECKNO-N
 14169             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 14170             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 14171             MOVE AL-UANON           TO CHECKNOA
 14172             GO TO 6120-REWRITE.
 14173
 14174     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 14175
 14176 6120-REWRITE.
 14177
 14178* EXEC CICS REWRITE
 14179*         DATASET('ELCNTL')
 14180*         FROM(CONTROL-FILE)
 14181*     END-EXEC.
 14182     MOVE LENGTH OF
 14183      CONTROL-FILE
 14184       TO DFHEIV11
 14185     MOVE 'ELCNTL' TO DFHEIV1
 14186*    MOVE '&& L                  %   #00013420' TO DFHEIV0
 14187     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14188     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14189     MOVE X'2020233030303133343230' TO DFHEIV0(25:11)
 14190     CALL 'kxdfhei1' USING DFHEIV0,
 14191           DFHEIV1,
 14192           CONTROL-FILE,
 14193           DFHEIV11,
 14194           DFHEIV99
 14195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14196
 14197
 14198     MOVE 'Y'                    TO PI-CK-ASSIGN.
 14199
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 275
* EL156.cbl
 14201 6130-BUILD-TRAILER.
 14202
 14203
 14204* EXEC CICS GETMAIN
 14205*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14206*         LENGTH    (200)
 14207*         INITIMG   (GETMAIN-SPACE)
 14208*     END-EXEC.
 14209     MOVE 200
 14210       TO DFHEIV11
 14211*    MOVE ',"IL                  $   #00013430' TO DFHEIV0
 14212     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14213     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14214     MOVE X'2020233030303133343330' TO DFHEIV0(25:11)
 14215     CALL 'kxdfhei1' USING DFHEIV0,
 14216           DFHEIV20,
 14217           DFHEIV11,
 14218           GETMAIN-SPACE
 14219     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14220         DFHEIV20
 14221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14222
 14223
 14224     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 14225                                    AT-PREV-PAID-THRU-DT.
 14226     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 14227     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 14228     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 14229     MOVE 'AT'                   TO AT-RECORD-ID.
 14230     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 14231
 14232     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 14233        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 14234           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 14235     ELSE
 14236           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 14237           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 14238
 14239     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 14240         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 14241             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 14242             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 14243           ELSE
 14244             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 14245             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 14246
 14247     MOVE '2'                    TO AT-TRAILER-TYPE.
 14248     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 14249                                    AT-PAYMENT-LAST-MAINT-DT.
 14250     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 14251                                    AT-PAYMENT-LAST-UPDATED-BY.
 14252     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 14253     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 14254     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 14255     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 14256
 14257     IF PI-PMT-APPROVED
 14258        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 276
* EL156.cbl
 14259           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 14260
 14261     IF PI-PFKEY-USED = DFHPF5
 14262        GO TO 6140-PF5-ENTERED.
 14263
 14264     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 14265     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 14266
 14267     IF PI-AIG-SPECIAL-BENEFIT
 14268         IF WS-1ST-SPECIAL-PMT
 14269             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 14270             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 14271                                        AT-AMOUNT-PAID
 14272         ELSE
 14273             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 14274
 14275     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 14276
 14277     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 14278     MOVE '4'                    TO DC-OPTION-CODE.
 14279     PERFORM 9700-LINK-DATE-CONVERT.
 14280
 14281     IF DATE-CONVERSION-ERROR
 14282        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 14283     ELSE
 14284        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 14285
 14286     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 14287     MOVE '4'                    TO DC-OPTION-CODE.
 14288     PERFORM 9700-LINK-DATE-CONVERT.
 14289
 14290     IF DATE-CONVERSION-ERROR
 14291        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 14292     ELSE
 14293        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 14294
 14295     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 14296     GO TO 6150-FINISH-MOVE.
 14297
 14298 6140-PF5-ENTERED.
 14299     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 14300     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 14301
 14302     IF PI-AIG-SPECIAL-BENEFIT
 14303         IF WS-1ST-SPECIAL-PMT
 14304             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 14305             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 14306                                        AT-AMOUNT-PAID
 14307         ELSE
 14308             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 14309
 14310     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 14311     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 14312     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 14313
 14314 6150-FINISH-MOVE.
 14315
 14316     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 277
* EL156.cbl
 14317         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 14318     ELSE
 14319         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 14320
 14321     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 14322     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 14323
 14324*05919      MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 14325*05920      MOVE PI-CASH                TO AT-CASH-PAYMENT.
 14326
 14327     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14328         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 14329
 14330     IF PI-OFFLINE = 'N'
 14331        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 14332        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 14333     ELSE
 14334        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 14335        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 14336
 14337     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 14338
 14339     IF WS-2ND-SPECIAL-PMT
 14340         MOVE 'Y'                TO AT-CASH-PAYMENT
 14341         MOVE SPACES             TO AT-CHECK-NO
 14342         MOVE '3'                TO AT-PAYMENT-ORIGIN
 14343         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 14344         MOVE 'U'                TO AT-AIG-UNEMP-IND
 14345         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 14346
 14347     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 14348                                    AT-TO-BE-WRITTEN-DT.
 14349
 14350     IF PI-HOLDTIL NOT = ZEROS
 14351        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 14352        MOVE '4'                 TO DC-OPTION-CODE
 14353        PERFORM 9700-LINK-DATE-CONVERT
 14354        IF PI-OFFLINE = 'N'
 14355           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 14356        ELSE
 14357           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 14358
 14359     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 14360     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 14361                                    AT-CHECK-QUE-SEQUENCE.
 14362
 14363     IF PI-PFKEY-USED = DFHPF4
 14364        MOVE '1'                 TO AT-FORCE-CONTROL.
 14365
 14366     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 14367        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 14368        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 14369        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 14370
 14371     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 14372                                    AT-VOID-SELECT-DT
 14373                                    AT-VOID-ACCEPT-DT
 14374                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 278
* EL156.cbl
 14375     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14376        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 14377        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 14378        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 14379        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 14380     ELSE
 14381        MOVE ZEROS               TO AT-DAILY-RATE
 14382                                    AT-ELIMINATION-DAYS
 14383        MOVE SPACES              TO AT-BENEFIT-TYPE
 14384     END-IF
 14385     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 14386     MOVE '4'                    TO DC-OPTION-CODE.
 14387     PERFORM 9700-LINK-DATE-CONVERT.
 14388     IF DATE-CONVERSION-ERROR
 14389         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 14390     ELSE
 14391         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 14392     END-IF.
 14393     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 14394     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 14395     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 14396     IF PI-REAUDIT-NEEDED = 'Y'
 14397         MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 14398         MOVE 'Y' TO WS-NEED-APPROVAL
 14399         GO TO 6170-WRITE
 14400     END-IF.
 14401*******************************************************
 14402     IF NOT PI-PMT-GRADUATED
 14403         GO TO 6170-WRITE.
 14404
 14405     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14406     MOVE '1'                    TO CNTL-REC-TYPE.
 14407     MOVE SPACES                 TO CNTL-ACCESS.
 14408     MOVE +0                     TO CNTL-SEQ-NO.
 14409     MOVE 'COMP'                 TO FILE-SWITCH.
 14410
 14411     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 14412
 14413     IF PAID-FOR-LIFE
 14414         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 14415             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14416                                     WS-PMT-APPROVAL-SW
 14417             GO TO 6170-WRITE.
 14418
 14419*05999      IF PAID-FOR-AH
 14420     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 14421         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 14422             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14423                                     WS-PMT-APPROVAL-SW
 14424             GO TO 6170-WRITE.
 14425
 14426     MOVE '1'                    TO AT-APPROVED-LEVEL.
 14427
 14428******A&H Limits are set as a monthly payment.  Calculate the mont
 14429******equivalent of the amount paid today
 14430     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 14431        PI-SAVE-ODD-DAYS-OVER > 0
 14432           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 279
* EL156.cbl
 14433                               / 30) + PI-SAVE-ELAPSED-MONTHS
 14434           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 14435                                  WS-CALC-PMT-MONTHS
 14436     ELSE
 14437           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 14438     END-IF.
 14439*06007      IF ((PAID-FOR-AH) AND
 14440     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14441*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 14442        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 14443              OR
 14444        ((PAID-FOR-LIFE) AND
 14445        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 14446            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 14447       ELSE
 14448*06014      IF ((PAID-FOR-AH)  AND
 14449         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14450*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 14451           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 14452              OR
 14453        ((PAID-FOR-LIFE) AND
 14454        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 14455            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 14456         ELSE
 14457*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 14458           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14459               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 14460              OR
 14461          ((PAID-FOR-LIFE) AND
 14462          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 14463            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 14464       ELSE
 14465            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD.
 14466
 14467     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14468        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 14469        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 14470            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 14471        END-IF
 14472     ELSE
 14473     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14474        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 14475        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 14476            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 14477        END-IF
 14478     ELSE
 14479     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14480        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 14481        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 14482            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 14483        END-IF
 14484     ELSE
 14485     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 14486            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD.
 14487
 14488     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 14489
 14490     IF NOT PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 280
* EL156.cbl
 14491         GO TO 6170-WRITE.
 14492
 14493
 14494* EXEC CICS HANDLE CONDITION
 14495*        NOTFND   (6170-WRITE)
 14496*    END-EXEC.
 14497*    MOVE '"$I                   ! 2 #00013705' TO DFHEIV0
 14498     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14499     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14500     MOVE X'3220233030303133373035' TO DFHEIV0(25:11)
 14501     CALL 'kxdfhei1' USING DFHEIV0
 14502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14503
 14504
 14505     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14506     MOVE '2'                    TO CNTL-REC-TYPE.
 14507     MOVE +0                     TO CNTL-SEQ-NO.
 14508     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 14509
 14510
 14511* EXEC CICS READ
 14512*         DATASET  ('ELCNTL')
 14513*         SET      (ADDRESS OF CONTROL-FILE)
 14514*         RIDFLD   (ELCNTL-KEY)
 14515*    END-EXEC.
 14516     MOVE 'ELCNTL' TO DFHEIV1
 14517*    MOVE '&"S        E          (   #00013714' TO DFHEIV0
 14518     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14519     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14520     MOVE X'2020233030303133373134' TO DFHEIV0(25:11)
 14521     CALL 'kxdfhei1' USING DFHEIV0,
 14522           DFHEIV1,
 14523           DFHEIV20,
 14524           DFHEIV99,
 14525           ELCNTL-KEY,
 14526           DFHEIV99,
 14527           DFHEIV99,
 14528           DFHEIV99
 14529     SET ADDRESS OF CONTROL-FILE TO
 14530         DFHEIV20
 14531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14532
 14533
 14534     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 14535
 14536     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 14537                         OR '4'
 14538         NEXT SENTENCE
 14539     ELSE
 14540         MOVE 'Y' TO WS-NEED-APPROVAL
 14541         GO TO 6170-WRITE.
 14542
 14543     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 14544         MOVE 'Y' TO WS-NEED-APPROVAL
 14545         IF WS-APPROVAL-LEVEL = '1'
 14546             MOVE '2'        TO  AT-APPROVED-LEVEL
 14547                            WS-SAVE-APPROVED-LEVEL
 14548             GO TO 6170-WRITE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 281
* EL156.cbl
 14549         ELSE
 14550             IF WS-APPROVAL-LEVEL = '2'
 14551                 MOVE '3'        TO  AT-APPROVED-LEVEL
 14552                                WS-SAVE-APPROVED-LEVEL
 14553                 GO TO 6170-WRITE
 14554             ELSE IF WS-APPROVAL-LEVEL = '3'
 14555                 MOVE '4'        TO  AT-APPROVED-LEVEL
 14556                                WS-SAVE-APPROVED-LEVEL
 14557                 GO TO 6170-WRITE.
 14558
 14559     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14560                             WS-PMT-APPROVAL-SW.
 14561     MOVE SPACES         TO  AT-APPROVED-LEVEL
 14562                             AT-APPROVAL-LEVEL-REQD.
 14563
 14564*******************************************************
 14565
 14566 6170-WRITE.
 14567
 14568     IF PI-COMPANY-ID = 'DMD'
 14569        IF PI-AT-EOB-CODES NOT = SPACES
 14570           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 14571           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 14572           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 14573           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 14574           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 14575
 14576
 14577* EXEC CICS HANDLE CONDITION
 14578*        DUPREC    (6180-DUPREC)
 14579*    END-EXEC.
 14580*    MOVE '"$%                   ! 3 #00013762' TO DFHEIV0
 14581     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14582     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14583     MOVE X'3320233030303133373632' TO DFHEIV0(25:11)
 14584     CALL 'kxdfhei1' USING DFHEIV0
 14585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14586
 14587
 14588
 14589* EXEC CICS WRITE
 14590*         DATASET       ('ELTRLR')
 14591*         FROM          (ACTIVITY-TRAILERS)
 14592*         RIDFLD        (AT-CONTROL-PRIMARY)
 14593*     END-EXEC.
 14594     MOVE LENGTH OF
 14595      ACTIVITY-TRAILERS
 14596       TO DFHEIV11
 14597     MOVE 'ELTRLR' TO DFHEIV1
 14598*    MOVE '&$ L                  ''   #00013766' TO DFHEIV0
 14599     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14600     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14601     MOVE X'2020233030303133373636' TO DFHEIV0(25:11)
 14602     CALL 'kxdfhei1' USING DFHEIV0,
 14603           DFHEIV1,
 14604           ACTIVITY-TRAILERS,
 14605           DFHEIV11,
 14606           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 282
* EL156.cbl
 14607           DFHEIV99,
 14608           DFHEIV99
 14609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14610
 14611
 14612     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 14613        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 14614*06088           GO TO 6199-EXIT.
 14615           GO TO 6176-APPROVAL-NOTE.
 14616
 14617
 14618* EXEC CICS GETMAIN
 14619*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14620*         LENGTH    (200)
 14621*         INITIMG   (GETMAIN-SPACE)
 14622*     END-EXEC.
 14623     MOVE 200
 14624       TO DFHEIV11
 14625*    MOVE ',"IL                  $   #00013777' TO DFHEIV0
 14626     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14627     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14628     MOVE X'2020233030303133373737' TO DFHEIV0(25:11)
 14629     CALL 'kxdfhei1' USING DFHEIV0,
 14630           DFHEIV20,
 14631           DFHEIV11,
 14632           GETMAIN-SPACE
 14633     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14634         DFHEIV20
 14635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14636
 14637
 14638     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14639
 14640     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 14641     MOVE 'AT'                   TO AT-RECORD-ID.
 14642     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 14643     MOVE '6'                    TO AT-TRAILER-TYPE.
 14644     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 14645                                    AT-GEN-INFO-LAST-MAINT-DT
 14646     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 14647                                    AT-GEN-INFO-LAST-UPDATED-BY
 14648     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 14649
 14650     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 14651     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 14652     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 14653
 14654     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 14655
 14656 6175-WRITE.
 14657
 14658
 14659* EXEC CICS HANDLE CONDITION
 14660*        DUPREC    (6190-DUPREC)
 14661*    END-EXEC.
 14662*    MOVE '"$%                   ! 4 #00013803' TO DFHEIV0
 14663     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14664     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 283
* EL156.cbl
 14665     MOVE X'3420233030303133383033' TO DFHEIV0(25:11)
 14666     CALL 'kxdfhei1' USING DFHEIV0
 14667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14668
 14669
 14670
 14671* EXEC CICS WRITE
 14672*         DATASET     ('ELTRLR')
 14673*         FROM        (ACTIVITY-TRAILERS)
 14674*         RIDFLD      (AT-CONTROL-PRIMARY)
 14675*     END-EXEC.
 14676     MOVE LENGTH OF
 14677      ACTIVITY-TRAILERS
 14678       TO DFHEIV11
 14679     MOVE 'ELTRLR' TO DFHEIV1
 14680*    MOVE '&$ L                  ''   #00013807' TO DFHEIV0
 14681     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14682     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14683     MOVE X'2020233030303133383037' TO DFHEIV0(25:11)
 14684     CALL 'kxdfhei1' USING DFHEIV0,
 14685           DFHEIV1,
 14686           ACTIVITY-TRAILERS,
 14687           DFHEIV11,
 14688           AT-CONTROL-PRIMARY,
 14689           DFHEIV99,
 14690           DFHEIV99
 14691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14692
 14693
 14694 6176-APPROVAL-NOTE.
 14695
 14696     IF NOT APPROVAL-NEEDED
 14697         GO TO 6199-EXIT.
 14698
 14699
 14700* EXEC CICS GETMAIN
 14701*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14702*        LENGTH    (200)
 14703*        INITIMG   (GETMAIN-SPACE)
 14704*    END-EXEC.
 14705     MOVE 200
 14706       TO DFHEIV11
 14707*    MOVE ',"IL                  $   #00013818' TO DFHEIV0
 14708     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14709     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14710     MOVE X'2020233030303133383138' TO DFHEIV0(25:11)
 14711     CALL 'kxdfhei1' USING DFHEIV0,
 14712           DFHEIV20,
 14713           DFHEIV11,
 14714           GETMAIN-SPACE
 14715     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14716         DFHEIV20
 14717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14718
 14719
 14720     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 14721
 14722     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 284
* EL156.cbl
 14723     MOVE 'AT'               TO AT-RECORD-ID
 14724     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 14725     MOVE '6'                TO AT-TRAILER-TYPE
 14726     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 14727                                AT-GEN-INFO-LAST-MAINT-DT
 14728     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 14729                                AT-GEN-INFO-LAST-UPDATED-BY
 14730     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 14731
 14732     IF PI-REAUDIT-NEEDED = 'Y'
 14733         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 14734     ELSE
 14735         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 14736     END-IF
 14737     MOVE SPACES             TO AT-INFO-LINE-2
 14738
 14739     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 14740 6177-WRITE.
 14741
 14742
 14743* EXEC CICS HANDLE CONDITION
 14744*        DUPREC    (6185-DUPREC)
 14745*    END-EXEC.
 14746*    MOVE '"$%                   ! 5 #00013846' TO DFHEIV0
 14747     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14748     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14749     MOVE X'3520233030303133383436' TO DFHEIV0(25:11)
 14750     CALL 'kxdfhei1' USING DFHEIV0
 14751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14752
 14753
 14754
 14755* EXEC CICS WRITE
 14756*         DATASET     ('ELTRLR')
 14757*         FROM        (ACTIVITY-TRAILERS)
 14758*         RIDFLD      (AT-CONTROL-PRIMARY)
 14759*     END-EXEC.
 14760     MOVE LENGTH OF
 14761      ACTIVITY-TRAILERS
 14762       TO DFHEIV11
 14763     MOVE 'ELTRLR' TO DFHEIV1
 14764*    MOVE '&$ L                  ''   #00013850' TO DFHEIV0
 14765     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14766     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14767     MOVE X'2020233030303133383530' TO DFHEIV0(25:11)
 14768     CALL 'kxdfhei1' USING DFHEIV0,
 14769           DFHEIV1,
 14770           ACTIVITY-TRAILERS,
 14771           DFHEIV11,
 14772           AT-CONTROL-PRIMARY,
 14773           DFHEIV99,
 14774           DFHEIV99
 14775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14776
 14777
 14778
 14779     GO TO 6199-EXIT.
 14780
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 285
* EL156.cbl
 14781 6180-DUPREC.
 14782
 14783     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14784     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14785     GO TO 6170-WRITE.
 14786
 14787 6185-DUPREC.
 14788     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14789     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14790     GO TO 6177-WRITE.
 14791
 14792 6190-DUPREC.
 14793     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14794     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14795     GO TO 6175-WRITE.
 14796
 14797 6199-EXIT.
 14798      EXIT.
 14799
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 286
* EL156.cbl
 14801 6200-UPDATE-CLAIM-MSTR.
 14802     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14803     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14804     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14805     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14806
 14807     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 14808
 14809     MOVE ZEROS                  TO W-INTEREST.
 14810
 14811     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 14812        IF (PI-OFFLINE = 'Y') OR
 14813           (PI-PMTTYPE = '7')
 14814           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14815                                 THRU 9870-EXIT
 14816        END-IF
 14817     END-IF
 14818     IF NOT ERROR-ON-OUTPUT
 14819        CONTINUE
 14820     ELSE
 14821
 14822* EXEC CICS REWRITE
 14823*          DATASET('ELMSTR')
 14824*          FROM(CLAIM-MASTER)
 14825*       END-EXEC
 14826     MOVE LENGTH OF
 14827      CLAIM-MASTER
 14828       TO DFHEIV11
 14829     MOVE 'ELMSTR' TO DFHEIV1
 14830*    MOVE '&& L                  %   #00013899' TO DFHEIV0
 14831     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14832     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14833     MOVE X'2020233030303133383939' TO DFHEIV0(25:11)
 14834     CALL 'kxdfhei1' USING DFHEIV0,
 14835           DFHEIV1,
 14836           CLAIM-MASTER,
 14837           DFHEIV11,
 14838           DFHEIV99
 14839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14840
 14841        MOVE -1                  TO ENTPFBL
 14842        MOVE AL-UANON            TO ENTPFBA
 14843        MOVE MAP-NAMEB           TO MAP-NAME
 14844        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14845        GO TO 8200-SEND-DATAONLY
 14846     END-IF
 14847
 14848     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 14849
 14850     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 14851
 14852     IF PI-AIG-SPECIAL-BENEFIT
 14853         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 14854
 14855     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 14856
 14857     IF PI-SPECIAL-BEN-SW = 'Y'
 14858         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 287
* EL156.cbl
 14859         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 14860
 14861     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14862         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 14863     ELSE
 14864         IF PI-PMTTYPE NOT = '4'
 14865            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 14866
 14867     IF PI-PMTTYPE = '5' OR '6'
 14868        GO TO  6250-SET-MAINT.
 14869
 14870     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 14871                                         CL-LAG-REPORT-CODE.
 14872
 14873     IF CL-ACTIVITY-CODE = 09
 14874         GO TO 6200-CONT-UPDATE.
 14875
 14876     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14877         IF CL-ACTIVITY-CODE = 11
 14878             GO TO 6200-CONT-UPDATE.
 14879
 14880     IF WS-ACT-REC-FOUND-SW = 'N'
 14881         GO TO 6200-CONT-UPDATE.
 14882
 14883     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 14884         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 14885         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 14886         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 14887
 14888     IF WS-UPDATE-SW = 'Y'
 14889         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 14890                                         CL-NEXT-FOLLOWUP-DT.
 14891
 14892 6200-CONT-UPDATE.
 14893
 14894     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14895       IF CLAIM-IS-CLOSED
 14896         IF PI-PMTTYPE = '2' OR '3' OR '4'
 14897           IF WS-OPEN-CLOSE-SW = '2'
 14898             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 14899                                        CL-LAST-CLOSE-DT.
 14900
 14901     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 14902        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 14903        MOVE 'O'                 TO CL-CLAIM-STATUS.
 14904
 14905     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 14906        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 14907        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 14908        MOVE 'C'                 TO CL-CLAIM-STATUS
 14909        IF PI-PMTTYPE = '2'
 14910           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14911           CONTINUE
 14912        ELSE
 14913           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 14914        END-IF
 14915     ELSE
 14916        IF PI-PMTTYPE = '2' OR '3'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 288
* EL156.cbl
 14917           IF PI-PMTTYPE = '2' AND
 14918              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14919              CONTINUE
 14920           ELSE
 14921              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 14922           END-IF
 14923        END-IF
 14924     END-IF
 14925
 14926     IF PI-PMTTYPE = '4'
 14927        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 14928
 14929     IF PI-COMPANY-ID = 'CVL'
 14930         IF PI-LOAN-UPDATE-SW = 'Y'
 14931             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 14932             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 14933             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 14934             MOVE CL-CERT-STATE      TO  CERT-STATE
 14935             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 14936             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 14937             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 14938             MOVE 'CERT'             TO  FILE-SWITCH
 14939             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 14940             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 14941             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 14942
 14943     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 14944        GO TO 6220-USE-COMPUTED.
 14945
 14946     IF (PI-PMTTYPE = '4')  AND
 14947        (PI-EPYAMT < ZEROS)
 14948          COMPUTE CL-NO-OF-DAYS-PAID =
 14949                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 14950          IF CL-NO-OF-DAYS-PAID < +0
 14951              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 14952          ELSE
 14953              NEXT SENTENCE
 14954     ELSE
 14955          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 14956
 14957     IF PI-PROCESSOR-ID = 'FIX '
 14958        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 14959           NEXT SENTENCE
 14960        ELSE
 14961           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 14962     ELSE
 14963        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 14964
 14965     IF PI-PMTTYPE = '4'
 14966        GO TO 6250-SET-MAINT.
 14967
 14968     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 14969
 14970     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 14971     MOVE '4'                    TO DC-OPTION-CODE.
 14972     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14973     IF DATE-CONVERSION-ERROR
 14974        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 289
* EL156.cbl
 14975     ELSE
 14976        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 14977           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 14978           IF PI-AIG-SPECIAL-BENEFIT
 14979               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 14980           ELSE
 14981               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 14982
 14983     GO TO 6250-SET-MAINT.
 14984
 14985 6220-USE-COMPUTED.
 14986
 14987     IF (PI-PMTTYPE = '4')  AND
 14988        (PI-CPYAMT < ZEROS)
 14989          COMPUTE CL-NO-OF-DAYS-PAID =
 14990                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 14991          IF CL-NO-OF-DAYS-PAID < +0
 14992              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 14993          ELSE
 14994              NEXT SENTENCE
 14995     ELSE
 14996          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 14997
 14998     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 14999
 15000     IF PI-PMTTYPE = '4'
 15001        GO TO 6250-SET-MAINT.
 15002
 15003     IF PI-AIG-SPECIAL-BENEFIT
 15004         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 15005     ELSE
 15006         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 15007
 15008     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 15009
 15010     IF PI-CPYTHRU > CL-PAID-THRU-DT
 15011        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 15012
 15013 6250-SET-MAINT.
 15014     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 15015
 15016     IF PI-PROCESSOR-ID = 'FIX '
 15017        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 15018           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 15019        ELSE
 15020           NEXT SENTENCE
 15021     ELSE
 15022        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 15023
 15024     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 15025     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 15026     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 15027
 15028 6299-EXIT.
 15029      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 290
* EL156.cbl
 15031 6300-UPDATE-CERT.
 15032
 15033*  ADD CERTNOTE FOR SC NP+6
 15034     IF PI-COMPANY-ID = 'CID' AND
 15035       (PI-PMTTYPE = '2' OR '3') AND
 15036        CL-CERT-STATE = 'SC'  AND
 15037        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 15038           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 15039     END-IF.
 15040
 15041     IF PI-COMPANY-ID = 'AHL' AND
 15042       (PI-PMTTYPE = '2' OR '3') AND
 15043        CL-CERT-STATE = 'SC'  AND
 15044        (PI-LF-BENEFIT-CD = '5I' OR '6J')
 15045           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 15046     END-IF.
 15047
 15048     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 15049     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 15050     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 15051     MOVE CL-CERT-STATE    TO CERT-STATE.
 15052     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 15053     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 15054     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 15055     MOVE 'CERT'           TO FILE-SWITCH.
 15056
 15057     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 15058
 15059     IF CERT-NOTE-ADDED
 15060        IF CM-NOTE-SW = ' '
 15061           MOVE '4'             TO CM-NOTE-SW
 15062        ELSE
 15063           IF CM-NOTE-SW = '1'
 15064               MOVE '5'           TO CM-NOTE-SW
 15065           ELSE
 15066              IF CM-NOTE-SW = '2'
 15067                 MOVE '6'         TO CM-NOTE-SW
 15068              ELSE
 15069                 IF CM-NOTE-SW = '3'
 15070                    MOVE '7'      TO CM-NOTE-SW
 15071                 END-IF
 15072              END-IF
 15073           END-IF
 15074        END-IF
 15075     END-IF.
 15076
 15077     IF PI-COMPANY-ID = 'CVL'
 15078         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 15079         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 15080
 15081     IF PI-PMTTYPE NOT = '4'
 15082        GO TO 6340-UPDATE-CERT.
 15083
 15084     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15085        IF PI-PFKEY-USED = DFHPF5
 15086           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 15087        ELSE
 15088           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 291
* EL156.cbl
 15089
 15090*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15091*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 15092*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15093*               PI-LF-COVERAGE-TYPE = 'P'
 15094*                GO TO 6350-REWRITE-CERT.
 15095
 15096     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15097       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15098          PI-LF-COVERAGE-TYPE = 'P'
 15099           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 15100                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 15101                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 15102                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 15103                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 15104                GO TO 6350-REWRITE-CERT
 15105            ELSE
 15106                GO TO 6350-REWRITE-CERT.
 15107
 15108     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15109         GO TO 6350-REWRITE-CERT.
 15110
 15111     IF NOT CM-AH-LUMP-SUM-DISAB
 15112        GO TO 6380-UNLOCK-CERT.
 15113
 15114     IF PI-PFKEY-USED = DFHPF5
 15115        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 15116                                    CM-AH-ITD-AH-PMT
 15117        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 15118        GO TO 6350-REWRITE-CERT
 15119     ELSE
 15120        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 15121                                    CM-AH-ITD-AH-PMT
 15122        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 15123        GO TO 6350-REWRITE-CERT.
 15124
 15125 6340-UPDATE-CERT.
 15126
 15127     IF CL-CLAIM-TYPE = 'L'
 15128         IF PI-PFKEY-USED = DFHPF5
 15129             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 15130         ELSE
 15131             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 15132
 15133     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15134         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 15135             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15136                PI-LF-COVERAGE-TYPE = 'P'
 15137                 GO TO 6350-REWRITE-CERT.
 15138
 15139     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15140       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15141          PI-LF-COVERAGE-TYPE = 'P'
 15142           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 15143                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 15144                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 15145                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 15146                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 292
* EL156.cbl
 15147                GO TO 6350-REWRITE-CERT.
 15148
 15149     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15150         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 15151            PI-LF-COVERAGE-TYPE NOT = 'P'
 15152             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 15153             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 15154             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 15155             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 15156             GO TO 6350-REWRITE-CERT.
 15157
 15158     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 15159         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 15160         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 15161         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 15162         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 15163         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 15164         IF PI-PFKEY-USED = DFHPF5
 15165             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 15166                                        CM-AH-ITD-AH-PMT
 15167             GO TO 6350-REWRITE-CERT
 15168         ELSE
 15169             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 15170                                        CM-AH-ITD-AH-PMT
 15171             GO TO 6350-REWRITE-CERT.
 15172
 15173 6350-REWRITE-CERT.
 15174
 15175
 15176* EXEC CICS REWRITE
 15177*         DATASET  ('ELCERT')
 15178*         FROM(CERTIFICATE-MASTER)
 15179*     END-EXEC.
 15180     MOVE LENGTH OF
 15181      CERTIFICATE-MASTER
 15182       TO DFHEIV11
 15183     MOVE 'ELCERT' TO DFHEIV1
 15184*    MOVE '&& L                  %   #00014238' TO DFHEIV0
 15185     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15186     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15187     MOVE X'2020233030303134323338' TO DFHEIV0(25:11)
 15188     CALL 'kxdfhei1' USING DFHEIV0,
 15189           DFHEIV1,
 15190           CERTIFICATE-MASTER,
 15191           DFHEIV11,
 15192           DFHEIV99
 15193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15194
 15195
 15196     GO TO 6399-EXIT.
 15197
 15198 6380-UNLOCK-CERT.
 15199
 15200* EXEC CICS UNLOCK
 15201*         DATASET  ('ELCERT')
 15202*     END-EXEC.
 15203     MOVE 'ELCERT' TO DFHEIV1
 15204*    MOVE '&*                    #   #00014246' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 293
* EL156.cbl
 15205     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 15206     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15207     MOVE X'2020233030303134323436' TO DFHEIV0(25:11)
 15208     CALL 'kxdfhei1' USING DFHEIV0,
 15209           DFHEIV1,
 15210           DFHEIV99
 15211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15212
 15213
 15214 6399-EXIT.
 15215      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 294
* EL156.cbl
 15217 6400-UPDATE-ZERO-TRAILER.
 15218     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 15219     MOVE ZEROS                  TO TRLR-SEQ-NO.
 15220
 15221     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 15222
 15223     IF PI-EPYAMT NOT = ZEROS
 15224         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 15225     ELSE
 15226         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 15227
 15228     IF PI-ERESV NOT = ZEROS
 15229        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 15230
 15231     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 15232        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 15233
 15234     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 15235        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 15236     ELSE
 15237        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 15238
 15239     IF PI-PMTTYPE = '5'
 15240        IF PI-EPYAMT = ZEROS
 15241           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 15242        ELSE
 15243           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 15244
 15245     IF PI-PMTTYPE = '6'
 15246        IF PI-EPYAMT = ZEROS
 15247           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 15248        ELSE
 15249           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 15250
 15251 6420-CHECK-OPEN-CLOSE.
 15252     IF PI-PMTTYPE = '5' OR '6'
 15253        GO TO 6450-REWRITE.
 15254
 15255     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15256         IF PI-PMTTYPE = '2' OR '3' OR '4'
 15257             IF CLAIM-IS-CLOSED
 15258                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 15259                 MOVE 1          TO  SUB-1
 15260                 GO TO 6440-AIG-LOOP.
 15261
 15262     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 15263        GO TO 6450-REWRITE.
 15264
 15265     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 15266        GO TO 6450-REWRITE.
 15267
 15268     MOVE 1                      TO SUB-1.
 15269
 15270 6430-LOOP.
 15271     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 15272        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 15273        IF PI-PMTTYPE = '1' OR '4'
 15274           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 295
* EL156.cbl
 15275           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 15276           GO TO 6450-REWRITE
 15277        ELSE
 15278           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 15279           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 15280           GO TO 6450-REWRITE.
 15281
 15282     IF SUB-1 = 6
 15283      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 15284      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 15285      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 15286      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 15287      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 15288      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 15289      GO TO 6430-LOOP.
 15290
 15291     ADD 1                       TO SUB-1.
 15292     GO TO 6430-LOOP.
 15293
 15294
 15295 6440-AIG-LOOP.
 15296
 15297     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 15298       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 15299       IF WS-OPEN-CLOSE-SW = '1'
 15300         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 15301         IF PI-PMTTYPE = '2'
 15302           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15303           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 15304         ELSE
 15305           IF PI-PMTTYPE = '3'
 15306             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15307             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 15308           ELSE
 15309             IF PI-PMTTYPE = '4'
 15310               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15311               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 15312             ELSE
 15313               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15314               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 15315       ELSE
 15316         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 15317         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15318         GO TO 6450-REWRITE.
 15319
 15320     IF SUB-1 = 6
 15321      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 15322      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 15323      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 15324      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 15325      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 15326      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 15327      GO TO 6440-AIG-LOOP.
 15328
 15329     ADD 1                       TO SUB-1.
 15330     GO TO 6440-AIG-LOOP.
 15331
 15332 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 296
* EL156.cbl
 15333     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 15334     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 15335     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 15336
 15337     IF PI-COMPANY-ID = 'DMD'
 15338         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15339         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15340         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15341         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15342         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15343
 15344
 15345* EXEC CICS REWRITE
 15346*         DATASET  ('ELTRLR')
 15347*         FROM     (ACTIVITY-TRAILERS)
 15348*     END-EXEC.
 15349     MOVE LENGTH OF
 15350      ACTIVITY-TRAILERS
 15351       TO DFHEIV11
 15352     MOVE 'ELTRLR' TO DFHEIV1
 15353*    MOVE '&& L                  %   #00014380' TO DFHEIV0
 15354     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15355     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15356     MOVE X'2020233030303134333830' TO DFHEIV0(25:11)
 15357     CALL 'kxdfhei1' USING DFHEIV0,
 15358           DFHEIV1,
 15359           ACTIVITY-TRAILERS,
 15360           DFHEIV11,
 15361           DFHEIV99
 15362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15363
 15364
 15365 6499-EXIT.
 15366      EXIT.
 15367
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 297
* EL156.cbl
 15369 6500-READ-DLO035.
 15370     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 15371     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 15372     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 15373     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 15374
 15375
 15376* EXEC CICS LINK
 15377*        PROGRAM    ('DLO035')
 15378*        COMMAREA   (DLO035-KEY)
 15379*        LENGTH     (DL35-LENGTH)
 15380*    END-EXEC.
 15381     MOVE 'DLO035' TO DFHEIV1
 15382*    MOVE '."C                   (   #00014395' TO DFHEIV0
 15383     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15384     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15385     MOVE X'2020233030303134333935' TO DFHEIV0(25:11)
 15386     CALL 'kxdfhei1' USING DFHEIV0,
 15387           DFHEIV1,
 15388           DLO035-KEY,
 15389           DL35-LENGTH,
 15390           DFHEIV99,
 15391           DFHEIV99,
 15392           DFHEIV99,
 15393           DFHEIV99
 15394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15395
 15396
 15397     IF DL35-RETURN-CODE = 'OK'
 15398         GO TO 6500-EXIT.
 15399
 15400     IF DL35-RETURN-CODE = '01'
 15401         MOVE ER-7830            TO EMI-ERROR
 15402         GO TO 6500-BAD-EXIT.
 15403
 15404     IF DL35-RETURN-CODE = '02'
 15405         MOVE ER-7831            TO EMI-ERROR
 15406         GO TO 6500-BAD-EXIT.
 15407
 15408     IF DL35-RETURN-CODE = '03'
 15409         MOVE ER-7832            TO EMI-ERROR
 15410         GO TO 6500-BAD-EXIT.
 15411
 15412     IF DL35-RETURN-CODE = '04'
 15413         MOVE ER-7833            TO EMI-ERROR
 15414         GO TO 6500-BAD-EXIT.
 15415
 15416     IF DL35-RETURN-CODE = '05'
 15417         MOVE ER-7834            TO EMI-ERROR
 15418         GO TO 6500-BAD-EXIT.
 15419
 15420     IF DL35-RETURN-CODE = '06'
 15421         MOVE ER-7835            TO EMI-ERROR
 15422         GO TO 6500-BAD-EXIT.
 15423
 15424     IF DL35-RETURN-CODE = '07'
 15425         MOVE ER-7836            TO EMI-ERROR
 15426         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 298
* EL156.cbl
 15427
 15428     IF DL35-RETURN-CODE = 'E1'
 15429         MOVE ER-7837            TO EMI-ERROR
 15430         GO TO 6500-BAD-EXIT.
 15431
 15432     IF DL35-RETURN-CODE NOT = 'OK'
 15433         MOVE ER-7838            TO EMI-ERROR
 15434         GO TO 6500-BAD-EXIT.
 15435
 15436 6500-EXIT.
 15437      EXIT.
 15438
 15439 6500-BAD-EXIT.
 15440
 15441* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15442*    MOVE '6"R                   !   #00014444' TO DFHEIV0
 15443     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15444     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15445     MOVE X'2020233030303134343434' TO DFHEIV0(25:11)
 15446     CALL 'kxdfhei1' USING DFHEIV0
 15447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15448
 15449     MOVE -1                 TO PMTTYPEL.
 15450     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15451     GO TO 8200-SEND-DATAONLY.
 15452
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 299
* EL156.cbl
 15454 6600-UPDATE-DLO035.
 15455     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 15456     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 15457     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 15458     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 15459
 15460
 15461* EXEC CICS LINK
 15462*        PROGRAM    ('DLO035')
 15463*        COMMAREA   (DLO035-KEY)
 15464*        LENGTH     (DL35-LENGTH)
 15465*    END-EXEC.
 15466     MOVE 'DLO035' TO DFHEIV1
 15467*    MOVE '."C                   (   #00014456' TO DFHEIV0
 15468     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15469     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15470     MOVE X'2020233030303134343536' TO DFHEIV0(25:11)
 15471     CALL 'kxdfhei1' USING DFHEIV0,
 15472           DFHEIV1,
 15473           DLO035-KEY,
 15474           DL35-LENGTH,
 15475           DFHEIV99,
 15476           DFHEIV99,
 15477           DFHEIV99,
 15478           DFHEIV99
 15479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15480
 15481
 15482     IF DL35-RETURN-CODE = 'OK'
 15483         GO TO 6600-EXIT.
 15484
 15485     IF DL35-RETURN-CODE = '01'
 15486         MOVE ER-7830            TO EMI-ERROR
 15487         GO TO 6500-BAD-EXIT.
 15488
 15489     IF DL35-RETURN-CODE = '02'
 15490         MOVE ER-7831            TO EMI-ERROR
 15491         GO TO 6500-BAD-EXIT.
 15492
 15493     IF DL35-RETURN-CODE = '03'
 15494         MOVE ER-7832            TO EMI-ERROR
 15495         GO TO 6500-BAD-EXIT.
 15496
 15497     IF DL35-RETURN-CODE = '04'
 15498         MOVE ER-7833            TO EMI-ERROR
 15499         GO TO 6500-BAD-EXIT.
 15500
 15501     IF DL35-RETURN-CODE = '05'
 15502         MOVE ER-7834            TO EMI-ERROR
 15503         GO TO 6500-BAD-EXIT.
 15504
 15505     IF DL35-RETURN-CODE = '06'
 15506         MOVE ER-7835            TO EMI-ERROR
 15507         GO TO 6500-BAD-EXIT.
 15508
 15509     IF DL35-RETURN-CODE = '07'
 15510         MOVE ER-7836            TO EMI-ERROR
 15511         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 300
* EL156.cbl
 15512
 15513     IF DL35-RETURN-CODE = 'E1'
 15514         MOVE ER-7837            TO EMI-ERROR
 15515         GO TO 6500-BAD-EXIT.
 15516
 15517     IF DL35-RETURN-CODE NOT = 'OK'
 15518         MOVE ER-7838            TO EMI-ERROR
 15519         GO TO 6500-BAD-EXIT.
 15520
 15521 6600-EXIT.
 15522      EXIT.
 15523
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 301
* EL156.cbl
 15525 6700-UPDATE-ACTQ.
 15526***************************************************************
 15527*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 15528*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 15529*    ONE ALREADY THERE.                                       *
 15530***************************************************************
 15531
 15532
 15533* EXEC CICS HANDLE CONDITION
 15534*         NOTFND(6720-BUILD-NEW-RECORD)
 15535*     END-EXEC.
 15536*    MOVE '"$I                   ! 6 #00014512' TO DFHEIV0
 15537     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15538     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15539     MOVE X'3620233030303134353132' TO DFHEIV0(25:11)
 15540     CALL 'kxdfhei1' USING DFHEIV0
 15541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15542
 15543
 15544
 15545* EXEC CICS READ
 15546*         DATASET('ELACTQ')
 15547*         RIDFLD (ELMSTR-KEY)
 15548*         SET    (ADDRESS OF ACTIVITY-QUE)
 15549*         UPDATE
 15550*     END-EXEC.
 15551     MOVE 'ELACTQ' TO DFHEIV1
 15552*    MOVE '&"S        EU         (   #00014516' TO DFHEIV0
 15553     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15554     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15555     MOVE X'2020233030303134353136' TO DFHEIV0(25:11)
 15556     CALL 'kxdfhei1' USING DFHEIV0,
 15557           DFHEIV1,
 15558           DFHEIV20,
 15559           DFHEIV99,
 15560           ELMSTR-KEY,
 15561           DFHEIV99,
 15562           DFHEIV99,
 15563           DFHEIV99
 15564     SET ADDRESS OF ACTIVITY-QUE TO
 15565         DFHEIV20
 15566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15567
 15568
 15569     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 15570
 15571     IF PI-AIG-SPECIAL-BENEFIT AND
 15572        PI-CASH = 'Y'
 15573         ADD 2                   TO AQ-PAYMENT-COUNTER
 15574     ELSE
 15575         ADD 1                   TO AQ-PAYMENT-COUNTER.
 15576
 15577     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 15578         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 15579
 15580     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 15581
 15582     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 302
* EL156.cbl
 15583         IF WS-PMT-APPROVAL-SW = 'A'
 15584             NEXT SENTENCE
 15585         ELSE
 15586            IF PI-AIG-SPECIAL-BENEFIT AND
 15587               PI-CASH = 'Y'
 15588                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15589                                     WS-PMT-UNAPPROVED-CNT
 15590            ELSE
 15591                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15592                                     WS-PMT-UNAPPROVED-CNT
 15593     ELSE
 15594         IF PI-PMT-APPR-SW = 'Y'
 15595            IF PI-AIG-SPECIAL-BENEFIT AND
 15596               PI-CASH = 'Y'
 15597                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15598                                     WS-PMT-UNAPPROVED-CNT
 15599            ELSE
 15600                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15601                                     WS-PMT-UNAPPROVED-CNT.
 15602
 15603     IF WS-PMT-UNAPPROVED-CNT > ZERO
 15604         MOVE ER-3536 TO EMI-ERROR
 15605         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15606
 15607     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 15608
 15609
 15610* EXEC CICS REWRITE
 15611*         DATASET('ELACTQ')
 15612*         FROM   (ACTIVITY-QUE)
 15613*     END-EXEC.
 15614     MOVE LENGTH OF
 15615      ACTIVITY-QUE
 15616       TO DFHEIV11
 15617     MOVE 'ELACTQ' TO DFHEIV1
 15618*    MOVE '&& L                  %   #00014563' TO DFHEIV0
 15619     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15620     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15621     MOVE X'2020233030303134353633' TO DFHEIV0(25:11)
 15622     CALL 'kxdfhei1' USING DFHEIV0,
 15623           DFHEIV1,
 15624           ACTIVITY-QUE,
 15625           DFHEIV11,
 15626           DFHEIV99
 15627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15628
 15629
 15630     GO TO 6799-EXIT.
 15631
 15632 6720-BUILD-NEW-RECORD.
 15633
 15634* EXEC CICS GETMAIN
 15635*         SET    (ADDRESS OF ACTIVITY-QUE)
 15636*         LENGTH (60)
 15637*         INITIMG(GETMAIN-SPACE)
 15638*     END-EXEC.
 15639     MOVE 60
 15640       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 303
* EL156.cbl
 15641*    MOVE ',"IL                  $   #00014571' TO DFHEIV0
 15642     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15643     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15644     MOVE X'2020233030303134353731' TO DFHEIV0(25:11)
 15645     CALL 'kxdfhei1' USING DFHEIV0,
 15646           DFHEIV20,
 15647           DFHEIV11,
 15648           GETMAIN-SPACE
 15649     SET ADDRESS OF ACTIVITY-QUE TO
 15650         DFHEIV20
 15651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15652
 15653
 15654     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 15655
 15656     IF PI-AIG-SPECIAL-BENEFIT AND
 15657        PI-CASH = 'Y'
 15658         MOVE 2                  TO AQ-PAYMENT-COUNTER
 15659     ELSE
 15660         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 15661
 15662     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 15663     MOVE 'AQ'                   TO AQ-RECORD-ID.
 15664     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 15665     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 15666                                    AQ-FOLLOWUP-DATE.
 15667     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 15668     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 15669
 15670     IF PI-PMT-GRADUATED
 15671         IF WS-PMT-APPROVAL-SW = 'A'
 15672             NEXT SENTENCE
 15673         ELSE
 15674            IF PI-AIG-SPECIAL-BENEFIT AND
 15675               PI-CASH = 'Y'
 15676                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15677            ELSE
 15678                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15679     ELSE
 15680         IF PI-PMT-APPR-SW = 'Y'
 15681            IF PI-AIG-SPECIAL-BENEFIT AND
 15682               PI-CASH = 'Y'
 15683                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15684            ELSE
 15685                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 15686
 15687     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 15688         MOVE ER-3536 TO EMI-ERROR
 15689         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15690
 15691
 15692* EXEC CICS WRITE
 15693*         DATASET('ELACTQ')
 15694*         RIDFLD (ELMSTR-KEY)
 15695*         FROM   (ACTIVITY-QUE)
 15696*     END-EXEC.
 15697     MOVE LENGTH OF
 15698      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 304
* EL156.cbl
 15699       TO DFHEIV11
 15700     MOVE 'ELACTQ' TO DFHEIV1
 15701*    MOVE '&$ L                  ''   #00014614' TO DFHEIV0
 15702     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15703     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15704     MOVE X'2020233030303134363134' TO DFHEIV0(25:11)
 15705     CALL 'kxdfhei1' USING DFHEIV0,
 15706           DFHEIV1,
 15707           ACTIVITY-QUE,
 15708           DFHEIV11,
 15709           ELMSTR-KEY,
 15710           DFHEIV99,
 15711           DFHEIV99
 15712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15713
 15714
 15715 6799-EXIT.
 15716      EXIT.
 15717
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 305
* EL156.cbl
 15719 6800-BUILD-FORM-TRAILER.
 15720
 15721
 15722* EXEC CICS GETMAIN
 15723*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15724*         LENGTH   (200)
 15725*         INITIMG  (GETMAIN-SPACE)
 15726*    END-EXEC.
 15727     MOVE 200
 15728       TO DFHEIV11
 15729*    MOVE ',"IL                  $   #00014626' TO DFHEIV0
 15730     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15731     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15732     MOVE X'2020233030303134363236' TO DFHEIV0(25:11)
 15733     CALL 'kxdfhei1' USING DFHEIV0,
 15734           DFHEIV20,
 15735           DFHEIV11,
 15736           GETMAIN-SPACE
 15737     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15738         DFHEIV20
 15739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15740
 15741
 15742     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 15743
 15744     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 15745     MOVE 'AT'                   TO AT-RECORD-ID.
 15746     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15747
 15748     MOVE 'A'                    TO AT-TRAILER-TYPE.
 15749     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15750                                    AT-FORM-LAST-MAINT-DT
 15751                                    AT-FORM-SEND-ON-DT.
 15752     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15753                                    AT-FORM-LAST-UPDATED-BY.
 15754     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15755     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 15756     MOVE '6'                    TO DC-OPTION-CODE.
 15757     MOVE +29                    TO DC-ELAPSED-DAYS.
 15758     MOVE +0                     TO DC-ELAPSED-MONTHS.
 15759     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15760     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 15761
 15762     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 15763         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 15764
 15765     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 15766                                    AT-FORM-RE-SEND-DT
 15767                                    AT-EMP-FORM-ANSWERED-DT
 15768                                    AT-PHY-FORM-ANSWERED-DT
 15769                                    AT-EMP-FORM-SEND-ON-DT
 15770                                    AT-PHY-FORM-SEND-ON-DT
 15771                                    AT-FORM-PRINTED-DT
 15772                                    AT-FORM-REPRINT-DT.
 15773     MOVE '2'                    TO AT-FORM-TYPE.
 15774
 15775     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 15776     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 306
* EL156.cbl
 15777
 15778     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 15779         NEXT SENTENCE
 15780     ELSE
 15781         IF CL-PROG-FORM-TYPE NOT = 'S'
 15782            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 15783
 15784
 15785* EXEC CICS WRITE
 15786*         DATASET  ('ELTRLR')
 15787*         FROM     (ACTIVITY-TRAILERS)
 15788*         RIDFLD   (AT-CONTROL-PRIMARY)
 15789*     END-EXEC.
 15790     MOVE LENGTH OF
 15791      ACTIVITY-TRAILERS
 15792       TO DFHEIV11
 15793     MOVE 'ELTRLR' TO DFHEIV1
 15794*    MOVE '&$ L                  ''   #00014674' TO DFHEIV0
 15795     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15796     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15797     MOVE X'2020233030303134363734' TO DFHEIV0(25:11)
 15798     CALL 'kxdfhei1' USING DFHEIV0,
 15799           DFHEIV1,
 15800           ACTIVITY-TRAILERS,
 15801           DFHEIV11,
 15802           AT-CONTROL-PRIMARY,
 15803           DFHEIV99,
 15804           DFHEIV99
 15805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15806
 15807
 15808 6899-EXIT.
 15809      EXIT.
 15810
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 307
* EL156.cbl
 15812 6900-BUILD-ARCHIVE-HEADER.
 15813
 15814     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15815     MOVE '1'                    TO CNTL-REC-TYPE.
 15816     MOVE +0                     TO CNTL-SEQ-NO.
 15817     MOVE SPACES                 TO CNTL-ACCESS.
 15818
 15819
 15820* EXEC CICS READ
 15821*         DATASET  ('ELCNTL')
 15822*         SET      (ADDRESS OF CONTROL-FILE)
 15823*         RIDFLD   (ELCNTL-KEY)
 15824*         UPDATE
 15825*    END-EXEC.
 15826     MOVE 'ELCNTL' TO DFHEIV1
 15827*    MOVE '&"S        EU         (   #00014691' TO DFHEIV0
 15828     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15829     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15830     MOVE X'2020233030303134363931' TO DFHEIV0(25:11)
 15831     CALL 'kxdfhei1' USING DFHEIV0,
 15832           DFHEIV1,
 15833           DFHEIV20,
 15834           DFHEIV99,
 15835           ELCNTL-KEY,
 15836           DFHEIV99,
 15837           DFHEIV99,
 15838           DFHEIV99
 15839     SET ADDRESS OF CONTROL-FILE TO
 15840         DFHEIV20
 15841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15842
 15843
 15844     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 15845     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 15846
 15847
 15848* EXEC CICS REWRITE
 15849*         FROM     (CONTROL-FILE)
 15850*         DATASET  ('ELCNTL')
 15851*    END-EXEC.
 15852     MOVE LENGTH OF
 15853      CONTROL-FILE
 15854       TO DFHEIV11
 15855     MOVE 'ELCNTL' TO DFHEIV1
 15856*    MOVE '&& L                  %   #00014701' TO DFHEIV0
 15857     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15858     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15859     MOVE X'2020233030303134373031' TO DFHEIV0(25:11)
 15860     CALL 'kxdfhei1' USING DFHEIV0,
 15861           DFHEIV1,
 15862           CONTROL-FILE,
 15863           DFHEIV11,
 15864           DFHEIV99
 15865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15866
 15867
 15868
 15869* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 308
* EL156.cbl
 15870*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 15871*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 15872*    END-EXEC.
 15873*    MOVE '"$$%                  ! 7 #00014706' TO DFHEIV0
 15874     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 15875     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15876     MOVE X'3720233030303134373036' TO DFHEIV0(25:11)
 15877     CALL 'kxdfhei1' USING DFHEIV0
 15878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15879
 15880
 15881
 15882* EXEC CICS GETMAIN
 15883*         SET     (ADDRESS OF LETTER-ARCHIVE)
 15884*         LENGTH  (ELARCH-LENGTH)
 15885*         INITIMG (GETMAIN-SPACE)
 15886*    END-EXEC.
 15887*    MOVE ',"IL                  $   #00014711' TO DFHEIV0
 15888     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15889     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15890     MOVE X'2020233030303134373131' TO DFHEIV0(25:11)
 15891     CALL 'kxdfhei1' USING DFHEIV0,
 15892           DFHEIV20,
 15893           ELARCH-LENGTH,
 15894           GETMAIN-SPACE
 15895     SET ADDRESS OF LETTER-ARCHIVE TO
 15896         DFHEIV20
 15897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15898
 15899
 15900     MOVE 'LA'                   TO LA-RECORD-ID.
 15901     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 15902                                    LA-ARCHIVE-NO-A1.
 15903     MOVE '4'                    TO LA-RECORD-TYPE
 15904                                    LA-RECORD-TYPE-A1.
 15905     MOVE +0                     TO LA-LINE-SEQ-NO
 15906                                    LA-LINE-SEQ-NO-A1.
 15907     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 15908                                    LA-COMPANY-CD-A1.
 15909     MOVE CL-CARRIER             TO LA4-CARRIER.
 15910     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 15911     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 15912     MOVE CL-CERT-STATE          TO LA4-STATE.
 15913     MOVE +0                     TO LA4-NO-OF-COPIES.
 15914     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 15915     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 15916     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 15917                                    LA4-INITIAL-PRINT-DATE
 15918                                    LA4-RESEND-PRINT-DATE
 15919                                    LA4-FORM-REM-PRINT-DT.
 15920     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 15921     MOVE '2'                    TO LA4-FORM-TYPE.
 15922
 15923
 15924* EXEC CICS WRITE
 15925*         DATASET  ('ELARCH')
 15926*         FROM     (LETTER-ARCHIVE)
 15927*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 309
* EL156.cbl
 15928*    END-EXEC.
 15929     MOVE LENGTH OF
 15930      LETTER-ARCHIVE
 15931       TO DFHEIV11
 15932     MOVE 'ELARCH' TO DFHEIV1
 15933*    MOVE '&$ L                  ''   #00014740' TO DFHEIV0
 15934     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15935     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15936     MOVE X'2020233030303134373430' TO DFHEIV0(25:11)
 15937     CALL 'kxdfhei1' USING DFHEIV0,
 15938           DFHEIV1,
 15939           LETTER-ARCHIVE,
 15940           DFHEIV11,
 15941           LA-CONTROL-PRIMARY,
 15942           DFHEIV99,
 15943           DFHEIV99
 15944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15945
 15946
 15947 6999-EXIT.
 15948      EXIT.
 15949
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 310
* EL156.cbl
 15951 7000-SHOW-CLAIM.
 15952     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 15953     MOVE 'A'                    TO PI-PASS-SW.
 15954     MOVE LOW-VALUES             TO PI-CPYFROM
 15955                                    PI-MONTH-END-SAVE
 15956                                    PI-CPYTHRU.
 15957
 15958     MOVE ZEROS                  TO PI-FATAL-COUNT
 15959                                    PI-DAILY-RATE
 15960                                    PI-BEN-DAYS
 15961                                    PI-MANUAL-SW
 15962                                    PI-SAVE-CURSOR
 15963                                    PI-FORCE-COUNT
 15964                                    PI-HOLDTIL
 15965                                    PI-EPYFROM
 15966                                    PI-EPYTHRU
 15967                                    PI-EDAYS
 15968                                    PI-EPYAMT
 15969                                    PI-ERESV
 15970                                    PI-EEXPENS
 15971                                    PI-CDAYS
 15972                                    PI-CPYAMT
 15973                                    PI-CRESV
 15974                                    PI-CEXPENS
 15975                                    PI-INT-RATE
 15976                                    PI-AIGFROM.
 15977     MOVE ZEROS                  TO PI-PROOF-DATE.
 15978     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 15979                                    PI-REM-BEN-AMT
 15980                                    PI-MO-BEN-AMT.
 15981
 15982     MOVE LOW-VALUES             TO EL156AI.
 15983     MOVE MAP-NAMEA              TO MAP-NAME.
 15984
 15985
 15986
 15987* EXEC CICS HANDLE CONDITION
 15988*        NOTFND   (7010-BUILD-MAP)
 15989*    END-EXEC.
 15990*    MOVE '"$I                   ! 8 #00014785' TO DFHEIV0
 15991     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15992     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15993     MOVE X'3820233030303134373835' TO DFHEIV0(25:11)
 15994     CALL 'kxdfhei1' USING DFHEIV0
 15995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15996
 15997
 15998     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15999     MOVE '2'                    TO CNTL-REC-TYPE.
 16000     MOVE +0                     TO CNTL-SEQ-NO.
 16001     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 16002
 16003
 16004* EXEC CICS READ
 16005*         DATASET  ('ELCNTL')
 16006*         SET      (ADDRESS OF CONTROL-FILE)
 16007*         RIDFLD   (ELCNTL-KEY)
 16008*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 311
* EL156.cbl
 16009     MOVE 'ELCNTL' TO DFHEIV1
 16010*    MOVE '&"S        E          (   #00014794' TO DFHEIV0
 16011     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16012     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16013     MOVE X'2020233030303134373934' TO DFHEIV0(25:11)
 16014     CALL 'kxdfhei1' USING DFHEIV0,
 16015           DFHEIV1,
 16016           DFHEIV20,
 16017           DFHEIV99,
 16018           ELCNTL-KEY,
 16019           DFHEIV99,
 16020           DFHEIV99,
 16021           DFHEIV99
 16022     SET ADDRESS OF CONTROL-FILE TO
 16023         DFHEIV20
 16024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16025
 16026
 16027     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 16028
 16029     IF PI-APPROVAL-LEVEL = '4'
 16030         MOVE AL-UANON      TO SURVYYNA
 16031     END-IF.
 16032
 16033     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16034     MOVE '1'                    TO CNTL-REC-TYPE.
 16035     MOVE SPACES                 TO CNTL-ACCESS.
 16036     MOVE +0                     TO CNTL-SEQ-NO.
 16037
 16038
 16039* EXEC CICS READ
 16040*         DATASET  ('ELCNTL')
 16041*         SET      (ADDRESS OF CONTROL-FILE)
 16042*         RIDFLD   (ELCNTL-KEY)
 16043*    END-EXEC.
 16044     MOVE 'ELCNTL' TO DFHEIV1
 16045*    MOVE '&"S        E          (   #00014811' TO DFHEIV0
 16046     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16047     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16048     MOVE X'2020233030303134383131' TO DFHEIV0(25:11)
 16049     CALL 'kxdfhei1' USING DFHEIV0,
 16050           DFHEIV1,
 16051           DFHEIV20,
 16052           DFHEIV99,
 16053           ELCNTL-KEY,
 16054           DFHEIV99,
 16055           DFHEIV99,
 16056           DFHEIV99
 16057     SET ADDRESS OF CONTROL-FILE TO
 16058         DFHEIV20
 16059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16060
 16061
 16062     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 16063
 16064 7010-BUILD-MAP.
 16065
 16066
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 312
* EL156.cbl
 16067* EXEC CICS HANDLE CONDITION
 16068*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 16069*    END-EXEC.
 16070*    MOVE '"$I                   ! 9 #00014821' TO DFHEIV0
 16071     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16072     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16073     MOVE X'3920233030303134383231' TO DFHEIV0(25:11)
 16074     CALL 'kxdfhei1' USING DFHEIV0
 16075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16076
 16077
 16078     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16079     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16080     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16081     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16082     MOVE 'MSTR'                 TO FILE-SWITCH.
 16083
 16084     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 16085
 16086     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 16087     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 16088     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 16089     MOVE CL-CCN                 TO PI-SV-CCN.
 16090
 16091     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 16092     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 16093     MOVE CL-CLAIM-NO            TO CLMNOO.
 16094     MOVE CL-CARRIER             TO CARRO.
 16095     MOVE CL-CERT-PRIME          TO CERTNOO.
 16096     MOVE CL-CERT-SFX            TO SUFXO.
 16097
 16098     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 16099        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 16100        CONTINUE
 16101     ELSE
 16102        MOVE AL-SADOF            TO ZINTHA
 16103                                    ZINTA
 16104                                    PINTHA
 16105                                    PINTA
 16106     END-IF
 16107     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 16108     EVALUATE TRUE
 16109     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 16110         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 16111     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16112         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 16113
 16114     WHEN CL-CLAIM-TYPE = 'I'
 16115         MOVE '  IU  '           TO CLMTYPO
 16116     WHEN CL-CLAIM-TYPE = 'G'
 16117         MOVE ' GAP  '           TO CLMTYPO
 16118     END-EVALUATE.
 16119     IF CLAIM-IS-OPEN
 16120         MOVE ' OPEN'            TO CLMSTATO
 16121     ELSE
 16122         MOVE 'CLOSED'           TO CLMSTATO.
 16123
 16124     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 313
* EL156.cbl
 16125
 16126     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 16127         MOVE SPACES             TO  PCERTNOO
 16128                                     PSUFXO
 16129                                     PRIMHDGO
 16130                                     SEQUO
 16131         MOVE AL-SADOF           TO  PCERTNOA
 16132                                     PSUFXA
 16133                                     PRIMHDGA
 16134                                     SEQUA
 16135     ELSE
 16136         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 16137         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 16138         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 16139         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 16140         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 16141         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 16142         MOVE AL-SANON               TO  PCERTNOA
 16143                                         PSUFXA
 16144                                         PRIMHDGA
 16145         MOVE AL-SABON               TO  SEQUA.
 16146
 16147     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 16148
 16149     IF CL-NO-OF-PMTS-MADE = 0 AND
 16150        CL-TOTAL-PAID-AMT = 0
 16151         NEXT SENTENCE
 16152     ELSE
 16153         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 16154             IF NOT PI-USES-PAID-TO
 16155                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 16156                 MOVE ' '                 TO DC-OPTION-CODE
 16157                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16158                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 16159             ELSE
 16160                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 16161                 MOVE '6'                 TO DC-OPTION-CODE
 16162                 MOVE +1                  TO DC-ELAPSED-DAYS
 16163                 MOVE +0                  TO DC-ELAPSED-MONTHS
 16164                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16165                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 16166
 16167     IF MAP-NAME = 'EL156A'
 16168     IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 16169        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16170          MOVE AL-SADOF TO    AIGFRMHA AIGFROMA.
 16171
 16172     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 16173         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 16174         MOVE ' '                TO DC-OPTION-CODE
 16175         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16176         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 16177
 16178     IF CL-INCURRED-DT NOT = LOW-VALUES
 16179         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 16180         MOVE ' '                TO DC-OPTION-CODE
 16181         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16182         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 314
* EL156.cbl
 16183
 16184     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 16185
 16186     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 16187         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 16188         MOVE ' '                TO DC-OPTION-CODE
 16189         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16190         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 16191
 16192     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16193         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 16194         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 16195     ELSE
 16196         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 16197         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 16198
 16199     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 16200     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 16201     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 16202     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 16203                                    PI-GROUPING.
 16204     MOVE CL-CERT-STATE          TO CERT-STATE
 16205                                    PI-STATE.
 16206     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 16207                                    PI-ACCOUNT.
 16208     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 16209     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 16210     MOVE 'CERT'                 TO FILE-SWITCH.
 16211
 16212     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 16213
 16214     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16215     MOVE PI-STATE               TO WS-ST-ACCESS.
 16216     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 16217     MOVE '3'                    TO CNTL-REC-TYPE.
 16218     MOVE +0                     TO CNTL-SEQ-NO.
 16219     MOVE 'STAT'                 TO FILE-SWITCH.
 16220
 16221     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 16222
 16223     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 16224     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 16225
 16226     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16227        GO TO 7020-BYPASS-BENEFIT.
 16228
 16229     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16230     MOVE '4'                    TO CNTL-REC-TYPE.
 16231     MOVE +0                     TO CNTL-SEQ-NO.
 16232     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 16233     MOVE WS-ACCESS              TO CNTL-ACCESS.
 16234     MOVE 'BENE'                 TO FILE-SWITCH.
 16235
 16236     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 16237
 16238     IF NO-BENEFIT-FOUND
 16239        GO TO 7020-BYPASS-BENEFIT.
 16240
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 315
* EL156.cbl
 16241     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 16242     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 16243     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 16244
 16245 7020-BYPASS-BENEFIT.
 16246
 16247*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16248*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 16249*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 16250
 16251     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 16252         GO TO 7021-GO-TO-LIFE.
 16253
 16254     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 16255     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 16256     MOVE CM-AH-BENEFIT-AMT      TO BENEO.
 16257     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 16258     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 16259                                    CP-ORIGINAL-TERM.
 16260     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 16261
 16262*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16263*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 16264*    ELSE
 16265         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 16266
 16267     MOVE ' '                    TO DC-OPTION-CODE.
 16268     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16269     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 16270
 16271     IF PI-COMPANY-ID = 'DMD'
 16272         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 16273         GO TO 7023-BYPASS-REMAINING-TERM.
 16274
 16275     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 16276     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 16277     GO TO 7022-AROUND-LIFE.
 16278
 16279 7021-GO-TO-LIFE.
 16280
 16281     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16282     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 16283     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 16284                                    CP-ORIGINAL-TERM.
 16285     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 16286     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 16287     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 16288     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 16289
 16290     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16291         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 16292     ELSE
 16293         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 16294
 16295     MOVE ' '                    TO DC-OPTION-CODE.
 16296     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16297     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 16298
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 316
* EL156.cbl
 16299 7022-AROUND-LIFE.
 16300
 16301     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 16302     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16303     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 16304     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 16305     MOVE '4'                    TO CP-REM-TERM-METHOD.
 16306     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 16307     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 16308
 16309     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 16310
 16311     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16312        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 16313           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 16314
 16315     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16316        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 16317           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 16318
 16319 7023-BYPASS-REMAINING-TERM.
 16320
 16321     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16322       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 16323          MOVE ZEROS                  TO BENEO
 16324       ELSE
 16325          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 16326          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 16327          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 16328          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 16329          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 16330          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 16331          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 16332          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 16333          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 16334          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 16335          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 16336          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 16337
 16338* EXEC CICS LINK
 16339*            PROGRAM  (LINK-REMAMT)
 16340*            COMMAREA (CALCULATION-PASS-AREA)
 16341*            LENGTH   (CP-COMM-LENGTH)
 16342*         END-EXEC
 16343*    MOVE '."C                   (   #00015084' TO DFHEIV0
 16344     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16345     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16346     MOVE X'2020233030303135303834' TO DFHEIV0(25:11)
 16347     CALL 'kxdfhei1' USING DFHEIV0,
 16348           LINK-REMAMT,
 16349           CALCULATION-PASS-AREA,
 16350           CP-COMM-LENGTH,
 16351           DFHEIV99,
 16352           DFHEIV99,
 16353           DFHEIV99,
 16354           DFHEIV99
 16355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16356          MOVE CP-REMAINING-AMT       TO BENEO.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 317
* EL156.cbl
 16357
 16358     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16359         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16360            WS-LF-COVERAGE-TYPE = 'P'
 16361             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 16362                                        CM-LF-ITD-DEATH-AMT
 16363             MOVE WS-REMAINING-AMT  TO  BENEO.
 16364
 16365     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 16366     MOVE BENEO                  TO PI-REM-BEN-AMT.
 16367     MOVE WS-TERMS               TO TERMSO.
 16368
 16369     IF WS-STATUS = '6' OR '7' OR '8'
 16370         MOVE AL-SABOF           TO CRTSTATA.
 16371
 16372     IF WS-STATUS = '1' OR '4'
 16373        IF CP-REMAINING-TERM-3 = ZEROS
 16374           MOVE 'EXPIRED'        TO CRTSTATO
 16375        ELSE
 16376           MOVE 'ACTIVE  '       TO CRTSTATO.
 16377
 16378     IF WS-STATUS = '2'
 16379         MOVE 'PEND    '         TO CRTSTATO.
 16380
 16381     IF WS-STATUS = '3'
 16382         MOVE 'RESTORE '         TO CRTSTATO.
 16383
 16384     IF WS-STATUS = '5'
 16385         MOVE 'REISSUE '         TO CRTSTATO.
 16386
 16387     IF WS-STATUS = '6'
 16388         MOVE 'LMP DIS'          TO CRTSTATO.
 16389
 16390     IF WS-STATUS = '7'
 16391         MOVE 'DEATH'            TO CRTSTATO.
 16392
 16393     IF WS-STATUS = '8'
 16394         MOVE 'CANCEL'           TO CRTSTATO.
 16395
 16396     IF WS-STATUS = '9'
 16397         MOVE 'RE-ONLY '         TO CRTSTATO.
 16398
 16399     IF WS-STATUS = 'V'
 16400         MOVE 'VOID  '           TO CRTSTATO.
 16401
 16402     IF WS-STATUS = 'D'
 16403         MOVE 'DECLINE '         TO CRTSTATO.
 16404
 16405     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16406         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 16407         MOVE '5'                TO CNTL-REC-TYPE
 16408     ELSE
 16409         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 16410         MOVE '4'                TO CNTL-REC-TYPE.
 16411
 16412     MOVE '** NONE **'           TO COVERO.
 16413     MOVE AL-SABON               TO COVERA.
 16414
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 318
* EL156.cbl
 16415     IF PI-COMPANY-ID = 'CVL'
 16416         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 16417             MOVE CM-BENEFICIARY TO LOANNOO
 16418             MOVE AL-UANON       TO LOANNOA.
 16419
 16420     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 16421        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 16422        MOVE +91                 TO  TRLR-SEQ-NO
 16423
 16424* EXEC CICS READ
 16425*           DATASET  ('ELTRLR')
 16426*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16427*           RIDFLD   (ELTRLR-KEY)
 16428*           RESP     (WS-RESPONSE)
 16429*       END-EXEC
 16430     MOVE 'ELTRLR' TO DFHEIV1
 16431*    MOVE '&"S        E          (  N#00015156' TO DFHEIV0
 16432     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16433     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16434     MOVE X'204E233030303135313536' TO DFHEIV0(25:11)
 16435     CALL 'kxdfhei1' USING DFHEIV0,
 16436           DFHEIV1,
 16437           DFHEIV20,
 16438           DFHEIV99,
 16439           ELTRLR-KEY,
 16440           DFHEIV99,
 16441           DFHEIV99,
 16442           DFHEIV99
 16443     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16444         DFHEIV20
 16445     MOVE EIBRESP  TO WS-RESPONSE
 16446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16447
 16448        IF WS-RESP-NORMAL
 16449           MOVE AT-INFO-LINE-1   TO  LOANNOO
 16450        ELSE
 16451           MOVE SPACES           TO  LOANNOO
 16452        END-IF
 16453*052506
 16454*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 16455*052506
 16456     END-IF
 16457
 16458     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 16459        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 16460
 16461     IF WS-BEN-CD = ZEROS
 16462         GO TO 7050-SHOW-CONTINUE.
 16463
 16464     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16465     MOVE WS-ACCESS              TO CNTL-ACCESS.
 16466     MOVE +0                     TO CNTL-SEQ-NO.
 16467     MOVE 'BENE'                 TO FILE-SWITCH.
 16468
 16469     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 16470
 16471     IF BENEFIT-FOUND
 16472         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 319
* EL156.cbl
 16473         MOVE AL-SANON                    TO COVERA.
 16474
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 320
* EL156.cbl
 16476 7050-SHOW-CONTINUE.
 16477
 16478     IF PI-COMPANY-ID = 'DMD'
 16479         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 16480
 16481     MOVE -1                     TO PMTTYPEL.
 16482     GO TO 8100-SEND-INITIAL-MAP.
 16483
 16484 7100-SHOW-RECORD-NOT-FOUND.
 16485     IF FILE-SWITCH = 'MSTR'
 16486         MOVE ER-0204            TO EMI-ERROR.
 16487
 16488     IF FILE-SWITCH = 'CERT'
 16489         MOVE ER-0206            TO EMI-ERROR.
 16490
 16491     IF FILE-SWITCH = 'STAT'
 16492         MOVE ER-0149            TO EMI-ERROR.
 16493
 16494     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16495
 16496     MOVE -1                     TO PMTTYPEL.
 16497     GO TO 8100-SEND-INITIAL-MAP
 16498
 16499     .
 16500 7110-BUILD-PMT-TRLR.
 16501     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 16502     MOVE +51                    TO TRLR-SEQ-NO
 16503
 16504* EXEC CICS READ
 16505*        DATASET  ('ELTRLR')
 16506*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16507*        RIDFLD   (ELTRLR-KEY)
 16508*        RESP     (WS-RESPONSE)
 16509*    END-EXEC
 16510     MOVE 'ELTRLR' TO DFHEIV1
 16511*    MOVE '&"S        E          (  N#00015218' TO DFHEIV0
 16512     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16513     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16514     MOVE X'204E233030303135323138' TO DFHEIV0(25:11)
 16515     CALL 'kxdfhei1' USING DFHEIV0,
 16516           DFHEIV1,
 16517           DFHEIV20,
 16518           DFHEIV99,
 16519           ELTRLR-KEY,
 16520           DFHEIV99,
 16521           DFHEIV99,
 16522           DFHEIV99
 16523     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16524         DFHEIV20
 16525     MOVE EIBRESP  TO WS-RESPONSE
 16526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16527     IF WS-RESP-NORMAL
 16528        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 16529     END-IF
 16530     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 16531
 16532* EXEC CICS GETMAIN
 16533*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 321
* EL156.cbl
 16534*         LENGTH    (200)
 16535*         INITIMG   (GETMAIN-SPACE)
 16536*     END-EXEC
 16537     MOVE 200
 16538       TO DFHEIV11
 16539*    MOVE ',"IL                  $   #00015228' TO DFHEIV0
 16540     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16541     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16542     MOVE X'2020233030303135323238' TO DFHEIV0(25:11)
 16543     CALL 'kxdfhei1' USING DFHEIV0,
 16544           DFHEIV20,
 16545           DFHEIV11,
 16546           GETMAIN-SPACE
 16547     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16548         DFHEIV20
 16549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16550     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 16551                                    AT-PREV-PAID-THRU-DT
 16552     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 16553     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 16554     MOVE 'AT'                   TO AT-RECORD-ID
 16555     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 16556     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 16557     MOVE '2'                    TO AT-TRAILER-TYPE
 16558     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16559                                    AT-PAYMENT-LAST-MAINT-DT
 16560     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16561                                    AT-PAYMENT-LAST-UPDATED-BY
 16562     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 16563     MOVE 'I'                    TO AT-PAYMENT-TYPE
 16564     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 16565     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 16566     MOVE +0                     TO AT-EXPENSE-PER-PMT
 16567     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 16568     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 16569     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 16570     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 16571     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 16572     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 16573     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 16574     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 16575     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 16576     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 16577     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 16578                                    AT-TO-BE-WRITTEN-DT
 16579     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 16580                                    AT-CHECK-QUE-SEQUENCE
 16581                                    AT-ADDL-RESERVE
 16582     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 16583                                    AT-VOID-SELECT-DT
 16584                                    AT-VOID-ACCEPT-DT
 16585                                    AT-VOID-DT
 16586                                    AT-PMT-PROOF-DT
 16587                                    AT-INT-PMT-SELECT-DT
 16588     MOVE ZEROS                  TO AT-DAILY-RATE
 16589                                    AT-ELIMINATION-DAYS
 16590     MOVE SPACES                 TO AT-BENEFIT-TYPE
 16591*    EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 322
* EL156.cbl
 16592*        DUPREC    (7120-DUPREC)
 16593*    END-EXEC
 16594     .
 16595 7115-WRITE-INT-TRLR.
 16596
 16597* EXEC CICS WRITE
 16598*         DATASET       ('ELTRLR')
 16599*         FROM          (ACTIVITY-TRAILERS)
 16600*         RIDFLD        (AT-CONTROL-PRIMARY)
 16601*         RESP          (WS-RESPONSE)
 16602*     END-EXEC
 16603     MOVE LENGTH OF
 16604      ACTIVITY-TRAILERS
 16605       TO DFHEIV11
 16606     MOVE 'ELTRLR' TO DFHEIV1
 16607*    MOVE '&$ L                  ''  N#00015279' TO DFHEIV0
 16608     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16609     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16610     MOVE X'204E233030303135323739' TO DFHEIV0(25:11)
 16611     CALL 'kxdfhei1' USING DFHEIV0,
 16612           DFHEIV1,
 16613           ACTIVITY-TRAILERS,
 16614           DFHEIV11,
 16615           AT-CONTROL-PRIMARY,
 16616           DFHEIV99,
 16617           DFHEIV99
 16618     MOVE EIBRESP  TO WS-RESPONSE
 16619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16620      IF WS-RESP-DUPREC
 16621         GO TO 7120-DUPREC
 16622      END-IF
 16623     GO TO 7130-EXIT
 16624     .
 16625 7120-DUPREC.
 16626     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16627     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 16628     GO TO 7115-WRITE-INT-TRLR
 16629     .
 16630 7130-EXIT.
 16631      EXIT.
 16632 7140-BUILD-NOTE-TRLR.
 16633
 16634
 16635* EXEC CICS GETMAIN
 16636*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16637*         LENGTH    (200)
 16638*         INITIMG   (GETMAIN-SPACE)
 16639*     END-EXEC
 16640     MOVE 200
 16641       TO DFHEIV11
 16642*    MOVE ',"IL                  $   #00015299' TO DFHEIV0
 16643     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16644     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16645     MOVE X'2020233030303135323939' TO DFHEIV0(25:11)
 16646     CALL 'kxdfhei1' USING DFHEIV0,
 16647           DFHEIV20,
 16648           DFHEIV11,
 16649           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 323
* EL156.cbl
 16650     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16651         DFHEIV20
 16652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16653     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16654     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 16655     MOVE 'AT'                   TO AT-RECORD-ID
 16656     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 16657     MOVE '6'                    TO AT-TRAILER-TYPE
 16658     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16659                                    AT-GEN-INFO-LAST-MAINT-DT
 16660     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16661                                    AT-GEN-INFO-LAST-UPDATED-BY
 16662     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 16663     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 16664     .
 16665 7150-WRITE.
 16666
 16667* EXEC CICS HANDLE CONDITION
 16668*        DUPREC    (7160-DUPREC)
 16669*    END-EXEC
 16670*    MOVE '"$%                   ! : #00015317' TO DFHEIV0
 16671     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16673     MOVE X'3A20233030303135333137' TO DFHEIV0(25:11)
 16674     CALL 'kxdfhei1' USING DFHEIV0
 16675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16676
 16677* EXEC CICS WRITE
 16678*         DATASET     ('ELTRLR')
 16679*         FROM        (ACTIVITY-TRAILERS)
 16680*         RIDFLD      (AT-CONTROL-PRIMARY)
 16681*         RESP        (WS-RESPONSE)
 16682*     END-EXEC
 16683     MOVE LENGTH OF
 16684      ACTIVITY-TRAILERS
 16685       TO DFHEIV11
 16686     MOVE 'ELTRLR' TO DFHEIV1
 16687*    MOVE '&$ L                  ''  N#00015320' TO DFHEIV0
 16688     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16689     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16690     MOVE X'204E233030303135333230' TO DFHEIV0(25:11)
 16691     CALL 'kxdfhei1' USING DFHEIV0,
 16692           DFHEIV1,
 16693           ACTIVITY-TRAILERS,
 16694           DFHEIV11,
 16695           AT-CONTROL-PRIMARY,
 16696           DFHEIV99,
 16697           DFHEIV99
 16698     MOVE EIBRESP  TO WS-RESPONSE
 16699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16700      IF WS-RESP-DUPREC
 16701         GO TO 7160-DUPREC
 16702      END-IF
 16703     GO TO 7170-EXIT
 16704     .
 16705 7160-DUPREC.
 16706     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16707     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 324
* EL156.cbl
 16708     GO TO 7150-WRITE
 16709     .
 16710 7170-EXIT.
 16711      EXIT.
 16712
 16713 7180-ADD-CERT-NOTE.
 16714*ADD CERT NOTE FOR SC NP+6
 16715
 16716
 16717* EXEC CICS GETMAIN
 16718*         SET       (ADDRESS OF CERT-NOTE-FILE)
 16719*         LENGTH    (150)
 16720*         INITIMG   (GETMAIN-SPACE)
 16721*     END-EXEC.
 16722     MOVE 150
 16723       TO DFHEIV11
 16724*    MOVE ',"IL                  $   #00015342' TO DFHEIV0
 16725     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16726     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16727     MOVE X'2020233030303135333432' TO DFHEIV0(25:11)
 16728     CALL 'kxdfhei1' USING DFHEIV0,
 16729           DFHEIV20,
 16730           DFHEIV11,
 16731           GETMAIN-SPACE
 16732     SET ADDRESS OF CERT-NOTE-FILE TO
 16733         DFHEIV20
 16734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16735
 16736
 16737     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 16738     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 16739     MOVE +1                     TO WRK-NOTE-SEQ.
 16740     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 16741     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 16742     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 16743     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 16744     MOVE CL-CERT-STATE          TO CZ-STATE.
 16745     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 16746     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 16747     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 16748     MOVE '2'                    TO CZ-RECORD-TYPE.
 16749     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 16750     MOVE 'CZ'                   TO CZ-RECORD-ID.
 16751     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 16752     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 16753     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 16754     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 16755     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 16756     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 16757     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 16758
 16759 7181-WRITE.
 16760
 16761
 16762* EXEC CICS WRITE
 16763*         DATASET     ('ERCNOT')
 16764*         FROM        (CERT-NOTE-FILE)
 16765*         RIDFLD      (CZ-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 325
* EL156.cbl
 16766*         RESP        (WS-RESPONSE)
 16767*    END-EXEC.
 16768     MOVE LENGTH OF
 16769      CERT-NOTE-FILE
 16770       TO DFHEIV11
 16771     MOVE 'ERCNOT' TO DFHEIV1
 16772*    MOVE '&$ L                  ''  N#00015372' TO DFHEIV0
 16773     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16774     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16775     MOVE X'204E233030303135333732' TO DFHEIV0(25:11)
 16776     CALL 'kxdfhei1' USING DFHEIV0,
 16777           DFHEIV1,
 16778           CERT-NOTE-FILE,
 16779           DFHEIV11,
 16780           CZ-CONTROL-PRIMARY,
 16781           DFHEIV99,
 16782           DFHEIV99
 16783     MOVE EIBRESP  TO WS-RESPONSE
 16784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16785
 16786
 16787     IF WS-RESP-DUPREC
 16788         GO TO 7182-DUPREC
 16789     END-IF.
 16790
 16791     SET CERT-NOTE-ADDED TO TRUE.
 16792
 16793     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 16794         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 16795     END-IF.
 16796
 16797     GO TO 7189-EXIT.
 16798
 16799 7182-DUPREC.
 16800
 16801     ADD +1                      TO  WRK-NOTE-SEQ.
 16802     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 16803     GO TO 7181-WRITE.
 16804
 16805 7189-EXIT.
 16806      EXIT.
 16807
 16808 7190-ADD-ORIG-NOTE.
 16809
 16810
 16811* EXEC CICS GETMAIN
 16812*         SET       (ADDRESS OF CERT-NOTE-FILE)
 16813*         LENGTH    (150)
 16814*         INITIMG   (GETMAIN-SPACE)
 16815*     END-EXEC.
 16816     MOVE 150
 16817       TO DFHEIV11
 16818*    MOVE ',"IL                  $   #00015402' TO DFHEIV0
 16819     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16820     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16821     MOVE X'2020233030303135343032' TO DFHEIV0(25:11)
 16822     CALL 'kxdfhei1' USING DFHEIV0,
 16823           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 326
* EL156.cbl
 16824           DFHEIV11,
 16825           GETMAIN-SPACE
 16826     SET ADDRESS OF CERT-NOTE-FILE TO
 16827         DFHEIV20
 16828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16829
 16830
 16831     ADD +1                      TO WRK-NOTE-SEQ.
 16832     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 16833     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 16834     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 16835     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 16836     MOVE CL-CERT-STATE          TO CZ-STATE.
 16837     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 16838     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 16839     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 16840     MOVE '2'                    TO CZ-RECORD-TYPE.
 16841     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 16842     MOVE 'CZ'                   TO CZ-RECORD-ID.
 16843     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 16844     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 16845     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 16846     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 16847
 16848 7191-WRITE.
 16849
 16850
 16851* EXEC CICS WRITE
 16852*         DATASET     ('ERCNOT')
 16853*         FROM        (CERT-NOTE-FILE)
 16854*         RIDFLD      (CZ-CONTROL-PRIMARY)
 16855*         RESP        (WS-RESPONSE)
 16856*    END-EXEC.
 16857     MOVE LENGTH OF
 16858      CERT-NOTE-FILE
 16859       TO DFHEIV11
 16860     MOVE 'ERCNOT' TO DFHEIV1
 16861*    MOVE '&$ L                  ''  N#00015427' TO DFHEIV0
 16862     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16863     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16864     MOVE X'204E233030303135343237' TO DFHEIV0(25:11)
 16865     CALL 'kxdfhei1' USING DFHEIV0,
 16866           DFHEIV1,
 16867           CERT-NOTE-FILE,
 16868           DFHEIV11,
 16869           CZ-CONTROL-PRIMARY,
 16870           DFHEIV99,
 16871           DFHEIV99
 16872     MOVE EIBRESP  TO WS-RESPONSE
 16873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16874
 16875
 16876     IF WS-RESP-DUPREC
 16877         GO TO 7192-DUPREC
 16878     END-IF.
 16879
 16880     GO TO 7199-EXIT.
 16881
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 327
* EL156.cbl
 16882 7192-DUPREC.
 16883
 16884     ADD +1                      TO  WRK-NOTE-SEQ.
 16885     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 16886     GO TO 7191-WRITE.
 16887
 16888 7199-EXIT.
 16889      EXIT.
 16890 7200-FIND-BENEFIT.
 16891     MOVE 'N' TO WS-BEN-SEARCH-SW.
 16892
 16893
 16894* EXEC CICS HANDLE CONDITION
 16895*        ENDFILE(7200-EXIT)
 16896*        NOTFND(7200-EXIT)
 16897*    END-EXEC.
 16898*    MOVE '"$''I                  ! ; #00015451' TO DFHEIV0
 16899     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16900     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16901     MOVE X'3B20233030303135343531' TO DFHEIV0(25:11)
 16902     CALL 'kxdfhei1' USING DFHEIV0
 16903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16904
 16905
 16906
 16907* EXEC CICS READ
 16908*        DATASET('ELCNTL')
 16909*        SET(ADDRESS OF CONTROL-FILE)
 16910*        RIDFLD(ELCNTL-KEY)
 16911*        GTEQ
 16912*    END-EXEC.
 16913     MOVE 'ELCNTL' TO DFHEIV1
 16914*    MOVE '&"S        G          (   #00015456' TO DFHEIV0
 16915     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16916     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16917     MOVE X'2020233030303135343536' TO DFHEIV0(25:11)
 16918     CALL 'kxdfhei1' USING DFHEIV0,
 16919           DFHEIV1,
 16920           DFHEIV20,
 16921           DFHEIV99,
 16922           ELCNTL-KEY,
 16923           DFHEIV99,
 16924           DFHEIV99,
 16925           DFHEIV99
 16926     SET ADDRESS OF CONTROL-FILE TO
 16927         DFHEIV20
 16928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16929
 16930
 16931     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 16932        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 16933           GO TO 7200-EXIT.
 16934
 16935     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 16936         VARYING SUB-1 FROM 1 BY 1 UNTIL
 16937            ((SUB-1 > 8) OR
 16938            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 16939
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 328
* EL156.cbl
 16940     IF SUB-1 NOT = 9
 16941         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 16942
 16943     GO TO 7200-EXIT.
 16944
 16945 7200-BENEFIT-DUMMY.
 16946
 16947 7200-DUMMY-EXIT.
 16948     EXIT.
 16949
 16950 7200-EXIT.
 16951     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 329
* EL156.cbl
 16953*052506
 16954*052506 7250-FIND-LETTER-TRLR.
 16955*052506     EXEC CICS HANDLE CONDITION
 16956*052506         ENDFILE  (7250-END)
 16957*052506         NOTFND   (7250-END)
 16958*052506     END-EXEC.
 16959*052506
 16960*052506     EXEC CICS STARTBR
 16961*052506         DATASET   ('ELTRLR')
 16962*052506         RIDFLD    (ELTRLR-KEY)
 16963*052506         GTEQ
 16964*052506     END-EXEC.
 16965*052506
 16966*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 16967*052506
 16968*052506 7250-FIND-LOOP.
 16969*052506     EXEC CICS READNEXT
 16970*052506         DATASET   ('ELTRLR')
 16971*052506         RIDFLD    (ELTRLR-KEY)
 16972*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16973*052506     END-EXEC.
 16974*052506
 16975*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 16976*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 16977*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 16978*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 16979*052506        GO TO 7250-END
 16980*052506     END-IF.
 16981*052506
 16982*052506     IF AT-TRAILER-TYPE NOT = '4'
 16983*052506         GO TO 7250-FIND-LOOP
 16984*052506     END-IF.
 16985*052506
 16986*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 16987*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 16988*052506     END-IF.
 16989*052506
 16990*052506     GO TO 7250-FIND-LOOP.
 16991*052506
 16992*052506 7250-END.
 16993*052506
 16994*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 16995*051506         MOVE SPACES             TO  DC-OPTION-CODE
 16996*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 16997*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16998*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 16999*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 17000*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 17001*052506     END-IF.
 17002*052506
 17003*052506     EXEC CICS ENDBR
 17004*052506          DATASET    ('ELTRLR')
 17005*052506     END-EXEC.
 17006*052506
 17007*052506 7250-EXIT.
 17008*052506     EXIT.
 17009*052506     EJECT
 17010*052506
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 330
* EL156.cbl
 17011 7300-CHECK-AUTO-ACTIVITY.
 17012
 17013     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 17014         NEXT SENTENCE
 17015     ELSE
 17016         GO TO 7399-EXIT.
 17017
 17018     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 17019
 17020     IF WS-ACT-REC-FOUND-SW = 'N'
 17021         GO TO 7399-EXIT.
 17022
 17023     IF PI-ACTIVITY-CODE = 09
 17024         GO TO 7300-CONT-AUTO-ACTIVITY.
 17025
 17026     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 17027        (PI-ACTIVITY-CODE = 11)
 17028         GO TO 7300-CONT-AUTO-ACTIVITY.
 17029
 17030     IF PI-PROVISIONAL-IND = 'P'
 17031         IF PI-PMTTYPE = '1'
 17032             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 17033                 MOVE 'N'    TO  PI-RESET-SW
 17034                 GO TO 7399-EXIT.
 17035
 17036     IF PI-PMTTYPE = '1'
 17037         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 17038             MOVE 'N'        TO  PI-RESET-SW
 17039             GO TO 7399-EXIT.
 17040
 17041     IF PI-PMTTYPE = '2' OR '3'
 17042         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 17043             MOVE 'N'        TO  PI-RESET-SW
 17044             GO TO 7399-EXIT.
 17045
 17046     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17047         IF PI-PROVISIONAL-IND = 'P'
 17048             NEXT SENTENCE
 17049         ELSE
 17050             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 17051
 17052 7300-CONT-AUTO-ACTIVITY.
 17053
 17054     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 17055         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 17056         MOVE '4'            TO DC-OPTION-CODE
 17057         MOVE +0             TO DC-ELAPSED-DAYS
 17058                                DC-ELAPSED-MONTHS
 17059         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17060         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 17061         IF PI-USES-PAID-TO
 17062             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17063             IF NO-CONVERSION-ERROR
 17064                 MOVE +1     TO DC-ELAPSED-DAYS
 17065                 MOVE +0     TO DC-ELAPSED-MONTHS
 17066                 MOVE '6'    TO DC-OPTION-CODE
 17067                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17068                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 331
* EL156.cbl
 17069                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 17070
 17071     IF PI-PFKEY-USED = DFHPF5
 17072         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 17073         IF PI-USES-PAID-TO
 17074             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 17075             MOVE +1                  TO DC-ELAPSED-DAYS
 17076             MOVE +0                  TO DC-ELAPSED-MONTHS
 17077             MOVE '6'                 TO DC-OPTION-CODE
 17078             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17079             IF NO-CONVERSION-ERROR
 17080                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 17081
 17082     IF WS-CHK-THRU-DT < PI-EXP-DT
 17083         NEXT SENTENCE
 17084     ELSE
 17085         MOVE 03                     TO  WS-ACTIVITY-CODE
 17086         GO TO 7390-PROCESS-ACTIVITY.
 17087
 17088     IF PI-PROV-PMT
 17089         MOVE 09                     TO  WS-ACTIVITY-CODE
 17090     ELSE
 17091        IF PI-PMTTYPE = '1'
 17092            MOVE 02                  TO  WS-ACTIVITY-CODE
 17093        ELSE
 17094        IF PI-PMTTYPE = '2' OR '3'
 17095            MOVE 07                  TO  WS-ACTIVITY-CODE
 17096        ELSE
 17097        IF PI-PMTTYPE = '4'
 17098            MOVE 00                  TO  WS-ACTIVITY-CODE
 17099        ELSE
 17100            MOVE 'N'                 TO  PI-RESET-SW
 17101            GO TO 7399-EXIT.
 17102
 17103 7390-PROCESS-ACTIVITY.
 17104
 17105     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7499-EXIT.
 17106
 17107 7399-EXIT.
 17108     EXIT.
 17109
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 332
* EL156.cbl
 17111 7400-CHECK-AUTO-ACTIVITY.
 17112
 17113
 17114* EXEC CICS HANDLE CONDITION
 17115*        NOTFND   (7400-NOT-FOUND)
 17116*    END-EXEC.
 17117*    MOVE '"$I                   ! < #00015645' TO DFHEIV0
 17118     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17119     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17120     MOVE X'3C20233030303135363435' TO DFHEIV0(25:11)
 17121     CALL 'kxdfhei1' USING DFHEIV0
 17122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17123
 17124
 17125     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 17126     MOVE 'T'                    TO  CNTL-REC-TYPE.
 17127     MOVE SPACES                 TO  CNTL-ACCESS.
 17128     MOVE +0                     TO  CNTL-SEQ-NO.
 17129
 17130
 17131* EXEC CICS READ
 17132*        DATASET   ('ELCNTL')
 17133*        RIDFLD    (ELCNTL-KEY)
 17134*        SET       (ADDRESS OF CONTROL-FILE)
 17135*    END-EXEC.
 17136     MOVE 'ELCNTL' TO DFHEIV1
 17137*    MOVE '&"S        E          (   #00015654' TO DFHEIV0
 17138     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17139     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17140     MOVE X'2020233030303135363534' TO DFHEIV0(25:11)
 17141     CALL 'kxdfhei1' USING DFHEIV0,
 17142           DFHEIV1,
 17143           DFHEIV20,
 17144           DFHEIV99,
 17145           ELCNTL-KEY,
 17146           DFHEIV99,
 17147           DFHEIV99,
 17148           DFHEIV99
 17149     SET ADDRESS OF CONTROL-FILE TO
 17150         DFHEIV20
 17151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17152
 17153
 17154     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 17155     GO TO 7400-EXIT.
 17156
 17157 7400-NOT-FOUND.
 17158     MOVE 'N'                        TO  PI-RESET-SW
 17159                                         WS-LETTER-SW
 17160                                         WS-ACT-REC-FOUND-SW.
 17161
 17162     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17163
 17164 7400-EXIT.
 17165     EXIT.
 17166
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 333
* EL156.cbl
 17168 7450-FORMAT-AUTO-LETTER.
 17169
 17170     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 17171         MOVE 'Y'                    TO PI-RESET-SW
 17172         GO TO 7450-CONTINUE-PROCESS.
 17173
 17174     MOVE PI-ACTIVITY-CODE           TO  SUB.
 17175
 17176     IF SUB > 9
 17177         SUBTRACT 9 FROM SUB
 17178         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 17179     ELSE
 17180         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 17181
 17182 7450-CONTINUE-PROCESS.
 17183
 17184     IF WS-ACTIVITY-CODE = ZEROS
 17185         MOVE 'N'                    TO  WS-LETTER-SW
 17186         GO TO 7499-EXIT.
 17187
 17188     MOVE WS-ACTIVITY-CODE           TO  SUB.
 17189
 17190     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 17191         MOVE 'N'                    TO  PI-RESET-SW
 17192                                         WS-LETTER-SW
 17193         GO TO 7499-EXIT.
 17194
 17195     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 17196         MOVE 'N'                    TO  WS-LETTER-SW
 17197         GO TO 7499-EXIT.
 17198
 17199     MOVE 'Y'                        TO  WS-LETTER-SW.
 17200     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 17201     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 17202
 17203     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 17204
 17205     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 17206         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 17207         MOVE '6'                    TO  DC-OPTION-CODE
 17208         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 17209         MOVE +0                     TO  DC-ELAPSED-MONTHS
 17210         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17211         IF NO-CONVERSION-ERROR
 17212             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 17213         ELSE
 17214              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 17215
 17216     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 17217         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 17218         MOVE '6'                    TO  DC-OPTION-CODE
 17219         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 17220         MOVE +0                     TO  DC-ELAPSED-MONTHS
 17221         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17222         IF NO-CONVERSION-ERROR
 17223             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 17224         ELSE
 17225             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 334
* EL156.cbl
 17226
 17227 7499-EXIT.
 17228     EXIT.
 17229
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 335
* EL156.cbl
 17231 7500-RESET-AUTO-ACTIVITY.
 17232
 17233     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 17234     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 17235     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 17236     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 17237     MOVE +100                   TO  TRLR-SEQ-NO.
 17238
 17239 7500-STARTBR-TRLR.
 17240
 17241
 17242* EXEC CICS HANDLE CONDITION
 17243*        ENDFILE  (7590-END)
 17244*        NOTFND   (7590-END)
 17245*    END-EXEC.
 17246*    MOVE '"$''I                  ! = #00015747' TO DFHEIV0
 17247     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 17248     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17249     MOVE X'3D20233030303135373437' TO DFHEIV0(25:11)
 17250     CALL 'kxdfhei1' USING DFHEIV0
 17251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17252
 17253
 17254
 17255* EXEC CICS STARTBR
 17256*        DATASET   ('ELTRLR')
 17257*        RIDFLD    (ELTRLR-KEY)
 17258*        GTEQ
 17259*    END-EXEC.
 17260     MOVE 'ELTRLR' TO DFHEIV1
 17261     MOVE 0
 17262       TO DFHEIV11
 17263*    MOVE '&,         G          &   #00015752' TO DFHEIV0
 17264     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17265     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17266     MOVE X'2020233030303135373532' TO DFHEIV0(25:11)
 17267     CALL 'kxdfhei1' USING DFHEIV0,
 17268           DFHEIV1,
 17269           ELTRLR-KEY,
 17270           DFHEIV99,
 17271           DFHEIV11,
 17272           DFHEIV99
 17273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17274
 17275
 17276     MOVE 'Y'                        TO  WS-BROWSE-SW.
 17277
 17278 7500-READ-NEXT.
 17279
 17280
 17281* EXEC CICS READNEXT
 17282*        DATASET   ('ELTRLR')
 17283*        RIDFLD    (ELTRLR-KEY)
 17284*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17285*    END-EXEC.
 17286     MOVE 'ELTRLR' TO DFHEIV1
 17287     MOVE 0
 17288       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 336
* EL156.cbl
 17289*    MOVE '&.S                   )   #00015762' TO DFHEIV0
 17290     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17291     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17292     MOVE X'2020233030303135373632' TO DFHEIV0(25:11)
 17293     CALL 'kxdfhei1' USING DFHEIV0,
 17294           DFHEIV1,
 17295           DFHEIV20,
 17296           DFHEIV99,
 17297           ELTRLR-KEY,
 17298           DFHEIV99,
 17299           DFHEIV11,
 17300           DFHEIV99,
 17301           DFHEIV99
 17302     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17303         DFHEIV20
 17304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17305
 17306
 17307     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 17308        PI-CARRIER    NOT = TRLR-CARRIER  OR
 17309        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 17310        PI-CERT-NO    NOT = TRLR-CERT-NO
 17311         GO TO 7590-END.
 17312
 17313     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 17314         GO TO 7500-READ-NEXT.
 17315
 17316     IF AT-TRAILER-TYPE NOT = '4'
 17317         GO TO 7500-READ-NEXT.
 17318
 17319     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 17320         GO TO 7500-READ-NEXT.
 17321
 17322     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 17323        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 17324         GO TO 7500-READ-NEXT.
 17325
 17326     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 17327        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 17328        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 17329         GO TO 7500-READ-NEXT.
 17330
 17331     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 17332                         AND
 17333        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 17334                         AND
 17335        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 17336            GO TO 7500-READ-NEXT.
 17337
 17338     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 17339
 17340
 17341* EXEC CICS ENDBR
 17342*        DATASET   ('ELTRLR')
 17343*    END-EXEC.
 17344     MOVE 'ELTRLR' TO DFHEIV1
 17345     MOVE 0
 17346       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 337
* EL156.cbl
 17347*    MOVE '&2                    $   #00015801' TO DFHEIV0
 17348     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17349     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17350     MOVE X'2020233030303135383031' TO DFHEIV0(25:11)
 17351     CALL 'kxdfhei1' USING DFHEIV0,
 17352           DFHEIV1,
 17353           DFHEIV11,
 17354           DFHEIV99
 17355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17356
 17357
 17358     MOVE 'N'                        TO  WS-BROWSE-SW.
 17359
 17360
 17361* EXEC CICS READ
 17362*        DATASET   ('ELTRLR')
 17363*        RIDFLD    (ELTRLR-KEY)
 17364*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17365*        UPDATE
 17366*    END-EXEC.
 17367     MOVE 'ELTRLR' TO DFHEIV1
 17368*    MOVE '&"S        EU         (   #00015807' TO DFHEIV0
 17369     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17370     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17371     MOVE X'2020233030303135383037' TO DFHEIV0(25:11)
 17372     CALL 'kxdfhei1' USING DFHEIV0,
 17373           DFHEIV1,
 17374           DFHEIV20,
 17375           DFHEIV99,
 17376           ELTRLR-KEY,
 17377           DFHEIV99,
 17378           DFHEIV99,
 17379           DFHEIV99
 17380     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17381         DFHEIV20
 17382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17383
 17384
 17385     MOVE 'Y'                        TO  WS-UPDATE-SW.
 17386
 17387     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 17388         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 17389     ELSE
 17390         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 17391             NEXT SENTENCE
 17392         ELSE
 17393             GO TO 7500-REWRITE-TRLR.
 17394
 17395     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 17396
 17397     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 17398     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 17399     MOVE '1'                        TO  ARCH-REC-TYPE.
 17400     MOVE +0                         TO  ARCH-SEQ.
 17401
 17402     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 17403
 17404 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 338
* EL156.cbl
 17405
 17406
 17407* EXEC CICS REWRITE
 17408*        DATASET   ('ELTRLR')
 17409*        FROM      (ACTIVITY-TRAILERS)
 17410*    END-EXEC.
 17411     MOVE LENGTH OF
 17412      ACTIVITY-TRAILERS
 17413       TO DFHEIV11
 17414     MOVE 'ELTRLR' TO DFHEIV1
 17415*    MOVE '&& L                  %   #00015835' TO DFHEIV0
 17416     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17417     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17418     MOVE X'2020233030303135383335' TO DFHEIV0(25:11)
 17419     CALL 'kxdfhei1' USING DFHEIV0,
 17420           DFHEIV1,
 17421           ACTIVITY-TRAILERS,
 17422           DFHEIV11,
 17423           DFHEIV99
 17424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17425
 17426
 17427     GO TO 7500-STARTBR-TRLR.
 17428
 17429 7590-END.
 17430
 17431     IF WS-BROWSE-SW = 'Y'
 17432         MOVE 'N'                    TO  WS-BROWSE-SW
 17433
 17434* EXEC CICS ENDBR
 17435*            DATASET   ('ELTRLR')
 17436*        END-EXEC.
 17437     MOVE 'ELTRLR' TO DFHEIV1
 17438     MOVE 0
 17439       TO DFHEIV11
 17440*    MOVE '&2                    $   #00015846' TO DFHEIV0
 17441     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17442     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17443     MOVE X'2020233030303135383436' TO DFHEIV0(25:11)
 17444     CALL 'kxdfhei1' USING DFHEIV0,
 17445           DFHEIV1,
 17446           DFHEIV11,
 17447           DFHEIV99
 17448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17449
 17450
 17451 7599-EXIT.
 17452     EXIT.
 17453
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 339
* EL156.cbl
 17455 7600-READ-ARCH-UPDATE.
 17456
 17457
 17458* EXEC CICS HANDLE CONDITION
 17459*        NOTFND   (7699-EXIT)
 17460*    END-EXEC.
 17461*    MOVE '"$I                   ! > #00015856' TO DFHEIV0
 17462     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17463     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17464     MOVE X'3E20233030303135383536' TO DFHEIV0(25:11)
 17465     CALL 'kxdfhei1' USING DFHEIV0
 17466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17467
 17468
 17469
 17470* EXEC CICS READ
 17471*        DATASET   ('ELARCH')
 17472*        RIDFLD    (ELARCH-KEY)
 17473*        SET       (ADDRESS OF LETTER-ARCHIVE)
 17474*        UPDATE
 17475*    END-EXEC.
 17476     MOVE 'ELARCH' TO DFHEIV1
 17477*    MOVE '&"S        EU         (   #00015860' TO DFHEIV0
 17478     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17479     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17480     MOVE X'2020233030303135383630' TO DFHEIV0(25:11)
 17481     CALL 'kxdfhei1' USING DFHEIV0,
 17482           DFHEIV1,
 17483           DFHEIV20,
 17484           DFHEIV99,
 17485           ELARCH-KEY,
 17486           DFHEIV99,
 17487           DFHEIV99,
 17488           DFHEIV99
 17489     SET ADDRESS OF LETTER-ARCHIVE TO
 17490         DFHEIV20
 17491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17492
 17493
 17494     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 17495
 17496
 17497* EXEC CICS REWRITE
 17498*        DATASET   ('ELARCH')
 17499*        FROM      (LETTER-ARCHIVE)
 17500*    END-EXEC.
 17501     MOVE LENGTH OF
 17502      LETTER-ARCHIVE
 17503       TO DFHEIV11
 17504     MOVE 'ELARCH' TO DFHEIV1
 17505*    MOVE '&& L                  %   #00015869' TO DFHEIV0
 17506     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17507     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17508     MOVE X'2020233030303135383639' TO DFHEIV0(25:11)
 17509     CALL 'kxdfhei1' USING DFHEIV0,
 17510           DFHEIV1,
 17511           LETTER-ARCHIVE,
 17512           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 340
* EL156.cbl
 17513           DFHEIV99
 17514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17515
 17516
 17517 7699-EXIT.
 17518     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 341
* EL156.cbl
 17520 7700-GET-DCT.
 17521
 17522     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 17523     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 17524     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 17525     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 17526                                    PI-MAX-BENEFIT-AMT
 17527                                    PI-MAX-BENEFIT-PYMT
 17528                                    PI-MIN-PAYMENT-AMT
 17529                                    PI-TIME-OF-LOSS-BAL.
 17530
 17531
 17532* EXEC CICS HANDLE CONDITION
 17533*         NOTFND (5300-NOTE-NOT-FOUND)
 17534*     END-EXEC.
 17535*    MOVE '"$I                   ! ? #00015888' TO DFHEIV0
 17536     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17538     MOVE X'3F20233030303135383838' TO DFHEIV0(25:11)
 17539     CALL 'kxdfhei1' USING DFHEIV0
 17540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17541
 17542
 17543
 17544* EXEC CICS READ
 17545*         DATASET('ERNOTE')
 17546*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 17547*         RIDFLD (W-NOTE-KEY)
 17548*     END-EXEC.
 17549     MOVE 'ERNOTE' TO DFHEIV1
 17550*    MOVE '&"S        E          (   #00015892' TO DFHEIV0
 17551     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17552     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17553     MOVE X'2020233030303135383932' TO DFHEIV0(25:11)
 17554     CALL 'kxdfhei1' USING DFHEIV0,
 17555           DFHEIV1,
 17556           DFHEIV20,
 17557           DFHEIV99,
 17558           W-NOTE-KEY,
 17559           DFHEIV99,
 17560           DFHEIV99,
 17561           DFHEIV99
 17562     SET ADDRESS OF CERTIFICATE-NOTE TO
 17563         DFHEIV20
 17564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17565
 17566
 17567     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 17568     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 17569     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 17570     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 17571     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 17572
 17573     IF PI-PAYEE-TYPE NOT = 'B'
 17574         GO TO 7700-EXIT.
 17575
 17576     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 17577     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 342
* EL156.cbl
 17578     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 17579
 17580     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 17581         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 17582     ELSE
 17583         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 17584
 17585     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 17586     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 17587     MOVE 'DLO006'               TO PGM-NAME.
 17588
 17589
 17590* EXEC CICS LINK
 17591*        PROGRAM    (PGM-NAME)
 17592*        COMMAREA   (DCT-COMMUNICATION-AREA)
 17593*        LENGTH     (DCT-RCRD-LENGTH)
 17594*    END-EXEC.
 17595*    MOVE '."C                   (   #00015920' TO DFHEIV0
 17596     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17597     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17598     MOVE X'2020233030303135393230' TO DFHEIV0(25:11)
 17599     CALL 'kxdfhei1' USING DFHEIV0,
 17600           PGM-NAME,
 17601           DCT-COMMUNICATION-AREA,
 17602           DCT-RCRD-LENGTH,
 17603           DFHEIV99,
 17604           DFHEIV99,
 17605           DFHEIV99,
 17606           DFHEIV99
 17607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17608
 17609
 17610     IF DCT-RETURN-CODE = 'OK'
 17611         GO TO 7700-CONT.
 17612
 17613     IF DCT-RETURN-CODE = '01' OR '02'
 17614         GO TO 7700-SET-TO-YES.
 17615
 17616     IF DCT-RETURN-CODE = '03'
 17617
 17618* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17619*    MOVE '6"R                   !   #00015933' TO DFHEIV0
 17620     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17622     MOVE X'2020233030303135393333' TO DFHEIV0(25:11)
 17623     CALL 'kxdfhei1' USING DFHEIV0
 17624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17625         MOVE ER-0951            TO EMI-ERROR
 17626         MOVE -1                 TO PMTTYPEL
 17627         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17628         GO TO 8200-SEND-DATAONLY.
 17629
 17630     IF DCT-RETURN-CODE = '04'
 17631
 17632* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17633*    MOVE '6"R                   !   #00015940' TO DFHEIV0
 17634     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17635     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 343
* EL156.cbl
 17636     MOVE X'2020233030303135393430' TO DFHEIV0(25:11)
 17637     CALL 'kxdfhei1' USING DFHEIV0
 17638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17639         MOVE ER-0946            TO EMI-ERROR
 17640         MOVE -1                 TO PMTTYPEL
 17641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17642         GO TO 8200-SEND-DATAONLY.
 17643
 17644     IF DCT-RETURN-CODE = '05'
 17645
 17646* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17647*    MOVE '6"R                   !   #00015947' TO DFHEIV0
 17648     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17649     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17650     MOVE X'2020233030303135393437' TO DFHEIV0(25:11)
 17651     CALL 'kxdfhei1' USING DFHEIV0
 17652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17653         MOVE ER-0947            TO EMI-ERROR
 17654         MOVE -1                 TO PMTTYPEL
 17655         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17656         GO TO 8200-SEND-DATAONLY.
 17657
 17658     IF DCT-RETURN-CODE = '06'
 17659
 17660* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17661*    MOVE '6"R                   !   #00015954' TO DFHEIV0
 17662     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17664     MOVE X'2020233030303135393534' TO DFHEIV0(25:11)
 17665     CALL 'kxdfhei1' USING DFHEIV0
 17666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17667         MOVE ER-0921            TO EMI-ERROR
 17668         MOVE -1                 TO PMTTYPEL
 17669         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17670         GO TO 8200-SEND-DATAONLY.
 17671
 17672     IF DCT-RETURN-CODE = '07'
 17673
 17674* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17675*    MOVE '6"R                   !   #00015961' TO DFHEIV0
 17676     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17677     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17678     MOVE X'2020233030303135393631' TO DFHEIV0(25:11)
 17679     CALL 'kxdfhei1' USING DFHEIV0
 17680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17681         MOVE ER-0919            TO EMI-ERROR
 17682         MOVE -1                 TO PMTTYPEL
 17683         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17684         GO TO 8200-SEND-DATAONLY.
 17685
 17686     IF DCT-RETURN-CODE = '08'
 17687
 17688* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17689*    MOVE '6"R                   !   #00015968' TO DFHEIV0
 17690     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17691     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17692     MOVE X'2020233030303135393638' TO DFHEIV0(25:11)
 17693     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 344
* EL156.cbl
 17694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17695         MOVE ER-0948            TO EMI-ERROR
 17696         MOVE -1                 TO PMTTYPEL
 17697         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17698         GO TO 8200-SEND-DATAONLY.
 17699
 17700     IF DCT-RETURN-CODE = 'N1'
 17701
 17702* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17703*    MOVE '6"R                   !   #00015975' TO DFHEIV0
 17704     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17705     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17706     MOVE X'2020233030303135393735' TO DFHEIV0(25:11)
 17707     CALL 'kxdfhei1' USING DFHEIV0
 17708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17709         MOVE ER-0950            TO EMI-ERROR
 17710         MOVE -1                 TO PMTTYPEL
 17711         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17712         GO TO 8200-SEND-DATAONLY.
 17713
 17714     IF DCT-RETURN-CODE = 'E1'
 17715
 17716* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17717*    MOVE '6"R                   !   #00015982' TO DFHEIV0
 17718     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17719     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17720     MOVE X'2020233030303135393832' TO DFHEIV0(25:11)
 17721     CALL 'kxdfhei1' USING DFHEIV0
 17722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17723         MOVE ER-0974            TO EMI-ERROR
 17724         MOVE -1                 TO PMTTYPEL
 17725         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17726         GO TO 8200-SEND-DATAONLY.
 17727
 17728     IF DCT-RETURN-CODE = 'E2'
 17729
 17730* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17731*    MOVE '6"R                   !   #00015989' TO DFHEIV0
 17732     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17733     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17734     MOVE X'2020233030303135393839' TO DFHEIV0(25:11)
 17735     CALL 'kxdfhei1' USING DFHEIV0
 17736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17737         MOVE ER-0975            TO EMI-ERROR
 17738         MOVE -1                 TO PMTTYPEL
 17739         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17740         GO TO 8200-SEND-DATAONLY.
 17741
 17742     IF DCT-RETURN-CODE NOT = 'OK'
 17743
 17744* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17745*    MOVE '6"R                   !   #00015996' TO DFHEIV0
 17746     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17747     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17748     MOVE X'2020233030303135393936' TO DFHEIV0(25:11)
 17749     CALL 'kxdfhei1' USING DFHEIV0
 17750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17751         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 345
* EL156.cbl
 17752         MOVE -1                 TO PMTTYPEL
 17753         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17754         GO TO 8200-SEND-DATAONLY.
 17755
 17756 7700-CONT.
 17757
 17758*07839      MOVE 'N'                    TO CASHO.
 17759*07840      MOVE +1                     TO CASHL.
 17760*07841      MOVE AL-UANON               TO CASHA.
 17761
 17762     IF PI-OFFLINE = 'Y'
 17763         GO TO 7700-EXIT.
 17764
 17765     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 17766     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 17767     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 17768     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 17769     MOVE +7                     TO CHECKNOL.
 17770     MOVE AL-UANON               TO CHECKNOA.
 17771     GO TO 7700-EXIT.
 17772
 17773 7700-SET-TO-YES.
 17774
 17775*07856      MOVE 'Y'                    TO CASHO.
 17776*07857      MOVE +1                     TO CASHL.
 17777*07858      MOVE AL-UANON               TO CASHA.
 17778
 17779 7700-EXIT.
 17780     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 346
* EL156.cbl
 17782 7800-READ-COMP-MSTR.
 17783
 17784
 17785* EXEC CICS HANDLE CONDITION
 17786*        NOTFND   (7800-COMP-NOTFND)
 17787*    END-EXEC.
 17788*    MOVE '"$I                   ! @ #00016030' TO DFHEIV0
 17789     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17790     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17791     MOVE X'4020233030303136303330' TO DFHEIV0(25:11)
 17792     CALL 'kxdfhei1' USING DFHEIV0
 17793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17794
 17795
 17796
 17797* EXEC CICS READ
 17798*        DATASET   ('ERCOMP')
 17799*        RIDFLD    (ERCOMP-KEY)
 17800*        SET       (ADDRESS OF COMPENSATION-MASTER)
 17801*    END-EXEC.
 17802     MOVE 'ERCOMP' TO DFHEIV1
 17803*    MOVE '&"S        E          (   #00016034' TO DFHEIV0
 17804     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17805     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17806     MOVE X'2020233030303136303334' TO DFHEIV0(25:11)
 17807     CALL 'kxdfhei1' USING DFHEIV0,
 17808           DFHEIV1,
 17809           DFHEIV20,
 17810           DFHEIV99,
 17811           ERCOMP-KEY,
 17812           DFHEIV99,
 17813           DFHEIV99,
 17814           DFHEIV99
 17815     SET ADDRESS OF COMPENSATION-MASTER TO
 17816         DFHEIV20
 17817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17818
 17819
 17820     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 17821     GO TO 7800-COMP-EXIT.
 17822
 17823 7800-COMP-NOTFND.
 17824     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 17825
 17826 7800-COMP-EXIT.
 17827     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 347
* EL156.cbl
 17829 7900-READ-CLAIM.
 17830
 17831* EXEC CICS READ
 17832*        DATASET  ('ELMSTR')
 17833*        SET      (ADDRESS OF CLAIM-MASTER)
 17834*        RIDFLD   (ELMSTR-KEY)
 17835*    END-EXEC.
 17836     MOVE 'ELMSTR' TO DFHEIV1
 17837*    MOVE '&"S        E          (   #00016050' TO DFHEIV0
 17838     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17839     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17840     MOVE X'2020233030303136303530' TO DFHEIV0(25:11)
 17841     CALL 'kxdfhei1' USING DFHEIV0,
 17842           DFHEIV1,
 17843           DFHEIV20,
 17844           DFHEIV99,
 17845           ELMSTR-KEY,
 17846           DFHEIV99,
 17847           DFHEIV99,
 17848           DFHEIV99
 17849     SET ADDRESS OF CLAIM-MASTER TO
 17850         DFHEIV20
 17851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17852
 17853
 17854 7900-EXIT.
 17855      EXIT.
 17856
 17857 7910-READ-CLAIM-UPDATE.
 17858
 17859* EXEC CICS READ
 17860*        DATASET  ('ELMSTR')
 17861*        SET      (ADDRESS OF CLAIM-MASTER)
 17862*        RIDFLD   (ELMSTR-KEY)
 17863*        UPDATE
 17864*    END-EXEC.
 17865     MOVE 'ELMSTR' TO DFHEIV1
 17866*    MOVE '&"S        EU         (   #00016060' TO DFHEIV0
 17867     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17868     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17869     MOVE X'2020233030303136303630' TO DFHEIV0(25:11)
 17870     CALL 'kxdfhei1' USING DFHEIV0,
 17871           DFHEIV1,
 17872           DFHEIV20,
 17873           DFHEIV99,
 17874           ELMSTR-KEY,
 17875           DFHEIV99,
 17876           DFHEIV99,
 17877           DFHEIV99
 17878     SET ADDRESS OF CLAIM-MASTER TO
 17879         DFHEIV20
 17880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17881
 17882
 17883 7910-EXIT.
 17884      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 348
* EL156.cbl
 17886 7920-READ-BENE.
 17887     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 17888     MOVE 'B'                TO BENE-RECORD-TYPE.
 17889     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 17890
 17891     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17892        IF PI-PAYEE-TYPE    = 'B' AND
 17893           PI-PAYEE-SEQ-NUM = 9
 17894             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 17895             MOVE WS-A-BENE           TO BENE-NUMBER.
 17896
 17897
 17898* EXEC CICS HANDLE CONDITION
 17899*        NOTFND   (7920-NOT-FOUND)
 17900*    END-EXEC.
 17901*    MOVE '"$I                   ! A #00016081' TO DFHEIV0
 17902     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17903     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17904     MOVE X'4120233030303136303831' TO DFHEIV0(25:11)
 17905     CALL 'kxdfhei1' USING DFHEIV0
 17906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17907
 17908
 17909
 17910* EXEC CICS READ
 17911*        DATASET  ('ELBENE')
 17912*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 17913*        RIDFLD   (ELBENE-KEY)
 17914*    END-EXEC.
 17915     MOVE 'ELBENE' TO DFHEIV1
 17916*    MOVE '&"S        E          (   #00016085' TO DFHEIV0
 17917     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17918     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17919     MOVE X'2020233030303136303835' TO DFHEIV0(25:11)
 17920     CALL 'kxdfhei1' USING DFHEIV0,
 17921           DFHEIV1,
 17922           DFHEIV20,
 17923           DFHEIV99,
 17924           ELBENE-KEY,
 17925           DFHEIV99,
 17926           DFHEIV99,
 17927           DFHEIV99
 17928     SET ADDRESS OF BENEFICIARY-MASTER TO
 17929         DFHEIV20
 17930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17931
 17932
 17933     MOVE 'Y' TO BENE-FOUND-SW.
 17934     GO TO 7920-EXIT.
 17935
 17936 7920-NOT-FOUND.
 17937     MOVE 'N'                    TO BENE-FOUND-SW.
 17938
 17939 7920-EXIT.
 17940      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 349
* EL156.cbl
 17942 7930-READ-CONTROL.
 17943
 17944* EXEC CICS READ
 17945*        DATASET  ('ELCNTL')
 17946*        SET      (ADDRESS OF CONTROL-FILE)
 17947*        RIDFLD   (ELCNTL-KEY)
 17948*    END-EXEC.
 17949     MOVE 'ELCNTL' TO DFHEIV1
 17950*    MOVE '&"S        E          (   #00016101' TO DFHEIV0
 17951     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17953     MOVE X'2020233030303136313031' TO DFHEIV0(25:11)
 17954     CALL 'kxdfhei1' USING DFHEIV0,
 17955           DFHEIV1,
 17956           DFHEIV20,
 17957           DFHEIV99,
 17958           ELCNTL-KEY,
 17959           DFHEIV99,
 17960           DFHEIV99,
 17961           DFHEIV99
 17962     SET ADDRESS OF CONTROL-FILE TO
 17963         DFHEIV20
 17964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17965
 17966
 17967 7930-EXIT.
 17968      EXIT.
 17969
 17970 7940-READ-CONTROL-UPDATE.
 17971
 17972* EXEC CICS READ
 17973*        DATASET  ('ELCNTL')
 17974*        SET      (ADDRESS OF CONTROL-FILE)
 17975*        RIDFLD   (ELCNTL-KEY)
 17976*        UPDATE
 17977*    END-EXEC.
 17978     MOVE 'ELCNTL' TO DFHEIV1
 17979*    MOVE '&"S        EU         (   #00016111' TO DFHEIV0
 17980     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17981     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17982     MOVE X'2020233030303136313131' TO DFHEIV0(25:11)
 17983     CALL 'kxdfhei1' USING DFHEIV0,
 17984           DFHEIV1,
 17985           DFHEIV20,
 17986           DFHEIV99,
 17987           ELCNTL-KEY,
 17988           DFHEIV99,
 17989           DFHEIV99,
 17990           DFHEIV99
 17991     SET ADDRESS OF CONTROL-FILE TO
 17992         DFHEIV20
 17993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17994
 17995
 17996 7940-EXIT.
 17997      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 350
* EL156.cbl
 17999 7950-READ-TRAILER.
 18000
 18001* EXEC CICS READ
 18002*        DATASET  ('ELTRLR')
 18003*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18004*        RIDFLD   (ELTRLR-KEY)
 18005*    END-EXEC.
 18006     MOVE 'ELTRLR' TO DFHEIV1
 18007*    MOVE '&"S        E          (   #00016122' TO DFHEIV0
 18008     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18009     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18010     MOVE X'2020233030303136313232' TO DFHEIV0(25:11)
 18011     CALL 'kxdfhei1' USING DFHEIV0,
 18012           DFHEIV1,
 18013           DFHEIV20,
 18014           DFHEIV99,
 18015           ELTRLR-KEY,
 18016           DFHEIV99,
 18017           DFHEIV99,
 18018           DFHEIV99
 18019     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18020         DFHEIV20
 18021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18022
 18023
 18024 7950-EXIT.
 18025      EXIT.
 18026
 18027 7960-READ-TRAILER-UPDATE.
 18028
 18029* EXEC CICS READ
 18030*        DATASET  ('ELTRLR')
 18031*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18032*        RIDFLD   (ELTRLR-KEY)
 18033*        UPDATE
 18034*    END-EXEC.
 18035     MOVE 'ELTRLR' TO DFHEIV1
 18036*    MOVE '&"S        EU         (   #00016132' TO DFHEIV0
 18037     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18038     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18039     MOVE X'2020233030303136313332' TO DFHEIV0(25:11)
 18040     CALL 'kxdfhei1' USING DFHEIV0,
 18041           DFHEIV1,
 18042           DFHEIV20,
 18043           DFHEIV99,
 18044           ELTRLR-KEY,
 18045           DFHEIV99,
 18046           DFHEIV99,
 18047           DFHEIV99
 18048     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18049         DFHEIV20
 18050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18051
 18052
 18053 7960-EXIT.
 18054      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 351
* EL156.cbl
 18056 7970-READ-CERT.
 18057
 18058* EXEC CICS READ
 18059*        DATASET  ('ELCERT')
 18060*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 18061*        RIDFLD   (ELCERT-KEY)
 18062*    END-EXEC.
 18063     MOVE 'ELCERT' TO DFHEIV1
 18064*    MOVE '&"S        E          (   #00016143' TO DFHEIV0
 18065     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18066     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18067     MOVE X'2020233030303136313433' TO DFHEIV0(25:11)
 18068     CALL 'kxdfhei1' USING DFHEIV0,
 18069           DFHEIV1,
 18070           DFHEIV20,
 18071           DFHEIV99,
 18072           ELCERT-KEY,
 18073           DFHEIV99,
 18074           DFHEIV99,
 18075           DFHEIV99
 18076     SET ADDRESS OF CERTIFICATE-MASTER TO
 18077         DFHEIV20
 18078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18079
 18080
 18081 7970-EXIT.
 18082      EXIT.
 18083
 18084 7980-READ-CERT-UPDATE.
 18085
 18086* EXEC CICS READ
 18087*        DATASET  ('ELCERT')
 18088*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 18089*        RIDFLD   (ELCERT-KEY)
 18090*        UPDATE
 18091*    END-EXEC.
 18092     MOVE 'ELCERT' TO DFHEIV1
 18093*    MOVE '&"S        EU         (   #00016153' TO DFHEIV0
 18094     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18095     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18096     MOVE X'2020233030303136313533' TO DFHEIV0(25:11)
 18097     CALL 'kxdfhei1' USING DFHEIV0,
 18098           DFHEIV1,
 18099           DFHEIV20,
 18100           DFHEIV99,
 18101           ELCERT-KEY,
 18102           DFHEIV99,
 18103           DFHEIV99,
 18104           DFHEIV99
 18105     SET ADDRESS OF CERTIFICATE-MASTER TO
 18106         DFHEIV20
 18107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18108
 18109
 18110 7980-EXIT.
 18111      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 352
* EL156.cbl
 18113 8000-LOAD-ERROR-MESSAGES.
 18114     IF PI-PASS-SW = 'C'
 18115        MOVE EMI-LINE1           TO ERMSG1BO
 18116     ELSE
 18117        MOVE EMI-LINE1           TO ERRMSG1O
 18118        MOVE EMI-LINE2           TO ERRMSG2O.
 18119
 18120 8000-EXIT.
 18121     EXIT.
 18122
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 353
* EL156.cbl
 18124
 18125 8010-DMD-ERROR-CHECKS.
 18126     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 18127
 18128     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 18129         GO TO 8051-ISSUE-ERROR.
 18130
 18131     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 18132     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 18133     MOVE '3'                    TO DC-OPTION-CODE.
 18134     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 18135     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 18136         GO TO 8051-ISSUE-ERROR.
 18137
 18138     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 18139       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 18140                           OR
 18141          (CL-SSN-STATE   = CL-CERT-STATE  AND
 18142           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 18143             MOVE ER-0851         TO EMI-ERROR
 18144             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18145       END-IF
 18146       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 18147             MOVE ER-8147         TO EMI-ERROR
 18148             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18149
 18150     GO TO 8090-EXIT.
 18151
 18152 8051-ISSUE-ERROR.
 18153     MOVE ER-8146            TO EMI-ERROR.
 18154     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18155     GO TO 8090-EXIT.
 18156
 18157 8090-EXIT.
 18158      EXIT.
 18159
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 354
* EL156.cbl
 18161 8100-SEND-INITIAL-MAP.
 18162
 18163     MOVE SAVE-DATE              TO RUNDTEAO.
 18164     MOVE EIBTIME                TO TIME-IN.
 18165     MOVE TIME-OUT               TO RUNTIMAO.
 18166     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 18167
 18168     IF MAP-NAME = 'EL156A'
 18169        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 18170           MOVE 'PF6=EOB CODES'  TO PF6TITO
 18171        END-IF
 18172     END-IF
 18173*08059      IF MAP-NAME = 'EL156A'
 18174*08060         IF PI-COMPANY-ID = 'CRI'
 18175*08061            NEXT SENTENCE
 18176*08062         ELSE
 18177*08063            MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 18178
 18179     IF MAP-NAME = 'EL156A'
 18180        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 18181           NEXT SENTENCE
 18182        ELSE
 18183           MOVE AL-SADOF TO  PINTA    PINTHA.
 18184
 18185     IF MAP-NAME = 'EL156A'
 18186        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18187            NEXT SENTENCE
 18188        ELSE
 18189           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 18190
 18191*08077      IF MAP-NAME = 'EL156A'
 18192*08078         IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 18193*08079            NEXT SENTENCE
 18194*08080         ELSE
 18195*08081            MOVE AL-SADOF TO CASHHA CASHA.
 18196
 18197     IF MAP-NAME = 'EL156A'
 18198        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 18199           NEXT SENTENCE
 18200        ELSE
 18201           MOVE AL-SADOF        TO  LOANHA
 18202                                    LOANNOA.
 18203
 18204     IF MAP-NAME = 'EL156A'
 18205        MOVE -1                 TO  ENTERPFL
 18206        IF PI-USES-PAID-TO
 18207           MOVE 'PAID TO DATE :' TO PTHRHDGO
 18208           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 18209           MOVE PMT-HEAD-A      TO  PMTHDGAO
 18210        ELSE
 18211           NEXT SENTENCE
 18212     ELSE
 18213        IF MAP-NAME = 'EL156B'
 18214           IF PI-USES-PAID-TO
 18215              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 18216              MOVE PMT-HEAD-B     TO PMTHDGBO.
 18217
 18218
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 355
* EL156.cbl
 18219* EXEC CICS SEND
 18220*        MAP   (MAP-NAME)
 18221*        MAPSET(MAPSET-NAME)
 18222*        FROM  (EL156AI)
 18223*        ERASE
 18224*        CURSOR
 18225*    END-EXEC.
 18226     MOVE LENGTH OF
 18227      EL156AI
 18228       TO DFHEIV12
 18229     MOVE -1
 18230       TO DFHEIV11
 18231*    MOVE '8$     CT  E    H L F ,   #00016268' TO DFHEIV0
 18232     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 18233     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 18234     MOVE X'2020233030303136323638' TO DFHEIV0(25:11)
 18235     CALL 'kxdfhei1' USING DFHEIV0,
 18236           MAP-NAME,
 18237           EL156AI,
 18238           DFHEIV12,
 18239           MAPSET-NAME,
 18240           DFHEIV99,
 18241           DFHEIV99,
 18242           DFHEIV99,
 18243           DFHEIV11,
 18244           DFHEIV99,
 18245           DFHEIV99,
 18246           DFHEIV99
 18247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18248
 18249
 18250     GO TO 9100-RETURN-TRAN.
 18251
 18252 8200-SEND-DATAONLY.
 18253
 18254     IF FIRST-ENTRY = 'Y'
 18255         GO TO 8100-SEND-INITIAL-MAP.
 18256
 18257     IF RETURNED-FROM-B = 'Y'
 18258         GO TO 8100-SEND-INITIAL-MAP.
 18259
 18260     MOVE SAVE-DATE              TO RUNDTEAO.
 18261     MOVE EIBTIME                TO TIME-IN.
 18262     MOVE TIME-OUT               TO RUNTIMAO.
 18263
 18264     IF EIBAID = DFHPF11
 18265        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 18266        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18267        MOVE 'EL001   '          TO RETURNED-FROM
 18268        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 18269        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 18270        GO TO 8100-SEND-INITIAL-MAP.
 18271
 18272     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 18273
 18274     IF MAP-NAME =  'EL156A'
 18275        MOVE -1                 TO  ENTERPFL
 18276        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 356
* EL156.cbl
 18277           MOVE 'PAID TO DATE :' TO PTHRHDGO
 18278           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 18279           MOVE PMT-HEAD-A      TO  PMTHDGAO
 18280        ELSE
 18281           NEXT SENTENCE
 18282     ELSE
 18283        IF MAP-NAME = 'EL156B'
 18284           IF PI-USES-PAID-TO
 18285              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 18286              MOVE PMT-HEAD-B     TO PMTHDGBO.
 18287
 18288     IF MAP-NAME =  'EL156A'
 18289        IF PI-COMPANY-ID = 'BOA'
 18290            IF PI-INT-RATE NUMERIC
 18291                MOVE PI-INT-RATE TO PINTO.
 18292     IF MAP-NAME = 'EL156A'
 18293        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 18294           MOVE 'PF6=EOB CODES'  TO PF6TITO
 18295*          MOVE 'Y'              TO EOBYNO
 18296        END-IF
 18297     END-IF
 18298
 18299
 18300* EXEC CICS SEND
 18301*        MAP   (MAP-NAME)
 18302*        MAPSET(MAPSET-NAME)
 18303*        FROM  (EL156AI)
 18304*        DATAONLY
 18305*        CURSOR
 18306*    END-EXEC.
 18307     MOVE LENGTH OF
 18308      EL156AI
 18309       TO DFHEIV12
 18310     MOVE -1
 18311       TO DFHEIV11
 18312*    MOVE '8$D    CT       H L F ,   #00016325' TO DFHEIV0
 18313     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 18314     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 18315     MOVE X'2020233030303136333235' TO DFHEIV0(25:11)
 18316     CALL 'kxdfhei1' USING DFHEIV0,
 18317           MAP-NAME,
 18318           EL156AI,
 18319           DFHEIV12,
 18320           MAPSET-NAME,
 18321           DFHEIV99,
 18322           DFHEIV99,
 18323           DFHEIV99,
 18324           DFHEIV11,
 18325           DFHEIV99,
 18326           DFHEIV99,
 18327           DFHEIV99
 18328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18329
 18330
 18331     GO TO 9100-RETURN-TRAN.
 18332
 18333 8300-SEND-TEXT.
 18334
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 357
* EL156.cbl
 18335* EXEC CICS SEND TEXT
 18336*        FROM(LOGOFF-TEXT)
 18337*        LENGTH(LOGOFF-LENGTH)
 18338*        ERASE
 18339*        FREEKB
 18340*    END-EXEC.
 18341*    MOVE '8&      T  E F  H   F -   #00016336' TO DFHEIV0
 18342     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 18343     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 18344     MOVE X'2020233030303136333336' TO DFHEIV0(25:11)
 18345     CALL 'kxdfhei1' USING DFHEIV0,
 18346           LOGOFF-TEXT,
 18347           LOGOFF-LENGTH,
 18348           DFHEIV99,
 18349           DFHEIV99,
 18350           DFHEIV99,
 18351           DFHEIV99,
 18352           DFHEIV99,
 18353           DFHEIV99,
 18354           DFHEIV99,
 18355           DFHEIV99,
 18356           DFHEIV99,
 18357           DFHEIV99
 18358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18359
 18360
 18361
 18362* EXEC CICS RETURN
 18363*    END-EXEC.
 18364*    MOVE '.(                    ''   #00016343' TO DFHEIV0
 18365     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 18366     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18367     MOVE X'2020233030303136333433' TO DFHEIV0(25:11)
 18368     CALL 'kxdfhei1' USING DFHEIV0,
 18369           DFHEIV99,
 18370           DFHEIV99,
 18371           DFHEIV99,
 18372           DFHEIV99,
 18373           DFHEIV99,
 18374           DFHEIV99
 18375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18376
 18377
 18378 8500-FILE-NOTOPEN.
 18379     IF FILE-SWITCH = 'MSTR'
 18380         MOVE ER-0154            TO EMI-ERROR.
 18381     IF FILE-SWITCH = 'TRLR'
 18382         MOVE ER-0172            TO EMI-ERROR.
 18383     IF FILE-SWITCH = 'CERT'
 18384         MOVE ER-0169            TO EMI-ERROR.
 18385     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 18386                      'PROC' OR 'STAT'
 18387         MOVE ER-0042            TO EMI-ERROR.
 18388     IF FILE-SWITCH = 'ACTQ'
 18389         MOVE ER-0338            TO EMI-ERROR.
 18390     IF FILE-SWITCH = 'ACCT'
 18391         MOVE ER-0168            TO EMI-ERROR.
 18392
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 358
* EL156.cbl
 18393     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18394     MOVE -1                     TO PMTTYPEL.
 18395
 18396     IF FIRST-ENTRY = 'Y'
 18397         GO TO 8100-SEND-INITIAL-MAP.
 18398
 18399     GO TO 8200-SEND-DATAONLY.
 18400
 18401 8600-PGRM-NOT-FOUND.
 18402
 18403     MOVE ER-0923                TO EMI-ERROR.
 18404     MOVE -1                     TO ENTPFBL.
 18405     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18406
 18407     IF FIRST-ENTRY = 'Y'
 18408         GO TO 8100-SEND-INITIAL-MAP
 18409     ELSE
 18410         GO TO 8200-SEND-DATAONLY.
 18411
 18412 8800-UNAUTHORIZED-ACCESS.
 18413     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 18414     GO TO 8300-SEND-TEXT.
 18415
 18416 8810-PF23.
 18417     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 18418     MOVE XCTL-005               TO PGM-NAME.
 18419     GO TO 9300-XCTL.
 18420
 18421 8820-PF7-8.
 18422     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 18423     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 18424                                    PI-SAVED-PROGRAM-2
 18425                                    PI-SAVED-PROGRAM-3
 18426                                    PI-SAVED-PROGRAM-4
 18427                                    PI-SAVED-PROGRAM-5
 18428                                    PI-SAVED-PROGRAM-6
 18429                                    PI-RETURN-TO-PROGRAM.
 18430     IF EIBAID = DFHPF8
 18431        MOVE XCTL-132            TO PGM-NAME
 18432     ELSE
 18433        MOVE XCTL-130            TO PGM-NAME.
 18434
 18435     GO TO 9300-XCTL.
 18436
 18437 9100-RETURN-TRAN.
 18438     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 18439     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 18440
 18441
 18442* EXEC CICS RETURN
 18443*        TRANSID(TRANS-ID)
 18444*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 18445*        LENGTH(PI-COMM-LENGTH)
 18446*    END-EXEC.
 18447*    MOVE '.(CT                  ''   #00016409' TO DFHEIV0
 18448     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 18449     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18450     MOVE X'2020233030303136343039' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 359
* EL156.cbl
 18451     CALL 'kxdfhei1' USING DFHEIV0,
 18452           TRANS-ID,
 18453           PROGRAM-INTERFACE-BLOCK,
 18454           PI-COMM-LENGTH,
 18455           DFHEIV99,
 18456           DFHEIV99,
 18457           DFHEIV99
 18458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18459
 18460
 18461 9200-RETURN-MAIN-MENU.
 18462     MOVE XCTL-126               TO PGM-NAME.
 18463     GO TO 9300-XCTL.
 18464
 18465 9300-XCTL.
 18466
 18467* EXEC CICS XCTL
 18468*        PROGRAM(PGM-NAME)
 18469*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 18470*        LENGTH(PI-COMM-LENGTH)
 18471*    END-EXEC.
 18472*    MOVE '.$C                   %   #00016420' TO DFHEIV0
 18473     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 18474     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18475     MOVE X'2020233030303136343230' TO DFHEIV0(25:11)
 18476     CALL 'kxdfhei1' USING DFHEIV0,
 18477           PGM-NAME,
 18478           PROGRAM-INTERFACE-BLOCK,
 18479           PI-COMM-LENGTH,
 18480           DFHEIV99
 18481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18482
 18483
 18484 9400-CLEAR.
 18485     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 18486     GO TO 9300-XCTL.
 18487
 18488 9500-PF12.
 18489     MOVE XCTL-010               TO PGM-NAME.
 18490     GO TO 9300-XCTL.
 18491
 18492 9700-LINK-DATE-CONVERT.
 18493     MOVE LINK-ELDATCV           TO PGM-NAME.
 18494
 18495* EXEC CICS LINK
 18496*        PROGRAM   (PGM-NAME)
 18497*        COMMAREA  (DATE-CONVERSION-DATA)
 18498*        LENGTH    (DC-COMM-LENGTH)
 18499*    END-EXEC.
 18500*    MOVE '."C                   (   #00016436' TO DFHEIV0
 18501     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18502     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18503     MOVE X'2020233030303136343336' TO DFHEIV0(25:11)
 18504     CALL 'kxdfhei1' USING DFHEIV0,
 18505           PGM-NAME,
 18506           DATE-CONVERSION-DATA,
 18507           DC-COMM-LENGTH,
 18508           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 360
* EL156.cbl
 18509           DFHEIV99,
 18510           DFHEIV99,
 18511           DFHEIV99
 18512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18513
 18514
 18515 9700-EXIT.
 18516     EXIT.
 18517
 18518 9800-LINK-REM-TERM.
 18519     MOVE LINK-REMTERM TO PGM-NAME.
 18520
 18521
 18522* EXEC CICS LINK
 18523*        PROGRAM   (PGM-NAME)
 18524*        COMMAREA  (CALCULATION-PASS-AREA)
 18525*        LENGTH    (CP-COMM-LENGTH)
 18526*    END-EXEC.
 18527*    MOVE '."C                   (   #00016448' TO DFHEIV0
 18528     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18529     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18530     MOVE X'2020233030303136343438' TO DFHEIV0(25:11)
 18531     CALL 'kxdfhei1' USING DFHEIV0,
 18532           PGM-NAME,
 18533           CALCULATION-PASS-AREA,
 18534           CP-COMM-LENGTH,
 18535           DFHEIV99,
 18536           DFHEIV99,
 18537           DFHEIV99,
 18538           DFHEIV99
 18539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18540
 18541
 18542 9800-EXIT.
 18543     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 361
* EL156.cbl
 18545 9830-DMD-REMAINING-TERM.
 18546
 18547     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 18548         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 18549
 18550     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 18551                              CM-PMT-EXTENSION-DAYS.
 18552
 18553     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 18554                                  CL-NO-OF-DAYS-PAID.
 18555
 18556     DIVIDE W-REM-TERM-IN-DAYS BY +30
 18557         GIVING W-REM REMAINDER W-REM-DAYS.
 18558
 18559     MOVE W-REM                  TO WST-REM.
 18560
 18561     IF W-REM-DAYS > ZEROS
 18562         MOVE '/'                TO WST-SLASH
 18563         MOVE W-REM-DAYS         TO WST-REM-DAYS
 18564     ELSE
 18565         MOVE SPACES             TO WST-REM-DAYS-GRP.
 18566
 18567 9830-EXIT.
 18568     EXIT.
 18569
 18570 9870-OUTPUT-ACTIVITY-RECORD.
 18571
 18572
 18573* EXEC CICS GETMAIN
 18574*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 18575*         LENGTH(25)
 18576*         INITIMG(WS-BLANK)
 18577*    END-EXEC.
 18578     MOVE 25
 18579       TO DFHEIV11
 18580*    MOVE ',"IL                  $   #00016484' TO DFHEIV0
 18581     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18582     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18583     MOVE X'2020233030303136343834' TO DFHEIV0(25:11)
 18584     CALL 'kxdfhei1' USING DFHEIV0,
 18585           DFHEIV20,
 18586           DFHEIV11,
 18587           WS-BLANK
 18588     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 18589         DFHEIV20
 18590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18591
 18592
 18593     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 18594     MOVE ELMSTR-KEY             TO DA-KEY.
 18595     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 18596
 18597     IF PI-PMTTYPE EQUAL '7'
 18598         MOVE 'V'                TO DA-RECORD-TYPE
 18599     ELSE
 18600         MOVE 'P'                TO DA-RECORD-TYPE.
 18601
 18602
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 362
* EL156.cbl
 18603* EXEC CICS HANDLE CONDITION
 18604*         NOTOPEN(9870-NOTOPEN)
 18605*         DUPREC(9870-EXIT)
 18606*    END-EXEC.
 18607*    MOVE '"$J%                  ! B #00016499' TO DFHEIV0
 18608     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 18609     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18610     MOVE X'4220233030303136343939' TO DFHEIV0(25:11)
 18611     CALL 'kxdfhei1' USING DFHEIV0
 18612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18613
 18614
 18615
 18616* EXEC CICS WRITE
 18617*         DATASET('DLYACTV')
 18618*         RIDFLD(DA-KEY)
 18619*         FROM(DAILY-ACTIVITY-RECORD)
 18620*         LENGTH(25)
 18621*    END-EXEC.
 18622     MOVE 'DLYACTV' TO DFHEIV1
 18623     MOVE 25
 18624       TO DFHEIV11
 18625*    MOVE '&$ L                  ''   #00016504' TO DFHEIV0
 18626     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18627     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18628     MOVE X'2020233030303136353034' TO DFHEIV0(25:11)
 18629     CALL 'kxdfhei1' USING DFHEIV0,
 18630           DFHEIV1,
 18631           DAILY-ACTIVITY-RECORD,
 18632           DFHEIV11,
 18633           DA-KEY,
 18634           DFHEIV99,
 18635           DFHEIV99
 18636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18637
 18638     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 18639     GO TO 9870-EXIT.
 18640
 18641 9870-NOTOPEN.
 18642
 18643     MOVE '2955'                 TO EMI-ERROR.
 18644     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 18645
 18646 9870-EXIT.
 18647     EXIT.
 18648
 18649 9900-ERROR-FORMAT.
 18650
 18651     IF EMI-ERROR = ER-0923
 18652         MOVE PGM-NAME           TO W-CALLED-NAME.
 18653
 18654     MOVE LINK-001      TO PGM-NAME.
 18655     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 18656
 18657
 18658* EXEC CICS LINK
 18659*        PROGRAM (PGM-NAME)
 18660*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 363
* EL156.cbl
 18661*        LENGTH  (EMI-COMM-LENGTH)
 18662*    END-EXEC.
 18663*    MOVE '."C                   (   #00016529' TO DFHEIV0
 18664     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18665     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18666     MOVE X'2020233030303136353239' TO DFHEIV0(25:11)
 18667     CALL 'kxdfhei1' USING DFHEIV0,
 18668           PGM-NAME,
 18669           ERROR-MESSAGE-INTERFACE-BLOCK,
 18670           EMI-COMM-LENGTH,
 18671           DFHEIV99,
 18672           DFHEIV99,
 18673           DFHEIV99,
 18674           DFHEIV99
 18675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18676
 18677
 18678     IF EMI-ERROR = ER-0923
 18679         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 18680
 18681 9900-EXIT.
 18682     EXIT.
 18683
 18684 9990-ABEND.
 18685     MOVE LINK-004               TO PGM-NAME.
 18686     MOVE DFHEIBLK               TO EMI-LINE1.
 18687
 18688* EXEC CICS LINK
 18689*        PROGRAM   (PGM-NAME)
 18690*        COMMAREA  (EMI-LINE1)
 18691*        LENGTH    (64)
 18692*    END-EXEC.
 18693     MOVE 64
 18694       TO DFHEIV11
 18695*    MOVE '."C                   (   #00016544' TO DFHEIV0
 18696     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18697     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18698     MOVE X'2020233030303136353434' TO DFHEIV0(25:11)
 18699     CALL 'kxdfhei1' USING DFHEIV0,
 18700           PGM-NAME,
 18701           EMI-LINE1,
 18702           DFHEIV11,
 18703           DFHEIV99,
 18704           DFHEIV99,
 18705           DFHEIV99,
 18706           DFHEIV99
 18707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18708
 18709
 18710     MOVE 'EL156A'               TO  MAP-NAME.
 18711     MOVE LOW-VALUES             TO  EL156AO.
 18712     GO TO 8100-SEND-INITIAL-MAP.
 18713
 18714 9995-SECURITY-VIOLATION.
 18715*    COPY ELCSCTP.
 18716******************************************************************
 18717*                                                                *
 18718*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 364
* EL156.cbl
 18719*                            VMOD=2.001                          *
 18720*                                                                *
 18721*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 18722******************************************************************
 18723
 18724
 18725     MOVE EIBDATE          TO SM-JUL-DATE.
 18726     MOVE EIBTRMID         TO SM-TERMID.
 18727     MOVE THIS-PGM         TO SM-PGM.
 18728     MOVE EIBTIME          TO TIME-IN.
 18729     MOVE TIME-OUT         TO SM-TIME.
 18730     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 18731
 18732
 18733* EXEC CICS LINK
 18734*         PROGRAM  ('EL003')
 18735*         COMMAREA (SECURITY-MESSAGE)
 18736*         LENGTH   (80)
 18737*    END-EXEC.
 18738     MOVE 'EL003' TO DFHEIV1
 18739     MOVE 80
 18740       TO DFHEIV11
 18741*    MOVE '."C                   (   #00016572' TO DFHEIV0
 18742     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18743     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18744     MOVE X'2020233030303136353732' TO DFHEIV0(25:11)
 18745     CALL 'kxdfhei1' USING DFHEIV0,
 18746           DFHEIV1,
 18747           SECURITY-MESSAGE,
 18748           DFHEIV11,
 18749           DFHEIV99,
 18750           DFHEIV99,
 18751           DFHEIV99,
 18752           DFHEIV99
 18753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18754
 18755
 18756******************************************************************
 18757
 18758
 18759
 18760 9999-DFHBACK SECTION.
 18761     MOVE '9%                    "   ' TO DFHEIV0
 18762     MOVE 'EL156' TO DFHEIV1
 18763     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18764     GOBACK.
 18765 9999-DFHEXIT.
 18766     IF DFHEIGDJ EQUAL 0001
 18767         NEXT SENTENCE
 18768     ELSE IF DFHEIGDJ EQUAL 2
 18769         GO TO 9990-ABEND,
 18770               8600-PGRM-NOT-FOUND,
 18771               0400-FIRST-TIME,
 18772               6180-DUPREC,
 18773               9990-ABEND
 18774         DEPENDING ON DFHEIGDI
 18775     ELSE IF DFHEIGDJ EQUAL 3
 18776         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 365
* EL156.cbl
 18777               0380-CLAIM-END-FILE
 18778         DEPENDING ON DFHEIGDI
 18779     ELSE IF DFHEIGDJ EQUAL 4
 18780         GO TO 0380-CLAIM-END-FILE,
 18781               0380-CLAIM-END-FILE
 18782         DEPENDING ON DFHEIGDI
 18783     ELSE IF DFHEIGDJ EQUAL 5
 18784         GO TO 0800-EXIT
 18785         DEPENDING ON DFHEIGDI
 18786     ELSE IF DFHEIGDJ EQUAL 6
 18787         GO TO 1950-NOT-FOUND,
 18788               1950-NOT-FOUND
 18789         DEPENDING ON DFHEIGDI
 18790     ELSE IF DFHEIGDJ EQUAL 7
 18791         GO TO 1950-NOT-FOUND
 18792         DEPENDING ON DFHEIGDI
 18793     ELSE IF DFHEIGDJ EQUAL 8
 18794         GO TO 1950-NOT-FOUND,
 18795               1950-NOT-FOUND
 18796         DEPENDING ON DFHEIGDI
 18797     ELSE IF DFHEIGDJ EQUAL 9
 18798         GO TO 1166-END-CHECK,
 18799               1166-END-CHECK
 18800         DEPENDING ON DFHEIGDI
 18801     ELSE IF DFHEIGDJ EQUAL 10
 18802         GO TO 1950-NOT-FOUND,
 18803               1950-NOT-FOUND
 18804         DEPENDING ON DFHEIGDI
 18805     ELSE IF DFHEIGDJ EQUAL 11
 18806         GO TO 1950-NOT-FOUND,
 18807               1950-NOT-FOUND
 18808         DEPENDING ON DFHEIGDI
 18809     ELSE IF DFHEIGDJ EQUAL 12
 18810         GO TO 1950-NOT-FOUND
 18811         DEPENDING ON DFHEIGDI
 18812     ELSE IF DFHEIGDJ EQUAL 13
 18813         GO TO 3600-CONTINUE
 18814         DEPENDING ON DFHEIGDI
 18815     ELSE IF DFHEIGDJ EQUAL 14
 18816         GO TO 5300-NOTE-NOT-FOUND
 18817         DEPENDING ON DFHEIGDI
 18818     ELSE IF DFHEIGDJ EQUAL 15
 18819         GO TO 6065-NOT-FOUND
 18820         DEPENDING ON DFHEIGDI
 18821     ELSE IF DFHEIGDJ EQUAL 16
 18822         GO TO 6068-ACCT-NOT-FND
 18823         DEPENDING ON DFHEIGDI
 18824     ELSE IF DFHEIGDJ EQUAL 17
 18825         GO TO 6074-GET-COMP-DATA
 18826         DEPENDING ON DFHEIGDI
 18827     ELSE IF DFHEIGDJ EQUAL 18
 18828         GO TO 6170-WRITE
 18829         DEPENDING ON DFHEIGDI
 18830     ELSE IF DFHEIGDJ EQUAL 19
 18831         GO TO 6180-DUPREC
 18832         DEPENDING ON DFHEIGDI
 18833     ELSE IF DFHEIGDJ EQUAL 20
 18834         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 09-Apr-13 12:13 Page 366
* EL156.cbl
 18835         DEPENDING ON DFHEIGDI
 18836     ELSE IF DFHEIGDJ EQUAL 21
 18837         GO TO 6185-DUPREC
 18838         DEPENDING ON DFHEIGDI
 18839     ELSE IF DFHEIGDJ EQUAL 22
 18840         GO TO 6720-BUILD-NEW-RECORD
 18841         DEPENDING ON DFHEIGDI
 18842     ELSE IF DFHEIGDJ EQUAL 23
 18843         GO TO 6900-BUILD-ARCHIVE-HEADER,
 18844               6900-BUILD-ARCHIVE-HEADER
 18845         DEPENDING ON DFHEIGDI
 18846     ELSE IF DFHEIGDJ EQUAL 24
 18847         GO TO 7010-BUILD-MAP
 18848         DEPENDING ON DFHEIGDI
 18849     ELSE IF DFHEIGDJ EQUAL 25
 18850         GO TO 7100-SHOW-RECORD-NOT-FOUND
 18851         DEPENDING ON DFHEIGDI
 18852     ELSE IF DFHEIGDJ EQUAL 26
 18853         GO TO 7160-DUPREC
 18854         DEPENDING ON DFHEIGDI
 18855     ELSE IF DFHEIGDJ EQUAL 27
 18856         GO TO 7200-EXIT,
 18857               7200-EXIT
 18858         DEPENDING ON DFHEIGDI
 18859     ELSE IF DFHEIGDJ EQUAL 28
 18860         GO TO 7400-NOT-FOUND
 18861         DEPENDING ON DFHEIGDI
 18862     ELSE IF DFHEIGDJ EQUAL 29
 18863         GO TO 7590-END,
 18864               7590-END
 18865         DEPENDING ON DFHEIGDI
 18866     ELSE IF DFHEIGDJ EQUAL 30
 18867         GO TO 7699-EXIT
 18868         DEPENDING ON DFHEIGDI
 18869     ELSE IF DFHEIGDJ EQUAL 31
 18870         GO TO 5300-NOTE-NOT-FOUND
 18871         DEPENDING ON DFHEIGDI
 18872     ELSE IF DFHEIGDJ EQUAL 32
 18873         GO TO 7800-COMP-NOTFND
 18874         DEPENDING ON DFHEIGDI
 18875     ELSE IF DFHEIGDJ EQUAL 33
 18876         GO TO 7920-NOT-FOUND
 18877         DEPENDING ON DFHEIGDI
 18878     ELSE IF DFHEIGDJ EQUAL 34
 18879         GO TO 9870-NOTOPEN,
 18880               9870-EXIT
 18881         DEPENDING ON DFHEIGDI.
 18882     MOVE '9%                    "   ' TO DFHEIV0
 18883     MOVE 'EL156' TO DFHEIV1
 18884     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18885     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       11764     Code:       68199
