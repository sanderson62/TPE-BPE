* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53******************************************************************
    54 ENVIRONMENT DIVISION.
    55
    56 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page   3
* EL050.cbl
    58 WORKING-STORAGE SECTION.
    59 01  DFH-START PIC X(04).
    60
    61 77  FILLER   PIC X(32) VALUE '********************************'.
    62 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    63 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    64
    65 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    66 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    67                                   USAGE POINTER.
    68 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    69 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    70 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    71                                   USAGE IS POINTER.
    72 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    73 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    74                                   USAGE IS POINTER.
    75 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    76 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    77                                   USAGE IS POINTER.
    78
    79 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    80 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    81                                   USAGE IS POINTER.
    82
    83*    COPY ELC50WS.
    84*****************************************************************
    85*                                                               *
    86*                            ELC50WS.                           *
    87*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    88*                            VMOD=2.061.                        *
    89*                                                               *
    90*   THIS IS THE WORKING STORAGE FOR EL050                       *
    91*                                   EL517                       *
    92*****************************************************************
    93******************************************************************
    94*                   C H A N G E   L O G
    95*
    96* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    97*-----------------------------------------------------------------
    98*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    99* EFFECTIVE    NUMBER
   100*-----------------------------------------------------------------
   101* 123102                   PEMA  ADD DCC PROCESSING
   102* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   103* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   104* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   105* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   106* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   107* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   108* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   109* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   110* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   111* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   112* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   113* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   114* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   115* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page   4
* EL050.cbl
   116* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   117* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   118* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   119* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   120* 030309  CR2009021700001  PEMA  ADD ER-2883
   121* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   122* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   123* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   124* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   125* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   126* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   127* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   128* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   129* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   130* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   131* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   132* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   133* 061412  CR2011022800001  AJRA  NAPERSOFT
   134* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   135* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   136* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   137* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   138* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   139* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   140* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   141* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   142* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   143* 091114  IR2014091000001  TANA  ADD ERROR 2898
   144*-----------------------------------------------------------------
   145
   146 01  WORK-AREAS.
   147
   148*****************************************************************
   149*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   150*****************************************************************
   151
   152     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   153     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   154     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   155     12  WS-NAME-EDIT-WORK-AREA.
   156         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   157         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   158             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   159         16  WS-WORK-NAME.
   160             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   161             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   162             20  FILLER           PIC X(10)     VALUE SPACES.
   163         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   164             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   165
   166*****************************************************************
   167*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   168*****************************************************************
   169
   170     12  WS-ERRESC-KEY.
   171         16 WS-ERRESC-SEARCH-KEY.
   172             20  WS-ERRESC-COMPANY-CD PIC  X.
   173             20  WS-ERRESC-CARRIER    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page   5
* EL050.cbl
   174             20  WS-ERRESC-GROUP      PIC X(6).
   175             20  WS-ERRESC-STATE      PIC XX.
   176             20  WS-ERRESC-ACCOUNT    PIC X(10).
   177         16 WS-ERRESC-RESIDUAL-KEY.
   178             20  WS-ERRESC-AGENT      PIC X(10).
   179             20  WS-ERRESC-RES-STATE  PIC XX.
   180             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   181*                                          YYYYMMDD
   182     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   183     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   184
   185*RESIDENT STATE TAX MASTER(ERRESS)
   186*
   187     12  WS-ERRESS-KEY.
   188         16  WS-ERRESS-COMPANY-CD      PIC  X.
   189         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   190         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   191         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   192*                                          YYYYMMDD
   193
   194     12  WS-CONTRACT-DATE              PIC 9(8).
   195*                                          YYYYMMDD
   196     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   197     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   198         16 WS-YEAR-YY                 PIC   9999.
   199         16 FILLER                     PIC 9(4).
   200*                                          YYYYMMDD
   201     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   202     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   203     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   204     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   205
   206     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   207         88  DPRB-1ST-TIME                      VALUE ' '.
   208
   209*****************************************************************
   210*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   211*****************************************************************
   212
   213     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   214     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   215     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   216     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   217     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   218     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   219     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   220     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   221     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   222     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   223     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   224         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   225         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   226     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   227         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   228         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   229     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   230
   231     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page   6
* EL050.cbl
   232     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   233
   234     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   235     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   240     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   241     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   245     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   246     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   248     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   249     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   250     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   251     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   265     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   266     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   267     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   268     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   270     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   271     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   272     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   273     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   274     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   275     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   276     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   277     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   278     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   279     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   280     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   282     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   283     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   284     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   285     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   286     12  WS-2671-SW               PIC X         VALUE SPACE.
   287     12  WS-2672-SW               PIC X         VALUE SPACE.
   288     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   289         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page   7
* EL050.cbl
   290     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   291         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   292     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   293
   294     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   295         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   296         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   297         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   298         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   299
   300     12  WS-CREDIT-EDIT-CONTROLS.
   301         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   302         16  WS-MIN-AGE           PIC 99                VALUE  0.
   303         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   304         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   305         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   306         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   307
   308     12  WS-AGE-FIELDS.
   309         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   310         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   311         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   312         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   313
   314     12  WS-SAVE-ALLOWABLE-BENEFIT.
   315         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   316         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   317         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   318         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   319         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   320         16  FILLER                      PIC XX.
   321
   322     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   323     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   324     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   325     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   326     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   327     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   328     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   329     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   330     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   331     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   332
   333     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   334     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   335     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   336     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   337     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   338     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   339     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   340     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   341         88  WS-REDUCING              VALUE 'R'.
   342         88  WS-LEVEL                 VALUE 'L' 'P'.
   343     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   344
   345     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   346     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   347     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page   8
* EL050.cbl
   348     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   349     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   350     12  ws-ah-max-bens           pic 99        value zeros.
   351     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   352     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   353     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   354     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   355
   356     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   357     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   358     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   359     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   360     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   361     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   362     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   363     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   364     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   365     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   366     12  WS-ACCT-SIG-SW.
   367         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   368         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   369     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   370     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   371     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   372     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   373     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   374     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   375     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   376     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   377     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   378     12  WS-INITIALS.
   379         16  WS-INIT-1            PIC X         VALUE SPACES.
   380         16  WS-INIT-2            PIC X         VALUE SPACES.
   381
   382     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   383     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   384     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   385     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   386     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   387*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   388     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   389     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   390     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   391     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   392     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   393     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   394     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   395     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   396     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   397     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   398     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   399     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   400     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   401     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   402     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   403     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   404     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   405     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page   9
* EL050.cbl
   406     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   407     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   408     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   409     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   410******** FLA
   411     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   412     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   413     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   414     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   415     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   416********
   417     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   418     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   419     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   420     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   421     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   422     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   423     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   424     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   425     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   426     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   427
   428     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   429         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   430                                         '0' THRU '9'.
   431
   432     12  NUMBER-OF-MONTHS.
   433         16  SK-MO OCCURS 12 TIMES PIC X.
   434
   435     12  WS-WORK-DATE.
   436         16  WS-YEAR            PIC 99    VALUE 00.
   437         16  WS-MONTH           PIC 99    VALUE 00.
   438         16  WS-DAY             PIC 99    VALUE 00.
   439
   440     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   441     12  WS-WORK-CRIT-DEV       REDEFINES
   442         WS-WORK-LF-CRIT-PER    PIC X(03).
   443
   444     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   445     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   446
   447     12  WS-WORK-DATE-FROM.
   448         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   449         16  FILLER             PIC X  VALUE SPACE.
   450         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   451         16  FILLER             PIC X         VALUE SPACE.
   452         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   453
   454     12  WS-WORK-DATE-THRU.
   455         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   456         16  FILLER             PIC X         VALUE SPACE.
   457         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   458         16  FILLER             PIC X         VALUE SPACE.
   459         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   460
   461     12  WS-LF-INPUT-CD.
   462         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   463         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  10
* EL050.cbl
   464
   465     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   466     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   467         16  WS-AH-INPUT-CD-1   PIC X.
   468         16  WS-AH-INPUT-CD-2-3 PIC XX.
   469
   470     12  WS-SWITCHES.
   471         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   472         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   473             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   474         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   475             88  BANK-ACCT-FOUND          VALUE 'Y'.
   476         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   477             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   478         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   479             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   480         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   481             88  COMP-MASTER-FOUND        VALUE 'Y'.
   482         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   483             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   484         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   485             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   486         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   487             88  STAT-MASTER-FOUND        VALUE 'Y'.
   488         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   489             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   490         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   491             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   492         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   493             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   494         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   495             88  FORM-MASTER-FOUND        VALUE 'Y'.
   496         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   497             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   498         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   499             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   500         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   501             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   502         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   503             88  NO-BENEFIT-FOUND         VALUE 'N'.
   504         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   505             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   506         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   507             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   508         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   509             88  AH-BENEFIT-FOUND         VALUE ' '.
   510             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   511         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   512             88  LF-BENEFIT-FOUND         VALUE ' '.
   513             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   514         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   515             88  NO-STATE-RECORD          VALUE '1'.
   516         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   517             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   518         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   519             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   520         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   521             88  CERT-WAS-FOUND           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  11
* EL050.cbl
   522             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   523         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   524             88  BROWSE-STARTED           VALUE 'Y'.
   525         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   526             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   527         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   528             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   529         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   530             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   531         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   532             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   533         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   534             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   535         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   536             88  APP-CERT-USED            VALUE 'Y' 'A'.
   537         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   538             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   539             88  FIRST-TIME-THROUGH       VALUE '1'.
   540             88  CTBL-NOT-FOUND           VALUE '2'.
   541
   542         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   543             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   544
   545         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   546             88  DLO-ERROR-FOUND          VALUE 'Y'.
   547
   548********FLA
   549     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   550     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   551********
   552     12  RC-SW-1                  PIC X           VALUE '0'.
   553     12  RC-SW-2                  PIC X           VALUE '0'.
   554     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   555     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   556     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   557     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   558     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   559     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   560     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   561     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   562     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   563     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   564     12  LIT-SPACES               PIC X           VALUE SPACES.
   565     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   566     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   567     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   568     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   569     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   570     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   571     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   572         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   573         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   574     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   575         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   576
   577 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   578     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   579     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  12
* EL050.cbl
   580 01  WS-CRI-SSN-WORK-AREA.
   581     05  WS-CRI-SOC-SEC-NO.
   582         10  WS-SS-REPT-CD       PIC X(5).
   583         10  WS-SS-LAST-NAME     PIC X(5).
   584         10  WS-SS-INITIAL       PIC X.
   585
   586     05  WS-CRI-REPORT-CODE.
   587         10  FILLER              PIC X(5).
   588         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   589
   590     05  WS-CRI-LAST-NAME.
   591         10  WS-CRI-NAME-MOVE    PIC X(5).
   592         10  FILLER              PIC X(10).
   593
   594 01  WS-NUM-TABLE                PIC X(26)  VALUE
   595     '12345678012345070923456789'.
   596 01  FILLER REDEFINES WS-NUM-TABLE.
   597     05  WS-NUM OCCURS 26        PIC 9.
   598 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   599 01  V1                          PIC S999 COMP-3.
   600 01  V2                          PIC S999 COMP-3.
   601 01  V3                          PIC S999 COMP-3.
   602 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   603 01  FILLER REDEFINES WS-WORK-VIN.
   604     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   605 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   606 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   607 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   608 01  WS-HEX-WORK.
   609     05  FILLER                  PIC X  VALUE LOW-VALUES.
   610     05  WS-HEX-BYTE             PIC X.
   611 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   612 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   613 01  WS-WORK-HIN-ROW-B.
   614     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   615
   616 01  ws-benefit-cd-chg-sw      pic x value spaces.
   617     88  benefit-code-chg           value 'Y'.
   618 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   619 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   620     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   621 01  WS-ROW-D-TABLE.
   622     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   623
   624 01  WS-HIN-TABLE-B.
   625     05  F                       PIC XX VALUE 'A2'.
   626     05  F                       PIC XX VALUE 'B3'.
   627     05  F                       PIC XX VALUE 'C4'.
   628     05  F                       PIC XX VALUE 'D5'.
   629     05  F                       PIC XX VALUE 'E6'.
   630     05  F                       PIC XX VALUE 'F7'.
   631     05  F                       PIC XX VALUE 'G8'.
   632     05  F                       PIC XX VALUE 'H9'.
   633     05  F                       PIC XX VALUE 'I1'.
   634     05  F                       PIC XX VALUE 'J2'.
   635     05  F                       PIC XX VALUE 'K3'.
   636     05  F                       PIC XX VALUE 'L4'.
   637     05  F                       PIC XX VALUE 'M5'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  13
* EL050.cbl
   638     05  F                       PIC XX VALUE 'N6'.
   639     05  F                       PIC XX VALUE 'O0'.
   640     05  F                       PIC XX VALUE 'P7'.
   641     05  F                       PIC XX VALUE 'Q0'.
   642     05  F                       PIC XX VALUE 'R8'.
   643     05  F                       PIC XX VALUE 'S9'.
   644     05  F                       PIC XX VALUE 'T2'.
   645     05  F                       PIC XX VALUE 'U3'.
   646     05  F                       PIC XX VALUE 'V4'.
   647     05  F                       PIC XX VALUE 'W5'.
   648     05  F                       PIC XX VALUE 'X6'.
   649     05  F                       PIC XX VALUE 'Y7'.
   650     05  F                       PIC XX VALUE 'Z8'.
   651 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   652     05  WS-VAL-IN               PIC X.
   653     05  WS-VAL-OUT              PIC 9.
   654 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   655 01  WS-COMPARE-BINARY-DATES.
   656     05  WS-971231                PIC XX VALUE X'92FF'.
   657     05  WS-931231                PIC XX VALUE X'8CFF'.
   658     05  WS-791231                PIC XX VALUE X'77FF'.
   659     05  WS-771001                PIC XX VALUE X'74A1'.
   660     05  WS-820301                PIC XX VALUE X'7B41'.
   661     05  WS-831031                PIC XX VALUE X'7DBF'.
   662     05  WS-831231                PIC XX VALUE X'7DFF'.
   663     05  WS-810831                PIC XX VALUE X'7A7F'.
   664     05  WS-830901                PIC XX VALUE X'7D81'.
   665
   666 01  FILE-ACCESS-IDS.
   667     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   668     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   669     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   670     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   671     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   672     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   673     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   674     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   675     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   676     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   677     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   678     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   679     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   680     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   681     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   682     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   683     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   684 01  DD-IU-SW                    PIC X   VALUE ' '.
   685     88  DD-IU-PRESENT                 VALUE 'Y'.
   686
   687 01  ACCESS-KEYS.
   688     12  ELMSTR-KEY.
   689         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   690         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   691     12  W-CLAIM-KEY.
   692         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   693         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   694
   695     12  ELCNTL-KEY.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  14
* EL050.cbl
   696         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   697         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   698         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   699         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   700
   701     12  ELCERT-KEY.
   702         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   703         16  CERT-CARRIER         PIC X       VALUE SPACE.
   704         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   705         16  CERT-STATE           PIC XX      VALUE SPACES.
   706         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   707         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   708         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   709
   710     12  ELCERT2-KEY.
   711         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   712         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   713
   714     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   715
   716     12  ELCERT-SAVE.
   717         16  FILLER                      PIC XX    VALUE SPACES.
   718
   719         16  WCS-CONTROL-PRIMARY.
   720             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   721             20  WCS-CARRIER             PIC X     VALUE SPACE.
   722             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   723             20  WCS-STATE               PIC XX    VALUE SPACES.
   724             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   725             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   726             20  WCS-CERT-NO.
   727                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   728                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   729
   730         16  CS-CONTROL-BY-NAME.
   731             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   732             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   733             20  CS-INSURED-INITIALS.
   734                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   735                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   736
   737         16  CS-CONTROL-BY-SSN.
   738             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   739             20  CS-SOC-SEC-NO.
   740                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   741                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   742                 24  CS-SSN-LN3.
   743                     28 CS-INSURED-INITIALS-A2   PIC XX
   744                                     VALUE SPACES.
   745                     28 CS-PART-LAST-NAME-A2     PIC X
   746                                     VALUE SPACE.
   747
   748         16  CS-CONTROL-BY-CERT-NO.
   749             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   750             20  CS-CERT-NO-A4           PIC X(11)
   751                                     VALUE SPACES.
   752
   753         16  CS-CONTROL-BY-MEMB.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  15
* EL050.cbl
   754             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   755             20  CS-MEMBER-NO.
   756                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   757                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   758                 24  CS-MEMB-LN4.
   759                     28 CS-INSURED-INITIALS-A5   PIC XX
   760                                      VALUE SPACES.
   761                     28 CS-PART-LAST-NAME-A5     PIC XX
   762                                      VALUE SPACES.
   763
   764         16  FILLER              PIC X(360) VALUE SPACES.
   765
   766     12  ERACCT-KEY.
   767         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   768         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   769         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   770         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   771         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   772         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   773
   774     12  ERCOMP-KEY.
   775         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   776         16  COMP-CARRIER         PIC X     VALUE SPACES.
   777         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   778         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   779         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   780         16  COMP-TYPE            PIC X     VALUE SPACES.
   781
   782     12  ERLOFC-KEY.
   783         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   784         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   785         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   786         16  LOFC-STATE           PIC XX    VALUE SPACES.
   787         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   788         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   789
   790     12  WS-ELCRTT-KEY.
   791         16  WS-ELCRTT-PRIMARY       PIC X(33).
   792         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   793
   794     12  ERBXRF-KEY.
   795         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   796         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   797         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   798         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   799
   800     12  ERAGTC-KEY.
   801         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   802         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   803         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   804         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   805         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   806         16  AGTC-TYPE            PIC X     VALUE SPACES.
   807
   808     12  ERPLAN-KEY.
   809         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   810         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   811         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  16
* EL050.cbl
   812         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   813         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   814         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   815         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   816         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   817
   818     12  ERFORM-KEY.
   819         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   820         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   821         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   822         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   823
   824     12  ERREIN-KEY.
   825         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   826         16  REIN-TYPE            PIC X     VALUE SPACES.
   827         16  REIN-TABLE-CO.
   828             20  REIN-CODE-1      PIC X     VALUE SPACE.
   829             20  REIN-CODE-2      PIC X     VALUE SPACE.
   830             20  REIN-CODE-3      PIC X     VALUE SPACE.
   831         16  FILLER               PIC X(3)  VALUE SPACES.
   832
   833     12  ERCTBL-KEY.
   834         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   835         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   836         16  CTBL-CNTRL-2.
   837             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   838             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   839
   840     12  ELCRTO-KEY.
   841         16  ELCRTO-COMPANY-CD       PIC X.
   842         16  ELCRTO-CARRIER          PIC X.
   843         16  ELCRTO-GROUPING         PIC X(6).
   844         16  ELCRTO-STATE            PIC XX.
   845         16  ELCRTO-ACCOUNT          PIC X(10).
   846         16  ELCRTO-CERT-EFF-DT      PIC XX.
   847         16  ELCRTO-CERT-NO.
   848             20  ELCRTO-CERT-PRIME   PIC X(10).
   849             20  ELCRTO-CERT-SFX     PIC X.
   850         16  ELCRTO-RECORD-TYPE      PIC X.
   851         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   852
   853
   854     12  WS-ACCESS.
   855         16  FILLER               PIC XX    VALUE SPACES.
   856         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   857
   858     12  WS-CARR-ACCESS.
   859         16  FILLER               PIC X(3)  VALUE SPACES.
   860         16  WS-CARR              PIC X     VALUE SPACE.
   861*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   862*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   863     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   864         88  WS-DMD-LF-RATING   VALUE 'Y'.
   865         88  WS-DMD-AH-RATING   VALUE 'Y'.
   866         88  WS-DMD-NO-RATING   VALUE 'N'.
   867
   868     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   869         88  WS-LF-CASH            VALUE 'MJ' 'MS'
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  17
* EL050.cbl
   870                                         'NJ' 'NL'
   871                                         'PJ' 'PL'
   872                                         'SJ' 'SL'.
   873     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   874         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   875                                         'NI' 'NJ' 'NL' 'NU'
   876                                         'PJ' 'PL' 'PI' 'PU'
   877                                         'SI' 'SJ' 'SL' 'SU'
   878                                         'MX' 'MY' 'MZ'.
   879 01  ERPDEF-KEY-SAVE             PIC X(18).
   880 01  ERPDEF-KEY.
   881     12  ERPDEF-COMPANY-CD       PIC X.
   882     12  ERPDEF-STATE            PIC XX.
   883     12  ERPDEF-PROD-CD          PIC XXX.
   884     12  F                       PIC X(7).
   885     12  ERPDEF-BEN-TYPE         PIC X.
   886     12  ERPDEF-BEN-CODE         PIC XX.
   887     12  ERPDEF-EXP-DT           PIC XX.
   888
   889 01  ELSTAT-KEY-SAVE             PIC X(20).
   890 01  ELSTAT-KEY.
   891     12  ELSTAT-COMPANY-ID       PIC XXX.
   892     12  ELSTAT-CARRIER          PIC X.
   893     12  ELSTAT-GROUP            PIC X(6).
   894     12  ELSTAT-STATE            PIC XX.
   895     12  ELSTAT-EXP-DT           PIC 9(8).
   896 01  WS-ERROR-VALUES.
   897     12  ER-1570                     PIC S9(4)   VALUE +1570.
   898     12  ER-1571                     PIC S9(4)   VALUE +1571.
   899     12  er-1572                     pic s9(4)   value +1572.
   900     12  er-1573                     pic s9(4)   value +1573.
   901     12  er-1574                     pic s9(4)   value +1574.
   902     12  ER-1575                     PIC S9(4)   VALUE +1575.
   903     12  er-1576                     pic s9(4)   value +1576.
   904     12  ER-1891                     PIC S9(4)   VALUE +1891.
   905     12  ER-1892                     PIC S9(4)   VALUE +1892.
   906     12  ER-1893                     PIC S9(4)   VALUE +1893.
   907     12  ER-1894                     PIC S9(4)   VALUE +1894.
   908     12  ER-1895                     PIC S9(4)   VALUE +1895.
   909     12  ER-1896                     PIC S9(4)   VALUE +1896.
   910     12  ER-1897                     PIC S9(4)   VALUE +1897.
   911     12  ER-1898                     PIC S9(4)   VALUE +1898.
   912     12  ER-1899                     PIC S9(4)   VALUE +1899.
   913     12  ER-1900                     PIC S9(4)   VALUE +1900.
   914     12  ER-1901                     PIC S9(4)   VALUE +1901.
   915     12  ER-1902                     PIC S9(4)   VALUE +1902.
   916     12  ER-1903                     PIC S9(4)   VALUE +1903.
   917     12  ER-1904                     PIC S9(4)   VALUE +1904.
   918     12  ER-1905                     PIC S9(4)   VALUE +1905.
   919     12  ER-1906                     PIC S9(4)   VALUE +1906.
   920     12  ER-1907                     PIC S9(4)   VALUE +1907.
   921     12  ER-1909                     PIC S9(4)   VALUE +1909.
   922     12  ER-1910                     PIC S9(4)   VALUE +1910.
   923     12  ER-1911                     PIC S9(4)   VALUE +1911.
   924     12  ER-1912                     PIC S9(4)   VALUE +1912.
   925     12  ER-1913                     PIC S9(4)   VALUE +1913.
   926     12  ER-1914                     PIC S9(4)   VALUE +1914.
   927     12  ER-1915                     PIC S9(4)   VALUE +1915.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  18
* EL050.cbl
   928     12  ER-1916                     PIC S9(4)   VALUE +1916.
   929     12  ER-1917                     PIC S9(4)   VALUE +1917.
   930     12  ER-1918                     PIC S9(4)   VALUE +1918.
   931     12  ER-1919                     PIC S9(4)   VALUE +1919.
   932     12  ER-1920                     PIC S9(4)   VALUE +1920.
   933     12  ER-1921                     PIC S9(4)   VALUE +1921.
   934     12  ER-1922                     PIC S9(4)   VALUE +1922.
   935     12  ER-1923                     PIC S9(4)   VALUE +1923.
   936     12  ER-1924                     PIC S9(4)   VALUE +1924.
   937     12  ER-1925                     PIC S9(4)   VALUE +1925.
   938     12  ER-1926                     PIC S9(4)   VALUE +1926.
   939     12  ER-1927                     PIC S9(4)   VALUE +1927.
   940     12  ER-2393                     PIC S9(4)   VALUE +2393.
   941     12  ER-2600                     PIC S9(4)   VALUE +2600.
   942     12  ER-2601                     PIC S9(4)   VALUE +2601.
   943     12  ER-2602                     PIC S9(4)   VALUE +2602.
   944     12  ER-2603                     PIC S9(4)   VALUE +2603.
   945     12  ER-2604                     PIC S9(4)   VALUE +2604.
   946     12  ER-2605                     PIC S9(4)   VALUE +2605.
   947     12  ER-2606                     PIC S9(4)   VALUE +2606.
   948     12  ER-2607                     PIC S9(4)   VALUE +2607.
   949     12  ER-2608                     PIC S9(4)   VALUE +2608.
   950     12  ER-2609                     PIC S9(4)   VALUE +2609.
   951     12  ER-2610                     PIC S9(4)   VALUE +2610.
   952     12  ER-2611                     PIC S9(4)   VALUE +2611.
   953     12  ER-2612                     PIC S9(4)   VALUE +2612.
   954     12  ER-2613                     PIC S9(4)   VALUE +2613.
   955     12  ER-2614                     PIC S9(4)   VALUE +2614.
   956     12  ER-2615                     PIC S9(4)   VALUE +2615.
   957     12  ER-2616                     PIC S9(4)   VALUE +2616.
   958     12  ER-2617                     PIC S9(4)   VALUE +2617.
   959     12  ER-2618                     PIC S9(4)   VALUE +2618.
   960     12  ER-2619                     PIC S9(4)   VALUE +2619.
   961     12  ER-2620                     PIC S9(4)   VALUE +2620.
   962     12  ER-2621                     PIC S9(4)   VALUE +2621.
   963     12  ER-2622                     PIC S9(4)   VALUE +2622.
   964     12  ER-2623                     PIC S9(4)   VALUE +2623.
   965     12  ER-2624                     PIC S9(4)   VALUE +2624.
   966     12  ER-2625                     PIC S9(4)   VALUE +2625.
   967     12  ER-2626                     PIC S9(4)   VALUE +2626.
   968     12  ER-2627                     PIC S9(4)   VALUE +2627.
   969     12  ER-2628                     PIC S9(4)   VALUE +2628.
   970     12  ER-2629                     PIC S9(4)   VALUE +2629.
   971     12  ER-2630                     PIC S9(4)   VALUE +2630.
   972     12  ER-2631                     PIC S9(4)   VALUE +2631.
   973     12  ER-2632                     PIC S9(4)   VALUE +2632.
   974     12  ER-2633                     PIC S9(4)   VALUE +2633.
   975     12  ER-2634                     PIC S9(4)   VALUE +2634.
   976     12  ER-2635                     PIC S9(4)   VALUE +2635.
   977     12  ER-2636                     PIC S9(4)   VALUE +2636.
   978     12  ER-2637                     PIC S9(4)   VALUE +2637.
   979     12  ER-2638                     PIC S9(4)   VALUE +2638.
   980     12  ER-2639                     PIC S9(4)   VALUE +2639.
   981     12  ER-2640                     PIC S9(4)   VALUE +2640.
   982     12  ER-2641                     PIC S9(4)   VALUE +2641.
   983     12  ER-2642                     PIC S9(4)   VALUE +2642.
   984     12  ER-2643                     PIC S9(4)   VALUE +2643.
   985     12  ER-2644                     PIC S9(4)   VALUE +2644.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  19
* EL050.cbl
   986     12  ER-2645                     PIC S9(4)   VALUE +2645.
   987     12  ER-2646                     PIC S9(4)   VALUE +2646.
   988     12  ER-2647                     PIC S9(4)   VALUE +2647.
   989     12  ER-2648                     PIC S9(4)   VALUE +2648.
   990     12  ER-2649                     PIC S9(4)   VALUE +2649.
   991     12  ER-2650                     PIC S9(4)   VALUE +2650.
   992     12  ER-2651                     PIC S9(4)   VALUE +2651.
   993     12  ER-2652                     PIC S9(4)   VALUE +2652.
   994     12  ER-2653                     PIC S9(4)   VALUE +2653.
   995     12  ER-2654                     PIC S9(4)   VALUE +2654.
   996     12  ER-2655                     PIC S9(4)   VALUE +2655.
   997     12  ER-2656                     PIC S9(4)   VALUE +2656.
   998     12  ER-2657                     PIC S9(4)   VALUE +2657.
   999     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1000     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1001     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1002     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1003     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1004     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1005     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1006     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1007     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1008     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1009     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1010     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1011     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1012     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1013     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1014     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1015     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1016     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1017     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1018     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1019     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1020     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1021     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1022     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1023     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1024     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1025     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1026     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1027     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1028     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1029     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1030     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1031     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1032     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1033     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1034     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1035     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1036     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1037     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1038     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1039     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1040     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1041     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1042     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1043     12  ER-2702                     PIC S9(4)   VALUE +2702.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  20
* EL050.cbl
  1044     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1045     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1046     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1047     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1048     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1049     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1050     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1051     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1052     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1053     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1054     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1055     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1056     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1057     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1058     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1059     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1060     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1061     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1062     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1063     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1064     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1065     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1066     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1067     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1068     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1069     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1070     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1071     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1072     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1073     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1074     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1075     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1076     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1077     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1078     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1079     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1080     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1081     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1082     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1083     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1084     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1085     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1086     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1087     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1088     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1089     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1090     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1091     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1092     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1093     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1094     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1095     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1096     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1097     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1098     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1099     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1100     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1101     12  ER-2770                     PIC S9(4)   VALUE +2770.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  21
* EL050.cbl
  1102     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1103     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1104     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1105     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1106     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1107     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1108     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1109     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1110     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1111     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1112     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1113     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1114     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1115     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1116     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1117     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1118     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1119     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1120     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1121     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1122     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1123     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1124     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1125     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1126     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1127     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1128     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1129     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1130     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1131     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1132     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1133     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1134     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1135     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1136     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1137     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1138     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1139     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1140     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1141     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1142     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1143     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1144     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1145     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1146     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1147     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1148     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1149     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1150     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1151     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1152     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1153     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1154     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1155     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1156     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1157     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1158     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1159     12  ER-3825                     PIC S9(4)   VALUE +3825.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  22
* EL050.cbl
  1160     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1161     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1162     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1163     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1164     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1165     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1166     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1167     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1168     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1169     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1170     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1171     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1172     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1173     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1174     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1175     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1176     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1177     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1178     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1179     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1180     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1181     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1182     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1183     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1184     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1185     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1186     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1187     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1188     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1189     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1190     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1191     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1192     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1193     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1194     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1195     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1196     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1197     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1198     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1199     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1200     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1201     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1202     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1203     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1204     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1205     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1206     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1207     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1208     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1209     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1210     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1211     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1212     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1213     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1214     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1215     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1216     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1217     12  ER-8098                     PIC S9(4)   VALUE +8098.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  23
* EL050.cbl
  1218     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1219     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1220     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1221     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1222     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1223     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1224     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1225     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1226     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1227     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1228     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1229     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1230     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1231     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1232     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1233     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1234     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1235     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1236     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1237     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1238     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1239     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1240     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1241     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1242     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1243     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1244     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1245     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1246******************************************************************
  1247***************   END OF ELC50WS     ****************************
  1248******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  24
* EL050.cbl
  1251 01  WORKING-STORAGE-WORK-AREAS.
  1252     12  WS-RESPONSE             PIC S9(8)  COMP.
  1253         88  WS-RESP-NORMAL           VALUE +00.
  1254         88  WS-RESP-ERROR            VALUE +01.
  1255         88  WS-RESP-NOTFND           VALUE +13.
  1256         88  WS-RESP-DUPREC           VALUE +14.
  1257         88  WS-RESP-ENDFILE          VALUE +20.
  1258     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1259     12  WORK-AREAS.
  1260         16  WK-CONV-GREG.
  1261             24  WCG-CENT             PIC XX.
  1262             24  WCG-REST             PIC X(4).
  1263         16  WORK-GREGORIAN-DATE.
  1264             24  WK-GREG-CENT         PIC XX.
  1265             24  WK-GREG-DATE-YYMMDD.
  1266                 28  WK-GREG-YYMM     PIC X(4).
  1267                 28  WK-GREG-DD       PIC XX.
  1268
  1269         16  WORK-SELECT-DATE.
  1270             24  WK-SELECT-CENT            PIC XX.
  1271             24  WK-SELECT-DATE-YYMMDD.
  1272                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1273                 28  FILLER                PIC XX.
  1274
  1275         16  WK-FORM-NO.
  1276             24  WK-FORM-BANK-ID       PIC X(5).
  1277             24  WK-FORM-UNDRWRTR      PIC X(1).
  1278             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1279
  1280         16  WK-MEMBER-NO.
  1281             24  WK-MEMBER-1-6        PIC X(6).
  1282             24  WK-MEMBER-7-12       PIC X(6).
  1283
  1284         16  WK-FULL-CERT-NO.
  1285             24  WK-CERT-POS-1-2      PIC X(2).
  1286             24  WK-CERT-POS-3        PIC X(1).
  1287             24  WK-CERT-POS-4        PIC X(1).
  1288             24  WK-CERT-POS-5-6      PIC X(2).
  1289             24  WK-CERT-POS-7        PIC X(1).
  1290             24  WK-CERT-POS-8-11     PIC X(4).
  1291
  1292         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1293             88  VALID-RATE-CODE        VALUE 'Y'.
  1294             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1295
  1296         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1297         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1298         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1299         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1300         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1301         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1302         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1303         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1304         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1305         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1306
  1307* DLO001
  1308 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  25
* EL050.cbl
  1309     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1310     12  DMPF-RETURN-CODE          PIC XX.
  1311         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1312         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1313         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1314         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1315         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1316         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1317
  1318* DLO002
  1319 01  WS-DLO-INTERNAL-POLICY-FORM.
  1320     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1321     12  DIPF-RETURN-CODE          PIC XX.
  1322         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1323         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1324         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1325         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1326         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1327         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1328
  1329* DLO003
  1330 01  WS-DLO-VALID-BANK-ID.
  1331     12  DVBI-BANK-ID              PIC X(5).
  1332     12  DVBI-BANK-ID-TYPE         PIC X.
  1333         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1334         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1335         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1336         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1337         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1338     12  DVBI-RETURN-CODE          PIC XX.
  1339         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1340         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1341         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1342         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1343         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1344         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1345         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1346         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1347         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1348
  1349* DLO007
  1350 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1351     12  DCUA-RES-STATE            PIC XX.
  1352     12  DCUA-BEN-TYPE             PIC XX.
  1353     12  DCUA-SYS-IDENT            PIC X.
  1354         88  DCUA-CLAIM                        VALUE 'C'.
  1355         88  DCUA-PREMIUM                      VALUE 'P'.
  1356     12  DCUA-COVERAGE-RULE        PIC X.
  1357     12  DCUA-CLIENT-ID            PIC X(10).
  1358     12  DCUA-EFF-DATE             PIC X(8).
  1359     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1360     12  DCUA-RETURN-CODE          PIC XX.
  1361         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1362     12  DCUA-CERT-NUMBER          PIC X(11).
  1363     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1364     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1365
  1366* DLO011
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  26
* EL050.cbl
  1367 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1368     12  DPRB-RATE-CODE            PIC X(4).
  1369     12  DPRB-COVERAGE-CATEG       PIC X.
  1370     12  DPRB-RETURN-CODE          PIC XX.
  1371         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1372         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1373         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1374         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1375         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1376         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1377         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1378         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1379         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1380     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1381     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1382     12  DPRB-BEN-TYPE             PIC XX.
  1383
  1384* DLO017
  1385 01  WS-DLO-VALID-RATE-CODE.
  1386     12  DVRC-RATE-CODE            PIC X(4).
  1387     12  DVRC-RETURN-CODE          PIC XX.
  1388         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1389         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1390         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1391         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1392         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1393         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1394
  1395* DLO019
  1396 01  WS-DLO-ORIG-COV-CAT.
  1397     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1398     12  DOCC-RETURN-CODE          PIC XX.
  1399     12  DOCC-ORIG-COV-CAT         PIC X.
  1400     12  DOCC-UNDERWITER           PIC XX.
  1401     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1402     12  DOCC-FILLER               PIC X(6).
  1403
  1404* DLO021
  1405 01  WS-DLO-VALID-LOAN-OFFICER.
  1406     12  DVLO-LOAN-OFFICER.
  1407         16  DVLO-BILL-TYPE        PIC X.
  1408         16  DVLO-BILL-SOURCE      PIC X.
  1409         16  DVLO-BATCH-TYPE       PIC X.
  1410     12  DVLO-RETURN-CODE          PIC XX.
  1411         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1412         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1413         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1414         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1415         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1416         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1417
  1418* DLO022
  1419 01  WS-DLO-VALID-STATE-CODE.
  1420     12  DVSC-STATE-CODE           PIC XX.
  1421     12  DVSC-RETURN-CODE          PIC XX.
  1422         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1423
  1424* DLO023
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  27
* EL050.cbl
  1425 01  WS-DLO-VALID-CODE-VALUES.
  1426     12  DVCV-SYSTEM-ID            PIC XX.
  1427         88  DVCV-CLAIMS                       VALUE 'CL'.
  1428         88  DVCV-CREDIT                       VALUE 'CR'.
  1429     12  DVCV-RECORD-TYPE          PIC XX.
  1430         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1431         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1432         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1433         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1434         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1435         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1436         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1437         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1438     12  DVCV-RECORD-KEY           PIC X(6).
  1439     12  DVCV-RETURN-CODE          PIC XX.
  1440         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1441         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1442         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1443         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1444         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1445         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1446         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1447     12  DVCV-CODE-DESC            PIC X(60).
  1448     12  DVCV-GEN-DESC-1           PIC X(20).
  1449     12  DVCV-GEN-DESC-2           PIC X(20).
  1450     12  DVCV-GEN-DESC-3           PIC X(20).
  1451
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  28
* EL050.cbl
  1453*    COPY ERCBXRF.
  1454******************************************************************
  1455*                                                                *
  1456*                                                                *
  1457*                            ERCBXRF                             *
  1458*                                                                *
  1459*   ONLINE CREDIT SYSTEM                                         *
  1460*                                                                *
  1461*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1462*                                                                *
  1463*   FILE TYPE = VSAM,KSDS                                        *
  1464*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1465*                                                                *
  1466*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1467*       ALTERNATE PATH = NONE                                    *
  1468*                                                                *
  1469*   LOG = NO                                                     *
  1470*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1471*                                                                *
  1472******************************************************************
  1473
  1474 01  BANK-CROSS-REFERENCE.
  1475     12  BK-RECORD-ID                PIC XX.
  1476         88  VALID-BK-ID             VALUE 'BK'.
  1477
  1478     12  BK-CONTROL-PRIMARY.
  1479         16  BK-COMPANY-CD           PIC X.
  1480         16  BK-CARRIER              PIC X.
  1481         16  BK-GROUPING             PIC X(6).
  1482         16  BK-BANK-NO              PIC X(10).
  1483
  1484     12  BK-MAINT-INFORMATION.
  1485         16  BK-LAST-MAINT-DT        PIC XX.
  1486         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1487         16  BK-LAST-MAINT-USER      PIC X(4).
  1488         16  FILLER                  PIC X(9).
  1489
  1490     12  FILLER                      PIC X(37).
  1491
  1492     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1493
  1494     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1495                            DEPENDING ON BK-BANK-POINTER-CNT.
  1496         16  BK-AM-ACCOUNT           PIC X(10).
  1497         16  BK-AM-EXP-DT            PIC XX.
  1498         16  BK-AM-EFF-DT            PIC XX.
  1499         16  BK-AM-STATE             PIC XX.
  1500         16  FILLER                  PIC X(20).
  1501
  1502******************************************************************
  1503
  1504*    COPY ERCCOMP.
  1505******************************************************************
  1506*                                                                *
  1507*                                                                *
  1508*                            ERCCOMP                             *
  1509*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1510*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  29
* EL050.cbl
  1511*                                                                *
  1512*   ONLINE CREDIT SYSTEM                                         *
  1513*                                                                *
  1514*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1515*                                                                *
  1516*   FILE TYPE = VSAM,KSDS                                        *
  1517*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1518*                                                                *
  1519*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1520*       ALTERNATE PATH = NONE                                    *
  1521*                                                                *
  1522*   LOG = NO                                                     *
  1523*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1524*                                                                *
  1525******************************************************************
  1526*                   C H A N G E   L O G
  1527*
  1528* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1529*-----------------------------------------------------------------
  1530*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1531* EFFECTIVE    NUMBER
  1532*-----------------------------------------------------------------
  1533* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1534* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1535* 092205    2005050300006  PEMA  ADD LEASE FEE
  1536* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1537* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1538* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1539* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1540* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1541* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1542******************************************************************
  1543
  1544 01  COMPENSATION-MASTER.
  1545     12  CO-RECORD-ID                          PIC XX.
  1546         88  VALID-CO-ID                          VALUE 'CO'.
  1547
  1548     12  CO-CONTROL-PRIMARY.
  1549         16  CO-COMPANY-CD                     PIC X.
  1550         16  CO-CONTROL.
  1551             20  CO-CTL-1.
  1552                 24  CO-CARR-GROUP.
  1553                     28  CO-CARRIER            PIC X.
  1554                     28  CO-GROUPING.
  1555                         32  CO-GROUP-PREFIX   PIC XXX.
  1556                         32  CO-GROUP-PRIME    PIC XXX.
  1557                 24  CO-RESP-NO.
  1558                     28  CO-RESP-PREFIX        PIC X(4).
  1559                     28  CO-RESP-PRIME         PIC X(6).
  1560             20  CO-CTL-2.
  1561                 24  CO-ACCOUNT.
  1562                     28  CO-ACCT-PREFIX        PIC X(4).
  1563                     28  CO-ACCT-PRIME         PIC X(6).
  1564         16  CO-TYPE                           PIC X.
  1565             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1566             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1567             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1568
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  30
* EL050.cbl
  1569     12  CO-MAINT-INFORMATION.
  1570         16  CO-LAST-MAINT-DT                  PIC XX.
  1571         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1572         16  CO-LAST-MAINT-USER                PIC X(4).
  1573     12  FILLER                                PIC XX.
  1574     12  CO-STMT-TYPE                          PIC XXX.
  1575     12  CO-COMP-TYPE                          PIC X.
  1576         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1577     12  CO-STMT-OWNER                         PIC X(4).
  1578     12  CO-BALANCE-CONTROL                    PIC X.
  1579         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1580         88  CO-NO-BALANCE                        VALUE 'N'.
  1581
  1582     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1583         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1584         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1585         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1586
  1587     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1588         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1589         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1590
  1591     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1592     12  CO-GA-DIRECT-DEP                      PIC X.
  1593     12  CO-FUTURE-SPACE                       PIC X.
  1594         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1595
  1596     12  CO-ACCT-NAME                          PIC X(30).
  1597     12  CO-MAIL-NAME                          PIC X(30).
  1598     12  CO-ADDR-1                             PIC X(30).
  1599     12  CO-ADDR-2                             PIC X(30).
  1600     12  CO-ADDR-3.
  1601         16  CO-ADDR-CITY                      PIC X(27).
  1602         16  CO-ADDR-STATE                     PIC XX.
  1603     12  CO-CSO-1099                           PIC X.
  1604     12  CO-ZIP.
  1605         16  CO-ZIP-PRIME.
  1606             20  CO-ZIP-PRI-1ST                PIC X.
  1607                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1608             20  FILLER                        PIC X(4).
  1609         16  CO-ZIP-PLUS4                      PIC X(4).
  1610     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1611         16  CO-CAN-POSTAL-1                   PIC XXX.
  1612         16  CO-CAN-POSTAL-2                   PIC XXX.
  1613         16  FILLER                            PIC XXX.
  1614     12  CO-SOC-SEC                            PIC X(13).
  1615     12  CO-TELEPHONE.
  1616         16  CO-AREA-CODE                      PIC XXX.
  1617         16  CO-PREFIX                         PIC XXX.
  1618         16  CO-PHONE                          PIC X(4).
  1619
  1620     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1621
  1622     12  CO-AR-BAL-LEVEL                       PIC X.
  1623         88  CO-AR-REF-LVL                        VALUE '1'.
  1624         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1625         88  CO-AR-BILL-LVL                       VALUE '2'.
  1626         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  31
* EL050.cbl
  1627         88  CO-AR-FR-LVL                         VALUE '4'.
  1628
  1629     12  CO-AR-NORMAL-PRINT                    PIC X.
  1630         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1631         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1632
  1633     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1634
  1635     12  CO-AR-REPORTING                       PIC X.
  1636         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1637         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1638
  1639     12  CO-AR-PULL-CHECK                      PIC X.
  1640         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1641         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1642
  1643     12  CO-AR-BALANCE-PRINT                   PIC X.
  1644         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1645
  1646     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1647         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1648         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1649         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1650
  1651     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1652
  1653     12  CO-USER-CODE                          PIC X.
  1654     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1655
  1656******************************************************************
  1657*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1658*    THE LAST MONTH END RUN.
  1659******************************************************************
  1660
  1661     12  CO-LAST-ACTIVITY-DATE.
  1662         16  CO-ACT-YEAR                       PIC 99.
  1663         16  CO-ACT-MONTH                      PIC 99.
  1664         16  CO-ACT-DAY                        PIC 99.
  1665
  1666     12  CO-LAST-STMT-DT.
  1667         16  CO-LAST-STMT-YEAR                 PIC 99.
  1668         16  CO-LAST-STMT-MONTH                PIC 99.
  1669         16  CO-LAST-STMT-DAY                  PIC 99.
  1670
  1671     12  CO-MO-END-TOTALS.
  1672         16  CO-MONTHLY-TOTALS.
  1673             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1674             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1675             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1676             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1677             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1678
  1679         16  CO-AGING-TOTALS.
  1680             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1681             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1682             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1683             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1684
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  32
* EL050.cbl
  1685         16  CO-YTD-TOTALS.
  1686             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1687             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1688
  1689         16  CO-OVER-UNDER-TOTALS.
  1690             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1691             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1692
  1693     12  CO-MISCELLANEOUS-TOTALS.
  1694         16  CO-FICA-TOTALS.
  1695             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1696             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1697
  1698         16  CO-CLAIM-TOTALS.
  1699             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1700             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1701
  1702******************************************************************
  1703*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1704*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1705******************************************************************
  1706
  1707     12  CO-CURRENT-TOTALS.
  1708         16  CO-CURRENT-LAST-STMT-DT.
  1709             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1710             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1711             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1712
  1713         16  CO-CURRENT-MONTHLY-TOTALS.
  1714             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1715             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1716             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1717             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1718             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1719
  1720         16  CO-CURRENT-AGING-TOTALS.
  1721             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1722             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1723             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1724             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1725
  1726         16  CO-CURRENT-YTD-TOTALS.
  1727             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1728             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1729
  1730     12  CO-PAID-COMM-TOTALS.
  1731         16  CO-YTD-PAID-COMMS.
  1732             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1733             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1734
  1735     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1736         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1737         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1738
  1739     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1740         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1741         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1742         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  33
* EL050.cbl
  1743         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1744         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1745         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1746         88  CO-FINAL-LETTER                  VALUE 'F'.
  1747         88  CO-RECONCILING                   VALUE 'R'.
  1748         88  CO-PHONE-CALL                    VALUE 'P'.
  1749         88  CO-LEGAL                         VALUE 'L'.
  1750         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1751         88  CO-WRITE-OFF                     VALUE 'W'.
  1752         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1753
  1754     12  CO-CSR-CODE                       PIC X(4).
  1755
  1756     12  CO-GA-STATUS-INFO.
  1757         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1758         16  CO-GA-TERMINATION-DT          PIC XX.
  1759         16  CO-GA-STATUS-CODE             PIC X.
  1760             88  CO-GA-ACTIVE                 VALUE 'A'.
  1761             88  CO-GA-INACTIVE               VALUE 'I'.
  1762             88  CO-GA-PENDING                VALUE 'P'.
  1763         16  CO-GA-COMMENTS.
  1764             20  CO-GA-COMMENT-1           PIC X(40).
  1765             20  CO-GA-COMMENT-2           PIC X(40).
  1766             20  CO-GA-COMMENT-3           PIC X(40).
  1767             20  CO-GA-COMMENT-4           PIC X(40).
  1768
  1769     12  CO-RPTCD2                         PIC X(10).
  1770     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1771         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1772         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1773
  1774     12  CO-TYPE-AGENT                     PIC X(01).
  1775         88  CO-CORPORATION                   VALUE 'C'.
  1776         88  CO-PARTNERSHIP                   VALUE 'P'.
  1777         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1778         88  CO-TRUST                         VALUE 'T'.
  1779         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1780
  1781     12  CO-FAXNO.
  1782         16  CO-FAX-AREA-CODE                  PIC XXX.
  1783         16  CO-FAX-PREFIX                     PIC XXX.
  1784         16  CO-FAX-PHONE                      PIC X(4).
  1785
  1786     12  CO-BANK-INFORMATION.
  1787         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1788         16  CO-BANK-TRANSIT-NON REDEFINES
  1789             CO-BANK-TRANSIT-NO                PIC 9(8).
  1790
  1791         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1792     12  CO-MISC-DEDUCT-INFO REDEFINES
  1793                  CO-BANK-INFORMATION.
  1794         16  CO-MD-GL-ACCT                     PIC X(10).
  1795         16  CO-MD-DIV                         PIC XX.
  1796         16  CO-MD-CENTER                      PIC X(4).
  1797         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1798         16  CO-CREATE-AP-CHECK                PIC X.
  1799         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1800         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  34
* EL050.cbl
  1801     12  CO-ACH-STATUS                         PIC X.
  1802         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1803         88  CO-ACH-PENDING                        VALUE 'P'.
  1804
  1805     12  CO-BILL-SW                            PIC X.
  1806     12  CO-CONTROL-NAME                       PIC X(30).
  1807     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1808     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1809     12  CO-CLP-STATE                          PIC XX.
  1810     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1811     12  CO-SPP-REFUND-EDIT                    PIC X.
  1812
  1813******************************************************************
  1814
  1815*    COPY ERCAGTC.
  1816******************************************************************
  1817*                                                                *
  1818*                                                                *
  1819*                            ERCAGTC                             *
  1820*                            VMOD=2.001                          *
  1821*                                                                *
  1822*   ONLINE CREDIT SYSTEM                                         *
  1823*                                                                *
  1824*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1825*                                                                *
  1826*   FILE TYPE = VSAM,KSDS                                        *
  1827*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1828*                                                                *
  1829*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1830*       ALTERNATE PATH = NONE                                    *
  1831*                                                                *
  1832*   LOG = NO                                                     *
  1833*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1834*                                                                *
  1835******************************************************************
  1836*                   C H A N G E   L O G
  1837*
  1838* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1839*-----------------------------------------------------------------
  1840*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1841* EFFECTIVE    NUMBER
  1842*-----------------------------------------------------------------
  1843* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1844* 111004                         NEW FILE AND COPYBOOK
  1845* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1846******************************************************************
  1847 01  AGENT-COMMISSIONS.
  1848     12  AG-RECORD-ID                          PIC XX.
  1849         88  VALID-CO-ID                          VALUE 'AG'.
  1850     12  AG-CONTROL-PRIMARY.
  1851         16  AG-COMPANY-CD                     PIC X.
  1852         16  AG-CONTROL.
  1853             20  AG-CTL-1.
  1854                 24  AG-CARR-GROUP.
  1855                     28  AG-CARRIER            PIC X.
  1856                     28  AG-GROUPING           PIC X(6).
  1857                 24  AG-BANK                   PIC X(10).
  1858             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  35
* EL050.cbl
  1859                 24  AG-EXP-DT                 PIC XX.
  1860         16  AG-TYPE                           PIC X.
  1861             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1862             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1863     12  AG-MAINT-INFORMATION.
  1864         16  AG-LAST-MAINT-DT                  PIC XX.
  1865         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1866         16  AG-LAST-MAINT-USER                PIC X(4).
  1867         16  FILLER                            PIC X(10).
  1868     12  AG-EFF-DT                             PIC XX.
  1869     12  AG-COMM-STRUCTURE.
  1870         16  AG-AGT-COMMS OCCURS 10.
  1871             20  AG-AGT                PIC X(10).
  1872             20  AG-COM-TYP            PIC X.
  1873             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1874             20  AG-RECALC-LV-INDIC    PIC X.
  1875             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1876             20  AG-LRCALC-LV-INDIC    PIC X.
  1877             20  FILLER                PIC X(05).
  1878     12  FILLER                  PIC X(145).
  1879******************************************************************
  1880*    COPY ERCRESS.
  1881******************************************************************
  1882*                                                                *
  1883*                            ERCRESS                             *
  1884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1885*                            VMOD=2.002                          *
  1886*                                                                *
  1887*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1888*                                                                *
  1889*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1890*   VSAM RESIDENT STATE TAX MASTER                              *
  1891*                                                                *
  1892*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1893*                                                                *
  1894*   FILE TYPE = VSAM,KSDS                                        *
  1895*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1896*                                                                *
  1897*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1898*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1899*                                                                *
  1900*   LOG = NO                                                     *
  1901*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1902*                                                                *
  1903*                                                                *
  1904******************************************************************
  1905
  1906 01  RESIDENT-STATE-TAX-MASTER.
  1907
  1908     10  ERRESS-PRIMARY-KEY.
  1909         15  RES-COMPANY-CD        PIC X.
  1910         15  RES-RESIDENT-STATE    PIC XX.
  1911         15  RES-COVERAGE-CATEGORY PIC X.
  1912         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1913*                                      YYYYMMDD
  1914*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1915
  1916     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  36
* EL050.cbl
  1917
  1918         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1919         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1920         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1921         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1922
  1923     10 RES-RECALC-SW              PIC   X.
  1924         88 RECALC                VALUE 'Y'.
  1925         88 NO-RECALC             VALUE 'N'.
  1926     10  RES-MAINT-BY              PIC X(4).
  1927     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1928     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1929*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  37
* EL050.cbl
  1931*    COPY ERCRESC.
  1932******************************************************************
  1933*                                                                *
  1934*                            ERCRESC                             *
  1935*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1936*                            VMOD=2.003                          *
  1937*                                                                *
  1938*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1939*                                                                *
  1940*   FILE TYPE = VSAM,KSDS                                        *
  1941*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1942*                                                                *
  1943*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1944*       ALTERNATE PATH1 = NONE                                   *
  1945*                                                                *
  1946*   LOG = NO                                                     *
  1947*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1948*                                                                *
  1949******************************************************************
  1950
  1951 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1952
  1953     10  ERRESC-RECORD-KEY.
  1954         15  RESC-COMPANY-CD           PIC   X.
  1955         15  RESC-CARRIER              PIC   X.
  1956         15  RESC-GROUP                PIC   X(6).
  1957         15  RESC-STATE                PIC   XX.
  1958         15  RESC-ACCOUNT              PIC   X(10).
  1959         15  RESC-AGENT                PIC   X(10).
  1960         15  RESC-RESIDENT-STATE       PIC   XX.
  1961         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1962*                                           YYYYMMDD
  1963     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1964
  1965     10  RESC-COMM-RECORD-DATA.
  1966         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1967             20 RESC-COVERAGE-CAT      PIC    X.
  1968             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1969             20 RESC-COMMISSION-TAB REDEFINES
  1970                RESC-COMMISSION-PER    PIC  XXX.
  1971
  1972     10  RESC-MAINT-BY                 PIC X(4).
  1973     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1974     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1975*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  38
* EL050.cbl
  1977*    COPY ERCPLAN.
  1978******************************************************************
  1979*                                                                *
  1980*                                                                *
  1981*                            ERCPLAN                             *
  1982*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1983*                            VMOD=2.003                          *
  1984*                                                                *
  1985*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1986*                                                                *
  1987*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1988*   PLAN MASTER                                                  *
  1989*                                                                *
  1990*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1991*                                                                *
  1992*   FILE TYPE = VSAM,KSDS                                        *
  1993*   RECORD SIZE = 420   RECFORM = FIX                            *
  1994*                                                                *
  1995*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1996*       ALTERNATE PATH1 = N/A                                    *
  1997*                                                                *
  1998*   LOG = NO                                                     *
  1999*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2000*                                                                *
  2001*                                                                *
  2002******************************************************************
  2003
  2004 01  PLAN-MASTER.
  2005     12  PL-RECORD-ID                      PIC XX.
  2006         88  VALID-PL-ID                      VALUE 'PL'.
  2007
  2008     12  PL-CONTROL-PRIMARY.
  2009         16  PL-COMPANY-CD                 PIC X.
  2010         16  PL-MSTR-CNTRL.
  2011             20  PL-CONTROL-A.
  2012                 24  PL-CARRIER            PIC X.
  2013                 24  PL-GROUPING           PIC X(6).
  2014                 24  PL-STATE              PIC XX.
  2015                 24  PL-ACCOUNT            PIC X(10).
  2016             20  PL-BENEFIT-TYPE           PIC X.
  2017             20  PL-BENEFIT-CODE           PIC XX.
  2018             20  PL-REVISION-NO            PIC X(3).
  2019
  2020     12  PL-CONTROL-BY-VAR-GRP.
  2021         16  PL-COMPANY-CD-A1              PIC X.
  2022         16  PL-VG-CARRIER                 PIC X.
  2023         16  PL-VG-GROUPING                PIC X(6).
  2024         16  PL-VG-STATE                   PIC XX.
  2025         16  PL-VG-ACCOUNT                 PIC X(10).
  2026         16  PL-BENEFIT-TYPE-A1            PIC X.
  2027         16  PL-BENEFIT-CODE-A1            PIC XX.
  2028         16  PL-REVISION-NO-A1             PIC 999.
  2029
  2030     12  PL-MAINT-INFORMATION.
  2031         16  PL-LAST-MAINT-DT              PIC XX.
  2032         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2033         16  PL-LAST-MAINT-USER            PIC X(4).
  2034         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  39
* EL050.cbl
  2035
  2036     12  PL-LIABILITY-LIMITS.
  2037         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2038         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2039             20  PL-LM-AGE                 PIC S99        COMP-3.
  2040             20  PL-LM-DUR                 PIC S999       COMP-3.
  2041             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2042             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2043
  2044     12  FILLER                            PIC X(30).
  2045
  2046     12  PL-GL-ACCOUNT-NOS.
  2047         16  PL-PREMIUM-GL                 PIC X(8).
  2048         16  PL-COMM-GL                    PIC X(8).
  2049         16  PL-CLAIM-GL                   PIC X(8).
  2050     12  FILLER                            PIC X(24).
  2051     12  PL-TOLERANCES.
  2052         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2053         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2054         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2055         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2056         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2057         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2058     12  PL-OVER-SHORT.
  2059         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2060         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2061     12  FILLER                            PIC X(24).
  2062     12  PLAN-MISC.
  2063         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2064         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2065         16  PL-IG                         PIC X.
  2066         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2067         16  PL-POLICY-FORM                PIC X(12).
  2068         16  PL-EDIT-FOR-FORM              PIC X(01).
  2069         16  PL-DEV-CODE                   PIC XXX.
  2070         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2071         16  PL-CALC-METHOD                PIC X.
  2072         16  PL-BENEFIT-GROUP              PIC X(05).
  2073         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2074
  2075         16  FILLER                        PIC X(99).
  2076******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  40
* EL050.cbl
  2078*    COPY ELCCERT.
  2079******************************************************************
  2080*                                                                *
  2081*                            ELCCERT.                            *
  2082*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2083*                            VMOD=2.013                          *
  2084*                                                                *
  2085*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2086*                                                                *
  2087*   FILE TYPE = VSAM,KSDS                                        *
  2088*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2089*                                                                *
  2090*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2091*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2092*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2093*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2094*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2095*                                                                *
  2096*   LOG = YES                                                    *
  2097*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2098******************************************************************
  2099*                   C H A N G E   L O G
  2100*
  2101* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2102*-----------------------------------------------------------------
  2103*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2104* EFFECTIVE    NUMBER
  2105*-----------------------------------------------------------------
  2106* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2107* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2108* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2109* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2110* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2111* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2112* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2113* 032612  CR2011110200001  PEMA  AHL CHANGES
  2114* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2115******************************************************************
  2116
  2117 01  CERTIFICATE-MASTER.
  2118     12  CM-RECORD-ID                      PIC XX.
  2119         88  VALID-CM-ID                      VALUE 'CM'.
  2120
  2121     12  CM-CONTROL-PRIMARY.
  2122         16  CM-COMPANY-CD                 PIC X.
  2123         16  CM-CARRIER                    PIC X.
  2124         16  CM-GROUPING.
  2125             20  CM-GROUPING-PREFIX        PIC X(3).
  2126             20  CM-GROUPING-PRIME         PIC X(3).
  2127         16  CM-STATE                      PIC XX.
  2128         16  CM-ACCOUNT.
  2129             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2130             20  CM-ACCOUNT-PRIME          PIC X(6).
  2131         16  CM-CERT-EFF-DT                PIC XX.
  2132         16  CM-CERT-NO.
  2133             20  CM-CERT-PRIME             PIC X(10).
  2134             20  CM-CERT-SFX               PIC X.
  2135
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  41
* EL050.cbl
  2136     12  CM-CONTROL-BY-NAME.
  2137         16  CM-COMPANY-CD-A1              PIC X.
  2138         16  CM-INSURED-LAST-NAME          PIC X(15).
  2139         16  CM-INSURED-INITIALS.
  2140             20  CM-INSURED-INITIAL1       PIC X.
  2141             20  CM-INSURED-INITIAL2       PIC X.
  2142
  2143     12  CM-CONTROL-BY-SSN.
  2144         16  CM-COMPANY-CD-A2              PIC X.
  2145         16  CM-SOC-SEC-NO.
  2146             20  CM-SSN-STATE              PIC XX.
  2147             20  CM-SSN-ACCOUNT            PIC X(6).
  2148             20  CM-SSN-LN3.
  2149                 25  CM-INSURED-INITIALS-A2.
  2150                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2151                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2152                 25 CM-PART-LAST-NAME-A2         PIC X.
  2153
  2154     12  CM-CONTROL-BY-CERT-NO.
  2155         16  CM-COMPANY-CD-A4              PIC X.
  2156         16  CM-CERT-NO-A4                 PIC X(11).
  2157
  2158     12  CM-CONTROL-BY-MEMB.
  2159         16  CM-COMPANY-CD-A5              PIC X.
  2160         16  CM-MEMBER-NO.
  2161             20  CM-MEMB-STATE             PIC XX.
  2162             20  CM-MEMB-ACCOUNT           PIC X(6).
  2163             20  CM-MEMB-LN4.
  2164                 25  CM-INSURED-INITIALS-A5.
  2165                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2166                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2167                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2168
  2169     12  CM-INSURED-PROFILE-DATA.
  2170         16  CM-INSURED-FIRST-NAME.
  2171             20  CM-INSURED-1ST-INIT       PIC X.
  2172             20  FILLER                    PIC X(9).
  2173         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2174         16  CM-INSURED-SEX                PIC X.
  2175             88  CM-SEX-MALE                  VALUE 'M'.
  2176             88  CM-SEX-FEMAL                 VALUE 'F'.
  2177         16  CM-INSURED-JOINT-AGE          PIC 99.
  2178         16  CM-JOINT-INSURED-NAME.
  2179             20  CM-JT-LAST-NAME           PIC X(15).
  2180             20  CM-JT-FIRST-NAME.
  2181                 24  CM-JT-1ST-INIT        PIC X.
  2182                 24  FILLER                PIC X(9).
  2183             20  CM-JT-INITIAL             PIC X.
  2184
  2185     12  CM-LIFE-DATA.
  2186         16  CM-LF-BENEFIT-CD              PIC XX.
  2187         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2188         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2189         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2190         16  CM-LF-DEV-CODE                PIC XXX.
  2191         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2192         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2193         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  42
* EL050.cbl
  2194         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2195         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2196         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2197         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2198         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2199         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2200         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2201         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2202         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2203         16  cm-temp-epiq                  pic xx.
  2204             88  EPIQ-CLASS                  value 'EQ'.
  2205*        16  FILLER                        PIC XX.
  2206
  2207     12  CM-AH-DATA.
  2208         16  CM-AH-BENEFIT-CD              PIC XX.
  2209         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2210         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2211         16  CM-AH-DEV-CODE                PIC XXX.
  2212         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2213         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2214         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2215         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2216         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2217         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2218         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2219         16  CM-AH-PAID-THRU-DT            PIC XX.
  2220             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2221         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2222         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2223         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2224         16  FILLER                        PIC X.
  2225
  2226     12  CM-LOAN-INFORMATION.
  2227         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2228         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2229                                           PIC S9(5)V99  COMP-3.
  2230         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2231         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2232         16  CM-PAY-FREQUENCY              PIC S99.
  2233         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2234         16  CM-RATE-CLASS                 PIC XX.
  2235         16  CM-BENEFICIARY                PIC X(25).
  2236         16  CM-POLICY-FORM-NO             PIC X(12).
  2237         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2238         16  CM-LAST-ADD-ON-DT             PIC XX.
  2239         16  CM-DEDUCTIBLE-AMOUNTS.
  2240             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2241             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2242         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2243             20  CM-RESIDENT-STATE         PIC XX.
  2244             20  CM-RATE-CODE              PIC X(4).
  2245             20  FILLER                    PIC XX.
  2246         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2247             20  CM-LOAN-OFFICER           PIC X(5).
  2248             20  FILLER                    PIC XXX.
  2249         16  CM-CSR-CODE                   PIC XXX.
  2250         16  CM-UNDERWRITING-CODE          PIC X.
  2251             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  43
* EL050.cbl
  2252         16  CM-POST-CARD-IND              PIC X.
  2253         16  CM-NH-INTERFACE-SW            PIC X.
  2254         16  CM-PREMIUM-TYPE               PIC X.
  2255             88  CM-SING-PRM                  VALUE '1'.
  2256             88  CM-O-B-COVERAGE              VALUE '2'.
  2257             88  CM-OPEN-END                  VALUE '3'.
  2258         16  CM-IND-GRP-TYPE               PIC X.
  2259             88  CM-INDIVIDUAL                VALUE 'I'.
  2260             88  CM-GROUP                     VALUE 'G'.
  2261         16  CM-SKIP-CODE                  PIC X.
  2262             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2263             88  SKIP-JULY                    VALUE '1'.
  2264             88  SKIP-AUGUST                  VALUE '2'.
  2265             88  SKIP-SEPTEMBER               VALUE '3'.
  2266             88  SKIP-JULY-AUG                VALUE '4'.
  2267             88  SKIP-AUG-SEPT                VALUE '5'.
  2268             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2269             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2270             88  SKIP-JUNE                    VALUE '8'.
  2271             88  SKIP-JUNE-JULY               VALUE '9'.
  2272             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2273             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2274         16  CM-PAYMENT-MODE               PIC X.
  2275             88  PAY-MONTHLY                  VALUE SPACE.
  2276             88  PAY-WEEKLY                   VALUE '1'.
  2277             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2278             88  PAY-BI-WEEKLY                VALUE '3'.
  2279             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2280         16  CM-LOAN-NUMBER                PIC X(8).
  2281         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2282         16  CM-OLD-LOF                    PIC XXX.
  2283*        16  CM-LOAN-OFFICER               PIC XXX.
  2284         16  CM-REIN-TABLE                 PIC XXX.
  2285         16  CM-SPECIAL-REIN-CODE          PIC X.
  2286         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2287         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2288         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2289
  2290     12  CM-STATUS-DATA.
  2291         16  CM-ENTRY-STATUS               PIC X.
  2292         16  CM-ENTRY-DT                   PIC XX.
  2293
  2294         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2295         16  CM-LF-CANCEL-DT               PIC XX.
  2296         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2297
  2298         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2299         16  CM-LF-DEATH-DT                PIC XX.
  2300         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2301
  2302         16  CM-LF-CURRENT-STATUS          PIC X.
  2303             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2304                                                'M' '4' '5' '9'.
  2305             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2306             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2307             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2308             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2309             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  44
* EL050.cbl
  2310             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2311             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2312             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2313             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2314             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2315             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2316             88  CM-LF-DECLINED               VALUE 'D'.
  2317             88  CM-LF-VOIDED                 VALUE 'V'.
  2318
  2319         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2320         16  CM-AH-CANCEL-DT               PIC XX.
  2321         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2322
  2323         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2324         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2325         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2326
  2327         16  CM-AH-CURRENT-STATUS          PIC X.
  2328             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2329                                                'M' '4' '5' '9'.
  2330             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2331             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2332             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2333             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2334             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2335             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2336             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2337             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2338             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2339             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2340             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2341             88  CM-AH-DECLINED               VALUE 'D'.
  2342             88  CM-AH-VOIDED                 VALUE 'V'.
  2343
  2344         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2345             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2346             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2347             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2348         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2349
  2350         16  CM-ENTRY-BATCH                PIC X(6).
  2351         16  CM-LF-EXIT-BATCH              PIC X(6).
  2352         16  CM-AH-EXIT-BATCH              PIC X(6).
  2353         16  CM-LAST-MONTH-END             PIC XX.
  2354
  2355     12  CM-NOTE-SW                        PIC X.
  2356         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2357         88  CERT-NOTES-PRESENT               VALUE '1'.
  2358         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2359         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2360         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2361         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2362         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2363         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2364     12  CM-COMP-EXCP-SW                   PIC X.
  2365         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2366         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2367     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  45
* EL050.cbl
  2368         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2369         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2370
  2371*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2372     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2373     12  FILLER                            PIC X.
  2374
  2375*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2376     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2377     12  FILLER                            PIC X.
  2378*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2379     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2380
  2381     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2382         88  CERT-ADDED-BATCH                 VALUE ' '.
  2383         88  CERT-ADDED-ONLINE                VALUE '1'.
  2384         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2385         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2386         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2387     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2388         88  CERT-AS-LOADED                   VALUE ' '.
  2389         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2390         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2391         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2392         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2393         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2394         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2395         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2396
  2397     12  CM-ACCOUNT-COMM-PCTS.
  2398         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2399         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2400
  2401     12  CM-USER-FIELD                     PIC X.
  2402     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2403     12  CM-CLP-STATE                      PIC XX.
  2404     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2405     12  CM-USER-RESERVED                  PIC XXX.
  2406     12  FILLER REDEFINES CM-USER-RESERVED.
  2407         16  CM-AH-CLASS-CD                PIC XX.
  2408         16  F                             PIC X.
  2409******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  46
* EL050.cbl
  2411*    COPY ERCMAIL.
  2412******************************************************************
  2413*                                                                *
  2414*                                                                *
  2415*                            ERCMAIL                             *
  2416*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2417*                            VMOD=2.003                          *
  2418*                                                                *
  2419*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2420*                                                                *
  2421*   FILE TYPE = VSAM,KSDS                                        *
  2422*   RECORD SIZE = 374   RECFORM = FIX                            *
  2423*                                                                *
  2424*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2425*   ALTERNATE PATH    = NOT USED                                 *
  2426*                                                                *
  2427*   LOG = YES                                                    *
  2428*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2429******************************************************************
  2430*                   C H A N G E   L O G
  2431*
  2432* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2433*-----------------------------------------------------------------
  2434*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2435* EFFECTIVE    NUMBER
  2436*-----------------------------------------------------------------
  2437* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2438* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2439* 111108                   PEMA  ADD CRED BENE ADDR2
  2440******************************************************************
  2441
  2442 01  MAILING-DATA.
  2443     12  MA-RECORD-ID                      PIC XX.
  2444         88  VALID-MA-ID                       VALUE 'MA'.
  2445
  2446     12  MA-CONTROL-PRIMARY.
  2447         16  MA-COMPANY-CD                 PIC X.
  2448         16  MA-CARRIER                    PIC X.
  2449         16  MA-GROUPING.
  2450             20  MA-GROUPING-PREFIX        PIC XXX.
  2451             20  MA-GROUPING-PRIME         PIC XXX.
  2452         16  MA-STATE                      PIC XX.
  2453         16  MA-ACCOUNT.
  2454             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2455             20  MA-ACCOUNT-PRIME          PIC X(6).
  2456         16  MA-CERT-EFF-DT                PIC XX.
  2457         16  MA-CERT-NO.
  2458             20  MA-CERT-PRIME             PIC X(10).
  2459             20  MA-CERT-SFX               PIC X.
  2460
  2461     12  FILLER                            PIC XX.
  2462
  2463     12  MA-ACCESS-CONTROL.
  2464         16  MA-SOURCE-SYSTEM              PIC XX.
  2465             88  MA-FROM-CREDIT                VALUE 'CR'.
  2466             88  MA-FROM-VSI                   VALUE 'VS'.
  2467             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2468             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  47
* EL050.cbl
  2469         16  MA-RECORD-ADD-DT              PIC XX.
  2470         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2471         16  MA-LAST-MAINT-DT              PIC XX.
  2472         16  MA-LAST-MAINT-BY              PIC XXXX.
  2473         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2474
  2475     12  MA-PROFILE-INFO.
  2476         16  MA-QUALIFY-CODE-1             PIC XX.
  2477         16  MA-QUALIFY-CODE-2             PIC XX.
  2478         16  MA-QUALIFY-CODE-3             PIC XX.
  2479         16  MA-QUALIFY-CODE-4             PIC XX.
  2480         16  MA-QUALIFY-CODE-5             PIC XX.
  2481
  2482         16  MA-INSURED-LAST-NAME          PIC X(15).
  2483         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2484         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2485         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2486         16  MA-INSURED-BIRTH-DT           PIC XX.
  2487         16  MA-INSURED-SEX                PIC X.
  2488             88  MA-SEX-MALE                   VALUE 'M'.
  2489             88  MA-SEX-FEMALE                 VALUE 'F'.
  2490         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2491
  2492         16  MA-ADDRESS-CORRECTED          PIC X.
  2493         16  MA-JOINT-BIRTH-DT             PIC XX.
  2494*        16  FILLER                        PIC X(12).
  2495
  2496         16  MA-ADDRESS-LINE-1             PIC X(30).
  2497         16  MA-ADDRESS-LINE-2             PIC X(30).
  2498         16  MA-CITY-STATE.
  2499             20  MA-CITY                   PIC X(28).
  2500             20  MA-ADDR-STATE             PIC XX.
  2501         16  MA-ZIP.
  2502             20  MA-ZIP-CODE.
  2503                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2504                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2505                 24  FILLER                PIC X(4).
  2506             20  MA-ZIP-PLUS4              PIC X(4).
  2507         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2508             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2509             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2510             20  FILLER                    PIC X(3).
  2511
  2512         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2513
  2514         16  FILLER                        PIC XXX.
  2515*        16  FILLER                        PIC X(10).
  2516
  2517     12  MA-CRED-BENE-INFO.
  2518         16  MA-CRED-BENE-NAME                 PIC X(25).
  2519         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2520         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2521         16  MA-CRED-BENE-CTYST.
  2522             20  MA-CRED-BENE-CITY             PIC X(28).
  2523             20  MA-CRED-BENE-STATE            PIC XX.
  2524         16  MA-CRED-BENE-ZIP.
  2525             20  MA-CB-ZIP-CODE.
  2526                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  48
* EL050.cbl
  2527                     88  MA-CB-CANADIAN-POST-CODE
  2528                                           VALUE 'A' THRU 'Z'.
  2529                 24  FILLER                    PIC X(4).
  2530             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2531         16  MA-CB-CANADIAN-POSTAL-CODE
  2532                            REDEFINES MA-CRED-BENE-ZIP.
  2533             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2534             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2535             20  FILLER                        PIC X(3).
  2536     12  MA-POST-CARD-MAIL-DATA.
  2537         16  MA-MAIL-DATA OCCURS 7.
  2538             20  MA-MAIL-TYPE              PIC X.
  2539                 88  MA-12MO-MAILING           VALUE '1'.
  2540                 88  MA-EXP-MAILING            VALUE '2'.
  2541             20  MA-MAIL-STATUS            PIC X.
  2542                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2543                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2544                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2545             20  MA-MAIL-DATE              PIC XX.
  2546     12  FILLER                            PIC XX.
  2547     12  FILLER                            PIC XX.
  2548*    12  FILLER                            PIC X(30).
  2549******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  49
* EL050.cbl
  2551*    COPY ERCPNDM.
  2552******************************************************************
  2553*                                                                *
  2554*                                                                *
  2555*                            ERCPNDM                             *
  2556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2557*                            VMOD=2.003                          *
  2558*                                                                *
  2559*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2560*                                                                *
  2561*   FILE TYPE = VSAM,KSDS                                        *
  2562*   RECORD SIZE = 374   RECFORM = FIX                            *
  2563*                                                                *
  2564*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2565*   ALTERNATE PATH    = NOT USED                                 *
  2566*                                                                *
  2567*   LOG = YES                                                    *
  2568*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2569******************************************************************
  2570*                   C H A N G E   L O G
  2571*
  2572* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2573*-----------------------------------------------------------------
  2574*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2575* EFFECTIVE    NUMBER
  2576*-----------------------------------------------------------------
  2577* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2578* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2579* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2580******************************************************************
  2581
  2582 01  PENDING-MAILING-DATA.
  2583     12  PM-RECORD-ID                      PIC XX.
  2584         88  VALID-MA-ID                       VALUE 'PM'.
  2585
  2586     12  PM-CONTROL-PRIMARY.
  2587         16  PM-COMPANY-CD                 PIC X.
  2588         16  PM-ENTRY-BATCH                PIC X(6).
  2589         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2590         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2591
  2592     12  FILLER                            PIC X(14).
  2593
  2594     12  PM-ACCESS-CONTROL.
  2595         16  PM-SOURCE-SYSTEM              PIC XX.
  2596             88  PM-FROM-CREDIT                VALUE 'CR'.
  2597             88  PM-FROM-VSI                   VALUE 'VS'.
  2598             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2599             88  PM-FROM-OTHER                 VALUE 'OT'.
  2600         16  PM-RECORD-ADD-DT              PIC XX.
  2601         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2602         16  PM-LAST-MAINT-DT              PIC XX.
  2603         16  PM-LAST-MAINT-BY              PIC XXXX.
  2604         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2605
  2606     12  PM-PROFILE-INFO.
  2607         16  PM-QUALIFY-CODE-1             PIC XX.
  2608         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  50
* EL050.cbl
  2609         16  PM-QUALIFY-CODE-3             PIC XX.
  2610         16  PM-QUALIFY-CODE-4             PIC XX.
  2611         16  PM-QUALIFY-CODE-5             PIC XX.
  2612
  2613         16  PM-INSURED-LAST-NAME          PIC X(15).
  2614         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2615         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2616         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2617         16  PM-INSURED-BIRTH-DT           PIC XX.
  2618         16  PM-INSURED-SEX                PIC X.
  2619             88  PM-SEX-MALE                   VALUE 'M'.
  2620             88  PM-SEX-FEMALE                 VALUE 'F'.
  2621         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2622
  2623         16  PM-ADDRESS-CORRECTED          PIC X.
  2624         16  PM-JOINT-BIRTH-DT             PIC XX.
  2625*        16  FILLER                        PIC X(12).
  2626
  2627         16  PM-ADDRESS-LINE-1             PIC X(30).
  2628         16  PM-ADDRESS-LINE-2             PIC X(30).
  2629         16  PM-CITY-STATE.
  2630             20  PM-CITY                   PIC X(28).
  2631             20  PM-STATE                  PIC XX.
  2632         16  PM-ZIP.
  2633             20  PM-ZIP-CODE.
  2634                 24  PM-ZIP-1              PIC X.
  2635                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2636                 24  FILLER                PIC X(4).
  2637             20  PM-ZIP-PLUS4              PIC X(4).
  2638         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2639             20  PM-CAN-POST1              PIC XXX.
  2640             20  PM-CAN-POST2              PIC XXX.
  2641             20  FILLER                    PIC XXX.
  2642
  2643         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2644
  2645         16  FILLER                        PIC X(03).
  2646
  2647     12  PM-CRED-BENE-INFO.
  2648         16  PM-CRED-BENE-NAME             PIC X(25).
  2649         16  PM-CRED-BENE-ADDR             PIC X(30).
  2650         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2651         16  PM-CRED-BENE-CTYST.
  2652             20  PM-CRED-BENE-CITY         PIC X(28).
  2653             20  PM-CRED-BENE-STATE        PIC XX.
  2654         16  PM-CRED-BENE-ZIP.
  2655             20  PM-CB-ZIP-CODE.
  2656                 24  PM-CB-ZIP-1           PIC X.
  2657                     88  PM-CB-CANADIAN-POST-CODE
  2658                                  VALUE 'A' THRU 'Z'.
  2659                 24  FILLER                PIC X(4).
  2660             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2661         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2662             20  PM-CB-CAN-POST1           PIC XXX.
  2663             20  PM-CB-CAN-POST2           PIC XXX.
  2664             20  FILLER                    PIC XXX.
  2665     12  PM-POST-CARD-MAIL-DATA.
  2666         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  51
* EL050.cbl
  2667             20  PM-MAIL-TYPE              PIC X.
  2668                 88  PM-12MO-MAILING           VALUE '1'.
  2669                 88  PM-EXP-MAILING            VALUE '2'.
  2670             20  PM-MAIL-STATUS            PIC X.
  2671                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2672                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2673                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2674             20  PM-MAIL-DATE              PIC XX.
  2675     12  FILLER                            PIC XX.
  2676     12  FILLER                            PIC X(12).
  2677*    12  FILLER                            PIC X(30).
  2678
  2679******************************************************************
  2680*                                COPY ERCLOFC.
  2681******************************************************************
  2682*                                                                *
  2683*                                                                *
  2684*                            ERCLOFC                             *
  2685*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2686*                            VMOD=2.003                          *
  2687*                                                                *
  2688*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2689*                                                                *
  2690*   FILE TYPE = VSAM,KSDS                                        *
  2691*   RECORD SIZE = 670   RECFORM = FIX                            *
  2692*                                                                *
  2693*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2694*                                                                *
  2695*   LOG = YES                                                    *
  2696*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2697*                                                                *
  2698******************************************************************
  2699
  2700 01  LOAN-OFFICER-MASTER.
  2701     12  LO-RECORD-ID                PIC XX.
  2702         88  VALID-LO-ID                VALUE 'LO'.
  2703
  2704     12  LO-CONTROL-PRIMARY.
  2705         16  LO-COMPANY-CD           PIC X.
  2706         16  LO-CARRIER              PIC X.
  2707         16  LO-GROUPING.
  2708             20  LO-GROUPING-PREFIX  PIC XXX.
  2709             20  LO-GROUPING-PRIME   PIC XXX.
  2710         16  LO-STATE                PIC XX.
  2711         16  LO-ACCOUNT.
  2712             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2713             20  LO-ACCOUNT-PRIME    PIC X(6).
  2714         16  LO-OFFICER-CODE         PIC X(5).
  2715
  2716     12  LO-OFFICER-NAME             PIC X(30).
  2717
  2718     12  LO-LAST-MAINT-DT            PIC XX.
  2719     12  LO-LAST-USER                PIC X(4).
  2720     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2721
  2722     12  LO-COMP-CONTROL             PIC X.
  2723             88  LO-SHOW-COMP           VALUE 'Y'.
  2724             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  52
* EL050.cbl
  2725     12  LO-DETAIL-CONTROL           PIC X.
  2726             88  LO-PRINT-DETAIL        VALUE 'D'.
  2727             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2728
  2729     12  LO-SV-CARRIER               PIC X.
  2730     12  LO-SV-GROUPING              PIC X(6).
  2731     12  LO-SV-STATE                 PIC XX.
  2732
  2733     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2734     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2735
  2736     12  LO-OFFICER-INFO.
  2737         16  FILLER OCCURS 12 TIMES.
  2738             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2739             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2740             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2741             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2742             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2743             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2744             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2745             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2746     12  FILLER                      PIC X(198).
  2747******************************************************************
  2748*                                COPY ERCPDEF.
  2749******************************************************************
  2750*                                                                *
  2751*                                                                *
  2752*                            ERCPDEF.                            *
  2753*                                                                *
  2754*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2755*                                                                *
  2756*    FILE TYPE = VSAM,KSDS                                       *
  2757*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2758*                                                                *
  2759*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2760*                                                                *
  2761*    LOG = YES                                                   *
  2762*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2763******************************************************************
  2764*                   C H A N G E   L O G
  2765*
  2766* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2767*-----------------------------------------------------------------
  2768*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2769* EFFECTIVE    NUMBER
  2770*-----------------------------------------------------------------
  2771* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2772* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2773******************************************************************
  2774 01  PRODUCT-MASTER.
  2775    12  PD-RECORD-ID                 PIC X(02).
  2776        88  VALID-PD-ID                  VALUE 'PD'.
  2777    12  PD-CONTROL-PRIMARY.
  2778        16  PD-COMPANY-CD            PIC X.
  2779        16  PD-STATE                 PIC XX.
  2780        16  PD-PRODUCT-CD            PIC XXX.
  2781        16  PD-FILLER                PIC X(7).
  2782        16  PD-BEN-TYPE              PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  53
* EL050.cbl
  2783        16  PD-BEN-CODE              PIC XX.
  2784        16  PD-PROD-EXP-DT           PIC XX.
  2785    12  FILLER                       PIC X(50).
  2786    12  PD-PRODUCT-DATA OCCURS 8.
  2787        16  PD-PROD-CODE             PIC X.
  2788            88  PD-PROD-LIFE           VALUE 'L'.
  2789            88  PD-PROD-PROP           VALUE 'P'.
  2790            88  PD-PROD-AH             VALUE 'A'.
  2791            88  PD-PROD-IU             VALUE 'I'.
  2792            88  PD-PROD-GAP            VALUE 'G'.
  2793            88  PD-PROD-FAML           VALUE 'F'.
  2794        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2795        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2796        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2797        16  PD-MAX-TERM              PIC S999        COMP-3.
  2798        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2799        16  FILLER                   PIC X.
  2800        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2801        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2802        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2803        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2804        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2805        16  PD-REC-CRIT-PERIOD       PIC 99.
  2806        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2807            20  PD-RECURRING-YN      PIC X.
  2808            20  FILLER               PIC X.
  2809        16  PD-RTW-MOS               PIC 99.
  2810        16  PD-MAX-EXTENSION         PIC 99.
  2811        16  FILLER                   PIC XX.
  2812    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2813    12  PD-TERM-LIMITS OCCURS 15.
  2814        16  PD-LOW-TERM              PIC S999        COMP-3.
  2815        16  PD-HI-TERM               PIC S999        COMP-3.
  2816*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2817    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2818        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2819        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2820    12  PD-EARN-FACTORS.
  2821        16  FILLER OCCURS 15.
  2822            20  FILLER OCCURS 15.
  2823                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2824    12  PD-PRODUCT-DESC              PIC X(80).
  2825    12  PD-TRUNCATED                 PIC X.
  2826    12  FILLER                       PIC X(59).
  2827    12  PD-MAINT-INFORMATION.
  2828        16  PD-LAST-MAINT-DT         PIC X(02).
  2829        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2830        16  PD-LAST-MAINT-BY         PIC X(04).
  2831*                                COPY ELCSTATE.
  2832******************************************************************
  2833*                                                                *
  2834*                                                                *
  2835*                            ELCSTATE.                           *
  2836*                                                                *
  2837*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2838*                                                                *
  2839*   FILE TYPE = VSAM,KSDS                                        *
  2840*   RECORD SIZE = 250  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  54
* EL050.cbl
  2841*                                                                *
  2842*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2843*       ALTERNATE INDEX = NONE                                   *
  2844*                                                                *
  2845*   LOG = YES                                                    *
  2846*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2847******************************************************************
  2848*                   C H A N G E   L O G
  2849*
  2850* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2851*-----------------------------------------------------------------
  2852*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2853* EFFECTIVE    NUMBER
  2854*-----------------------------------------------------------------
  2855* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2856******************************************************************
  2857*
  2858 01  STATE-FILE.
  2859     12  SF-RECORD-ID                       PIC XX.
  2860         88  VALID-CF-ID                        VALUE 'SF'.
  2861     12  SF-CONTROL-PRIMARY.
  2862         16  SF-COMPANY-ID                  PIC XXX.
  2863         16  SF-CARRIER-CODE                PIC X.
  2864         16  SF-GROUPING                    PIC X(6).
  2865         16  SF-STATE-CODE                  PIC XX.
  2866         16  SF-EXPIRE-DATE                 PIC 9(8).
  2867****************************************************************
  2868*             STATE CONTROLS
  2869****************************************************************
  2870     12  SF-LAST-MAINT-DT                   PIC XX.
  2871     12  SF-LAST-MAINT-BY                   PIC X(4).
  2872     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2873     12  SF-STATE-RT-CONTROLS.
  2874         16  SF-ST-RT-CALC                  PIC X.
  2875     12  SF-ST-TAX-CONTROLS.
  2876         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2877         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2878         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2879     12  SF-ST-REFUND-OPTIONS.
  2880         16  SF-ST-RF-LR-CALC               PIC X.
  2881         16  SF-ST-RF-LL-CALC               PIC X.
  2882         16  SF-ST-RF-LN-CALC               PIC X.
  2883         16  SF-ST-RF-AH-CALC               PIC X.
  2884         16  SF-ST-RF-CP-CALC               PIC X.
  2885     12  SF-ST-UNEARN-PREM-OPTIONS.
  2886         16  SF-ST-LUEP-R78                 PIC X.
  2887         16  SF-ST-LUEP-PRO                 PIC X.
  2888         16  SF-ST-LUEP-ST                  PIC X.
  2889         16  SF-ST-LUEP-DOM                 PIC X.
  2890         16  SF-ST-AUEP-R78                 PIC X.
  2891         16  SF-ST-AUEP-PRO                 PIC X.
  2892         16  SF-ST-AUEP-ST                  PIC X.
  2893         16  SF-ST-AUEP-DOM                 PIC X.
  2894         16  SF-ST-CUEP-R78                 PIC X.
  2895         16  SF-ST-CUEP-PRO                 PIC X.
  2896         16  SF-ST-CUEP-ST                  PIC X.
  2897         16  SF-ST-CUEP-DOM                 PIC X.
  2898     12  SF-ST-EARN-PREM-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  55
* EL050.cbl
  2899         16  SF-ST-LEP-R78                  PIC X.
  2900         16  SF-ST-LEP-PRO                  PIC X.
  2901         16  SF-ST-LEP-ST                   PIC X.
  2902         16  SF-ST-LEP-DOM                  PIC X.
  2903         16  SF-ST-AEP-R78                  PIC X.
  2904         16  SF-ST-AEP-PRO                  PIC X.
  2905         16  SF-ST-AEP-ST                   PIC X.
  2906         16  SF-ST-AEP-DOM                  PIC X.
  2907         16  SF-ST-CEP-R78                  PIC X.
  2908         16  SF-ST-CEP-PRO                  PIC X.
  2909         16  SF-ST-CEP-ST                   PIC X.
  2910         16  SF-ST-CEP-DOM                  PIC X.
  2911     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  56
* EL050.cbl
  2913*    COPY ELCCRTT.
  2914******************************************************************
  2915*                                                                *
  2916*                            ELCCRTT.                            *
  2917*                                                                *
  2918*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2919*                                                                *
  2920*   FILE TYPE = VSAM,KSDS                                        *
  2921*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2922*                                                                *
  2923*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2924*                                                                *
  2925*   LOG = YES                                                    *
  2926*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2927******************************************************************
  2928*                   C H A N G E   L O G
  2929*
  2930* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2931*-----------------------------------------------------------------
  2932*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2933* EFFECTIVE    NUMBER
  2934*-----------------------------------------------------------------
  2935* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2936* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2937* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2938* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2939* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2940* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2941* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2942******************************************************************
  2943
  2944 01  CERTIFICATE-TRAILERS.
  2945     12  CS-RECORD-ID                      PIC XX.
  2946         88  VALID-CS-ID                      VALUE 'CS'.
  2947
  2948     12  CS-CONTROL-PRIMARY.
  2949         16  CS-COMPANY-CD                 PIC X.
  2950         16  CS-CARRIER                    PIC X.
  2951         16  CS-GROUPING                   PIC X(6).
  2952         16  CS-STATE                      PIC XX.
  2953         16  CS-ACCOUNT                    PIC X(10).
  2954         16  CS-CERT-EFF-DT                PIC XX.
  2955         16  CS-CERT-NO.
  2956             20  CS-CERT-PRIME             PIC X(10).
  2957             20  CS-CERT-SFX               PIC X.
  2958         16  CS-TRAILER-TYPE               PIC X.
  2959             88  COMM-TRLR           VALUE 'A'.
  2960             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2961             88  CERT-DATA-TRLR      VALUE 'C'.
  2962
  2963     12  CS-DATA-AREA                      PIC X(516).
  2964
  2965     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2966         16  CS-BANK-COMMISSION-AREA.
  2967             20  CS-BANK-COMMS       OCCURS 10.
  2968                 24  CS-AGT                PIC X(10).
  2969                 24  CS-COM-TYP            PIC X.
  2970                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  57
* EL050.cbl
  2971                 24  CS-RECALC-LV-INDIC    PIC X.
  2972                 24  FILLER                PIC X(10).
  2973         16  FILLER                        PIC X(256).
  2974
  2975     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2976****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2977         16  CS-MB-CLAIM-DATA OCCURS 24.
  2978             20  CS-CLAIM-NO               PIC X(7).
  2979             20  CS-CLAIM-TYPE             PIC X.
  2980                 88  CS-AH-CLM               VALUE 'A'.
  2981                 88  CS-IU-CLM               VALUE 'I'.
  2982                 88  CS-GP-CLM               VALUE 'G'.
  2983                 88  CS-LF-CLM               VALUE 'L'.
  2984                 88  CS-PR-CLM               VALUE 'P'.
  2985                 88  CS-FL-CLM               VALUE 'F'.
  2986             20  CS-INSURED-TYPE           PIC X.
  2987                 88  CS-PRIM-INSURED          VALUE 'P'.
  2988                 88  CS-CO-BORROWER           VALUE 'C'.
  2989             20  CS-BENEFIT-PERIOD         PIC 99.
  2990             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  2991             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  2992             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  2993         16  FILLER                        PIC X(12).
  2994     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2995         16  CS-VIN-NUMBER                 PIC X(17).
  2996         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2997         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2998         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2999         16  FILLER                        PIC X(496).
  3000*    COPY ELCCRTO.
  3001******************************************************************
  3002*                                                                *
  3003*                            ELCCRTO.                            *
  3004*                                                                *
  3005*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3006*                                                                *
  3007*   FILE TYPE = VSAM,KSDS                                        *
  3008*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3009*                                                                *
  3010*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3011*                                                                *
  3012*   LOG = YES                                                    *
  3013*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3014******************************************************************
  3015*                   C H A N G E   L O G
  3016*
  3017* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3018*-----------------------------------------------------------------
  3019*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3020* EFFECTIVE    NUMBER
  3021*-----------------------------------------------------------------
  3022* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3023* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3024* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3025* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3026* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3027******************************************************************
  3028 01  ORIGINAL-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  58
* EL050.cbl
  3029     12  OC-RECORD-ID                      PIC XX.
  3030         88  VALID-OC-ID                      VALUE 'OC'.
  3031     12  OC-CONTROL-PRIMARY.
  3032         16  OC-COMPANY-CD                 PIC X.
  3033         16  OC-CARRIER                    PIC X.
  3034         16  OC-GROUPING                   PIC X(6).
  3035         16  OC-STATE                      PIC XX.
  3036         16  OC-ACCOUNT                    PIC X(10).
  3037         16  OC-CERT-EFF-DT                PIC XX.
  3038         16  OC-CERT-NO.
  3039             20  OC-CERT-PRIME             PIC X(10).
  3040             20  OC-CERT-SFX               PIC X.
  3041         16  OC-RECORD-TYPE                PIC X.
  3042         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3043     12  OC-LAST-MAINT-DT                  PIC XX.
  3044     12  OC-LAST-MAINT-BY                  PIC X(4).
  3045     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3046     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3047     12  FILLER                            PIC X(49).
  3048     12  OC-ORIG-REC.
  3049         16  OC-INS-LAST-NAME              PIC X(15).
  3050         16  OC-INS-FIRST-NAME             PIC X(10).
  3051         16  OC-INS-MIDDLE-INIT            PIC X.
  3052         16  OC-INS-AGE                    PIC S999     COMP-3.
  3053         16  OC-JNT-LAST-NAME              PIC X(15).
  3054         16  OC-JNT-FIRST-NAME             PIC X(10).
  3055         16  OC-JNT-MIDDLE-INIT            PIC X.
  3056         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3057         16  OC-LF-BENCD                   PIC XX.
  3058         16  OC-LF-TERM                    PIC S999      COMP-3.
  3059         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3060         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3061         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3062         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3063         16  OC-LF-EXP-DT                  PIC XX.
  3064         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3065         16  OC-LF-CANCEL-DT               PIC XX.
  3066         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3067         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3068         16  OC-AH-BENCD                   PIC XX.
  3069         16  OC-AH-TERM                    PIC S999      COMP-3.
  3070         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3071         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3072         16  OC-AH-EXP-DT                  PIC XX.
  3073         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3074         16  OC-AH-CP                      PIC 99.
  3075         16  OC-AH-CANCEL-DT               PIC XX.
  3076         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3077         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3078         16  OC-CRED-BENE-NAME             PIC X(25).
  3079         16  OC-1ST-PMT-DT                 PIC XX.
  3080         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3081         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3082         16  OC-ISSUE-TRAN-IND             PIC X.
  3083         16  OC-CANCEL-TRAN-IND            PIC X.
  3084         16  FILLER                        PIC X(211).
  3085
  3086     12  FILLER                            PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  59
* EL050.cbl
  3087******************************************************************
  3088
  3089*    COPY ELCDATE.
  3090******************************************************************
  3091*                                                                *
  3092*                                                                *
  3093*                            ELCDATE.                            *
  3094*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3095*                            VMOD=2.003
  3096*                                                                *
  3097*                                                                *
  3098*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3099*                 LENGTH = 200                                   *
  3100******************************************************************
  3101
  3102 01  DATE-CONVERSION-DATA.
  3103     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3104     12  DC-OPTION-CODE                PIC X.
  3105         88  BIN-TO-GREG                VALUE ' '.
  3106         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3107         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3108         88  YMD-GREG-TO-BIN            VALUE '3'.
  3109         88  MDY-GREG-TO-BIN            VALUE '4'.
  3110         88  JULIAN-TO-BIN              VALUE '5'.
  3111         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3112         88  FIND-CENTURY               VALUE '7'.
  3113         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3114         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3115         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3116         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3117         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3118         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3119         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3120         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3121         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3122         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3123         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3124         88  BIN-3-TO-GREG              VALUE 'I'.
  3125         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3126         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3127         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3128         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3129         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3130         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3131         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3132         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3133         88  THREE-CHARACTER-BIN
  3134                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3135         88  GREGORIAN-TO-BIN
  3136                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3137         88  BIN-TO-GREGORIAN
  3138                  VALUES ' ' '1' 'I' '8' 'G'.
  3139         88  JULIAN-TO-BINARY
  3140                  VALUES '5' 'C' 'E' 'F'.
  3141     12  DC-ERROR-CODE                 PIC X.
  3142         88  NO-CONVERSION-ERROR        VALUE ' '.
  3143         88  DATE-CONVERSION-ERROR
  3144                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  60
* EL050.cbl
  3145         88  DATE-IS-ZERO               VALUE '1'.
  3146         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3147         88  DATE-IS-INVALID            VALUE '3'.
  3148         88  DATE1-GREATER-DATE2        VALUE '4'.
  3149         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3150         88  DATE-INVALID-OPTION        VALUE '9'.
  3151         88  INVALID-CENTURY            VALUE 'A'.
  3152         88  ONLY-CENTURY               VALUE 'B'.
  3153         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3154         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3155     12  DC-END-OF-MONTH               PIC X.
  3156         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3157     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3158         88  USE-NORMAL-PROCESS         VALUE ' '.
  3159         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3160         88  ADJUST-UP-100-YRS          VALUE '2'.
  3161     12  FILLER                        PIC X.
  3162     12  DC-CONVERSION-DATES.
  3163         16  DC-BIN-DATE-1             PIC XX.
  3164         16  DC-BIN-DATE-2             PIC XX.
  3165         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3166         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3167                       DC-GREG-DATE-1-EDIT.
  3168             20  DC-EDIT1-MONTH        PIC 99.
  3169             20  SLASH1-1              PIC X.
  3170             20  DC-EDIT1-DAY          PIC 99.
  3171             20  SLASH1-2              PIC X.
  3172             20  DC-EDIT1-YEAR         PIC 99.
  3173         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3174         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3175                     DC-GREG-DATE-2-EDIT.
  3176             20  DC-EDIT2-MONTH        PIC 99.
  3177             20  SLASH2-1              PIC X.
  3178             20  DC-EDIT2-DAY          PIC 99.
  3179             20  SLASH2-2              PIC X.
  3180             20  DC-EDIT2-YEAR         PIC 99.
  3181         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3182         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3183                     DC-GREG-DATE-1-YMD.
  3184             20  DC-YMD-YEAR           PIC 99.
  3185             20  DC-YMD-MONTH          PIC 99.
  3186             20  DC-YMD-DAY            PIC 99.
  3187         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3188         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3189                      DC-GREG-DATE-1-MDY.
  3190             20  DC-MDY-MONTH          PIC 99.
  3191             20  DC-MDY-DAY            PIC 99.
  3192             20  DC-MDY-YEAR           PIC 99.
  3193         16  DC-GREG-DATE-1-ALPHA.
  3194             20  DC-ALPHA-MONTH        PIC X(10).
  3195             20  DC-ALPHA-DAY          PIC 99.
  3196             20  FILLER                PIC XX.
  3197             20  DC-ALPHA-CENTURY.
  3198                 24 DC-ALPHA-CEN-N     PIC 99.
  3199             20  DC-ALPHA-YEAR         PIC 99.
  3200         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3201         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3202         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  61
* EL050.cbl
  3203         16  DC-JULIAN-DATE            PIC 9(05).
  3204         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3205                                       PIC 9(05).
  3206         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3207             20  DC-JULIAN-YEAR        PIC 99.
  3208             20  DC-JULIAN-DAYS        PIC 999.
  3209         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3210         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3211         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3212     12  DATE-CONVERSION-VARIBLES.
  3213         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3214         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3215             20  FILLER                PIC 9(3).
  3216             20  HOLD-CEN-1-CCYY.
  3217                 24  HOLD-CEN-1-CC     PIC 99.
  3218                 24  HOLD-CEN-1-YY     PIC 99.
  3219             20  HOLD-CEN-1-MO         PIC 99.
  3220             20  HOLD-CEN-1-DA         PIC 99.
  3221         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3222             20  HOLD-CEN-1-R-MO       PIC 99.
  3223             20  HOLD-CEN-1-R-DA       PIC 99.
  3224             20  HOLD-CEN-1-R-CCYY.
  3225                 24  HOLD-CEN-1-R-CC   PIC 99.
  3226                 24  HOLD-CEN-1-R-YY   PIC 99.
  3227             20  FILLER                PIC 9(3).
  3228         16  HOLD-CENTURY-1-X.
  3229             20  FILLER                PIC X(3)  VALUE SPACES.
  3230             20  HOLD-CEN-1-X-CCYY.
  3231                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3232                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3233             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3234             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3235         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3236             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3237             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3238             20  HOLD-CEN-1-R-X-CCYY.
  3239                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3240                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3241             20  FILLER                PIC XXX.
  3242         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3243         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3244         16  DC-JULIAN-DATE-1          PIC 9(07).
  3245         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3246             20  DC-JULIAN-1-CCYY.
  3247                 24  DC-JULIAN-1-CC    PIC 99.
  3248                 24  DC-JULIAN-1-YR    PIC 99.
  3249             20  DC-JULIAN-DA-1        PIC 999.
  3250         16  DC-JULIAN-DATE-2          PIC 9(07).
  3251         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3252             20  DC-JULIAN-2-CCYY.
  3253                 24  DC-JULIAN-2-CC    PIC 99.
  3254                 24  DC-JULIAN-2-YR    PIC 99.
  3255             20  DC-JULIAN-DA-2        PIC 999.
  3256         16  DC-GREG-DATE-A-EDIT.
  3257             20  DC-EDITA-MONTH        PIC 99.
  3258             20  SLASHA-1              PIC X VALUE '/'.
  3259             20  DC-EDITA-DAY          PIC 99.
  3260             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  62
* EL050.cbl
  3261             20  DC-EDITA-CCYY.
  3262                 24  DC-EDITA-CENT     PIC 99.
  3263                 24  DC-EDITA-YEAR     PIC 99.
  3264         16  DC-GREG-DATE-B-EDIT.
  3265             20  DC-EDITB-MONTH        PIC 99.
  3266             20  SLASHB-1              PIC X VALUE '/'.
  3267             20  DC-EDITB-DAY          PIC 99.
  3268             20  SLASHB-2              PIC X VALUE '/'.
  3269             20  DC-EDITB-CCYY.
  3270                 24  DC-EDITB-CENT     PIC 99.
  3271                 24  DC-EDITB-YEAR     PIC 99.
  3272         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3273         16  DC-GREG-DATE-CYMD-R REDEFINES
  3274                              DC-GREG-DATE-CYMD.
  3275             20  DC-CYMD-CEN           PIC 99.
  3276             20  DC-CYMD-YEAR          PIC 99.
  3277             20  DC-CYMD-MONTH         PIC 99.
  3278             20  DC-CYMD-DAY           PIC 99.
  3279         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3280         16  DC-GREG-DATE-MDCY-R REDEFINES
  3281                              DC-GREG-DATE-MDCY.
  3282             20  DC-MDCY-MONTH         PIC 99.
  3283             20  DC-MDCY-DAY           PIC 99.
  3284             20  DC-MDCY-CEN           PIC 99.
  3285             20  DC-MDCY-YEAR          PIC 99.
  3286    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3287        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3288    12  DC-EL310-DATE                  PIC X(21).
  3289    12  FILLER                         PIC X(28).
  3290
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  63
* EL050.cbl
  3292*    COPY ELCCALC.
  3293******************************************************************
  3294*                                                                *
  3295*                           ELCCALC.                            *
  3296*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3297*                            VMOD=2.025                          *
  3298*                                                                *
  3299*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3300*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3301*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3302*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3303*                                                                *
  3304*  PASSED TO ELRTRM                                              *
  3305*  -----------------                                             *
  3306*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3307*  ORIGINAL TERM                                                 *
  3308*  BEGINNING DATE                                                *
  3309*  ENDING DATE                                                   *
  3310*  COMPANY I.D.                                                  *
  3311*  ACCOUNT MASTER USER FIELD                                     *
  3312*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3313*  FREE LOOK DAYS                                                *
  3314*                                                                *
  3315*  RETURNED FROM ELRTRM                                          *
  3316*  ---------------------                                         *
  3317*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3318*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3319*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3320*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3321*----------------------------------------------------------------*
  3322*  PASSED TO ELRAMT                                              *
  3323*  ----------------                                              *
  3324*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3325*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3326*  ORIGINAL AMOUNT                                               *
  3327*  ALTERNATE BENEFIT (BALLON)                                    *
  3328*  A.P.R. - NET PAY ONLY                                         *
  3329*  METHOD
  3330*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3331*  COMPANY I.D.                                                  *
  3332*  BENEFIT TYPE                                                  *
  3333*                                                                *
  3334*  RETURNED FROM ELRAMT                                          *
  3335*  --------------------                                          *
  3336*  REMAINING AMOUNT 1 - CURRENT                                  *
  3337*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3338*  REMAINING AMOUNT FACTOR
  3339*----------------------------------------------------------------*
  3340*  PASSED TO ELRESV                                              *
  3341*  -----------------                                             *
  3342*  CERTIFICATE EFFECTIVE DATE                                    *
  3343*  VALUATION DATE                                                *
  3344*  PAID THRU DATE                                                *
  3345*  BENEFIT                                                       *
  3346*  INCURRED DATE                                                 *
  3347*  REPORTED DATE                                                 *
  3348*  ISSUE AGE                                                     *
  3349*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  64
* EL050.cbl
  3350*  CDT PERCENT                                                   *
  3351*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3352* *CLAIM TYPE (LIFE, A/H)                                        *
  3353* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3354* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3355*                                                                *
  3356*  RETURNED FROM ELRESV                                          *
  3357*  --------------------                                          *
  3358*  CDT TABLE USED                                                *
  3359*  CDT FACTOR USED                                               *
  3360*  PAY TO CURRENT RESERVE                                        *
  3361*  I.B.N.R. - A/H ONLY                                           *
  3362*  FUTURE (ACCRUED) AH ONLY                                      *
  3363*----------------------------------------------------------------*
  3364*  PASSED TO ELRATE                                              *
  3365*  ----------------                                              *
  3366*  CERT ISSUE DATE                                               *
  3367*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3368*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3369*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3370*  STATE CODE (CLIENT DEFINED)                                   *
  3371*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3372*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3373*  DEVIATION CODE                                                *
  3374*  ISSUE AGE                                                     *
  3375*  ORIGINAL BENEFIT AMOUNT                                       *
  3376*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3377*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3378*  BENEFIT KIND (LIFE OR A/H)                                    *
  3379*  A.P.R.                                                        *
  3380*  METHOD
  3381*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3382*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3383*  COMPANY I.D. (3 CHARACTER)                                    *
  3384*  BENEFIT CODE                                                  *
  3385*  BENEFIT OVERRIDE CODE                                         *
  3386*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3387*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3388*  JOINT INDICATOR (CSL ONLY)                                    *
  3389*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3390*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3391*                                                                *
  3392*  RETURNED FROM ELRATE                                          *
  3393*  --------------------                                          *
  3394*  CALCULATED PREMIUM                                            *
  3395*  PREMIUM RATE                                                  *
  3396*  MORTALITY CODE                                                *
  3397*  MAX ATTAINED AGE                                              *
  3398*  MAX AGE                                                       *
  3399*  MAX TERM                                                      *
  3400*  MAX MONTHLY BENEFIT                                           *
  3401*  MAX TOTAL BENIFIT                                             *
  3402*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3403*----------------------------------------------------------------*
  3404*  PASSED TO ELRFND                                              *
  3405*  ----------------                                              *
  3406*  CERT ISSUE DATE                                               *
  3407*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  65
* EL050.cbl
  3408*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3409*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3410*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3411*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3412*  STATE CODE (CLIENT DEFINED)                                   *
  3413*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3414*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3415*  DEVIATION CODE                                                *
  3416*  ISSUE AGE                                                     *
  3417*  ORIGINAL BENEFIT AMOUNT                                       *
  3418*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3419*  PROCESS TYPE (CANCEL)                                         *
  3420*  BENEFIT KIND (LIFE OR A/H)                                    *
  3421*  A.P.R.                                                        *
  3422*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3423*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3424*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3425*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3426*  COMPANY I.D. (3 CHARACTER)                                    *
  3427*  BENEFIT CODE                                                  *
  3428*  BENEFIT OVERRIDE CODE                                         *
  3429*                                                                *
  3430*  RETURNED FROM ELRFND                                          *
  3431*  --------------------                                          *
  3432*  CALCULATED REFUND                                             *
  3433*----------------------------------------------------------------*
  3434*  PASSED TO ELEARN                                              *
  3435*  ----------------                                              *
  3436*  CERT ISSUE DATE                                               *
  3437*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3438*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3439*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3440*  STATE CODE (CLIENT DEFINED)                                   *
  3441*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3442*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3443*  DEVIATION CODE                                                *
  3444*  ISSUE AGE                                                     *
  3445*  ORIGINAL BENEFIT AMOUNT                                       *
  3446*  BENEFIT KIND (LIFE OR A/H)                                    *
  3447*  A.P.R.                                                        *
  3448*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3449*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3450*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3451*  COMPANY I.D. (3 CHARACTER)                                    *
  3452*  BENEFIT CODE                                                  *
  3453*  BENEFIT OVERRIDE CODE                                         *
  3454*                                                                *
  3455*  RETURNED FROM ELEARN                                          *
  3456*  --------------------                                          *
  3457*  INDICATED  EARNINGS                                           *
  3458*----------------------------------------------------------------*
  3459*                 LENGTH = 450                                   *
  3460*                                                                *
  3461******************************************************************
  3462******************************************************************
  3463*                   C H A N G E   L O G
  3464*
  3465* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  66
* EL050.cbl
  3466*-----------------------------------------------------------------
  3467*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3468* EFFECTIVE    NUMBER
  3469*-----------------------------------------------------------------
  3470* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3471* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3472* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3473* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3474* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3475* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3476* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3477* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3478* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3479******************************************************************
  3480
  3481 01  CALCULATION-PASS-AREA.
  3482     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3483                                     COMP.
  3484
  3485     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3486       88  NO-CP-ERROR                             VALUE ZERO.
  3487       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3488                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3489       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3490       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3491       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3492       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3493       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3494       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3495       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3496       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3497       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3498       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3499       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3500       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3501       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3502       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3503       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3504       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3505       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3506
  3507     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3508       88  NO-CP-ERROR-2                           VALUE ZERO.
  3509***********************  INPUT AREAS ****************************
  3510
  3511     12  CP-CALCULATION-AREA.
  3512         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3513         16  CP-CERT-EFF-DT        PIC XX.
  3514         16  CP-VALUATION-DT       PIC XX.
  3515         16  CP-PAID-THRU-DT       PIC XX.
  3516         16  CP-BENEFIT-TYPE       PIC X.
  3517           88  CP-AH                               VALUE 'A' 'D'
  3518                                                   'I' 'U'.
  3519           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3520           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3521         16  CP-INCURRED-DT        PIC XX.
  3522         16  CP-REPORTED-DT        PIC XX.
  3523         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  67
* EL050.cbl
  3524         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3525         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3526                                     COMP-3.
  3527         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3528                                     COMP-3.
  3529         16  CP-CDT-METHOD         PIC X.
  3530           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3531           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3532           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3533         16  CP-CLAIM-TYPE         PIC X.
  3534           88  CP-AH-CLAIM                         VALUE 'A'.
  3535           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3536         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3537                                     COMP-3.
  3538         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3539                                     COMP-3.
  3540         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3541                                     COMP-3.
  3542         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3543                                     COMP-3.
  3544         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3545                                     COMP-3.
  3546         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3547                                     COMP-3.
  3548         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3549                                     COMP-3.
  3550         16  CP-REM-TERM-METHOD    PIC X.
  3551           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3552           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3553           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3554           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3555           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3556           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3557           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3558         16  CP-EARNING-METHOD     PIC X.
  3559           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3560           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3561           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3562           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3563           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3564           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3565           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3566           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3567           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3568           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3569           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3570           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3571           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3572           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3573         16  CP-PROCESS-TYPE       PIC X.
  3574           88  CP-CLAIM                            VALUE '1'.
  3575           88  CP-CANCEL                           VALUE '2'.
  3576           88  CP-ISSUE                            VALUE '3'.
  3577         16  CP-SPECIAL-CALC-CD    PIC X.
  3578           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3579           88  CP-1-MTH-INTEREST               VALUE ' '.
  3580           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3581           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  68
* EL050.cbl
  3582           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3583           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3584           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3585           88  CP-FARM-PLAN                    VALUE 'F'.
  3586           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3587           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3588           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3589           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3590           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3591           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3592           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3593           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3594           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3595           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3596                                                     'W' 'X'.
  3597           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3598           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3599           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3600           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3601           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3602           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3603           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3604           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3605           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3606           88  CP-CSL-METH-1                   VALUE '5'.
  3607           88  CP-CSL-METH-2                   VALUE '6'.
  3608           88  CP-CSL-METH-3                   VALUE '7'.
  3609           88  CP-CSL-METH-4                   VALUE '8'.
  3610
  3611         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3612                                     COMP-3.
  3613         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3614         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3615         16  CP-STATE              PIC XX          VALUE SPACE.
  3616         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3617         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3618           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3619               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3620         16  CP-R78-OPTION         PIC X.
  3621           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3622           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3623
  3624         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3625         16  CP-IBNR-RESERVE-SW    PIC X.
  3626         16  CP-CLAIM-STATUS       PIC X.
  3627         16  CP-RATE-FILE          PIC X.
  3628         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3629                                     COMP-3.
  3630
  3631         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3632         16  CP-AH-OVERRIDE-CODE   PIC X.
  3633
  3634         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3635                                     COMP-3.
  3636         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3637                                   PIC S9(5)V99 COMP-3.
  3638         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3639                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  69
* EL050.cbl
  3640         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3641                                     COMP-3.
  3642         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3643                                     COMP-3.
  3644         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3645                                  PIC S9(7)V99 COMP-3.
  3646
  3647         16  CP-PAID-FROM-DATE     PIC X(02).
  3648         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3649         16  CP-EXT-DAYS-CALC      PIC X.
  3650           88  CP-EXT-NO-CHG                   VALUE ' '.
  3651           88  CP-EXT-CHG-LF                   VALUE '1'.
  3652           88  CP-EXT-CHG-AH                   VALUE '2'.
  3653           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3654         16  CP-DOMICILE-STATE     PIC XX.
  3655         16  CP-CARRIER            PIC X.
  3656         16  CP-REIN-FLAG          PIC X.
  3657         16  CP-REM-TRM-CALC-OPTION PIC X.
  3658           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3659                      '2' '3' '4' '5'.
  3660           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3661           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3662           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3663           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3664           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3665           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3666           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3667           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3668         16  CP-SIG-SWITCH         PIC X.
  3669         16  CP-RATING-METHOD      PIC X.
  3670           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3671           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3672           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3673           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3674           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3675           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3676           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3677           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3678           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3679         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3680                                     COMP-3.
  3681         16  CP-BEN-CATEGORY       PIC X.
  3682         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3683         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3684                                   PIC S99V9(5) COMP-3.
  3685         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3686         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3687                                   PIC S99V9(5) COMP-3.
  3688         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3689         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3690         16  CP-EXPIRE-DT          PIC XX.
  3691         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3692         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3693         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3694         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3695         16  CP-DDF-SPEC-CALC      PIC X.
  3696             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3697             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  70
* EL050.cbl
  3698         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3699         16  CP-CANCEL-REASON      PIC X.
  3700         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3701         16  CP-PMT-MODE           PIC X.
  3702         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3703         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3704         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3705         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3706         16  FILLER                PIC X.
  3707
  3708***************    OUTPUT FROM ELRESV   ************************
  3709
  3710         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3711
  3712         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3713                                     COMP-3.
  3714         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3715                                     COMP-3.
  3716         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3717                                     COMP-3.
  3718         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3719                                     COMP-3.
  3720         16  FILLER                PIC X(09).
  3721***************    OUTPUT FROM ELRTRM   *************************
  3722
  3723         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3724                                     COMP-3.
  3725         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3726                                     COMP-3.
  3727         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3728                                     COMP-3.
  3729         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3730                                     COMP-3.
  3731         16  FILLER                PIC X(12).
  3732
  3733***************    OUTPUT FROM ELRAMT   *************************
  3734
  3735         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3736                                     COMP-3.
  3737         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3738                                     COMP-3.
  3739         16  FILLER                PIC X(12).
  3740
  3741***************    OUTPUT FROM ELRATE   *************************
  3742
  3743         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3744                                     COMP-3.
  3745         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3746                                     COMP-3.
  3747         16  CP-MORTALITY-CODE     PIC X(4).
  3748         16  CP-RATE-EDIT-FLAG     PIC X.
  3749             88  CP-RATES-NEED-APR                  VALUE '1'.
  3750         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3751                                     COMP-3.
  3752         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3753         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3754         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3755                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  71
* EL050.cbl
  3756         16  FILLER                PIC X(07).
  3757
  3758***************    OUTPUT FROM ELRFND   *************************
  3759
  3760         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3761                                     COMP-3.
  3762         16  CP-REFUND-TYPE-USED   PIC X.
  3763           88  CP-R-AS-R78                         VALUE '1'.
  3764           88  CP-R-AS-PRORATA                     VALUE '2'.
  3765           88  CP-R-AS-CALIF                       VALUE '3'.
  3766           88  CP-R-AS-TEXAS                       VALUE '4'.
  3767           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3768           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3769           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3770           88  CP-R-AS-MEAN                        VALUE '8'.
  3771           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3772           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3773           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3774           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3775           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3776           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3777         16  FILLER                PIC X(12).
  3778
  3779***************    OUTPUT FROM ELEARN   *************************
  3780
  3781         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3782                                     COMP-3.
  3783         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3784                                     COMP-3.
  3785         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3786                                     COMP-3.
  3787         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3788                                     COMP-3.
  3789         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3790                                     COMP-3.
  3791         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3792                                     COMP-3.
  3793         16  CP-EARNING-TYPE-USED  PIC X.
  3794           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3795           88  CP-E-AS-R78                         VALUE '1'.
  3796           88  CP-E-AS-PRORATA                     VALUE '2'.
  3797           88  CP-E-AS-TEXAS                       VALUE '4'.
  3798           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3799           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3800           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3801           88  CP-E-AS-MEAN                        VALUE '8'.
  3802           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3803         16  FILLER                PIC X(12).
  3804
  3805***************    OUTPUT FROM ELPMNT   *************************
  3806
  3807         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3808                                     COMP-3.
  3809         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3810                                     COMP-3.
  3811         16  FILLER                PIC X(12).
  3812
  3813***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  72
* EL050.cbl
  3814         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3815                                     COMP-3.
  3816         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3817                                     COMP-3.
  3818         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3819                                     COMP-3.
  3820         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3821                                     COMP-3.
  3822         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3823                                     COMP-3.
  3824         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3825                                     COMP-3.
  3826         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3827             88  OPEN-RATE-FILE                   VALUE 'O'.
  3828             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3829             88  IO-ERROR                         VALUE 'E'.
  3830
  3831         16  CP-FIRST-PAY-DATE     PIC XX.
  3832
  3833         16  CP-JOINT-INDICATOR    PIC X.
  3834
  3835         16  CP-RESERVE-REMAINING-TERM
  3836                                   PIC S9(4)V9    VALUE ZERO
  3837                                     COMP-3.
  3838
  3839         16  CP-INSURED-BIRTH-DT   PIC XX.
  3840
  3841         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3842                                     COMP-3.
  3843
  3844         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3845                                     COMP-3.
  3846
  3847         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3848                                     COMP-3.
  3849
  3850         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3851                                     COMP-3.
  3852
  3853         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3854                                     COMP-3.
  3855
  3856         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3857                                     COMP-3.
  3858
  3859         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3860                                     COMP-3.
  3861
  3862         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3863             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3864
  3865         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3866                                     COMP-3.
  3867         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3868                                     COMP-3.
  3869         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3870         16  FILLER                PIC X(15).
  3871******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  73
* EL050.cbl
  3873******************************************************************
  3874*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3875*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3876*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3877*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3878*** MODIFICATION.                                              ***
  3879*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3880*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3881******************************************************************
  3882*    COPY ERCPNDB.
  3883******************************************************************
  3884*                                                                *
  3885*                                                                *
  3886*                            ERCPNDB.                            *
  3887*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3888*                            VMOD=2.025                          *
  3889*                                                                *
  3890*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3891*                                                                *
  3892******************************************************************
  3893*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3894*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3895******************************************************************
  3896*                                                                *
  3897*                                                                *
  3898*   FILE TYPE = VSAM,KSDS                                        *
  3899*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3900*                                                                *
  3901*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3902*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3903*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3904*                                                 RKP=13,LEN=36  *
  3905*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3906*                                      AND CHG-SEQ.)             *
  3907*                                                RKP=49,LEN=11   *
  3908*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3909*                                      AND CHG-SEQ.)             *
  3910*                                                RKP=60,LEN=15   *
  3911*                                                                *
  3912*   LOG = NO                                                     *
  3913*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3914******************************************************************
  3915******************************************************************
  3916*                   C H A N G E   L O G
  3917*
  3918* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3919*-----------------------------------------------------------------
  3920*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3921* EFFECTIVE    NUMBER
  3922*-----------------------------------------------------------------
  3923* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3924* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3925* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3926* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3927* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3928* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3929* 032306                   PEMA  ADD BOW LOAN NUMBER
  3930* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  74
* EL050.cbl
  3931* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3932* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3933* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3934* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3935* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3936* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3937* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3938* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3939******************************************************************
  3940
  3941 01  PENDING-BUSINESS.
  3942     12  PB-RECORD-ID                     PIC XX.
  3943         88  VALID-PB-ID                        VALUE 'PB'.
  3944
  3945     12  PB-CONTROL-PRIMARY.
  3946         16  PB-COMPANY-CD                PIC X.
  3947         16  PB-ENTRY-BATCH               PIC X(6).
  3948         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3949         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3950
  3951     12  PB-CONTROL-BY-ACCOUNT.
  3952         16  PB-COMPANY-CD-A1             PIC X.
  3953         16  PB-CARRIER                   PIC X.
  3954         16  PB-GROUPING.
  3955             20  PB-GROUPING-PREFIX       PIC XXX.
  3956             20  PB-GROUPING-PRIME        PIC XXX.
  3957         16  PB-STATE                     PIC XX.
  3958         16  PB-ACCOUNT.
  3959             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3960             20  PB-ACCOUNT-PRIME         PIC X(6).
  3961         16  PB-CERT-EFF-DT               PIC XX.
  3962         16  PB-CERT-NO.
  3963             20  PB-CERT-PRIME            PIC X(10).
  3964             20  PB-CERT-SFX              PIC X.
  3965         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3966
  3967         16  PB-RECORD-TYPE               PIC X.
  3968             88  PB-MAILING-DATA                VALUE '0'.
  3969             88  PB-ISSUE                       VALUE '1'.
  3970             88  PB-CANCELLATION                VALUE '2'.
  3971             88  PB-BATCH-TRAILER               VALUE '9'.
  3972
  3973     12  PB-CONTROL-BY-ORIG-BATCH.
  3974         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3975         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3976         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3977         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3978
  3979     12  PB-CONTROL-BY-CSR.
  3980         16  PB-CSR-COMPANY-CD            PIC X.
  3981         16  PB-CSR-ID                    PIC X(4).
  3982         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3983         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3984         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3985******************************************************************
  3986*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3987******************************************************************
  3988
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  75
* EL050.cbl
  3989     12  PB-LAST-MAINT-DT                 PIC XX.
  3990     12  PB-LAST-MAINT-BY                 PIC X(4).
  3991     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3992
  3993     12  PB-RECORD-BODY                   PIC X(375).
  3994
  3995     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3996         16  PB-CERT-ORIGIN               PIC X.
  3997             88  CLASIC-CREATED-CERT         VALUE '1'.
  3998         16  PB-I-NAME.
  3999             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4000             20  PB-I-INSURED-FIRST-NAME.
  4001                 24  PB-I-INSURED-1ST-INIT PIC X.
  4002                 24  FILLER                PIC X(9).
  4003             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4004         16  PB-I-AGE                     PIC S99   COMP-3.
  4005         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4006         16  PB-I-BIRTHDAY                PIC XX.
  4007         16  PB-I-INSURED-SEX             PIC X.
  4008             88  PB-SEX-MALE     VALUE 'M'.
  4009             88  PB-SEX-FEMALE   VALUE 'F'.
  4010
  4011         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4012         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4013         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4014         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4015         16  PB-I-SKIP-CODE               PIC X.
  4016             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4017             88  PB-SKIP-JULY              VALUE '1'.
  4018             88  PB-SKIP-AUGUST            VALUE '2'.
  4019             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4020             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4021             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4022             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4023             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4024             88  PB-SKIP-JUNE              VALUE '8'.
  4025             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4026             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4027             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4028         16  PB-I-TERM-TYPE               PIC X.
  4029             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4030             88  PB-PAID-WEEKLY            VALUE 'W'.
  4031             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4032             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4033             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4034         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4035         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4036         16  PB-I-DATA-ENTRY-SW           PIC X.
  4037             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4038             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4039             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4040             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4041         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4042         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4043*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4044         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4045         16  FILLER                       PIC X.
  4046
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  76
* EL050.cbl
  4047         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4048             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4049             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4050                                                   '90' THRU '99'.
  4051         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4052                                          PIC XX.
  4053         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4054         16  PB-I-AMOUNT-FINANCED REDEFINES
  4055                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4056         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4057         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4058                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4059         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4060         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4061         16  PB-I-CLP-AMOUNT REDEFINES
  4062                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4063         16  PB-I-LF-CALC-FLAG            PIC X.
  4064             88 PB-COMP-LF-PREM               VALUE '?'.
  4065         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4066         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4067         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4068         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4069         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4070         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4071         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4072         16  PB-I-LF-ABBR                 PIC XXX.
  4073         16  PB-I-LF-INPUT-CD             PIC XX.
  4074
  4075         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4076             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4077             88  PB-INVALID-AH               VALUE '  ' '00'
  4078                                                   '90' THRU '99'.
  4079         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4080         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4081         16  PB-I-AH-CALC-FLAG            PIC X.
  4082             88 PB-COMP-AH-PREM                  VALUE '?'.
  4083         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4084         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4085         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4086         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4087         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4088         16  PB-I-AH-ABBR                 PIC XXX.
  4089         16  PB-I-AH-INPUT-CD             PIC XXX.
  4090
  4091         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4092         16  PB-I-REIN-TABLE              PIC XXX.
  4093         16  PB-I-BUSINESS-TYPE           PIC 99.
  4094         16  PB-I-INDV-GRP-CD             PIC X.
  4095         16  PB-I-MORT-CODE.
  4096             20  PB-I-TABLE               PIC X.
  4097             20  PB-I-INTEREST            PIC XX.
  4098             20  PB-I-MORT-TYP            PIC X.
  4099         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4100         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4101         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4102         16  PB-I-INDV-GRP-OVRD           PIC X.
  4103         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4104         16  PB-I-SIG-SW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  77
* EL050.cbl
  4105             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4106         16  PB-I-RATE-CLASS              PIC XX.
  4107         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4108         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4109         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4110         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4111         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4112         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4113         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4114         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4115         16  PB-I-OB-FLAG                 PIC X.
  4116             88  PB-I-OB                      VALUE 'B'.
  4117             88  PB-I-SUMMARY                 VALUE 'Z'.
  4118         16  PB-I-ENTRY-STATUS            PIC X.
  4119             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4120                                              'M' '5' '9' '2'.
  4121             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4122             88  PB-I-POLICY-PENDING          VALUE '2'.
  4123             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4124             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4125             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4126             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4127             88  PB-I-REIN-ONLY               VALUE '9'.
  4128             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4129             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4130             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4131             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4132         16  PB-I-INT-CODE                PIC X.
  4133             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4134             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4135         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4136         16  PB-I-SOC-SEC-NO              PIC X(11).
  4137         16  PB-I-MEMBER-NO               PIC X(12).
  4138         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4139*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4140         16  PB-I-OLD-LOF                 PIC XXX.
  4141         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4142         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4143         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4144         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4145         16  PB-I-LIFE-INDICATOR          PIC X.
  4146             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4147         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4148         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4149                                          PIC S9(5)V99    COMP-3.
  4150         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4151             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4152             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4153         16  PB-I-1ST-PMT-DT              PIC XX.
  4154         16  PB-I-JOINT-INSURED.
  4155             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4156             20 PB-I-JOINT-FIRST-NAME.
  4157                24  PB-I-JOINT-FIRST-INIT PIC X.
  4158                24  FILLER                PIC X(9).
  4159             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4160*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4161         16  PB-I-BENEFICIARY-NAME.
  4162             20  PB-I-BANK-NUMBER         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  78
* EL050.cbl
  4163             20  FILLER                   PIC X(15).
  4164         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4165         16  PB-I-REFERENCE               PIC X(12).
  4166         16  FILLER REDEFINES PB-I-REFERENCE.
  4167             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4168             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4169             20  PB-I-CLP-STATE           PIC XX.
  4170         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4171             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4172             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4173             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4174         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4175         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4176         16  PB-I-RESIDENT-STATE          PIC XX.
  4177         16  PB-I-RATE-CODE               PIC X(4).
  4178         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4179         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4180         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4181         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4182         16  PB-I-BANK-NOCHRGB            PIC 99.
  4183         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4184         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4185
  4186     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4187         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4188             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4189         16  PB-C-CANCEL-ORIGIN           PIC X.
  4190             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4191         16  PB-C-LF-CANCEL-DT            PIC XX.
  4192         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4193         16  PB-C-LF-CALC-REQ             PIC X.
  4194             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4195         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4196         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4197         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4198             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4199         16  PB-C-AH-CANCEL-DT            PIC XX.
  4200         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4201         16  PB-C-AH-CALC-REQ             PIC X.
  4202             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4203         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4204         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4205         16  PB-C-LAST-NAME               PIC X(15).
  4206         16  PB-C-REFUND-SW               PIC X.
  4207             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4208             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4209         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4210         16  PB-C-PAYEE-CODE              PIC X(6).
  4211         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4212         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4213         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4214         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4215         16  PB-C-REFERENCE               PIC X(12).
  4216         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4217         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4218         16  PB-C-POST-CARD-IND           PIC X.
  4219         16  PB-C-CANCEL-REASON           PIC X.
  4220         16  PB-C-REF-INTERFACE-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  79
* EL050.cbl
  4221         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4222         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4223         16  FILLER                       PIC X(01).
  4224*        16  FILLER                       PIC X(18).
  4225         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4226*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4227         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4228         16  PB-CANCELED-CERT-DATA.
  4229             20  PB-CI-INSURED-NAME.
  4230                 24  PB-CI-LAST-NAME      PIC X(15).
  4231                 24  PB-CI-INITIALS       PIC XX.
  4232             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4233             20  PB-CI-INSURED-SEX        PIC X.
  4234             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4235             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4236             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4237             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4238             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4239             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4240             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4241             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4242             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4243             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4244             20  PB-CI-RATE-CLASS         PIC XX.
  4245             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4246             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4247             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4248             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4249             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4250             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4251             20  PB-CI-LF-ABBR            PIC X(3).
  4252             20  PB-CI-AH-ABBR            PIC X(3).
  4253             20  PB-CI-OB-FLAG            PIC X.
  4254                 88  PB-CI-OB                VALUE 'B'.
  4255             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4256                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4257                                           'M' '4' '5' '9' '2'.
  4258                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4259                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4260                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4261                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4262                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4263                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4264                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4265                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4266                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4267                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4268                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4269                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4270                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4271             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4272                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4273                                           'M' '4' '5' '9' '2'.
  4274                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4275                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4276                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4277                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4278                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  80
* EL050.cbl
  4279                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4280                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4281                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4282                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4283                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4284                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4285                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4286                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4287             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4288             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4289             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4290             20  PB-CI-MEMBER-NO          PIC X(12).
  4291             20  PB-CI-INT-CODE           PIC X.
  4292                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4293                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4294             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4295             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4296             20  PB-CI-COMP-EXCP-SW       PIC X.
  4297                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4298                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4299             20  PB-CI-ENTRY-STATUS       PIC X.
  4300             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4301             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4302             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4303             20  PB-CI-DEATH-DT           PIC XX.
  4304             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4305             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4306             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4307             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4308             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4309             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4310             20  PB-CI-ENTRY-DT              PIC XX.
  4311             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4312             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4313             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4314             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4315             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4316             20  PB-CI-OLD-LOF               PIC XXX.
  4317*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4318             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4319             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4320             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4321             20  PB-CI-INDV-GRP-CD           PIC X.
  4322             20  PB-CI-BENEFICIARY-NAME.
  4323                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4324                 24  FILLER                  PIC X(15).
  4325             20  PB-CI-NOTE-SW               PIC X.
  4326             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4327             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4328             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4329             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4330             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4331             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4332             20  PB-CI-FIRST-NAME            PIC X(10).
  4333             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4334
  4335         16  FILLER                       PIC X(13).
  4336*032306  16  FILLER                       PIC X(27).
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  81
* EL050.cbl
  4337*        16  FILLER                       PIC X(46).
  4338
  4339     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4340         16  FILLER                       PIC X(10).
  4341         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4342         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4343         16  PB-M-INSURED-MID-INIT        PIC X.
  4344         16  PB-M-INSURED-AGE             PIC 99.
  4345         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4346         16  PB-M-INSURED-SEX             PIC X.
  4347         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4348         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4349         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4350         16  PB-M-INSURED-CITY-STATE.
  4351             20  PB-M-INSURED-CITY        PIC X(28).
  4352             20  PB-M-INSURED-STATE       PIC XX.
  4353         16  PB-M-INSURED-ZIP-CODE.
  4354             20  PB-M-INSURED-ZIP-PRIME.
  4355                 24  PB-M-INSURED-ZIP-1   PIC X.
  4356                     88  PB-M-CANADIAN-POST-CODE
  4357                                             VALUE 'A' THRU 'Z'.
  4358                 24  FILLER               PIC X(4).
  4359             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4360         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4361                                        PB-M-INSURED-ZIP-CODE.
  4362             20  PM-M-INS-CAN-POST1       PIC XXX.
  4363             20  PM-M-INS-CAN-POST2       PIC XXX.
  4364             20  FILLER                   PIC XXX.
  4365         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4366         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4367         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4368         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4369         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4370         16  PB-M-CRED-BENE-CITYST.
  4371             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4372             20  PB-M-CRED-BENE-STATE     PIC XX.
  4373         16  FILLER                       PIC X(92).
  4374
  4375     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4376         16  FILLER                       PIC X(10).
  4377         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4378         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4379         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4380         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4381         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4382         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4383         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4384         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4385         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4386         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4387         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4388         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4389         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4390         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4391         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4392         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4393         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4394         16  PB-ACCOUNT-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  82
* EL050.cbl
  4395         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4396         16  PB-REFERENCE                 PIC X(12).
  4397         16  PB-B-RECEIVED-DT             PIC XX.
  4398         16  FILLER                       PIC X(234).
  4399
  4400     12  PB-RECORD-STATUS.
  4401         16  PB-CREDIT-SELECT-DT          PIC XX.
  4402         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4403         16  PB-BILLED-DT                 PIC XX.
  4404         16  PB-BILLING-STATUS            PIC X.
  4405             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4406             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4407             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4408         16  PB-RECORD-BILL               PIC X.
  4409             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4410             88  PB-RECORD-RETURNED           VALUE 'R'.
  4411             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4412             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4413             88  PB-OVERRIDE-AH               VALUE 'A'.
  4414             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4415         16  PB-BATCH-ENTRY               PIC X.
  4416             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4417             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4418             88  PB-REISSUED-CERT             VALUE 'E'.
  4419             88  PB-CASH-CERT                 VALUE 'C'.
  4420             88  PB-MONTHLY-CERT              VALUE 'M'.
  4421             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4422             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4423             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4424         16  PB-FORCE-CODE                PIC X.
  4425             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4426             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4427             88  PB-CANCEL-FORCE              VALUE '8'.
  4428             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4429             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4430             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4431             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4432             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4433             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4434             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4435         16  PB-FATAL-FLAG                PIC X.
  4436             88  PB-FATAL-ERRORS              VALUE 'X'.
  4437         16  PB-FORCE-ER-CD               PIC X.
  4438             88  PB-FORCE-ERRORS              VALUE 'F'.
  4439             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4440         16  PB-WARN-ER-CD                PIC X.
  4441             88  PB-WARNING-ERRORS            VALUE 'W'.
  4442         16  FILLER                       PIC X.
  4443         16  PB-OUT-BAL-CD                PIC X.
  4444             88  PB-OUT-OF-BAL                VALUE 'O'.
  4445         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4446         16  PB-AH-OVERRIDE-L1            PIC X.
  4447         16  PB-INPUT-DT                  PIC XX.
  4448         16  PB-INPUT-BY                  PIC X(4).
  4449         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4450         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4451         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4452         16  PB-LF-EARNING-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  83
* EL050.cbl
  4453         16  PB-AH-EARNING-METHOD         PIC X.
  4454         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4455         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4456         16  PB-REIN-CD                   PIC XXX.
  4457         16  PB-LF-REFUND-TYPE            PIC X.
  4458         16  PB-AH-REFUND-TYPE            PIC X.
  4459         16  PB-ACCT-EFF-DT               PIC XX.
  4460         16  PB-ACCT-EXP-DT               PIC XX.
  4461         16  PB-COMPANY-ID                PIC X(3).
  4462         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4463         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4464         16  PB-SV-CARRIER                PIC X.
  4465         16  PB-SV-GROUPING               PIC X(6).
  4466         16  PB-SV-STATE                  PIC XX.
  4467         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4468         16  PB-GA-BILLING-INFO.
  4469             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4470                                          PIC XX.
  4471         16  PB-SV-REMIT-TO  REDEFINES
  4472             PB-GA-BILLING-INFO           PIC X(10).
  4473         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4474         16  PB-I-LOAN-OFFICER            PIC X(5).
  4475         16  PB-I-VIN                     PIC X(17).
  4476
  4477         16  FILLER                       PIC X(04).
  4478         16  IMNET-BYPASS-SW              PIC X.
  4479
  4480******************************************************************
  4481*                COMMON EDIT ERRORS                              *
  4482******************************************************************
  4483
  4484     12  PB-COMMON-ERRORS.
  4485         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4486                                           PIC S9(4)     COMP.
  4487
  4488******************************************************************
  4489
  4490* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4491*    COPY ELC50W1.
  4492******************************************************************
  4493*                                                                *
  4494*                                                                *
  4495*                             ELC50W1                            *
  4496*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4497*                            VMOD=2.004                          *
  4498*                                                                *
  4499*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4500*                                                                *
  4501*                                                                *
  4502******************************************************************
  4503
  4504     12  WK-WORK-AREA.
  4505         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4506         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4507         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4508         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4509         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4510         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  84
* EL050.cbl
  4511         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4512         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4513         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4514         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4515         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4516         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4517         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4518         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4519         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4520         16  WK-CREDIT-EDIT-CONTROLS.
  4521             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4522             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4523             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4524             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4525             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4526             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4527         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4528         16  WK-SAVE-REIN-DATA.
  4529             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4530             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4531             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4532         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4533             88  ENTRY-FROM-EL6311       VALUE '6'.
  4534         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4535         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4536     12  WK-RECORD-ADDRESSES.
  4537         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4538         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4539         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4540         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4541         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4542         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4543         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4544         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4545     12  WK-OVER-SHORT-AREA.
  4546         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4547         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4548         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4549             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4550         16  FILLER                   PIC X(5) VALUE SPACES.
  4551
  4552*    COPY ELCEDITC.
  4553******************************************************************
  4554*                                                                *
  4555*                                                                *
  4556*                            ELCEDITC                            *
  4557*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4558*                            VMOD=2.012                          *
  4559*                                                                *
  4560*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4561*                     EL6313, EL050 AND EL517.                   *
  4562*                                                                *
  4563******************************************************************
  4564******************************************************************
  4565*                   C H A N G E   L O G
  4566*
  4567* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4568*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  85
* EL050.cbl
  4569*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4570* EFFECTIVE    NUMBER
  4571*-----------------------------------------------------------------
  4572* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4573******************************************************************
  4574
  4575     12  EDIT-CRITERIA-DATA.
  4576         16  EC-CO-MONTH-END-DT       PIC XX.
  4577         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4578         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4579         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4580         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4581         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4582         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4583         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4584         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4585         16  EC-CO-REM-TERM-CALC      PIC X.
  4586               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4587               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4588               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4589               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4590
  4591         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4592               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4593               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4594               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4595               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4596               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4597               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4598               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4599               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4600               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4601               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4602
  4603         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4604               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4605               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4606               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4607               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4608               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4609               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4610               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4611               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4612
  4613         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4614                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4615                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4616
  4617         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4618                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4619                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4620                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4621                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4622                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4623                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4624                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4625                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4626
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  86
* EL050.cbl
  4627         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4628               88  EC-BR-REDUCING                   VALUE 'R'.
  4629               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4630
  4631         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4632         16  EC-BR-LF-DESC             PIC X(10).
  4633         16  EC-BR-AH-DESC             PIC X(10).
  4634         16  EC-BR-LF-COMMENT          PIC X(10).
  4635         16  EC-BR-AH-COMMENT          PIC X(10).
  4636
  4637         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4638               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4639               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4640               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4641               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4642
  4643         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4644               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4645               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4646               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4647               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4648
  4649         16  EC-BR-LF-REFUND-CALC      PIC X.
  4650                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4651                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4652                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4653                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4654                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4655                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4656                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4657
  4658         16  EC-BR-AH-REFUND-CALC      PIC X.
  4659                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4660                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4661                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4662                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4663                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4664                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4665                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4666                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4667
  4668         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4669                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4670                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4671                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4672
  4673         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4674                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4675                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4676                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4677
  4678         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4679         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4680         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4681         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4682
  4683         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4684         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  87
* EL050.cbl
  4685                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4686                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4687                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4688                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4689
  4690         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4691               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4692               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4693               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4694               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4695               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4696
  4697         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4698               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4699               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4700               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4701               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4702               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4703
  4704         16  EC-ST-LF-REFUND-CALC      PIC X.
  4705                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4706                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4707                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4708                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4709                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4710                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4711                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4712                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4713
  4714         16  EC-ST-AH-REFUND-CALC      PIC X.
  4715                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4716                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4717                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4718                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4719                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4720                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4721                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4722                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4723
  4724         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4725         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4726         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4727         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4728         16  EC-AM-EXPIRATION-DT       PIC XX.
  4729         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4730         16  EC-AM-CLASS-CD            PIC XX.
  4731         16  EC-AM-LF-DEVIATION        PIC XXX.
  4732         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4733         16  EC-AM-AH-DEVIATION        PIC XXX.
  4734         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4735         16  EC-AM-PHONE-NO            PIC X(10).
  4736
  4737         16  EC-AM-LF-REFUND-CALC      PIC X.
  4738                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4739                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4740                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4741                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4742                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  88
* EL050.cbl
  4743                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4744                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4745
  4746         16  EC-AM-AH-REFUND-CALC      PIC X.
  4747                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4748                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4749                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4750                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4751                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4752                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4753                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4754
  4755         16  EC-AM-BEN-I-G-CD          PIC X.
  4756                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4757                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4758                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4759
  4760         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4761         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4762         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4763         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4764         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4765         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4766         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4767         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4768         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4769
  4770         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4771         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4772         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4773         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4774         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4775         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4776         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4777         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4778         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4779         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4780         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4781         16  EC-RT-LF-NSP-ST           PIC XX.
  4782         16  EC-RT-AH-NSP-ST           PIC XX.
  4783         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4784         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4785
  4786         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4787             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4788                                             'M' '5' '9' '2'.
  4789             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4790             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4791             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4792             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4793             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4794             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4795             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4796             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4797             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4798             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4799
  4800         16  EC-CM-AH-PRIOR-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  89
* EL050.cbl
  4801             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4802                                             'M' '5' '9' '2'.
  4803             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4804             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4805             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4806             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4807             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4808             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4809             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4810             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4811             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4812             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4813
  4814         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4815         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4816         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4817         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4818         16  EC-CM-DEATH-DT            PIC XX.
  4819
  4820*DMD CUSTOM CODING FIELDS BELOW
  4821*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4822         16  EC-BR-DMD-RATING-SW       PIC X.
  4823                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4824                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4825                 88  NO-DMD-RATING               VALUE 'N'.
  4826
  4827         16  EC-NEW-CERT               PIC X(11).
  4828         16  EC-NEW-STATE              PIC XX.
  4829         16  FILLER                    PIC X.
  4830*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4831         16  OVER-SHORT-EDIT-FIELDS.
  4832             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4833             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4834             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4835             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4836             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4837             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4838             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4839             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4840             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4841         16  FILLER                    PIC X(71).
  4842******************************************************************
  4843
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  90
* EL050.cbl
  4845*    COPY ELCDIFRD.
  4846******************************************************************
  4847*                                                                *
  4848*                                                                *
  4849*                            ELCDIFRD.                           *
  4850*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4851*                            VMOD=2.004                          *
  4852*                                                                *
  4853*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4854*                                                                *
  4855******************************************************************
  4856*
  4857  01  WS-DIFFERENCE-CALCULATION.
  4858        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4859        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4860        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4861        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4862        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4863        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4864        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4865        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4866        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4867        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4868        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4869
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  91
* EL050.cbl
  4871****************************************************************
  4872*
  4873* Copyright (c) 2007 by Clerity Solutions, Inc.
  4874* All rights reserved.
  4875*
  4876****************************************************************
  4877 01  DFHEIV.
  4878   02  DFHEIV0               PIC X(35).
  4879   02  DFHEIV1               PIC X(08).
  4880   02  DFHEIV2               PIC X(08).
  4881   02  DFHEIV3               PIC X(08).
  4882   02  DFHEIV4               PIC X(06).
  4883   02  DFHEIV5               PIC X(04).
  4884   02  DFHEIV6               PIC X(04).
  4885   02  DFHEIV7               PIC X(02).
  4886   02  DFHEIV8               PIC X(02).
  4887   02  DFHEIV9               PIC X(01).
  4888   02  DFHEIV10              PIC S9(7) COMP-3.
  4889   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4890   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4891   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4892   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4893   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4894   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4895   02  DFHEIV17              PIC X(04).
  4896   02  DFHEIV18              PIC X(04).
  4897   02  DFHEIV19              PIC X(04).
  4898   02  DFHEIV20              USAGE IS POINTER.
  4899   02  DFHEIV21              USAGE IS POINTER.
  4900   02  DFHEIV22              USAGE IS POINTER.
  4901   02  DFHEIV23              USAGE IS POINTER.
  4902   02  DFHEIV24              USAGE IS POINTER.
  4903   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4904   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4905   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4906   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4907   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4908   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4909   02  FILLER                PIC X(02).
  4910   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4911   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4912   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4913   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4914   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4915 LINKAGE  SECTION.
  4916*****************************************************************
  4917*                                                               *
  4918* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4919* All rights reserved.                                          *
  4920*                                                               *
  4921*****************************************************************
  4922 01  dfheiblk.
  4923     02  eibtime          pic s9(7) comp-3.
  4924     02  eibdate          pic s9(7) comp-3.
  4925     02  eibtrnid         pic x(4).
  4926     02  eibtaskn         pic s9(7) comp-3.
  4927     02  eibtrmid         pic x(4).
  4928     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  92
* EL050.cbl
  4929     02  eibcposn         pic s9(4) comp.
  4930     02  eibcalen         pic s9(4) comp.
  4931     02  eibaid           pic x(1).
  4932     02  eibfiller1       pic x(1).
  4933     02  eibfn            pic x(2).
  4934     02  eibfiller2       pic x(2).
  4935     02  eibrcode         pic x(6).
  4936     02  eibfiller3       pic x(2).
  4937     02  eibds            pic x(8).
  4938     02  eibreqid         pic x(8).
  4939     02  eibrsrce         pic x(8).
  4940     02  eibsync          pic x(1).
  4941     02  eibfree          pic x(1).
  4942     02  eibrecv          pic x(1).
  4943     02  eibsend          pic x(1).
  4944     02  eibatt           pic x(1).
  4945     02  eibeoc           pic x(1).
  4946     02  eibfmh           pic x(1).
  4947     02  eibcompl         pic x(1).
  4948     02  eibsig           pic x(1).
  4949     02  eibconf          pic x(1).
  4950     02  eiberr           pic x(1).
  4951     02  eibrldbk         pic x(1).
  4952     02  eiberrcd         pic x(4).
  4953     02  eibsynrb         pic x(1).
  4954     02  eibnodat         pic x(1).
  4955     02  eibfiller5       pic x(2).
  4956     02  eibresp          pic 9(09) comp.
  4957     02  eibresp2         pic 9(09) comp.
  4958     02  dfheigdj         pic s9(4) comp.
  4959     02  dfheigdk         pic s9(4) comp.
  4960
  4961 01  DFHCOMMAREA                   PIC X(1036).
  4962
  4963*01 PARMLIST .
  4964*    02  FILLER                    PIC S9(8)   COMP.
  4965*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4966*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4967*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4968*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4969*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4970*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4971*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4972
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  93
* EL050.cbl
  4974*    COPY ELCCNTL.
  4975******************************************************************
  4976*                                                                *
  4977*                                                                *
  4978*                            ELCCNTL.                            *
  4979*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4980*                            VMOD=2.059                          *
  4981*                                                                *
  4982*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4983*                                                                *
  4984*   FILE TYPE = VSAM,KSDS                                        *
  4985*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4986*                                                                *
  4987*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4988*       ALTERNATE INDEX = NONE                                   *
  4989*                                                                *
  4990*   LOG = YES                                                    *
  4991*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4992******************************************************************
  4993*                   C H A N G E   L O G
  4994*
  4995* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4996*-----------------------------------------------------------------
  4997*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4998* EFFECTIVE    NUMBER
  4999*-----------------------------------------------------------------
  5000* 082503                   PEMA  ADD BENEFIT GROUP
  5001* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5002* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5003* 092705    2005050300006  PEMA  ADD SPP LEASES
  5004* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5005* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5006* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5007* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5008* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5009* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5010* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5011* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5012* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5013* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5014******************************************************************
  5015*
  5016 01  CONTROL-FILE.
  5017     12  CF-RECORD-ID                       PIC XX.
  5018         88  VALID-CF-ID                        VALUE 'CF'.
  5019
  5020     12  CF-CONTROL-PRIMARY.
  5021         16  CF-COMPANY-ID                  PIC XXX.
  5022         16  CF-RECORD-TYPE                 PIC X.
  5023             88  CF-COMPANY-MASTER              VALUE '1'.
  5024             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5025             88  CF-STATE-MASTER                VALUE '3'.
  5026             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5027             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5028             88  CF-CARRIER-MASTER              VALUE '6'.
  5029             88  CF-MORTALITY-MASTER            VALUE '7'.
  5030             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5031             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  94
* EL050.cbl
  5032             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5033             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5034             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5035             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5036             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5037             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5038             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5039             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5040             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5041         16  CF-ACCESS-CD-GENL              PIC X(4).
  5042         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5043             20  CF-PROCESSOR               PIC X(4).
  5044         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5045             20  CF-STATE-CODE              PIC XX.
  5046             20  FILLER                     PIC XX.
  5047         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5048             20  FILLER                     PIC XX.
  5049             20  CF-HI-BEN-IN-REC           PIC XX.
  5050         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5051             20  FILLER                     PIC XXX.
  5052             20  CF-CARRIER-CNTL            PIC X.
  5053         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5054             20  FILLER                     PIC XX.
  5055             20  CF-HI-TYPE-IN-REC          PIC 99.
  5056         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5057             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5058                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5059             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5060             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5061         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5062             20  FILLER                     PIC X.
  5063             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5064         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5065             20  FILLER                     PIC XX.
  5066             20  CF-MORTGAGE-PLAN           PIC XX.
  5067         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5068
  5069     12  CF-LAST-MAINT-DT                   PIC XX.
  5070     12  CF-LAST-MAINT-BY                   PIC X(4).
  5071     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5072
  5073     12  CF-RECORD-BODY                     PIC X(728).
  5074
  5075
  5076****************************************************************
  5077*             COMPANY MASTER RECORD                            *
  5078****************************************************************
  5079
  5080     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5081         16  CF-COMPANY-ADDRESS.
  5082             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5083             20  CF-CL-IN-CARE-OF           PIC X(30).
  5084             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5085             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5086             20  CF-CL-CITY-STATE           PIC X(30).
  5087             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5088             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5089         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  95
* EL050.cbl
  5090         16  CF-COMPANY-PASSWORD            PIC X(8).
  5091         16  CF-SECURITY-OPTION             PIC X.
  5092             88  ALL-SECURITY                   VALUE '1'.
  5093             88  COMPANY-VERIFY                 VALUE '2'.
  5094             88  PROCESSOR-VERIFY               VALUE '3'.
  5095             88  NO-SECURITY                    VALUE '4'.
  5096             88  ALL-BUT-TERM                   VALUE '5'.
  5097         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5098             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5099         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5100             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5101         16  CF-INFORCE-LOCATION            PIC X.
  5102             88  CERTS-ARE-ONLINE               VALUE '1'.
  5103             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5104             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5105         16  CF-LOWER-CASE-LETTERS          PIC X.
  5106         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5107             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5108             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5109             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5110             88  CF-ACCNT-CNTL                  VALUE '3'.
  5111             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5112
  5113         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5114         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5115
  5116         16  CF-LGX-CREDIT-USER             PIC X.
  5117             88  CO-IS-NOT-USER                 VALUE 'N'.
  5118             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5119
  5120         16 CF-CREDIT-CALC-CODES.
  5121             20  CF-CR-REM-TERM-CALC PIC X.
  5122               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5123               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5124               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5125               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5126               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5127               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5128               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5129             20  CF-CR-R78-METHOD           PIC X.
  5130               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5131               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5132
  5133         16  CF-CLAIM-CONTROL-COUNTS.
  5134             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5135                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5136
  5137             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5138                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5139
  5140             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5141                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5142
  5143             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5144                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5145
  5146         16  CF-CURRENT-MONTH-END           PIC XX.
  5147
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  96
* EL050.cbl
  5148         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5149             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5150             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5151             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5152             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5153                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5154                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5155             20  CF-CO-PREM-REJECT-SW       PIC X.
  5156                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5157                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5158             20  CF-CO-REF-REJECT-SW        PIC X.
  5159                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5160                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5161
  5162         16  CF-CO-REPORTING-DT             PIC XX.
  5163         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5164         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5165           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5166           88  CF-CO-MONTH-END                  VALUE '1'.
  5167
  5168         16  CF-LGX-CLAIM-USER              PIC X.
  5169             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5170             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5171
  5172         16  CF-CREDIT-EDIT-CONTROLS.
  5173             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5174             20  CF-MIN-AGE                 PIC 99.
  5175             20  CF-DEFAULT-AGE             PIC 99.
  5176             20  CF-MIN-TERM                PIC S999      COMP-3.
  5177             20  CF-MAX-TERM                PIC S999      COMP-3.
  5178             20  CF-DEFAULT-SEX             PIC X.
  5179             20  CF-JOINT-AGE-INPUT         PIC X.
  5180                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5181             20  CF-BIRTH-DATE-INPUT        PIC X.
  5182                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5183             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5184                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5185                 88  CF-ZERO-CARRIER            VALUE '1'.
  5186                 88  CF-ZERO-GROUPING           VALUE '2'.
  5187                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5188             20  CF-EDIT-SW                 PIC X.
  5189                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5190             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5191             20  CF-CR-PR-METHOD            PIC X.
  5192               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5193               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5194             20  FILLER                     PIC X.
  5195
  5196         16  CF-CREDIT-MISC-CONTROLS.
  5197             20  CF-REIN-TABLE-SW           PIC X.
  5198                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5199             20  CF-COMP-TABLE-SW           PIC X.
  5200                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5201             20  CF-EXPERIENCE-RETENTION-AGE
  5202                                            PIC S9        COMP-3.
  5203             20  CF-CONVERSION-DT           PIC XX.
  5204             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5205             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  97
* EL050.cbl
  5206                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5207                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5208
  5209             20  CF-CR-CHECK-NO-CONTROL.
  5210                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5211                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5212                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5213                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5214                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5215                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5216
  5217                 24  CF-CR-CHECK-COUNT       REDEFINES
  5218                     CF-CR-CHECK-COUNTER      PIC X(4).
  5219
  5220                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5221                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5222
  5223                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5224                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5225                 24  CF-MAIL-PROCESSING       PIC X.
  5226                     88  MAIL-PROCESSING          VALUE 'Y'.
  5227
  5228         16  CF-MISC-SYSTEM-CONTROL.
  5229             20  CF-SYSTEM-C                 PIC X.
  5230                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5231             20  CF-SYSTEM-D                 PIC X.
  5232                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5233             20  CF-SOC-SEC-NO-SW            PIC X.
  5234                 88  SOC-SEC-NO-USED             VALUE '1'.
  5235             20  CF-MEMBER-NO-SW             PIC X.
  5236                 88  MEMBER-NO-USED              VALUE '1'.
  5237             20  CF-TAX-ID-NUMBER            PIC X(11).
  5238             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5239             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5240                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5241                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5242                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5243                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5244             20  CF-SYSTEM-E                 PIC X.
  5245                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5246
  5247         16  CF-LGX-LIFE-USER               PIC X.
  5248             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5249             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5250
  5251         16  CF-CR-MONTH-END-DT             PIC XX.
  5252
  5253         16  CF-FILE-MAINT-DATES.
  5254             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5255                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5256             20  CF-LAST-BATCH       REDEFINES
  5257                 CF-LAST-BATCH-NO               PIC X(4).
  5258             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5259             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5260             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5261             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5262             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5263             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  98
* EL050.cbl
  5264             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5265             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5266             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5267             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5268
  5269         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5270         16  FILLER                         PIC X.
  5271
  5272         16  CF-ALT-MORT-CODE               PIC X(4).
  5273         16  CF-MEMBER-CAPTION              PIC X(10).
  5274
  5275         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5276             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5277             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5278             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5279             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5280             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5281
  5282         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5283
  5284         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5285         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5286         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5287         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5288
  5289         16  CF-AH-OVERRIDE-L1              PIC X.
  5290         16  CF-AH-OVERRIDE-L2              PIC XX.
  5291         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5292         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5293
  5294         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5295         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5296
  5297         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5298         16  CF-AR-LAST-EL860-DT            PIC XX.
  5299         16  CF-MP-MONTH-END-DT             PIC XX.
  5300
  5301         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5302         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5303             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5304
  5305         16  CF-AR-MONTH-END-DT             PIC XX.
  5306
  5307         16  CF-CRDTCRD-USER                PIC X.
  5308             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5309             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5310
  5311         16  CF-CC-MONTH-END-DT             PIC XX.
  5312
  5313         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5314
  5315         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5316             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5317             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5318             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5319         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5320         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5321         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page  99
* EL050.cbl
  5322         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5323             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5324             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5325         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5326         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5327         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5328             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5329         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5330
  5331         16  CF-CL-ZIP-CODE.
  5332             20  CF-CL-ZIP-PRIME.
  5333                 24  CF-CL-ZIP-1ST          PIC X.
  5334                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5335                 24  FILLER                 PIC X(4).
  5336             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5337         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5338             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5339             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5340             20  FILLER                     PIC XXX.
  5341
  5342         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5343         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5344         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5345         16  CF-CO-OPTION-START-DATE        PIC XX.
  5346         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5347           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5348                                                      '3' '4'.
  5349           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5350           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5351           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5352           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5353           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5354           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5355
  5356         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5357
  5358         16  CF-PAYMENT-APPROVAL-LEVELS.
  5359             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5360             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5361             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5362             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5363             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5364             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5365
  5366         16  CF-END-USER-REPORTING-USER     PIC X.
  5367             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5368             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5369
  5370         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5371             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5372             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5373
  5374         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5375
  5376         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5377         16  FILLER                         PIC X.
  5378
  5379         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 100
* EL050.cbl
  5380             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5381             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5382             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5383
  5384         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5385
  5386         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5387             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5388             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5389
  5390         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5391             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5392             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5393
  5394         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5395
  5396         16  CF-CO-ACH-ID-CODE              PIC  X.
  5397             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5398             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5399             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5400         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5401         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5402         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5403         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5404         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5405         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5406         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5407         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5408         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5409                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5410         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5411                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5412
  5413         16  CF-CO-OVER-SHORT.
  5414             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5415             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5416
  5417*         16  FILLER                         PIC X(102).
  5418         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5419             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5420             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5421
  5422         16  CF-AH-APPROVAL-DAYS.
  5423             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5424             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5425             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5426             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5427
  5428         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5429
  5430         16  CF-APPROV-LEV-5.
  5431             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5432             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5433             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5434
  5435         16  FILLER                         PIC X(68).
  5436****************************************************************
  5437*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 101
* EL050.cbl
  5438****************************************************************
  5439
  5440     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5441         16  CF-PROCESSOR-NAME              PIC X(30).
  5442         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5443         16  CF-PROCESSOR-TITLE             PIC X(26).
  5444         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5445                 88  MESSAGE-YES                VALUE 'Y'.
  5446                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5447
  5448*****************************************************
  5449****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5450****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5451****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5452****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5453*****************************************************
  5454
  5455         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5456             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5457             20  CF-APPLICATION-FORCE       PIC X.
  5458             20  CF-INDIVIDUAL-APP.
  5459                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5460                     28  CF-BROWSE-APP      PIC X.
  5461                     28  CF-UPDATE-APP      PIC X.
  5462
  5463         16  CF-CURRENT-TERM-ON             PIC X(4).
  5464         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5465             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5466             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5467             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5468             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5469             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5470             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5471             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5472         16  CF-PROCESSOR-CARRIER           PIC X.
  5473             88  NO-CARRIER-SECURITY            VALUE ' '.
  5474         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5475             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5476         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5477             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5478         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5479             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5480
  5481         16  CF-PROC-SYS-ACCESS-SW.
  5482             20  CF-PROC-CREDIT-CLAIMS-SW.
  5483                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5484                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5485                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5486                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5487             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5488                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5489                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5490             20  CF-PROC-LIFE-GNRLDGR-SW.
  5491                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5492                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5493                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5494                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5495             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 102
* EL050.cbl
  5496                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5497                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5498         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5499             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5500             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5501         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5502
  5503         16  CF-APPROVAL-LEVEL                  PIC X.
  5504             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5505             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5506             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5507             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5508             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5509
  5510         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5511
  5512         16  CF-LANGUAGE-TYPE                   PIC X.
  5513             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5514             88  CF-LANG-IS-FR                      VALUE 'F'.
  5515
  5516         16  CF-CSR-IND                         PIC X.
  5517         16  FILLER                             PIC X(239).
  5518
  5519****************************************************************
  5520*             PROCESSOR/REMINDERS RECORD                       *
  5521****************************************************************
  5522
  5523     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5524         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5525             20  CF-START-REMIND-DT         PIC XX.
  5526             20  CF-END-REMIND-DT           PIC XX.
  5527             20  CF-REMINDER-TEXT           PIC X(50).
  5528         16  FILLER                         PIC X(296).
  5529
  5530
  5531****************************************************************
  5532*             STATE MASTER RECORD                              *
  5533****************************************************************
  5534
  5535     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5536         16  CF-STATE-ABBREVIATION          PIC XX.
  5537         16  CF-STATE-NAME                  PIC X(25).
  5538         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5539         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5540             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5541             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5542             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5543             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5544                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5545                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5546             20  CF-ST-PREM-REJECT-SW       PIC X.
  5547                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5548                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5549             20  CF-ST-REF-REJECT-SW        PIC X.
  5550                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5551                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5552         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5553         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 103
* EL050.cbl
  5554         16  CF-ST-REFUND-RULES.
  5555             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5556             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5557             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5558         16  CF-ST-FST-PMT-EXTENSION.
  5559             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5560             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5561                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5562                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5563                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5564                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5565         16  CF-ST-STATE-CALL.
  5566             20  CF-ST-CALL-UNEARNED        PIC X.
  5567             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5568             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5569         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5570             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5571             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5572         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5573         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5574         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5575         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5576         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5577         16  FILLER                         PIC X.
  5578         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5579             20  CF-ST-BENEFIT-CD           PIC XX.
  5580             20  CF-ST-BENEFIT-KIND         PIC X.
  5581                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5582                 88  CF-ST-AH-KIND              VALUE 'A'.
  5583             20  CF-ST-REM-TERM-CALC        PIC X.
  5584                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5585                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5586                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5587                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5588                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5589                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5590                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5591                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5592
  5593             20  CF-ST-REFUND-CALC          PIC X.
  5594                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5595                 88  ST-REFD-BY-R78             VALUE '1'.
  5596                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5597                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5598                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5599                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5600                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5601                 88  ST-REFD-UTAH               VALUE '7'.
  5602                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5603                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5604                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5605
  5606             20  CF-ST-EARNING-CALC         PIC X.
  5607                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5608                 88  ST-EARN-BY-R78             VALUE '1'.
  5609                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5610                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5611                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 104
* EL050.cbl
  5612                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5613                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5614                 88  ST-EARN-MEAN               VALUE '8'.
  5615                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5616
  5617             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5618                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5619                 88  ST-OVRD-BY-R78             VALUE '1'.
  5620                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5621                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5622                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5623                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5624                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5625                 88  ST-OVRD-MEAN               VALUE '8'.
  5626                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5627             20  FILLER                     PIC X.
  5628
  5629         16  CF-ST-COMMISSION-CAPS.
  5630             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5631             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5632             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5633             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5634         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5635                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5636
  5637         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5638
  5639         16  CF-ST-STATUTORY-INTEREST.
  5640             20  CF-ST-STAT-DATE-FROM       PIC X.
  5641                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5642                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5643             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5644             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5645             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5646             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5647             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5648
  5649         16  CF-ST-OVER-SHORT.
  5650             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5651             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5652
  5653         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5654
  5655         16  CF-ST-RT-CALC                  PIC X.
  5656
  5657         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5658         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5659         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5660         16  CF-ST-RF-LR-CALC               PIC X.
  5661         16  CF-ST-RF-LL-CALC               PIC X.
  5662         16  CF-ST-RF-LN-CALC               PIC X.
  5663         16  CF-ST-RF-AH-CALC               PIC X.
  5664         16  CF-ST-RF-CP-CALC               PIC X.
  5665*        16  FILLER                         PIC X(206).
  5666*CIDMOD         16  FILLER                         PIC X(192).
  5667         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5668             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5669         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 105
* EL050.cbl
  5670         16  CF-ST-VFY-2ND-BENE             PIC X.
  5671         16  CF-ST-CAUSAL-STATE             PIC X.
  5672         16  FILLER                         PIC X(185).
  5673
  5674****************************************************************
  5675*             BENEFIT MASTER RECORD                            *
  5676****************************************************************
  5677
  5678     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5679         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5680             20  CF-BENEFIT-CODE            PIC XX.
  5681             20  CF-BENEFIT-NUMERIC  REDEFINES
  5682                 CF-BENEFIT-CODE            PIC XX.
  5683             20  CF-BENEFIT-ALPHA           PIC XXX.
  5684             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5685             20  CF-BENEFIT-COMMENT         PIC X(10).
  5686
  5687             20  CF-LF-COVERAGE-TYPE        PIC X.
  5688                 88  CF-REDUCING                VALUE 'R'.
  5689                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5690
  5691             20  CF-SPECIAL-CALC-CD         PIC X.
  5692                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5693                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5694                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5695                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5696                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5697                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5698                 88  CF-FARM-PLAN               VALUE 'F'.
  5699                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5700                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5701                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5702                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5703                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5704                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5705                 88  CF-PRUDENTIAL              VALUE 'P'.
  5706                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5707                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5708                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5709                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5710                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5711                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5712
  5713             20  CF-JOINT-INDICATOR         PIC X.
  5714                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5715
  5716*            20  FILLER                     PIC X(12).
  5717             20  cf-maximum-benefits        pic s999 comp-3.
  5718             20  FILLER                     PIC X(09).
  5719             20  CF-BENEFIT-CATEGORY        PIC X.
  5720             20  CF-LOAN-TYPE               PIC X(8).
  5721
  5722             20  CF-CO-REM-TERM-CALC        PIC X.
  5723                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5724                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5725                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5726                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5727                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 106
* EL050.cbl
  5728
  5729             20  CF-CO-EARNINGS-CALC        PIC X.
  5730                 88  CO-EARN-BY-R78             VALUE '1'.
  5731                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5732                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5733                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5734                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5735                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5736                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5737                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5738
  5739             20  CF-CO-REFUND-CALC          PIC X.
  5740                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5741                 88  CO-REFD-BY-R78             VALUE '1'.
  5742                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5743                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5744                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5745                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5746                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5747                 88  CO-REFD-MEAN               VALUE '8'.
  5748                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5749                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5750                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5751
  5752             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5753                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5754                 88  CO-OVRD-BY-R78             VALUE '1'.
  5755                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5756                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5757                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5758                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5759                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5760                 88  CO-OVRD-MEAN               VALUE '8'.
  5761                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5762
  5763             20  CF-CO-BEN-I-G-CD           PIC X.
  5764                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5765                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5766                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5767
  5768         16  FILLER                         PIC X(304).
  5769
  5770
  5771****************************************************************
  5772*             CARRIER MASTER RECORD                            *
  5773****************************************************************
  5774
  5775     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5776         16  CF-ADDRESS-DATA.
  5777             20  CF-MAIL-TO-NAME            PIC X(30).
  5778             20  CF-IN-CARE-OF              PIC X(30).
  5779             20  CF-ADDRESS-LINE-1          PIC X(30).
  5780             20  CF-ADDRESS-LINE-2          PIC X(30).
  5781             20  CF-CITY-STATE              PIC X(30).
  5782             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5783             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5784
  5785         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 107
* EL050.cbl
  5786             20  CF-CLAIM-NO-METHOD         PIC X.
  5787                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5788                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5789                 88  CLAIM-NO-SEQ               VALUE '3'.
  5790                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5791             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5792                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5793                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5794                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5795
  5796         16  CF-CHECK-NO-CONTROL.
  5797             20  CF-CHECK-NO-METHOD         PIC X.
  5798                 88  CHECK-NO-MANUAL            VALUE '1'.
  5799                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5800                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5801                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5802             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5803                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5804
  5805         16  CF-DOMICILE-STATE              PIC XX.
  5806
  5807         16  CF-EXPENSE-CONTROLS.
  5808             20  CF-EXPENSE-METHOD          PIC X.
  5809                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5810                 88  DOLLARS-PER-PMT            VALUE '2'.
  5811                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5812                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5813             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5814             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5815
  5816         16  CF-CORRESPONDENCE-CONTROL.
  5817             20  CF-LETTER-RESEND-OPT       PIC X.
  5818                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5819                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5820             20  FILLER                     PIC X(4).
  5821
  5822         16  CF-RESERVE-CONTROLS.
  5823             20  CF-MANUAL-SW               PIC X.
  5824                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5825             20  CF-FUTURE-SW               PIC X.
  5826                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5827             20  CF-PTC-SW                  PIC X.
  5828                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5829             20  CF-IBNR-SW                 PIC X.
  5830                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5831             20  CF-PTC-LF-SW               PIC X.
  5832                 88  CF-LF-PTC-USED             VALUE '1'.
  5833             20  CF-CDT-ACCESS-METHOD       PIC X.
  5834                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5835                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5836                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5837             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5838
  5839         16  CF-CLAIM-CALC-METHOD           PIC X.
  5840             88  360-PLUS-MONTHS                VALUE '1'.
  5841             88  365-PLUS-MONTHS                VALUE '2'.
  5842             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5843             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 108
* EL050.cbl
  5844             88  365-DAILY                      VALUE '5'.
  5845
  5846         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5847         16  FILLER                         PIC X(11).
  5848
  5849         16  CF-LIMIT-AMOUNTS.
  5850             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5851             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5852             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5853             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5854             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5855             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5856             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5857             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5858             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5859             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5860
  5861         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5862         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5863         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5864
  5865         16  CF-ZIP-CODE.
  5866             20  CF-ZIP-PRIME.
  5867                 24  CF-ZIP-1ST             PIC X.
  5868                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5869                 24  FILLER                 PIC X(4).
  5870             20  CF-ZIP-PLUS4               PIC X(4).
  5871         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5872             20  CF-CAN-POSTAL-1            PIC XXX.
  5873             20  CF-CAN-POSTAL-2            PIC XXX.
  5874             20  FILLER                     PIC XXX.
  5875
  5876         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5877         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5878         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5879
  5880         16  CF-RATING-SWITCH               PIC X.
  5881             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5882             88  CF-NO-RATING                   VALUE 'N'.
  5883
  5884         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5885
  5886         16  CF-CARRIER-OVER-SHORT.
  5887             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5888             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5889
  5890         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5891         16  CF-SECPAY-SWITCH               PIC X.
  5892             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5893             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5894         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5895         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5896         16  FILLER                         PIC X(444).
  5897*        16  FILLER                         PIC X(452).
  5898
  5899
  5900****************************************************************
  5901*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 109
* EL050.cbl
  5902****************************************************************
  5903
  5904     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5905         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5906                                INDEXED BY CF-MORT-NDX.
  5907             20  CF-MORT-TABLE              PIC X(5).
  5908             20  CF-MORT-TABLE-TYPE         PIC X.
  5909                 88  CF-MORT-JOINT              VALUE 'J'.
  5910                 88  CF-MORT-SINGLE             VALUE 'S'.
  5911                 88  CF-MORT-COMBINED           VALUE 'C'.
  5912                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5913                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5914             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5915             20  CF-MORT-AGE-METHOD         PIC XX.
  5916                 88  CF-AGE-LAST                VALUE 'AL'.
  5917                 88  CF-AGE-NEAR                VALUE 'AN'.
  5918             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5919             20  CF-MORT-ADJUSTMENT-DIRECTION
  5920                                            PIC X.
  5921                 88  CF-MINUS                   VALUE '-'.
  5922                 88  CF-PLUS                    VALUE '+'.
  5923             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5924             20  CF-MORT-JOINT-CODE         PIC X.
  5925                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5926             20  CF-MORT-PC-Q               PIC X.
  5927                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5928             20  CF-MORT-TABLE-CODE         PIC X(4).
  5929             20  CF-MORT-COMMENTS           PIC X(15).
  5930             20  FILLER                     PIC X(14).
  5931
  5932         16  FILLER                         PIC X(251).
  5933
  5934
  5935****************************************************************
  5936*             BUSSINESS TYPE MASTER RECORD                     *
  5937****************************************************************
  5938
  5939     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5940* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5941* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5942* AND RECORD 05 IS TYPES 81-99
  5943         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5944             20  CF-BUSINESS-TITLE          PIC  X(19).
  5945             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5946                                            PIC S9V9(4) COMP-3.
  5947             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5948             20  FILLER                     PIC  X.
  5949         16  FILLER                         PIC  X(248).
  5950
  5951
  5952****************************************************************
  5953*             TERMINAL MASTER RECORD                           *
  5954****************************************************************
  5955
  5956     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5957
  5958         16  CF-COMPANY-TERMINALS.
  5959             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 110
* EL050.cbl
  5960                                  PIC X(4).
  5961         16  FILLER               PIC X(248).
  5962
  5963
  5964****************************************************************
  5965*             LIFE EDIT MASTER RECORD                          *
  5966****************************************************************
  5967
  5968     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5969         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5970             20  CF-LIFE-CODE-IN            PIC XX.
  5971             20  CF-LIFE-CODE-OUT           PIC XX.
  5972         16  FILLER                         PIC X(248).
  5973
  5974
  5975****************************************************************
  5976*             AH EDIT MASTER RECORD                            *
  5977****************************************************************
  5978
  5979     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5980         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5981             20  CF-AH-CODE-IN              PIC XXX.
  5982             20  CF-AH-CODE-OUT             PIC XX.
  5983         16  FILLER                         PIC X(248).
  5984
  5985
  5986****************************************************************
  5987*             CREDIBILITY TABLES                               *
  5988****************************************************************
  5989
  5990     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5991         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5992                             INDEXED BY CF-CRDB-NDX.
  5993             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5994             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5995             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5996         16  FILLER                         PIC  X(332).
  5997
  5998
  5999****************************************************************
  6000*             REPORT CUSTOMIZATION RECORD                      *
  6001****************************************************************
  6002
  6003     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6004         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6005             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6006             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6007             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6008**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6009****       A T-TRANSFER.                                   ****
  6010             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6011
  6012         16  FILLER                         PIC XX.
  6013
  6014         16  CF-CARRIER-CNTL-OPT.
  6015             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6016                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6017                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 111
* EL050.cbl
  6018             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6019                                            PIC X.
  6020         16  CF-GROUP-CNTL-OPT.
  6021             20  CF-GROUP-OPT-SEQ           PIC 9.
  6022                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6023                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6024             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6025                                            PIC X(6).
  6026         16  CF-STATE-CNTL-OPT.
  6027             20  CF-STATE-OPT-SEQ           PIC 9.
  6028                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6029                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6030             20  CF-STATE-SELECT OCCURS 3 TIMES
  6031                                            PIC XX.
  6032         16  CF-ACCOUNT-CNTL-OPT.
  6033             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6034                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6035                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6036             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6037                                            PIC X(10).
  6038         16  CF-BUS-TYP-CNTL-OPT.
  6039             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6040                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6041                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6042             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6043                                            PIC XX.
  6044         16  CF-LF-TYP-CNTL-OPT.
  6045             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6046                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6047                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6048             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6049                                            PIC XX.
  6050         16  CF-AH-TYP-CNTL-OPT.
  6051             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6052                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6053                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6054             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6055                                            PIC XX.
  6056         16  CF-REPTCD1-CNTL-OPT.
  6057             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6058                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6059                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6060             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6061                                            PIC X(10).
  6062         16  CF-REPTCD2-CNTL-OPT.
  6063             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6064                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6065                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6066             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6067                                            PIC X(10).
  6068         16  CF-USER1-CNTL-OPT.
  6069             20  CF-USER1-OPT-SEQ           PIC 9.
  6070                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6071                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6072             20  CF-USER1-SELECT OCCURS 3 TIMES
  6073                                            PIC X(10).
  6074         16  CF-USER2-CNTL-OPT.
  6075             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 112
* EL050.cbl
  6076                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6077                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6078             20  CF-USER2-SELECT OCCURS 3 TIMES
  6079                                            PIC X(10).
  6080         16  CF-USER3-CNTL-OPT.
  6081             20  CF-USER3-OPT-SEQ           PIC 9.
  6082                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6083                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6084             20  CF-USER3-SELECT OCCURS 3 TIMES
  6085                                            PIC X(10).
  6086         16  CF-USER4-CNTL-OPT.
  6087             20  CF-USER4-OPT-SEQ           PIC 9.
  6088                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6089                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6090             20  CF-USER4-SELECT OCCURS 3 TIMES
  6091                                            PIC X(10).
  6092         16  CF-USER5-CNTL-OPT.
  6093             20  CF-USER5-OPT-SEQ           PIC 9.
  6094                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6095                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6096             20  CF-USER5-SELECT OCCURS 3 TIMES
  6097                                            PIC X(10).
  6098         16  CF-REINS-CNTL-OPT.
  6099             20  CF-REINS-OPT-SEQ           PIC 9.
  6100                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6101                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6102             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6103                 24  CF-REINS-PRIME         PIC XXX.
  6104                 24  CF-REINS-SUB           PIC XXX.
  6105
  6106         16  CF-AGENT-CNTL-OPT.
  6107             20  CF-AGENT-OPT-SEQ           PIC 9.
  6108                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6109                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6110             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6111                                            PIC X(10).
  6112
  6113         16  FILLER                         PIC X(43).
  6114
  6115         16  CF-LOSS-RATIO-SELECT.
  6116             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6117             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6118         16  CF-ENTRY-DATE-SELECT.
  6119             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6120             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6121         16  CF-EFFECTIVE-DATE-SELECT.
  6122             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6123             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6124
  6125         16  CF-EXCEPTION-LIST-IND          PIC X.
  6126             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6127
  6128         16  FILLER                         PIC X(318).
  6129
  6130****************************************************************
  6131*                  EXCEPTION REPORTING RECORD                  *
  6132****************************************************************
  6133
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 113
* EL050.cbl
  6134     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6135         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6136             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6137
  6138         16  CF-COMBINED-LIFE-AH-OPT.
  6139             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6140             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6141             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6142             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6143
  6144         16  CF-LIFE-OPT.
  6145             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6146             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6147             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6148             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6149             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6150             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6151             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6152             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6153             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6154             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6155
  6156         16  CF-AH-OPT.
  6157             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6158             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6159             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6160             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6161             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6162             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6163             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6164             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6165             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6166             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6167
  6168         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6169             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6170             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6171             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6172
  6173         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6174
  6175         16  FILLER                         PIC X(673).
  6176
  6177
  6178****************************************************************
  6179*             MORTGAGE SYSTEM PLAN RECORD                      *
  6180****************************************************************
  6181
  6182     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6183         16  CF-PLAN-TYPE                   PIC X.
  6184             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6185             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6186             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6187         16  CF-PLAN-ABBREV                 PIC XXX.
  6188         16  CF-PLAN-DESCRIPT               PIC X(10).
  6189         16  CF-PLAN-NOTES                  PIC X(20).
  6190         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6191         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 114
* EL050.cbl
  6192             20  CF-PLAN-TERM-DATA.
  6193                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6194                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6195             20  CF-PLAN-AGE-DATA.
  6196                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6197                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6198                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6199             20  CF-PLAN-BENEFIT-DATA.
  6200                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6201                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6202                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6203                                            PIC S9(7)V99  COMP-3.
  6204         16  CF-PLAN-POLICY-FORMS.
  6205             20  CF-POLICY-FORM             PIC X(12).
  6206             20  CF-MASTER-APPLICATION      PIC X(12).
  6207             20  CF-MASTER-POLICY           PIC X(12).
  6208         16  CF-PLAN-RATING.
  6209             20  CF-RATE-CODE               PIC X(5).
  6210             20  CF-SEX-RATING              PIC X.
  6211                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6212                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6213             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6214             20  CF-SUB-STD-TYPE            PIC X.
  6215                 88  CF-PCT-OF-PREM            VALUE '1'.
  6216                 88  CF-PCT-OF-BENE            VALUE '2'.
  6217         16  CF-PLAN-PREM-TOLERANCES.
  6218             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6219             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6220         16  CF-PLAN-PYMT-TOLERANCES.
  6221             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6222             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6223         16  CF-PLAN-MISC-DATA.
  6224             20  FILLER                     PIC X.
  6225             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6226             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6227         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6228         16  CF-PLAN-IND-GRP                PIC X.
  6229             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6230                                                     '1'.
  6231             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6232                                                     '2'.
  6233         16  CF-MIB-SEARCH-SW               PIC X.
  6234             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6235             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6236             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6237             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6238         16  CF-ALPHA-SEARCH-SW             PIC X.
  6239             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6240             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6241             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6242             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6243             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6244             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6245             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6246             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6247             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6248             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6249                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 115
* EL050.cbl
  6250                                                     'X' 'Y' 'Z'.
  6251         16  CF-EFF-DT-RULE-SW              PIC X.
  6252             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6253             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6254             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6255             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6256             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6257         16  FILLER                         PIC X(4).
  6258         16  CF-HEALTH-QUESTIONS            PIC X.
  6259             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6260         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6261         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6262         16  CF-PLAN-SNGL-JNT               PIC X.
  6263             88  CF-COMBINED-PLAN              VALUE 'C'.
  6264             88  CF-JNT-PLAN                   VALUE 'J'.
  6265             88  CF-SNGL-PLAN                  VALUE 'S'.
  6266         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6267         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6268         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6269         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6270         16  CF-RERATE-CNTL                 PIC  X.
  6271             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6272             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6273             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6274             88  CF-AUTO-RECALC                 VALUE '4'.
  6275         16  CF-BENEFIT-TYPE                PIC  X.
  6276             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6277             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6278         16  CF-POLICY-FEE                  PIC S999V99
  6279                                                    COMP-3.
  6280         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6281         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6282         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6283         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6284         16  FILLER                         PIC  X(32).
  6285         16  CF-TERMINATION-FORM            PIC  X(04).
  6286         16  FILLER                         PIC  X(08).
  6287         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6288                                                       COMP-3.
  6289         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6290         16  CF-ISSUE-LETTER                PIC  X(4).
  6291         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6292         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6293             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6294             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6295         16  CF-MP-REFUND-CALC              PIC X.
  6296             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6297             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6298             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6299             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6300             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6301             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6302             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6303             88  CF-MP-REFD-MEAN                VALUE '8'.
  6304         16  CF-ALT-RATE-CODE               PIC  X(5).
  6305
  6306
  6307         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 116
* EL050.cbl
  6308****************************************************************
  6309*             MORTGAGE COMPANY MASTER RECORD                   *
  6310****************************************************************
  6311
  6312     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6313         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6314         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6315             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6316             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6317             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6318             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6319             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6320
  6321         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6322         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6323         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6324         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6325         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6326
  6327         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6328             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6329         16  CF-MP-RECON-USE-IND            PIC X(1).
  6330             88  CF-MP-USE-RECON             VALUE 'Y'.
  6331         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6332             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6333         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6334             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6335             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6336         16  FILLER                         PIC X(1).
  6337         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6338             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6339         16  CF-MORTG-MIB-VERSION           PIC X.
  6340             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6341             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6342             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6343         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6344             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6345                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6346             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6347                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6348             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6349                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6350             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6351                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6352             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6353                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6354             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6355                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6356         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6357         16  FILLER                         PIC X(7).
  6358         16  CF-MORTG-DESTINATION-SYMBOL.
  6359             20  CF-MORTG-MIB-COMM          PIC X(5).
  6360             20  CF-MORTG-MIB-TERM          PIC X(5).
  6361         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6362             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6363         16  FILLER                         PIC X(03).
  6364         16  CF-MP-CHECK-NO-CONTROL.
  6365             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 117
* EL050.cbl
  6366                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6367                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6368                                                ' ' LOW-VALUES.
  6369                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6370                                               VALUE '3'.
  6371         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6372         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6373         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6374             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6375                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6376             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6377                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6378             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6379                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6380             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6381                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6382             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6383                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6384             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6385                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6386         16  CF-MORTG-BILLING-AREA.
  6387             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6388                                            PIC X.
  6389         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6390         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6391         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6392         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6393             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6394             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6395         16  FILLER                         PIC X.
  6396         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6397             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6398             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6399         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6400         16  FILLER                         PIC X(8).
  6401         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6402         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6403         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6404         16  CF-ACH-COMPANY-ID.
  6405             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6406                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6407                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6408                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6409             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6410         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6411             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6412         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6413             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6414             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6415         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6416         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6417         16  FILLER                         PIC X(536).
  6418
  6419****************************************************************
  6420*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6421****************************************************************
  6422
  6423     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 118
* EL050.cbl
  6424         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6425             20  CF-FEMALE-HEIGHT.
  6426                 24  CF-FEMALE-FT           PIC 99.
  6427                 24  CF-FEMALE-IN           PIC 99.
  6428             20  CF-FEMALE-MIN-WT           PIC 999.
  6429             20  CF-FEMALE-MAX-WT           PIC 999.
  6430         16  FILLER                         PIC X(428).
  6431
  6432     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6433         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6434             20  CF-MALE-HEIGHT.
  6435                 24  CF-MALE-FT             PIC 99.
  6436                 24  CF-MALE-IN             PIC 99.
  6437             20  CF-MALE-MIN-WT             PIC 999.
  6438             20  CF-MALE-MAX-WT             PIC 999.
  6439         16  FILLER                         PIC X(428).
  6440******************************************************************
  6441*             AUTOMATIC ACTIVITY RECORD                          *
  6442******************************************************************
  6443     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6444         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6445             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6446             20  CF-SYS-LETTER-ID           PIC X(04).
  6447             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6448             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6449             20  CF-SYS-RESET-SW            PIC X(01).
  6450             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6451             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6452
  6453         16  FILLER                         PIC X(50).
  6454
  6455         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6456             20  CF-USER-ACTIVE-SW          PIC X(01).
  6457             20  CF-USER-LETTER-ID          PIC X(04).
  6458             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6459             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6460             20  CF-USER-RESET-SW           PIC X(01).
  6461             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6462             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6463             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6464
  6465         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 119
* EL050.cbl
  6467*    COPY ERCACCT.
  6468******************************************************************
  6469*                                                                *
  6470*                                                                *
  6471*                            ERCACCT                             *
  6472*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6473*                            VMOD=2.031                          *
  6474*                                                                *
  6475*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6476*                                                                *
  6477*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6478*   VSAM ACCOUNT MASTER FILES.                                   *
  6479*                                                                *
  6480*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6481*                                                                *
  6482*   FILE TYPE = VSAM,KSDS                                        *
  6483*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6484*                                                                *
  6485*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6486*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6487*                                                                *
  6488*   LOG = NO                                                     *
  6489*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6490*                                                                *
  6491*                                                                *
  6492******************************************************************
  6493*                   C H A N G E   L O G
  6494*
  6495* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6496*-----------------------------------------------------------------
  6497*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6498* EFFECTIVE    NUMBER
  6499*-----------------------------------------------------------------
  6500* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6501* 092705    2005050300006  PEMA  ADD SPP LEASES
  6502* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6503* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6504* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6505* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6506* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6507******************************************************************
  6508
  6509 01  ACCOUNT-MASTER.
  6510     12  AM-RECORD-ID                      PIC XX.
  6511         88  VALID-AM-ID                      VALUE 'AM'.
  6512
  6513     12  AM-CONTROL-PRIMARY.
  6514         16  AM-COMPANY-CD                 PIC X.
  6515         16  AM-MSTR-CNTRL.
  6516             20  AM-CONTROL-A.
  6517                 24  AM-CARRIER            PIC X.
  6518                 24  AM-GROUPING.
  6519                     28 AM-GROUPING-PREFIX PIC XXX.
  6520                     28 AM-GROUPING-PRIME  PIC XXX.
  6521                 24  AM-STATE              PIC XX.
  6522                 24  AM-ACCOUNT.
  6523                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6524                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 120
* EL050.cbl
  6525             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6526                                           PIC X(19).
  6527             20  AM-CNTRL-B.
  6528                 24  AM-EXPIRATION-DT      PIC XX.
  6529                 24  FILLER                PIC X(4).
  6530             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6531                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6532
  6533     12  AM-CONTROL-BY-VAR-GRP.
  6534         16  AM-COMPANY-CD-A1              PIC X.
  6535         16  AM-VG-CARRIER                 PIC X.
  6536         16  AM-VG-GROUPING                PIC X(6).
  6537         16  AM-VG-STATE                   PIC XX.
  6538         16  AM-VG-ACCOUNT                 PIC X(10).
  6539         16  AM-VG-DATE.
  6540             20  AM-VG-EXPIRATION-DT       PIC XX.
  6541             20  FILLER                    PIC X(4).
  6542         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6543                                           PIC 9(11)      COMP-3.
  6544     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6545         16  FILLER                        PIC X(10).
  6546         16  AM-VG-KEY3.
  6547             20  AM-VG3-ACCOUNT            PIC X(10).
  6548             20  AM-VG3-EXP-DT             PIC XX.
  6549         16  FILLER                        PIC X(4).
  6550     12  AM-MAINT-INFORMATION.
  6551         16  AM-LAST-MAINT-DT              PIC XX.
  6552         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6553         16  AM-LAST-MAINT-USER            PIC X(4).
  6554         16  FILLER                        PIC XX.
  6555
  6556     12  AM-EFFECTIVE-DT                   PIC XX.
  6557     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6558
  6559     12  AM-PREV-DATES  COMP-3.
  6560         16  AM-PREV-EXP-DT                PIC 9(11).
  6561         16  AM-PREV-EFF-DT                PIC 9(11).
  6562
  6563     12  AM-REPORT-CODE-1                  PIC X(10).
  6564     12  AM-REPORT-CODE-2                  PIC X(10).
  6565
  6566     12  AM-CITY-CODE                      PIC X(4).
  6567     12  AM-COUNTY-PARISH                  PIC X(6).
  6568
  6569     12  AM-NAME                           PIC X(30).
  6570     12  AM-PERSON                         PIC X(30).
  6571     12  AM-ADDRS                          PIC X(30).
  6572     12  AM-CITY.
  6573         16  AM-ADDR-CITY                  PIC X(28).
  6574         16  AM-ADDR-STATE                 PIC XX.
  6575     12  AM-ZIP.
  6576         16  AM-ZIP-PRIME.
  6577             20  AM-ZIP-PRI-1ST            PIC X.
  6578                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6579             20  FILLER                    PIC X(4).
  6580         16  AM-ZIP-PLUS4                  PIC X(4).
  6581     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6582         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 121
* EL050.cbl
  6583         16  AM-CAN-POSTAL-2               PIC XXX.
  6584         16  FILLER                        PIC XXX.
  6585     12  AM-TEL-NO.
  6586         16  AM-AREA-CODE                  PIC 999.
  6587         16  AM-TEL-PRE                    PIC 999.
  6588         16  AM-TEL-NBR                    PIC 9(4).
  6589     12  AM-TEL-LOC                        PIC X.
  6590         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6591         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6592
  6593     12  AM-COMM-STRUCTURE.
  6594         16  AM-DEFN-1.
  6595             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6596                 24  AM-AGT.
  6597                     28  AM-AGT-PREFIX     PIC X(4).
  6598                     28  AM-AGT-PRIME      PIC X(6).
  6599                 24  AM-COM-TYP            PIC X.
  6600                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6601                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6602                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6603                 24  AM-RECALC-LV-INDIC    PIC X.
  6604                 24  AM-RETRO-LV-INDIC     PIC X.
  6605                 24  AM-GL-CODES           PIC X.
  6606                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6607                 24  FILLER                PIC X(01).
  6608         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6609             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6610                 24  FILLER                PIC X(11).
  6611                 24  AM-L-COMA             PIC XXX.
  6612                 24  AM-J-COMA             PIC XXX.
  6613                 24  AM-A-COMA             PIC XXX.
  6614                 24  FILLER                PIC X(6).
  6615
  6616     12  AM-COMM-CHANGE-STATUS             PIC X.
  6617         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6618
  6619     12  AM-CSR-CODE                       PIC X(4).
  6620
  6621     12  AM-BILLING-STATUS                 PIC X.
  6622         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6623         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6624     12  AM-AUTO-REFUND-SW                 PIC X.
  6625         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6626         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6627     12  AM-GPCD                           PIC 99.
  6628     12  AM-IG                             PIC X.
  6629         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6630         88  AM-HAS-GROUP                     VALUE '2'.
  6631     12  AM-STATUS                         PIC X.
  6632         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6633         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6634         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6635         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6636         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6637         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6638     12  AM-REMIT-TO                       PIC 99.
  6639     12  AM-ID-NO                          PIC X(11).
  6640
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 122
* EL050.cbl
  6641     12  AM-CAL-TABLE                      PIC XX.
  6642     12  AM-LF-DEVIATION                   PIC XXX.
  6643     12  AM-AH-DEVIATION                   PIC XXX.
  6644     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6645     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6646     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6647     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6648     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6649     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6650
  6651     12  AM-USER-FIELDS.
  6652         16  AM-FLD-1                      PIC XX.
  6653         16  AM-FLD-2                      PIC XX.
  6654         16  AM-FLD-3                      PIC XX.
  6655         16  AM-FLD-4                      PIC XX.
  6656         16  AM-FLD-5                      PIC XX.
  6657
  6658     12  AM-1ST-PROD-DATE.
  6659         16  AM-1ST-PROD-YR                PIC XX.
  6660         16  AM-1ST-PROD-MO                PIC XX.
  6661         16  AM-1ST-PROD-DA                PIC XX.
  6662     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6663     12  AM-CERTS-PURGED-DATE.
  6664         16  AM-PUR-YR                     PIC XX.
  6665         16  AM-PUR-MO                     PIC XX.
  6666         16  AM-PUR-DA                     PIC XX.
  6667     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6668     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6669     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6670     12  AM-INACTIVE-DATE.
  6671         16  AM-INA-MO                     PIC 99.
  6672         16  AM-INA-DA                     PIC 99.
  6673         16  AM-INA-YR                     PIC 99.
  6674     12  AM-AR-HI-CERT-DATE                PIC XX.
  6675
  6676     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6677     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6678
  6679     12  AM-OB-PAYMENT-MODE                PIC X.
  6680         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6681         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6682         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6683         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6684
  6685     12  AM-AH-ONLY-INDICATOR              PIC X.
  6686         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6687         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6688
  6689     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6690
  6691     12  AM-OVER-SHORT.
  6692         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6693         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6694
  6695     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6696     12  AM-DCC-CLP-STATE                  PIC XX.
  6697
  6698     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 123
* EL050.cbl
  6699     12  AM-RECALC-REIN                    PIC X.
  6700
  6701     12  AM-REI-TABLE                      PIC XXX.
  6702     12  AM-REI-ET-LF                      PIC X.
  6703     12  AM-REI-ET-AH                      PIC X.
  6704     12  AM-REI-PE-LF                      PIC X.
  6705     12  AM-REI-PE-AH                      PIC X.
  6706     12  AM-REI-PRT-ST                     PIC X.
  6707     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6708     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6709     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6710     12  AM-REI-GROUP-A                    PIC X(6).
  6711     12  AM-REI-MORT                       PIC X(4).
  6712     12  AM-REI-PRT-OW                     PIC X.
  6713     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6714     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6715     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6716     12  AM-REI-GROUP-B                    PIC X(6).
  6717
  6718     12  AM-TRUST-TYPE                     PIC X(2).
  6719
  6720     12  AM-EMPLOYER-STMT-USED             PIC X.
  6721     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6722
  6723     12  AM-STD-AH-TYPE                    PIC XX.
  6724     12  AM-EARN-METHODS.
  6725         16  AM-EARN-METHOD-R              PIC X.
  6726             88 AM-REF-RL-R78                 VALUE 'R'.
  6727             88 AM-REF-RL-PR                  VALUE 'P'.
  6728             88 AM-REF-RL-MEAN                VALUE 'M'.
  6729             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6730         16  AM-EARN-METHOD-L              PIC X.
  6731             88 AM-REF-LL-R78                 VALUE 'R'.
  6732             88 AM-REF-LL-PR                  VALUE 'P'.
  6733             88 AM-REF-LL-MEAN                VALUE 'M'.
  6734             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6735         16  AM-EARN-METHOD-A              PIC X.
  6736             88 AM-REF-AH-R78                 VALUE 'R'.
  6737             88 AM-REF-AH-PR                  VALUE 'P'.
  6738             88 AM-REF-AH-MEAN                VALUE 'M'.
  6739             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6740             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6741             88 AM-REF-AH-NET                 VALUE 'N'.
  6742
  6743     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6744     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6745     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6746
  6747     12  AM-RET-Y-N                        PIC X.
  6748     12  AM-RET-P-E                        PIC X.
  6749     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6750     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6751     12  AM-RET-GRP                        PIC X(6).
  6752     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6753         16  AM-POOL-PRIME                 PIC XXX.
  6754         16  AM-POOL-SUB                   PIC XXX.
  6755     12  AM-RETRO-EARNINGS.
  6756         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 124
* EL050.cbl
  6757         16  AM-RET-EARN-L                 PIC X.
  6758         16  AM-RET-EARN-A                 PIC X.
  6759     12  AM-RET-ST-TAX-USE                 PIC X.
  6760         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6761         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6762     12  AM-RETRO-BEG-EARNINGS.
  6763         16  AM-RET-BEG-EARN-R             PIC X.
  6764         16  AM-RET-BEG-EARN-L             PIC X.
  6765         16  AM-RET-BEG-EARN-A             PIC X.
  6766     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6767     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6768
  6769     12  AM-USER-SELECT-OPTIONS.
  6770         16  AM-USER-SELECT-1              PIC X(10).
  6771         16  AM-USER-SELECT-2              PIC X(10).
  6772         16  AM-USER-SELECT-3              PIC X(10).
  6773         16  AM-USER-SELECT-4              PIC X(10).
  6774         16  AM-USER-SELECT-5              PIC X(10).
  6775
  6776     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6777
  6778     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6779
  6780     12  AM-RPT045A-SWITCH                 PIC X.
  6781         88  RPT045A-OFF                   VALUE 'N'.
  6782
  6783     12  AM-INSURANCE-LIMITS.
  6784         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6785         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6786
  6787     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6788         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6789
  6790     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6791         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6792         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6793
  6794     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6795
  6796     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6797     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6798     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6799     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6800     12  AM-DCC-UEF-STATE                  PIC XX.
  6801     12  FILLER                            PIC XXX.
  6802     12  AM-REPORT-CODE-3                  PIC X(10).
  6803*    12  FILLER                            PIC X(22).
  6804
  6805     12  AM-RESERVE-DATE.
  6806         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6807         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6808         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6809
  6810     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6811     12  AM-NOTIFICATION-TYPES.
  6812         16  AM-NOTIF-OF-LETTERS           PIC X.
  6813         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6814         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 125
* EL050.cbl
  6815         16  AM-NOTIF-OF-STATUS            PIC X.
  6816
  6817     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6818         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6819         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6820         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6821         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6822
  6823     12  AM-BENEFIT-CONTROLS.
  6824         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6825             20  AM-BENEFIT-CODE           PIC XX.
  6826             20  AM-BENEFIT-TYPE           PIC X.
  6827             20  AM-BENEFIT-REVISION       PIC XXX.
  6828             20  AM-BENEFIT-REM-TERM       PIC X.
  6829             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6830             20  FILLER                    PIC XX.
  6831         16  FILLER                        PIC X(80).
  6832
  6833     12  AM-TRANSFER-DATA.
  6834         16  AM-TRANSFERRED-FROM.
  6835             20  AM-TRNFROM-CARRIER        PIC X.
  6836             20  AM-TRNFROM-GROUPING.
  6837                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6838                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6839             20  AM-TRNFROM-STATE          PIC XX.
  6840             20  AM-TRNFROM-ACCOUNT.
  6841                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6842                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6843             20  AM-TRNFROM-DTE            PIC XX.
  6844         16  AM-TRANSFERRED-TO.
  6845             20  AM-TRNTO-CARRIER          PIC X.
  6846             20  AM-TRNTO-GROUPING.
  6847                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6848                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6849             20  AM-TRNTO-STATE            PIC XX.
  6850             20  AM-TRNTO-ACCOUNT.
  6851                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6852                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6853             20  AM-TRNTO-DTE              PIC XX.
  6854         16  FILLER                        PIC X(10).
  6855
  6856     12  AM-SAVED-REMIT-TO                 PIC 99.
  6857
  6858     12  AM-COMM-STRUCTURE-SAVED.
  6859         16  AM-DEFN-1-SAVED.
  6860             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6861                 24  AM-AGT-SV             PIC X(10).
  6862                 24  AM-COM-TYP-SV         PIC X.
  6863                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6864                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6865                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6866                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6867                 24  FILLER                PIC X.
  6868                 24  AM-GL-CODES-SV        PIC X.
  6869                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6870                 24  FILLER                PIC X.
  6871         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6872             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 126
* EL050.cbl
  6873                 24  FILLER                PIC X(11).
  6874                 24  AM-L-COMA-SV          PIC XXX.
  6875                 24  AM-J-COMA-SV          PIC XXX.
  6876                 24  AM-A-COMA-SV          PIC XXX.
  6877                 24  FILLER                PIC X(6).
  6878
  6879     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6880         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6881            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6882            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6883            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6884
  6885     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6886     12  FILLER                            PIC X(120).
  6887
  6888     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6889         16  AM-CONTROL-NAME               PIC X(30).
  6890         16  AM-EXECUTIVE-ONE.
  6891             20  AM-EXEC1-NAME             PIC X(15).
  6892             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6893                                                          COMP-3.
  6894             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6895                                                          COMP-3.
  6896         16  AM-EXECUTIVE-TWO.
  6897             20  AM-EXEC2-NAME             PIC X(15).
  6898             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6899                                                          COMP-3.
  6900             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6901                                                          COMP-3.
  6902
  6903     12  AM-RETRO-ADDITIONAL-DATA.
  6904         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6905         16  AM-RETRO-PREM-P-E             PIC X.
  6906         16  AM-RETRO-CLMS-P-I             PIC X.
  6907         16  AM-RETRO-RET-BRACKET-LF.
  6908             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6909                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6910                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6911             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6912                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6913                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6914             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6915                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6916                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6917         16  AM-RETRO-RET-BRACKET-AH.
  6918             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6919                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6920                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6921                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6922             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6923                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6924                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6925             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6926                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6927                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6928
  6929     12  AM-COMMENTS.
  6930         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 127
* EL050.cbl
  6931
  6932     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6933         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6934         16  AM-FLI-BILLING-CODE           PIC X.
  6935         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6936         16  AM-FLI-UNITED-IDENT           PIC X.
  6937         16  AM-FLI-INTEREST-LOST-DATA.
  6938             20  AM-FLI-BANK-NO            PIC X(5).
  6939             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6940             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6941             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6942         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6943             20  AM-FLI-AGT                PIC X(9).
  6944             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6945             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6946         16  FILLER                        PIC X(102).
  6947
  6948     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6949         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6950             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6951             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6952             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6953             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6954             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6955         16  FILLER                          PIC X(10).
  6956******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 128
* EL050.cbl
  6958*    COPY ERCREIN.
  6959******************************************************************
  6960*                                                                *
  6961*                            ERCREIN                             *
  6962*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6963*                            VMOD=2.010                          *
  6964*                                                                *
  6965*   ONLINE CREDIT SYSTEM                                         *
  6966*                                                                *
  6967*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6968*                                                                *
  6969*   FILE TYPE = VSAM,KSDS                                        *
  6970*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6971*                                                                *
  6972*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6973*       ALTERNATE PATH = NONE                                    *
  6974*                                                                *
  6975*   LOG = NO                                                     *
  6976*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6977*                                                                *
  6978******************************************************************
  6979*                   C H A N G E   L O G
  6980*
  6981* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6982*-----------------------------------------------------------------
  6983*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6984* EFFECTIVE    NUMBER
  6985*-----------------------------------------------------------------
  6986* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6987* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6988******************************************************************
  6989 01  REINSURANCE-RECORD.
  6990     12  RE-RECORD-ID                      PIC XX.
  6991         88  VALID-RE-ID                      VALUE 'RE'.
  6992
  6993     12  RE-CONTROL-PRIMARY.
  6994         16  RE-COMPANY-CD                 PIC X.
  6995         16  RE-KEY.
  6996             20  RE-CODE                   PIC X.
  6997                 88  RE-TABLE-RECORD          VALUE 'A'.
  6998                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6999             20  RE-TABLE                  PIC XXX.
  7000             20  FILLER                    PIC XXX.
  7001         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7002             20  FILLER                    PIC X.
  7003             20  RE-COMPANY.
  7004                 24  RE-COMP-PRIME         PIC XXX.
  7005                 24  RE-COMP-SUB           PIC XXX.
  7006
  7007     12  RE-MAINT-INFORMATION.
  7008         16  RE-LAST-MAINT-DT              PIC XX.
  7009         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7010         16  RE-LAST-MAINT-USER            PIC X(4).
  7011         16  FILLER                        PIC X(10).
  7012
  7013     12  RE-TABLE-DATA.
  7014         16  RE-100-COMP                   PIC 99.
  7015
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 129
* EL050.cbl
  7016         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7017             20  RE-REI-COMP-NO.
  7018                 24  RE-REI-COMP           PIC XXX.
  7019                 24  RE-REI-COMP-SUB       PIC XXX.
  7020             20  RE-LF-QC                  PIC X.
  7021             20  RE-AH-QC                  PIC X.
  7022             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7023             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7024             20  RE-LFAGE-LO               PIC 99.
  7025             20  RE-LFAGE-HI               PIC 99.
  7026             20  RE-AHAGE-LO               PIC 99.
  7027             20  RE-AHAGE-HI               PIC 99.
  7028             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7029             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7030             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7031             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7032             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7033             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7034             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7035             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7036             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7037             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7038             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7039             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7040             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7041             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7042             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7043             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7044             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7045             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7046             20  RE-LF-BEN-CODE            PIC X.
  7047             20  RE-AH-BEN-CODE            PIC X.
  7048             20  RE-INTERACTIVE            PIC X.
  7049             20  RE-REMAINING              PIC X.
  7050             20  RE-LF-RUNOFF-SW           PIC X.
  7051             20  RE-AH-RUNOFF-SW           PIC X.
  7052             20  FILLER                    PIC X(19).
  7053
  7054         16  RE-COMP-INFO-END              PIC X(6).
  7055         16  RE-NSP-ST-CD-LF               PIC XX.
  7056         16  RE-NSP-ST-CD-AH               PIC XX.
  7057         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7058             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7059
  7060         16  FILLER                        PIC X(27).
  7061
  7062     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7063         16  RE-NAME                       PIC X(30).
  7064         16  RE-LF-PE                      PIC X.
  7065         16  RE-AH-PE                      PIC X.
  7066         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7067         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7068         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7069         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7070         16  RE-PRT-ST                     PIC X.
  7071         16  RE-PRT-OW                     PIC X.
  7072         16  RE-MORT-CODE                  PIC X(4).
  7073         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 130
* EL050.cbl
  7074         16  RE-ZERO-LF-FEE                PIC X.
  7075         16  RE-ZERO-AH-FEE                PIC X.
  7076         16  RE-CEDE-NAME                  PIC X(30).
  7077         16  RE-LF-COMM                    PIC X.
  7078         16  RE-AH-COMM                    PIC X.
  7079         16  RE-LF-TAX                     PIC X.
  7080         16  RE-AH-TAX                     PIC X.
  7081         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7082         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7083         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7084
  7085         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7086             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7087
  7088         16  RE-LF-CEDING-FEE-BRACKETS.
  7089             20  RE-LF-FEE-METHOD          PIC X.
  7090                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7091                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7092                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7093                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7094             20  RE-LF-FEE-BASIS           PIC X.
  7095                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7096                 88  RE-LF-NET-CEDED               VALUE '2'.
  7097                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7098                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7099                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7100                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7101                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7102                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7103             20  FILLER                    PIC XXX.
  7104             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7105                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7106                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7107
  7108         16  RE-AH-CEDING-FEE-BRACKETS.
  7109             20  RE-AH-FEE-METHOD          PIC X.
  7110                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7111                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7112                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7113                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7114             20  RE-AH-FEE-BASIS           PIC X.
  7115                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7116                 88  RE-AH-NET-CEDED               VALUE '2'.
  7117                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7118                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7119                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7120                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7121                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7122                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7123             20  FILLER                    PIC XXX.
  7124             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7125                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7126                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7127
  7128         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7129
  7130         16  RE-OLD-CEDING-STMT            PIC X.
  7131
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 131
* EL050.cbl
  7132         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7133         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7134         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7135         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7136         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7137         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7138         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7139         16  RE-MORT-SW                    PIC X.
  7140         16  RE-CEDING-TYPE-FLAG           PIC X.
  7141             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7142             88  RE-CEDED                          VALUE 'C'.
  7143             88  RE-ASSUMED                        VALUE 'A'.
  7144             88  RE-PHANTOM                        VALUE 'P'.
  7145
  7146         16  RE-CEDING-STMT-OPT-A          PIC X.
  7147             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7148         16  RE-CEDING-STMT-OPT-B          PIC X.
  7149             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7150         16  RE-CEDING-STMT-OPT-C          PIC X.
  7151             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7152         16  RE-CEDING-STMT-OPT-D          PIC X.
  7153             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7154         16  RE-CEDING-STMT-OPT-E          PIC X.
  7155             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7156
  7157         16  RE-PRT-CRSV                   PIC X.
  7158
  7159         16  RE-GL-CENTER                  PIC X(4).
  7160
  7161         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7162
  7163         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7164
  7165         16  RE-EARN-STOP-CODE             PIC X.
  7166             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7167             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7168
  7169         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7170             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7171
  7172         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7173         16  FILLER                        PIC X(2281).
  7174
  7175         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7176
  7177******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 132
* EL050.cbl
  7179*    COPY ERCCTBL.
  7180******************************************************************
  7181*                                                                *
  7182*                                                                *
  7183*                            ERCCTBL                             *
  7184*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7185*                            VMOD=2.003
  7186*                                                                *
  7187*   ONLINE CREDIT SYSTEM                                         *
  7188*                                                                *
  7189*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7190*                                                                *
  7191*   FILE TYPE = VSAM,KSDS                                        *
  7192*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7193*                                                                *
  7194*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7195*       ALTERNATE PATH = NONE                                    *
  7196*                                                                *
  7197*   LOG = NO                                                     *
  7198*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7199*                                                                *
  7200*                                                                *
  7201******************************************************************
  7202
  7203 01  COMM-TABLE-RECORD.
  7204     12  CT-RECORD-ID                      PIC XX.
  7205         88  VALID-CT-ID                      VALUE 'CT'.
  7206
  7207     12  CT-CONTROL-PRIMARY.
  7208         16  CT-COMPANY-CD                 PIC X.
  7209         16  CT-TABLE                      PIC XXX.
  7210         16  CT-CNTRL-2.
  7211             20  CT-BEN-TYPE               PIC X.
  7212             20  CT-BEN-CODE               PIC XX.
  7213
  7214     12  CT-MAINT-INFORMATION.
  7215         16  CT-LAST-MAINT-DT              PIC XX.
  7216         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7217         16  CT-LAST-MAINT-USER            PIC X(4).
  7218         16  FILLER                        PIC X(31).
  7219
  7220     12  CT-LIMITS.
  7221         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7222
  7223         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7224
  7225         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7226
  7227     12  CT-RATES.
  7228         16  CT-RTX          OCCURS 27 TIMES.
  7229             20  CT-RT                     PIC SV9(5)     COMP-3.
  7230             20  CT-RT-R   REDEFINES
  7231                 CT-RT                     PIC XXX.
  7232
  7233     12  FILLER                            PIC  X(42).
  7234
  7235******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 133
* EL050.cbl
  7237*    COPY ERCFORM.
  7238******************************************************************
  7239*                                                                *
  7240*                                                                *
  7241*                            ERCFORM.                            *
  7242*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7243*                            VMOD=2.003                          *
  7244*                                                                *
  7245*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7246*                                                                *
  7247*    FILE TYPE = VSAM,KSDS                                       *
  7248*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7249*                                                                *
  7250*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7251*                                                                *
  7252*    LOG = YES                                                   *
  7253*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7254******************************************************************
  7255 01  FORM-MASTER.
  7256    12  FO-RECORD-ID                 PIC X(02).
  7257        88  VALID-FO-ID                  VALUE 'FO'.
  7258
  7259    12  FO-CONTROL-PRIMARY.
  7260        16  FO-COMPANY-CD            PIC X(01).
  7261        16  FO-STATE                 PIC X(02).
  7262        16  FO-FORM-ID               PIC X(12).
  7263        16  FO-FORM-EXP-DT           PIC X(02).
  7264
  7265    12  FO-POLICY-FORM-DATA.
  7266        16  FO-IND-GRP-CD            PIC X(01).
  7267        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7268        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7269        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7270        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7271        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7272        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7273        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7274        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7275        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7276        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7277        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7278        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7279        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7280        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7281        16  FO-APP-CERT-USE-CD       PIC X(01).
  7282
  7283    12  FILLER                       PIC X(29).
  7284
  7285    12  FO-FORM-PLAN-TABLE.
  7286        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7287            20  FO-PLAN-TYPE         PIC X(01).
  7288            20  FO-PLAN-ID           PIC X(02).
  7289            20  FO-PLAN-TERM         PIC 9(03).
  7290            20  FO-PLAN-REFUND-METHOD
  7291                                     PIC X.
  7292
  7293    12  FILLER                       PIC X(30).
  7294
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 134
* EL050.cbl
  7295    12  FO-COMMENTS-AREA.
  7296        16  FO-COMMENT-LINE-1        PIC X(78).
  7297
  7298    12  FILLER                       PIC X(20).
  7299
  7300    12  FO-MAINT-INFORMATION.
  7301        16  FO-LAST-MAINT-DT         PIC X(02).
  7302        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7303        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 135
* EL050.cbl
  7305*    COPY ELCMSTR.
  7306******************************************************************
  7307*                                                                *
  7308*                            ELCMSTR.                            *
  7309*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7310*                            VMOD=2.012                          *
  7311*                                                                *
  7312*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7313*                                                                *
  7314*   FILE TYPE = VSAM,KSDS                                        *
  7315*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7316*                                                                *
  7317*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7318*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7319*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7320*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7321*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7322*                                                 RKP=75,LEN=21  *
  7323*                                                                *
  7324*   **** NOTE ****                                               *
  7325*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7326*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7327*                                                                *
  7328*   LOG = YES                                                    *
  7329*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7330******************************************************************
  7331*                   C H A N G E   L O G
  7332*
  7333* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7334*-----------------------------------------------------------------
  7335*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7336* EFFECTIVE    NUMBER
  7337*-----------------------------------------------------------------
  7338* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7339* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7340* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7341* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7342* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7343******************************************************************
  7344 01  CLAIM-MASTER.
  7345     12  CL-RECORD-ID                PIC XX.
  7346         88  VALID-CL-ID         VALUE 'CL'.
  7347
  7348     12  CL-CONTROL-PRIMARY.
  7349         16  CL-COMPANY-CD           PIC X.
  7350         16  CL-CARRIER              PIC X.
  7351         16  CL-CLAIM-NO             PIC X(7).
  7352         16  CL-CERT-NO.
  7353             20  CL-CERT-PRIME       PIC X(10).
  7354             20  CL-CERT-SFX         PIC X.
  7355
  7356     12  CL-CONTROL-BY-NAME.
  7357         16  CL-COMPANY-CD-A1        PIC X.
  7358         16  CL-INSURED-LAST-NAME    PIC X(15).
  7359         16  CL-INSURED-NAME.
  7360             20  CL-INSURED-1ST-NAME PIC X(12).
  7361             20  CL-INSURED-MID-INIT PIC X.
  7362
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 136
* EL050.cbl
  7363     12  CL-CONTROL-BY-SSN.
  7364         16  CL-COMPANY-CD-A2        PIC X.
  7365         16  CL-SOC-SEC-NO.
  7366             20  CL-SSN-STATE        PIC XX.
  7367             20  CL-SSN-ACCOUNT      PIC X(6).
  7368             20  CL-SSN-LN3          PIC X(3).
  7369
  7370     12  CL-CONTROL-BY-CERT-NO.
  7371         16  CL-COMPANY-CD-A4        PIC X.
  7372         16  CL-CERT-NO-A4.
  7373             20  CL-CERT-A4-PRIME    PIC X(10).
  7374             20  CL-CERT-A4-SFX      PIC X.
  7375
  7376     12  CL-CONTROL-BY-CCN.
  7377         16  CL-COMPANY-CD-A5        PIC X.
  7378         16  CL-CCN-A5.
  7379             20  CL-CCN.
  7380                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7381                 24  CL-CCN-PRIME-A5 PIC X(12).
  7382             20  CL-CCN-FILLER-A5    PIC X(4).
  7383
  7384     12  CL-INSURED-PROFILE-DATA.
  7385         16  CL-INSURED-BIRTH-DT     PIC XX.
  7386         16  CL-INSURED-SEX-CD       PIC X.
  7387             88  INSURED-IS-MALE        VALUE 'M'.
  7388             88  INSURED-IS-FEMALE      VALUE 'F'.
  7389             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7390         16  CL-INSURED-OCC-CD       PIC X(6).
  7391         16  FILLER                  PIC X(5).
  7392
  7393     12  CL-PROCESSING-INFO.
  7394         16  CL-PROCESSOR-ID         PIC X(4).
  7395         16  CL-CLAIM-STATUS         PIC X.
  7396             88  CLAIM-IS-OPEN          VALUE 'O'.
  7397             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7398         16  CL-CLAIM-TYPE           PIC X.
  7399*            88  AH-CLAIM               VALUE 'A'.
  7400*            88  LIFE-CLAIM             VALUE 'L'.
  7401*            88  PROPERTY-CLAIM         VALUE 'P'.
  7402*            88  IUI-CLAIM              VALUE 'I'.
  7403*            88  GAP-CLAIM              VALUE 'G'.
  7404*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7405         16  CL-CLAIM-PREM-TYPE      PIC X.
  7406             88  SINGLE-PREMIUM         VALUE '1'.
  7407             88  O-B-COVERAGE           VALUE '2'.
  7408             88  OPEN-END-COVERAGE      VALUE '3'.
  7409         16  CL-INCURRED-DT          PIC XX.
  7410         16  CL-REPORTED-DT          PIC XX.
  7411         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7412         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7413         16  CL-LAST-PMT-DT          PIC XX.
  7414         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7415         16  CL-PAID-THRU-DT         PIC XX.
  7416         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7417         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7418         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7419         16  CL-PMT-CALC-METHOD      PIC X.
  7420             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 137
* EL050.cbl
  7421             88  CL-365-DAY-YR          VALUE '2'.
  7422             88  CL-FULL-MONTHS         VALUE '3'.
  7423         16  CL-CAUSE-CD             PIC X(6).
  7424
  7425         16  CL-PRIME-CERT-NO.
  7426             20  CL-PRIME-CERT-PRIME PIC X(10).
  7427             20  CL-PRIME-CERT-SFX   PIC X.
  7428
  7429         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7430             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7431             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7432
  7433         16  CL-MICROFILM-NO         PIC X(10).
  7434         16  FILLER REDEFINES CL-MICROFILM-NO.
  7435             20  CL-BENEFIT-PERIOD   PIC 99.
  7436             20  FILLER              PIC X(8).
  7437         16  CL-PROG-FORM-TYPE       PIC X.
  7438         16  CL-LAST-ADD-ON-DT       PIC XX.
  7439
  7440         16  CL-LAST-REOPEN-DT       PIC XX.
  7441         16  CL-LAST-CLOSE-DT        PIC XX.
  7442         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7443             88  FINAL-PAID             VALUE '1'.
  7444             88  CLAIM-DENIED           VALUE '2'.
  7445             88  AUTO-CLOSE             VALUE '3'.
  7446             88  MANUAL-CLOSE           VALUE '4'.
  7447             88  BENEFITS-CHANGED       VALUE 'C'.
  7448             88  SETUP-ERRORS           VALUE 'E'.
  7449         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7450         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7451         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7452             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7453         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7454         16  FILLER                  PIC X.
  7455
  7456     12  CL-CERTIFICATE-DATA.
  7457         16  CL-CERT-ORIGIN          PIC X.
  7458             88  CERT-WAS-ONLINE        VALUE '1'.
  7459             88  CERT-WAS-CREATED       VALUE '2'.
  7460             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7461         16  CL-CERT-KEY-DATA.
  7462             20  CL-CERT-CARRIER     PIC X.
  7463             20  CL-CERT-GROUPING    PIC X(6).
  7464             20  CL-CERT-STATE       PIC XX.
  7465             20  CL-CERT-ACCOUNT.
  7466                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7467                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7468             20  CL-CERT-EFF-DT      PIC XX.
  7469
  7470     12  CL-STATUS-CONTROLS.
  7471         16  CL-PRIORITY-CD          PIC X.
  7472             88  CONFIDENTIAL-DATA      VALUE '8'.
  7473             88  HIGHEST-PRIORITY       VALUE '9'.
  7474         16  CL-SUPV-ATTN-CD         PIC X.
  7475             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7476             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7477         16  CL-PURGED-DT            PIC XX.
  7478         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 138
* EL050.cbl
  7479         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7480         16  CL-NEXT-RESEND-DT       PIC XX.
  7481         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7482         16  CL-CRITICAL-PERIOD      PIC 99.
  7483*        16  FILLER                  PIC XX.
  7484         16  CL-LAST-MAINT-DT        PIC XX.
  7485         16  CL-LAST-MAINT-USER      PIC X(4).
  7486         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7487         16  CL-LAST-MAINT-TYPE      PIC X.
  7488             88  CLAIM-SET-UP           VALUE ' '.
  7489             88  PAYMENT-MADE           VALUE '1'.
  7490             88  LETTER-SENT            VALUE '2'.
  7491             88  MASTER-WAS-ALTERED     VALUE '3'.
  7492             88  MASTER-WAS-RESTORED    VALUE '4'.
  7493             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7494             88  FILE-CONVERTED         VALUE '6'.
  7495             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7496             88  ERROR-CORRECTION       VALUE 'E'.
  7497         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7498         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7499         16  CL-BENEFICIARY          PIC X(10).
  7500         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7501         16  CL-DENIAL-TYPE          PIC X.
  7502             88  CL-TYPE-DENIAL          VALUE '1'.
  7503             88  CL-TYPE-RESCISSION      VALUE '2'.
  7504             88  CL-TYPE-REFORMATION     VALUE '3'.
  7505             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7506             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7507         16  filler                  pic x(5).
  7508*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7509*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7510*        16  CL-RTW-DT               PIC XX.
  7511
  7512     12  CL-TRAILER-CONTROLS.
  7513         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7514             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7515             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7516             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7517         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7518         16  FILLER                  PIC XX.
  7519         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7520         16  CL-ADDRESS-TRAILER-CNT.
  7521             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7522                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7523             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7524                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7525             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7526                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7527             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7528                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7529             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7530                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7531             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7532                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7533             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7534                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7535
  7536     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 139
* EL050.cbl
  7537         16  CL-CV-REFNO-PRIME       PIC X(18).
  7538         16  CL-CV-REFNO-SFX         PIC XX.
  7539
  7540     12  CL-FILE-LOCATION            PIC X(4).
  7541
  7542     12  CL-PROCESS-ERRORS.
  7543         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7544             88  NO-FATAL-ERRORS        VALUE ZERO.
  7545         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7546             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7547
  7548     12  CL-PRODUCT-CD               PIC X.
  7549
  7550     12  CL-CURRENT-KEY-DATA.
  7551         16  CL-CURRENT-CARRIER      PIC X.
  7552         16  CL-CURRENT-GROUPING     PIC X(6).
  7553         16  CL-CURRENT-STATE        PIC XX.
  7554         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7555
  7556     12  CL-ASSOCIATES               PIC X.
  7557         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7558         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7559         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7560         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7561
  7562     12  CL-ACTIVITY-CODE            PIC 99.
  7563     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7564     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7565
  7566     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7567     12  CL-LAG-REPORT-CODE          PIC 9.
  7568     12  CL-LOAN-TYPE                PIC XX.
  7569     12  CL-LEGAL-STATE              PIC XX.
  7570
  7571     12  CL-YESNOSW                  PIC X.
  7572     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7573         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7574         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7575         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7576     12  cl-insured-type             pic x.
  7577         88  cl-claim-on-primary         value 'P'.
  7578         88  cl-claim-on-co-borrower     value 'C'.
  7579     12  cl-benefit-expiration-dt    PIC XX.
  7580
  7581 01  PLAN-RECORDS.
  7582     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7583     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7584
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 140
* EL050.cbl
  7586 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7587                          ACCOUNT-MASTER REINSURANCE-RECORD
  7588                          COMM-TABLE-RECORD FORM-MASTER
  7589                          CLAIM-MASTER PLAN-RECORDS.
  7590 0000-DFHEXIT SECTION.
  7591     MOVE '9#                    $   ' TO DFHEIV0.
  7592     MOVE 'EL050' TO DFHEIV1.
  7593     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7594
  7595     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7596
  7597
  7598* EXEC CICS  HANDLE CONDITION
  7599*           ERROR    (9300-ABEND)
  7600*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7601*    END-EXEC.
  7602*    MOVE '"$.J                  ! " #00007593' TO DFHEIV0
  7603     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7605     MOVE X'2220233030303037353933' TO DFHEIV0(25:11)
  7606     CALL 'kxdfhei1' USING DFHEIV0
  7607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7608
  7609
  7610 0000-COPY-PROCEDURE-DIV.
  7611*                          COPY ELC50PD.
  7612******************************************************************
  7613*                                                                *
  7614*                            ELC50PD                             *
  7615*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7616*                            VMOD=2.188                          *
  7617*                                                                *
  7618******************************************************************
  7619*                   C H A N G E   L O G
  7620*
  7621* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7622*-----------------------------------------------------------------
  7623*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7624* EFFECTIVE    NUMBER
  7625*-----------------------------------------------------------------
  7626* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7627* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7628* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7629*                             2709 AND 2718
  7630* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7631* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7632* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7633* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7634* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7635*                                IS OPEN OR CNC DT < PD THRU
  7636* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7637* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7638* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7639* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7640* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7641* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7642* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7643* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 141
* EL050.cbl
  7644* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7645* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7646* 020906                   PEMA  EXPAND LOAN OFFICER
  7647* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7648* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7649* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7650* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7651* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7652* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7653* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7654* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7655* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7656* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7657* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7658* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7659* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7660* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7661* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7662* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7663* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7664* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7665* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7666* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7667* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7668* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7669* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7670* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7671* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7672*                                UPDATE VIN ON CERT TRAILER
  7673* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7674* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7675* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7676* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7677* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7678* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7679* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7680* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7681* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7682* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7683* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7684* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7685* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7686* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7687* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7688* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7689* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7690* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7691* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7692* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7693* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7694* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7695* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7696* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7697* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7698* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7699* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7700* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7701* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 142
* EL050.cbl
  7702* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7703* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7704* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7705* 032912  CR2011110200001  PEMA  AHL CHANGES
  7706* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7707* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7708* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7709* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7710* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7711* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7712* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7713* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7714* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7715* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7716* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7717* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7718* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7719* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7720* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7721* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7722* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7723* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7724* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7725* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7726* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7727* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7728* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7729* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7730* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7731* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7732******************************************************************
  7733************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7734******************************************************************
  7735
  7736     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7737
  7738     MOVE SPACES                 TO PB-FATAL-FLAG
  7739                                    PB-FORCE-ER-CD
  7740                                    PB-WARN-ER-CD
  7741                                    PB-OUT-BAL-CD.
  7742
  7743     MOVE SPACE                  TO WS-IG-OVRD-AH
  7744                                    WS-IG-OVRD-LF
  7745                                    WS-IG-OVRD-AM
  7746                                    WS-IG-OVRD
  7747                                    WS-IG-OVRD-AH-PL
  7748                                    WS-IG-OVRD-LF-PL
  7749                                    WS-IG-OVRD-AH-BEN
  7750                                    WS-IG-OVRD-LF-BEN.
  7751
  7752******************************************************************
  7753*************       INITIALIZE COMMON ERRORS       ***************
  7754******************************************************************
  7755
  7756     MOVE +0                     TO PB-NO-OF-ERRORS.
  7757     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7758
  7759******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 143
* EL050.cbl
  7760
  7761     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7762     SET JULIAN-TO-BIN           TO TRUE.
  7763*    MOVE 5                      TO DC-OPTION-CODE.
  7764     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7765     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7766
  7767     MOVE ZERO                   TO  SUB4.
  7768
  7769 0040-INITIALIZE-GA-BILL-DT.
  7770
  7771     ADD +1                      TO  SUB4.
  7772
  7773     IF  SUB4 GREATER THAN +5
  7774         GO TO 0050-CHECK-CNTL-FOUND.
  7775
  7776     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7777         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7778
  7779     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7780
  7781 0050-CHECK-CNTL-FOUND.
  7782
  7783     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7784        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7785                                         WS-AH-REM-TERM-CALC
  7786                                         EC-CO-REM-TERM-CALC
  7787        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7788        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7789        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7790                                         WS-TOL-AH-CLAIM
  7791        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7792                                         WS-TOL-AH-PREM
  7793                                         EC-CO-TOL-PREM
  7794        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7795                                         WS-TOL-AH-REFUND
  7796                                         EC-CO-TOL-REFUND
  7797        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7798                                         WS-AH-REFUND-OVS-AMT
  7799                                         EC-CO-OVR-SHT-AMT
  7800        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7801                                         WS-TOL-AH-PREM-PCT
  7802                                         EC-CO-TOL-PREM-PCT
  7803        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7804                                         WS-TOL-AH-REFUND-PCT
  7805                                         EC-CO-TOL-REFUND-PCT
  7806        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7807                                         WS-AH-REFUND-OVS-PCT
  7808                                         EC-CO-OVR-SHT-PCT
  7809        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7810        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7811        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7812        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7813        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7814        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7815        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7816        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7817        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 144
* EL050.cbl
  7818        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7819        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7820        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7821                                         EC-CO-MONTH-END-DT
  7822        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7823          GO TO 0100-READ-ACCT.
  7824
  7825     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7826     MOVE SPACES                 TO CNTL-ACCESS.
  7827     MOVE '1'                    TO CNTL-REC-TYPE.
  7828     MOVE +0                     TO CNTL-SEQ-NO.
  7829
  7830     MOVE '1' TO RC-SW-1.
  7831     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7832     IF NOT CF-COMPANY-MASTER
  7833         MOVE ZEROS             TO WK-CO-TOL-PREM
  7834                                   WK-CO-TOL-CLAIM
  7835                                   WK-CO-TOL-REFUND
  7836                                   WK-REFUND-OVS-AMT
  7837                                   WK-REFUND-OVS-PCT
  7838                                   WK-CO-TOL-PREM-PCT
  7839                                   WK-CO-TOL-REFUND-PCT
  7840                                   WK-DEFAULT-APR
  7841                                   WK-CO-MAX-CAP
  7842        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7843                                   WK-CR-R78-METHOD
  7844                                   WK-CO-REF-REJECT-SW
  7845                                   WK-CO-PREM-REJECT-SW
  7846                                   WK-REM-TRM-CALC-OPTION
  7847                                   WK-BIRTH-DATE-INPUT
  7848                                   WK-JOINT-AGE-INPUT
  7849        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7850        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7851        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7852        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7853          GO TO 0099-COMPANY-NOT-FOUND.
  7854
  7855     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7856        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7857     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7858        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7859     IF CF-CO-TOL-CAP NOT NUMERIC
  7860        MOVE +0                    TO CF-CO-TOL-CAP.
  7861     IF CF-DEFAULT-APR NOT NUMERIC
  7862        MOVE +0                    TO CF-DEFAULT-APR.
  7863
  7864     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7865     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7866     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7867     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7868     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7869     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7870     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7871     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7872     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7873     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7874     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7875     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 145
* EL050.cbl
  7876
  7877     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7878          CF-CO-OVR-SHT-AMT > +0
  7879        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7880
  7881     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7882          CF-CO-OVR-SHT-PCT > +0
  7883        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7884
  7885     IF CF-VALID-REM-TRM-OPTION
  7886         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7887     ELSE
  7888         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7889
  7890     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7891     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7892     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7893     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7894
  7895     GO TO 0050-CHECK-CNTL-FOUND.
  7896
  7897 0099-COMPANY-NOT-FOUND.
  7898
  7899     MOVE ER-2616                TO WS-ERROR.
  7900     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7901
  7902 0100-READ-ACCT.
  7903
  7904     MOVE SPACES                 TO DATE-RANGE-SW.
  7905
  7906     IF WK-ACCT-ADDR = ZEROS
  7907        GO TO 0102-ACCT-GETMAIN.
  7908
  7909     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7910     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7911     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7912
  7913     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7914        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7915        GO TO 0105-READ-ACCT
  7916     END-IF
  7917
  7918     IF PB-CARRIER NOT = SPACES
  7919        IF PB-CARRIER NOT = AM-VG-CARRIER
  7920           GO TO 0105-READ-ACCT.
  7921
  7922     IF PB-STATE NOT = SPACES
  7923        IF PB-STATE NOT = AM-VG-STATE
  7924           GO TO 0105-READ-ACCT.
  7925
  7926     IF PB-GROUPING NOT = SPACES
  7927        IF PB-GROUPING NOT = AM-VG-GROUPING
  7928           GO TO 0105-READ-ACCT.
  7929
  7930     MOVE 'X'                 TO DATE-RANGE-SW.
  7931
  7932     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7933        MOVE 'X'                 TO DATE-RANGE-SW
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 146
* EL050.cbl
  7934        GO TO 0105-READ-ACCT.
  7935
  7936     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7937        GO TO 0105-READ-ACCT.
  7938
  7939     GO TO 0180-ACCOUNT-FOUND.
  7940
  7941 0102-ACCT-GETMAIN.
  7942     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7943     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7944
  7945 0105-READ-ACCT.
  7946     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7947     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7948     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7949     MOVE PB-STATE               TO ACCT-STATE.
  7950     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7951     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7952
  7953     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7954
  7955     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7956
  7957 0110-FIND-ACCT-TOLERANCES-LOOP.
  7958     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7959
  7960     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7961        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7962        GO TO 0199-ACCT-NOT-FOUND
  7963     END-IF
  7964     IF PB-CARRIER NOT = SPACES
  7965        IF PB-CARRIER NOT = AM-VG-CARRIER
  7966           GO TO 0199-ACCT-NOT-FOUND.
  7967
  7968     IF PB-STATE NOT = SPACES
  7969        IF PB-STATE NOT = AM-VG-STATE
  7970           GO TO 0199-ACCT-NOT-FOUND.
  7971
  7972     IF PB-GROUPING NOT = SPACES
  7973        IF PB-GROUPING NOT = AM-VG-GROUPING
  7974           GO TO 0199-ACCT-NOT-FOUND.
  7975
  7976     MOVE 'X'                    TO DATE-RANGE-SW.
  7977
  7978     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7979        MOVE 'X'                 TO DATE-RANGE-SW
  7980        GO TO 0199-ACCT-NOT-FOUND.
  7981
  7982     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7983        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7984
  7985 0180-ACCOUNT-FOUND.
  7986     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7987     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7988     MOVE AM-STATE               TO PB-SV-STATE.
  7989     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7990
  7991     IF AM-CANCEL-FEE  NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 147
* EL050.cbl
  7992        MOVE ZEROS TO AM-CANCEL-FEE.
  7993
  7994     IF AM-MAX-MON-BEN NOT NUMERIC
  7995        MOVE ZEROS TO AM-MAX-MON-BEN.
  7996
  7997     IF AM-MAX-TOT-BEN NOT NUMERIC
  7998        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7999
  8000     IF AM-CLP-TOL-PCT NOT NUMERIC
  8001        MOVE +0                  TO AM-CLP-TOL-PCT
  8002     END-IF
  8003     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8004        MOVE +0                  TO AM-SPP-LEASE-COMM
  8005     END-IF
  8006     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8007        MOVE ER-2611             TO   WS-ERROR
  8008        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8009
  8010     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8011        MOVE ER-2621             TO   WS-ERROR
  8012        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8013
  8014     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8015        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8016        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8017        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8018         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8019
  8020     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8021     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8022     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8023     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8024     IF AM-CLP-TOL-PCT NOT = ZEROS
  8025        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8026     END-IF
  8027     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8028        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8029     END-IF
  8030*    IF PB-COMPANY-ID = 'DCC'
  8031*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8032*                                   WS-ADMIN-FEES
  8033*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8034*          (SUB5 > +10)
  8035*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8036*             AND (AM-A-COM (SUB5) NUMERIC)
  8037*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8038*                + (AM-A-COM (SUB5) * 1000)
  8039*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8040*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8041*                + (AM-A-COM (SUB5) * 1000)
  8042*             END-IF
  8043*             IF AM-COM-TYP (SUB5) = 'N'
  8044*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8045*                + (AM-A-COM (SUB5) * 1000)
  8046*             END-IF
  8047*          END-IF
  8048*       END-PERFORM
  8049*    END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 148
* EL050.cbl
  8050     IF (PB-COMPANY-ID = 'DCC')
  8051        AND (PB-ISSUE)
  8052        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8053                                    ws-cred-union-fees
  8054        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8055           (SUB5 > +10)
  8056           MOVE +0 TO WS-WK-RATE
  8057           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8058                                   'O' OR 'S')
  8059              IF (AM-A-COM (SUB5) NUMERIC)
  8060                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8061                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8062              ELSE
  8063                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8064                 IF PB-ISSUE
  8065                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8066                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8067                 ELSE
  8068                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8069                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8070                 END-IF
  8071                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8072                 MOVE ZEROS             TO WS-SUB1
  8073                                           WS-COMMISSION
  8074                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8075                 MOVE '0530'               TO CTBL-SW
  8076                 MOVE ' '                  TO WS-CTBL-READ-SW
  8077                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8078                 IF FIRST-TIME-THROUGH
  8079                    MOVE 'AA'              TO CTBL-BEN-CODE
  8080                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8081                 END-IF
  8082                 IF CTBL-TABLE-FOUND
  8083                    IF PB-ISSUE
  8084                       COMPUTE WS-COMM-CK-AMT =
  8085                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8086                    ELSE
  8087                       COMPUTE WS-COMM-CK-AMT =
  8088                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8089                    END-IF
  8090                    PERFORM 8800-GET-COMP-RATE
  8091                              THRU 8800-EXIT
  8092                 END-IF
  8093              END-IF
  8094              if am-com-typ (sub5) = 'O' or 'S'
  8095                 compute ws-cred-union-fees rounded =
  8096                    ws-cred-union-fees +
  8097                    (pb-i-ah-premium-amt * ws-wk-rate)
  8098              else
  8099                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8100                + (WS-WK-RATE * 1000)
  8101              end-if
  8102           END-IF
  8103        END-PERFORM
  8104     END-IF
  8105     IF PB-COMPANY-ID EQUAL 'CRI'
  8106         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8107
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 149
* EL050.cbl
  8108     IF PB-COMPANY-ID EQUAL 'NCL'
  8109         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8110     END-IF
  8111
  8112     GO TO 0200-READ-CERT.
  8113
  8114 0199-ACCT-NOT-FOUND.
  8115
  8116     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8117
  8118     IF DATE-RANGE-SW NOT = SPACES
  8119        MOVE ER-2601             TO WS-ERROR
  8120        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8121     ELSE
  8122        MOVE ER-2619             TO WS-ERROR
  8123        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8124
  8125     GO TO 9990-RETURN.
  8126
  8127 0200-READ-CERT.
  8128
  8129     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8130     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8131     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8132     MOVE PB-SV-STATE            TO CERT-STATE.
  8133     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8134     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8135     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8136
  8137     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8138
  8139     IF CERT-WAS-NOT-FOUND
  8140        GO TO 0299-CERT-NOT-FOUND.
  8141
  8142     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8143        MOVE ER-2759             TO WS-ERROR
  8144        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8145        GO TO 0298-UNLOCK-RETURN.
  8146
  8147     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8148         MOVE ER-2758            TO WS-ERROR
  8149         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8150         GO TO 0298-UNLOCK-RETURN.
  8151
  8152     IF PB-ISSUE
  8153        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8154           IF CERT-WAS-CREATED-FOR-CLAIM
  8155              NEXT SENTENCE
  8156            ELSE
  8157              MOVE ER-2626       TO WS-ERROR
  8158              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8159              GO TO 0298-UNLOCK-RETURN.
  8160
  8161     IF NOT PB-CANCELLATION
  8162        GO TO 0300-CONTINUE-EDIT.
  8163
  8164     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8165     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 150
* EL050.cbl
  8166     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8167     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8168     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8169     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8170
  8171     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8172     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8173     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8174     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8175     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8176     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8177     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8178     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8179     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8180
  8181     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8182     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8183     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8184     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8185     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8186     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8187     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8188
  8189     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8190     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8191
  8192     MOVE CM-CREDIT-INTERFACE-SW-1
  8193                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8194     MOVE CM-CREDIT-INTERFACE-SW-2
  8195                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8196
  8197     IF CM-O-B-COVERAGE
  8198         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8199
  8200     IF CM-LIVES NOT NUMERIC
  8201         MOVE ZERO                TO CM-LIVES.
  8202
  8203     IF CM-BILLED NOT NUMERIC
  8204         MOVE ZERO                TO CM-BILLED.
  8205
  8206     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8207         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8208         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8209         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8210         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8211         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8212         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8213         MOVE CM-LIVES             TO PB-CI-LIVES
  8214*The next line causes a problem with my change  I dont think it is
  8215*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8216
  8217     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8218     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8219     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8220     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8221     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8222     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8223
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 151
* EL050.cbl
  8224     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8225     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8226     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8227     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8228
  8229     IF CM-LIFE-COMM-PCT NUMERIC
  8230         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8231     ELSE
  8232         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8233
  8234     IF CM-AH-COMM-PCT NUMERIC
  8235         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8236     ELSE
  8237         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8238
  8239     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8240
  8241     IF CM-LOAN-APR       NOT NUMERIC
  8242           MOVE ZERO               TO CM-LOAN-APR.
  8243
  8244     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8245           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8246
  8247     IF CM-LOAN-TERM      NOT NUMERIC
  8248           MOVE ZERO               TO CM-LOAN-TERM.
  8249
  8250     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8251           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8252
  8253     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8254           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8255
  8256     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8257     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8258     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8259     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8260     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8261     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8262     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8263     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8264     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8265     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8266     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8267     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8268
  8269     IF CM-STATE = CM-SSN-STATE
  8270         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8271
  8272     IF CM-STATE NOT = CM-MEMB-STATE
  8273         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8274
  8275     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8276
  8277     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8278        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8279        IF CM-ADDL-CLP NOT NUMERIC
  8280           MOVE +0               TO CM-ADDL-CLP
  8281        END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 152
* EL050.cbl
  8282        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8283        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8284           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8285        END-IF
  8286     END-IF
  8287     IF PB-COMPANY-ID = 'DCC'
  8288        MOVE +0                  TO WS-ADMIN-FEES
  8289                                    WS-CSO-ADMIN-FEE
  8290                                    WS-COMM-AND-MFEE
  8291                                    WS-1ST-YR-ALLOW
  8292        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8293           (SUB5 > +10)
  8294           MOVE +0 TO WS-WK-RATE
  8295           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8296              IF (AM-A-COM (SUB5) NUMERIC)
  8297                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8298                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8299              ELSE
  8300                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8301                 IF PB-ISSUE
  8302                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8303                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8304                 ELSE
  8305                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8306                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8307                 END-IF
  8308                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8309                 MOVE ZEROS             TO WS-SUB1
  8310                                           WS-COMMISSION
  8311                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8312                 MOVE '0530'               TO CTBL-SW
  8313                 MOVE ' '                  TO WS-CTBL-READ-SW
  8314                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8315                 IF FIRST-TIME-THROUGH
  8316                    MOVE 'AA'              TO CTBL-BEN-CODE
  8317                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8318                 END-IF
  8319                 IF CTBL-TABLE-FOUND
  8320                    IF PB-ISSUE
  8321                       COMPUTE WS-COMM-CK-AMT =
  8322                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8323                    ELSE
  8324                       COMPUTE WS-COMM-CK-AMT =
  8325                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8326                    END-IF
  8327                    PERFORM 8800-GET-COMP-RATE
  8328                              THRU 8800-EXIT
  8329                 END-IF
  8330              END-IF
  8331              IF AM-COM-TYP (SUB5) = 'I'
  8332                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8333                   + (WS-WK-RATE * 1000)
  8334              END-IF
  8335              IF AM-COM-TYP (SUB5) = 'N'
  8336                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8337                   + (WS-WK-RATE * 1000)
  8338              END-IF
  8339              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 153
* EL050.cbl
  8340                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8341                   + (WS-WK-RATE * 1000)
  8342              END-IF
  8343              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8344                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8345                   + (WS-WK-RATE * 1000)
  8346              END-IF
  8347           END-IF
  8348        END-PERFORM
  8349     END-IF
  8350     GO TO 0300-CONTINUE-EDIT.
  8351
  8352 0298-UNLOCK-RETURN.
  8353      PERFORM 9250-UNLOCK-RETURN
  8354      GO TO 9990-RETURN.
  8355
  8356 0299-CERT-NOT-FOUND.
  8357
  8358     MOVE '1'                     TO CERT-STATUS-SW.
  8359
  8360     IF PB-COMPANY-ID = 'UCL'
  8361         IF WS-ERROR = ER-2799
  8362             GO TO 3000-CONTINUE-EDIT.
  8363
  8364     IF NOT PB-CANCELLATION
  8365         GO TO 0300-CONTINUE-EDIT.
  8366
  8367     MOVE ER-2726                  TO  WS-ERROR.
  8368     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8369     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8370     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8371                                    PB-CI-LF-TERM
  8372                                    PB-C-LF-REM-TERM
  8373                                    PB-CI-AH-TERM
  8374                                    PB-C-AH-REM-TERM
  8375                                    PB-CI-LF-BENEFIT-CD
  8376                                    PB-CI-LF-BENEFIT-AMT
  8377                                    PB-CI-LF-ALT-BENEFIT-AMT
  8378                                    PB-CI-LF-PREMIUM-AMT
  8379                                    PB-CI-LF-ALT-PREMIUM-AMT
  8380                                    PB-CI-AH-BENEFIT-CD
  8381                                    PB-CI-AH-BENEFIT-AMT
  8382                                    PB-CI-AH-PREMIUM-AMT
  8383                                    PB-CI-PAY-FREQUENCY
  8384                                    PB-CI-LOAN-APR
  8385                                    PB-CI-LOAN-TERM
  8386                                    PB-CI-LIFE-COMMISSION
  8387                                    PB-CI-AH-COMMISSION
  8388                                    PB-CI-CURR-SEQ
  8389                                    PB-CI-AH-CANCEL-AMT
  8390                                    PB-CI-LF-CANCEL-AMT
  8391                                    PB-CI-RATE-DEV-PCT-LF
  8392                                    PB-CI-RATE-DEV-PCT-AH
  8393                                    PB-CI-EXTENTION-DAYS
  8394                                    PB-CI-TERM-IN-DAYS
  8395                                    PB-CI-LIVES
  8396                                    PB-CI-LF-CRIT-PER
  8397                                    PB-CI-AH-CRIT-PER
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 154
* EL050.cbl
  8398                                    PB-CI-ADDL-CLP
  8399                                    PB-CI-DDF-IU-RATE-UP.
  8400
  8401     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8402                                    PB-CI-AH-SETTLEMENT-DT
  8403                                    PB-CI-DEATH-DT
  8404                                    PB-CI-LF-PRIOR-CANCEL-DT
  8405                                    PB-CI-AH-PRIOR-CANCEL-DT
  8406                                    PB-CI-ENTRY-DT
  8407                                    PB-CI-LF-EXPIRE-DT
  8408                                    PB-CI-AH-EXPIRE-DT
  8409                                    PB-CI-LOAN-1ST-PMT-DT.
  8410
  8411     IF ACCOUNT-MAST-FOUND
  8412        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8413        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8414
  8415
  8416 0300-CONTINUE-EDIT.
  8417
  8418     IF PB-ISSUE
  8419        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8420            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8421
  8422     IF PB-ISSUE
  8423        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8424            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8425
  8426     IF PB-ISSUE
  8427       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8428          (AM-NO-AH-ONLY)
  8429           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8430               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8431                   MOVE ER-2679 TO WS-ERROR
  8432                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8433
  8434     IF PB-ISSUE
  8435        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8436        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8437        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8438     ELSE
  8439        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8440        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8441        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8442
  8443     MOVE 'N'                    TO PLAN-MASTER-SW
  8444                                    PLAN-MASTER-LIFE-SW
  8445                                    FORM-MASTER-SW
  8446                                    WS-APP-CERT-SW.
  8447
  8448     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8449                                    WS-PL-TOL-LF-REFUND
  8450                                    WS-PL-REF-OVS-AMT
  8451                                    WS-PL-TOL-LF-PREM-PCT
  8452                                    WS-PL-TOL-LF-REFUND-PCT
  8453                                    WS-PL-REF-OVS-PCT
  8454                                    WS-PL-TOL-LF-CLAIM.
  8455
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 155
* EL050.cbl
  8456     IF PB-COMPANY-ID = 'NCL'
  8457       IF PB-ISSUE
  8458         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8459             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8460             IF FORM-MASTER-FOUND
  8461                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8462
  8463     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8464        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8465
  8466********************** MON CODE **********************
  8467     IF PB-COMPANY-ID = 'MON'
  8468     IF PB-ISSUE
  8469     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8470        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8471             PB-I-LOAN-APR = ZERO)
  8472               MOVE 14.0         TO PB-I-LOAN-APR.
  8473******************************************************
  8474
  8475     IF PB-COMPANY-ID = 'NCL'
  8476       IF PB-ISSUE
  8477           IF FORM-MASTER-FOUND
  8478             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8479                AM-DISMBR-COVERAGE
  8480                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8481                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8482                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8483                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8484                                           PB-I-LIFE-BENEFIT-CD.
  8485
  8486     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8487
  8488     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8489         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8490         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8491         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8492         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8493         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8494           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8495             GO TO 0301-LIFE-BENEFIT-SEARCH
  8496         ELSE
  8497             NEXT SENTENCE
  8498     ELSE
  8499         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8500
  8501     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8502     MOVE '4'                    TO CNTL-REC-TYPE.
  8503     MOVE +0                     TO CNTL-SEQ-NO.
  8504     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8505
  8506     MOVE '1' TO RC-SW-2.
  8507     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8508
  8509     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8510        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8511         GO TO 0305-BENEFIT-NOT-FOUND.
  8512
  8513     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 156
* EL050.cbl
  8514
  8515 0301-LIFE-BENEFIT-SEARCH.
  8516
  8517     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8518
  8519     IF NO-BENEFIT-FOUND
  8520        GO TO 0305-BENEFIT-NOT-FOUND.
  8521
  8522     IF WS-BEN-CD = '99'
  8523        GO TO 0305-BENEFIT-NOT-FOUND.
  8524
  8525     IF PB-COMPANY-ID = 'NCL'
  8526         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8527             GO TO 0304-LIFE-BENEFIT-FOUND.
  8528
  8529     MOVE +1                     TO SUB5.
  8530     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8531
  8532* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8533* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8534     IF PB-COMPANY-ID = 'DMD'
  8535         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8536
  8537 0302-EDIT-ACCT-LF-BENEFITS.
  8538
  8539     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8540        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8541           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8542                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8543           GO TO 03XX-GET-LIFE-ERPLAN.
  8544
  8545     IF SUB5 LESS THAN +20
  8546        ADD +1                   TO SUB5
  8547        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8548
  8549     MOVE +1                     TO SUB5.
  8550
  8551     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8552        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8553
  8554 0303-EDIT-DMD-EXTRA-BENEFITS.
  8555
  8556     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8557        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8558           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8559                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8560           GO TO 03XX-GET-LIFE-ERPLAN.
  8561
  8562     IF SUB5 LESS THAN +30
  8563        ADD +1                   TO SUB5
  8564        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8565
  8566     MOVE +1                     TO SUB5.
  8567
  8568 03XX-EDIT-FOR-NINETY-LF.
  8569
  8570***************************************************************
  8571*                                                             *
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 157
* EL050.cbl
  8572*    NINETY BENEFIT PLAN TYPES:                               *
  8573*                                                             *
  8574*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8575*      92 = ALL GROUP REDUCING BENEFITS                       *
  8576*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8577*      94 = ALL GROUP LEVEL BENEFITS                          *
  8578*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8579*           BENEFIT CONTROLS.                                 *
  8580*      99 = ALL BENEFITS                                      *
  8581*                                                             *
  8582***************************************************************
  8583
  8584     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8585                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8586
  8587     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8588       AND
  8589        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8590        GO TO 03XX-GET-LIFE-ERPLAN.
  8591
  8592     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8593       AND
  8594        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8595        IF CF-REDUCING (SUB3)
  8596           IF (PB-I-INDV-GRP-OVRD = 'I')
  8597              OR
  8598           ((AM-IG = '1') AND
  8599           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8600              OR
  8601           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8602           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8603           (AM-IG NOT = '2'))
  8604              GO TO 03XX-GET-LIFE-ERPLAN.
  8605
  8606     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8607       AND
  8608        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8609        IF CF-REDUCING (SUB3)
  8610           IF (PB-I-INDV-GRP-OVRD = 'G')
  8611              OR
  8612           ((AM-IG = '2') AND
  8613           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8614              OR
  8615           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8616           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8617           (AM-IG NOT = '1'))
  8618              GO TO 03XX-GET-LIFE-ERPLAN.
  8619
  8620     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8621       AND
  8622        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8623        IF CF-LEVEL    (SUB3)
  8624           IF (PB-I-INDV-GRP-OVRD = 'I')
  8625              OR
  8626           ((AM-IG = '1') AND
  8627           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8628              OR
  8629           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 158
* EL050.cbl
  8630           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8631            (AM-IG NOT = '2'))
  8632              GO TO 03XX-GET-LIFE-ERPLAN.
  8633
  8634     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8635       AND
  8636        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8637        IF CF-LEVEL    (SUB3)
  8638           IF (PB-I-INDV-GRP-OVRD = 'G')
  8639              OR
  8640           ((AM-IG = '2') AND
  8641           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8642              OR
  8643           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8644           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8645           (AM-IG NOT = '1'))
  8646              GO TO 03XX-GET-LIFE-ERPLAN.
  8647
  8648     IF SUB5 LESS THAN +20
  8649        ADD +1                   TO SUB5
  8650        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8651
  8652     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8653
  8654     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8655        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8656
  8657     MOVE +1                     TO SUB5.
  8658
  8659 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8660
  8661     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8662                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8663
  8664     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8665       AND
  8666        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8667        GO TO 03XX-GET-LIFE-ERPLAN.
  8668
  8669     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8670       AND
  8671        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8672        IF CF-REDUCING (SUB3)
  8673           IF (PB-I-INDV-GRP-OVRD = 'I')
  8674              OR
  8675           ((AM-IG = '1') AND
  8676           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8677              OR
  8678           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8679           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8680           (AM-IG NOT = '2'))
  8681              GO TO 03XX-GET-LIFE-ERPLAN.
  8682
  8683     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8684       AND
  8685        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8686        IF CF-REDUCING (SUB3)
  8687           IF (PB-I-INDV-GRP-OVRD = 'G')
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 159
* EL050.cbl
  8688              OR
  8689           ((AM-IG = '2') AND
  8690           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8691              OR
  8692           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8693           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8694           (AM-IG NOT = '1'))
  8695              GO TO 03XX-GET-LIFE-ERPLAN.
  8696
  8697     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8698       AND
  8699        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8700        IF CF-LEVEL    (SUB3)
  8701           IF (PB-I-INDV-GRP-OVRD = 'I')
  8702              OR
  8703           ((AM-IG = '1') AND
  8704           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8705              OR
  8706           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8707           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8708            (AM-IG NOT = '2'))
  8709              GO TO 03XX-GET-LIFE-ERPLAN.
  8710
  8711     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8712       AND
  8713        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8714        IF CF-LEVEL    (SUB3)
  8715           IF (PB-I-INDV-GRP-OVRD = 'G')
  8716              OR
  8717           ((AM-IG = '2') AND
  8718           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8719              OR
  8720           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8721           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8722           (AM-IG NOT = '1'))
  8723              GO TO 03XX-GET-LIFE-ERPLAN.
  8724
  8725     IF SUB5 LESS THAN +30
  8726        ADD +1                   TO SUB5
  8727        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8728
  8729     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8730
  8731 03XX-EDIT-FOR-NINETY-LF-CONT.
  8732
  8733     MOVE +99                    TO SUB5.
  8734
  8735     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8736        IF PB-ISSUE
  8737           MOVE ER-1924          TO  WS-ERROR
  8738           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8739
  8740     GO TO 0304-LIFE-BENEFIT-FOUND.
  8741
  8742 03XX-GET-LIFE-ERPLAN.
  8743
  8744     IF WK-PLAN-ADDR EQUAL +0
  8745        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 160
* EL050.cbl
  8746
  8747     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8748     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8749     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8750     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8751     MOVE 'Y'                    TO PLAN-MASTER-SW
  8752                                    PLAN-MASTER-LIFE-SW.
  8753     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8754
  8755 03XX-ERPLAN-LIFE-GETMAIN.
  8756
  8757     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8758     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8759
  8760 03XX-ERPLAN-LIFE-READ.
  8761
  8762     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8763     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8764     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8765     MOVE PB-SV-STATE            TO PLAN-STATE.
  8766     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8767     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8768     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8769     MOVE WS-SAVE-BENEFIT-REVISION
  8770                                 TO PLAN-REVISION-NO.
  8771
  8772     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8773     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8774
  8775     IF PB-COMPANY-ID = 'NCL'
  8776       IF NOT LF-PLAN-MASTER-FOUND
  8777         IF NOT PB-POLICY-IS-DECLINED  AND
  8778            NOT PB-POLICY-IS-VOIDED
  8779             MOVE  ER-1921         TO  WS-ERROR
  8780             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8781             GO TO 0304-LIFE-BENEFIT-FOUND.
  8782
  8783     IF NOT LF-PLAN-MASTER-FOUND
  8784        GO TO 0304-LIFE-BENEFIT-FOUND.
  8785
  8786 XXXX-CHECK-LF-PLAN-KEY.
  8787
  8788     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8789        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8790        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8791        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8792        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8793        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8794        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8795        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8796        MOVE 'N'                 TO PLAN-MASTER-SW
  8797          GO TO 03XX-ERPLAN-LIFE-READ.
  8798
  8799     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8800
  8801     IF  PB-CANCELLATION
  8802         GO TO  0303-LF-ACCT-BEN-FOUND.
  8803
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 161
* EL050.cbl
  8804     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8805        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8806           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8807           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8808              MOVE ER-2644             TO WS-ERROR
  8809              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8810           ELSE
  8811              NEXT SENTENCE
  8812        ELSE
  8813           IF PB-COMPANY-ID NOT = 'NCL'
  8814              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8815                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8816
  8817 0303-LF-ACCT-BEN-FOUND.
  8818
  8819     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8820
  8821     IF PL-DEV-CODE NOT = SPACES
  8822        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8823
  8824     IF PL-DEV-PCT NUMERIC AND
  8825        PL-DEV-PCT NOT = ZEROS
  8826        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8827
  8828     IF PL-TOL-PREM-AMT GREATER THAN +0
  8829        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8830
  8831     IF PL-TOL-REF-AMT GREATER THAN +0
  8832        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8833
  8834     IF PL-TOL-PREM-PCT GREATER THAN +0
  8835        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8836
  8837     IF PL-TOL-REF-PCT GREATER THAN +0
  8838        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8839
  8840     IF PL-TOL-CLM-AMT GREATER THAN +0
  8841        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8842
  8843     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8844                          PL-OVER-SHORT-AMT > +0
  8845        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8846
  8847     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8848                          PL-OVER-SHORT-PCT > +0
  8849        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8850
  8851     IF PL-SALES-TAX NUMERIC AND
  8852                          PL-SALES-TAX > +0
  8853         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8854
  8855     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8856        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8857                                    WS-IG-OVRD-AM.
  8858
  8859 0304-LIFE-BENEFIT-FOUND.
  8860
  8861     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 162
* EL050.cbl
  8862
  8863     IF PB-ISSUE
  8864        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8865     ELSE
  8866        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8867
  8868     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8869     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8870     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8871     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8872     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8873                                         WS-LF-REFUND-CALC.
  8874     if (ws-lf-earnings-calc = '5')
  8875        and (pb-i-loan-apr = zeros)
  8876        and (benefit-code-chg)
  8877        move +99.9999 to pb-i-loan-apr
  8878     end-if
  8879
  8880     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8881        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8882
  8883     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8884        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8885     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8886
  8887     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8888     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8889     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8890     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8891     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8892     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8893
  8894     IF PB-COMPANY-ID = 'NCL'  AND
  8895        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8896         NEXT SENTENCE
  8897     ELSE
  8898         IF SUB5 NOT GREATER THAN +20
  8899            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8900               MOVE WS-SAVE-BENEFIT-REM-TERM
  8901                                      TO WS-AM-LF-BENE-REM-TERM
  8902                                         EC-BR-LF-REM-TERM-CALC.
  8903
  8904     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8905     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8906
  8907     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8908
  8909 0305-BENEFIT-NOT-FOUND.
  8910
  8911     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8912     MOVE ER-2604                TO WS-ERROR.
  8913     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8914
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 163
* EL050.cbl
  8916
  8917 0310-FIND-AH-BENEFIT-RECORD.
  8918
  8919     MOVE 'N'                    TO PLAN-MASTER-SW
  8920                                    PLAN-MASTER-AH-SW.
  8921
  8922     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8923                                    WS-PL-TOL-AH-REFUND
  8924                                    WS-AH-PL-REF-OVS-AMT
  8925                                    WS-PL-TOL-AH-PREM-PCT
  8926                                    WS-PL-TOL-AH-REFUND-PCT
  8927                                    WS-AH-PL-REF-OVS-PCT
  8928                                    WS-PL-TOL-AH-CLAIM.
  8929     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8930
  8931
  8932     if pb-issue
  8933        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8934           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8935        end-if
  8936        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8937           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8938           GO TO 0399-BENEFIT-NOT-FOUND
  8939        end-if
  8940     end-if
  8941
  8942     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8943        GO TO 0400-FIND-CARRIER.
  8944
  8945     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8946
  8947     IF WK-AH-BEN-ADDR NOT = ZEROS
  8948         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8949         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8950         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8951         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8952           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8953             GO TO 0311-AH-BENEFIT-SEARCH
  8954         ELSE
  8955             NEXT SENTENCE
  8956     ELSE
  8957         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8958
  8959     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8960     MOVE '5'                    TO CNTL-REC-TYPE.
  8961     MOVE +0                     TO CNTL-SEQ-NO.
  8962     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8963
  8964     MOVE '2' TO RC-SW-2.
  8965     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8966
  8967     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8968        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8969          GO TO 0399-BENEFIT-NOT-FOUND.
  8970
  8971     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8972
  8973 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 164
* EL050.cbl
  8974
  8975     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8976
  8977     IF NO-BENEFIT-FOUND
  8978         GO TO 0399-BENEFIT-NOT-FOUND.
  8979
  8980     IF WS-BEN-CD = '99'
  8981        GO TO 0399-BENEFIT-NOT-FOUND.
  8982
  8983     IF PB-COMPANY-ID  =  'NCL'
  8984         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8985             GO TO 0314-A-H-BENEFIT-FOUND.
  8986
  8987     MOVE +1                     TO SUB5.
  8988     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8989
  8990* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8991* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8992     IF PB-COMPANY-ID = 'DMD'
  8993         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8994
  8995 0312-EDIT-ACCT-AH-BENEFITS.
  8996
  8997     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8998        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8999           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9000                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9001           GO TO 03XX-GET-AH-ERPLAN.
  9002
  9003     IF SUB5 LESS THAN +20
  9004        ADD +1                   TO SUB5
  9005        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9006
  9007     MOVE +1                     TO SUB5.
  9008
  9009     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9010        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9011
  9012 0313-EDIT-DMD-EXTRA-BENEFITS.
  9013
  9014     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9015        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9016           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9017                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9018           GO TO 03XX-GET-AH-ERPLAN.
  9019
  9020     IF SUB5 LESS THAN +30
  9021        ADD +1                   TO SUB5
  9022        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9023
  9024     MOVE +1                     TO SUB5.
  9025
  9026 03XX-EDIT-FOR-NINETY-AH.
  9027
  9028***************************************************************
  9029*                                                             *
  9030*    NINETY BENEFIT PLAN TYPES:                               *
  9031*                                                             *
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 165
* EL050.cbl
  9032*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9033*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9034*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9035*           BENEFIT CONTROLS.                                 *
  9036*      99 = ALL BENEFITS.                                     *
  9037*                                                             *
  9038***************************************************************
  9039
  9040     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9041                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9042
  9043     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9044       AND
  9045        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9046        GO TO 03XX-GET-AH-ERPLAN.
  9047
  9048     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9049       AND
  9050        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9051           IF (PB-I-INDV-GRP-OVRD = 'I')
  9052              OR
  9053           ((AM-IG = '1') AND
  9054           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9055              OR
  9056           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9057           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9058           (AM-IG NOT = '2'))
  9059              GO TO 03XX-GET-AH-ERPLAN.
  9060
  9061     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9062       AND
  9063        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9064           IF (PB-I-INDV-GRP-OVRD = 'G')
  9065              OR
  9066           ((AM-IG = '2') AND
  9067           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9068              OR
  9069           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9070           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9071           (AM-IG NOT = '1'))
  9072              GO TO 03XX-GET-AH-ERPLAN.
  9073
  9074     IF SUB5 LESS THAN +20
  9075        ADD +1                   TO SUB5
  9076        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9077
  9078     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9079        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9080
  9081     MOVE +1                    TO SUB5.
  9082
  9083 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9084
  9085     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9086                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9087
  9088     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9089       AND
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 166
* EL050.cbl
  9090        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9091        GO TO 03XX-GET-AH-ERPLAN.
  9092
  9093     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9094       AND
  9095        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9096           IF (PB-I-INDV-GRP-OVRD = 'I')
  9097              OR
  9098           ((AM-IG = '1') AND
  9099           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9100              OR
  9101           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9102           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9103           (AM-IG NOT = '2'))
  9104              GO TO 03XX-GET-AH-ERPLAN.
  9105
  9106     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9107       AND
  9108        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9109           IF (PB-I-INDV-GRP-OVRD = 'G')
  9110              OR
  9111           ((AM-IG = '2') AND
  9112           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9113              OR
  9114           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9115           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9116           (AM-IG NOT = '1'))
  9117              GO TO 03XX-GET-AH-ERPLAN.
  9118
  9119     IF SUB5 LESS THAN +30
  9120        ADD +1                   TO SUB5
  9121        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9122
  9123 03XX-EDIT-FOR-NINETY-AH-CONT.
  9124
  9125     MOVE +99                    TO SUB5.
  9126
  9127     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9128
  9129     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9130        IF PB-ISSUE
  9131           MOVE ER-1925          TO  WS-ERROR
  9132           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9133
  9134     GO TO 0314-A-H-BENEFIT-FOUND.
  9135
  9136 03XX-GET-AH-ERPLAN.
  9137
  9138     IF WK-PLAN-ADDR EQUAL +0
  9139         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9140
  9141     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9142     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9143     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9144     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9145     MOVE 'Y'                    TO PLAN-MASTER-SW
  9146                                    PLAN-MASTER-AH-SW.
  9147*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 167
* EL050.cbl
  9148     GO TO 03XX-ERPLAN-AH-READ.
  9149
  9150 03XX-ERPLAN-AH-GETMAIN.
  9151
  9152     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9153     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9154
  9155 03XX-ERPLAN-AH-READ.
  9156
  9157     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9158     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9159     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9160     MOVE PB-SV-STATE            TO PLAN-STATE.
  9161     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9162     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9163     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9164     MOVE WS-SAVE-BENEFIT-REVISION
  9165                                 TO PLAN-REVISION-NO.
  9166
  9167     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9168     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9169
  9170     IF PB-COMPANY-ID = 'NCL'
  9171       IF NOT AH-PLAN-MASTER-FOUND
  9172         IF NOT PB-POLICY-IS-DECLINED  AND
  9173            NOT PB-POLICY-IS-VOIDED
  9174             MOVE  ER-1922         TO  WS-ERROR
  9175             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9176             GO TO 0314-A-H-BENEFIT-FOUND.
  9177
  9178     IF NOT AH-PLAN-MASTER-FOUND
  9179        GO TO 0314-A-H-BENEFIT-FOUND.
  9180
  9181 XXXX-CHECK-AH-PLAN-KEY.
  9182
  9183     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9184        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9185        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9186        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9187        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9188        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9189        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9190        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9191        MOVE 'N'                 TO PLAN-MASTER-SW
  9192          GO TO 03XX-ERPLAN-AH-READ.
  9193
  9194     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9195
  9196     IF  PB-CANCELLATION
  9197         GO TO  0313-AH-ACCT-BEN-FOUND.
  9198
  9199     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9200       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9201          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9202          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9203             MOVE ER-2644             TO WS-ERROR
  9204             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9205          ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 168
* EL050.cbl
  9206             NEXT SENTENCE
  9207       ELSE
  9208          IF PB-COMPANY-ID NOT = 'NCL'
  9209             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9210                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9211
  9212 0313-AH-ACCT-BEN-FOUND.
  9213
  9214     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9215
  9216     IF PL-DEV-CODE NOT = SPACES
  9217        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9218
  9219     IF PL-DEV-PCT NUMERIC AND
  9220        PL-DEV-PCT NOT = ZEROS
  9221        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9222
  9223     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9224        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9225
  9226     IF PL-TOL-REF-AMT NOT EQUAL +0
  9227        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9228
  9229     IF PL-TOL-PREM-PCT GREATER THAN +0
  9230        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9231
  9232     IF PL-TOL-REF-PCT GREATER THAN +0
  9233        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9234
  9235     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9236        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9237
  9238     IF PL-OVER-SHORT-AMT NUMERIC AND
  9239                          PL-OVER-SHORT-AMT > +0
  9240        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9241
  9242     IF PL-OVER-SHORT-PCT NUMERIC AND
  9243                          PL-OVER-SHORT-PCT > +0
  9244        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9245
  9246     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9247        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9248        IF WS-IG-OVRD-AM EQUAL SPACES
  9249            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9250
  9251 0314-A-H-BENEFIT-FOUND.
  9252
  9253     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9254
  9255     IF PB-ISSUE
  9256        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9257       ELSE
  9258        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9259
  9260     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9261     if cf-maximum-benefits (sub3) numeric
  9262        move cf-maximum-benefits (sub3)
  9263                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 169
* EL050.cbl
  9264     else
  9265        move zeros               to ws-ah-max-bens
  9266     end-if
  9267     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9268     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9269     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9270                                         WS-AH-REFUND-CALC.
  9271
  9272     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9273        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9274
  9275     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9276        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9277     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9278
  9279     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9280     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9281     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9282     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9283     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9284     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9285
  9286     IF PB-COMPANY-ID = 'NCL'  AND
  9287        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9288         NEXT SENTENCE
  9289     ELSE
  9290         IF SUB5 NOT GREATER THAN +20
  9291            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9292                MOVE WS-SAVE-BENEFIT-REM-TERM
  9293                                      TO WS-AM-AH-BENE-REM-TERM
  9294                                         EC-BR-AH-REM-TERM-CALC.
  9295
  9296     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9297     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9298
  9299     GO TO 0400-FIND-CARRIER.
  9300
  9301 0399-BENEFIT-NOT-FOUND.
  9302
  9303     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9304     MOVE ER-2605                TO WS-ERROR.
  9305     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9306
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 170
* EL050.cbl
  9308
  9309 0400-FIND-CARRIER.
  9310
  9311     MOVE PB-SV-CARRIER          TO WS-CARR.
  9312
  9313     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9314     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9315     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9316     MOVE '6'                    TO CNTL-REC-TYPE.
  9317
  9318*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9319     MOVE SPACE                  TO WS-DMD-RATING-SW
  9320                                    EC-BR-DMD-RATING-SW.
  9321
  9322     MOVE '2'                    TO RC-SW-1.
  9323     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9324
  9325     IF NOT CF-CARRIER-MASTER
  9326        GO TO 0400-CARRIER-NOT-FOUND.
  9327
  9328 0400-BUILD-CARR-TOL.
  9329
  9330     IF CF-CR-TOL-PREM NUMERIC AND
  9331        CF-CR-TOL-PREM GREATER THAN +0
  9332        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9333                                    WS-TOL-AH-PREM.
  9334
  9335     IF CF-CR-TOL-REFUND NUMERIC AND
  9336        CF-CR-TOL-REFUND GREATER THAN +0
  9337        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9338                                    WS-TOL-AH-REFUND.
  9339
  9340     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9341        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9342        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9343                                    WS-AH-REFUND-OVS-AMT.
  9344
  9345     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9346        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9347        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9348                                    WS-AH-REFUND-OVS-PCT.
  9349
  9350     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9351        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9352        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9353                                    WS-TOL-AH-PREM-PCT.
  9354
  9355     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9356        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9357        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9358                                     WS-TOL-AH-REFUND-PCT.
  9359
  9360     IF CF-COMPANY-ID EQUAL 'DMD'
  9361         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9362                                    EC-BR-DMD-RATING-SW.
  9363
  9364     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9365     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 171
* EL050.cbl
  9366        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9367     END-IF
  9368     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9369        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9370     END-IF
  9371     IF WS-TOL-CLP-PCT = ZEROS
  9372        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9373     END-IF
  9374
  9375     IF WS-SPP-LEASE-COMM = ZEROS
  9376        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9377     END-IF
  9378     GO TO 0400-FIND-ERPDEF.
  9379
  9380 0400-CARRIER-NOT-FOUND.
  9381
  9382     MOVE ER-2602                TO WS-ERROR.
  9383     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9384
  9385 0400-FIND-ERPDEF.
  9386     IF PB-COMPANY-ID = 'DCC'
  9387        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9388        CONTINUE
  9389     ELSE
  9390        GO TO 0400-FIND-ERCOMP
  9391     END-IF
  9392     MOVE ' '                    TO PDEF-MASTER-SW
  9393     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9394     MOVE PB-STATE               TO ERPDEF-STATE
  9395     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9396     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9397     IF PB-ISSUE
  9398        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9399     ELSE
  9400        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9401     END-IF
  9402     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9403     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9404     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9405     IF PDEF-MASTER-FOUND
  9406        MOVE 'N'                 TO PDEF-MASTER-SW
  9407        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9408        IF PDEF-MASTER-FOUND
  9409           IF (ERPDEF-KEY-SAVE (1:16) =
  9410                        PD-CONTROL-PRIMARY (1:16))
  9411              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9412              CONTINUE
  9413           ELSE
  9414              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9415              IF (ERPDEF-KEY-SAVE (1:16) =
  9416                        PD-CONTROL-PRIMARY (1:16))
  9417                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9418                 CONTINUE
  9419              ELSE
  9420                 MOVE 'N'        TO PDEF-MASTER-SW
  9421              END-IF
  9422           END-IF
  9423        END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 172
* EL050.cbl
  9424        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9425     END-IF
  9426     IF PDEF-MASTER-FOUND
  9427        IF PD-TRUNCATED = 'Y'
  9428           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9429        END-IF
  9430     END-IF
  9431     .
  9432 0400-FIND-ERCOMP.
  9433     IF PB-COMPANY-ID = 'DCC'
  9434        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9435           (WS-SUB1 > +10)
  9436           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9437                 OR 'A' OR 'N'
  9438              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9439              MOVE PB-CARRIER    TO COMP-CARRIER
  9440              MOVE PB-GROUPING   TO COMP-GROUPING
  9441              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9442              MOVE AM-AGT (WS-SUB1)
  9443                                 TO COMP-FIN-RESP
  9444              MOVE 'G'           TO COMP-TYPE
  9445              PERFORM 8582-READ-COMPENSATION-MASTER
  9446                                 THRU 8582-EXIT
  9447              IF COMP-MASTER-FOUND
  9448                 IF CO-GA-INACTIVE
  9449                    MOVE ER-2763 TO WS-ERROR
  9450                    PERFORM 9900-ERROR-FORMAT
  9451                                 THRU 9900-EXIT
  9452                    MOVE +11     TO WS-SUB1
  9453                 END-IF
  9454                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9455                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9456                    MOVE ER-2788 TO WS-ERROR
  9457                    PERFORM 9900-ERROR-FORMAT
  9458                                 THRU 9900-EXIT
  9459                    MOVE +11     TO WS-SUB1
  9460                 END-IF
  9461              END-IF
  9462           END-IF
  9463        END-PERFORM
  9464     END-IF
  9465     IF PB-COMPANY-ID = 'DCC'
  9466        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9467           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9468                                    WS-CLP-STATE
  9469        ELSE
  9470           MOVE SPACES           TO PB-I-CLP-STATE
  9471                                    WS-CLP-STATE
  9472        END-IF
  9473     END-IF
  9474
  9475     IF (PB-COMPANY-ID = 'DCC')
  9476        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9477        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9478        CONTINUE
  9479     ELSE
  9480        GO TO 0400-FIND-STATE-RECORD
  9481     END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 173
* EL050.cbl
  9482     MOVE SPACES                 TO WS-CLP-STATE
  9483     MOVE +0                     TO WS-BANK-FEE
  9484                                    WS-BANK-LFEE
  9485                                    WS-BANK-NOCHRGB
  9486
  9487     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9488     IF (PB-ISSUE)
  9489        AND (PB-I-BANK-NUMBER NOT =
  9490            SPACES AND ZEROS AND LOW-VALUES)
  9491        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9492     ELSE
  9493        IF (PB-CANCELLATION)
  9494           AND (PB-CI-BANK-NUMBER NOT =
  9495                SPACES AND ZEROS AND LOW-VALUES)
  9496           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9497        END-IF
  9498     END-IF
  9499     IF COMP-FIN-RESP NOT = LOW-VALUES
  9500        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9501        MOVE PB-CARRIER          TO COMP-CARRIER
  9502        MOVE PB-GROUPING         TO COMP-GROUPING
  9503        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9504        MOVE 'B'                 TO COMP-TYPE
  9505        PERFORM 8582-READ-COMPENSATION-MASTER
  9506                                 THRU 8582-EXIT
  9507        IF COMP-MASTER-FOUND
  9508           IF CO-MAX-BANK-FEE NOT NUMERIC
  9509              MOVE +0            TO CO-MAX-BANK-FEE
  9510           END-IF
  9511           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9512              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9513           END-IF
  9514           IF CO-GA-INACTIVE
  9515              MOVE ER-2763       TO WS-ERROR
  9516              PERFORM 9900-ERROR-FORMAT
  9517                                 THRU 9900-EXIT
  9518           END-IF
  9519           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9520              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9521              MOVE ER-2788 TO WS-ERROR
  9522              PERFORM 9900-ERROR-FORMAT
  9523                                 THRU 9900-EXIT
  9524              MOVE +11     TO WS-SUB1
  9525           END-IF
  9526           IF WS-AH-BEN-CATEGORY = 'G'
  9527              MOVE CO-MAX-BANK-FEE
  9528                                 TO WS-BANK-FEE
  9529                                    PB-I-BANK-FEE
  9530           ELSE
  9531              MOVE CO-MAX-BANK-FEE-LEASE
  9532                                 TO WS-BANK-LFEE
  9533                                    PB-I-BANK-FEE
  9534           END-IF
  9535           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9536              AND (WS-AH-REFUND-CALC = 'G'))
  9537                        OR
  9538              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9539              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 174
* EL050.cbl
  9540              CONTINUE
  9541           ELSE
  9542              MOVE ER-2789 TO WS-ERROR
  9543              PERFORM 9900-ERROR-FORMAT
  9544                                 THRU 9900-EXIT
  9545           END-IF
  9546           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9547                                    PB-I-CLP-STATE
  9548           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9549           MOVE CO-CARRIER       TO BXRF-CARRIER
  9550           MOVE CO-GROUPING      TO BXRF-GROUPING
  9551           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9552           MOVE BXRF-MAX-REC-LENGTH
  9553                                 TO BXRF-REC-LENGTH
  9554           PERFORM 8584-READ-BANK-CROSS-REF
  9555                                 THRU 8584-EXIT
  9556           IF BXRF-MASTER-FOUND
  9557              MOVE ' '           TO BANK-ACCT-SW
  9558              MOVE BK-BANK-POINTER-CNT
  9559                                 TO BK-BANK-POINTER-CNT
  9560              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9561                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9562                 OR (BANK-ACCT-FOUND)
  9563                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9564                    AND (BK-AM-EXP-DT (WS-SUB1)
  9565                                 > PB-CERT-EFF-DT)
  9566                    AND (BK-AM-EFF-DT (WS-SUB1)
  9567                                 NOT > PB-CERT-EFF-DT)
  9568                    SET BANK-ACCT-FOUND TO TRUE
  9569                 END-IF
  9570              END-PERFORM
  9571              IF NOT BANK-ACCT-FOUND
  9572                 MOVE ZEROS      TO WS-BANK-FEE
  9573                                    WS-BANK-LFEE
  9574                 MOVE ER-2869    TO WS-ERROR
  9575                 PERFORM 9900-ERROR-FORMAT
  9576                                 THRU 9900-EXIT
  9577              ELSE
  9578                 PERFORM 5000-PROCESS-REPS
  9579                                 THRU 5000-EXIT
  9580                 IF AGENT-MASTER-FOUND
  9581                    MOVE +0      TO WS-BANK-FEE
  9582                                    WS-BANK-LFEE
  9583*                   MOVE AG-SPP-FEES (1)
  9584*                                TO PB-I-BANK-FEE
  9585*                                   WS-BANK-FEE
  9586                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9587                       (WS-SUB1 > +10)
  9588                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9589                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9590                       END-IF
  9591                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9592                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9593                       END-IF
  9594                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9595                          AG-SPP-FEES (WS-SUB1)
  9596                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9597                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 175
* EL050.cbl
  9598                    END-PERFORM
  9599                    IF WS-AH-BEN-CATEGORY = 'G'
  9600                       MOVE WS-BANK-FEE
  9601                                 TO PB-I-BANK-FEE
  9602                    ELSE
  9603                       MOVE WS-BANK-LFEE
  9604                                 TO PB-I-BANK-FEE
  9605                    END-IF
  9606                 END-IF
  9607              END-IF
  9608           END-IF
  9609        ELSE
  9610           MOVE ER-2879          TO WS-ERROR
  9611           PERFORM 9900-ERROR-FORMAT
  9612                                 THRU 9900-EXIT
  9613        END-IF
  9614     ELSE
  9615        MOVE ER-2879             TO WS-ERROR
  9616        PERFORM 9900-ERROR-FORMAT
  9617                                 THRU 9900-EXIT
  9618     END-IF
  9619     IF WS-AH-BEN-CATEGORY = 'G'
  9620        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9621        + WS-BANK-FEE
  9622     ELSE
  9623        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9624        + WS-BANK-LFEE
  9625     END-IF
  9626     .
  9627 0400-FIND-STATE-RECORD.
  9628
  9629     IF WK-STATE-ADDR NOT = ZEROS
  9630         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9631         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9632         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9633         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9634         IF PB-SV-STATE = CF-STATE-CODE
  9635             GO TO 0405-CONTINUE-EDIT
  9636         ELSE
  9637             NEXT SENTENCE
  9638     ELSE
  9639         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9640
  9641     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9642     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9643     MOVE '3'                    TO CNTL-REC-TYPE.
  9644     MOVE +0                     TO CNTL-SEQ-NO.
  9645
  9646     MOVE '3'                    TO RC-SW-2.
  9647     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9648
  9649     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9650        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9651        PB-SV-STATE   NOT = CF-STATE-CODE)
  9652        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9653                                    WS-TOL-AH-CLAIM
  9654                                    WS-MINIMUM-REFUND
  9655                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 176
* EL050.cbl
  9656                                    WS-TOL-AH-PREM
  9657                                    WS-TOL-LF-REFUND
  9658                                    WS-TOL-AH-REFUND
  9659                                    EC-ST-TOL-PREM-PCT
  9660                                    WS-TOL-LF-PREM-PCT
  9661                                    WS-TOL-AH-PREM-PCT
  9662                                    EC-ST-TOL-REFUND-PCT
  9663                                    WS-TOL-LF-REFUND-PCT
  9664                                    WS-TOL-AH-REFUND-PCT
  9665                                    EC-ST-TOL-PREM
  9666                                    EC-ST-TOL-REFUND
  9667                                    EC-ST-FST-PMT-DAYS-MAX
  9668                                    WS-FREE-LOOK-PERIOD
  9669                                    WS-ST-LF-PREM-TAX
  9670                                    WS-ST-AH-PREM-TAX-I
  9671                                    WS-ST-AH-PREM-TAX-G
  9672                                    WS-BANK-FEE
  9673                                    WS-BANK-LFEE
  9674                                    WS-TOL-CLP-PCT
  9675                                    WS-SPP-LEASE-COMM
  9676        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9677                                    EC-ST-FST-PMT-DAYS-CHG
  9678                                    WS-LF-REM-TERM-CALC
  9679                                    WS-LF-REFUND-CALC
  9680                                    EC-ST-LF-REM-TERM-CALC
  9681                                    EC-ST-LF-REFUND-CALC
  9682                                    WS-AH-REM-TERM-CALC
  9683                                    WS-AH-REFUND-CALC
  9684                                    WS-LF-BEN-CATEGORY
  9685                                    WS-AH-BEN-CATEGORY
  9686                                    WS-CLP-STATE
  9687                                    WS-ST-REFUND-CLAIM-FLAG
  9688                                    WS-ST-CAUSAL-STATE
  9689                                    EC-ST-AH-REM-TERM-CALC
  9690                                    EC-ST-AH-REFUND-CALC
  9691          GO TO 0499-STATE-NOT-FOUND.
  9692
  9693     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9694
  9695 0405-CONTINUE-EDIT.
  9696
  9697     if pb-company-id = 'AHL'
  9698        continue
  9699     else
  9700        IF PB-CERT-PRIME NOT NUMERIC
  9701           MOVE ER-2722          TO WS-ERROR
  9702           PERFORM 9900-ERROR-FORMAT
  9703                                 THRU 9900-EXIT
  9704        end-if
  9705     END-IF
  9706*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9707*       MOVE +0                  TO SUB3
  9708*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9709*       IF SUB3 > +0
  9710*          MOVE ER-2722          TO WS-ERROR
  9711*          PERFORM 9900-ERROR-FORMAT
  9712*                                THRU 9900-EXIT
  9713*       END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 177
* EL050.cbl
  9714*    END-IF
  9715*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9716*       IF PB-CERT-PRIME NOT NUMERIC
  9717*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9718*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9719*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9720*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9721*
  9722*          MOVE ER-2722          TO WS-ERROR
  9723*          PERFORM 9900-ERROR-FORMAT
  9724*                                THRU 9900-EXIT
  9725*       END-IF
  9726*    END-IF
  9727
  9728     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9729
  9730     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9731        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9732                                    WS-TOL-AH-CLAIM.
  9733
  9734     IF CF-ST-REFUND-MIN NOT NUMERIC
  9735        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9736
  9737     IF CF-ST-REFUND-MIN NOT = ZEROS
  9738        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9739
  9740     IF CF-ST-TOL-PREM  NOT = ZEROS
  9741        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9742                                    WS-TOL-AH-PREM
  9743        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9744
  9745     IF CF-ST-TOL-REFUND NOT = ZEROS
  9746        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9747                                    WS-TOL-AH-REFUND
  9748        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9749
  9750     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9751        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9752        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9753                                    WS-AH-REFUND-OVS-AMT
  9754                                    EC-ST-OVR-SHT-AMT.
  9755
  9756     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9757        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9758        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9759                                    WS-TOL-LF-PREM-PCT
  9760                                    WS-TOL-AH-PREM-PCT.
  9761
  9762     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9763        CF-ST-TOL-REF-PCT GREATER THAN +0
  9764        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9765                                    WS-TOL-LF-REFUND-PCT
  9766                                    WS-TOL-AH-REFUND-PCT.
  9767
  9768     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9769        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9770        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9771                                    WS-AH-REFUND-OVS-PCT
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 178
* EL050.cbl
  9772                                    EC-ST-OVR-SHT-PCT.
  9773
  9774     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9775     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9776
  9777     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9778          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9779
  9780     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9781     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9782     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9783
  9784     IF CF-ST-LF-PREM-TAX NUMERIC
  9785        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9786     END-IF
  9787     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9788        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9789     END-IF
  9790     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9791        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9792     END-IF
  9793
  9794     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9795         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9796     END-IF.
  9797
  9798     IF CF-ST-CAUSAL-STATE > SPACES
  9799         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9800     END-IF.
  9801
  9802     IF WS-LF-BENEFIT-CD = ZEROS
  9803        GO TO 0410-CHECK-AH.
  9804
  9805     IF CF-ST-RT-CALC NOT = SPACES
  9806        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9807                                    EC-ST-LF-REM-TERM-CALC
  9808     END-IF
  9809
  9810     IF WS-LF-COVERAGE-TYPE = 'R'
  9811        IF WS-LF-EARNINGS-CALC = '5'
  9812           IF CF-ST-RF-LN-CALC > '0'
  9813              MOVE CF-ST-RF-LN-CALC
  9814                                 TO WS-LF-REFUND-CALC
  9815                                    EC-ST-LF-REFUND-CALC
  9816           END-IF
  9817        ELSE
  9818           IF CF-ST-RF-LR-CALC > '0'
  9819              MOVE CF-ST-RF-LR-CALC
  9820                                 TO WS-LF-REFUND-CALC
  9821                                    EC-ST-LF-REFUND-CALC
  9822           END-IF
  9823        END-IF
  9824     ELSE
  9825        IF CF-ST-RF-LL-CALC > '0'
  9826           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9827                                    EC-ST-LF-REFUND-CALC
  9828        END-IF
  9829     END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 179
* EL050.cbl
  9830
  9831     IF CF-ST-RT-CALC NOT = SPACES
  9832        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9833                                    EC-ST-LF-REM-TERM-CALC
  9834     END-IF
  9835
  9836     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9837     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9838
  9839     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9840
  9841     IF NO-BENEFIT-FOUND
  9842        GO TO 0410-CHECK-AH.
  9843
  9844     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9845        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9846                                 TO EC-ST-LF-REM-TERM-CALC
  9847                                    WS-LF-REM-TERM-CALC
  9848     END-IF
  9849
  9850     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9851        MOVE CF-ST-REFUND-CALC (SUB3)
  9852                                 TO WS-LF-REFUND-CALC
  9853                                    EC-ST-LF-REFUND-CALC
  9854     END-IF
  9855*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9856
  9857     .
  9858 0410-CHECK-AH.
  9859
  9860     IF WS-AH-BENEFIT-CD = ZEROS
  9861        GO TO 0500-SET-ACCOUNT.
  9862
  9863     IF CF-ST-RT-CALC NOT = SPACES
  9864        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9865                                    EC-ST-AH-REM-TERM-CALC
  9866     END-IF
  9867
  9868     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9869        IF CF-ST-RF-CP-CALC > '0'
  9870           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9871                                    EC-ST-AH-REFUND-CALC
  9872        END-IF
  9873     ELSE
  9874        IF CF-ST-RF-AH-CALC > '0'
  9875           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9876                                    EC-ST-AH-REFUND-CALC
  9877        END-IF
  9878     END-IF
  9879     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9880     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9881
  9882     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9883
  9884     IF NO-BENEFIT-FOUND
  9885        GO TO 0500-SET-ACCOUNT.
  9886
  9887     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 180
* EL050.cbl
  9888        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9889                                 TO WS-AH-REM-TERM-CALC
  9890                                    EC-ST-AH-REM-TERM-CALC
  9891     END-IF
  9892
  9893     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9894        MOVE CF-ST-REFUND-CALC (SUB3)
  9895                                 TO WS-AH-REFUND-CALC
  9896                                    EC-ST-AH-REFUND-CALC
  9897     END-IF
  9898
  9899*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9900
  9901     GO TO 0500-SET-ACCOUNT.
  9902
  9903 0499-STATE-NOT-FOUND.
  9904
  9905     MOVE ER-2603                TO WS-ERROR.
  9906     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9907
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 181
* EL050.cbl
  9909
  9910 0500-SET-ACCOUNT.
  9911*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9912     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9913        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9914        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9915        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9916        MOVE '3'                 TO CNTL-REC-TYPE
  9917        MOVE +0                  TO CNTL-SEQ-NO
  9918
  9919        MOVE '3'                 TO RC-SW-2
  9920        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9921
  9922        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9923           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9924           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9925           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9926                                    WS-ST-AH-PREM-TAX-I
  9927                                    WS-ST-AH-PREM-TAX-G
  9928        ELSE
  9929           IF CF-ST-LF-PREM-TAX NUMERIC
  9930              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9931           END-IF
  9932           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9933              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9934           END-IF
  9935           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9936              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9937           END-IF
  9938        END-IF
  9939        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9940     END-IF
  9941*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9942*  FOR DCC ONLY
  9943     IF PB-COMPANY-ID = 'DCC'
  9944
  9945     MOVE ' '                    TO STAT-MASTER-SW
  9946     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9947     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9948     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9949     MOVE PB-STATE               TO ELSTAT-STATE
  9950     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9951        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9952     END-IF
  9953
  9954     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9955     SET BIN-TO-GREG             TO TRUE
  9956     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9957     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9958     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9959
  9960     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9961     IF STAT-MASTER-FOUND
  9962        MOVE 'N'                 TO STAT-MASTER-SW
  9963        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9964        IF STAT-MASTER-FOUND
  9965           IF (ELSTAT-KEY-SAVE (1:12) =
  9966                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 182
* EL050.cbl
  9967              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9968                 MOVE 'F'        TO STAT-MASTER-SW
  9969              ELSE
  9970                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9971                 IF (STAT-MASTER-FOUND)
  9972                    AND (ELSTAT-KEY-SAVE (1:12) =
  9973                        SF-CONTROL-PRIMARY (1:12))
  9974                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9975                    MOVE 'F'     TO STAT-MASTER-SW
  9976                 END-IF
  9977              END-IF
  9978           END-IF
  9979        END-IF
  9980     END-IF
  9981
  9982     IF STAT-MASTER-SW = 'F'
  9983        IF SF-ST-LF-PREM-TAX NUMERIC
  9984           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9985        END-IF
  9986        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9987           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9988        END-IF
  9989        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9990           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9991        END-IF
  9992     END-IF
  9993
  9994     END-IF
  9995     IF (PB-COMPANY-ID = 'DCC')
  9996        AND (PB-ISSUE)
  9997        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9998        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9999        AND (AM-GPCD = 06)
 10000        MOVE 'Y'                 TO WS-GOOD-HIN
 10001        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10002           MOVE PB-I-VIN         TO WS-WORK-VIN
 10003           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10004              (V1 > 16)
 10005              IF WS-WORK-VIN (V1:1) NUMERIC
 10006                 MOVE WS-WORK-VIN-N (V1)
 10007                                 TO WS-ROW-B-VAL (V1)
 10008              ELSE
 10009                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10010                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10011                    OR (V2 > 26)
 10012                 END-PERFORM
 10013                 IF V2 < 27
 10014                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10015                 ELSE
 10016                    MOVE 'N'     TO WS-GOOD-HIN
 10017                 END-IF
 10018              END-IF
 10019              COMPUTE WS-ROW-D-VAL (V1) =
 10020                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10021              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10022                 WS-ROW-D-VAL (V1)
 10023           END-PERFORM
 10024           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 183
* EL050.cbl
 10025           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10026             REMAINDER WS-VIN-REMAINDER
 10027           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10028              CONTINUE
 10029           ELSE
 10030              MOVE 'N'           TO WS-GOOD-HIN
 10031           END-IF
 10032        ELSE
 10033           MOVE 'N'              TO WS-GOOD-HIN
 10034        END-IF
 10035        IF WS-GOOD-HIN NOT = 'Y'
 10036           MOVE ER-3826           TO WS-ERROR
 10037           PERFORM 9900-ERROR-FORMAT
 10038                                 THRU 9900-EXIT
 10039        END-IF
 10040     END-IF
 10041     IF (PB-COMPANY-ID = 'DCC')
 10042        AND (PB-ISSUE)
 10043        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10044        AND (AM-GPCD NOT = 06)
 10045        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10046          MOVE PB-I-VIN          TO WS-WORK-VIN
 10047          MOVE +8                TO V2
 10048          MOVE ZEROS             TO WS-VIN-TOTAL
 10049          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10050           (V1 > 17)
 10051             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 10052                MOVE ER-3825     TO WS-ERROR
 10053                PERFORM 9900-ERROR-FORMAT
 10054                                 THRU 9900-EXIT
 10055             ELSE
 10056                IF V1 = 8
 10057                   MOVE 10       TO V2
 10058                END-IF
 10059                IF V1 = 9
 10060                   MOVE 0        TO V2
 10061                END-IF
 10062                IF V1 = 10
 10063                   MOVE 9        TO V2
 10064                END-IF
 10065                IF WS-WORK-VIN (V1:1) NUMERIC
 10066                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10067                    + (WS-WORK-VIN-N (V1) * V2)
 10068                ELSE
 10069                   MOVE WS-WORK-VIN (V1:1)
 10070                                 TO WS-HEX-BYTE
 10071                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 10072                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10073                    + (WS-NUM (V3) * V2)
 10074                END-IF
 10075                COMPUTE V2 = V2 - 1
 10076             END-IF
 10077          END-PERFORM
 10078          MOVE ZEROS TO WS-VIN-REMAINDER
 10079          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 10080             REMAINDER WS-VIN-REMAINDER
 10081          IF ((WS-WORK-VIN (9:1) = 'X')
 10082             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 184
* EL050.cbl
 10083                     OR
 10084             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10085             CONTINUE
 10086          ELSE
 10087             MOVE ER-3826        TO WS-ERROR
 10088             PERFORM 9900-ERROR-FORMAT
 10089                                 THRU 9900-EXIT
 10090          END-IF
 10091        ELSE
 10092          MOVE ER-3826           TO WS-ERROR
 10093          PERFORM 9900-ERROR-FORMAT
 10094                                 THRU 9900-EXIT
 10095        END-IF
 10096     END-IF
 10097******************************************************************
 10098******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10099******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10100******* METHODS.
 10101******************************************************************
 10102     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10103        IF PB-CANCELLATION
 10104           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10105              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10106                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10107                IF FORM-MASTER-FOUND
 10108                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10109******************************************************************
 10110
 10111     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10112     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10113
 10114     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10115     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10116     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10117     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10118
 10119
 10120     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10121     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10122     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10123
 10124     IF AM-LF-OB-RATE NOT NUMERIC
 10125         MOVE ZERO               TO AM-LF-OB-RATE.
 10126
 10127     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10128         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10129
 10130     IF AM-AH-OB-RATE NOT NUMERIC
 10131         MOVE ZERO               TO AM-AH-OB-RATE.
 10132
 10133     IF WS-LF-JOINT-INDICATOR = 'J'
 10134         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10135     ELSE
 10136         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10137
 10138     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10139
 10140     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 185
* EL050.cbl
 10141         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10142
 10143     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10144         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10145                                       WS-IG-OVRD
 10146     ELSE
 10147         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10148             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10149                                       WS-IG-OVRD
 10150         ELSE
 10151             MOVE AM-IG             TO WS-IG-OVRD-AH
 10152                                       WS-IG-OVRD.
 10153
 10154     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10155         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10156                                       WS-IG-OVRD
 10157     ELSE
 10158         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10159             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10160                                       WS-IG-OVRD
 10161         ELSE
 10162             MOVE AM-IG             TO WS-IG-OVRD-LF
 10163                                       WS-IG-OVRD.
 10164
 10165     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10166     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10167     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10168     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10169     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10170
 10171     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10172     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10173     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10174     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10175
 10176     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10177     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10178     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10179     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10180     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10181     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10182     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10183
 10184     IF WS-ACCT-AH-DEV-PCT > +0
 10185        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10186     ELSE
 10187        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10188
 10189     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10190        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10191     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10192        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10193
 10194        IF AM-EARN-METHOD-L = 'S'
 10195            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10196                                        WS-LF-REFUND-CALC.
 10197
 10198        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 186
* EL050.cbl
 10199            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10200                                        WS-LF-REFUND-CALC.
 10201
 10202     IF WS-LF-COVERAGE-TYPE = 'R'
 10203         IF AM-EARN-METHOD-R = 'R'
 10204            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10205                                    WS-LF-REFUND-CALC.
 10206     IF WS-LF-COVERAGE-TYPE = 'R'
 10207         IF AM-EARN-METHOD-R = 'P'
 10208            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10209                                    WS-LF-REFUND-CALC.
 10210     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10211         IF AM-EARN-METHOD-L = 'R'
 10212            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10213                                    WS-LF-REFUND-CALC.
 10214     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10215         IF AM-EARN-METHOD-L = 'P'
 10216            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10217                                    WS-LF-REFUND-CALC.
 10218     IF WS-LF-COVERAGE-TYPE = 'R'
 10219         IF AM-EARN-METHOD-R = 'A'
 10220            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10221                                    WS-LF-REFUND-CALC.
 10222     IF WS-LF-COVERAGE-TYPE = 'R'
 10223         IF AM-EARN-METHOD-R = 'M'
 10224            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10225                                    WS-LF-REFUND-CALC.
 10226     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10227         IF AM-EARN-METHOD-L = 'A'
 10228            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10229                                    WS-LF-REFUND-CALC.
 10230     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10231         IF AM-EARN-METHOD-L = 'M'
 10232            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10233                                    WS-LF-REFUND-CALC.
 10234
 10235     IF AM-EARN-METHOD-A = 'R'
 10236        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10237                                    WS-AH-REFUND-CALC.
 10238     IF AM-EARN-METHOD-A = 'P'
 10239        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10240                                    WS-AH-REFUND-CALC.
 10241     IF AM-EARN-METHOD-A = 'C'
 10242        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10243                                    WS-AH-REFUND-CALC.
 10244     IF AM-EARN-METHOD-A = 'A'
 10245        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10246                                    WS-AH-REFUND-CALC.
 10247     IF AM-EARN-METHOD-A = 'M'
 10248        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10249                                    WS-AH-REFUND-CALC.
 10250     IF AM-EARN-METHOD-A = 'N'
 10251        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10252                                    WS-AH-REFUND-CALC.
 10253     IF AM-EARN-METHOD-A = 'S'
 10254        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10255                                    WS-AH-REFUND-CALC.
 10256
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 187
* EL050.cbl
 10257     IF AM-TOL-PREM NOT = ZEROS
 10258        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10259                                    WS-TOL-AH-PREM.
 10260
 10261     IF AM-OVR-SHT-AMT NUMERIC AND
 10262                  AM-OVR-SHT-AMT > 0
 10263        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10264                                    EC-AM-LF-OVR-SHT-AMT
 10265                                    WS-AH-REFUND-OVS-AMT
 10266                                    EC-AM-AH-OVR-SHT-AMT.
 10267
 10268     IF AM-OVR-SHT-PCT NUMERIC AND
 10269                    AM-OVR-SHT-PCT > 0
 10270        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10271                                    EC-AM-LF-OVR-SHT-PCT
 10272                                    WS-AH-REFUND-OVS-PCT
 10273                                    EC-AM-AH-OVR-SHT-PCT.
 10274
 10275     IF AM-TOL-REF-PCT NUMERIC AND
 10276                  AM-TOL-REF-PCT > 0
 10277        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10278                                    WS-TOL-AH-REFUND-PCT.
 10279
 10280     IF AM-TOL-REF  NOT = ZEROS  AND
 10281                  AM-TOL-REF NUMERIC
 10282        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10283                                    EC-AM-LF-TOL-REFUND
 10284                                    WS-TOL-AH-REFUND
 10285                                    EC-AM-AH-TOL-REFUND.
 10286
 10287     IF AM-TOL-CLM  NOT = ZEROS
 10288        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10289                                    WS-TOL-AH-CLAIM.
 10290
 10291     IF AM-CLP-TOL-PCT NOT NUMERIC
 10292        MOVE +0                  TO AM-CLP-TOL-PCT
 10293     END-IF
 10294
 10295     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10296        MOVE +0                  TO AM-SPP-LEASE-COMM
 10297     END-IF
 10298     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10299        MOVE WS-PL-TOL-LF-PREM-PCT
 10300                                 TO WS-TOL-LF-PREM-PCT.
 10301
 10302     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10303        MOVE WS-PL-TOL-AH-PREM-PCT
 10304                                 TO WS-TOL-AH-PREM-PCT.
 10305
 10306     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10307        MOVE WS-PL-TOL-LF-REFUND-PCT
 10308                                 TO WS-TOL-LF-REFUND-PCT.
 10309
 10310     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10311        MOVE WS-PL-TOL-AH-REFUND-PCT
 10312                                 TO WS-TOL-AH-REFUND-PCT.
 10313
 10314     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 188
* EL050.cbl
 10315        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10316
 10317     IF WS-PL-REF-OVS-PCT > +0
 10318        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10319
 10320     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10321        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10322     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10323        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10324     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10325        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10326     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10327        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10328     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10329        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10330     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10331        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10332
 10333     IF WS-AH-PL-REF-OVS-AMT > +0
 10334        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10335
 10336     IF WS-AH-PL-REF-OVS-PCT > +0
 10337        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10338
 10339     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10340     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10341
 10342     IF PB-CANCELLATION
 10343        GO TO 3000-CONTINUE-EDIT.
 10344
 10345     MOVE +1 TO SUB1.
 10346     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10347     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10348
 10349     IF CF-COMPANY-ID = 'DMD'
 10350       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10351         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10352        ELSE
 10353         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10354
 10355  0525-FIND-ACCT-COMM.
 10356     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10357        NEXT SENTENCE
 10358      ELSE
 10359         ADD +1 TO SUB1
 10360         IF SUB1 LESS +11
 10361            GO TO 0525-FIND-ACCT-COMM
 10362          ELSE
 10363             GO TO 0560-EDIT-CONTINUE.
 10364
 10365     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10366     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10367                                    PB-I-LIFE-COMMISSION.
 10368***  IF PB-COMPANY-ID = 'CRI'
 10369     IF PB-PREM-ACCTNG-ONLY
 10370         GO TO 0560-EDIT-CONTINUE.
 10371
 10372     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 189
* EL050.cbl
 10373     MOVE ' '    TO WS-CTBL-READ-SW.
 10374
 10375
 10376 0530-GET-AH-COMP.
 10377     IF NO-AH-COVERAGE  OR
 10378        NO-AH-BENEFIT-MATCH
 10379           GO TO 0540-NEXT-READ-STEP.
 10380
 10381     IF AM-A-COM (SUB1) NUMERIC
 10382        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10383         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10384         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10385         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10386         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10387     ELSE
 10388          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10389          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10390          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10391          MOVE ZEROS             TO WS-SUB1
 10392                                    WS-COMMISSION
 10393          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10394          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10395          IF WS-COMMISSION > ZEROS
 10396             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10397             GO TO 0540-NEXT-READ-STEP
 10398          END-IF
 10399          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10400          IF CTBL-TABLE-FOUND
 10401             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10402                                        PB-I-AH-TERM
 10403             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10404             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10405             GO TO 0540-NEXT-READ-STEP
 10406          ELSE
 10407             IF FIRST-TIME-THROUGH
 10408                 GO TO 0530-GET-AH-COMP
 10409             ELSE
 10410                 MOVE ER-2609                TO WS-ERROR
 10411                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10412
 10413 0540-NEXT-READ-STEP.
 10414     MOVE '0540' TO CTBL-SW.
 10415     MOVE ' '    TO WS-CTBL-READ-SW.
 10416
 10417 0540-GET-LF-COMP.
 10418     IF NO-LIFE-COVERAGE  OR
 10419        NO-LF-BENEFIT-MATCH
 10420           GO TO 0560-EDIT-CONTINUE.
 10421
 10422     IF WS-LF-JOINT-INDICATOR = 'J'
 10423        IF AM-J-COM (SUB1) NUMERIC
 10424           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10425           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10426           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10427           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10428           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10429        ELSE
 10430           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 190
* EL050.cbl
 10431           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10432           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10433           MOVE ZEROS                TO WS-SUB1
 10434                                        WS-COMMISSION
 10435           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10436           IF WS-COMMISSION > ZEROS
 10437              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10438              GO TO 0560-EDIT-CONTINUE
 10439           END-IF
 10440           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10441           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10442           IF CTBL-TABLE-FOUND
 10443              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10444              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10445              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10446              GO TO 0560-EDIT-CONTINUE
 10447           ELSE
 10448              IF FIRST-TIME-THROUGH
 10449                  GO TO 0540-GET-LF-COMP
 10450              ELSE
 10451                  MOVE ER-2609                TO WS-ERROR
 10452                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10453                  GO TO 0560-EDIT-CONTINUE.
 10454
 10455     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10456        IF AM-L-COM (SUB1) NUMERIC
 10457           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10458           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10459           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10460           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10461           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10462        ELSE
 10463           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10464           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10465           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10466           MOVE ZEROS                TO WS-SUB1
 10467                                        WS-COMMISSION
 10468           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10469           IF WS-COMMISSION IS GREATER THAN ZEROS
 10470              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10471              GO TO 0560-EDIT-CONTINUE
 10472           END-IF
 10473           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10474           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10475           IF CTBL-TABLE-FOUND
 10476              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10477              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10478              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10479              GO TO 0560-EDIT-CONTINUE
 10480           ELSE
 10481              IF FIRST-TIME-THROUGH
 10482                  GO TO 0540-GET-LF-COMP
 10483              ELSE
 10484                  MOVE ER-2609                TO WS-ERROR
 10485                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10486
 10487*    GO TO 0560-EDIT-CONTINUE.
 10488
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 191
* EL050.cbl
 10489 0560-EDIT-CONTINUE.
 10490     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10491                                    WS-AH-PMF-COMM
 10492*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10493*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10494     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10495        (SUB1 > +10)
 10496        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10497           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10498           MOVE '0530'           TO CTBL-SW
 10499           MOVE ' '              TO WS-CTBL-READ-SW
 10500           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10501           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10502           MOVE '0540'           TO CTBL-SW
 10503           MOVE ' '              TO WS-CTBL-READ-SW
 10504           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10505        END-IF
 10506     END-PERFORM
 10507     GO TO 0564-EDIT-CONTINUE
 10508     .
 10509 0561-CHECK-AH.
 10510     IF (NO-AH-COVERAGE)
 10511        OR (NO-AH-BENEFIT-MATCH)
 10512        CONTINUE
 10513     ELSE
 10514        IF (AM-A-COM (SUB1) NUMERIC)
 10515           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10516           IF (AM-COM-TYP (SUB1) = 'A')
 10517              AND (WS-AH-PMF-COMM = ZEROS)
 10518              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10519           END-IF
 10520           CONTINUE
 10521        ELSE
 10522           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10523           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10524           MOVE PB-AH-OVERRIDE-L1
 10525                                 TO CTBL-BEN-TYPE
 10526           MOVE ZEROS            TO WS-SUB1
 10527                                    WS-COMMISSION
 10528           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10529           PERFORM 8300-READ-CTBL-TABLE
 10530                                 THRU 8300-EXIT
 10531           IF CTBL-TABLE-FOUND
 10532              IF (AM-COM-TYP (SUB1) = 'A')
 10533                 AND (WS-AH-PMF-COMM = ZEROS)
 10534                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10535                                        PB-I-AH-TERM
 10536                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10537                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10538              END-IF
 10539              CONTINUE
 10540           ELSE
 10541              IF FIRST-TIME-THROUGH
 10542                 GO TO 0561-CHECK-AH
 10543              ELSE
 10544                 MOVE ER-2609    TO WS-ERROR
 10545                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10546              END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 192
* EL050.cbl
 10547           END-IF
 10548        END-IF
 10549     END-IF
 10550     .
 10551 0561-EXIT.
 10552     EXIT.
 10553 0563-CHECK-LF.
 10554     IF (NO-LIFE-COVERAGE)
 10555        OR (NO-LF-BENEFIT-MATCH)
 10556        CONTINUE
 10557     ELSE
 10558        IF WS-LF-JOINT-INDICATOR = 'J'
 10559           IF AM-J-COM (SUB1) NUMERIC
 10560              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10561              IF (AM-COM-TYP (SUB1) = 'A')
 10562                 AND (WS-LF-PMF-COMM = ZEROS)
 10563                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10564              END-IF
 10565              CONTINUE
 10566           ELSE
 10567              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10568              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10569              MOVE PB-LIFE-OVERRIDE-L1
 10570                                 TO CTBL-BEN-TYPE
 10571              MOVE ZEROS         TO WS-SUB1
 10572                                    WS-COMMISSION
 10573              MOVE AM-J-COMA (SUB1)
 10574                                 TO CTBL-TABLE
 10575              PERFORM 8300-READ-CTBL-TABLE
 10576                                 THRU 8300-EXIT
 10577              IF CTBL-TABLE-FOUND
 10578                 IF (AM-COM-TYP (SUB1) = 'A')
 10579                    AND (WS-LF-PMF-COMM = ZEROS)
 10580                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10581                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10582                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10583                 END-IF
 10584                 CONTINUE
 10585              ELSE
 10586                 IF FIRST-TIME-THROUGH
 10587                    GO TO 0563-CHECK-LF
 10588                 ELSE
 10589                    MOVE ER-2609 TO WS-ERROR
 10590                    PERFORM 9900-ERROR-FORMAT
 10591                                 THRU 9900-EXIT
 10592*                   GO TO 0560-EDIT-CONTINUE
 10593                 END-IF
 10594              END-IF
 10595           END-IF
 10596        ELSE
 10597           IF AM-L-COM (SUB1) NUMERIC
 10598              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10599              IF (AM-COM-TYP (SUB1) = 'A')
 10600                 AND (WS-LF-PMF-COMM = ZEROS)
 10601                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10602              END-IF
 10603              CONTINUE
 10604           ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 193
* EL050.cbl
 10605              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10606              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10607              MOVE PB-LIFE-OVERRIDE-L1
 10608                                 TO CTBL-BEN-TYPE
 10609              MOVE ZEROS         TO WS-SUB1
 10610                                    WS-COMMISSION
 10611              MOVE AM-L-COMA (SUB1)
 10612                                 TO CTBL-TABLE
 10613              PERFORM 8300-READ-CTBL-TABLE
 10614                                 THRU 8300-EXIT
 10615              IF CTBL-TABLE-FOUND
 10616                 CONTINUE
 10617              ELSE
 10618                 IF FIRST-TIME-THROUGH
 10619                    GO TO 0563-CHECK-LF
 10620                 ELSE
 10621                    MOVE ER-2609 TO WS-ERROR
 10622                    PERFORM 9900-ERROR-FORMAT
 10623                                 THRU 9900-EXIT
 10624                 END-IF
 10625              END-IF
 10626           END-IF
 10627        END-IF
 10628     END-IF
 10629     .
 10630 0563-EXIT.
 10631     EXIT.
 10632 0564-EDIT-CONTINUE.
 10633
 10634     IF  PB-COMPANY-ID EQUAL 'DMD'
 10635         IF PB-I-NUM-BILLED EQUAL ZEROS
 10636            MOVE ER-8148       TO WS-ERROR
 10637            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10638
 10639*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10640*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10641*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10642*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10643*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10644*         IF NO-CONVERSION-ERROR
 10645*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10646*         ELSE
 10647*             IF PB-COMPANY-ID EQUAL 'HAN'
 10648*                 MOVE ZEROS     TO PB-I-AGE.
 10649     IF PB-I-BIRTHDAY > LOW-VALUES
 10650        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10651        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10652        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10653        PERFORM 8500-DATE-CONVERT
 10654                                 THRU 8500-EXIT
 10655        IF NO-CONVERSION-ERROR
 10656           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10657           IF PB-I-AGE > ZEROS
 10658              IF WS-WORK-AGE NOT = PB-I-AGE
 10659                 MOVE ER-9501    TO WS-ERROR
 10660                 PERFORM 9900-ERROR-FORMAT
 10661                                 THRU 9900-EXIT
 10662              END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 194
* EL050.cbl
 10663           ELSE
 10664              MOVE WS-WORK-AGE   TO PB-I-AGE
 10665           END-IF
 10666        END-IF
 10667     END-IF
 10668     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10669                                   WS-INS-AGE-SET
 10670     IF PB-I-AGE = ZEROS
 10671        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10672           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10673                                   WS-INS-AGE-SET
 10674           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10675
 10676     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10677                                   WS-AH-EDIT-AGE.
 10678
 10679     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10680        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10681        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10682        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10683        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10684        IF NO-CONVERSION-ERROR
 10685           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10686           IF PB-I-JOINT-AGE > 0
 10687              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10688                 MOVE ER-9503    TO WS-ERROR
 10689                 PERFORM 9900-ERROR-FORMAT
 10690                                 THRU 9900-EXIT
 10691              END-IF
 10692           ELSE
 10693              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10694           END-IF
 10695        ELSE
 10696           MOVE ZEROS            TO PB-I-JOINT-AGE
 10697        END-IF
 10698     END-IF
 10699     IF PB-I-JOINT-AGE NOT NUMERIC
 10700        MOVE ZERO               TO PB-I-JOINT-AGE.
 10701
 10702     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10703                                   WS-JNT-AGE-SET
 10704     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10705        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10706           (WS-AH-JOINT-INDICATOR = 'J')
 10707           IF PB-I-JOINT-AGE = ZEROS
 10708               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10709                                          WS-JNT-AGE-SET
 10710               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10711           END-IF
 10712        END-IF
 10713     END-IF
 10714
 10715     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10716     IF WS-LF-JOINT-INDICATOR = 'J'
 10717        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10718        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10719            IF  PB-I-JOINT-AGE = ZERO
 10720                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 195
* EL050.cbl
 10721                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10722            ELSE
 10723                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10724                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10725                    IF PB-COMPANY-ID NOT = 'LBL'
 10726                        MOVE ER-2685    TO WS-ERROR
 10727                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10728
 10729     IF WS-AH-JOINT-INDICATOR = 'J'
 10730        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10731            IF  PB-I-JOINT-AGE = ZERO
 10732                MOVE ER-2686       TO WS-ERROR
 10733                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10734            ELSE
 10735                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10736                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10737                                           WS-EDIT-AGE
 10738                    IF PB-COMPANY-ID NOT = 'LBL'
 10739                        MOVE ER-2685    TO WS-ERROR
 10740                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10741
 10742******************************************************************
 10743*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10744******************************************************************
 10745
 10746     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10747        (WS-AH-SPECIAL-CALC-CD = 'O')
 10748        NEXT SENTENCE
 10749     ELSE
 10750        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10751          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10752           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10753            WS-AH-JOINT-INDICATOR = 'J')  AND
 10754           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10755            MOVE ER-2627             TO WS-ERROR
 10756            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10757
 10758     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10759        (WS-AH-SPECIAL-CALC-CD = 'O')
 10760         NEXT SENTENCE
 10761     ELSE
 10762         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10763            WS-AH-JOINT-INDICATOR = 'J'
 10764             IF PB-I-JOINT-INSURED = SPACES
 10765                 IF PB-COMPANY-ID NOT = 'JAL'
 10766                     MOVE ER-2696    TO WS-ERROR
 10767                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10768
 10769     IF PB-COMPANY-ID NOT = 'BOA'
 10770        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10771           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10772           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10773               PB-I-JOINT-INSURED NOT = SPACES)
 10774                MOVE ER-2691         TO WS-ERROR
 10775                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10776
 10777     IF PB-COMPANY-ID = 'BOA'
 10778        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 196
* EL050.cbl
 10779           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10780            IF PB-I-JOINT-AGE NOT = ZEROS
 10781                MOVE ER-2691         TO WS-ERROR
 10782                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10783
 10784     IF PB-COMPANY-ID = 'CRI'
 10785        IF PB-I-SIG-SW = 'J'
 10786           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10787              WS-AH-JOINT-INDICATOR NOT = 'J'
 10788              MOVE ER-2675       TO WS-ERROR
 10789              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10790
 10791     IF PB-COMPANY-ID = 'CRI'
 10792        IF PB-I-SIG-SW = 'S'
 10793           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10794              WS-AH-JOINT-INDICATOR = 'J'
 10795              MOVE ER-2676       TO WS-ERROR
 10796              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10797
 10798     IF PB-COMPANY-ID = 'CVL'
 10799         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10800            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10801              MOVE ER-2783           TO WS-ERROR
 10802              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10803     IF (WS-LF-JOINT-INDICATOR = 'J')
 10804        AND (WS-AH-JOINT-INDICATOR = 'J')
 10805        AND (PB-I-LF-TERM > 120)
 10806        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10807        MOVE ER-2783             TO WS-ERROR
 10808        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10809     END-IF
 10810     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10811
 10812     IF PB-I-INDV-GRP-OVRD = 'I'
 10813        MOVE ER-2666             TO WS-ERROR
 10814        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10815        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10816
 10817     IF PB-I-INDV-GRP-OVRD = 'G'
 10818        MOVE ER-2666             TO WS-ERROR
 10819        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10820        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10821
 10822     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10823        NEXT SENTENCE
 10824     ELSE
 10825        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10826
 10827     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10828        IF WS-ERROR = ER-2666
 10829           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10830           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10831
 10832     IF PB-COMPANY-ID = 'CID'
 10833        IF PB-STATE = 'UT' OR 'MO'
 10834           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10835                 OR '76' OR '77')
 10836                      OR
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 197
* EL050.cbl
 10837               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10838                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10839                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10840                   OR '2K' OR '2L'))
 10841              AND PB-I-INDV-GRP-CD = 'I'
 10842              MOVE ER-2721             TO WS-ERROR
 10843              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10844           END-IF
 10845        END-IF
 10846     END-IF
 10847
 10848     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10849     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10850        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10851     ELSE
 10852        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10853     END-IF
 10854
 10855*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10856*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10857     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10858                                    ACCOUNT-AH-CK-SW.
 10859
 10860     IF PB-REISSUED-CERT       OR
 10861        PB-REIN-ONLY-CERT      OR
 10862        PB-POLICY-IS-DECLINED  OR
 10863        PB-POLICY-IS-VOIDED
 10864*       OR PB-MONTHLY-CERT
 10865         GO TO 3000-CONTINUE-EDIT.
 10866
 10867     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10868        IF WS-EDIT-AGE           > +65
 10869           MOVE ER-2709          TO WS-ERROR
 10870           PERFORM 9900-ERROR-FORMAT
 10871                                 THRU 9900-EXIT
 10872        ELSE
 10873           IF WS-EDIT-AGE        > +55
 10874              MOVE ER-2718       TO WS-ERROR
 10875              PERFORM 9900-ERROR-FORMAT
 10876                                 THRU 9900-EXIT
 10877           END-IF
 10878        END-IF
 10879     IF PB-COMPANY-ID = 'DCC'
 10880        IF WS-EDIT-AGE           > +65
 10881           MOVE ER-2709          TO WS-ERROR
 10882           PERFORM 9900-ERROR-FORMAT
 10883                                 THRU 9900-EXIT
 10884        END-IF
 10885     END-IF
 10886     .
 10887
 10888 0565-LIFE-PLAN-LIMIT-EDITS.
 10889
 10890     IF NOT LF-PLAN-MASTER-FOUND
 10891        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10892                                    EC-AM-LF-MAX-TOT-BEN
 10893        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10894
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 198
* EL050.cbl
 10895     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10896
 10897     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10898         IF PL-LM-AGE (1) = ZEROS
 10899             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10900
 10901     IF NO-LF-BENEFIT-MATCH          OR
 10902        WS-LF-BENEFIT-CD = ZEROS     OR
 10903        WS-LF-SPECIAL-CALC-CD = 'M'
 10904        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10905
 10906     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10907     MOVE +1                     TO SUB2.
 10908
 10909     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10910        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10911           MOVE +5   TO SUB2
 10912           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10913              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10914              (PL-LM-AGE (SUB2) EQUAL +0)
 10915              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10916              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10917
 10918     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10919
 10920     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10921                               + PB-I-LF-ALT-BENEFIT-AMT.
 10922
 10923 0568-CHECK-LIFE-ATT-AGE.
 10924
 10925     IF PL-ATT-AGE NUMERIC AND
 10926        PL-ATT-AGE > +0
 10927        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10928     END-IF
 10929*    IF PL-ATT-AGE NUMERIC AND
 10930*       PL-ATT-AGE > +0
 10931*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10932*       IF PB-I-BIRTHDAY > LOW-VALUES
 10933*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10934*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10935*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10936*          SET BIN-PLUS-ELAPSED  TO TRUE
 10937*          PERFORM 8500-DATE-CONVERT
 10938*                                THRU 8500-EXIT
 10939*          IF NO-CONVERSION-ERROR
 10940*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10941*             MOVE ER-2669       TO WS-ERROR
 10942*             PERFORM 9900-ERROR-FORMAT
 10943*                                THRU 9900-EXIT
 10944*          END-IF
 10945*       ELSE
 10946*          IF WS-ATT-AGE >= PL-ATT-AGE
 10947*             MOVE ER-2669       TO WS-ERROR
 10948*             PERFORM 9900-ERROR-FORMAT
 10949*                                THRU 9900-EXIT
 10950*          END-IF
 10951*       END-IF
 10952*    END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 199
* EL050.cbl
 10953     .
 10954 0570-CHECK-LIFE-LIMITS.
 10955
 10956     IF PB-COMPANY-ID EQUAL 'CRI'
 10957        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10958           IF SUB2 GREATER THAN +4
 10959              MOVE ER-2637 TO WS-ERROR
 10960              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10961              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10962
 10963     IF PB-COMPANY-ID  =  'NCL'
 10964        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10965            SUB2 GREATER THAN +8
 10966             MOVE 'U'         TO PB-BATCH-ENTRY
 10967             MOVE ER-2637     TO WS-ERROR
 10968             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10969             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10970
 10971     IF SUB2 > +8
 10972        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10973           AND (PB-I-SIG-SW = 'Y')
 10974           CONTINUE
 10975        ELSE
 10976           MOVE ER-2637          TO WS-ERROR
 10977           PERFORM 9900-ERROR-FORMAT
 10978                                 THRU 9900-EXIT
 10979        END-IF
 10980        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10981     END-IF
 10982     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10983     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10984     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10985
 10986     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10987        ADD +1  TO SUB2
 10988        GO TO 0570-CHECK-LIFE-LIMITS.
 10989
 10990     IF PB-COMPANY-ID = 'NCL'
 10991         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10992
 10993     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10994        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10995        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10996           AND (PB-I-SIG-SW = 'Y')
 10997           CONTINUE
 10998        ELSE
 10999           MOVE ER-2637          TO WS-ERROR
 11000           PERFORM 9900-ERROR-FORMAT
 11001                                 THRU 9900-EXIT
 11002        END-IF
 11003     END-IF
 11004     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11005
 11006
 11007 0570-CHECK-NCL-LIFE-LIMITS.
 11008
 11009     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11010        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 200
* EL050.cbl
 11011         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11012
 11013     IF APP-CERT-USED
 11014         IF SUB2  LESS THAN  +5
 11015             MOVE +5          TO SUB2
 11016             GO TO 0570-CHECK-LIFE-LIMITS.
 11017
 11018     MOVE ER-2637             TO WS-ERROR.
 11019     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11020
 11021     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11022
 11023 0575-CHECK-NCL-SIG-SWITCH.
 11024
 11025     IF NOT APP-CERT-USED
 11026         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11027
 11028     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11029        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11030        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11031        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11032         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11033
 11034     IF SUB2 GREATER THAN +4
 11035         IF PL-LM-AGE (5) = ZEROS  AND
 11036            PL-LM-AGE (6) = ZEROS  AND
 11037            PL-LM-AGE (7) = ZEROS  AND
 11038            PL-LM-AGE (8) = ZEROS
 11039             MOVE  ER-1927        TO WS-ERROR
 11040             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11041             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11042         ELSE
 11043             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11044                 MOVE  ER-1920    TO WS-ERROR
 11045                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11046
 11047     IF PB-I-SIG-SW  = 'Y'
 11048       IF NOT PB-I-POLICY-ACCEPTED  AND
 11049          NOT PB-I-POLICY-DECLINED
 11050           MOVE 'U'               TO PB-BATCH-ENTRY
 11051           MOVE  ER-1926          TO WS-ERROR
 11052           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11053
 11054
 11055 0580-AH-PLAN-LIMIT-EDITS.
 11056
 11057     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11058        IF PB-I-AH-BENEFIT-AMT > +1250
 11059           MOVE ER-2702          TO WS-ERROR
 11060           PERFORM 9900-ERROR-FORMAT
 11061                                 THRU 9900-EXIT
 11062        END-IF
 11063     END-IF
 11064
 11065     IF (PB-COMPANY-ID = 'DCC')
 11066        AND (PB-MONTHLY-CERT)
 11067        IF PB-I-AH-BENEFIT-AMT > +3000
 11068           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 201
* EL050.cbl
 11069           PERFORM 9900-ERROR-FORMAT
 11070                                 THRU 9900-EXIT
 11071        END-IF
 11072     END-IF
 11073     IF NOT AH-PLAN-MASTER-FOUND
 11074        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11075        GO TO 3000-CONTINUE-EDIT.
 11076
 11077     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11078
 11079     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11080         IF PL-LM-AGE (1) = ZEROS
 11081             GO TO 3000-CONTINUE-EDIT.
 11082
 11083     IF NO-AH-BENEFIT-MATCH          OR
 11084        WS-AH-BENEFIT-CD = ZEROS     OR
 11085        WS-AH-SPECIAL-CALC-CD = 'M'
 11086        GO TO 3000-CONTINUE-EDIT.
 11087
 11088     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11089     MOVE +1                     TO SUB2.
 11090
 11091     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11092        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11093           MOVE +5 TO SUB2
 11094           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11095              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11096              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11097              (PL-LM-AGE (SUB2) EQUAL +0)
 11098              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11099              GO TO 3000-CONTINUE-EDIT.
 11100
 11101     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11102
 11103 0590-CHECK-AH-ATT-AGE.
 11104
 11105     IF PL-ATT-AGE NUMERIC AND
 11106        PL-ATT-AGE GREATER THAN +0
 11107        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11108     END-IF
 11109*       IF WS-ATT-AGE >= PL-ATT-AGE
 11110*          MOVE ER-3054          TO WS-ERROR
 11111*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11112     .
 11113 0597-CHECK-AH-LIMITS.
 11114
 11115     IF PB-COMPANY-ID EQUAL 'CRI'
 11116        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11117           IF SUB2 GREATER THAN +4
 11118              MOVE ER-2638       TO WS-ERROR
 11119              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11120              GO TO 3000-CONTINUE-EDIT.
 11121
 11122     IF PB-COMPANY-ID  =  'NCL'
 11123        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11124            SUB2 GREATER THAN +8
 11125             MOVE 'U'            TO PB-BATCH-ENTRY
 11126             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 202
* EL050.cbl
 11127             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11128             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11129
 11130     IF SUB2 > +8
 11131        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11132           AND (PB-I-SIG-SW = 'Y')
 11133           CONTINUE
 11134        ELSE
 11135           MOVE ER-2638          TO WS-ERROR
 11136           PERFORM 9900-ERROR-FORMAT
 11137                                 THRU 9900-EXIT
 11138        END-IF
 11139        GO TO 3000-CONTINUE-EDIT
 11140     END-IF
 11141
 11142     IF PB-COMPANY-ID = 'CRI'
 11143        IF WS-ERROR = ER-2638
 11144           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11145
 11146     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11147     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11148     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11149     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11150
 11151     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11152        ADD +1                   TO SUB2
 11153        GO TO 0597-CHECK-AH-LIMITS.
 11154
 11155     IF PB-COMPANY-ID = 'NCL'
 11156         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11157
 11158     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11159        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11160        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11161                                 > PL-LM-AMT (SUB2))
 11162        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11163           AND (PB-I-SIG-SW = 'Y')
 11164           CONTINUE
 11165        ELSE
 11166           MOVE ER-2638          TO WS-ERROR
 11167           PERFORM 9900-ERROR-FORMAT
 11168                                 THRU 9900-EXIT
 11169        END-IF
 11170     END-IF
 11171
 11172     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11173         IF  WS-ERROR    EQUAL    ER-2638
 11174             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11175                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11176                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11177                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11178                MOVE  ER-1910    TO  WS-ERROR
 11179                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11180
 11181     IF PB-COMPANY-ID = 'CRI'
 11182        IF WS-ERROR = ER-2638
 11183            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11184            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 203
* EL050.cbl
 11185            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11186
 11187     GO TO 3000-CONTINUE-EDIT.
 11188
 11189 0597-CHECK-NCL-AH-LIMITS.
 11190
 11191     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11192        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11193        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11194                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11195         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11196
 11197     IF APP-CERT-USED
 11198         IF SUB2  LESS THAN  +5
 11199             MOVE +5             TO SUB2
 11200             GO TO 0597-CHECK-AH-LIMITS.
 11201
 11202     MOVE ER-2638                TO WS-ERROR.
 11203     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11204
 11205     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11206
 11207 0599-CHECK-NCL-SIG-SWITCH.
 11208
 11209     IF NOT APP-CERT-USED
 11210         GO TO 3000-CONTINUE-EDIT.
 11211
 11212     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11213        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11214        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11215        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11216         GO TO 3000-CONTINUE-EDIT.
 11217
 11218     IF SUB2 GREATER THAN +4
 11219         IF PL-LM-AGE (5) = ZEROS  AND
 11220            PL-LM-AGE (6) = ZEROS  AND
 11221            PL-LM-AGE (7) = ZEROS  AND
 11222            PL-LM-AGE (8) = ZEROS
 11223             MOVE  ER-1927        TO WS-ERROR
 11224             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11225             GO TO 3000-CONTINUE-EDIT
 11226         ELSE
 11227             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11228                 MOVE  ER-1920    TO WS-ERROR
 11229                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11230
 11231     IF PB-I-SIG-SW  = 'Y'
 11232       IF NOT PB-I-POLICY-ACCEPTED  AND
 11233          NOT PB-I-POLICY-DECLINED
 11234           MOVE 'U'               TO PB-BATCH-ENTRY
 11235           MOVE  ER-1926          TO WS-ERROR
 11236           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11237
 11238******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 204
* EL050.cbl
 11240
 11241 3000-CONTINUE-EDIT.
 11242
 11243     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11244     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11245     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11246     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11247     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11248
 11249     IF BROWSE-STARTED
 11250        PERFORM 9990-RETURN THRU 9990-EXIT
 11251        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11252
 11253     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11254        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11255        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11256        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11257*       MOVE 1                   TO DC-OPTION-CODE
 11258        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11259        IF DATE-CONVERSION-ERROR
 11260           MOVE ER-2622          TO WS-ERROR
 11261           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11262        ELSE
 11263           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11264              MOVE ER-2623       TO WS-ERROR
 11265              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11266           ELSE
 11267              MOVE ER-2622       TO WS-ERROR
 11268              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11269
 11270     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11271     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11272     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11273*    MOVE 1                      TO DC-OPTION-CODE.
 11274     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11275     IF DATE-CONVERSION-ERROR
 11276        GO TO 3005-EDIT-CONTINUE
 11277     ELSE
 11278        IF DC-ELAPSED-DAYS GREATER +180
 11279           MOVE ER-2613          TO WS-ERROR
 11280           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11281        ELSE
 11282           IF DC-ELAPSED-DAYS GREATER +90
 11283              MOVE ER-2612       TO WS-ERROR
 11284              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11285           ELSE
 11286             IF DC-ELAPSED-DAYS GREATER +60
 11287                MOVE ER-2614     TO WS-ERROR
 11288                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11289
 11290 3005-EDIT-CONTINUE.
 11291
 11292     IF PB-CANCELLATION
 11293         GO TO 3700-EDIT-CANCEL.
 11294
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 205
* EL050.cbl
 11296******************************************************************
 11297*                  E D I T   I S S U E                           *
 11298******************************************************************
 11299
 11300 3020-EDIT-ISSUE.
 11301
 11302      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11303      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11304      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11305      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11306      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11307
 11308     IF PB-ISSUE-FORCE
 11309        OR PB-ISSUE-DATE-FORCED
 11310        OR PB-FORCE-OFF
 11311        OR PB-OVERCHARGE-FORCE
 11312        CONTINUE
 11313     ELSE
 11314        MOVE ER-2670             TO WS-ERROR
 11315        PERFORM 9900-ERROR-FORMAT
 11316                                 THRU 9900-EXIT
 11317     END-IF
 11318     .
 11319 3022-SET-POLICY-STATUS.
 11320
 11321     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11322
 11323     IF (PB-REISSUED-CERT)
 11324             OR
 11325        ((PB-COMPANY-ID NOT = 'DCC')
 11326         AND (PB-MONTHLY-CERT))
 11327         MOVE '5'                TO PB-I-ENTRY-STATUS
 11328         MOVE 'E'                TO PB-BATCH-ENTRY
 11329     END-IF
 11330
 11331     IF PB-COMPANY-ID = 'DCC'
 11332        IF PB-MONTHLY-CERT
 11333           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11334        END-IF
 11335        IF PB-CASH-CERT
 11336           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11337        END-IF
 11338     END-IF
 11339     IF PB-POLICY-IS-DECLINED
 11340         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11341     IF PB-POLICY-IS-VOIDED
 11342         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11343     IF PB-NEEDS-UNDERWRITING
 11344         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11345     IF PB-REIN-ONLY-CERT
 11346         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11347     IF PB-PREM-ACCTNG-ONLY
 11348         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11349
 11350     MOVE SPACE                  TO PB-I-OB-FLAG.
 11351
 11352     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11353         MOVE ER-2665            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 206
* EL050.cbl
 11354         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11355         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11356
 11357     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11358        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11359           MOVE 'Z'             TO PB-I-OB-FLAG.
 11360
 11361     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11362        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11363           MOVE 'Z'             TO PB-I-OB-FLAG.
 11364
 11365     IF ACCOUNT-MAST-FOUND
 11366         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11367         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11368         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11369         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11370         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11371         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11372         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11373     END-IF
 11374
 11375     IF ACCOUNT-MAST-FOUND
 11376        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11377         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11378
 11379     IF (ACCOUNT-MAST-FOUND)
 11380        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11381        IF PB-REISSUED-CERT
 11382           CONTINUE
 11383        ELSE
 11384           MOVE ER-2608          TO WS-ERROR
 11385           PERFORM 9900-ERROR-FORMAT
 11386                                 THRU 9900-EXIT
 11387         END-IF
 11388     END-IF
 11389
 11390     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11391        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11392        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11393
 11394**********   DMD CUSTOM CODE FOLLOWS  **********
 11395 3024-EDIT-DMD-FIELDS.
 11396     IF PB-COMPANY-ID NOT = 'DMD'
 11397        GO TO 3025-EDIT-REINSURANCE.
 11398
 11399*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11400*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11401*** ERROR IF THEY ARE NOT EQUAL.
 11402
 11403     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11404     SET BIN-TO-GREG               TO TRUE.
 11405     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11406     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11407**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11408
 11409     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11410     SET BIN-TO-GREG               TO TRUE.
 11411     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 207
* EL050.cbl
 11412     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11413**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11414
 11415     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11416        MOVE ER-8116               TO WS-ERROR
 11417        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11418
 11419     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11420
 11421     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11422                                      WK-FULL-CERT-NO.
 11423     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11424
 11425     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11426
 11427     IF PB-VALID-LIFE
 11428        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11429     ELSE
 11430        IF PB-VALID-AH
 11431          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11432
 11433
 11434     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11435     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11436     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11437                                      DCUA-UNDRWRTR-CODE
 11438                                      DCUA-UNDRWRTR-GROUP-CODE
 11439                                      DCUA-RETURN-CODE.
 11440
 11441****************************************************************
 11442*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11443***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11444***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11445***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11446***   TO THIS RECORD.                                        ***
 11447****************************************************************
 11448     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11449     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11450     IF DCUA-SUCCESSFUL-PROCESS
 11451        GO TO 3024-EDIT-DL7-CONT.
 11452
 11453     IF DCUA-RETURN-CODE EQUAL '01'
 11454        MOVE ER-8110               TO WS-ERROR
 11455        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11457        GO TO 3024-EDIT-DL7-CONT.
 11458
 11459     IF DCUA-RETURN-CODE EQUAL '02'
 11460        MOVE ER-8111               TO WS-ERROR
 11461        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11462        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11463        GO TO 3024-EDIT-DL7-CONT.
 11464
 11465     IF DCUA-RETURN-CODE EQUAL '03'
 11466        MOVE ER-8074               TO WS-ERROR
 11467        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11468        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11469        GO TO 3024-EDIT-DL7-CONT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 208
* EL050.cbl
 11470
 11471     IF DCUA-RETURN-CODE EQUAL '04'
 11472        MOVE ER-8075               TO WS-ERROR
 11473        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11474        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11475        GO TO 3024-EDIT-DL7-CONT.
 11476
 11477     IF DCUA-RETURN-CODE EQUAL '05'
 11478        MOVE ER-8076               TO WS-ERROR
 11479        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11480        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11481        GO TO 3024-EDIT-DL7-CONT.
 11482
 11483     IF DCUA-RETURN-CODE EQUAL '06'
 11484        MOVE ER-8077               TO WS-ERROR
 11485        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11486        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11487        GO TO 3024-EDIT-DL7-CONT.
 11488
 11489     IF DCUA-RETURN-CODE EQUAL '07'
 11490        MOVE ER-8078               TO WS-ERROR
 11491        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11492        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11493        GO TO 3024-EDIT-DL7-CONT.
 11494
 11495     IF DCUA-RETURN-CODE EQUAL 'E1'
 11496        MOVE ER-8079               TO WS-ERROR
 11497        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11498        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11499        GO TO 3024-EDIT-DL7-CONT.
 11500
 11501     IF DCUA-RETURN-CODE EQUAL 'E2'
 11502        MOVE ER-8080               TO WS-ERROR
 11503        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11504        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11505        GO TO 3024-EDIT-DL7-CONT.
 11506
 11507     IF DCUA-RETURN-CODE EQUAL 'E3'
 11508        MOVE ER-8098               TO WS-ERROR
 11509        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11510        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11511        GO TO 3024-EDIT-DL7-CONT.
 11512
 11513     IF DCUA-RETURN-CODE EQUAL 'C1'
 11514        MOVE ER-8099               TO WS-ERROR
 11515        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11517        GO TO 3024-EDIT-DL7-CONT.
 11518
 11519     IF DCUA-RETURN-CODE EQUAL 'U1'
 11520        MOVE ER-8109               TO WS-ERROR
 11521        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11522        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11523        GO TO 3024-EDIT-DL7-CONT.
 11524
 11525     IF DCUA-RETURN-CODE EQUAL 'N1'
 11526        MOVE ER-8112               TO WS-ERROR
 11527        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 209
* EL050.cbl
 11528        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11529        GO TO 3024-EDIT-DL7-CONT.
 11530
 11531     IF DCUA-RETURN-CODE EQUAL 'N2'
 11532        MOVE ER-8113               TO WS-ERROR
 11533        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11534        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11535        GO TO 3024-EDIT-DL7-CONT.
 11536
 11537     IF DCUA-RETURN-CODE EQUAL 'N3'
 11538        MOVE ER-8114               TO WS-ERROR
 11539        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11540        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11541        GO TO 3024-EDIT-DL7-CONT.
 11542
 11543     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11544     MOVE ER-8097                  TO WS-ERROR.
 11545     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11546     GO TO 3024-EDIT-DL7-CONT.
 11547
 11548 3024-EDIT-DL7-CONT.
 11549
 11550     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11551     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11552     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11553        NEXT SENTENCE
 11554     ELSE
 11555        MOVE ER-9263               TO WS-ERROR
 11556        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11557
 11558******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11559******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11560     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11561        NEXT SENTENCE
 11562     ELSE
 11563        MOVE ER-8039               TO WS-ERROR
 11564        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11565
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 210
* EL050.cbl
 11567****************************************************************
 11568*** VALIDATE STATE  : DLO022                                 ***
 11569****************************************************************
 11570     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11571     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11572
 11573     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11574     IF DVSC-SUCCESSFUL-EDIT
 11575        GO TO 3024-EDIT-DL22-CONT.
 11576
 11577     IF DVSC-RETURN-CODE EQUAL '01'
 11578        MOVE ER-8300               TO WS-ERROR
 11579        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11580        GO TO 3024-EDIT-DL22-CONT.
 11581
 11582     IF DVSC-RETURN-CODE EQUAL '02'
 11583        MOVE ER-8301               TO WS-ERROR
 11584        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11585        GO TO 3024-EDIT-DL22-CONT.
 11586
 11587     IF DVSC-RETURN-CODE EQUAL '03'
 11588        MOVE ER-8302               TO WS-ERROR
 11589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11590        GO TO 3024-EDIT-DL22-CONT.
 11591
 11592     IF DVSC-RETURN-CODE EQUAL 'N1'
 11593        MOVE ER-8304               TO WS-ERROR
 11594        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11595        GO TO 3024-EDIT-DL22-CONT.
 11596
 11597     MOVE ER-8303                  TO WS-ERROR
 11598     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11599
 11600 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 211
* EL050.cbl
 11602****************************************************************
 11603*** VALIDATE LOAN OFFICER : DLO021                           ***
 11604****************************************************************
 11605
 11606     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11607     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11608     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11609     IF DVLO-SUCCESSFUL-EDIT
 11610        GO TO 3024-EDIT-DL21-CONT.
 11611
 11612     IF DVLO-RETURN-CODE EQUAL '01'
 11613        MOVE ER-8081               TO WS-ERROR
 11614        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11615        GO TO 3024-EDIT-DL21-CONT.
 11616
 11617     IF DVLO-RETURN-CODE EQUAL '02'
 11618        MOVE ER-8082               TO WS-ERROR
 11619        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11620        GO TO 3024-EDIT-DL21-CONT.
 11621
 11622     IF DVLO-RETURN-CODE EQUAL '03'
 11623        MOVE ER-8083               TO WS-ERROR
 11624        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11625        GO TO 3024-EDIT-DL21-CONT.
 11626
 11627     IF DVLO-RETURN-CODE EQUAL '04'
 11628        MOVE ER-8084               TO WS-ERROR
 11629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11630        GO TO 3024-EDIT-DL21-CONT.
 11631
 11632     IF DVLO-RETURN-CODE EQUAL '05'
 11633        MOVE ER-8085               TO WS-ERROR
 11634        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11635        GO TO 3024-EDIT-DL21-CONT.
 11636
 11637     MOVE ER-7825                  TO WS-ERROR
 11638     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11639     GO TO 3024-EDIT-DL21-CONT.
 11640
 11641 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 212
* EL050.cbl
 11643
 11644****************************************************************
 11645*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11646****************************************************************
 11647
 11648     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11649     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11650     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11651     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11652     IF DIPF-SUCCESSFUL-EDIT
 11653        GO TO 3024-EDIT-DL02-CONT.
 11654
 11655     IF DIPF-RETURN-CODE EQUAL '01'
 11656        MOVE ER-8086               TO WS-ERROR
 11657        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11658        GO TO 3024-EDIT-DL02-CONT.
 11659
 11660     IF DIPF-RETURN-CODE EQUAL '02'
 11661        MOVE ER-8087               TO WS-ERROR
 11662        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11663        GO TO 3024-EDIT-DL02-CONT.
 11664
 11665     IF DIPF-RETURN-CODE EQUAL '03'
 11666        MOVE ER-8088               TO WS-ERROR
 11667        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11668        GO TO 3024-EDIT-DL02-CONT.
 11669
 11670     MOVE ER-8095                  TO WS-ERROR
 11671     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11672     GO TO 3024-EDIT-DL02-CONT.
 11673
 11674 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 213
* EL050.cbl
 11676
 11677****************************************************************
 11678*** VALIDATE BANK ID : DLO003                                ***
 11679****************************************************************
 11680
 11681     MOVE WK-GREG-CENT           TO WCG-CENT.
 11682     MOVE WK-GREG-YYMM           TO WCG-REST.
 11683     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11684        MOVE ER-8040               TO WS-ERROR
 11685        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11686
 11687     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11688     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11689     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11690     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11691     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11692     IF DVBI-SUCCESSFUL-EDIT
 11693        GO TO 3024-EDIT-DL03-CONT.
 11694
 11695     IF DVBI-RETURN-CODE EQUAL '01'
 11696        MOVE ER-8089               TO WS-ERROR
 11697        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11698        GO TO 3024-EDIT-DL03-CONT.
 11699
 11700     IF DVBI-RETURN-CODE EQUAL '02'
 11701        MOVE ER-8090               TO WS-ERROR
 11702        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11703        GO TO 3024-EDIT-DL03-CONT.
 11704
 11705     IF DVBI-RETURN-CODE EQUAL '03'
 11706        MOVE ER-8091               TO WS-ERROR
 11707        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11708        GO TO 3024-EDIT-DL03-CONT.
 11709
 11710     IF DVBI-RETURN-CODE EQUAL '04'
 11711        MOVE ER-8092               TO WS-ERROR
 11712        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11713        GO TO 3024-EDIT-DL03-CONT.
 11714
 11715     IF DVBI-RETURN-CODE EQUAL '05'
 11716        MOVE ER-8093               TO WS-ERROR
 11717        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11718        GO TO 3024-EDIT-DL03-CONT.
 11719
 11720     IF DVBI-RETURN-CODE EQUAL '06'
 11721        MOVE ER-8094               TO WS-ERROR
 11722        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11723        GO TO 3024-EDIT-DL03-CONT.
 11724
 11725     MOVE ER-8096                  TO WS-ERROR
 11726     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11727     GO TO 3024-EDIT-DL03-CONT.
 11728
 11729 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 214
* EL050.cbl
 11731
 11732     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11733        NEXT SENTENCE
 11734     ELSE
 11735        MOVE ER-8042               TO WS-ERROR
 11736        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11737
 11738     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11739     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11740     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11741
 11742     IF DMPF-RETURN-CODE = '01'
 11743        MOVE ER-8067               TO WS-ERROR
 11744        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11745        GO TO 3024-EDIT-DL01-CONT.
 11746
 11747     IF DMPF-RETURN-CODE = '02'
 11748        MOVE ER-8068               TO WS-ERROR
 11749        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11750        GO TO 3024-EDIT-DL01-CONT.
 11751
 11752     IF DMPF-RETURN-CODE = '03'
 11753        MOVE ER-8069               TO WS-ERROR
 11754        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11755        GO TO 3024-EDIT-DL01-CONT.
 11756
 11757     IF DMPF-RETURN-CODE = 'E1'
 11758        MOVE ER-8070               TO WS-ERROR
 11759        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11760        GO TO 3024-EDIT-DL01-CONT.
 11761
 11762     IF DMPF-RETURN-CODE = 'N1'
 11763        MOVE ER-8071               TO WS-ERROR
 11764        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11765        GO TO 3024-EDIT-DL01-CONT.
 11766
 11767     IF DMPF-RETURN-CODE NOT = 'OK'
 11768        MOVE ER-8072               TO WS-ERROR
 11769        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11770
 11771 3024-EDIT-DL01-CONT.
 11772******************************************************************
 11773***  VALIDATES RATE CODES : DLO017                             ***
 11774******************************************************************
 11775
 11776      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11777      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11778      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11779      IF DVRC-SUCCESSFUL-EDIT
 11780        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11781        GO TO 3024-CHECK-VALID-RATE.
 11782
 11783      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11784
 11785      IF DVRC-RETURN-CODE EQUAL '01'
 11786         MOVE ER-7817                   TO WS-ERROR
 11787         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11788         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 215
* EL050.cbl
 11789
 11790      IF DVRC-RETURN-CODE EQUAL '02'
 11791         MOVE ER-7818                   TO WS-ERROR
 11792         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11793         GO TO 3025-EDIT-REINSURANCE.
 11794
 11795      IF DVRC-RETURN-CODE EQUAL '03'
 11796         MOVE ER-7819                   TO WS-ERROR
 11797         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11798         GO TO 3025-EDIT-REINSURANCE.
 11799
 11800       MOVE ER-7820                     TO WS-ERROR.
 11801       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11802       GO TO 3025-EDIT-REINSURANCE.
 11803
 11804******************************************************************
 11805***  GET PREMIUM RATES : DLO011                                ***
 11806******************************************************************
 11807
 11808 3024-CHECK-VALID-RATE.
 11809
 11810     IF VALID-RATE-CODE
 11811        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11812        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11813        MOVE SPACES                TO DPRB-RETURN-CODE
 11814        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11815     ELSE
 11816         GO TO 3025-EDIT-REINSURANCE.
 11817
 11818      IF DPRB-SUCCESSFUL-PROCESS
 11819         IF PB-VALID-LIFE
 11820             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11821             GO TO 3025-EDIT-REINSURANCE
 11822         ELSE
 11823             IF PB-VALID-AH
 11824                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11825                 GO TO 3025-EDIT-REINSURANCE.
 11826
 11827      IF DPRB-RETURN-CODE EQUAL '01'
 11828         MOVE ER-7812                   TO WS-ERROR
 11829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11830         GO TO 3025-EDIT-REINSURANCE.
 11831
 11832      IF DPRB-RETURN-CODE EQUAL '02'
 11833         MOVE ER-7813                   TO WS-ERROR
 11834         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11835         GO TO 3025-EDIT-REINSURANCE.
 11836
 11837      IF DPRB-RETURN-CODE EQUAL '03'
 11838         MOVE ER-7814                   TO WS-ERROR
 11839         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11840         GO TO 3025-EDIT-REINSURANCE.
 11841
 11842      IF DPRB-RETURN-CODE EQUAL '04'
 11843         IF NOT DPRB-1ST-TIME
 11844            MOVE ER-7815                   TO WS-ERROR
 11845            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11846            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 216
* EL050.cbl
 11847          ELSE
 11848         IF PB-VALID-LIFE
 11849            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11850          ELSE
 11851            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11852         END-IF
 11853         MOVE SPACES                TO DOCC-RETURN-CODE
 11854         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11855         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11856         IF DOCC-RETURN-CODE = 'OK'
 11857             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11858             GO TO 3024-CHECK-VALID-RATE
 11859           ELSE
 11860             MOVE ER-7823               TO WS-ERROR
 11861             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11862             GO TO 3025-EDIT-REINSURANCE.
 11863
 11864       MOVE ER-7816                     TO WS-ERROR.
 11865       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11866       GO TO 3025-EDIT-REINSURANCE.
 11867
 11868**********   DMD CUSTOM CODE ABOVE    **********
 11869
 11870 3025-EDIT-REINSURANCE.
 11871     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11872         GO TO 3027-EDIT-CONTINUE.
 11873
 11874     MOVE LOW-VALUES               TO ERREIN-KEY.
 11875     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11876     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11877                                      REIN-CODE-2
 11878                                      REIN-CODE-3.
 11879     MOVE 'A'                      TO REIN-TYPE.
 11880
 11881     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11882
 11883     MOVE '3026' TO REIN-SW.
 11884     MOVE ' '                   TO WS-REIN-READ-SW.
 11885
 11886     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11887     IF REIN-TABLE-NOT-FOUND
 11888         GO TO 3026-NO-SPEC-TABLE.
 11889
 11890     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11891     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11892                                   WS-NSP-ST-CD-LF.
 11893     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11894                                   WS-NSP-ST-CD-AH.
 11895
 11896     GO TO 3040-EDIT-CONTINUE.
 11897
 11898 3026-NO-SPEC-TABLE.
 11899
 11900     MOVE ER-2664                TO WS-ERROR.
 11901     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11902     GO TO 3040-EDIT-CONTINUE.
 11903
 11904 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 217
* EL050.cbl
 11905
 11906     IF PB-I-REIN-TABLE = SPACES
 11907       GO TO 3040-EDIT-CONTINUE.
 11908
 11909     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11910          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11911          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11912           GO TO 3040-EDIT-CONTINUE.
 11913
 11914     MOVE LOW-VALUES            TO ERREIN-KEY.
 11915     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11916     MOVE 'A'                   TO REIN-TYPE.
 11917     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11918
 11919     MOVE '3028'                TO REIN-SW.
 11920     MOVE ' '                   TO WS-REIN-READ-SW.
 11921
 11922     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11923     IF REIN-TABLE-NOT-FOUND
 11924         GO TO 3028-NO-REIN-TABLE.
 11925
 11926     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11927     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11928                                   WS-NSP-ST-CD-LF.
 11929     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11930                                   WS-NSP-ST-CD-AH.
 11931
 11932     GO TO 3040-EDIT-CONTINUE.
 11933
 11934 3028-NO-REIN-TABLE.
 11935
 11936     MOVE ER-2615                TO WS-ERROR.
 11937     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11938     GO TO 3040-EDIT-CONTINUE.
 11939
 11940 3040-EDIT-CONTINUE.
 11941
 11942     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11943         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11944
 11945     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11946         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11947
 11948     IF (NOT PB-REISSUED-CERT)
 11949        AND (NOT PB-MONTHLY-CERT)
 11950        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11951            MOVE '001'           TO PB-I-LF-TERM
 11952            MOVE 'M'             TO PB-I-INSURED-SEX.
 11953
 11954     IF (NOT PB-REISSUED-CERT)
 11955        AND (NOT PB-MONTHLY-CERT)
 11956        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11957            MOVE '001'           TO PB-I-AH-TERM
 11958            MOVE 'M'             TO PB-I-INSURED-SEX.
 11959
 11960 3040-EDIT-1ST-PMT-DT.
 11961     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11962     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 218
* EL050.cbl
 11963         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11964
 11965******************************************************************
 11966*                                                                *
 11967*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11968*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11969*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11970*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11971*                                                                *
 11972******************************************************************
 11973
 11974     IF PB-EFF-DT-PROCESSING
 11975        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11976                                    PB-I-LF-EXPIRE-DT
 11977                                    PB-I-AH-EXPIRE-DT
 11978        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11979        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11980        MOVE ZERO                TO DC-ELAPSED-DAYS
 11981        MOVE +1                  TO DC-ELAPSED-MONTHS
 11982        SET BIN-PLUS-ELAPSED     TO TRUE
 11983*       MOVE 6                   TO DC-OPTION-CODE
 11984        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11985        IF NO-CONVERSION-ERROR
 11986           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11987
 11988******************************************************************
 11989*                                                                *
 11990*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11991*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11992*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11993*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11994*                                                                *
 11995******************************************************************
 11996
 11997     IF PB-EXT-DAYS-PROCESSING
 11998          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11999                                         PB-I-LF-EXPIRE-DT
 12000                                         PB-I-AH-EXPIRE-DT
 12001          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12002          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12003          MOVE +1                     TO DC-ELAPSED-MONTHS
 12004          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12005          SET BIN-PLUS-ELAPSED        TO TRUE
 12006*         MOVE 6                      TO DC-OPTION-CODE
 12007          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12008          IF NO-CONVERSION-ERROR
 12009             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12010
 12011******************************************************************
 12012*                                                                *
 12013*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12014*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12015*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12016*        (EXPIRE DATE - (TERM -1))  *  -1.
 12017*                                                                *
 12018******************************************************************
 12019
 12020     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 219
* EL050.cbl
 12021        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12022           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12023              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12024              MOVE PB-I-AH-TERM      TO WS-TERM
 12025           ELSE
 12026              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12027              MOVE PB-I-LF-TERM      TO WS-TERM
 12028        ELSE
 12029           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12030              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12031              MOVE PB-I-LF-TERM      TO WS-TERM
 12032           ELSE
 12033              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12034              MOVE PB-I-AH-TERM      TO WS-TERM.
 12035
 12036     IF PB-EXPIRE-DT-PROCESSING
 12037        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12038        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12039        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12040        MOVE ZERO                TO DC-ELAPSED-DAYS
 12041                                    DC-ODD-DAYS-OVER
 12042          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12043          SET BIN-PLUS-ELAPSED    TO TRUE
 12044*         MOVE 6                  TO DC-OPTION-CODE
 12045          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12046          IF NO-CONVERSION-ERROR
 12047             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12048
 12049******************************************************************
 12050*                                                                *
 12051*            1ST PAYMENT DATE PROCESSING                         *
 12052*                                                                *
 12053******************************************************************
 12054
 12055     IF PB-1ST-PMT-DT-PROCESSING
 12056        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12057                                    PB-I-AH-EXPIRE-DT
 12058        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12059
 12060     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12061         NEXT SENTENCE
 12062     ELSE
 12063         MOVE ER-2680                 TO WS-ERROR
 12064         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12065         GO TO 3060-ORIG-TERM-CHECK.
 12066
 12067     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12068     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12069     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12070*    MOVE 1                      TO DC-OPTION-CODE.
 12071     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12072                                    DC-ELAPSED-DAYS
 12073                                    DC-ODD-DAYS-OVER.
 12074
 12075     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12076
 12077     IF DATE-CONVERSION-ERROR
 12078        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 220
* EL050.cbl
 12079
 12080     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12081     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12082        AND (WS-LF-COVERAGE-TYPE = 'L')
 12083        IF (DC-ELAPSED-MONTHS > 1)
 12084                      OR
 12085           ((DC-ELAPSED-MONTHS = 1)
 12086           AND (DC-ODD-DAYS-OVER > 0))
 12087           MOVE ER-2882          TO WS-ERROR
 12088           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12089        END-IF
 12090     END-IF
 12091     if dc-elapsed-months > 0
 12092        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12093        + dc-odd-days-over
 12094     end-if
 12095     IF PB-EXT-DAYS-PROCESSING
 12096        CONTINUE
 12097     ELSE
 12098        IF DC-ELAPSED-MONTHS = +0
 12099           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12100        ELSE
 12101           IF (WS-LF-EARNINGS-CALC = '4')
 12102              AND (DC-ELAPSED-MONTHS > ZERO)
 12103              AND (DC-ELAPSED-DAYS > ZERO)
 12104              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12105           ELSE
 12106              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12107                                 THRU 6499-EXIT
 12108              MOVE WS-ODD-DAYS-OVER
 12109                                 TO PB-I-EXTENTION-DAYS
 12110           END-IF
 12111        END-IF
 12112     END-IF
 12113******************************************************************
 12114*                                                                *
 12115*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12116*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12117*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12118*            AND ANY ODD DAYS.                                   *
 12119*                                                                *
 12120******************************************************************
 12121
 12122     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12123                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12124     IF WS-LF-EARNINGS-CALC NOT = '4'
 12125        IF DC-ELAPSED-DAYS > ZEROS
 12126           MOVE ER-2681          TO WS-ERROR
 12127           PERFORM 9900-ERROR-FORMAT
 12128                                 THRU 9900-EXIT
 12129        END-IF
 12130     END-IF
 12131
 12132     IF WS-LF-EARNINGS-CALC NOT = '4'
 12133        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12134           MOVE ER-2681          TO WS-ERROR
 12135           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12136
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 221
* EL050.cbl
 12137     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12138        (PB-I-LF-TERM NOT = ZERO) AND
 12139         NOT NO-LIFE-COVERAGE
 12140          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12141          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12142          IF WS-LF-EARNINGS-CALC = '4'
 12143             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12144             PB-I-PAY-FREQUENCY
 12145          END-IF
 12146          MOVE ZERO              TO DC-ELAPSED-DAYS
 12147                                    DC-ODD-DAYS-OVER
 12148          MOVE 1                 TO DC-END-OF-MONTH
 12149          SET BIN-PLUS-ELAPSED        TO TRUE
 12150*         MOVE 6                 TO DC-OPTION-CODE
 12151          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12152          IF NO-CONVERSION-ERROR
 12153             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12154             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12155                (WS-LF-SPECIAL-CALC-CD = 'L')
 12156                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12157                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12158                  MOVE +1             TO DC-ELAPSED-MONTHS
 12159                  SET BIN-PLUS-ELAPSED  TO TRUE
 12160*                 MOVE 6              TO DC-OPTION-CODE
 12161                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12162                  IF NO-CONVERSION-ERROR
 12163                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12164
 12165* okay, i had to move the new att age edit down here because the
 12166* expiration date could get recalculated and i need the exp date
 12167     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12168        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12169        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12170        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12171           AND ZEROS
 12172           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12173           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12174           SET ELAPSED-BETWEEN-BIN TO TRUE
 12175           PERFORM 8500-DATE-CONVERT
 12176                                 THRU 8500-EXIT
 12177           IF NO-CONVERSION-ERROR
 12178              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12179                 MOVE ER-2669       TO WS-ERROR
 12180*                PERFORM 9900-ERROR-FORMAT
 12181*                                THRU 9900-EXIT
 12182              END-IF
 12183           END-IF
 12184        ELSE
 12185           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12186           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12187              MOVE ER-2669       TO WS-ERROR
 12188*             PERFORM 9900-ERROR-FORMAT
 12189*                                THRU 9900-EXIT
 12190           ELSE
 12191              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12192                 MOVE ER-1570    TO WS-ERROR
 12193                 PERFORM 9900-ERROR-FORMAT
 12194                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 222
* EL050.cbl
 12195              END-IF
 12196           END-IF
 12197        END-IF
 12198        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12199           AND ZEROS
 12200           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12201           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12202           SET ELAPSED-BETWEEN-BIN TO TRUE
 12203           PERFORM 8500-DATE-CONVERT
 12204                                 THRU 8500-EXIT
 12205           IF NO-CONVERSION-ERROR
 12206              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12207                 MOVE ER-2669       TO WS-ERROR
 12208*                PERFORM 9900-ERROR-FORMAT
 12209*                                THRU 9900-EXIT
 12210              END-IF
 12211           END-IF
 12212        ELSE
 12213           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12214             (PB-I-LF-TERM / 12)
 12215           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12216              MOVE ER-2669       TO WS-ERROR
 12217*             PERFORM 9900-ERROR-FORMAT
 12218*                                THRU 9900-EXIT
 12219           ELSE
 12220              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12221                 MOVE ER-1571    TO WS-ERROR
 12222                 PERFORM 9900-ERROR-FORMAT
 12223                                 THRU 9900-EXIT
 12224              END-IF
 12225           END-IF
 12226        END-IF
 12227        IF WS-ERROR = ER-2669
 12228           PERFORM 9900-ERROR-FORMAT
 12229                                 THRU 9900-EXIT
 12230        END-IF
 12231     END-IF
 12232     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12233        (PB-I-AH-TERM NOT = ZERO) AND
 12234         NOT NO-AH-COVERAGE
 12235          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12236             AND (PB-COMPANY-ID = 'DCC')
 12237             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12238             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12239          ELSE
 12240             IF WS-LF-EARNINGS-CALC = '4'
 12241                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12242                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12243                PB-I-PAY-FREQUENCY
 12244             ELSE
 12245                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12246                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12247             END-IF
 12248          END-IF
 12249          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12250                                         DC-ODD-DAYS-OVER
 12251          MOVE 1                      TO DC-END-OF-MONTH
 12252          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 223
* EL050.cbl
 12253*         MOVE 6                      TO DC-OPTION-CODE
 12254          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12255          IF NO-CONVERSION-ERROR
 12256             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12257     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12258        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12259        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12260        IF PB-I-BIRTHDAY > LOW-VALUES
 12261           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12262           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12263           SET ELAPSED-BETWEEN-BIN TO TRUE
 12264           PERFORM 8500-DATE-CONVERT
 12265                                 THRU 8500-EXIT
 12266           IF NO-CONVERSION-ERROR
 12267              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12268                 MOVE ER-3054       TO WS-ERROR
 12269*                PERFORM 9900-ERROR-FORMAT
 12270*                                THRU 9900-EXIT
 12271              END-IF
 12272           END-IF
 12273        ELSE
 12274           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12275           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12276              MOVE ER-3054       TO WS-ERROR
 12277*             PERFORM 9900-ERROR-FORMAT
 12278*                                THRU 9900-EXIT
 12279           END-IF
 12280        END-IF
 12281        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12282           AND ZEROS
 12283           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12284           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12285           SET ELAPSED-BETWEEN-BIN TO TRUE
 12286           PERFORM 8500-DATE-CONVERT
 12287                                 THRU 8500-EXIT
 12288           IF NO-CONVERSION-ERROR
 12289              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12290                 MOVE ER-3054       TO WS-ERROR
 12291*                PERFORM 9900-ERROR-FORMAT
 12292*                                THRU 9900-EXIT
 12293              END-IF
 12294           END-IF
 12295        ELSE
 12296           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12297             (PB-I-AH-TERM / 12)
 12298           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12299              MOVE ER-3054       TO WS-ERROR
 12300*             PERFORM 9900-ERROR-FORMAT
 12301*                                THRU 9900-EXIT
 12302           END-IF
 12303        END-IF
 12304        IF WS-ERROR = ER-3054
 12305           PERFORM 9900-ERROR-FORMAT
 12306                                 THRU 9900-EXIT
 12307        END-IF
 12308     END-IF
 12309     MOVE SPACE                       TO DC-END-OF-MONTH.
 12310
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 224
* EL050.cbl
 12311     IF PB-COMPANY-ID = 'NCB'
 12312        GO TO 3040-EDIT-EXTENSION-DAYS.
 12313
 12314     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12315       AND
 12316        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12317        NEXT SENTENCE
 12318     ELSE
 12319        GO TO 3040-EDIT-EXTENSION-DAYS.
 12320
 12321     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12322        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12323        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12324     ELSE
 12325        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12326        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12327
 12328     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12329*    MOVE '1'      TO DC-OPTION-CODE
 12330     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12331     IF (NO-CONVERSION-ERROR)
 12332        AND (DC-ELAPSED-MONTHS > +1)
 12333        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12334        MOVE ER-2668   TO WS-ERROR
 12335        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12336
 12337 3040-EDIT-EXTENSION-DAYS.
 12338
 12339     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12340        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12341         GO TO 3050-EDIT-TERM-IN-DAYS
 12342     ELSE
 12343         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12344
 12345     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12346         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12347     ELSE
 12348        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12349           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12350           MOVE ER-2681         TO WS-ERROR
 12351           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12352
 12353     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12354        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12355        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12356         GO TO 3060-ORIG-TERM-CHECK.
 12357
 12358     GO TO 3060-ORIG-TERM-CHECK.
 12359
 12360 3050-EDIT-TERM-IN-DAYS.
 12361
 12362     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12363
 12364     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12365         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12366     ELSE
 12367         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12368            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 225
* EL050.cbl
 12369            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12370
 12371     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12372                                       REMAINDER WS-WORK-TERM.
 12373     IF WS-WORK-TERM GREATER THAN ZERO
 12374         ADD +1 TO PB-I-LF-TERM.
 12375
 12376     IF NOT NO-AH-COVERAGE
 12377         MOVE ER-2684            TO WS-ERROR
 12378         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12379
 12380
 12381 3060-ORIG-TERM-CHECK.
 12382
 12383******************************************************************
 12384*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12385******************************************************************
 12386
 12387     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12388        NEXT SENTENCE
 12389     ELSE
 12390        IF NOT NO-LIFE-COVERAGE
 12391           IF PB-I-LF-TERM NUMERIC
 12392              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12393              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12394              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12395                  NEXT SENTENCE
 12396           ELSE
 12397              MOVE ER-2647       TO WS-ERROR
 12398              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12399
 12400     IF NOT NO-AH-COVERAGE
 12401         IF PB-I-AH-TERM NUMERIC
 12402            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12403            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12404            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12405             NEXT SENTENCE
 12406          ELSE
 12407              MOVE ER-2658       TO WS-ERROR
 12408              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12409
 12410     IF PB-COMPANY-ID = 'NCB'
 12411        GO TO 3070-LOAN-TERM-CHECK.
 12412
 12413     IF POLICY-HAS-AH
 12414       AND
 12415        POLICY-HAS-LIFE
 12416       AND
 12417        PB-I-LF-TERM NUMERIC
 12418       AND
 12419        PB-I-AH-TERM NUMERIC
 12420        NEXT SENTENCE
 12421     ELSE
 12422        GO TO 3070-LOAN-TERM-CHECK.
 12423
 12424     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12425     IF WS-TEX-FACT-2 LESS THAN +0
 12426        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 226
* EL050.cbl
 12427
 12428     IF WS-TEX-FACT-2 GREATER THAN +1
 12429        MOVE ER-2668             TO WS-ERROR
 12430        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12431
 12432 3070-LOAN-TERM-CHECK.
 12433
 12434     IF (WS-LF-BENEFIT-CD = ZERO)
 12435         OR (NO-LF-BENEFIT-MATCH)
 12436            GO TO 3125-EDIT-PMT-FREQ.
 12437*    IF PB-COMPANY-ID NOT = 'DCC'
 12438*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12439*          AND 'V' AND 'W' AND 'X'
 12440*          GO TO 3125-EDIT-PMT-FREQ
 12441*       END-IF
 12442*    ELSE
 12443*       IF WS-AH-DCC-TRUNC = 'T'
 12444*          CONTINUE
 12445*       ELSE
 12446*          GO TO 3125-EDIT-PMT-FREQ
 12447*       END-IF
 12448*    END-IF
 12449     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12450                    OR
 12451        ((PB-COMPANY-ID = 'DCC')
 12452        AND (WS-AH-DCC-TRUNC = 'T'))
 12453        CONTINUE
 12454     ELSE
 12455        GO TO 3125-EDIT-PMT-FREQ
 12456     END-IF
 12457     IF PB-I-LOAN-TERM NOT NUMERIC
 12458         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12459
 12460     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12461        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12462*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12463        PB-I-LOAN-TERM NOT GREATER THAN +360
 12464         NEXT SENTENCE
 12465     ELSE
 12466         MOVE ER-2648            TO WS-ERROR
 12467         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12468
 12469     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12470        MOVE ER-3058             TO WS-ERROR
 12471        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12472     end-if
 12473
 12474     IF WS-STATE-ABBREVIATION = 'NC'
 12475        IF PB-I-LOAN-TERM > +59
 12476           CONTINUE
 12477        ELSE
 12478           MOVE ER-2792          TO WS-ERROR
 12479           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12480        END-IF
 12481     END-IF
 12482
 12483     .
 12484 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 227
* EL050.cbl
 12485     IF (WS-LF-BENEFIT-CD = ZERO)
 12486         OR (NO-LF-BENEFIT-MATCH)
 12487            GO TO 3127-EDIT-LOAN-OFFICER.
 12488     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12489                    OR
 12490        ((PB-COMPANY-ID = 'DCC')
 12491        AND (WS-AH-DCC-TRUNC = 'T'))
 12492                    OR
 12493         (PB-COMPANY-ID = 'AHL')
 12494        CONTINUE
 12495     ELSE
 12496        IF (PB-I-LOAN-TERM > ZEROS)
 12497           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12498           MOVE ER-1575          TO WS-ERROR
 12499           PERFORM 9900-ERROR-FORMAT
 12500                                 THRU 9900-EXIT
 12501        END-IF
 12502     END-IF
 12503     IF WS-LF-EARNINGS-CALC NOT = '4'
 12504         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12505            MOVE ER-2653         TO WS-ERROR
 12506            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12507            GO TO 3127-EDIT-LOAN-OFFICER
 12508         ELSE
 12509            GO TO 3127-EDIT-LOAN-OFFICER.
 12510
 12511     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12512         MOVE ER-2655            TO WS-ERROR
 12513         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12514         GO TO 3127-EDIT-LOAN-OFFICER.
 12515
 12516     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12517         MOVE ER-2654            TO WS-ERROR
 12518         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12519         GO TO 3127-EDIT-LOAN-OFFICER.
 12520
 12521     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12522         GIVING WS-TEX-FACT-2
 12523             REMAINDER WS-TEX-FACT-3.
 12524
 12525*    IF WS-TEX-FACT-3 NOT = ZERO
 12526*       MOVE ER-2654             TO WS-ERROR
 12527*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12528
 12529
 12530 3127-EDIT-LOAN-OFFICER.
 12531
 12532     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12533        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12534           MOVE ER-2690          TO WS-ERROR
 12535           PERFORM 9900-ERROR-FORMAT
 12536                                 THRU 9900-EXIT
 12537        ELSE
 12538           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12539           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12540           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12541           MOVE PB-SV-STATE      TO LOFC-STATE
 12542           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 228
* EL050.cbl
 12543           MOVE PB-I-LOAN-OFFICER
 12544                                 TO LOFC-CODE
 12545           PERFORM 8586-READ-LOAN-OFFICER
 12546                                 THRU 8586-EXIT
 12547           IF (NOT LOFC-MASTER-FOUND)
 12548              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12549              MOVE ER-3006       TO WS-ERROR
 12550              PERFORM 9900-ERROR-FORMAT
 12551                                 THRU 9900-EXIT
 12552           END-IF
 12553        END-IF
 12554     END-IF
 12555     .
 12556 3129-EDIT-APR.
 12557
 12558     IF (WS-LF-BENEFIT-CD = ZERO)
 12559        OR (NO-LF-BENEFIT-MATCH)
 12560        IF PB-COMPANY-ID NOT = 'DCC'
 12561           GO TO 3130-EDIT-AGE
 12562*       ELSE
 12563*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12564*             GO TO 3130-EDIT-AGE
 12565*          END-IF
 12566        END-IF
 12567     END-IF
 12568
 12569     IF (WS-STATE-ABBREVIATION = 'OH')
 12570         AND (PB-I-RATE-CLASS NOT = 'L ')
 12571         AND (PB-I-LF-TERM GREATER THAN 60)
 12572         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12573         GO TO 3129-APR-CONT.
 12574
 12575     IF (WS-STATE-ABBREVIATION = 'RI')
 12576         AND (PB-I-LF-TERM GREATER THAN 60)
 12577         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12578         GO TO 3129-APR-CONT.
 12579
 12580     IF (WS-STATE-ABBREVIATION = 'UT')
 12581         AND (PB-I-LF-TERM GREATER THAN 62)
 12582         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12583         AND (PB-CERT-EFF-DT LESS WS-830901)
 12584         GO TO 3129-APR-CONT.
 12585
 12586     IF PB-COMPANY-ID = 'LAP'
 12587        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12588           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12589              MOVE ER-2656         TO WS-ERROR
 12590              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12591              GO TO 3130-EDIT-AGE.
 12592
 12593     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12594        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12595        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12596        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12597        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12598        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12599         GO TO 3130-EDIT-AGE.
 12600
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 229
* EL050.cbl
 12601 3129-APR-CONT.
 12602     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12603         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12604         GO TO 3130-EDIT-AGE.
 12605
 12606     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12607         WS-AH-BENEFIT-CD (1:1) = 'S')
 12608        AND (PB-COMPANY-ID = 'DCC')
 12609        AND (PB-I-LOAN-APR = ZERO)
 12610        MOVE ER-2657             TO WS-ERROR
 12611        PERFORM 9900-ERROR-FORMAT
 12612                                 THRU 9900-EXIT
 12613        GO TO 3130-EDIT-AGE
 12614     END-IF
 12615*    IF PB-I-LOAN-APR = ZERO
 12616*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12617*    END-IF
 12618
 12619     if pb-i-loan-apr = +99.9999
 12620        move er-2656             to ws-error
 12621        PERFORM 9900-ERROR-FORMAT
 12622                                 THRU 9900-EXIT
 12623        GO TO 3130-EDIT-AGE
 12624     end-if
 12625*    IF PB-I-LOAN-APR = ZERO
 12626*       MOVE ER-2656             TO WS-ERROR
 12627*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12628*       GO TO 3130-EDIT-AGE.
 12629
 12630*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12631     if pb-i-loan-apr not = +99.9999
 12632        IF PB-I-LOAN-APR > +30.000
 12633           MOVE ER-2657          TO WS-ERROR
 12634           PERFORM 9900-ERROR-FORMAT
 12635                                 THRU 9900-EXIT
 12636        end-if
 12637     end-if
 12638     .
 12639 3130-EDIT-AGE.
 12640
 12641******************************************************************
 12642*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12643******************************************************************
 12644
 12645     IF NOT NO-LIFE-COVERAGE
 12646        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12647           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12648               MOVE ER-2628             TO WS-ERROR
 12649               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12650
 12651     IF NOT NO-AH-COVERAGE
 12652        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12653           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12654               MOVE ER-2628         TO WS-ERROR
 12655               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12656
 12657 3133-SEX-CODE.
 12658     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 230
* EL050.cbl
 12659         IF WS-DEFAULT-SEX = 'M'
 12660             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12661          ELSE
 12662             IF WS-DEFAULT-SEX = 'F'
 12663             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12664
 12665     IF PB-I-INSURED-SEX = '1'
 12666         MOVE 'M' TO PB-I-INSURED-SEX.
 12667
 12668     IF PB-I-INSURED-SEX = '2'
 12669         MOVE 'F' TO PB-I-INSURED-SEX.
 12670
 12671 3134-SIG-SW-EDIT.
 12672     IF PB-I-SIG-SW = SPACE
 12673         MOVE 'N'                TO  PB-I-SIG-SW.
 12674
 12675     IF PB-COMPANY-ID = 'NCL'
 12676         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12677             NEXT SENTENCE
 12678         ELSE
 12679             MOVE ER-1923        TO  WS-ERROR
 12680             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12681     ELSE
 12682     IF PB-COMPANY-ID = 'CRI'
 12683         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12684             NEXT SENTENCE
 12685         ELSE
 12686             MOVE ER-2606        TO  WS-ERROR
 12687             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12688     ELSE
 12689     IF PB-COMPANY-ID = 'TMS'
 12690         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12691             NEXT SENTENCE
 12692         ELSE
 12693             MOVE ER-2689        TO  WS-ERROR
 12694             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12695     ELSE
 12696         IF PB-I-SIG-SW = 'Y' OR 'N'
 12697             NEXT SENTENCE
 12698         ELSE
 12699             MOVE ER-2651        TO  WS-ERROR
 12700             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12701
 12702     IF PB-COMPANY-ID = 'FLA'
 12703         IF (WS-EDIT-AGE GREATER 54  OR
 12704             WS-AH-EDIT-AGE GREATER 54)  AND
 12705            PB-I-SIG-SW = 'N'
 12706            MOVE ER-2651         TO  WS-ERROR
 12707            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12708
 12709 3135-NAME-EDIT.
 12710
 12711     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12712        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12713        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12714           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12715                                 TO PB-I-JOINT-FIRST-NAME
 12716        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 231
* EL050.cbl
 12717     END-IF
 12718     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12719        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12720        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12721           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12722                                 TO PB-I-JOINT-LAST-NAME
 12723        END-PERFORM
 12724     END-IF
 12725     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12726        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12727        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12728           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12729                                 TO PB-I-INSURED-FIRST-NAME
 12730        END-PERFORM
 12731     END-IF
 12732     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12733        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12734        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12735           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12736                                 TO PB-I-INSURED-LAST-NAME
 12737        END-PERFORM
 12738     END-IF
 12739     IF PB-I-INSURED-LAST-NAME = SPACES
 12740       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12741       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12742           MOVE ER-2660    TO WS-ERROR
 12743           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12744
 12745 3136-EDIT-SEX.
 12746
 12747******************************************************************
 12748*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12749******************************************************************
 12750
 12751     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12752        (WS-AH-SPECIAL-CALC-CD = 'O')
 12753        NEXT SENTENCE
 12754     ELSE
 12755        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12756           NEXT SENTENCE
 12757        ELSE
 12758           MOVE ER-2629            TO WS-ERROR
 12759           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12760
 12761 3137-EDIT-EFF-DATE.
 12762
 12763     IF PB-REISSUED-CERT       OR
 12764        PB-POLICY-IS-DECLINED  OR
 12765        PB-POLICY-IS-VOIDED
 12766         GO TO 3139-EDIT-COVERAGE-CODES.
 12767
 12768     MOVE SPACE                  TO WS-2671-SW
 12769                                    WS-2672-SW.
 12770
 12771     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12772         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12773             MOVE ER-2703        TO WS-ERROR
 12774             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 232
* EL050.cbl
 12775             GO TO 3139-EDIT-COVERAGE-CODES.
 12776
 12777     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12778         GO TO 3139-EDIT-COVERAGE-CODES.
 12779
 12780     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12781     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12782*    MOVE '1'                    TO DC-OPTION-CODE.
 12783     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12784     MOVE +0                     TO DC-ELAPSED-MONTHS
 12785                                    DC-ELAPSED-DAYS.
 12786     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12787
 12788     IF DATE-CONVERSION-ERROR
 12789         GO TO 3139-EDIT-COVERAGE-CODES.
 12790
 12791     IF DC-ELAPSED-DAYS GREATER +180
 12792         MOVE ER-2672            TO WS-ERROR
 12793         MOVE 'Y'                TO WS-2672-SW
 12794         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12795     END-IF
 12796
 12797     IF WS-ERROR = ER-2671  AND
 12798        PB-COMPANY-ID  = 'LBL'
 12799        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12800        MOVE SPACE               TO WS-2671-SW
 12801        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12802
 12803     IF PB-ISSUE-DATE-FORCED  AND
 12804      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12805         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12806         MOVE ER-2673            TO WS-ERROR
 12807         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12808         MOVE SPACE              TO WS-2671-SW
 12809                                    WS-2672-SW.
 12810
 12811     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12812         IF PB-ISSUE-DATE-FORCED
 12813             MOVE ER-2600          TO  WS-ERROR
 12814             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12815         ELSE
 12816             MOVE ER-2692          TO  WS-ERROR
 12817             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12818
 12819
 12820 3139-EDIT-COVERAGE-CODES.
 12821
 12822     if pb-company-id not = 'AHL'
 12823        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12824           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12825           MOVE ER-2787          TO WS-ERROR
 12826           PERFORM 9900-ERROR-FORMAT
 12827                                 THRU 9900-EXIT
 12828        END-IF
 12829     end-if
 12830     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12831        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12832                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 233
* EL050.cbl
 12833           MOVE ER-2719          TO WS-ERROR
 12834           PERFORM 9900-ERROR-FORMAT
 12835                                 THRU 9900-EXIT
 12836        END-IF
 12837     END-IF
 12838
 12839     IF PB-POLICY-IS-DECLINED  OR
 12840        PB-POLICY-IS-VOIDED
 12841         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12842
 12843     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12844        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12845         MOVE ER-2630                TO WS-ERROR
 12846         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12847
 12848     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12849        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12850        PB-I-LF-PREMIUM-AMT = ZERO
 12851         GO TO 3140-CHECK-AH-FOR-ZERO.
 12852
 12853     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12854        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12855        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12856         GO TO 3140-CHECK-AH-FOR-ZERO.
 12857
 12858     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12859        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12860        MOVE ER-2631             TO WS-ERROR
 12861        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12862     END-IF
 12863
 12864
 12865******************************************************************
 12866*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12867******************************************************************
 12868
 12869     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12870        NEXT SENTENCE
 12871     ELSE
 12872        IF PB-I-LF-BENEFIT-AMT = ZERO
 12873           MOVE ER-2632             TO WS-ERROR
 12874           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12875
 12876
 12877******************************************************************
 12878*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12879******************************************************************
 12880
 12881     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12882        CONTINUE
 12883     ELSE
 12884        IF PB-I-LF-PREMIUM-AMT = ZERO
 12885           IF (NOT PB-COMP-LF-PREM)
 12886              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12887              and (ws-lf-ben-category not = 'C')
 12888              MOVE ER-2633       TO WS-ERROR
 12889              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12890           END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 234
* EL050.cbl
 12891        END-IF
 12892     END-IF
 12893     .
 12894 3140-CHECK-AH-FOR-ZERO.
 12895
 12896     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12897        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12898        PB-I-AH-PREMIUM-AMT = ZERO
 12899         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12900
 12901     IF PB-COMPANY-ID = 'CSL'  AND
 12902        PB-I-AH-BENEFIT-CD = ZERO  AND
 12903        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12904        PB-I-AH-PREMIUM-AMT = ZERO
 12905         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12906
 12907     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12908        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12909        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12910         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12911
 12912     IF PB-I-AH-BENEFIT-CD = ZERO
 12913         MOVE ER-2634            TO WS-ERROR
 12914         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12915
 12916******************************************************************
 12917*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12918******************************************************************
 12919
 12920     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12921        NEXT SENTENCE
 12922     ELSE
 12923        IF PB-I-AH-BENEFIT-AMT = ZERO
 12924           MOVE ER-2635             TO WS-ERROR
 12925           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12926
 12927******************************************************************
 12928*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12929******************************************************************
 12930
 12931     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12932        NEXT SENTENCE
 12933     ELSE
 12934        IF PB-I-AH-PREMIUM-AMT = ZERO
 12935            IF NOT PB-COMP-AH-PREM
 12936                MOVE ER-2636    TO WS-ERROR
 12937                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12938
 12939
 12940 3140-EDIT-MAX-AMT-SIZES.
 12941* CUSTOM CODE FOR CLIENT    'DMD'
 12942     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12943                                     WS-RES-MUNI-TAX
 12944                                     PB-I-STATE-TAX
 12945                                     PB-I-MUNI-TAX.
 12946
 12947     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12948
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 235
* EL050.cbl
 12949     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12950        GO TO 3150-RATE-OUTSTAND-BAL.
 12951
 12952     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12953        GO TO 3150-RATE-OUTSTAND-BAL.
 12954
 12955     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12956        GO TO 3150-RATE-OUTSTAND-BAL.
 12957
 12958     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12959                             OR 'RIC')
 12960        GO TO 3150-RATE-OUTSTAND-BAL.
 12961
 12962     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12963        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12964            GO TO 3150-RATE-OUTSTAND-BAL
 12965        ELSE
 12966           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12967               GO TO 3150-RATE-OUTSTAND-BAL.
 12968
 12969     IF NOT PB-NO-MONTHS-SKIPPED
 12970        GO TO 3150-RATE-OUTSTAND-BAL.
 12971
 12972     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12973        GO TO 3150-RATE-OUTSTAND-BAL.
 12974
 12975     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12976        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12977           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12978             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12979           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12980           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12981              MOVE ER-2693     TO WS-ERROR
 12982              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12983              GO TO 3150-RATE-OUTSTAND-BAL
 12984           ELSE
 12985              GO TO 3150-RATE-OUTSTAND-BAL.
 12986
 12987 3150-RATE-OUTSTAND-BAL.
 12988
 12989* DMD RATING TEST
 12990     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12991         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12992         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12993         MOVE ER-2687                 TO WS-ERROR
 12994         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12995         MOVE 'B'                     TO PB-I-OB-FLAG
 12996         GO TO 3260-EDIT-CONTINUE.
 12997
 12998     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12999         IF  WS-ERROR    EQUAL    ER-2693
 13000             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13001                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13002                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13003                 MOVE  +0            TO  WS-ERROR.
 13004
 13005     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13006         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 236
* EL050.cbl
 13007             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13008                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13009                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13010                 MOVE  +0            TO  WS-ERROR.
 13011
 13012     IF PLAN-MASTER-AH-SW = 'Y'
 13013        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13014            IF  WS-ERROR    EQUAL    ER-2693
 13015              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13016                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13017                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13018                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13019                 MOVE  ER-1910           TO  WS-ERROR
 13020                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13021
 13022     IF PLAN-MASTER-AH-SW = 'Y'
 13023        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13024            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13025               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13026               MOVE  ER-1910           TO  WS-ERROR
 13027               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13028
 13029     IF PLAN-MASTER-AH-SW = 'Y'
 13030        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13031            IF  WS-ERROR    EQUAL    ER-2693
 13032                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13033                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13034                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13035                 MOVE  +0       TO  WS-ERROR.
 13036
 13037     IF WS-ERROR = ER-2693
 13038        IF PB-COMPANY-ID = 'JAL' AND
 13039           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13040           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13041           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13042
 13043     IF WS-ERROR = ER-2693
 13044        IF PB-COMPANY-ID = 'NCL'  AND
 13045           PB-I-AH-BENEFIT-CD = 'OA'
 13046           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13047           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13048
 13049     IF WS-ERROR = ER-2693
 13050        IF PB-COMPANY-ID = 'CNL' AND
 13051           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13052           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13053           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13054
 13055     IF WS-ERROR = ER-2693
 13056        IF PB-COMPANY-ID = 'HER'
 13057           IF WS-LEVEL
 13058              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13059              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13060
 13061     IF ((LF-BENEFIT-FOUND) AND
 13062         (NOT NO-LIFE-COVERAGE)  AND
 13063         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13064       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 237
* EL050.cbl
 13065             (NOT NO-AH-COVERAGE)    AND
 13066             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13067         NEXT SENTENCE
 13068     ELSE
 13069         GO TO 3215-EDIT-RATES.
 13070
 13071     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13072        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13073           MOVE ER-2674          TO WS-ERROR
 13074           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13075           GO TO 3215-EDIT-RATES.
 13076
 13077     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13078        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13079           MOVE ER-2674          TO WS-ERROR
 13080           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13081           GO TO 3215-EDIT-RATES.
 13082
 13083     MOVE 'B'                    TO PB-I-OB-FLAG.
 13084
 13085     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13086         NEXT SENTENCE
 13087     ELSE
 13088         IF NOT NO-LIFE-COVERAGE
 13089             IF WS-ACCT-LF-OB-RT = ZERO
 13090                MOVE ER-2641    TO WS-ERROR
 13091                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13092
 13093     IF PB-COMPANY-ID = 'CRI'
 13094       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13095         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13096         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13097         IF WS-ERROR = ER-2675
 13098            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13099            MOVE ER-2687              TO WS-ERROR
 13100            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13101         ELSE
 13102            MOVE ER-2687              TO WS-ERROR
 13103            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13104
 13105
 13106     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13107         NEXT SENTENCE
 13108     ELSE
 13109       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13110            NEXT SENTENCE
 13111       ELSE
 13112         IF NOT NO-AH-COVERAGE
 13113             IF WS-ACCT-AH-OB-RT = ZERO
 13114                MOVE ER-2642    TO WS-ERROR
 13115                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13116
 13117     IF PB-COMPANY-ID = 'CRI'
 13118       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13119         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13120         IF WS-ERROR = ER-2676
 13121            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13122            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 238
* EL050.cbl
 13123            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13124         ELSE
 13125            MOVE ER-2687              TO WS-ERROR
 13126            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13127
 13128     IF PB-COMPANY-ID NOT = 'GIC'
 13129         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13130            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13131     ELSE
 13132         IF PB-I-LF-PREM-CALC = ZEROS
 13133             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13134                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13135
 13136     IF PB-COMPANY-ID NOT = 'GIC'
 13137         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13138            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13139     ELSE
 13140         IF PB-I-AH-PREM-CALC = ZEROS
 13141             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13142                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13143
 13144     MOVE ZEROS TO PB-I-MORT-CODE.
 13145
 13146     GO TO 3260-EDIT-CONTINUE.
 13147
 13148
 13149 3215-EDIT-RATES.
 13150     IF ACCOUNT-MAST-FOUND
 13151         NEXT SENTENCE
 13152     ELSE
 13153         GO TO 3999-END-EDIT.
 13154
 13155 3220-CHECK-LF-RATES.
 13156
 13157     IF PB-COMPANY-ID = 'DCC'
 13158        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13159        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13160        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13161           AND (NOT WS-LF-CASH))
 13162                           OR
 13163           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13164           AND (NOT WS-AH-CASH)))
 13165                       AND
 13166           (PB-I-ENTRY-STATUS NOT = '5')
 13167           MOVE 'M'              TO PB-BATCH-ENTRY
 13168                                    PB-I-ENTRY-STATUS
 13169        END-IF
 13170     END-IF
 13171     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13172                                    PB-I-AH-PREM-CALC
 13173                                    PB-I-LF-ALT-PREM-CALC
 13174                                    PB-I-LF-ALT-RATE
 13175                                    PB-I-LF-REI-RATE
 13176                                    PB-I-LF-ALT-REI-RATE
 13177                                    PB-I-AH-REI-RATE
 13178                                    PB-I-TOT-FEES-CALC.
 13179
 13180     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 239
* EL050.cbl
 13181        NEXT SENTENCE
 13182     ELSE
 13183        MOVE ZEROS               TO PB-I-LF-RATE
 13184                                    PB-I-AH-RATE.
 13185
 13186     IF PB-I-TOT-FEES NOT NUMERIC
 13187        MOVE ZEROS               TO PB-I-TOT-FEES
 13188     END-IF
 13189     IF PB-I-LIVES NOT NUMERIC
 13190         MOVE ZERO               TO PB-I-LIVES.
 13191
 13192     IF PB-I-NUM-BILLED NOT NUMERIC
 13193         MOVE ZERO               TO PB-I-NUM-BILLED.
 13194
 13195     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13196        MOVE +0                  TO PB-I-LF-PREM-TAX
 13197     END-IF
 13198
 13199     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13200        MOVE +0                  TO PB-I-AH-PREM-TAX
 13201     END-IF
 13202
 13203     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13204        PB-I-PAY-FREQUENCY = ZEROS
 13205            MOVE 12 TO CP-PAY-FREQUENCY
 13206     ELSE
 13207            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13208
 13209     IF PB-I-STATE-TAX NOT NUMERIC
 13210         MOVE ZEROS               TO PB-I-STATE-TAX.
 13211
 13212     IF PB-I-MUNI-TAX NOT NUMERIC
 13213         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13214
 13215     MOVE SPACES                 TO CP-BEN-CATEGORY
 13216     IF PB-COMPANY-ID  = 'CSL'  AND
 13217        PB-I-LF-TERM NOT = ZERO
 13218        COMPUTE WS-PAYMENT-AMT =
 13219             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13220        COMPUTE WS-CSL-AMT1 =
 13221             PB-I-LF-TERM * AM-MAX-MON-BEN
 13222        COMPUTE WS-CSL-AMT2 =
 13223             WS-PAYMENT-AMT * PB-I-LF-TERM
 13224        IF CP-PAY-FREQUENCY NOT = 12
 13225           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13226           MOVE '8' TO WS-CSL-CALC-CD
 13227        ELSE
 13228           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13229              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13230               AM-MAX-TOT-BEN
 13231               MOVE '6' TO WS-CSL-CALC-CD
 13232           ELSE
 13233              IF (WS-CSL-AMT1  GREATER THAN
 13234                 AM-MAX-TOT-BEN) AND
 13235                 (WS-CSL-AMT2  GREATER THAN
 13236                 AM-MAX-TOT-BEN)
 13237                 MOVE '7' TO WS-CSL-CALC-CD
 13238              ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 240
* EL050.cbl
 13239                 MOVE '5' TO WS-CSL-CALC-CD.
 13240
 13241     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13242         NEXT SENTENCE
 13243     ELSE
 13244         GO TO 3300-CHECK-AH-RATES.
 13245
 13246*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13247
 13248     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13249        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13250              OR
 13251           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13252           MOVE ER-2618          TO WS-ERROR
 13253           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13254           GO TO 3300-CHECK-AH-RATES.
 13255
 13256     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13257           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13258                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13259
 13260     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13261         MOVE ER-2687             TO WS-ERROR
 13262         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13263         MOVE 'Z000'              TO PB-I-MORT-CODE
 13264         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13265         GO TO 3300-CHECK-AH-RATES.
 13266
 13267     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13268        IF PB-I-LIVES = ZERO
 13269           MOVE ER-2688          TO WS-ERROR
 13270           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13271
 13272     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13273
 13274     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13275     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13276     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13277     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13278     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13279     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13280     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13281     MOVE '3'                    TO CP-PROCESS-TYPE.
 13282     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13283     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13284
 13285******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13286     IF PB-COMPANY-ID EQUAL 'CDL'
 13287         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13288            CP-EARN-AS-NET-PAY)
 13289             IF PB-CERT-EFF-DT GREATER  WS-931231
 13290                 MOVE '1'        TO CP-EARNING-METHOD.
 13291*******
 13292
 13293     MOVE PB-SV-STATE            TO CP-STATE.
 13294     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13295     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13296     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 241
* EL050.cbl
 13297     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13298     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13299                                    CP-RATING-BENEFIT-AMT.
 13300     IF CP-STATE-STD-ABBRV = 'OR'
 13301         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13302                                         PB-I-LF-ALT-BENEFIT-AMT.
 13303     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13304     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13305     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13306     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13307     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13308     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13309     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13310     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13311     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13312                                    CP-REMAINING-TERM
 13313                                    CP-LOAN-TERM.
 13314
 13315     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13316         NEXT SENTENCE
 13317     ELSE
 13318         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13319             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13320                                           PB-I-LF-PREMIUM-AMT.
 13321
 13322     IF PB-COMPANY-ID EQUAL 'CSL'
 13323        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13324           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13325                                         PB-I-LF-PREMIUM-AMT.
 13326
 13327     IF PB-COMPANY-ID EQUAL 'NCB'
 13328         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13329            CP-EARN-AS-NET-PAY
 13330             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13331                 PB-I-LF-PREMIUM-AMT.
 13332
 13333     IF (CP-TRUNCATED-LIFE)
 13334        or ((pb-company-id = 'AHL')
 13335           and (pb-i-loan-term > pb-i-lf-term))
 13336        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13337
 13338     IF PB-COMPANY-ID EQUAL 'CRI'
 13339        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13340
 13341     IF CP-TERM-IS-DAYS
 13342         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13343     ELSE
 13344         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13345     IF PB-COMPANY-ID = 'DCC'
 13346        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13347        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13348        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13349        IF WS-LF-BEN-CATEGORY = 'D'
 13350           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13351           MOVE PB-I-LIFE-COMMISSION
 13352                                 TO CP-DCC-ACT-COMM
 13353           MOVE WS-LF-BEN-CATEGORY
 13354                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 242
* EL050.cbl
 13355        END-IF
 13356        IF (CP-BENEFIT-CD (1:1) = 'P')
 13357           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13358           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13359           add pb-i-ah-premium-amt to cp-original-premium
 13360        END-IF
 13361     END-IF
 13362     IF PB-COMPANY-ID = 'CSL'
 13363         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13364         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13365         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13366
 13367     IF PB-COMPANY-ID = 'CSL'
 13368        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13369
 13370     IF (CP-SPECIAL-CALC-CD = 'H')
 13371        OR (PB-COMPANY-ID = 'DCC')
 13372         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13373                                    TO CP-ALTERNATE-BENEFIT
 13374         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13375
 13376     IF (PB-COMPANY-ID = 'CID')
 13377        AND (WS-LF-EARNINGS-CALC = 'B')
 13378        AND (CP-STATE-STD-ABBRV = 'MN')
 13379        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13380                                 TO CP-ALTERNATE-BENEFIT
 13381        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13382     END-IF
 13383     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13384     MOVE 'R'                   TO CP-RATE-FILE.
 13385     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13386
 13387     IF CP-ERROR-RATE-NOT-FOUND
 13388        MOVE ER-2641            TO WS-ERROR
 13389        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13390        GO TO 3300-CHECK-AH-RATES.
 13391
 13392     IF PB-COMPANY-ID EQUAL 'CRI'
 13393        IF CP-ERROR-NO-LIMITS-CRI
 13394           IF NOT ACCOUNT-LIFE-CHECKED
 13395              MOVE ER-2607      TO WS-ERROR
 13396              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13397
 13398******************************************************************
 13399*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13400*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13401******************************************************************
 13402
 13403* CALC LIFE AGE AT EXPIRATION.
 13404
 13405     COMPUTE WS-AGE-AT-EXPIRE =
 13406          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13407
 13408*    IF PB-STATE = 'CO' OR 'UT'
 13409*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13410*        MOVE 'F'            TO PB-FATAL-FLAG
 13411*        MOVE ER-2709        TO WS-ERROR
 13412*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 243
* EL050.cbl
 13413*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13414
 13415*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13416*        MOVE 'X'            TO PB-FATAL-FLAG
 13417*        MOVE ER-2718        TO WS-ERROR
 13418*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13419*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13420
 13421* CALC A & H AGE AT EXPIRATION.
 13422
 13423     COMPUTE WS-AGE-AT-EXPIRE =
 13424          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13425
 13426*    IF PB-STATE = 'CO' OR 'UT'
 13427*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13428*        MOVE 'F'            TO PB-FATAL-FLAG
 13429*        MOVE ER-2709        TO WS-ERROR
 13430*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13431*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13432
 13433*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13434*        MOVE 'X'            TO PB-FATAL-FLAG
 13435*        MOVE ER-2718        TO WS-ERROR
 13436*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13437*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13438
 13439     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13440        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13441
 13442     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13443        and (not pb-monthly-cert)
 13444        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13445     end-if
 13446
 13447     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13448        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13449
 13450     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13451         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13452         MOVE ER-2639        TO WS-ERROR
 13453         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13454
 13455
 13456******************************************************************
 13457*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13458******************************************************************
 13459
 13460 PREMIUM-EDITING-IS-BYPASSED.
 13461     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13462        AND (CP-R-MAX-ATT-AGE > +0)
 13463        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13464        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13465           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13466           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13467           MOVE '1'              TO DC-OPTION-CODE
 13468           PERFORM 8500-DATE-CONVERT
 13469                                 THRU 8500-EXIT
 13470           IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 244
* EL050.cbl
 13471              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13472                 MOVE ER-2661       TO WS-ERROR
 13473*                PERFORM 9900-ERROR-FORMAT
 13474*                                THRU 9900-EXIT
 13475              END-IF
 13476           END-IF
 13477        ELSE
 13478           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13479           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13480              MOVE ER-2661       TO WS-ERROR
 13481*             PERFORM 9900-ERROR-FORMAT
 13482*                                THRU 9900-EXIT
 13483           ELSE
 13484              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13485                 MOVE ER-1570    TO WS-ERROR
 13486                 PERFORM 9900-ERROR-FORMAT
 13487                                 THRU 9900-EXIT
 13488              END-IF
 13489           END-IF
 13490        END-IF
 13491        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13492           MOVE PB-I-JOINT-BIRTHDAY
 13493                                 TO DC-BIN-DATE-1
 13494           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13495           MOVE '1'              TO DC-OPTION-CODE
 13496           PERFORM 8500-DATE-CONVERT
 13497                                 THRU 8500-EXIT
 13498           IF NO-CONVERSION-ERROR
 13499              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13500                 MOVE ER-2661       TO WS-ERROR
 13501*                PERFORM 9900-ERROR-FORMAT
 13502*                                THRU 9900-EXIT
 13503              END-IF
 13504           ELSE
 13505              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13506           END-IF
 13507        ELSE
 13508           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13509             (PB-I-LF-TERM / 12)
 13510           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13511              MOVE ER-2661       TO WS-ERROR
 13512*             PERFORM 9900-ERROR-FORMAT
 13513*                                THRU 9900-EXIT
 13514           ELSE
 13515              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13516                 MOVE ER-1571    TO WS-ERROR
 13517                 PERFORM 9900-ERROR-FORMAT
 13518                                 THRU 9900-EXIT
 13519              END-IF
 13520           END-IF
 13521        END-IF
 13522        IF WS-ERROR = ER-2661
 13523           PERFORM 9900-ERROR-FORMAT
 13524                                 THRU 9900-EXIT
 13525        END-IF
 13526     END-IF
 13527*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13528*       MOVE ER-2661             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 245
* EL050.cbl
 13529*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13530
 13531     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13532        MOVE ER-2662             TO WS-ERROR
 13533        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13534
 13535     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13536        MOVE ER-2677             TO WS-ERROR
 13537        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13538
 13539     IF CP-ERROR-LOAN-TERM
 13540        MOVE ER-2648             TO WS-ERROR
 13541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13542
 13543 3221-CHECK-ERROR-RATE-OPEN.
 13544
 13545     IF CP-ERROR-RATE-FILE-NOTOPEN
 13546         GO TO 3990-FILES-NOT-OPEN.
 13547
 13548     IF PB-COMPANY-ID NOT = 'DMD'
 13549        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13550     END-IF
 13551     .
 13552 3221-CONTINUE.
 13553     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13554                                    WS-DCC-AH-RATE
 13555     IF PB-COMPANY-ID = 'DCC'
 13556        IF WS-LF-BEN-CATEGORY = 'D'
 13557           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13558              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13559        END-IF
 13560     END-IF
 13561     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13562*   X'A4FF' = 12/31/2009
 13563     IF (PB-COMPANY-ID = 'CID')
 13564        AND (WS-LF-EARNINGS-CALC = 'B')
 13565        AND (CP-STATE-STD-ABBRV = 'MN')
 13566        AND (PB-CERT-EFF-DT > X'A4FF')
 13567        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13568     END-IF
 13569     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13570
 13571     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13572     IF (PB-COMPANY-ID = 'DCC')
 13573        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13574        AND (PB-I-POLICY-IS-MONTHLY)
 13575        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13576        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13577     END-IF
 13578     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13579     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13580     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13581     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13582     IF (PB-COMPANY-ID = 'DCC')
 13583        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13584        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13585        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13586        MOVE ER-2786             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 246
* EL050.cbl
 13587        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13588     END-IF
 13589
 13590     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13591
 13592******************************************************************
 13593*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13594******************************************************************
 13595     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13596        and ((not pb-monthly-cert)
 13597        or (ws-lf-ben-category = 'C'))
 13598        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13599
 13600     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13601        GO TO 3225-CHECK-ALT-LIFE-RATE
 13602     ELSE
 13603       IF PB-I-LF-RATE = ZERO
 13604          MOVE ER-2641          TO WS-ERROR
 13605          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13606
 13607 3225-CHECK-ALT-LIFE-RATE.
 13608
 13609     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13610        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13611        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13612         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13613
 13614     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13615         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13616             AND PB-COMPANY-ID NOT = 'DCC')
 13617                   OR
 13618              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13619              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13620              AND PB-COMPANY-ID NOT = 'DCC')
 13621             MOVE ER-2720        TO  WS-ERROR
 13622             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13623             GO TO 3225-RATING-CONT
 13624         ELSE
 13625             GO TO 3225-RATING-CONT.
 13626     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13627        AND (AM-GPCD = 01 OR 06 OR 15)
 13628        MOVE ER-2798             TO WS-ERROR
 13629        PERFORM 9900-ERROR-FORMAT
 13630                                 THRU 9900-EXIT
 13631*       GO TO 3225-RATING-CONT
 13632     END-IF
 13633     IF (PB-COMPANY-ID = 'CID')
 13634        AND (WS-LF-EARNINGS-CALC = 'B')
 13635        AND (CP-STATE-STD-ABBRV = 'MN')
 13636        AND (PB-CERT-EFF-DT > X'A4FF')
 13637        GO TO 3225-RATING-CONT
 13638     END-IF
 13639     IF PB-COMPANY-ID = 'DCC'
 13640        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13641           AND (PB-I-POLICY-IS-MONTHLY)
 13642           GO TO 3225-RATING-CONT
 13643        END-IF
 13644     END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 247
* EL050.cbl
 13645
 13646     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13647        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13648        CP-EARN-AS-REG-BALLOON
 13649        NEXT SENTENCE
 13650     ELSE
 13651        MOVE '2'                 TO CP-EARNING-METHOD.
 13652
 13653 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13654
 13655     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13656
 13657     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13658        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13659        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13660         NEXT SENTENCE
 13661     ELSE
 13662         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13663
 13664     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13665     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13666     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13667                                     CP-RATING-BENEFIT-AMT.
 13668     IF CP-STATE-STD-ABBRV = 'OR'
 13669         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13670                                         PB-I-LF-ALT-BENEFIT-AMT.
 13671     IF PB-COMPANY-ID = 'DCC'
 13672        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13673     END-IF
 13674     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13675     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13676     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13677                                    CP-REMAINING-TERM
 13678                                    CP-LOAN-TERM.
 13679     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13680        ADD +1                   TO CP-ORIGINAL-TERM
 13681                                    CP-REMAINING-TERM
 13682                                    CP-LOAN-TERM.
 13683
 13684     MOVE 'R'                   TO CP-RATE-FILE.
 13685     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13686
 13687     IF CP-ERROR-RATE-NOT-FOUND
 13688         MOVE ER-2641            TO WS-ERROR
 13689         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13690         GO TO 3300-CHECK-AH-RATES.
 13691
 13692     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13693     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13694
 13695     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13696         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13697
 13698     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13699                               + PB-I-LF-ALT-BENEFIT-AMT.
 13700
 13701     IF ACCOUNT-LIFE-CHECKED  OR
 13702        PB-POLICY-IS-VOIDED   OR
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 248
* EL050.cbl
 13703        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13704        and (not pb-monthly-cert))
 13705        GO TO 3225-CONTINUE.
 13706
 13707     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13708        GO TO 3225-CONTINUE.
 13709
 13710     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13711                             EC-RT-LF-MAX-TOT-BEN
 13712        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13713        MOVE ER-2639       TO WS-ERROR
 13714        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13715
 13716 3225-CONTINUE.
 13717     IF PB-I-LF-ALT-RATE = ZERO
 13718         MOVE ER-2659            TO WS-ERROR
 13719         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13720
 13721     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13722        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13723        MOVE ER-2698             TO WS-ERROR
 13724        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13725
 13726 3225-RATING-CONT.
 13727
 13728     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13729        and (not pb-monthly-cert)
 13730         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13731         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13732         IF (PB-COMPANY-ID = 'DCC')
 13733            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13734            CONTINUE
 13735         ELSE
 13736            MOVE ER-2687         TO WS-ERROR
 13737            PERFORM 9900-ERROR-FORMAT
 13738                                 THRU 9900-EXIT
 13739         END-IF
 13740         GO TO 3290-EDIT-LF-REIN-RATE
 13741     END-IF
 13742
 13743* DMD RATING TEST
 13744     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13745         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13746         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13747         MOVE ER-2687                 TO WS-ERROR
 13748         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13749         GO TO 3290-EDIT-LF-REIN-RATE.
 13750
 13751 3230-CLIENT-MORT-CD-SPECIALS.
 13752
 13753     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13754     SET BIN-TO-GREG          TO TRUE.
 13755*    MOVE ' '                 TO DC-OPTION-CODE.
 13756     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13757     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13758
 13759 C-POS-3230-MORT-CD.
 13760     IF PB-COMPANY-ID = 'POS' AND
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 249
* EL050.cbl
 13761        PB-SV-CARRIER = '2'
 13762         NEXT SENTENCE
 13763     ELSE
 13764         GO TO C-POS-3240-MORT-CD.
 13765
 13766     IF PB-SV-GROUPING = '030'
 13767        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13768         MOVE '2350' TO PB-I-MORT-CODE
 13769      ELSE
 13770         MOVE '3300' TO PB-I-MORT-CODE.
 13771
 13772
 13773 C-POS-3240-MORT-CD.
 13774     IF PB-COMPANY-ID = 'POS' AND
 13775        PB-SV-CARRIER = '1'
 13776         NEXT SENTENCE
 13777     ELSE
 13778         GO TO 3230-CONTINUE.
 13779
 13780     IF PB-SV-STATE = '45' OR '47'
 13781        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13782         MOVE '5200' TO PB-I-MORT-CODE
 13783     ELSE
 13784         MOVE '8300' TO PB-I-MORT-CODE.
 13785
 13786 3230-CONTINUE.
 13787
 13788     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13789        GO TO 3240-CONTINUE
 13790     END-IF
 13791
 13792     IF PB-CERT-EFF-DT > WS-971231
 13793        GO TO 3240-CONTINUE
 13794     END-IF
 13795
 13796     IF LF-BENEFIT-FOUND AND
 13797        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13798         MOVE 'F250'       TO PB-I-MORT-CODE
 13799     ELSE
 13800         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13801             MOVE '7250'   TO PB-I-MORT-CODE
 13802         ELSE
 13803             MOVE '4251'   TO PB-I-MORT-CODE
 13804         END-IF
 13805     END-IF
 13806
 13807     .
 13808 3240-CONTINUE.
 13809
 13810     IF PB-COMPANY-ID NOT = 'GNL'
 13811         GO TO 3256-CONTINUE.
 13812
 13813     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13814         MOVE 'A300' TO PB-I-MORT-CODE
 13815     ELSE
 13816         MOVE '8350' TO PB-I-MORT-CODE.
 13817
 13818 3256-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 250
* EL050.cbl
 13819     IF PB-COMPANY-ID NOT = 'ABL'
 13820         GO TO 3260-EDIT-CONTINUE.
 13821
 13822     IF PB-I-LF-TERM GREATER THAN 59
 13823         MOVE 'F550' TO PB-I-MORT-CODE
 13824     ELSE
 13825         MOVE 'E550' TO PB-I-MORT-CODE.
 13826
 13827 3260-EDIT-CONTINUE.
 13828     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13829
 13830 3290-EDIT-LF-REIN-RATE.
 13831     IF LF-REIN-NSP-NOT-USED
 13832         GO TO 3290-RATING-CONT.
 13833
 13834     IF PB-COMPANY-ID = 'DCC'
 13835        GO TO 3290-RATING-CONT.
 13836     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13837     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13838     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13839     MOVE '3'                   TO CP-PROCESS-TYPE.
 13840     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13841
 13842******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13843     IF PB-COMPANY-ID EQUAL 'CDL'
 13844         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13845            CP-EARN-AS-NET-PAY)
 13846             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13847*            MOVE SPACE          TO DC-OPTION-CODE
 13848             SET BIN-TO-GREG     TO TRUE
 13849             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13850***  Y2K PROJ 7744
 13851             IF DC-GREG-DATE-CYMD GREATER 19931231
 13852                 MOVE '1'        TO CP-EARNING-METHOD.
 13853***  Y2K PROJ 7744
 13854*******
 13855
 13856     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13857     MOVE PB-SV-STATE           TO CP-STATE.
 13858     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13859     MOVE ZERO                  TO CP-DEVIATION-CODE
 13860                                   CP-RATE-DEV-PCT.
 13861     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13862     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13863                                   CP-RATING-BENEFIT-AMT.
 13864
 13865************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13866     IF PB-COMPANY-ID EQUAL 'NCB'
 13867         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13868            CP-EARN-AS-NET-PAY
 13869             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13870                 PB-I-LF-PREMIUM-AMT.
 13871************
 13872
 13873     IF CP-STATE-STD-ABBRV = 'OR'
 13874         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13875                                         PB-I-LF-ALT-BENEFIT-AMT.
 13876     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 251
* EL050.cbl
 13877     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13878     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13879     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13880     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13881     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13882     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13883     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13884                                   CP-REMAINING-TERM
 13885                                   CP-LOAN-TERM.
 13886     IF CP-TRUNCATED-LIFE
 13887        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13888
 13889     IF CP-TERM-IS-DAYS
 13890         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13891     ELSE
 13892         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13893
 13894     IF PB-COMPANY-ID = 'DCC'
 13895        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13896     END-IF
 13897     IF PB-COMPANY-ID NOT = 'TIC'
 13898          MOVE ZERO          TO CP-CLASS-CODE.
 13899
 13900     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13901
 13902     MOVE 'R'                   TO CP-RATE-FILE.
 13903     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13904
 13905     IF CP-ERROR-RATE-NOT-FOUND
 13906        IF PB-I-OB
 13907           MOVE ER-2625      TO WS-ERROR
 13908           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13909           GO TO 3299-EDIT-CONTINUE
 13910        ELSE
 13911           MOVE ER-2643      TO WS-ERROR
 13912           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13913           GO TO 3299-EDIT-CONTINUE.
 13914
 13915     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13916
 13917     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13918     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13919
 13920     IF PB-I-LF-REI-RATE = ZERO
 13921         MOVE ER-2643        TO WS-ERROR
 13922         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13923
 13924 3290-CHECK-ALT-REIN-RATE.
 13925
 13926     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13927        GO TO 3290-RATING-CONT.
 13928
 13929     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13930     MOVE '2'                    TO CP-EARNING-METHOD.
 13931     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13932     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13933     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13934     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 252
* EL050.cbl
 13935                                     CP-RATING-BENEFIT-AMT.
 13936     IF CP-STATE-STD-ABBRV = 'OR'
 13937         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13938                                         PB-I-LF-ALT-BENEFIT-AMT.
 13939     IF PB-COMPANY-ID = 'DCC'
 13940        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13941     END-IF
 13942     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13943     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13944     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13945                                    CP-REMAINING-TERM
 13946                                    CP-LOAN-TERM.
 13947     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13948        ADD +1                   TO CP-ORIGINAL-TERM
 13949                                    CP-REMAINING-TERM
 13950                                    CP-LOAN-TERM.
 13951
 13952     MOVE 'R'                   TO CP-RATE-FILE.
 13953     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13954
 13955     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13956
 13957     IF PB-I-LF-ALT-REI-RATE = ZERO
 13958         MOVE ER-2643            TO WS-ERROR
 13959         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13960
 13961 3290-RATING-CONT.
 13962
 13963     IF PB-I-OB
 13964*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13965        GO TO 3300-CHECK-AH-RATES.
 13966
 13967 3299-EDIT-CONTINUE.
 13968
 13969     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13970         NEXT SENTENCE
 13971     ELSE
 13972         MOVE ER-2620           TO WS-ERROR
 13973         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13974
 13975 3300-CHECK-AH-RATES.
 13976     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13977         NEXT SENTENCE
 13978     ELSE
 13979         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13980
 13981     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 13982        and (not pb-monthly-cert))
 13983                  or
 13984        ((CF-COMPANY-ID = 'DMD') AND
 13985                (NO-DMD-RATING))
 13986         IF (PB-COMPANY-ID = 'DCC')
 13987            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13988            CONTINUE
 13989         ELSE
 13990            MOVE ER-2687         TO WS-ERROR
 13991            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13992         END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 253
* EL050.cbl
 13993         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13994         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13995     END-IF
 13996
 13997     IF PB-I-OB
 13998        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13999
 14000     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14001         MOVE ER-2687             TO WS-ERROR
 14002         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14003         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14004         GO TO 3999-END-EDIT.
 14005
 14006*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14007     if pb-company-id = 'AHL'
 14008        go to 3300-skip-crit-per
 14009     end-if
 14010     if (pb-i-ah-crit-per not = zeros)
 14011        and (ws-ah-special-calc-cd not = 'C')
 14012        MOVE ER-1572             TO WS-ERROR
 14013        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14014        go to 3300-skip-crit-per
 14015     END-IF
 14016     if (pb-company-id = 'DCC')
 14017        and (am-dcc-product-code not = spaces)
 14018        go to 3300-skip-crit-per
 14019     end-if
 14020     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14021        IF PB-I-AH-CRIT-PER = ZERO
 14022           move ws-ah-max-bens   to pb-i-ah-crit-per
 14023*          MOVE ER-2618       TO WS-ERROR
 14024*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14025*          GO TO 3999-END-EDIT
 14026        END-IF
 14027     END-IF
 14028     if (ws-ah-special-calc-cd = 'C')
 14029        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14030        MOVE ER-1576             TO WS-ERROR
 14031        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14032     end-if
 14033
 14034     .
 14035 3300-skip-crit-per.
 14036     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14037     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14038     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14039     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14040     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14041     MOVE PB-SV-STATE            TO CP-STATE.
 14042     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14043     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14044     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14045*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14046     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14047     MOVE '3'                    TO CP-PROCESS-TYPE.
 14048     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14049     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14050                                    CP-RATING-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 254
* EL050.cbl
 14051     IF PB-COMPANY-ID = 'CID'
 14052               OR
 14053        CP-STATE-STD-ABBRV = 'OR'
 14054         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14055                                         PB-I-AH-TERM.
 14056     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 14057        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14058           AND (PB-I-POLICY-IS-MONTHLY)
 14059           MOVE PB-I-LF-BENEFIT-AMT
 14060                                 TO CP-NET-BENEFIT-AMT
 14061           move pb-i-ah-premium-amt to cp-original-premium
 14062           add pb-i-lf-premium-amt to cp-original-premium
 14063        END-IF
 14064     END-IF
 14065     MOVE SPACES                 TO CP-BEN-CATEGORY
 14066     IF PB-COMPANY-ID = 'DCC'
 14067        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14068        EVALUATE TRUE
 14069           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14070              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14071              MOVE PB-I-LF-BENEFIT-AMT
 14072                                 TO CP-RATING-BENEFIT-AMT
 14073              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14074           WHEN WS-AH-BEN-CATEGORY = 'G'
 14075              MOVE PB-I-UNPAID-CASH-PRICE
 14076                                 TO CP-RATING-BENEFIT-AMT
 14077           WHEN WS-AH-BEN-CATEGORY = 'D'
 14078              MOVE WS-AH-PMF-COMM
 14079                                 TO CP-DCC-PMF-COMM
 14080              MOVE PB-I-AH-COMMISSION
 14081                                 TO CP-DCC-ACT-COMM
 14082        END-EVALUATE
 14083     END-IF
 14084     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14085     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14086     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14087     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14088     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14089     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14090     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14091                                    CP-REMAINING-TERM
 14092                                    WS-WORK-TERM.
 14093     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14094
 14095     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14096     SET BIN-TO-GREG             TO TRUE.
 14097*    MOVE ' '                    TO DC-OPTION-CODE.
 14098     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14099     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14100
 14101     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14102     IF NOT VALID-SKIP-CODE
 14103         MOVE ER-2683            TO WS-ERROR
 14104         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14105         GO TO 3320-RATE-CONTINUE.
 14106
 14107     IF PB-NO-MONTHS-SKIPPED
 14108         GO TO 3320-RATE-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 255
* EL050.cbl
 14109
 14110     MOVE SPACE TO NUMBER-OF-MONTHS.
 14111
 14112     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14113         MOVE 'S'                TO SK-MO (6).
 14114     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14115         MOVE 'S'                TO SK-MO (7).
 14116     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14117         MOVE 'S'                TO SK-MO (8).
 14118     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14119         MOVE 'S'                TO SK-MO (9).
 14120     IF PB-I-SKIP-CODE = 'A'
 14121         MOVE 'S'                TO SK-MO (10).
 14122
 14123     MOVE 1                      TO SUB2.
 14124     MOVE PB-I-AH-TERM           TO SUB3.
 14125     MOVE WS-MONTH               TO SUB1.
 14126     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14127     GO TO 3320-RATE-CONTINUE.
 14128
 14129 3310-GET-SKIP-MO.
 14130     IF SUB1 = 13
 14131         MOVE 1                  TO SUB1.
 14132
 14133     IF SK-MO (SUB1) = 'S'
 14134         SUBTRACT 1 FROM WS-WORK-TERM.
 14135
 14136     ADD 1 TO SUB2
 14137              SUB1.
 14138
 14139 3320-RATE-CONTINUE.
 14140
 14141     IF WS-WORK-TERM = ZERO
 14142         MOVE 1                  TO WS-WORK-TERM.
 14143
 14144     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14145                                    CP-LOAN-TERM.
 14146
 14147     IF PB-COMPANY-ID EQUAL 'DMD'
 14148         NEXT SENTENCE
 14149     ELSE
 14150         MOVE ZERO               TO PB-I-AH-RATE
 14151                                    PB-I-AH-REI-RATE.
 14152
 14153
 14154     IF PB-COMPANY-ID EQUAL 'CRI'
 14155        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14156
 14157     IF PB-COMPANY-ID = 'CSL'
 14158         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14159         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14160         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14161         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14162
 14163     IF PB-COMPANY-ID = 'DCC'
 14164        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14165           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14166              PB-I-RATE-DEV-PCT-LF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 256
* EL050.cbl
 14167        END-IF
 14168        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14169                                 TO CP-ALTERNATE-BENEFIT
 14170        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14171        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14172        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14173     END-IF
 14174     IF (PB-COMPANY-ID = 'CID')
 14175        AND (WS-LF-EARNINGS-CALC = 'B')
 14176        AND (CP-STATE-STD-ABBRV = 'MN')
 14177        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14178     ELSE
 14179        MOVE ' '                 TO CP-AH-BALLOON-SW
 14180     END-IF
 14181     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14182     MOVE 'R'                   TO CP-RATE-FILE.
 14183     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14184
 14185     IF (CP-ERROR-RATE-NOT-FOUND)
 14186        and (not pb-monthly-cert)
 14187        IF PB-I-OB
 14188           MOVE ER-2624          TO WS-ERROR
 14189           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14190           GO TO 3340-CALCULATE-PREMIUM-AMT
 14191        ELSE
 14192          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14193              NEXT SENTENCE
 14194          ELSE
 14195           MOVE ER-2642          TO WS-ERROR
 14196           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14197           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14198
 14199     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14200        CP-ERROR-DIV-BY-ZERO
 14201           MOVE ER-3782          TO WS-ERROR
 14202           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14203
 14204     IF PB-COMPANY-ID EQUAL 'CRI'
 14205        IF CP-ERROR-NO-LIMITS-CRI
 14206           IF NOT ACCOUNT-AH-CHECKED
 14207              MOVE ER-2607          TO WS-ERROR
 14208              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14209
 14210     IF ACCOUNT-AH-CHECKED
 14211        NEXT SENTENCE
 14212     ELSE
 14213       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14214          MOVE ER-2640           TO WS-ERROR
 14215          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14216
 14217     IF PB-COMPANY-ID = 'CRI'
 14218         IF WS-ERROR = ER-2640
 14219             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14220     IF ACCOUNT-AH-CHECKED
 14221        CONTINUE
 14222     ELSE
 14223        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14224           AND (CP-R-MAX-ATT-AGE > +0)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 257
* EL050.cbl
 14225           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14226           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14227              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14228              MOVE PB-I-AH-EXPIRE-DT
 14229                                 TO DC-BIN-DATE-2
 14230              MOVE '1'           TO DC-OPTION-CODE
 14231              PERFORM 8500-DATE-CONVERT
 14232                                 THRU 8500-EXIT
 14233              IF NO-CONVERSION-ERROR
 14234                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14235                    MOVE ER-2661       TO WS-ERROR
 14236*                   PERFORM 9900-ERROR-FORMAT
 14237*                                THRU 9900-EXIT
 14238                 END-IF
 14239              END-IF
 14240           ELSE
 14241              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14242              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14243                 MOVE ER-2661    TO WS-ERROR
 14244*                PERFORM 9900-ERROR-FORMAT
 14245*                                THRU 9900-EXIT
 14246              ELSE
 14247                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14248                    MOVE ER-1570 TO WS-ERROR
 14249                    PERFORM 9900-ERROR-FORMAT
 14250                                 THRU 9900-EXIT
 14251                 END-IF
 14252              END-IF
 14253           END-IF
 14254           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14255              MOVE PB-I-JOINT-BIRTHDAY
 14256                                    TO DC-BIN-DATE-1
 14257              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14258              MOVE '1'              TO DC-OPTION-CODE
 14259              PERFORM 8500-DATE-CONVERT
 14260                                    THRU 8500-EXIT
 14261              IF NO-CONVERSION-ERROR
 14262                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14263                    MOVE ER-2661       TO WS-ERROR
 14264*                   PERFORM 9900-ERROR-FORMAT
 14265*                                   THRU 9900-EXIT
 14266                 END-IF
 14267              END-IF
 14268           ELSE
 14269              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14270                (PB-I-AH-TERM / 12)
 14271              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14272                 MOVE ER-2661       TO WS-ERROR
 14273*                PERFORM 9900-ERROR-FORMAT
 14274*                                   THRU 9900-EXIT
 14275              ELSE
 14276                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14277                    MOVE ER-1571 TO WS-ERROR
 14278                    PERFORM 9900-ERROR-FORMAT
 14279                                 THRU 9900-EXIT
 14280                 END-IF
 14281              END-IF
 14282           END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 258
* EL050.cbl
 14283           IF WS-ERROR = ER-2661
 14284              PERFORM 9900-ERROR-FORMAT
 14285                                    THRU 9900-EXIT
 14286           END-IF
 14287        END-IF
 14288     END-IF
 14289*    IF ACCOUNT-AH-CHECKED
 14290*       NEXT SENTENCE
 14291*    ELSE
 14292*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14293*          MOVE ER-2661          TO WS-ERROR
 14294*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14295
 14296     IF ACCOUNT-AH-CHECKED
 14297        NEXT SENTENCE
 14298     ELSE
 14299        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14300           MOVE ER-2663          TO WS-ERROR
 14301           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14302
 14303     IF ACCOUNT-AH-CHECKED OR
 14304        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14305         PB-POLICY-IS-VOIDED
 14306        NEXT SENTENCE
 14307     ELSE
 14308        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14309           MOVE ER-2667            TO WS-ERROR
 14310           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14311
 14312     IF PB-COMPANY-ID = 'CRI'
 14313         IF WS-ERROR = ER-2667
 14314             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14315
 14316     IF ACCOUNT-AH-CHECKED
 14317        NEXT SENTENCE
 14318     ELSE
 14319        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14320           MOVE ER-2678            TO WS-ERROR
 14321           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14322
 14323     IF CP-ERROR-RATE-FILE-NOTOPEN
 14324         GO TO 3990-FILES-NOT-OPEN.
 14325
 14326 3321-CONTINUE.
 14327     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14328     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14329     IF (PB-COMPANY-ID = 'DCC')
 14330        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14331        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14332                                    PB-I-LF-ALT-PREM-CALC
 14333        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14334        IF WS-AH-BEN-CATEGORY = 'G'
 14335           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14336           + PB-I-ADDL-CLP)
 14337           * (1 + WS-TOL-CLP-PCT)
 14338*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14339        ELSE
 14340           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 259
* EL050.cbl
 14341           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14342*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14343        END-IF
 14344        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14345                                 TO PB-I-AH-PREM-CALC
 14346        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14347           MOVE ER-8152          TO WS-ERROR
 14348           PERFORM 9900-ERROR-FORMAT
 14349                                 THRU 9900-EXIT
 14350        ELSE
 14351           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14352                 PB-I-ADDL-CLP)
 14353              MOVE ER-8148       TO WS-ERROR
 14354              PERFORM 9900-ERROR-FORMAT
 14355                                 THRU 9900-EXIT
 14356           END-IF
 14357        END-IF
 14358     END-IF
 14359     IF (PB-COMPANY-ID = 'DCC')
 14360        AND (PB-I-POLICY-IS-MONTHLY)
 14361        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14362        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14363        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14364           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14365        END-IF
 14366     END-IF
 14367     IF (PB-COMPANY-ID = 'DCC')
 14368        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14369        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14370        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14371        MOVE ER-2786             TO WS-ERROR
 14372        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14373     END-IF
 14374     MOVE +0                     TO PB-I-AH-CLP
 14375     IF PB-COMPANY-ID = 'DCC'
 14376        evaluate true
 14377           when WS-AH-BEN-CATEGORY = 'D'
 14378              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14379                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14380           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14381              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14382           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14383              COMPUTE PB-I-AH-CLP ROUNDED =
 14384                 PB-I-AH-PREMIUM-AMT * (1 - pb-i-ah-commission)
 14385                    - ws-cred-union-fees
 14386        end-evaluate
 14387     END-IF
 14388     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14389
 14390     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14391         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14392
 14393     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14394         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14395
 14396     if (ws-ah-special-calc-cd = 'E')
 14397        and (pb-monthly-cert)
 14398        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 260
* EL050.cbl
 14399     end-if
 14400     IF PB-COMPANY-ID = 'CRI'
 14401         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14402            PB-I-PAYMENT-AMOUNT = ZERO
 14403             NEXT SENTENCE
 14404         ELSE
 14405             COMPUTE PB-I-AH-PREM-CALC =
 14406                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14407                 (CP-PREMIUM-RATE / 100)
 14408             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14409                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14410                                             PB-I-RATE-DEV-PCT-AH.
 14411
 14412     IF (PB-I-AH-RATE  = ZERO)
 14413        and (not pb-monthly-cert)
 14414       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14415           NEXT SENTENCE
 14416       ELSE
 14417         MOVE ER-2642            TO WS-ERROR
 14418         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14419
 14420     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14421     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14422     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14423     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14424     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14425     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14426
 14427     IF (PB-COMPANY-ID = 'DCC')
 14428        AND (WS-AH-BEN-CATEGORY = 'G')
 14429        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14430        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14431        IF CP-DEVIATION-CODE NOT = '000'
 14432           MOVE '000'            TO CP-DEVIATION-CODE
 14433           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14434           IF NO-CP-ERROR
 14435              COMPUTE PB-I-DDF-IU-RATE-UP =
 14436              PB-I-AH-CLP - CP-CALC-PREMIUM
 14437           ELSE
 14438              MOVE ER-3057        TO WS-ERROR
 14439              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14440           END-IF
 14441        END-IF
 14442     END-IF
 14443     .
 14444 3335-EDIT-AH-REIN-NSP-RATE.
 14445     IF PB-COMPANY-ID = 'DCC'
 14446        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14447              COMPUTE PB-I-AH-CLP ROUNDED =
 14448                 PB-I-AH-PREMIUM-AMT * (1 - pb-i-ah-commission)
 14449                    - ws-cred-union-fees
 14450        end-if
 14451     END-IF
 14452     IF AH-REIN-NSP-NOT-USED
 14453         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14454
 14455     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14456     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 261
* EL050.cbl
 14457         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14458     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14459     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14460     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14461     MOVE PB-SV-STATE            TO CP-STATE.
 14462     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14463     MOVE ZERO                   TO CP-DEVIATION-CODE
 14464                                    CP-RATE-DEV-PCT.
 14465*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14466     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14467     MOVE '3'                    TO CP-PROCESS-TYPE.
 14468     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14469     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14470                                    CP-RATING-BENEFIT-AMT.
 14471     IF CP-STATE-STD-ABBRV = 'OR'
 14472         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14473                                         PB-I-AH-TERM.
 14474     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14475     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14476     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14477     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14478     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14479     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14480                                    CP-REMAINING-TERM
 14481                                    WS-WORK-TERM.
 14482     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14483     IF PB-COMPANY-ID = 'DCC'
 14484        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14485     END-IF
 14486     IF  PB-COMPANY-ID = 'TIC'
 14487         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14488            MOVE ZERO TO CP-CLASS-CODE.
 14489
 14490     IF PB-COMPANY-ID NOT = 'TIC'
 14491          MOVE ZERO          TO CP-CLASS-CODE.
 14492
 14493     MOVE ZERO               TO CP-DEVIATION-CODE.
 14494
 14495     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14496
 14497     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14498
 14499     MOVE 'R'                   TO CP-RATE-FILE.
 14500     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14501
 14502     IF CP-ERROR-RATE-NOT-FOUND
 14503         MOVE ER-2645        TO WS-ERROR
 14504         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14505         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14506
 14507     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14508
 14509     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14510     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14511
 14512     IF PB-I-AH-REI-RATE = ZERO
 14513         MOVE ER-2645        TO WS-ERROR
 14514         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 262
* EL050.cbl
 14515
 14516
 14517 3340-CALCULATE-PREMIUM-AMT.
 14518
 14519     IF PB-COMPANY-ID = 'NCL'
 14520         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14521             WS-AH-SPECIAL-CALC-CD = 'O')
 14522             GO TO 3999-END-EDIT.
 14523
 14524     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14525                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14526                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14527                         OR 'AHL'
 14528         NEXT SENTENCE
 14529     ELSE
 14530         IF WS-STATE-ABBREVIATION = 'CT'
 14531             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14532                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14533                 COMPUTE PB-I-LF-PREM-CALC =
 14534                                     PB-I-LF-PREM-CALC * .90
 14535                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14536                                     PB-I-LF-ALT-PREM-CALC * .90
 14537                 COMPUTE PB-I-AH-PREM-CALC =
 14538                                     PB-I-AH-PREM-CALC * .90.
 14539
 14540     IF PB-COMP-LF-PREM
 14541        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14542        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14543
 14544     IF PB-COMP-AH-PREM
 14545        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14546
 14547 3340-CHECK-DCC-TOT-FEES.
 14548     IF (PB-COMPANY-ID = 'DCC')
 14549        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14550        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14551        AND (PB-I-POLICY-IS-MONTHLY)
 14552        CONTINUE
 14553     ELSE
 14554        GO TO 3340-EDIT-LF-AH-TOL
 14555     END-IF
 14556     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14557     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14558     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14559        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14560           PB-I-RATE-DEV-PCT-LF
 14561     END-IF
 14562     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14563        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14564           PB-I-RATE-DEV-PCT-AH
 14565     END-IF
 14566     MOVE 'N'                    TO CP-BEN-CATEGORY
 14567     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14568
 14569     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14570     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14571     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14572     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 263
* EL050.cbl
 14573     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14574     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14575     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14576     MOVE '3'                    TO CP-PROCESS-TYPE.
 14577     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14578     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14579
 14580     MOVE PB-SV-STATE            TO CP-STATE.
 14581     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14582     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14583     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14584     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14585     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14586                                    CP-RATING-BENEFIT-AMT.
 14587     IF CP-STATE-STD-ABBRV = 'OR'
 14588         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14589                                         PB-I-LF-ALT-BENEFIT-AMT.
 14590     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14591     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14592     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14593     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14594     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14595     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14596     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14597     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14598     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14599                                    CP-REMAINING-TERM
 14600                                    CP-LOAN-TERM.
 14601     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14602        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14603           PB-I-LF-PREMIUM-AMT
 14604     end-if
 14605
 14606     IF CP-TRUNCATED-LIFE
 14607        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14608
 14609     IF CP-TERM-IS-DAYS
 14610         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14611     ELSE
 14612         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14613
 14614     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14615     IF CP-SPECIAL-CALC-CD = 'H'
 14616         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14617                                    TO CP-ALTERNATE-BENEFIT
 14618         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14619     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14620     MOVE 'R'                    TO CP-RATE-FILE
 14621     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14622     IF NOT CP-ERROR-RATE-NOT-FOUND
 14623        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14624        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14625           AND (CP-BENEFIT-CD (1:1) = 'S')
 14626           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14627                                    PB-I-LF-PREMIUM-AMT
 14628        END-IF
 14629     ELSE
 14630        MOVE +0                  TO PB-I-TOT-FEES-CALC
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 264
* EL050.cbl
 14631     END-IF
 14632     .
 14633 3340-EDIT-LF-AH-TOL.
 14634
 14635***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14636***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14637***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14638***
 14639     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14640         PB-I-AH-PREMIUM-AMT
 14641          GIVING WS-CALC-WORK.
 14642
 14643     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14644        AND WS-CALC-WORK NOT = ZERO
 14645         MOVE ER-2649            TO WS-ERROR
 14646         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14647
 14648     SUBTRACT PB-I-LF-PREM-CALC
 14649             FROM PB-I-LF-PREMIUM-AMT
 14650                 GIVING WS-UNSIGN-WRK1.
 14651
 14652     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14653             FROM PB-I-LF-ALT-PREMIUM-AMT
 14654                 GIVING WS-UNSIGN-WRK4.
 14655
 14656     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14657                                + WS-UNSIGN-WRK4.
 14658
 14659     SUBTRACT PB-I-AH-PREM-CALC
 14660             FROM PB-I-AH-PREMIUM-AMT
 14661                 GIVING WS-UNSIGN-WRK2.
 14662
 14663******************************************************************
 14664*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14665******************************************************************
 14666
 14667     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14668         MOVE ZERO TO WS-UNSIGN-WRK1.
 14669
 14670     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14671         MOVE ZERO TO WS-UNSIGN-WRK2.
 14672
 14673     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14674             GIVING WS-UNSIGN-WRK3.
 14675
 14676 3342-CONTINUE.
 14677
 14678     IF (PB-I-LF-RATE = ZERO  AND
 14679         PB-I-AH-RATE = ZERO)
 14680         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14681            WS-AH-SPECIAL-CALC-CD = 'O'
 14682              NEXT SENTENCE
 14683         ELSE
 14684             GO TO 3345-EDIT-CONTINUE.
 14685
 14686     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14687         NEXT SENTENCE
 14688     ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 265
* EL050.cbl
 14689     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14690        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14691           IF (PB-REISSUED-CERT         OR
 14692               PB-POLICY-IS-DECLINED    OR
 14693               PB-POLICY-IS-VOIDED)
 14694              NEXT SENTENCE
 14695           ELSE
 14696              IF WS-PREM-REJECT-SW = SPACE
 14697                 MOVE ER-2652    TO WS-ERROR
 14698                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14699                 GO TO 3344-CHECK-AH
 14700              ELSE
 14701                 MOVE ER-2650    TO WS-ERROR
 14702                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14703                 GO TO 3344-CHECK-AH.
 14704
 14705***
 14706***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14707***
 14708
 14709     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14710         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14711            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14712             (1 + WS-TOL-LF-PREM-PCT)
 14713         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14714            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14715             (1 - WS-TOL-LF-PREM-PCT)
 14716     ELSE
 14717         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14718         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14719
 14720***
 14721***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14722***
 14723
 14724     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14725         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14726          WS-TOL-LF-PREM.
 14727
 14728     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14729         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14730          WS-TOL-LF-PREM.
 14731
 14732     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14733        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14734
 14735     IF PB-REISSUED-CERT
 14736        or PB-POLICY-IS-DECLINED
 14737        or PB-POLICY-IS-VOIDED
 14738        continue
 14739     ELSE
 14740        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14741              > WS-TOL-LF-HIGH-PREM-AMT)
 14742           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14743              < WS-TOL-LF-LOW-PREM-AMT))
 14744                      or
 14745           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14746              > WS-TOL-LF-HIGH-PREM-PCT)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 266
* EL050.cbl
 14747           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14748              < WS-TOL-LF-LOW-PREM-PCT))
 14749           IF WS-PREM-REJECT-SW = SPACE
 14750              MOVE ER-2652       TO WS-ERROR
 14751              PERFORM 9900-ERROR-FORMAT
 14752                                 THRU 9900-EXIT
 14753           ELSE
 14754              MOVE ER-2650       TO WS-ERROR
 14755              PERFORM 9900-ERROR-FORMAT
 14756                                 THRU 9900-EXIT
 14757           end-if
 14758        end-if
 14759     end-if
 14760
 14761*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14762*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14763*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14764*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14765
 14766     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14767        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14768                      OR
 14769           ((PB-COMPANY-ID = 'DCC')
 14770           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14771           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14772           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14773        END-IF
 14774     END-IF
 14775
 14776     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14777        IF WS-COMP-MAX-CAP GREATER THAN +0
 14778           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14779              IF (PB-REISSUED-CERT         OR
 14780                  PB-POLICY-IS-DECLINED    OR
 14781                  PB-POLICY-IS-VOIDED)
 14782                 NEXT SENTENCE
 14783              ELSE
 14784                  MOVE ER-2646   TO  WS-ERROR
 14785                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14786
 14787 3344-CVL-TOLERANCE-CHECK.
 14788
 14789      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14790          GO TO 3344-CHECK-AH.
 14791
 14792      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14793          GO TO 3344-CHECK-AH.
 14794
 14795      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14796                                     WS-UNSIGN-WRK6.
 14797
 14798      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14799          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14800                                 + PB-I-LF-PREMIUM-AMT
 14801                                 - PB-I-LF-PREM-CALC.
 14802
 14803      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14804          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 267
* EL050.cbl
 14805                                 + PB-I-LF-ALT-PREMIUM-AMT
 14806                                 - PB-I-LF-ALT-PREM-CALC.
 14807
 14808      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14809          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14810              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14811                 MOVE ER-2652    TO  WS-ERROR
 14812                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14813              ELSE
 14814                 MOVE ER-2650    TO  WS-ERROR
 14815                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14816
 14817      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14818          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14819              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14820                 MOVE ER-2652    TO  WS-ERROR
 14821                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14822              ELSE
 14823                 MOVE ER-2650    TO  WS-ERROR
 14824                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14825
 14826 3344-CHECK-AH.
 14827
 14828****************************************************************
 14829***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14830***
 14831
 14832     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14833         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14834             (1 + WS-TOL-AH-PREM-PCT)
 14835         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14836             (1 - WS-TOL-AH-PREM-PCT)
 14837     ELSE
 14838         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14839         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14840
 14841***
 14842***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14843***
 14844
 14845     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14846         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14847
 14848     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14849         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14850
 14851     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14852        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14853
 14854     IF (PB-REISSUED-CERT)
 14855        OR (PB-POLICY-IS-DECLINED)
 14856        OR (PB-POLICY-IS-VOIDED)
 14857        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14858        CONTINUE
 14859     ELSE
 14860        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14861              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14862                          or
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 268
* EL050.cbl
 14863           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14864              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14865           IF WS-PREM-REJECT-SW = SPACE
 14866              MOVE ER-3052       TO WS-ERROR
 14867              PERFORM 9900-ERROR-FORMAT
 14868                                 THRU 9900-EXIT
 14869           ELSE
 14870              MOVE ER-3050       TO WS-ERROR
 14871              PERFORM 9900-ERROR-FORMAT
 14872                                 THRU 9900-EXIT
 14873           END-IF
 14874        END-IF
 14875     END-IF
 14876     if (pb-company-id = 'DCC')
 14877        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14878        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14879        and (pb-i-policy-is-monthly)
 14880        compute ws-tol-ah-high-prem-amt =
 14881           pb-i-tot-fees-calc + ws-tol-ah-prem
 14882        compute ws-tol-ah-low-prem-amt =
 14883           pb-i-tot-fees-calc - ws-tol-ah-prem
 14884        if ws-tol-ah-prem-pct > zeros
 14885           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14886              (1 + ws-tol-ah-prem-pct)
 14887           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14888              (1 - ws-tol-ah-prem-pct)
 14889        else
 14890           move +9999999.99      to ws-tol-ah-high-prem-pct
 14891           move +0               to ws-tol-ah-low-prem-pct
 14892        end-if
 14893        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14894            or
 14895           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14896                          or
 14897           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14898           or
 14899           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14900            move er-3049         to ws-error
 14901           perform 9900-error-format
 14902                                 thru 9900-exit
 14903
 14904        end-if
 14905     end-if
 14906     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14907         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14908             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14909             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14910
 14911     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14912        IF WS-COMP-MAX-CAP GREATER THAN +0
 14913           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14914              IF (PB-REISSUED-CERT         OR
 14915                  PB-POLICY-IS-DECLINED    OR
 14916                  PB-POLICY-IS-VOIDED)
 14917                 NEXT SENTENCE
 14918              ELSE
 14919                  MOVE ER-2646   TO  WS-ERROR
 14920                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 269
* EL050.cbl
 14921
 14922     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14923        (WS-COMP-MAX-CAP EQUAL +0)
 14924           GO TO 3345-EDIT-CONTINUE.
 14925
 14926     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14927        GREATER THAN WS-COMP-MAX-CAP
 14928           MOVE ER-2646          TO  WS-ERROR
 14929           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14930
 14931 3345-EDIT-CONTINUE.
 14932
 14933*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14934*       IF PB-ENTRY-BATCH   NUMERIC
 14935*          IF PB-ISSUE
 14936*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14937*          ELSE
 14938*              IF PB-CANCELLATION
 14939*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14940
 14941*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14942*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14943*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14944*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14945*        ELSE
 14946*            MOVE  ER-1909            TO  WS-ERROR
 14947*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14948
 14949     IF PB-I-POLICY-ACCEPTED
 14950        IF PB-POLICY-IS-DECLINED  OR
 14951           PB-REISSUED-CERT  OR
 14952           PB-REIN-ONLY-CERT  OR
 14953           PB-POLICY-IS-VOIDED
 14954            MOVE  ER-1891         TO  WS-ERROR
 14955            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14956        ELSE
 14957            MOVE SPACE            TO  PB-BATCH-ENTRY
 14958            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14959
 14960     IF PB-I-POLICY-DECLINED
 14961        IF PB-REISSUED-CERT  OR
 14962           PB-REIN-ONLY-CERT  OR
 14963           PB-POLICY-IS-VOIDED
 14964            MOVE  ER-1906         TO  WS-ERROR
 14965            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14966        ELSE
 14967            MOVE  'D'             TO  PB-BATCH-ENTRY
 14968                                      PB-I-ENTRY-STATUS.
 14969
 14970     IF PB-I-NEEDS-UNDERWRITING
 14971        IF PB-POLICY-IS-DECLINED OR
 14972           PB-REISSUED-CERT  OR
 14973           PB-REIN-ONLY-CERT  OR
 14974           PB-POLICY-IS-VOIDED
 14975            MOVE  ER-1907         TO  WS-ERROR
 14976            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14977        ELSE
 14978            MOVE 'U'              TO  PB-BATCH-ENTRY
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 270
* EL050.cbl
 14979                                      PB-I-ENTRY-STATUS.
 14980
 14981     IF PB-NEEDS-UNDERWRITING
 14982        MOVE  ER-1901             TO  WS-ERROR
 14983        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14984     IF PB-COMPANY-ID = 'DCC'
 14985        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14986        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14987        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14988           AND (NOT WS-LF-CASH))
 14989                           OR
 14990           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14991           AND (NOT WS-AH-CASH)))
 14992                       AND
 14993           (PB-I-ENTRY-STATUS NOT = '5')
 14994           MOVE 'M'              TO PB-BATCH-ENTRY
 14995                                    PB-I-ENTRY-STATUS
 14996        END-IF
 14997     END-IF
 14998     IF  PB-COMPANY-ID NOT = 'NCL'
 14999         GO TO 3999-END-EDIT.
 15000
 15001     IF PB-REISSUED-CERT  OR
 15002        PB-POLICY-IS-DECLINED  OR
 15003        PB-POLICY-IS-VOIDED  OR
 15004        PB-I-OB
 15005         GO TO 3999-END-EDIT.
 15006
 15007     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15008         MOVE  ER-2644            TO  WS-ERROR
 15009         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15010         GO TO 3999-END-EDIT.
 15011
 15012     MOVE 'N'                     TO  FORM-MASTER-SW.
 15013     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15014
 15015     IF NOT FORM-MASTER-FOUND
 15016         GO TO 3999-END-EDIT.
 15017
 15018     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15019                                      FORM-MASTER-AH-SW.
 15020
 15021     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15022         MOVE  +1                 TO SUB6
 15023         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15024
 15025     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15026         MOVE  +1                 TO SUB6
 15027         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15028
 15029     IF LF-FORM-MASTER-FOUND  OR
 15030        AH-FORM-MASTER-FOUND
 15031         GO TO 3360-CHECK-FORM-LIMITS
 15032     ELSE
 15033         GO TO 3999-END-EDIT.
 15034
 15035******************************************************************
 15036*                  3350-GET-ERFORM                               *
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 271
* EL050.cbl
 15037*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15038*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15039******************************************************************
 15040
 15041 3350-GET-ERFORM.
 15042
 15043     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15044         GO TO  3350-ERFORM-GETMAIN.
 15045
 15046     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15047     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15048     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15049     MOVE 'Y'                     TO FORM-MASTER-SW.
 15050
 15051     IF PB-CANCELLATION
 15052         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15053            PB-SV-STATE          EQUAL   FO-STATE       AND
 15054            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15055              GO TO 3350-EXIT
 15056         ELSE
 15057             NEXT SENTENCE
 15058     ELSE
 15059         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15060            PB-SV-STATE          EQUAL   FO-STATE       AND
 15061            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15062              GO TO 3350-EXIT.
 15063
 15064 3350-ERFORM-GETMAIN.
 15065
 15066     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15067     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15068
 15069 3350-ERFORM-READ.
 15070
 15071     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15072     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15073     IF PB-CANCELLATION
 15074         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15075     ELSE
 15076         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15077     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15078
 15079     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15080
 15081     IF FORM-MASTER-FOUND
 15082       IF PB-CANCELLATION
 15083          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15084             PB-SV-STATE          EQUAL   FO-STATE       AND
 15085             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15086              GO  TO 3350-EXIT
 15087          ELSE
 15088              NEXT SENTENCE
 15089       ELSE
 15090          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15091             PB-SV-STATE          EQUAL   FO-STATE       AND
 15092             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15093              GO  TO 3350-EXIT.
 15094
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 272
* EL050.cbl
 15095     MOVE  'N'                    TO  FORM-MASTER-SW.
 15096     MOVE  ER-1895                TO  WS-ERROR.
 15097     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15098
 15099 3350-EXIT.
 15100      EXIT.
 15101
 15102******************************************************************
 15103*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15104*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15105*   VALID FOR THE POLICY FORM USED.                              *
 15106******************************************************************
 15107
 15108 3355-EDIT-FORM-LF-BENEFITS.
 15109
 15110     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15111        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15112         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15113         GO TO   3355-EXIT.
 15114
 15115     IF  SUB6    LESS THAN   +40
 15116         ADD  +1      TO  SUB6
 15117         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15118
 15119     MOVE  ER-1896         TO  WS-ERROR.
 15120     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15121
 15122 3355-EXIT.
 15123      EXIT.
 15124
 15125******************************************************************
 15126*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15127*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15128*   VALID FOR THE POLICY FORM USED.                              *
 15129******************************************************************
 15130
 15131 3356-EDIT-FORM-AH-BENEFITS.
 15132
 15133     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15134        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15135         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15136         GO TO  3356-EXIT.
 15137
 15138      IF  SUB6    LESS THAN     +40
 15139          ADD  +1      TO  SUB6
 15140          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15141
 15142     MOVE  ER-1897         TO  WS-ERROR.
 15143     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15144
 15145 3356-EXIT.
 15146      EXIT.
 15147
 15148******************************************************************
 15149*                  3357-BENEFIT-SEARCH                           *
 15150*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15151*   CANCELLATIONS ONLY.                                          *
 15152******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 273
* EL050.cbl
 15153 3357-BENEFIT-SEARCH.
 15154     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15155         MOVE +1                          TO SUB6
 15156         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15157
 15158     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15159         MOVE +1                          TO SUB6
 15160         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15161
 15162 3357-EXIT.
 15163     EXIT.
 15164
 15165******************************************************************
 15166*                  3358-BENEFIT-LIFE-SEARCH                      *
 15167*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15168*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15169*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15170******************************************************************
 15171 3358-BENEFIT-LIFE-SEARCH.
 15172     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15173       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15174         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15175           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15176              IF FO-PLAN-REFUND-METHOD (SUB6)
 15177                     IS GREATER THAN SPACES
 15178                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15179                                          WS-LF-REFUND-CALC
 15180                 GO TO 3358-EXIT.
 15181
 15182     IF SUB6 LESS THAN +40
 15183         ADD +1                 TO SUB6
 15184         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15185
 15186 3358-EXIT.
 15187     EXIT.
 15188******************************************************************
 15189*                  3359-BENEFIT-AH-SEARCH                        *
 15190*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15191*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15192*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15193******************************************************************
 15194 3359-BENEFIT-AH-SEARCH.
 15195     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15196       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15197         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15198           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15199              IF FO-PLAN-REFUND-METHOD (SUB6)
 15200                      IS GREATER THAN SPACES
 15201                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15202                                          WS-AH-REFUND-CALC
 15203                 GO TO 3359-EXIT.
 15204
 15205     IF SUB6 LESS THAN +40
 15206         ADD +1                 TO SUB6
 15207         GO TO 3359-BENEFIT-AH-SEARCH.
 15208
 15209 3359-EXIT.
 15210     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 274
* EL050.cbl
 15211
 15212******************************************************************
 15213*                  3360-CHECK-FORM-LIMITS                        *
 15214*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15215*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15216******************************************************************
 15217
 15218 3360-CHECK-FORM-LIMITS.
 15219
 15220     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15221         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15222
 15223     IF NOT LF-FORM-MASTER-FOUND
 15224         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15225
 15226 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15227
 15228     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15229       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15230        WS-LF-JOINT-INDICATOR = 'J'  AND
 15231        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15232         IF PB-COMPANY-ID = 'NCL'
 15233            MOVE  ER-1911          TO  WS-ERROR
 15234            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15235         ELSE
 15236            MOVE  ER-1892          TO  WS-ERROR
 15237            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15238
 15239 3360-CHECK-FORM-LF-ATT-AGE.
 15240
 15241     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15242
 15243     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15244         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15245         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15246            IF PB-COMPANY-ID = 'NCL'
 15247                MOVE  ER-1913      TO  WS-ERROR
 15248                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15249            ELSE
 15250                MOVE  ER-1894      TO  WS-ERROR
 15251                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15252
 15253 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15254
 15255     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15256         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15257         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15258            IF PB-COMPANY-ID = 'NCL'
 15259                MOVE  ER-1914      TO  WS-ERROR
 15260                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15261            ELSE
 15262                MOVE  ER-1899      TO  WS-ERROR
 15263                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15264
 15265 3360-CHECK-FORM-LF-TERM-BAMT.
 15266
 15267     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15268         FO-LF-MAX-TERM   GREATER THAN   ZEROS
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 275
* EL050.cbl
 15269         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15270           IF  PB-COMPANY-ID = 'NCL'
 15271               MOVE  ER-1916       TO  WS-ERROR
 15272               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15273           ELSE
 15274               MOVE  ER-1902       TO  WS-ERROR
 15275               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15276
 15277     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15278                                    PB-I-LF-ALT-BENEFIT-AMT.
 15279
 15280     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15281         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15282         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15283             IF  PB-COMPANY-ID = 'NCL'
 15284                 MOVE  ER-1918     TO  WS-ERROR
 15285                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15286             ELSE
 15287                 MOVE  ER-1904     TO  WS-ERROR
 15288                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15289
 15290******************************************************************
 15291*                  3360-CHECK-FORM-AH-LIMITS                     *
 15292*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15293*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15294******************************************************************
 15295
 15296 3360-CHECK-FORM-AH-LIMITS.
 15297
 15298     IF NOT AH-FORM-MASTER-FOUND
 15299         GO TO 3999-END-EDIT.
 15300
 15301 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15302
 15303     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15304       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15305        WS-AH-JOINT-INDICATOR = 'J'  AND
 15306        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15307         IF PB-COMPANY-ID = 'NCL'
 15308            MOVE  ER-1912          TO  WS-ERROR
 15309            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15310         ELSE
 15311            MOVE  ER-1893          TO  WS-ERROR
 15312            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15313
 15314 3360-CHECK-FORM-AH-ATT-AGE.
 15315
 15316     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15317
 15318     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15319         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15320         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15321            IF PB-COMPANY-ID = 'NCL'
 15322                MOVE  ER-1913      TO  WS-ERROR
 15323                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15324            ELSE
 15325                MOVE  ER-1894      TO  WS-ERROR
 15326                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 276
* EL050.cbl
 15327
 15328 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15329
 15330     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15331         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15332         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15333            IF PB-COMPANY-ID = 'NCL'
 15334                MOVE  ER-1915      TO  WS-ERROR
 15335                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15336            ELSE
 15337                MOVE  ER-1900      TO  WS-ERROR
 15338                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15339
 15340 3360-CHECK-FORM-AH-TERM-BAMT.
 15341
 15342     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15343         FO-AH-MAX-TERM    GREATER THAN  +0
 15344         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15345             IF  PB-COMPANY-ID = 'NCL'
 15346                 MOVE  ER-1917     TO  WS-ERROR
 15347                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15348             ELSE
 15349                  MOVE  ER-1903    TO  WS-ERROR
 15350                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15351
 15352     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15353         FO-MAX-AH-AMT    GREATER THAN  +0
 15354         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15355             IF  PB-COMPANY-ID = 'NCL'
 15356                 MOVE  ER-1919     TO  WS-ERROR
 15357                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15358             ELSE
 15359                 MOVE  ER-1905     TO  WS-ERROR
 15360                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15361
 15362     GO TO 3999-END-EDIT.
 15363
 15364******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 277
* EL050.cbl
 15366******************************************************************
 15367*                  E D I T   C A N C E L                         *
 15368******************************************************************
 15369
 15370 3700-EDIT-CANCEL.
 15371     IF PB-COMPANY-ID = 'DMD'
 15372         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15373                                         WS-RES-MUNI-TAX
 15374                                         PB-CI-STATE-TAX
 15375                                         PB-CI-MUNI-TAX
 15376         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15377
 15378*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15379*       IF PB-ENTRY-BATCH  NUMERIC
 15380*          IF PB-CANCELLATION
 15381*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15382*          ELSE
 15383*             IF PB-ISSUE
 15384*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15385
 15386     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15387        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15388     END-IF
 15389*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15390*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15391
 15392     IF CM-ENTRY-STATUS = 'V'
 15393        MOVE ER-2780             TO WS-ERROR
 15394        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15395        GO TO 3999-END-EDIT.
 15396
 15397     IF CM-ENTRY-STATUS = 'D'
 15398        MOVE ER-2781             TO WS-ERROR
 15399        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15400        GO TO 3999-END-EDIT.
 15401
 15402     IF CM-ENTRY-STATUS = 'U'
 15403        MOVE ER-2782             TO WS-ERROR
 15404        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15405
 15406***************************************************************
 15407*                                                             *
 15408*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15409*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15410*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15411*   OF ANOTHER COVERAGE.                                      *
 15412*                                                             *
 15413***************************************************************
 15414
 15415     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15416                                    PB-C-AH-CANCEL-VOID-SW.
 15417
 15418     IF PB-C-LF-CANCEL-AMT = ZERO
 15419        NEXT SENTENCE
 15420     ELSE
 15421        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15422           AND
 15423           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 278
* EL050.cbl
 15424               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15425               MOVE ER-2745           TO WS-ERROR
 15426               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15427
 15428     IF PB-C-AH-CANCEL-AMT = ZERO
 15429        NEXT SENTENCE
 15430     ELSE
 15431        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15432           AND
 15433           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15434               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15435               MOVE ER-2745           TO WS-ERROR
 15436               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15437
 15438     IF WS-LF-EARNINGS-CALC = '4'
 15439        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15440
 15441     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15442     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15443     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15444     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15445     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15446     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15447
 15448     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15449                                      PB-C-AH-REF-CALC.
 15450     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15451
 15452******************************************************************
 15453*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15454*             TO VALIDATE COVERAGE.                              *
 15455******************************************************************
 15456
 15457     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15458        PB-C-LF-CANCEL-AMT = ZEROS
 15459          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15460      ELSE
 15461          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15462
 15463     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15464        PB-C-AH-CANCEL-AMT = ZEROS
 15465          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15466      ELSE
 15467          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15468
 15469     EVALUATE TRUE
 15470         WHEN PB-CANCEL-FORCE             OR
 15471              PB-CANCEL-DATE-FORCED       OR
 15472              PB-FORCE-OFF
 15473                  IF PB-COMPANY-ID = 'ACE'
 15474                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15475                  END-IF
 15476         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15477               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15478              (PB-COMPANY-ID = 'ACE' )
 15479                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15480         WHEN OTHER
 15481              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 279
* EL050.cbl
 15482                 MOVE ER-2794              TO WS-ERROR
 15483              ELSE
 15484                 MOVE ER-2749              TO WS-ERROR
 15485              END-IF
 15486              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15487     END-EVALUATE.
 15488
 15489
 15490*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15491*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15492*            MOVE  ER-1909            TO  WS-ERROR
 15493*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15494*        ELSE
 15495*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15496
 15497     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15498     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15499        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15500     ELSE
 15501        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15502     END-IF
 15503     .
 15504 3705-EDIT-CANCEL-DT.
 15505
 15506     IF LF-COVERAGE-CANCELLED
 15507        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15508         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15509         MOVE WS-CURRENT-MONTH-END
 15510                                 TO DC-BIN-DATE-2
 15511         SET ELAPSED-BETWEEN-BIN TO TRUE
 15512*        MOVE 1                  TO DC-OPTION-CODE
 15513         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15514         IF DATE-CONVERSION-ERROR
 15515            NEXT SENTENCE
 15516          ELSE
 15517             IF DC-ELAPSED-DAYS GREATER +180
 15518                IF PB-CANCEL-DATE-FORCED  OR
 15519                   PB-CANCEL-DATE-FORCED-NO-FEE
 15520                      MOVE ER-2751  TO WS-ERROR
 15521                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15522                 ELSE
 15523                   MOVE ER-2752  TO WS-ERROR
 15524                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15525
 15526     IF AH-COVERAGE-CANCELLED
 15527        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15528         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15529         MOVE WS-CURRENT-MONTH-END
 15530                                 TO DC-BIN-DATE-2
 15531         SET ELAPSED-BETWEEN-BIN TO TRUE
 15532*        MOVE 1                  TO DC-OPTION-CODE
 15533         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15534         IF DATE-CONVERSION-ERROR
 15535            NEXT SENTENCE
 15536          ELSE
 15537             IF DC-ELAPSED-DAYS GREATER +180
 15538                IF PB-CANCEL-DATE-FORCED OR
 15539                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 280
* EL050.cbl
 15540                      MOVE ER-2751  TO WS-ERROR
 15541                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15542                 ELSE
 15543                   MOVE ER-2752  TO WS-ERROR
 15544                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15545
 15546     IF WS-ERROR = ER-2752
 15547        AND (PB-COMPANY-ID = 'ABL'
 15548         OR  PB-COMPANY-ID = 'FGL'
 15549         OR  PB-COMPANY-ID = 'IST'
 15550         OR  PB-COMPANY-ID = 'JHL'
 15551         OR  PB-COMPANY-ID = 'LAP'
 15552         OR  PB-COMPANY-ID = 'LBL'
 15553         OR  PB-COMPANY-ID = 'NCB'
 15554         OR  PB-COMPANY-ID = 'NLI'
 15555         OR  PB-COMPANY-ID = 'OFI'
 15556         OR  PB-COMPANY-ID = 'PLI'
 15557         OR  PB-COMPANY-ID = 'TAO'
 15558         OR  PB-COMPANY-ID = 'TIC'
 15559         OR  PB-COMPANY-ID = 'HER'
 15560         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15561         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15562            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15563            MOVE ER-2762     TO WS-ERROR
 15564            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15565
 15566     IF LF-COVERAGE-CANCELLED
 15567        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15568        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15569             MOVE ER-2733         TO WS-ERROR
 15570             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15571
 15572     IF AH-COVERAGE-CANCELLED
 15573        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15574        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15575              MOVE ER-2733        TO WS-ERROR
 15576              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15577
 15578     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15579        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15580        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15581           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15582            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15583              IF PB-COMPANY-ID NOT = 'LAP'
 15584               MOVE ER-2704            TO WS-ERROR
 15585               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15586
 15587     IF CERT-WAS-NOT-FOUND
 15588         GO TO 3999-END-EDIT.
 15589
 15590     IF PB-COMPANY-ID EQUAL 'CDC'
 15591        IF LF-COVERAGE-CANCELLED
 15592           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15593            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15594            MOVE PB-C-LF-CANCEL-DT
 15595                                 TO DC-BIN-DATE-2
 15596            SET ELAPSED-BETWEEN-BIN TO TRUE
 15597*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 281
* EL050.cbl
 15598            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15599            IF DATE-CONVERSION-ERROR
 15600               NEXT SENTENCE
 15601             ELSE
 15602                IF DC-ELAPSED-DAYS GREATER +60
 15603                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15604
 15605     IF PB-COMPANY-ID EQUAL 'CDC'
 15606        IF AH-COVERAGE-CANCELLED
 15607           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15608            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15609            MOVE PB-C-AH-CANCEL-DT
 15610                                 TO DC-BIN-DATE-2
 15611            MOVE +0              TO DC-ELAPSED-DAYS
 15612                                    DC-ELAPSED-MONTHS
 15613            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15614*           MOVE 1               TO DC-OPTION-CODE
 15615            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15616            IF DATE-CONVERSION-ERROR
 15617               NEXT SENTENCE
 15618             ELSE
 15619                IF DC-ELAPSED-DAYS GREATER +60
 15620                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15621
 15622     MOVE +0                     TO DC-ELAPSED-DAYS
 15623                                    DC-ELAPSED-MONTHS.
 15624
 15625     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15626        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15627          MOVE 'Z'                TO PB-CI-OB-FLAG
 15628          MOVE ER-2767            TO WS-ERROR
 15629          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15630          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15631          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15632          GO TO 3775-OVER-REF-CHK
 15633        ELSE
 15634          MOVE ZEROS              TO PB-CI-LIVES
 15635                                     PB-C-LIVES
 15636          IF PB-CI-OB-FLAG NOT = 'B'
 15637             MOVE SPACE           TO PB-CI-OB-FLAG.
 15638
 15639     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15640         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15641     ELSE
 15642         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15643
 15644     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15645        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15646            MOVE ER-2760         TO WS-ERROR
 15647            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15648
 15649     IF LF-COVERAGE-CANCELLED
 15650        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15651         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15652            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15653               MOVE ER-2774       TO WS-ERROR
 15654               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15655
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 282
* EL050.cbl
 15656     IF AH-COVERAGE-CANCELLED
 15657        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15658         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15659            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15660               MOVE ER-2775       TO WS-ERROR
 15661               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15662
 15663     IF LF-COVERAGE-CANCELLED
 15664        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15665         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15666            MOVE ER-2776         TO WS-ERROR
 15667            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15668
 15669     IF AH-COVERAGE-CANCELLED
 15670        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15671         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15672            MOVE ER-2777         TO WS-ERROR
 15673            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15674
 15675     IF LF-COVERAGE-CANCELLED
 15676        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15677        if pb-ci-lf-expire-dt = low-values or spaces
 15678           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15679           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15680           MOVE PB-CI-EXTENTION-DAYS
 15681                                 TO DC-ELAPSED-DAYS
 15682           SET BIN-PLUS-ELAPSED  TO TRUE
 15683           PERFORM 8500-DATE-CONVERT
 15684                                 THRU 8500-EXIT
 15685           IF DATE-CONVERSION-ERROR
 15686              move low-values    to dc-bin-date-2
 15687           end-if
 15688        else
 15689           move pb-ci-lf-expire-dt
 15690                                 to dc-bin-date-2
 15691        end-if
 15692        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15693           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15694                             OR  'FIA'
 15695              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15696           ELSE
 15697              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15698              MOVE ER-2731       TO WS-ERROR
 15699              PERFORM 9900-ERROR-FORMAT
 15700                                 THRU 9900-EXIT
 15701           end-if
 15702        end-if
 15703     end-if
 15704*    IF LF-COVERAGE-CANCELLED
 15705*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15706*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15707*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15708*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15709*        SET BIN-PLUS-ELAPSED      TO TRUE
 15710*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15711*        IF DATE-CONVERSION-ERROR
 15712*           NEXT SENTENCE
 15713*         ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 283
* EL050.cbl
 15714*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15715*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15716*                            OR  'FIA'
 15717*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15718*              ELSE
 15719*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15720*               MOVE ER-2731       TO WS-ERROR
 15721*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15722     .
 15723 3705-EDIT-AH-CANCEL-DT.
 15724     IF AH-COVERAGE-CANCELLED
 15725        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15726        if pb-ci-AH-expire-dt = low-values or spaces
 15727           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15728           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15729           MOVE PB-CI-EXTENTION-DAYS
 15730                                 TO DC-ELAPSED-DAYS
 15731           SET BIN-PLUS-ELAPSED  TO TRUE
 15732           PERFORM 8500-DATE-CONVERT
 15733                                 THRU 8500-EXIT
 15734           IF DATE-CONVERSION-ERROR
 15735              move low-values    to dc-bin-date-2
 15736           end-if
 15737        else
 15738           move pb-ci-ah-expire-dt
 15739                                 to dc-bin-date-2
 15740        end-if
 15741        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15742           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15743                             OR  'FIA'
 15744              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15745           ELSE
 15746              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15747              MOVE ER-2771       TO WS-ERROR
 15748              PERFORM 9900-ERROR-FORMAT
 15749                                 THRU 9900-EXIT
 15750           end-if
 15751        end-if
 15752     end-if
 15753*    IF AH-COVERAGE-CANCELLED
 15754*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15755*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15756*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15757*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15758**       MOVE 6                    TO DC-OPTION-CODE
 15759*        SET BIN-PLUS-ELAPSED      TO TRUE
 15760*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15761*        IF DATE-CONVERSION-ERROR
 15762*           NEXT SENTENCE
 15763*         ELSE
 15764*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15765*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15766*                             OR 'FIA'
 15767*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15768*             ELSE
 15769*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15770*              MOVE ER-2771       TO WS-ERROR
 15771*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 284
* EL050.cbl
 15772     .
 15773 3705-EDIT-CONTINUED.
 15774
 15775*    IF LF-COVERAGE-CANCELLED
 15776*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15777*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15778*            MOVE ER-2727         TO WS-ERROR
 15779*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15780*
 15781*    IF AH-COVERAGE-CANCELLED
 15782*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15783*        IF PB-COMPANY-ID = 'ACE'
 15784*           MOVE ER-2727        TO WS-ERROR
 15785*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15786*        ELSE
 15787*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15788*              MOVE ER-2727     TO WS-ERROR
 15789*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15790
 15791     IF PB-COMPANY-ID = 'ACE'
 15792       IF AH-COVERAGE-CANCELLED
 15793         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15794           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15795              MOVE ER-2732      TO WS-ERROR
 15796              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15797
 15798     IF PB-COMPANY-ID      EQUAL   'HER'
 15799        IF WS-ERROR        EQUAL   ER-2727
 15800            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15801            MOVE  ER-2725          TO  WS-ERROR
 15802            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15803
 15804     IF PB-C-CLAIM-CREATED-CANCEL
 15805            MOVE ER-2748         TO WS-ERROR
 15806            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15807
 15808     IF PB-C-LAST-NAME NOT = SPACES
 15809         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15810            MOVE ER-2747         TO WS-ERROR
 15811            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15812
 15813 3710-EDIT-LUMP-SUM-PRIOR.
 15814
 15815     IF AH-COVERAGE-CANCELLED
 15816         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15817             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15818                MOVE ER-2735    TO WS-ERROR
 15819                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15820
 15821     IF LF-COVERAGE-CANCELLED
 15822         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15823             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15824                MOVE ER-2735    TO WS-ERROR
 15825                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15826
 15827 3710-EDIT-PRIOR-DEATH.
 15828
 15829*    IF LF-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 285
* EL050.cbl
 15830*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15831*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15832*           (NOT PB-CI-OB)
 15833*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15834*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15835*                   MOVE ER-2732  TO WS-ERROR
 15836*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15837*
 15838*    IF AH-COVERAGE-CANCELLED
 15839*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15840*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15841*           (NOT PB-CI-OB)
 15842*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15843*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15844*                   MOVE ER-2732  TO WS-ERROR
 15845*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15846
 15847     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15848         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15849            (NOT PB-COMP-LF-CANCEL)
 15850             NEXT SENTENCE
 15851         ELSE
 15852           IF PB-C-LF-CANCEL-VOIDED
 15853              NEXT SENTENCE
 15854           ELSE
 15855              MOVE ER-2753      TO WS-ERROR
 15856              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15857
 15858     IF CANCEL-FUTURE-DT
 15859         GO TO 3999-END-EDIT.
 15860
 15861 3715-GET-REMAIN-TERM-LF.
 15862
 15863     IF NO-LF-BENEFIT-MATCH  OR
 15864        WS-LF-BENEFIT-CD = ZEROS
 15865        GO TO 3730-GET-AH-REMAIN-TERM.
 15866
 15867     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15868     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15869     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15870     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15871     MOVE PB-SV-STATE            TO CP-STATE.
 15872     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15873     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15874     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15875     MOVE '2'                    TO CP-PROCESS-TYPE.
 15876     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15877     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15878     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15879     IF (PB-COMPANY-ID = 'CID')
 15880        AND (CP-STATE-STD-ABBRV = 'WI')
 15881        MOVE '7'                 TO CP-REM-TERM-METHOD
 15882        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15883     ELSE
 15884        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15885        MOVE WS-REM-TRM-CALC-OPTION
 15886                                 TO CP-REM-TRM-CALC-OPTION
 15887     END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 286
* EL050.cbl
 15888**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15889     IF (PB-COMPANY-ID = 'CID')
 15890        AND (CP-STATE-STD-ABBRV = 'MO')
 15891        AND (PB-CERT-EFF-DT >= X'9B41')
 15892        AND (PB-CERT-EFF-DT <= X'A2FB')
 15893        MOVE '7'                 TO CP-REM-TERM-METHOD
 15894        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15895     END-IF
 15896     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15897                                    CP-LOAN-TERM.
 15898     IF CP-TRUNCATED-LIFE
 15899        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15900
 15901     IF CP-TERM-IS-DAYS
 15902         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15903     ELSE
 15904         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15905
 15906     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15907
 15908     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15909
 15910     IF LF-COVERAGE-CANCELLED
 15911        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15912        NEXT SENTENCE
 15913      ELSE
 15914          GO TO 3730-GET-AH-REMAIN-TERM.
 15915
 15916 3720-GET-LF-REFUND.
 15917
 15918     IF PB-C-LF-CANCEL-VOIDED
 15919        GO TO 3730-GET-AH-REMAIN-TERM
 15920     end-if
 15921
 15922     IF PB-COMPANY-ID EQUAL 'BOA'
 15923         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15924         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15925         GO TO 3730-GET-AH-REMAIN-TERM.
 15926
 15927     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15928        (WS-AH-SPECIAL-CALC-CD = 'M')
 15929         MOVE ER-2767            TO WS-ERROR
 15930         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15931         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15932         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15933         GO TO 3780-UPDATE-CANCEL-CERT.
 15934
 15935*    if (ws-lf-earnings-calc = '6')
 15936*       or (pb-c-lf-refund-override = '6')
 15937*       move cp-remaining-term-1 to cp-remaining-term-2
 15938*    end-if
 15939     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15940
 15941     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15942     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15943     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15944     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15945     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 287
* EL050.cbl
 15946     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15947     IF (PB-COMPANY-ID = 'DCC')
 15948        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15949        IF PDEF-MASTER-FOUND
 15950           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15951              (V1 > +8)
 15952              OR (PD-PROD-CODE (V1) = 'L')
 15953           END-PERFORM
 15954           IF V1 < +9
 15955              MOVE PD-MAX-AMT (V1)
 15956                           TO CP-R-MAX-TOT-BEN
 15957                              EC-AM-LF-MAX-TOT-BEN
 15958           END-IF
 15959        ELSE
 15960        MOVE ' '                 TO PDEF-MASTER-SW
 15961        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15962        MOVE PB-STATE            TO ERPDEF-STATE
 15963        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15964        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15965        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15966        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15967        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15968        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15969        IF PDEF-MASTER-FOUND
 15970           MOVE 'N'              TO PDEF-MASTER-SW
 15971           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15972           IF PDEF-MASTER-FOUND
 15973              IF (ERPDEF-KEY-SAVE (1:16) =
 15974                           PD-CONTROL-PRIMARY (1:16))
 15975                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15976                 CONTINUE
 15977              ELSE
 15978                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15979                 IF (ERPDEF-KEY-SAVE (1:16) =
 15980                           PD-CONTROL-PRIMARY (1:16))
 15981                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15982                    CONTINUE
 15983                 ELSE
 15984                    MOVE 'N'     TO PDEF-MASTER-SW
 15985                 END-IF
 15986              END-IF
 15987
 15988              IF PDEF-MASTER-FOUND
 15989                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15990                    (V1 > +8)
 15991                    OR (PD-PROD-CODE (V1) = 'L')
 15992                 END-PERFORM
 15993                 IF V1 < +9
 15994                    MOVE PD-MAX-AMT (V1)
 15995                                 TO CP-R-MAX-TOT-BEN
 15996                                    EC-AM-LF-MAX-TOT-BEN
 15997                 END-IF
 15998              END-IF
 15999           END-IF
 16000           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16001        END-IF
 16002        END-IF
 16003     END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 288
* EL050.cbl
 16004     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16005
 16006     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16007
 16008     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16009                                    PB-C-LF-REM-TERM.
 16010
 16011     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16012     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16013
 16014     IF PB-COMPANY-ID EQUAL 'FLC'
 16015        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16016           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16017           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16018                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16019                    - CM-LF-ITD-DEATH-AMT
 16020           IF PB-C-LF-REF-CALC LESS THAN +0
 16021              MOVE +0            TO PB-C-LF-REF-CALC
 16022              GO TO 3730-GET-AH-REMAIN-TERM
 16023           ELSE
 16024              GO TO 3730-GET-AH-REMAIN-TERM.
 16025
 16026     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16027                            OR '4' OR '5' OR '6' OR '8'
 16028                            OR '9' OR 'G'
 16029        MOVE PB-C-LF-REFUND-OVERRIDE
 16030                                 TO CP-EARNING-METHOD.
 16031
 16032     if pb-company-id = 'AHL'
 16033        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16034        if cp-class-code = spaces
 16035           move zeros            to cp-class-code
 16036        end-if
 16037     ELSE
 16038        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16039     END-IF
 16040*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16041     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16042     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16043                                    CP-RATING-BENEFIT-AMT.
 16044     IF CP-STATE-STD-ABBRV = 'OR'
 16045         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16046                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16047     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16048     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16049     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16050     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16051     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16052     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16053     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16054     IF WS-DEFAULT-APR NOT NUMERIC
 16055         MOVE ZEROS TO WS-DEFAULT-APR.
 16056****   N O T E   ****
 16057*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16058*      THE OH HARD CODING IN ELCRFNDP
 16059
 16060     IF PB-COMPANY-ID = 'CID'
 16061        IF CP-STATE-STD-ABBRV = 'OH'
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 289
* EL050.cbl
 16062           MOVE WS-LF-EARNINGS-CALC
 16063                                 TO CP-EARNING-METHOD
 16064        END-IF
 16065     END-IF
 16066
 16067****   N O T E   ****
 16068
 16069     IF CP-EARN-AS-NET-PAY
 16070         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16071            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16072                MOVE WS-DEFAULT-APR
 16073                                 TO  CP-LOAN-APR
 16074                MOVE ER-3780     TO  WS-ERROR
 16075                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16076            ELSE
 16077                MOVE ER-3781     TO  WS-ERROR
 16078                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16079*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16080     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16081
 16082     IF CP-REFUND-TYPE-USED NOT = SPACE
 16083         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16084
 16085     IF CP-ERROR-RATE-IS-ZERO OR
 16086        CP-ERROR-RATE-NOT-FOUND
 16087        MOVE ER-2740             TO WS-ERROR
 16088        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16089
 16090     IF CP-ERROR-RATE-FILE-NOTOPEN
 16091        MOVE ER-2617             TO WS-ERROR
 16092        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16093
 16094     IF PB-COMPANY-ID = 'DCC'
 16095        AND PB-CI-ENTRY-STATUS = 'M'
 16096        MOVE +0                  TO PB-C-LF-REF-CALC
 16097     ELSE
 16098        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16099     END-IF
 16100
 16101     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16102         GO TO 3730-GET-AH-REMAIN-TERM.
 16103
 16104*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16105*       ADD +1                   TO PB-C-LF-REM-TERM
 16106*                                   CP-REMAINING-TERM
 16107*                                   CP-ORIGINAL-TERM.
 16108
 16109     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16110     MOVE '2'                    TO CP-EARNING-METHOD
 16111                                    CP-RATING-METHOD.
 16112     IF PB-COMPANY-ID = 'CID'
 16113        IF (CP-STATE-STD-ABBRV = 'MN')
 16114           AND (PB-CERT-EFF-DT > X'A4FF')
 16115           AND (WS-LF-EARNINGS-CALC = 'B')
 16116           MOVE '5'              TO CP-EARNING-METHOD
 16117           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16118        END-IF
 16119     END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 290
* EL050.cbl
 16120     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16121                                        CP-REMAINING-BENEFIT
 16122                                        CP-RATING-BENEFIT-AMT.
 16123     IF CP-STATE-STD-ABBRV = 'OR'
 16124         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16125                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16126     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16127     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16128
 16129     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16130
 16131     IF CP-ERROR-RATE-IS-ZERO OR
 16132        CP-ERROR-RATE-NOT-FOUND
 16133        MOVE ER-2740             TO WS-ERROR
 16134        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16135
 16136     IF CP-ERROR-RATE-FILE-NOTOPEN
 16137        MOVE ER-2617             TO WS-ERROR
 16138        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16139
 16140     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16141
 16142******************************************************************
 16143
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 291
* EL050.cbl
 16145 3730-GET-AH-REMAIN-TERM.
 16146     IF NO-AH-BENEFIT-MATCH  OR
 16147        WS-AH-BENEFIT-CD = ZEROS
 16148         GO TO 3770-CHECK-REFUNDS.
 16149
 16150     IF PB-CI-AH-LUMP-SUM-DISAB
 16151         IF  PB-C-AH-CANCEL-AMT = ZERO
 16152            IF NOT PB-COMP-AH-CANCEL
 16153             GO TO 3770-CHECK-REFUNDS.
 16154
 16155     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16156     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16157     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16158     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16159     MOVE PB-SV-STATE            TO CP-STATE.
 16160     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16161     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16162     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16163     MOVE '2'                    TO CP-PROCESS-TYPE.
 16164     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16165     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16166     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16167     IF (PB-COMPANY-ID = 'CID')
 16168        AND (CP-STATE-STD-ABBRV = 'WI')
 16169        MOVE '7'                 TO CP-REM-TERM-METHOD
 16170        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16171     ELSE
 16172        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16173        MOVE WS-REM-TRM-CALC-OPTION
 16174                                 TO CP-REM-TRM-CALC-OPTION
 16175     END-IF
 16176     IF (PB-COMPANY-ID = 'CID')
 16177        AND (CP-STATE-STD-ABBRV = 'MO')
 16178        AND (PB-CERT-EFF-DT >= X'9B41')
 16179        AND (PB-CERT-EFF-DT <= X'A2FB')
 16180        MOVE '7'                 TO CP-REM-TERM-METHOD
 16181        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16182     END-IF
 16183     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16184                                    CP-LOAN-TERM.
 16185     IF NOT CP-TERM-IS-DAYS
 16186         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16187
 16188     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16189
 16190     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16191
 16192     IF AH-COVERAGE-CANCELLED
 16193        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16194        NEXT SENTENCE
 16195      ELSE
 16196         GO TO 3770-CHECK-REFUNDS.
 16197
 16198 3740-GET-AH-REFUND.
 16199
 16200     IF PB-C-AH-CANCEL-VOIDED
 16201        GO TO 3780-UPDATE-CANCEL-CERT
 16202     END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 292
* EL050.cbl
 16203
 16204     IF PB-COMPANY-ID = 'BOA'
 16205         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16206         GO TO 3770-CHECK-REFUNDS.
 16207
 16208     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16209*    MOVE ' '                    TO DC-OPTION-CODE
 16210     SET BIN-TO-GREG             TO TRUE
 16211     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16212     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16213                                    PB-C-AH-REM-TERM.
 16214     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16215     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16216
 16217     IF PB-COMPANY-ID EQUAL 'FLC'
 16218        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16219           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16220           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16221                    - CM-AH-ITD-AH-PMT)
 16222           IF PB-C-AH-REF-CALC LESS THAN +0
 16223              MOVE +0            TO PB-C-AH-REF-CALC
 16224              GO TO 3770-CHECK-REFUNDS
 16225           ELSE
 16226              GO TO 3770-CHECK-REFUNDS.
 16227
 16228     IF PB-COMPANY-ID = 'DCC'
 16229        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16230            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16231           MOVE 'S'              TO CP-EARNING-METHOD
 16232        END-IF
 16233     END-IF
 16234     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16235                            OR '4' OR '5' OR '6' OR '8'
 16236                            OR '9' OR 'G' OR 'S'
 16237        MOVE PB-C-AH-REFUND-OVERRIDE
 16238                                 TO CP-EARNING-METHOD.
 16239
 16240     if pb-company-id = 'AHL'
 16241        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16242        if cp-class-code = spaces
 16243           move zeros            to cp-class-code
 16244        end-if
 16245     ELSE
 16246        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16247     END-IF
 16248*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16249     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16250     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16251                                    CP-RATING-BENEFIT-AMT.
 16252     IF CP-STATE-STD-ABBRV = 'OR'
 16253         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16254                                         PB-CI-AH-TERM.
 16255     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16256     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16257     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16258     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16259     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16260     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 293
* EL050.cbl
 16261
 16262     IF CP-STATE-STD-ABBRV = 'OH'
 16263        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16264                                AND 'CID' AND 'DCC' AND 'AHL')
 16265           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16266              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16267              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16268              MOVE '6' TO CP-EARNING-METHOD
 16269           END-IF
 16270        END-IF
 16271        IF PB-COMPANY-ID = 'CID'
 16272           IF NO-LIFE-COVERAGE
 16273              IF CP-CRITICAL-PERIOD
 16274                 MOVE '2'       TO CP-EARNING-METHOD
 16275              ELSE
 16276                 MOVE '6'       TO CP-EARNING-METHOD
 16277              END-IF
 16278           ELSE
 16279              IF WS-LF-COVERAGE-TYPE = 'L'
 16280                 MOVE '2'       TO CP-EARNING-METHOD
 16281              ELSE
 16282                 IF (PB-CI-LF-TERM > +60) OR
 16283                    (WS-LF-EARNINGS-CALC = '5')
 16284                    IF CP-CRITICAL-PERIOD
 16285                       MOVE '2'  TO CP-EARNING-METHOD
 16286                    ELSE
 16287                       MOVE '6'  TO CP-EARNING-METHOD
 16288                    END-IF
 16289                 ELSE
 16290                    MOVE '1'     TO CP-EARNING-METHOD
 16291                 END-IF
 16292              END-IF
 16293           END-IF
 16294        END-IF
 16295     END-IF
 16296
 16297*    IF CP-STATE-STD-ABBRV = 'VA'
 16298*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16299*          IF CP-ORIGINAL-TERM GREATER 61
 16300*             MOVE '6' TO CP-EARNING-METHOD
 16301*          ELSE
 16302*             MOVE '1' TO CP-EARNING-METHOD.
 16303
 16304     IF WS-DEFAULT-APR NOT NUMERIC
 16305         MOVE ZEROS TO WS-DEFAULT-APR.
 16306     IF CP-EARN-AS-NET-PAY
 16307         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16308            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16309                MOVE WS-DEFAULT-APR
 16310                                 TO  CP-LOAN-APR
 16311                MOVE ER-3780     TO  WS-ERROR
 16312                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16313            ELSE
 16314                MOVE ER-3781     TO  WS-ERROR
 16315                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16316     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16317     IF PB-COMPANY-ID = 'DCC'
 16318        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 294
* EL050.cbl
 16319        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16320        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16321     END-IF
 16322     IF PB-COMPANY-ID = 'DCC'
 16323        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16324        AND (CP-EARNING-METHOD = 'D')
 16325        AND (CP-CANCEL-REASON NOT = 'R')
 16326        CONTINUE
 16327     ELSE
 16328        GO TO 3750-CONTINUE
 16329     END-IF
 16330     MOVE ' '                    TO DD-IU-SW
 16331     IF NOT PDEF-MASTER-FOUND
 16332        MOVE ' '                 TO PDEF-MASTER-SW
 16333        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16334        MOVE PB-STATE            TO ERPDEF-STATE
 16335        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16336        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16337        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16338        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16339        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16340        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16341        IF PDEF-MASTER-FOUND
 16342           MOVE 'N'              TO PDEF-MASTER-SW
 16343           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16344           IF PDEF-MASTER-FOUND
 16345              IF (ERPDEF-KEY-SAVE (1:16) =
 16346                           PD-CONTROL-PRIMARY (1:16))
 16347                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16348                 CONTINUE
 16349              ELSE
 16350                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16351                 IF (ERPDEF-KEY-SAVE (1:16) =
 16352                           PD-CONTROL-PRIMARY (1:16))
 16353                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16354                    CONTINUE
 16355                 ELSE
 16356                    MOVE ER-2740 TO WS-ERROR
 16357                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16358                    GO TO 3770-CHECK-REFUNDS
 16359                 END-IF
 16360              END-IF
 16361           END-IF
 16362           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16363        END-IF
 16364     END-IF
 16365     IF PDEF-MASTER-FOUND
 16366        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16367           (V1 > +8)
 16368           OR (PD-PROD-CODE (V1) = 'I')
 16369        END-PERFORM
 16370        IF V1 < +9
 16371           SET DD-IU-PRESENT        TO TRUE
 16372        END-IF
 16373        IF WS-AH-DCC-TRUNC = 'T'
 16374           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16375        ELSE
 16376           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 295
* EL050.cbl
 16377        END-IF
 16378        EVALUATE TRUE
 16379           WHEN WS-TERM > +168
 16380              MOVE 15               TO V1
 16381           WHEN WS-TERM > +156
 16382              MOVE 14               TO V1
 16383           WHEN WS-TERM > +144
 16384              MOVE 13               TO V1
 16385           WHEN WS-TERM > +132
 16386              MOVE 12               TO V1
 16387           WHEN WS-TERM > +120
 16388              MOVE 11               TO V1
 16389           WHEN WS-TERM > +108
 16390              MOVE 10               TO V1
 16391           WHEN WS-TERM > +96
 16392              MOVE 9                TO V1
 16393           WHEN WS-TERM > +84
 16394              MOVE 8                TO V1
 16395           WHEN WS-TERM > +72
 16396              MOVE 7                TO V1
 16397           WHEN WS-TERM > +60
 16398              MOVE 6                TO V1
 16399           WHEN WS-TERM > +48
 16400              MOVE 5                TO V1
 16401           WHEN WS-TERM > +36
 16402              MOVE 4                TO V1
 16403           WHEN WS-TERM > +24
 16404              MOVE 3                TO V1
 16405           WHEN WS-TERM > +12
 16406              MOVE 2                TO V1
 16407           WHEN OTHER
 16408              MOVE 1                TO V1
 16409        END-EVALUATE
 16410
 16411        EVALUATE TRUE
 16412*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16413*             < +13)
 16414*             AND (DD-IU-PRESENT)
 16415*             MOVE 2                TO V2
 16416*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16417*             MOVE 1                TO V2
 16418           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16419              MOVE 2                TO V2
 16420           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16421              MOVE 3                TO V2
 16422           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16423              MOVE 4                TO V2
 16424           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16425              MOVE 5                TO V2
 16426           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16427              MOVE 6                TO V2
 16428           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16429              MOVE 7                TO V2
 16430           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16431              MOVE 8                TO V2
 16432           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16433              MOVE 9                TO V2
 16434           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 296
* EL050.cbl
 16435              MOVE 10               TO V2
 16436           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16437              MOVE 11               TO V2
 16438           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16439              MOVE 12               TO V2
 16440           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16441              MOVE 13               TO V2
 16442           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16443              MOVE 14               TO V2
 16444           WHEN OTHER
 16445              MOVE 15               TO V2
 16446        END-EVALUATE
 16447
 16448        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16449                                 TO CP-DDF-LO-FACT
 16450        MOVE PD-UEP-FACTOR (V1 V2)
 16451                                 TO CP-DDF-HI-FACT
 16452
 16453        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16454        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16455        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16456           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16457        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16458        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16459        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16460           + PD-1ST-YR-ADMIN-ALLOW
 16461
 16462        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16463*       IF PI-CLP-YN = 'Y'
 16464*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16465*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16466*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16467*       END-IF
 16468
 16469        IF DD-IU-PRESENT
 16470           MOVE 'I'              TO CP-EARNING-METHOD
 16471        END-IF
 16472        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16473                                     CP-CLP-RATE-UP
 16474        IF CP-IU-RATE-UP NOT = ZEROS
 16475           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16476              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16477           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16478              / (1 - WS-WORK-FACT)
 16479        END-IF
 16480     END-IF
 16481     .
 16482 3750-CONTINUE.
 16483     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16484
 16485     IF CP-REFUND-TYPE-USED NOT = SPACE
 16486         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16487
 16488     IF CP-ERROR-RATE-IS-ZERO OR
 16489        CP-ERROR-RATE-NOT-FOUND
 16490        MOVE ER-2740             TO WS-ERROR
 16491        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16492
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 297
* EL050.cbl
 16493     IF CP-ERROR-RATE-FILE-NOTOPEN
 16494        MOVE ER-2617             TO WS-ERROR
 16495        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16496     IF PB-COMPANY-ID = 'DCC'
 16497        AND PB-CI-ENTRY-STATUS = 'M'
 16498        MOVE +0                  TO PB-C-AH-REF-CALC
 16499     ELSE
 16500        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16501     END-IF
 16502     IF PB-COMPANY-ID = 'DCC'
 16503        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16504        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16505        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16506        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16507        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16508        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16509        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16510        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16511*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16512     END-IF
 16513     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 298
* EL050.cbl
 16515
 16516 3770-CHECK-REFUNDS.
 16517
 16518     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16519        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16520           MOVE ER-2766          TO WS-ERROR
 16521           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16522           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16523           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16524              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16525
 16526     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16527        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16528           MOVE ER-2766          TO WS-ERROR
 16529           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16530           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16531           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16532              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16533
 16534     IF PB-COMP-LF-CANCEL
 16535        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16536        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16537           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16538              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16539
 16540     IF PB-COMP-AH-CANCEL
 16541        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16542        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16543           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16544              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16545
 16546     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16547             GIVING WS-UNSIGN-WRK1
 16548     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16549             GIVING WS-UNSIGN-WRK2.
 16550
 16551     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16552         MOVE ZERO TO WS-UNSIGN-WRK1.
 16553
 16554     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16555         MOVE ZERO TO WS-UNSIGN-WRK2.
 16556
 16557     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16558
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 299
* EL050.cbl
 16560
 16561 3772-CONTINUE.
 16562
 16563**********************************
 16564*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16565*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16566*** DOUBLES THE TOLERANCE AMOUNT.
 16567***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16568**********************************
 16569     IF PB-COMPANY-ID = 'MON'
 16570     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16571         IF WS-REF-REJECT-SW = SPACE
 16572             MOVE ER-2754        TO WS-ERROR
 16573             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16574           ELSE
 16575             MOVE ER-2736        TO WS-ERROR
 16576             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16577**********************************
 16578
 16579 3773-CONTINUE.
 16580
 16581     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16582        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16583           MOVE ER-2723          TO WS-ERROR
 16584           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16585
 16586     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16587        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16588           MOVE ER-2724          TO WS-ERROR
 16589           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16590
 16591     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16592         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16593             (1 + WS-LF-REFUND-OVS-PCT)
 16594     ELSE
 16595         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16596
 16597     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16598         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16599             (1 - WS-TOL-LF-REFUND-PCT)
 16600     ELSE
 16601         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16602
 16603     IF (PB-COMPANY-ID = 'DCC')
 16604        AND (PB-CI-ENTRY-STATUS = 'M')
 16605        AND (PB-C-LF-CANCEL-AMT > +0)
 16606        MOVE ER-3843             TO WS-ERROR
 16607        PERFORM 9900-ERROR-FORMAT
 16608                                 THRU 9900-EXIT
 16609     END-IF
 16610     EVALUATE TRUE
 16611        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16612           CONTINUE
 16613        WHEN PB-C-LF-CANCEL-AMT = +0
 16614                 AND PB-C-LF-REF-CALC > +0
 16615           CONTINUE
 16616        WHEN WS-LF-REFUND-OVS-AMT = 0
 16617                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 300
* EL050.cbl
 16618           CONTINUE
 16619        WHEN OTHER
 16620           IF WS-TOL-LF-REFUND  = +0
 16621              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16622           END-IF
 16623           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16624                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16625                          (PB-C-LF-CANCEL-AMT))
 16626              CONTINUE
 16627           ELSE
 16628              IF WS-LF-REFUND-OVS-AMT = +0
 16629                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16630              END-IF
 16631              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16632                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16633                                       PB-C-LF-CANCEL-AMT)
 16634                 CONTINUE
 16635              ELSE
 16636                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16637                   MOVE ER-2754   TO  WS-ERROR
 16638                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16639                 ELSE
 16640                    MOVE ER-2736   TO  WS-ERROR
 16641                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16642                 END-IF
 16643              END-IF
 16644           END-IF
 16645     END-EVALUATE.
 16646
 16647     EVALUATE TRUE
 16648        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16649           CONTINUE
 16650        WHEN PB-C-LF-CANCEL-AMT = +0
 16651                 AND PB-C-LF-REF-CALC > +0
 16652           CONTINUE
 16653        WHEN OTHER
 16654           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16655               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16656              CONTINUE
 16657           ELSE
 16658              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16659               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16660                CONTINUE
 16661              ELSE
 16662                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16663                     MOVE ER-2754   TO  WS-ERROR
 16664                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16665                 ELSE
 16666                     MOVE ER-2736   TO  WS-ERROR
 16667                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16668                 END-IF
 16669              END-IF
 16670           END-IF
 16671     END-EVALUATE.
 16672
 16673     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16674         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16675             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 301
* EL050.cbl
 16676     ELSE
 16677         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16678
 16679     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16680         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16681             (1 - WS-TOL-AH-REFUND-PCT)
 16682     ELSE
 16683         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16684
 16685     IF (PB-COMPANY-ID = 'DCC')
 16686        AND (PB-CI-ENTRY-STATUS = 'M')
 16687        AND (PB-C-AH-CANCEL-AMT > +0)
 16688        MOVE ER-3843             TO WS-ERROR
 16689        PERFORM 9900-ERROR-FORMAT
 16690                                 THRU 9900-EXIT
 16691     END-IF
 16692     EVALUATE TRUE
 16693        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16694           CONTINUE
 16695*       WHEN PB-C-AH-REF-CALC = +0 AND
 16696*                  PB-C-AH-CANCEL-AMT > +0
 16697        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16698                   PB-C-AH-REF-CALC > +0
 16699           CONTINUE
 16700        WHEN WS-AH-REFUND-OVS-AMT = +0
 16701                AND WS-TOL-AH-REFUND = +0
 16702           CONTINUE
 16703        WHEN OTHER
 16704           IF WS-TOL-AH-REFUND = +0
 16705              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16706           END-IF
 16707           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16708               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16709                                         PB-C-AH-CANCEL-AMT)
 16710              CONTINUE
 16711           ELSE
 16712              IF WS-AH-REFUND-OVS-AMT = +0
 16713                 MOVE +9999999.99 TO
 16714                         WS-AH-REFUND-OVS-AMT
 16715              END-IF
 16716              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16717                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16718                                         PB-C-AH-CANCEL-AMT)
 16719                 CONTINUE
 16720              ELSE
 16721                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16722                    MOVE ER-2754   TO  WS-ERROR
 16723                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16724                 ELSE
 16725                    MOVE ER-2736   TO  WS-ERROR
 16726                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16727                 END-IF
 16728              END-IF
 16729           END-IF
 16730     END-EVALUATE.
 16731
 16732     EVALUATE TRUE
 16733        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 302
* EL050.cbl
 16734           CONTINUE
 16735*       WHEN PB-C-AH-REF-CALC > +0 AND
 16736*                  PB-C-AH-CANCEL-AMT = +0
 16737        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16738                   PB-C-AH-REF-CALC = +0
 16739           CONTINUE
 16740        WHEN OTHER
 16741           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16742               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16743              CONTINUE
 16744           ELSE
 16745              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16746                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16747                 CONTINUE
 16748              ELSE
 16749                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16750                     MOVE ER-2754   TO  WS-ERROR
 16751                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16752                 ELSE
 16753                     MOVE ER-2736   TO  WS-ERROR
 16754                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16755                 END-IF
 16756              END-IF
 16757           END-IF
 16758     END-EVALUATE.
 16759
 16760     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16761        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16762        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16763           AND  PB-C-LF-REF-CALC < +1.00
 16764           AND  PB-C-AH-REF-CALC < +1.00
 16765           CONTINUE
 16766        ELSE
 16767           IF (PB-COMPANY-ID = 'DCC')
 16768              AND (PB-CI-ENTRY-STATUS = 'M')
 16769              CONTINUE
 16770           ELSE
 16771              MOVE ER-2741       TO WS-ERROR
 16772              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16773           END-IF
 16774        END-IF
 16775     END-IF
 16776
 16777     IF (PB-C-LF-CANCEL-AMT = ZERO
 16778        AND WS-LF-BENEFIT-CD NOT = ZERO
 16779        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16780        AND PB-C-LF-REF-CALC NOT = ZERO)
 16781        OR
 16782        (PB-C-LF-CANCEL-AMT = ZERO
 16783        AND WS-LF-BENEFIT-CD NOT = ZERO
 16784        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16785             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16786                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16787                NEXT SENTENCE
 16788             ELSE
 16789                MOVE ER-2739        TO WS-ERROR
 16790                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16791
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 303
* EL050.cbl
 16792     IF (PB-C-AH-CANCEL-AMT = ZERO
 16793        AND WS-AH-BENEFIT-CD NOT = ZERO
 16794        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16795        AND PB-C-AH-REF-CALC NOT = ZERO)
 16796        OR
 16797        (PB-C-AH-CANCEL-AMT = ZERO
 16798        AND WS-AH-BENEFIT-CD NOT = ZERO
 16799        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16800             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16801                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16802                NEXT SENTENCE
 16803             ELSE
 16804                MOVE ER-2738        TO WS-ERROR
 16805                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16806
 16807 3775-OVER-REF-CHK.
 16808
 16809     IF PB-CI-ENTRY-STATUS = '5'
 16810        GO TO 3780-UPDATE-CANCEL-CERT.
 16811
 16812     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16813                              PB-CI-LF-ALT-PREMIUM-AMT.
 16814
 16815     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16816        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16817                                 PB-C-LF-REF-CALC
 16818      ELSE
 16819        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16820                                 PB-C-LF-CANCEL-AMT.
 16821
 16822     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16823        MOVE ER-2755             TO WS-ERROR
 16824        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16825
 16826     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16827
 16828     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16829        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16830                                 PB-C-AH-REF-CALC
 16831      ELSE
 16832        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16833                                 PB-C-AH-CANCEL-AMT.
 16834
 16835     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16836        MOVE ER-2778             TO WS-ERROR
 16837        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16838
 16839     IF PB-CI-OB-FLAG NOT = 'Z'
 16840        NEXT SENTENCE
 16841       ELSE
 16842         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16843            MOVE ER-2757           TO WS-ERROR
 16844            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16845
 16846 3780-UPDATE-CANCEL-CERT.
 16847
 16848     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16849        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 304
* EL050.cbl
 16850        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16851
 16852     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16853         MOVE ER-2729              TO WS-ERROR
 16854         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16855
 16856     IF PB-CI-LF-BENEFIT-CD = ZERO
 16857         GO TO 3780-UPDATE-CONT-1.
 16858
 16859     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16860         GO TO 3780-UPDATE-CONT-1.
 16861
 16862     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16863       AND
 16864        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16865       AND
 16866        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16867       AND
 16868        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16869            NEXT SENTENCE
 16870       ELSE
 16871        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16872          AND
 16873***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16874***       AND
 16875           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16876            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16877               MOVE ER-2730      TO WS-ERROR
 16878               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16879               GO TO 3999-END-EDIT
 16880            ELSE
 16881               GO TO 3999-END-EDIT
 16882        ELSE
 16883            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16884               MOVE ER-2765           TO WS-ERROR
 16885               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16886               GO TO 3785-CHECK-NH.
 16887*              GO TO 3999-END-EDIT.
 16888
 16889 3780-UPDATE-CONT-1.
 16890     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16891
 16892     IF PB-CI-AH-BENEFIT-CD = ZERO
 16893         GO TO 3780-UPDATE-CONT-2.
 16894
 16895     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16896         GO TO 3780-UPDATE-CONT-2.
 16897
 16898     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16899
 16900     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16901       AND
 16902        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16903       AND
 16904        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16905       AND
 16906        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16907            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 305
* EL050.cbl
 16908       ELSE
 16909        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16910          AND
 16911***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16912***       AND
 16913           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16914           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16915            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16916               MOVE ER-2773      TO WS-ERROR
 16917               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16918               GO TO 3999-END-EDIT
 16919            ELSE
 16920               GO TO 3999-END-EDIT
 16921            END-IF
 16922           ELSE
 16923             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16924                MOVE ER-2890 TO WS-ERROR
 16925                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16926                GO TO 3999-END-EDIT
 16927             ELSE
 16928                GO TO 3785-CHECK-NH
 16929             END-IF
 16930           END-IF
 16931          ELSE
 16932            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16933              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16934                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16935                   MOVE ER-2890 TO WS-ERROR
 16936                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16937                   GO TO 3999-END-EDIT
 16938                ELSE
 16939                   MOVE ER-2765 TO WS-ERROR
 16940                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16941                   GO TO 3785-CHECK-NH
 16942                END-IF
 16943              ELSE
 16944               MOVE ER-2765      TO WS-ERROR
 16945               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16946               GO TO 3785-CHECK-NH.
 16947*              GO TO 3999-END-EDIT.
 16948
 16949 3780-UPDATE-CONT-2.
 16950
 16951     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16952        AND WS-LF-BENEFIT-CD = ZERO
 16953           MOVE ER-2743           TO WS-ERROR
 16954           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16955
 16956     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16957        AND WS-AH-BENEFIT-CD = ZERO
 16958           MOVE ER-2744           TO WS-ERROR
 16959           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16960
 16961     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16962        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16963        AND
 16964        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16965         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 306
* EL050.cbl
 16966           MOVE ER-2746           TO WS-ERROR
 16967           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16968
 16969     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16970       AND
 16971        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16972             MOVE ER-2737        TO WS-ERROR
 16973             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16974
 16975     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16976       AND
 16977        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16978             MOVE ER-2737        TO WS-ERROR
 16979             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16980
 16981     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16982         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16983             OR 'CID' OR 'DCC' OR 'AHL'
 16984             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16985         ELSE
 16986             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16987                 MOVE ER-2768    TO WS-ERROR
 16988                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16989             ELSE
 16990                 MOVE ER-2756    TO WS-ERROR
 16991                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16992
 16993     IF CERT-PEND-ISSUE-RETURNED
 16994        MOVE ER-2772             TO WS-ERROR
 16995        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16996 3785-CHECK-NH.
 16997     IF PB-STATE NOT = 'NH'
 16998        GO TO 3999-END-EDIT
 16999     END-IF
 17000
 17001     MOVE ER-2796                TO WS-ERROR
 17002     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17003     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17004        OR (CM-NH-INTERFACE-SW = 'Y')
 17005        MOVE ER-2793             TO WS-ERROR
 17006        PERFORM 9900-ERROR-FORMAT
 17007                                 THRU 9900-EXIT
 17008     END-IF
 17009     MOVE +0                     TO WS-PAYMENT-AMT
 17010     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 17011        GO TO 3999-END-EDIT
 17012     END-IF
 17013     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17014        GO TO 3999-END-EDIT
 17015     END-IF
 17016     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17017     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17018     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17019        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17020     END-IF
 17021     MOVE '1'                    TO DC-OPTION-CODE
 17022     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17023     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 307
* EL050.cbl
 17024        IF DC-ELAPSED-DAYS < +16
 17025           GO TO 3999-END-EDIT
 17026        END-IF
 17027     END-IF
 17028     MOVE +0                     TO DC-ELAPSED-DAYS
 17029     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17030     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17031     MOVE '1'                    TO DC-OPTION-CODE
 17032     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17033     IF NO-CONVERSION-ERROR
 17034        IF DC-ELAPSED-DAYS > +30
 17035           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17036        ELSE
 17037           GO TO 3999-END-EDIT
 17038        END-IF
 17039     ELSE
 17040        GO TO 3999-END-EDIT
 17041     END-IF
 17042     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17043        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17044           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 17045     IF WS-PAYMENT-AMT < 600.00
 17046        GO TO 3999-END-EDIT
 17047     END-IF
 17048     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17049
 17050     IF (ERMAIL-FOUND = ' ')
 17051         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17052         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17053        GO TO 3999-END-EDIT
 17054     END-IF
 17055     MOVE ER-2795                TO WS-ERROR
 17056     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17057
 17058     GO TO 3999-END-EDIT.
 17059******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 308
* EL050.cbl
 17061 3990-FILES-NOT-OPEN.
 17062
 17063     MOVE ER-2617                TO WS-ERROR.
 17064     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17065     GO TO 9990-RETURN.
 17066
 17067 3999-END-EDIT.
 17068
 17069     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17070
 17071     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17072         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17073         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17074             PERFORM 9250-UNLOCK-RETURN
 17075             GO TO 9990-RETURN
 17076          ELSE
 17077             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17078             GO TO 9990-RETURN.
 17079
 17080     IF PB-CANCELLATION
 17081          GO TO 9990-RETURN.
 17082
 17083     IF CERT-WAS-NOT-FOUND
 17084        MOVE SPACES              TO CERTIFICATE-MASTER.
 17085
 17086     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17087
 17088     IF CERT-WAS-FOUND
 17089         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17090             PERFORM 9250-UNLOCK-RETURN
 17091          ELSE
 17092            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17093      ELSE
 17094         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17095
 17096     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17097        IF PB-COMPANY-ID = 'DCC' AND
 17098           (PB-CARRIER = '2' OR '4' OR '6')
 17099              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17100        END-IF
 17101     END-IF.
 17102
 17103     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17104         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17105     END-IF.
 17106     move ' '                    to ws-ins-age-defaulted
 17107     perform 8150-read-elcrtt    thru 8150-exit
 17108     if ws-ins-age-defaulted = 'Y'
 17109        move er-1573             to ws-error
 17110        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17111     end-if
 17112
 17113     if ws-jnt-age-defaulted = 'Y'
 17114        move er-1574             to ws-error
 17115        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17116     end-if
 17117
 17118     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 309
* EL050.cbl
 17119     IF ((PB-COMPANY-ID = 'DCC')
 17120        AND (WS-NO-SECURE-PAY))
 17121                  OR
 17122        (WS-LF-SPECIAL-CALC-CD = 'O'
 17123        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17124        SET SKIP-ADDR-EDIT       TO TRUE
 17125     END-IF
 17126     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17127        AND (NOT SKIP-ADDR-EDIT)
 17128        MOVE ER-2963             TO WS-ERROR
 17129        PERFORM 9900-ERROR-FORMAT
 17130                                 THRU 9900-EXIT
 17131        GO TO 9990-RETURN
 17132     END-IF
 17133     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17134     IF ERPNDM-FOUND NOT = 'X'
 17135        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17136           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17137           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17138           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17139           AND (NOT SKIP-ADDR-EDIT)
 17140           MOVE ER-2694          TO WS-ERROR
 17141           PERFORM 9900-ERROR-FORMAT
 17142                                 THRU 9900-EXIT
 17143        END-IF
 17144        MOVE ' '                 TO STATE-RECORD-ERROR
 17145        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17146        MOVE PM-STATE            TO CNTL-ACCESS
 17147        MOVE '3'                 TO CNTL-REC-TYPE
 17148        MOVE +0                  TO CNTL-SEQ-NO
 17149        MOVE '0'                 TO RC-SW-2
 17150        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17151        IF (NO-STATE-RECORD)
 17152           OR (CF-RECORD-TYPE NOT = '3')
 17153           OR (PM-STATE NOT = CF-STATE-CODE)
 17154           IF (PM-STATE = SPACES)
 17155              AND (SKIP-ADDR-EDIT)
 17156              CONTINUE
 17157           ELSE
 17158              MOVE ER-2963       TO WS-ERROR
 17159              PERFORM 9900-ERROR-FORMAT
 17160                                 THRU 9900-EXIT
 17161           END-IF
 17162        END-IF
 17163        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17164           MOVE ER-2883          TO WS-ERROR
 17165           PERFORM 9900-ERROR-FORMAT
 17166                                 THRU 9900-EXIT
 17167        END-IF
 17168        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17169           MOVE ' '                 TO STATE-RECORD-ERROR
 17170           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17171           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17172           MOVE '3'                 TO CNTL-REC-TYPE
 17173           MOVE +0                  TO CNTL-SEQ-NO
 17174           MOVE '0'                 TO RC-SW-2
 17175           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17176           IF NO-STATE-RECORD
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 310
* EL050.cbl
 17177              OR (CF-RECORD-TYPE NOT = '3')
 17178              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17179              MOVE ER-2964          TO WS-ERROR
 17180              PERFORM 9900-ERROR-FORMAT
 17181                                    THRU 9900-EXIT
 17182           END-IF
 17183        END-IF
 17184     ELSE
 17185        IF NOT SKIP-ADDR-EDIT
 17186           MOVE ER-2393          TO WS-ERROR
 17187           PERFORM 9900-ERROR-FORMAT
 17188                                 THRU 9900-EXIT
 17189        END-IF
 17190     END-IF
 17191
 17192     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17193
 17194     IF (ERMAIL-FOUND = ' ' AND
 17195        ERPNDM-FOUND = ' ')
 17196        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17197           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17198           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17199          OR
 17200           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17201          OR
 17202           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17203           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17204           GO TO 3999-UNLOCK-ERMAIL.
 17205
 17206     IF ERPNDM-FOUND = 'X'
 17207        GO TO 3999-UNLOCK-ERMAIL.
 17208
 17209     IF PM-INSURED-LAST-NAME      = SPACES
 17210        AND PM-INSURED-FIRST-NAME = SPACES
 17211        AND PM-ADDRESS-LINE-1     = SPACES
 17212        AND PM-ADDRESS-LINE-2     = SPACES
 17213        AND PM-CITY-STATE         = SPACES
 17214        AND PM-CRED-BENE-NAME     = SPACES
 17215        AND PM-CRED-BENE-ADDR     = SPACES
 17216        AND PM-CRED-BENE-CTYST    = SPACES
 17217        GO TO 3999-UNLOCK-ERMAIL
 17218     END-IF
 17219
 17220     MOVE SPACES                 TO MAILING-DATA.
 17221
 17222     MOVE 'MA'                   TO MA-RECORD-ID.
 17223     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17224     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17225     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17226     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17227     MOVE PB-SV-STATE            TO MA-STATE.
 17228     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17229     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17230
 17231     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17232     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17233
 17234     IF ERMAIL-FOUND = ' '
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 311
* EL050.cbl
 17235        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17236     ELSE
 17237        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17238        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17239        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17240
 17241     GO TO 9990-RETURN.
 17242
 17243 3999-UNLOCK-ERMAIL.
 17244     IF ERMAIL-FOUND = ' '
 17245        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17246
 17247     GO TO 9990-RETURN.
 17248******************************************************************
 17249
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 312
* EL050.cbl
 17251 4000-UPDATE-CANCELLED-CERT.
 17252     IF CERT-WAS-NOT-FOUND
 17253        GO TO 4299-EXIT.
 17254
 17255*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17256     IF PB-C-NH-INT-ON-REFS > ZEROS
 17257        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17258     END-IF
 17259     IF PB-C-REF-INTERFACE-SW = 'Y'
 17260        MOVE PB-C-REF-INTERFACE-SW
 17261                                 TO CM-NH-INTERFACE-SW
 17262     END-IF
 17263     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17264     IF ERMAIL-FOUND = 'X'
 17265        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17266        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17267        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17268        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17269           MOVE ER-2694          TO WS-ERROR
 17270           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17271     END-IF
 17272
 17273     IF PB-C-POST-CARD-IND = 'Y'
 17274        MOVE +8                  TO SUB
 17275*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17276        IF ERMAIL-FOUND = ' '
 17277           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17278              (SUB > +7)
 17279              OR (MA-MAIL-STATUS (SUB) = '1')
 17280           END-PERFORM
 17281        END-IF
 17282        IF (SUB > +7)
 17283           OR (ERMAIL-FOUND = 'X')
 17284           MOVE ER-3789          TO WS-ERROR
 17285           PERFORM 9900-ERROR-FORMAT
 17286                                 THRU 9900-EXIT
 17287        END-IF
 17288     ELSE
 17289        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17290     END-IF
 17291
 17292     IF ERMAIL-FOUND = ' '
 17293        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17294     END-IF.
 17295
 17296     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17297
 17298     IF PB-CI-OB-FLAG = 'Z'
 17299        GO TO 4150-SUMMARY-CERT-CANCEL.
 17300
 17301     IF PB-C-LF-CANCEL-VOIDED
 17302         PERFORM 4200-REVERSE-LF-CANCEL.
 17303     IF PB-C-AH-CANCEL-VOIDED
 17304         PERFORM 4200-REVERSE-AH-CANCEL.
 17305
 17306 4100-APPLY-LF-CANCEL.
 17307
 17308     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 313
* EL050.cbl
 17309
 17310 4100-CHECK-LF-ERRORS.
 17311
 17312     ADD +1                       TO WS-SUB.
 17313
 17314     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17315        IF LF-COVERAGE-CANCELLED
 17316           GO TO 4100-LF-CANCEL-CONT
 17317        ELSE
 17318           GO TO 4100-UPDATE-LF-COVERAGE.
 17319
 17320     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17321                                   ER-2729 OR
 17322                                   ER-2730 OR
 17323                                   ER-2731 OR
 17324                                   ER-2732 OR
 17325                                   ER-2737 OR
 17326                                   ER-2740 OR
 17327                                   ER-2743 OR
 17328                                   ER-2749 OR
 17329                                   ER-2750 OR
 17330                                   ER-2755 OR
 17331                                   ER-2757 OR
 17332                                   ER-2760 OR
 17333                                   ER-2772 OR
 17334                                   ER-2774 OR
 17335                                   ER-2776 OR
 17336                                   ER-2794
 17337        GO TO 4100-UPDATE-LF-COVERAGE.
 17338
 17339     GO TO 4100-CHECK-LF-ERRORS.
 17340
 17341 4100-UPDATE-LF-COVERAGE.
 17342
 17343     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17344     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17345     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17346        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17347     END-IF
 17348     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17349                                      TO CM-CREDIT-INTERFACE-SW-2.
 17350     IF CM-LF-CANCEL-DT = LOW-VALUE
 17351         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17352
 17353     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17354         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17355                                         CM-LF-STATUS-AT-CANCEL.
 17356
 17357     GO TO 4100-APPLY-AH-CANCEL.
 17358
 17359 4100-LF-CANCEL-CONT.
 17360     IF PB-C-LF-CANCEL-VOIDED
 17361         GO TO 4100-APPLY-AH-CANCEL.
 17362
 17363     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17364         GO TO 4100-APPLY-AH-CANCEL.
 17365
 17366     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 314
* EL050.cbl
 17367        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17368           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17369        ELSE
 17370           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17371
 17372     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17373     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17374
 17375     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17376         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17377
 17378     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17379        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17380         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17381         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17382
 17383     IF PB-RECORD-RETURNED
 17384        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17385      ELSE
 17386        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17387
 17388 4100-APPLY-AH-CANCEL.
 17389
 17390     MOVE +0                      TO WS-SUB.
 17391
 17392 4100-CHECK-AH-ERRORS.
 17393
 17394     ADD +1                       TO WS-SUB.
 17395
 17396     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17397        IF AH-COVERAGE-CANCELLED
 17398           GO TO 4100-AH-CANCEL-CONT
 17399        ELSE
 17400           GO TO 4100-UPDATE-AH-COVERAGE.
 17401
 17402     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17403                                   ER-2729 OR
 17404                                   ER-2732 OR
 17405                                   ER-2737 OR
 17406                                   ER-2740 OR
 17407                                   ER-2744 OR
 17408                                   ER-2749 OR
 17409                                   ER-2750 OR
 17410                                   ER-2755 OR
 17411                                   ER-2757 OR
 17412                                   ER-2760 OR
 17413                                   ER-2771 OR
 17414                                   ER-2772 OR
 17415                                   ER-2773 OR
 17416                                   ER-2775 OR
 17417                                   ER-2777 OR
 17418                                   ER-2778 OR
 17419                                   ER-2794
 17420        GO TO 4100-UPDATE-AH-COVERAGE.
 17421
 17422     GO TO 4100-CHECK-AH-ERRORS.
 17423
 17424 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 315
* EL050.cbl
 17425
 17426     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17427     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17428     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17429     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17430                                      TO CM-CREDIT-INTERFACE-SW-2.
 17431     IF CM-AH-CANCEL-DT = LOW-VALUE
 17432         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17433
 17434     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17435         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17436                                         CM-AH-STATUS-AT-CANCEL.
 17437
 17438     IF LF-COVERAGE-CANCELLED
 17439         IF PB-RECORD-RETURNED
 17440              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17441          ELSE
 17442              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17443
 17444     GO TO 4299-EXIT.
 17445
 17446 4100-AH-CANCEL-CONT.
 17447     IF PB-C-AH-CANCEL-VOIDED
 17448         GO TO 4299-EXIT.
 17449
 17450     if cm-credit-interface-sw-2 = ' '
 17451        if pb-fatal-errors or pb-unforced-errors
 17452           move '4'              to cm-credit-interface-sw-2
 17453        else
 17454           move '1'              to cm-credit-interface-sw-2
 17455        end-if
 17456     end-if
 17457     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17458         GO TO 4299-EXIT.
 17459
 17460     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17461        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17462           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17463        ELSE
 17464           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17465
 17466     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17467     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17468
 17469     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17470         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17471
 17472     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17473         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17474         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17475
 17476     IF PB-RECORD-RETURNED
 17477        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17478      ELSE
 17479        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17480
 17481     GO TO 4299-EXIT.
 17482
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 316
* EL050.cbl
 17483 4150-SUMMARY-CERT-CANCEL.
 17484     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17485
 17486     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17487        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17488                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17489     ELSE
 17490        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17491                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17492
 17493     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17494        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17495                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17496     ELSE
 17497        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17498                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17499
 17500     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17501        NEXT SENTENCE
 17502     ELSE
 17503        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17504
 17505     GO TO 4299-EXIT.
 17506
 17507 4200-REVERSE-LF-CANCEL.
 17508     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17509
 17510     IF CM-LF-CANCEL-APPLIED
 17511        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17512        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17513        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17514
 17515     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17516
 17517     IF PB-RECORD-RETURNED
 17518        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17519       ELSE
 17520        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17521
 17522 4200-REVERSE-LF-EXIT.
 17523       EXIT.
 17524
 17525 4200-REVERSE-AH-CANCEL.
 17526     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17527
 17528     IF CM-AH-CANCEL-APPLIED
 17529        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17530        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17531        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17532
 17533     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17534
 17535     IF PB-RECORD-RETURNED
 17536        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17537       ELSE
 17538        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17539
 17540 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 317
* EL050.cbl
 17541       EXIT.
 17542
 17543 4299-EXIT.
 17544       EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 318
* EL050.cbl
 17546
 17547 4500-UPDATE-NEW-CERT.
 17548     IF CERT-WAS-FOUND
 17549         NEXT SENTENCE
 17550       ELSE
 17551         GO TO 4520-BUILD-NEW-KEY.
 17552
 17553     IF  CLASIC-CREATED-CERT
 17554         GO TO 4999-EXIT.
 17555
 17556     IF  CERT-WAS-CREATED-FOR-CLAIM
 17557         GO TO 4520-BUILD-NEW-KEY.
 17558
 17559     IF CERT-ADDED-BATCH
 17560        IF CM-RECORD-ID = 'CM'
 17561            GO TO 4999-EXIT.
 17562
 17563 4520-BUILD-NEW-KEY.
 17564* BUILD CONTROL PRIMARY
 17565
 17566     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17567                                       CM-COMPANY-CD-A1
 17568                                       CM-COMPANY-CD-A2
 17569                                       CM-COMPANY-CD-A4
 17570                                       CM-COMPANY-CD-A5.
 17571
 17572     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17573     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17574     MOVE PB-SV-STATE               TO CM-STATE.
 17575     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17576     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17577     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17578     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17579
 17580     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17581
 17582     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17583     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17584     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17585     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17586
 17587     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17588        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17589
 17590     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17591         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17592         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17593         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17594         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17595     ELSE
 17596         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17597
 17598     IF PB-COMPANY-ID   EQUAL  'CRI'
 17599         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17600         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17601         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17602         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17603         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 319
* EL050.cbl
 17604
 17605     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17606        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17607         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17608
 17609     IF PB-COMPANY-ID  = 'LBL'
 17610        IF PB-I-JOINT-COVERAGE
 17611            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17612                                           PB-I-MEMBER-NO
 17613            GO TO 4550-CONT-CERT-PROCESS.
 17614
 17615     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17616        NEXT SENTENCE
 17617     ELSE
 17618        GO TO 4540-BUILD-MEMBER-NO.
 17619
 17620******************************************************************
 17621*                                                                *
 17622*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17623*    FOR 'MON'.                                                  *
 17624*                                                                *
 17625******************************************************************
 17626
 17627     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17628     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17629     MOVE +1                     TO WS-SUB1
 17630                                    WS-SUB2.
 17631
 17632 4530-EDIT-MEMB-NAME.
 17633
 17634     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17635        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17636        ADD +1                       TO WS-SUB2.
 17637
 17638     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17639        ADD +1                       TO WS-SUB1
 17640        GO TO 4530-EDIT-MEMB-NAME.
 17641
 17642     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17643     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17644     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17645*    MOVE SPACE                      TO DC-OPTION-CODE.
 17646     SET  BIN-TO-GREG                TO TRUE.
 17647     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17648     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17649
 17650     GO TO 4550-CONT-CERT-PROCESS.
 17651
 17652******************************************************************
 17653*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17654******************************************************************
 17655
 17656 4540-BUILD-MEMBER-NO.
 17657
 17658     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17659         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17660         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17661         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 320
* EL050.cbl
 17662         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17663     ELSE
 17664         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17665
 17666     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17667        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17668         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17669
 17670 4550-CONT-CERT-PROCESS.
 17671
 17672*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17673*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17674*    ELSE
 17675*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17676
 17677     IF CERT-WAS-CREATED-FOR-CLAIM
 17678        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17679        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17680
 17681     IF CERT-AND-CLAIM-ONLINE
 17682        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17683        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17684
 17685     MOVE 'CM'                     TO CM-RECORD-ID.
 17686     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17687
 17688     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17689        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17690        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17691     ELSE
 17692        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17693        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17694
 17695     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17696     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17697     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17698     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17699     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17700     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17701     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17702                                      CM-LF-ITD-CANCEL-AMT
 17703                                      CM-LF-ITD-DEATH-AMT
 17704                                      CM-AH-ITD-AH-PMT
 17705                                      CM-AH-ITD-LUMP-PMT
 17706                                      CM-AH-ITD-CANCEL-AMT
 17707                                      CM-LF-NSP-PREMIUM-AMT
 17708                                      CM-AH-NSP-PREMIUM-AMT.
 17709*                                     CM-CLAIM-DEDUCT-WITHHELD
 17710*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17711     if pb-i-loan-apr = +99.9999
 17712        move zeros                 to cm-loan-apr
 17713     else
 17714        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17715     end-if
 17716     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17717     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17718     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17719     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 321
* EL050.cbl
 17720     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17721     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17722     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17723     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17724     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17725     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17726     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17727
 17728     IF PB-I-LIVES NOT NUMERIC
 17729         MOVE ZERO                 TO PB-I-LIVES.
 17730
 17731     IF PB-I-NUM-BILLED NOT NUMERIC
 17732         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17733
 17734     MOVE PB-I-LIVES               TO CM-LIVES.
 17735     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17736
 17737     IF PB-COMPANY-ID EQUAL  'DMD'
 17738         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17739         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17740
 17741     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17742     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17743     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17744     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17745     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17746     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17747
 17748     IF PB-I-LF-POLICY-FEE NUMERIC
 17749        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17750     ELSE
 17751        MOVE +0                    TO CM-LF-POLICY-FEE.
 17752
 17753     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17754        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17755        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17756     ELSE
 17757        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17758
 17759     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17760     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17761     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17762     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17763     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17764     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17765     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17766     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17767     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17768
 17769     IF PB-I-AH-POLICY-FEE NUMERIC
 17770        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17771     ELSE
 17772        MOVE +0                    TO CM-AH-POLICY-FEE.
 17773
 17774     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17775        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17776     ELSE
 17777        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 322
* EL050.cbl
 17778
 17779     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17780     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17781
 17782     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17783                                      CM-LF-DEATH-EXIT-DT
 17784                                      CM-AH-SETTLEMENT-EXIT-DT.
 17785
 17786*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17787*                       'TIH' OR 'OFL' OR 'FLA' OR
 17788*                       'TII' OR 'TMS' OR 'CRI' OR
 17789*                       'NCL'
 17790     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17791
 17792     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17793         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17794            MOVE '2'                TO CM-PREMIUM-TYPE.
 17795
 17796     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17797         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17798            MOVE '2'                TO CM-PREMIUM-TYPE.
 17799
 17800     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17801         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17802     ELSE
 17803         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17804         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17805
 17806     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17807     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17808     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17809     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17810     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17811     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17812     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17813     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17814
 17815     IF PB-NO-MONTHS-SKIPPED
 17816         MOVE SPACE                 TO CM-SKIP-CODE
 17817     ELSE
 17818         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17819
 17820     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17821     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17822                                       CM-LF-STATUS-AT-CANCEL.
 17823
 17824     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17825     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17826                                       CM-AH-STATUS-AT-CANCEL.
 17827
 17828     MOVE '1'                       TO CM-ENTRY-STATUS.
 17829
 17830     IF PB-REISSUED-CERT
 17831        MOVE '5'                    TO CM-ENTRY-STATUS.
 17832
 17833     IF PB-MONTHLY-CERT
 17834        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17835
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 323
* EL050.cbl
 17836     IF PB-CASH-CERT
 17837        MOVE 'C'                    TO CM-ENTRY-STATUS.
 17838
 17839     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17840     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17841     IF PB-POLICY-IS-DECLINED
 17842        MOVE 'D'                    TO CM-ENTRY-STATUS.
 17843
 17844     IF PB-POLICY-IS-VOIDED
 17845        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17846
 17847     IF PB-NEEDS-UNDERWRITING
 17848        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17849
 17850     IF PB-REIN-ONLY-CERT
 17851        MOVE '9'                    TO CM-ENTRY-STATUS.
 17852
 17853     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17854         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17855     ELSE
 17856         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17857
 17858     IF PB-RECORD-RETURNED
 17859        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17860      ELSE
 17861        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17862
 17863     IF PB-I-MAIL-ADDRS-PRESENT
 17864        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17865
 17866     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17867                                       CM-ENTRY-DT.
 17868
 17869 4999-EXIT.
 17870     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 324
* EL050.cbl
 17872
 17873 5000-PROCESS-REPS.
 17874     MOVE ' '                    TO AGTC-MASTER-SW
 17875     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17876     MOVE CO-TYPE                TO AGTC-TYPE
 17877     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17878     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17879     IF (AGTC-MASTER-SW NOT = 'N')
 17880        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17881        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17882        PERFORM 8583-READ-ERAGTC-NEXT
 17883                                 THRU 8583-EXIT
 17884     END-IF
 17885     IF AGTC-MASTER-SW = 'N'
 17886        CONTINUE
 17887     ELSE
 17888        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17889           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17890              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17891              MOVE 'Y'           TO AGTC-MASTER-SW
 17892           END-IF
 17893        END-IF
 17894     END-IF
 17895     .
 17896 5000-EXIT.
 17897     EXIT.
 17898 6370-EDIT-INPUT-LF-CODE.
 17899     move ' ' to ws-benefit-cd-chg-sw
 17900     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17901        MOVE +1                  TO SUB
 17902        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17903        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17904        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17905        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17906        GO TO 6370-SEARCH-LOOP.
 17907
 17908     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17909
 17910     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17911     MOVE SPACES                 TO CNTL-ACCESS.
 17912*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17913     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17914     MOVE +0                     TO CNTL-SEQ-NO.
 17915     MOVE '4' TO RC-SW-2.
 17916     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17917
 17918     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17919        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17920        GO TO 6370-NO-LF-FOUND.
 17921
 17922     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17923     MOVE +1                     TO SUB.
 17924
 17925 6370-SEARCH-LOOP.
 17926     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17927         GO TO 6370-NO-LF-FOUND.
 17928
 17929     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 325
* EL050.cbl
 17930        if (pb-i-lf-benefit-cd not = zeros and spaces)
 17931           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 17932           set benefit-code-chg to true
 17933        end-if
 17934        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 17935        GO TO 6370-HER-NET-PAY-CHECK.
 17936
 17937     ADD 1   TO SUB.
 17938*    IF SUB GREATER 120
 17939     IF SUB GREATER 200
 17940         GO TO 6370-NO-LF-FOUND.
 17941
 17942     GO TO 6370-SEARCH-LOOP.
 17943
 17944 6370-NO-LF-FOUND.
 17945
 17946     if (pb-i-lf-benefit-cd not = zeros and spaces)
 17947        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 17948        set benefit-code-chg to true
 17949     end-if
 17950     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17951
 17952 6370-HER-NET-PAY-CHECK.
 17953
 17954     IF PB-COMPANY-ID = 'CID'
 17955        IF PB-SV-STATE = 'CA' OR 'MN'
 17956           IF PB-I-LF-BENEFIT-CD = '02'
 17957              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17958           ELSE
 17959              IF PB-I-LF-BENEFIT-CD = '04'
 17960                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17961              END-IF
 17962           END-IF
 17963        END-IF
 17964     END-IF
 17965
 17966     IF PB-COMPANY-ID NOT = 'HER'
 17967         GO TO 6370-EXIT.
 17968
 17969     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17970         GO TO 6370-EXIT.
 17971
 17972     IF PB-I-LF-TERM NOT NUMERIC
 17973         MOVE ZEROS              TO PB-I-LF-TERM.
 17974
 17975     IF PB-I-LOAN-TERM NOT NUMERIC
 17976         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17977
 17978     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17979         GO TO 6370-EXIT.
 17980
 17981     IF PB-I-LF-BENEFIT-CD = '33'
 17982         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17983
 17984     IF PB-I-LF-BENEFIT-CD = '34'
 17985         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17986
 17987 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 326
* EL050.cbl
 17988     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 327
* EL050.cbl
 17990
 17991 6380-EDIT-INPUT-AH-CODE.
 17992     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17993        MOVE +1                  TO SUB
 17994        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17995        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17996        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17997        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17998        GO TO 6380-SEARCH-LOOP.
 17999
 18000     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18001
 18002     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18003     MOVE SPACES                 TO CNTL-ACCESS.
 18004     MOVE 'A'                    TO CNTL-REC-TYPE.
 18005*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18006     MOVE +0                     TO CNTL-SEQ-NO.
 18007     MOVE '5' TO RC-SW-2.
 18008     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18009
 18010     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18011        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18012        GO TO 6380-NO-AH-FOUND.
 18013
 18014     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18015     MOVE +1 TO SUB.
 18016
 18017 6380-SEARCH-LOOP.
 18018     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18019         GO TO 6380-NO-AH-FOUND.
 18020
 18021     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18022         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18023         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18024
 18025     ADD 1   TO SUB.
 18026     IF SUB GREATER THAN 96
 18027*    IF SUB GREATER THAN 300
 18028         GO TO 6380-NO-AH-FOUND.
 18029
 18030     GO TO 6380-SEARCH-LOOP.
 18031
 18032 6380-NO-AH-FOUND.
 18033
 18034     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18035
 18036     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18037         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18038     ELSE
 18039         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18040
 18041 6380-CSO-AH-ONLY-CHECKS.
 18042
 18043     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18044        NEXT SENTENCE
 18045      ELSE
 18046        GO TO 6380-EXIT.
 18047
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 328
* EL050.cbl
 18048     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18049         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18050
 18051
 18052     GO TO 6380-EXIT
 18053     .
 18054 6380-CSO-LIFE-WITH-AH-CHECKS.
 18055
 18056
 18057     .
 18058 6380-EXIT.
 18059     EXIT.
 18060
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 329
* EL050.cbl
 18062
 18063 6400-COMPUTE-EXTENSION-DAYS.
 18064
 18065******************************************************************
 18066*                                                                *
 18067*                   COMPUTE EXTENSION DAYS                       *
 18068*                                                                *
 18069*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18070*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18071*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18072*    THE EXTENSION DAYS.                                         *
 18073*                                                                *
 18074******************************************************************
 18075
 18076     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18077     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18078
 18079******************************************************************
 18080*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18081*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18082******************************************************************
 18083
 18084     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18085        COMPUTE WS-ODD-DAYS-OVER =
 18086               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18087     ELSE
 18088        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18089
 18090     IF WS-ODD-DAYS-OVER = ZEROS
 18091           GO TO 6499-EXIT
 18092     ELSE
 18093        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18094           IF WS-WDF-MONTH = 02
 18095              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18096              ADD 2       TO  WS-ODD-DAYS-OVER
 18097              GO TO 6499-EXIT
 18098           ELSE
 18099              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18100                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18101                 GO TO 6499-EXIT
 18102               ELSE
 18103                 GO TO 6499-EXIT
 18104        ELSE
 18105           GO TO 6499-EXIT.
 18106
 18107 6412-CHECK-TO-DAY.
 18108
 18109        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18110           IF WS-WDT-DAY = 28
 18111              ADD 2              TO WS-ODD-DAYS-OVER
 18112           ELSE
 18113              IF WS-WDT-DAY = 29
 18114                 ADD 1           TO WS-ODD-DAYS-OVER
 18115              ELSE
 18116                 NEXT SENTENCE
 18117        ELSE
 18118           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18119              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 330
* EL050.cbl
 18120
 18121     GO TO 6499-EXIT.
 18122
 18123
 18124 6415-CHECK-LEAP-YEAR.
 18125
 18126     IF DC-DAYS-IN-MONTH = 29
 18127        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18128
 18129 6415-EXIT.
 18130     EXIT.
 18131
 18132 6499-EXIT.
 18133      EXIT.
 18134
 18135 6500-END.
 18136     EXIT.
 18137
 18138
 18139******************************************************************
 18140************* PROCEDURE DIVISION FOR EL050 ***********************
 18141********************** ELC50PD END *******************************
 18142
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 331
* EL050.cbl
 18144
 18145**START***********************************************************
 18146*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18147*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18148******************************************************************
 18149*
 18150 6600-GET-STATE-MUNICIPAL-TAX.
 18151
 18152     IF PB-COMPANY-ID NOT = 'DMD'
 18153         GO TO 6640-EXIT.
 18154
 18155     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18156     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18157     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18158*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18159*
 18160***  Y2K PROJ 7744
 18161     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18162     SET BIN-TO-GREG          TO TRUE.
 18163     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18164
 18165     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18166
 18167     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18168     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18169
 18170
 18171* EXEC CICS HANDLE CONDITION
 18172*        INVREQ    (6610-START-BROWSE)
 18173*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18174*        NOTFND    (6630-END-OF-FILE)
 18175*    END-EXEC.
 18176*    MOVE '"$8JI                 ! # #00018158' TO DFHEIV0
 18177     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18178     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18179     MOVE X'2320233030303138313538' TO DFHEIV0(25:11)
 18180     CALL 'kxdfhei1' USING DFHEIV0
 18181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18182
 18183
 18184 6610-START-BROWSE.
 18185
 18186
 18187* EXEC CICS HANDLE CONDITION
 18188*        NOTFND    (6630-END-OF-FILE)
 18189*        DISABLED  (6630-ERRESS-PROBLEM)
 18190*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18191*        ENDFILE   (6630-END-OF-FILE)
 18192*    END-EXEC.
 18193*    MOVE '"$IcJ''                ! $ #00018166' TO DFHEIV0
 18194     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18195     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18196     MOVE X'2420233030303138313636' TO DFHEIV0(25:11)
 18197     CALL 'kxdfhei1' USING DFHEIV0
 18198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18199
 18200
 18201
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 332
* EL050.cbl
 18202* EXEC CICS STARTBR
 18203*        DATASET (FILE-ID-ERRESS)
 18204*        RIDFLD  (WS-ERRESS-KEY)
 18205*        GTEQ
 18206*    END-EXEC.
 18207     MOVE 0
 18208       TO DFHEIV11
 18209*    MOVE '&,         G          &   #00018173' TO DFHEIV0
 18210     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18211     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18212     MOVE X'2020233030303138313733' TO DFHEIV0(25:11)
 18213     CALL 'kxdfhei1' USING DFHEIV0,
 18214           FILE-ID-ERRESS,
 18215           WS-ERRESS-KEY,
 18216           DFHEIV99,
 18217           DFHEIV11,
 18218           DFHEIV99
 18219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18220
 18221
 18222 6620-READ-NEXT-ERRESS-MASTER.
 18223
 18224
 18225* EXEC CICS HANDLE CONDITION
 18226*        NOTFND    (6630-END-OF-FILE)
 18227*        ENDFILE   (6630-END-OF-FILE)
 18228*        DISABLED  (6630-ERRESS-PROBLEM)
 18229*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18230*    END-EXEC.
 18231*    MOVE '"$I''cJ                ! % #00018181' TO DFHEIV0
 18232     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18233     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18234     MOVE X'2520233030303138313831' TO DFHEIV0(25:11)
 18235     CALL 'kxdfhei1' USING DFHEIV0
 18236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18237
 18238
 18239
 18240* EXEC CICS READNEXT
 18241*        DATASET (FILE-ID-ERRESS)
 18242*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18243*        RIDFLD  (WS-ERRESS-KEY)
 18244*    END-EXEC.
 18245     MOVE LENGTH OF
 18246      RESIDENT-STATE-TAX-MASTER
 18247       TO DFHEIV12
 18248     MOVE 0
 18249       TO DFHEIV11
 18250*    MOVE '&.IL                  )   #00018188' TO DFHEIV0
 18251     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18252     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18253     MOVE X'2020233030303138313838' TO DFHEIV0(25:11)
 18254     CALL 'kxdfhei1' USING DFHEIV0,
 18255           FILE-ID-ERRESS,
 18256           RESIDENT-STATE-TAX-MASTER,
 18257           DFHEIV12,
 18258           WS-ERRESS-KEY,
 18259           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 333
* EL050.cbl
 18260           DFHEIV11,
 18261           DFHEIV99,
 18262           DFHEIV99
 18263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18264
 18265
 18266     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18267
 18268* EXEC CICS ENDBR
 18269*            DATASET (FILE-ID-ERRESS)
 18270*       END-EXEC
 18271     MOVE 0
 18272       TO DFHEIV11
 18273*    MOVE '&2                    $   #00018195' TO DFHEIV0
 18274     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18275     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18276     MOVE X'2020233030303138313935' TO DFHEIV0(25:11)
 18277     CALL 'kxdfhei1' USING DFHEIV0,
 18278           FILE-ID-ERRESS,
 18279           DFHEIV11,
 18280           DFHEIV99
 18281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18282        GO TO 6630-END-OF-FILE.
 18283
 18284     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18285        NEXT SENTENCE
 18286      ELSE
 18287        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18288
 18289*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18290*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18291*
 18292     MOVE +2                     TO WS-SUB1.
 18293
 18294     IF PB-ISSUE
 18295     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18296        MOVE +1                  TO WS-SUB1.
 18297
 18298     IF PB-CANCELLATION
 18299     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18300        MOVE +1                  TO WS-SUB1.
 18301*
 18302*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18303*
 18304***  Y2K PROJ 7744
 18305     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18306***  Y2K PROJ 7744
 18307
 18308*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18309* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18310* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18311
 18312     ADD 1                    TO WS-YEAR-YY.
 18313
 18314     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18315         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18316                              TO WS-RES-STATE-TAX
 18317         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 334
* EL050.cbl
 18318                              TO WS-RES-MUNI-TAX
 18319     ELSE
 18320         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18321                              TO WS-RES-STATE-TAX
 18322         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18323                              TO WS-RES-MUNI-TAX.
 18324
 18325*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18326
 18327     IF PB-CANCELLATION
 18328         GO TO 6640-CANCEL-TAX.
 18329
 18330     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18331         COMPUTE PB-I-STATE-TAX ROUNDED =
 18332                                   PB-I-LF-PREMIUM-AMT
 18333                                 * WS-RES-STATE-TAX
 18334         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18335                                   PB-I-LF-PREMIUM-AMT
 18336                                 * WS-RES-MUNI-TAX
 18337     ELSE
 18338     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18339         COMPUTE PB-I-STATE-TAX ROUNDED =
 18340                                   PB-I-AH-PREMIUM-AMT
 18341                                 * WS-RES-STATE-TAX
 18342         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18343                                   PB-I-AH-PREMIUM-AMT
 18344                                 * WS-RES-MUNI-TAX.
 18345
 18346
 18347* EXEC CICS ENDBR
 18348*         DATASET (FILE-ID-ERRESS)
 18349*    END-EXEC.
 18350     MOVE 0
 18351       TO DFHEIV11
 18352*    MOVE '&2                    $   #00018262' TO DFHEIV0
 18353     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18354     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18355     MOVE X'2020233030303138323632' TO DFHEIV0(25:11)
 18356     CALL 'kxdfhei1' USING DFHEIV0,
 18357           FILE-ID-ERRESS,
 18358           DFHEIV11,
 18359           DFHEIV99
 18360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18361
 18362
 18363     GO TO 6640-EXIT.
 18364
 18365 6640-CANCEL-TAX.
 18366     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18367
 18368     IF PB-C-LF-CANCEL-AMT > ZEROS
 18369         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18370                                   PB-C-LF-CANCEL-AMT
 18371                                 * WS-RES-STATE-TAX
 18372         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18373                                   PB-C-LF-CANCEL-AMT
 18374                                *  WS-RES-MUNI-TAX
 18375     ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 335
* EL050.cbl
 18376     IF PB-C-AH-CANCEL-AMT > ZEROS
 18377         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18378                                   PB-C-AH-CANCEL-AMT
 18379                                 * WS-RES-STATE-TAX
 18380         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18381                                   PB-C-AH-CANCEL-AMT
 18382                                *  WS-RES-MUNI-TAX.
 18383
 18384
 18385* EXEC CICS ENDBR
 18386*         DATASET (FILE-ID-ERRESS)
 18387*    END-EXEC.
 18388     MOVE 0
 18389       TO DFHEIV11
 18390*    MOVE '&2                    $   #00018287' TO DFHEIV0
 18391     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18392     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18393     MOVE X'2020233030303138323837' TO DFHEIV0(25:11)
 18394     CALL 'kxdfhei1' USING DFHEIV0,
 18395           FILE-ID-ERRESS,
 18396           DFHEIV11,
 18397           DFHEIV99
 18398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18399
 18400
 18401     GO TO 6640-EXIT.
 18402
 18403 6630-END-OF-FILE.
 18404     MOVE ER-8002              TO WS-ERROR.
 18405     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18406
 18407     GO TO 6640-EXIT.
 18408
 18409 6630-ERRESS-PROBLEM.
 18410     MOVE ER-8044              TO WS-ERROR.
 18411     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18412
 18413 6640-EXIT.
 18414     EXIT.
 18415
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 336
* EL050.cbl
 18417 6650-GET-RES-STATE-COMM.
 18418
 18419     IF PB-COMPANY-ID NOT = 'DMD'
 18420         GO TO 6700-COMM-EXIT.
 18421
 18422     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18423     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18424     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18425     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18426     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18427     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18428     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18429
 18430*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18431*
 18432***  Y2K PROJ 7744
 18433     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18434     SET BIN-TO-GREG          TO TRUE.
 18435     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18436
 18437     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18438***  Y2K PROJ 7744
 18439
 18440     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18441
 18442
 18443* EXEC CICS HANDLE CONDITION
 18444*        INVREQ    (6660-START-BROWSE)
 18445*        DISABLED  (6690-ERRESC-PROBLEM)
 18446*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18447*        NOTFND    (6690-END-OF-FILE)
 18448*    END-EXEC.
 18449*    MOVE '"$8cJI                ! & #00018332' TO DFHEIV0
 18450     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18451     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18452     MOVE X'2620233030303138333332' TO DFHEIV0(25:11)
 18453     CALL 'kxdfhei1' USING DFHEIV0
 18454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18455
 18456
 18457
 18458* EXEC CICS RESETBR
 18459*        DATASET (FILE-ID-ERRESC)
 18460*        RIDFLD  (WS-ERRESC-KEY)
 18461*    END-EXEC.
 18462     MOVE 0
 18463       TO DFHEIV11
 18464*    MOVE '&4         G          &   #00018339' TO DFHEIV0
 18465     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18466     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18467     MOVE X'2020233030303138333339' TO DFHEIV0(25:11)
 18468     CALL 'kxdfhei1' USING DFHEIV0,
 18469           FILE-ID-ERRESC,
 18470           WS-ERRESC-KEY,
 18471           DFHEIV99,
 18472           DFHEIV11,
 18473           DFHEIV99
 18474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 337
* EL050.cbl
 18475
 18476
 18477 6660-START-BROWSE.
 18478
 18479
 18480* EXEC CICS HANDLE CONDITION
 18481*        NOTFND    (6690-END-OF-FILE)
 18482*        DISABLED  (6690-ERRESC-PROBLEM)
 18483*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18484*        ENDFILE   (6690-END-OF-FILE)
 18485*    END-EXEC.
 18486*    MOVE '"$IcJ''                ! '' #00018346' TO DFHEIV0
 18487     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18488     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18489     MOVE X'2720233030303138333436' TO DFHEIV0(25:11)
 18490     CALL 'kxdfhei1' USING DFHEIV0
 18491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18492
 18493
 18494
 18495* EXEC CICS STARTBR
 18496*        DATASET (FILE-ID-ERRESC)
 18497*        RIDFLD  (WS-ERRESC-KEY)
 18498*        GTEQ
 18499*    END-EXEC.
 18500     MOVE 0
 18501       TO DFHEIV11
 18502*    MOVE '&,         G          &   #00018353' TO DFHEIV0
 18503     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18504     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18505     MOVE X'2020233030303138333533' TO DFHEIV0(25:11)
 18506     CALL 'kxdfhei1' USING DFHEIV0,
 18507           FILE-ID-ERRESC,
 18508           WS-ERRESC-KEY,
 18509           DFHEIV99,
 18510           DFHEIV11,
 18511           DFHEIV99
 18512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18513
 18514
 18515     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18516
 18517 6670-READ-NEXT-ERRESC-MASTER.
 18518
 18519
 18520* EXEC CICS HANDLE CONDITION
 18521*        NOTFND    (6690-END-OF-FILE)
 18522*        DISABLED  (6690-ERRESC-PROBLEM)
 18523*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18524*        ENDFILE   (6690-END-OF-FILE)
 18525*    END-EXEC.
 18526*    MOVE '"$IcJ''                ! ( #00018363' TO DFHEIV0
 18527     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18528     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18529     MOVE X'2820233030303138333633' TO DFHEIV0(25:11)
 18530     CALL 'kxdfhei1' USING DFHEIV0
 18531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18532
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 338
* EL050.cbl
 18533
 18534
 18535* EXEC CICS READNEXT
 18536*        DATASET (FILE-ID-ERRESC)
 18537*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18538*        RIDFLD  (ERRESC-RECORD-KEY)
 18539*    END-EXEC.
 18540     MOVE LENGTH OF
 18541      ACCOUNT-RESIDENT-ST-COMMISSION
 18542       TO DFHEIV12
 18543     MOVE 0
 18544       TO DFHEIV11
 18545*    MOVE '&.IL                  )   #00018370' TO DFHEIV0
 18546     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18547     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18548     MOVE X'2020233030303138333730' TO DFHEIV0(25:11)
 18549     CALL 'kxdfhei1' USING DFHEIV0,
 18550           FILE-ID-ERRESC,
 18551           ACCOUNT-RESIDENT-ST-COMMISSION,
 18552           DFHEIV12,
 18553           ERRESC-RECORD-KEY,
 18554           DFHEIV99,
 18555           DFHEIV11,
 18556           DFHEIV99,
 18557           DFHEIV99
 18558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18559
 18560
 18561     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18562        NEXT SENTENCE
 18563     ELSE
 18564
 18565* EXEC CICS ENDBR
 18566*            DATASET (FILE-ID-ERRESC)
 18567*       END-EXEC
 18568     MOVE 0
 18569       TO DFHEIV11
 18570*    MOVE '&2                    $   #00018379' TO DFHEIV0
 18571     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18572     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18573     MOVE X'2020233030303138333739' TO DFHEIV0(25:11)
 18574     CALL 'kxdfhei1' USING DFHEIV0,
 18575           FILE-ID-ERRESC,
 18576           DFHEIV11,
 18577           DFHEIV99
 18578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18579        GO TO 6690-END-OF-FILE.
 18580
 18581     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18582
 18583* EXEC CICS ENDBR
 18584*            DATASET (FILE-ID-ERRESC)
 18585*       END-EXEC
 18586     MOVE 0
 18587       TO DFHEIV11
 18588*    MOVE '&2                    $   #00018385' TO DFHEIV0
 18589     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18590     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 339
* EL050.cbl
 18591     MOVE X'2020233030303138333835' TO DFHEIV0(25:11)
 18592     CALL 'kxdfhei1' USING DFHEIV0,
 18593           FILE-ID-ERRESC,
 18594           DFHEIV11,
 18595           DFHEIV99
 18596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18597        GO TO 6690-END-OF-FILE.
 18598
 18599     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18600        NEXT SENTENCE
 18601      ELSE
 18602        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18603
 18604* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18605*
 18606     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18607
 18608     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18609
 18610     IF WS-SUB1 > ZERO
 18611         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18612             PERFORM 6680-SET-COMMISSION
 18613         ELSE
 18614             PERFORM 6680-SET-TABLE-CODE.
 18615
 18616
 18617* EXEC CICS ENDBR
 18618*         DATASET (FILE-ID-ERRESC)
 18619*    END-EXEC.
 18620     MOVE 0
 18621       TO DFHEIV11
 18622*    MOVE '&2                    $   #00018407' TO DFHEIV0
 18623     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18624     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18625     MOVE X'2020233030303138343037' TO DFHEIV0(25:11)
 18626     CALL 'kxdfhei1' USING DFHEIV0,
 18627           FILE-ID-ERRESC,
 18628           DFHEIV11,
 18629           DFHEIV99
 18630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18631
 18632
 18633     GO TO 6700-COMM-EXIT.
 18634
 18635 6680-SET-TABLE-CODE.
 18636     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18637        MOVE ZEROS             TO WS-SUB1
 18638     ELSE
 18639* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18640* TO COMPUTE AH COMMISSION.
 18641        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18642        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18643        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18644        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18645        PERFORM 6680-READ-CTBL-TABLE
 18646        IF WS-CTBL-READ-SW NOT = 'Y'
 18647           MOVE ZEROS          TO WS-SUB1.
 18648
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 340
* EL050.cbl
 18649 6680-READ-CTBL-TABLE.
 18650*
 18651* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18652* TO COMPUTE LIFE COMMISSION
 18653
 18654     IF CTBL-SW = '0540'
 18655        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18656        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18657        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18658
 18659     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18660
 18661     IF CTBL-TABLE-FOUND
 18662        IF CTBL-SW = '0530'
 18663             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18664                                    * PB-I-AH-TERM
 18665             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18666             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18667        ELSE
 18668             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18669             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18670             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18671     ELSE
 18672        IF FIRST-TIME-THROUGH
 18673            GO TO 6680-READ-CTBL-TABLE
 18674        ELSE
 18675            MOVE ZEROS         TO WS-SUB1.
 18676
 18677 6680-SET-COMMISSION.
 18678     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18679           MOVE ZEROS          TO WS-SUB1
 18680       ELSE
 18681           MOVE RESC-COMMISSION-PER (WS-SUB)
 18682                               TO WS-COMMISSION
 18683           IF CTBL-SW = '0530'
 18684               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18685           ELSE
 18686               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18687
 18688 6680-SEARCH-CATEGORY.
 18689     ADD +1                   TO WS-SUB.
 18690     IF WS-SUB > +12
 18691         GO TO 6680-EXIT.
 18692
 18693     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18694          MOVE WS-SUB         TO WS-SUB1
 18695          GO TO 6680-EXIT.
 18696
 18697     GO TO 6680-SEARCH-CATEGORY.
 18698
 18699 6680-EXIT.
 18700     EXIT.
 18701
 18702 6690-END-OF-FILE.
 18703     GO TO 6700-COMM-EXIT.
 18704
 18705 6690-ERRESC-PROBLEM.
 18706      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 341
* EL050.cbl
 18707      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18708
 18709      GO TO 6700-COMM-EXIT.
 18710
 18711 6700-COMM-EXIT.
 18712     EXIT.
 18713
 18714 7000-GET-RATE.
 18715
 18716* EXEC CICS LINK
 18717*        PROGRAM    ('ELRATE')
 18718*        COMMAREA   (CALCULATION-PASS-AREA)
 18719*        LENGTH     (CP-COMM-LENGTH)
 18720*    END-EXEC.
 18721     MOVE 'ELRATE' TO DFHEIV1
 18722*    MOVE '."C                   (   #00018493' TO DFHEIV0
 18723     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18724     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18725     MOVE X'2020233030303138343933' TO DFHEIV0(25:11)
 18726     CALL 'kxdfhei1' USING DFHEIV0,
 18727           DFHEIV1,
 18728           CALCULATION-PASS-AREA,
 18729           CP-COMM-LENGTH,
 18730           DFHEIV99,
 18731           DFHEIV99,
 18732           DFHEIV99,
 18733           DFHEIV99
 18734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18735
 18736
 18737 7000-EXIT.
 18738     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 342
* EL050.cbl
 18740 7100-FIND-BENEFIT-IN-STATE.
 18741     MOVE 'N'                    TO BEN-SEARCH-SW.
 18742
 18743     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18744         VARYING SUB3 FROM 1 BY 1 UNTIL
 18745            ((SUB3 GREATER 50) OR
 18746              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18747               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18748
 18749     IF SUB3 NOT = 51
 18750         MOVE 'Y'                TO BEN-SEARCH-SW.
 18751
 18752     GO TO 7199-EXIT.
 18753
 18754 7100-BENEFIT-DUMMY.
 18755
 18756 7100-DUMMY-EXIT.
 18757     EXIT.
 18758
 18759 7199-EXIT.
 18760     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 343
* EL050.cbl
 18762 7200-FIND-BENEFIT.
 18763     MOVE 'N'                    TO BEN-SEARCH-SW.
 18764
 18765     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18766         VARYING SUB3 FROM 1 BY 1 UNTIL
 18767            ((SUB3 GREATER 8) OR
 18768            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18769
 18770     IF SUB3 NOT = 9
 18771         MOVE 'Y'                TO BEN-SEARCH-SW.
 18772
 18773     GO TO 7200-EXIT.
 18774
 18775 7200-BENEFIT-DUMMY.
 18776
 18777 7200-DUMMY-EXIT.
 18778     EXIT.
 18779
 18780 7200-EXIT.
 18781     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 344
* EL050.cbl
 18783 7250-LOOK-FOR-RESCINDED-CLAIM.
 18784     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18785                                    W-CL-COMP-CD.
 18786     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18787                                    W-CL-CERT-NO.
 18788
 18789
 18790* EXEC CICS HANDLE CONDITION
 18791*        NOTFND  (7250-CONTINUE)
 18792*        ENDFILE (7250-CONTINUE)
 18793*    END-EXEC.
 18794*    MOVE '"$I''                  ! ) #00018551' TO DFHEIV0
 18795     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18796     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18797     MOVE X'2920233030303138353531' TO DFHEIV0(25:11)
 18798     CALL 'kxdfhei1' USING DFHEIV0
 18799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18800
 18801
 18802
 18803* EXEC CICS IGNORE CONDITION
 18804*        DUPKEY
 18805*    END-EXEC.
 18806*    MOVE '"*$                   !   #00018556' TO DFHEIV0
 18807     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18808     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18809     MOVE X'2020233030303138353536' TO DFHEIV0(25:11)
 18810     CALL 'kxdfhei1' USING DFHEIV0
 18811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18812
 18813
 18814
 18815* EXEC CICS STARTBR
 18816*        DATASET   (CLMS-ID)
 18817*        RIDFLD    (ELMSTR-KEY)
 18818*        GENERIC   EQUAL
 18819*        KEYLENGTH (ELMSTR-LENGTH)
 18820*    END-EXEC.
 18821     MOVE 0
 18822       TO DFHEIV11
 18823*    MOVE '&,   KG    E          &   #00018560' TO DFHEIV0
 18824     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18825     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18826     MOVE X'2020233030303138353630' TO DFHEIV0(25:11)
 18827     CALL 'kxdfhei1' USING DFHEIV0,
 18828           CLMS-ID,
 18829           ELMSTR-KEY,
 18830           ELMSTR-LENGTH,
 18831           DFHEIV11,
 18832           DFHEIV99
 18833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18834
 18835
 18836     MOVE 'Y'                    TO W-BROWSE-SW.
 18837
 18838 7250-NEXT-CLAIM.
 18839
 18840
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 345
* EL050.cbl
 18841* EXEC CICS READNEXT
 18842*        DATASET   (CLMS-ID)
 18843*        RIDFLD    (ELMSTR-KEY)
 18844*        SET       (ADDRESS OF CLAIM-MASTER)
 18845*    END-EXEC.
 18846     MOVE 0
 18847       TO DFHEIV11
 18848*    MOVE '&.S                   )   #00018571' TO DFHEIV0
 18849     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18850     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18851     MOVE X'2020233030303138353731' TO DFHEIV0(25:11)
 18852     CALL 'kxdfhei1' USING DFHEIV0,
 18853           CLMS-ID,
 18854           DFHEIV20,
 18855           DFHEIV99,
 18856           ELMSTR-KEY,
 18857           DFHEIV99,
 18858           DFHEIV11,
 18859           DFHEIV99,
 18860           DFHEIV99
 18861     SET ADDRESS OF CLAIM-MASTER TO
 18862         DFHEIV20
 18863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18864
 18865
 18866     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18867        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18868         GO TO 7250-CONTINUE
 18869     END-IF.
 18870
 18871     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18872        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18873        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18874        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18875        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18876         GO TO 7250-NEXT-CLAIM
 18877     END-IF.
 18878
 18879     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18880        OR (CL-CLAIM-TYPE = 'I')
 18881        OR (CL-CLAIM-TYPE = 'G')
 18882        OR (CL-CLAIM-TYPE = 'F')
 18883          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18884              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18885              GO TO 7250-CONTINUE
 18886          END-IF
 18887     END-IF.
 18888
 18889     GO TO 7250-NEXT-CLAIM.
 18890
 18891 7250-CONTINUE.
 18892
 18893     IF W-BROWSE-SW = 'Y'
 18894
 18895* EXEC CICS ENDBR
 18896*            DATASET   (CLMS-ID)
 18897*        END-EXEC
 18898     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 346
* EL050.cbl
 18899       TO DFHEIV11
 18900*    MOVE '&2                    $   #00018605' TO DFHEIV0
 18901     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18902     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18903     MOVE X'2020233030303138363035' TO DFHEIV0(25:11)
 18904     CALL 'kxdfhei1' USING DFHEIV0,
 18905           CLMS-ID,
 18906           DFHEIV11,
 18907           DFHEIV99
 18908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18909         MOVE 'N' TO W-BROWSE-SW
 18910     END-IF.
 18911
 18912 7250-EXIT.
 18913     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 347
* EL050.cbl
 18915 7300-CHECK-FOR-OPEN-CLMS.
 18916
 18917*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18918*    MOVE SPACES                 TO CNTL-ACCESS.
 18919*    MOVE '1'                    TO CNTL-REC-TYPE.
 18920*    MOVE +0                     TO CNTL-SEQ-NO.
 18921
 18922*    MOVE '3'                    TO RC-SW-1.
 18923*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18924
 18925*    IF NOT CF-COMPANY-MASTER
 18926*         PERFORM 0099-COMPANY-NOT-FOUND
 18927*         GO TO 7300-EXIT.
 18928
 18929     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18930                                    W-CL-COMP-CD.
 18931     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18932                                    W-CL-CERT-NO.
 18933
 18934
 18935* EXEC CICS HANDLE CONDITION
 18936*        NOTFND  (7300-CONTINUE)
 18937*        ENDFILE (7300-CONTINUE)
 18938*    END-EXEC.
 18939*    MOVE '"$I''                  ! * #00018633' TO DFHEIV0
 18940     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18941     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18942     MOVE X'2A20233030303138363333' TO DFHEIV0(25:11)
 18943     CALL 'kxdfhei1' USING DFHEIV0
 18944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18945
 18946
 18947
 18948* EXEC CICS IGNORE CONDITION
 18949*        DUPKEY
 18950*    END-EXEC.
 18951*    MOVE '"*$                   !   #00018638' TO DFHEIV0
 18952     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18953     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18954     MOVE X'2020233030303138363338' TO DFHEIV0(25:11)
 18955     CALL 'kxdfhei1' USING DFHEIV0
 18956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18957
 18958
 18959
 18960* EXEC CICS STARTBR
 18961*        DATASET   (CLMS-ID)
 18962*        RIDFLD    (ELMSTR-KEY)
 18963*        GENERIC   EQUAL
 18964*        KEYLENGTH (ELMSTR-LENGTH)
 18965*    END-EXEC.
 18966     MOVE 0
 18967       TO DFHEIV11
 18968*    MOVE '&,   KG    E          &   #00018642' TO DFHEIV0
 18969     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18970     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18971     MOVE X'2020233030303138363432' TO DFHEIV0(25:11)
 18972     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 348
* EL050.cbl
 18973           CLMS-ID,
 18974           ELMSTR-KEY,
 18975           ELMSTR-LENGTH,
 18976           DFHEIV11,
 18977           DFHEIV99
 18978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18979
 18980
 18981     MOVE 'Y'                    TO W-BROWSE-SW.
 18982
 18983 7300-NEXT-CLAIM.
 18984
 18985
 18986* EXEC CICS READNEXT
 18987*        DATASET   (CLMS-ID)
 18988*        RIDFLD    (ELMSTR-KEY)
 18989*        SET       (ADDRESS OF CLAIM-MASTER)
 18990*    END-EXEC.
 18991     MOVE 0
 18992       TO DFHEIV11
 18993*    MOVE '&.S                   )   #00018653' TO DFHEIV0
 18994     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18995     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18996     MOVE X'2020233030303138363533' TO DFHEIV0(25:11)
 18997     CALL 'kxdfhei1' USING DFHEIV0,
 18998           CLMS-ID,
 18999           DFHEIV20,
 19000           DFHEIV99,
 19001           ELMSTR-KEY,
 19002           DFHEIV99,
 19003           DFHEIV11,
 19004           DFHEIV99,
 19005           DFHEIV99
 19006     SET ADDRESS OF CLAIM-MASTER TO
 19007         DFHEIV20
 19008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19009
 19010
 19011     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19012        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19013         GO TO 7300-CONTINUE.
 19014
 19015     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19016        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19017        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19018        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19019        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19020         GO TO 7300-NEXT-CLAIM.
 19021
 19022*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19023     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19024        OR (CL-CLAIM-TYPE = 'I')
 19025        OR (CL-CLAIM-TYPE = 'G')
 19026        OR (CL-CLAIM-TYPE = 'F')
 19027        IF CLAIM-IS-OPEN
 19028           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19029             AND PB-C-AH-CANCEL-DT > SPACES
 19030              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 349
* EL050.cbl
 19031              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19032           END-IF
 19033           EVALUATE TRUE
 19034             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19035                 MOVE ER-2884      TO WS-ERROR
 19036             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19037                 MOVE ER-2887      TO WS-ERROR
 19038             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19039                 MOVE ER-2886      TO WS-ERROR
 19040             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19041                 MOVE ER-2888      TO WS-ERROR
 19042             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19043                 MOVE ER-2885      TO WS-ERROR
 19044             WHEN OTHER
 19045                 MOVE ER-2768      TO WS-ERROR
 19046           END-EVALUATE
 19047           IF PB-C-AH-CANCEL-VOIDED OR
 19048              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19049                NOT AH-COVERAGE-CANCELLED)
 19050               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19051               MOVE ER-2768      TO WS-ERROR
 19052           END-IF
 19053           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19054           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19055              PB-FORCE-CODE NOT EQUAL '8'
 19056               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19057           END-IF
 19058           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19059           GO TO 7300-NEXT-CLAIM
 19060        ELSE
 19061           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19062*****THIS IS A RESCISSION OR REFORMATION
 19063              IF AH-COVERAGE-CANCELLED
 19064                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19065                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19066                    MOVE 1                   TO DC-ELAPSED-DAYS
 19067                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19068                    SET BIN-PLUS-ELAPSED     TO TRUE
 19069                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19070                    IF NO-CONVERSION-ERROR
 19071                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19072                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19073                          MOVE ER-2897 TO WS-ERROR
 19074                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19075                          GO TO 7300-NEXT-CLAIM
 19076                       END-IF
 19077                    END-IF
 19078                 ELSE
 19079                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19080                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19081                         MOVE ER-2890 TO WS-ERROR
 19082                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19083                         GO TO 7300-NEXT-CLAIM
 19084                      ELSE
 19085                         MOVE ER-2898 TO WS-ERROR
 19086                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19087                         GO TO 7300-NEXT-CLAIM
 19088                      END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 350
* EL050.cbl
 19089                   END-IF
 19090                 END-IF
 19091              END-IF
 19092           ELSE
 19093              IF CL-DENIAL-TYPE = '1'  AND
 19094                 CL-TOTAL-PAID-AMT = 0
 19095                    GO TO 7300-NEXT-CLAIM
 19096              END-IF
 19097              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19098               AND PB-C-AH-CANCEL-DT > SPACES
 19099                 MOVE ER-2756        TO WS-ERROR
 19100                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19101                 GO TO 7300-NEXT-CLAIM
 19102              END-IF
 19103           END-IF
 19104        END-IF
 19105     ELSE
 19106*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19107        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19108           IF CLAIM-IS-OPEN
 19109              MOVE ER-2889      TO WS-ERROR
 19110              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19111              GO TO 7300-NEXT-CLAIM
 19112           ELSE
 19113              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19114*****THIS IS A RESCISSION OR REFORMATION
 19115                 IF (LF-COVERAGE-CANCELLED AND
 19116                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19117                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19118                         MOVE ER-2890 TO WS-ERROR
 19119                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19120                         GO TO 7300-NEXT-CLAIM
 19121                      ELSE
 19122                         MOVE ER-2898 TO WS-ERROR
 19123                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19124                         GO TO 7300-NEXT-CLAIM
 19125                      END-IF
 19126                 END-IF
 19127              ELSE
 19128                 IF CL-DENIAL-TYPE = '1'  AND
 19129                    CL-TOTAL-PAID-AMT = 0
 19130                       GO TO 7300-NEXT-CLAIM
 19131                 END-IF
 19132                 IF (AH-COVERAGE-CANCELLED AND
 19133                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 19134                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 19135                    (LF-COVERAGE-CANCELLED AND
 19136                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 19137                     WS-ST-REFUND-CLAIM-FLAG = '4')
 19138                       MOVE ER-2965 TO WS-ERROR
 19139                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19140                       GO TO 7300-NEXT-CLAIM
 19141                 END-IF
 19142                 IF LF-COVERAGE-CANCELLED
 19143                  IF CL-TOTAL-PAID-AMT > 0
 19144                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19145                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19146                        MOVE ER-2891 TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 351
* EL050.cbl
 19147                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19148                        GO TO 7300-NEXT-CLAIM
 19149                      END-IF
 19150                    ELSE
 19151****only show this error if cert num matches exactly
 19152                      IF PB-CERT-NO = CL-CERT-NO
 19153                         MOVE ER-2892 TO WS-ERROR
 19154                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19155                         GO TO 7300-NEXT-CLAIM
 19156                      END-IF
 19157                    END-IF
 19158                  END-IF
 19159                 END-IF
 19160              END-IF
 19161           END-IF
 19162        END-IF
 19163     END-IF
 19164
 19165     GO TO 7300-NEXT-CLAIM.
 19166
 19167 7300-CONTINUE.
 19168
 19169     IF W-BROWSE-SW = 'Y'
 19170
 19171* EXEC CICS ENDBR
 19172*            DATASET   (CLMS-ID)
 19173*        END-EXEC.
 19174     MOVE 0
 19175       TO DFHEIV11
 19176*    MOVE '&2                    $   #00018818' TO DFHEIV0
 19177     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19178     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19179     MOVE X'2020233030303138383138' TO DFHEIV0(25:11)
 19180     CALL 'kxdfhei1' USING DFHEIV0,
 19181           CLMS-ID,
 19182           DFHEIV11,
 19183           DFHEIV99
 19184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19185
 19186
 19187 7300-EXIT.
 19188     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 352
* EL050.cbl
 19190
 19191 7400-GET-REMAIN-TERM.
 19192
 19193* EXEC CICS LINK
 19194*        PROGRAM    ('ELRTRM')
 19195*        COMMAREA   (CALCULATION-PASS-AREA)
 19196*        LENGTH     (CP-COMM-LENGTH)
 19197*    END-EXEC.
 19198     MOVE 'ELRTRM' TO DFHEIV1
 19199*    MOVE '."C                   (   #00018827' TO DFHEIV0
 19200     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19201     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19202     MOVE X'2020233030303138383237' TO DFHEIV0(25:11)
 19203     CALL 'kxdfhei1' USING DFHEIV0,
 19204           DFHEIV1,
 19205           CALCULATION-PASS-AREA,
 19206           CP-COMM-LENGTH,
 19207           DFHEIV99,
 19208           DFHEIV99,
 19209           DFHEIV99,
 19210           DFHEIV99
 19211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19212
 19213
 19214 7400-EXIT.
 19215     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 353
* EL050.cbl
 19217
 19218 7500-GET-REMAIN-AMOUNT.
 19219
 19220* EXEC CICS LINK
 19221*        PROGRAM    ('ELRAMT')
 19222*        COMMAREA   (CALCULATION-PASS-AREA)
 19223*        LENGTH     (CP-COMM-LENGTH)
 19224*    END-EXEC.
 19225     MOVE 'ELRAMT' TO DFHEIV1
 19226*    MOVE '."C                   (   #00018838' TO DFHEIV0
 19227     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19228     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19229     MOVE X'2020233030303138383338' TO DFHEIV0(25:11)
 19230     CALL 'kxdfhei1' USING DFHEIV0,
 19231           DFHEIV1,
 19232           CALCULATION-PASS-AREA,
 19233           CP-COMM-LENGTH,
 19234           DFHEIV99,
 19235           DFHEIV99,
 19236           DFHEIV99,
 19237           DFHEIV99
 19238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19239
 19240
 19241 7500-EXIT.
 19242     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 354
* EL050.cbl
 19244
 19245 7600-GET-REFUND.
 19246
 19247* EXEC CICS LINK
 19248*        PROGRAM    ('ELRFND')
 19249*        COMMAREA   (CALCULATION-PASS-AREA)
 19250*        LENGTH     (CP-COMM-LENGTH)
 19251*    END-EXEC.
 19252     MOVE 'ELRFND' TO DFHEIV1
 19253*    MOVE '."C                   (   #00018849' TO DFHEIV0
 19254     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19255     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19256     MOVE X'2020233030303138383439' TO DFHEIV0(25:11)
 19257     CALL 'kxdfhei1' USING DFHEIV0,
 19258           DFHEIV1,
 19259           CALCULATION-PASS-AREA,
 19260           CP-COMM-LENGTH,
 19261           DFHEIV99,
 19262           DFHEIV99,
 19263           DFHEIV99,
 19264           DFHEIV99
 19265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19266
 19267
 19268 7600-EXIT.
 19269     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 355
* EL050.cbl
 19271 7700-CALL-DL1.
 19272
 19273* EXEC CICS LINK
 19274*        PROGRAM    ('DLO001')
 19275*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19276*        LENGTH     (DLO001-COMM-LENGTH)
 19277*    END-EXEC.
 19278     MOVE 'DLO001' TO DFHEIV1
 19279*    MOVE '."C                   (   #00018859' TO DFHEIV0
 19280     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19281     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19282     MOVE X'2020233030303138383539' TO DFHEIV0(25:11)
 19283     CALL 'kxdfhei1' USING DFHEIV0,
 19284           DFHEIV1,
 19285           WS-DLO-MASTER-POLICY-FORM,
 19286           DLO001-COMM-LENGTH,
 19287           DFHEIV99,
 19288           DFHEIV99,
 19289           DFHEIV99,
 19290           DFHEIV99
 19291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19292
 19293
 19294 7700-EXIT.
 19295     EXIT.
 19296
 19297 7710-CALL-DL2.
 19298
 19299* EXEC CICS LINK
 19300*        PROGRAM    ('DLO002')
 19301*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19302*        LENGTH     (DLO002-COMM-LENGTH)
 19303*    END-EXEC.
 19304     MOVE 'DLO002' TO DFHEIV1
 19305*    MOVE '."C                   (   #00018869' TO DFHEIV0
 19306     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19307     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19308     MOVE X'2020233030303138383639' TO DFHEIV0(25:11)
 19309     CALL 'kxdfhei1' USING DFHEIV0,
 19310           DFHEIV1,
 19311           WS-DLO-INTERNAL-POLICY-FORM,
 19312           DLO002-COMM-LENGTH,
 19313           DFHEIV99,
 19314           DFHEIV99,
 19315           DFHEIV99,
 19316           DFHEIV99
 19317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19318
 19319
 19320 7710-EXIT.
 19321     EXIT.
 19322
 19323 7720-CALL-DL3.
 19324
 19325* EXEC CICS LINK
 19326*        PROGRAM    ('DLO003')
 19327*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19328*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 356
* EL050.cbl
 19329*    END-EXEC.
 19330     MOVE 'DLO003' TO DFHEIV1
 19331*    MOVE '."C                   (   #00018879' TO DFHEIV0
 19332     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19333     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19334     MOVE X'2020233030303138383739' TO DFHEIV0(25:11)
 19335     CALL 'kxdfhei1' USING DFHEIV0,
 19336           DFHEIV1,
 19337           WS-DLO-VALID-BANK-ID,
 19338           DLO003-COMM-LENGTH,
 19339           DFHEIV99,
 19340           DFHEIV99,
 19341           DFHEIV99,
 19342           DFHEIV99
 19343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19344
 19345
 19346 7720-EXIT.
 19347     EXIT.
 19348
 19349 7730-CALL-DL7.
 19350
 19351* EXEC CICS LINK
 19352*        PROGRAM    ('DLO007')
 19353*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19354*        LENGTH     (DLO007-COMM-LENGTH)
 19355*    END-EXEC.
 19356     MOVE 'DLO007' TO DFHEIV1
 19357*    MOVE '."C                   (   #00018889' TO DFHEIV0
 19358     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19359     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19360     MOVE X'2020233030303138383839' TO DFHEIV0(25:11)
 19361     CALL 'kxdfhei1' USING DFHEIV0,
 19362           DFHEIV1,
 19363           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19364           DLO007-COMM-LENGTH,
 19365           DFHEIV99,
 19366           DFHEIV99,
 19367           DFHEIV99,
 19368           DFHEIV99
 19369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19370
 19371
 19372 7730-EXIT.
 19373     EXIT.
 19374
 19375 7740-CALL-DL11.
 19376
 19377* EXEC CICS LINK
 19378*        PROGRAM    ('DLO011')
 19379*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19380*        LENGTH     (DLO011-COMM-LENGTH)
 19381*    END-EXEC.
 19382     MOVE 'DLO011' TO DFHEIV1
 19383*    MOVE '."C                   (   #00018899' TO DFHEIV0
 19384     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19385     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19386     MOVE X'2020233030303138383939' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 357
* EL050.cbl
 19387     CALL 'kxdfhei1' USING DFHEIV0,
 19388           DFHEIV1,
 19389           WS-DLO-PREM-RATES-BEN-TYPE,
 19390           DLO011-COMM-LENGTH,
 19391           DFHEIV99,
 19392           DFHEIV99,
 19393           DFHEIV99,
 19394           DFHEIV99
 19395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19396
 19397
 19398 7740-EXIT.
 19399     EXIT.
 19400
 19401 7750-CALL-DL17.
 19402
 19403* EXEC CICS LINK
 19404*        PROGRAM    ('DLO017')
 19405*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19406*        LENGTH     (DLO017-COMM-LENGTH)
 19407*    END-EXEC.
 19408     MOVE 'DLO017' TO DFHEIV1
 19409*    MOVE '."C                   (   #00018909' TO DFHEIV0
 19410     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19411     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19412     MOVE X'2020233030303138393039' TO DFHEIV0(25:11)
 19413     CALL 'kxdfhei1' USING DFHEIV0,
 19414           DFHEIV1,
 19415           WS-DLO-VALID-RATE-CODE,
 19416           DLO017-COMM-LENGTH,
 19417           DFHEIV99,
 19418           DFHEIV99,
 19419           DFHEIV99,
 19420           DFHEIV99
 19421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19422
 19423
 19424 7750-EXIT.
 19425     EXIT.
 19426
 19427 7755-CALL-DL19.
 19428
 19429* EXEC CICS LINK
 19430*        PROGRAM    ('DLO019')
 19431*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19432*        LENGTH     (DLO019-COMM-LENGTH)
 19433*    END-EXEC.
 19434     MOVE 'DLO019' TO DFHEIV1
 19435*    MOVE '."C                   (   #00018919' TO DFHEIV0
 19436     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19437     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19438     MOVE X'2020233030303138393139' TO DFHEIV0(25:11)
 19439     CALL 'kxdfhei1' USING DFHEIV0,
 19440           DFHEIV1,
 19441           WS-DLO-ORIG-COV-CAT,
 19442           DLO019-COMM-LENGTH,
 19443           DFHEIV99,
 19444           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 358
* EL050.cbl
 19445           DFHEIV99,
 19446           DFHEIV99
 19447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19448
 19449
 19450 7755-EXIT.
 19451     EXIT.
 19452
 19453 7760-CALL-DL21.
 19454
 19455* EXEC CICS LINK
 19456*        PROGRAM    ('DLO021')
 19457*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19458*        LENGTH     (DLO021-COMM-LENGTH)
 19459*    END-EXEC.
 19460     MOVE 'DLO021' TO DFHEIV1
 19461*    MOVE '."C                   (   #00018929' TO DFHEIV0
 19462     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19463     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19464     MOVE X'2020233030303138393239' TO DFHEIV0(25:11)
 19465     CALL 'kxdfhei1' USING DFHEIV0,
 19466           DFHEIV1,
 19467           WS-DLO-VALID-LOAN-OFFICER,
 19468           DLO021-COMM-LENGTH,
 19469           DFHEIV99,
 19470           DFHEIV99,
 19471           DFHEIV99,
 19472           DFHEIV99
 19473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19474
 19475
 19476 7760-EXIT.
 19477     EXIT.
 19478
 19479 7770-CALL-DL22.
 19480
 19481* EXEC CICS LINK
 19482*        PROGRAM    ('DLO022')
 19483*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19484*        LENGTH     (DLO022-COMM-LENGTH)
 19485*    END-EXEC.
 19486     MOVE 'DLO022' TO DFHEIV1
 19487*    MOVE '."C                   (   #00018939' TO DFHEIV0
 19488     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19489     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19490     MOVE X'2020233030303138393339' TO DFHEIV0(25:11)
 19491     CALL 'kxdfhei1' USING DFHEIV0,
 19492           DFHEIV1,
 19493           WS-DLO-VALID-STATE-CODE,
 19494           DLO022-COMM-LENGTH,
 19495           DFHEIV99,
 19496           DFHEIV99,
 19497           DFHEIV99,
 19498           DFHEIV99
 19499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19500
 19501
 19502 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 359
* EL050.cbl
 19503     EXIT.
 19504
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 360
* EL050.cbl
 19506
 19507 7800-REWRITE-CERT.
 19508******************************************************************
 19509*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19510*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19511******************************************************************
 19512
 19513     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19514        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19515        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19516        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19517
 19518* EXEC CICS REWRITE
 19519*                  DATASET (CERT-ID)
 19520*                  FROM    (CERTIFICATE-MASTER)
 19521*              END-EXEC
 19522     MOVE LENGTH OF
 19523      CERTIFICATE-MASTER
 19524       TO DFHEIV11
 19525*    MOVE '&& L                  %   #00018960' TO DFHEIV0
 19526     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19527     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19528     MOVE X'2020233030303138393630' TO DFHEIV0(25:11)
 19529     CALL 'kxdfhei1' USING DFHEIV0,
 19530           CERT-ID,
 19531           CERTIFICATE-MASTER,
 19532           DFHEIV11,
 19533           DFHEIV99
 19534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19535        GO TO 7800-EXIT.
 19536
 19537       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19538       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19539
 19540 7800-EXIT.
 19541      EXIT.
 19542
 19543 7900-DELETE-CERT.
 19544
 19545* EXEC CICS DELETE
 19546*        DATASET (CERT-ID)
 19547*    END-EXEC.
 19548*    MOVE '&(                    &   #00018973' TO DFHEIV0
 19549     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19550     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19551     MOVE X'2020233030303138393733' TO DFHEIV0(25:11)
 19552     CALL 'kxdfhei1' USING DFHEIV0,
 19553           CERT-ID,
 19554           DFHEIV99,
 19555           DFHEIV99,
 19556           DFHEIV99,
 19557           DFHEIV99
 19558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19559
 19560
 19561 7900-EXIT.
 19562     EXIT.
 19563
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 361
* EL050.cbl
 19564 8000-WRITE-CERT.
 19565
 19566* EXEC CICS HANDLE CONDITION
 19567*        DUPKEY    (8000-FREE-MAIN)
 19568*    END-EXEC.
 19569*    MOVE '"$$                   ! + #00018981' TO DFHEIV0
 19570     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19571     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19572     MOVE X'2B20233030303138393831' TO DFHEIV0(25:11)
 19573     CALL 'kxdfhei1' USING DFHEIV0
 19574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19575
 19576
 19577
 19578* EXEC CICS WRITE
 19579*        DATASET     (CERT-ID)
 19580*        FROM        (CERTIFICATE-MASTER)
 19581*        RIDFLD      (ELCERT-KEY)
 19582*    END-EXEC.
 19583     MOVE LENGTH OF
 19584      CERTIFICATE-MASTER
 19585       TO DFHEIV11
 19586*    MOVE '&$ L                  ''   #00018985' TO DFHEIV0
 19587     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19588     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19589     MOVE X'2020233030303138393835' TO DFHEIV0(25:11)
 19590     CALL 'kxdfhei1' USING DFHEIV0,
 19591           CERT-ID,
 19592           CERTIFICATE-MASTER,
 19593           DFHEIV11,
 19594           ELCERT-KEY,
 19595           DFHEIV99,
 19596           DFHEIV99
 19597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19598
 19599
 19600 8000-FREE-MAIN.
 19601
 19602 8000-EXIT.
 19603      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 362
* EL050.cbl
 19605
 19606 8100-READ-ERPNDM.
 19607
 19608* EXEC CICS HANDLE CONDITION
 19609*         NOTFND     (8100-NOTFND)
 19610*         ENDFILE    (8100-NOTFND)
 19611*    END-EXEC.
 19612*    MOVE '"$I''                  ! , #00018998' TO DFHEIV0
 19613     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19614     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19615     MOVE X'2C20233030303138393938' TO DFHEIV0(25:11)
 19616     CALL 'kxdfhei1' USING DFHEIV0
 19617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19618
 19619
 19620     MOVE SPACES                 TO ERPNDM-FOUND.
 19621     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19622
 19623
 19624* EXEC CICS READ
 19625*         DATASET   (FILE-ERPNDM)
 19626*         RIDFLD    (PM-CONTROL-PRIMARY)
 19627*         INTO      (PENDING-MAILING-DATA)
 19628*    END-EXEC.
 19629     MOVE LENGTH OF
 19630      PENDING-MAILING-DATA
 19631       TO DFHEIV11
 19632*    MOVE '&"IL       E          (   #00019006' TO DFHEIV0
 19633     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19634     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19635     MOVE X'2020233030303139303036' TO DFHEIV0(25:11)
 19636     CALL 'kxdfhei1' USING DFHEIV0,
 19637           FILE-ERPNDM,
 19638           PENDING-MAILING-DATA,
 19639           DFHEIV11,
 19640           PM-CONTROL-PRIMARY,
 19641           DFHEIV99,
 19642           DFHEIV99,
 19643           DFHEIV99
 19644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19645
 19646
 19647     GO TO 8100-EXIT.
 19648
 19649 8100-NOTFND.
 19650
 19651     MOVE 'X'                    TO ERPNDM-FOUND.
 19652     MOVE ER-2694                TO WS-ERROR.
 19653     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19654     MOVE ER-2883                TO WS-ERROR
 19655     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19656     .
 19657 8100-EXIT.
 19658     EXIT.
 19659
 19660 8110-READ-ERMAIL.
 19661
 19662* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 363
* EL050.cbl
 19663*         NOTFND     (8110-NOTFND)
 19664*         ENDFILE    (8110-NOTFND)
 19665*    END-EXEC.
 19666*    MOVE '"$I''                  ! - #00019026' TO DFHEIV0
 19667     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19668     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19669     MOVE X'2D20233030303139303236' TO DFHEIV0(25:11)
 19670     CALL 'kxdfhei1' USING DFHEIV0
 19671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19672
 19673
 19674     MOVE SPACES                 TO ERMAIL-FOUND.
 19675     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19676     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19677     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19678     MOVE PB-SV-STATE            TO MA-STATE.
 19679
 19680
 19681* EXEC CICS READ
 19682*         UPDATE
 19683*         DATASET   (FILE-ERMAIL)
 19684*         RIDFLD    (MA-CONTROL-PRIMARY)
 19685*         INTO      (MAILING-DATA)
 19686*    END-EXEC.
 19687     MOVE LENGTH OF
 19688      MAILING-DATA
 19689       TO DFHEIV11
 19690*    MOVE '&"IL       EU         (   #00019037' TO DFHEIV0
 19691     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19692     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19693     MOVE X'2020233030303139303337' TO DFHEIV0(25:11)
 19694     CALL 'kxdfhei1' USING DFHEIV0,
 19695           FILE-ERMAIL,
 19696           MAILING-DATA,
 19697           DFHEIV11,
 19698           MA-CONTROL-PRIMARY,
 19699           DFHEIV99,
 19700           DFHEIV99,
 19701           DFHEIV99
 19702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19703
 19704
 19705     GO TO 8110-EXIT.
 19706
 19707 8110-NOTFND.
 19708     MOVE 'X'                    TO ERMAIL-FOUND.
 19709
 19710 8110-EXIT.
 19711     EXIT.
 19712
 19713 8120-REWRITE-ERMAIL.
 19714
 19715* EXEC CICS REWRITE
 19716*         DATASET    (FILE-ERMAIL)
 19717*         FROM       (MAILING-DATA)
 19718*    END-EXEC.
 19719     MOVE LENGTH OF
 19720      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 364
* EL050.cbl
 19721       TO DFHEIV11
 19722*    MOVE '&& L                  %   #00019053' TO DFHEIV0
 19723     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19724     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19725     MOVE X'2020233030303139303533' TO DFHEIV0(25:11)
 19726     CALL 'kxdfhei1' USING DFHEIV0,
 19727           FILE-ERMAIL,
 19728           MAILING-DATA,
 19729           DFHEIV11,
 19730           DFHEIV99
 19731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19732
 19733
 19734 8120-EXIT.
 19735     EXIT.
 19736
 19737 8130-WRITE-ERMAIL.
 19738
 19739* EXEC CICS HANDLE CONDITION
 19740*         DUPKEY   (8130-EXIT)
 19741*    END-EXEC.
 19742*    MOVE '"$$                   ! . #00019062' TO DFHEIV0
 19743     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19744     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19745     MOVE X'2E20233030303139303632' TO DFHEIV0(25:11)
 19746     CALL 'kxdfhei1' USING DFHEIV0
 19747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19748
 19749
 19750
 19751* EXEC CICS WRITE
 19752*         DATASET     (FILE-ERMAIL)
 19753*         RIDFLD      (MA-CONTROL-PRIMARY)
 19754*         FROM        (MAILING-DATA)
 19755*    END-EXEC.
 19756     MOVE LENGTH OF
 19757      MAILING-DATA
 19758       TO DFHEIV11
 19759*    MOVE '&$ L                  ''   #00019066' TO DFHEIV0
 19760     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19761     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19762     MOVE X'2020233030303139303636' TO DFHEIV0(25:11)
 19763     CALL 'kxdfhei1' USING DFHEIV0,
 19764           FILE-ERMAIL,
 19765           MAILING-DATA,
 19766           DFHEIV11,
 19767           MA-CONTROL-PRIMARY,
 19768           DFHEIV99,
 19769           DFHEIV99
 19770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19771
 19772
 19773 8130-EXIT.
 19774     EXIT.
 19775
 19776 8140-UNLOCK-ERMAIL.
 19777
 19778* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 365
* EL050.cbl
 19779*         DATASET   (FILE-ERMAIL)
 19780*    END-EXEC.
 19781*    MOVE '&*                    #   #00019076' TO DFHEIV0
 19782     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19783     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19784     MOVE X'2020233030303139303736' TO DFHEIV0(25:11)
 19785     CALL 'kxdfhei1' USING DFHEIV0,
 19786           FILE-ERMAIL,
 19787           DFHEIV99
 19788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19789
 19790
 19791 8140-EXIT.
 19792     EXIT.
 19793
 19794 8150-read-elcrtt.
 19795
 19796
 19797* EXEC CICS HANDLE CONDITION
 19798*        NOTFND   (8150-exit)
 19799*    END-EXEC
 19800*    MOVE '"$I                   ! / #00019085' TO DFHEIV0
 19801     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19803     MOVE X'2F20233030303139303835' TO DFHEIV0(25:11)
 19804     CALL 'kxdfhei1' USING DFHEIV0
 19805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19806
 19807     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19808     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19809
 19810
 19811* EXEC CICS READ
 19812*        DATASET  (CRTT-ID)
 19813*        RIDFLD   (WS-ELCRTT-KEY)
 19814*        INTO     (CERTIFICATE-TRAILERS)
 19815*    END-EXEC
 19816     MOVE LENGTH OF
 19817      CERTIFICATE-TRAILERS
 19818       TO DFHEIV11
 19819*    MOVE '&"IL       E          (   #00019092' TO DFHEIV0
 19820     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19821     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19822     MOVE X'2020233030303139303932' TO DFHEIV0(25:11)
 19823     CALL 'kxdfhei1' USING DFHEIV0,
 19824           CRTT-ID,
 19825           CERTIFICATE-TRAILERS,
 19826           DFHEIV11,
 19827           WS-ELCRTT-KEY,
 19828           DFHEIV99,
 19829           DFHEIV99,
 19830           DFHEIV99
 19831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19832
 19833     move cs-ins-age-default-flag to ws-ins-age-defaulted
 19834     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 19835
 19836     .
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 366
* EL050.cbl
 19837 8150-exit.
 19838     exit.
 19839 8180-UPDATE-VIN-NUMBER.
 19840
 19841* EXEC CICS HANDLE CONDITION
 19842*        NOTFND   (8180-NOTFND)
 19843*    END-EXEC.
 19844*    MOVE '"$I                   ! 0 #00019105' TO DFHEIV0
 19845     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19846     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19847     MOVE X'3020233030303139313035' TO DFHEIV0(25:11)
 19848     CALL 'kxdfhei1' USING DFHEIV0
 19849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19850
 19851
 19852     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19853     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19854
 19855
 19856* EXEC CICS READ
 19857*        UPDATE
 19858*        DATASET  (CRTT-ID)
 19859*        RIDFLD   (WS-ELCRTT-KEY)
 19860*        INTO     (CERTIFICATE-TRAILERS)
 19861*    END-EXEC.
 19862     MOVE LENGTH OF
 19863      CERTIFICATE-TRAILERS
 19864       TO DFHEIV11
 19865*    MOVE '&"IL       EU         (   #00019112' TO DFHEIV0
 19866     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19867     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19868     MOVE X'2020233030303139313132' TO DFHEIV0(25:11)
 19869     CALL 'kxdfhei1' USING DFHEIV0,
 19870           CRTT-ID,
 19871           CERTIFICATE-TRAILERS,
 19872           DFHEIV11,
 19873           WS-ELCRTT-KEY,
 19874           DFHEIV99,
 19875           DFHEIV99,
 19876           DFHEIV99
 19877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19878
 19879
 19880     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19881         MOVE PB-I-VIN TO CS-VIN-NUMBER
 19882
 19883* EXEC CICS REWRITE
 19884*           DATASET  (CRTT-ID)
 19885*           FROM     (CERTIFICATE-TRAILERS)
 19886*        END-EXEC
 19887     MOVE LENGTH OF
 19888      CERTIFICATE-TRAILERS
 19889       TO DFHEIV11
 19890*    MOVE '&& L                  %   #00019121' TO DFHEIV0
 19891     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19892     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19893     MOVE X'2020233030303139313231' TO DFHEIV0(25:11)
 19894     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 367
* EL050.cbl
 19895           CRTT-ID,
 19896           CERTIFICATE-TRAILERS,
 19897           DFHEIV11,
 19898           DFHEIV99
 19899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19900     ELSE
 19901
 19902* EXEC CICS UNLOCK
 19903*          DATASET  (CRTT-ID)
 19904*       END-EXEC
 19905*    MOVE '&*                    #   #00019126' TO DFHEIV0
 19906     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19907     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19908     MOVE X'2020233030303139313236' TO DFHEIV0(25:11)
 19909     CALL 'kxdfhei1' USING DFHEIV0,
 19910           CRTT-ID,
 19911           DFHEIV99
 19912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19913     END-IF.
 19914
 19915     GO TO 8180-EXIT.
 19916
 19917 8180-NOTFND.
 19918
 19919     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19920     MOVE 'CS'         TO CS-RECORD-ID.
 19921     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19922     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19923     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19924     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19925
 19926* EXEC CICS WRITE
 19927*       DATASET  (CRTT-ID)
 19928*       RIDFLD   (WS-ELCRTT-KEY)
 19929*       FROM     (CERTIFICATE-TRAILERS)
 19930*    END-EXEC.
 19931     MOVE LENGTH OF
 19932      CERTIFICATE-TRAILERS
 19933       TO DFHEIV11
 19934*    MOVE '&$ L                  ''   #00019141' TO DFHEIV0
 19935     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19936     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19937     MOVE X'2020233030303139313431' TO DFHEIV0(25:11)
 19938     CALL 'kxdfhei1' USING DFHEIV0,
 19939           CRTT-ID,
 19940           CERTIFICATE-TRAILERS,
 19941           DFHEIV11,
 19942           WS-ELCRTT-KEY,
 19943           DFHEIV99,
 19944           DFHEIV99
 19945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19946
 19947
 19948 8180-EXIT.
 19949     EXIT.
 19950
 19951 8190-UPDATE-REFUND-CLAIM-FLAG.
 19952
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 368
* EL050.cbl
 19953* EXEC CICS HANDLE CONDITION
 19954*        NOTFND   (8190-NOTFND)
 19955*    END-EXEC.
 19956*    MOVE '"$I                   ! 1 #00019151' TO DFHEIV0
 19957     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19958     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19959     MOVE X'3120233030303139313531' TO DFHEIV0(25:11)
 19960     CALL 'kxdfhei1' USING DFHEIV0
 19961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19962
 19963
 19964     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19965     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19966
 19967
 19968* EXEC CICS READ
 19969*        UPDATE
 19970*        DATASET  (CRTT-ID)
 19971*        RIDFLD   (WS-ELCRTT-KEY)
 19972*        INTO     (CERTIFICATE-TRAILERS)
 19973*    END-EXEC.
 19974     MOVE LENGTH OF
 19975      CERTIFICATE-TRAILERS
 19976       TO DFHEIV11
 19977*    MOVE '&"IL       EU         (   #00019158' TO DFHEIV0
 19978     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19979     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19980     MOVE X'2020233030303139313538' TO DFHEIV0(25:11)
 19981     CALL 'kxdfhei1' USING DFHEIV0,
 19982           CRTT-ID,
 19983           CERTIFICATE-TRAILERS,
 19984           DFHEIV11,
 19985           WS-ELCRTT-KEY,
 19986           DFHEIV99,
 19987           DFHEIV99,
 19988           DFHEIV99
 19989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19990
 19991
 19992     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19993
 19994* EXEC CICS REWRITE
 19995*       DATASET  (CRTT-ID)
 19996*       FROM     (CERTIFICATE-TRAILERS)
 19997*    END-EXEC.
 19998     MOVE LENGTH OF
 19999      CERTIFICATE-TRAILERS
 20000       TO DFHEIV11
 20001*    MOVE '&& L                  %   #00019166' TO DFHEIV0
 20002     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20003     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20004     MOVE X'2020233030303139313636' TO DFHEIV0(25:11)
 20005     CALL 'kxdfhei1' USING DFHEIV0,
 20006           CRTT-ID,
 20007           CERTIFICATE-TRAILERS,
 20008           DFHEIV11,
 20009           DFHEIV99
 20010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 369
* EL050.cbl
 20011
 20012
 20013     GO TO 8190-EXIT.
 20014
 20015 8190-NOTFND.
 20016
 20017     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20018     MOVE 'CS'         TO CS-RECORD-ID.
 20019     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20020     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20021     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20022     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20023
 20024* EXEC CICS WRITE
 20025*       DATASET  (CRTT-ID)
 20026*       RIDFLD   (WS-ELCRTT-KEY)
 20027*       FROM     (CERTIFICATE-TRAILERS)
 20028*    END-EXEC.
 20029     MOVE LENGTH OF
 20030      CERTIFICATE-TRAILERS
 20031       TO DFHEIV11
 20032*    MOVE '&$ L                  ''   #00019181' TO DFHEIV0
 20033     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20034     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20035     MOVE X'2020233030303139313831' TO DFHEIV0(25:11)
 20036     CALL 'kxdfhei1' USING DFHEIV0,
 20037           CRTT-ID,
 20038           CERTIFICATE-TRAILERS,
 20039           DFHEIV11,
 20040           WS-ELCRTT-KEY,
 20041           DFHEIV99,
 20042           DFHEIV99
 20043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20044
 20045
 20046 8190-EXIT.
 20047     EXIT.
 20048
 20049 8195-UPDATE-AGE-FLAGS.
 20050
 20051* EXEC CICS HANDLE CONDITION
 20052*        NOTFND   (8195-NOTFND)
 20053*    END-EXEC.
 20054*    MOVE '"$I                   ! 2 #00019191' TO DFHEIV0
 20055     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20056     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20057     MOVE X'3220233030303139313931' TO DFHEIV0(25:11)
 20058     CALL 'kxdfhei1' USING DFHEIV0
 20059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20060
 20061
 20062     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20063     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20064
 20065
 20066* EXEC CICS READ
 20067*        UPDATE
 20068*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 370
* EL050.cbl
 20069*        RIDFLD   (WS-ELCRTT-KEY)
 20070*        INTO     (CERTIFICATE-TRAILERS)
 20071*    END-EXEC.
 20072     MOVE LENGTH OF
 20073      CERTIFICATE-TRAILERS
 20074       TO DFHEIV11
 20075*    MOVE '&"IL       EU         (   #00019198' TO DFHEIV0
 20076     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20077     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20078     MOVE X'2020233030303139313938' TO DFHEIV0(25:11)
 20079     CALL 'kxdfhei1' USING DFHEIV0,
 20080           CRTT-ID,
 20081           CERTIFICATE-TRAILERS,
 20082           DFHEIV11,
 20083           WS-ELCRTT-KEY,
 20084           DFHEIV99,
 20085           DFHEIV99,
 20086           DFHEIV99
 20087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20088
 20089
 20090     IF WS-INS-AGE-SET = 'Y'
 20091        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20092     END-IF
 20093     IF WS-JNT-AGE-SET = 'Y'
 20094        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20095     END-IF
 20096
 20097
 20098* EXEC CICS REWRITE
 20099*       DATASET  (CRTT-ID)
 20100*       FROM     (CERTIFICATE-TRAILERS)
 20101*    END-EXEC.
 20102     MOVE LENGTH OF
 20103      CERTIFICATE-TRAILERS
 20104       TO DFHEIV11
 20105*    MOVE '&& L                  %   #00019212' TO DFHEIV0
 20106     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20107     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20108     MOVE X'2020233030303139323132' TO DFHEIV0(25:11)
 20109     CALL 'kxdfhei1' USING DFHEIV0,
 20110           CRTT-ID,
 20111           CERTIFICATE-TRAILERS,
 20112           DFHEIV11,
 20113           DFHEIV99
 20114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20115
 20116
 20117     GO TO 8195-EXIT.
 20118
 20119 8195-NOTFND.
 20120
 20121     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20122     MOVE 'CS'         TO CS-RECORD-ID.
 20123     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20124     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20125     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20126     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 371
* EL050.cbl
 20127     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20128
 20129* EXEC CICS WRITE
 20130*       DATASET  (CRTT-ID)
 20131*       RIDFLD   (WS-ELCRTT-KEY)
 20132*       FROM     (CERTIFICATE-TRAILERS)
 20133*    END-EXEC.
 20134     MOVE LENGTH OF
 20135      CERTIFICATE-TRAILERS
 20136       TO DFHEIV11
 20137*    MOVE '&$ L                  ''   #00019228' TO DFHEIV0
 20138     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20139     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20140     MOVE X'2020233030303139323238' TO DFHEIV0(25:11)
 20141     CALL 'kxdfhei1' USING DFHEIV0,
 20142           CRTT-ID,
 20143           CERTIFICATE-TRAILERS,
 20144           DFHEIV11,
 20145           WS-ELCRTT-KEY,
 20146           DFHEIV99,
 20147           DFHEIV99
 20148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20149
 20150
 20151 8195-EXIT.
 20152     EXIT.
 20153
 20154 8200-READ-REIN-TABLE.
 20155
 20156* EXEC CICS HANDLE CONDITION
 20157*         NOTFND   (8200-NOTFND)
 20158*    END-EXEC.
 20159*    MOVE '"$I                   ! 3 #00019238' TO DFHEIV0
 20160     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20162     MOVE X'3320233030303139323338' TO DFHEIV0(25:11)
 20163     CALL 'kxdfhei1' USING DFHEIV0
 20164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20165
 20166
 20167
 20168* EXEC CICS READ
 20169*        DATASET     (REIN-ID)
 20170*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20171*        RIDFLD      (ERREIN-KEY)
 20172*    END-EXEC.
 20173*    MOVE '&"S        E          (   #00019242' TO DFHEIV0
 20174     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20175     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20176     MOVE X'2020233030303139323432' TO DFHEIV0(25:11)
 20177     CALL 'kxdfhei1' USING DFHEIV0,
 20178           REIN-ID,
 20179           DFHEIV20,
 20180           DFHEIV99,
 20181           ERREIN-KEY,
 20182           DFHEIV99,
 20183           DFHEIV99,
 20184           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 372
* EL050.cbl
 20185     SET ADDRESS OF REINSURANCE-RECORD TO
 20186         DFHEIV20
 20187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20188
 20189
 20190     GO TO 8200-EXIT.
 20191
 20192 8200-NOTFND.
 20193     MOVE 'N'             TO WS-REIN-READ-SW.
 20194
 20195 8200-EXIT.
 20196      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 373
* EL050.cbl
 20198
 20199 8300-READ-CTBL-TABLE.
 20200
 20201* EXEC CICS HANDLE CONDITION
 20202*        NOTFND    (8300-NOTFND)
 20203*        DISABLED  (8300-ERRESS-PROBLEM)
 20204*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20205*        ENDFILE   (8300-NOTFND)
 20206*    END-EXEC.
 20207*    MOVE '"$IcJ''                ! 4 #00019258' TO DFHEIV0
 20208     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20209     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20210     MOVE X'3420233030303139323538' TO DFHEIV0(25:11)
 20211     CALL 'kxdfhei1' USING DFHEIV0
 20212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20213
 20214
 20215
 20216* EXEC CICS READ
 20217*        DATASET     (CTBL-ID)
 20218*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20219*        RIDFLD      (ERCTBL-KEY)
 20220*    END-EXEC.
 20221*    MOVE '&"S        E          (   #00019265' TO DFHEIV0
 20222     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20223     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20224     MOVE X'2020233030303139323635' TO DFHEIV0(25:11)
 20225     CALL 'kxdfhei1' USING DFHEIV0,
 20226           CTBL-ID,
 20227           DFHEIV20,
 20228           DFHEIV99,
 20229           ERCTBL-KEY,
 20230           DFHEIV99,
 20231           DFHEIV99,
 20232           DFHEIV99
 20233     SET ADDRESS OF COMM-TABLE-RECORD TO
 20234         DFHEIV20
 20235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20236
 20237
 20238     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20239
 20240     GO TO 8300-EXIT.
 20241
 20242 8300-NOTFND.
 20243
 20244     IF CTBL-SW = '0530'
 20245         MOVE 'AA'                     TO WS-AH-COMP-CD
 20246         MOVE '0550'                   TO CTBL-SW
 20247         MOVE '1'                      TO WS-CTBL-READ-SW
 20248         GO TO 8300-EXIT.
 20249
 20250     IF CTBL-SW = '0540'
 20251         MOVE 'AA'                     TO WS-LF-COMP-CD
 20252         MOVE '0550'                   TO CTBL-SW
 20253         MOVE '1'                      TO WS-CTBL-READ-SW
 20254         GO TO 8300-EXIT.
 20255
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 374
* EL050.cbl
 20256     IF CTBL-SW = '0550'
 20257         MOVE '2'                      TO WS-CTBL-READ-SW
 20258         GO TO 8300-EXIT.
 20259
 20260     GO TO 8300-EXIT.
 20261
 20262 8300-ERRESS-PROBLEM.
 20263
 20264      MOVE ER-8050              TO WS-ERROR.
 20265      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20266
 20267     GO TO 8300-EXIT.
 20268
 20269 8300-EXIT.
 20270      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 375
* EL050.cbl
 20272
 20273
 20274 8400-GETMAIN-ERFORM.
 20275
 20276
 20277* EXEC CICS   GETMAIN
 20278*        LENGTH  (500)
 20279*        SET     (ADDRESS OF FORM-MASTER)
 20280*    END-EXEC.
 20281     MOVE 500
 20282       TO DFHEIV11
 20283*    MOVE '," L                  $   #00019309' TO DFHEIV0
 20284     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20285     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20286     MOVE X'2020233030303139333039' TO DFHEIV0(25:11)
 20287     CALL 'kxdfhei1' USING DFHEIV0,
 20288           DFHEIV20,
 20289           DFHEIV11,
 20290           DFHEIV99
 20291     SET ADDRESS OF FORM-MASTER TO
 20292         DFHEIV20
 20293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20294
 20295
 20296     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20297
 20298 8400-EXIT.
 20299      EXIT.
 20300
 20301 8450-READ-FORM-MASTER.
 20302
 20303
 20304* EXEC CICS  HANDLE CONDITION
 20305*        NOTFND   (8450-FORM-NOT-FOUND)
 20306*        ENDFILE  (8450-FORM-NOT-FOUND)
 20307*    END-EXEC.
 20308*    MOVE '"$I''                  ! 5 #00019321' TO DFHEIV0
 20309     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20310     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20311     MOVE X'3520233030303139333231' TO DFHEIV0(25:11)
 20312     CALL 'kxdfhei1' USING DFHEIV0
 20313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20314
 20315
 20316
 20317* EXEC CICS   READ
 20318*        DATASET   (FORM-ID)
 20319*        RIDFLD    (ERFORM-KEY)
 20320*        INTO      (FORM-MASTER)
 20321*        GTEQ
 20322*    END-EXEC.
 20323     MOVE LENGTH OF
 20324      FORM-MASTER
 20325       TO DFHEIV11
 20326*    MOVE '&"IL       G          (   #00019326' TO DFHEIV0
 20327     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20329     MOVE X'2020233030303139333236' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 376
* EL050.cbl
 20330     CALL 'kxdfhei1' USING DFHEIV0,
 20331           FORM-ID,
 20332           FORM-MASTER,
 20333           DFHEIV11,
 20334           ERFORM-KEY,
 20335           DFHEIV99,
 20336           DFHEIV99,
 20337           DFHEIV99
 20338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20339
 20340
 20341     MOVE  'Y'           TO  FORM-MASTER-SW.
 20342
 20343     GO TO  8450-EXIT.
 20344
 20345 8450-FORM-NOT-FOUND.
 20346
 20347     MOVE  'N'           TO  FORM-MASTER-SW.
 20348
 20349 8450-EXIT.
 20350      EXIT.
 20351
 20352 8500-DATE-CONVERT.
 20353
 20354* EXEC CICS LINK
 20355*        PROGRAM    ('ELDATCV')
 20356*        COMMAREA   (DATE-CONVERSION-DATA)
 20357*        LENGTH     (DC-COMM-LENGTH)
 20358*    END-EXEC.
 20359     MOVE 'ELDATCV' TO DFHEIV1
 20360*    MOVE '."C                   (   #00019345' TO DFHEIV0
 20361     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20362     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20363     MOVE X'2020233030303139333435' TO DFHEIV0(25:11)
 20364     CALL 'kxdfhei1' USING DFHEIV0,
 20365           DFHEIV1,
 20366           DATE-CONVERSION-DATA,
 20367           DC-COMM-LENGTH,
 20368           DFHEIV99,
 20369           DFHEIV99,
 20370           DFHEIV99,
 20371           DFHEIV99
 20372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20373
 20374
 20375 8500-EXIT.
 20376     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 377
* EL050.cbl
 20378
 20379 8555-RELOAD-CONTROL-FILE.
 20380     CONTINUE.
 20381
 20382 8555-EXIT.
 20383     EXIT.
 20384
 20385 8557-GETMAIN-ERPLAN.
 20386
 20387
 20388* EXEC CICS GETMAIN
 20389*        LENGTH    (840)
 20390*        SET       (ADDRESS OF PLAN-RECORDS)
 20391*    END-EXEC.
 20392     MOVE 840
 20393       TO DFHEIV11
 20394*    MOVE '," L                  $   #00019363' TO DFHEIV0
 20395     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20396     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20397     MOVE X'2020233030303139333633' TO DFHEIV0(25:11)
 20398     CALL 'kxdfhei1' USING DFHEIV0,
 20399           DFHEIV20,
 20400           DFHEIV11,
 20401           DFHEIV99
 20402     SET ADDRESS OF PLAN-RECORDS TO
 20403         DFHEIV20
 20404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20405
 20406
 20407     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20408
 20409 8557-EXIT.
 20410     EXIT.
 20411
 20412 8560-GETMAIN.
 20413
 20414* EXEC CICS GETMAIN
 20415*        LENGTH    (2000)
 20416*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20417*    END-EXEC.
 20418     MOVE 2000
 20419       TO DFHEIV11
 20420*    MOVE '," L                  $   #00019374' TO DFHEIV0
 20421     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20422     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20423     MOVE X'2020233030303139333734' TO DFHEIV0(25:11)
 20424     CALL 'kxdfhei1' USING DFHEIV0,
 20425           DFHEIV20,
 20426           DFHEIV11,
 20427           DFHEIV99
 20428     SET ADDRESS OF ACCOUNT-MASTER TO
 20429         DFHEIV20
 20430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20431
 20432
 20433     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20434
 20435 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 378
* EL050.cbl
 20436     EXIT.
 20437
 20438 8570-START-ACCOUNT-MASTER.
 20439
 20440* EXEC CICS HANDLE CONDITION
 20441*        NOTFND    (0199-ACCT-NOT-FOUND)
 20442*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20443*    END-EXEC.
 20444*    MOVE '"$I''                  ! 6 #00019385' TO DFHEIV0
 20445     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20446     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20447     MOVE X'3620233030303139333835' TO DFHEIV0(25:11)
 20448     CALL 'kxdfhei1' USING DFHEIV0
 20449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20450
 20451
 20452
 20453* EXEC CICS STARTBR
 20454*        DATASET    (ACCT-ID)
 20455*        RIDFLD     (ERACCT-KEY)
 20456*        GTEQ
 20457*    END-EXEC.
 20458     MOVE 0
 20459       TO DFHEIV11
 20460*    MOVE '&,         G          &   #00019390' TO DFHEIV0
 20461     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20462     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20463     MOVE X'2020233030303139333930' TO DFHEIV0(25:11)
 20464     CALL 'kxdfhei1' USING DFHEIV0,
 20465           ACCT-ID,
 20466           ERACCT-KEY,
 20467           DFHEIV99,
 20468           DFHEIV11,
 20469           DFHEIV99
 20470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20471
 20472
 20473 8570-EXIT.
 20474     EXIT.
 20475
 20476 8580-READ-ACCOUNT-MASTER.
 20477
 20478* EXEC CICS HANDLE CONDITION
 20479*        NOTFND    (0199-ACCT-NOT-FOUND)
 20480*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20481*    END-EXEC.
 20482*    MOVE '"$I''                  ! 7 #00019400' TO DFHEIV0
 20483     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20484     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20485     MOVE X'3720233030303139343030' TO DFHEIV0(25:11)
 20486     CALL 'kxdfhei1' USING DFHEIV0
 20487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20488
 20489
 20490
 20491* EXEC CICS READNEXT
 20492*        DATASET     (ACCT-ID)
 20493*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 379
* EL050.cbl
 20494*        RIDFLD      (ERACCT-KEY)
 20495*    END-EXEC.
 20496     MOVE LENGTH OF
 20497      ACCOUNT-MASTER
 20498       TO DFHEIV12
 20499     MOVE 0
 20500       TO DFHEIV11
 20501*    MOVE '&.IL                  )   #00019405' TO DFHEIV0
 20502     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20503     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20504     MOVE X'2020233030303139343035' TO DFHEIV0(25:11)
 20505     CALL 'kxdfhei1' USING DFHEIV0,
 20506           ACCT-ID,
 20507           ACCOUNT-MASTER,
 20508           DFHEIV12,
 20509           ERACCT-KEY,
 20510           DFHEIV99,
 20511           DFHEIV11,
 20512           DFHEIV99,
 20513           DFHEIV99
 20514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20515
 20516
 20517 8580-EXIT.
 20518     EXIT.
 20519
 20520 8582-READ-COMPENSATION-MASTER.
 20521
 20522* EXEC CICS HANDLE CONDITION
 20523*        NOTFND    (8582-COMP-NOT-FOUND)
 20524*        ENDFILE   (8582-COMP-NOT-FOUND)
 20525*    END-EXEC.
 20526*    MOVE '"$I''                  ! 8 #00019415' TO DFHEIV0
 20527     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20528     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20529     MOVE X'3820233030303139343135' TO DFHEIV0(25:11)
 20530     CALL 'kxdfhei1' USING DFHEIV0
 20531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20532
 20533
 20534
 20535* EXEC CICS READ
 20536*        DATASET     (COMP-ID)
 20537*        INTO        (COMPENSATION-MASTER)
 20538*        RIDFLD      (ERCOMP-KEY)
 20539*    END-EXEC.
 20540     MOVE LENGTH OF
 20541      COMPENSATION-MASTER
 20542       TO DFHEIV11
 20543*    MOVE '&"IL       E          (   #00019420' TO DFHEIV0
 20544     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20545     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20546     MOVE X'2020233030303139343230' TO DFHEIV0(25:11)
 20547     CALL 'kxdfhei1' USING DFHEIV0,
 20548           COMP-ID,
 20549           COMPENSATION-MASTER,
 20550           DFHEIV11,
 20551           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 380
* EL050.cbl
 20552           DFHEIV99,
 20553           DFHEIV99,
 20554           DFHEIV99
 20555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20556
 20557
 20558     MOVE 'Y'                    TO COMP-MASTER-SW
 20559
 20560     GO TO 8582-EXIT
 20561     .
 20562 8582-COMP-NOT-FOUND.
 20563
 20564     MOVE 'N'                    TO COMP-MASTER-SW.
 20565
 20566 8582-EXIT.
 20567     EXIT.
 20568
 20569 8583-READ-ERAGTC.
 20570
 20571* EXEC CICS HANDLE CONDITION
 20572*        NOTFND    (8583-AGTC-NOT-FOUND)
 20573*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20574*    END-EXEC.
 20575*    MOVE '"$I''                  ! 9 #00019438' TO DFHEIV0
 20576     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20578     MOVE X'3920233030303139343338' TO DFHEIV0(25:11)
 20579     CALL 'kxdfhei1' USING DFHEIV0
 20580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20581
 20582
 20583
 20584* EXEC CICS STARTBR
 20585*        DATASET    (AGTC-ID)
 20586*        RIDFLD     (ERAGTC-KEY)
 20587*        GTEQ
 20588*    END-EXEC.
 20589     MOVE 0
 20590       TO DFHEIV11
 20591*    MOVE '&,         G          &   #00019443' TO DFHEIV0
 20592     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20593     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20594     MOVE X'2020233030303139343433' TO DFHEIV0(25:11)
 20595     CALL 'kxdfhei1' USING DFHEIV0,
 20596           AGTC-ID,
 20597           ERAGTC-KEY,
 20598           DFHEIV99,
 20599           DFHEIV11,
 20600           DFHEIV99
 20601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20602
 20603
 20604 8583-READ-ERAGTC-NEXT.
 20605
 20606* EXEC CICS READNEXT
 20607*        DATASET     (AGTC-ID)
 20608*        INTO        (AGENT-COMMISSIONS)
 20609*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 381
* EL050.cbl
 20610*    END-EXEC.
 20611     MOVE LENGTH OF
 20612      AGENT-COMMISSIONS
 20613       TO DFHEIV12
 20614     MOVE 0
 20615       TO DFHEIV11
 20616*    MOVE '&.IL                  )   #00019450' TO DFHEIV0
 20617     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20618     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20619     MOVE X'2020233030303139343530' TO DFHEIV0(25:11)
 20620     CALL 'kxdfhei1' USING DFHEIV0,
 20621           AGTC-ID,
 20622           AGENT-COMMISSIONS,
 20623           DFHEIV12,
 20624           ERAGTC-KEY,
 20625           DFHEIV99,
 20626           DFHEIV11,
 20627           DFHEIV99,
 20628           DFHEIV99
 20629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20630
 20631
 20632*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20633
 20634     GO TO 8583-EXIT
 20635     .
 20636 8583-AGTC-NOT-FOUND.
 20637
 20638     MOVE 'N'                    TO AGTC-MASTER-SW.
 20639
 20640 8583-EXIT.
 20641     EXIT.
 20642
 20643 8584-READ-BANK-CROSS-REF.
 20644
 20645* EXEC CICS HANDLE CONDITION
 20646*        NOTFND    (8584-BXRF-NOT-FOUND)
 20647*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20648*    END-EXEC.
 20649*    MOVE '"$I''                  ! : #00019468' TO DFHEIV0
 20650     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20651     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20652     MOVE X'3A20233030303139343638' TO DFHEIV0(25:11)
 20653     CALL 'kxdfhei1' USING DFHEIV0
 20654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20655
 20656
 20657
 20658* EXEC CICS READ
 20659*        DATASET     (BXRF-ID)
 20660*        INTO        (BANK-CROSS-REFERENCE)
 20661*        RIDFLD      (ERBXRF-KEY)
 20662*        LENGTH      (BXRF-REC-LENGTH)
 20663*    END-EXEC.
 20664*    MOVE '&"IL       E          (   #00019473' TO DFHEIV0
 20665     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20666     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20667     MOVE X'2020233030303139343733' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 382
* EL050.cbl
 20668     CALL 'kxdfhei1' USING DFHEIV0,
 20669           BXRF-ID,
 20670           BANK-CROSS-REFERENCE,
 20671           BXRF-REC-LENGTH,
 20672           ERBXRF-KEY,
 20673           DFHEIV99,
 20674           DFHEIV99,
 20675           DFHEIV99
 20676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20677
 20678
 20679     MOVE 'Y'                    TO BXRF-MASTER-SW
 20680
 20681     GO TO 8584-EXIT
 20682     .
 20683 8584-BXRF-NOT-FOUND.
 20684
 20685     MOVE 'N'                    TO BXRF-MASTER-SW.
 20686
 20687 8584-EXIT.
 20688     EXIT.
 20689
 20690 8585-READ-PLAN-MASTER.
 20691
 20692
 20693* EXEC CICS HANDLE CONDITION
 20694*        NOTFND    (8585-PLAN-NOT-FOUND)
 20695*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20696*    END-EXEC.
 20697*    MOVE '"$I''                  ! ; #00019493' TO DFHEIV0
 20698     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20700     MOVE X'3B20233030303139343933' TO DFHEIV0(25:11)
 20701     CALL 'kxdfhei1' USING DFHEIV0
 20702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20703
 20704
 20705
 20706* EXEC CICS READ
 20707*        DATASET     (PLAN-ID)
 20708*        INTO        (PLAN-MASTER)
 20709*        RIDFLD      (ERPLAN-KEY)
 20710*    END-EXEC.
 20711     MOVE LENGTH OF
 20712      PLAN-MASTER
 20713       TO DFHEIV11
 20714*    MOVE '&"IL       E          (   #00019498' TO DFHEIV0
 20715     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20716     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20717     MOVE X'2020233030303139343938' TO DFHEIV0(25:11)
 20718     CALL 'kxdfhei1' USING DFHEIV0,
 20719           PLAN-ID,
 20720           PLAN-MASTER,
 20721           DFHEIV11,
 20722           ERPLAN-KEY,
 20723           DFHEIV99,
 20724           DFHEIV99,
 20725           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 383
* EL050.cbl
 20726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20727
 20728
 20729     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20730
 20731     GO TO 8585-EXIT.
 20732
 20733 8585-PLAN-NOT-FOUND.
 20734
 20735     MOVE 'N'                    TO PLAN-MASTER-SW.
 20736
 20737 8585-EXIT.
 20738     EXIT.
 20739
 20740 8586-READ-LOAN-OFFICER.
 20741
 20742* EXEC CICS READ
 20743*        DATASET     (LOFC-ID)
 20744*        INTO        (LOAN-OFFICER-MASTER)
 20745*        RIDFLD      (ERLOFC-KEY)
 20746*        RESP        (WS-RESPONSE)
 20747*    END-EXEC
 20748     MOVE LENGTH OF
 20749      LOAN-OFFICER-MASTER
 20750       TO DFHEIV11
 20751*    MOVE '&"IL       E          (  N#00019516' TO DFHEIV0
 20752     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20753     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20754     MOVE X'204E233030303139353136' TO DFHEIV0(25:11)
 20755     CALL 'kxdfhei1' USING DFHEIV0,
 20756           LOFC-ID,
 20757           LOAN-OFFICER-MASTER,
 20758           DFHEIV11,
 20759           ERLOFC-KEY,
 20760           DFHEIV99,
 20761           DFHEIV99,
 20762           DFHEIV99
 20763     MOVE EIBRESP  TO WS-RESPONSE
 20764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20765
 20766     IF WS-RESP-NORMAL
 20767        MOVE 'Y'                 TO LOFC-MASTER-SW
 20768     ELSE
 20769        MOVE 'N'                 TO LOFC-MASTER-SW
 20770     END-IF
 20771     .
 20772 8586-EXIT.
 20773     EXIT.
 20774 8587-START-ERPDEF.
 20775
 20776* EXEC CICS STARTBR
 20777*       DATASET   (PDEF-ID)
 20778*       RIDFLD    (ERPDEF-KEY)
 20779*       GTEQ
 20780*       RESP      (WS-RESPONSE)
 20781*    END-EXEC
 20782     MOVE 0
 20783       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 384
* EL050.cbl
 20784*    MOVE '&,         G          &  N#00019532' TO DFHEIV0
 20785     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20786     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20787     MOVE X'204E233030303139353332' TO DFHEIV0(25:11)
 20788     CALL 'kxdfhei1' USING DFHEIV0,
 20789           PDEF-ID,
 20790           ERPDEF-KEY,
 20791           DFHEIV99,
 20792           DFHEIV11,
 20793           DFHEIV99
 20794     MOVE EIBRESP  TO WS-RESPONSE
 20795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20796     IF WS-RESP-NORMAL
 20797        MOVE 'Y'                 TO PDEF-MASTER-SW
 20798     ELSE
 20799        MOVE 'N'                 TO PDEF-MASTER-SW
 20800     END-IF
 20801     .
 20802 8587-EXIT.
 20803     EXIT.
 20804 8588-READ-ERPDEF.
 20805
 20806* EXEC CICS READNEXT
 20807*       DATASET   (PDEF-ID)
 20808*       RIDFLD    (ERPDEF-KEY)
 20809*       INTO      (PRODUCT-MASTER)
 20810*       RESP      (WS-RESPONSE)
 20811*    END-EXEC
 20812     MOVE LENGTH OF
 20813      PRODUCT-MASTER
 20814       TO DFHEIV12
 20815     MOVE 0
 20816       TO DFHEIV11
 20817*    MOVE '&.IL                  )  N#00019547' TO DFHEIV0
 20818     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20819     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20820     MOVE X'204E233030303139353437' TO DFHEIV0(25:11)
 20821     CALL 'kxdfhei1' USING DFHEIV0,
 20822           PDEF-ID,
 20823           PRODUCT-MASTER,
 20824           DFHEIV12,
 20825           ERPDEF-KEY,
 20826           DFHEIV99,
 20827           DFHEIV11,
 20828           DFHEIV99,
 20829           DFHEIV99
 20830     MOVE EIBRESP  TO WS-RESPONSE
 20831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20832     IF WS-RESP-NORMAL
 20833        MOVE 'Y'                 TO PDEF-MASTER-SW
 20834     ELSE
 20835        MOVE 'N'                 TO PDEF-MASTER-SW
 20836     END-IF
 20837     .
 20838 8588-EXIT.
 20839     EXIT.
 20840 8589-ENDBR-ERPDEF.
 20841
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 385
* EL050.cbl
 20842* EXEC CICS ENDBR
 20843*       DATASET   (PDEF-ID)
 20844*    END-EXEC
 20845     MOVE 0
 20846       TO DFHEIV11
 20847*    MOVE '&2                    $   #00019562' TO DFHEIV0
 20848     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20849     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20850     MOVE X'2020233030303139353632' TO DFHEIV0(25:11)
 20851     CALL 'kxdfhei1' USING DFHEIV0,
 20852           PDEF-ID,
 20853           DFHEIV11,
 20854           DFHEIV99
 20855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20856     .
 20857 8589-EXIT.
 20858     EXIT.
 20859 8590-READ-CERT-MASTER.
 20860     IF PB-COMPANY-ID = 'UCL'
 20861         GO TO 8690-READ-CERT-MASTER-UCL.
 20862
 20863
 20864* EXEC CICS HANDLE CONDITION
 20865*         NOTFND    (0299-CERT-NOT-FOUND)
 20866*    END-EXEC.
 20867*    MOVE '"$I                   ! < #00019572' TO DFHEIV0
 20868     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20869     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20870     MOVE X'3C20233030303139353732' TO DFHEIV0(25:11)
 20871     CALL 'kxdfhei1' USING DFHEIV0
 20872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20873
 20874
 20875
 20876* EXEC CICS READ
 20877*        DATASET     (CERT-ID)
 20878*        INTO        (CERTIFICATE-MASTER)
 20879*        RIDFLD      (ELCERT-KEY)
 20880*        UPDATE
 20881*    END-EXEC.
 20882     MOVE LENGTH OF
 20883      CERTIFICATE-MASTER
 20884       TO DFHEIV11
 20885*    MOVE '&"IL       EU         (   #00019576' TO DFHEIV0
 20886     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20887     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20888     MOVE X'2020233030303139353736' TO DFHEIV0(25:11)
 20889     CALL 'kxdfhei1' USING DFHEIV0,
 20890           CERT-ID,
 20891           CERTIFICATE-MASTER,
 20892           DFHEIV11,
 20893           ELCERT-KEY,
 20894           DFHEIV99,
 20895           DFHEIV99,
 20896           DFHEIV99
 20897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20898
 20899
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 386
* EL050.cbl
 20900 8590-EXIT.
 20901     EXIT.
 20902
 20903 8690-READ-CERT-MASTER-UCL.
 20904
 20905* EXEC CICS HANDLE CONDITION
 20906*         NOTFND    (8700-READ-CERT-MASTER)
 20907*    END-EXEC.
 20908*    MOVE '"$I                   ! = #00019587' TO DFHEIV0
 20909     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20910     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20911     MOVE X'3D20233030303139353837' TO DFHEIV0(25:11)
 20912     CALL 'kxdfhei1' USING DFHEIV0
 20913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20914
 20915
 20916 8690-READ-CERT-CONT.
 20917
 20918* EXEC CICS READ
 20919*        DATASET     (CERT-ID)
 20920*        INTO        (CERTIFICATE-MASTER)
 20921*        RIDFLD      (ELCERT-KEY)
 20922*        UPDATE
 20923*    END-EXEC.
 20924     MOVE LENGTH OF
 20925      CERTIFICATE-MASTER
 20926       TO DFHEIV11
 20927*    MOVE '&"IL       EU         (   #00019592' TO DFHEIV0
 20928     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20929     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20930     MOVE X'2020233030303139353932' TO DFHEIV0(25:11)
 20931     CALL 'kxdfhei1' USING DFHEIV0,
 20932           CERT-ID,
 20933           CERTIFICATE-MASTER,
 20934           DFHEIV11,
 20935           ELCERT-KEY,
 20936           DFHEIV99,
 20937           DFHEIV99,
 20938           DFHEIV99
 20939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20940
 20941
 20942     GO TO 8590-EXIT.
 20943
 20944 8700-READ-CERT-MASTER.
 20945     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20946     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20947
 20948* EXEC CICS HANDLE CONDITION
 20949*         DUPKEY    (8720-COMP-ACCOUNTS)
 20950*         ENDFILE   (8730-END-BROWSE)
 20951*         NOTFND    (8740-NOT-FOUND)
 20952*    END-EXEC.
 20953*    MOVE '"$$''I                 ! > #00019604' TO DFHEIV0
 20954     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20955     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20956     MOVE X'3E20233030303139363034' TO DFHEIV0(25:11)
 20957     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 387
* EL050.cbl
 20958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20959
 20960
 20961
 20962* EXEC CICS STARTBR
 20963*        DATASET     ('ELCERT5')
 20964*        RIDFLD      (ELCERT2-KEY)
 20965*        EQUAL
 20966*    END-EXEC.
 20967     MOVE 'ELCERT5' TO DFHEIV1
 20968     MOVE 0
 20969       TO DFHEIV11
 20970*    MOVE '&,         E          &   #00019610' TO DFHEIV0
 20971     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20972     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20973     MOVE X'2020233030303139363130' TO DFHEIV0(25:11)
 20974     CALL 'kxdfhei1' USING DFHEIV0,
 20975           DFHEIV1,
 20976           ELCERT2-KEY,
 20977           DFHEIV99,
 20978           DFHEIV11,
 20979           DFHEIV99
 20980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20981
 20982
 20983 8710-READ-NEXT.
 20984
 20985* EXEC CICS READNEXT
 20986*        DATASET     ('ELCERT5')
 20987*        INTO        (CERTIFICATE-MASTER)
 20988*        RIDFLD      (ELCERT2-KEY)
 20989*    END-EXEC.
 20990     MOVE LENGTH OF
 20991      CERTIFICATE-MASTER
 20992       TO DFHEIV12
 20993     MOVE 'ELCERT5' TO DFHEIV1
 20994     MOVE 0
 20995       TO DFHEIV11
 20996*    MOVE '&.IL                  )   #00019617' TO DFHEIV0
 20997     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20998     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20999     MOVE X'2020233030303139363137' TO DFHEIV0(25:11)
 21000     CALL 'kxdfhei1' USING DFHEIV0,
 21001           DFHEIV1,
 21002           CERTIFICATE-MASTER,
 21003           DFHEIV12,
 21004           ELCERT2-KEY,
 21005           DFHEIV99,
 21006           DFHEIV11,
 21007           DFHEIV99,
 21008           DFHEIV99
 21009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21010
 21011
 21012 8720-COMP-ACCOUNTS.
 21013
 21014* EXEC CICS ENTER
 21015*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 388
* EL050.cbl
 21016*         FROM (PB-C-LAST-NAME)
 21017*    END-EXEC.
 21018     MOVE 001
 21019       TO DFHEIV11
 21020*    MOVE ':$F                   %   #00019624' TO DFHEIV0
 21021     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21022     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21023     MOVE X'2020233030303139363234' TO DFHEIV0(25:11)
 21024     CALL 'kxdfhei1' USING DFHEIV0,
 21025           DFHEIV11,
 21026           PB-C-LAST-NAME,
 21027           DFHEIV99,
 21028           DFHEIV99
 21029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21030
 21031
 21032
 21033* EXEC CICS ENTER
 21034*         TRACEID (002)
 21035*         FROM (CM-INSURED-LAST-NAME)
 21036*    END-EXEC.
 21037     MOVE 002
 21038       TO DFHEIV11
 21039*    MOVE ':$F                   %   #00019629' TO DFHEIV0
 21040     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21041     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21042     MOVE X'2020233030303139363239' TO DFHEIV0(25:11)
 21043     CALL 'kxdfhei1' USING DFHEIV0,
 21044           DFHEIV11,
 21045           CM-INSURED-LAST-NAME,
 21046           DFHEIV99,
 21047           DFHEIV99
 21048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21049
 21050
 21051     IF PB-CERT-NO NOT = CM-CERT-NO
 21052         GO TO 8730-END-BROWSE.
 21053
 21054     IF PB-ACCOUNT = CM-ACCOUNT
 21055         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21056             MOVE ER-2799        TO WS-ERROR
 21057             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21058             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21059             GO TO 8730-END-BROWSE.
 21060
 21061     GO TO 8710-READ-NEXT.
 21062
 21063 8730-END-BROWSE.
 21064
 21065* EXEC CICS ENDBR
 21066*         DATASET    ('ELCERT5')
 21067*    END-EXEC.
 21068     MOVE 'ELCERT5' TO DFHEIV1
 21069     MOVE 0
 21070       TO DFHEIV11
 21071*    MOVE '&2                    $   #00019647' TO DFHEIV0
 21072     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21073     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 389
* EL050.cbl
 21074     MOVE X'2020233030303139363437' TO DFHEIV0(25:11)
 21075     CALL 'kxdfhei1' USING DFHEIV0,
 21076           DFHEIV1,
 21077           DFHEIV11,
 21078           DFHEIV99
 21079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21080
 21081
 21082 8740-NOT-FOUND.
 21083     GO TO 0299-CERT-NOT-FOUND.
 21084
 21085 8750-START-ELSTAT.
 21086
 21087* EXEC CICS STARTBR
 21088*       DATASET   (STAT-ID)
 21089*       RIDFLD    (ELSTAT-KEY)
 21090*       GTEQ
 21091*       RESP      (WS-RESPONSE)
 21092*    END-EXEC
 21093     MOVE 0
 21094       TO DFHEIV11
 21095*    MOVE '&,         G          &  N#00019655' TO DFHEIV0
 21096     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21097     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21098     MOVE X'204E233030303139363535' TO DFHEIV0(25:11)
 21099     CALL 'kxdfhei1' USING DFHEIV0,
 21100           STAT-ID,
 21101           ELSTAT-KEY,
 21102           DFHEIV99,
 21103           DFHEIV11,
 21104           DFHEIV99
 21105     MOVE EIBRESP  TO WS-RESPONSE
 21106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21107     IF WS-RESP-NORMAL
 21108        MOVE 'Y'                 TO STAT-MASTER-SW
 21109     ELSE
 21110        MOVE 'N'                 TO STAT-MASTER-SW
 21111     END-IF
 21112     .
 21113 8750-EXIT.
 21114     EXIT.
 21115 8752-READ-ELSTAT.
 21116
 21117* EXEC CICS READNEXT
 21118*       DATASET   (STAT-ID)
 21119*       RIDFLD    (ELSTAT-KEY)
 21120*       INTO      (STATE-FILE)
 21121*       RESP      (WS-RESPONSE)
 21122*    END-EXEC
 21123     MOVE LENGTH OF
 21124      STATE-FILE
 21125       TO DFHEIV12
 21126     MOVE 0
 21127       TO DFHEIV11
 21128*    MOVE '&.IL                  )  N#00019670' TO DFHEIV0
 21129     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21130     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21131     MOVE X'204E233030303139363730' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 390
* EL050.cbl
 21132     CALL 'kxdfhei1' USING DFHEIV0,
 21133           STAT-ID,
 21134           STATE-FILE,
 21135           DFHEIV12,
 21136           ELSTAT-KEY,
 21137           DFHEIV99,
 21138           DFHEIV11,
 21139           DFHEIV99,
 21140           DFHEIV99
 21141     MOVE EIBRESP  TO WS-RESPONSE
 21142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21143     IF WS-RESP-NORMAL
 21144        MOVE 'Y'                 TO STAT-MASTER-SW
 21145     ELSE
 21146        MOVE 'N'                 TO STAT-MASTER-SW
 21147     END-IF
 21148     .
 21149 8752-EXIT.
 21150     EXIT.
 21151 8800-GET-COMP-RATE.
 21152     MOVE +1 TO IB.
 21153     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21154         ADD +9 TO IB
 21155         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21156             ADD +9 TO IB
 21157             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21158                MOVE ZEROS       TO WS-WK-RATE
 21159                GO TO 8800-EXIT.
 21160
 21161     IF PB-I-AGE GREATER CT-AGE (1)
 21162         ADD +3 TO IB
 21163         IF PB-I-AGE GREATER CT-AGE (2)
 21164             ADD +3 TO IB
 21165             IF PB-I-AGE GREATER CT-AGE (3)
 21166                MOVE ZEROS       TO WS-WK-RATE
 21167                GO TO 8800-EXIT.
 21168
 21169     IF WS-WORK-TERM GREATER CT-TRM (1)
 21170         ADD +1 TO IB
 21171         IF WS-WORK-TERM GREATER CT-TRM (2)
 21172             ADD +1 TO IB
 21173             IF WS-WORK-TERM GREATER CT-TRM (3)
 21174                MOVE ZEROS       TO WS-WK-RATE
 21175                GO TO 8800-EXIT.
 21176
 21177     IF CT-RT (IB) NOT NUMERIC
 21178         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21179         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21180         GO TO 8800-GET-COMP-RATE.
 21181
 21182     MOVE CT-RT (IB) TO WS-WK-RATE.
 21183
 21184 8800-EXIT.
 21185     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 391
* EL050.cbl
 21187 8900-ADDRESS-FILE.
 21188     IF ERACCT-FILE-ADDRESSED
 21189         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21190         GO TO 8900-ADDRESS-EXIT.
 21191
 21192     IF ELCNTL-FILE-ADDRESSED
 21193         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21194         GO TO 8900-ADDRESS-EXIT.
 21195
 21196     IF ERPLAN-FILE-ADDRESSED
 21197         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21198         GO TO 8900-ADDRESS-EXIT.
 21199
 21200     IF ERFORM-FILE-ADDRESSED
 21201         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21202         GO TO 8900-ADDRESS-EXIT.
 21203
 21204 8900-ADDRESS-EXIT.
 21205     EXIT.
 21206
 21207 9000-READ-CONTROL.
 21208
 21209* EXEC CICS HANDLE CONDITION
 21210*        NOTFND    (9000-NOTFND)
 21211*    END-EXEC.
 21212*    MOVE '"$I                   ! ? #00019741' TO DFHEIV0
 21213     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21214     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21215     MOVE X'3F20233030303139373431' TO DFHEIV0(25:11)
 21216     CALL 'kxdfhei1' USING DFHEIV0
 21217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21218
 21219
 21220
 21221* EXEC CICS READ
 21222*        DATASET     (CNTL-ID)
 21223*        SET         (ADDRESS OF CONTROL-FILE)
 21224*        RIDFLD      (ELCNTL-KEY)
 21225*        GTEQ
 21226*    END-EXEC.
 21227*    MOVE '&"S        G          (   #00019745' TO DFHEIV0
 21228     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21229     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21230     MOVE X'2020233030303139373435' TO DFHEIV0(25:11)
 21231     CALL 'kxdfhei1' USING DFHEIV0,
 21232           CNTL-ID,
 21233           DFHEIV20,
 21234           DFHEIV99,
 21235           ELCNTL-KEY,
 21236           DFHEIV99,
 21237           DFHEIV99,
 21238           DFHEIV99
 21239     SET ADDRESS OF CONTROL-FILE TO
 21240         DFHEIV20
 21241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21242
 21243
 21244     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 392
* EL050.cbl
 21245
 21246 9000-NOTFND.
 21247     IF RC-SW-1 = '1'
 21248        MOVE ER-2616              TO WS-ERROR
 21249        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21250        GO TO 9000-EXIT.
 21251
 21252     IF RC-SW-1 = '2'
 21253        MOVE ER-2602              TO WS-ERROR
 21254        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21255
 21256 9000-EXIT.
 21257      EXIT.
 21258
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 393
* EL050.cbl
 21260 9100-READ-CONTROL.
 21261
 21262* EXEC CICS HANDLE CONDITION
 21263*        NOTFND  (9100-NOTFND)
 21264*        ENDFILE (9100-NOTFND)
 21265*    END-EXEC.
 21266*    MOVE '"$I''                  ! @ #00019769' TO DFHEIV0
 21267     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21268     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21269     MOVE X'4020233030303139373639' TO DFHEIV0(25:11)
 21270     CALL 'kxdfhei1' USING DFHEIV0
 21271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21272
 21273
 21274
 21275* EXEC CICS READ
 21276*        DATASET     (CNTL-ID)
 21277*        INTO        (CONTROL-FILE)
 21278*        RIDFLD      (ELCNTL-KEY)
 21279*        GTEQ
 21280*    END-EXEC.
 21281     MOVE LENGTH OF
 21282      CONTROL-FILE
 21283       TO DFHEIV11
 21284*    MOVE '&"IL       G          (   #00019774' TO DFHEIV0
 21285     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21286     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21287     MOVE X'2020233030303139373734' TO DFHEIV0(25:11)
 21288     CALL 'kxdfhei1' USING DFHEIV0,
 21289           CNTL-ID,
 21290           CONTROL-FILE,
 21291           DFHEIV11,
 21292           ELCNTL-KEY,
 21293           DFHEIV99,
 21294           DFHEIV99,
 21295           DFHEIV99
 21296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21297
 21298
 21299     GO TO 9100-EXIT.
 21300
 21301 9100-NOTFND.
 21302     IF RC-SW-2 = '0'
 21303        MOVE '1'                  TO STATE-RECORD-ERROR
 21304        GO TO 9100-EXIT
 21305     END-IF
 21306     IF RC-SW-2 = '1'
 21307        MOVE '1'                  TO LF-BENEFIT-ERROR
 21308        MOVE ER-2604              TO WS-ERROR
 21309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21310        GO TO 9100-EXIT.
 21311
 21312     IF RC-SW-2 = '2'
 21313        MOVE '1'                  TO AH-BENEFIT-ERROR
 21314        MOVE ER-2605              TO WS-ERROR
 21315        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21316        GO TO 9100-EXIT.
 21317
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 394
* EL050.cbl
 21318     IF RC-SW-2 = '3'
 21319         MOVE ER-2603           TO WS-ERROR
 21320         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21321         GO TO 9100-EXIT.
 21322
 21323     IF RC-SW-2 = '4'
 21324         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21325         GO TO 9100-EXIT.
 21326
 21327     IF RC-SW-2 = '5'
 21328         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21329         IF WS-AH-INPUT-CD-1 = SPACE
 21330             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21331         ELSE
 21332             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21333
 21334 9100-EXIT.
 21335      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 395
* EL050.cbl
 21337 9200-CONTROL-GETMAIN.
 21338
 21339* EXEC CICS GETMAIN
 21340*         LENGTH   (750)
 21341*         SET      (ADDRESS OF CONTROL-FILE)
 21342*    END-EXEC.
 21343     MOVE 750
 21344       TO DFHEIV11
 21345*    MOVE '," L                  $   #00019820' TO DFHEIV0
 21346     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21347     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21348     MOVE X'2020233030303139383230' TO DFHEIV0(25:11)
 21349     CALL 'kxdfhei1' USING DFHEIV0,
 21350           DFHEIV20,
 21351           DFHEIV11,
 21352           DFHEIV99
 21353     SET ADDRESS OF CONTROL-FILE TO
 21354         DFHEIV20
 21355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21356
 21357
 21358     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21359
 21360 9200-EXIT.
 21361     EXIT.
 21362
 21363 9250-UNLOCK-RETURN.
 21364
 21365* EXEC CICS UNLOCK
 21366*        DATASET   (CERT-ID)
 21367*    END-EXEC.
 21368*    MOVE '&*                    #   #00019831' TO DFHEIV0
 21369     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21370     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21371     MOVE X'2020233030303139383331' TO DFHEIV0(25:11)
 21372     CALL 'kxdfhei1' USING DFHEIV0,
 21373           CERT-ID,
 21374           DFHEIV99
 21375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21376
 21377
 21378 9300-ABEND.
 21379     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21380
 21381
 21382* EXEC CICS LINK
 21383*        PROGRAM   ('EL004')
 21384*        COMMAREA  (WS-ERROR-LINE)
 21385*        LENGTH    (72)
 21386*    END-EXEC.
 21387     MOVE 'EL004' TO DFHEIV1
 21388     MOVE 72
 21389       TO DFHEIV11
 21390*    MOVE '."C                   (   #00019838' TO DFHEIV0
 21391     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21392     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21393     MOVE X'2020233030303139383338' TO DFHEIV0(25:11)
 21394     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 396
* EL050.cbl
 21395           DFHEIV1,
 21396           WS-ERROR-LINE,
 21397           DFHEIV11,
 21398           DFHEIV99,
 21399           DFHEIV99,
 21400           DFHEIV99,
 21401           DFHEIV99
 21402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21403
 21404
 21405     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21406
 21407
 21408* EXEC CICS ABEND
 21409*        ABCODE ('EL50')
 21410*    END-EXEC.
 21411     MOVE 'EL50' TO DFHEIV5
 21412*    MOVE '.,A                   "   #00019846' TO DFHEIV0
 21413     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21414     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21415     MOVE X'2020233030303139383436' TO DFHEIV0(25:11)
 21416     CALL 'kxdfhei1' USING DFHEIV0,
 21417           DFHEIV5
 21418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21419
 21420
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 397
* EL050.cbl
 21422
 21423******************************************************************
 21424*                                                                *
 21425*            E R R O R   F O R M A T   R O U T I N E             *
 21426*                                                                *
 21427******************************************************************
 21428
 21429 9900-ERROR-FORMAT.
 21430
 21431     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21432                    PB-COMMON-ERROR (2) OR
 21433                    PB-COMMON-ERROR (3) OR
 21434                    PB-COMMON-ERROR (4) OR
 21435                    PB-COMMON-ERROR (5) OR
 21436                    PB-COMMON-ERROR (6) OR
 21437                    PB-COMMON-ERROR (7) OR
 21438                    PB-COMMON-ERROR (8) OR
 21439                    PB-COMMON-ERROR (9) OR
 21440                    PB-COMMON-ERROR (10)
 21441        GO TO 9900-EXIT.
 21442
 21443     IF PB-NO-OF-ERRORS = +10
 21444        GO TO 9900-EXIT.
 21445
 21446     ADD +1  TO PB-NO-OF-ERRORS.
 21447     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21448                                       (PB-NO-OF-ERRORS).
 21449 9900-EXIT.
 21450     EXIT.
 21451
 21452 9990-RETURN.
 21453     IF BROWSE-STARTED
 21454
 21455* EXEC CICS ENDBR
 21456*            DATASET  (ACCT-ID)
 21457*       END-EXEC.
 21458     MOVE 0
 21459       TO DFHEIV11
 21460*    MOVE '&2                    $   #00019883' TO DFHEIV0
 21461     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21462     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21463     MOVE X'2020233030303139383833' TO DFHEIV0(25:11)
 21464     CALL 'kxdfhei1' USING DFHEIV0,
 21465           ACCT-ID,
 21466           DFHEIV11,
 21467           DFHEIV99
 21468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21469
 21470
 21471 9990-EXIT.
 21472     EXIT.
 21473
 21474
 21475****Check for CRTO record, add one if not found.
 21476 9991-CHECK-FOR-ELCRTO.
 21477
 21478* EXEC CICS HANDLE CONDITION
 21479*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 398
* EL050.cbl
 21480*         ENDFILE (9991-CRTO-NOT-FOUND)
 21481*     END-EXEC.
 21482*    MOVE '"$I''                  ! A #00019893' TO DFHEIV0
 21483     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21484     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21485     MOVE X'4120233030303139383933' TO DFHEIV0(25:11)
 21486     CALL 'kxdfhei1' USING DFHEIV0
 21487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21488
 21489     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21490     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21491     MOVE +0                     TO ELCRTO-SEQ-NO
 21492
 21493
 21494* EXEC CICS READ
 21495*       DATASET   ('ELCRTO')
 21496*       INTO      (ORIGINAL-CERTIFICATE)
 21497*       RIDFLD    (ELCRTO-KEY)
 21498*       GTEQ
 21499*       RESP      (WS-RESPONSE)
 21500*    END-EXEC
 21501     MOVE LENGTH OF
 21502      ORIGINAL-CERTIFICATE
 21503       TO DFHEIV11
 21504     MOVE 'ELCRTO' TO DFHEIV1
 21505*    MOVE '&"IL       G          (  N#00019901' TO DFHEIV0
 21506     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21507     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21508     MOVE X'204E233030303139393031' TO DFHEIV0(25:11)
 21509     CALL 'kxdfhei1' USING DFHEIV0,
 21510           DFHEIV1,
 21511           ORIGINAL-CERTIFICATE,
 21512           DFHEIV11,
 21513           ELCRTO-KEY,
 21514           DFHEIV99,
 21515           DFHEIV99,
 21516           DFHEIV99
 21517     MOVE EIBRESP  TO WS-RESPONSE
 21518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21519
 21520     IF WS-RESP-NORMAL
 21521        AND (OC-CONTROL-PRIMARY (1:33) =
 21522                 PB-CONTROL-BY-ACCOUNT (1:33))
 21523        AND (OC-RECORD-TYPE =  'I')
 21524           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21525               GO TO 9991-CHECK-INDICATORS
 21526           ELSE
 21527               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21528               GO TO 9991-CRTO-ADD-REC
 21529           END-IF
 21530     END-IF.
 21531
 21532 9991-CRTO-NOT-FOUND.
 21533
 21534     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21535     MOVE 'OC'                TO OC-RECORD-ID
 21536     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21537                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 399
* EL050.cbl
 21538     MOVE +4096               TO OC-KEY-SEQ-NO.
 21539
 21540 9991-CRTO-ADD-REC.
 21541
 21542     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21543     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21544     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21545     MOVE 'I'                 TO OC-RECORD-TYPE
 21546     IF PB-ISSUE
 21547         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21548         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21549         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21550         MOVE PB-I-AGE               TO OC-INS-AGE
 21551         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21552         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21553         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21554         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21555         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21556         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21557         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21558         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21559         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21560         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21561         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21562         IF PB-I-JOINT-COMMISSION > +0
 21563             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21564         ELSE
 21565             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21566         END-IF
 21567         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21568         MOVE +0                     TO OC-LF-CANCEL-AMT
 21569                                        OC-LF-ITD-CANCEL-AMT
 21570         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21571         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21572         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21573         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21574         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21575         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21576         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21577         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21578         MOVE +0                     TO OC-AH-CANCEL-AMT
 21579                                        OC-AH-ITD-CANCEL-AMT
 21580         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21581         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21582         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21583     ELSE
 21584         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21585         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21586         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21587         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21588         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21589         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21590         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21591         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21592         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21593          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21594             MOVE SPACES             TO OC-LF-BENCD
 21595             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 400
* EL050.cbl
 21596                                        OC-LF-BEN-AMT
 21597                                        OC-LF-PRM-AMT
 21598                                        OC-LF-ALT-BEN-AMT
 21599                                        OC-LF-ALT-PRM-AMT
 21600                                        OC-LF-COMM-PCT
 21601                                        OC-LF-CANCEL-AMT
 21602             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21603             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21604         ELSE
 21605             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21606             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21607             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21608             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21609             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21610             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21611             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21612             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21613             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21614             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21615         END-IF
 21616         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21617         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21618          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21619             MOVE SPACES             TO OC-AH-BENCD
 21620             MOVE ZEROS              TO OC-AH-TERM
 21621                                        OC-AH-BEN-AMT
 21622                                        OC-AH-PRM-AMT
 21623                                        OC-AH-COMM-PCT
 21624                                        OC-AH-CANCEL-AMT
 21625                                        OC-AH-CP
 21626             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21627             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21628         ELSE
 21629             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21630             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21631             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21632             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21633             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21634             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21635             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21636             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21637             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21638         END-IF
 21639         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21640         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21641         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21642         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21643     END-IF
 21644     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21645
 21646     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21647
 21648
 21649* EXEC CICS READ
 21650*         DATASET   (FILE-ERMAIL)
 21651*         RIDFLD    (MA-CONTROL-PRIMARY)
 21652*         INTO      (MAILING-DATA)
 21653*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 401
* EL050.cbl
 21654*    END-EXEC
 21655     MOVE LENGTH OF
 21656      MAILING-DATA
 21657       TO DFHEIV11
 21658*    MOVE '&"IL       E          (  N#00020037' TO DFHEIV0
 21659     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21660     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21661     MOVE X'204E233030303230303337' TO DFHEIV0(25:11)
 21662     CALL 'kxdfhei1' USING DFHEIV0,
 21663           FILE-ERMAIL,
 21664           MAILING-DATA,
 21665           DFHEIV11,
 21666           MA-CONTROL-PRIMARY,
 21667           DFHEIV99,
 21668           DFHEIV99,
 21669           DFHEIV99
 21670     MOVE EIBRESP  TO WS-RESPONSE
 21671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21672
 21673     IF WS-RESP-NORMAL
 21674         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21675     END-IF.
 21676
 21677     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21678     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21679
 21680
 21681* EXEC CICS READ
 21682*         DATASET  (CRTT-ID)
 21683*         RIDFLD   (WS-ELCRTT-KEY)
 21684*         INTO     (CERTIFICATE-TRAILERS)
 21685*         RESP     (WS-RESPONSE)
 21686*    END-EXEC
 21687     MOVE LENGTH OF
 21688      CERTIFICATE-TRAILERS
 21689       TO DFHEIV11
 21690*    MOVE '&"IL       E          (  N#00020051' TO DFHEIV0
 21691     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21692     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21693     MOVE X'204E233030303230303531' TO DFHEIV0(25:11)
 21694     CALL 'kxdfhei1' USING DFHEIV0,
 21695           CRTT-ID,
 21696           CERTIFICATE-TRAILERS,
 21697           DFHEIV11,
 21698           WS-ELCRTT-KEY,
 21699           DFHEIV99,
 21700           DFHEIV99,
 21701           DFHEIV99
 21702     MOVE EIBRESP  TO WS-RESPONSE
 21703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21704
 21705     IF WS-RESP-NORMAL
 21706         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21707         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21708     END-IF.
 21709
 21710
 21711* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 402
* EL050.cbl
 21712*       DATASET   ('ELCRTO')
 21713*       FROM      (ORIGINAL-CERTIFICATE)
 21714*       RIDFLD    (OC-CONTROL-PRIMARY)
 21715*       RESP      (WS-RESPONSE)
 21716*    END-EXEC.
 21717     MOVE LENGTH OF
 21718      ORIGINAL-CERTIFICATE
 21719       TO DFHEIV11
 21720     MOVE 'ELCRTO' TO DFHEIV1
 21721*    MOVE '&$ L                  ''  N#00020063' TO DFHEIV0
 21722     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21723     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21724     MOVE X'204E233030303230303633' TO DFHEIV0(25:11)
 21725     CALL 'kxdfhei1' USING DFHEIV0,
 21726           DFHEIV1,
 21727           ORIGINAL-CERTIFICATE,
 21728           DFHEIV11,
 21729           OC-CONTROL-PRIMARY,
 21730           DFHEIV99,
 21731           DFHEIV99
 21732     MOVE EIBRESP  TO WS-RESPONSE
 21733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21734
 21735
 21736     GO TO 9991-EXIT.
 21737
 21738 9991-CHECK-INDICATORS.
 21739
 21740     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21741         GO TO 9991-EXIT
 21742     END-IF.
 21743
 21744     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21745         GO TO 9991-EXIT
 21746     END-IF.
 21747
 21748
 21749* EXEC CICS READ
 21750*       DATASET   ('ELCRTO')
 21751*       INTO      (ORIGINAL-CERTIFICATE)
 21752*       RIDFLD    (OC-CONTROL-PRIMARY)
 21753*       UPDATE
 21754*       RESP      (WS-RESPONSE)
 21755*    END-EXEC
 21756     MOVE LENGTH OF
 21757      ORIGINAL-CERTIFICATE
 21758       TO DFHEIV11
 21759     MOVE 'ELCRTO' TO DFHEIV1
 21760*    MOVE '&"IL       EU         (  N#00020082' TO DFHEIV0
 21761     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21762     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21763     MOVE X'204E233030303230303832' TO DFHEIV0(25:11)
 21764     CALL 'kxdfhei1' USING DFHEIV0,
 21765           DFHEIV1,
 21766           ORIGINAL-CERTIFICATE,
 21767           DFHEIV11,
 21768           OC-CONTROL-PRIMARY,
 21769           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 403
* EL050.cbl
 21770           DFHEIV99,
 21771           DFHEIV99
 21772     MOVE EIBRESP  TO WS-RESPONSE
 21773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21774     IF WS-RESP-NORMAL
 21775        IF PB-ISSUE
 21776          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21777          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21778          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21779          MOVE PB-I-AGE               TO OC-INS-AGE
 21780          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21781          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21782          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21783          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21784          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21785          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21786          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21787          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21788          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21789          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21790          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21791          IF PB-I-JOINT-COMMISSION > +0
 21792              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21793          ELSE
 21794              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21795          END-IF
 21796          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21797          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21798          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21799          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21800          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21801          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21802          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21803          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21804          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21805
 21806          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21807
 21808* EXEC CICS READ
 21809*             DATASET   (FILE-ERMAIL)
 21810*             RIDFLD    (MA-CONTROL-PRIMARY)
 21811*             INTO      (MAILING-DATA)
 21812*             RESP      (WS-RESPONSE)
 21813*         END-EXEC
 21814     MOVE LENGTH OF
 21815      MAILING-DATA
 21816       TO DFHEIV11
 21817*    MOVE '&"IL       E          (  N#00020122' TO DFHEIV0
 21818     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21819     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21820     MOVE X'204E233030303230313232' TO DFHEIV0(25:11)
 21821     CALL 'kxdfhei1' USING DFHEIV0,
 21822           FILE-ERMAIL,
 21823           MAILING-DATA,
 21824           DFHEIV11,
 21825           MA-CONTROL-PRIMARY,
 21826           DFHEIV99,
 21827           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 404
* EL050.cbl
 21828           DFHEIV99
 21829     MOVE EIBRESP  TO WS-RESPONSE
 21830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21831          IF WS-RESP-NORMAL
 21832             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21833          END-IF
 21834
 21835          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21836          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21837
 21838* EXEC CICS READ
 21839*             DATASET  (CRTT-ID)
 21840*             RIDFLD   (WS-ELCRTT-KEY)
 21841*             INTO     (CERTIFICATE-TRAILERS)
 21842*             RESP     (WS-RESPONSE)
 21843*         END-EXEC
 21844     MOVE LENGTH OF
 21845      CERTIFICATE-TRAILERS
 21846       TO DFHEIV11
 21847*    MOVE '&"IL       E          (  N#00020134' TO DFHEIV0
 21848     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21849     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21850     MOVE X'204E233030303230313334' TO DFHEIV0(25:11)
 21851     CALL 'kxdfhei1' USING DFHEIV0,
 21852           CRTT-ID,
 21853           CERTIFICATE-TRAILERS,
 21854           DFHEIV11,
 21855           WS-ELCRTT-KEY,
 21856           DFHEIV99,
 21857           DFHEIV99,
 21858           DFHEIV99
 21859     MOVE EIBRESP  TO WS-RESPONSE
 21860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21861          IF WS-RESP-NORMAL
 21862             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21863                               OC-INS-AGE-DEFAULT-FLAG
 21864             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21865                               OC-JNT-AGE-DEFAULT-FLAG
 21866          END-IF
 21867
 21868        ELSE
 21869          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21870             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21871             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21872             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21873          END-IF
 21874          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21875             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21876             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21877             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21878          END-IF
 21879          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21880        END-IF
 21881
 21882* EXEC CICS REWRITE
 21883*          DATASET   ('ELCRTO')
 21884*          FROM      (ORIGINAL-CERTIFICATE)
 21885*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 405
* EL050.cbl
 21886*       END-EXEC
 21887     MOVE LENGTH OF
 21888      ORIGINAL-CERTIFICATE
 21889       TO DFHEIV11
 21890     MOVE 'ELCRTO' TO DFHEIV1
 21891*    MOVE '&& L                  %  N#00020160' TO DFHEIV0
 21892     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21893     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21894     MOVE X'204E233030303230313630' TO DFHEIV0(25:11)
 21895     CALL 'kxdfhei1' USING DFHEIV0,
 21896           DFHEIV1,
 21897           ORIGINAL-CERTIFICATE,
 21898           DFHEIV11,
 21899           DFHEIV99
 21900     MOVE EIBRESP  TO WS-RESPONSE
 21901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21902     END-IF.
 21903
 21904 9991-EXIT.
 21905     EXIT.
 21906
 21907
 21908 9999-RETURN.
 21909     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21910
 21911
 21912* EXEC CICS RETURN
 21913*    END-EXEC.
 21914*    MOVE '.(                    ''   #00020174' TO DFHEIV0
 21915     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21916     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21917     MOVE X'2020233030303230313734' TO DFHEIV0(25:11)
 21918     CALL 'kxdfhei1' USING DFHEIV0,
 21919           DFHEIV99,
 21920           DFHEIV99,
 21921           DFHEIV99,
 21922           DFHEIV99,
 21923           DFHEIV99,
 21924           DFHEIV99
 21925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21926
 21927
 21928
 21929* GOBACK.
 21930     MOVE '9%                    "   ' TO DFHEIV0
 21931     MOVE 'EL050' TO DFHEIV1
 21932     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21933     GOBACK.
 21934
 21935 9999-DFHBACK SECTION.
 21936     MOVE '9%                    "   ' TO DFHEIV0
 21937     MOVE 'EL050' TO DFHEIV1
 21938     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21939     GOBACK.
 21940 9999-DFHEXIT.
 21941     IF DFHEIGDJ EQUAL 0001
 21942         NEXT SENTENCE
 21943     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 406
* EL050.cbl
 21944         GO TO 9300-ABEND,
 21945               3990-FILES-NOT-OPEN
 21946         DEPENDING ON DFHEIGDI
 21947     ELSE IF DFHEIGDJ EQUAL 3
 21948         GO TO 6610-START-BROWSE,
 21949               6630-ERRESS-PROBLEM,
 21950               6630-END-OF-FILE
 21951         DEPENDING ON DFHEIGDI
 21952     ELSE IF DFHEIGDJ EQUAL 4
 21953         GO TO 6630-END-OF-FILE,
 21954               6630-ERRESS-PROBLEM,
 21955               6630-ERRESS-PROBLEM,
 21956               6630-END-OF-FILE
 21957         DEPENDING ON DFHEIGDI
 21958     ELSE IF DFHEIGDJ EQUAL 5
 21959         GO TO 6630-END-OF-FILE,
 21960               6630-END-OF-FILE,
 21961               6630-ERRESS-PROBLEM,
 21962               6630-ERRESS-PROBLEM
 21963         DEPENDING ON DFHEIGDI
 21964     ELSE IF DFHEIGDJ EQUAL 6
 21965         GO TO 6660-START-BROWSE,
 21966               6690-ERRESC-PROBLEM,
 21967               6690-ERRESC-PROBLEM,
 21968               6690-END-OF-FILE
 21969         DEPENDING ON DFHEIGDI
 21970     ELSE IF DFHEIGDJ EQUAL 7
 21971         GO TO 6690-END-OF-FILE,
 21972               6690-ERRESC-PROBLEM,
 21973               6690-ERRESC-PROBLEM,
 21974               6690-END-OF-FILE
 21975         DEPENDING ON DFHEIGDI
 21976     ELSE IF DFHEIGDJ EQUAL 8
 21977         GO TO 6690-END-OF-FILE,
 21978               6690-ERRESC-PROBLEM,
 21979               6690-ERRESC-PROBLEM,
 21980               6690-END-OF-FILE
 21981         DEPENDING ON DFHEIGDI
 21982     ELSE IF DFHEIGDJ EQUAL 9
 21983         GO TO 7250-CONTINUE,
 21984               7250-CONTINUE
 21985         DEPENDING ON DFHEIGDI
 21986     ELSE IF DFHEIGDJ EQUAL 10
 21987         GO TO 7300-CONTINUE,
 21988               7300-CONTINUE
 21989         DEPENDING ON DFHEIGDI
 21990     ELSE IF DFHEIGDJ EQUAL 11
 21991         GO TO 8000-FREE-MAIN
 21992         DEPENDING ON DFHEIGDI
 21993     ELSE IF DFHEIGDJ EQUAL 12
 21994         GO TO 8100-NOTFND,
 21995               8100-NOTFND
 21996         DEPENDING ON DFHEIGDI
 21997     ELSE IF DFHEIGDJ EQUAL 13
 21998         GO TO 8110-NOTFND,
 21999               8110-NOTFND
 22000         DEPENDING ON DFHEIGDI
 22001     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 407
* EL050.cbl
 22002         GO TO 8130-EXIT
 22003         DEPENDING ON DFHEIGDI
 22004     ELSE IF DFHEIGDJ EQUAL 15
 22005         GO TO 8150-exit
 22006         DEPENDING ON DFHEIGDI
 22007     ELSE IF DFHEIGDJ EQUAL 16
 22008         GO TO 8180-NOTFND
 22009         DEPENDING ON DFHEIGDI
 22010     ELSE IF DFHEIGDJ EQUAL 17
 22011         GO TO 8190-NOTFND
 22012         DEPENDING ON DFHEIGDI
 22013     ELSE IF DFHEIGDJ EQUAL 18
 22014         GO TO 8195-NOTFND
 22015         DEPENDING ON DFHEIGDI
 22016     ELSE IF DFHEIGDJ EQUAL 19
 22017         GO TO 8200-NOTFND
 22018         DEPENDING ON DFHEIGDI
 22019     ELSE IF DFHEIGDJ EQUAL 20
 22020         GO TO 8300-NOTFND,
 22021               8300-ERRESS-PROBLEM,
 22022               8300-ERRESS-PROBLEM,
 22023               8300-NOTFND
 22024         DEPENDING ON DFHEIGDI
 22025     ELSE IF DFHEIGDJ EQUAL 21
 22026         GO TO 8450-FORM-NOT-FOUND,
 22027               8450-FORM-NOT-FOUND
 22028         DEPENDING ON DFHEIGDI
 22029     ELSE IF DFHEIGDJ EQUAL 22
 22030         GO TO 0199-ACCT-NOT-FOUND,
 22031               0199-ACCT-NOT-FOUND
 22032         DEPENDING ON DFHEIGDI
 22033     ELSE IF DFHEIGDJ EQUAL 23
 22034         GO TO 0199-ACCT-NOT-FOUND,
 22035               0199-ACCT-NOT-FOUND
 22036         DEPENDING ON DFHEIGDI
 22037     ELSE IF DFHEIGDJ EQUAL 24
 22038         GO TO 8582-COMP-NOT-FOUND,
 22039               8582-COMP-NOT-FOUND
 22040         DEPENDING ON DFHEIGDI
 22041     ELSE IF DFHEIGDJ EQUAL 25
 22042         GO TO 8583-AGTC-NOT-FOUND,
 22043               8583-AGTC-NOT-FOUND
 22044         DEPENDING ON DFHEIGDI
 22045     ELSE IF DFHEIGDJ EQUAL 26
 22046         GO TO 8584-BXRF-NOT-FOUND,
 22047               8584-BXRF-NOT-FOUND
 22048         DEPENDING ON DFHEIGDI
 22049     ELSE IF DFHEIGDJ EQUAL 27
 22050         GO TO 8585-PLAN-NOT-FOUND,
 22051               8585-PLAN-NOT-FOUND
 22052         DEPENDING ON DFHEIGDI
 22053     ELSE IF DFHEIGDJ EQUAL 28
 22054         GO TO 0299-CERT-NOT-FOUND
 22055         DEPENDING ON DFHEIGDI
 22056     ELSE IF DFHEIGDJ EQUAL 29
 22057         GO TO 8700-READ-CERT-MASTER
 22058         DEPENDING ON DFHEIGDI
 22059     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 23-Sep-14 09:47 Page 408
* EL050.cbl
 22060         GO TO 8720-COMP-ACCOUNTS,
 22061               8730-END-BROWSE,
 22062               8740-NOT-FOUND
 22063         DEPENDING ON DFHEIGDI
 22064     ELSE IF DFHEIGDJ EQUAL 31
 22065         GO TO 9000-NOTFND
 22066         DEPENDING ON DFHEIGDI
 22067     ELSE IF DFHEIGDJ EQUAL 32
 22068         GO TO 9100-NOTFND,
 22069               9100-NOTFND
 22070         DEPENDING ON DFHEIGDI
 22071     ELSE IF DFHEIGDJ EQUAL 33
 22072         GO TO 9991-CRTO-NOT-FOUND,
 22073               9991-CRTO-NOT-FOUND
 22074         DEPENDING ON DFHEIGDI.
 22075     MOVE '9%                    "   ' TO DFHEIV0
 22076     MOVE 'EL050' TO DFHEIV1
 22077     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22078     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40040     Code:       89011
