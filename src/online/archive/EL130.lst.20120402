* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   1
* EL130.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL130.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   2
* EL130.cbl
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33******************************************************************
    34
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   3
* EL130.cbl
    36 ENVIRONMENT DIVISION.
    37 DATA DIVISION.
    38 WORKING-STORAGE SECTION.
    39 01  DFH-START PIC X(04).
    40 77  FILLER  PIC X(32)  VALUE '********************************'.
    41 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    42 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    43
    44*    COPY ELCSCTM.
    45******************************************************************
    46*                                                                *
    47*                                                                *
    48*                            ELCSCTM                             *
    49*                            VMOD=2.001                          *
    50*                                                                *
    51*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    52*                                                                *
    53******************************************************************
    54 01  SECURITY-MESSAGE.
    55     12  FILLER                          PIC X(30)
    56            VALUE '** LOGIC SECURITY VIOLATION -'.
    57     12  SM-READ                         PIC X(6).
    58     12  FILLER                          PIC X(5)
    59            VALUE ' PGM='.
    60     12  SM-PGM                          PIC X(6).
    61     12  FILLER                          PIC X(5)
    62            VALUE ' OPR='.
    63     12  SM-PROCESSOR-ID                 PIC X(4).
    64     12  FILLER                          PIC X(6)
    65            VALUE ' TERM='.
    66     12  SM-TERMID                       PIC X(4).
    67     12  FILLER                          PIC XX   VALUE SPACE.
    68     12  SM-JUL-DATE                     PIC 9(5).
    69     12  FILLER                          PIC X    VALUE SPACE.
    70     12  SM-TIME                         PIC 99.99.
    71
    72
    73*    COPY ELCSCRTY.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCSCRTY                            *
    78*                            VMOD=2.001                          *
    79*                                                                *
    80*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    81*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    82*        SAVED IN PI-SECURITY-ADDRESS.                           *
    83*                                                                *
    84******************************************************************
    85 01  SECURITY-CONTROL.
    86     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    87     12  FILLER                       PIC XX    VALUE 'SC'.
    88     12  SC-CREDIT-CODES.
    89         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    90             20  SC-CREDIT-DISPLAY    PIC X.
    91             20  SC-CREDIT-UPDATE     PIC X.
    92     12  SC-CLAIMS-CODES.
    93         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   4
* EL130.cbl
    94             20  SC-CLAIMS-DISPLAY    PIC X.
    95             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   5
* EL130.cbl
    97 01  WS-DATE-AREA.
    98     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    99     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   100     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   101
   102 01  WS-CRI-SSN-WORK-AREA.
   103     05  WS-CRI-SOC-SEC-NO.
   104         10  WS-SS-REPT-CD       PIC X(5).
   105         10  WS-SS-LAST-NAME     PIC X(5).
   106         10  WS-SS-INITIAL       PIC X.
   107
   108     05  WS-CRI-REPORT-CODE.
   109         10  FILLER              PIC X(5).
   110         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   111
   112     05  WS-CRI-LAST-NAME.
   113         10  WS-CRI-NAME-MOVE    PIC X(5).
   114         10  FILLER              PIC X(10).
   115
   116 01  STANDARD-AREAS.
   117     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   118     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   119     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   120     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   121     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   122     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   123     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   124     12  PGM-NAME            PIC X(8).
   125     12  TIME-IN             PIC S9(7).
   126     12  TIME-OUT-R  REDEFINES TIME-IN.
   127         16  FILLER          PIC X.
   128         16  TIME-OUT        PIC 99V99.
   129         16  FILLER          PIC X(2).
   130     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   131     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   132     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   133     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   134     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   135     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   136     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   137     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   138     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   139     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   140     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   141     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   142     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   143     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   144     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   145     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   146     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   147     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   148     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   149     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   150     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   151     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
   152     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   153     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   154     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   6
* EL130.cbl
   155     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   156     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   157     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   158     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   159     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   160     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   161     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   162     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   163     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   164     12  FILE-ID             PIC X(8).
   165     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   166     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   167     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   168     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   169     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   170     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   171     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   172     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   173     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +550.
   174
   175 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   176     12  M                   PIC S9(7)V99           VALUE ZEROS.
   177     12  L                   PIC S9(7)V99           VALUE ZEROS.
   178     12  N                   PIC S9(3)              VALUE ZEROS.
   179     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   180     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   181     12  I                   PIC S99V9(5)           VALUE ZEROS.
   182     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   183     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   184     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   185     12  R                   PIC S9(3)              VALUE ZEROS.
   186     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   187     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   188     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   189     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   190     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   191     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   192     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   193     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   194     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   195
   196 01  TERM-CALC-WORK-AREA.
   197     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   198     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   199     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   200     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   201     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   202     12  V-EXPONENTS.
   203        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   204     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   205
   206 01  MISC-WORK-AREAS.
   207     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   208     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   209     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
   210     12  QID.
   211         16  QID-TERM        PIC X(4).
   212         16  FILLER          PIC X(4)    VALUE '130A'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   7
* EL130.cbl
   213     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   214     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   215     12  WS-GROUP-NO.
   216         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   217         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   218
   219     12  WS-RESPONSE         PIC S9(8)   COMP.
   220         88  WS-RESP-NORMAL              VALUE +00.
   221         88  WS-RESP-ERROR               VALUE +01.
   222         88  WS-RESP-NOTFND              VALUE +13.
   223
   224***************************************************************
   225*                                                             *
   226*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   227*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   228*    CHANGES WITH IN MAP EL130A.                              *
   229*                                                             *
   230***************************************************************
   231
   232     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   233     12  WS-SAVE-CLAIM-MASTER.
   234         16  FILLER                    PIC XX.
   235         16  WS-SAVE-CLAIM-KEY.
   236             20  WS-SAVE-COMPANY-CD    PIC X.
   237             20  WS-SAVE-CARRIER       PIC X.
   238             20  WS-SAVE-CLAIM-NO      PIC X(7).
   239             20  WS-SAVE-CERT-NO       PIC X(11).
   240         16  FILLER                    PIC X(328).
   241     12  SAVE-CURRENT-DATE         PIC XX.
   242     12  SAVE-CONTROL              PIC X(39).
   243     12  SAVE-ERACCT-KEY           PIC X(26).
   244     12  SAVE-COUNTER              PIC S9(8)   COMP.
   245     12  SAVE-METHOD               PIC X.
   246     12  SAVE-COMPANY-ID           PIC XXX.
   247     12  SAVE-COMPANY-CD           PIC X.
   248     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   249     12  SAVE-CREDIT-USER          PIC X.
   250     12  SAVE-CLAIM-USER           PIC X.
   251     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   252     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   253     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   254     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   255     12  SAVE-AH-OVERRIDE-L1       PIC X.
   256     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   257     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   258     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   259     12  FILLER                    PIC X.
   260*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   261     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   262     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   263     12  SAVE-EL127-TO-EL130-CNTRL.
   264         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
   265         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   266         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   267             20  SAVE-EL127-CARRIER  PIC X.
   268             20  SAVE-EL127-GROUPING PIC X(6).
   269             20  SAVE-EL127-STATE    PIC X(2).
   270             20  SAVE-EL127-ACCOUNT  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   8
* EL130.cbl
   271             20  SAVE-EL127-CERT-NO  PIC X(11).
   272             20  SAVE-EL127-EFF-DT   PIC XX.
   273     12  SAVE-EL659-TO-EL130-CNTRL.
   274         16  SAVE-EL659-CARRIER    PIC X.
   275         16  SAVE-EL659-GROUPING   PIC X(6).
   276         16  SAVE-EL659-STATE      PIC XX.
   277         16  SAVE-EL659-ACCOUNT    PIC X(10).
   278     12  DIVIDE-QUOT               PIC 999.
   279     12  DIVIDE-REM                PIC 999.
   280     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   281     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   282     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   283     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   284     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   285     12  WS-RESERVE-CONTROLS       PIC X(9).
   286     12  WS-EXPENSE-CONTROLS       PIC X(7).
   287     12  WS-REIN-TABLE.
   288         16  WS-REIN-1             PIC X            VALUE SPACE.
   289         16  WS-REIN-2             PIC X            VALUE SPACE.
   290         16  WS-REIN-3             PIC X            VALUE SPACE.
   291     12  WS-BENE-CALC-METHOD       PIC X.
   292     12  WS-EARNINGS-CALC          PIC X.
   293     12  WS-LF-EARNINGS-CALC       PIC X.
   294         88 TEX-REG                VALUE '4'.
   295         88 NET-PAY                VALUE '5'.
   296     12  WS-AH-EARNINGS-CALC       PIC X.
   297     12  WS-SPECIAL-CALC-CD        PIC X(01).
   298     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   299     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   300     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   301     12  WS-CLAIM-NUMBER.
   302         16  WS-CN-PREFIX.
   303             20  WS-CN-PRF-A PIC X.
   304             20  WS-CN-PRF-B PIC X.
   305         16  WS-CN-NUMBER    PIC 9(5).
   306     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   307     12  WS-CLAIM-SEQU.
   308         16  FILLER          PIC X    VALUE '('.
   309         16  WS-CURRENT-SEQU PIC Z9.
   310         16  FILLER          PIC X(4) VALUE ' OF '.
   311         16  WS-OF-SEQU      PIC Z9.
   312         16  FILLER          PIC X    VALUE ')'.
   313     12  DATE-WORK.
   314       14  FILLER                PIC XX.
   315       14  DATE-MM               PIC XX.
   316       14  DATE-DD               PIC XX.
   317       14  DATE-YY               PIC XX.
   318     12  CURR-DATE REDEFINES DATE-WORK.
   319         16  CURR-MM.
   320           18  CURR-M1           PIC 9.
   321           18  CURR-M2           PIC 9.
   322         16  FILLER              PIC X(5).
   323         16  CURR-YEAR           PIC 9.
   324     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   325     12  SUB                     PIC 99.
   326     12  MY-DATE.
   327         16  MY-MM               PIC XX.
   328         16  FILLER              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   9
* EL130.cbl
   329         16  MY-YY               PIC XX.
   330
   331     12  WS-EDIT-BEN-CODE        PIC XX.
   332         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   333                                          '90' THRU '99'.
   334
   335     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   336     12  WS-BEN-HOLD             PIC XX.
   337     12  WS-BEN-ALPHA-HOLD.
   338         15  WS-BEN-ALPHA-2      PIC XX.
   339         15  WS-BEN-ALPHA-1      PIC X.
   340     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   341     12  WS-REC-TYPE             PIC X.
   342     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   343     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   344     12  ARCH-NUMBER             PIC S9(8)   COMP.
   345     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   346         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   347         88  REIN-REC-FOUND                  VALUE 'Y'.
   348
   349     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   350     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   351
   352
   353 01  CSO-WORK-FIELDS.
   354     12  WS-BLANK            PIC X       VALUE ' '.
   355
   356     12  WS-MA-CONTROL-PRIMARY.
   357         16  WS-MA-COMPANY-CD        PIC  X.
   358         16  WS-MA-CARRIER           PIC  X.
   359         16  WS-MA-GROUPING          PIC  X(6).
   360         16  WS-MA-STATE             PIC  XX.
   361         16  WS-MA-ACCOUNT           PIC  X(10).
   362         16  WS-MA-CERT-EFF-DT       PIC  XX.
   363         16  WS-MA-CERT-NO.
   364             20  WS-MA-CERT-PRIME    PIC  X(10).
   365             20  WS-MA-CERT-SFX      PIC  X.
   366
   367     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   368     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   369     12  WS-SOC-SEC-NUMBER.
   370         16  WS-SOC-SEC-NO       PIC 9(9).
   371         16  WS-SOC-SEC-BLANK    PIC X(2).
   372     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   373         16  WS-SSN-1-3          PIC 9(3).
   374         16  WS-SSN-DASH1        PIC X(1).
   375         16  WS-SSN-4-5          PIC 9(2).
   376         16  WS-SSN-DASH2        PIC X(1).
   377         16  WS-SSN-6-9          PIC 9(4).
   378
   379     12  WS-DIAG-VIN-MSG.
   380         16  FILLER          PIC X(11)
   381             VALUE 'VIN NUMBER '.
   382         16  WS-DIAG-VIN     PIC X(17).
   383
   384     12  WS-VERIFY-NOTE      PIC X(34)
   385         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   386
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  10
* EL130.cbl
   387 01  MAP-DATE-AREAS.
   388     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   389     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   390     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   391     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   392     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   393     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   394     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   395     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   396     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   397     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   398     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   399     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   400     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   401     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   402     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   403     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   404     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   405     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   406     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   407         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   408     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   409     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   410     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   411     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   412
   413 01  ACCESS-KEYS.
   414     12  ELACTQ-KEY.
   415         16  ELACTQ-COMPANY-CD       PIC X.
   416         16  ELACTQ-CARRIER          PIC X.
   417         16  ELACTQ-CLAIM-NO         PIC X(7).
   418         16  ELACTQ-CERT-NO          PIC X(11).
   419     12  ELMSTR-KEY.
   420         16  MSTR-COMP-CD            PIC X.
   421         16  MSTR-CARRIER            PIC X.
   422         16  MSTR-CLAIM-NO           PIC X(7).
   423         16  MSTR-CERT-NO.
   424             20  MSTR-CERT-NO-PRIME  PIC X(10).
   425             20  MSTR-CERT-NO-SUFX   PIC X.
   426     12  SAVE-ELMSTR-KEY.
   427         16  SAVE-COMP-CD            PIC X.
   428         16  SAVE-CARRIER            PIC X.
   429         16  SAVE-CLAIM-NO           PIC X(7).
   430         16  SAVE-CERT-NO.
   431             20  SAVE-CERT-NO-PRIME  PIC X(10).
   432             20  SAVE-CERT-NO-SUFX   PIC X.
   433     12  ELMSTR5-KEY.
   434         16  MSTR5-COMP-CD           PIC X.
   435         16  MSTR5-CERT-NO.
   436             20  MSTR5-CERT-NO-PRIME PIC X(10).
   437             20  MSTR5-CERT-NO-SUFX  PIC X.
   438     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   439         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   440         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   441         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   442     12  ELCNTL-KEY.
   443         16  CNTL-COMP-ID    PIC X(3).
   444         16  CNTL-REC-TYPE   PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  11
* EL130.cbl
   445         16  CNTL-ACCESS.
   446             20  FILLER      PIC XX.
   447             20  CNTL-BENEFIT.
   448                 24  FILLER  PIC X.
   449                 24  CNTL-CARRIER PIC X.
   450         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   451     12  ELCERT-KEY.
   452         16  CERT-COMP-CD    PIC X.
   453         16  CERT-CARRIER    PIC X.
   454         16  CERT-GROUPING   PIC X(6).
   455         16  CERT-STATE      PIC X(2).
   456         16  CERT-ACCOUNT.
   457             20  CERT-ACCOUNT-PREFIX PIC X(4).
   458             20  CERT-ACCOUNT-PRIME  PIC X(6).
   459         16  CERT-EFF-DT     PIC XX.
   460         16  CERT-CERT-NO.
   461             20  CERT-CERT-NO-PRIME  PIC X(10).
   462             20  CERT-CERT-NO-SUFX   PIC X.
   463     12  ELCERT-KEY-5.
   464         16  CERT-COMP-CD-5      PIC X.
   465         16  CERT-CERT-5.
   466             20  CERT-CERT-5-PRIME   PIC X(10).
   467             20  CERT-CERT-5-SUFX    PIC X.
   468     12  ERACCT-KEY.
   469         16  ACCT-COMP-CD    PIC X.
   470         16  ACCT-CARRIER    PIC X.
   471         16  ACCT-GROUPING   PIC X(6).
   472         16  ACCT-STATE      PIC X(2).
   473         16  ACCT-ACCOUNT    PIC X(10).
   474         16  ACCT-EXP-DT     PIC XX.
   475     12  ELTRLR-KEY.
   476         16  TRLR-COMP-CD    PIC X.
   477         16  TRLR-CARRIER    PIC X.
   478         16  TRLR-CLAIM-NO   PIC X(7).
   479         16  TRLR-CERT-NO.
   480             20  TRLR-CERT-NO-PRIME  PIC X(10).
   481             20  TRLR-CERT-NO-SUFX   PIC X.
   482         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   483         16  TRLR-TYPE       PIC X.
   484     12  ELBENE-KEY.
   485         16  BENE-COMP-CD    PIC X.
   486         16  BENE-RCD-TYPE   PIC X.
   487         16  BENE-CODE       PIC X(10).
   488     12  ERREIN-KEY.
   489         16  REIN-COMP-CD        PIC X(01).
   490         16  REIN-TYPE           PIC X(01).
   491         16  REIN-TABLE-CO.
   492             20  REIN-CODE-1     PIC X(01).
   493             20  REIN-CODE-2     PIC X(01).
   494             20  REIN-CODE-3     PIC X(01).
   495         16  FILLER              PIC X(03).
   496     12  ELCRTT-KEY.
   497         16  CTRLR-COMP-CD       PIC X.
   498         16  CTRLR-CARRIER       PIC X.
   499         16  CTRLR-GROUPING      PIC X(6).
   500         16  CTRLR-STATE         PIC X(2).
   501         16  CTRLR-ACCOUNT       PIC X(10).
   502         16  CTRLR-EFF-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  12
* EL130.cbl
   503         16  CTRLR-CERT-NO       PIC X(11).
   504         16  CTRLR-REC-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  13
* EL130.cbl
   506 01  ERROR-MESSAGES.
   507     12  ER-0000                 PIC X(4)  VALUE '0000'.
   508     12  ER-0004                 PIC X(4)  VALUE '0004'.
   509     12  ER-0019                 PIC X(4)  VALUE '0019'.
   510     12  ER-0023                 PIC X(4)  VALUE '0023'.
   511     12  ER-0029                 PIC X(4)  VALUE '0029'.
   512     12  ER-0033                 PIC X(4)  VALUE '0033'.
   513     12  ER-0068                 PIC X(4)  VALUE '0068'.
   514     12  ER-0070                 PIC X(4)  VALUE '0070'.
   515     12  ER-0194                 PIC X(4)  VALUE '0194'.
   516     12  ER-0202                 PIC X(4)  VALUE '0202'.
   517     12  ER-0203                 PIC X(4)  VALUE '0203'.
   518     12  ER-0204                 PIC X(4)  VALUE '0204'.
   519     12  ER-0205                 PIC X(4)  VALUE '0205'.
   520     12  ER-0206                 PIC X(4)  VALUE '0206'.
   521     12  ER-0207                 PIC X(4)  VALUE '0207'.
   522     12  ER-0213                 PIC X(4)  VALUE '0213'.
   523     12  ER-0214                 PIC X(4)  VALUE '0214'.
   524     12  ER-0217                 PIC X(4)  VALUE '0217'.
   525     12  ER-0219                 PIC X(4)  VALUE '0219'.
   526     12  ER-0220                 PIC X(4)  VALUE '0220'.
   527     12  ER-0221                 PIC X(4)  VALUE '0221'.
   528     12  ER-0222                 PIC X(4)  VALUE '0222'.
   529     12  ER-0223                 PIC X(4)  VALUE '0223'.
   530     12  ER-0224                 PIC X(4)  VALUE '0224'.
   531     12  ER-0225                 PIC X(4)  VALUE '0225'.
   532     12  ER-0226                 PIC X(4)  VALUE '0226'.
   533     12  ER-0227                 PIC X(4)  VALUE '0227'.
   534     12  ER-0229                 PIC X(4)  VALUE '0229'.
   535     12  ER-0230                 PIC X(4)  VALUE '0230'.
   536     12  ER-0231                 PIC X(4)  VALUE '0231'.
   537     12  ER-0232                 PIC X(4)  VALUE '0232'.
   538     12  ER-0233                 PIC X(4)  VALUE '0233'.
   539     12  ER-0234                 PIC X(4)  VALUE '0234'.
   540     12  ER-0235                 PIC X(4)  VALUE '0235'.
   541     12  ER-0236                 PIC X(4)  VALUE '0236'.
   542     12  ER-0237                 PIC X(4)  VALUE '0237'.
   543     12  ER-0238                 PIC X(4)  VALUE '0238'.
   544     12  ER-0239                 PIC X(4)  VALUE '0239'.
   545     12  ER-0240                 PIC X(4)  VALUE '0240'.
   546     12  ER-0241                 PIC X(4)  VALUE '0241'.
   547     12  ER-0243                 PIC X(4)  VALUE '0243'.
   548     12  ER-0244                 PIC X(4)  VALUE '0244'.
   549     12  ER-0245                 PIC X(4)  VALUE '0245'.
   550     12  ER-0246                 PIC X(4)  VALUE '0246'.
   551     12  ER-0247                 PIC X(4)  VALUE '0247'.
   552     12  ER-0248                 PIC X(4)  VALUE '0248'.
   553     12  ER-0250                 PIC X(4)  VALUE '0250'.
   554     12  ER-0251                 PIC X(4)  VALUE '0251'.
   555     12  ER-0252                 PIC X(4)  VALUE '0252'.
   556     12  ER-0253                 PIC X(4)  VALUE '0253'.
   557     12  ER-0254                 PIC X(4)  VALUE '0254'.
   558     12  ER-0257                 PIC X(4)  VALUE '0257'.
   559     12  ER-0258                 PIC X(4)  VALUE '0258'.
   560     12  ER-0260                 PIC X(4)  VALUE '0260'.
   561     12  ER-0261                 PIC X(4)  VALUE '0261'.
   562     12  ER-0263                 PIC X(4)  VALUE '0263'.
   563     12  ER-0264                 PIC X(4)  VALUE '0264'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  14
* EL130.cbl
   564     12  ER-0265                 PIC X(4)  VALUE '0265'.
   565     12  ER-0266                 PIC X(4)  VALUE '0266'.
   566     12  ER-0267                 PIC X(4)  VALUE '0267'.
   567     12  ER-0334                 PIC X(4)  VALUE '0334'.
   568     12  ER-0337                 PIC X(4)  VALUE '0337'.
   569     12  ER-0412                 PIC X(4)  VALUE '0412'.
   570     12  ER-0413                 PIC X(4)  VALUE '0413'.
   571     12  ER-0428                 PIC X(4)  VALUE '0428'.
   572     12  ER-0429                 PIC X(4)  VALUE '0429'.
   573     12  ER-0430                 PIC X(4)  VALUE '0430'.
   574     12  ER-0433                 PIC X(4)  VALUE '0433'.
   575     12  ER-0434                 PIC X(4)  VALUE '0434'.
   576     12  ER-0458                 PIC X(4)  VALUE '0458'.
   577     12  ER-0489                 PIC X(4)  VALUE '0489'.
   578     12  ER-0509                 PIC X(4)  VALUE '0509'.
   579     12  ER-0510                 PIC X(4)  VALUE '0510'.
   580     12  ER-0511                 PIC X(4)  VALUE '0511'.
   581     12  ER-0512                 PIC X(4)  VALUE '0512'.
   582     12  ER-0516                 PIC X(4)  VALUE '0516'.
   583     12  ER-0517                 PIC X(4)  VALUE '0517'.
   584     12  ER-0518                 PIC X(4)  VALUE '0518'.
   585     12  ER-0519                 PIC X(4)  VALUE '0519'.
   586     12  ER-0520                 PIC X(4)  VALUE '0520'.
   587     12  ER-0521                 PIC X(4)  VALUE '0521'.
   588     12  ER-0522                 PIC X(4)  VALUE '0522'.
   589     12  ER-0523                 PIC X(4)  VALUE '0523'.
   590     12  ER-0544                 PIC X(4)  VALUE '0544'.
   591     12  ER-0546                 PIC X(4)  VALUE '0546'.
   592     12  ER-0558                 PIC X(4)  VALUE '0558'.
   593     12  ER-0560                 PIC X(4)  VALUE '0560'.
   594     12  ER-0562                 PIC X(4)  VALUE '0562'.
   595     12  ER-0565                 PIC X(4)  VALUE '0565'.
   596     12  ER-0569                 PIC X(4)  VALUE '0569'.
   597     12  ER-0693                 PIC X(4)  VALUE '0693'.
   598     12  ER-0715                 PIC X(4)  VALUE '0715'.
   599     12  ER-0840                 PIC X(4)  VALUE '0840'.
   600     12  ER-0841                 PIC X(4)  VALUE '0841'.
   601     12  ER-0842                 PIC X(4)  VALUE '0842'.
   602     12  ER-0843                 PIC X(4)  VALUE '0843'.
   603     12  ER-0878                 PIC X(4)  VALUE '0878'.
   604     12  ER-0887                 PIC X(4)  VALUE '0887'.
   605     12  ER-2280                 PIC X(4)  VALUE '2280'.
   606     12  ER-2370                 PIC X(4)  VALUE '2370'.
   607     12  ER-2371                 PIC X(4)  VALUE '2371'.
   608     12  ER-2378                 PIC X(4)  VALUE '2378'.
   609     12  ER-2380                 PIC X(4)  VALUE '2380'.
   610     12  ER-2566                 PIC X(4)  VALUE '2566'.
   611     12  ER-2848                 PIC X(4)  VALUE '2848'.
   612     12  ER-3548                 PIC X(4)  VALUE '3548'.
   613     12  ER-7008                 PIC X(4)  VALUE '7008'.
   614     12  ER-7319                 PIC X(4)  VALUE '7319'.
   615     12  ER-7321                 PIC X(4)  VALUE '7321'.
   616     12  ER-7352                 PIC X(4)  VALUE '7352'.
   617     12  ER-7353                 PIC X(4)  VALUE '7353'.
   618     12  ER-7575                 PIC X(4)  VALUE '7575'.
   619     12  ER-7634                 PIC X(4)  VALUE '7634'.
   620     12  ER-7635                 PIC X(4)  VALUE '7635'.
   621     12  ER-7636                 PIC X(4)  VALUE '7636'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  15
* EL130.cbl
   622     12  ER-7637                 PIC X(4)  VALUE '7637'.
   623     12  ER-7638                 PIC X(4)  VALUE '7638'.
   624     12  ER-7639                 PIC X(4)  VALUE '7639'.
   625     12  ER-7640                 PIC X(4)  VALUE '7640'.
   626     12  ER-7641                 PIC X(4)  VALUE '7641'.
   627     12  ER-7642                 PIC X(4)  VALUE '7642'.
   628     12  ER-7643                 PIC X(4)  VALUE '7643'.
   629     12  ER-7646                 PIC X(4)  VALUE '7646'.
   630     12  ER-7647                 PIC X(4)  VALUE '7647'.
   631     12  ER-7648                 PIC X(4)  VALUE '7648'.
   632     12  ER-7649                 PIC X(4)  VALUE '7649'.
   633     12  ER-7651                 PIC X(4)  VALUE '7651'.
   634     12  ER-7670                 PIC X(4)  VALUE '7670'.
   635     12  ER-7671                 PIC X(4)  VALUE '7671'.
   636     12  ER-7686                 PIC X(4)  VALUE '7686'.
   637     12  ER-7688                 PIC X(4)  VALUE '7688'.
   638     12  ER-7689                 PIC X(4)  VALUE '7689'.
   639     12  ER-7691                 PIC X(4)  VALUE '7691'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  16
* EL130.cbl
   641*    COPY ELCLNKLT.
   642******************************************************************
   643*                                                                *
   644*                                                                *
   645*                           ELCLNKLT                             *
   646*                            VMOD=2.003                          *
   647*                                                                *
   648*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   649*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   650*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   651*                                                                *
   652*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   653*   COMPLETING THE REQUIRED FIELDS.                              *
   654*                                                                *
   655*   THE CALLING PROGRAM SHOULD CHECK:                            *
   656*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   657*                              9999 INDICATES AN UNKNOWN ABEND   *
   658*                                   WAS DETECTED.                *
   659*                              ALL OTHER VALUES ARE NORMAL ERROR *
   660*                              CODES FOUND IN THE ERROR FILE.    *
   661******************************************************************
   662 01  W-1523-LINKDATA.
   663     12  W-1523-COMMON-PI-DATA.
   664         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   665         16  FILLER              PIC  X(67).
   666         16  W-1523-COMPANY-CD   PIC  X(01).
   667         16  FILLER              PIC  X(10).
   668         16  W-1523-CONTROL-IN-PROGRESS.
   669             20  W-1523-CARRIER  PIC  X(01).
   670             20  W-1523-GROUPING PIC  X(06).
   671             20  W-1523-STATE    PIC  X(02).
   672             20  W-1523-ACCOUNT  PIC  X(10).
   673             20  W-1523-CLAIM-CERT-GRP.
   674                 24  W-1523-CLAIM-NO
   675                                 PIC  X(07).
   676                 24  W-1523-CERT-NO.
   677                     28  W-1523-CERT-PRIME
   678                                 PIC  X(10).
   679                     28  W-1523-CERT-SFX
   680                                 PIC  X(01).
   681                 24  W-1523-CERT-EFF-DT
   682                                 PIC  X(02).
   683         16  FILLER              PIC X(265).
   684
   685     12  W-1523-WORK-AREA.
   686         16  W-1523-FORM-NUMBER  PIC  X(04).
   687         16  W-1523-NUMBER-COPIES
   688                                 PIC  9(01).
   689         16  W-1523-ADDR-TYPE    PIC  X(02).
   690         16  W-1523-FOLLOW-UP-DATE
   691                                 PIC  X(02).
   692         16  W-1523-RESEND-DATE  PIC  X(02).
   693         16  W-1523-ERROR-CODE   PIC  9(04).
   694             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   695             88  W-1523-FATAL-ERROR
   696                                    VALUES  0006 0013 0042
   697                                            0154 0168 0169
   698                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  17
* EL130.cbl
   699                                            0179 0186 0281
   700                                            0332 2055 3697
   701                                            3698 3699 3770
   702                                            3771 3772 7675
   703                                            9106 9808 9883
   704                                            9887.
   705             88  W-1523-STOP-ERRORS
   706                                    VALUES  0013 0042 0154
   707                                            0168 0169 0172
   708                                            0281 0332 2055
   709                                            3698 3699 7675
   710                                            9106 9808 9883
   711                                            9999.
   712         16  W-1523-REASON       PIC  X(70).
   713         16  W-1523-ARCHIVE-NUMBER
   714                                 PIC  9(08).
   715     12  W-1523-POINTER-AREA.
   716         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   717         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   718         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   719         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   720         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  18
* EL130.cbl
   722*    COPY ELCINTF.
   723******************************************************************
   724*                                                                *
   725*                                                                *
   726*                            ELCINTF.                            *
   727*                            VMOD=2.017                          *
   728*                                                                *
   729*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   730*                                                                *
   731*       LENGTH = 1024                                            *
   732*                                                                *
   733******************************************************************
   734 01  PROGRAM-INTERFACE-BLOCK.
   735     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   736     12  PI-CALLING-PROGRAM              PIC X(8).
   737     12  PI-SAVED-PROGRAM-1              PIC X(8).
   738     12  PI-SAVED-PROGRAM-2              PIC X(8).
   739     12  PI-SAVED-PROGRAM-3              PIC X(8).
   740     12  PI-SAVED-PROGRAM-4              PIC X(8).
   741     12  PI-SAVED-PROGRAM-5              PIC X(8).
   742     12  PI-SAVED-PROGRAM-6              PIC X(8).
   743     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   744     12  PI-COMPANY-ID                   PIC XXX.
   745     12  PI-COMPANY-CD                   PIC X.
   746
   747     12  PI-COMPANY-PASSWORD             PIC X(8).
   748
   749     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   750
   751     12  PI-CONTROL-IN-PROGRESS.
   752         16  PI-CARRIER                  PIC X.
   753         16  PI-GROUPING                 PIC X(6).
   754         16  PI-STATE                    PIC XX.
   755         16  PI-ACCOUNT                  PIC X(10).
   756         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   757                                         PIC X(10).
   758         16  PI-CLAIM-CERT-GRP.
   759             20  PI-CLAIM-NO             PIC X(7).
   760             20  PI-CERT-NO.
   761                 25  PI-CERT-PRIME       PIC X(10).
   762                 25  PI-CERT-SFX         PIC X.
   763             20  PI-CERT-EFF-DT          PIC XX.
   764         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   765             20  PI-PLAN-CODE            PIC X(2).
   766             20  PI-REVISION-NUMBER      PIC X(3).
   767             20  PI-PLAN-EFF-DT          PIC X(2).
   768             20  PI-PLAN-EXP-DT          PIC X(2).
   769             20  FILLER                  PIC X(11).
   770         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   771             20  PI-OE-REFERENCE-1.
   772                 25  PI-OE-REF-1-PRIME   PIC X(18).
   773                 25  PI-OE-REF-1-SUFF    PIC XX.
   774
   775     12  PI-SESSION-IN-PROGRESS          PIC X.
   776         88  CLAIM-SESSION                   VALUE '1'.
   777         88  CREDIT-SESSION                  VALUE '2'.
   778         88  WARRANTY-SESSION                VALUE '3'.
   779         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  19
* EL130.cbl
   780         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   781
   782
   783*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   784
   785     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   786     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   787
   788     12  PI-CREDIT-USER                  PIC X.
   789         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   790         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   791
   792     12  PI-CLAIM-USER                   PIC X.
   793         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   794         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   795
   796     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   797         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   798         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   799         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   800         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   801         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   802
   803     12  PI-PROCESSOR-ID                 PIC X(4).
   804
   805     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   806
   807     12  PI-MEMBER-CAPTION               PIC X(10).
   808
   809     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   810         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   811
   812     12  PI-LIFE-OVERRIDE-L1             PIC X.
   813     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   814     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   815     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   816
   817     12  PI-AH-OVERRIDE-L1               PIC X.
   818     12  PI-AH-OVERRIDE-L2               PIC XX.
   819     12  PI-AH-OVERRIDE-L6               PIC X(6).
   820     12  PI-AH-OVERRIDE-L12              PIC X(12).
   821
   822     12  PI-NEW-SYSTEM                   PIC X(2).
   823
   824     12  PI-PRIMARY-CERT-NO              PIC X(11).
   825     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   826         88  PI-USES-PAID-TO                 VALUE '1'.
   827     12  PI-CRDTCRD-SYSTEM.
   828         16  PI-CRDTCRD-USER             PIC X.
   829             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   830             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   831         16  PI-CC-MONTH-END-DT          PIC XX.
   832     12  PI-PROCESSOR-PRINTER            PIC X(4).
   833
   834     12  PI-OE-REFERENCE-2.
   835         16  PI-OE-REF-2-PRIME           PIC X(10).
   836         16  PI-OE-REF-2-SUFF            PIC X.
   837
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  20
* EL130.cbl
   838     12  PI-REM-TRM-CALC-OPTION          PIC X.
   839
   840     12  PI-LANGUAGE-TYPE                PIC X.
   841             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   842             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   843             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   844
   845     12  PI-POLICY-LINKAGE-IND           PIC X.
   846         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   847         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   848                                                   LOW-VALUES.
   849
   850     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   851     12  PI-CLAIM-PW-SESSION             PIC X(1).
   852         88  PI-CLAIM-CREDIT                 VALUE '1'.
   853         88  PI-CLAIM-CONVEN                 VALUE '2'.
   854     12  FILLER                          PIC X(4).
   855
   856     12  PI-SYSTEM-LEVEL                 PIC X(145).
   857
   858     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   859         PI-SYSTEM-LEVEL.
   860
   861         16  PI-ENTRY-CODES.
   862             20  PI-ENTRY-CD-1           PIC X.
   863             20  PI-ENTRY-CD-2           PIC X.
   864
   865         16  PI-RETURN-CODES.
   866             20  PI-RETURN-CD-1          PIC X.
   867             20  PI-RETURN-CD-2          PIC X.
   868
   869         16  PI-UPDATE-STATUS-SAVE.
   870             20  PI-UPDATE-BY            PIC X(4).
   871             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   872
   873         16  PI-LOWER-CASE-LETTERS       PIC X.
   874             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   875
   876*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   877*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   878*            88  CARRIER-CLM-CNTL            VALUE '2'.
   879
   880         16  PI-CERT-ACCESS-CONTROL      PIC X.
   881             88  ST-ACCNT-CNTL               VALUE ' '.
   882             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   883             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   884             88  ACCNT-CNTL                  VALUE '3'.
   885             88  CARR-ACCNT-CNTL             VALUE '4'.
   886
   887         16  PI-PROCESSOR-CAP-LIST.
   888             20  PI-SYSTEM-CONTROLS.
   889                24 PI-SYSTEM-DISPLAY     PIC X.
   890                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   891                24 PI-SYSTEM-MODIFY      PIC X.
   892                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   893             20  FILLER                  PIC XX.
   894             20  PI-DISPLAY-CAP          PIC X.
   895                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  21
* EL130.cbl
   896             20  PI-MODIFY-CAP           PIC X.
   897                 88  MODIFY-CAP              VALUE 'Y'.
   898             20  PI-MSG-AT-LOGON-CAP     PIC X.
   899                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   900             20  PI-FORCE-CAP            PIC X.
   901                 88  FORCE-CAP               VALUE 'Y'.
   902
   903         16  PI-PROGRAM-CONTROLS.
   904             20  PI-PGM-PRINT-OPT        PIC X.
   905             20  PI-PGM-FORMAT-OPT       PIC X.
   906             20  PI-PGM-PROCESS-OPT      PIC X.
   907             20  PI-PGM-TOTALS-OPT       PIC X.
   908
   909         16  PI-HELP-INTERFACE.
   910             20  PI-LAST-ERROR-NO        PIC X(4).
   911             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   912
   913         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   914             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   915
   916         16  PI-CR-CONTROL-IN-PROGRESS.
   917             20  PI-CR-CARRIER           PIC X.
   918             20  PI-CR-GROUPING          PIC X(6).
   919             20  PI-CR-STATE             PIC XX.
   920             20  PI-CR-ACCOUNT           PIC X(10).
   921             20  PI-CR-FIN-RESP          PIC X(10).
   922             20  PI-CR-TYPE              PIC X.
   923
   924         16  PI-CR-BATCH-NUMBER          PIC X(6).
   925
   926         16  PI-CR-MONTH-END-DT          PIC XX.
   927
   928         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   929             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   930             88  PI-ZERO-CARRIER             VALUE '1'.
   931             88  PI-ZERO-GROUPING            VALUE '2'.
   932             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   933
   934         16  PI-CARRIER-SECURITY         PIC X.
   935             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   936
   937         16  PI-ACCOUNT-SECURITY         PIC X(10).
   938             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   939             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   940
   941         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   942             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   943                                         INDEXED BY PI-ACCESS-NDX
   944                                         PIC X.
   945
   946         16  PI-GA-BILLING-CONTROL       PIC X.
   947             88  PI-GA-BILLING               VALUE '1'.
   948
   949         16  PI-MAIL-PROCESSING          PIC X.
   950             88  PI-MAIL-YES                 VALUE 'Y'.
   951
   952         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   953
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  22
* EL130.cbl
   954         16  PI-AR-SYSTEM.
   955             20  PI-AR-PROCESSING-CNTL   PIC X.
   956                 88  PI-AR-PROCESSING        VALUE 'Y'.
   957             20  PI-AR-SUMMARY-CODE      PIC X(6).
   958             20  PI-AR-MONTH-END-DT      PIC XX.
   959
   960         16  PI-MP-SYSTEM.
   961             20  PI-MORTGAGE-USER            PIC X.
   962                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   963                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   964             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   965                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   966                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   967                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   968                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   969                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   970             20  PI-MP-MONTH-END-DT          PIC XX.
   971             20  PI-MP-REFERENCE-NO.
   972                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   973                 24  PI-MP-REFERENCE-SFX     PIC XX.
   974
   975         16  PI-LABEL-CONTROL            PIC X(01).
   976             88  PI-CREATE-LABELS                    VALUE 'Y'.
   977             88  PI-BYPASS-LABELS                    VALUE 'N'.
   978
   979         16  PI-BILL-GROUPING-CODE       PIC X(01).
   980             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   981
   982         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   983             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   984             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   985
   986         16  FILLER                      PIC X(14).
   987
   988     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   989******************************************************************
   990     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
   991         16  PI-MSTR-DT               PIC XX.
   992         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
   993         16  PI-TRLR-DT               PIC XX.
   994         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
   995         16  PI-LAST-CLAIM            PIC X(7).
   996         16  PI-LAST-CARR             PIC X.
   997         16  PI-LAST-CERT.
   998             20  PI-LAST-CERT-PRIME   PIC X(10).
   999             20  PI-LAST-CERT-SUFX    PIC X.
  1000         16  PI-LAST-CLAIM-TYPE       PIC X.
  1001         16  PI-CURSOR                PIC S9(4)   COMP.
  1002         16  PI-SAVE-CERT.
  1003             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1004             20  PI-SAVE-CERT-SUFX    PIC X.
  1005         16  PI-SAVE-EFFDT            PIC X(2).
  1006         16  PI-SAVE-ACCOUNT          PIC X(10).
  1007         16  PI-INCURR-SW             PIC X.
  1008         16  PI-PRT-OPT               PIC X.
  1009         16  PI-ALT-PRT               PIC X(4).
  1010         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1011             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  23
* EL130.cbl
  1012         16  FILLER                   PIC X(272).
  1013         16  PI-EL127-TO-EL130-CNTRL.
  1014             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1015             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1016             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1017                 24  PI-EL127-CARRIER        PIC X.
  1018                 24  PI-EL127-GROUPING       PIC X(6).
  1019                 24  PI-EL127-STATE          PIC X(2).
  1020                 24  PI-EL127-ACCOUNT        PIC X(10).
  1021                 24  PI-EL127-CERT-NO.
  1022                     28  PI-EL127-CERT-PRIME PIC X(10).
  1023                     28  PI-EL127-CERT-SUFX  PIC X.
  1024                 24  PI-EL127-EFF-DT         PIC XX.
  1025*        16  FILLER                          PIC X(50).
  1026         16  FILLER                          PIC X(31).
  1027         16  PI-EL659-TO-EL130-CNTRL.
  1028             20  PI-EL659-CARRIER            PIC X.
  1029             20  PI-EL659-GROUPING           PIC X(6).
  1030             20  PI-EL659-STATE              PIC XX.
  1031             20  PI-EL659-ACCOUNT            PIC X(10).
  1032
  1033         16  FILLER                          PIC X(19).
  1034
  1035         16  PI-SAVE-INCUR-DT                PIC X(02).
  1036         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1037*         16  FILLER                          PIC X(65).
  1038         16  PI-ST-VFY-2ND-BENE              PIC X.
  1039         16  FILLER                          PIC X(64).
  1040
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  24
* EL130.cbl
  1042*    COPY EL130S.
  1043 01  EL130AI.
  1044     05  FILLER            PIC  X(0012).
  1045*    -------------------------------
  1046     05  RUNDTEL PIC S9(0004) COMP.
  1047     05  RUNDTEF PIC  X(0001).
  1048     05  FILLER REDEFINES RUNDTEF.
  1049         10  RUNDTEA PIC  X(0001).
  1050     05  RUNDTEI PIC  X(0008).
  1051*    -------------------------------
  1052     05  RUNTIMEL PIC S9(0004) COMP.
  1053     05  RUNTIMEF PIC  X(0001).
  1054     05  FILLER REDEFINES RUNTIMEF.
  1055         10  RUNTIMEA PIC  X(0001).
  1056     05  RUNTIMEI PIC  X(0005).
  1057*    -------------------------------
  1058     05  COMPL PIC S9(0004) COMP.
  1059     05  COMPF PIC  X(0001).
  1060     05  FILLER REDEFINES COMPF.
  1061         10  COMPA PIC  X(0001).
  1062     05  COMPI PIC  X(0003).
  1063*    -------------------------------
  1064     05  SEQUL PIC S9(0004) COMP.
  1065     05  SEQUF PIC  X(0001).
  1066     05  FILLER REDEFINES SEQUF.
  1067         10  SEQUA PIC  X(0001).
  1068     05  SEQUI PIC  X(0010).
  1069*    -------------------------------
  1070     05  MAINTL PIC S9(0004) COMP.
  1071     05  MAINTF PIC  X(0001).
  1072     05  FILLER REDEFINES MAINTF.
  1073         10  MAINTA PIC  X(0001).
  1074     05  MAINTI PIC  X(0001).
  1075*    -------------------------------
  1076     05  CLMNOL PIC S9(0004) COMP.
  1077     05  CLMNOF PIC  X(0001).
  1078     05  FILLER REDEFINES CLMNOF.
  1079         10  CLMNOA PIC  X(0001).
  1080     05  CLMNOI PIC  X(0007).
  1081*    -------------------------------
  1082     05  CLMCARRL PIC S9(0004) COMP.
  1083     05  CLMCARRF PIC  X(0001).
  1084     05  FILLER REDEFINES CLMCARRF.
  1085         10  CLMCARRA PIC  X(0001).
  1086     05  CLMCARRI PIC  X(0001).
  1087*    -------------------------------
  1088     05  CLMTYPEL PIC S9(0004) COMP.
  1089     05  CLMTYPEF PIC  X(0001).
  1090     05  FILLER REDEFINES CLMTYPEF.
  1091         10  CLMTYPEA PIC  X(0001).
  1092     05  CLMTYPEI PIC  X(0001).
  1093*    -------------------------------
  1094     05  CERTNOL PIC S9(0004) COMP.
  1095     05  CERTNOF PIC  X(0001).
  1096     05  FILLER REDEFINES CERTNOF.
  1097         10  CERTNOA PIC  X(0001).
  1098     05  CERTNOI PIC  X(0010).
  1099*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  25
* EL130.cbl
  1100     05  SUFXL PIC S9(0004) COMP.
  1101     05  SUFXF PIC  X(0001).
  1102     05  FILLER REDEFINES SUFXF.
  1103         10  SUFXA PIC  X(0001).
  1104     05  SUFXI PIC  X(0001).
  1105*    -------------------------------
  1106     05  PCERTNOL PIC S9(0004) COMP.
  1107     05  PCERTNOF PIC  X(0001).
  1108     05  FILLER REDEFINES PCERTNOF.
  1109         10  PCERTNOA PIC  X(0001).
  1110     05  PCERTNOI PIC  X(0010).
  1111*    -------------------------------
  1112     05  PSUFXL PIC S9(0004) COMP.
  1113     05  PSUFXF PIC  X(0001).
  1114     05  FILLER REDEFINES PSUFXF.
  1115         10  PSUFXA PIC  X(0001).
  1116     05  PSUFXI PIC  X(0001).
  1117*    -------------------------------
  1118     05  INCURL PIC S9(0004) COMP.
  1119     05  INCURF PIC  X(0001).
  1120     05  FILLER REDEFINES INCURF.
  1121         10  INCURA PIC  X(0001).
  1122     05  INCURI PIC  X(0008).
  1123*    -------------------------------
  1124     05  REPORTL PIC S9(0004) COMP.
  1125     05  REPORTF PIC  X(0001).
  1126     05  FILLER REDEFINES REPORTF.
  1127         10  REPORTA PIC  X(0001).
  1128     05  REPORTI PIC  X(0008).
  1129*    -------------------------------
  1130     05  CAUSEL PIC S9(0004) COMP.
  1131     05  CAUSEF PIC  X(0001).
  1132     05  FILLER REDEFINES CAUSEF.
  1133         10  CAUSEA PIC  X(0001).
  1134     05  CAUSEI PIC  X(0006).
  1135*    -------------------------------
  1136     05  ESTENDL PIC S9(0004) COMP.
  1137     05  ESTENDF PIC  X(0001).
  1138     05  FILLER REDEFINES ESTENDF.
  1139         10  ESTENDA PIC  X(0001).
  1140     05  ESTENDI PIC  X(0008).
  1141*    -------------------------------
  1142     05  DIAGL PIC S9(0004) COMP.
  1143     05  DIAGF PIC  X(0001).
  1144     05  FILLER REDEFINES DIAGF.
  1145         10  DIAGA PIC  X(0001).
  1146     05  DIAGI PIC  X(0060).
  1147*    -------------------------------
  1148     05  BENECDL PIC S9(0004) COMP.
  1149     05  BENECDF PIC  X(0001).
  1150     05  FILLER REDEFINES BENECDF.
  1151         10  BENECDA PIC  X(0001).
  1152     05  BENECDI PIC  X(0010).
  1153*    -------------------------------
  1154     05  BIRTHDTL PIC S9(0004) COMP.
  1155     05  BIRTHDTF PIC  X(0001).
  1156     05  FILLER REDEFINES BIRTHDTF.
  1157         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  26
* EL130.cbl
  1158     05  BIRTHDTI PIC  X(0008).
  1159*    -------------------------------
  1160     05  SSNL PIC S9(0004) COMP.
  1161     05  SSNF PIC  X(0001).
  1162     05  FILLER REDEFINES SSNF.
  1163         10  SSNA PIC  X(0001).
  1164     05  SSNI PIC  X(0011).
  1165*    -------------------------------
  1166     05  SEXL PIC S9(0004) COMP.
  1167     05  SEXF PIC  X(0001).
  1168     05  FILLER REDEFINES SEXF.
  1169         10  SEXA PIC  X(0001).
  1170     05  SEXI PIC  X(0001).
  1171*    -------------------------------
  1172     05  OCCCDL PIC S9(0004) COMP.
  1173     05  OCCCDF PIC  X(0001).
  1174     05  FILLER REDEFINES OCCCDF.
  1175         10  OCCCDA PIC  X(0001).
  1176     05  OCCCDI PIC  X(0006).
  1177*    -------------------------------
  1178     05  LSTNMEL PIC S9(0004) COMP.
  1179     05  LSTNMEF PIC  X(0001).
  1180     05  FILLER REDEFINES LSTNMEF.
  1181         10  LSTNMEA PIC  X(0001).
  1182     05  LSTNMEI PIC  X(0015).
  1183*    -------------------------------
  1184     05  FSTNMEL PIC S9(0004) COMP.
  1185     05  FSTNMEF PIC  X(0001).
  1186     05  FILLER REDEFINES FSTNMEF.
  1187         10  FSTNMEA PIC  X(0001).
  1188     05  FSTNMEI PIC  X(0012).
  1189*    -------------------------------
  1190     05  INITL PIC S9(0004) COMP.
  1191     05  INITF PIC  X(0001).
  1192     05  FILLER REDEFINES INITF.
  1193         10  INITA PIC  X(0001).
  1194     05  INITI PIC  X(0001).
  1195*    -------------------------------
  1196     05  LOANNOL PIC S9(0004) COMP.
  1197     05  LOANNOF PIC  X(0001).
  1198     05  FILLER REDEFINES LOANNOF.
  1199         10  LOANNOA PIC  X(0001).
  1200     05  LOANNOI PIC  X(0008).
  1201*    -------------------------------
  1202     05  CRTLNMEL PIC S9(0004) COMP.
  1203     05  CRTLNMEF PIC  X(0001).
  1204     05  FILLER REDEFINES CRTLNMEF.
  1205         10  CRTLNMEA PIC  X(0001).
  1206     05  CRTLNMEI PIC  X(0015).
  1207*    -------------------------------
  1208     05  CRTFNMEL PIC S9(0004) COMP.
  1209     05  CRTFNMEF PIC  X(0001).
  1210     05  FILLER REDEFINES CRTFNMEF.
  1211         10  CRTFNMEA PIC  X(0001).
  1212     05  CRTFNMEI PIC  X(0012).
  1213*    -------------------------------
  1214     05  CRTINITL PIC S9(0004) COMP.
  1215     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  27
* EL130.cbl
  1216     05  FILLER REDEFINES CRTINITF.
  1217         10  CRTINITA PIC  X(0001).
  1218     05  CRTINITI PIC  X(0001).
  1219*    -------------------------------
  1220     05  LOANBALL PIC S9(0004) COMP.
  1221     05  LOANBALF PIC  X(0001).
  1222     05  FILLER REDEFINES LOANBALF.
  1223         10  LOANBALA PIC  X(0001).
  1224     05  LOANBALI PIC  9(7)V99.
  1225*    -------------------------------
  1226     05  MANRSVL PIC S9(0004) COMP.
  1227     05  MANRSVF PIC  X(0001).
  1228     05  FILLER REDEFINES MANRSVF.
  1229         10  MANRSVA PIC  X(0001).
  1230     05  MANRSVI PIC  9(7)V99.
  1231*    -------------------------------
  1232     05  SUPVL PIC S9(0004) COMP.
  1233     05  SUPVF PIC  X(0001).
  1234     05  FILLER REDEFINES SUPVF.
  1235         10  SUPVA PIC  X(0001).
  1236     05  SUPVI PIC  X(0001).
  1237*    -------------------------------
  1238     05  PRICDL PIC S9(0004) COMP.
  1239     05  PRICDF PIC  X(0001).
  1240     05  FILLER REDEFINES PRICDF.
  1241         10  PRICDA PIC  X(0001).
  1242     05  PRICDI PIC  X(0001).
  1243*    -------------------------------
  1244     05  PRODL PIC S9(0004) COMP.
  1245     05  PRODF PIC  X(0001).
  1246     05  FILLER REDEFINES PRODF.
  1247         10  PRODA PIC  X(0001).
  1248     05  PRODI PIC  X(0008).
  1249*    -------------------------------
  1250     05  PRODCDL PIC S9(0004) COMP.
  1251     05  PRODCDF PIC  X(0001).
  1252     05  FILLER REDEFINES PRODCDF.
  1253         10  PRODCDA PIC  X(0001).
  1254     05  PRODCDI PIC  X(0001).
  1255*    -------------------------------
  1256     05  FILETOL PIC S9(0004) COMP.
  1257     05  FILETOF PIC  X(0001).
  1258     05  FILLER REDEFINES FILETOF.
  1259         10  FILETOA PIC  X(0001).
  1260     05  FILETOI PIC  X(0004).
  1261*    -------------------------------
  1262     05  PROCCDL PIC S9(0004) COMP.
  1263     05  PROCCDF PIC  X(0001).
  1264     05  FILLER REDEFINES PROCCDF.
  1265         10  PROCCDA PIC  X(0001).
  1266     05  PROCCDI PIC  X(0004).
  1267*    -------------------------------
  1268     05  RELCLML PIC S9(0004) COMP.
  1269     05  RELCLMF PIC  X(0001).
  1270     05  FILLER REDEFINES RELCLMF.
  1271         10  RELCLMA PIC  X(0001).
  1272     05  RELCLMI PIC  X(0007).
  1273*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  28
* EL130.cbl
  1274     05  PRTOPTL PIC S9(0004) COMP.
  1275     05  PRTOPTF PIC  X(0001).
  1276     05  FILLER REDEFINES PRTOPTF.
  1277         10  PRTOPTA PIC  X(0001).
  1278     05  PRTOPTI PIC  X(0001).
  1279*    -------------------------------
  1280     05  ALTPRTL PIC S9(0004) COMP.
  1281     05  ALTPRTF PIC  X(0001).
  1282     05  FILLER REDEFINES ALTPRTF.
  1283         10  ALTPRTA PIC  X(0001).
  1284     05  ALTPRTI PIC  X(0004).
  1285*    -------------------------------
  1286     05  CERTMTL PIC S9(0004) COMP.
  1287     05  CERTMTF PIC  X(0001).
  1288     05  FILLER REDEFINES CERTMTF.
  1289         10  CERTMTA PIC  X(0001).
  1290     05  CERTMTI PIC  X(0001).
  1291*    -------------------------------
  1292     05  CRTCARRL PIC S9(0004) COMP.
  1293     05  CRTCARRF PIC  X(0001).
  1294     05  FILLER REDEFINES CRTCARRF.
  1295         10  CRTCARRA PIC  X(0001).
  1296     05  CRTCARRI PIC  X(0001).
  1297*    -------------------------------
  1298     05  GROUPL PIC S9(0004) COMP.
  1299     05  GROUPF PIC  X(0001).
  1300     05  FILLER REDEFINES GROUPF.
  1301         10  GROUPA PIC  X(0001).
  1302     05  GROUPI PIC  X(0006).
  1303*    -------------------------------
  1304     05  STATEL PIC S9(0004) COMP.
  1305     05  STATEF PIC  X(0001).
  1306     05  FILLER REDEFINES STATEF.
  1307         10  STATEA PIC  X(0001).
  1308     05  STATEI PIC  X(0002).
  1309*    -------------------------------
  1310     05  ACCOUNTL PIC S9(0004) COMP.
  1311     05  ACCOUNTF PIC  X(0001).
  1312     05  FILLER REDEFINES ACCOUNTF.
  1313         10  ACCOUNTA PIC  X(0001).
  1314     05  ACCOUNTI PIC  X(0010).
  1315*    -------------------------------
  1316     05  EFFDTL PIC S9(0004) COMP.
  1317     05  EFFDTF PIC  X(0001).
  1318     05  FILLER REDEFINES EFFDTF.
  1319         10  EFFDTA PIC  X(0001).
  1320     05  EFFDTI PIC  X(0008).
  1321*    -------------------------------
  1322     05  CRTSSNL PIC S9(0004) COMP.
  1323     05  CRTSSNF PIC  X(0001).
  1324     05  FILLER REDEFINES CRTSSNF.
  1325         10  CRTSSNA PIC  X(0001).
  1326     05  CRTSSNI PIC  X(0011).
  1327*    -------------------------------
  1328     05  MEMCAPL PIC S9(0004) COMP.
  1329     05  MEMCAPF PIC  X(0001).
  1330     05  FILLER REDEFINES MEMCAPF.
  1331         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  29
* EL130.cbl
  1332     05  MEMCAPI PIC  X(0010).
  1333*    -------------------------------
  1334     05  MEMBERL PIC S9(0004) COMP.
  1335     05  MEMBERF PIC  X(0001).
  1336     05  FILLER REDEFINES MEMBERF.
  1337         10  MEMBERA PIC  X(0001).
  1338     05  MEMBERI PIC  X(0012).
  1339*    -------------------------------
  1340     05  REINCDL PIC S9(0004) COMP.
  1341     05  REINCDF PIC  X(0001).
  1342     05  FILLER REDEFINES REINCDF.
  1343         10  REINCDA PIC  X(0001).
  1344     05  REINCDI PIC  X(0001).
  1345*    -------------------------------
  1346     05  ISSAGEL PIC S9(0004) COMP.
  1347     05  ISSAGEF PIC  X(0001).
  1348     05  FILLER REDEFINES ISSAGEF.
  1349         10  ISSAGEA PIC  X(0001).
  1350     05  ISSAGEI PIC  X(0002).
  1351*    -------------------------------
  1352     05  APRL PIC S9(0004) COMP.
  1353     05  APRF PIC  X(0001).
  1354     05  FILLER REDEFINES APRF.
  1355         10  APRA PIC  X(0001).
  1356     05  APRI PIC  9(4)V9(4).
  1357*    -------------------------------
  1358     05  PMTFREQL PIC S9(0004) COMP.
  1359     05  PMTFREQF PIC  X(0001).
  1360     05  FILLER REDEFINES PMTFREQF.
  1361         10  PMTFREQA PIC  X(0001).
  1362     05  PMTFREQI PIC  99.
  1363*    -------------------------------
  1364     05  INDGRPL PIC S9(0004) COMP.
  1365     05  INDGRPF PIC  X(0001).
  1366     05  FILLER REDEFINES INDGRPF.
  1367         10  INDGRPA PIC  X(0001).
  1368     05  INDGRPI PIC  X(0001).
  1369*    -------------------------------
  1370     05  PREMTYPL PIC S9(0004) COMP.
  1371     05  PREMTYPF PIC  X(0001).
  1372     05  FILLER REDEFINES PREMTYPF.
  1373         10  PREMTYPA PIC  X(0001).
  1374     05  PREMTYPI PIC  X(0001).
  1375*    -------------------------------
  1376     05  ADDONDTL PIC S9(0004) COMP.
  1377     05  ADDONDTF PIC  X(0001).
  1378     05  FILLER REDEFINES ADDONDTF.
  1379         10  ADDONDTA PIC  X(0001).
  1380     05  ADDONDTI PIC  X(0008).
  1381*    -------------------------------
  1382     05  JNTLNMEL PIC S9(0004) COMP.
  1383     05  JNTLNMEF PIC  X(0001).
  1384     05  FILLER REDEFINES JNTLNMEF.
  1385         10  JNTLNMEA PIC  X(0001).
  1386     05  JNTLNMEI PIC  X(0015).
  1387*    -------------------------------
  1388     05  JNTFNMEL PIC S9(0004) COMP.
  1389     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  30
* EL130.cbl
  1390     05  FILLER REDEFINES JNTFNMEF.
  1391         10  JNTFNMEA PIC  X(0001).
  1392     05  JNTFNMEI PIC  X(0002).
  1393*    -------------------------------
  1394     05  JNTINITL PIC S9(0004) COMP.
  1395     05  JNTINITF PIC  X(0001).
  1396     05  FILLER REDEFINES JNTINITF.
  1397         10  JNTINITA PIC  X(0001).
  1398     05  JNTINITI PIC  X(0001).
  1399*    -------------------------------
  1400     05  JNTAGEL PIC S9(0004) COMP.
  1401     05  JNTAGEF PIC  X(0001).
  1402     05  FILLER REDEFINES JNTAGEF.
  1403         10  JNTAGEA PIC  X(0001).
  1404     05  JNTAGEI PIC  X(0002).
  1405*    -------------------------------
  1406     05  LCVDSCRL PIC S9(0004) COMP.
  1407     05  LCVDSCRF PIC  X(0001).
  1408     05  FILLER REDEFINES LCVDSCRF.
  1409         10  LCVDSCRA PIC  X(0001).
  1410     05  LCVDSCRI PIC  X(0006).
  1411*    -------------------------------
  1412     05  LCVKINDL PIC S9(0004) COMP.
  1413     05  LCVKINDF PIC  X(0001).
  1414     05  FILLER REDEFINES LCVKINDF.
  1415         10  LCVKINDA PIC  X(0001).
  1416     05  LCVKINDI PIC  X(0003).
  1417*    -------------------------------
  1418     05  LCVCDL PIC S9(0004) COMP.
  1419     05  LCVCDF PIC  X(0001).
  1420     05  FILLER REDEFINES LCVCDF.
  1421         10  LCVCDA PIC  X(0001).
  1422     05  LCVCDI PIC  X(0002).
  1423*    -------------------------------
  1424     05  LCVOTRML PIC S9(0004) COMP.
  1425     05  LCVOTRMF PIC  X(0001).
  1426     05  FILLER REDEFINES LCVOTRMF.
  1427         10  LCVOTRMA PIC  X(0001).
  1428     05  LCVOTRMI PIC  999.
  1429*    -------------------------------
  1430     05  LCVRTRML PIC S9(0004) COMP.
  1431     05  LCVRTRMF PIC  X(0001).
  1432     05  FILLER REDEFINES LCVRTRMF.
  1433         10  LCVRTRMA PIC  X(0001).
  1434     05  LCVRTRMI PIC  X(0003).
  1435*    -------------------------------
  1436     05  LCVRATEL PIC S9(0004) COMP.
  1437     05  LCVRATEF PIC  X(0001).
  1438     05  FILLER REDEFINES LCVRATEF.
  1439         10  LCVRATEA PIC  X(0001).
  1440     05  LCVRATEI PIC  9999V99.
  1441*    -------------------------------
  1442     05  LCVBENEL PIC S9(0004) COMP.
  1443     05  LCVBENEF PIC  X(0001).
  1444     05  FILLER REDEFINES LCVBENEF.
  1445         10  LCVBENEA PIC  X(0001).
  1446     05  LCVBENEI PIC  9(9)V99.
  1447*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  31
* EL130.cbl
  1448     05  LCVFORML PIC S9(0004) COMP.
  1449     05  LCVFORMF PIC  X(0001).
  1450     05  FILLER REDEFINES LCVFORMF.
  1451         10  LCVFORMA PIC  X(0001).
  1452     05  LCVFORMI PIC  X(0012).
  1453*    -------------------------------
  1454     05  LCVCNDTL PIC S9(0004) COMP.
  1455     05  LCVCNDTF PIC  X(0001).
  1456     05  FILLER REDEFINES LCVCNDTF.
  1457         10  LCVCNDTA PIC  X(0001).
  1458     05  LCVCNDTI PIC  X(0008).
  1459*    -------------------------------
  1460     05  LCVEXITL PIC S9(0004) COMP.
  1461     05  LCVEXITF PIC  X(0001).
  1462     05  FILLER REDEFINES LCVEXITF.
  1463         10  LCVEXITA PIC  X(0001).
  1464     05  LCVEXITI PIC  X(0008).
  1465*    -------------------------------
  1466     05  LCVSTATL PIC S9(0004) COMP.
  1467     05  LCVSTATF PIC  X(0001).
  1468     05  FILLER REDEFINES LCVSTATF.
  1469         10  LCVSTATA PIC  X(0001).
  1470     05  LCVSTATI PIC  X(0006).
  1471*    -------------------------------
  1472     05  ACVDSCRL PIC S9(0004) COMP.
  1473     05  ACVDSCRF PIC  X(0001).
  1474     05  FILLER REDEFINES ACVDSCRF.
  1475         10  ACVDSCRA PIC  X(0001).
  1476     05  ACVDSCRI PIC  X(0006).
  1477*    -------------------------------
  1478     05  ACVKINDL PIC S9(0004) COMP.
  1479     05  ACVKINDF PIC  X(0001).
  1480     05  FILLER REDEFINES ACVKINDF.
  1481         10  ACVKINDA PIC  X(0001).
  1482     05  ACVKINDI PIC  X(0003).
  1483*    -------------------------------
  1484     05  ACVCDL PIC S9(0004) COMP.
  1485     05  ACVCDF PIC  X(0001).
  1486     05  FILLER REDEFINES ACVCDF.
  1487         10  ACVCDA PIC  X(0001).
  1488     05  ACVCDI PIC  X(0002).
  1489*    -------------------------------
  1490     05  ACVOTRML PIC S9(0004) COMP.
  1491     05  ACVOTRMF PIC  X(0001).
  1492     05  FILLER REDEFINES ACVOTRMF.
  1493         10  ACVOTRMA PIC  X(0001).
  1494     05  ACVOTRMI PIC  999.
  1495*    -------------------------------
  1496     05  ACVRTRML PIC S9(0004) COMP.
  1497     05  ACVRTRMF PIC  X(0001).
  1498     05  FILLER REDEFINES ACVRTRMF.
  1499         10  ACVRTRMA PIC  X(0001).
  1500     05  ACVRTRMI PIC  X(0003).
  1501*    -------------------------------
  1502     05  ACVRATEL PIC S9(0004) COMP.
  1503     05  ACVRATEF PIC  X(0001).
  1504     05  FILLER REDEFINES ACVRATEF.
  1505         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  32
* EL130.cbl
  1506     05  ACVRATEI PIC  9999V99.
  1507*    -------------------------------
  1508     05  ACVBENEL PIC S9(0004) COMP.
  1509     05  ACVBENEF PIC  X(0001).
  1510     05  FILLER REDEFINES ACVBENEF.
  1511         10  ACVBENEA PIC  X(0001).
  1512     05  ACVBENEI PIC  9(9)V99.
  1513*    -------------------------------
  1514     05  ACVFORML PIC S9(0004) COMP.
  1515     05  ACVFORMF PIC  X(0001).
  1516     05  FILLER REDEFINES ACVFORMF.
  1517         10  ACVFORMA PIC  X(0001).
  1518     05  ACVFORMI PIC  X(0012).
  1519*    -------------------------------
  1520     05  ACVCNDTL PIC S9(0004) COMP.
  1521     05  ACVCNDTF PIC  X(0001).
  1522     05  FILLER REDEFINES ACVCNDTF.
  1523         10  ACVCNDTA PIC  X(0001).
  1524     05  ACVCNDTI PIC  X(0008).
  1525*    -------------------------------
  1526     05  ACVEXITL PIC S9(0004) COMP.
  1527     05  ACVEXITF PIC  X(0001).
  1528     05  FILLER REDEFINES ACVEXITF.
  1529         10  ACVEXITA PIC  X(0001).
  1530     05  ACVEXITI PIC  X(0008).
  1531*    -------------------------------
  1532     05  ACVSTATL PIC S9(0004) COMP.
  1533     05  ACVSTATF PIC  X(0001).
  1534     05  FILLER REDEFINES ACVSTATF.
  1535         10  ACVSTATA PIC  X(0001).
  1536     05  ACVSTATI PIC  X(0006).
  1537*    -------------------------------
  1538     05  ERRMSG1L PIC S9(0004) COMP.
  1539     05  ERRMSG1F PIC  X(0001).
  1540     05  FILLER REDEFINES ERRMSG1F.
  1541         10  ERRMSG1A PIC  X(0001).
  1542     05  ERRMSG1I PIC  X(0072).
  1543*    -------------------------------
  1544     05  ERRMSG2L PIC S9(0004) COMP.
  1545     05  ERRMSG2F PIC  X(0001).
  1546     05  FILLER REDEFINES ERRMSG2F.
  1547         10  ERRMSG2A PIC  X(0001).
  1548     05  ERRMSG2I PIC  X(0072).
  1549*    -------------------------------
  1550     05  BCERT1L PIC S9(0004) COMP.
  1551     05  BCERT1F PIC  X(0001).
  1552     05  FILLER REDEFINES BCERT1F.
  1553         10  BCERT1A PIC  X(0001).
  1554     05  BCERT1I PIC  X(0010).
  1555*    -------------------------------
  1556     05  BSUFX1L PIC S9(0004) COMP.
  1557     05  BSUFX1F PIC  X(0001).
  1558     05  FILLER REDEFINES BSUFX1F.
  1559         10  BSUFX1A PIC  X(0001).
  1560     05  BSUFX1I PIC  X(0001).
  1561*    -------------------------------
  1562     05  BCERT2L PIC S9(0004) COMP.
  1563     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  33
* EL130.cbl
  1564     05  FILLER REDEFINES BCERT2F.
  1565         10  BCERT2A PIC  X(0001).
  1566     05  BCERT2I PIC  X(0010).
  1567*    -------------------------------
  1568     05  BSUFX2L PIC S9(0004) COMP.
  1569     05  BSUFX2F PIC  X(0001).
  1570     05  FILLER REDEFINES BSUFX2F.
  1571         10  BSUFX2A PIC  X(0001).
  1572     05  BSUFX2I PIC  X(0001).
  1573*    -------------------------------
  1574     05  BCERT3L PIC S9(0004) COMP.
  1575     05  BCERT3F PIC  X(0001).
  1576     05  FILLER REDEFINES BCERT3F.
  1577         10  BCERT3A PIC  X(0001).
  1578     05  BCERT3I PIC  X(0010).
  1579*    -------------------------------
  1580     05  BSUFX3L PIC S9(0004) COMP.
  1581     05  BSUFX3F PIC  X(0001).
  1582     05  FILLER REDEFINES BSUFX3F.
  1583         10  BSUFX3A PIC  X(0001).
  1584     05  BSUFX3I PIC  X(0001).
  1585*    -------------------------------
  1586     05  BCERT4L PIC S9(0004) COMP.
  1587     05  BCERT4F PIC  X(0001).
  1588     05  FILLER REDEFINES BCERT4F.
  1589         10  BCERT4A PIC  X(0001).
  1590     05  BCERT4I PIC  X(0010).
  1591*    -------------------------------
  1592     05  BSUFX4L PIC S9(0004) COMP.
  1593     05  BSUFX4F PIC  X(0001).
  1594     05  FILLER REDEFINES BSUFX4F.
  1595         10  BSUFX4A PIC  X(0001).
  1596     05  BSUFX4I PIC  X(0001).
  1597*    -------------------------------
  1598     05  BCERT5L PIC S9(0004) COMP.
  1599     05  BCERT5F PIC  X(0001).
  1600     05  FILLER REDEFINES BCERT5F.
  1601         10  BCERT5A PIC  X(0001).
  1602     05  BCERT5I PIC  X(0010).
  1603*    -------------------------------
  1604     05  BSUFX5L PIC S9(0004) COMP.
  1605     05  BSUFX5F PIC  X(0001).
  1606     05  FILLER REDEFINES BSUFX5F.
  1607         10  BSUFX5A PIC  X(0001).
  1608     05  BSUFX5I PIC  X(0001).
  1609*    -------------------------------
  1610     05  ENTERPFL PIC S9(0004) COMP.
  1611     05  ENTERPFF PIC  X(0001).
  1612     05  FILLER REDEFINES ENTERPFF.
  1613         10  ENTERPFA PIC  X(0001).
  1614     05  ENTERPFI PIC  99.
  1615*    -------------------------------
  1616     05  PF5L PIC S9(0004) COMP.
  1617     05  PF5F PIC  X(0001).
  1618     05  FILLER REDEFINES PF5F.
  1619         10  PF5A PIC  X(0001).
  1620     05  PF5I PIC  X(0013).
  1621 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  34
* EL130.cbl
  1622     05  FILLER            PIC  X(0012).
  1623*    -------------------------------
  1624     05  FILLER            PIC  X(0003).
  1625     05  RUNDTEO PIC  X(0008).
  1626*    -------------------------------
  1627     05  FILLER            PIC  X(0003).
  1628     05  RUNTIMEO PIC  99.99.
  1629*    -------------------------------
  1630     05  FILLER            PIC  X(0003).
  1631     05  COMPO PIC  X(0003).
  1632*    -------------------------------
  1633     05  FILLER            PIC  X(0003).
  1634     05  SEQUO PIC  X(0010).
  1635*    -------------------------------
  1636     05  FILLER            PIC  X(0003).
  1637     05  MAINTO PIC  X(0001).
  1638*    -------------------------------
  1639     05  FILLER            PIC  X(0003).
  1640     05  CLMNOO PIC  X(0007).
  1641*    -------------------------------
  1642     05  FILLER            PIC  X(0003).
  1643     05  CLMCARRO PIC  X(0001).
  1644*    -------------------------------
  1645     05  FILLER            PIC  X(0003).
  1646     05  CLMTYPEO PIC  X(0001).
  1647*    -------------------------------
  1648     05  FILLER            PIC  X(0003).
  1649     05  CERTNOO PIC  X(0010).
  1650*    -------------------------------
  1651     05  FILLER            PIC  X(0003).
  1652     05  SUFXO PIC  X(0001).
  1653*    -------------------------------
  1654     05  FILLER            PIC  X(0003).
  1655     05  PCERTNOO PIC  X(0010).
  1656*    -------------------------------
  1657     05  FILLER            PIC  X(0003).
  1658     05  PSUFXO PIC  X(0001).
  1659*    -------------------------------
  1660     05  FILLER            PIC  X(0003).
  1661     05  INCURO PIC  X(0008).
  1662*    -------------------------------
  1663     05  FILLER            PIC  X(0003).
  1664     05  REPORTO PIC  X(0008).
  1665*    -------------------------------
  1666     05  FILLER            PIC  X(0003).
  1667     05  CAUSEO PIC  X(0006).
  1668*    -------------------------------
  1669     05  FILLER            PIC  X(0003).
  1670     05  ESTENDO PIC  X(0008).
  1671*    -------------------------------
  1672     05  FILLER            PIC  X(0003).
  1673     05  DIAGO PIC  X(0060).
  1674*    -------------------------------
  1675     05  FILLER            PIC  X(0003).
  1676     05  BENECDO PIC  X(0010).
  1677*    -------------------------------
  1678     05  FILLER            PIC  X(0003).
  1679     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  35
* EL130.cbl
  1680*    -------------------------------
  1681     05  FILLER            PIC  X(0003).
  1682     05  SSNO PIC  X(0011).
  1683*    -------------------------------
  1684     05  FILLER            PIC  X(0003).
  1685     05  SEXO PIC  X(0001).
  1686*    -------------------------------
  1687     05  FILLER            PIC  X(0003).
  1688     05  OCCCDO PIC  X(0006).
  1689*    -------------------------------
  1690     05  FILLER            PIC  X(0003).
  1691     05  LSTNMEO PIC  X(0015).
  1692*    -------------------------------
  1693     05  FILLER            PIC  X(0003).
  1694     05  FSTNMEO PIC  X(0012).
  1695*    -------------------------------
  1696     05  FILLER            PIC  X(0003).
  1697     05  INITO PIC  X(0001).
  1698*    -------------------------------
  1699     05  FILLER            PIC  X(0003).
  1700     05  LOANNOO PIC  X(0008).
  1701*    -------------------------------
  1702     05  FILLER            PIC  X(0003).
  1703     05  CRTLNMEO PIC  X(0015).
  1704*    -------------------------------
  1705     05  FILLER            PIC  X(0003).
  1706     05  CRTFNMEO PIC  X(0012).
  1707*    -------------------------------
  1708     05  FILLER            PIC  X(0003).
  1709     05  CRTINITO PIC  X(0001).
  1710*    -------------------------------
  1711     05  FILLER            PIC  X(0003).
  1712     05  LOANBALO PIC  ZZZZZ9.99.
  1713*    -------------------------------
  1714     05  FILLER            PIC  X(0003).
  1715     05  MANRSVO PIC  Z(5)9.99.
  1716*    -------------------------------
  1717     05  FILLER            PIC  X(0003).
  1718     05  SUPVO PIC  X(0001).
  1719*    -------------------------------
  1720     05  FILLER            PIC  X(0003).
  1721     05  PRICDO PIC  X(0001).
  1722*    -------------------------------
  1723     05  FILLER            PIC  X(0003).
  1724     05  PRODO PIC  X(0008).
  1725*    -------------------------------
  1726     05  FILLER            PIC  X(0003).
  1727     05  PRODCDO PIC  X(0001).
  1728*    -------------------------------
  1729     05  FILLER            PIC  X(0003).
  1730     05  FILETOO PIC  X(0004).
  1731*    -------------------------------
  1732     05  FILLER            PIC  X(0003).
  1733     05  PROCCDO PIC  X(0004).
  1734*    -------------------------------
  1735     05  FILLER            PIC  X(0003).
  1736     05  RELCLMO PIC  X(0007).
  1737*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  36
* EL130.cbl
  1738     05  FILLER            PIC  X(0003).
  1739     05  PRTOPTO PIC  X(0001).
  1740*    -------------------------------
  1741     05  FILLER            PIC  X(0003).
  1742     05  ALTPRTO PIC  X(0004).
  1743*    -------------------------------
  1744     05  FILLER            PIC  X(0003).
  1745     05  CERTMTO PIC  X(0001).
  1746*    -------------------------------
  1747     05  FILLER            PIC  X(0003).
  1748     05  CRTCARRO PIC  X(0001).
  1749*    -------------------------------
  1750     05  FILLER            PIC  X(0003).
  1751     05  GROUPO PIC  X(0006).
  1752*    -------------------------------
  1753     05  FILLER            PIC  X(0003).
  1754     05  STATEO PIC  X(0002).
  1755*    -------------------------------
  1756     05  FILLER            PIC  X(0003).
  1757     05  ACCOUNTO PIC  X(0010).
  1758*    -------------------------------
  1759     05  FILLER            PIC  X(0003).
  1760     05  EFFDTO PIC  X(0008).
  1761*    -------------------------------
  1762     05  FILLER            PIC  X(0003).
  1763     05  CRTSSNO PIC  X(0011).
  1764*    -------------------------------
  1765     05  FILLER            PIC  X(0003).
  1766     05  MEMCAPO PIC  X(0010).
  1767*    -------------------------------
  1768     05  FILLER            PIC  X(0003).
  1769     05  MEMBERO PIC  X(0012).
  1770*    -------------------------------
  1771     05  FILLER            PIC  X(0003).
  1772     05  REINCDO PIC  X(0001).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  ISSAGEO PIC  X(0002).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  APRO PIC  9(3).9(4).
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  PMTFREQO PIC  99.
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  INDGRPO PIC  X(0001).
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
  1787     05  PREMTYPO PIC  X(0001).
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
  1790     05  ADDONDTO PIC  X(0008).
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  JNTLNMEO PIC  X(0015).
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  37
* EL130.cbl
  1796     05  JNTFNMEO PIC  X(0002).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  JNTINITO PIC  X(0001).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  JNTAGEO PIC  X(0002).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  LCVDSCRO PIC  X(0006).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  LCVKINDO PIC  X(0003).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  LCVCDO PIC  X(0002).
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  LCVOTRMO PIC  999.
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  LCVRTRMO PIC  ZZZ.
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  LCVRATEO PIC  ZZZ.ZZ.
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  LCVFORMO PIC  X(0012).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  LCVCNDTO PIC  X(0008).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  LCVEXITO PIC  X(0008).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  LCVSTATO PIC  X(0006).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  ACVDSCRO PIC  X(0006).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  ACVKINDO PIC  X(0003).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  ACVCDO PIC  X(0002).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  ACVOTRMO PIC  999.
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  ACVRTRMO PIC  ZZZ.
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  38
* EL130.cbl
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  ACVFORMO PIC  X(0012).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  ACVCNDTO PIC  X(0008).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  ACVEXITO PIC  X(0008).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  ACVSTATO PIC  X(0006).
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  ERRMSG1O PIC  X(0072).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  ERRMSG2O PIC  X(0072).
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  BCERT1O PIC  X(0010).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  BSUFX1O PIC  X(0001).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  BCERT2O PIC  X(0010).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  BSUFX2O PIC  X(0001).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  BCERT3O PIC  X(0010).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  BSUFX3O PIC  X(0001).
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  BCERT4O PIC  X(0010).
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  BSUFX4O PIC  X(0001).
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  BCERT5O PIC  X(0010).
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  BSUFX5O PIC  X(0001).
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  ENTERPFO PIC  X(0002).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  PF5O PIC  X(0013).
  1911*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  39
* EL130.cbl
  1913*    COPY ELCDATE.
  1914******************************************************************
  1915*                                                                *
  1916*                                                                *
  1917*                            ELCDATE.                            *
  1918*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1919*                            VMOD=2.003
  1920*                                                                *
  1921*                                                                *
  1922*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1923*                 LENGTH = 200                                   *
  1924******************************************************************
  1925
  1926 01  DATE-CONVERSION-DATA.
  1927     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1928     12  DC-OPTION-CODE                PIC X.
  1929         88  BIN-TO-GREG                VALUE ' '.
  1930         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1931         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1932         88  YMD-GREG-TO-BIN            VALUE '3'.
  1933         88  MDY-GREG-TO-BIN            VALUE '4'.
  1934         88  JULIAN-TO-BIN              VALUE '5'.
  1935         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1936         88  FIND-CENTURY               VALUE '7'.
  1937         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1938         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1939         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1940         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1941         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1942         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1943         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1944         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1945         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1946         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1947         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1948         88  BIN-3-TO-GREG              VALUE 'I'.
  1949         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1950         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1951         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1952         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1953         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1954         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1955         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1956         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1957         88  THREE-CHARACTER-BIN
  1958                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1959         88  GREGORIAN-TO-BIN
  1960                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1961         88  BIN-TO-GREGORIAN
  1962                  VALUES ' ' '1' 'I' '8' 'G'.
  1963         88  JULIAN-TO-BINARY
  1964                  VALUES '5' 'C' 'E' 'F'.
  1965     12  DC-ERROR-CODE                 PIC X.
  1966         88  NO-CONVERSION-ERROR        VALUE ' '.
  1967         88  DATE-CONVERSION-ERROR
  1968                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1969         88  DATE-IS-ZERO               VALUE '1'.
  1970         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  40
* EL130.cbl
  1971         88  DATE-IS-INVALID            VALUE '3'.
  1972         88  DATE1-GREATER-DATE2        VALUE '4'.
  1973         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1974         88  DATE-INVALID-OPTION        VALUE '9'.
  1975         88  INVALID-CENTURY            VALUE 'A'.
  1976         88  ONLY-CENTURY               VALUE 'B'.
  1977         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1978         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1979     12  DC-END-OF-MONTH               PIC X.
  1980         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1981     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1982         88  USE-NORMAL-PROCESS         VALUE ' '.
  1983         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1984         88  ADJUST-UP-100-YRS          VALUE '2'.
  1985     12  FILLER                        PIC X.
  1986     12  DC-CONVERSION-DATES.
  1987         16  DC-BIN-DATE-1             PIC XX.
  1988         16  DC-BIN-DATE-2             PIC XX.
  1989         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1990         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1991                       DC-GREG-DATE-1-EDIT.
  1992             20  DC-EDIT1-MONTH        PIC 99.
  1993             20  SLASH1-1              PIC X.
  1994             20  DC-EDIT1-DAY          PIC 99.
  1995             20  SLASH1-2              PIC X.
  1996             20  DC-EDIT1-YEAR         PIC 99.
  1997         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1998         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1999                     DC-GREG-DATE-2-EDIT.
  2000             20  DC-EDIT2-MONTH        PIC 99.
  2001             20  SLASH2-1              PIC X.
  2002             20  DC-EDIT2-DAY          PIC 99.
  2003             20  SLASH2-2              PIC X.
  2004             20  DC-EDIT2-YEAR         PIC 99.
  2005         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2006         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2007                     DC-GREG-DATE-1-YMD.
  2008             20  DC-YMD-YEAR           PIC 99.
  2009             20  DC-YMD-MONTH          PIC 99.
  2010             20  DC-YMD-DAY            PIC 99.
  2011         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2012         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2013                      DC-GREG-DATE-1-MDY.
  2014             20  DC-MDY-MONTH          PIC 99.
  2015             20  DC-MDY-DAY            PIC 99.
  2016             20  DC-MDY-YEAR           PIC 99.
  2017         16  DC-GREG-DATE-1-ALPHA.
  2018             20  DC-ALPHA-MONTH        PIC X(10).
  2019             20  DC-ALPHA-DAY          PIC 99.
  2020             20  FILLER                PIC XX.
  2021             20  DC-ALPHA-CENTURY.
  2022                 24 DC-ALPHA-CEN-N     PIC 99.
  2023             20  DC-ALPHA-YEAR         PIC 99.
  2024         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2025         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2026         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2027         16  DC-JULIAN-DATE            PIC 9(05).
  2028         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  41
* EL130.cbl
  2029                                       PIC 9(05).
  2030         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2031             20  DC-JULIAN-YEAR        PIC 99.
  2032             20  DC-JULIAN-DAYS        PIC 999.
  2033         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2034         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2035         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2036     12  DATE-CONVERSION-VARIBLES.
  2037         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2038         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2039             20  FILLER                PIC 9(3).
  2040             20  HOLD-CEN-1-CCYY.
  2041                 24  HOLD-CEN-1-CC     PIC 99.
  2042                 24  HOLD-CEN-1-YY     PIC 99.
  2043             20  HOLD-CEN-1-MO         PIC 99.
  2044             20  HOLD-CEN-1-DA         PIC 99.
  2045         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2046             20  HOLD-CEN-1-R-MO       PIC 99.
  2047             20  HOLD-CEN-1-R-DA       PIC 99.
  2048             20  HOLD-CEN-1-R-CCYY.
  2049                 24  HOLD-CEN-1-R-CC   PIC 99.
  2050                 24  HOLD-CEN-1-R-YY   PIC 99.
  2051             20  FILLER                PIC 9(3).
  2052         16  HOLD-CENTURY-1-X.
  2053             20  FILLER                PIC X(3)  VALUE SPACES.
  2054             20  HOLD-CEN-1-X-CCYY.
  2055                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2056                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2057             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2058             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2059         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2060             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2061             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2062             20  HOLD-CEN-1-R-X-CCYY.
  2063                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2064                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2065             20  FILLER                PIC XXX.
  2066         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2067         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2068         16  DC-JULIAN-DATE-1          PIC 9(07).
  2069         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2070             20  DC-JULIAN-1-CCYY.
  2071                 24  DC-JULIAN-1-CC    PIC 99.
  2072                 24  DC-JULIAN-1-YR    PIC 99.
  2073             20  DC-JULIAN-DA-1        PIC 999.
  2074         16  DC-JULIAN-DATE-2          PIC 9(07).
  2075         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2076             20  DC-JULIAN-2-CCYY.
  2077                 24  DC-JULIAN-2-CC    PIC 99.
  2078                 24  DC-JULIAN-2-YR    PIC 99.
  2079             20  DC-JULIAN-DA-2        PIC 999.
  2080         16  DC-GREG-DATE-A-EDIT.
  2081             20  DC-EDITA-MONTH        PIC 99.
  2082             20  SLASHA-1              PIC X VALUE '/'.
  2083             20  DC-EDITA-DAY          PIC 99.
  2084             20  SLASHA-2              PIC X VALUE '/'.
  2085             20  DC-EDITA-CCYY.
  2086                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  42
* EL130.cbl
  2087                 24  DC-EDITA-YEAR     PIC 99.
  2088         16  DC-GREG-DATE-B-EDIT.
  2089             20  DC-EDITB-MONTH        PIC 99.
  2090             20  SLASHB-1              PIC X VALUE '/'.
  2091             20  DC-EDITB-DAY          PIC 99.
  2092             20  SLASHB-2              PIC X VALUE '/'.
  2093             20  DC-EDITB-CCYY.
  2094                 24  DC-EDITB-CENT     PIC 99.
  2095                 24  DC-EDITB-YEAR     PIC 99.
  2096         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2097         16  DC-GREG-DATE-CYMD-R REDEFINES
  2098                              DC-GREG-DATE-CYMD.
  2099             20  DC-CYMD-CEN           PIC 99.
  2100             20  DC-CYMD-YEAR          PIC 99.
  2101             20  DC-CYMD-MONTH         PIC 99.
  2102             20  DC-CYMD-DAY           PIC 99.
  2103         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2104         16  DC-GREG-DATE-MDCY-R REDEFINES
  2105                              DC-GREG-DATE-MDCY.
  2106             20  DC-MDCY-MONTH         PIC 99.
  2107             20  DC-MDCY-DAY           PIC 99.
  2108             20  DC-MDCY-CEN           PIC 99.
  2109             20  DC-MDCY-YEAR          PIC 99.
  2110    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2111        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2112    12  DC-EL310-DATE                  PIC X(21).
  2113    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  43
* EL130.cbl
  2115*    COPY ELCCALC.
  2116******************************************************************
  2117*                                                                *
  2118*                           ELCCALC.                            *
  2119*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2120*                            VMOD=2.025                          *
  2121*                                                                *
  2122*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2123*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2124*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2125*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2126*                                                                *
  2127*  PASSED TO ELRTRM                                              *
  2128*  -----------------                                             *
  2129*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2130*  ORIGINAL TERM                                                 *
  2131*  BEGINNING DATE                                                *
  2132*  ENDING DATE                                                   *
  2133*  COMPANY I.D.                                                  *
  2134*  ACCOUNT MASTER USER FIELD                                     *
  2135*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2136*  FREE LOOK DAYS                                                *
  2137*                                                                *
  2138*  RETURNED FROM ELRTRM                                          *
  2139*  ---------------------                                         *
  2140*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2141*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2142*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2143*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2144*----------------------------------------------------------------*
  2145*  PASSED TO ELRAMT                                              *
  2146*  ----------------                                              *
  2147*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2148*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2149*  ORIGINAL AMOUNT                                               *
  2150*  ALTERNATE BENEFIT (BALLON)                                    *
  2151*  A.P.R. - NET PAY ONLY                                         *
  2152*  METHOD
  2153*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2154*  COMPANY I.D.                                                  *
  2155*  BENEFIT TYPE                                                  *
  2156*                                                                *
  2157*  RETURNED FROM ELRAMT                                          *
  2158*  --------------------                                          *
  2159*  REMAINING AMOUNT 1 - CURRENT                                  *
  2160*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2161*  REMAINING AMOUNT FACTOR
  2162*----------------------------------------------------------------*
  2163*  PASSED TO ELRESV                                              *
  2164*  -----------------                                             *
  2165*  CERTIFICATE EFFECTIVE DATE                                    *
  2166*  VALUATION DATE                                                *
  2167*  PAID THRU DATE                                                *
  2168*  BENEFIT                                                       *
  2169*  INCURRED DATE                                                 *
  2170*  REPORTED DATE                                                 *
  2171*  ISSUE AGE                                                     *
  2172*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  44
* EL130.cbl
  2173*  CDT PERCENT                                                   *
  2174*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2175* *CLAIM TYPE (LIFE, A/H)                                        *
  2176* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2177* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2178*                                                                *
  2179*  RETURNED FROM ELRESV                                          *
  2180*  --------------------                                          *
  2181*  CDT TABLE USED                                                *
  2182*  CDT FACTOR USED                                               *
  2183*  PAY TO CURRENT RESERVE                                        *
  2184*  I.B.N.R. - A/H ONLY                                           *
  2185*  FUTURE (ACCRUED) AH ONLY                                      *
  2186*----------------------------------------------------------------*
  2187*  PASSED TO ELRATE                                              *
  2188*  ----------------                                              *
  2189*  CERT ISSUE DATE                                               *
  2190*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2191*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2192*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2193*  STATE CODE (CLIENT DEFINED)                                   *
  2194*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2195*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2196*  DEVIATION CODE                                                *
  2197*  ISSUE AGE                                                     *
  2198*  ORIGINAL BENEFIT AMOUNT                                       *
  2199*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2200*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2201*  BENEFIT KIND (LIFE OR A/H)                                    *
  2202*  A.P.R.                                                        *
  2203*  METHOD
  2204*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2205*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2206*  COMPANY I.D. (3 CHARACTER)                                    *
  2207*  BENEFIT CODE                                                  *
  2208*  BENEFIT OVERRIDE CODE                                         *
  2209*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2210*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2211*  JOINT INDICATOR (CSL ONLY)                                    *
  2212*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2213*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2214*                                                                *
  2215*  RETURNED FROM ELRATE                                          *
  2216*  --------------------                                          *
  2217*  CALCULATED PREMIUM                                            *
  2218*  PREMIUM RATE                                                  *
  2219*  MORTALITY CODE                                                *
  2220*  MAX ATTAINED AGE                                              *
  2221*  MAX AGE                                                       *
  2222*  MAX TERM                                                      *
  2223*  MAX MONTHLY BENEFIT                                           *
  2224*  MAX TOTAL BENIFIT                                             *
  2225*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2226*----------------------------------------------------------------*
  2227*  PASSED TO ELRFND                                              *
  2228*  ----------------                                              *
  2229*  CERT ISSUE DATE                                               *
  2230*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  45
* EL130.cbl
  2231*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2232*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2233*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2234*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2235*  STATE CODE (CLIENT DEFINED)                                   *
  2236*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2237*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2238*  DEVIATION CODE                                                *
  2239*  ISSUE AGE                                                     *
  2240*  ORIGINAL BENEFIT AMOUNT                                       *
  2241*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2242*  PROCESS TYPE (CANCEL)                                         *
  2243*  BENEFIT KIND (LIFE OR A/H)                                    *
  2244*  A.P.R.                                                        *
  2245*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2246*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2247*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2248*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2249*  COMPANY I.D. (3 CHARACTER)                                    *
  2250*  BENEFIT CODE                                                  *
  2251*  BENEFIT OVERRIDE CODE                                         *
  2252*                                                                *
  2253*  RETURNED FROM ELRFND                                          *
  2254*  --------------------                                          *
  2255*  CALCULATED REFUND                                             *
  2256*----------------------------------------------------------------*
  2257*  PASSED TO ELEARN                                              *
  2258*  ----------------                                              *
  2259*  CERT ISSUE DATE                                               *
  2260*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2261*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2262*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2263*  STATE CODE (CLIENT DEFINED)                                   *
  2264*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2265*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2266*  DEVIATION CODE                                                *
  2267*  ISSUE AGE                                                     *
  2268*  ORIGINAL BENEFIT AMOUNT                                       *
  2269*  BENEFIT KIND (LIFE OR A/H)                                    *
  2270*  A.P.R.                                                        *
  2271*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2272*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2273*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2274*  COMPANY I.D. (3 CHARACTER)                                    *
  2275*  BENEFIT CODE                                                  *
  2276*  BENEFIT OVERRIDE CODE                                         *
  2277*                                                                *
  2278*  RETURNED FROM ELEARN                                          *
  2279*  --------------------                                          *
  2280*  INDICATED  EARNINGS                                           *
  2281*----------------------------------------------------------------*
  2282*                 LENGTH = 450                                   *
  2283*                                                                *
  2284******************************************************************
  2285******************************************************************
  2286*                   C H A N G E   L O G
  2287*
  2288* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  46
* EL130.cbl
  2289*-----------------------------------------------------------------
  2290*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2291* EFFECTIVE    NUMBER
  2292*-----------------------------------------------------------------
  2293* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2294* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2295* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2296* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2297* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2298* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2299* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2300* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2301* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2302******************************************************************
  2303
  2304 01  CALCULATION-PASS-AREA.
  2305     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2306                                     COMP.
  2307
  2308     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2309       88  NO-CP-ERROR                             VALUE ZERO.
  2310       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2311                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2312       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2313       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2314       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2315       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2316       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2317       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2318       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2319       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2320       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2321       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2322       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2323       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2324       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2325       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2326       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2327       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2328       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2329
  2330     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2331       88  NO-CP-ERROR-2                           VALUE ZERO.
  2332***********************  INPUT AREAS ****************************
  2333
  2334     12  CP-CALCULATION-AREA.
  2335         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2336         16  CP-CERT-EFF-DT        PIC XX.
  2337         16  CP-VALUATION-DT       PIC XX.
  2338         16  CP-PAID-THRU-DT       PIC XX.
  2339         16  CP-BENEFIT-TYPE       PIC X.
  2340           88  CP-AH                               VALUE 'A' 'D'
  2341                                                   'I' 'U'.
  2342           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2343           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2344         16  CP-INCURRED-DT        PIC XX.
  2345         16  CP-REPORTED-DT        PIC XX.
  2346         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  47
* EL130.cbl
  2347         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2348         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2349                                     COMP-3.
  2350         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2351                                     COMP-3.
  2352         16  CP-CDT-METHOD         PIC X.
  2353           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2354           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2355           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2356         16  CP-CLAIM-TYPE         PIC X.
  2357           88  CP-AH-CLAIM                         VALUE 'A'.
  2358           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2359         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2360                                     COMP-3.
  2361         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2362                                     COMP-3.
  2363         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2364                                     COMP-3.
  2365         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2366                                     COMP-3.
  2367         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2368                                     COMP-3.
  2369         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2370                                     COMP-3.
  2371         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2372                                     COMP-3.
  2373         16  CP-REM-TERM-METHOD    PIC X.
  2374           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2375           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2376           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2377           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2378           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2379           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2380           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2381         16  CP-EARNING-METHOD     PIC X.
  2382           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2383           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2384           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2385           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2386           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2387           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2388           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2389           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2390           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2391           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2392           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2393           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2394           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2395           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2396         16  CP-PROCESS-TYPE       PIC X.
  2397           88  CP-CLAIM                            VALUE '1'.
  2398           88  CP-CANCEL                           VALUE '2'.
  2399           88  CP-ISSUE                            VALUE '3'.
  2400         16  CP-SPECIAL-CALC-CD    PIC X.
  2401           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2402           88  CP-1-MTH-INTEREST               VALUE ' '.
  2403           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2404           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  48
* EL130.cbl
  2405           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2406           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2407           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2408           88  CP-FARM-PLAN                    VALUE 'F'.
  2409           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2410           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2411           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2412           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2413           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2414           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2415           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2416           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2417           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2418           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2419                                                     'W' 'X'.
  2420           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2421           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2422           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2423           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2424           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2425           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2426           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2427           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2428           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2429           88  CP-CSL-METH-1                   VALUE '5'.
  2430           88  CP-CSL-METH-2                   VALUE '6'.
  2431           88  CP-CSL-METH-3                   VALUE '7'.
  2432           88  CP-CSL-METH-4                   VALUE '8'.
  2433
  2434         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2435                                     COMP-3.
  2436         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2437         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2438         16  CP-STATE              PIC XX          VALUE SPACE.
  2439         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2440         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2441           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2442               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2443         16  CP-R78-OPTION         PIC X.
  2444           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2445           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2446
  2447         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2448         16  CP-IBNR-RESERVE-SW    PIC X.
  2449         16  CP-CLAIM-STATUS       PIC X.
  2450         16  CP-RATE-FILE          PIC X.
  2451         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2452                                     COMP-3.
  2453
  2454         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2455         16  CP-AH-OVERRIDE-CODE   PIC X.
  2456
  2457         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2458                                     COMP-3.
  2459         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2460                                     COMP-3.
  2461         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2462                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  49
* EL130.cbl
  2463         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2464                                     COMP-3.
  2465
  2466         16  CP-PAID-FROM-DATE     PIC X(02).
  2467         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2468         16  CP-EXT-DAYS-CALC      PIC X.
  2469           88  CP-EXT-NO-CHG                   VALUE ' '.
  2470           88  CP-EXT-CHG-LF                   VALUE '1'.
  2471           88  CP-EXT-CHG-AH                   VALUE '2'.
  2472           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2473         16  CP-DOMICILE-STATE     PIC XX.
  2474         16  CP-CARRIER            PIC X.
  2475         16  CP-REIN-FLAG          PIC X.
  2476         16  CP-REM-TRM-CALC-OPTION PIC X.
  2477           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2478                      '2' '3' '4' '5'.
  2479           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2480           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2481           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2482           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2483           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2484           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2485           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2486           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2487         16  CP-SIG-SWITCH         PIC X.
  2488         16  CP-RATING-METHOD      PIC X.
  2489           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2490           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2491           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2492           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2493           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2494           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2495           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2496           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2497           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2498         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2499                                     COMP-3.
  2500         16  CP-BEN-CATEGORY       PIC X.
  2501         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2502         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2503                                   PIC S99V9(5) COMP-3.
  2504         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2505         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2506                                   PIC S99V9(5) COMP-3.
  2507         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2508         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2509         16  CP-EXPIRE-DT          PIC XX.
  2510         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2511         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2512         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2513         16  CP-DDF-ADDL-CLP       PIC S9(5)V99 COMP-3 VALUE +0.
  2514         16  CP-DDF-SPEC-CALC      PIC X.
  2515             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2516             88  CP-CALC-CLP              VALUE 'C'.
  2517         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2518         16  CP-CANCEL-REASON      PIC X.
  2519         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2520         16  CP-PMT-MODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  50
* EL130.cbl
  2521         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2522         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2523         16  FILLER                PIC X(09).
  2524
  2525***************    OUTPUT FROM ELRESV   ************************
  2526
  2527         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2528
  2529         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2530                                     COMP-3.
  2531         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2532                                     COMP-3.
  2533         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2534                                     COMP-3.
  2535         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2536                                     COMP-3.
  2537         16  FILLER                PIC X(09).
  2538***************    OUTPUT FROM ELRTRM   *************************
  2539
  2540         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2541                                     COMP-3.
  2542         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2543                                     COMP-3.
  2544         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2545                                     COMP-3.
  2546         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2547                                     COMP-3.
  2548         16  FILLER                PIC X(12).
  2549
  2550***************    OUTPUT FROM ELRAMT   *************************
  2551
  2552         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2553                                     COMP-3.
  2554         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2555                                     COMP-3.
  2556         16  FILLER                PIC X(12).
  2557
  2558***************    OUTPUT FROM ELRATE   *************************
  2559
  2560         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2561                                     COMP-3.
  2562         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2563                                     COMP-3.
  2564         16  CP-MORTALITY-CODE     PIC X(4).
  2565         16  CP-RATE-EDIT-FLAG     PIC X.
  2566             88  CP-RATES-NEED-APR                  VALUE '1'.
  2567         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2568                                     COMP-3.
  2569         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2570         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2571         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2572                                   PIC S9(7)V99 COMP-3.
  2573         16  FILLER                PIC X(07).
  2574
  2575***************    OUTPUT FROM ELRFND   *************************
  2576
  2577         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2578                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  51
* EL130.cbl
  2579         16  CP-REFUND-TYPE-USED   PIC X.
  2580           88  CP-R-AS-R78                         VALUE '1'.
  2581           88  CP-R-AS-PRORATA                     VALUE '2'.
  2582           88  CP-R-AS-CALIF                       VALUE '3'.
  2583           88  CP-R-AS-TEXAS                       VALUE '4'.
  2584           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2585           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2586           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2587           88  CP-R-AS-MEAN                        VALUE '8'.
  2588           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2589           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2590           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2591           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2592           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2593           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2594         16  FILLER                PIC X(12).
  2595
  2596***************    OUTPUT FROM ELEARN   *************************
  2597
  2598         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2599                                     COMP-3.
  2600         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2601                                     COMP-3.
  2602         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2603                                     COMP-3.
  2604         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2605                                     COMP-3.
  2606         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2607                                     COMP-3.
  2608         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2609                                     COMP-3.
  2610         16  CP-EARNING-TYPE-USED  PIC X.
  2611           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2612           88  CP-E-AS-R78                         VALUE '1'.
  2613           88  CP-E-AS-PRORATA                     VALUE '2'.
  2614           88  CP-E-AS-TEXAS                       VALUE '4'.
  2615           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2616           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2617           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2618           88  CP-E-AS-MEAN                        VALUE '8'.
  2619           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2620         16  FILLER                PIC X(12).
  2621
  2622***************    OUTPUT FROM ELPMNT   *************************
  2623
  2624         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2625                                     COMP-3.
  2626         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2627                                     COMP-3.
  2628         16  FILLER                PIC X(12).
  2629
  2630***************   MISC WORK AREAS    *****************************
  2631         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2632                                     COMP-3.
  2633         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2634                                     COMP-3.
  2635         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2636                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  52
* EL130.cbl
  2637         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2638                                     COMP-3.
  2639         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2640                                     COMP-3.
  2641         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2642                                     COMP-3.
  2643         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2644             88  OPEN-RATE-FILE                   VALUE 'O'.
  2645             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2646             88  IO-ERROR                         VALUE 'E'.
  2647
  2648         16  CP-FIRST-PAY-DATE     PIC XX.
  2649
  2650         16  CP-JOINT-INDICATOR    PIC X.
  2651
  2652         16  CP-RESERVE-REMAINING-TERM
  2653                                   PIC S9(4)V9    VALUE ZERO
  2654                                     COMP-3.
  2655
  2656         16  CP-INSURED-BIRTH-DT   PIC XX.
  2657
  2658         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2659                                     COMP-3.
  2660
  2661         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2662                                     COMP-3.
  2663
  2664         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2665                                     COMP-3.
  2666
  2667         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2668                                     COMP-3.
  2669
  2670         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2671                                     COMP-3.
  2672
  2673         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2674                                     COMP-3.
  2675
  2676         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2677                                     COMP-3.
  2678
  2679         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2680             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2681
  2682         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2683                                     COMP-3.
  2684         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2685                                     COMP-3.
  2686         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2687         16  FILLER                PIC X(15).
  2688******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  53
* EL130.cbl
  2690*    COPY ELCLOGOF.
  2691******************************************************************
  2692*                                                                *
  2693*                                                                *
  2694*                            ELCLOGOF.                           *
  2695*                            VMOD=2.001                          *
  2696*                                                                *
  2697*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2698*                                                                *
  2699******************************************************************
  2700 01  CLASIC-LOGOFF.
  2701     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2702     12  LOGOFF-TEXT.
  2703         16  FILLER          PIC X(5)    VALUE SPACES.
  2704         16  LOGOFF-MSG.
  2705             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2706             20  FILLER      PIC X       VALUE SPACES.
  2707             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2708         16  FILLER          PIC X(80)
  2709           VALUE '* YOU ARE NOW LOGGED OFF'.
  2710         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2711         16  FILLER          PIC X       VALUE QUOTE.
  2712         16  LOGOFF-SYS-MSG  PIC X(17)
  2713           VALUE 'S CLAS-IC SYSTEM '.
  2714     12  TEXT-MESSAGES.
  2715         16  UNACCESS-MSG    PIC X(29)
  2716             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2717         16  PGMIDERR-MSG    PIC X(17)
  2718             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  54
* EL130.cbl
  2720*    COPY ELCATTR.
  2721******************************************************************
  2722*                                                                *
  2723*                            ELCATTR.                            *
  2724*                            VMOD=2.001                          *
  2725*                                                                *
  2726*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2727*                                                                *
  2728*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2729*                                                                *
  2730*                   POS 1   P=PROTECTED                          *
  2731*                           U=UNPROTECTED                        *
  2732*                           S=ASKIP                              *
  2733*                   POS 2   A=ALPHA/NUMERIC                      *
  2734*                           N=NUMERIC                            *
  2735*                   POS 3   N=NORMAL                             *
  2736*                           B=BRIGHT                             *
  2737*                           D=DARK                               *
  2738*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2739*                           OF=MODIFIED DATA TAG OFF             *
  2740*                                                                *
  2741*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2742******************************************************************
  2743 01  ATTRIBUTE-LIST.
  2744     12  AL-PABOF            PIC X       VALUE 'Y'.
  2745     12  AL-PABON            PIC X       VALUE 'Z'.
  2746     12  AL-PADOF            PIC X       VALUE '%'.
  2747     12  AL-PADON            PIC X       VALUE '_'.
  2748     12  AL-PANOF            PIC X       VALUE '-'.
  2749     12  AL-PANON            PIC X       VALUE '/'.
  2750     12  AL-SABOF            PIC X       VALUE '8'.
  2751     12  AL-SABON            PIC X       VALUE '9'.
  2752     12  AL-SADOF            PIC X       VALUE '@'.
  2753     12  AL-SADON            PIC X       VALUE QUOTE.
  2754     12  AL-SANOF            PIC X       VALUE '0'.
  2755     12  AL-SANON            PIC X       VALUE '1'.
  2756     12  AL-UABOF            PIC X       VALUE 'H'.
  2757     12  AL-UABON            PIC X       VALUE 'I'.
  2758     12  AL-UADOF            PIC X       VALUE '<'.
  2759     12  AL-UADON            PIC X       VALUE '('.
  2760     12  AL-UANOF            PIC X       VALUE ' '.
  2761     12  AL-UANON            PIC X       VALUE 'A'.
  2762     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2763     12  AL-UNBON            PIC X       VALUE 'R'.
  2764     12  AL-UNDOF            PIC X       VALUE '*'.
  2765     12  AL-UNDON            PIC X       VALUE ')'.
  2766     12  AL-UNNOF            PIC X       VALUE '&'.
  2767     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  55
* EL130.cbl
  2769*    COPY ELCEMIB.
  2770******************************************************************
  2771*                                                                *
  2772*                                                                *
  2773*                            ELCEMIB.                            *
  2774*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2775*                            VMOD=2.005                          *
  2776*                                                                *
  2777*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2778*                                                                *
  2779******************************************************************
  2780 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2781     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2782     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2783     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2784     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2785     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2786     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2787     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2788     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2789     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2790         88  EMI-NO-ERRORS                    VALUE '1'.
  2791         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2792         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2793     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2794         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2795     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2796         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2797         88  EMI-AREA1-FULL                   VALUE '2'.
  2798     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2799         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2800         88  EMI-AREA2-FULL                   VALUE '2'.
  2801     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2802         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2803         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2804         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2805         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2806         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2807     12  EMI-ERROR-LINES.
  2808         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2809         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2810         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2811         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2812             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2813                 24  EMI-ERR-NUM         PIC X(4).
  2814                 24  EMI-FILLER          PIC X.
  2815                 24  EMI-SEV             PIC X.
  2816                 24  FILLER              PIC X.
  2817             20  FILLER                  PIC X(02).
  2818     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2819         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2820             20  EMI-ERROR-NUMBER    PIC X(4).
  2821             20  EMI-FILL            PIC X.
  2822             20  EMI-SEVERITY        PIC X.
  2823             20  FILLER              PIC X.
  2824             20  EMI-ERROR-TEXT.
  2825                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2826                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  56
* EL130.cbl
  2827     12  EMI-SEVERITY-SAVE           PIC X.
  2828         88  EMI-NOTE                    VALUE 'N'.
  2829         88  EMI-WARNING                 VALUE 'W'.
  2830         88  EMI-FORCABLE                VALUE 'F'.
  2831         88  EMI-FATAL                   VALUE 'X'.
  2832     12  EMI-MESSAGE-FLAG            PIC X.
  2833         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2834         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2835     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2836     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2837         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2838         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2839         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2840     12  FILLER                      PIC X(137)  VALUE SPACES.
  2841     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2842     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2843     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2844     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  57
* EL130.cbl
  2846*    COPY ELCJPFX.
  2847******************************************************************
  2848*                                                                *
  2849*                                                                *
  2850*                            ELCJPFX.                            *
  2851*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2852*                            VMOD=2.002                          *
  2853*                                                                *
  2854*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2855*                                                                *
  2856*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2857*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2858*        ELCNTL - CONTROL FILE                                   *
  2859*        ELMSTR - CLAIM MASTERS                                  *
  2860*        ELTRLR - ACTIVITY TRAILERS                              *
  2861*        ELCHKQ - CHECK QUE                                      *
  2862******************************************************************
  2863 01  JOURNAL-RECORD.
  2864     12  JP-USER-ID                  PIC X(4).
  2865     12  JP-FILE-ID                  PIC X(8).
  2866     12  JP-PROGRAM-ID               PIC X(8).
  2867     12  JP-RECORD-TYPE              PIC X.
  2868         88 JP-ADD              VALUE 'A'.
  2869         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2870         88 JP-AFTER-CHANGE     VALUE 'C'.
  2871         88 JP-DELETE           VALUE 'D'.
  2872         88 JP-GENERIC-DELETE   VALUE 'G'.
  2873         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2874         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2875     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2876     12  JP-RECORD-AREA
  2877
  2878
  2879         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  58
* EL130.cbl
  2881*    COPY ELCAID.
  2882******************************************************************
  2883*                                                                *
  2884*                            ELCAID.                             *
  2885*                            VMOD=2.001                          *
  2886*                                                                *
  2887*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2888*                                                                *
  2889*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2890*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2891******************************************************************
  2892
  2893 01  DFHAID.
  2894   02  DFHNULL   PIC  X  VALUE  ' '.
  2895   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2896   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2897   02  DFHPEN    PIC  X  VALUE  '='.
  2898   02  DFHOPID   PIC  X  VALUE  'W'.
  2899   02  DFHPA1    PIC  X  VALUE  '%'.
  2900   02  DFHPA2    PIC  X  VALUE  '>'.
  2901   02  DFHPA3    PIC  X  VALUE  ','.
  2902   02  DFHPF1    PIC  X  VALUE  '1'.
  2903   02  DFHPF2    PIC  X  VALUE  '2'.
  2904   02  DFHPF3    PIC  X  VALUE  '3'.
  2905   02  DFHPF4    PIC  X  VALUE  '4'.
  2906   02  DFHPF5    PIC  X  VALUE  '5'.
  2907   02  DFHPF6    PIC  X  VALUE  '6'.
  2908   02  DFHPF7    PIC  X  VALUE  '7'.
  2909   02  DFHPF8    PIC  X  VALUE  '8'.
  2910   02  DFHPF9    PIC  X  VALUE  '9'.
  2911   02  DFHPF10   PIC  X  VALUE  ':'.
  2912   02  DFHPF11   PIC  X  VALUE  '#'.
  2913   02  DFHPF12   PIC  X  VALUE  '@'.
  2914   02  DFHPF13   PIC  X  VALUE  'A'.
  2915   02  DFHPF14   PIC  X  VALUE  'B'.
  2916   02  DFHPF15   PIC  X  VALUE  'C'.
  2917   02  DFHPF16   PIC  X  VALUE  'D'.
  2918   02  DFHPF17   PIC  X  VALUE  'E'.
  2919   02  DFHPF18   PIC  X  VALUE  'F'.
  2920   02  DFHPF19   PIC  X  VALUE  'G'.
  2921   02  DFHPF20   PIC  X  VALUE  'H'.
  2922   02  DFHPF21   PIC  X  VALUE  'I'.
  2923*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2924   02  DFHPF22   PIC  X  VALUE  '['.
  2925   02  DFHPF23   PIC  X  VALUE  '.'.
  2926   02  DFHPF24   PIC  X  VALUE  '<'.
  2927   02  DFHMSRE   PIC  X  VALUE  'X'.
  2928   02  DFHSTRF   PIC  X  VALUE  'h'.
  2929   02  DFHTRIG   PIC  X  VALUE  '"'.
  2930
  2931 01  FILLER    REDEFINES DFHAID.
  2932     12  FILLER              PIC X(8).
  2933     12  PF-VALUES           PIC X       OCCURS 12.
  2934
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  59
* EL130.cbl
  2936****************************************************************
  2937*
  2938* Copyright (c) 2007 by Clerity Solutions, Inc.
  2939* All rights reserved.
  2940*
  2941****************************************************************
  2942 01  DFHEIV.
  2943   02  DFHEIV0               PIC X(35).
  2944   02  DFHEIV1               PIC X(08).
  2945   02  DFHEIV2               PIC X(08).
  2946   02  DFHEIV3               PIC X(08).
  2947   02  DFHEIV4               PIC X(06).
  2948   02  DFHEIV5               PIC X(04).
  2949   02  DFHEIV6               PIC X(04).
  2950   02  DFHEIV7               PIC X(02).
  2951   02  DFHEIV8               PIC X(02).
  2952   02  DFHEIV9               PIC X(01).
  2953   02  DFHEIV10              PIC S9(7) COMP-3.
  2954   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2955   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2956   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2957   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2958   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2959   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2960   02  DFHEIV17              PIC X(04).
  2961   02  DFHEIV18              PIC X(04).
  2962   02  DFHEIV19              PIC X(04).
  2963   02  DFHEIV20              USAGE IS POINTER.
  2964   02  DFHEIV21              USAGE IS POINTER.
  2965   02  DFHEIV22              USAGE IS POINTER.
  2966   02  DFHEIV23              USAGE IS POINTER.
  2967   02  DFHEIV24              USAGE IS POINTER.
  2968   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2969   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2970   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2971   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2972   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2973   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2974   02  FILLER                PIC X(02).
  2975   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2976   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2977   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2978   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2979   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2980 LINKAGE  SECTION.
  2981*****************************************************************
  2982*                                                               *
  2983* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2984* All rights reserved.                                          *
  2985*                                                               *
  2986*****************************************************************
  2987 01  dfheiblk.
  2988     02  eibtime          pic s9(7) comp-3.
  2989     02  eibdate          pic s9(7) comp-3.
  2990     02  eibtrnid         pic x(4).
  2991     02  eibtaskn         pic s9(7) comp-3.
  2992     02  eibtrmid         pic x(4).
  2993     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  60
* EL130.cbl
  2994     02  eibcposn         pic s9(4) comp.
  2995     02  eibcalen         pic s9(4) comp.
  2996     02  eibaid           pic x(1).
  2997     02  eibfiller1       pic x(1).
  2998     02  eibfn            pic x(2).
  2999     02  eibfiller2       pic x(2).
  3000     02  eibrcode         pic x(6).
  3001     02  eibfiller3       pic x(2).
  3002     02  eibds            pic x(8).
  3003     02  eibreqid         pic x(8).
  3004     02  eibrsrce         pic x(8).
  3005     02  eibsync          pic x(1).
  3006     02  eibfree          pic x(1).
  3007     02  eibrecv          pic x(1).
  3008     02  eibsend          pic x(1).
  3009     02  eibatt           pic x(1).
  3010     02  eibeoc           pic x(1).
  3011     02  eibfmh           pic x(1).
  3012     02  eibcompl         pic x(1).
  3013     02  eibsig           pic x(1).
  3014     02  eibconf          pic x(1).
  3015     02  eiberr           pic x(1).
  3016     02  eibrldbk         pic x(1).
  3017     02  eiberrcd         pic x(4).
  3018     02  eibsynrb         pic x(1).
  3019     02  eibnodat         pic x(1).
  3020     02  eibfiller5       pic x(2).
  3021     02  eibresp          pic 9(09) comp.
  3022     02  eibresp2         pic 9(09) comp.
  3023     02  dfheigdj         pic s9(4) comp.
  3024     02  dfheigdk         pic s9(4) comp.
  3025
  3026 01  DFHCOMMAREA             PIC X(1024).
  3027
  3028*01 PARMLIST .
  3029*    02  FILLER              PIC S9(8)   COMP.
  3030*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3031*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3032*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3033*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3034*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3035*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3036*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3037*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3038*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  61
* EL130.cbl
  3040*    COPY ELCMSTR.
  3041******************************************************************
  3042*                                                                *
  3043*                            ELCMSTR.                            *
  3044*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3045*                            VMOD=2.012                          *
  3046*                                                                *
  3047*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3048*                                                                *
  3049*   FILE TYPE = VSAM,KSDS                                        *
  3050*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3051*                                                                *
  3052*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3053*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3054*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3055*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3056*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3057*                                                 RKP=75,LEN=21  *
  3058*                                                                *
  3059*   **** NOTE ****                                               *
  3060*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3061*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3062*                                                                *
  3063*   LOG = YES                                                    *
  3064*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3065******************************************************************
  3066*                   C H A N G E   L O G
  3067*
  3068* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3069*-----------------------------------------------------------------
  3070*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3071* EFFECTIVE    NUMBER
  3072*-----------------------------------------------------------------
  3073* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3074* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3075******************************************************************
  3076 01  CLAIM-MASTER.
  3077     12  CL-RECORD-ID                PIC XX.
  3078         88  VALID-CL-ID         VALUE 'CL'.
  3079
  3080     12  CL-CONTROL-PRIMARY.
  3081         16  CL-COMPANY-CD           PIC X.
  3082         16  CL-CARRIER              PIC X.
  3083         16  CL-CLAIM-NO             PIC X(7).
  3084         16  CL-CERT-NO.
  3085             20  CL-CERT-PRIME       PIC X(10).
  3086             20  CL-CERT-SFX         PIC X.
  3087
  3088     12  CL-CONTROL-BY-NAME.
  3089         16  CL-COMPANY-CD-A1        PIC X.
  3090         16  CL-INSURED-LAST-NAME    PIC X(15).
  3091         16  CL-INSURED-NAME.
  3092             20  CL-INSURED-1ST-NAME PIC X(12).
  3093             20  CL-INSURED-MID-INIT PIC X.
  3094
  3095     12  CL-CONTROL-BY-SSN.
  3096         16  CL-COMPANY-CD-A2        PIC X.
  3097         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  62
* EL130.cbl
  3098             20  CL-SSN-STATE        PIC XX.
  3099             20  CL-SSN-ACCOUNT      PIC X(6).
  3100             20  CL-SSN-LN3          PIC X(3).
  3101
  3102     12  CL-CONTROL-BY-CERT-NO.
  3103         16  CL-COMPANY-CD-A4        PIC X.
  3104         16  CL-CERT-NO-A4.
  3105             20  CL-CERT-A4-PRIME    PIC X(10).
  3106             20  CL-CERT-A4-SFX      PIC X.
  3107
  3108     12  CL-CONTROL-BY-CCN.
  3109         16  CL-COMPANY-CD-A5        PIC X.
  3110         16  CL-CCN-A5.
  3111             20  CL-CCN.
  3112                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3113                 24  CL-CCN-PRIME-A5 PIC X(12).
  3114             20  CL-CCN-FILLER-A5    PIC X(4).
  3115
  3116     12  CL-INSURED-PROFILE-DATA.
  3117         16  CL-INSURED-BIRTH-DT     PIC XX.
  3118         16  CL-INSURED-SEX-CD       PIC X.
  3119             88  INSURED-IS-MALE        VALUE 'M'.
  3120             88  INSURED-IS-FEMALE      VALUE 'F'.
  3121             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3122         16  CL-INSURED-OCC-CD       PIC X(6).
  3123         16  FILLER                  PIC X(5).
  3124
  3125     12  CL-PROCESSING-INFO.
  3126         16  CL-PROCESSOR-ID         PIC X(4).
  3127         16  CL-CLAIM-STATUS         PIC X.
  3128             88  CLAIM-IS-OPEN          VALUE 'O'.
  3129             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3130         16  CL-CLAIM-TYPE           PIC X.
  3131*            88  AH-CLAIM               VALUE 'A'.
  3132*            88  LIFE-CLAIM             VALUE 'L'.
  3133*            88  PROPERTY-CLAIM         VALUE 'P'.
  3134*            88  IUI-CLAIM              VALUE 'I'.
  3135*            88  GAP-CLAIM              VALUE 'G'.
  3136         16  CL-CLAIM-PREM-TYPE      PIC X.
  3137             88  SINGLE-PREMIUM         VALUE '1'.
  3138             88  O-B-COVERAGE           VALUE '2'.
  3139             88  OPEN-END-COVERAGE      VALUE '3'.
  3140         16  CL-INCURRED-DT          PIC XX.
  3141         16  CL-REPORTED-DT          PIC XX.
  3142         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3143         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3144         16  CL-LAST-PMT-DT          PIC XX.
  3145         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3146         16  CL-PAID-THRU-DT         PIC XX.
  3147         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3148         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3149         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3150         16  CL-PMT-CALC-METHOD      PIC X.
  3151             88  CL-360-DAY-YR          VALUE '1'.
  3152             88  CL-365-DAY-YR          VALUE '2'.
  3153             88  CL-FULL-MONTHS         VALUE '3'.
  3154         16  CL-CAUSE-CD             PIC X(6).
  3155
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  63
* EL130.cbl
  3156         16  CL-PRIME-CERT-NO.
  3157             20  CL-PRIME-CERT-PRIME PIC X(10).
  3158             20  CL-PRIME-CERT-SFX   PIC X.
  3159
  3160         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3161             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3162             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3163
  3164         16  CL-MICROFILM-NO         PIC X(10).
  3165         16  CL-PROG-FORM-TYPE       PIC X.
  3166         16  CL-LAST-ADD-ON-DT       PIC XX.
  3167
  3168         16  CL-LAST-REOPEN-DT       PIC XX.
  3169         16  CL-LAST-CLOSE-DT        PIC XX.
  3170         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3171             88  FINAL-PAID             VALUE '1'.
  3172             88  CLAIM-DENIED           VALUE '2'.
  3173             88  AUTO-CLOSE             VALUE '3'.
  3174             88  MANUAL-CLOSE           VALUE '4'.
  3175             88  BENEFITS-CHANGED       VALUE 'C'.
  3176             88  SETUP-ERRORS           VALUE 'E'.
  3177         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3178         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3179         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3180             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3181         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3182         16  FILLER                  PIC X.
  3183
  3184     12  CL-CERTIFICATE-DATA.
  3185         16  CL-CERT-ORIGIN          PIC X.
  3186             88  CERT-WAS-ONLINE        VALUE '1'.
  3187             88  CERT-WAS-CREATED       VALUE '2'.
  3188             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3189         16  CL-CERT-KEY-DATA.
  3190             20  CL-CERT-CARRIER     PIC X.
  3191             20  CL-CERT-GROUPING    PIC X(6).
  3192             20  CL-CERT-STATE       PIC XX.
  3193             20  CL-CERT-ACCOUNT.
  3194                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3195                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3196             20  CL-CERT-EFF-DT      PIC XX.
  3197
  3198     12  CL-STATUS-CONTROLS.
  3199         16  CL-PRIORITY-CD          PIC X.
  3200             88  CONFIDENTIAL-DATA      VALUE '8'.
  3201             88  HIGHEST-PRIORITY       VALUE '9'.
  3202         16  CL-SUPV-ATTN-CD         PIC X.
  3203             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3204             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3205         16  CL-PURGED-DT            PIC XX.
  3206         16  CL-RESTORED-DT          PIC XX.
  3207         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3208         16  CL-NEXT-RESEND-DT       PIC XX.
  3209         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3210         16  FILLER                  PIC XX.
  3211         16  CL-LAST-MAINT-DT        PIC XX.
  3212         16  CL-LAST-MAINT-USER      PIC X(4).
  3213         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  64
* EL130.cbl
  3214         16  CL-LAST-MAINT-TYPE      PIC X.
  3215             88  CLAIM-SET-UP           VALUE ' '.
  3216             88  PAYMENT-MADE           VALUE '1'.
  3217             88  LETTER-SENT            VALUE '2'.
  3218             88  MASTER-WAS-ALTERED     VALUE '3'.
  3219             88  MASTER-WAS-RESTORED    VALUE '4'.
  3220             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3221             88  FILE-CONVERTED         VALUE '6'.
  3222             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3223             88  ERROR-CORRECTION       VALUE 'E'.
  3224         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3225         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3226         16  CL-BENEFICIARY          PIC X(10).
  3227         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3228         16  CL-DENIAL-TYPE          PIC X.
  3229             88  CL-TYPE-DENIAL          VALUE '1'.
  3230             88  CL-TYPE-RESCISSION      VALUE '2'.
  3231             88  CL-TYPE-REFORMATION     VALUE '3'.
  3232             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3233             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3234         16  FILLER                  PIC X(5).
  3235
  3236     12  CL-TRAILER-CONTROLS.
  3237         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3238             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3239             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3240             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3241         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3242         16  FILLER                  PIC XX.
  3243         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3244         16  CL-ADDRESS-TRAILER-CNT.
  3245             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3246                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3247             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3248                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3249             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3250                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3251             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3252                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3253             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3254                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3255             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3256                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3257             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3258                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3259
  3260     12  CL-CV-REFERENCE-NO.
  3261         16  CL-CV-REFNO-PRIME       PIC X(18).
  3262         16  CL-CV-REFNO-SFX         PIC XX.
  3263
  3264     12  CL-FILE-LOCATION            PIC X(4).
  3265
  3266     12  CL-PROCESS-ERRORS.
  3267         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3268             88  NO-FATAL-ERRORS        VALUE ZERO.
  3269         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3270             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3271
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  65
* EL130.cbl
  3272     12  CL-PRODUCT-CD               PIC X.
  3273
  3274     12  CL-CURRENT-KEY-DATA.
  3275         16  CL-CURRENT-CARRIER      PIC X.
  3276         16  CL-CURRENT-GROUPING     PIC X(6).
  3277         16  CL-CURRENT-STATE        PIC XX.
  3278         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3279
  3280     12  CL-ASSOCIATES               PIC X.
  3281         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3282         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3283         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3284         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3285
  3286     12  CL-ACTIVITY-CODE            PIC 99.
  3287     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3288     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3289
  3290     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3291     12  CL-LAG-REPORT-CODE          PIC 9.
  3292     12  CL-LOAN-TYPE                PIC XX.
  3293     12  CL-LEGAL-STATE              PIC XX.
  3294
  3295*    12  FILLER                      PIC X(5).
  3296     12  CL-YESNOSW                  PIC X.
  3297     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  66
* EL130.cbl
  3299*    COPY ELCCNTL.
  3300******************************************************************
  3301*                                                                *
  3302*                                                                *
  3303*                            ELCCNTL.                            *
  3304*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3305*                            VMOD=2.059                          *
  3306*                                                                *
  3307*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3308*                                                                *
  3309*   FILE TYPE = VSAM,KSDS                                        *
  3310*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3311*                                                                *
  3312*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3313*       ALTERNATE INDEX = NONE                                   *
  3314*                                                                *
  3315*   LOG = YES                                                    *
  3316*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3317******************************************************************
  3318*                   C H A N G E   L O G
  3319*
  3320* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3321*-----------------------------------------------------------------
  3322*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3323* EFFECTIVE    NUMBER
  3324*-----------------------------------------------------------------
  3325* 082503                   PEMA  ADD BENEFIT GROUP
  3326* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3327* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3328* 092705    2005050300006  PEMA  ADD SPP LEASES
  3329* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3330* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3331* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3332* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3333* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3334******************************************************************
  3335*
  3336 01  CONTROL-FILE.
  3337     12  CF-RECORD-ID                       PIC XX.
  3338         88  VALID-CF-ID                        VALUE 'CF'.
  3339
  3340     12  CF-CONTROL-PRIMARY.
  3341         16  CF-COMPANY-ID                  PIC XXX.
  3342         16  CF-RECORD-TYPE                 PIC X.
  3343             88  CF-COMPANY-MASTER              VALUE '1'.
  3344             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3345             88  CF-STATE-MASTER                VALUE '3'.
  3346             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3347             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3348             88  CF-CARRIER-MASTER              VALUE '6'.
  3349             88  CF-MORTALITY-MASTER            VALUE '7'.
  3350             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3351             88  CF-TERMINAL-MASTER             VALUE '9'.
  3352             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3353             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3354             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3355             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3356             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  67
* EL130.cbl
  3357             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3358             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3359             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3360             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3361         16  CF-ACCESS-CD-GENL              PIC X(4).
  3362         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3363             20  CF-PROCESSOR               PIC X(4).
  3364         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3365             20  CF-STATE-CODE              PIC XX.
  3366             20  FILLER                     PIC XX.
  3367         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3368             20  FILLER                     PIC XX.
  3369             20  CF-HI-BEN-IN-REC           PIC XX.
  3370         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3371             20  FILLER                     PIC XXX.
  3372             20  CF-CARRIER-CNTL            PIC X.
  3373         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3374             20  FILLER                     PIC XX.
  3375             20  CF-HI-TYPE-IN-REC          PIC 99.
  3376         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3377             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3378                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3379             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3380             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3381         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3382             20  FILLER                     PIC X.
  3383             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3384         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3385             20  FILLER                     PIC XX.
  3386             20  CF-MORTGAGE-PLAN           PIC XX.
  3387         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3388
  3389     12  CF-LAST-MAINT-DT                   PIC XX.
  3390     12  CF-LAST-MAINT-BY                   PIC X(4).
  3391     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3392
  3393     12  CF-RECORD-BODY                     PIC X(728).
  3394
  3395
  3396****************************************************************
  3397*             COMPANY MASTER RECORD                            *
  3398****************************************************************
  3399
  3400     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3401         16  CF-COMPANY-ADDRESS.
  3402             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3403             20  CF-CL-IN-CARE-OF           PIC X(30).
  3404             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3405             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3406             20  CF-CL-CITY-STATE           PIC X(30).
  3407             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3408             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3409         16  CF-COMPANY-CD                  PIC X.
  3410         16  CF-COMPANY-PASSWORD            PIC X(8).
  3411         16  CF-SECURITY-OPTION             PIC X.
  3412             88  ALL-SECURITY                   VALUE '1'.
  3413             88  COMPANY-VERIFY                 VALUE '2'.
  3414             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  68
* EL130.cbl
  3415             88  NO-SECURITY                    VALUE '4'.
  3416             88  ALL-BUT-TERM                   VALUE '5'.
  3417         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3418             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3419         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3420             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3421         16  CF-INFORCE-LOCATION            PIC X.
  3422             88  CERTS-ARE-ONLINE               VALUE '1'.
  3423             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3424             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3425         16  CF-LOWER-CASE-LETTERS          PIC X.
  3426         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3427             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3428             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3429             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3430             88  CF-ACCNT-CNTL                  VALUE '3'.
  3431             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3432
  3433         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3434         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3435
  3436         16  CF-LGX-CREDIT-USER             PIC X.
  3437             88  CO-IS-NOT-USER                 VALUE 'N'.
  3438             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3439
  3440         16 CF-CREDIT-CALC-CODES.
  3441             20  CF-CR-REM-TERM-CALC PIC X.
  3442               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3443               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3444               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3445               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3446               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3447               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3448               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3449             20  CF-CR-R78-METHOD           PIC X.
  3450               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3451               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3452
  3453         16  CF-CLAIM-CONTROL-COUNTS.
  3454             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3455                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3456
  3457             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3458                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3459
  3460             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3461                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3462
  3463             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3464                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3465
  3466         16  CF-CURRENT-MONTH-END           PIC XX.
  3467
  3468         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3469             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3470             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3471             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3472             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  69
* EL130.cbl
  3473                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3474                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3475             20  CF-CO-PREM-REJECT-SW       PIC X.
  3476                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3477                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3478             20  CF-CO-REF-REJECT-SW        PIC X.
  3479                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3480                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3481
  3482         16  CF-CO-REPORTING-DT             PIC XX.
  3483         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3484         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3485           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3486           88  CF-CO-MONTH-END                  VALUE '1'.
  3487
  3488         16  CF-LGX-CLAIM-USER              PIC X.
  3489             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3490             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3491
  3492         16  CF-CREDIT-EDIT-CONTROLS.
  3493             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3494             20  CF-MIN-AGE                 PIC 99.
  3495             20  CF-DEFAULT-AGE             PIC 99.
  3496             20  CF-MIN-TERM                PIC S999      COMP-3.
  3497             20  CF-MAX-TERM                PIC S999      COMP-3.
  3498             20  CF-DEFAULT-SEX             PIC X.
  3499             20  CF-JOINT-AGE-INPUT         PIC X.
  3500                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3501             20  CF-BIRTH-DATE-INPUT        PIC X.
  3502                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3503             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3504                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3505                 88  CF-ZERO-CARRIER            VALUE '1'.
  3506                 88  CF-ZERO-GROUPING           VALUE '2'.
  3507                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3508             20  CF-EDIT-SW                 PIC X.
  3509                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3510             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3511             20  CF-CR-PR-METHOD            PIC X.
  3512               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3513               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3514             20  FILLER                     PIC X.
  3515
  3516         16  CF-CREDIT-MISC-CONTROLS.
  3517             20  CF-REIN-TABLE-SW           PIC X.
  3518                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3519             20  CF-COMP-TABLE-SW           PIC X.
  3520                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3521             20  CF-EXPERIENCE-RETENTION-AGE
  3522                                            PIC S9        COMP-3.
  3523             20  CF-CONVERSION-DT           PIC XX.
  3524             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3525             20  CF-RUN-FREQUENCY-SW        PIC X.
  3526                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3527                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3528
  3529             20  CF-CR-CHECK-NO-CONTROL.
  3530                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  70
* EL130.cbl
  3531                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3532                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3533                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3534                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3535                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3536
  3537                 24  CF-CR-CHECK-COUNT       REDEFINES
  3538                     CF-CR-CHECK-COUNTER      PIC X(4).
  3539
  3540                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3541                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3542
  3543                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3544                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3545                 24  CF-MAIL-PROCESSING       PIC X.
  3546                     88  MAIL-PROCESSING          VALUE 'Y'.
  3547
  3548         16  CF-MISC-SYSTEM-CONTROL.
  3549             20  CF-SYSTEM-C                 PIC X.
  3550                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3551             20  CF-SYSTEM-D                 PIC X.
  3552                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3553             20  CF-SOC-SEC-NO-SW            PIC X.
  3554                 88  SOC-SEC-NO-USED             VALUE '1'.
  3555             20  CF-MEMBER-NO-SW             PIC X.
  3556                 88  MEMBER-NO-USED              VALUE '1'.
  3557             20  CF-TAX-ID-NUMBER            PIC X(11).
  3558             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3559             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3560                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3561                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3562                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3563                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3564             20  CF-SYSTEM-E                 PIC X.
  3565                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3566
  3567         16  CF-LGX-LIFE-USER               PIC X.
  3568             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3569             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3570
  3571         16  CF-CR-MONTH-END-DT             PIC XX.
  3572
  3573         16  CF-FILE-MAINT-DATES.
  3574             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3575                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3576             20  CF-LAST-BATCH       REDEFINES
  3577                 CF-LAST-BATCH-NO               PIC X(4).
  3578             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3579             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3580             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3581             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3582             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3583             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3584             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3585             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3586             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3587             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3588
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  71
* EL130.cbl
  3589         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3590         16  FILLER                         PIC X.
  3591
  3592         16  CF-ALT-MORT-CODE               PIC X(4).
  3593         16  CF-MEMBER-CAPTION              PIC X(10).
  3594
  3595         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3596             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3597             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3598             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3599             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3600             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3601
  3602         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3603
  3604         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3605         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3606         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3607         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3608
  3609         16  CF-AH-OVERRIDE-L1              PIC X.
  3610         16  CF-AH-OVERRIDE-L2              PIC XX.
  3611         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3612         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3613
  3614         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3615         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3616
  3617         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3618         16  CF-AR-LAST-EL860-DT            PIC XX.
  3619         16  CF-MP-MONTH-END-DT             PIC XX.
  3620
  3621         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3622         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3623             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3624
  3625         16  CF-AR-MONTH-END-DT             PIC XX.
  3626
  3627         16  CF-CRDTCRD-USER                PIC X.
  3628             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3629             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3630
  3631         16  CF-CC-MONTH-END-DT             PIC XX.
  3632
  3633         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3634
  3635         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3636             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3637             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3638             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3639         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3640         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3641         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3642         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3643             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3644             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3645         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3646         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  72
* EL130.cbl
  3647         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3648             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3649         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3650
  3651         16  CF-CL-ZIP-CODE.
  3652             20  CF-CL-ZIP-PRIME.
  3653                 24  CF-CL-ZIP-1ST          PIC X.
  3654                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3655                 24  FILLER                 PIC X(4).
  3656             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3657         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3658             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3659             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3660             20  FILLER                     PIC XXX.
  3661
  3662         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3663         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3664         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3665         16  CF-CO-OPTION-START-DATE        PIC XX.
  3666         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3667           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3668                                                      '3' '4'.
  3669           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3670           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3671           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3672           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3673           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3674           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3675
  3676         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3677
  3678         16  CF-PAYMENT-APPROVAL-LEVELS.
  3679             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3680             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3681             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3682             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3683             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3684             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3685
  3686         16  CF-END-USER-REPORTING-USER     PIC X.
  3687             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3688             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3689
  3690         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3691             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3692             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3693
  3694         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3695
  3696         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3697         16  FILLER                         PIC X.
  3698
  3699         16  CF-CREDIT-ARCHIVE-CNTL.
  3700             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3701             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3702             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3703
  3704         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  73
* EL130.cbl
  3705
  3706         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3707             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3708             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3709
  3710         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3711             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3712             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3713
  3714         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3715
  3716         16  CF-CO-ACH-ID-CODE              PIC  X.
  3717             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3718             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3719             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3720         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3721         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3722         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3723         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3724         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3725         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3726         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3727         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3728         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3729                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3730         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3731                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3732
  3733         16  CF-CO-OVER-SHORT.
  3734             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3735             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3736
  3737*         16  FILLER                         PIC X(102).
  3738         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3739             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3740             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3741
  3742         16  CF-AH-APPROVAL-DAYS.
  3743             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3744             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3745             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3746             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3747
  3748         16  FILLER                         PIC X(82).
  3749****************************************************************
  3750*             PROCESSOR/USER RECORD                            *
  3751****************************************************************
  3752
  3753     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3754         16  CF-PROCESSOR-NAME              PIC X(30).
  3755         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3756         16  CF-PROCESSOR-TITLE             PIC X(26).
  3757         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3758                 88  MESSAGE-YES                VALUE 'Y'.
  3759                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3760
  3761*****************************************************
  3762****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  74
* EL130.cbl
  3763****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3764****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3765****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3766*****************************************************
  3767
  3768         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3769             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3770             20  CF-APPLICATION-FORCE       PIC X.
  3771             20  CF-INDIVIDUAL-APP.
  3772                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3773                     28  CF-BROWSE-APP      PIC X.
  3774                     28  CF-UPDATE-APP      PIC X.
  3775
  3776         16  CF-CURRENT-TERM-ON             PIC X(4).
  3777         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3778             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3779             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3780             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3781             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3782             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3783             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3784             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3785         16  CF-PROCESSOR-CARRIER           PIC X.
  3786             88  NO-CARRIER-SECURITY            VALUE ' '.
  3787         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3788             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3789         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3790             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3791         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3792             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3793
  3794         16  CF-PROC-SYS-ACCESS-SW.
  3795             20  CF-PROC-CREDIT-CLAIMS-SW.
  3796                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3797                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3798                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3799                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3800             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3801                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3802                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3803             20  CF-PROC-LIFE-GNRLDGR-SW.
  3804                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3805                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3806                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3807                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3808             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3809                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3810                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3811         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3812             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3813             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3814         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3815
  3816         16  CF-APPROVAL-LEVEL                  PIC X.
  3817             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3818             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3819             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3820             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  75
* EL130.cbl
  3821
  3822         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3823
  3824         16  CF-LANGUAGE-TYPE                   PIC X.
  3825             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3826             88  CF-LANG-IS-FR                      VALUE 'F'.
  3827         16  FILLER                             PIC  X(240).
  3828
  3829****************************************************************
  3830*             PROCESSOR/REMINDERS RECORD                       *
  3831****************************************************************
  3832
  3833     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3834         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3835             20  CF-START-REMIND-DT         PIC XX.
  3836             20  CF-END-REMIND-DT           PIC XX.
  3837             20  CF-REMINDER-TEXT           PIC X(50).
  3838         16  FILLER                         PIC X(296).
  3839
  3840
  3841****************************************************************
  3842*             STATE MASTER RECORD                              *
  3843****************************************************************
  3844
  3845     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3846         16  CF-STATE-ABBREVIATION          PIC XX.
  3847         16  CF-STATE-NAME                  PIC X(25).
  3848         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3849         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3850             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3851             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3852             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3853             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3854                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3855                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3856             20  CF-ST-PREM-REJECT-SW       PIC X.
  3857                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3858                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3859             20  CF-ST-REF-REJECT-SW        PIC X.
  3860                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3861                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3862         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3863         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3864         16  CF-ST-REFUND-RULES.
  3865             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3866             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3867             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3868         16  CF-ST-FST-PMT-EXTENSION.
  3869             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3870             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3871                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3872                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3873                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3874                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3875         16  CF-ST-STATE-CALL.
  3876             20  CF-ST-CALL-UNEARNED        PIC X.
  3877             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3878             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  76
* EL130.cbl
  3879         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3880             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3881             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3882         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3883         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3884         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3885         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3886         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3887         16  FILLER                         PIC X.
  3888         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3889             20  CF-ST-BENEFIT-CD           PIC XX.
  3890             20  CF-ST-BENEFIT-KIND         PIC X.
  3891                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3892                 88  CF-ST-AH-KIND              VALUE 'A'.
  3893             20  CF-ST-REM-TERM-CALC        PIC X.
  3894                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3895                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3896                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3897                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3898                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3899                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3900                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3901                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3902
  3903             20  CF-ST-REFUND-CALC          PIC X.
  3904                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3905                 88  ST-REFD-BY-R78             VALUE '1'.
  3906                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3907                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3908                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3909                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3910                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3911                 88  ST-REFD-UTAH               VALUE '7'.
  3912                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3913                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3914                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3915
  3916             20  CF-ST-EARNING-CALC         PIC X.
  3917                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3918                 88  ST-EARN-BY-R78             VALUE '1'.
  3919                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3920                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3921                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3922                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3923                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3924                 88  ST-EARN-MEAN               VALUE '8'.
  3925                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3926
  3927             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3928                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3929                 88  ST-OVRD-BY-R78             VALUE '1'.
  3930                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3931                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3932                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3933                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3934                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3935                 88  ST-OVRD-MEAN               VALUE '8'.
  3936                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  77
* EL130.cbl
  3937             20  FILLER                     PIC X.
  3938
  3939         16  CF-ST-COMMISSION-CAPS.
  3940             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3941             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3942             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3943             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3944         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3945                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3946
  3947         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3948
  3949         16  CF-ST-STATUTORY-INTEREST.
  3950             20  CF-ST-STAT-DATE-FROM       PIC X.
  3951                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3952                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3953             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3954             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3955             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3956             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3957             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3958
  3959         16  CF-ST-OVER-SHORT.
  3960             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3961             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3962
  3963         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3964
  3965         16  CF-ST-RT-CALC                  PIC X.
  3966
  3967         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3968         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3969         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3970         16  CF-ST-RF-LR-CALC               PIC X.
  3971         16  CF-ST-RF-LL-CALC               PIC X.
  3972         16  CF-ST-RF-LN-CALC               PIC X.
  3973         16  CF-ST-RF-AH-CALC               PIC X.
  3974         16  CF-ST-RF-CP-CALC               PIC X.
  3975*        16  FILLER                         PIC X(206).
  3976*CIDMOD         16  FILLER                         PIC X(192).
  3977         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3978             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3979         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3980         16  CF-ST-VFY-2ND-BENE             PIC X.
  3981         16  FILLER                         PIC X(186).
  3982
  3983****************************************************************
  3984*             BENEFIT MASTER RECORD                            *
  3985****************************************************************
  3986
  3987     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3988         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3989             20  CF-BENEFIT-CODE            PIC XX.
  3990             20  CF-BENEFIT-NUMERIC  REDEFINES
  3991                 CF-BENEFIT-CODE            PIC XX.
  3992             20  CF-BENEFIT-ALPHA           PIC XXX.
  3993             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3994             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  78
* EL130.cbl
  3995
  3996             20  CF-LF-COVERAGE-TYPE        PIC X.
  3997                 88  CF-REDUCING                VALUE 'R'.
  3998                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3999
  4000             20  CF-SPECIAL-CALC-CD         PIC X.
  4001                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4002                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4003                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4004                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4005                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4006                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4007                 88  CF-FARM-PLAN               VALUE 'F'.
  4008                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4009                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4010                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4011                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4012                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4013                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4014                 88  CF-PRUDENTIAL              VALUE 'P'.
  4015                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4016                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4017                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4018                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4019                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4020                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4021
  4022             20  CF-JOINT-INDICATOR         PIC X.
  4023                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4024
  4025*            20  FILLER                     PIC X(12).
  4026             20  FILLER                     PIC X(11).
  4027             20  CF-BENEFIT-CATEGORY        PIC X.
  4028             20  CF-LOAN-TYPE               PIC X(8).
  4029
  4030             20  CF-CO-REM-TERM-CALC        PIC X.
  4031                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4032                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4033                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4034                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4035                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4036
  4037             20  CF-CO-EARNINGS-CALC        PIC X.
  4038                 88  CO-EARN-BY-R78             VALUE '1'.
  4039                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4040                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4041                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4042                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4043                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4044                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4045                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4046
  4047             20  CF-CO-REFUND-CALC          PIC X.
  4048                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4049                 88  CO-REFD-BY-R78             VALUE '1'.
  4050                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4051                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4052                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  79
* EL130.cbl
  4053                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4054                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4055                 88  CO-REFD-MEAN               VALUE '8'.
  4056                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4057                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4058                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4059
  4060             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4061                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4062                 88  CO-OVRD-BY-R78             VALUE '1'.
  4063                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4064                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4065                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4066                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4067                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4068                 88  CO-OVRD-MEAN               VALUE '8'.
  4069                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4070
  4071             20  CF-CO-BEN-I-G-CD           PIC X.
  4072                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4073                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4074                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4075
  4076         16  FILLER                         PIC X(304).
  4077
  4078
  4079****************************************************************
  4080*             CARRIER MASTER RECORD                            *
  4081****************************************************************
  4082
  4083     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4084         16  CF-ADDRESS-DATA.
  4085             20  CF-MAIL-TO-NAME            PIC X(30).
  4086             20  CF-IN-CARE-OF              PIC X(30).
  4087             20  CF-ADDRESS-LINE-1          PIC X(30).
  4088             20  CF-ADDRESS-LINE-2          PIC X(30).
  4089             20  CF-CITY-STATE              PIC X(30).
  4090             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4091             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4092
  4093         16  CF-CLAIM-NO-CONTROL.
  4094             20  CF-CLAIM-NO-METHOD         PIC X.
  4095                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4096                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4097                 88  CLAIM-NO-SEQ               VALUE '3'.
  4098                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4099             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4100                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4101                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4102                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4103
  4104         16  CF-CHECK-NO-CONTROL.
  4105             20  CF-CHECK-NO-METHOD         PIC X.
  4106                 88  CHECK-NO-MANUAL            VALUE '1'.
  4107                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4108                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4109                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4110             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  80
* EL130.cbl
  4111                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4112
  4113         16  CF-DOMICILE-STATE              PIC XX.
  4114
  4115         16  CF-EXPENSE-CONTROLS.
  4116             20  CF-EXPENSE-METHOD          PIC X.
  4117                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4118                 88  DOLLARS-PER-PMT            VALUE '2'.
  4119                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4120                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4121             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4122             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4123
  4124         16  CF-CORRESPONDENCE-CONTROL.
  4125             20  CF-LETTER-RESEND-OPT       PIC X.
  4126                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4127                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4128             20  FILLER                     PIC X(4).
  4129
  4130         16  CF-RESERVE-CONTROLS.
  4131             20  CF-MANUAL-SW               PIC X.
  4132                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4133             20  CF-FUTURE-SW               PIC X.
  4134                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4135             20  CF-PTC-SW                  PIC X.
  4136                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4137             20  CF-IBNR-SW                 PIC X.
  4138                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4139             20  CF-PTC-LF-SW               PIC X.
  4140                 88  CF-LF-PTC-USED             VALUE '1'.
  4141             20  CF-CDT-ACCESS-METHOD       PIC X.
  4142                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4143                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4144                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4145             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4146
  4147         16  CF-CLAIM-CALC-METHOD           PIC X.
  4148             88  360-PLUS-MONTHS                VALUE '1'.
  4149             88  365-PLUS-MONTHS                VALUE '2'.
  4150             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4151             88  360-DAILY                      VALUE '4'.
  4152             88  365-DAILY                      VALUE '5'.
  4153
  4154         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4155         16  FILLER                         PIC X(11).
  4156
  4157         16  CF-LIMIT-AMOUNTS.
  4158             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4159             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4160             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4161             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4162             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4163             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4164             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4165             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4166             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4167             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4168
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  81
* EL130.cbl
  4169         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4170         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4171         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4172
  4173         16  CF-ZIP-CODE.
  4174             20  CF-ZIP-PRIME.
  4175                 24  CF-ZIP-1ST             PIC X.
  4176                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4177                 24  FILLER                 PIC X(4).
  4178             20  CF-ZIP-PLUS4               PIC X(4).
  4179         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4180             20  CF-CAN-POSTAL-1            PIC XXX.
  4181             20  CF-CAN-POSTAL-2            PIC XXX.
  4182             20  FILLER                     PIC XXX.
  4183
  4184         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4185         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4186         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4187
  4188         16  CF-RATING-SWITCH               PIC X.
  4189             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4190             88  CF-NO-RATING                   VALUE 'N'.
  4191
  4192         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4193
  4194         16  CF-CARRIER-OVER-SHORT.
  4195             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4196             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4197
  4198         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4199         16  CF-SECPAY-SWITCH               PIC X.
  4200             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4201             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4202         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4203         16  FILLER                         PIC X(448).
  4204*        16  FILLER                         PIC X(452).
  4205
  4206
  4207****************************************************************
  4208*             MORTALITY MASTER RECORD                          *
  4209****************************************************************
  4210
  4211     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4212         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4213                                INDEXED BY CF-MORT-NDX.
  4214             20  CF-MORT-TABLE              PIC X(5).
  4215             20  CF-MORT-TABLE-TYPE         PIC X.
  4216                 88  CF-MORT-JOINT              VALUE 'J'.
  4217                 88  CF-MORT-SINGLE             VALUE 'S'.
  4218                 88  CF-MORT-COMBINED           VALUE 'C'.
  4219                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4220                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4221             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4222             20  CF-MORT-AGE-METHOD         PIC XX.
  4223                 88  CF-AGE-LAST                VALUE 'AL'.
  4224                 88  CF-AGE-NEAR                VALUE 'AN'.
  4225             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4226             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  82
* EL130.cbl
  4227                                            PIC X.
  4228                 88  CF-MINUS                   VALUE '-'.
  4229                 88  CF-PLUS                    VALUE '+'.
  4230             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4231             20  CF-MORT-JOINT-CODE         PIC X.
  4232                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4233             20  CF-MORT-PC-Q               PIC X.
  4234                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4235             20  CF-MORT-TABLE-CODE         PIC X(4).
  4236             20  CF-MORT-COMMENTS           PIC X(15).
  4237             20  FILLER                     PIC X(14).
  4238
  4239         16  FILLER                         PIC X(251).
  4240
  4241
  4242****************************************************************
  4243*             BUSSINESS TYPE MASTER RECORD                     *
  4244****************************************************************
  4245
  4246     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4247* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4248* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4249* AND RECORD 05 IS TYPES 81-99
  4250         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4251             20  CF-BUSINESS-TITLE          PIC  X(19).
  4252             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4253                                            PIC S9V9(4) COMP-3.
  4254             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4255             20  FILLER                     PIC  X.
  4256         16  FILLER                         PIC  X(248).
  4257
  4258
  4259****************************************************************
  4260*             TERMINAL MASTER RECORD                           *
  4261****************************************************************
  4262
  4263     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4264
  4265         16  CF-COMPANY-TERMINALS.
  4266             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4267                                  PIC X(4).
  4268         16  FILLER               PIC X(248).
  4269
  4270
  4271****************************************************************
  4272*             LIFE EDIT MASTER RECORD                          *
  4273****************************************************************
  4274
  4275     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4276         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4277             20  CF-LIFE-CODE-IN            PIC XX.
  4278             20  CF-LIFE-CODE-OUT           PIC XX.
  4279         16  FILLER                         PIC X(248).
  4280
  4281
  4282****************************************************************
  4283*             AH EDIT MASTER RECORD                            *
  4284****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  83
* EL130.cbl
  4285
  4286     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4287         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4288             20  CF-AH-CODE-IN              PIC XXX.
  4289             20  CF-AH-CODE-OUT             PIC XX.
  4290         16  FILLER                         PIC X(248).
  4291
  4292
  4293****************************************************************
  4294*             CREDIBILITY TABLES                               *
  4295****************************************************************
  4296
  4297     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4298         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4299                             INDEXED BY CF-CRDB-NDX.
  4300             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4301             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4302             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4303         16  FILLER                         PIC  X(332).
  4304
  4305
  4306****************************************************************
  4307*             REPORT CUSTOMIZATION RECORD                      *
  4308****************************************************************
  4309
  4310     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4311         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4312             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4313             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4314             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4315**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4316****       A T-TRANSFER.                                   ****
  4317             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4318
  4319         16  FILLER                         PIC XX.
  4320
  4321         16  CF-CARRIER-CNTL-OPT.
  4322             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4323                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4324                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4325             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4326                                            PIC X.
  4327         16  CF-GROUP-CNTL-OPT.
  4328             20  CF-GROUP-OPT-SEQ           PIC 9.
  4329                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4330                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4331             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4332                                            PIC X(6).
  4333         16  CF-STATE-CNTL-OPT.
  4334             20  CF-STATE-OPT-SEQ           PIC 9.
  4335                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4336                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4337             20  CF-STATE-SELECT OCCURS 3 TIMES
  4338                                            PIC XX.
  4339         16  CF-ACCOUNT-CNTL-OPT.
  4340             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4341                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4342                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  84
* EL130.cbl
  4343             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4344                                            PIC X(10).
  4345         16  CF-BUS-TYP-CNTL-OPT.
  4346             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4347                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4348                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4349             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4350                                            PIC XX.
  4351         16  CF-LF-TYP-CNTL-OPT.
  4352             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4353                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4354                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4355             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4356                                            PIC XX.
  4357         16  CF-AH-TYP-CNTL-OPT.
  4358             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4359                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4360                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4361             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4362                                            PIC XX.
  4363         16  CF-REPTCD1-CNTL-OPT.
  4364             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4365                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4366                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4367             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4368                                            PIC X(10).
  4369         16  CF-REPTCD2-CNTL-OPT.
  4370             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4371                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4372                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4373             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4374                                            PIC X(10).
  4375         16  CF-USER1-CNTL-OPT.
  4376             20  CF-USER1-OPT-SEQ           PIC 9.
  4377                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4378                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4379             20  CF-USER1-SELECT OCCURS 3 TIMES
  4380                                            PIC X(10).
  4381         16  CF-USER2-CNTL-OPT.
  4382             20  CF-USER2-OPT-SEQ           PIC 9.
  4383                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4384                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4385             20  CF-USER2-SELECT OCCURS 3 TIMES
  4386                                            PIC X(10).
  4387         16  CF-USER3-CNTL-OPT.
  4388             20  CF-USER3-OPT-SEQ           PIC 9.
  4389                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4390                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4391             20  CF-USER3-SELECT OCCURS 3 TIMES
  4392                                            PIC X(10).
  4393         16  CF-USER4-CNTL-OPT.
  4394             20  CF-USER4-OPT-SEQ           PIC 9.
  4395                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4396                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4397             20  CF-USER4-SELECT OCCURS 3 TIMES
  4398                                            PIC X(10).
  4399         16  CF-USER5-CNTL-OPT.
  4400             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  85
* EL130.cbl
  4401                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4402                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4403             20  CF-USER5-SELECT OCCURS 3 TIMES
  4404                                            PIC X(10).
  4405         16  CF-REINS-CNTL-OPT.
  4406             20  CF-REINS-OPT-SEQ           PIC 9.
  4407                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4408                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4409             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4410                 24  CF-REINS-PRIME         PIC XXX.
  4411                 24  CF-REINS-SUB           PIC XXX.
  4412
  4413         16  CF-AGENT-CNTL-OPT.
  4414             20  CF-AGENT-OPT-SEQ           PIC 9.
  4415                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4416                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4417             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4418                                            PIC X(10).
  4419
  4420         16  FILLER                         PIC X(43).
  4421
  4422         16  CF-LOSS-RATIO-SELECT.
  4423             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4424             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4425         16  CF-ENTRY-DATE-SELECT.
  4426             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4427             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4428         16  CF-EFFECTIVE-DATE-SELECT.
  4429             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4430             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4431
  4432         16  CF-EXCEPTION-LIST-IND          PIC X.
  4433             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4434
  4435         16  FILLER                         PIC X(318).
  4436
  4437****************************************************************
  4438*                  EXCEPTION REPORTING RECORD                  *
  4439****************************************************************
  4440
  4441     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4442         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4443             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4444
  4445         16  CF-COMBINED-LIFE-AH-OPT.
  4446             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4447             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4448             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4449             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4450
  4451         16  CF-LIFE-OPT.
  4452             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4453             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4454             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4455             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4456             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4457             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4458             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  86
* EL130.cbl
  4459             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4460             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4461             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4462
  4463         16  CF-AH-OPT.
  4464             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4465             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4466             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4467             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4468             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4469             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4470             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4471             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4472             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4473             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4474
  4475         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4476             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4477             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4478             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4479
  4480         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4481
  4482         16  FILLER                         PIC X(673).
  4483
  4484
  4485****************************************************************
  4486*             MORTGAGE SYSTEM PLAN RECORD                      *
  4487****************************************************************
  4488
  4489     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4490         16  CF-PLAN-TYPE                   PIC X.
  4491             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4492             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4493             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4494         16  CF-PLAN-ABBREV                 PIC XXX.
  4495         16  CF-PLAN-DESCRIPT               PIC X(10).
  4496         16  CF-PLAN-NOTES                  PIC X(20).
  4497         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4498         16  CF-PLAN-UNDERWRITING.
  4499             20  CF-PLAN-TERM-DATA.
  4500                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4501                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4502             20  CF-PLAN-AGE-DATA.
  4503                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4504                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4505                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4506             20  CF-PLAN-BENEFIT-DATA.
  4507                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4508                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4509                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4510                                            PIC S9(7)V99  COMP-3.
  4511         16  CF-PLAN-POLICY-FORMS.
  4512             20  CF-POLICY-FORM             PIC X(12).
  4513             20  CF-MASTER-APPLICATION      PIC X(12).
  4514             20  CF-MASTER-POLICY           PIC X(12).
  4515         16  CF-PLAN-RATING.
  4516             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  87
* EL130.cbl
  4517             20  CF-SEX-RATING              PIC X.
  4518                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4519                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4520             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4521             20  CF-SUB-STD-TYPE            PIC X.
  4522                 88  CF-PCT-OF-PREM            VALUE '1'.
  4523                 88  CF-PCT-OF-BENE            VALUE '2'.
  4524         16  CF-PLAN-PREM-TOLERANCES.
  4525             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4526             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4527         16  CF-PLAN-PYMT-TOLERANCES.
  4528             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4529             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4530         16  CF-PLAN-MISC-DATA.
  4531             20  FILLER                     PIC X.
  4532             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4533             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4534         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4535         16  CF-PLAN-IND-GRP                PIC X.
  4536             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4537                                                     '1'.
  4538             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4539                                                     '2'.
  4540         16  CF-MIB-SEARCH-SW               PIC X.
  4541             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4542             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4543             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4544             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4545         16  CF-ALPHA-SEARCH-SW             PIC X.
  4546             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4547             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4548             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4549             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4550             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4551             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4552             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4553             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4554             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4555             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4556                                                     'A' 'B' 'C'
  4557                                                     'X' 'Y' 'Z'.
  4558         16  CF-EFF-DT-RULE-SW              PIC X.
  4559             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4560             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4561             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4562             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4563             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4564         16  FILLER                         PIC X(4).
  4565         16  CF-HEALTH-QUESTIONS            PIC X.
  4566             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4567         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4568         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4569         16  CF-PLAN-SNGL-JNT               PIC X.
  4570             88  CF-COMBINED-PLAN              VALUE 'C'.
  4571             88  CF-JNT-PLAN                   VALUE 'J'.
  4572             88  CF-SNGL-PLAN                  VALUE 'S'.
  4573         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4574         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  88
* EL130.cbl
  4575         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4576         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4577         16  CF-RERATE-CNTL                 PIC  X.
  4578             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4579             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4580             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4581             88  CF-AUTO-RECALC                 VALUE '4'.
  4582         16  CF-BENEFIT-TYPE                PIC  X.
  4583             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4584             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4585         16  CF-POLICY-FEE                  PIC S999V99
  4586                                                    COMP-3.
  4587         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4588         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4589         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4590         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4591         16  FILLER                         PIC  X(32).
  4592         16  CF-TERMINATION-FORM            PIC  X(04).
  4593         16  FILLER                         PIC  X(08).
  4594         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4595                                                       COMP-3.
  4596         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4597         16  CF-ISSUE-LETTER                PIC  X(4).
  4598         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4599         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4600             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4601             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4602         16  CF-MP-REFUND-CALC              PIC X.
  4603             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4604             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4605             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4606             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4607             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4608             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4609             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4610             88  CF-MP-REFD-MEAN                VALUE '8'.
  4611         16  CF-ALT-RATE-CODE               PIC  X(5).
  4612
  4613
  4614         16  FILLER                         PIC X(498).
  4615****************************************************************
  4616*             MORTGAGE COMPANY MASTER RECORD                   *
  4617****************************************************************
  4618
  4619     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4620         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4621         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4622             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4623             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4624             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4625             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4626             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4627
  4628         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4629         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4630         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4631         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4632         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  89
* EL130.cbl
  4633
  4634         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4635             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4636         16  CF-MP-RECON-USE-IND            PIC X(1).
  4637             88  CF-MP-USE-RECON             VALUE 'Y'.
  4638         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4639             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4640         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4641             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4642             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4643         16  FILLER                         PIC X(1).
  4644         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4645             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4646         16  CF-MORTG-MIB-VERSION           PIC X.
  4647             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4648             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4649             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4650         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4651             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4652                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4653             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4654                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4655             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4656                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4657             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4658                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4659             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4660                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4661             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4662                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4663         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4664         16  FILLER                         PIC X(7).
  4665         16  CF-MORTG-DESTINATION-SYMBOL.
  4666             20  CF-MORTG-MIB-COMM          PIC X(5).
  4667             20  CF-MORTG-MIB-TERM          PIC X(5).
  4668         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4669             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4670         16  FILLER                         PIC X(03).
  4671         16  CF-MP-CHECK-NO-CONTROL.
  4672             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4673                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4674                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4675                                                ' ' LOW-VALUES.
  4676                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4677                                               VALUE '3'.
  4678         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4679         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4680         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4681             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4682                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4683             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4684                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4685             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4686                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4687             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4688                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4689             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4690                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  90
* EL130.cbl
  4691             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4692                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4693         16  CF-MORTG-BILLING-AREA.
  4694             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4695                                            PIC X.
  4696         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4697         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4698         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4699         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4700             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4701             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4702         16  FILLER                         PIC X.
  4703         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4704             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4705             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4706         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4707         16  FILLER                         PIC X(8).
  4708         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4709         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4710         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4711         16  CF-ACH-COMPANY-ID.
  4712             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4713                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4714                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4715                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4716             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4717         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4718             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4719         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4720             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4721             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4722         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4723         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4724         16  FILLER                         PIC X(536).
  4725
  4726****************************************************************
  4727*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4728****************************************************************
  4729
  4730     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4731         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4732             20  CF-FEMALE-HEIGHT.
  4733                 24  CF-FEMALE-FT           PIC 99.
  4734                 24  CF-FEMALE-IN           PIC 99.
  4735             20  CF-FEMALE-MIN-WT           PIC 999.
  4736             20  CF-FEMALE-MAX-WT           PIC 999.
  4737         16  FILLER                         PIC X(428).
  4738
  4739     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4740         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4741             20  CF-MALE-HEIGHT.
  4742                 24  CF-MALE-FT             PIC 99.
  4743                 24  CF-MALE-IN             PIC 99.
  4744             20  CF-MALE-MIN-WT             PIC 999.
  4745             20  CF-MALE-MAX-WT             PIC 999.
  4746         16  FILLER                         PIC X(428).
  4747******************************************************************
  4748*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  91
* EL130.cbl
  4749******************************************************************
  4750     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4751         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4752             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4753             20  CF-SYS-LETTER-ID           PIC X(04).
  4754             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4755             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4756             20  CF-SYS-RESET-SW            PIC X(01).
  4757             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4758             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4759
  4760         16  FILLER                         PIC X(50).
  4761
  4762         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4763             20  CF-USER-ACTIVE-SW          PIC X(01).
  4764             20  CF-USER-LETTER-ID          PIC X(04).
  4765             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4766             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4767             20  CF-USER-RESET-SW           PIC X(01).
  4768             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4769             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4770             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4771
  4772         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  92
* EL130.cbl
  4774*    COPY ELCCERT.
  4775******************************************************************
  4776*                                                                *
  4777*                            ELCCERT.                            *
  4778*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4779*                            VMOD=2.013                          *
  4780*                                                                *
  4781*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4782*                                                                *
  4783*   FILE TYPE = VSAM,KSDS                                        *
  4784*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4785*                                                                *
  4786*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4787*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4788*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4789*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4790*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4791*                                                                *
  4792*   LOG = YES                                                    *
  4793*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4794******************************************************************
  4795*                   C H A N G E   L O G
  4796*
  4797* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4798*-----------------------------------------------------------------
  4799*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4800* EFFECTIVE    NUMBER
  4801*-----------------------------------------------------------------
  4802* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4803* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4804* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4805* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4806* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4807* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4808* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4809******************************************************************
  4810
  4811 01  CERTIFICATE-MASTER.
  4812     12  CM-RECORD-ID                      PIC XX.
  4813         88  VALID-CM-ID                      VALUE 'CM'.
  4814
  4815     12  CM-CONTROL-PRIMARY.
  4816         16  CM-COMPANY-CD                 PIC X.
  4817         16  CM-CARRIER                    PIC X.
  4818         16  CM-GROUPING.
  4819             20  CM-GROUPING-PREFIX        PIC X(3).
  4820             20  CM-GROUPING-PRIME         PIC X(3).
  4821         16  CM-STATE                      PIC XX.
  4822         16  CM-ACCOUNT.
  4823             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4824             20  CM-ACCOUNT-PRIME          PIC X(6).
  4825         16  CM-CERT-EFF-DT                PIC XX.
  4826         16  CM-CERT-NO.
  4827             20  CM-CERT-PRIME             PIC X(10).
  4828             20  CM-CERT-SFX               PIC X.
  4829
  4830     12  CM-CONTROL-BY-NAME.
  4831         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  93
* EL130.cbl
  4832         16  CM-INSURED-LAST-NAME          PIC X(15).
  4833         16  CM-INSURED-INITIALS.
  4834             20  CM-INSURED-INITIAL1       PIC X.
  4835             20  CM-INSURED-INITIAL2       PIC X.
  4836
  4837     12  CM-CONTROL-BY-SSN.
  4838         16  CM-COMPANY-CD-A2              PIC X.
  4839         16  CM-SOC-SEC-NO.
  4840             20  CM-SSN-STATE              PIC XX.
  4841             20  CM-SSN-ACCOUNT            PIC X(6).
  4842             20  CM-SSN-LN3.
  4843                 25  CM-INSURED-INITIALS-A2.
  4844                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4845                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4846                 25 CM-PART-LAST-NAME-A2         PIC X.
  4847
  4848     12  CM-CONTROL-BY-CERT-NO.
  4849         16  CM-COMPANY-CD-A4              PIC X.
  4850         16  CM-CERT-NO-A4                 PIC X(11).
  4851
  4852     12  CM-CONTROL-BY-MEMB.
  4853         16  CM-COMPANY-CD-A5              PIC X.
  4854         16  CM-MEMBER-NO.
  4855             20  CM-MEMB-STATE             PIC XX.
  4856             20  CM-MEMB-ACCOUNT           PIC X(6).
  4857             20  CM-MEMB-LN4.
  4858                 25  CM-INSURED-INITIALS-A5.
  4859                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4860                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4861                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4862
  4863     12  CM-INSURED-PROFILE-DATA.
  4864         16  CM-INSURED-FIRST-NAME.
  4865             20  CM-INSURED-1ST-INIT       PIC X.
  4866             20  FILLER                    PIC X(9).
  4867         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4868         16  CM-INSURED-SEX                PIC X.
  4869             88  CM-SEX-MALE                  VALUE 'M'.
  4870             88  CM-SEX-FEMAL                 VALUE 'F'.
  4871         16  CM-INSURED-JOINT-AGE          PIC 99.
  4872         16  CM-JOINT-INSURED-NAME.
  4873             20  CM-JT-LAST-NAME           PIC X(15).
  4874             20  CM-JT-FIRST-NAME.
  4875                 24  CM-JT-1ST-INIT        PIC X.
  4876                 24  FILLER                PIC X(9).
  4877             20  CM-JT-INITIAL             PIC X.
  4878
  4879     12  CM-LIFE-DATA.
  4880         16  CM-LF-BENEFIT-CD              PIC XX.
  4881         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4882         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4883         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4884         16  CM-LF-DEV-CODE                PIC XXX.
  4885         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4886         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4887         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4888         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4889         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  94
* EL130.cbl
  4890         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4891         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4892         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4893         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4894         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4895         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4896         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4897         16  FILLER                        PIC XX.
  4898
  4899     12  CM-AH-DATA.
  4900         16  CM-AH-BENEFIT-CD              PIC XX.
  4901         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4902         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4903         16  CM-AH-DEV-CODE                PIC XXX.
  4904         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4905         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4906         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4907         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4908         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4909         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4910         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4911         16  CM-AH-PAID-THRU-DT            PIC XX.
  4912             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4913         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4914         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4915         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4916         16  FILLER                        PIC X.
  4917
  4918     12  CM-LOAN-INFORMATION.
  4919         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4920         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4921                                           PIC S9(5)V99  COMP-3.
  4922         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4923         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4924         16  CM-PAY-FREQUENCY              PIC S99.
  4925         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4926         16  CM-RATE-CLASS                 PIC XX.
  4927         16  CM-BENEFICIARY                PIC X(25).
  4928         16  CM-POLICY-FORM-NO             PIC X(12).
  4929         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4930         16  CM-LAST-ADD-ON-DT             PIC XX.
  4931         16  CM-DEDUCTIBLE-AMOUNTS.
  4932             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4933             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4934         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4935             20  CM-RESIDENT-STATE         PIC XX.
  4936             20  CM-RATE-CODE              PIC X(4).
  4937             20  FILLER                    PIC XX.
  4938         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4939             20  CM-LOAN-OFFICER           PIC X(5).
  4940             20  FILLER                    PIC XXX.
  4941         16  CM-CSR-CODE                   PIC XXX.
  4942         16  CM-UNDERWRITING-CODE          PIC X.
  4943             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4944         16  CM-POST-CARD-IND              PIC X.
  4945         16  CM-NH-INTERFACE-SW            PIC X.
  4946         16  CM-PREMIUM-TYPE               PIC X.
  4947             88  CM-SING-PRM                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  95
* EL130.cbl
  4948             88  CM-O-B-COVERAGE              VALUE '2'.
  4949             88  CM-OPEN-END                  VALUE '3'.
  4950         16  CM-IND-GRP-TYPE               PIC X.
  4951             88  CM-INDIVIDUAL                VALUE 'I'.
  4952             88  CM-GROUP                     VALUE 'G'.
  4953         16  CM-SKIP-CODE                  PIC X.
  4954             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4955             88  SKIP-JULY                    VALUE '1'.
  4956             88  SKIP-AUGUST                  VALUE '2'.
  4957             88  SKIP-SEPTEMBER               VALUE '3'.
  4958             88  SKIP-JULY-AUG                VALUE '4'.
  4959             88  SKIP-AUG-SEPT                VALUE '5'.
  4960             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4961             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4962             88  SKIP-JUNE                    VALUE '8'.
  4963             88  SKIP-JUNE-JULY               VALUE '9'.
  4964             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4965             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4966         16  CM-PAYMENT-MODE               PIC X.
  4967             88  PAY-MONTHLY                  VALUE SPACE.
  4968             88  PAY-WEEKLY                   VALUE '1'.
  4969             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4970             88  PAY-BI-WEEKLY                VALUE '3'.
  4971             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4972         16  CM-LOAN-NUMBER                PIC X(8).
  4973         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4974         16  CM-OLD-LOF                    PIC XXX.
  4975*        16  CM-LOAN-OFFICER               PIC XXX.
  4976         16  CM-REIN-TABLE                 PIC XXX.
  4977         16  CM-SPECIAL-REIN-CODE          PIC X.
  4978         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4979         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4980         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4981
  4982     12  CM-STATUS-DATA.
  4983         16  CM-ENTRY-STATUS               PIC X.
  4984         16  CM-ENTRY-DT                   PIC XX.
  4985
  4986         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4987         16  CM-LF-CANCEL-DT               PIC XX.
  4988         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4989
  4990         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4991         16  CM-LF-DEATH-DT                PIC XX.
  4992         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4993
  4994         16  CM-LF-CURRENT-STATUS          PIC X.
  4995             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4996                                                'M' '4' '5' '9'.
  4997             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4998             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4999             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5000             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5001             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5002             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5003             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5004             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5005             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  96
* EL130.cbl
  5006             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5007             88  CM-LF-DECLINED               VALUE 'D'.
  5008             88  CM-LF-VOIDED                 VALUE 'V'.
  5009
  5010         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5011         16  CM-AH-CANCEL-DT               PIC XX.
  5012         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5013
  5014         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5015         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5016         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5017
  5018         16  CM-AH-CURRENT-STATUS          PIC X.
  5019             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5020                                                'M' '4' '5' '9'.
  5021             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5022             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5023             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5024             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5025             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5026             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5027             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5028             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5029             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5030             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5031             88  CM-AH-DECLINED               VALUE 'D'.
  5032             88  CM-AH-VOIDED                 VALUE 'V'.
  5033
  5034         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5035             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5036             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5037             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5038         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5039
  5040         16  CM-ENTRY-BATCH                PIC X(6).
  5041         16  CM-LF-EXIT-BATCH              PIC X(6).
  5042         16  CM-AH-EXIT-BATCH              PIC X(6).
  5043         16  CM-LAST-MONTH-END             PIC XX.
  5044
  5045     12  CM-NOTE-SW                        PIC X.
  5046         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5047         88  CERT-NOTES-PRESENT               VALUE '1'.
  5048         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5049         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5050         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5051         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5052         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5053         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5054     12  CM-COMP-EXCP-SW                   PIC X.
  5055         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5056         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5057     12  CM-INSURED-ADDRESS-SW             PIC X.
  5058         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5059         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5060
  5061*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5062     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5063     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  97
* EL130.cbl
  5064
  5065*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5066     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5067     12  FILLER                            PIC X.
  5068*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5069     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5070
  5071     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5072         88  CERT-ADDED-BATCH                 VALUE ' '.
  5073         88  CERT-ADDED-ONLINE                VALUE '1'.
  5074         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5075         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5076         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5077     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5078         88  CERT-AS-LOADED                   VALUE ' '.
  5079         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5080         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5081         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5082         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5083         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5084         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5085         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5086
  5087     12  CM-ACCOUNT-COMM-PCTS.
  5088         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5089         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5090
  5091     12  CM-USER-FIELD                     PIC X.
  5092     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5093     12  CM-CLP-STATE                      PIC XX.
  5094     12  CM-USER-RESERVED                  PIC XXX.
  5095******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  98
* EL130.cbl
  5097*    COPY ERCACCT.
  5098******************************************************************
  5099*                                                                *
  5100*                                                                *
  5101*                            ERCACCT                             *
  5102*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5103*                            VMOD=2.031                          *
  5104*                                                                *
  5105*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5106*                                                                *
  5107*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5108*   VSAM ACCOUNT MASTER FILES.                                   *
  5109*                                                                *
  5110*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5111*                                                                *
  5112*   FILE TYPE = VSAM,KSDS                                        *
  5113*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5114*                                                                *
  5115*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5116*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5117*                                                                *
  5118*   LOG = NO                                                     *
  5119*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5120*                                                                *
  5121*                                                                *
  5122******************************************************************
  5123*                   C H A N G E   L O G
  5124*
  5125* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5126*-----------------------------------------------------------------
  5127*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5128* EFFECTIVE    NUMBER
  5129*-----------------------------------------------------------------
  5130* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5131* 092705    2005050300006  PEMA  ADD SPP LEASES
  5132* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5133* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5134* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5135* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5136******************************************************************
  5137
  5138 01  ACCOUNT-MASTER.
  5139     12  AM-RECORD-ID                      PIC XX.
  5140         88  VALID-AM-ID                      VALUE 'AM'.
  5141
  5142     12  AM-CONTROL-PRIMARY.
  5143         16  AM-COMPANY-CD                 PIC X.
  5144         16  AM-MSTR-CNTRL.
  5145             20  AM-CONTROL-A.
  5146                 24  AM-CARRIER            PIC X.
  5147                 24  AM-GROUPING.
  5148                     28 AM-GROUPING-PREFIX PIC XXX.
  5149                     28 AM-GROUPING-PRIME  PIC XXX.
  5150                 24  AM-STATE              PIC XX.
  5151                 24  AM-ACCOUNT.
  5152                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5153                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5154             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  99
* EL130.cbl
  5155                                           PIC X(19).
  5156             20  AM-CNTRL-B.
  5157                 24  AM-EXPIRATION-DT      PIC XX.
  5158                 24  FILLER                PIC X(4).
  5159             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5160                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5161
  5162     12  AM-CONTROL-BY-VAR-GRP.
  5163         16  AM-COMPANY-CD-A1              PIC X.
  5164         16  AM-VG-CARRIER                 PIC X.
  5165         16  AM-VG-GROUPING                PIC X(6).
  5166         16  AM-VG-STATE                   PIC XX.
  5167         16  AM-VG-ACCOUNT                 PIC X(10).
  5168         16  AM-VG-DATE.
  5169             20  AM-VG-EXPIRATION-DT       PIC XX.
  5170             20  FILLER                    PIC X(4).
  5171         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5172                                           PIC 9(11)      COMP-3.
  5173     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5174         16  FILLER                        PIC X(10).
  5175         16  AM-VG-KEY3.
  5176             20  AM-VG3-ACCOUNT            PIC X(10).
  5177             20  AM-VG3-EXP-DT             PIC XX.
  5178         16  FILLER                        PIC X(4).
  5179     12  AM-MAINT-INFORMATION.
  5180         16  AM-LAST-MAINT-DT              PIC XX.
  5181         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5182         16  AM-LAST-MAINT-USER            PIC X(4).
  5183         16  FILLER                        PIC XX.
  5184
  5185     12  AM-EFFECTIVE-DT                   PIC XX.
  5186     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5187
  5188     12  AM-PREV-DATES  COMP-3.
  5189         16  AM-PREV-EXP-DT                PIC 9(11).
  5190         16  AM-PREV-EFF-DT                PIC 9(11).
  5191
  5192     12  AM-REPORT-CODE-1                  PIC X(10).
  5193     12  AM-REPORT-CODE-2                  PIC X(10).
  5194
  5195     12  AM-CITY-CODE                      PIC X(4).
  5196     12  AM-COUNTY-PARISH                  PIC X(6).
  5197
  5198     12  AM-NAME                           PIC X(30).
  5199     12  AM-PERSON                         PIC X(30).
  5200     12  AM-ADDRS                          PIC X(30).
  5201     12  AM-CITY.
  5202         16  AM-ADDR-CITY                  PIC X(28).
  5203         16  AM-ADDR-STATE                 PIC XX.
  5204     12  AM-ZIP.
  5205         16  AM-ZIP-PRIME.
  5206             20  AM-ZIP-PRI-1ST            PIC X.
  5207                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5208             20  FILLER                    PIC X(4).
  5209         16  AM-ZIP-PLUS4                  PIC X(4).
  5210     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5211         16  AM-CAN-POSTAL-1               PIC XXX.
  5212         16  AM-CAN-POSTAL-2               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 100
* EL130.cbl
  5213         16  FILLER                        PIC XXX.
  5214     12  AM-TEL-NO.
  5215         16  AM-AREA-CODE                  PIC 999.
  5216         16  AM-TEL-PRE                    PIC 999.
  5217         16  AM-TEL-NBR                    PIC 9(4).
  5218     12  AM-TEL-LOC                        PIC X.
  5219         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5220         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5221
  5222     12  AM-COMM-STRUCTURE.
  5223         16  AM-DEFN-1.
  5224             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5225                 24  AM-AGT.
  5226                     28  AM-AGT-PREFIX     PIC X(4).
  5227                     28  AM-AGT-PRIME      PIC X(6).
  5228                 24  AM-COM-TYP            PIC X.
  5229                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5230                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5231                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5232                 24  AM-RECALC-LV-INDIC    PIC X.
  5233                 24  AM-RETRO-LV-INDIC     PIC X.
  5234                 24  AM-GL-CODES           PIC X.
  5235                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5236                 24  FILLER                PIC X(01).
  5237         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5238             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5239                 24  FILLER                PIC X(11).
  5240                 24  AM-L-COMA             PIC XXX.
  5241                 24  AM-J-COMA             PIC XXX.
  5242                 24  AM-A-COMA             PIC XXX.
  5243                 24  FILLER                PIC X(6).
  5244
  5245     12  AM-COMM-CHANGE-STATUS             PIC X.
  5246         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5247
  5248     12  AM-CSR-CODE                       PIC X(4).
  5249
  5250     12  AM-BILLING-STATUS                 PIC X.
  5251         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5252         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5253     12  AM-AUTO-REFUND-SW                 PIC X.
  5254         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5255         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5256     12  AM-GPCD                           PIC 99.
  5257     12  AM-IG                             PIC X.
  5258         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5259         88  AM-HAS-GROUP                     VALUE '2'.
  5260     12  AM-STATUS                         PIC X.
  5261         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5262         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5263         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5264         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5265         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5266         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5267     12  AM-REMIT-TO                       PIC 99.
  5268     12  AM-ID-NO                          PIC X(11).
  5269
  5270     12  AM-CAL-TABLE                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 101
* EL130.cbl
  5271     12  AM-LF-DEVIATION                   PIC XXX.
  5272     12  AM-AH-DEVIATION                   PIC XXX.
  5273     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5274     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5275     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5276     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5277     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5278     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5279
  5280     12  AM-USER-FIELDS.
  5281         16  AM-FLD-1                      PIC XX.
  5282         16  AM-FLD-2                      PIC XX.
  5283         16  AM-FLD-3                      PIC XX.
  5284         16  AM-FLD-4                      PIC XX.
  5285         16  AM-FLD-5                      PIC XX.
  5286
  5287     12  AM-1ST-PROD-DATE.
  5288         16  AM-1ST-PROD-YR                PIC XX.
  5289         16  AM-1ST-PROD-MO                PIC XX.
  5290         16  AM-1ST-PROD-DA                PIC XX.
  5291     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5292     12  AM-CERTS-PURGED-DATE.
  5293         16  AM-PUR-YR                     PIC XX.
  5294         16  AM-PUR-MO                     PIC XX.
  5295         16  AM-PUR-DA                     PIC XX.
  5296     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5297     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5298     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5299     12  AM-INACTIVE-DATE.
  5300         16  AM-INA-MO                     PIC 99.
  5301         16  AM-INA-DA                     PIC 99.
  5302         16  AM-INA-YR                     PIC 99.
  5303     12  AM-AR-HI-CERT-DATE                PIC XX.
  5304
  5305     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5306     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5307
  5308     12  AM-OB-PAYMENT-MODE                PIC X.
  5309         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5310         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5311         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5312         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5313
  5314     12  AM-AH-ONLY-INDICATOR              PIC X.
  5315         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5316         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5317
  5318     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5319
  5320     12  AM-OVER-SHORT.
  5321         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5322         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5323
  5324     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5325     12  AM-DCC-CLP-STATE                  PIC XX.
  5326
  5327     12  AM-RECALC-COMM                    PIC X.
  5328     12  AM-RECALC-REIN                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 102
* EL130.cbl
  5329
  5330     12  AM-REI-TABLE                      PIC XXX.
  5331     12  AM-REI-ET-LF                      PIC X.
  5332     12  AM-REI-ET-AH                      PIC X.
  5333     12  AM-REI-PE-LF                      PIC X.
  5334     12  AM-REI-PE-AH                      PIC X.
  5335     12  AM-REI-PRT-ST                     PIC X.
  5336     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5337     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5338     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5339     12  AM-REI-GROUP-A                    PIC X(6).
  5340     12  AM-REI-MORT                       PIC X(4).
  5341     12  AM-REI-PRT-OW                     PIC X.
  5342     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5343     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5344     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5345     12  AM-REI-GROUP-B                    PIC X(6).
  5346
  5347     12  AM-TRUST-TYPE                     PIC X(2).
  5348
  5349     12  AM-EMPLOYER-STMT-USED             PIC X.
  5350     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5351
  5352     12  AM-STD-AH-TYPE                    PIC XX.
  5353     12  AM-EARN-METHODS.
  5354         16  AM-EARN-METHOD-R              PIC X.
  5355             88 AM-REF-RL-R78                 VALUE 'R'.
  5356             88 AM-REF-RL-PR                  VALUE 'P'.
  5357             88 AM-REF-RL-MEAN                VALUE 'M'.
  5358             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5359         16  AM-EARN-METHOD-L              PIC X.
  5360             88 AM-REF-LL-R78                 VALUE 'R'.
  5361             88 AM-REF-LL-PR                  VALUE 'P'.
  5362             88 AM-REF-LL-MEAN                VALUE 'M'.
  5363             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5364         16  AM-EARN-METHOD-A              PIC X.
  5365             88 AM-REF-AH-R78                 VALUE 'R'.
  5366             88 AM-REF-AH-PR                  VALUE 'P'.
  5367             88 AM-REF-AH-MEAN                VALUE 'M'.
  5368             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5369             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5370             88 AM-REF-AH-NET                 VALUE 'N'.
  5371
  5372     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5373     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5374     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5375
  5376     12  AM-RET-Y-N                        PIC X.
  5377     12  AM-RET-P-E                        PIC X.
  5378     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5379     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5380     12  AM-RET-GRP                        PIC X(6).
  5381     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5382         16  AM-POOL-PRIME                 PIC XXX.
  5383         16  AM-POOL-SUB                   PIC XXX.
  5384     12  AM-RETRO-EARNINGS.
  5385         16  AM-RET-EARN-R                 PIC X.
  5386         16  AM-RET-EARN-L                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 103
* EL130.cbl
  5387         16  AM-RET-EARN-A                 PIC X.
  5388     12  AM-RET-ST-TAX-USE                 PIC X.
  5389         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5390         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5391     12  AM-RETRO-BEG-EARNINGS.
  5392         16  AM-RET-BEG-EARN-R             PIC X.
  5393         16  AM-RET-BEG-EARN-L             PIC X.
  5394         16  AM-RET-BEG-EARN-A             PIC X.
  5395     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5396     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5397
  5398     12  AM-USER-SELECT-OPTIONS.
  5399         16  AM-USER-SELECT-1              PIC X(10).
  5400         16  AM-USER-SELECT-2              PIC X(10).
  5401         16  AM-USER-SELECT-3              PIC X(10).
  5402         16  AM-USER-SELECT-4              PIC X(10).
  5403         16  AM-USER-SELECT-5              PIC X(10).
  5404
  5405     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5406
  5407     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5408
  5409     12  AM-RPT045A-SWITCH                 PIC X.
  5410         88  RPT045A-OFF                   VALUE 'N'.
  5411
  5412     12  AM-INSURANCE-LIMITS.
  5413         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5414         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5415
  5416     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5417         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5418
  5419     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5420         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5421         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5422
  5423     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5424
  5425     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5426     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5427     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5428     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5429     12  FILLER                            PIC X(5).
  5430     12  AM-REPORT-CODE-3                  PIC X(10).
  5431*    12  FILLER                            PIC X(22).
  5432
  5433     12  AM-RESERVE-DATE.
  5434         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5435         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5436         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5437
  5438     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5439     12  AM-NOTIFICATION-TYPES.
  5440         16  AM-NOTIF-OF-LETTERS           PIC X.
  5441         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5442         16  AM-NOTIF-OF-REPORTS           PIC X.
  5443         16  AM-NOTIF-OF-STATUS            PIC X.
  5444
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 104
* EL130.cbl
  5445     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5446         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5447         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5448         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5449         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5450
  5451     12  AM-BENEFIT-CONTROLS.
  5452         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5453             20  AM-BENEFIT-CODE           PIC XX.
  5454             20  AM-BENEFIT-TYPE           PIC X.
  5455             20  AM-BENEFIT-REVISION       PIC XXX.
  5456             20  AM-BENEFIT-REM-TERM       PIC X.
  5457             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5458             20  FILLER                    PIC XX.
  5459         16  FILLER                        PIC X(80).
  5460
  5461     12  AM-TRANSFER-DATA.
  5462         16  AM-TRANSFERRED-FROM.
  5463             20  AM-TRNFROM-CARRIER        PIC X.
  5464             20  AM-TRNFROM-GROUPING.
  5465                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5466                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5467             20  AM-TRNFROM-STATE          PIC XX.
  5468             20  AM-TRNFROM-ACCOUNT.
  5469                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5470                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5471             20  AM-TRNFROM-DTE            PIC XX.
  5472         16  AM-TRANSFERRED-TO.
  5473             20  AM-TRNTO-CARRIER          PIC X.
  5474             20  AM-TRNTO-GROUPING.
  5475                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5476                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5477             20  AM-TRNTO-STATE            PIC XX.
  5478             20  AM-TRNTO-ACCOUNT.
  5479                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5480                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5481             20  AM-TRNTO-DTE              PIC XX.
  5482         16  FILLER                        PIC X(10).
  5483
  5484     12  AM-SAVED-REMIT-TO                 PIC 99.
  5485
  5486     12  AM-COMM-STRUCTURE-SAVED.
  5487         16  AM-DEFN-1-SAVED.
  5488             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5489                 24  AM-AGT-SV             PIC X(10).
  5490                 24  AM-COM-TYP-SV         PIC X.
  5491                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5492                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5493                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5494                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5495                 24  FILLER                PIC X.
  5496                 24  AM-GL-CODES-SV        PIC X.
  5497                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5498                 24  FILLER                PIC X.
  5499         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5500             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5501                 24  FILLER                PIC X(11).
  5502                 24  AM-L-COMA-SV          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 105
* EL130.cbl
  5503                 24  AM-J-COMA-SV          PIC XXX.
  5504                 24  AM-A-COMA-SV          PIC XXX.
  5505                 24  FILLER                PIC X(6).
  5506
  5507     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5508         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5509            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5510            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5511            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5512
  5513     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5514     12  FILLER                            PIC X(120).
  5515
  5516     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5517         16  AM-CONTROL-NAME               PIC X(30).
  5518         16  AM-EXECUTIVE-ONE.
  5519             20  AM-EXEC1-NAME             PIC X(15).
  5520             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5521                                                          COMP-3.
  5522             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5523                                                          COMP-3.
  5524         16  AM-EXECUTIVE-TWO.
  5525             20  AM-EXEC2-NAME             PIC X(15).
  5526             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5527                                                          COMP-3.
  5528             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5529                                                          COMP-3.
  5530
  5531     12  AM-RETRO-ADDITIONAL-DATA.
  5532         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5533         16  AM-RETRO-PREM-P-E             PIC X.
  5534         16  AM-RETRO-CLMS-P-I             PIC X.
  5535         16  AM-RETRO-RET-BRACKET-LF.
  5536             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5537                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5538                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5539             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5540                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5541                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5542             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5543                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5544                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5545         16  AM-RETRO-RET-BRACKET-AH.
  5546             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5547                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5548                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5549                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5550             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5551                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5552                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5553             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5554                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5555                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5556
  5557     12  AM-COMMENTS.
  5558         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5559
  5560     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 106
* EL130.cbl
  5561         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5562         16  AM-FLI-BILLING-CODE           PIC X.
  5563         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5564         16  AM-FLI-UNITED-IDENT           PIC X.
  5565         16  AM-FLI-INTEREST-LOST-DATA.
  5566             20  AM-FLI-BANK-NO            PIC X(5).
  5567             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5568             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5569             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5570         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5571             20  AM-FLI-AGT                PIC X(9).
  5572             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5573             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5574         16  FILLER                        PIC X(102).
  5575
  5576     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5577         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5578             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5579             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5580             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5581             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5582             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5583         16  FILLER                          PIC X(10).
  5584******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 107
* EL130.cbl
  5586*    COPY ELCTRLR.
  5587******************************************************************
  5588*                                                                *
  5589*                            ELCTRLR.                            *
  5590*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5591*                            VMOD=2.014                          *
  5592*                                                                *
  5593*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5594*                                                                *
  5595*   FILE TYPE = VSAM,KSDS                                        *
  5596*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5597*                                                                *
  5598*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5599*       ALTERNATE INDEX = NONE                                   *
  5600*                                                                *
  5601*   LOG = YES                                                    *
  5602*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5603******************************************************************
  5604*                   C H A N G E   L O G
  5605*
  5606* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5607*-----------------------------------------------------------------
  5608*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5609* EFFECTIVE    NUMBER
  5610*-----------------------------------------------------------------
  5611* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5612* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5613* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5614* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5615* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5616* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5617* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5618* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5619* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5620* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5621* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5622* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5623* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5624******************************************************************
  5625 01  ACTIVITY-TRAILERS.
  5626     12  AT-RECORD-ID                    PIC XX.
  5627         88  VALID-AT-ID                       VALUE 'AT'.
  5628
  5629     12  AT-CONTROL-PRIMARY.
  5630         16  AT-COMPANY-CD               PIC X.
  5631         16  AT-CARRIER                  PIC X.
  5632         16  AT-CLAIM-NO                 PIC X(7).
  5633         16  AT-CERT-NO.
  5634             20  AT-CERT-PRIME           PIC X(10).
  5635             20  AT-CERT-SFX             PIC X.
  5636         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5637             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5638             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5639             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5640             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5641             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5642             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5643             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 108
* EL130.cbl
  5644             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5645             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5646             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5647             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5648             88  AT-BENEFICIARY-TRL           VALUE +91.
  5649             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5650             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5651
  5652     12  AT-TRAILER-TYPE                 PIC X.
  5653         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5654         88  PAYMENT-TR                       VALUE '2'.
  5655         88  AUTO-PAY-TR                      VALUE '3'.
  5656         88  CORRESPONDENCE-TR                VALUE '4'.
  5657         88  ADDRESS-TR                       VALUE '5'.
  5658         88  GENERAL-INFO-TR                  VALUE '6'.
  5659         88  AUTO-PROMPT-TR                   VALUE '7'.
  5660         88  DENIAL-TR                        VALUE '8'.
  5661         88  INCURRED-CHG-TR                  VALUE '9'.
  5662         88  FORM-CONTROL-TR                  VALUE 'A'.
  5663
  5664     12  AT-RECORDED-DT                  PIC XX.
  5665     12  AT-RECORDED-BY                  PIC X(4).
  5666     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5667
  5668     12  AT-TRAILER-BODY                 PIC X(165).
  5669
  5670     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5671         16  AT-RESERVE-CONTROLS.
  5672             20  AT-MANUAL-SW            PIC X.
  5673                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5674             20  AT-FUTURE-SW            PIC X.
  5675                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5676             20  AT-PTC-SW               PIC X.
  5677                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5678             20  AT-IBNR-SW              PIC X.
  5679                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5680             20  AT-PTC-LF-SW            PIC X.
  5681                 88  AT-LF-PTC-USED          VALUE '1'.
  5682             20  AT-CDT-ACCESS-METHOD    PIC X.
  5683                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5684                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5685                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5686             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5687         16  AT-LAST-COMPUTED-DT         PIC XX.
  5688         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5689         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5690         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5691         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5692         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5693         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5694         16  AT-EXPENSE-CONTROLS.
  5695             20  AT-EXPENSE-METHOD       PIC X.
  5696                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5697                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5698                 88  PERCENT-OF-PMT           VALUE '3'.
  5699                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5700             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5701             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 109
* EL130.cbl
  5702         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5703         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5704
  5705         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5706         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5707
  5708*        16  FILLER                      PIC X(53).
  5709         16  FILLER                      PIC X(47).
  5710
  5711         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5712         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5713
  5714         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5715             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5716             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5717*                    C = CLOSED
  5718*                    O = OPEN
  5719             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5720*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5721
  5722     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5723         16  AT-PAYMENT-TYPE             PIC X.
  5724             88  PARTIAL-PAYMENT                VALUE '1'.
  5725             88  FINAL-PAYMENT                  VALUE '2'.
  5726             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5727             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5728             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5729             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5730             88  VOIDED-PAYMENT                 VALUE '9'.
  5731             88  TRANSFER                       VALUE 'T'.
  5732             88  LIFE-INTEREST                  VALUE 'I'.
  5733
  5734         16  AT-CLAIM-TYPE               PIC X.
  5735             88  PAID-FOR-AH                    VALUE 'A'.
  5736             88  PAID-FOR-LIFE                  VALUE 'L'.
  5737             88  PAID-FOR-IUI                   VALUE 'I'.
  5738             88  PAID-FOR-GAP                   VALUE 'G'.
  5739         16  AT-CLAIM-PREM-TYPE          PIC X.
  5740             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5741             88  AT-O-B-COVERAGE                VALUE '2'.
  5742             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5743         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5744         16  AT-CHECK-NO                 PIC X(7).
  5745         16  AT-PAID-FROM-DT             PIC XX.
  5746         16  AT-PAID-THRU-DT             PIC XX.
  5747         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5748         16  FILLER                      PIC X.
  5749         16  AT-PAYEES-NAME              PIC X(30).
  5750         16  AT-PAYMENT-ORIGIN           PIC X.
  5751             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5752             88  ONLINE-AUTO-PMT                VALUE '2'.
  5753             88  OFFLINE-PMT                    VALUE '3'.
  5754         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5755         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5756         16  AT-VOID-DATA.
  5757             20  AT-VOID-DT              PIC XX.
  5758*00144       20  AT-VOID-REASON          PIC X(30).
  5759             20  AT-VOID-REASON          PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 110
* EL130.cbl
  5760         16  AT-PMT-APPROVED-BY          PIC X(04).
  5761         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5762         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5763         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5764                                         PIC S99V9(5)  COMP-3.
  5765         16  AT-CREDIT-INTERFACE.
  5766             20  AT-PMT-SELECT-DT        PIC XX.
  5767                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5768             20  AT-PMT-ACCEPT-DT        PIC XX.
  5769                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5770             20  AT-VOID-SELECT-DT       PIC XX.
  5771                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5772             20  AT-VOID-ACCEPT-DT       PIC XX.
  5773                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5774
  5775         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5776                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5777                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5778         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5779
  5780         16  AT-FORCE-CONTROL            PIC X.
  5781             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5782         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5783         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5784         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5785         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5786         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5787         16  AT-BENEFIT-TYPE             PIC X.
  5788
  5789         16  AT-EXPENSE-TYPE             PIC X.
  5790         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5791
  5792         16  AT-PAYEE-TYPE-CD.
  5793             20  AT-PAYEE-TYPE           PIC X.
  5794                 88  INSURED-PAID           VALUE 'I'.
  5795                 88  BENEFICIARY-PAID       VALUE 'B'.
  5796                 88  ACCOUNT-PAID           VALUE 'A'.
  5797                 88  OTHER-1-PAID           VALUE 'O'.
  5798                 88  OTHER-2-PAID           VALUE 'Q'.
  5799                 88  DOCTOR-PAID            VALUE 'P'.
  5800                 88  EMPLOYER-PAID          VALUE 'E'.
  5801             20  AT-PAYEE-SEQ            PIC X.
  5802
  5803         16  AT-CASH-PAYMENT             PIC X.
  5804         16  AT-GROUPED-PAYMENT          PIC X.
  5805         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5806         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5807         16  AT-APPROVED-LEVEL           PIC X.
  5808         16  AT-VOID-TYPE                PIC X.
  5809             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5810             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5811         16  AT-AIG-UNEMP-IND            PIC X.
  5812             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5813         16  AT-ASSOCIATES               PIC X.
  5814             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5815             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5816
  5817         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 111
* EL130.cbl
  5818         16  AT-CV-PMT-CODE              PIC X.
  5819             88  FULL-DEATH-PAYMENT         VALUE '1'.
  5820             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5821             88  FULL-ADD-PAYMENT           VALUE '3'.
  5822             88  HALF-ADD-PAYMENT           VALUE '4'.
  5823             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5824             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5825             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5826             88  ADDL-PAYMENT               VALUE '8'.
  5827
  5828         16  AT-EOB-CODE1                PIC XXX.
  5829         16  AT-EOB-CODE2                PIC XXX.
  5830         16  AT-EOB-CODE3                PIC XXX.
  5831         16  AT-EOB-CODE4                PIC XXX.
  5832         16  FILLER REDEFINES AT-EOB-CODE4.
  5833             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5834             20  FILLER                  PIC X.
  5835         16  AT-EOB-CODE5                PIC XXX.
  5836         16  FILLER REDEFINES AT-EOB-CODE5.
  5837             20  AT-PMT-PROOF-DT         PIC XX.
  5838             20  FILLER                  PIC X.
  5839
  5840         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5841             88  AT-PRINT-EOB            VALUE 'Y'.
  5842
  5843         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5844         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5845
  5846     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5847         16  AT-SCHEDULE-START-DT        PIC XX.
  5848         16  AT-SCHEDULE-END-DT          PIC XX.
  5849         16  AT-TERMINATED-DT            PIC XX.
  5850         16  AT-LAST-PMT-TYPE            PIC X.
  5851             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5852             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5853         16  AT-FIRST-PMT-DATA.
  5854             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5855             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  5856             20  AT-1ST-PAY-THRU-DT      PIC XX.
  5857         16  AT-REGULAR-PMT-DATA.
  5858             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  5859             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  5860             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  5861         16  AT-AUTO-PAYEE-CD.
  5862             20  AT-AUTO-PAYEE-TYPE      PIC X.
  5863                 88  INSURED-PAID-AUTO      VALUE 'I'.
  5864                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  5865                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  5866                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  5867                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  5868             20  AT-AUTO-PAYEE-SEQ       PIC X.
  5869         16  AT-AUTO-PAY-DAY             PIC 99.
  5870         16  AT-AUTO-CASH                PIC X.
  5871             88  AT-CASH                      VALUE 'Y'.
  5872             88  AT-NON-CASH                  VALUE 'N'.
  5873*        16  FILLER                      PIC X(129).
  5874         16  AT-AUTO-END-LETTER          PIC X(4).
  5875         16  FILLER                      PIC X(125).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 112
* EL130.cbl
  5876
  5877         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  5878         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  5879
  5880     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  5881         16  AT-LETTER-SENT-DT           PIC XX.
  5882         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  5883         16  AT-AUTO-RE-SEND-DT          PIC XX.
  5884         16  AT-LETTER-ANSWERED-DT       PIC XX.
  5885         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  5886         16  AT-LETTER-ORIGIN            PIC X.
  5887             88  ONLINE-CREATION              VALUE '1' '3'.
  5888             88  OFFLINE-CREATION             VALUE '2' '4'.
  5889             88  NAPER-ONLINE-CREATION        VALUE '3'.
  5890             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  5891         16  AT-STD-LETTER-FORM          PIC X(4).
  5892         16  AT-REASON-TEXT              PIC X(70).
  5893         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  5894         16  AT-ADDRESEE-TYPE            PIC X.
  5895              88  INSURED-ADDRESEE            VALUE 'I'.
  5896              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  5897              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  5898              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  5899              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  5900              88  OTHER-ADDRESEE-1            VALUE 'O'.
  5901              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  5902         16  AT-ADDRESSEE-NAME           PIC X(30).
  5903         16  AT-INITIAL-PRINT-DATE       PIC XX.
  5904         16  AT-RESEND-PRINT-DATE        PIC XX.
  5905         16  AT-CORR-SOL-UNSOL           PIC X.
  5906         16  AT-LETTER-PURGED-DT         PIC XX.
  5907*
  5908*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  5909*
  5910         16  AT-CSO-REDEFINITION.
  5911             20  AT-RESEND-LETTER-FORM   PIC X(4).
  5912             20  AT-AUTO-CLOSE-IND       PIC X(1).
  5913             20  AT-LETTER-TO-BENE       PIC X(1).
  5914             20  AT-STOP-LETTER-DT       PIC X(2).
  5915             20  FILLER                  PIC X(19).
  5916*             20  FILLER                  PIC X(27).
  5917             20  AT-CSO-LETTER-STATUS    PIC X.
  5918                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  5919                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  5920                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  5921             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  5922             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  5923*
  5924*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  5925*
  5926*        16  FILLER                      PIC X(26).
  5927*
  5928*        16  AT-DMD-BSR-CODE             PIC X.
  5929*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  5930*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  5931*
  5932*        16  AT-DMD-LETTER-STATUS        PIC X.
  5933*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 113
* EL130.cbl
  5934*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  5935*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  5936*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  5937*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  5938
  5939         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  5940         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  5941
  5942     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  5943         16  AT-ADDRESS-TYPE             PIC X.
  5944             88  INSURED-ADDRESS               VALUE 'I'.
  5945             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  5946             88  ACCOUNT-ADDRESS               VALUE 'A'.
  5947             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  5948             88  EMPLOYER-ADDRESS              VALUE 'E'.
  5949             88  OTHER-ADDRESS-1               VALUE 'O'.
  5950             88  OTHER-ADDRESS-2               VALUE 'Q'.
  5951         16  AT-MAIL-TO-NAME             PIC X(30).
  5952         16  AT-ADDRESS-LINE-1           PIC X(30).
  5953         16  AT-ADDRESS-LINE-2           PIC X(30).
  5954         16  AT-CITY-STATE.
  5955             20  AT-CITY                 PIC X(28).
  5956             20  AT-STATE                PIC XX.
  5957         16  AT-ZIP.
  5958             20  AT-ZIP-CODE.
  5959                 24  AT-ZIP-1ST          PIC X.
  5960                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5961                 24  FILLER              PIC X(4).
  5962             20  AT-ZIP-PLUS4            PIC X(4).
  5963         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  5964             20  AT-CAN-POSTAL-1         PIC XXX.
  5965             20  AT-CAN-POSTAL-2         PIC XXX.
  5966             20  FILLER                  PIC XXX.
  5967         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  5968*         16  FILLER                      PIC X(23).
  5969         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  5970         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  5971         16  FILLER                      PIC X(13).
  5972         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  5973         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  5974
  5975     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  5976         16  AT-INFO-LINE-1              PIC X(60).
  5977         16  AT-INFO-LINE-2              PIC X(60).
  5978         16  AT-INFO-TRAILER-TYPE        PIC X.
  5979             88  AT-PAYMENT-NOTE         VALUE 'P'.
  5980             88  AT-CALL-NOTE            VALUE 'C'.
  5981             88  AT-MAINT-NOTE           VALUE 'M'.
  5982             88  AT-CERT-CHANGE          VALUE 'X'.
  5983             88  AT-APPROVAL-NOTE        VALUE 'R'.
  5984             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  5985         16  AT-CALL-TYPE                PIC X.
  5986             88  AT-PHONE-CALL-IN        VALUE 'I'.
  5987             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  5988         16  AT-NOTE-CONTINUATION        PIC X.
  5989             88  AT-CONTINUED-NOTE       VALUE 'X'.
  5990         16  AT-EOB-CODES-EXIST          PIC X.
  5991             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 114
* EL130.cbl
  5992         16  FILLER                      PIC X(35).
  5993         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  5994         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  5995
  5996     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  5997         16  AT-PROMPT-LINE-1            PIC X(60).
  5998         16  AT-PROMPT-LINE-2            PIC X(60).
  5999         16  AT-PROMPT-START-DT          PIC XX.
  6000         16  AT-PROMPT-END-DT            PIC XX.
  6001         16  FILLER                      PIC X(35).
  6002         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6003         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6004
  6005     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6006         16  AT-DENIAL-INFO-1            PIC X(60).
  6007         16  AT-DENIAL-INFO-2            PIC X(60).
  6008         16  AT-DENIAL-DT                PIC XX.
  6009         16  AT-RETRACTION-DT            PIC XX.
  6010         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6011*         16  FILLER                      PIC X(31).
  6012         16  AT-DENIAL-PROOF-DT          PIC XX.
  6013         16  FILLER                      PIC X(29).
  6014         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6015         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6016
  6017     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6018         16  AT-OLD-INCURRED-DT          PIC XX.
  6019         16  AT-OLD-REPORTED-DT          PIC XX.
  6020         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6021         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6022         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6023         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6024         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6025         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6026         16  FILLER                      PIC X(26).
  6027         16  AT-OLD-DIAG-CODE            PIC X(6).
  6028         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6029         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6030         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6031         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6032         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6033         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6034         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6035         16  FILLER                      PIC X(25).
  6036         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6037
  6038     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6039         16  AT-FORM-SEND-ON-DT          PIC XX.
  6040         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6041         16  AT-FORM-RE-SEND-DT          PIC XX.
  6042         16  AT-FORM-ANSWERED-DT         PIC XX.
  6043         16  AT-FORM-PRINTED-DT          PIC XX.
  6044         16  AT-FORM-REPRINT-DT          PIC XX.
  6045         16  AT-FORM-TYPE                PIC X.
  6046             88  INITIAL-FORM                  VALUE '1'.
  6047             88  PROGRESS-FORM                 VALUE '2'.
  6048         16  AT-INSTRUCT-LN-1            PIC X(28).
  6049         16  AT-INSTRUCT-LN-2            PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 115
* EL130.cbl
  6050         16  AT-INSTRUCT-LN-3            PIC X(28).
  6051         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6052         16  AT-FORM-ADDRESS             PIC X.
  6053             88  FORM-TO-INSURED              VALUE 'I'.
  6054             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6055             88  FORM-TO-OTHER-1              VALUE 'O'.
  6056             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6057         16  AT-RELATED-1.
  6058             20 AT-REL-CARR-1            PIC X.
  6059             20 AT-REL-CLAIM-1           PIC X(7).
  6060             20 AT-REL-CERT-1            PIC X(11).
  6061         16  AT-RELATED-2.
  6062             20 AT-REL-CARR-2            PIC X.
  6063             20 AT-REL-CLAIM-2           PIC X(7).
  6064             20 AT-REL-CERT-2            PIC X(11).
  6065         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6066         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6067         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6068         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6069         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6070         16  AT-STOP-FORM-DT             PIC X(2).
  6071
  6072         16  FILLER                      PIC X(09).
  6073         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6074         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6075******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 116
* EL130.cbl
  6077*    COPY ELCBENE.
  6078******************************************************************
  6079*                                                                *
  6080*                            ELCBENE.                            *
  6081*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6082*                            VMOD=2.006                          *
  6083*                                                                *
  6084*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6085*                                                                *
  6086*   FILE TYPE = VSAM,KSDS                                        *
  6087*   RECORD SIZE = 500   RECFORM = FIX                            *
  6088*                                                                *
  6089*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6090*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6091*                                                                *
  6092*   LOG = YES                                                    *
  6093*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6094*                                                                *
  6095*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6096******************************************************************
  6097
  6098 01  BENEFICIARY-MASTER.
  6099     12  BE-RECORD-ID                PIC XX.
  6100         88  VALID-BE-ID                VALUE 'BE'.
  6101
  6102     12  BE-CONTROL-PRIMARY.
  6103         16  BE-COMPANY-CD           PIC X.
  6104         16  BE-RECORD-TYPE          PIC X.
  6105             88  BENEFICIARY-RECORD  VALUE 'B'.
  6106             88  ADJUSTOR-RECORD     VALUE 'A'.
  6107         16  BE-BENEFICIARY          PIC X(10).
  6108     12  BE-CONTROL-BY-NAME.
  6109         16  BE-COMPANY-CD-A1        PIC X.
  6110         16  BE-RECORD-TYPE-A1       PIC X.
  6111         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6112         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6113
  6114     12  BE-LAST-MAINT-DT            PIC XX.
  6115     12  BE-LAST-MAINT-BY            PIC X(4).
  6116     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6117
  6118     12  BE-ADDRESS-DATA.
  6119         16  BE-MAIL-TO-NAME         PIC X(30).
  6120         16  BE-ADDRESS-LINE-1       PIC X(30).
  6121         16  BE-ADDRESS-LINE-2       PIC X(30).
  6122         16  BE-ADDRESS-LINE-3       PIC X(30).
  6123         16  BE-CITY-STATE.
  6124             20  BE-CITY             PIC X(28).
  6125             20  BE-STATE            PIC XX.
  6126         16  BE-ZIP-CODE.
  6127             20  BE-ZIP-PRIME.
  6128                 24  BE-ZIP-1ST      PIC X.
  6129                     88  BE-CANADIAN-POST-CODE
  6130                                         VALUE 'A' THRU 'Z'.
  6131                 24  FILLER          PIC X(4).
  6132             20  BE-ZIP-PLUS4        PIC X(4).
  6133         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6134             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 117
* EL130.cbl
  6135             20  BE-CAN-POSTAL-2     PIC XXX.
  6136             20  FILLER              PIC XXX.
  6137         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6138         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6139
  6140******************************************************************
  6141*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6142*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6143******************************************************************
  6144     12  BE-CARRIER                  PIC X.
  6145
  6146     12  BE-ADDRESS-DATA2.
  6147         16  BE-MAIL-TO-NAME2        PIC X(30).
  6148         16  BE-ADDRESS-LINE-12      PIC X(30).
  6149         16  BE-ADDRESS-LINE-22      PIC X(30).
  6150         16  BE-ADDRESS-LINE-32      PIC X(30).
  6151         16  BE-CITY-STATE2.
  6152             20  BE-CITY2            PIC X(28).
  6153             20  BE-STATE2           PIC XX.
  6154         16  BE-ZIP-CODE2.
  6155             20  BE-ZIP-PRIME2.
  6156                 24  BE-ZIP-1ST2     PIC X.
  6157                     88  BE-CANADIAN-POST-CODE2
  6158                                         VALUE 'A' THRU 'Z'.
  6159                 24  FILLER          PIC X(4).
  6160             20  BE-ZIP-PLUS42       PIC X(4).
  6161         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6162             20  BE-CAN-POSTAL-12    PIC XXX.
  6163             20  BE-CAN-POSTAL-22    PIC XXX.
  6164             20  FILLER              PIC XXX.
  6165         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6166         16  BE-BILLING-STMT-DATA.
  6167             20  BE-BSR              PIC X.
  6168                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6169                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6170             20  BE-BSR-FROM         PIC X(30).
  6171             20  BE-BSR-DEPT         PIC X(30).
  6172             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6173             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6174             20  BE-OUTPUT-TYPE      PIC X.
  6175                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6176                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6177
  6178     12  FILLER                      PIC X(28).
  6179******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 118
* EL130.cbl
  6181*    COPY ELCDAR.
  6182******************************************************************
  6183*                                                                *
  6184*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6185*   FILE TYPE = VSAM,KSDS                                        *
  6186*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6187*   BASE CLUSTER = DLYACTV                                       *
  6188*   LOG = YES                                                    *
  6189*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6190*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6191*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6192*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6193*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6194*               BY PROGRAM "LGINFCE".                            *
  6195*                                                                *
  6196******************************************************************
  6197 01  DAILY-ACTIVITY-RECORD.
  6198     05  DA-KEY.
  6199         10  DA-COMP-CD          PIC X.
  6200         10  DA-CARRIER          PIC X.
  6201         10  DA-CLAIM-NO         PIC X(7).
  6202         10  DA-CERT-NO.
  6203             15  DA-CERT-PRIME   PIC X(10).
  6204             15  DA-CERT-SFX     PIC X.
  6205     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6206     05  DA-RECORD-TYPE          PIC X.
  6207     05  FILLER                  PIC X(2).
  6208******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 119
* EL130.cbl
  6210*    COPY ELCACTQ.
  6211******************************************************************
  6212*                                                                *
  6213*                            ELCACTQ.                            *
  6214*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6215*                            VMOD=2.004                          *
  6216*                                                                *
  6217*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6218*                                                                *
  6219*   FILE TYPE = VSAM,KSDS                                        *
  6220*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6221*                                                                *
  6222*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6223*       ALTERNATE INDEX = NONE                                   *
  6224*                                                                *
  6225*   LOG = YES                                                    *
  6226*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6227*                                                                *
  6228*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6229******************************************************************
  6230
  6231 01  ACTIVITY-QUE.
  6232     12  AQ-RECORD-ID                PIC XX.
  6233         88  VALID-AQ-ID                VALUE 'AQ'.
  6234
  6235     12  AQ-CONTROL-PRIMARY.
  6236         16  AQ-COMPANY-CD           PIC X.
  6237         16  AQ-CARRIER              PIC X.
  6238         16  AQ-CLAIM-NO             PIC X(7).
  6239         16  AQ-CERT-NO.
  6240             20  AQ-CERT-PRIME       PIC X(10).
  6241             20  AQ-CERT-SFX         PIC X.
  6242
  6243     12  AQ-PENDING-ACTIVITY-FLAGS.
  6244         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6245         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6246             88  PENDING-PAYMENTS       VALUE '1'.
  6247         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6248             88  PENDING-FULL-PRINT     VALUE '1'.
  6249             88  PENDING-PART-PRINT     VALUE '2'.
  6250         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6251             88  PENDING-LETTERS        VALUE '1'.
  6252         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6253             88  PENDING-RESTORE        VALUE 'C'.
  6254             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6255
  6256     12  FILLER                      PIC X(20).
  6257
  6258     12  AQ-RESEND-DATE              PIC XX.
  6259     12  AQ-FOLLOWUP-DATE            PIC XX.
  6260     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6261     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6262     12  AQ-AUTO-LETTER              PIC X(4).
  6263     12  FILLER                      PIC XX.
  6264     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6265*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 120
* EL130.cbl
  6267*    COPY ELCARCH.
  6268******************************************************************
  6269*                                                                *
  6270*                            ELCARCH.                            *
  6271*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6272*                            VMOD=2.007                          *
  6273*                                                                *
  6274*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6275*                                                                *
  6276*   FILE TYPE = VSAM,KSDS                                        *
  6277*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6278*                                                                *
  6279*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6280*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6281*                                                                *
  6282*   LOG = NO                                                     *
  6283*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6284*                                                                *
  6285*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6286******************************************************************
  6287 01  LETTER-ARCHIVE.
  6288     12  LA-RECORD-ID                PIC XX.
  6289         88  VALID-LA-ID                VALUE 'LA'.
  6290
  6291     12  LA-CONTROL-PRIMARY.
  6292         16  LA-COMPANY-CD           PIC X.
  6293         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6294         16  LA-RECORD-TYPE          PIC X.
  6295             88  LA-HEADER-DATA         VALUE '1'.
  6296             88  LA-ADDRESS-DATA        VALUE '2'.
  6297             88  LA-TEXT-DATA           VALUE '3'.
  6298             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6299         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6300
  6301     12  LA-CONTROL-BY-TYPE.
  6302         16  LA-COMPANY-CD-A1        PIC X.
  6303         16  LA-RECORD-TYPE-A1       PIC X.
  6304         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6305         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6306
  6307     12  LA-TEXT-RECORD.
  6308         16  LA-SKIP-CONTROL         PIC XX.
  6309             88  NO-LINES-SKIPPED       VALUE SPACES.
  6310             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6311         16  LA-TEXT-LINE            PIC X(70).
  6312
  6313     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6314         16  FILLER                  PIC XX.
  6315         16  LA-ADDRESS-LINE         PIC X(30).
  6316         16  FILLER                  PIC X(40).
  6317
  6318     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6319         16  FILLER                  PIC XX.
  6320         16  LA-CARRIER              PIC X.
  6321         16  LA-CLAIM-NO             PIC X(7).
  6322         16  LA-CERT-NO.
  6323             20  LA-CERT-PRIME       PIC X(10).
  6324             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 121
* EL130.cbl
  6325         16  LA-NO-OF-COPIES         PIC S9.
  6326         16  LA-RESEND-DATE          PIC XX.
  6327         16  LA-PROCESSOR-CD         PIC X(4).
  6328         16  LA-CREATION-DT          PIC XX.
  6329         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6330         16  LA-RESEND-PRINT-DATE    PIC XX.
  6331         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6332         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6333*
  6334* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6335*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6336*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6337*   I        20  LA-DMD-RES-ST           PIC XX.
  6338*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6339*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6340*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6341*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6342*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6343*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6344*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6345*   I        20  LA-DMD-UND-CODE         PIC XX.
  6346*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6347*   V    16  FILLER                  PIC X(15).
  6348* -----
  6349*
  6350* REINSERTED  CSO  MODS
  6351*
  6352         16  FILLER.
  6353             20  FILLER                  PIC X(29).
  6354             20  LA-CSO-LETTER-STATUS    PIC X.
  6355                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6356                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6357                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6358             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6359             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6360*
  6361
  6362     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6363         16  FILLER                  PIC XX.
  6364         16  LA4-CARRIER             PIC X.
  6365         16  LA4-CLAIM-NO            PIC X(7).
  6366         16  LA4-CERT-NO.
  6367             20  LA4-CERT-PRIME      PIC X(10).
  6368             20  LA4-CERT-SFX        PIC X.
  6369         16  LA4-NO-OF-COPIES        PIC S9.
  6370         16  LA4-RESEND-DATE         PIC XX.
  6371         16  LA4-PROCESSOR-CD        PIC X(4).
  6372         16  LA4-CREATION-DT         PIC XX.
  6373         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6374         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6375         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6376         16  LA4-FORM-TYPE           PIC X.
  6377             88  LA4-INITIAL-FORM    VALUE '1'.
  6378             88  LA4-PROGRESS-FORM   VALUE '2'.
  6379         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6380         16  LA4-STATE               PIC X(02).
  6381         16  FILLER                  PIC X(31).
  6382******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 122
* EL130.cbl
  6384*    COPY ERCREIN.
  6385******************************************************************
  6386*                                                                *
  6387*                            ERCREIN                             *
  6388*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6389*                            VMOD=2.010                          *
  6390*                                                                *
  6391*   ONLINE CREDIT SYSTEM                                         *
  6392*                                                                *
  6393*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6394*                                                                *
  6395*   FILE TYPE = VSAM,KSDS                                        *
  6396*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6397*                                                                *
  6398*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6399*       ALTERNATE PATH = NONE                                    *
  6400*                                                                *
  6401*   LOG = NO                                                     *
  6402*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6403*                                                                *
  6404******************************************************************
  6405*                   C H A N G E   L O G
  6406*
  6407* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6408*-----------------------------------------------------------------
  6409*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6410* EFFECTIVE    NUMBER
  6411*-----------------------------------------------------------------
  6412* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6413* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6414******************************************************************
  6415 01  REINSURANCE-RECORD.
  6416     12  RE-RECORD-ID                      PIC XX.
  6417         88  VALID-RE-ID                      VALUE 'RE'.
  6418
  6419     12  RE-CONTROL-PRIMARY.
  6420         16  RE-COMPANY-CD                 PIC X.
  6421         16  RE-KEY.
  6422             20  RE-CODE                   PIC X.
  6423                 88  RE-TABLE-RECORD          VALUE 'A'.
  6424                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6425             20  RE-TABLE                  PIC XXX.
  6426             20  FILLER                    PIC XXX.
  6427         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6428             20  FILLER                    PIC X.
  6429             20  RE-COMPANY.
  6430                 24  RE-COMP-PRIME         PIC XXX.
  6431                 24  RE-COMP-SUB           PIC XXX.
  6432
  6433     12  RE-MAINT-INFORMATION.
  6434         16  RE-LAST-MAINT-DT              PIC XX.
  6435         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6436         16  RE-LAST-MAINT-USER            PIC X(4).
  6437         16  FILLER                        PIC X(10).
  6438
  6439     12  RE-TABLE-DATA.
  6440         16  RE-100-COMP                   PIC 99.
  6441
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 123
* EL130.cbl
  6442         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6443             20  RE-REI-COMP-NO.
  6444                 24  RE-REI-COMP           PIC XXX.
  6445                 24  RE-REI-COMP-SUB       PIC XXX.
  6446             20  RE-LF-QC                  PIC X.
  6447             20  RE-AH-QC                  PIC X.
  6448             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6449             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6450             20  RE-LFAGE-LO               PIC 99.
  6451             20  RE-LFAGE-HI               PIC 99.
  6452             20  RE-AHAGE-LO               PIC 99.
  6453             20  RE-AHAGE-HI               PIC 99.
  6454             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6455             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6456             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6457             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6458             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6459             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6460             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6461             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6462             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6463             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6464             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6465             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6466             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6467             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6468             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6469             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6470             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6471             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6472             20  RE-LF-BEN-CODE            PIC X.
  6473             20  RE-AH-BEN-CODE            PIC X.
  6474             20  RE-INTERACTIVE            PIC X.
  6475             20  RE-REMAINING              PIC X.
  6476             20  RE-LF-RUNOFF-SW           PIC X.
  6477             20  RE-AH-RUNOFF-SW           PIC X.
  6478             20  FILLER                    PIC X(19).
  6479
  6480         16  RE-COMP-INFO-END              PIC X(6).
  6481         16  RE-NSP-ST-CD-LF               PIC XX.
  6482         16  RE-NSP-ST-CD-AH               PIC XX.
  6483         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6484             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6485
  6486         16  FILLER                        PIC X(27).
  6487
  6488     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6489         16  RE-NAME                       PIC X(30).
  6490         16  RE-LF-PE                      PIC X.
  6491         16  RE-AH-PE                      PIC X.
  6492         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6493         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6494         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6495         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6496         16  RE-PRT-ST                     PIC X.
  6497         16  RE-PRT-OW                     PIC X.
  6498         16  RE-MORT-CODE                  PIC X(4).
  6499         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 124
* EL130.cbl
  6500         16  RE-ZERO-LF-FEE                PIC X.
  6501         16  RE-ZERO-AH-FEE                PIC X.
  6502         16  RE-CEDE-NAME                  PIC X(30).
  6503         16  RE-LF-COMM                    PIC X.
  6504         16  RE-AH-COMM                    PIC X.
  6505         16  RE-LF-TAX                     PIC X.
  6506         16  RE-AH-TAX                     PIC X.
  6507         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6508         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6509         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6510
  6511         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6512             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6513
  6514         16  RE-LF-CEDING-FEE-BRACKETS.
  6515             20  RE-LF-FEE-METHOD          PIC X.
  6516                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6517                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6518                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6519                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6520             20  RE-LF-FEE-BASIS           PIC X.
  6521                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6522                 88  RE-LF-NET-CEDED               VALUE '2'.
  6523                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6524                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6525                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6526                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6527                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6528                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6529             20  FILLER                    PIC XXX.
  6530             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6531                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6532                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6533
  6534         16  RE-AH-CEDING-FEE-BRACKETS.
  6535             20  RE-AH-FEE-METHOD          PIC X.
  6536                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6537                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6538                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6539                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6540             20  RE-AH-FEE-BASIS           PIC X.
  6541                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6542                 88  RE-AH-NET-CEDED               VALUE '2'.
  6543                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6544                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6545                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6546                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6547                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6548                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6549             20  FILLER                    PIC XXX.
  6550             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6551                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6552                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6553
  6554         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6555
  6556         16  RE-OLD-CEDING-STMT            PIC X.
  6557
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 125
* EL130.cbl
  6558         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6559         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6560         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6561         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6562         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6563         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6564         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6565         16  RE-MORT-SW                    PIC X.
  6566         16  RE-CEDING-TYPE-FLAG           PIC X.
  6567             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6568             88  RE-CEDED                          VALUE 'C'.
  6569             88  RE-ASSUMED                        VALUE 'A'.
  6570             88  RE-PHANTOM                        VALUE 'P'.
  6571
  6572         16  RE-CEDING-STMT-OPT-A          PIC X.
  6573             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6574         16  RE-CEDING-STMT-OPT-B          PIC X.
  6575             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6576         16  RE-CEDING-STMT-OPT-C          PIC X.
  6577             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6578         16  RE-CEDING-STMT-OPT-D          PIC X.
  6579             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6580         16  RE-CEDING-STMT-OPT-E          PIC X.
  6581             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6582
  6583         16  RE-PRT-CRSV                   PIC X.
  6584
  6585         16  RE-GL-CENTER                  PIC X(4).
  6586
  6587         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6588
  6589         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6590
  6591         16  RE-EARN-STOP-CODE             PIC X.
  6592             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6593             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6594
  6595         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6596             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6597
  6598         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6599         16  FILLER                        PIC X(2281).
  6600
  6601         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6602
  6603******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 126
* EL130.cbl
  6605*    COPY ERCMAIL.
  6606******************************************************************
  6607*                                                                *
  6608*                                                                *
  6609*                            ERCMAIL                             *
  6610*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6611*                            VMOD=2.003                          *
  6612*                                                                *
  6613*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6614*                                                                *
  6615*   FILE TYPE = VSAM,KSDS                                        *
  6616*   RECORD SIZE = 374   RECFORM = FIX                            *
  6617*                                                                *
  6618*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6619*   ALTERNATE PATH    = NOT USED                                 *
  6620*                                                                *
  6621*   LOG = YES                                                    *
  6622*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6623******************************************************************
  6624*                   C H A N G E   L O G
  6625*
  6626* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6627*-----------------------------------------------------------------
  6628*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6629* EFFECTIVE    NUMBER
  6630*-----------------------------------------------------------------
  6631* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6632* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6633* 111108                   PEMA  ADD CRED BENE ADDR2
  6634******************************************************************
  6635
  6636 01  MAILING-DATA.
  6637     12  MA-RECORD-ID                      PIC XX.
  6638         88  VALID-MA-ID                       VALUE 'MA'.
  6639
  6640     12  MA-CONTROL-PRIMARY.
  6641         16  MA-COMPANY-CD                 PIC X.
  6642         16  MA-CARRIER                    PIC X.
  6643         16  MA-GROUPING.
  6644             20  MA-GROUPING-PREFIX        PIC XXX.
  6645             20  MA-GROUPING-PRIME         PIC XXX.
  6646         16  MA-STATE                      PIC XX.
  6647         16  MA-ACCOUNT.
  6648             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6649             20  MA-ACCOUNT-PRIME          PIC X(6).
  6650         16  MA-CERT-EFF-DT                PIC XX.
  6651         16  MA-CERT-NO.
  6652             20  MA-CERT-PRIME             PIC X(10).
  6653             20  MA-CERT-SFX               PIC X.
  6654
  6655     12  FILLER                            PIC XX.
  6656
  6657     12  MA-ACCESS-CONTROL.
  6658         16  MA-SOURCE-SYSTEM              PIC XX.
  6659             88  MA-FROM-CREDIT                VALUE 'CR'.
  6660             88  MA-FROM-VSI                   VALUE 'VS'.
  6661             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6662             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 127
* EL130.cbl
  6663         16  MA-RECORD-ADD-DT              PIC XX.
  6664         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6665         16  MA-LAST-MAINT-DT              PIC XX.
  6666         16  MA-LAST-MAINT-BY              PIC XXXX.
  6667         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6668
  6669     12  MA-PROFILE-INFO.
  6670         16  MA-QUALIFY-CODE-1             PIC XX.
  6671         16  MA-QUALIFY-CODE-2             PIC XX.
  6672         16  MA-QUALIFY-CODE-3             PIC XX.
  6673         16  MA-QUALIFY-CODE-4             PIC XX.
  6674         16  MA-QUALIFY-CODE-5             PIC XX.
  6675
  6676         16  MA-INSURED-LAST-NAME          PIC X(15).
  6677         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6678         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6679         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6680         16  MA-INSURED-BIRTH-DT           PIC XX.
  6681         16  MA-INSURED-SEX                PIC X.
  6682             88  MA-SEX-MALE                   VALUE 'M'.
  6683             88  MA-SEX-FEMALE                 VALUE 'F'.
  6684         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6685
  6686         16  MA-ADDRESS-CORRECTED          PIC X.
  6687         16  MA-JOINT-BIRTH-DT             PIC XX.
  6688*        16  FILLER                        PIC X(12).
  6689
  6690         16  MA-ADDRESS-LINE-1             PIC X(30).
  6691         16  MA-ADDRESS-LINE-2             PIC X(30).
  6692         16  MA-CITY-STATE.
  6693             20  MA-CITY                   PIC X(28).
  6694             20  MA-ADDR-STATE             PIC XX.
  6695         16  MA-ZIP.
  6696             20  MA-ZIP-CODE.
  6697                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6698                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6699                 24  FILLER                PIC X(4).
  6700             20  MA-ZIP-PLUS4              PIC X(4).
  6701         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6702             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6703             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6704             20  FILLER                    PIC X(3).
  6705
  6706         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6707
  6708         16  FILLER                        PIC XXX.
  6709*        16  FILLER                        PIC X(10).
  6710
  6711     12  MA-CRED-BENE-INFO.
  6712         16  MA-CRED-BENE-NAME                 PIC X(25).
  6713         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6714         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6715         16  MA-CRED-BENE-CTYST.
  6716             20  MA-CRED-BENE-CITY             PIC X(28).
  6717             20  MA-CRED-BENE-STATE            PIC XX.
  6718         16  MA-CRED-BENE-ZIP.
  6719             20  MA-CB-ZIP-CODE.
  6720                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 128
* EL130.cbl
  6721                     88  MA-CB-CANADIAN-POST-CODE
  6722                                           VALUE 'A' THRU 'Z'.
  6723                 24  FILLER                    PIC X(4).
  6724             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6725         16  MA-CB-CANADIAN-POSTAL-CODE
  6726                            REDEFINES MA-CRED-BENE-ZIP.
  6727             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6728             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6729             20  FILLER                        PIC X(3).
  6730     12  MA-POST-CARD-MAIL-DATA.
  6731         16  MA-MAIL-DATA OCCURS 7.
  6732             20  MA-MAIL-TYPE              PIC X.
  6733                 88  MA-12MO-MAILING           VALUE '1'.
  6734                 88  MA-EXP-MAILING            VALUE '2'.
  6735             20  MA-MAIL-STATUS            PIC X.
  6736                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6737                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6738                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6739             20  MA-MAIL-DATE              PIC XX.
  6740     12  FILLER                            PIC XX.
  6741     12  FILLER                            PIC XX.
  6742*    12  FILLER                            PIC X(30).
  6743******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 129
* EL130.cbl
  6745*    COPY ELCCRTT.
  6746******************************************************************
  6747*                                                                *
  6748*                            ELCCRTT.                            *
  6749*                                                                *
  6750*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  6751*                                                                *
  6752*   FILE TYPE = VSAM,KSDS                                        *
  6753*   RECORD SIZE = 552  RECFORM = FIXED                           *
  6754*                                                                *
  6755*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  6756*                                                                *
  6757*   LOG = YES                                                    *
  6758*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6759******************************************************************
  6760*                   C H A N G E   L O G
  6761*
  6762* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6763*-----------------------------------------------------------------
  6764*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6765* EFFECTIVE    NUMBER
  6766*-----------------------------------------------------------------
  6767* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  6768* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  6769* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  6770******************************************************************
  6771
  6772 01  CERTIFICATE-TRAILERS.
  6773     12  CS-RECORD-ID                      PIC XX.
  6774         88  VALID-CS-ID                      VALUE 'CS'.
  6775
  6776     12  CS-CONTROL-PRIMARY.
  6777         16  CS-COMPANY-CD                 PIC X.
  6778         16  CS-CARRIER                    PIC X.
  6779         16  CS-GROUPING                   PIC X(6).
  6780         16  CS-STATE                      PIC XX.
  6781         16  CS-ACCOUNT                    PIC X(10).
  6782         16  CS-CERT-EFF-DT                PIC XX.
  6783         16  CS-CERT-NO.
  6784             20  CS-CERT-PRIME             PIC X(10).
  6785             20  CS-CERT-SFX               PIC X.
  6786         16  CS-TRAILER-TYPE               PIC X.
  6787             88  COMM-TRLR           VALUE 'A'.
  6788             88  FUTURE-TRLR         VALUE 'B'.
  6789             88  CERT-DATA-TRLR      VALUE 'C'.
  6790
  6791     12  CS-DATA-AREA                      PIC X(516).
  6792
  6793     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  6794         16  CS-BANK-COMMISSION-AREA.
  6795             20  CS-BANK-COMMS       OCCURS 10.
  6796                 24  CS-AGT                PIC X(10).
  6797                 24  CS-COM-TYP            PIC X.
  6798                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  6799                 24  CS-RECALC-LV-INDIC    PIC X.
  6800                 24  FILLER                PIC X(10).
  6801         16  FILLER                        PIC X(256).
  6802
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 130
* EL130.cbl
  6803     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  6804         16  CS-VIN-NUMBER                 PIC X(17).
  6805         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  6806         16  FILLER                        PIC X(498).
  6807******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 131
* EL130.cbl
  6809
  6810 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  6811                          CONTROL-FILE CERTIFICATE-MASTER
  6812                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  6813                          BENEFICIARY-MASTER
  6814                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  6815                          LETTER-ARCHIVE REINSURANCE-RECORD
  6816                          MAILING-DATA CERTIFICATE-TRAILERS.
  6817 0000-DFHEXIT SECTION.
  6818     MOVE '9#                    $   ' TO DFHEIV0.
  6819     MOVE 'EL130' TO DFHEIV1.
  6820     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6821     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6822     MOVE '5'                    TO DC-OPTION-CODE.
  6823     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  6824     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  6825     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  6826
  6827     IF EIBCALEN = ZERO
  6828         GO TO 8800-UNAUTHORIZED-ACCESS
  6829     END-IF.
  6830
  6831     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  6832     MOVE EIBTRMID               TO QID-TERM.
  6833     MOVE +2                     TO EMI-NUMBER-OF-LINES.
  6834     MOVE '2'                    TO EMI-SWITCH2.
  6835     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  6836     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  6837
  6838
  6839
  6840* EXEC CICS HANDLE CONDITION
  6841*        QIDERR     (0100-TEST-ENTRY)
  6842*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  6843*        PGMIDERR   (9600-PGMID-ERROR)
  6844*        TERMIDERR  (8820-TERM-ERROR)
  6845*        TRANSIDERR (8830-TRAN-ERROR)
  6846*        ERROR      (9990-ABEND)
  6847*    END-EXEC.
  6848*    MOVE '"$N?L[\.              ! " #00006835' TO DFHEIV0
  6849     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  6850     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6851     MOVE X'2220233030303036383335' TO DFHEIV0(25:11)
  6852     CALL 'kxdfhei1' USING DFHEIV0
  6853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6854
  6855
  6856     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  6857        PI-CALLING-PROGRAM   = XCTL-6592
  6858         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  6859     ELSE
  6860         MOVE SPACES             TO RETURNED-FROM
  6861     END-IF.
  6862
  6863     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6864         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6865             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6866             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 132
* EL130.cbl
  6867             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6868             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6869             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6870             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6871             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6872             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  6873         ELSE
  6874             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  6875             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  6876             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  6877             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  6878             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  6879             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  6880             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  6881             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  6882         END-IF
  6883     END-IF.
  6884
  6885     IF EIBTRNID = TRANS-ID
  6886         IF EIBAID = DFHCLEAR
  6887             GO TO 9400-CLEAR
  6888         ELSE
  6889             GO TO 0200-RECEIVE
  6890         END-IF
  6891     END-IF.
  6892
  6893     IF RETURNED-FROM NOT = SPACES
  6894         GO TO 0600-RECOVER-TEMP-STORAGE
  6895     END-IF.
  6896
  6897     MOVE LOW-VALUES TO EL130AO.
  6898
  6899
  6900
  6901* EXEC CICS DELETEQ TS
  6902*         QUEUE   (QID)
  6903*    END-EXEC.
  6904*    MOVE '*&                    #   #00006888' TO DFHEIV0
  6905     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  6906     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6907     MOVE X'2020233030303036383838' TO DFHEIV0(25:11)
  6908     CALL 'kxdfhei1' USING DFHEIV0,
  6909           QID,
  6910           DFHEIV99
  6911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6912
  6913
  6914 0100-TEST-ENTRY.
  6915     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  6916         GO TO 0650-FROM-EL127
  6917     ELSE
  6918         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  6919                                    PI-CERT-PROCESSED
  6920                                    PI-LETTER-ERROR-CODE
  6921     END-IF.
  6922
  6923     IF PI-RETURN-TO-PROGRAM = XCTL-132
  6924         GO TO 0640-FROM-EL132
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 133
* EL130.cbl
  6925     END-IF.
  6926
  6927     GO TO 8100-SEND-INITIAL-MAP.
  6928
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 134
* EL130.cbl
  6930 0200-RECEIVE.
  6931     MOVE LOW-VALUES             TO EL130AI.
  6932
  6933     IF PI-PROCESSOR-ID = 'LGXX'
  6934*        NEXT SENTENCE
  6935         CONTINUE
  6936     ELSE
  6937
  6938* EXEC CICS READQ TS
  6939*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6940*            INTO    (SECURITY-CONTROL)
  6941*            LENGTH  (SC-COMM-LENGTH)
  6942*            ITEM    (SC-ITEM)
  6943*        END-EXEC
  6944*    MOVE '*$II   L              ''   #00006915' TO DFHEIV0
  6945     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6946     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6947     MOVE X'2020233030303036393135' TO DFHEIV0(25:11)
  6948     CALL 'kxdfhei1' USING DFHEIV0,
  6949           PI-SECURITY-TEMP-STORE-ID,
  6950           SECURITY-CONTROL,
  6951           SC-COMM-LENGTH,
  6952           SC-ITEM,
  6953           DFHEIV99,
  6954           DFHEIV99
  6955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6956         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  6957         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  6958         IF NOT DISPLAY-CAP
  6959             MOVE 'READ'              TO  SM-READ
  6960             PERFORM 9995-SECURITY-VIOLATION
  6961             MOVE ER-0070             TO  EMI-ERROR
  6962             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6963             GO TO 8100-SEND-INITIAL-MAP
  6964         END-IF
  6965     END-IF.
  6966
  6967     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6968         MOVE ER-7008 TO EMI-ERROR
  6969         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6970         MOVE -1 TO MAINTL
  6971         GO TO 8200-SEND-DATAONLY
  6972     END-IF.
  6973
  6974
  6975
  6976* EXEC CICS RECEIVE
  6977*         MAP     (MAP-NAME)
  6978*         MAPSET  (MAPSET-NAME)
  6979*         INTO    (EL130AI)
  6980*    END-EXEC.
  6981     MOVE LENGTH OF
  6982      EL130AI
  6983       TO DFHEIV11
  6984*    MOVE '8"T I  L              ''   #00006940' TO DFHEIV0
  6985     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6986     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6987     MOVE X'2020233030303036393430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 135
* EL130.cbl
  6988     CALL 'kxdfhei1' USING DFHEIV0,
  6989           MAP-NAME,
  6990           EL130AI,
  6991           DFHEIV11,
  6992           MAPSET-NAME,
  6993           DFHEIV99,
  6994           DFHEIV99
  6995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6996
  6997
  6998     IF NOT PI-NO-CARRIER-SECURITY
  6999        MOVE +1                  TO CLMCARRL
  7000        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7001     END-IF.
  7002
  7003     IF ENTERPFL = ZERO
  7004         GO TO 0300-CHECK-PFKEYS
  7005     END-IF.
  7006
  7007     IF EIBAID NOT = DFHENTER
  7008         MOVE ER-0004            TO EMI-ERROR
  7009         GO TO 0320-INPUT-ERROR
  7010     END-IF.
  7011
  7012     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7013         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7014     ELSE
  7015         MOVE ER-0029            TO EMI-ERROR
  7016         GO TO 0320-INPUT-ERROR
  7017     END-IF.
  7018
  7019 0300-CHECK-PFKEYS.
  7020     IF EIBAID = DFHPF23
  7021         GO TO 8810-PF23
  7022     END-IF.
  7023
  7024     IF EIBAID = DFHPF24
  7025         GO TO 9200-RETURN-MAIN-MENU
  7026     END-IF.
  7027
  7028     IF EIBAID = DFHPF12
  7029         GO TO 9500-PF12
  7030     END-IF.
  7031
  7032     IF EIBAID = DFHPF3
  7033         MOVE SPACES              TO MAINTI
  7034         MOVE ZEROS               TO MAINTL
  7035         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7036         MOVE XCTL-127            TO PGM-NAME
  7037         GO TO 9300-XCTL
  7038     END-IF.
  7039
  7040     IF EIBAID = DFHPF4
  7041         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7042         MOVE XCTL-132            TO PGM-NAME
  7043         GO TO 9300-XCTL
  7044     END-IF.
  7045
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 136
* EL130.cbl
  7046     IF EIBAID = DFHPF13
  7047         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7048             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7049             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7050             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7051             MOVE PI-STATE            TO  PI-CR-STATE
  7052             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7053             MOVE XCTL-650            TO  PGM-NAME
  7054             GO TO 9300-XCTL
  7055         ELSE
  7056             MOVE -1                  TO  ENTERPFL
  7057             MOVE ER-2566             TO  EMI-ERROR
  7058             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7059             GO TO 8100-SEND-INITIAL-MAP
  7060         END-IF
  7061     END-IF.
  7062
  7063     IF EIBAID = DFHPF5
  7064         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7065             ADD +1 TO PI-CERT-PROCESSED
  7066             GO TO 0650-FROM-EL127
  7067         ELSE
  7068             MOVE ER-7686         TO EMI-ERROR
  7069             GO TO 0320-INPUT-ERROR
  7070         END-IF
  7071     END-IF.
  7072
  7073     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7074         GO TO 0800-TEST-PREVIOUS-CONTROL
  7075     END-IF.
  7076
  7077     IF PI-HAS-CLAS-IC-CRDTCRD
  7078         IF EIBAID = DFHPF10
  7079             MOVE XCTL-725          TO PGM-NAME
  7080             GO TO 9300-XCTL
  7081         END-IF
  7082     END-IF.
  7083
  7084     IF EIBAID = DFHPF14
  7085         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7086         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7087         MOVE XCTL-659            TO PGM-NAME
  7088         GO TO 9300-XCTL
  7089     END-IF.
  7090
  7091     IF EIBAID = DFHPF15
  7092         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7093         MOVE XCTL-114            TO PGM-NAME
  7094         GO TO 9300-XCTL
  7095     END-IF.
  7096
  7097     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7098         GO TO 0330-EDIT-DATA
  7099     END-IF.
  7100
  7101     MOVE ER-0029                TO EMI-ERROR.
  7102
  7103 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 137
* EL130.cbl
  7104     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7105
  7106     MOVE AL-UNBON               TO ENTERPFA.
  7107
  7108     IF ENTERPFL = ZERO
  7109         MOVE -1                 TO MAINTL
  7110     ELSE
  7111         MOVE -1                 TO ENTERPFL
  7112     END-IF.
  7113
  7114     GO TO 8200-SEND-DATAONLY.
  7115
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 138
* EL130.cbl
  7117 0330-EDIT-DATA.
  7118
  7119     IF MAINTI = 'S'
  7120         IF PRTOPTL GREATER THAN 0
  7121             IF PRTOPTI NOT = 'N' AND 'L'
  7122                 MOVE AL-UABON   TO  PRTOPTA
  7123                 MOVE -1         TO  PRTOPTL
  7124                 MOVE ER-0334    TO  EMI-ERROR
  7125                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7126                 GO TO 8200-SEND-DATAONLY
  7127             ELSE
  7128                 IF PRTOPTI = 'L'
  7129                     GO TO 0400-CREATE-ELACTQ
  7130                 ELSE
  7131                     GO TO 0480-PRINT-NOW
  7132                 END-IF
  7133             END-IF
  7134         ELSE
  7135             GO TO 1000-SHOW-CLAIM
  7136         END-IF
  7137     END-IF.
  7138
  7139     IF NOT MODIFY-CAP
  7140         MOVE 'UPDATE'       TO  SM-READ
  7141         PERFORM 9995-SECURITY-VIOLATION
  7142         MOVE ER-0070        TO  EMI-ERROR
  7143         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7144         GO TO 8100-SEND-INITIAL-MAP
  7145     END-IF.
  7146
  7147     IF MAINTI = 'D'
  7148         GO TO 2000-DELETE-CLAIM
  7149     END-IF.
  7150
  7151     IF MAINTI = 'A'
  7152         GO TO 3000-ADD-CLAIM
  7153     END-IF.
  7154
  7155     IF MAINTI = 'I'
  7156         GO TO 5000-INCURRED-CHANGE
  7157     END-IF.
  7158
  7159     MOVE ER-0023                TO EMI-ERROR.
  7160     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7161     MOVE -1                     TO MAINTL.
  7162     MOVE AL-UABON               TO MAINTA.
  7163
  7164     GO TO 8200-SEND-DATAONLY.
  7165
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 139
* EL130.cbl
  7167 0400-CREATE-ELACTQ.
  7168     IF CLMNOI   = PI-LAST-CLAIM      AND
  7169        CLMCARRI = PI-LAST-CARR       AND
  7170        CERTNOI  = PI-LAST-CERT-PRIME AND
  7171        SUFXI    = PI-LAST-CERT-SUFX
  7172         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7173         MOVE PI-LAST-CARR       TO PI-CARRIER
  7174         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7175     ELSE
  7176         MOVE ER-0207            TO EMI-ERROR
  7177         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7178         MOVE -1                 TO MAINTL
  7179         GO TO 8200-SEND-DATAONLY
  7180     END-IF.
  7181
  7182     IF (NOT PI-NO-CARRIER-SECURITY OR
  7183         NOT PI-NO-ACCOUNT-SECURITY)
  7184         MOVE AL-UABON      TO  PRTOPTA
  7185         MOVE -1            TO  PRTOPTL
  7186         MOVE ER-2378       TO  EMI-ERROR
  7187         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7188         GO TO 8200-SEND-DATAONLY
  7189     END-IF.
  7190
  7191     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7192     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7193     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7194     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7195
  7196
  7197
  7198* EXEC CICS HANDLE CONDITION
  7199*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7200*    END-EXEC.
  7201*    MOVE '"$I                   ! # #00007145' TO DFHEIV0
  7202     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7203     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7204     MOVE X'2320233030303037313435' TO DFHEIV0(25:11)
  7205     CALL 'kxdfhei1' USING DFHEIV0
  7206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7207
  7208
  7209
  7210
  7211* EXEC CICS READ
  7212*         UPDATE
  7213*         DATASET    (ELACTQ-DSID)
  7214*         SET        (ADDRESS OF ACTIVITY-QUE)
  7215*         RIDFLD     (ELACTQ-KEY)
  7216*    END-EXEC.
  7217*    MOVE '&"S        EU         (   #00007150' TO DFHEIV0
  7218     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7219     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7220     MOVE X'2020233030303037313530' TO DFHEIV0(25:11)
  7221     CALL 'kxdfhei1' USING DFHEIV0,
  7222           ELACTQ-DSID,
  7223           DFHEIV20,
  7224           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 140
* EL130.cbl
  7225           ELACTQ-KEY,
  7226           DFHEIV99,
  7227           DFHEIV99,
  7228           DFHEIV99
  7229     SET ADDRESS OF ACTIVITY-QUE TO
  7230         DFHEIV20
  7231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7232
  7233
  7234     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7235     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7236
  7237
  7238
  7239* EXEC CICS REWRITE
  7240*         DATASET     (ELACTQ-DSID)
  7241*         FROM        (ACTIVITY-QUE)
  7242*    END-EXEC.
  7243     MOVE LENGTH OF
  7244      ACTIVITY-QUE
  7245       TO DFHEIV11
  7246*    MOVE '&& L                  %   #00007161' TO DFHEIV0
  7247     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7248     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7249     MOVE X'2020233030303037313631' TO DFHEIV0(25:11)
  7250     CALL 'kxdfhei1' USING DFHEIV0,
  7251           ELACTQ-DSID,
  7252           ACTIVITY-QUE,
  7253           DFHEIV11,
  7254           DFHEIV99
  7255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7256
  7257
  7258     GO TO 0470-STATUS-FINISH.
  7259
  7260 0450-ADD-ELACTQ-RECORD.
  7261
  7262
  7263* EXEC CICS GETMAIN
  7264*        SET     (ADDRESS OF ACTIVITY-QUE)
  7265*        LENGTH  (ELACTQ-LENGTH)
  7266*        INITIMG (GETMAIN-SPACE)
  7267*    END-EXEC.
  7268*    MOVE ',"IL                  $   #00007170' TO DFHEIV0
  7269     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7270     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7271     MOVE X'2020233030303037313730' TO DFHEIV0(25:11)
  7272     CALL 'kxdfhei1' USING DFHEIV0,
  7273           DFHEIV20,
  7274           ELACTQ-LENGTH,
  7275           GETMAIN-SPACE
  7276     SET ADDRESS OF ACTIVITY-QUE TO
  7277         DFHEIV20
  7278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7279
  7280
  7281     MOVE 'AQ'              TO AQ-RECORD-ID.
  7282     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 141
* EL130.cbl
  7283     MOVE +0                TO AQ-PAYMENT-COUNTER
  7284                               AQ-PMT-UNAPPROVED-COUNT.
  7285     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7286                               AQ-FOLLOWUP-DATE.
  7287     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7288     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7289
  7290
  7291
  7292* EXEC CICS WRITE
  7293*         DATASET     (ELACTQ-DSID)
  7294*         FROM        (ACTIVITY-QUE)
  7295*         RIDFLD      (ELACTQ-KEY)
  7296*    END-EXEC.
  7297     MOVE LENGTH OF
  7298      ACTIVITY-QUE
  7299       TO DFHEIV11
  7300*    MOVE '&$ L                  ''   #00007186' TO DFHEIV0
  7301     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7302     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7303     MOVE X'2020233030303037313836' TO DFHEIV0(25:11)
  7304     CALL 'kxdfhei1' USING DFHEIV0,
  7305           ELACTQ-DSID,
  7306           ACTIVITY-QUE,
  7307           DFHEIV11,
  7308           ELACTQ-KEY,
  7309           DFHEIV99,
  7310           DFHEIV99
  7311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7312
  7313
  7314 0470-STATUS-FINISH.
  7315     MOVE AL-UANOF               TO  PRTOPTA
  7316                                     ALTPRTA.
  7317
  7318     MOVE SPACES                 TO  PRTOPTO
  7319                                     ALTPRTO.
  7320
  7321     MOVE ER-0000                TO EMI-ERROR.
  7322     MOVE -1                     TO MAINTL.
  7323     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7324     GO TO 8100-SEND-INITIAL-MAP.
  7325
  7326 0480-PRINT-NOW.
  7327
  7328
  7329* EXEC CICS HANDLE CONDITION
  7330*        TERMIDERR   (8820-TERM-ERROR)
  7331*        TRANSIDERR  (8830-TRAN-ERROR)
  7332*    END-EXEC.
  7333*    MOVE '"$[\                  ! $ #00007206' TO DFHEIV0
  7334     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7335     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7336     MOVE X'2420233030303037323036' TO DFHEIV0(25:11)
  7337     CALL 'kxdfhei1' USING DFHEIV0
  7338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7339
  7340
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 142
* EL130.cbl
  7341     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7342     MOVE '1'                    TO  CNTL-REC-TYPE.
  7343     MOVE SPACES                 TO  CNTL-ACCESS.
  7344     MOVE +0                     TO  CNTL-SEQ-NO.
  7345     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7346
  7347     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7348
  7349     IF CF-FORMS-PRINTER-ID = SPACES
  7350         IF ALTPRTL NOT GREATER THAN 0
  7351             MOVE ER-0337        TO  EMI-ERROR
  7352             MOVE -1             TO  ALTPRTL
  7353             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7354             GO TO 8200-SEND-DATAONLY
  7355         END-IF
  7356     END-IF.
  7357
  7358     IF ALTPRTL GREATER THAN 0
  7359         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7360     END-IF.
  7361
  7362     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7363     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7364     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7365
  7366
  7367
  7368* EXEC CICS START
  7369*        TRANSID   (START-TRANS-ID)
  7370*        TERMID    (CF-FORMS-PRINTER-ID)
  7371*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7372*        LENGTH    (PI-COMM-LENGTH)
  7373*    END-EXEC.
  7374*    MOVE '0( LFT                0   #00007237' TO DFHEIV0
  7375     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7376     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  7377     MOVE X'2020233030303037323337' TO DFHEIV0(25:11)
  7378     CALL 'kxdfhei1' USING DFHEIV0,
  7379           DFHEIV99,
  7380           START-TRANS-ID,
  7381           DFHEIV99,
  7382           PROGRAM-INTERFACE-BLOCK,
  7383           PI-COMM-LENGTH,
  7384           CF-FORMS-PRINTER-ID,
  7385           DFHEIV99,
  7386           DFHEIV99,
  7387           DFHEIV99,
  7388           DFHEIV99,
  7389           DFHEIV99,
  7390           DFHEIV99,
  7391           DFHEIV99,
  7392           DFHEIV99,
  7393           DFHEIV99
  7394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7395
  7396
  7397     MOVE AL-UANOF               TO  PRTOPTA
  7398                                     ALTPRTA.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 143
* EL130.cbl
  7399
  7400     MOVE SPACES                 TO  PRTOPTO
  7401                                     ALTPRTO.
  7402
  7403     MOVE ER-0000                TO  EMI-ERROR.
  7404     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7405     MOVE -1                     TO  MAINTL.
  7406     GO TO 8100-SEND-INITIAL-MAP.
  7407
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 144
* EL130.cbl
  7409 0500-CREATE-TEMP-STORAGE.
  7410     MOVE EIBCPOSN               TO PI-CURSOR.
  7411
  7412
  7413
  7414* EXEC CICS WRITEQ TS
  7415*        QUEUE   (QID)
  7416*        FROM    (EL130AI)
  7417*        LENGTH  (QID-MAP-LENGTH)
  7418*    END-EXEC.
  7419*    MOVE '*"                    ''   #00007260' TO DFHEIV0
  7420     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7421     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7422     MOVE X'2020233030303037323630' TO DFHEIV0(25:11)
  7423     CALL 'kxdfhei1' USING DFHEIV0,
  7424           QID,
  7425           EL130AI,
  7426           QID-MAP-LENGTH,
  7427           DFHEIV99,
  7428           DFHEIV99,
  7429           DFHEIV99
  7430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7431
  7432
  7433
  7434
  7435* EXEC CICS WRITEQ TS
  7436*        QUEUE    (QID)
  7437*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7438*        LENGTH   (PI-COMM-LENGTH)
  7439*    END-EXEC.
  7440*    MOVE '*"                    ''   #00007267' TO DFHEIV0
  7441     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7442     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7443     MOVE X'2020233030303037323637' TO DFHEIV0(25:11)
  7444     CALL 'kxdfhei1' USING DFHEIV0,
  7445           QID,
  7446           PROGRAM-INTERFACE-BLOCK,
  7447           PI-COMM-LENGTH,
  7448           DFHEIV99,
  7449           DFHEIV99,
  7450           DFHEIV99
  7451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7452
  7453
  7454 0599-EXIT.
  7455      EXIT.
  7456
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 145
* EL130.cbl
  7458 0600-RECOVER-TEMP-STORAGE.
  7459     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7460     MOVE PI-EL127-TO-EL130-CNTRL
  7461                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7462     MOVE PI-EL659-TO-EL130-CNTRL
  7463                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7464     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7465     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7466     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7467     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7468     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7469     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7470     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7471     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7472     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7473     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7474     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7475     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7476     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7477     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7478     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7479     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7480                                 TO SAVE-BENEFICIARY
  7481
  7482
  7483
  7484* EXEC CICS HANDLE CONDITION
  7485*        NOTFND  (0660-NOT-FOUND)
  7486*        QIDERR  (0670-QIDERR)
  7487*    END-EXEC.
  7488*    MOVE '"$IN                  ! % #00007302' TO DFHEIV0
  7489     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7490     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7491     MOVE X'2520233030303037333032' TO DFHEIV0(25:11)
  7492     CALL 'kxdfhei1' USING DFHEIV0
  7493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7494
  7495
  7496
  7497
  7498* EXEC CICS READQ TS
  7499*        QUEUE    (QID)
  7500*        INTO     (EL130AI)
  7501*        LENGTH   (QID-MAP-LENGTH)
  7502*    END-EXEC.
  7503*    MOVE '*$I    L              ''   #00007308' TO DFHEIV0
  7504     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7505     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7506     MOVE X'2020233030303037333038' TO DFHEIV0(25:11)
  7507     CALL 'kxdfhei1' USING DFHEIV0,
  7508           QID,
  7509           EL130AI,
  7510           QID-MAP-LENGTH,
  7511           DFHEIV99,
  7512           DFHEIV99,
  7513           DFHEIV99
  7514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7515
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 146
* EL130.cbl
  7516
  7517     IF RETURNED-FROM = XCTL-131
  7518        IF CLAIM-DELETED-BY-EL131
  7519            MOVE LOW-VALUES      TO CERTNOI
  7520                                    SUFXI
  7521            MOVE ZEROS           TO CERTNOL
  7522                                    SUFXL
  7523         END-IF
  7524     END-IF.
  7525
  7526     IF RETURNED-FROM = XCTL-131
  7527         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7528         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7529                                    PI-CERT-PROCESSED
  7530     ELSE
  7531
  7532
  7533* EXEC CICS READQ TS
  7534*             QUEUE   (QID)
  7535*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7536*             LENGTH  (PI-COMM-LENGTH)
  7537*        END-EXEC
  7538*    MOVE '*$I    L              ''   #00007329' TO DFHEIV0
  7539     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7540     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7541     MOVE X'2020233030303037333239' TO DFHEIV0(25:11)
  7542     CALL 'kxdfhei1' USING DFHEIV0,
  7543           QID,
  7544           PROGRAM-INTERFACE-BLOCK,
  7545           PI-COMM-LENGTH,
  7546           DFHEIV99,
  7547           DFHEIV99,
  7548           DFHEIV99
  7549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7550     END-IF.
  7551
  7552
  7553* EXEC CICS DELETEQ TS
  7554*        QUEUE   (QID)
  7555*    END-EXEC.
  7556*    MOVE '*&                    #   #00007336' TO DFHEIV0
  7557     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7558     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7559     MOVE X'2020233030303037333336' TO DFHEIV0(25:11)
  7560     CALL 'kxdfhei1' USING DFHEIV0,
  7561           QID,
  7562           DFHEIV99
  7563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7564
  7565
  7566     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7567
  7568     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7569         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7570         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7571         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7572         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7573         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 147
* EL130.cbl
  7574         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7575         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7576         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7577         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7578         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7579         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7580         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7581         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7582         MOVE SAVE-CERT-ACCESS-CONTROL
  7583                                    TO PI-CERT-ACCESS-CONTROL
  7584         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7585                                    TO PI-CARRIER-CONTROL-LEVEL
  7586     END-IF.
  7587
  7588     IF RETURNED-FROM = XCTL-127
  7589         MOVE SAVE-EL127-TO-EL130-CNTRL
  7590                                 TO PI-EL127-TO-EL130-CNTRL
  7591     END-IF.
  7592
  7593     IF RETURNED-FROM = XCTL-6592
  7594        MOVE SAVE-EL659-TO-EL130-CNTRL
  7595                                 TO PI-EL659-TO-EL130-CNTRL
  7596     END-IF.
  7597
  7598     IF RETURNED-FROM = XCTL-114
  7599        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7600           MOVE SAVE-BENEFICIARY TO BENECDI
  7601           MOVE +10              TO BENECDL
  7602           MOVE -1               TO BIRTHDTL
  7603        END-IF
  7604     END-IF.
  7605     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  7606
  7607     IF MAINTL NOT = ZERO
  7608         MOVE AL-UANON           TO MAINTA
  7609     END-IF.
  7610
  7611     IF ENTERPFL NOT = ZERO
  7612         MOVE AL-UNNON           TO ENTERPFA
  7613     END-IF.
  7614
  7615     IF RETURNED-FROM = XCTL-127
  7616         GO TO 0650-FROM-EL127
  7617     END-IF.
  7618
  7619     IF RETURNED-FROM = XCTL-132
  7620         GO TO 0640-FROM-EL132
  7621     END-IF.
  7622
  7623     IF RETURNED-FROM = XCTL-650
  7624         MOVE AL-SABON           TO PF5A
  7625         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
  7626     END-IF.
  7627
  7628     IF RETURNED-FROM = XCTL-6592
  7629         GO TO 0630-FROM-EL6592
  7630     END-IF.
  7631
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 148
* EL130.cbl
  7632     IF MAINTI = 'S' OR 'I'
  7633        GO TO 1000-SHOW-CLAIM
  7634     END-IF.
  7635
  7636     GO TO 8100-SEND-INITIAL-MAP.
  7637
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 149
* EL130.cbl
  7639 0630-FROM-EL6592.
  7640     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  7641     MOVE PI-EL659-GROUPING      TO GROUPO.
  7642     MOVE PI-EL659-STATE         TO STATEO.
  7643     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  7644
  7645     MOVE AL-UANON               TO CRTCARRA
  7646                                    GROUPA
  7647                                    STATEA
  7648                                    ACCOUNTA.
  7649     GO TO 8100-SEND-INITIAL-MAP.
  7650
  7651 0640-FROM-EL132.
  7652     IF PI-CLAIM-NO = SPACES
  7653         GO TO 0645-NO-CLAIM-SELECTED
  7654     END-IF.
  7655
  7656     MOVE LOW-VALUES             TO EL130AI.
  7657     MOVE 'MSTR'                 TO FILE-SWITCH.
  7658     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  7659     MOVE PI-CARRIER             TO MSTR-CARRIER.
  7660     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  7661                                    CLMNOO.
  7662     MOVE AL-UANON               TO CLMNOA.
  7663     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  7664
  7665
  7666
  7667* EXEC CICS HANDLE CONDITION
  7668*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  7669*    END-EXEC.
  7670*    MOVE '"$I                   ! & #00007440' TO DFHEIV0
  7671     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7673     MOVE X'2620233030303037343430' TO DFHEIV0(25:11)
  7674     CALL 'kxdfhei1' USING DFHEIV0
  7675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7676
  7677
  7678     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  7679     MOVE 'X'                    TO CLAIM-SWITCH.
  7680     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  7681     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  7682     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  7683     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7684
  7685     MOVE ER-0213                TO EMI-ERROR.
  7686     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7687     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  7688     GO TO 8100-SEND-INITIAL-MAP.
  7689
  7690 0645-NO-CLAIM-SELECTED.
  7691
  7692     IF MAINTI = 'S' OR 'I'
  7693        GO TO 1000-SHOW-CLAIM
  7694     END-IF.
  7695
  7696     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 150
* EL130.cbl
  7697
  7698 0650-FROM-EL127.
  7699
  7700     IF PI-CERT-SELECT-CNT GREATER THAN +6
  7701         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7702                                    PI-CERT-PROCESSED
  7703     END-IF.
  7704
  7705     IF PI-RETURN-TO-PROGRAM = XCTL-727
  7706         MOVE +1                 TO PI-CERT-SELECT-CNT
  7707                                    PI-CERT-PROCESSED
  7708         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  7709         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  7710         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  7711         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  7712         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  7713         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  7714     END-IF.
  7715
  7716     IF PI-CERT-SELECT-CNT = ZERO
  7717         IF CERTNOI NOT = SPACES AND LOW-VALUES
  7718             MOVE CERTNOI        TO PI-CERT-NO
  7719             MOVE SUFXI          TO PI-CERT-SFX
  7720             GO TO 3000-READ-CERT
  7721         ELSE
  7722             GO TO 8100-SEND-INITIAL-MAP
  7723         END-IF
  7724     END-IF.
  7725
  7726     MOVE AL-SABON               TO PF5A.
  7727
  7728     IF PI-CERT-PROCESSED = 1
  7729         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  7730     END-IF.
  7731
  7732     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  7733     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  7734
  7735     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  7736     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  7737                                 TO CERT-CARRIER
  7738                                    PI-CARRIER.
  7739     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  7740                                 TO CERT-GROUPING
  7741                                    PI-GROUPING.
  7742     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  7743                                 TO CERT-STATE
  7744                                    PI-STATE.
  7745     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  7746                                 TO CERT-ACCOUNT
  7747                                    PI-ACCOUNT.
  7748     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  7749                                 TO CERT-EFF-DT
  7750                                    PI-CERT-EFF-DT.
  7751     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  7752                                 TO CERT-CERT-NO
  7753                                    PI-CERT-NO.
  7754
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 151
* EL130.cbl
  7755     MOVE 'CERT'                 TO FILE-SWITCH.
  7756     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  7757
  7758     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  7759     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  7760     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  7761
  7762     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  7763         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  7764         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  7765         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  7766         IF INCURRED-DATE-MATCH
  7767             MOVE ER-7352        TO EMI-ERROR
  7768             MOVE -1             TO CERTNOL
  7769             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7770         ELSE
  7771             IF NO-CLAIMS-FOR-CERT
  7772                 MOVE ER-7353    TO EMI-ERROR
  7773                 MOVE -1         TO CERTNOL
  7774                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7775             ELSE
  7776                 MOVE ER-0558    TO EMI-ERROR
  7777                 MOVE -1         TO CERTNOL
  7778                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7779             END-IF
  7780         END-IF
  7781     END-IF.
  7782
  7783     MOVE SPACES                 TO PI-PRT-OPT
  7784                                    PI-ALT-PRT.
  7785
  7786     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7787
  7788     IF LSTNMEL NOT GREATER ZERO
  7789        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  7790         MOVE CRTLNMEI           TO  LSTNMEO
  7791         MOVE CRTFNMEI           TO  FSTNMEO
  7792         MOVE CRTINITI           TO  INITO
  7793         MOVE AL-UANON           TO  LSTNMEA
  7794                                     FSTNMEA
  7795                                     INITA
  7796     END-IF.
  7797
  7798     IF SSNL GREATER ZERO
  7799         GO TO 0655-SKIP-SOCIAL-SECURITY
  7800     END-IF.
  7801
  7802     IF CRTSSNI = SPACES OR LOW-VALUES
  7803         GO TO 0655-SKIP-SOCIAL-SECURITY
  7804     END-IF.
  7805
  7806     IF CM-SSN-STATE   = CM-STATE AND
  7807        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  7808            GO TO 0655-SKIP-SOCIAL-SECURITY
  7809     END-IF.
  7810
  7811     MOVE CRTSSNI                TO SSNO
  7812     MOVE AL-UANON               TO SSNA.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 152
* EL130.cbl
  7813
  7814 0655-SKIP-SOCIAL-SECURITY.
  7815
  7816     IF CLMCARRL NOT = ZERO  AND
  7817        CLMCARRI NOT = CRTCARRI
  7818        MOVE ER-0562             TO EMI-ERROR
  7819        MOVE AL-UABON            TO CLMCARRA
  7820        MOVE -1                  TO CLMCARRL
  7821        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7822     END-IF.
  7823
  7824     IF CLMCARRL = ZERO
  7825        MOVE AL-UANON            TO CLMCARRA
  7826        MOVE CRTCARRI            TO CLMCARRI
  7827     END-IF.
  7828
  7829     MOVE 'A'                    TO MAINTO.
  7830     MOVE AL-UANON               TO MAINTA.
  7831
  7832     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7833        GO TO 8100-SEND-INITIAL-MAP
  7834     ELSE
  7835        GO TO 8150-SEND-MAP-CURSOR
  7836     END-IF.
  7837
  7838 0660-NOT-FOUND.
  7839     MOVE ER-0214                TO EMI-ERROR.
  7840     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7841     GO TO 8100-SEND-INITIAL-MAP.
  7842
  7843 0670-QIDERR.
  7844     MOVE ER-0033                TO EMI-ERROR.
  7845     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7846     GO TO 8100-SEND-INITIAL-MAP.
  7847
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 153
* EL130.cbl
  7849 0680-PLUG-SELECTED-CERTS.
  7850
  7851     MOVE AL-SANON               TO BCERT1A
  7852                                    BSUFX1A
  7853                                    BCERT2A
  7854                                    BSUFX2A
  7855                                    BCERT3A
  7856                                    BSUFX3A
  7857                                    BCERT4A
  7858                                    BSUFX4A
  7859                                    BCERT5A
  7860                                    BSUFX5A.
  7861
  7862     IF PCERTNOO = SPACES OR LOW-VALUES
  7863         MOVE PI-EL127-CERT-PRIME (1)
  7864                                 TO PCERTNOO
  7865         MOVE PI-EL127-CERT-SUFX  (1)
  7866                                 TO PSUFXO
  7867     END-IF.
  7868
  7869     MOVE PI-EL127-CERT-PRIME (1)
  7870                                 TO BCERT1O.
  7871     MOVE PI-EL127-CERT-SUFX  (1)
  7872                                 TO BSUFX1O.
  7873
  7874     IF PI-CERT-SELECT-CNT GREATER THAN 1
  7875         MOVE PI-EL127-CERT-PRIME (2)
  7876                                 TO BCERT2O
  7877         MOVE PI-EL127-CERT-SUFX  (2)
  7878                                 TO BSUFX2O
  7879     ELSE
  7880         MOVE LOW-VALUES         TO BCERT2O
  7881                                    BSUFX2O
  7882     END-IF.
  7883
  7884     IF PI-CERT-SELECT-CNT GREATER THAN 2
  7885         MOVE PI-EL127-CERT-PRIME (3)
  7886                                 TO BCERT3O
  7887         MOVE PI-EL127-CERT-SUFX  (3)
  7888                                 TO BSUFX3O
  7889     ELSE
  7890         MOVE LOW-VALUES         TO BCERT3O
  7891                                    BSUFX3O
  7892     END-IF.
  7893
  7894     IF PI-CERT-SELECT-CNT GREATER THAN 3
  7895         MOVE PI-EL127-CERT-PRIME (4)
  7896                                 TO BCERT4O
  7897         MOVE PI-EL127-CERT-SUFX  (4)
  7898                                 TO BSUFX4O
  7899     ELSE
  7900         MOVE LOW-VALUES         TO BCERT4O
  7901                                    BSUFX4O
  7902     END-IF.
  7903
  7904     IF PI-CERT-SELECT-CNT GREATER THAN 4
  7905         MOVE PI-EL127-CERT-PRIME (5)
  7906                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 154
* EL130.cbl
  7907         MOVE PI-EL127-CERT-SUFX  (5)
  7908                                 TO BSUFX5O
  7909     ELSE
  7910         MOVE LOW-VALUES         TO BCERT5O
  7911                                    BSUFX5O
  7912     END-IF.
  7913
  7914 0680-EXIT.
  7915     EXIT.
  7916
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 155
* EL130.cbl
  7918 0690-HIGHLIGHT-CERTS.
  7919
  7920     MOVE AL-UANON               TO PCERTNOA
  7921                                    PSUFXA.
  7922
  7923     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7924        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7925            MOVE AL-SABON        TO BCERT1A
  7926                                    BSUFX1A
  7927     ELSE
  7928         MOVE AL-SANON           TO BCERT1A
  7929                                    BSUFX1A
  7930     END-IF.
  7931
  7932     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7933        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7934            MOVE AL-SABON        TO BCERT2A
  7935                                    BSUFX2A
  7936     ELSE
  7937         MOVE AL-SANON           TO BCERT2A
  7938                                    BSUFX2A
  7939     END-IF.
  7940
  7941     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7942        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7943            MOVE AL-SABON        TO BCERT3A
  7944                                    BSUFX3A
  7945     ELSE
  7946         MOVE AL-SANON           TO BCERT3A
  7947                                    BSUFX3A
  7948     END-IF.
  7949
  7950     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7951        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7952            MOVE AL-SABON        TO BCERT4A
  7953                                    BSUFX4A
  7954     ELSE
  7955         MOVE AL-SANON           TO BCERT4A
  7956                                    BSUFX4A
  7957     END-IF.
  7958
  7959     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7960        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7961            MOVE AL-SABON        TO BCERT5A
  7962                                    BSUFX5A
  7963     ELSE
  7964         MOVE AL-SANON           TO BCERT5A
  7965                                    BSUFX5A
  7966     END-IF.
  7967
  7968 0690-EXIT.
  7969     EXIT.
  7970
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 156
* EL130.cbl
  7972 0800-TEST-PREVIOUS-CONTROL.
  7973     IF CLMNOI   = PI-LAST-CLAIM       AND
  7974        CLMCARRI = PI-LAST-CARR        AND
  7975        CERTNOI  = PI-LAST-CERT-PRIME  AND
  7976        SUFXI    = PI-LAST-CERT-SUFX
  7977*        NEXT SENTENCE
  7978         CONTINUE
  7979     ELSE
  7980         MOVE ER-0207            TO EMI-ERROR
  7981         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7982         MOVE -1                 TO MAINTL
  7983         GO TO 8200-SEND-DATAONLY
  7984     END-IF.
  7985
  7986     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  7987
  7988     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  7989     MOVE PI-LAST-CARR           TO PI-CARRIER.
  7990     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  7991
  7992     IF EIBAID = DFHPF7
  7993         MOVE XCTL-157           TO PGM-NAME
  7994     END-IF.
  7995
  7996     IF EIBAID = DFHPF8
  7997         MOVE XCTL-141           TO PGM-NAME
  7998     END-IF.
  7999
  8000     IF EIBAID = DFHPF9
  8001        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8002                                    PI-SAVED-PROGRAM-2
  8003                                    PI-SAVED-PROGRAM-3
  8004                                    PI-SAVED-PROGRAM-4
  8005                                    PI-SAVED-PROGRAM-5
  8006                                    PI-SAVED-PROGRAM-6
  8007        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8008        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8009        MOVE XCTL-150            TO PGM-NAME
  8010     END-IF.
  8011
  8012     GO TO 9300-XCTL.
  8013
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 157
* EL130.cbl
  8015 1000-SHOW-CLAIM.
  8016
  8017     IF CLMNOL = ZERO
  8018         MOVE -1                 TO CLMNOL
  8019         MOVE AL-UABON           TO CLMNOA
  8020         MOVE ER-0202            TO EMI-ERROR
  8021         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8022     ELSE
  8023         MOVE AL-UANON           TO CLMNOA
  8024     END-IF.
  8025
  8026     IF PI-NO-CARRIER-SECURITY
  8027        IF CLMCARRL = ZERO
  8028             MOVE -1             TO CLMCARRL
  8029             MOVE AL-UABON       TO CLMCARRA
  8030             MOVE ER-0194        TO EMI-ERROR
  8031             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8032         ELSE
  8033             MOVE AL-UANON       TO CLMCARRA
  8034         END-IF
  8035     END-IF.
  8036
  8037     IF SUFXL = ZERO
  8038         MOVE SPACES             TO SUFXI
  8039         MOVE AL-UANON           TO SUFXA
  8040     ELSE
  8041         MOVE AL-UANON           TO SUFXA
  8042     END-IF.
  8043
  8044     IF NOT EMI-NO-ERRORS
  8045         GO TO 1050-SEND-CHECK
  8046     END-IF.
  8047
  8048
  8049
  8050* EXEC CICS HANDLE CONDITION
  8051*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8052*    END-EXEC.
  8053*    MOVE '"$I                   ! '' #00007815' TO DFHEIV0
  8054     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8055     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8056     MOVE X'2720233030303037383135' TO DFHEIV0(25:11)
  8057     CALL 'kxdfhei1' USING DFHEIV0
  8058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8059
  8060
  8061     MOVE 'MSTR'                 TO FILE-SWITCH
  8062     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8063
  8064     MOVE CLMCARRI               TO MSTR-CARRIER.
  8065     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8066
  8067     IF CERTNOL = ZERO     OR
  8068        CERTNOI = SPACES   OR
  8069        CERTNOI = LOW-VALUES
  8070         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8071         MOVE AL-SANON        TO CERTNOA
  8072                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 158
* EL130.cbl
  8073     ELSE
  8074         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8075     END-IF.
  8076
  8077     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8078     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8079
  8080
  8081
  8082* EXEC CICS HANDLE CONDITION
  8083*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8084*    END-EXEC.
  8085*    MOVE '"$I                   ! ( #00007839' TO DFHEIV0
  8086     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8087     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8088     MOVE X'2820233030303037383339' TO DFHEIV0(25:11)
  8089     CALL 'kxdfhei1' USING DFHEIV0
  8090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8091
  8092
  8093     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8094
  8095     IF NOT PI-NO-ACCOUNT-SECURITY
  8096         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8097           MOVE ER-2371          TO EMI-ERROR
  8098           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8099           MOVE -1               TO MAINTL
  8100           GO TO 8200-SEND-DATAONLY
  8101         END-IF
  8102     END-IF.
  8103
  8104
  8105
  8106* EXEC CICS HANDLE CONDITION
  8107*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8108*    END-EXEC.
  8109*    MOVE '"$I                   ! ) #00007855' TO DFHEIV0
  8110     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8111     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8112     MOVE X'2920233030303037383535' TO DFHEIV0(25:11)
  8113     CALL 'kxdfhei1' USING DFHEIV0
  8114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8115
  8116
  8117     MOVE 'Y'                    TO CLAIM-SWITCH.
  8118     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8119     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8120     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8121
  8122 1000-SHOW-END-OF-PERFORM.
  8123
  8124     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8125     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8126     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8127     MOVE CL-CERT-STATE          TO CERT-STATE.
  8128     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8129     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8130     MOVE CL-CERT-NO             TO CERT-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 159
* EL130.cbl
  8131
  8132     MOVE 'CERT'                 TO FILE-SWITCH.
  8133
  8134     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8135
  8136     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8137     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8138     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8139     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8140     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8141     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8142     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8143     MOVE CLMCARRI               TO PI-LAST-CARR.
  8144
  8145     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8146
  8147     IF MAINTI = 'I'
  8148         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8149                 BIRTHDTA  LSTNMEA   RELCLMA   OCCCDA
  8150                 LOANNOA   LOANBALA  BENECDA
  8151         MOVE AL-SANON TO  SSNA
  8152         MOVE SPACES   TO  INCURI    REPORTI  ESTENDI
  8153         MOVE 'Y'      TO PI-INCURR-SW
  8154         MOVE ER-0522  TO EMI-ERROR
  8155         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8156     ELSE
  8157         MOVE ' '      TO PI-INCURR-SW
  8158     END-IF.
  8159
  8160     MOVE -1                     TO MAINTL.
  8161     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8162     MOVE CERT-GROUPING          TO PI-GROUPING.
  8163     MOVE CERT-STATE             TO PI-STATE.
  8164     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8165     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8166     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8167     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8168
  8169     IF RETURNED-FROM NOT = SPACES
  8170         GO TO 8100-SEND-INITIAL-MAP
  8171     ELSE
  8172         GO TO 8200-SEND-DATAONLY
  8173     END-IF.
  8174
  8175 1025-SHOW-RECORD-NOT-FOUND.
  8176
  8177     IF FILE-SWITCH = 'MSTR'
  8178         MOVE ER-0204            TO EMI-ERROR
  8179     ELSE
  8180         IF FILE-SWITCH = 'TRLR'
  8181             MOVE ER-0205        TO EMI-ERROR
  8182         ELSE
  8183             MOVE ER-0206        TO EMI-ERROR
  8184         END-IF
  8185     END-IF.
  8186
  8187     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8188
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 160
* EL130.cbl
  8189 1050-SEND-CHECK.
  8190
  8191     IF RETURNED-FROM NOT = SPACES
  8192         GO TO 8100-SEND-INITIAL-MAP
  8193     ELSE
  8194         MOVE -1                 TO MAINTL
  8195         GO TO 8200-SEND-DATAONLY
  8196     END-IF.
  8197
  8198 2000-DELETE-CLAIM.
  8199     IF NOT MODIFY-CAP
  8200         MOVE ER-0070            TO EMI-ERROR
  8201         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8202         MOVE -1                 TO MAINTL
  8203         GO TO 8200-SEND-DATAONLY
  8204     END-IF.
  8205
  8206     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8207        CLMCARRI NOT = PI-LAST-CARR        OR
  8208        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8209        SUFXI    NOT = PI-LAST-CERT-SUFX
  8210         MOVE ER-0207            TO EMI-ERROR
  8211         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8212         MOVE -1                 TO MAINTL
  8213         GO TO 8200-SEND-DATAONLY
  8214     END-IF.
  8215
  8216
  8217
  8218* EXEC CICS HANDLE CONDITION
  8219*        NOTFND   (2050-DELETE-NOT-FOUND)
  8220*    END-EXEC.
  8221*    MOVE '"$I                   ! * #00007959' TO DFHEIV0
  8222     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8223     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8224     MOVE X'2A20233030303037393539' TO DFHEIV0(25:11)
  8225     CALL 'kxdfhei1' USING DFHEIV0
  8226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8227
  8228
  8229     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8230
  8231     MOVE CLMCARRI               TO MSTR-CARRIER.
  8232     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8233     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8234     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8235
  8236     MOVE 'MSTR'                 TO FILE-SWITCH.
  8237     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8238
  8239     MOVE 'Y'                    TO CLAIM-SWITCH.
  8240
  8241     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8242        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8243         MOVE ER-0068        TO EMI-ERROR
  8244         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8245         MOVE -1             TO MAINTL
  8246         GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 161
* EL130.cbl
  8247     END-IF.
  8248
  8249     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8250         MOVE ER-0569            TO EMI-ERROR
  8251         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8252         MOVE -1                 TO MAINTL
  8253         GO TO 8200-SEND-DATAONLY
  8254     END-IF.
  8255
  8256     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8257         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8258     END-IF.
  8259
  8260     IF CL-PURGED-DT NOT = LOW-VALUES
  8261         MOVE ER-7691            TO EMI-ERROR
  8262         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8263         MOVE -1                 TO MAINTL
  8264         GO TO 8200-SEND-DATAONLY
  8265     END-IF.
  8266
  8267     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8268     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8269     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8270     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8271     MOVE +0                     TO TRLR-SEQ-NO.
  8272     MOVE '1'                    TO TRLR-TYPE.
  8273
  8274     MOVE 'TRLR'                 TO FILE-SWITCH.
  8275
  8276
  8277
  8278* EXEC CICS READ
  8279*        UPDATE
  8280*        DATASET  (ELTRLR-DSID)
  8281*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8282*        RIDFLD   (ELTRLR-KEY)
  8283*    END-EXEC.
  8284*    MOVE '&"S        EU         (   #00008011' TO DFHEIV0
  8285     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8286     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8287     MOVE X'2020233030303038303131' TO DFHEIV0(25:11)
  8288     CALL 'kxdfhei1' USING DFHEIV0,
  8289           ELTRLR-DSID,
  8290           DFHEIV20,
  8291           DFHEIV99,
  8292           ELTRLR-KEY,
  8293           DFHEIV99,
  8294           DFHEIV99,
  8295           DFHEIV99
  8296     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8297         DFHEIV20
  8298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8299
  8300
  8301     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8302        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
  8303         MOVE ER-0068        TO EMI-ERROR
  8304         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 162
* EL130.cbl
  8305         MOVE -1             TO MAINTL
  8306         GO TO 8200-SEND-DATAONLY
  8307     END-IF.
  8308
  8309
  8310
  8311* EXEC CICS DELETE
  8312*        DATASET   (ELTRLR-DSID)
  8313*    END-EXEC.
  8314*    MOVE '&(                    &   #00008027' TO DFHEIV0
  8315     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8316     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8317     MOVE X'2020233030303038303237' TO DFHEIV0(25:11)
  8318     CALL 'kxdfhei1' USING DFHEIV0,
  8319           ELTRLR-DSID,
  8320           DFHEIV99,
  8321           DFHEIV99,
  8322           DFHEIV99,
  8323           DFHEIV99
  8324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8325
  8326
  8327     MOVE +90                    TO TRLR-SEQ-NO.
  8328     MOVE '6'                    TO TRLR-TYPE.
  8329
  8330
  8331
  8332* EXEC CICS READ
  8333*        UPDATE
  8334*        DATASET  (ELTRLR-DSID)
  8335*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8336*        RIDFLD   (ELTRLR-KEY)
  8337*    END-EXEC.
  8338*    MOVE '&"S        EU         (   #00008035' TO DFHEIV0
  8339     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8340     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8341     MOVE X'2020233030303038303335' TO DFHEIV0(25:11)
  8342     CALL 'kxdfhei1' USING DFHEIV0,
  8343           ELTRLR-DSID,
  8344           DFHEIV20,
  8345           DFHEIV99,
  8346           ELTRLR-KEY,
  8347           DFHEIV99,
  8348           DFHEIV99,
  8349           DFHEIV99
  8350     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8351         DFHEIV20
  8352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8353
  8354
  8355
  8356
  8357* EXEC CICS DELETE
  8358*        DATASET   (ELTRLR-DSID)
  8359*    END-EXEC.
  8360*    MOVE '&(                    &   #00008043' TO DFHEIV0
  8361     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8362     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 163
* EL130.cbl
  8363     MOVE X'2020233030303038303433' TO DFHEIV0(25:11)
  8364     CALL 'kxdfhei1' USING DFHEIV0,
  8365           ELTRLR-DSID,
  8366           DFHEIV99,
  8367           DFHEIV99,
  8368           DFHEIV99,
  8369           DFHEIV99
  8370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8371
  8372
  8373     MOVE +91                    TO TRLR-SEQ-NO.
  8374     MOVE '6'                    TO TRLR-TYPE.
  8375
  8376
  8377
  8378* EXEC CICS READ
  8379*        UPDATE
  8380*        DATASET  (ELTRLR-DSID)
  8381*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8382*        RIDFLD   (ELTRLR-KEY)
  8383*        RESP     (WS-RESPONSE)
  8384*    END-EXEC
  8385*    MOVE '&"S        EU         (  N#00008051' TO DFHEIV0
  8386     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8387     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8388     MOVE X'204E233030303038303531' TO DFHEIV0(25:11)
  8389     CALL 'kxdfhei1' USING DFHEIV0,
  8390           ELTRLR-DSID,
  8391           DFHEIV20,
  8392           DFHEIV99,
  8393           ELTRLR-KEY,
  8394           DFHEIV99,
  8395           DFHEIV99,
  8396           DFHEIV99
  8397     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8398         DFHEIV20
  8399     MOVE EIBRESP  TO WS-RESPONSE
  8400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8401
  8402     IF WS-RESP-NORMAL
  8403
  8404* EXEC CICS DELETE
  8405*          DATASET   (ELTRLR-DSID)
  8406*       END-EXEC
  8407*    MOVE '&(                    &   #00008060' TO DFHEIV0
  8408     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8409     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8410     MOVE X'2020233030303038303630' TO DFHEIV0(25:11)
  8411     CALL 'kxdfhei1' USING DFHEIV0,
  8412           ELTRLR-DSID,
  8413           DFHEIV99,
  8414           DFHEIV99,
  8415           DFHEIV99,
  8416           DFHEIV99
  8417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8418     END-IF.
  8419
  8420     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 164
* EL130.cbl
  8421     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8422     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8423     MOVE CL-CERT-STATE          TO CERT-STATE.
  8424     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8425     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8426     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8427
  8428     MOVE 'CERT'                 TO FILE-SWITCH.
  8429
  8430     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8431
  8432     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8433
  8434     IF WS-NUM-HOLD NOT = +0
  8435         GO TO 2005-REWRITE-CERT
  8436     END-IF.
  8437
  8438     IF NOT CERT-WAS-CREATED
  8439         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8440         GO TO 2005-REWRITE-CERT
  8441     END-IF.
  8442
  8443
  8444
  8445* EXEC CICS DELETE
  8446*        DATASET   (ELCERT-DSID)
  8447*    END-EXEC.
  8448*    MOVE '&(                    &   #00008089' TO DFHEIV0
  8449     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8450     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8451     MOVE X'2020233030303038303839' TO DFHEIV0(25:11)
  8452     CALL 'kxdfhei1' USING DFHEIV0,
  8453           ELCERT-DSID,
  8454           DFHEIV99,
  8455           DFHEIV99,
  8456           DFHEIV99,
  8457           DFHEIV99
  8458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8459
  8460
  8461     GO TO 2010-DELETE-CL.
  8462
  8463 2005-REWRITE-CERT.
  8464
  8465     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8466
  8467
  8468
  8469* EXEC CICS HANDLE CONDITION
  8470*         DUPKEY   (2010-DELETE-CL)
  8471*    END-EXEC.
  8472*    MOVE '"$$                   ! + #00008100' TO DFHEIV0
  8473     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8474     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8475     MOVE X'2B20233030303038313030' TO DFHEIV0(25:11)
  8476     CALL 'kxdfhei1' USING DFHEIV0
  8477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8478
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 165
* EL130.cbl
  8479
  8480
  8481
  8482* EXEC CICS REWRITE
  8483*        DATASET  (ELCERT-DSID)
  8484*        FROM     (CERTIFICATE-MASTER)
  8485*    END-EXEC.
  8486     MOVE LENGTH OF
  8487      CERTIFICATE-MASTER
  8488       TO DFHEIV11
  8489*    MOVE '&& L                  %   #00008105' TO DFHEIV0
  8490     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8491     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8492     MOVE X'2020233030303038313035' TO DFHEIV0(25:11)
  8493     CALL 'kxdfhei1' USING DFHEIV0,
  8494           ELCERT-DSID,
  8495           CERTIFICATE-MASTER,
  8496           DFHEIV11,
  8497           DFHEIV99
  8498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8499
  8500
  8501 2010-DELETE-CL.
  8502
  8503
  8504
  8505* EXEC CICS DELETE
  8506*        DATASET  (ELMSTR-DSID)
  8507*    END-EXEC.
  8508*    MOVE '&(                    &   #00008113' TO DFHEIV0
  8509     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8510     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8511     MOVE X'2020233030303038313133' TO DFHEIV0(25:11)
  8512     CALL 'kxdfhei1' USING DFHEIV0,
  8513           ELMSTR-DSID,
  8514           DFHEIV99,
  8515           DFHEIV99,
  8516           DFHEIV99,
  8517           DFHEIV99
  8518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8519
  8520
  8521     MOVE -1                     TO ONE-OR-MIN1.
  8522     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8523
  8524     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8525         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8526                                    WS-SAVE-CLAIM-KEY
  8527         MOVE +1                 TO ONE-OR-MIN1
  8528         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8529     END-IF.
  8530
  8531     MOVE ER-0000                TO EMI-ERROR.
  8532     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8533     MOVE LOW-VALUES             TO EL130AO.
  8534     MOVE -1                     TO MAINTL.
  8535     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8536     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 166
* EL130.cbl
  8537                                    PI-CERT-PROCESSED
  8538                                    PI-LETTER-ERROR-CODE.
  8539     GO TO 8100-SEND-INITIAL-MAP.
  8540
  8541 2050-DELETE-NOT-FOUND.
  8542     IF FILE-SWITCH = 'MSTR'
  8543         MOVE -1                 TO CLMNOL
  8544         MOVE ER-0204            TO EMI-ERROR
  8545     ELSE
  8546         IF FILE-SWITCH = 'TRLR'
  8547             MOVE -1             TO MAINTL
  8548             MOVE ER-0205        TO EMI-ERROR
  8549         ELSE
  8550             MOVE -1             TO CERTNOL
  8551             MOVE ER-0206        TO EMI-ERROR
  8552         END-IF
  8553     END-IF.
  8554
  8555     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8556     GO TO 8200-SEND-DATAONLY.
  8557
  8558 3000-ADD-CLAIM.
  8559     IF NOT MODIFY-CAP
  8560         MOVE ER-0070            TO EMI-ERROR
  8561         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8562         MOVE -1                 TO MAINTL
  8563         GO TO 8200-SEND-DATAONLY
  8564     END-IF.
  8565
  8566     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8567
  8568     IF CERTMTI = 'S'
  8569         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8570            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8571            WS-EFFDT = PI-SAVE-EFFDT       AND
  8572            ACCOUNTI = PI-SAVE-ACCOUNT
  8573             IF EMI-ERROR = 0
  8574                 GO TO 3010-TEST-FOR-ERRORS
  8575             ELSE
  8576                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8577                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8578                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8579                 MOVE PI-STATE         TO  CERT-STATE
  8580                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8581                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8582                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8583
  8584
  8585* EXEC CICS HANDLE CONDITION
  8586*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8587*                END-EXEC
  8588*    MOVE '"$I                   ! , #00008180' TO DFHEIV0
  8589     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8590     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8591     MOVE X'2C20233030303038313830' TO DFHEIV0(25:11)
  8592     CALL 'kxdfhei1' USING DFHEIV0
  8593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8594                 PERFORM 7940-READ-CERT THRU 7940-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 167
* EL130.cbl
  8595                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  8596                 GO TO 3010-TEST-FOR-ERRORS
  8597             END-IF
  8598         END-IF
  8599     END-IF.
  8600
  8601     IF CERTMTI = 'A'
  8602         IF NOT PI-NO-CARRIER-SECURITY OR
  8603             NOT PI-NO-ACCOUNT-SECURITY
  8604             MOVE ER-2370          TO EMI-ERROR
  8605             MOVE -1               TO MAINTL
  8606             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8607             GO TO 8200-SEND-DATAONLY
  8608         ELSE
  8609             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  8610             GO TO 3010-TEST-FOR-ERRORS
  8611         END-IF
  8612     END-IF.
  8613
  8614     IF CERTNOL = ZEROS
  8615        GO TO 3010-TEST-FOR-ERRORS
  8616     END-IF.
  8617
  8618 3000-READ-CERT.
  8619
  8620     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  8621                                    MSTR5-COMP-CD.
  8622     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  8623                                    MSTR5-CERT-NO-PRIME.
  8624     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  8625                                    MSTR5-CERT-NO-SUFX.
  8626
  8627
  8628
  8629* EXEC CICS HANDLE CONDITION
  8630*         DUPKEY   (3008-DUP-ERROR)
  8631*         NOTFND   (3009-NOT-FOUND)
  8632*    END-EXEC
  8633*    MOVE '"$$I                  ! - #00008217' TO DFHEIV0
  8634     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  8635     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8636     MOVE X'2D20233030303038323137' TO DFHEIV0(25:11)
  8637     CALL 'kxdfhei1' USING DFHEIV0
  8638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8639
  8640     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  8641
  8642     IF NOT PI-NO-ACCOUNT-SECURITY
  8643         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  8644             MOVE ER-2371          TO EMI-ERROR
  8645             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8646             MOVE -1               TO MAINTL
  8647             GO TO 8200-SEND-DATAONLY
  8648         END-IF
  8649     END-IF.
  8650
  8651     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  8652     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 168
* EL130.cbl
  8653     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  8654     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  8655     MOVE CM-CARRIER             TO PI-CARRIER.
  8656     MOVE CM-GROUPING            TO PI-GROUPING.
  8657     MOVE CM-STATE               TO PI-STATE.
  8658     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  8659     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  8660     MOVE CM-CERT-NO             TO PI-CERT-NO.
  8661     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  8662
  8663     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  8664         IF LSTNMEO = SPACES OR LOW-VALUES
  8665             MOVE CRTLNMEI       TO  LSTNMEO
  8666             MOVE AL-UANON       TO  LSTNMEA
  8667         END-IF
  8668     END-IF.
  8669
  8670     MOVE 'S'                    TO CERTMTO.
  8671*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  8672     MOVE AL-SANON               TO CERTNOA.
  8673     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  8674                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  8675     IF EMI-NO-ERRORS
  8676         MOVE -1                  TO MAINTL
  8677     END-IF.
  8678
  8679     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8680         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8681         IF INCURRED-DATE-MATCH
  8682             MOVE ER-7352         TO EMI-ERROR
  8683             MOVE -1              TO CERTNOL
  8684             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8685         ELSE
  8686             IF NO-CLAIMS-FOR-CERT
  8687                 MOVE ER-7353     TO EMI-ERROR
  8688                 MOVE -1          TO CERTNOL
  8689                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8690             ELSE
  8691                 MOVE ER-0558     TO EMI-ERROR
  8692                 MOVE -1          TO CERTNOL
  8693                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8694                 GO TO 3010-TEST-FOR-ERRORS
  8695             END-IF
  8696         END-IF
  8697     END-IF.
  8698
  8699 3007-SEND-SCREEN.
  8700     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  8701         GO TO 8150-SEND-MAP-CURSOR
  8702     ELSE
  8703         GO TO 8200-SEND-DATAONLY
  8704     END-IF.
  8705
  8706 3008-DUP-ERROR.
  8707     MOVE ER-0560                TO EMI-ERROR.
  8708     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8709     MOVE -1                     TO CERTNOL.
  8710     GO TO 3007-SEND-SCREEN.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 169
* EL130.cbl
  8711
  8712 3009-NOT-FOUND.
  8713     MOVE ER-0214                TO EMI-ERROR.
  8714     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8715     MOVE -1                     TO CERTNOL.
  8716     GO TO 3007-SEND-SCREEN.
  8717
  8718 3010-TEST-FOR-ERRORS.
  8719
  8720     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  8721     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  8722
  8723     IF CERTMTI NOT = 'A'
  8724         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8725             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  8726             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  8727             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  8728             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8729             IF INCURRED-DATE-MATCH
  8730                 MOVE ER-7352         TO EMI-ERROR
  8731                 MOVE -1              TO CERTNOL
  8732                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8733             ELSE
  8734                 IF NO-CLAIMS-FOR-CERT
  8735                     MOVE ER-7353     TO EMI-ERROR
  8736                     MOVE -1          TO CERTNOL
  8737                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8738                 ELSE
  8739                     MOVE ER-0558     TO EMI-ERROR
  8740                     MOVE -1          TO CERTNOL
  8741                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8742                 END-IF
  8743             END-IF
  8744         END-IF
  8745     END-IF.
  8746
  8747     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  8748         MOVE ER-0433             TO EMI-ERROR
  8749         MOVE -1                  TO MAINTL
  8750         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8751         GO TO 8200-SEND-DATAONLY
  8752     END-IF.
  8753
  8754     IF EMI-NO-ERRORS
  8755         GO TO 3015-TRY-TO-BUILD
  8756     END-IF.
  8757
  8758     IF EIBAID = DFHPF6
  8759         IF EMI-FATAL-CTR NOT EQUAL ZERO
  8760             MOVE ER-0434         TO EMI-ERROR
  8761             MOVE -1              TO MAINTL
  8762             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8763             GO TO 8200-SEND-DATAONLY
  8764         ELSE
  8765             MOVE +1              TO INCURL
  8766             GO TO 3015-TRY-TO-BUILD
  8767         END-IF
  8768     END-IF.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 170
* EL130.cbl
  8769
  8770     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  8771         GO TO 8150-SEND-MAP-CURSOR
  8772     ELSE
  8773         GO TO 8200-SEND-DATAONLY
  8774     END-IF.
  8775
  8776 3015-TRY-TO-BUILD.
  8777     IF CLMNOL EQUAL ZERO
  8778         GO TO 3030-BUILD-CONT
  8779     END-IF.
  8780
  8781
  8782
  8783* EXEC CICS HANDLE CONDITION
  8784*        NOTFND   (3030-BUILD-CONT)
  8785*    END-EXEC.
  8786*    MOVE '"$I                   ! . #00008364' TO DFHEIV0
  8787     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8788     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8789     MOVE X'2E20233030303038333634' TO DFHEIV0(25:11)
  8790     CALL 'kxdfhei1' USING DFHEIV0
  8791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8792
  8793
  8794     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8795
  8796     MOVE CLMCARRI               TO MSTR-CARRIER.
  8797     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8798     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8799     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8800
  8801     MOVE 'MSTR'                 TO FILE-SWITCH.
  8802
  8803     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8804
  8805     MOVE ER-0221                TO EMI-ERROR.
  8806
  8807     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8808     MOVE -1                     TO MAINTL.
  8809     GO TO 8200-SEND-DATAONLY.
  8810
  8811 3030-BUILD-CONT.
  8812     IF CERTMTI NOT = 'A'
  8813         GO TO 3060-BUILD-CONT
  8814     END-IF.
  8815
  8816
  8817
  8818* EXEC CICS HANDLE CONDITION
  8819*        NOTFND   (3033-ACCT-NOT-FOUND)
  8820*        ENDFILE  (3033-ACCT-NOT-FOUND)
  8821*    END-EXEC.
  8822*    MOVE '"$I''                  ! / #00008391' TO DFHEIV0
  8823     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8824     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8825     MOVE X'2F20233030303038333931' TO DFHEIV0(25:11)
  8826     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 171
* EL130.cbl
  8827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8828
  8829
  8830     MOVE SPACES                 TO ERACCT-KEY.
  8831
  8832     IF CARR-GROUP-ST-ACCNT-CNTL
  8833         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  8834         MOVE CRTCARRI           TO ACCT-CARRIER
  8835         MOVE GROUPI             TO ACCT-GROUPING
  8836         MOVE STATEI             TO ACCT-STATE
  8837         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  8838         GO TO 3031-MOVE-ACCT-KEY
  8839     END-IF.
  8840
  8841     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  8842     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  8843
  8844     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  8845         MOVE STATEI             TO ACCT-STATE
  8846     END-IF.
  8847
  8848     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  8849         MOVE CRTCARRI           TO ACCT-CARRIER
  8850     END-IF.
  8851
  8852 3031-MOVE-ACCT-KEY.
  8853     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  8854
  8855
  8856
  8857* EXEC CICS STARTBR
  8858*        DATASET     (ERACCT2-DSID)
  8859*        RIDFLD      (SAVE-ERACCT-KEY)
  8860*        GENERIC
  8861*        KEYLENGTH   (20)
  8862*    END-EXEC.
  8863     MOVE 20
  8864       TO DFHEIV11
  8865     MOVE 0
  8866       TO DFHEIV12
  8867*    MOVE '&,   KG    G          &   #00008422' TO DFHEIV0
  8868     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  8869     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8870     MOVE X'2020233030303038343232' TO DFHEIV0(25:11)
  8871     CALL 'kxdfhei1' USING DFHEIV0,
  8872           ERACCT2-DSID,
  8873           SAVE-ERACCT-KEY,
  8874           DFHEIV11,
  8875           DFHEIV12,
  8876           DFHEIV99
  8877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8878
  8879
  8880
  8881
  8882* EXEC CICS HANDLE CONDITION
  8883*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  8884*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 172
* EL130.cbl
  8885*    MOVE '"$''                   ! 0 #00008430' TO DFHEIV0
  8886     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8887     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8888     MOVE X'3020233030303038343330' TO DFHEIV0(25:11)
  8889     CALL 'kxdfhei1' USING DFHEIV0
  8890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8891
  8892
  8893 3031-READ-ACCT-LOOP.
  8894
  8895
  8896* EXEC CICS READNEXT
  8897*        DATASET   (ERACCT2-DSID)
  8898*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8899*        RIDFLD    (SAVE-ERACCT-KEY)
  8900*    END-EXEC.
  8901     MOVE 0
  8902       TO DFHEIV11
  8903*    MOVE '&.S                   )   #00008436' TO DFHEIV0
  8904     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8905     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8906     MOVE X'2020233030303038343336' TO DFHEIV0(25:11)
  8907     CALL 'kxdfhei1' USING DFHEIV0,
  8908           ERACCT2-DSID,
  8909           DFHEIV20,
  8910           DFHEIV99,
  8911           SAVE-ERACCT-KEY,
  8912           DFHEIV99,
  8913           DFHEIV11,
  8914           DFHEIV99,
  8915           DFHEIV99
  8916     SET ADDRESS OF ACCOUNT-MASTER TO
  8917         DFHEIV20
  8918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8919
  8920
  8921     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  8922        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  8923        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  8924        ACCT-STATE    NOT = AM-VG-STATE       OR
  8925        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  8926         GO TO 3033-ACCT-NOT-FOUND
  8927     END-IF.
  8928
  8929     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  8930        WS-EFFDT LESS AM-EXPIRATION-DT
  8931         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  8932         MOVE AM-CARRIER       TO CERT-CARRIER
  8933         MOVE AM-GROUPING      TO CERT-GROUPING
  8934         MOVE AM-STATE         TO CERT-STATE
  8935         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  8936         MOVE WS-EFFDT         TO CERT-EFF-DT
  8937         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  8938         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  8939         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  8940         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  8941     END-IF.
  8942
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 173
* EL130.cbl
  8943     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  8944         GO TO 3031-READ-ACCT-LOOP
  8945     END-IF.
  8946
  8947 3032-NOT-IN-DT-RANGE.
  8948     MOVE ER-0226                TO EMI-ERROR.
  8949     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8950     MOVE -1                     TO EFFDTL.
  8951     GO TO 8200-SEND-DATAONLY.
  8952
  8953 3033-ACCT-NOT-FOUND.
  8954     MOVE ER-0226 TO EMI-ERROR.
  8955     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8956     MOVE -1                     TO ACCOUNTL.
  8957     GO TO 8200-SEND-DATAONLY.
  8958
  8959 3034-CHECK-EMPLOYER-STATEMENT.
  8960
  8961     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  8962*        NEXT SENTENCE
  8963         CONTINUE
  8964     ELSE
  8965         GO TO  3034-CHECK-ACCOUNT-LIMITS
  8966     END-IF.
  8967
  8968     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  8969     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  8970     MOVE '1'                    TO  DC-OPTION-CODE.
  8971     MOVE +0                     TO  DC-ELAPSED-MONTHS
  8972                                     DC-ELAPSED-DAYS.
  8973     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8974
  8975     IF (AM-EMPLOYER-STMT-USED = '1' AND
  8976         DC-ELAPSED-DAYS LESS THAN +31)
  8977                      OR
  8978        (AM-EMPLOYER-STMT-USED = '2' AND
  8979         DC-ELAPSED-DAYS LESS THAN +61)
  8980                      OR
  8981        (AM-EMPLOYER-STMT-USED = '3' AND
  8982         DC-ELAPSED-DAYS LESS THAN +91)
  8983            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  8984     END-IF.
  8985
  8986 3034-CHECK-ACCOUNT-LIMITS.
  8987
  8988     IF CERTMTI NOT = 'A'
  8989         GO TO 3060-BUILD-CONT
  8990     END-IF.
  8991
  8992     IF AM-STATUS NOT = '0'
  8993         MOVE ER-0225                TO EMI-ERROR
  8994         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8995         MOVE -1                     TO ACCOUNTL
  8996     END-IF.
  8997
  8998     IF EIBAID = DFHPF6
  8999         IF EMI-FATAL-CTR NOT = ZERO
  9000             MOVE ER-0434         TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 174
* EL130.cbl
  9001             MOVE -1              TO MAINTL
  9002             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9003             GO TO 8200-SEND-DATAONLY
  9004         END-IF
  9005     END-IF.
  9006
  9007*    IF PI-COMPANY-ID NOT = 'CRI'
  9008*        GO TO 3035-END-BROWSE
  9009*    END-IF.
  9010
  9011 3035-END-BROWSE.
  9012
  9013
  9014* EXEC CICS ENDBR
  9015*        DATASET    (ERACCT2-DSID)
  9016*    END-EXEC.
  9017     MOVE 0
  9018       TO DFHEIV11
  9019*    MOVE '&2                    $   #00008534' TO DFHEIV0
  9020     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9021     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9022     MOVE X'2020233030303038353334' TO DFHEIV0(25:11)
  9023     CALL 'kxdfhei1' USING DFHEIV0,
  9024           ERACCT2-DSID,
  9025           DFHEIV11,
  9026           DFHEIV99
  9027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9028
  9029
  9030 3040-CHECK-CERT-ALREADY-ON.
  9031
  9032
  9033* EXEC CICS HANDLE CONDITION
  9034*        NOTFND   (3070-BUILD-CONT)
  9035*    END-EXEC.
  9036*    MOVE '"$I                   ! 1 #00008540' TO DFHEIV0
  9037     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9038     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9039     MOVE X'3120233030303038353430' TO DFHEIV0(25:11)
  9040     CALL 'kxdfhei1' USING DFHEIV0
  9041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9042
  9043
  9044     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9045
  9046     MOVE ER-0229                TO EMI-ERROR.
  9047     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9048     MOVE -1                     TO MAINTL.
  9049     GO TO 8200-SEND-DATAONLY.
  9050
  9051 3060-BUILD-CONT.
  9052     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9053     MOVE CRTCARRI               TO CERT-CARRIER.
  9054     MOVE GROUPI                 TO CERT-GROUPING.
  9055     MOVE STATEI                 TO CERT-STATE.
  9056     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9057     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9058     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 175
* EL130.cbl
  9059     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9060
  9061
  9062
  9063* EXEC CICS HANDLE CONDITION
  9064*        NOTFND  (3065-CERT-NOT-FOUND)
  9065*    END-EXEC.
  9066*    MOVE '"$I                   ! 2 #00008562' TO DFHEIV0
  9067     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9068     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9069     MOVE X'3220233030303038353632' TO DFHEIV0(25:11)
  9070     CALL 'kxdfhei1' USING DFHEIV0
  9071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9072
  9073
  9074     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9075
  9076     GO TO 3070-BUILD-CONT.
  9077
  9078 3065-CERT-NOT-FOUND.
  9079     MOVE ER-0244                TO EMI-ERROR.
  9080     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9081     MOVE -1                     TO CERTNOL.
  9082     GO TO 8200-SEND-DATAONLY.
  9083
  9084 3070-BUILD-CONT.
  9085     IF CLMNOL NOT = ZERO
  9086         GO TO 3200-BUILD-ZERO-TRAILER
  9087     END-IF.
  9088
  9089     MOVE SPACES                 TO ELCNTL-KEY.
  9090
  9091     IF CONTROL-IS-ACTUAL-CARRIER
  9092         MOVE PI-CARRIER         TO CNTL-CARRIER
  9093     ELSE
  9094         MOVE PI-CARRIER-CONTROL-LEVEL
  9095                                 TO CNTL-CARRIER
  9096     END-IF.
  9097
  9098     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9099     MOVE '6'                    TO CNTL-REC-TYPE.
  9100     MOVE +0                     TO CNTL-SEQ-NO.
  9101
  9102
  9103
  9104* EXEC CICS HANDLE CONDITION
  9105*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9106*    END-EXEC.
  9107*    MOVE '"$I                   ! 3 #00008595' TO DFHEIV0
  9108     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9109     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9110     MOVE X'3320233030303038353935' TO DFHEIV0(25:11)
  9111     CALL 'kxdfhei1' USING DFHEIV0
  9112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9113
  9114
  9115
  9116
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 176
* EL130.cbl
  9117* EXEC CICS READ
  9118*        UPDATE
  9119*        DATASET   (ELCNTL-DSID)
  9120*        SET       (ADDRESS OF CONTROL-FILE)
  9121*        RIDFLD    (ELCNTL-KEY)
  9122*    END-EXEC.
  9123*    MOVE '&"S        EU         (   #00008600' TO DFHEIV0
  9124     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9125     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9126     MOVE X'2020233030303038363030' TO DFHEIV0(25:11)
  9127     CALL 'kxdfhei1' USING DFHEIV0,
  9128           ELCNTL-DSID,
  9129           DFHEIV20,
  9130           DFHEIV99,
  9131           ELCNTL-KEY,
  9132           DFHEIV99,
  9133           DFHEIV99,
  9134           DFHEIV99
  9135     SET ADDRESS OF CONTROL-FILE TO
  9136         DFHEIV20
  9137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9138
  9139
  9140     IF CLAIM-NO-MANUAL
  9141         GO TO 3120-CLAIM-MUST-BE-INPUT
  9142     END-IF.
  9143
  9144     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9145     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9146
  9147     IF PI-COMPANY-ID = 'CID' OR 'DCC'
  9148         CONTINUE
  9149     ELSE
  9150         GO TO 3080-ASSIGN-LOOP
  9151     END-IF.
  9152
  9153
  9154
  9155* EXEC CICS UNLOCK
  9156*        DATASET   (ELCNTL-DSID)
  9157*    END-EXEC.
  9158*    MOVE '&*                    #   #00008621' TO DFHEIV0
  9159     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9160     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9161     MOVE X'2020233030303038363231' TO DFHEIV0(25:11)
  9162     CALL 'kxdfhei1' USING DFHEIV0,
  9163           ELCNTL-DSID,
  9164           DFHEIV99
  9165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9166
  9167
  9168     MOVE '1'                    TO CNTL-REC-TYPE.
  9169     MOVE SPACES                 TO CNTL-ACCESS.
  9170
  9171     IF PI-COMPANY-ID = 'CID'
  9172         MOVE 'CID'              TO CNTL-COMP-ID
  9173     ELSE
  9174         IF PI-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 177
* EL130.cbl
  9175             MOVE 'DCC'          TO CNTL-COMP-ID
  9176         END-IF
  9177     END-IF.
  9178
  9179
  9180
  9181* EXEC CICS HANDLE CONDITION
  9182*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9183*    END-EXEC.
  9184*    MOVE '"$I                   ! 4 #00008637' TO DFHEIV0
  9185     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9186     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9187     MOVE X'3420233030303038363337' TO DFHEIV0(25:11)
  9188     CALL 'kxdfhei1' USING DFHEIV0
  9189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9190
  9191
  9192     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9193
  9194     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9195
  9196 3080-ASSIGN-LOOP.
  9197     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9198        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9199         MOVE +0                 TO SAVE-COUNTER
  9200     END-IF.
  9201
  9202     ADD +1 TO SAVE-COUNTER.
  9203
  9204     IF SAVE-METHOD  = '3'
  9205         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9206         GO TO 3090-SET-COMP
  9207     END-IF.
  9208
  9209     IF SAVE-METHOD  = '4'
  9210         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9211         MOVE CLMCARRI           TO WS-CN-PRF-A
  9212         GO TO 3090-SET-COMP
  9213     END-IF.
  9214
  9215     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9216     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9217     MOVE SAVE-DATE              TO CURR-DATE.
  9218
  9219     IF CURR-MM LESS '10'
  9220         MOVE CURR-M2             TO WS-CN-PRF-B
  9221     END-IF.
  9222
  9223     IF CURR-MM = '10'
  9224        MOVE 'A'                 TO WS-CN-PRF-B
  9225     END-IF.
  9226     IF CURR-MM = '11'
  9227        MOVE 'B'                 TO WS-CN-PRF-B
  9228     END-IF.
  9229     IF CURR-MM = '12'
  9230        MOVE 'C'                 TO WS-CN-PRF-B
  9231     END-IF.
  9232
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 178
* EL130.cbl
  9233     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9234
  9235 3090-SET-COMP.
  9236
  9237     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9238     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9239                                    CLMNOO.
  9240     MOVE AL-UANON               TO CLMNOA.
  9241     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9242     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9243     MOVE CLMCARRI               TO MSTR-CARRIER.
  9244
  9245
  9246
  9247* EXEC CICS HANDLE CONDITION
  9248*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9249*    END-EXEC.
  9250*    MOVE '"$I                   ! 5 #00008695' TO DFHEIV0
  9251     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9252     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9253     MOVE X'3520233030303038363935' TO DFHEIV0(25:11)
  9254     CALL 'kxdfhei1' USING DFHEIV0
  9255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9256
  9257
  9258     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9259
  9260     GO TO 3080-ASSIGN-LOOP.
  9261
  9262 3100-CARRIER-NOT-FOUND.
  9263     MOVE ER-0252                TO EMI-ERROR.
  9264     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9265     MOVE -1                     TO CLMCARRL.
  9266     GO TO 8200-SEND-DATAONLY.
  9267
  9268 3110-COMPANY-NOT-FOUND.
  9269     MOVE ER-0254                TO EMI-ERROR.
  9270     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9271     MOVE -1                     TO MAINTL.
  9272     GO TO 8200-SEND-DATAONLY.
  9273
  9274 3120-CLAIM-MUST-BE-INPUT.
  9275     MOVE ER-0264                TO EMI-ERROR.
  9276     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9277     MOVE -1                     TO CLMNOL.
  9278     GO TO 8200-SEND-DATAONLY.
  9279
  9280 3200-BUILD-ZERO-TRAILER.
  9281
  9282
  9283* EXEC CICS HANDLE CONDITION
  9284*        NOTFND
  9285*    END-EXEC.
  9286*    MOVE '"$                   ! 6 #00008723' TO DFHEIV0
  9287     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9288     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9289     MOVE X'3620233030303038373233' TO DFHEIV0(25:11)
  9290     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 179
* EL130.cbl
  9291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9292
  9293
  9294
  9295
  9296* EXEC CICS GETMAIN
  9297*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9298*        LENGTH  (ELTRLR-LENGTH)
  9299*    END-EXEC.
  9300*    MOVE '," L                  $   #00008728' TO DFHEIV0
  9301     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9302     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9303     MOVE X'2020233030303038373238' TO DFHEIV0(25:11)
  9304     CALL 'kxdfhei1' USING DFHEIV0,
  9305           DFHEIV20,
  9306           ELTRLR-LENGTH,
  9307           DFHEIV99
  9308     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9309         DFHEIV20
  9310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9311
  9312
  9313     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9314     MOVE 'AT'                   TO AT-RECORD-ID.
  9315
  9316     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9317     MOVE CLMCARRI               TO AT-CARRIER.
  9318     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9319     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9320     MOVE +0                     TO AT-SEQUENCE-NO.
  9321     MOVE '1'                    TO AT-TRAILER-TYPE.
  9322
  9323     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9324     MOVE '5'                    TO DC-OPTION-CODE.
  9325     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9326     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9327                                    AT-RESERVES-LAST-MAINT-DT.
  9328
  9329     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9330                                    AT-RESERVES-LAST-UPDATED-BY.
  9331
  9332     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9333
  9334     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9335
  9336     MOVE +0                     TO AT-FUTURE-RESERVE
  9337                                    AT-IBNR-RESERVE
  9338                                    AT-PAY-CURRENT-RESERVE
  9339                                    AT-INITIAL-MANUAL-RESERVE
  9340                                    AT-CURRENT-MANUAL-RESERVE
  9341                                    AT-ITD-LIFE-REFUNDS
  9342                                    AT-ITD-AH-REFUNDS
  9343                                    AT-ITD-ADDITIONAL-RESERVE.
  9344
  9345     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9346
  9347     IF MANRSVL NOT = ZERO
  9348         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 180
* EL130.cbl
  9349                                    AT-CURRENT-MANUAL-RESERVE
  9350     END-IF.
  9351
  9352     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9353
  9354     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9355                                    AT-ITD-CHARGEABLE-EXPENSE.
  9356
  9357     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9358     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9359     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9360
  9361
  9362
  9363* EXEC CICS WRITE
  9364*        DATASET   (ELTRLR-DSID)
  9365*        FROM      (ACTIVITY-TRAILERS)
  9366*        RIDFLD    (AT-CONTROL-PRIMARY)
  9367*    END-EXEC.
  9368     MOVE LENGTH OF
  9369      ACTIVITY-TRAILERS
  9370       TO DFHEIV11
  9371*    MOVE '&$ L                  ''   #00008782' TO DFHEIV0
  9372     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9373     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9374     MOVE X'2020233030303038373832' TO DFHEIV0(25:11)
  9375     CALL 'kxdfhei1' USING DFHEIV0,
  9376           ELTRLR-DSID,
  9377           ACTIVITY-TRAILERS,
  9378           DFHEIV11,
  9379           AT-CONTROL-PRIMARY,
  9380           DFHEIV99,
  9381           DFHEIV99
  9382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9383
  9384
  9385     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9386
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 181
* EL130.cbl
  9388
  9389 3250-BUILD-I1-ADDRESS-TRAILER.
  9390
  9391     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9392     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9393     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9394     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9395     MOVE GROUPI                 TO WS-MA-GROUPING.
  9396     MOVE STATEI                 TO WS-MA-STATE.
  9397     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9398     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9399     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9400     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9401
  9402
  9403* EXEC CICS HANDLE CONDITION
  9404*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9405*    END-EXEC.
  9406*    MOVE '"$I                   ! 7 #00008805' TO DFHEIV0
  9407     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9408     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9409     MOVE X'3720233030303038383035' TO DFHEIV0(25:11)
  9410     CALL 'kxdfhei1' USING DFHEIV0
  9411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9412
  9413
  9414
  9415* EXEC CICS READ
  9416*        EQUAL
  9417*        DATASET   (ERMAIL-DSID)
  9418*        SET       (ADDRESS OF MAILING-DATA)
  9419*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9420*    END-EXEC.
  9421*    MOVE '&"S        E          (   #00008809' TO DFHEIV0
  9422     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9423     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9424     MOVE X'2020233030303038383039' TO DFHEIV0(25:11)
  9425     CALL 'kxdfhei1' USING DFHEIV0,
  9426           ERMAIL-DSID,
  9427           DFHEIV20,
  9428           DFHEIV99,
  9429           WS-MA-CONTROL-PRIMARY,
  9430           DFHEIV99,
  9431           DFHEIV99,
  9432           DFHEIV99
  9433     SET ADDRESS OF MAILING-DATA TO
  9434         DFHEIV20
  9435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9436
  9437
  9438     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9439         GO TO 3290-NO-INSURED-ADDRESS
  9440     END-IF.
  9441
  9442     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9443     MOVE 'AT'                   TO AT-RECORD-ID.
  9444
  9445     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 182
* EL130.cbl
  9446     MOVE CLMCARRI               TO AT-CARRIER.
  9447     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9448     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9449     MOVE +1                     TO AT-SEQUENCE-NO.
  9450     MOVE '5'                    TO AT-TRAILER-TYPE.
  9451
  9452     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9453     IF MA-INSURED-MIDDLE-INIT > SPACES
  9454        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9455               ' ' DELIMITED BY SIZE
  9456               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9457               ' ' DELIMITED BY SIZE
  9458               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9459        INTO AT-MAIL-TO-NAME
  9460     ELSE
  9461        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9462               ' ' DELIMITED BY SIZE
  9463               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9464        INTO AT-MAIL-TO-NAME
  9465     END-IF.
  9466     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9467     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9468*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9469     MOVE MA-CITY                TO AT-CITY
  9470     MOVE MA-ADDR-STATE          TO AT-STATE
  9471     MOVE MA-ZIP                 TO AT-ZIP
  9472     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9473
  9474     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9475                                    AT-ADDRESS-LAST-MAINT-DT.
  9476
  9477     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9478                                    AT-ADDRESS-LAST-UPDATED-BY.
  9479
  9480     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9481
  9482
  9483* EXEC CICS WRITE
  9484*        DATASET   (ELTRLR-DSID)
  9485*        FROM      (ACTIVITY-TRAILERS)
  9486*        RIDFLD    (AT-CONTROL-PRIMARY)
  9487*    END-EXEC.
  9488     MOVE LENGTH OF
  9489      ACTIVITY-TRAILERS
  9490       TO DFHEIV11
  9491*    MOVE '&$ L                  ''   #00008860' TO DFHEIV0
  9492     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9493     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9494     MOVE X'2020233030303038383630' TO DFHEIV0(25:11)
  9495     CALL 'kxdfhei1' USING DFHEIV0,
  9496           ELTRLR-DSID,
  9497           ACTIVITY-TRAILERS,
  9498           DFHEIV11,
  9499           AT-CONTROL-PRIMARY,
  9500           DFHEIV99,
  9501           DFHEIV99
  9502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9503
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 183
* EL130.cbl
  9504
  9505     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9506     GO TO 3300-BUILD-NINETY-TRAILER.
  9507
  9508 3290-NO-INSURED-ADDRESS.
  9509      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
  9510
  9511 3300-BUILD-NINETY-TRAILER.
  9512
  9513     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9514     MOVE 'AT'                   TO AT-RECORD-ID.
  9515
  9516     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9517     MOVE CLMCARRI               TO AT-CARRIER.
  9518
  9519     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9520     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9521     MOVE +90                    TO AT-SEQUENCE-NO.
  9522     MOVE '6'                    TO AT-TRAILER-TYPE.
  9523
  9524     IF DIAGL NOT = ZERO
  9525         MOVE DIAGI              TO AT-INFO-LINE-1
  9526     END-IF.
  9527
  9528     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9529                                    AT-GEN-INFO-LAST-MAINT-DT.
  9530
  9531     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9532                                    AT-GEN-INFO-LAST-UPDATED-BY.
  9533     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9534
  9535
  9536
  9537* EXEC CICS WRITE
  9538*        DATASET   (ELTRLR-DSID)
  9539*        FROM      (ACTIVITY-TRAILERS)
  9540*        RIDFLD    (AT-CONTROL-PRIMARY)
  9541*    END-EXEC.
  9542     MOVE LENGTH OF
  9543      ACTIVITY-TRAILERS
  9544       TO DFHEIV11
  9545*    MOVE '&$ L                  ''   #00008897' TO DFHEIV0
  9546     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9547     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9548     MOVE X'2020233030303038383937' TO DFHEIV0(25:11)
  9549     CALL 'kxdfhei1' USING DFHEIV0,
  9550           ELTRLR-DSID,
  9551           ACTIVITY-TRAILERS,
  9552           DFHEIV11,
  9553           AT-CONTROL-PRIMARY,
  9554           DFHEIV99,
  9555           DFHEIV99
  9556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9557
  9558
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 184
* EL130.cbl
  9560 3400-CHECK-CERT-MAINT.
  9561
  9562     IF CERTMTI = 'A'
  9563         GO TO 3600-BUILD-NEW-CERT
  9564     END-IF.
  9565
  9566     IF NO-CLAIM-ATTACHED
  9567         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
  9568     END-IF.
  9569
  9570     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
  9571
  9572     IF CM-LF-CURRENT-STATUS = '2' OR
  9573        CM-AH-CURRENT-STATUS = '2'
  9574         GO TO 3400-REWRITE-CERT
  9575     END-IF.
  9576
  9577     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9578
  9579 3400-REWRITE-CERT.
  9580
  9581
  9582
  9583* EXEC CICS HANDLE CONDITION
  9584*        DUPKEY (3410-DUP-KEY)
  9585*    END-EXEC.
  9586*    MOVE '"$$                   ! 8 #00008926' TO DFHEIV0
  9587     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9589     MOVE X'3820233030303038393236' TO DFHEIV0(25:11)
  9590     CALL 'kxdfhei1' USING DFHEIV0
  9591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9592
  9593
  9594
  9595
  9596* EXEC CICS REWRITE
  9597*        DATASET   (ELCERT-DSID)
  9598*        FROM      (CERTIFICATE-MASTER)
  9599*    END-EXEC.
  9600     MOVE LENGTH OF
  9601      CERTIFICATE-MASTER
  9602       TO DFHEIV11
  9603*    MOVE '&& L                  %   #00008931' TO DFHEIV0
  9604     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9605     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9606     MOVE X'2020233030303038393331' TO DFHEIV0(25:11)
  9607     CALL 'kxdfhei1' USING DFHEIV0,
  9608           ELCERT-DSID,
  9609           CERTIFICATE-MASTER,
  9610           DFHEIV11,
  9611           DFHEIV99
  9612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9613
  9614
  9615 3410-DUP-KEY.
  9616     GO TO 3800-BUILD-NEW-CLAIM.
  9617
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 185
* EL130.cbl
  9618 3600-BUILD-NEW-CERT.
  9619
  9620
  9621* EXEC CICS GETMAIN
  9622*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  9623*        LENGTH   (ELCERT-LENGTH)
  9624*    END-EXEC.
  9625*    MOVE '," L                  $   #00008941' TO DFHEIV0
  9626     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9627     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9628     MOVE X'2020233030303038393431' TO DFHEIV0(25:11)
  9629     CALL 'kxdfhei1' USING DFHEIV0,
  9630           DFHEIV20,
  9631           ELCERT-LENGTH,
  9632           DFHEIV99
  9633     SET ADDRESS OF CERTIFICATE-MASTER TO
  9634         DFHEIV20
  9635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9636
  9637
  9638     MOVE SPACES                 TO CERTIFICATE-MASTER.
  9639
  9640     MOVE 'CM'                   TO CM-RECORD-ID.
  9641
  9642     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
  9643                                    CM-COMPANY-CD-A1
  9644                                    CM-COMPANY-CD-A2
  9645                                    CM-COMPANY-CD-A4
  9646                                    CM-COMPANY-CD-A5.
  9647
  9648     MOVE CERT-CARRIER           TO CM-CARRIER.
  9649     MOVE CERT-GROUPING          TO CM-GROUPING.
  9650     MOVE CERT-STATE             TO CM-STATE.
  9651     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
  9652     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
  9653     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
  9654
  9655     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
  9656                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
  9657                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
  9658                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
  9659                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
  9660                       CM-LIVES              CM-LOAN-TERM
  9661                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
  9662                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
  9663                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
  9664                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
  9665                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
  9666                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
  9667                       CM-LF-ALT-PREMIUM-RATE
  9668                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
  9669                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
  9670                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
  9671                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
  9672                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
  9673
  9674     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
  9675                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 186
* EL130.cbl
  9676                                    CM-AH-SETTLEMENT-DT
  9677                                    CM-AH-CANCEL-EXIT-DT
  9678                                    CM-AH-SETTLEMENT-EXIT-DT
  9679                                    CM-LF-LOAN-EXPIRE-DT
  9680                                    CM-LF-CANCEL-DT
  9681                                    CM-LF-DEATH-DT
  9682                                    CM-LF-CANCEL-EXIT-DT
  9683                                    CM-LF-DEATH-EXIT-DT
  9684                                    CM-LAST-ADD-ON-DT
  9685                                    CM-ENTRY-DT.
  9686
  9687     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
  9688     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
  9689     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
  9690
  9691     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
  9692                                    CM-PART-LAST-NAME-A2
  9693                                    CM-PART-LAST-NAME-A5.
  9694
  9695     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
  9696                                    CM-INSURED-INITIAL1-A2
  9697                                    CM-INSURED-INITIAL1-A5
  9698                                    CM-INSURED-FIRST-NAME.
  9699
  9700     IF CRTINITL GREATER ZERO
  9701         MOVE CRTINITI           TO CM-INSURED-INITIAL2
  9702                                    CM-INSURED-INITIAL2-A2
  9703                                    CM-INSURED-INITIAL2-A5
  9704     ELSE
  9705         MOVE SPACES             TO CM-INSURED-INITIAL2
  9706                                    CM-INSURED-INITIAL2-A2
  9707                                    CM-INSURED-INITIAL2-A5
  9708     END-IF.
  9709
  9710     IF CM-INSURED-INITIALS = SPACES
  9711         MOVE '**'               TO CM-INSURED-INITIALS
  9712     END-IF.
  9713
  9714     IF MEMBERL GREATER ZERO
  9715         MOVE MEMBERI              TO CM-MEMBER-NO
  9716     ELSE
  9717         MOVE CERT-STATE           TO CM-MEMB-STATE
  9718         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
  9719         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
  9720         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
  9721     END-IF.
  9722
  9723     IF JNTLNMEL GREATER ZERO
  9724         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
  9725     END-IF.
  9726
  9727     IF JNTFNMEL GREATER ZERO
  9728         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
  9729     END-IF.
  9730
  9731     IF JNTINITL GREATER ZERO
  9732         MOVE JNTINITI           TO CM-JT-INITIAL
  9733     END-IF.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 187
* EL130.cbl
  9734
  9735     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9736
  9737
  9738
  9739* EXEC CICS HANDLE CONDITION
  9740*        DUPKEY   (3690-CERT-WRITTEN)
  9741*    END-EXEC.
  9742*    MOVE '"$$                   ! 9 #00009046' TO DFHEIV0
  9743     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9744     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9745     MOVE X'3920233030303039303436' TO DFHEIV0(25:11)
  9746     CALL 'kxdfhei1' USING DFHEIV0
  9747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9748
  9749
  9750
  9751
  9752* EXEC CICS WRITE
  9753*        DATASET   (ELCERT-DSID)
  9754*        FROM      (CERTIFICATE-MASTER)
  9755*        RIDFLD    (CM-CONTROL-PRIMARY)
  9756*    END-EXEC.
  9757     MOVE LENGTH OF
  9758      CERTIFICATE-MASTER
  9759       TO DFHEIV11
  9760*    MOVE '&$ L                  ''   #00009051' TO DFHEIV0
  9761     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9762     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9763     MOVE X'2020233030303039303531' TO DFHEIV0(25:11)
  9764     CALL 'kxdfhei1' USING DFHEIV0,
  9765           ELCERT-DSID,
  9766           CERTIFICATE-MASTER,
  9767           DFHEIV11,
  9768           CM-CONTROL-PRIMARY,
  9769           DFHEIV99,
  9770           DFHEIV99
  9771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9772
  9773
  9774 3690-CERT-WRITTEN.
  9775
  9776     GO TO 3800-BUILD-NEW-CLAIM.
  9777
  9778 3690-EXIT.
  9779      EXIT.
  9780
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 188
* EL130.cbl
  9782 3700-BUILD-CERT.
  9783
  9784     IF CERTMTI NOT = 'A'
  9785         GO TO 3700-FINISH-CERT-BUILD
  9786     END-IF.
  9787
  9788     IF CERTMTI = 'A'
  9789         IF LCVCDL = ZEROS
  9790             MOVE ZEROS          TO CM-LF-BENEFIT-CD
  9791                                    CM-LF-ORIG-TERM
  9792                                    CM-LF-BENEFIT-AMT
  9793                                    CM-LF-PREMIUM-RATE
  9794             GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9795         END-IF
  9796     END-IF.
  9797
  9798     IF LCVCDL GREATER ZERO
  9799         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
  9800     END-IF.
  9801
  9802     IF LCVOTRML GREATER ZERO
  9803         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
  9804     END-IF.
  9805
  9806     IF LCVBENEL GREATER ZERO
  9807         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
  9808     END-IF.
  9809
  9810     IF LCVRATEL GREATER ZERO
  9811         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
  9812     END-IF.
  9813
  9814     IF WS-EXPIRE NOT = LOW-VALUES
  9815         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
  9816     END-IF.
  9817
  9818     IF LCVFORML GREATER ZERO
  9819         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
  9820     END-IF.
  9821
  9822     IF LCVCNDTL = ZERO
  9823        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9824     END-IF.
  9825
  9826     IF WS-LCVCNDT NOT = LOW-VALUES
  9827        MOVE '8'                 TO CM-LF-CURRENT-STATUS
  9828        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
  9829        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9830     END-IF.
  9831
  9832     IF CM-LF-CURRENT-STATUS = '7'
  9833        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
  9834        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
  9835        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
  9836                                    CM-LF-DEATH-DT
  9837        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9838     END-IF.
  9839
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 189
* EL130.cbl
  9840     IF CM-LF-CURRENT-STATUS = '8'
  9841        MOVE '1'                 TO CM-LF-CURRENT-STATUS
  9842        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
  9843     END-IF.
  9844
  9845 3700-BUILD-AH-COVERAGE-SIDE.
  9846
  9847     IF CERTMTI = 'A'
  9848         IF ACVCDL = ZEROS
  9849             MOVE ZEROS          TO CM-AH-BENEFIT-CD
  9850                                    CM-AH-ORIG-TERM
  9851                                    CM-AH-BENEFIT-AMT
  9852                                    CM-AH-PREMIUM-RATE
  9853             GO TO 3700-COVERAGE-BUILT
  9854         END-IF
  9855     END-IF.
  9856
  9857     IF ACVCDL GREATER ZERO
  9858         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
  9859     END-IF.
  9860
  9861     IF ACVOTRML GREATER ZERO
  9862         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
  9863     END-IF.
  9864
  9865     IF ACVBENEL GREATER ZERO
  9866         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
  9867     END-IF.
  9868
  9869     IF ACVRATEL GREATER ZERO
  9870         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
  9871     END-IF.
  9872
  9873     IF WS-EXPIRE NOT = LOW-VALUES
  9874         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
  9875     END-IF.
  9876
  9877     IF ACVFORML GREATER ZERO
  9878         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
  9879     END-IF.
  9880
  9881     IF ACVCNDTL = ZERO
  9882        GO TO 3700-COVERAGE-BUILT
  9883     END-IF.
  9884
  9885     IF WS-ACVCNDT NOT = LOW-VALUES
  9886        MOVE '8'                 TO CM-AH-CURRENT-STATUS
  9887        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
  9888        GO TO 3700-COVERAGE-BUILT
  9889     END-IF.
  9890
  9891     IF CM-AH-CURRENT-STATUS = '6'
  9892        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
  9893        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
  9894        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
  9895        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
  9896        GO TO 3700-COVERAGE-BUILT
  9897     END-IF.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 190
* EL130.cbl
  9898
  9899     IF CM-AH-CURRENT-STATUS = '8'
  9900        MOVE '1'                 TO CM-AH-CURRENT-STATUS
  9901        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
  9902     END-IF.
  9903
  9904 3700-COVERAGE-BUILT.
  9905     IF ISSAGEL GREATER ZERO
  9906         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
  9907     END-IF.
  9908
  9909     IF JNTAGEL GREATER ZERO
  9910         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
  9911     END-IF.
  9912
  9913     IF SEXL GREATER ZERO
  9914         MOVE SEXI               TO CM-INSURED-SEX
  9915     END-IF.
  9916
  9917     IF APRL GREATER ZERO
  9918         MOVE WS-APR             TO CM-LOAN-APR
  9919     END-IF.
  9920
  9921     IF PMTFREQL GREATER ZERO
  9922         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
  9923     END-IF.
  9924
  9925     IF INDGRPL GREATER ZERO
  9926         MOVE INDGRPI            TO CM-IND-GRP-TYPE
  9927     END-IF.
  9928
  9929     IF CERTMTI = 'A'
  9930         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
  9931     END-IF.
  9932
  9933     IF REINCDL GREATER ZERO
  9934         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
  9935                                    WS-REIN-1
  9936                                    WS-REIN-2
  9937                                    WS-REIN-3
  9938         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
  9939     END-IF.
  9940
  9941     IF WS-ADD-ON-DT NOT = LOW-VALUES
  9942         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
  9943     END-IF.
  9944
  9945     IF CRTSSNL GREATER ZERO
  9946         MOVE CRTSSNI            TO CM-SOC-SEC-NO
  9947     ELSE
  9948         IF SSNL GREATER ZERO
  9949             MOVE SSNI           TO CM-SOC-SEC-NO
  9950         END-IF
  9951     END-IF.
  9952
  9953     IF CRTSSNL = ZERO AND
  9954        SSNL    = ZERO
  9955         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 191
* EL130.cbl
  9956         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
  9957         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
  9958         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
  9959     END-IF.
  9960
  9961     IF CM-LF-CURRENT-STATUS = SPACES
  9962         MOVE '1'                TO CM-LF-CURRENT-STATUS
  9963     END-IF.
  9964
  9965     IF CM-AH-CURRENT-STATUS = SPACES
  9966         MOVE '1'                TO CM-AH-CURRENT-STATUS
  9967     END-IF.
  9968
  9969     IF CERTMTI = 'A'
  9970         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
  9971     END-IF.
  9972
  9973 3700-FINISH-CERT-BUILD.
  9974
  9975     IF LOANNOL GREATER ZERO
  9976         MOVE LOANNOI            TO CM-LOAN-NUMBER
  9977     END-IF.
  9978
  9979     IF LOANBALL GREATER ZERO
  9980         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
  9981     END-IF.
  9982
  9983     IF PREMTYPL GREATER ZERO
  9984         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
  9985     END-IF.
  9986
  9987 3700-EXIT.
  9988      EXIT.
  9989
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 192
* EL130.cbl
  9991 3800-BUILD-NEW-CLAIM.
  9992
  9993*************************************************************
  9994*****           START OF ACTIVITY FILE PROCESSING          **
  9995*************************************************************
  9996     IF PI-COMPANY-ID EQUAL 'CID'
  9997         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
  9998                 6700-EXIT
  9999     END-IF.
 10000*************************************************************
 10001*****            END OF ACTIVITY FILE PROCESSING           **
 10002*************************************************************
 10003
 10004
 10005
 10006
 10007* EXEC CICS GETMAIN
 10008*        SET     (ADDRESS OF CLAIM-MASTER)
 10009*        LENGTH  (ELMSTR-LENGTH)
 10010*    END-EXEC.
 10011*    MOVE '," L                  $   #00009289' TO DFHEIV0
 10012     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10013     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10014     MOVE X'2020233030303039323839' TO DFHEIV0(25:11)
 10015     CALL 'kxdfhei1' USING DFHEIV0,
 10016           DFHEIV20,
 10017           ELMSTR-LENGTH,
 10018           DFHEIV99
 10019     SET ADDRESS OF CLAIM-MASTER TO
 10020         DFHEIV20
 10021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10022
 10023
 10024     MOVE SPACES TO CLAIM-MASTER.
 10025
 10026     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10027         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10028         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10029         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10030         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10031         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10032         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10033         CL-ACTIVITY-MAINT-DT.
 10034
 10035     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10036             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10037             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10038             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10039             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10040             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10041             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10042             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10043             CL-FORCEABLE-ERROR-CNT.
 10044
 10045     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10046
 10047     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10048                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 193
* EL130.cbl
 10049                                    CL-LAG-REPORT-CODE.
 10050
 10051     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10052     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10053
 10054     IF BENECDL NOT = ZEROS
 10055        MOVE BENECDI             TO CL-BENEFICIARY
 10056     END-IF.
 10057
 10058     MOVE 'CL'                   TO CL-RECORD-ID.
 10059     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10060
 10061     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10062                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10063                             CL-COMPANY-CD-A5.
 10064
 10065     MOVE CLMCARRI               TO CL-CARRIER.
 10066
 10067     IF CLMNOL = ZERO
 10068         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10069     ELSE
 10070         MOVE CLMNOI             TO CL-CLAIM-NO
 10071     END-IF.
 10072
 10073     MOVE CERTNOI                TO CL-CERT-PRIME
 10074                                    CL-CERT-A4-PRIME.
 10075
 10076     MOVE SUFXI                  TO CL-CERT-SFX
 10077                                    CL-CERT-A4-SFX.
 10078
 10079     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10080
 10081     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10082
 10083     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10084
 10085     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10086
 10087     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10088     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10089
 10090     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10091
 10092     IF CERTMTI = 'A'
 10093         MOVE '2'                TO CL-CERT-ORIGIN
 10094     ELSE
 10095         MOVE '1'                TO CL-CERT-ORIGIN
 10096     END-IF.
 10097
 10098     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10099     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10100     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10101     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10102     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10103
 10104 3820-REWRITE-CONTROL-FILE.
 10105
 10106     IF CLMNOL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 194
* EL130.cbl
 10107         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10108     END-IF.
 10109
 10110     IF CF-RECORD-TYPE = '6'
 10111         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10112     ELSE
 10113         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10114     END-IF.
 10115
 10116
 10117
 10118* EXEC CICS REWRITE
 10119*        DATASET   (ELCNTL-DSID)
 10120*        FROM      (CONTROL-FILE)
 10121*    END-EXEC.
 10122     MOVE LENGTH OF
 10123      CONTROL-FILE
 10124       TO DFHEIV11
 10125*    MOVE '&& L                  %   #00009387' TO DFHEIV0
 10126     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10127     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10128     MOVE X'2020233030303039333837' TO DFHEIV0(25:11)
 10129     CALL 'kxdfhei1' USING DFHEIV0,
 10130           ELCNTL-DSID,
 10131           CONTROL-FILE,
 10132           DFHEIV11,
 10133           DFHEIV99
 10134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10135
 10136
 10137 3830-SEQUENCE-CLAIM-RECORDS.
 10138
 10139     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10140     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10141     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10142
 10143     IF WS-ASSOC-CERT-TOTAL = ZERO
 10144         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10145                                    CL-ASSOC-CERT-TOTAL
 10146         GO TO 3840-WRITE-CLAIM-MASTER
 10147     END-IF.
 10148
 10149     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10150         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10151     ELSE
 10152         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10153     END-IF.
 10154
 10155     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10156     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10157     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10158
 10159 3840-WRITE-CLAIM-MASTER.
 10160
 10161     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
 10162     IF WS-REC-FOUND-SW = 'Y'
 10163         MOVE 01                 TO  CL-ACTIVITY-CODE
 10164         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 195
* EL130.cbl
 10165         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10166     END-IF.
 10167
 10168
 10169
 10170* EXEC CICS HANDLE CONDITION
 10171*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10172*    END-EXEC.
 10173*    MOVE '"$$                   ! : #00009424' TO DFHEIV0
 10174     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10175     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10176     MOVE X'3A20233030303039343234' TO DFHEIV0(25:11)
 10177     CALL 'kxdfhei1' USING DFHEIV0
 10178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10179
 10180
 10181** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10182     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10183
 10184
 10185
 10186* EXEC CICS WRITE
 10187*        DATASET   (ELMSTR-DSID)
 10188*        FROM      (CLAIM-MASTER)
 10189*        RIDFLD    (CL-CONTROL-PRIMARY)
 10190*    END-EXEC.
 10191     MOVE LENGTH OF
 10192      CLAIM-MASTER
 10193       TO DFHEIV11
 10194*    MOVE '&$ L                  ''   #00009432' TO DFHEIV0
 10195     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10196     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10197     MOVE X'2020233030303039343332' TO DFHEIV0(25:11)
 10198     CALL 'kxdfhei1' USING DFHEIV0,
 10199           ELMSTR-DSID,
 10200           CLAIM-MASTER,
 10201           DFHEIV11,
 10202           CL-CONTROL-PRIMARY,
 10203           DFHEIV99,
 10204           DFHEIV99
 10205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10206
 10207
 10208 3850-CLAIM-MSTR-WRITTEN.
 10209
 10210     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10211         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10212     END-IF.
 10213
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 196
* EL130.cbl
 10215 3990-ADD-DONE.
 10216     MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10217                                   EMI-SUB      EMI-SWITCH-AREA-2.
 10218     MOVE SPACES                TO EMI-ACTION-SWITCH
 10219                                   EMI-ERROR-LINES.
 10220
 10221     IF CLMNOL = ZERO
 10222         MOVE ER-0265            TO EMI-ERROR
 10223         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10224         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (1)
 10225                                    PI-LAST-CLAIM
 10226     ELSE
 10227         MOVE CLMNOI             TO PI-LAST-CLAIM
 10228         MOVE ER-0000            TO EMI-ERROR
 10229         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10230     END-IF.
 10231
 10232     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10233       AND PI-ST-VFY-2ND-BENE = 'Y'
 10234         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10235         MOVE ER-7575            TO EMI-ERROR
 10236         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10237     END-IF.
 10238
 10239     IF WS-NO-INSURED-ADDRESS = 'Y'
 10240         MOVE ER-3548            TO EMI-ERROR
 10241         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10242     END-IF.
 10243
 10244     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10245     MOVE CLMCARRI                   TO  PI-CARRIER.
 10246     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10247     MOVE SUFXI                      TO  PI-CERT-SFX.
 10248
 10249     IF WS-LETTER-SW = 'Y'
 10250         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
 10251         IF W-1523-ERROR-CODE NOT = ZEROS
 10252             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10253             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10254         END-IF
 10255     END-IF.
 10256
 10257     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10258     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10259     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10260     MOVE CLMCARRI               TO PI-LAST-CARR.
 10261
 10262     IF PRTOPTL GREATER THAN 0
 10263         MOVE PRTOPTI            TO PI-PRT-OPT
 10264     END-IF.
 10265     IF ALTPRTL GREATER THAN 0
 10266         MOVE ALTPRTI            TO PI-ALT-PRT
 10267     END-IF.
 10268
 10269     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10270         MOVE LOW-VALUES         TO EL130AI
 10271         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10272         MOVE AL-SANON           TO CERTNOA
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 197
* EL130.cbl
 10273         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10274         MOVE AL-SANON           TO SUFXA
 10275         MOVE PI-LAST-CARR       TO CLMCARRO
 10276         MOVE AL-UANON           TO CLMCARRA
 10277         MOVE PI-LAST-CLAIM      TO CLMNOO
 10278         MOVE AL-UANON           TO CLMNOA
 10279         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10280         MOVE AL-UANON           TO CLMTYPEA
 10281     ELSE
 10282         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10283         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10284     END-IF.
 10285
 10286     IF PI-PRT-OPT = 'N' OR 'L'
 10287         MOVE PI-PRT-OPT         TO PRTOPTO
 10288         MOVE 1                  TO PRTOPTL
 10289     END-IF.
 10290
 10291     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10292         MOVE PI-ALT-PRT         TO ALTPRTO
 10293         MOVE 4                  TO ALTPRTL
 10294     END-IF.
 10295
 10296     IF PRTOPTL GREATER THAN 0
 10297         IF PRTOPTI = 'L'
 10298             GO TO 0400-CREATE-ELACTQ
 10299         ELSE
 10300             GO TO 0480-PRINT-NOW
 10301         END-IF
 10302     END-IF.
 10303
 10304     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10305         GO TO 8100-SEND-INITIAL-MAP
 10306     ELSE
 10307         MOVE LOW-VALUES         TO MAINTO
 10308         MOVE -1                 TO MAINTL
 10309         GO TO 8200-SEND-DATAONLY
 10310     END-IF.
 10311
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 198
* EL130.cbl
 10313 3993-MODIFY-SCREEN-ATTRB.
 10314
 10315     IF CERTMTL GREATER ZERO
 10316         MOVE AL-UANON           TO CERTMTA
 10317     END-IF.
 10318
 10319     IF EFFDTL GREATER ZERO
 10320         MOVE AL-UANON           TO EFFDTA
 10321     END-IF.
 10322
 10323     IF ACCOUNTL GREATER ZERO
 10324         MOVE AL-UANON           TO ACCOUNTA
 10325     END-IF.
 10326
 10327     IF STATEL GREATER ZERO
 10328         MOVE AL-UANON           TO STATEA
 10329     END-IF.
 10330
 10331     IF CRTCARRL GREATER ZERO
 10332         MOVE AL-UANON           TO CRTCARRA
 10333     END-IF.
 10334
 10335     IF GROUPL GREATER ZERO
 10336         MOVE AL-UANON           TO GROUPA
 10337     END-IF.
 10338
 10339     IF CRTLNMEL GREATER ZERO
 10340         MOVE AL-UANON           TO CRTLNMEA
 10341     END-IF.
 10342
 10343     IF CRTFNMEL GREATER ZERO
 10344         MOVE AL-UANON           TO CRTFNMEA
 10345     END-IF.
 10346
 10347     IF CRTINITL GREATER ZERO
 10348         MOVE AL-UANON           TO CRTINITA
 10349     END-IF.
 10350
 10351     IF ISSAGEL GREATER ZERO
 10352         MOVE AL-UNNON           TO ISSAGEA
 10353     END-IF.
 10354
 10355     IF JNTLNMEL GREATER ZERO
 10356         MOVE AL-UANON           TO JNTLNMEA
 10357     END-IF.
 10358
 10359     IF JNTFNMEL GREATER ZERO
 10360         MOVE AL-UANON           TO JNTFNMEA
 10361     END-IF.
 10362
 10363     IF JNTINITL GREATER ZERO
 10364         MOVE AL-UANON           TO JNTINITA
 10365     END-IF.
 10366
 10367     IF JNTAGEL GREATER ZERO
 10368         MOVE AL-UNNON           TO JNTAGEA
 10369     END-IF.
 10370
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 199
* EL130.cbl
 10371     IF CRTSSNL GREATER ZERO
 10372         MOVE AL-UANON           TO CRTSSNA
 10373     END-IF.
 10374
 10375     IF ACVDSCRL GREATER ZERO
 10376         MOVE AL-SANON           TO ACVDSCRA
 10377     END-IF.
 10378
 10379     IF ACVKINDL GREATER ZERO
 10380         MOVE AL-SANON           TO ACVKINDA
 10381     END-IF.
 10382
 10383     IF ACVCDL GREATER ZERO
 10384         MOVE AL-UANON           TO ACVCDA
 10385     END-IF.
 10386
 10387     IF ACVOTRML GREATER ZERO
 10388         MOVE AL-UNNON           TO ACVOTRMA
 10389     END-IF.
 10390
 10391     IF ACVRTRML GREATER ZERO
 10392         MOVE AL-UNNON           TO ACVRTRMA
 10393     END-IF.
 10394
 10395     IF ACVRATEL GREATER ZERO
 10396         MOVE AL-UNNON           TO ACVRATEA
 10397     END-IF.
 10398
 10399     IF ACVBENEL GREATER ZERO
 10400         MOVE AL-UNNON           TO ACVBENEA
 10401     END-IF.
 10402
 10403     IF ACVFORML GREATER ZERO
 10404         MOVE AL-UANON           TO ACVFORMA
 10405     END-IF.
 10406
 10407     IF ACVCNDTL GREATER ZERO
 10408         MOVE AL-UANON           TO ACVCNDTA
 10409     END-IF.
 10410
 10411     IF ACVEXITL GREATER ZERO
 10412         MOVE AL-UANON           TO ACVEXITA
 10413     END-IF.
 10414
 10415     IF ACVSTATL GREATER ZERO
 10416         MOVE AL-UANON           TO ACVSTATA
 10417     END-IF.
 10418
 10419     IF LCVDSCRL GREATER ZERO
 10420         MOVE AL-SANON           TO LCVDSCRA
 10421     END-IF.
 10422
 10423     IF LCVKINDL GREATER ZERO
 10424         MOVE AL-SANON           TO LCVKINDA
 10425     END-IF.
 10426
 10427     IF LCVCDL GREATER ZERO
 10428         MOVE AL-UANON           TO LCVCDA
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 200
* EL130.cbl
 10429     END-IF.
 10430
 10431     IF LCVOTRML GREATER ZERO
 10432         MOVE AL-UNNON           TO LCVOTRMA
 10433     END-IF.
 10434
 10435     IF LCVRTRML GREATER ZERO
 10436         MOVE AL-UNNON           TO LCVRTRMA
 10437     END-IF.
 10438
 10439     IF LCVRATEL GREATER ZERO
 10440         MOVE AL-UNNON           TO LCVRATEA
 10441     END-IF.
 10442
 10443     IF LCVBENEL GREATER ZERO
 10444         MOVE AL-UNNON           TO LCVBENEA
 10445     END-IF.
 10446
 10447     IF LCVFORML GREATER ZERO
 10448         MOVE AL-UANON           TO LCVFORMA
 10449     END-IF.
 10450
 10451     IF LCVCNDTL GREATER ZERO
 10452         MOVE AL-UANON           TO LCVCNDTA
 10453     END-IF.
 10454
 10455     IF LCVEXITL GREATER ZERO
 10456         MOVE AL-UANON           TO LCVEXITA
 10457     END-IF.
 10458
 10459     IF LCVSTATL GREATER ZERO
 10460         MOVE AL-UANON           TO LCVSTATA
 10461     END-IF.
 10462
 10463     IF MEMCAPL GREATER ZERO
 10464         MOVE AL-UANON           TO MEMCAPA
 10465     END-IF.
 10466
 10467     IF APRL GREATER ZERO
 10468         MOVE AL-UNNON           TO APRA
 10469     END-IF.
 10470
 10471     IF PMTFREQL GREATER ZERO
 10472         MOVE AL-UNNON           TO PMTFREQA
 10473     END-IF.
 10474
 10475     IF INDGRPL GREATER ZERO
 10476         MOVE AL-UANON           TO INDGRPA
 10477     END-IF.
 10478
 10479     IF PREMTYPL GREATER ZERO
 10480         MOVE AL-UANON           TO PREMTYPA
 10481     END-IF.
 10482
 10483     IF REINCDL GREATER ZERO
 10484         MOVE AL-UANON           TO REINCDA
 10485     END-IF.
 10486
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 201
* EL130.cbl
 10487     IF ADDONDTL GREATER ZERO
 10488         MOVE AL-UANON           TO ADDONDTA
 10489     END-IF.
 10490
 10491     IF MEMBERL GREATER ZERO
 10492         MOVE AL-UANON           TO MEMBERA
 10493     END-IF.
 10494
 10495     IF BCERT1L GREATER ZERO
 10496         MOVE AL-SANON           TO BCERT1A
 10497                                    BSUFX1A
 10498     END-IF.
 10499
 10500     IF BCERT2L GREATER ZERO
 10501         MOVE AL-SANON           TO BCERT2A
 10502                                    BSUFX2A
 10503     END-IF.
 10504
 10505     IF BCERT3L GREATER ZERO
 10506         MOVE AL-SANON           TO BCERT3A
 10507                                    BSUFX3A
 10508     END-IF.
 10509
 10510     IF BCERT4L GREATER ZERO
 10511         MOVE AL-SANON           TO BCERT4A
 10512                                    BSUFX4A
 10513     END-IF.
 10514
 10515     IF BCERT5L GREATER ZERO
 10516         MOVE AL-SANON           TO BCERT5A
 10517                                    BSUFX5A
 10518     END-IF.
 10519
 10520 3993-MODIFY-CLAIM-ATTRB.
 10521
 10522     IF PCERTNOL GREATER ZERO
 10523         MOVE AL-UANON           TO PCERTNOA
 10524     END-IF.
 10525
 10526     IF PSUFXL GREATER ZERO
 10527         MOVE AL-UANON           TO PSUFXA
 10528     END-IF.
 10529
 10530     IF LSTNMEL GREATER ZERO
 10531         MOVE AL-UANON           TO LSTNMEA
 10532     END-IF.
 10533
 10534     IF FSTNMEL GREATER ZERO
 10535         MOVE AL-UANON           TO FSTNMEA
 10536     END-IF.
 10537
 10538     IF INITL GREATER ZERO
 10539         MOVE AL-UANON           TO INITA
 10540     END-IF.
 10541
 10542     IF SEXL GREATER ZERO
 10543         MOVE AL-UANON           TO SEXA
 10544     END-IF.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 202
* EL130.cbl
 10545
 10546     IF OCCCDL GREATER ZERO
 10547         MOVE AL-UANON           TO OCCCDA
 10548     END-IF.
 10549
 10550     IF BIRTHDTL GREATER ZERO
 10551         MOVE AL-UANON           TO BIRTHDTA
 10552     END-IF.
 10553
 10554     IF SSNL GREATER ZERO
 10555         MOVE AL-UANON           TO SSNA
 10556     END-IF.
 10557
 10558     IF INCURL GREATER ZERO
 10559         MOVE AL-UANON           TO INCURA
 10560     END-IF.
 10561
 10562     IF REPORTL GREATER ZERO
 10563         MOVE AL-UANON           TO REPORTA
 10564     END-IF.
 10565
 10566     IF ESTENDL GREATER ZERO
 10567         MOVE AL-UANON           TO ESTENDA
 10568     END-IF.
 10569
 10570     IF DIAGL GREATER ZERO
 10571         MOVE AL-UANON           TO DIAGA
 10572     END-IF.
 10573
 10574     IF CAUSEL GREATER ZERO
 10575         MOVE AL-UANON           TO CAUSEA
 10576     END-IF.
 10577
 10578     IF MANRSVL GREATER ZERO
 10579         MOVE AL-UNNON           TO MANRSVA
 10580     END-IF.
 10581
 10582     IF RELCLML GREATER ZERO
 10583         MOVE AL-UANON           TO RELCLMA
 10584     END-IF.
 10585
 10586     IF LOANNOL GREATER ZERO
 10587         MOVE AL-UANON           TO LOANNOA
 10588     END-IF.
 10589
 10590     IF LOANBALL GREATER ZERO
 10591         MOVE AL-UNNON           TO LOANBALA
 10592     END-IF.
 10593
 10594     IF PROCCDL GREATER ZERO
 10595         MOVE AL-UANON           TO PROCCDA
 10596     END-IF.
 10597
 10598     IF BENECDL GREATER THAN ZERO
 10599         MOVE AL-UANON           TO  BENECDA
 10600     END-IF.
 10601
 10602     IF PRICDL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 203
* EL130.cbl
 10603         MOVE AL-UANON           TO PRICDA
 10604     END-IF.
 10605
 10606     IF SUPVL GREATER ZERO
 10607         MOVE AL-UANON           TO SUPVA
 10608     END-IF.
 10609
 10610     IF FILETOL GREATER ZERO
 10611         MOVE AL-UANON           TO FILETOA
 10612     END-IF.
 10613
 10614
 10615 3993-MODIFY-CLAIM-KEY-ATTRB.
 10616
 10617     IF CLMNOL GREATER ZERO
 10618         MOVE AL-UANON           TO CLMNOA
 10619     END-IF.
 10620
 10621     IF CLMCARRL GREATER ZERO
 10622         MOVE AL-UANON           TO CLMCARRA
 10623     END-IF.
 10624
 10625     IF CLMTYPEL GREATER ZERO
 10626         MOVE AL-UANON           TO CLMTYPEA
 10627     END-IF.
 10628
 10629     IF CERTNOL GREATER ZERO
 10630         MOVE AL-SANON           TO CERTNOA
 10631     END-IF.
 10632
 10633     IF SUFXL GREATER ZERO
 10634         MOVE AL-SANON           TO SUFXA
 10635     END-IF.
 10636
 10637 3993-EXIT.
 10638     EXIT.
 10639
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 204
* EL130.cbl
 10641 3994-BUILD-NINETY-THREE-TRAILER.
 10642
 10643     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 10644     MOVE 'AT'                   TO AT-RECORD-ID.
 10645
 10646     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 10647     MOVE CLMCARRI               TO AT-CARRIER.
 10648
 10649     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 10650     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 10651     MOVE +93                    TO AT-SEQUENCE-NO.
 10652     MOVE '6'                    TO AT-TRAILER-TYPE.
 10653     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 10654
 10655     MOVE WS-VERIFY-NOTE         TO AT-INFO-LINE-1.
 10656
 10657     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10658                                    AT-GEN-INFO-LAST-MAINT-DT.
 10659
 10660     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10661                                    AT-GEN-INFO-LAST-UPDATED-BY.
 10662     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10663
 10664
 10665
 10666* EXEC CICS WRITE
 10667*        DATASET   (ELTRLR-DSID)
 10668*        FROM      (ACTIVITY-TRAILERS)
 10669*        RIDFLD    (AT-CONTROL-PRIMARY)
 10670*    END-EXEC.
 10671     MOVE LENGTH OF
 10672      ACTIVITY-TRAILERS
 10673       TO DFHEIV11
 10674*    MOVE '&$ L                  ''   #00009895' TO DFHEIV0
 10675     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10676     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10677     MOVE X'2020233030303039383935' TO DFHEIV0(25:11)
 10678     CALL 'kxdfhei1' USING DFHEIV0,
 10679           ELTRLR-DSID,
 10680           ACTIVITY-TRAILERS,
 10681           DFHEIV11,
 10682           AT-CONTROL-PRIMARY,
 10683           DFHEIV99,
 10684           DFHEIV99
 10685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10686
 10687
 10688 3994-EXIT.
 10689     EXIT.
 10690
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 205
* EL130.cbl
 10692 3995-BUILD-CLAIM-RECORD.
 10693
 10694     IF PROCCDL GREATER ZERO
 10695         MOVE PROCCDI            TO CL-PROCESSOR-ID
 10696     ELSE
 10697         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 10698     END-IF.
 10699
 10700     IF FSTNMEL GREATER ZERO
 10701         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 10702     END-IF.
 10703
 10704     IF INITL GREATER ZERO
 10705         MOVE INITI              TO CL-INSURED-MID-INIT
 10706     END-IF.
 10707
 10708     IF BIRTHDTL GREATER ZERO
 10709         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 10710     END-IF.
 10711
 10712     IF SEXL GREATER ZERO
 10713         MOVE SEXI               TO CL-INSURED-SEX-CD
 10714     END-IF.
 10715
 10716     IF OCCCDL GREATER ZERO
 10717         MOVE OCCCDI             TO CL-INSURED-OCC-CD
 10718     END-IF.
 10719
 10720     MOVE 'O'                    TO CL-CLAIM-STATUS.
 10721
 10722*    IF CLMTYPEL GREATER ZERO
 10723     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 10724*    END-IF.
 10725
 10726     IF PREMTYPL GREATER ZERO
 10727         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 10728     END-IF.
 10729
 10730     IF INCURL GREATER ZERO
 10731         MOVE WS-INCUR           TO CL-INCURRED-DT
 10732     END-IF.
 10733
 10734     IF REPORTL GREATER ZERO
 10735         MOVE WS-REPORT          TO CL-REPORTED-DT
 10736     END-IF.
 10737
 10738     IF EIBAID = DFHPF6
 10739         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
 10740             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 10741                 IF EMI-FORCABLE-CTR = +1
 10742                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 10743                 END-IF
 10744         END-IF
 10745     END-IF.
 10746
 10747     IF ESTENDL GREATER ZERO
 10748        MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 10749     END-IF.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 206
* EL130.cbl
 10750
 10751     IF ADDONDTL GREATER ZERO
 10752         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 10753     END-IF.
 10754
 10755     IF CAUSEL GREATER ZERO
 10756         MOVE CAUSEI             TO CL-CAUSE-CD
 10757     END-IF.
 10758
 10759     IF SSNL GREATER ZERO
 10760         MOVE SSNI               TO CL-SOC-SEC-NO
 10761     ELSE
 10762         MOVE CERT-STATE         TO CL-SSN-STATE
 10763         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 10764         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 10765     END-IF.
 10766
 10767     IF PRICDL GREATER ZERO
 10768         MOVE PRICDI             TO CL-PRIORITY-CD
 10769     END-IF.
 10770
 10771     IF SUPVL GREATER ZERO
 10772         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 10773     END-IF.
 10774
 10775     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 10776     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 10777     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 10778
 10779     IF RELCLML GREATER ZERO
 10780         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 10781     END-IF.
 10782
 10783     IF FILETOL GREATER ZERO
 10784         MOVE FILETOI            TO CL-FILE-LOCATION
 10785     END-IF.
 10786
 10787 3995-EXIT.
 10788      EXIT.
 10789
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 207
* EL130.cbl
 10791 4000-CALCULATE-CERT-TERM.
 10792
 10793     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 10794
 10795     MOVE N                      TO WS-TERM.
 10796
 10797     IF WS-TERM GREATER 120
 10798         MOVE 120                TO WS-TERM
 10799     END-IF.
 10800
 10801 4000-CALC-TERM-EXIT.
 10802      EXIT.
 10803
 10804 4100-CALC-GROSS-TERM.
 10805     MOVE HOLD-LOAN-BAL           TO L.
 10806     MOVE WS-ACVBENE              TO M.
 10807     COMPUTE N = L / M.
 10808     IF N LESS 1
 10809         MOVE 1  TO N
 10810     END-IF.
 10811
 10812     IF LCVCDL GREATER ZERO
 10813         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 10814     ELSE
 10815         MOVE ZEROS               TO WS-LF-RATE
 10816     END-IF.
 10817
 10818     IF ACVCDL GREATER ZERO
 10819         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 10820     ELSE
 10821         MOVE ZEROS               TO WS-AH-RATE
 10822     END-IF.
 10823
 10824     COMPUTE I = WS-APR / +1200.
 10825
 10826 4105-LOOP.
 10827     IF N GREATER 240
 10828         GO TO 4200-EXIT
 10829     END-IF.
 10830
 10831     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 10832
 10833     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 10834         ADD 1 TO N
 10835         GO TO 4105-LOOP
 10836     END-IF.
 10837
 10838 4200-EXIT.
 10839      EXIT.
 10840
 10841 4210-CALC-LEFT-RIGHTONE.
 10842      MOVE L         TO LEFT-TOT-1.
 10843      SUBTRACT 1 FROM N.
 10844      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 10845      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 10846      ADD 1 TO N.
 10847
 10848 4211-CALC-TERM1.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 208
* EL130.cbl
 10849      MOVE N         TO TERM1.
 10850      MULTIPLY M BY TERM1.
 10851
 10852 4212-LOOP.
 10853      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 10854      ADD 1 TO A-N.
 10855      MULTIPLY A-N BY TERM1.
 10856      SUBTRACT 1 FROM A-N.
 10857      ADD TERM1 TO LEFT-TOT-1.
 10858
 10859 4213-CALC-TERM2.
 10860      MOVE M         TO TERM2.
 10861      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 10862      MULTIPLY IA-N BY TERM2.
 10863      SUBTRACT TERM2 FROM LEFT-TOT-1.
 10864
 10865 4215-CALC-RIGHTONE.
 10866      MOVE M         TO RIGHT-TOT-1.
 10867      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 10868      MULTIPLY A-N BY RIGHT-TOT-1.
 10869
 10870 4220-EXIT.
 10871      EXIT.
 10872
 10873 4300-CALC-A-N.
 10874     IF N LESS 1
 10875         MOVE 0     TO A-N
 10876         GO TO 4300-EXIT
 10877     END-IF.
 10878
 10879     IF I = 0
 10880         MOVE .00001 TO I
 10881     END-IF.
 10882
 10883     ADD 1 TO I.
 10884     DIVIDE I INTO 1 GIVING V.
 10885     SUBTRACT 1 FROM I.
 10886     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 10887     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 10888     DIVIDE I INTO TERM3 GIVING A-N.
 10889
 10890 4300-EXIT.
 10891      EXIT.
 10892
 10893 4350-CALC-IA-N.
 10894     IF N LESS 1
 10895         MOVE 0      TO IA-N
 10896         GO TO 4400-EXIT
 10897     END-IF.
 10898
 10899     ADD 1 TO N.
 10900     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 10901     SUBTRACT 1 FROM N.
 10902     MULTIPLY N BY V-EX-N GIVING TERM3.
 10903     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 10904     SUBTRACT V FROM 1 GIVING TERM4.
 10905     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 10906
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 209
* EL130.cbl
 10907 4400-EXIT.
 10908      EXIT.
 10909
 10910 4450-CALC-V-EX-N.
 10911     IF N LESS 1
 10912         MOVE 1    TO V-EX-N
 10913         GO TO 4490-EXIT
 10914     END-IF.
 10915
 10916     MOVE N        TO NV-STORE.
 10917
 10918     IF V-EX-ONETIME = 1  OR
 10919        V NOT = V-EXPONENT (1)
 10920          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 10921     END-IF.
 10922
 10923 4460-LOOP.
 10924     IF N GREATER 248
 10925         MOVE 248 TO N
 10926     END-IF.
 10927
 10928     IF N = 1
 10929         MOVE V               TO V-EX-N
 10930     ELSE
 10931         MOVE V-EXPONENT (N)  TO V-EX-N
 10932     END-IF.
 10933
 10934     GO TO 4490-EXIT.
 10935
 10936 4470-BUILD-V-EX-TABLE.
 10937     MOVE 2      TO N.
 10938     MOVE V      TO V-EXPONENT (1)
 10939                    V-EX-N.
 10940
 10941 4471-LOOP.
 10942     MULTIPLY V BY V-EX-N.
 10943     MOVE V-EX-N   TO V-EXPONENT (N).
 10944
 10945     ADD 1 TO N.
 10946     IF N LESS 248
 10947         GO TO 4471-LOOP
 10948     END-IF.
 10949
 10950     MOVE NV-STORE     TO N.
 10951     MOVE ZERO         TO V-EX-ONETIME.
 10952
 10953 4480-EXIT.
 10954      EXIT.
 10955
 10956 4490-EXIT.
 10957      EXIT.
 10958
 10959 4500-CALC-NET-TERM.
 10960     MOVE HOLD-LOAN-BAL           TO L.
 10961     MOVE WS-ACVBENE              TO M.
 10962     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 10963
 10964     IF WS-REMAIN GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 210
* EL130.cbl
 10965         ADD 1 TO N
 10966     END-IF.
 10967
 10968     IF N = 0
 10969         MOVE 1 TO N
 10970     END-IF.
 10971
 10972 4700-EXIT.
 10973      EXIT.
 10974
 10975 4999-CALC-TERM-EXIT.
 10976     EXIT.
 10977
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 211
* EL130.cbl
 10979 5000-INCURRED-CHANGE.
 10980     IF NOT MODIFY-CAP
 10981         MOVE ER-0070            TO EMI-ERROR
 10982         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10983         MOVE -1                 TO MAINTL
 10984         GO TO 8200-SEND-DATAONLY
 10985     END-IF.
 10986
 10987     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 10988        CLMCARRI     NOT = PI-LAST-CARR        OR
 10989        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 10990        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 10991        PI-INCURR-SW NOT = 'Y'
 10992          GO TO 1000-SHOW-CLAIM
 10993     END-IF.
 10994
 10995     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 10996     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 10997     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 10998
 10999     IF EMI-NO-ERRORS
 11000         GO TO 5000-TRY-TO-BUILD
 11001     END-IF.
 11002
 11003     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 11004        MOVE ER-0433             TO EMI-ERROR
 11005        MOVE -1                  TO MAINTL
 11006        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11007        GO TO 8200-SEND-DATAONLY
 11008     END-IF.
 11009
 11010     IF EIBAID = DFHPF6
 11011         IF EMI-FATAL-CTR NOT EQUAL ZERO
 11012            MOVE ER-0434         TO EMI-ERROR
 11013            MOVE -1              TO MAINTL
 11014            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11015            GO TO 8200-SEND-DATAONLY
 11016         ELSE
 11017            MOVE +1              TO INCURL
 11018            GO TO 5000-TRY-TO-BUILD
 11019         END-IF
 11020     END-IF.
 11021
 11022     GO TO 8200-SEND-DATAONLY.
 11023
 11024 5000-TRY-TO-BUILD.
 11025
 11026     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 11027
 11028     MOVE CLMCARRI               TO MSTR-CARRIER.
 11029
 11030     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 11031     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 11032     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 11033
 11034     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 11035
 11036     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 212
* EL130.cbl
 11037         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 11038     END-IF.
 11039
 11040     IF CL-PURGED-DT NOT = LOW-VALUES
 11041
 11042
 11043* EXEC CICS UNLOCK
 11044*            DATASET   (ELMSTR-DSID)
 11045*        END-EXEC
 11046*    MOVE '&*                    #   #00010255' TO DFHEIV0
 11047     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11048     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11049     MOVE X'2020233030303130323535' TO DFHEIV0(25:11)
 11050     CALL 'kxdfhei1' USING DFHEIV0,
 11051           ELMSTR-DSID,
 11052           DFHEIV99
 11053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11054         MOVE ER-7691            TO EMI-ERROR
 11055         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11056         MOVE -1                 TO MAINTL
 11057         GO TO 8200-SEND-DATAONLY
 11058     END-IF.
 11059
 11060     IF CL-AUTO-PAY-SEQ NOT = ZERO
 11061
 11062
 11063* EXEC CICS UNLOCK
 11064*            DATASET   (ELMSTR-DSID)
 11065*       END-EXEC
 11066*    MOVE '&*                    #   #00010266' TO DFHEIV0
 11067     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11068     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11069     MOVE X'2020233030303130323636' TO DFHEIV0(25:11)
 11070     CALL 'kxdfhei1' USING DFHEIV0,
 11071           ELMSTR-DSID,
 11072           DFHEIV99
 11073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11074         MOVE ER-0523             TO EMI-ERROR
 11075         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11076         MOVE -1                  TO MAINTL
 11077         GO TO 8200-SEND-DATAONLY
 11078     END-IF.
 11079
 11080     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 11081
 11082     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 11083     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 11084     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 11085     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 11086     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 11087
 11088     IF MANRSVL GREATER ZERO
 11089        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 11090                                    AT-CURRENT-MANUAL-RESERVE
 11091     END-IF.
 11092     MOVE 1                      TO SUB.
 11093
 11094 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 213
* EL130.cbl
 11095     IF SUB = 1
 11096        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 11097        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 11098        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 11099     ELSE
 11100        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 11101        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 11102                                    AT-OPEN-CLOSE-REASON (SUB)
 11103     END-IF.
 11104
 11105     IF SUB NOT = 6
 11106        ADD 1                    TO SUB
 11107        GO TO 5010-LOOP
 11108     END-IF.
 11109
 11110 5020-UPDATE.
 11111
 11112     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11113
 11114     IF DIAGL = ZERO
 11115         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 11116         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 11117         GO TO 5025-BYPASS-UPDATE
 11118     END-IF.
 11119
 11120     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 11121
 11122     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 11123     MOVE DIAGI                  TO AT-INFO-LINE-1.
 11124
 11125     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11126
 11127 5025-BYPASS-UPDATE.
 11128
 11129
 11130
 11131* EXEC CICS GETMAIN
 11132*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11133*        LENGTH   (ELTRLR-LENGTH)
 11134*    END-EXEC.
 11135*    MOVE '," L                  $   #00010325' TO DFHEIV0
 11136     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 11137     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11138     MOVE X'2020233030303130333235' TO DFHEIV0(25:11)
 11139     CALL 'kxdfhei1' USING DFHEIV0,
 11140           DFHEIV20,
 11141           ELTRLR-LENGTH,
 11142           DFHEIV99
 11143     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11144         DFHEIV20
 11145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11146
 11147
 11148     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11149     MOVE 'AT'                   TO AT-RECORD-ID.
 11150
 11151     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11152     MOVE MSTR-CARRIER           TO AT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 214
* EL130.cbl
 11153     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11154     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 11155     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 11156     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 11157     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 11158     MOVE '9'                    TO AT-TRAILER-TYPE.
 11159     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11160     MOVE '5'                    TO DC-OPTION-CODE.
 11161     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11162     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 11163
 11164     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 11165     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11166
 11167     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 11168     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 11169     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 11170     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 11171     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 11172     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 11173     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 11174     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 11175     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 11176     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 11177
 11178     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 11179     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 11180     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 11181     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 11182     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 11183
 11184
 11185
 11186* EXEC CICS WRITE
 11187*        DATASET   (ELTRLR-DSID)
 11188*        FROM      (ACTIVITY-TRAILERS)
 11189*        RIDFLD    (AT-CONTROL-PRIMARY)
 11190*    END-EXEC.
 11191     MOVE LENGTH OF
 11192      ACTIVITY-TRAILERS
 11193       TO DFHEIV11
 11194*    MOVE '&$ L                  ''   #00010367' TO DFHEIV0
 11195     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11196     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11197     MOVE X'2020233030303130333637' TO DFHEIV0(25:11)
 11198     CALL 'kxdfhei1' USING DFHEIV0,
 11199           ELTRLR-DSID,
 11200           ACTIVITY-TRAILERS,
 11201           DFHEIV11,
 11202           AT-CONTROL-PRIMARY,
 11203           DFHEIV99,
 11204           DFHEIV99
 11205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11206
 11207
 11208     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 11209     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 11210     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 215
* EL130.cbl
 11211     MOVE CL-CERT-STATE          TO CERT-STATE.
 11212     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 11213     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 11214     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 11215
 11216
 11217
 11218* EXEC CICS HANDLE CONDITION
 11219*        NOTFND   (5050-CERT-NOT-FOUND)
 11220*    END-EXEC.
 11221*    MOVE '"$I                   ! ; #00010382' TO DFHEIV0
 11222     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11223     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11224     MOVE X'3B20233030303130333832' TO DFHEIV0(25:11)
 11225     CALL 'kxdfhei1' USING DFHEIV0
 11226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11227
 11228
 11229     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 11230
 11231     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 11232
 11233
 11234
 11235* EXEC CICS HANDLE CONDITION
 11236*         DUPKEY   (5030-CERT-WRITTEN)
 11237*    END-EXEC.
 11238*    MOVE '"$$                   ! < #00010391' TO DFHEIV0
 11239     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11240     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11241     MOVE X'3C20233030303130333931' TO DFHEIV0(25:11)
 11242     CALL 'kxdfhei1' USING DFHEIV0
 11243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11244
 11245
 11246
 11247
 11248* EXEC CICS REWRITE
 11249*        DATASET  (ELCERT-DSID)
 11250*        FROM     (CERTIFICATE-MASTER)
 11251*    END-EXEC.
 11252     MOVE LENGTH OF
 11253      CERTIFICATE-MASTER
 11254       TO DFHEIV11
 11255*    MOVE '&& L                  %   #00010396' TO DFHEIV0
 11256     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11257     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11258     MOVE X'2020233030303130333936' TO DFHEIV0(25:11)
 11259     CALL 'kxdfhei1' USING DFHEIV0,
 11260           ELCERT-DSID,
 11261           CERTIFICATE-MASTER,
 11262           DFHEIV11,
 11263           DFHEIV99
 11264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11265
 11266
 11267 5030-CERT-WRITTEN.
 11268
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 216
* EL130.cbl
 11269     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 11270                                    CL-INCURRED-DT
 11271                                    CL-REPORTED-DT
 11272                                    CL-EST-END-OF-DISAB-DT
 11273                                    CL-PAID-THRU-DT.
 11274
 11275     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 11276                                    CL-NO-OF-PMTS-MADE
 11277                                    CL-NO-OF-DAYS-PAID.
 11278
 11279     IF CLAIM-IS-CLOSED
 11280        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 11281        MOVE 'O'                 TO CL-CLAIM-STATUS
 11282     END-IF.
 11283
 11284     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 11285     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 11286     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11287
 11288
 11289
 11290* EXEC CICS HANDLE CONDITION
 11291*         DUPKEY   (5035-CLAIM-WRITTEN)
 11292*    END-EXEC.
 11293*    MOVE '"$$                   ! = #00010423' TO DFHEIV0
 11294     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11295     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11296     MOVE X'3D20233030303130343233' TO DFHEIV0(25:11)
 11297     CALL 'kxdfhei1' USING DFHEIV0
 11298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11299
 11300
 11301
 11302
 11303* EXEC CICS REWRITE
 11304*        DATASET   (ELMSTR-DSID)
 11305*        FROM      (CLAIM-MASTER)
 11306*    END-EXEC.
 11307     MOVE LENGTH OF
 11308      CLAIM-MASTER
 11309       TO DFHEIV11
 11310*    MOVE '&& L                  %   #00010428' TO DFHEIV0
 11311     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11312     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11313     MOVE X'2020233030303130343238' TO DFHEIV0(25:11)
 11314     CALL 'kxdfhei1' USING DFHEIV0,
 11315           ELMSTR-DSID,
 11316           CLAIM-MASTER,
 11317           DFHEIV11,
 11318           DFHEIV99
 11319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11320
 11321
 11322 5035-CLAIM-WRITTEN.
 11323
 11324     MOVE ER-0000                TO EMI-ERROR.
 11325     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11326
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 217
* EL130.cbl
 11327     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 11328     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 11329     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 11330     MOVE CLMCARRI               TO PI-LAST-CARR.
 11331
 11332     IF PRTOPTL GREATER ZERO
 11333         MOVE PRTOPTI            TO PI-PRT-OPT
 11334     END-IF.
 11335
 11336     IF ALTPRTL GREATER ZERO
 11337         MOVE ALTPRTI            TO PI-ALT-PRT
 11338     END-IF.
 11339
 11340     MOVE LOW-VALUES             TO EL130AI.
 11341
 11342     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 11343     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 11344     MOVE PI-LAST-CARR           TO CLMCARRO.
 11345     MOVE PI-LAST-CLAIM          TO CLMNOO.
 11346
 11347     IF PI-PRT-OPT = 'N' OR 'L'
 11348         MOVE PI-PRT-OPT         TO PRTOPTO
 11349         MOVE 1                  TO PRTOPTL
 11350     END-IF.
 11351
 11352     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 11353         MOVE PI-ALT-PRT         TO ALTPRTO
 11354         MOVE 4                  TO ALTPRTL
 11355     END-IF.
 11356
 11357     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 11358     MOVE AL-SANON               TO CERTNOA SUFXA.
 11359
 11360     MOVE SPACES                 TO PI-INCURR-SW.
 11361
 11362     IF PRTOPTL GREATER ZERO
 11363         IF PRTOPTI = 'L'
 11364             GO TO 0400-CREATE-ELACTQ
 11365         ELSE
 11366             GO TO 0480-PRINT-NOW
 11367         END-IF
 11368     END-IF.
 11369
 11370     GO TO 8100-SEND-INITIAL-MAP.
 11371
 11372 5050-CERT-NOT-FOUND.
 11373
 11374     MOVE ER-0244                TO EMI-ERROR.
 11375     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11376     MOVE -1                     TO CERTNOL.
 11377     GO TO 8200-SEND-DATAONLY.
 11378
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 218
* EL130.cbl
 11380 5500-BUILD-FORM-TRAILER.
 11381*************************************************************
 11382*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 11383*************************************************************
 11384
 11385     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 11386
 11387     IF  WS-BEN-ALPHA-2 = '30'
 11388         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 11389         MOVE '6'                TO DC-OPTION-CODE
 11390         IF CL-CARRIER = 'C'
 11391             MOVE +14            TO DC-ELAPSED-DAYS
 11392             MOVE +0             TO DC-ELAPSED-MONTHS
 11393             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11394             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 11395         ELSE
 11396             MOVE +21            TO DC-ELAPSED-DAYS
 11397             MOVE +0             TO DC-ELAPSED-MONTHS
 11398             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11399             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 11400         END-IF
 11401     END-IF.
 11402
 11403
 11404
 11405* EXEC CICS GETMAIN
 11406*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11407*         LENGTH   (ELTRLR-LENGTH)
 11408*         INITIMG  (GETMAIN-SPACE)
 11409*    END-EXEC.
 11410*    MOVE ',"IL                  $   #00010515' TO DFHEIV0
 11411     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11412     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11413     MOVE X'2020233030303130353135' TO DFHEIV0(25:11)
 11414     CALL 'kxdfhei1' USING DFHEIV0,
 11415           DFHEIV20,
 11416           ELTRLR-LENGTH,
 11417           GETMAIN-SPACE
 11418     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11419         DFHEIV20
 11420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11421
 11422
 11423     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 11424     MOVE 'AT'                   TO AT-RECORD-ID.
 11425
 11426     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 11427     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 11428     MOVE 'A'                    TO AT-TRAILER-TYPE.
 11429     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 11430                                    AT-FORM-LAST-MAINT-DT.
 11431     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11432                                    AT-FORM-LAST-UPDATED-BY.
 11433     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11434     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 11435     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 11436                                    AT-FORM-RE-SEND-DT
 11437                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 219
* EL130.cbl
 11438                                    AT-EMP-FORM-ANSWERED-DT
 11439                                    AT-PHY-FORM-ANSWERED-DT
 11440                                    AT-EMP-FORM-SEND-ON-DT
 11441                                    AT-FORM-PRINTED-DT
 11442                                    AT-FORM-REPRINT-DT.
 11443     MOVE '1'                    TO AT-FORM-TYPE.
 11444
 11445     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 11446                                    AT-INSTRUCT-LN-2
 11447                                    AT-INSTRUCT-LN-3.
 11448
 11449     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 11450     MOVE 'I'                    TO AT-FORM-ADDRESS.
 11451
 11452     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 11453
 11454     IF AM-EMPLOYER-STMT-USED = 'Y'
 11455        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 11456     END-IF.
 11457
 11458
 11459
 11460* EXEC CICS WRITE
 11461*         DATASET  (ELTRLR-DSID)
 11462*         FROM     (ACTIVITY-TRAILERS)
 11463*         RIDFLD   (AT-CONTROL-PRIMARY)
 11464*    END-EXEC.
 11465     MOVE LENGTH OF
 11466      ACTIVITY-TRAILERS
 11467       TO DFHEIV11
 11468*    MOVE '&$ L                  ''   #00010557' TO DFHEIV0
 11469     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11470     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11471     MOVE X'2020233030303130353537' TO DFHEIV0(25:11)
 11472     CALL 'kxdfhei1' USING DFHEIV0,
 11473           ELTRLR-DSID,
 11474           ACTIVITY-TRAILERS,
 11475           DFHEIV11,
 11476           AT-CONTROL-PRIMARY,
 11477           DFHEIV99,
 11478           DFHEIV99
 11479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11480
 11481
 11482 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 220
* EL130.cbl
 11484*************************************************************
 11485*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 11486*************************************************************
 11487
 11488 5700-BUILD-ARCHIVE-HEADER.
 11489
 11490     MOVE '1'                    TO CNTL-REC-TYPE.
 11491     MOVE ZEROS                  TO CNTL-SEQ-NO.
 11492     MOVE SPACES                 TO CNTL-ACCESS.
 11493
 11494
 11495
 11496* EXEC CICS READ
 11497*         DATASET  (ELCNTL-DSID)
 11498*         SET      (ADDRESS OF CONTROL-FILE)
 11499*         RIDFLD   (ELCNTL-KEY)
 11500*         UPDATE
 11501*    END-EXEC.
 11502*    MOVE '&"S        EU         (   #00010576' TO DFHEIV0
 11503     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11504     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11505     MOVE X'2020233030303130353736' TO DFHEIV0(25:11)
 11506     CALL 'kxdfhei1' USING DFHEIV0,
 11507           ELCNTL-DSID,
 11508           DFHEIV20,
 11509           DFHEIV99,
 11510           ELCNTL-KEY,
 11511           DFHEIV99,
 11512           DFHEIV99,
 11513           DFHEIV99
 11514     SET ADDRESS OF CONTROL-FILE TO
 11515         DFHEIV20
 11516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11517
 11518
 11519     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 11520
 11521     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 11522
 11523
 11524
 11525* EXEC CICS REWRITE
 11526*         FROM     (CONTROL-FILE)
 11527*         DATASET  (ELCNTL-DSID)
 11528*    END-EXEC.
 11529     MOVE LENGTH OF
 11530      CONTROL-FILE
 11531       TO DFHEIV11
 11532*    MOVE '&& L                  %   #00010588' TO DFHEIV0
 11533     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11534     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11535     MOVE X'2020233030303130353838' TO DFHEIV0(25:11)
 11536     CALL 'kxdfhei1' USING DFHEIV0,
 11537           ELCNTL-DSID,
 11538           CONTROL-FILE,
 11539           DFHEIV11,
 11540           DFHEIV99
 11541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 221
* EL130.cbl
 11542
 11543
 11544
 11545
 11546* EXEC CICS HANDLE CONDITION
 11547*         NOTOPEN  (9990-ABEND)
 11548*         DUPKEY   (5799-EXIT)
 11549*    END-EXEC.
 11550*    MOVE '"$J$                  ! > #00010594' TO DFHEIV0
 11551     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 11552     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11553     MOVE X'3E20233030303130353934' TO DFHEIV0(25:11)
 11554     CALL 'kxdfhei1' USING DFHEIV0
 11555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11556
 11557
 11558
 11559
 11560* EXEC CICS GETMAIN
 11561*         SET     (ADDRESS OF LETTER-ARCHIVE)
 11562*         LENGTH  (ELARCH-LENGTH)
 11563*    END-EXEC.
 11564*    MOVE '," L                  $   #00010600' TO DFHEIV0
 11565     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 11566     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11567     MOVE X'2020233030303130363030' TO DFHEIV0(25:11)
 11568     CALL 'kxdfhei1' USING DFHEIV0,
 11569           DFHEIV20,
 11570           ELARCH-LENGTH,
 11571           DFHEIV99
 11572     SET ADDRESS OF LETTER-ARCHIVE TO
 11573         DFHEIV20
 11574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11575
 11576
 11577     MOVE SPACES                 TO LETTER-ARCHIVE.
 11578     MOVE 'LA'                   TO LA-RECORD-ID.
 11579     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 11580                                    LA-ARCHIVE-NO-A1.
 11581     MOVE '4'                    TO LA-RECORD-TYPE
 11582                                    LA-RECORD-TYPE-A1.
 11583     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 11584                                    LA-LINE-SEQ-NO-A1.
 11585     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 11586                                    LA-COMPANY-CD-A1.
 11587     MOVE CL-CARRIER             TO LA4-CARRIER.
 11588     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 11589     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 11590     MOVE CL-CERT-STATE          TO LA4-STATE.
 11591     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 11592     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 11593     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 11594     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 11595                                    LA4-RESEND-PRINT-DATE
 11596                                    LA4-FORM-REM-PRINT-DT
 11597                                    LA4-RESEND-DATE.
 11598     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 11599     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 222
* EL130.cbl
 11600
 11601
 11602
 11603* EXEC CICS WRITE
 11604*         DATASET  (ELARCH-DSID)
 11605*         FROM     (LETTER-ARCHIVE)
 11606*         RIDFLD   (LA-CONTROL-PRIMARY)
 11607*    END-EXEC.
 11608     MOVE LENGTH OF
 11609      LETTER-ARCHIVE
 11610       TO DFHEIV11
 11611*    MOVE '&$ L                  ''   #00010630' TO DFHEIV0
 11612     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11613     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11614     MOVE X'2020233030303130363330' TO DFHEIV0(25:11)
 11615     CALL 'kxdfhei1' USING DFHEIV0,
 11616           ELARCH-DSID,
 11617           LETTER-ARCHIVE,
 11618           DFHEIV11,
 11619           LA-CONTROL-PRIMARY,
 11620           DFHEIV99,
 11621           DFHEIV99
 11622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11623
 11624
 11625 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 223
* EL130.cbl
 11627 6000-EDIT-CLAIM-DATA.
 11628
 11629     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 11630     MOVE '2'                    TO DC-OPTION-CODE.
 11631     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11632     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 11633
 11634     IF CLMNOL GREATER ZERO
 11635         IF CLMNOI = SPACES OR LOW-VALUES
 11636             MOVE -1             TO CLMNOL
 11637             MOVE AL-UABON       TO CLMNOA
 11638             MOVE ER-7688        TO EMI-ERROR
 11639             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11640         ELSE
 11641             MOVE AL-UANON       TO CLMNOA
 11642         END-IF
 11643     END-IF.
 11644
 11645     IF CERTNOL = ZERO
 11646         MOVE -1                 TO CERTNOL
 11647         MOVE AL-SABON           TO CERTNOA
 11648         MOVE ER-0203            TO EMI-ERROR
 11649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11650     ELSE
 11651         MOVE AL-SANON           TO CERTNOA
 11652     END-IF.
 11653
 11654     IF SUFXL = ZERO
 11655         MOVE SPACES             TO SUFXI
 11656         MOVE AL-SANON           TO SUFXA
 11657     ELSE
 11658         MOVE AL-SANON           TO SUFXA
 11659     END-IF.
 11660
 11661     IF CLMCARRL = ZERO
 11662         MOVE -1                 TO CLMCARRL
 11663         MOVE ER-0194            TO EMI-ERROR
 11664         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11665     ELSE
 11666         MOVE CLMCARRI           TO PI-CARRIER
 11667         IF PI-NO-CARRIER-SECURITY
 11668             MOVE AL-UANON       TO CLMCARRA
 11669         END-IF
 11670     END-IF.
 11671
 11672     IF CLMTYPEL > ZERO
 11673        IF ((PI-COMPANY-ID = 'DCC')
 11674           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 11675              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G'))
 11676                        OR
 11677           ((PI-COMPANY-ID = 'CID')
 11678           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 11679              AND PI-AH-OVERRIDE-L1))
 11680              MOVE -1             TO CLMTYPEL
 11681              MOVE AL-UABON       TO CLMTYPEA
 11682              MOVE ER-7634        TO EMI-ERROR
 11683              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11684        ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 224
* EL130.cbl
 11685           MOVE AL-UANON       TO CLMTYPEA
 11686        END-IF
 11687     ELSE
 11688        IF MAINTI = 'A'
 11689           MOVE -1             TO CLMTYPEL
 11690           MOVE AL-UABON       TO CLMTYPEA
 11691           MOVE ER-0546        TO EMI-ERROR
 11692           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11693        END-IF
 11694     END-IF
 11695
 11696     IF PCERTNOL = ZERO
 11697        MOVE CERTNOI             TO PCERTNOI
 11698        MOVE CERTNOL             TO PCERTNOL
 11699        MOVE AL-UANON            TO PCERTNOA
 11700     ELSE
 11701        MOVE AL-UANON            TO PCERTNOA
 11702     END-IF.
 11703
 11704     IF PSUFXL = ZERO
 11705        MOVE SUFXI               TO PSUFXI
 11706        MOVE SUFXL               TO PSUFXL
 11707        MOVE AL-UANON            TO PSUFXA
 11708     ELSE
 11709        MOVE AL-UANON            TO PSUFXA
 11710     END-IF.
 11711
 11712     IF MAINTI = 'I'
 11713         GO TO 6020-EDIT
 11714     END-IF.
 11715
 11716     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 11717         MOVE -1                 TO LSTNMEL
 11718         MOVE ER-0236            TO EMI-ERROR
 11719         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11720     ELSE
 11721         MOVE AL-UANON           TO LSTNMEA
 11722     END-IF.
 11723
 11724     IF SEXI NOT = 'M' AND 'F'
 11725         MOVE -1                 TO SEXL
 11726         MOVE AL-UABON           TO SEXA
 11727         MOVE ER-0219            TO EMI-ERROR
 11728         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11729     ELSE
 11730         MOVE AL-UANON           TO SEXA
 11731     END-IF.
 11732
 11733     IF SSNL GREATER THAN ZERO
 11734         MOVE SSNI TO WS-SOC-SEC-NUMBER
 11735         IF WS-SOC-SEC-NO NUMERIC AND
 11736           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 11737             NEXT SENTENCE
 11738         ELSE
 11739            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 11740               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 11741               WS-SSN-DASH2 = '-'
 11742                 NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 225
* EL130.cbl
 11743            ELSE
 11744                 MOVE ER-0887        TO  EMI-ERROR
 11745                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11746                 MOVE AL-UABON       TO  SSNA
 11747                 MOVE -1             TO  SSNL
 11748            END-IF
 11749        END-IF
 11750     END-IF.
 11751
 11752     IF BIRTHDTL = ZERO
 11753         GO TO 6020-EDIT
 11754     END-IF.
 11755
 11756     IF BIRTHDTL GREATER ZERO
 11757         MOVE BIRTHDTI           TO DATE-WORK
 11758         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11759         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11760         MOVE '4'                TO DC-OPTION-CODE
 11761         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11762         IF DATE-CONVERSION-ERROR
 11763             MOVE AL-UABON       TO BIRTHDTA
 11764             MOVE -1             TO BIRTHDTL
 11765             MOVE ER-0220        TO EMI-ERROR
 11766             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11767             GO TO 6020-EDIT
 11768         END-IF
 11769     END-IF.
 11770
 11771******************************************************************
 11772**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 11773**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 11774**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 11775******************************************************************
 11776
 11777     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 11778         MOVE BIRTHDTI           TO  DATE-WORK
 11779         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11780         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 11781         MOVE '4'                TO  DC-OPTION-CODE
 11782         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 11783         MOVE +0                 TO  DC-ELAPSED-MONTHS
 11784                                     DC-ELAPSED-DAYS
 11785         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11786         IF DATE-CONVERSION-ERROR
 11787             MOVE AL-UABON       TO  BIRTHDTA
 11788             MOVE -1             TO  BIRTHDTL
 11789             MOVE ER-0220        TO  EMI-ERROR
 11790             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11791             GO TO 6020-EDIT
 11792         END-IF
 11793     END-IF.
 11794
 11795     MOVE AL-UANON               TO  BIRTHDTA.
 11796     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 11797     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 11798     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 11799
 11800 6020-EDIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 226
* EL130.cbl
 11801     IF INCURL GREATER ZERO
 11802         MOVE INCURI             TO DATE-WORK
 11803         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11804         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11805         MOVE '4'                TO DC-OPTION-CODE
 11806         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11807         IF DATE-CONVERSION-ERROR
 11808             MOVE AL-UABON       TO INCURA
 11809             MOVE -1             TO INCURL
 11810             MOVE ER-0222        TO EMI-ERROR
 11811             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11812         ELSE
 11813             MOVE AL-UANON       TO INCURA
 11814             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 11815             MOVE DC-BIN-DATE-1  TO WS-INCUR
 11816                                    PI-SAVE-INCUR-DT
 11817             IF WS-INCUR GREATER THAN WS-TODAY-DT
 11818                 MOVE ER-0511     TO EMI-ERROR
 11819                 MOVE -1          TO INCURL
 11820                 MOVE AL-UABON    TO INCURA
 11821                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11822             ELSE
 11823*                NEXT SENTENCE
 11824                 CONTINUE
 11825             END-IF
 11826         END-IF
 11827     ELSE
 11828         MOVE ER-0516         TO EMI-ERROR
 11829         MOVE AL-UABON        TO INCURA
 11830         MOVE -1              TO INCURL
 11831         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11832     END-IF.
 11833
 11834     IF REPORTL GREATER ZERO
 11835         MOVE REPORTI            TO DATE-WORK
 11836         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11837         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11838         MOVE '4'                TO DC-OPTION-CODE
 11839         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11840         IF DATE-CONVERSION-ERROR
 11841             MOVE AL-UABON       TO REPORTA
 11842             MOVE -1             TO REPORTL
 11843             MOVE ER-0223        TO EMI-ERROR
 11844             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11845         ELSE
 11846             MOVE AL-UANON       TO REPORTA
 11847             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 11848             MOVE DC-BIN-DATE-1  TO WS-REPORT
 11849             IF WS-REPORT GREATER THAN WS-TODAY-DT
 11850                 MOVE ER-0512     TO EMI-ERROR
 11851                 MOVE -1          TO REPORTL
 11852                 MOVE AL-UABON    TO REPORTA
 11853                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11854             ELSE
 11855*                NEXT SENTENCE
 11856                 CONTINUE
 11857             END-IF
 11858         END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 227
* EL130.cbl
 11859     ELSE
 11860         MOVE ER-0517         TO EMI-ERROR
 11861         MOVE -1              TO REPORTL
 11862         MOVE AL-UABON        TO REPORTA
 11863         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11864     END-IF.
 11865
 11866     IF WS-REPORT NOT = LOW-VALUES
 11867         IF WS-INCUR GREATER THAN WS-REPORT
 11868             MOVE AL-UABON       TO REPORTA
 11869             MOVE -1             TO REPORTL
 11870             MOVE ER-0509        TO EMI-ERROR
 11871             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11872         END-IF
 11873     END-IF.
 11874
 11875     IF ESTENDL GREATER ZERO
 11876         MOVE ESTENDI            TO DATE-WORK
 11877         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11878         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11879         MOVE '4'                TO DC-OPTION-CODE
 11880         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11881         IF DATE-CONVERSION-ERROR
 11882             MOVE AL-UABON       TO ESTENDA
 11883             MOVE -1             TO ESTENDL
 11884             MOVE ER-0224        TO EMI-ERROR
 11885             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11886         ELSE
 11887             MOVE AL-UANON       TO ESTENDA
 11888             MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 11889             MOVE DC-BIN-DATE-1  TO WS-ESTEND
 11890             IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 11891                MOVE AL-UABON    TO ESTENDA
 11892                MOVE -1          TO ESTENDL
 11893                MOVE ER-0544     TO EMI-ERROR
 11894                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11895             END-IF
 11896         END-IF
 11897     END-IF.
 11898
 11899     IF WS-ESTEND NOT = LOW-VALUES
 11900         IF WS-INCUR GREATER THAN WS-ESTEND
 11901             MOVE AL-UABON       TO ESTENDA
 11902             MOVE -1             TO ESTENDL
 11903             MOVE ER-0510        TO EMI-ERROR
 11904             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11905         END-IF
 11906     END-IF.
 11907
 11908     IF PRTOPTL GREATER ZERO
 11909         IF PRTOPTI NOT = 'N' AND 'L'
 11910             MOVE AL-UABON       TO PRTOPTA
 11911             MOVE -1             TO PRTOPTL
 11912             MOVE ER-0334        TO EMI-ERROR
 11913             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11914         END-IF
 11915     END-IF.
 11916
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 228
* EL130.cbl
 11917     IF MANRSVL GREATER ZERO
 11918
 11919* EXEC CICS BIF DEEDIT
 11920*            FIELD   (MANRSVI)
 11921*            LENGTH  (9)
 11922*        END-EXEC
 11923     MOVE 9
 11924       TO DFHEIV11
 11925*    MOVE '@"L                   #   #00010929' TO DFHEIV0
 11926     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 11927     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11928     MOVE X'2020233030303130393239' TO DFHEIV0(25:11)
 11929     CALL 'kxdfhei1' USING DFHEIV0,
 11930           MANRSVI,
 11931           DFHEIV11
 11932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11933         IF MANRSVI NOT NUMERIC
 11934             MOVE AL-UNBON       TO MANRSVA
 11935             MOVE -1             TO MANRSVL
 11936             MOVE ER-0489        TO EMI-ERROR
 11937             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11938         ELSE
 11939             MOVE AL-UNNON       TO MANRSVA
 11940             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 11941         END-IF
 11942     END-IF.
 11943
 11944     MOVE SPACES                 TO ELCNTL-KEY.
 11945
 11946     IF CONTROL-IS-ACTUAL-CARRIER
 11947         MOVE PI-CARRIER         TO CNTL-CARRIER
 11948     ELSE
 11949         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 11950     END-IF.
 11951
 11952     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11953     MOVE '6'                    TO CNTL-REC-TYPE.
 11954     MOVE +0                     TO CNTL-SEQ-NO.
 11955
 11956
 11957
 11958* EXEC CICS HANDLE CONDITION
 11959*        NOTFND   (3100-CARRIER-NOT-FOUND)
 11960*    END-EXEC.
 11961*    MOVE '"$I                   ! ? #00010957' TO DFHEIV0
 11962     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11963     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11964     MOVE X'3F20233030303130393537' TO DFHEIV0(25:11)
 11965     CALL 'kxdfhei1' USING DFHEIV0
 11966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11967
 11968
 11969     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 11970
 11971     IF NOT CF-MANUAL-RESERVES-USED AND
 11972           WS-MANRSV GREATER ZERO
 11973         MOVE ER-0518             TO EMI-ERROR
 11974         MOVE -1                  TO MANRSVL
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 229
* EL130.cbl
 11975         MOVE AL-UNBON            TO MANRSVA
 11976         MOVE ZEROS               TO WS-MANRSV
 11977         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11978     END-IF.
 11979
 11980     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 11981     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
 11982
 11983     IF SUPVL GREATER ZERO
 11984         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 11985             MOVE -1             TO SUPVL
 11986             MOVE AL-UABON       TO SUPVA
 11987             MOVE ER-0230        TO EMI-ERROR
 11988             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11989         ELSE
 11990             MOVE AL-UANON       TO SUPVA
 11991         END-IF
 11992     END-IF.
 11993
 11994     IF PROCCDL = ZERO
 11995        GO TO 6050-CONTINUE-EDITS
 11996     END-IF.
 11997
 11998     MOVE SPACES                 TO ELCNTL-KEY.
 11999     MOVE PROCCDI                TO CNTL-ACCESS.
 12000
 12001     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12002     MOVE '2'                    TO CNTL-REC-TYPE.
 12003     MOVE +0                     TO CNTL-SEQ-NO.
 12004
 12005
 12006
 12007* EXEC CICS HANDLE CONDITION
 12008*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 12009*    END-EXEC.
 12010*    MOVE '"$I                   ! @ #00010998' TO DFHEIV0
 12011     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12012     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12013     MOVE X'4020233030303130393938' TO DFHEIV0(25:11)
 12014     CALL 'kxdfhei1' USING DFHEIV0
 12015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12016
 12017
 12018     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 12019
 12020     GO TO 6050-CONTINUE-EDITS.
 12021
 12022 6040-NO-PROCESSOR-RECORD.
 12023     MOVE ER-0019                TO EMI-ERROR.
 12024     MOVE -1                     TO PROCCDL.
 12025     MOVE AL-UABON               TO PROCCDA.
 12026     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12027
 12028 6050-CONTINUE-EDITS.
 12029     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 12030           GO TO 6070-CONTINUE-EDITS
 12031     END-IF.
 12032
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 230
* EL130.cbl
 12033     MOVE BENECDI                TO BENE-CODE.
 12034     MOVE 'B'                    TO BENE-RCD-TYPE.
 12035     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 12036
 12037
 12038
 12039* EXEC CICS HANDLE CONDITION
 12040*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 12041*    END-EXEC.
 12042*    MOVE '"$I                   ! A #00011022' TO DFHEIV0
 12043     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12044     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12045     MOVE X'4120233030303131303232' TO DFHEIV0(25:11)
 12046     CALL 'kxdfhei1' USING DFHEIV0
 12047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12048
 12049
 12050
 12051* EXEC CICS READ
 12052*         DATASET   (ELBENE-DSID)
 12053*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 12054*         RIDFLD    (ELBENE-KEY)
 12055*    END-EXEC.
 12056*    MOVE '&"S        E          (   #00011026' TO DFHEIV0
 12057     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12058     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12059     MOVE X'2020233030303131303236' TO DFHEIV0(25:11)
 12060     CALL 'kxdfhei1' USING DFHEIV0,
 12061           ELBENE-DSID,
 12062           DFHEIV20,
 12063           DFHEIV99,
 12064           ELBENE-KEY,
 12065           DFHEIV99,
 12066           DFHEIV99,
 12067           DFHEIV99
 12068     SET ADDRESS OF BENEFICIARY-MASTER TO
 12069         DFHEIV20
 12070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12071
 12072
 12073     GO TO 6070-CONTINUE-EDITS.
 12074
 12075 6060-NO-BENEFICIARY-RECORD.
 12076     MOVE ER-0565                TO EMI-ERROR.
 12077     MOVE -1                     TO BENECDL.
 12078     MOVE AL-UABON               TO BENECDA.
 12079     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12080
 12081
 12082 6070-CONTINUE-EDITS.
 12083     IF CERTMTL GREATER ZERO
 12084         IF CERTMTI NOT = 'A' AND 'S'
 12085             MOVE -1             TO CERTMTL
 12086             MOVE AL-UABON       TO CERTMTA
 12087             MOVE ER-0267        TO EMI-ERROR
 12088             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12089         ELSE
 12090             MOVE AL-UANON       TO CERTMTA
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 231
* EL130.cbl
 12091         END-IF
 12092     ELSE
 12093         GO TO 6000-EXIT
 12094     END-IF.
 12095
 12096     IF EFFDTL GREATER ZERO
 12097         MOVE EFFDTI             TO DATE-WORK
 12098         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12099         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12100         MOVE '4'                TO DC-OPTION-CODE
 12101         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12102         IF DATE-CONVERSION-ERROR
 12103             MOVE AL-UABON       TO EFFDTA
 12104             MOVE -1             TO EFFDTL
 12105             MOVE ER-0231        TO EMI-ERROR
 12106             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12107         ELSE
 12108             MOVE AL-UANON       TO EFFDTA
 12109             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 12110             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 12111         END-IF
 12112     ELSE
 12113         MOVE ER-0231            TO EMI-ERROR
 12114         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12115         MOVE -1                 TO EFFDTL
 12116         MOVE AL-UABON           TO EFFDTA
 12117     END-IF.
 12118
 12119     IF ACCOUNTL = ZERO
 12120         MOVE ER-0232            TO EMI-ERROR
 12121         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12122         MOVE AL-UABON           TO ACCOUNTA
 12123         MOVE -1                 TO ACCOUNTL
 12124     ELSE
 12125         MOVE AL-UANON           TO ACCOUNTA
 12126     END-IF.
 12127
 12128     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 12129        (STATEL = ZERO)
 12130         MOVE ER-0233        TO EMI-ERROR
 12131         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12132         MOVE AL-UABON       TO STATEA
 12133         MOVE -1             TO STATEL
 12134     ELSE
 12135         MOVE AL-UANON       TO STATEA
 12136     END-IF.
 12137
 12138     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 12139        (CRTCARRL = ZERO)
 12140         MOVE ER-0234        TO EMI-ERROR
 12141         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12142         MOVE AL-UABON       TO CRTCARRA
 12143         MOVE -1             TO CRTCARRL
 12144     ELSE
 12145         MOVE AL-UANON       TO CRTCARRA
 12146     END-IF.
 12147
 12148     IF PI-CERT-ACCESS-CONTROL = '1' AND
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 232
* EL130.cbl
 12149        GROUPL = ZERO
 12150         MOVE ER-0235            TO EMI-ERROR
 12151         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12152         MOVE AL-UABON           TO GROUPA
 12153         MOVE -1                 TO GROUPL
 12154     ELSE
 12155         MOVE AL-UANON           TO GROUPA
 12156     END-IF.
 12157
 12158     IF CRTLNMEL = ZERO
 12159         IF LSTNMEI = SPACES OR LOW-VALUES
 12160             MOVE ER-0236            TO  EMI-ERROR
 12161             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12162             MOVE AL-UABON           TO  CRTLNMEA
 12163             MOVE -1                 TO  CRTLNMEL
 12164         ELSE
 12165             MOVE LSTNMEI            TO  CRTLNMEI
 12166             MOVE AL-UANON           TO  CRTLNMEA
 12167         END-IF
 12168     ELSE
 12169         MOVE AL-UANON               TO  CRTLNMEA
 12170     END-IF.
 12171
 12172     IF CRTFNMEL = ZERO
 12173         IF FSTNMEI = SPACES OR LOW-VALUES
 12174*            NEXT SENTENCE
 12175             CONTINUE
 12176         ELSE
 12177             MOVE FSTNMEI            TO  CRTFNMEI
 12178             MOVE AL-UANON           TO  CRTFNMEA
 12179         END-IF
 12180     END-IF.
 12181
 12182     IF CRTINITL = ZERO
 12183         IF INITI = SPACES OR LOW-VALUES
 12184*            NEXT SENTENCE
 12185             CONTINUE
 12186         ELSE
 12187             MOVE INITI              TO  CRTINITI
 12188             MOVE AL-UANON           TO  CRTINITA
 12189         END-IF
 12190     END-IF.
 12191
 12192 6000-EXIT.
 12193     EXIT.
 12194
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 233
* EL130.cbl
 12196 6200-EDIT-CERT-DATA.
 12197     IF ISSAGEL GREATER ZERO
 12198         IF ISSAGEI NOT NUMERIC
 12199             MOVE ER-0237        TO EMI-ERROR
 12200             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12201             MOVE -1             TO ISSAGEL
 12202             MOVE AL-UNBON       TO ISSAGEA
 12203         ELSE
 12204             MOVE AL-UNNON       TO ISSAGEA
 12205         END-IF
 12206     END-IF.
 12207
 12208     IF JNTAGEL GREATER ZERO
 12209         IF JNTAGEI NOT NUMERIC
 12210             MOVE ER-0238        TO EMI-ERROR
 12211             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12212             MOVE -1             TO JNTAGEL
 12213             MOVE AL-UNBON       TO JNTAGEA
 12214         ELSE
 12215             MOVE AL-UNNON       TO JNTAGEA
 12216         END-IF
 12217     END-IF.
 12218
 12219     IF LCVCDL GREATER ZERO
 12220         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 12221         IF INVALID-BENEFIT-CODE
 12222             MOVE ER-7635        TO EMI-ERROR
 12223             MOVE -1             TO LCVCDL
 12224             MOVE AL-UABON       TO LCVCDA
 12225             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12226         ELSE
 12227             MOVE LCVCDI         TO WS-BEN-HOLD
 12228             MOVE '4'            TO WS-REC-TYPE
 12229             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 12230             IF WS-BEN-ALPHA-HOLD = SPACES
 12231                MOVE ER-7635     TO EMI-ERROR
 12232                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12233                MOVE -1          TO LCVCDL
 12234                MOVE AL-UABON    TO LCVCDA
 12235             ELSE
 12236                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 12237                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 12238                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 12239                MOVE AL-UANON           TO LCVCDA
 12240             END-IF
 12241         END-IF
 12242     END-IF.
 12243
 12244     IF ACVCDL GREATER ZERO
 12245         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 12246         IF INVALID-BENEFIT-CODE
 12247             MOVE ER-7635        TO EMI-ERROR
 12248             MOVE -1             TO ACVCDL
 12249             MOVE AL-UABON       TO ACVCDA
 12250             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12251         ELSE
 12252             MOVE ACVCDI         TO WS-BEN-HOLD
 12253             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 234
* EL130.cbl
 12254             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 12255             IF WS-BEN-ALPHA-HOLD = SPACES
 12256                MOVE ER-7635     TO EMI-ERROR
 12257                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12258                MOVE -1          TO ACVCDL
 12259                MOVE AL-UABON    TO ACVCDA
 12260             ELSE
 12261                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 12262                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 12263                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 12264                MOVE AL-UANON           TO ACVCDA
 12265             END-IF
 12266         END-IF
 12267     END-IF.
 12268
 12269     IF LCVOTRML GREATER ZERO
 12270         IF LCVOTRMI NOT NUMERIC
 12271             MOVE ER-7636        TO EMI-ERROR
 12272             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12273             MOVE -1             TO LCVOTRML
 12274             MOVE AL-UNBON       TO LCVOTRMA
 12275         ELSE
 12276             MOVE AL-UNNON       TO LCVOTRMA
 12277         END-IF
 12278     END-IF.
 12279
 12280     IF ACVOTRML GREATER ZERO
 12281         IF ACVOTRMI NOT NUMERIC
 12282             MOVE ER-7636        TO EMI-ERROR
 12283             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12284             MOVE -1             TO ACVOTRML
 12285             MOVE AL-UNBON       TO ACVOTRMA
 12286         ELSE
 12287             MOVE AL-UNNON       TO ACVOTRMA
 12288         END-IF
 12289     END-IF.
 12290
 12291     IF LCVRATEL GREATER ZERO
 12292
 12293* EXEC CICS BIF DEEDIT
 12294*            FIELD    (LCVRATEI)
 12295*            LENGTH   (06)
 12296*        END-EXEC
 12297     MOVE 06
 12298       TO DFHEIV11
 12299*    MOVE '@"L                   #   #00011251' TO DFHEIV0
 12300     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12301     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12302     MOVE X'2020233030303131323531' TO DFHEIV0(25:11)
 12303     CALL 'kxdfhei1' USING DFHEIV0,
 12304           LCVRATEI,
 12305           DFHEIV11
 12306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12307         IF LCVRATEI NOT NUMERIC
 12308             MOVE AL-UNBON       TO LCVRATEA
 12309             MOVE -1             TO LCVRATEL
 12310             MOVE ER-2280        TO EMI-ERROR
 12311             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 235
* EL130.cbl
 12312         ELSE
 12313             MOVE AL-UNNON       TO LCVRATEA
 12314             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 12315         END-IF
 12316     END-IF.
 12317
 12318     IF ACVRATEL GREATER ZERO
 12319
 12320* EXEC CICS BIF DEEDIT
 12321*            FIELD    (ACVRATEI)
 12322*            LENGTH   (06)
 12323*        END-EXEC
 12324     MOVE 06
 12325       TO DFHEIV11
 12326*    MOVE '@"L                   #   #00011267' TO DFHEIV0
 12327     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12328     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12329     MOVE X'2020233030303131323637' TO DFHEIV0(25:11)
 12330     CALL 'kxdfhei1' USING DFHEIV0,
 12331           ACVRATEI,
 12332           DFHEIV11
 12333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12334         IF ACVRATEI NOT NUMERIC
 12335             MOVE AL-UNBON       TO ACVRATEA
 12336             MOVE -1             TO ACVRATEL
 12337             MOVE ER-2280        TO EMI-ERROR
 12338             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12339         ELSE
 12340             MOVE AL-UNNON       TO ACVRATEA
 12341             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 12342         END-IF
 12343     END-IF.
 12344
 12345     IF LCVBENEL GREATER ZERO
 12346
 12347* EXEC CICS BIF DEEDIT
 12348*            FIELD    (LCVBENEI)
 12349*            LENGTH   (11)
 12350*        END-EXEC
 12351     MOVE 11
 12352       TO DFHEIV11
 12353*    MOVE '@"L                   #   #00011283' TO DFHEIV0
 12354     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12355     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12356     MOVE X'2020233030303131323833' TO DFHEIV0(25:11)
 12357     CALL 'kxdfhei1' USING DFHEIV0,
 12358           LCVBENEI,
 12359           DFHEIV11
 12360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12361         IF LCVBENEI NOT NUMERIC
 12362             MOVE AL-UNBON       TO LCVBENEA
 12363             MOVE -1             TO LCVBENEL
 12364             MOVE ER-7637        TO EMI-ERROR
 12365             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12366         ELSE
 12367             MOVE AL-UNNON       TO LCVBENEA
 12368             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 12369         END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 236
* EL130.cbl
 12370     END-IF.
 12371
 12372     IF ACVBENEL GREATER ZERO
 12373
 12374* EXEC CICS BIF DEEDIT
 12375*            FIELD    (ACVBENEI)
 12376*            LENGTH   (11)
 12377*        END-EXEC
 12378     MOVE 11
 12379       TO DFHEIV11
 12380*    MOVE '@"L                   #   #00011299' TO DFHEIV0
 12381     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12382     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12383     MOVE X'2020233030303131323939' TO DFHEIV0(25:11)
 12384     CALL 'kxdfhei1' USING DFHEIV0,
 12385           ACVBENEI,
 12386           DFHEIV11
 12387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12388         IF ACVBENEI NOT NUMERIC
 12389             MOVE AL-UNBON       TO ACVBENEA
 12390             MOVE -1             TO ACVBENEL
 12391             MOVE ER-7637        TO EMI-ERROR
 12392             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12393         ELSE
 12394             MOVE AL-UNNON       TO ACVBENEA
 12395             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 12396         END-IF
 12397     END-IF.
 12398
 12399     IF LCVCNDTL GREATER ZERO
 12400         IF LCVCNDTI NOT = SPACES
 12401             MOVE LCVCNDTI        TO DATE-WORK
 12402             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12403             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12404             MOVE '4'             TO DC-OPTION-CODE
 12405             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12406             IF DATE-CONVERSION-ERROR
 12407                 MOVE AL-UABON    TO LCVCNDTA
 12408                 MOVE -1          TO LCVCNDTL
 12409                 MOVE ER-7638     TO EMI-ERROR
 12410                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12411             ELSE
 12412                 MOVE AL-UANON    TO LCVCNDTA
 12413                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 12414                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 12415             END-IF
 12416         END-IF
 12417     END-IF.
 12418
 12419     IF ACVCNDTL GREATER ZERO
 12420         IF ACVCNDTI NOT = SPACES
 12421             MOVE ACVCNDTI        TO DATE-WORK
 12422             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12423             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12424             MOVE '4'             TO DC-OPTION-CODE
 12425             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12426             IF DATE-CONVERSION-ERROR
 12427                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 237
* EL130.cbl
 12428                 MOVE -1          TO ACVCNDTL
 12429                 MOVE ER-7638     TO EMI-ERROR
 12430                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12431             ELSE
 12432                 MOVE AL-UANON    TO ACVCNDTA
 12433                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 12434                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 12435             END-IF
 12436         END-IF
 12437     END-IF.
 12438
 12439     IF ADDONDTL GREATER ZERO
 12440         MOVE ADDONDTI        TO DATE-WORK
 12441         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12442         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12443         MOVE '4'             TO DC-OPTION-CODE
 12444         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12445         IF DATE-CONVERSION-ERROR
 12446             MOVE AL-UABON    TO ADDONDTA
 12447             MOVE -1          TO ADDONDTL
 12448             MOVE ER-7651     TO EMI-ERROR
 12449             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12450         ELSE
 12451             MOVE AL-UANON    TO ADDONDTA
 12452             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 12453             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 12454         END-IF
 12455     END-IF.
 12456
 12457     IF APRL GREATER ZERO
 12458
 12459* EXEC CICS BIF DEEDIT
 12460*            FIELD    (APRI)
 12461*            LENGTH   (8)
 12462*        END-EXEC
 12463     MOVE 8
 12464       TO DFHEIV11
 12465*    MOVE '@"L                   #   #00011373' TO DFHEIV0
 12466     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12467     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12468     MOVE X'2020233030303131333733' TO DFHEIV0(25:11)
 12469     CALL 'kxdfhei1' USING DFHEIV0,
 12470           APRI,
 12471           DFHEIV11
 12472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12473         IF APRI NOT NUMERIC
 12474             MOVE AL-UNBON       TO APRA
 12475             MOVE -1             TO APRL
 12476             MOVE ER-0248        TO EMI-ERROR
 12477             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12478         ELSE
 12479             MOVE AL-UNNON       TO APRA
 12480             MOVE APRI           TO WS-APR APRO
 12481         END-IF
 12482     END-IF.
 12483
 12484     IF PMTFREQL GREATER ZERO
 12485
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 238
* EL130.cbl
 12486* EXEC CICS BIF DEEDIT
 12487*            FIELD   (PMTFREQI)
 12488*            LENGTH  (2)
 12489*        END-EXEC
 12490     MOVE 2
 12491       TO DFHEIV11
 12492*    MOVE '@"L                   #   #00011389' TO DFHEIV0
 12493     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12494     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12495     MOVE X'2020233030303131333839' TO DFHEIV0(25:11)
 12496     CALL 'kxdfhei1' USING DFHEIV0,
 12497           PMTFREQI,
 12498           DFHEIV11
 12499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12500         IF PMTFREQI NOT NUMERIC
 12501             MOVE -1             TO PMTFREQL
 12502             MOVE AL-UNBON       TO PMTFREQA
 12503             MOVE ER-0258        TO EMI-ERROR
 12504             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12505         ELSE
 12506             MOVE AL-UNNON       TO PMTFREQA
 12507             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 12508         END-IF
 12509     END-IF.
 12510
 12511     IF INDGRPL GREATER ZERO
 12512         IF INDGRPI = 'I' OR 'G'
 12513             MOVE AL-UANON       TO INDGRPA
 12514         ELSE
 12515             MOVE -1 TO INDGRPL
 12516             MOVE AL-UABON       TO INDGRPA
 12517             MOVE ER-0260        TO EMI-ERROR
 12518             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12519         END-IF
 12520     END-IF.
 12521
 12522     IF LOANBALL GREATER ZERO
 12523         MOVE LOANBALI           TO DEEDIT-FIELD
 12524
 12525* EXEC CICS BIF DEEDIT
 12526*            FIELD   (DEEDIT-FIELD)
 12527*            LENGTH  (12)
 12528*        END-EXEC
 12529     MOVE 12
 12530       TO DFHEIV11
 12531*    MOVE '@"L                   #   #00011417' TO DFHEIV0
 12532     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12533     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12534     MOVE X'2020233030303131343137' TO DFHEIV0(25:11)
 12535     CALL 'kxdfhei1' USING DFHEIV0,
 12536           DEEDIT-FIELD,
 12537           DFHEIV11
 12538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12539         IF DEEDIT-FIELD NOT NUMERIC
 12540             MOVE AL-UNBON       TO LOANBALA
 12541             MOVE -1             TO LOANBALL
 12542             MOVE ER-0247        TO EMI-ERROR
 12543             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 239
* EL130.cbl
 12544         ELSE
 12545             MOVE AL-UNNON       TO LOANBALA
 12546             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 12547         END-IF
 12548     END-IF.
 12549
 12550     IF PREMTYPL GREATER ZERO
 12551         IF (PREMTYPI = '1' OR '2' OR '3')
 12552             MOVE AL-UANON       TO PREMTYPA
 12553         ELSE
 12554             MOVE -1             TO PREMTYPL
 12555             MOVE AL-UABON       TO PREMTYPA
 12556             MOVE ER-0227        TO EMI-ERROR
 12557             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12558         END-IF
 12559     END-IF.
 12560
 12561     IF REINCDL GREATER ZERO
 12562         MOVE LOW-VALUES         TO  ERREIN-KEY
 12563         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 12564         MOVE REINCDI            TO  REIN-CODE-1
 12565                                     REIN-CODE-2
 12566                                     REIN-CODE-3
 12567         MOVE 'A'                TO  REIN-TYPE
 12568         PERFORM 7992-READ-REIN THRU 7992-EXIT
 12569         IF REIN-REC-NOT-FOUND
 12570             MOVE ER-0266        TO  EMI-ERROR
 12571             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12572             MOVE -1             TO  REINCDL
 12573             MOVE AL-UABON       TO  REINCDA
 12574         ELSE
 12575             MOVE AL-UANON       TO  REINCDA
 12576         END-IF
 12577     END-IF.
 12578
 12579     IF CERTMTI NOT = 'A'
 12580        GO TO 6200-EXIT
 12581     END-IF.
 12582
 12583     IF PREMTYPI = '1'
 12584         IF LCVCDL GREATER ZERO
 12585             IF WS-LF-SPECIAL-CALC-CD = 'O'
 12586                 MOVE ER-0841        TO  EMI-ERROR
 12587                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12588                 MOVE -1             TO  PREMTYPL
 12589                 MOVE AL-UABON       TO  PREMTYPA
 12590             END-IF
 12591         END-IF
 12592     END-IF.
 12593
 12594     IF PREMTYPI = '1'
 12595         IF ACVCDL GREATER ZERO
 12596             IF WS-AH-SPECIAL-CALC-CD = 'O'
 12597                 MOVE ER-0841        TO  EMI-ERROR
 12598                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12599                 MOVE -1             TO  PREMTYPL
 12600                 MOVE AL-UABON       TO  PREMTYPA
 12601             END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 240
* EL130.cbl
 12602         END-IF
 12603     END-IF.
 12604
 12605     IF PREMTYPI = '2'
 12606         IF LCVCDL GREATER ZERO
 12607             IF (PI-COMPANY-ID = 'HAN') AND
 12608                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 12609                        OR
 12610                 WS-LF-SPECIAL-CALC-CD = 'O'
 12611*                NEXT SENTENCE
 12612                 CONTINUE
 12613             ELSE
 12614                 MOVE ER-0840        TO  EMI-ERROR
 12615                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12616                 MOVE -1             TO  PREMTYPL
 12617                 MOVE AL-UABON       TO  PREMTYPA
 12618             END-IF
 12619         END-IF
 12620     END-IF.
 12621
 12622     IF PREMTYPI = '2'
 12623         IF ACVCDL GREATER ZERO
 12624             IF (PI-COMPANY-ID = 'HAN')  AND
 12625                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 12626                        OR
 12627                 WS-AH-SPECIAL-CALC-CD = 'O'
 12628*                NEXT SENTENCE
 12629                 CONTINUE
 12630             ELSE
 12631                 MOVE ER-0840        TO  EMI-ERROR
 12632                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12633                 MOVE -1             TO  PREMTYPL
 12634                 MOVE AL-UABON       TO  PREMTYPA
 12635             END-IF
 12636         END-IF
 12637     END-IF.
 12638
 12639     IF LCVCDL = ZEROS
 12640        GO TO 6200-EXIT
 12641     END-IF.
 12642
 12643     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 12644         IF PMTFREQI NOT = ZEROS
 12645             MOVE ER-0428        TO EMI-ERROR
 12646             MOVE -1             TO PMTFREQL
 12647             MOVE AL-UNBON       TO PMTFREQA
 12648             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12649             GO TO 6200-CHECK-APR
 12650         END-IF
 12651     END-IF.
 12652
 12653     IF PMTFREQL = ZEROS AND TEX-REG
 12654         MOVE ER-0429            TO EMI-ERROR
 12655         MOVE -1                 TO PMTFREQL
 12656         MOVE AL-UNBON           TO PMTFREQA
 12657         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12658         GO TO 6200-CHECK-APR
 12659     END-IF.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 241
* EL130.cbl
 12660
 12661     IF LCVOTRMI NOT NUMERIC
 12662         GO TO 6200-CHECK-APR
 12663     END-IF.
 12664
 12665     IF WS-PMTFREQ NOT = ZERO
 12666         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 12667         GIVING DIVIDE-QUOT
 12668         REMAINDER DIVIDE-REM
 12669         IF DIVIDE-REM GREATER ZERO
 12670             MOVE ER-0430            TO EMI-ERROR
 12671             MOVE -1                 TO PMTFREQL
 12672             MOVE AL-UNBON           TO PMTFREQA
 12673             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12674         END-IF
 12675     END-IF.
 12676
 12677 6200-CHECK-APR.
 12678     IF NET-PAY AND APRL = ZEROS
 12679        MOVE ER-0257             TO EMI-ERROR
 12680        MOVE -1                  TO APRL
 12681        MOVE AL-UABON            TO APRA
 12682        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12683     END-IF.
 12684
 12685 6200-EXIT.
 12686     EXIT.
 12687
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 242
* EL130.cbl
 12689 6300-REQUIRED-CERT-EDIT.
 12690
 12691     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12692        GO TO 6300-REQUIRED-AH-EDIT
 12693     END-IF
 12694
 12695     IF LCVCDL = ZERO
 12696        MOVE ER-7639             TO EMI-ERROR
 12697        MOVE -1                  TO LCVCDL
 12698        MOVE AL-UABON            TO LCVCDA
 12699        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12700     END-IF.
 12701
 12702     IF LCVOTRML = ZERO
 12703        MOVE ER-7670             TO EMI-ERROR
 12704        MOVE -1                  TO LCVOTRML
 12705        MOVE AL-UNBON            TO LCVOTRMA
 12706        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12707     END-IF.
 12708
 12709     IF LCVBENEL = ZERO
 12710        MOVE ER-7671             TO EMI-ERROR
 12711        MOVE -1                  TO LCVBENEL
 12712        MOVE AL-UNBON            TO LCVBENEA
 12713        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12714     END-IF.
 12715
 12716     GO TO 6399-EXIT.
 12717
 12718 6300-REQUIRED-AH-EDIT.
 12719
 12720     IF ACVCDL = ZERO
 12721        MOVE ER-7639             TO EMI-ERROR
 12722        MOVE -1                  TO ACVCDL
 12723        MOVE AL-UABON            TO ACVCDA
 12724        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12725     END-IF.
 12726
 12727     IF ACVOTRML = ZERO
 12728         MOVE ER-7670             TO EMI-ERROR
 12729         MOVE -1                  TO ACVOTRML
 12730         MOVE AL-UNBON            TO ACVOTRMA
 12731         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12732     END-IF.
 12733
 12734     IF ACVBENEL = ZERO
 12735        MOVE ER-7671             TO EMI-ERROR
 12736        MOVE -1                  TO ACVBENEL
 12737        MOVE AL-UNBON            TO ACVBENEA
 12738        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12739     END-IF.
 12740
 12741 6399-EXIT.
 12742      EXIT.
 12743
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 243
* EL130.cbl
 12745 6400-TEST-CLAIM-REASONABILITY.
 12746
 12747     IF WS-INCUR = LOW-VALUES
 12748        GO TO 6499-EXIT
 12749     END-IF.
 12750
 12751     IF WS-EFFDT NOT = LOW-VALUES
 12752         IF WS-INCUR LESS WS-EFFDT
 12753             MOVE ER-0458          TO EMI-ERROR
 12754             MOVE -1               TO INCURL
 12755             MOVE AL-UABON         TO INCURA
 12756             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12757         END-IF
 12758     END-IF.
 12759
 12760     IF CERTMTI = 'A'
 12761        GO TO 6460-TEST-NEW-CERT
 12762     END-IF.
 12763
 12764     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12765     MOVE CRTCARRI               TO CERT-CARRIER.
 12766     MOVE GROUPI                 TO CERT-GROUPING.
 12767     MOVE STATEI                 TO CERT-STATE.
 12768     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 12769     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 12770     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 12771
 12772
 12773
 12774* EXEC CICS HANDLE CONDITION
 12775*         DUPKEY   (6499-EXIT)
 12776*         NOTFND   (6499-EXIT)
 12777*    END-EXEC.
 12778*    MOVE '"$$I                  ! B #00011655' TO DFHEIV0
 12779     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 12780     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12781     MOVE X'4220233030303131363535' TO DFHEIV0(25:11)
 12782     CALL 'kxdfhei1' USING DFHEIV0
 12783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12784
 12785
 12786     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 12787
 12788     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 12789        'I' OR 'G')
 12790        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 12791     ELSE
 12792        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 12793     END-IF.
 12794
 12795     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12796     MOVE '6'                    TO DC-OPTION-CODE.
 12797     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12798
 12799     IF WS-INCUR GREATER THAN DC-BIN-DATE-2
 12800        MOVE ER-0519             TO EMI-ERROR
 12801        MOVE -1                  TO INCURL
 12802        MOVE AL-UABON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 244
* EL130.cbl
 12803        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12804     END-IF.
 12805
 12806     IF CLMCARRI NOT = CRTCARRI
 12807        MOVE ER-0562             TO EMI-ERROR
 12808        MOVE AL-UABON            TO CLMCARRA
 12809        MOVE -1                  TO CLMCARRL
 12810        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12811     END-IF.
 12812
 12813     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 12814        CM-AH-BENEFIT-CD = '00')
 12815                  OR
 12816        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 12817        CM-LF-BENEFIT-CD = '00')
 12818         MOVE ER-0521         TO EMI-ERROR
 12819         MOVE AL-UABON        TO CLMTYPEA
 12820         MOVE -1              TO CLMTYPEL
 12821         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12822     END-IF.
 12823*    IF CLMTYPEI = 'I' AND
 12824*       CM-AH-CRITICAL-PERIOD = +0
 12825*        MOVE ER-0521         TO EMI-ERROR
 12826*        MOVE AL-UABON        TO CLMTYPEA
 12827*        MOVE -1              TO CLMTYPEL
 12828*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12829*    END-IF
 12830
 12831*    IF PI-COMPANY-ID = 'CRI'
 12832*        IF MAINTI = 'A'
 12833*            IF CERT-PEND-ISSUE-ERROR  OR
 12834*               CERT-PEND-ISSUE-RETURNED
 12835*                MOVE -1                 TO CERTNOL
 12836*                MOVE AL-UABON           TO CERTNOA
 12837*                MOVE ER-7640            TO EMI-ERROR
 12838*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12839*            END-IF
 12840*        END-IF
 12841*    END-IF.
 12842
 12843     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 12844         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 12845         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 12846             GO TO 6450-DATE-ERROR
 12847         END-IF
 12848     END-IF.
 12849
 12850     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 12851         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 12852         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 12853             GO TO 6450-DATE-ERROR
 12854         END-IF
 12855     END-IF.
 12856
 12857     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 12858         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 12859             GO TO 6450-DATE-ERROR
 12860         END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 245
* EL130.cbl
 12861     END-IF.
 12862
 12863     GO TO 6499-EXIT.
 12864
 12865 6450-DATE-ERROR.
 12866     MOVE ER-0520                TO EMI-ERROR.
 12867     MOVE -1                     TO INCURL.
 12868     MOVE AL-UABON               TO INCURA.
 12869     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12870
 12871*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 12872*       (EMI-SEVERITY-SAVE = 'X')
 12873*        ADD 1                TO EMI-FORCABLE-CTR
 12874*        SUBTRACT 1 FROM EMI-FATAL-CTR
 12875*    END-IF.
 12876
 12877     GO TO 6499-EXIT.
 12878
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 246
* EL130.cbl
 12880 6460-TEST-NEW-CERT.
 12881
 12882     IF NOT EMI-NO-ERRORS
 12883        GO TO 6499-EXIT
 12884     END-IF.
 12885
 12886     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 12887
 12888     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 12889         ACVOTRML GREATER ZERO)
 12890        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 12891     END-IF.
 12892
 12893     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 12894         LCVOTRML GREATER ZERO
 12895        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 12896     END-IF.
 12897
 12898     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 12899
 12900*    IF PI-COMPANY-ID = 'HAN'
 12901*        IF ADDONDTL GREATER ZERO
 12902*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 12903*            IF CLMTYPEI = 'A'
 12904*                IF ACVOTRMI NOT = ZEROS
 12905*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 12906*                ELSE
 12907*                    NEXT SENTENCE
 12908*                    CONTINUE
 12909*                END-IF
 12910*            ELSE
 12911*                IF LCVOTRMI NOT = ZEROS
 12912*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 12913*                END-IF
 12914*            END-IF
 12915*        END-IF
 12916*    END-IF.
 12917
 12918     MOVE '6'                    TO DC-OPTION-CODE.
 12919     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12920
 12921     IF NO-CONVERSION-ERROR
 12922         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 12923     END-IF.
 12924
 12925     IF WS-INCUR GREATER THAN WS-EXPIRE
 12926        MOVE ER-0519             TO EMI-ERROR
 12927        MOVE -1                  TO INCURL
 12928        MOVE AL-UABON            TO INCURA
 12929        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12930     END-IF.
 12931
 12932     IF CLMCARRI NOT = CRTCARRI
 12933        MOVE ER-0562             TO EMI-ERROR
 12934        MOVE AL-UABON            TO CLMCARRA
 12935        MOVE -1                  TO CLMCARRL
 12936        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12937     END-IF.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 247
* EL130.cbl
 12938
 12939     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 12940         ACVCDL = ZEROS)
 12941             MOVE ER-0521        TO EMI-ERROR
 12942             MOVE AL-UABON       TO CLMTYPEA
 12943             MOVE -1             TO CLMTYPEL
 12944             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12945     END-IF.
 12946
 12947     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 12948         LCVCDL = ZEROS
 12949             MOVE ER-0521        TO EMI-ERROR
 12950             MOVE AL-UABON       TO CLMTYPEA
 12951             MOVE -1             TO CLMTYPEL
 12952             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12953     END-IF.
 12954
 12955     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 12956         IF LCVCNDTL GREATER ZERO
 12957             IF WS-INCUR GREATER THAN WS-LCVCNDT
 12958                 GO TO 6450-DATE-ERROR
 12959             END-IF
 12960         END-IF
 12961     END-IF.
 12962
 12963     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12964         IF ACVCNDTL GREATER ZERO
 12965             IF WS-INCUR GREATER THAN WS-ACVCNDT
 12966                 GO TO 6450-DATE-ERROR
 12967             END-IF
 12968         END-IF
 12969     END-IF.
 12970
 12971 6499-EXIT.
 12972     EXIT.
 12973
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 248
* EL130.cbl
 12975 6600-CHECK-AUTO-ACTIVITY.
 12976
 12977
 12978* EXEC CICS HANDLE CONDITION
 12979*        NOTFND   (6600-NOT-FOUND)
 12980*    END-EXEC.
 12981*    MOVE '"$I                   ! C #00011851' TO DFHEIV0
 12982     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12983     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12984     MOVE X'4320233030303131383531' TO DFHEIV0(25:11)
 12985     CALL 'kxdfhei1' USING DFHEIV0
 12986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12987
 12988
 12989     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 12990     MOVE 'T'                        TO  CNTL-REC-TYPE.
 12991     MOVE SPACES                     TO  CNTL-ACCESS.
 12992     MOVE +0                         TO  CNTL-SEQ-NO.
 12993
 12994     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 12995
 12996     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 12997         MOVE 'N'                    TO  WS-REC-FOUND-SW
 12998                                         WS-LETTER-SW
 12999         GO TO 6600-EXIT
 13000     END-IF.
 13001
 13002     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 13003         MOVE 'N'                     TO  WS-LETTER-SW
 13004     ELSE
 13005         MOVE 'Y'                     TO  WS-LETTER-SW
 13006     END-IF.
 13007
 13008     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 13009     GO TO 6600-EXIT.
 13010
 13011 6600-START-AUTO-LETTER-WRITER.
 13012
 13013     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 13014     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 13015
 13016     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 13017
 13018     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 13019         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 13020         MOVE '6'                     TO  DC-OPTION-CODE
 13021         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 13022         MOVE +0                      TO  DC-ELAPSED-MONTHS
 13023         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13024         IF NO-CONVERSION-ERROR
 13025             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 13026         ELSE
 13027             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 13028         END-IF
 13029     END-IF.
 13030
 13031     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
 13032         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 249
* EL130.cbl
 13033         MOVE '6'                     TO  DC-OPTION-CODE
 13034         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 13035         MOVE +0                      TO  DC-ELAPSED-MONTHS
 13036         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13037         IF NO-CONVERSION-ERROR
 13038             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 13039         ELSE
 13040             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 13041         END-IF
 13042     END-IF.
 13043
 13044
 13045
 13046* EXEC CICS LINK
 13047*        PROGRAM    (LINK-1523)
 13048*        COMMAREA   (W-1523-LINKDATA)
 13049*        LENGTH     (W-1523-COMM-LENGTH)
 13050*    END-EXEC.
 13051*    MOVE '."C                   ''   #00011911' TO DFHEIV0
 13052     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13053     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13054     MOVE X'2020233030303131393131' TO DFHEIV0(25:11)
 13055     CALL 'kxdfhei1' USING DFHEIV0,
 13056           LINK-1523,
 13057           W-1523-LINKDATA,
 13058           W-1523-COMM-LENGTH,
 13059           DFHEIV99,
 13060           DFHEIV99,
 13061           DFHEIV99
 13062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13063
 13064
 13065     GO TO 6600-EXIT.
 13066
 13067 6600-NOT-FOUND.
 13068     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 13069
 13070 6600-EXIT.
 13071     EXIT.
 13072
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 250
* EL130.cbl
 13073/
 13074*************************************************************
 13075*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 13076*************************************************************
 13077
 13078 6700-OUTPUT-ACTIVITY-RECORD.
 13079
 13080
 13081
 13082* EXEC CICS GETMAIN
 13083*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 13084*        LENGTH (DLYACTV-LENGTH)
 13085*        INITIMG (WS-BLANK)
 13086*    END-EXEC.
 13087*    MOVE ',"IL                  $   #00011933' TO DFHEIV0
 13088     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13089     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13090     MOVE X'2020233030303131393333' TO DFHEIV0(25:11)
 13091     CALL 'kxdfhei1' USING DFHEIV0,
 13092           DFHEIV20,
 13093           DLYACTV-LENGTH,
 13094           WS-BLANK
 13095     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 13096         DFHEIV20
 13097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13098
 13099
 13100     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 13101     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 13102     MOVE CLMCARRI               TO DA-CARRIER.
 13103     IF CLMNOL EQUAL ZERO
 13104         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 13105     ELSE
 13106         MOVE CLMNOI             TO DA-CLAIM-NO
 13107     END-IF.
 13108     MOVE CERTNOI                TO DA-CERT-PRIME.
 13109     MOVE SUFXI                  TO DA-CERT-SFX.
 13110     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 13111     MOVE 'A'                    TO DA-RECORD-TYPE.
 13112
 13113
 13114* EXEC CICS HANDLE CONDITION
 13115*        NOTOPEN (6700-NOTOPEN-ERROR)
 13116*        DUPREC (6700-EXIT)
 13117*    END-EXEC.
 13118*    MOVE '"$J%                  ! D #00011952' TO DFHEIV0
 13119     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 13120     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13121     MOVE X'4420233030303131393532' TO DFHEIV0(25:11)
 13122     CALL 'kxdfhei1' USING DFHEIV0
 13123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13124
 13125
 13126
 13127* EXEC CICS WRITE
 13128*        DATASET (DLYACTV-DSID)
 13129*        RIDFLD (DA-KEY)
 13130*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 251
* EL130.cbl
 13131*        LENGTH (DLYACTV-LENGTH)
 13132*    END-EXEC.
 13133*    MOVE '&$ L                  ''   #00011957' TO DFHEIV0
 13134     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13135     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13136     MOVE X'2020233030303131393537' TO DFHEIV0(25:11)
 13137     CALL 'kxdfhei1' USING DFHEIV0,
 13138           DLYACTV-DSID,
 13139           DAILY-ACTIVITY-RECORD,
 13140           DLYACTV-LENGTH,
 13141           DA-KEY,
 13142           DFHEIV99,
 13143           DFHEIV99
 13144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13145
 13146     GO TO 6700-EXIT.
 13147
 13148 6700-NOTOPEN-ERROR.
 13149     MOVE '2955'                 TO EMI-ERROR.
 13150     MOVE -1                     TO MAINTL.
 13151     MOVE AL-UANON               TO MAINTA.
 13152     PERFORM 9900-ERROR-FORMAT THRU
 13153             9900-EXIT.
 13154     GO TO 8200-SEND-DATAONLY.
 13155
 13156 6700-EXIT.
 13157     EXIT.
 13158
 13159*************************************************************
 13160*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 13161*************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 252
* EL130.cbl
 13162/
 13163 6990-DEEDIT-DATE.
 13164
 13165
 13166* EXEC CICS BIF DEEDIT
 13167*        FIELD   (DATE-WORK)
 13168*        LENGTH  (8)
 13169*    END-EXEC.
 13170     MOVE 8
 13171       TO DFHEIV11
 13172*    MOVE '@"L                   #   #00011982' TO DFHEIV0
 13173     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13174     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13175     MOVE X'2020233030303131393832' TO DFHEIV0(25:11)
 13176     CALL 'kxdfhei1' USING DFHEIV0,
 13177           DATE-WORK,
 13178           DFHEIV11
 13179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13180
 13181 6990-EXIT.
 13182     EXIT.
 13183
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 253
* EL130.cbl
 13185 7000-BUILD-OUTPUT-MAP.
 13186
 13187     IF CLAIM-SWITCH = 'N'
 13188         GO TO 7050-BUILD-MAP-CERT-DATA
 13189     END-IF.
 13190
 13191     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 13192         MOVE SPACES                 TO SEQUO
 13193         MOVE AL-SABOF               TO SEQUA
 13194     ELSE
 13195         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 13196         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 13197         MOVE WS-CLAIM-SEQU          TO SEQUO
 13198         MOVE AL-SABON               TO SEQUA
 13199     END-IF.
 13200
 13201     MOVE CL-CARRIER             TO CLMCARRO.
 13202     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 13203     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 13204     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 13205     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 13206     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 13207     MOVE CL-INSURED-MID-INIT    TO INITO.
 13208     MOVE CL-INSURED-SEX-CD      TO SEXO.
 13209     MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 13210
 13211     MOVE AL-UANON               TO CLMCARRA
 13212                                    CLMTYPEA
 13213                                    PCERTNOA
 13214                                    PSUFXA
 13215                                    LSTNMEA
 13216                                    FSTNMEA
 13217                                    INITA
 13218                                    SEXA
 13219                                    OCCCDA.
 13220
 13221     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 13222
 13223     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 13224         MOVE ' '                 TO DC-OPTION-CODE
 13225         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 13226         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13227         IF NOT DATE-CONVERSION-ERROR
 13228             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 13229             MOVE AL-UANON            TO BIRTHDTA
 13230         END-IF
 13231     END-IF.
 13232
 13233     MOVE CL-SOC-SEC-NO          TO SSNO.
 13234     MOVE AL-UANON               TO SSNA.
 13235
 13236     IF CL-INCURRED-DT NOT = LOW-VALUES
 13237         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13238         MOVE ' '                TO DC-OPTION-CODE
 13239         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13240         IF NOT DATE-CONVERSION-ERROR
 13241             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 13242             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 254
* EL130.cbl
 13243         END-IF
 13244     END-IF.
 13245
 13246     IF CL-REPORTED-DT NOT = LOW-VALUES
 13247         MOVE ' '                TO DC-OPTION-CODE
 13248         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 13249         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13250         IF NOT DATE-CONVERSION-ERROR
 13251             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 13252             MOVE AL-UANON            TO REPORTA
 13253         END-IF
 13254     END-IF.
 13255
 13256     IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 13257         MOVE ' '                 TO DC-OPTION-CODE
 13258         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 13259         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13260         IF NOT DATE-CONVERSION-ERROR
 13261             MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 13262             MOVE AL-UANON            TO ESTENDA
 13263         END-IF
 13264     END-IF.
 13265
 13266     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 13267     MOVE CL-CAUSE-CD            TO CAUSEO.
 13268     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 13269     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 13270     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 13271     MOVE CL-PRIORITY-CD         TO PRICDO.
 13272     MOVE AL-UANON               TO DIAGA
 13273                                    CAUSEA
 13274                                    RELCLMA
 13275                                    PROCCDA
 13276                                    PRICDA.
 13277     MOVE AL-UNNON               TO MANRSVA.
 13278
 13279*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 13280*        MOVE CL-PRODUCT-CD          TO PRODCDO
 13281*        MOVE AL-UANON               TO PRODCDA
 13282*    END-IF.
 13283
 13284     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 13285     MOVE CL-FILE-LOCATION       TO FILETOO.
 13286     MOVE CL-BENEFICIARY         TO BENECDO.
 13287     MOVE AL-UANON               TO SUPVA
 13288                                    FILETOA
 13289                                    BENECDA.
 13290
 13291     IF CLAIM-SWITCH = 'X'
 13292         GO TO 7099-EXIT
 13293     END-IF.
 13294
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 255
* EL130.cbl
 13296 7050-BUILD-MAP-CERT-DATA.
 13297     MOVE CM-CERT-PRIME          TO CERTNOO.
 13298     MOVE CM-CERT-SFX            TO SUFXO.
 13299     MOVE AL-SANON               TO CERTNOA
 13300                                    SUFXA.
 13301
 13302     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 13303         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 13304         MOVE ' '                TO DC-OPTION-CODE
 13305         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13306         IF NOT DATE-CONVERSION-ERROR
 13307             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 13308         END-IF
 13309     END-IF.
 13310
 13311     MOVE CM-ACCOUNT             TO ACCOUNTO.
 13312     MOVE CM-STATE               TO STATEO.
 13313     MOVE CM-CARRIER             TO CRTCARRO.
 13314     MOVE CM-GROUPING            TO GROUPO.
 13315     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 13316     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 13317     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 13318     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 13319     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 13320     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 13321     MOVE CM-JT-INITIAL          TO JNTINITO.
 13322     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 13323     MOVE AL-UANON               TO ACCOUNTA
 13324                                    STATEA
 13325                                    CRTCARRA
 13326                                    GROUPA
 13327                                    CRTLNMEA
 13328                                    CRTFNMEA
 13329                                    CRTINITA
 13330                                    JNTLNMEA
 13331                                    JNTFNMEA
 13332                                    JNTINITA.
 13333     MOVE AL-UNNON               TO ISSAGEA
 13334                                    JNTAGEA.
 13335
 13336     IF CM-SSN-STATE   = CM-STATE AND
 13337        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 13338*        NEXT SENTENCE
 13339         CONTINUE
 13340     ELSE
 13341         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 13342     END-IF.
 13343
 13344     MOVE AL-UANON               TO CRTSSNA.
 13345
 13346     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 13347     MOVE '2'                    TO DC-OPTION-CODE.
 13348     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13349     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 13350
 13351*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 13352     MOVE SPACES                 TO ELCNTL-KEY.
 13353     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 256
* EL130.cbl
 13354     MOVE '3'                    TO CNTL-REC-TYPE.
 13355     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13356     MOVE ZEROS                  TO CNTL-SEQ-NO.
 13357
 13358
 13359
 13360* EXEC CICS READ
 13361*        DATASET  (ELCNTL-DSID)
 13362*        SET      (ADDRESS OF CONTROL-FILE)
 13363*        RIDFLD   (ELCNTL-KEY)
 13364*        RESP     (WS-RESPONSE)
 13365*    END-EXEC.
 13366*    MOVE '&"S        E          (  N#00012164' TO DFHEIV0
 13367     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13368     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13369     MOVE X'204E233030303132313634' TO DFHEIV0(25:11)
 13370     CALL 'kxdfhei1' USING DFHEIV0,
 13371           ELCNTL-DSID,
 13372           DFHEIV20,
 13373           DFHEIV99,
 13374           ELCNTL-KEY,
 13375           DFHEIV99,
 13376           DFHEIV99,
 13377           DFHEIV99
 13378     SET ADDRESS OF CONTROL-FILE TO
 13379         DFHEIV20
 13380     MOVE EIBRESP  TO WS-RESPONSE
 13381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13382
 13383
 13384     IF WS-RESP-NOTFND
 13385          MOVE ER-2848           TO EMI-ERROR
 13386          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13387          GO TO 8100-SEND-INITIAL-MAP
 13388     END-IF.
 13389
 13390     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 13391     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 257
* EL130.cbl
 13393     IF CM-LF-BENEFIT-CD = '00'
 13394         MOVE ZEROS              TO LCVOTRMO
 13395                                    LCVRTRMO
 13396                                    LCVRATEO
 13397                                    LCVBENEO
 13398         MOVE SPACES             TO LCVDSCRO
 13399                                    LCVCDO
 13400                                    LCVKINDO
 13401                                    LCVFORMO
 13402                                    LCVCNDTO
 13403                                    LCVEXITO
 13404                                    LCVSTATO
 13405         IF CLMTYPEL GREATER THAN ZERO AND
 13406            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13407                MOVE ER-0521     TO EMI-ERROR
 13408                MOVE AL-UABON    TO CLMTYPEA
 13409                MOVE -1          TO CLMTYPEL
 13410                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13411                GO TO 7060-FILL-AH-COVERAGE
 13412         ELSE
 13413             GO TO 7060-FILL-AH-COVERAGE
 13414         END-IF
 13415     END-IF.
 13416
 13417     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 13418     MOVE AL-UANON               TO LCVDSCRA.
 13419     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 13420     MOVE '4'                    TO WS-REC-TYPE.
 13421     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 13422     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 13423     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 13424     MOVE AL-UANON               TO LCVCDA.
 13425     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 13426                                    CP-ORIGINAL-TERM.
 13427     MOVE AL-UNNON               TO LCVOTRMA.
 13428     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13429     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13430     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 13431     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13432     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13433     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13434
 13435     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 13436     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 13437
 13438     IF CM-LF-PREMIUM-RATE NUMERIC
 13439         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 13440     ELSE
 13441         MOVE ZEROS              TO LCVRATEO
 13442     END-IF.
 13443
 13444     MOVE AL-UNNON               TO LCVRATEA.
 13445
 13446     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 13447         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 13448     END-IF.
 13449
 13450     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 258
* EL130.cbl
 13451
 13452     MOVE AL-UNNON               TO LCVBENEA.
 13453
 13454     IF CM-POLICY-FORM-NO NOT = SPACES
 13455         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 13456     ELSE
 13457         MOVE WS-FORM-HOLD       TO LCVFORMO
 13458     END-IF.
 13459
 13460     MOVE SPACES                 TO WS-FORM-HOLD.
 13461     MOVE 'L'                    TO WS-REC-TYPE.
 13462     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 13463
 13464     IF WS-FORM-HOLD NOT = SPACES
 13465         MOVE WS-FORM-HOLD       TO LCVFORMO
 13466         MOVE AL-UANON           TO LCVFORMA
 13467     END-IF.
 13468
 13469     IF CM-LF-CURRENT-STATUS = '8'
 13470         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 13471             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 13472             MOVE ' '             TO DC-OPTION-CODE
 13473             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13474             IF NOT DATE-CONVERSION-ERROR
 13475                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 13476                 MOVE AL-UANON            TO LCVCNDTA
 13477             END-IF
 13478         END-IF
 13479     END-IF.
 13480
 13481     IF CM-LF-CURRENT-STATUS = '7'
 13482         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13483             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 13484             MOVE ' '            TO DC-OPTION-CODE
 13485             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13486             IF NOT DATE-CONVERSION-ERROR
 13487                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 13488                 MOVE AL-UANON   TO LCVCNDTA
 13489             END-IF
 13490         END-IF
 13491     END-IF.
 13492
 13493     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 13494         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 13495             MOVE ' '            TO DC-OPTION-CODE
 13496             MOVE CM-LF-DEATH-EXIT-DT
 13497                                 TO DC-BIN-DATE-1
 13498             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13499             IF NOT DATE-CONVERSION-ERROR
 13500                 MOVE DC-GREG-DATE-1-EDIT
 13501                                 TO LCVEXITO
 13502             END-IF
 13503         END-IF
 13504     END-IF.
 13505
 13506     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 13507         IF CP-REMAINING-TERM-3 = ZEROS
 13508             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 259
* EL130.cbl
 13509         ELSE
 13510             MOVE 'ACTIVE'       TO LCVSTATO
 13511         END-IF
 13512     END-IF.
 13513
 13514     IF CM-LF-CURRENT-STATUS = '2'
 13515        MOVE 'PEND  '            TO LCVSTATO
 13516     END-IF.
 13517     IF CM-LF-CURRENT-STATUS = '3'
 13518        MOVE 'RESTORE'           TO LCVSTATO
 13519     END-IF.
 13520     IF CM-LF-CURRENT-STATUS = '5'
 13521        MOVE 'REISSUE'           TO LCVSTATO
 13522     END-IF.
 13523     IF CM-LF-CURRENT-STATUS = '6'
 13524        MOVE 'LMP DIS'           TO LCVSTATO
 13525     END-IF.
 13526     IF CM-LF-CURRENT-STATUS = '7'
 13527        MOVE 'DEATH  '           TO LCVSTATO
 13528     END-IF.
 13529     IF CM-LF-CURRENT-STATUS = '8'
 13530        MOVE 'CANCEL '           TO LCVSTATO
 13531     END-IF.
 13532     IF CM-LF-CURRENT-STATUS = '9'
 13533        MOVE 'RE-ONLY'           TO LCVSTATO
 13534     END-IF.
 13535     IF CM-LF-CURRENT-STATUS = 'V'
 13536        MOVE 'VOID   '           TO LCVSTATO
 13537     END-IF.
 13538     IF CM-LF-CURRENT-STATUS = 'D'
 13539        MOVE 'DECLINE'           TO LCVSTATO
 13540     END-IF.
 13541
 13542     IF PI-COMPANY-ID = 'CID'
 13543         IF CM-LF-BENEFIT-CD >= '2O' AND
 13544            CM-LF-BENEFIT-CD <= '2V'
 13545             MOVE ER-0878       TO EMI-ERROR
 13546             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13547         END-IF
 13548     END-IF.
 13549
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 260
* EL130.cbl
 13551 7060-FILL-AH-COVERAGE.
 13552
 13553     IF CM-AH-BENEFIT-CD = '00'
 13554         MOVE ZEROS              TO ACVOTRMO
 13555                                    ACVRTRMO
 13556                                    ACVRATEO
 13557                                    ACVBENEO
 13558         MOVE SPACES             TO ACVDSCRO
 13559                                    ACVCDO
 13560                                    ACVKINDO
 13561                                    ACVFORMO
 13562                                    ACVCNDTO
 13563                                    ACVEXITO
 13564                                    ACVSTATO
 13565         IF (CLMTYPEL GREATER THAN ZERO AND
 13566             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 13567             MOVE ER-0521     TO EMI-ERROR
 13568             MOVE AL-UABON    TO CLMTYPEA
 13569             MOVE -1          TO CLMTYPEL
 13570             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13571             GO TO 7070-BUILD-MAP-FINISH
 13572         ELSE
 13573             GO TO 7070-BUILD-MAP-FINISH
 13574         END-IF
 13575     END-IF.
 13576
 13577     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 13578     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 13579     MOVE AL-UANON               TO ACVDSCRA
 13580                                    ACVCDA.
 13581     MOVE '5'                    TO WS-REC-TYPE.
 13582     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 13583     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 13584
 13585     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 13586                                    CP-ORIGINAL-TERM.
 13587     MOVE AL-UNNON               TO ACVOTRMA.
 13588
 13589     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13590     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13591     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 13592     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13593     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13594     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13595
 13596     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 13597     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 13598
 13599     IF CM-AH-PREMIUM-RATE NUMERIC
 13600         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 13601     ELSE
 13602         MOVE ZEROS              TO ACVRATEO
 13603     END-IF.
 13604
 13605     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 13606     MOVE AL-UNNON               TO ACVRATEA
 13607                                    ACVBENEA.
 13608
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 261
* EL130.cbl
 13609     IF CM-POLICY-FORM-NO NOT = SPACES
 13610         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 13611     ELSE
 13612         MOVE WS-FORM-HOLD       TO ACVFORMO
 13613         MOVE SPACES TO WS-FORM-HOLD
 13614         MOVE 'A'                TO WS-REC-TYPE
 13615         PERFORM 7400-READ-STATE THRU 7499-EXIT
 13616         IF WS-FORM-HOLD NOT = SPACES
 13617             MOVE WS-FORM-HOLD   TO ACVFORMO
 13618         END-IF
 13619     END-IF.
 13620
 13621     MOVE AL-UANON               TO ACVFORMA.
 13622
 13623     IF CM-AH-CURRENT-STATUS = '8'
 13624         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 13625             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 13626             MOVE ' '             TO DC-OPTION-CODE
 13627             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13628             IF NOT DATE-CONVERSION-ERROR
 13629                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 13630                MOVE AL-UANON    TO ACVCNDTA
 13631             END-IF
 13632         END-IF
 13633     END-IF.
 13634
 13635     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 13636         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 13637             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 13638             MOVE ' '             TO DC-OPTION-CODE
 13639             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13640             IF NOT DATE-CONVERSION-ERROR
 13641                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 13642                MOVE AL-UANON            TO ACVCNDTA
 13643             END-IF
 13644         END-IF
 13645     END-IF.
 13646
 13647     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 13648         MOVE ' '                TO DC-OPTION-CODE
 13649         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 13650         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13651         IF NOT DATE-CONVERSION-ERROR
 13652             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 13653         END-IF
 13654     END-IF.
 13655
 13656     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 13657         IF CP-REMAINING-TERM-3 = ZEROS
 13658             MOVE 'EXPIRED'      TO ACVSTATO
 13659         ELSE
 13660             MOVE 'ACTIVE'       TO ACVSTATO
 13661         END-IF
 13662     END-IF.
 13663
 13664     IF CM-AH-CURRENT-STATUS = '2'
 13665         MOVE 'PEND  '           TO ACVSTATO
 13666     END-IF.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 262
* EL130.cbl
 13667     IF CM-AH-CURRENT-STATUS = '3'
 13668         MOVE 'RESTORE'          TO ACVSTATO
 13669     END-IF.
 13670     IF CM-AH-CURRENT-STATUS = '5'
 13671         MOVE 'REISSUE'          TO ACVSTATO
 13672     END-IF.
 13673     IF CM-AH-CURRENT-STATUS = '6'
 13674         MOVE 'LMP DIS'          TO ACVSTATO
 13675     END-IF.
 13676     IF CM-AH-CURRENT-STATUS = '7'
 13677         MOVE 'DEATH  '          TO ACVSTATO
 13678     END-IF.
 13679     IF CM-AH-CURRENT-STATUS = '8'
 13680         MOVE 'CANCEL '          TO ACVSTATO
 13681     END-IF.
 13682     IF CM-AH-CURRENT-STATUS = '9'
 13683         MOVE 'RE-ONLY'          TO ACVSTATO
 13684     END-IF.
 13685     IF CM-AH-CURRENT-STATUS = 'V'
 13686         MOVE 'VOID   '          TO ACVSTATO
 13687     END-IF.
 13688     IF CM-AH-CURRENT-STATUS = 'D'
 13689         MOVE 'DECLINE'          TO ACVSTATO
 13690     END-IF.
 13691
 13692     IF PI-COMPANY-ID = 'DCC'
 13693        IF CM-ACCOUNT (9:2) = 'BI'
 13694           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 13695           MOVE CM-CARRIER       TO CTRLR-CARRIER
 13696           MOVE CM-GROUPING      TO CTRLR-GROUPING
 13697           MOVE CM-STATE         TO CTRLR-STATE
 13698           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 13699           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 13700           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 13701           MOVE 'C'              TO CTRLR-REC-TYPE
 13702
 13703* EXEC CICS READ
 13704*            DATASET  (ELCRTT-DSID)
 13705*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13706*            RIDFLD   (ELCRTT-KEY)
 13707*            RESP     (WS-RESPONSE)
 13708*          END-EXEC
 13709*    MOVE '&"S        E          (  N#00012489' TO DFHEIV0
 13710     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13711     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13712     MOVE X'204E233030303132343839' TO DFHEIV0(25:11)
 13713     CALL 'kxdfhei1' USING DFHEIV0,
 13714           ELCRTT-DSID,
 13715           DFHEIV20,
 13716           DFHEIV99,
 13717           ELCRTT-KEY,
 13718           DFHEIV99,
 13719           DFHEIV99,
 13720           DFHEIV99
 13721     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13722         DFHEIV20
 13723     MOVE EIBRESP  TO WS-RESPONSE
 13724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 263
* EL130.cbl
 13725           IF WS-RESP-NORMAL
 13726               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 13727               MOVE WS-DIAG-VIN-MSG TO DIAGO
 13728               MOVE AL-UANON        TO DIAGA
 13729           END-IF
 13730        END-IF
 13731     END-IF.
 13732
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 264
* EL130.cbl
 13734 7070-BUILD-MAP-FINISH.
 13735     MOVE CM-LOAN-APR            TO APRO.
 13736     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 13737     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 13738     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 13739     MOVE AL-UNNON               TO APRA
 13740                                    PMTFREQA.
 13741     MOVE AL-UANON               TO INDGRPA
 13742                                    PREMTYPA.
 13743
 13744     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 13745         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 13746         MOVE AL-UANON               TO REINCDA
 13747     END-IF.
 13748
 13749     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 13750*        NEXT SENTENCE
 13751         CONTINUE
 13752     ELSE
 13753         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 13754         MOVE ' '                TO DC-OPTION-CODE
 13755         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13756         IF NOT DATE-CONVERSION-ERROR
 13757             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 13758             MOVE AL-UANON            TO ADDONDTA
 13759         END-IF
 13760     END-IF.
 13761
 13762     IF CLAIM-SWITCH = 'N'
 13763         IF SEXL = ZEROS
 13764             MOVE CM-INSURED-SEX TO SEXO
 13765             MOVE AL-UANON       TO SEXA
 13766         END-IF
 13767     END-IF.
 13768
 13769     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 13770         MOVE CM-MEMBER-NO       TO MEMBERO
 13771         MOVE AL-UANON           TO MEMBERA
 13772     END-IF.
 13773
 13774     IF MAINTI = 'A'
 13775         IF (LOANNOL = ZEROS OR
 13776             EIBAID = DFHPF5)
 13777             MOVE CM-LOAN-NUMBER TO LOANNOO
 13778             MOVE AL-UANON       TO LOANNOA
 13779         ELSE
 13780*            NEXT SENTENCE
 13781             CONTINUE
 13782         END-IF
 13783     ELSE
 13784         MOVE CM-LOAN-NUMBER     TO LOANNOO
 13785         MOVE AL-UANON           TO LOANNOA
 13786     END-IF.
 13787
 13788     IF MAINTI = 'A'
 13789         IF (LOANBALL = ZEROS OR
 13790             EIBAID = DFHPF5)
 13791             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 265
* EL130.cbl
 13792             MOVE AL-UNNON       TO LOANBALA
 13793         ELSE
 13794*            NEXT SENTENCE
 13795             CONTINUE
 13796         END-IF
 13797     ELSE
 13798         MOVE CM-LOAN-BALANCE    TO LOANBALO
 13799         MOVE AL-UNNON           TO LOANBALA
 13800     END-IF.
 13801
 13802     IF CM-PREMIUM-TYPE NOT = '3'
 13803         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 13804             PERFORM 7200-PROTECT-CERT-FIELDS
 13805         ELSE
 13806             PERFORM 7300-RESET-KEY-ATTRBS
 13807         END-IF
 13808     ELSE
 13809         PERFORM 7300-RESET-KEY-ATTRBS
 13810     END-IF.
 13811
 13812*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 13813*        NEXT SENTENCE
 13814*        CONTINUE
 13815*    ELSE
 13816         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 13817*    END-IF.
 13818
 13819 7099-EXIT.
 13820     EXIT.
 13821
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 266
* EL130.cbl
 13823 7100-READ-BENEFIT.
 13824
 13825
 13826* EXEC CICS HANDLE CONDITION
 13827*         NOTFND   (7120-NOT-FOUND)
 13828*    END-EXEC.
 13829*    MOVE '"$I                   ! E #00012595' TO DFHEIV0
 13830     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13831     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13832     MOVE X'4520233030303132353935' TO DFHEIV0(25:11)
 13833     CALL 'kxdfhei1' USING DFHEIV0
 13834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13835
 13836
 13837     MOVE SPACES                 TO ELCNTL-KEY.
 13838     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 13839     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 13840     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13841     MOVE ZEROS                  TO CNTL-SEQ-NO.
 13842
 13843 7105-READ-FILE.
 13844     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 13845
 13846     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 13847        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 13848          GO TO 7120-NOT-FOUND
 13849     END-IF.
 13850
 13851     MOVE 1                      TO SUB.
 13852 7110-LOOP.
 13853     IF SUB = 9
 13854         GO TO 7120-NOT-FOUND
 13855     END-IF.
 13856
 13857     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 13858         ADD 1                   TO SUB
 13859         GO TO 7110-LOOP
 13860     END-IF.
 13861
 13862     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 13863     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 13864     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 13865
 13866     GO TO 7199-EXIT.
 13867
 13868 7120-NOT-FOUND.
 13869     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 13870                                    WS-FORM-HOLD.
 13871
 13872 7199-EXIT.
 13873      EXIT.
 13874
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 267
* EL130.cbl
 13876 7200-PROTECT-CERT-FIELDS.
 13877     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 13878                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 13879                                LCVFORMA ACVFORMA JNTLNMEA
 13880                                JNTFNMEA JNTINITA.
 13881
 13882     IF CM-LF-CURRENT-STATUS = '2' OR
 13883        CM-AH-CURRENT-STATUS = '2'
 13884         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 13885     END-IF.
 13886
 13887     MOVE AL-SANOF TO
 13888            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 13889            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 13890            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 13891            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 13892            LCVRATEA   ACVRATEA.
 13893
 13894     MOVE 'S'                    TO CERTMTI.
 13895
 13896 7300-RESET-KEY-ATTRBS.
 13897     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 13898                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 13899                                LCVFORMA ACVFORMA JNTLNMEA
 13900                                JNTFNMEA JNTINITA.
 13901
 13902     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 13903         MOVE AL-SANOF           TO REINCDA
 13904     END-IF.
 13905
 13906     MOVE 'S'                    TO CERTMTI.
 13907
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 268
* EL130.cbl
 13909 7400-READ-STATE.
 13910
 13911
 13912* EXEC CICS HANDLE CONDITION
 13913*         NOTFND   (7499-EXIT)
 13914*    END-EXEC.
 13915*    MOVE '"$I                   ! F #00012673' TO DFHEIV0
 13916     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13917     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13918     MOVE X'4620233030303132363733' TO DFHEIV0(25:11)
 13919     CALL 'kxdfhei1' USING DFHEIV0
 13920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13921
 13922
 13923     MOVE SPACES                 TO ELCNTL-KEY.
 13924     MOVE CM-STATE               TO CNTL-ACCESS.
 13925     MOVE '3'                    TO CNTL-REC-TYPE.
 13926     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13927     MOVE ZEROS                  TO CNTL-SEQ-NO.
 13928
 13929     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13930
 13931     MOVE 1                      TO SUB.
 13932
 13933 7410-LOOP.
 13934     IF SUB = 21
 13935        GO TO 7499-EXIT
 13936     END-IF.
 13937
 13938*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 13939*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 13940*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 13941*        GO TO 7499-EXIT.
 13942
 13943     ADD 1                       TO SUB.
 13944     GO TO 7410-LOOP.
 13945
 13946 7499-EXIT.
 13947      EXIT.
 13948
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 269
* EL130.cbl
 13950 7500-BROWSE-FOR-DUPLICATE.
 13951
 13952     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 13953
 13954
 13955
 13956* EXEC CICS HANDLE CONDITION
 13957*        NOTFND   (7500-EXIT)
 13958*        DUPKEY   (7500-DUPLICATE-KEY)
 13959*        ENDFILE  (7500-EXIT)
 13960*    END-EXEC.
 13961*    MOVE '"$I$''                 ! G #00012709' TO DFHEIV0
 13962     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 13963     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13964     MOVE X'4720233030303132373039' TO DFHEIV0(25:11)
 13965     CALL 'kxdfhei1' USING DFHEIV0
 13966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13967
 13968
 13969
 13970
 13971* EXEC CICS STARTBR
 13972*        DATASET    (ELMSTR5-DSID)
 13973*        RIDFLD     (ELMSTR5-KEY)
 13974*    END-EXEC.
 13975     MOVE 0
 13976       TO DFHEIV11
 13977*    MOVE '&,         G          &   #00012716' TO DFHEIV0
 13978     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13979     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13980     MOVE X'2020233030303132373136' TO DFHEIV0(25:11)
 13981     CALL 'kxdfhei1' USING DFHEIV0,
 13982           ELMSTR5-DSID,
 13983           ELMSTR5-KEY,
 13984           DFHEIV99,
 13985           DFHEIV11,
 13986           DFHEIV99
 13987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13988
 13989
 13990
 13991
 13992* EXEC CICS HANDLE CONDITION
 13993*        ENDFILE  (7500-END-BROWSE)
 13994*    END-EXEC.
 13995*    MOVE '"$''                   ! H #00012722' TO DFHEIV0
 13996     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 13997     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13998     MOVE X'4820233030303132373232' TO DFHEIV0(25:11)
 13999     CALL 'kxdfhei1' USING DFHEIV0
 14000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14001
 14002
 14003 7500-READ-CLAIM-LOOP.
 14004
 14005
 14006
 14007* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 270
* EL130.cbl
 14008*        DATASET   (ELMSTR5-DSID)
 14009*        SET       (ADDRESS OF CLAIM-MASTER)
 14010*        RIDFLD    (ELMSTR5-KEY)
 14011*    END-EXEC.
 14012     MOVE 0
 14013       TO DFHEIV11
 14014*    MOVE '&.S                   )   #00012729' TO DFHEIV0
 14015     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14016     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14017     MOVE X'2020233030303132373239' TO DFHEIV0(25:11)
 14018     CALL 'kxdfhei1' USING DFHEIV0,
 14019           ELMSTR5-DSID,
 14020           DFHEIV20,
 14021           DFHEIV99,
 14022           ELMSTR5-KEY,
 14023           DFHEIV99,
 14024           DFHEIV11,
 14025           DFHEIV99,
 14026           DFHEIV99
 14027     SET ADDRESS OF CLAIM-MASTER TO
 14028         DFHEIV20
 14029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14030
 14031
 14032 7500-DUPLICATE-KEY.
 14033
 14034     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 14035        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 14036        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 14037        CL-CERT-STATE     NOT = CM-STATE       OR
 14038        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 14039        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 14040        CL-CERT-NO        NOT = CM-CERT-NO
 14041           GO TO 7500-CHECK-MATCH-COUNT
 14042     END-IF.
 14043
 14044     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 14045
 14046     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 14047        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 14048        GO TO 7500-END-BROWSE
 14049     ELSE
 14050        GO TO 7500-READ-CLAIM-LOOP
 14051     END-IF.
 14052
 14053 7500-CHECK-MATCH-COUNT.
 14054
 14055     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 14056        CL-CERT-NO    = CM-CERT-NO
 14057          GO TO 7500-READ-CLAIM-LOOP
 14058     END-IF.
 14059
 14060 7500-END-BROWSE.
 14061
 14062
 14063
 14064* EXEC CICS ENDBR
 14065*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 271
* EL130.cbl
 14066*    END-EXEC.
 14067     MOVE 0
 14068       TO DFHEIV11
 14069*    MOVE '&2                    $   #00012766' TO DFHEIV0
 14070     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14071     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14072     MOVE X'2020233030303132373636' TO DFHEIV0(25:11)
 14073     CALL 'kxdfhei1' USING DFHEIV0,
 14074           ELMSTR5-DSID,
 14075           DFHEIV11,
 14076           DFHEIV99
 14077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14078
 14079
 14080 7500-EXIT.
 14081     EXIT.
 14082
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 272
* EL130.cbl
 14084 7550-FALL-THRU-PARA.
 14085
 14086
 14087
 14088* EXEC CICS DUMP
 14089*         DUMPCODE ('E130')
 14090*         TASK
 14091*    END-EXEC.
 14092     MOVE 'E130' TO DFHEIV5
 14093*    MOVE '<"   T                $   #00012777' TO DFHEIV0
 14094     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 14095     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14096     MOVE X'2020233030303132373737' TO DFHEIV0(25:11)
 14097     CALL 'kxdfhei1' USING DFHEIV0,
 14098           DFHEIV5,
 14099           DFHEIV99,
 14100           DFHEIV99
 14101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14102
 14103
 14104
 14105
 14106* EXEC CICS RETURN
 14107*    END-EXEC.
 14108*    MOVE '.(                    &   #00012783' TO DFHEIV0
 14109     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 14110     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14111     MOVE X'2020233030303132373833' TO DFHEIV0(25:11)
 14112     CALL 'kxdfhei1' USING DFHEIV0,
 14113           DFHEIV99,
 14114           DFHEIV99,
 14115           DFHEIV99,
 14116           DFHEIV99,
 14117           DFHEIV99
 14118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14119
 14120
 14121 7600-BROWSE-CLAIM.
 14122
 14123
 14124
 14125* EXEC CICS READ
 14126*        DATASET(ELMSTR-DSID)
 14127*        SET    (ADDRESS OF CLAIM-MASTER)
 14128*        RIDFLD (ELMSTR-KEY)
 14129*        GENERIC
 14130*        EQUAL
 14131*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14132*    END-EXEC.
 14133*    MOVE '&"S  KG    E          (   #00012789' TO DFHEIV0
 14134     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14135     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14136     MOVE X'2020233030303132373839' TO DFHEIV0(25:11)
 14137     CALL 'kxdfhei1' USING DFHEIV0,
 14138           ELMSTR-DSID,
 14139           DFHEIV20,
 14140           DFHEIV99,
 14141           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 273
* EL130.cbl
 14142           ELMSTR-GENERIC-LENGTH,
 14143           DFHEIV99,
 14144           DFHEIV99
 14145     SET ADDRESS OF CLAIM-MASTER TO
 14146         DFHEIV20
 14147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14148
 14149
 14150     MOVE CL-CERT-PRIME          TO CERTNOI.
 14151     MOVE CL-CERT-SFX            TO SUFXI.
 14152
 14153 7610-BROWSE-CLAIM-LOOP.
 14154
 14155     MOVE LOW-VALUES             TO BCERT1O
 14156                                    BSUFX1O
 14157                                    BCERT2O
 14158                                    BSUFX2O
 14159                                    BCERT3O
 14160                                    BSUFX3O
 14161                                    BCERT4O
 14162                                    BSUFX4O
 14163                                    BCERT5O
 14164                                    BSUFX5O.
 14165
 14166     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 14167
 14168
 14169
 14170* EXEC CICS HANDLE CONDITION
 14171*        ENDFILE  (7630-END-BROWSE)
 14172*    END-EXEC.
 14173*    MOVE '"$''                   ! I #00012817' TO DFHEIV0
 14174     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14175     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14176     MOVE X'4920233030303132383137' TO DFHEIV0(25:11)
 14177     CALL 'kxdfhei1' USING DFHEIV0
 14178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14179
 14180
 14181
 14182
 14183* EXEC CICS STARTBR
 14184*        DATASET    (ELMSTR-DSID)
 14185*        RIDFLD     (ELMSTR-KEY)
 14186*    END-EXEC.
 14187     MOVE 0
 14188       TO DFHEIV11
 14189*    MOVE '&,         G          &   #00012822' TO DFHEIV0
 14190     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14191     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14192     MOVE X'2020233030303132383232' TO DFHEIV0(25:11)
 14193     CALL 'kxdfhei1' USING DFHEIV0,
 14194           ELMSTR-DSID,
 14195           ELMSTR-KEY,
 14196           DFHEIV99,
 14197           DFHEIV11,
 14198           DFHEIV99
 14199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 274
* EL130.cbl
 14200
 14201
 14202     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 14203
 14204 7620-READ-CLAIM-LOOP.
 14205
 14206
 14207
 14208* EXEC CICS READNEXT
 14209*        DATASET   (ELMSTR-DSID)
 14210*        SET       (ADDRESS OF CLAIM-MASTER)
 14211*        RIDFLD    (ELMSTR-KEY)
 14212*    END-EXEC.
 14213     MOVE 0
 14214       TO DFHEIV11
 14215*    MOVE '&.S                   )   #00012832' TO DFHEIV0
 14216     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14217     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14218     MOVE X'2020233030303132383332' TO DFHEIV0(25:11)
 14219     CALL 'kxdfhei1' USING DFHEIV0,
 14220           ELMSTR-DSID,
 14221           DFHEIV20,
 14222           DFHEIV99,
 14223           ELMSTR-KEY,
 14224           DFHEIV99,
 14225           DFHEIV11,
 14226           DFHEIV99,
 14227           DFHEIV99
 14228     SET ADDRESS OF CLAIM-MASTER TO
 14229         DFHEIV20
 14230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14231
 14232
 14233     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 14234        CL-CARRIER     NOT = CLMCARRI       OR
 14235        CL-CLAIM-NO    NOT = CLMNOI
 14236          GO TO 7630-END-BROWSE
 14237     END-IF.
 14238
 14239     IF WS-ASSOCIATED-CERTS = 1
 14240         MOVE CL-CERT-PRIME      TO BCERT1O
 14241         MOVE CL-CERT-SFX        TO BSUFX1O
 14242     END-IF.
 14243
 14244     IF WS-ASSOCIATED-CERTS = 2
 14245         MOVE CL-CERT-PRIME      TO BCERT2O
 14246         MOVE CL-CERT-SFX        TO BSUFX2O
 14247     END-IF.
 14248
 14249     IF WS-ASSOCIATED-CERTS = 3
 14250         MOVE CL-CERT-PRIME      TO BCERT3O
 14251         MOVE CL-CERT-SFX        TO BSUFX3O
 14252     END-IF.
 14253
 14254     IF WS-ASSOCIATED-CERTS = 4
 14255         MOVE CL-CERT-PRIME      TO BCERT4O
 14256         MOVE CL-CERT-SFX        TO BSUFX4O
 14257     END-IF.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 275
* EL130.cbl
 14258
 14259     IF WS-ASSOCIATED-CERTS = 5
 14260         MOVE CL-CERT-PRIME      TO BCERT5O
 14261         MOVE CL-CERT-SFX        TO BSUFX5O
 14262     ELSE
 14263         ADD +1                  TO WS-ASSOCIATED-CERTS
 14264         GO TO 7620-READ-CLAIM-LOOP
 14265     END-IF.
 14266
 14267 7630-END-BROWSE.
 14268
 14269
 14270
 14271* EXEC CICS ENDBR
 14272*        DATASET   (ELMSTR-DSID)
 14273*    END-EXEC.
 14274     MOVE 0
 14275       TO DFHEIV11
 14276*    MOVE '&2                    $   #00012875' TO DFHEIV0
 14277     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14278     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14279     MOVE X'2020233030303132383735' TO DFHEIV0(25:11)
 14280     CALL 'kxdfhei1' USING DFHEIV0,
 14281           ELMSTR-DSID,
 14282           DFHEIV11,
 14283           DFHEIV99
 14284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14285
 14286
 14287 7640-HIGHLIGHT-CERT-DISPLAYED.
 14288
 14289     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 14290     MOVE AL-SANON               TO BCERT1A
 14291                                    BSUFX1A
 14292                                    BCERT2A
 14293                                    BSUFX2A
 14294                                    BCERT3A
 14295                                    BSUFX3A
 14296                                    BCERT4A
 14297                                    BSUFX4A
 14298                                    BCERT5A
 14299                                    BSUFX5A.
 14300
 14301     IF BCERT1O = CERTNOI AND
 14302        BSUFX1O = SUFXI
 14303            MOVE AL-SABON        TO BCERT1A
 14304                                    BSUFX1A
 14305     END-IF.
 14306
 14307     IF BCERT2O = CERTNOI AND
 14308        BSUFX2O = SUFXI
 14309            MOVE AL-SABON        TO BCERT2A
 14310                                    BSUFX2A
 14311     END-IF.
 14312
 14313     IF BCERT3O = CERTNOI AND
 14314        BSUFX3O = SUFXI
 14315            MOVE AL-SABON        TO BCERT3A
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 276
* EL130.cbl
 14316                                    BSUFX3A
 14317     END-IF.
 14318
 14319     IF BCERT4O = CERTNOI AND
 14320        BSUFX4O = SUFXI
 14321            MOVE AL-SABON        TO BCERT4A
 14322                                    BSUFX4A
 14323     END-IF.
 14324
 14325     IF BCERT5O = CERTNOI AND
 14326        BSUFX5O = SUFXI
 14327            MOVE AL-SABON        TO BCERT5A
 14328                                    BSUFX5A
 14329     END-IF.
 14330
 14331 7699-EXIT.
 14332     EXIT.
 14333
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 277
* EL130.cbl
 14335 7700-CHECK-SEQUENCE.
 14336
 14337
 14338
 14339* EXEC CICS HANDLE CONDITION
 14340*        ENDFILE  (7799-EXIT)
 14341*        NOTFND   (7799-EXIT)
 14342*    END-EXEC.
 14343*    MOVE '"$''I                  ! J #00012930' TO DFHEIV0
 14344     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 14345     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14346     MOVE X'4A20233030303132393330' TO DFHEIV0(25:11)
 14347     CALL 'kxdfhei1' USING DFHEIV0
 14348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14349
 14350
 14351
 14352
 14353* EXEC CICS READ
 14354*        DATASET(ELMSTR-DSID)
 14355*        SET    (ADDRESS OF CLAIM-MASTER)
 14356*        RIDFLD (ELMSTR-KEY)
 14357*        GENERIC
 14358*        EQUAL
 14359*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14360*    END-EXEC.
 14361*    MOVE '&"S  KG    E          (   #00012936' TO DFHEIV0
 14362     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14363     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14364     MOVE X'2020233030303132393336' TO DFHEIV0(25:11)
 14365     CALL 'kxdfhei1' USING DFHEIV0,
 14366           ELMSTR-DSID,
 14367           DFHEIV20,
 14368           DFHEIV99,
 14369           ELMSTR-KEY,
 14370           ELMSTR-GENERIC-LENGTH,
 14371           DFHEIV99,
 14372           DFHEIV99
 14373     SET ADDRESS OF CLAIM-MASTER TO
 14374         DFHEIV20
 14375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14376
 14377
 14378     COMPUTE WS-ASSOC-CERT-TOTAL =
 14379             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 14380
 14381     GO TO 7799-EXIT.
 14382
 14383 7710-RESEQUENCE-CLAIMS.
 14384
 14385
 14386
 14387* EXEC CICS HANDLE CONDITION
 14388*        ENDFILE  (7790-END-BROWSE)
 14389*    END-EXEC.
 14390*    MOVE '"$''                   ! K #00012953' TO DFHEIV0
 14391     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14392     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 278
* EL130.cbl
 14393     MOVE X'4B20233030303132393533' TO DFHEIV0(25:11)
 14394     CALL 'kxdfhei1' USING DFHEIV0
 14395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14396
 14397
 14398
 14399
 14400* EXEC CICS STARTBR
 14401*        DATASET    (ELMSTR-DSID)
 14402*        RIDFLD     (ELMSTR-KEY)
 14403*    END-EXEC.
 14404     MOVE 0
 14405       TO DFHEIV11
 14406*    MOVE '&,         G          &   #00012958' TO DFHEIV0
 14407     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14408     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14409     MOVE X'2020233030303132393538' TO DFHEIV0(25:11)
 14410     CALL 'kxdfhei1' USING DFHEIV0,
 14411           ELMSTR-DSID,
 14412           ELMSTR-KEY,
 14413           DFHEIV99,
 14414           DFHEIV11,
 14415           DFHEIV99
 14416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14417
 14418
 14419     ADD +1 TO WS-ASSOC-CERT-SEQU
 14420               WS-READNEXT-SWITCH.
 14421
 14422 7720-READ-CLAIM-LOOP.
 14423
 14424
 14425
 14426* EXEC CICS READNEXT
 14427*        DATASET   (ELMSTR-DSID)
 14428*        SET       (ADDRESS OF CLAIM-MASTER)
 14429*        RIDFLD    (ELMSTR-KEY)
 14430*    END-EXEC.
 14431     MOVE 0
 14432       TO DFHEIV11
 14433*    MOVE '&.S                   )   #00012969' TO DFHEIV0
 14434     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14435     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14436     MOVE X'2020233030303132393639' TO DFHEIV0(25:11)
 14437     CALL 'kxdfhei1' USING DFHEIV0,
 14438           ELMSTR-DSID,
 14439           DFHEIV20,
 14440           DFHEIV99,
 14441           ELMSTR-KEY,
 14442           DFHEIV99,
 14443           DFHEIV11,
 14444           DFHEIV99,
 14445           DFHEIV99
 14446     SET ADDRESS OF CLAIM-MASTER TO
 14447         DFHEIV20
 14448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14449
 14450
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 279
* EL130.cbl
 14451     IF WS-READNEXT-SWITCH = 1
 14452         ADD 1 TO WS-READNEXT-SWITCH
 14453         GO TO 7720-READ-CLAIM-LOOP
 14454     END-IF.
 14455
 14456 7730-END-BROWSE.
 14457
 14458
 14459
 14460* EXEC CICS ENDBR
 14461*        DATASET   (ELMSTR-DSID)
 14462*    END-EXEC.
 14463     MOVE 0
 14464       TO DFHEIV11
 14465*    MOVE '&2                    $   #00012983' TO DFHEIV0
 14466     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14467     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14468     MOVE X'2020233030303132393833' TO DFHEIV0(25:11)
 14469     CALL 'kxdfhei1' USING DFHEIV0,
 14470           ELMSTR-DSID,
 14471           DFHEIV11,
 14472           DFHEIV99
 14473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14474
 14475
 14476 7740-READ-CLAIM-UPDATE.
 14477
 14478     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 14479        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 14480        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 14481          GO TO 7799-EXIT
 14482     ELSE
 14483          MOVE ZERO              TO WS-READNEXT-SWITCH
 14484     END-IF.
 14485
 14486
 14487
 14488* EXEC CICS READ
 14489*        DATASET(ELMSTR-DSID)
 14490*        SET    (ADDRESS OF CLAIM-MASTER)
 14491*        RIDFLD (ELMSTR-KEY)
 14492*        UPDATE
 14493*    END-EXEC.
 14494*    MOVE '&"S        EU         (   #00012998' TO DFHEIV0
 14495     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14496     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14497     MOVE X'2020233030303132393938' TO DFHEIV0(25:11)
 14498     CALL 'kxdfhei1' USING DFHEIV0,
 14499           ELMSTR-DSID,
 14500           DFHEIV20,
 14501           DFHEIV99,
 14502           ELMSTR-KEY,
 14503           DFHEIV99,
 14504           DFHEIV99,
 14505           DFHEIV99
 14506     SET ADDRESS OF CLAIM-MASTER TO
 14507         DFHEIV20
 14508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 280
* EL130.cbl
 14509
 14510
 14511     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 14512     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 14513
 14514
 14515
 14516* EXEC CICS REWRITE
 14517*         DATASET     (ELMSTR-DSID)
 14518*         FROM        (CLAIM-MASTER)
 14519*    END-EXEC.
 14520     MOVE LENGTH OF
 14521      CLAIM-MASTER
 14522       TO DFHEIV11
 14523*    MOVE '&& L                  %   #00013009' TO DFHEIV0
 14524     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14525     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14526     MOVE X'2020233030303133303039' TO DFHEIV0(25:11)
 14527     CALL 'kxdfhei1' USING DFHEIV0,
 14528           ELMSTR-DSID,
 14529           CLAIM-MASTER,
 14530           DFHEIV11,
 14531           DFHEIV99
 14532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14533
 14534
 14535     GO TO 7710-RESEQUENCE-CLAIMS.
 14536
 14537 7790-END-BROWSE.
 14538
 14539
 14540
 14541* EXEC CICS ENDBR
 14542*        DATASET   (ELMSTR-DSID)
 14543*    END-EXEC.
 14544     MOVE 0
 14545       TO DFHEIV11
 14546*    MOVE '&2                    $   #00013019' TO DFHEIV0
 14547     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14548     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14549     MOVE X'2020233030303133303139' TO DFHEIV0(25:11)
 14550     CALL 'kxdfhei1' USING DFHEIV0,
 14551           ELMSTR-DSID,
 14552           DFHEIV11,
 14553           DFHEIV99
 14554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14555
 14556
 14557 7799-EXIT.
 14558     EXIT.
 14559
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 281
* EL130.cbl
 14561************************************************
 14562*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 14563************************************************
 14564
 14565 7900-READ-ACTV-UPDATE.
 14566     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14567     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14568     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14569     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14570     MOVE +0                     TO TRLR-SEQ-NO.
 14571     MOVE '1'                    TO TRLR-TYPE.
 14572     GO TO 7900-READ-TRAILER-UPDATE.
 14573
 14574 7900-READ-NINETY-UPDATE.
 14575     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14576     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14577     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14578     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14579     MOVE +90                    TO TRLR-SEQ-NO.
 14580     MOVE '6'                    TO TRLR-TYPE.
 14581
 14582 7900-READ-TRAILER-UPDATE.
 14583
 14584
 14585* EXEC CICS READ  UPDATE
 14586*        DATASET    (ELTRLR-DSID)
 14587*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 14588*        RIDFLD     (ELTRLR-KEY)
 14589*    END-EXEC.
 14590*    MOVE '&"S        EU         (   #00013050' TO DFHEIV0
 14591     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14592     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14593     MOVE X'2020233030303133303530' TO DFHEIV0(25:11)
 14594     CALL 'kxdfhei1' USING DFHEIV0,
 14595           ELTRLR-DSID,
 14596           DFHEIV20,
 14597           DFHEIV99,
 14598           ELTRLR-KEY,
 14599           DFHEIV99,
 14600           DFHEIV99,
 14601           DFHEIV99
 14602     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14603         DFHEIV20
 14604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14605
 14606
 14607 7900-EXIT.
 14608      EXIT.
 14609
 14610 7910-READ-ACTV.
 14611     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14612     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14613     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14614     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14615     MOVE +0                     TO TRLR-SEQ-NO.
 14616     MOVE '1'                    TO TRLR-TYPE.
 14617     GO TO 7910-READ-TRAILER.
 14618
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 282
* EL130.cbl
 14619 7910-READ-NINETY.
 14620     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14621     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14622     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14623     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14624     MOVE +90                    TO TRLR-SEQ-NO.
 14625     MOVE '6'                    TO TRLR-TYPE.
 14626
 14627 7910-READ-TRAILER.
 14628     MOVE 'TRLR'                 TO FILE-SWITCH.
 14629
 14630
 14631
 14632* EXEC CICS READ
 14633*        DATASET   (ELTRLR-DSID)
 14634*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14635*        RIDFLD    (ELTRLR-KEY)
 14636*    END-EXEC.
 14637*    MOVE '&"S        E          (   #00013080' TO DFHEIV0
 14638     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14639     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14640     MOVE X'2020233030303133303830' TO DFHEIV0(25:11)
 14641     CALL 'kxdfhei1' USING DFHEIV0,
 14642           ELTRLR-DSID,
 14643           DFHEIV20,
 14644           DFHEIV99,
 14645           ELTRLR-KEY,
 14646           DFHEIV99,
 14647           DFHEIV99,
 14648           DFHEIV99
 14649     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14650         DFHEIV20
 14651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14652
 14653
 14654 7910-EXIT.
 14655      EXIT.
 14656
 14657 7915-REWRITE-TRAILER.
 14658
 14659
 14660* EXEC CICS REWRITE
 14661*        DATASET   (ELTRLR-DSID)
 14662*        FROM      (ACTIVITY-TRAILERS)
 14663*    END-EXEC.
 14664     MOVE LENGTH OF
 14665      ACTIVITY-TRAILERS
 14666       TO DFHEIV11
 14667*    MOVE '&& L                  %   #00013091' TO DFHEIV0
 14668     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14669     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14670     MOVE X'2020233030303133303931' TO DFHEIV0(25:11)
 14671     CALL 'kxdfhei1' USING DFHEIV0,
 14672           ELTRLR-DSID,
 14673           ACTIVITY-TRAILERS,
 14674           DFHEIV11,
 14675           DFHEIV99
 14676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 283
* EL130.cbl
 14677
 14678
 14679 7915-EXIT.
 14680      EXIT.
 14681
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 284
* EL130.cbl
 14683********************************************
 14684*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 14685********************************************
 14686
 14687 7920-READ-CLAIM-UPDATE.
 14688
 14689
 14690
 14691* EXEC CICS READ
 14692*        UPDATE
 14693*        DATASET   (ELMSTR-DSID)
 14694*        SET       (ADDRESS OF CLAIM-MASTER)
 14695*        RIDFLD    (ELMSTR-KEY)
 14696*    END-EXEC.
 14697*    MOVE '&"S        EU         (   #00013107' TO DFHEIV0
 14698     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14699     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14700     MOVE X'2020233030303133313037' TO DFHEIV0(25:11)
 14701     CALL 'kxdfhei1' USING DFHEIV0,
 14702           ELMSTR-DSID,
 14703           DFHEIV20,
 14704           DFHEIV99,
 14705           ELMSTR-KEY,
 14706           DFHEIV99,
 14707           DFHEIV99,
 14708           DFHEIV99
 14709     SET ADDRESS OF CLAIM-MASTER TO
 14710         DFHEIV20
 14711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14712
 14713
 14714 7920-EXIT.
 14715      EXIT.
 14716
 14717 7950-READ-CLAIM.
 14718
 14719
 14720* EXEC CICS READ
 14721*        DATASET   (ELMSTR-DSID)
 14722*        SET       (ADDRESS OF CLAIM-MASTER)
 14723*        RIDFLD    (ELMSTR-KEY)
 14724*    END-EXEC.
 14725*    MOVE '&"S        E          (   #00013119' TO DFHEIV0
 14726     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14727     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14728     MOVE X'2020233030303133313139' TO DFHEIV0(25:11)
 14729     CALL 'kxdfhei1' USING DFHEIV0,
 14730           ELMSTR-DSID,
 14731           DFHEIV20,
 14732           DFHEIV99,
 14733           ELMSTR-KEY,
 14734           DFHEIV99,
 14735           DFHEIV99,
 14736           DFHEIV99
 14737     SET ADDRESS OF CLAIM-MASTER TO
 14738         DFHEIV20
 14739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14740
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 285
* EL130.cbl
 14741
 14742 7950-EXIT.
 14743      EXIT.
 14744
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 286
* EL130.cbl
 14746***************************************
 14747*  I/O REQUESTS AGAINST CONTROL FILE  *
 14748***************************************
 14749
 14750 7960-READ-CNTL-UPDATE.
 14751
 14752
 14753* EXEC CICS READ
 14754*        UPDATE
 14755*        DATASET  (ELCNTL-DSID)
 14756*        SET      (ADDRESS OF CONTROL-FILE)
 14757*        RIDFLD   (ELCNTL-KEY)
 14758*    END-EXEC.
 14759*    MOVE '&"S        EU         (   #00013135' TO DFHEIV0
 14760     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14761     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14762     MOVE X'2020233030303133313335' TO DFHEIV0(25:11)
 14763     CALL 'kxdfhei1' USING DFHEIV0,
 14764           ELCNTL-DSID,
 14765           DFHEIV20,
 14766           DFHEIV99,
 14767           ELCNTL-KEY,
 14768           DFHEIV99,
 14769           DFHEIV99,
 14770           DFHEIV99
 14771     SET ADDRESS OF CONTROL-FILE TO
 14772         DFHEIV20
 14773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14774
 14775
 14776 7960-EXIT.
 14777      EXIT.
 14778
 14779 7970-READ-CNTL.
 14780
 14781
 14782* EXEC CICS READ
 14783*        DATASET  (ELCNTL-DSID)
 14784*        SET      (ADDRESS OF CONTROL-FILE)
 14785*        RIDFLD   (ELCNTL-KEY)
 14786*    END-EXEC.
 14787*    MOVE '&"S        E          (   #00013147' TO DFHEIV0
 14788     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14789     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14790     MOVE X'2020233030303133313437' TO DFHEIV0(25:11)
 14791     CALL 'kxdfhei1' USING DFHEIV0,
 14792           ELCNTL-DSID,
 14793           DFHEIV20,
 14794           DFHEIV99,
 14795           ELCNTL-KEY,
 14796           DFHEIV99,
 14797           DFHEIV99,
 14798           DFHEIV99
 14799     SET ADDRESS OF CONTROL-FILE TO
 14800         DFHEIV20
 14801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14802
 14803
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 287
* EL130.cbl
 14804 7970-EXIT.
 14805      EXIT.
 14806
 14807 7975-READ-CNTL-GTEQ.
 14808
 14809
 14810* EXEC CICS READ
 14811*         DATASET   (ELCNTL-DSID)
 14812*         SET       (ADDRESS OF CONTROL-FILE)
 14813*         RIDFLD    (ELCNTL-KEY)
 14814*         GTEQ
 14815*     END-EXEC.
 14816*    MOVE '&"S        G          (   #00013158' TO DFHEIV0
 14817     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14818     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14819     MOVE X'2020233030303133313538' TO DFHEIV0(25:11)
 14820     CALL 'kxdfhei1' USING DFHEIV0,
 14821           ELCNTL-DSID,
 14822           DFHEIV20,
 14823           DFHEIV99,
 14824           ELCNTL-KEY,
 14825           DFHEIV99,
 14826           DFHEIV99,
 14827           DFHEIV99
 14828     SET ADDRESS OF CONTROL-FILE TO
 14829         DFHEIV20
 14830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14831
 14832
 14833 7975-EXIT.
 14834      EXIT.
 14835
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 288
* EL130.cbl
 14837**************************************************
 14838*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 14839**************************************************
 14840
 14841 7980-READ-CERT5.
 14842
 14843
 14844* EXEC CICS READ
 14845*         DATASET  (ELCERT5-DSID)
 14846*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14847*         RIDFLD   (ELCERT-KEY-5)
 14848*     END-EXEC.
 14849*    MOVE '&"S        E          (   #00013175' TO DFHEIV0
 14850     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14851     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14852     MOVE X'2020233030303133313735' TO DFHEIV0(25:11)
 14853     CALL 'kxdfhei1' USING DFHEIV0,
 14854           ELCERT5-DSID,
 14855           DFHEIV20,
 14856           DFHEIV99,
 14857           ELCERT-KEY-5,
 14858           DFHEIV99,
 14859           DFHEIV99,
 14860           DFHEIV99
 14861     SET ADDRESS OF CERTIFICATE-MASTER TO
 14862         DFHEIV20
 14863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14864
 14865
 14866 7980-EXIT.
 14867      EXIT.
 14868
 14869 7930-READ-CERT-UPDATE.
 14870
 14871
 14872* EXEC CICS READ
 14873*        DATASET  (ELCERT-DSID)
 14874*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 14875*        RIDFLD   (ELCERT-KEY)
 14876*        UPDATE
 14877*    END-EXEC.
 14878*    MOVE '&"S        EU         (   #00013186' TO DFHEIV0
 14879     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14880     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14881     MOVE X'2020233030303133313836' TO DFHEIV0(25:11)
 14882     CALL 'kxdfhei1' USING DFHEIV0,
 14883           ELCERT-DSID,
 14884           DFHEIV20,
 14885           DFHEIV99,
 14886           ELCERT-KEY,
 14887           DFHEIV99,
 14888           DFHEIV99,
 14889           DFHEIV99
 14890     SET ADDRESS OF CERTIFICATE-MASTER TO
 14891         DFHEIV20
 14892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14893
 14894
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 289
* EL130.cbl
 14895 7930-EXIT.
 14896      EXIT.
 14897
 14898 7940-READ-CERT.
 14899
 14900
 14901* EXEC CICS READ
 14902*        DATASET  (ELCERT-DSID)
 14903*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 14904*        RIDFLD   (ELCERT-KEY)
 14905*    END-EXEC.
 14906*    MOVE '&"S        E          (   #00013198' TO DFHEIV0
 14907     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14908     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14909     MOVE X'2020233030303133313938' TO DFHEIV0(25:11)
 14910     CALL 'kxdfhei1' USING DFHEIV0,
 14911           ELCERT-DSID,
 14912           DFHEIV20,
 14913           DFHEIV99,
 14914           ELCERT-KEY,
 14915           DFHEIV99,
 14916           DFHEIV99,
 14917           DFHEIV99
 14918     SET ADDRESS OF CERTIFICATE-MASTER TO
 14919         DFHEIV20
 14920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14921
 14922
 14923 7940-EXIT.
 14924      EXIT.
 14925
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 290
* EL130.cbl
 14927**************************************************
 14928*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 14929**************************************************
 14930
 14931 7991-READ-BENE.
 14932
 14933
 14934* EXEC CICS READ
 14935*         DATASET   (ELBENE-DSID)
 14936*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 14937*         RIDFLD    (ELBENE-KEY)
 14938*     END-EXEC.
 14939*    MOVE '&"S        E          (   #00013214' TO DFHEIV0
 14940     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14942     MOVE X'2020233030303133323134' TO DFHEIV0(25:11)
 14943     CALL 'kxdfhei1' USING DFHEIV0,
 14944           ELBENE-DSID,
 14945           DFHEIV20,
 14946           DFHEIV99,
 14947           ELBENE-KEY,
 14948           DFHEIV99,
 14949           DFHEIV99,
 14950           DFHEIV99
 14951     SET ADDRESS OF BENEFICIARY-MASTER TO
 14952         DFHEIV20
 14953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14954
 14955
 14956 7991-EXIT.
 14957      EXIT.
 14958
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 291
* EL130.cbl
 14960**************************************************
 14961*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 14962**************************************************
 14963
 14964 7992-READ-REIN.
 14965
 14966
 14967
 14968* EXEC CICS HANDLE CONDITION
 14969*        NOTFND   (7992-NOT-FOUND)
 14970*    END-EXEC.
 14971*    MOVE '"$I                   ! L #00013231' TO DFHEIV0
 14972     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14973     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14974     MOVE X'4C20233030303133323331' TO DFHEIV0(25:11)
 14975     CALL 'kxdfhei1' USING DFHEIV0
 14976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14977
 14978
 14979
 14980
 14981* EXEC CICS READ
 14982*        DATASET   (ERREIN-DSID)
 14983*        SET       (ADDRESS OF REINSURANCE-RECORD)
 14984*        RIDFLD    (ERREIN-KEY)
 14985*    END-EXEC.
 14986*    MOVE '&"S        E          (   #00013236' TO DFHEIV0
 14987     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14988     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14989     MOVE X'2020233030303133323336' TO DFHEIV0(25:11)
 14990     CALL 'kxdfhei1' USING DFHEIV0,
 14991           ERREIN-DSID,
 14992           DFHEIV20,
 14993           DFHEIV99,
 14994           ERREIN-KEY,
 14995           DFHEIV99,
 14996           DFHEIV99,
 14997           DFHEIV99
 14998     SET ADDRESS OF REINSURANCE-RECORD TO
 14999         DFHEIV20
 15000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15001
 15002
 15003     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 15004
 15005     GO TO 7992-EXIT.
 15006
 15007 7992-NOT-FOUND.
 15008     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 15009
 15010 7992-EXIT.
 15011     EXIT.
 15012
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 292
* EL130.cbl
 15014 8000-LOAD-ERROR-MESSAGES.
 15015     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 15016
 15017     IF EMI-NO-ERRORS
 15018         GO TO 8000-EXIT
 15019     END-IF.
 15020
 15021     IF EMI-NUMBER-OF-LINES = 1
 15022         MOVE EMI-LINE1          TO ERRMSG1O
 15023         GO TO 8000-EXIT
 15024     END-IF.
 15025
 15026     IF EMI-NUMBER-OF-LINES = 2
 15027          MOVE EMI-LINE1         TO ERRMSG1O
 15028          MOVE EMI-LINE2         TO ERRMSG2O
 15029          GO TO 8000-EXIT
 15030     END-IF.
 15031
 15032     MOVE EMI-LINE1              TO ERRMSG1O.
 15033
 15034 8000-EXIT.
 15035     EXIT.
 15036
 15037 8100-SEND-INITIAL-MAP.
 15038     MOVE SAVE-DATE              TO RUNDTEO.
 15039     MOVE EIBTIME                TO TIME-IN.
 15040     MOVE TIME-OUT               TO RUNTIMEO.
 15041     IF RETURNED-FROM = XCTL-114
 15042        CONTINUE
 15043     ELSE
 15044        MOVE -1                  TO MAINTL
 15045     END-IF.
 15046
 15047*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15048         MOVE SPACES             TO PRODO.
 15049         MOVE AL-SANOF           TO PRODCDA.
 15050*    END-IF.
 15051
 15052     MOVE PI-COMPANY-ID          TO COMPO.
 15053     MOVE AL-PABOF               TO COMPA.
 15054     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15055     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15056     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15057
 15058     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15059
 15060     IF NOT PI-NO-CARRIER-SECURITY
 15061        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 15062        MOVE AL-SABOF            TO CLMCARRA
 15063     END-IF.
 15064
 15065     IF PI-PROCESSOR-ID = 'PEMA'
 15066        MOVE AL-UANON            TO CERTNOA
 15067                                    SUFXA
 15068     END-IF.
 15069*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15070*        NEXT SENTENCE
 15071*        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 293
* EL130.cbl
 15072*    ELSE
 15073         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15074*    END-IF.
 15075
 15076
 15077
 15078* EXEC CICS SEND
 15079*        MAP     (MAP-NAME)
 15080*        MAPSET  (MAPSET-NAME)
 15081*        FROM    (EL130AO)
 15082*        ERASE
 15083*        CURSOR
 15084*    END-EXEC.
 15085     MOVE LENGTH OF
 15086      EL130AO
 15087       TO DFHEIV12
 15088     MOVE -1
 15089       TO DFHEIV11
 15090*    MOVE '8$     CT  E    H L F ,   #00013316' TO DFHEIV0
 15091     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15092     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15093     MOVE X'2020233030303133333136' TO DFHEIV0(25:11)
 15094     CALL 'kxdfhei1' USING DFHEIV0,
 15095           MAP-NAME,
 15096           EL130AO,
 15097           DFHEIV12,
 15098           MAPSET-NAME,
 15099           DFHEIV99,
 15100           DFHEIV99,
 15101           DFHEIV99,
 15102           DFHEIV11,
 15103           DFHEIV99,
 15104           DFHEIV99,
 15105           DFHEIV99
 15106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15107
 15108
 15109     GO TO 9100-RETURN-TRAN.
 15110
 15111 8150-SEND-MAP-CURSOR.
 15112     MOVE SAVE-DATE              TO RUNDTEO.
 15113     MOVE EIBTIME                TO TIME-IN.
 15114     MOVE TIME-OUT               TO RUNTIMEO.
 15115     MOVE PI-COMPANY-ID          TO COMPO.
 15116     MOVE AL-PABOF               TO COMPA
 15117     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15118     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15119     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15120
 15121*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15122         MOVE SPACES             TO PRODO.
 15123         MOVE AL-SANOF           TO PRODCDA.
 15124*    END-IF.
 15125
 15126     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15127
 15128     IF NOT PI-NO-CARRIER-SECURITY
 15129         MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 294
* EL130.cbl
 15130         MOVE AL-SABOF            TO CLMCARRA
 15131     END-IF.
 15132
 15133     IF PI-PROCESSOR-ID = 'PEMA'
 15134        MOVE AL-UANON            TO CERTNOA
 15135                                    SUFXA
 15136     END-IF.
 15137*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15138*        NEXT SENTENCE
 15139*        CONTINUE
 15140*    ELSE
 15141         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15142*    END-IF.
 15143
 15144
 15145
 15146* EXEC CICS SEND
 15147*        MAP      (MAP-NAME)
 15148*        MAPSET   (MAPSET-NAME)
 15149*        FROM     (EL130AO)
 15150*        CURSOR   (PI-CURSOR)
 15151*        ERASE
 15152*    END-EXEC.
 15153     MOVE LENGTH OF
 15154      EL130AO
 15155       TO DFHEIV11
 15156*    MOVE '8$     CT  E    H L F ,   #00013360' TO DFHEIV0
 15157     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15158     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15159     MOVE X'2020233030303133333630' TO DFHEIV0(25:11)
 15160     CALL 'kxdfhei1' USING DFHEIV0,
 15161           MAP-NAME,
 15162           EL130AO,
 15163           DFHEIV11,
 15164           MAPSET-NAME,
 15165           DFHEIV99,
 15166           DFHEIV99,
 15167           DFHEIV99,
 15168           PI-CURSOR,
 15169           DFHEIV99,
 15170           DFHEIV99,
 15171           DFHEIV99
 15172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15173
 15174
 15175     GO TO 9100-RETURN-TRAN.
 15176
 15177 8200-SEND-DATAONLY.
 15178     IF EIBAID = DFHPF11
 15179        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 15180        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15181     END-IF.
 15182
 15183     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15184
 15185 8200-BYPASS-ERROR.
 15186     MOVE SAVE-DATE              TO RUNDTEO.
 15187     MOVE EIBTIME                TO TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 295
* EL130.cbl
 15188     MOVE TIME-OUT               TO RUNTIMEO.
 15189     MOVE PI-COMPANY-ID          TO COMPO.
 15190     MOVE AL-PABOF               TO COMPA
 15191     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15192
 15193*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15194         MOVE SPACES             TO PRODO.
 15195         MOVE AL-SANOF           TO PRODCDA.
 15196*    END-IF.
 15197
 15198     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15199     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15200
 15201     IF PI-PROCESSOR-ID = 'PEMA'
 15202        MOVE AL-UANON            TO CERTNOA
 15203                                    SUFXA
 15204     END-IF.
 15205     IF NOT PI-NO-CARRIER-SECURITY
 15206        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 15207        MOVE AL-SABOF            TO CLMCARRA
 15208     END-IF.
 15209
 15210*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15211*        NEXT SENTENCE
 15212*        CONTINUE
 15213*    ELSE
 15214         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15215*    END-IF.
 15216
 15217*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 15218         MOVE AL-SANOF           TO PRODCDA.
 15219*    END-IF.
 15220
 15221
 15222
 15223* EXEC CICS SEND
 15224*        MAP      (MAP-NAME)
 15225*        MAPSET   (MAPSET-NAME)
 15226*        FROM     (EL130AO)
 15227*        DATAONLY
 15228*        CURSOR
 15229*    END-EXEC.
 15230     MOVE LENGTH OF
 15231      EL130AO
 15232       TO DFHEIV12
 15233     MOVE -1
 15234       TO DFHEIV11
 15235*    MOVE '8$D    CT       H L F ,   #00013415' TO DFHEIV0
 15236     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15237     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15238     MOVE X'2020233030303133343135' TO DFHEIV0(25:11)
 15239     CALL 'kxdfhei1' USING DFHEIV0,
 15240           MAP-NAME,
 15241           EL130AO,
 15242           DFHEIV12,
 15243           MAPSET-NAME,
 15244           DFHEIV99,
 15245           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 296
* EL130.cbl
 15246           DFHEIV99,
 15247           DFHEIV11,
 15248           DFHEIV99,
 15249           DFHEIV99,
 15250           DFHEIV99
 15251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15252
 15253
 15254     GO TO 9100-RETURN-TRAN.
 15255
 15256 8300-SEND-TEXT.
 15257
 15258
 15259* EXEC CICS SEND TEXT
 15260*        FROM     (LOGOFF-TEXT)
 15261*        LENGTH   (LOGOFF-LENGTH)
 15262*        ERASE
 15263*        FREEKB
 15264*    END-EXEC.
 15265*    MOVE '8&      T  E F  H   F -   #00013427' TO DFHEIV0
 15266     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 15267     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 15268     MOVE X'2020233030303133343237' TO DFHEIV0(25:11)
 15269     CALL 'kxdfhei1' USING DFHEIV0,
 15270           LOGOFF-TEXT,
 15271           LOGOFF-LENGTH,
 15272           DFHEIV99,
 15273           DFHEIV99,
 15274           DFHEIV99,
 15275           DFHEIV99,
 15276           DFHEIV99,
 15277           DFHEIV99,
 15278           DFHEIV99,
 15279           DFHEIV99,
 15280           DFHEIV99,
 15281           DFHEIV99
 15282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15283
 15284
 15285
 15286
 15287* EXEC CICS RETURN
 15288*    END-EXEC.
 15289*    MOVE '.(                    &   #00013435' TO DFHEIV0
 15290     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15291     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15292     MOVE X'2020233030303133343335' TO DFHEIV0(25:11)
 15293     CALL 'kxdfhei1' USING DFHEIV0,
 15294           DFHEIV99,
 15295           DFHEIV99,
 15296           DFHEIV99,
 15297           DFHEIV99,
 15298           DFHEIV99
 15299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15300
 15301
 15302 8800-UNAUTHORIZED-ACCESS.
 15303     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 297
* EL130.cbl
 15304     GO TO 8300-SEND-TEXT.
 15305
 15306 8810-PF23.
 15307     MOVE EIBAID TO PI-ENTRY-CD-1.
 15308     MOVE XCTL-005               TO PGM-NAME.
 15309     GO TO 9300-XCTL.
 15310
 15311 8820-TERM-ERROR.
 15312     MOVE ER-0412                TO EMI-ERROR.
 15313     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15314     MOVE -1                     TO MAINTL.
 15315     GO TO 8200-SEND-DATAONLY.
 15316
 15317 8830-TRAN-ERROR.
 15318     MOVE ER-0413                TO EMI-ERROR.
 15319     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15320     MOVE -1                     TO MAINTL.
 15321     GO TO 8200-SEND-DATAONLY.
 15322
 15323 9000-RETURN-CICS.
 15324
 15325
 15326* EXEC CICS RETURN
 15327*    END-EXEC.
 15328*    MOVE '.(                    &   #00013461' TO DFHEIV0
 15329     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15330     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15331     MOVE X'2020233030303133343631' TO DFHEIV0(25:11)
 15332     CALL 'kxdfhei1' USING DFHEIV0,
 15333           DFHEIV99,
 15334           DFHEIV99,
 15335           DFHEIV99,
 15336           DFHEIV99,
 15337           DFHEIV99
 15338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15339
 15340
 15341 9100-RETURN-TRAN.
 15342     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 15343     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 15344
 15345
 15346
 15347* EXEC CICS RETURN
 15348*        TRANSID   (TRANS-ID)
 15349*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 15350*        LENGTH    (PI-COMM-LENGTH)
 15351*    END-EXEC.
 15352*    MOVE '.(CT                  &   #00013469' TO DFHEIV0
 15353     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 15354     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15355     MOVE X'2020233030303133343639' TO DFHEIV0(25:11)
 15356     CALL 'kxdfhei1' USING DFHEIV0,
 15357           TRANS-ID,
 15358           PROGRAM-INTERFACE-BLOCK,
 15359           PI-COMM-LENGTH,
 15360           DFHEIV99,
 15361           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 298
* EL130.cbl
 15362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15363
 15364
 15365 9200-RETURN-MAIN-MENU.
 15366     MOVE XCTL-126               TO PGM-NAME.
 15367     GO TO 9300-XCTL.
 15368
 15369 9300-XCTL.
 15370
 15371
 15372* EXEC CICS XCTL
 15373*        PROGRAM   (PGM-NAME)
 15374*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 15375*        LENGTH    (PI-COMM-LENGTH)
 15376*    END-EXEC.
 15377*    MOVE '.$C                   $   #00013481' TO DFHEIV0
 15378     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 15379     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15380     MOVE X'2020233030303133343831' TO DFHEIV0(25:11)
 15381     CALL 'kxdfhei1' USING DFHEIV0,
 15382           PGM-NAME,
 15383           PROGRAM-INTERFACE-BLOCK,
 15384           PI-COMM-LENGTH
 15385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15386
 15387
 15388 9400-CLEAR.
 15389     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 15390     GO TO 9300-XCTL.
 15391
 15392 9500-PF12.
 15393     MOVE XCTL-010               TO PGM-NAME.
 15394     GO TO 9300-XCTL.
 15395
 15396 9600-PGMID-ERROR.
 15397
 15398
 15399* EXEC CICS HANDLE CONDITION
 15400*        PGMIDERR  (8300-SEND-TEXT)
 15401*    END-EXEC.
 15402*    MOVE '"$L                   ! M #00013497' TO DFHEIV0
 15403     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 15404     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15405     MOVE X'4D20233030303133343937' TO DFHEIV0(25:11)
 15406     CALL 'kxdfhei1' USING DFHEIV0
 15407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15408
 15409
 15410     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 15411     MOVE ' '                    TO PI-ENTRY-CD-1.
 15412     MOVE XCTL-005               TO PGM-NAME.
 15413     MOVE PGM-NAME               TO LOGOFF-PGM.
 15414     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 15415     GO TO 9300-XCTL.
 15416
 15417 9700-LINK-DATE-CONVERT.
 15418     MOVE LINK-ELDATCV           TO PGM-NAME.
 15419
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 299
* EL130.cbl
 15420
 15421* EXEC CICS LINK
 15422*        PROGRAM    (PGM-NAME)
 15423*        COMMAREA   (DATE-CONVERSION-DATA)
 15424*        LENGTH     (DC-COMM-LENGTH)
 15425*    END-EXEC.
 15426*    MOVE '."C                   ''   #00013511' TO DFHEIV0
 15427     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15428     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15429     MOVE X'2020233030303133353131' TO DFHEIV0(25:11)
 15430     CALL 'kxdfhei1' USING DFHEIV0,
 15431           PGM-NAME,
 15432           DATE-CONVERSION-DATA,
 15433           DC-COMM-LENGTH,
 15434           DFHEIV99,
 15435           DFHEIV99,
 15436           DFHEIV99
 15437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15438
 15439
 15440 9700-EXIT.
 15441     EXIT.
 15442
 15443 9800-LINK-REM-TERM.
 15444     MOVE LINK-ELRTRM            TO PGM-NAME.
 15445
 15446
 15447* EXEC CICS LINK
 15448*        PROGRAM    (PGM-NAME)
 15449*        COMMAREA   (CALCULATION-PASS-AREA)
 15450*        LENGTH     (CP-COMM-LENGTH)
 15451*    END-EXEC.
 15452*    MOVE '."C                   ''   #00013523' TO DFHEIV0
 15453     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15454     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15455     MOVE X'2020233030303133353233' TO DFHEIV0(25:11)
 15456     CALL 'kxdfhei1' USING DFHEIV0,
 15457           PGM-NAME,
 15458           CALCULATION-PASS-AREA,
 15459           CP-COMM-LENGTH,
 15460           DFHEIV99,
 15461           DFHEIV99,
 15462           DFHEIV99
 15463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15464
 15465
 15466 9800-EXIT.
 15467     EXIT.
 15468
 15469 9900-ERROR-FORMAT.
 15470     IF NOT EMI-ERRORS-COMPLETE
 15471         MOVE LINK-001           TO PGM-NAME
 15472
 15473* EXEC CICS LINK
 15474*            PROGRAM   (PGM-NAME)
 15475*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 15476*            LENGTH    (EMI-COMM-LENGTH)
 15477*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 300
* EL130.cbl
 15478*    MOVE '."C                   ''   #00013535' TO DFHEIV0
 15479     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15480     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15481     MOVE X'2020233030303133353335' TO DFHEIV0(25:11)
 15482     CALL 'kxdfhei1' USING DFHEIV0,
 15483           PGM-NAME,
 15484           ERROR-MESSAGE-INTERFACE-BLOCK,
 15485           EMI-COMM-LENGTH,
 15486           DFHEIV99,
 15487           DFHEIV99,
 15488           DFHEIV99
 15489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15490     END-IF.
 15491
 15492 9900-EXIT.
 15493     EXIT.
 15494
 15495 9990-ABEND.
 15496     MOVE -1                     TO MAINTL.
 15497     MOVE LINK-004               TO PGM-NAME.
 15498     MOVE DFHEIBLK               TO EMI-LINE1.
 15499
 15500
 15501* EXEC CICS LINK
 15502*        PROGRAM   (PGM-NAME)
 15503*        COMMAREA  (EMI-LINE1)
 15504*        LENGTH    (72)
 15505*    END-EXEC.
 15506     MOVE 72
 15507       TO DFHEIV11
 15508*    MOVE '."C                   ''   #00013550' TO DFHEIV0
 15509     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15510     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15511     MOVE X'2020233030303133353530' TO DFHEIV0(25:11)
 15512     CALL 'kxdfhei1' USING DFHEIV0,
 15513           PGM-NAME,
 15514           EMI-LINE1,
 15515           DFHEIV11,
 15516           DFHEIV99,
 15517           DFHEIV99,
 15518           DFHEIV99
 15519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15520
 15521
 15522     MOVE EMI-LINE1              TO ERRMSG2O.
 15523
 15524     GO TO 8200-BYPASS-ERROR.
 15525
 15526
 15527
 15528* GOBACK.
 15529     MOVE '9%                    "   ' TO DFHEIV0
 15530     MOVE 'EL130' TO DFHEIV1
 15531     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15532     GOBACK.
 15533
 15534 9995-SECURITY-VIOLATION.
 15535*             COPY ELCSCTP.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 301
* EL130.cbl
 15536******************************************************************
 15537*                                                                *
 15538*                            ELCSCTP                             *
 15539*                            VMOD=2.001                          *
 15540*                                                                *
 15541*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 15542******************************************************************
 15543
 15544
 15545     MOVE EIBDATE          TO SM-JUL-DATE.
 15546     MOVE EIBTRMID         TO SM-TERMID.
 15547     MOVE THIS-PGM         TO SM-PGM.
 15548     MOVE EIBTIME          TO TIME-IN.
 15549     MOVE TIME-OUT         TO SM-TIME.
 15550     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 15551
 15552
 15553* EXEC CICS LINK
 15554*         PROGRAM  ('EL003')
 15555*         COMMAREA (SECURITY-MESSAGE)
 15556*         LENGTH   (80)
 15557*    END-EXEC.
 15558     MOVE 'EL003' TO DFHEIV1
 15559     MOVE 80
 15560       TO DFHEIV11
 15561*    MOVE '."C                   ''   #00013581' TO DFHEIV0
 15562     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15563     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15564     MOVE X'2020233030303133353831' TO DFHEIV0(25:11)
 15565     CALL 'kxdfhei1' USING DFHEIV0,
 15566           DFHEIV1,
 15567           SECURITY-MESSAGE,
 15568           DFHEIV11,
 15569           DFHEIV99,
 15570           DFHEIV99,
 15571           DFHEIV99
 15572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15573
 15574
 15575******************************************************************
 15576
 15577
 15578 9995-EXIT.
 15579     EXIT.
 15580
 15581
 15582 9999-DFHBACK SECTION.
 15583     MOVE '9%                    "   ' TO DFHEIV0
 15584     MOVE 'EL130' TO DFHEIV1
 15585     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15586     GOBACK.
 15587 9999-DFHEXIT.
 15588     IF DFHEIGDJ EQUAL 0001
 15589         NEXT SENTENCE
 15590     ELSE IF DFHEIGDJ EQUAL 2
 15591         GO TO 0100-TEST-ENTRY,
 15592               8100-SEND-INITIAL-MAP,
 15593               9600-PGMID-ERROR,
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 302
* EL130.cbl
 15594               8820-TERM-ERROR,
 15595               8830-TRAN-ERROR,
 15596               9990-ABEND
 15597         DEPENDING ON DFHEIGDI
 15598     ELSE IF DFHEIGDJ EQUAL 3
 15599         GO TO 0450-ADD-ELACTQ-RECORD
 15600         DEPENDING ON DFHEIGDI
 15601     ELSE IF DFHEIGDJ EQUAL 4
 15602         GO TO 8820-TERM-ERROR,
 15603               8830-TRAN-ERROR
 15604         DEPENDING ON DFHEIGDI
 15605     ELSE IF DFHEIGDJ EQUAL 5
 15606         GO TO 0660-NOT-FOUND,
 15607               0670-QIDERR
 15608         DEPENDING ON DFHEIGDI
 15609     ELSE IF DFHEIGDJ EQUAL 6
 15610         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15611         DEPENDING ON DFHEIGDI
 15612     ELSE IF DFHEIGDJ EQUAL 7
 15613         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15614         DEPENDING ON DFHEIGDI
 15615     ELSE IF DFHEIGDJ EQUAL 8
 15616         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15617         DEPENDING ON DFHEIGDI
 15618     ELSE IF DFHEIGDJ EQUAL 9
 15619         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15620         DEPENDING ON DFHEIGDI
 15621     ELSE IF DFHEIGDJ EQUAL 10
 15622         GO TO 2050-DELETE-NOT-FOUND
 15623         DEPENDING ON DFHEIGDI
 15624     ELSE IF DFHEIGDJ EQUAL 11
 15625         GO TO 2010-DELETE-CL
 15626         DEPENDING ON DFHEIGDI
 15627     ELSE IF DFHEIGDJ EQUAL 12
 15628         GO TO 3010-TEST-FOR-ERRORS
 15629         DEPENDING ON DFHEIGDI
 15630     ELSE IF DFHEIGDJ EQUAL 13
 15631         GO TO 3008-DUP-ERROR,
 15632               3009-NOT-FOUND
 15633         DEPENDING ON DFHEIGDI
 15634     ELSE IF DFHEIGDJ EQUAL 14
 15635         GO TO 3030-BUILD-CONT
 15636         DEPENDING ON DFHEIGDI
 15637     ELSE IF DFHEIGDJ EQUAL 15
 15638         GO TO 3033-ACCT-NOT-FOUND,
 15639               3033-ACCT-NOT-FOUND
 15640         DEPENDING ON DFHEIGDI
 15641     ELSE IF DFHEIGDJ EQUAL 16
 15642         GO TO 3032-NOT-IN-DT-RANGE
 15643         DEPENDING ON DFHEIGDI
 15644     ELSE IF DFHEIGDJ EQUAL 17
 15645         GO TO 3070-BUILD-CONT
 15646         DEPENDING ON DFHEIGDI
 15647     ELSE IF DFHEIGDJ EQUAL 18
 15648         GO TO 3065-CERT-NOT-FOUND
 15649         DEPENDING ON DFHEIGDI
 15650     ELSE IF DFHEIGDJ EQUAL 19
 15651         GO TO 3100-CARRIER-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 303
* EL130.cbl
 15652         DEPENDING ON DFHEIGDI
 15653     ELSE IF DFHEIGDJ EQUAL 20
 15654         GO TO 3110-COMPANY-NOT-FOUND
 15655         DEPENDING ON DFHEIGDI
 15656     ELSE IF DFHEIGDJ EQUAL 21
 15657         GO TO 3200-BUILD-ZERO-TRAILER
 15658         DEPENDING ON DFHEIGDI
 15659     ELSE IF DFHEIGDJ EQUAL 22
 15660         GO TO 9999-DFHBACK
 15661         DEPENDING ON DFHEIGDI
 15662     ELSE IF DFHEIGDJ EQUAL 23
 15663         GO TO 3290-NO-INSURED-ADDRESS
 15664         DEPENDING ON DFHEIGDI
 15665     ELSE IF DFHEIGDJ EQUAL 24
 15666         GO TO 3410-DUP-KEY
 15667         DEPENDING ON DFHEIGDI
 15668     ELSE IF DFHEIGDJ EQUAL 25
 15669         GO TO 3690-CERT-WRITTEN
 15670         DEPENDING ON DFHEIGDI
 15671     ELSE IF DFHEIGDJ EQUAL 26
 15672         GO TO 3850-CLAIM-MSTR-WRITTEN
 15673         DEPENDING ON DFHEIGDI
 15674     ELSE IF DFHEIGDJ EQUAL 27
 15675         GO TO 5050-CERT-NOT-FOUND
 15676         DEPENDING ON DFHEIGDI
 15677     ELSE IF DFHEIGDJ EQUAL 28
 15678         GO TO 5030-CERT-WRITTEN
 15679         DEPENDING ON DFHEIGDI
 15680     ELSE IF DFHEIGDJ EQUAL 29
 15681         GO TO 5035-CLAIM-WRITTEN
 15682         DEPENDING ON DFHEIGDI
 15683     ELSE IF DFHEIGDJ EQUAL 30
 15684         GO TO 9990-ABEND,
 15685               5799-EXIT
 15686         DEPENDING ON DFHEIGDI
 15687     ELSE IF DFHEIGDJ EQUAL 31
 15688         GO TO 3100-CARRIER-NOT-FOUND
 15689         DEPENDING ON DFHEIGDI
 15690     ELSE IF DFHEIGDJ EQUAL 32
 15691         GO TO 6040-NO-PROCESSOR-RECORD
 15692         DEPENDING ON DFHEIGDI
 15693     ELSE IF DFHEIGDJ EQUAL 33
 15694         GO TO 6060-NO-BENEFICIARY-RECORD
 15695         DEPENDING ON DFHEIGDI
 15696     ELSE IF DFHEIGDJ EQUAL 34
 15697         GO TO 6499-EXIT,
 15698               6499-EXIT
 15699         DEPENDING ON DFHEIGDI
 15700     ELSE IF DFHEIGDJ EQUAL 35
 15701         GO TO 6600-NOT-FOUND
 15702         DEPENDING ON DFHEIGDI
 15703     ELSE IF DFHEIGDJ EQUAL 36
 15704         GO TO 6700-NOTOPEN-ERROR,
 15705               6700-EXIT
 15706         DEPENDING ON DFHEIGDI
 15707     ELSE IF DFHEIGDJ EQUAL 37
 15708         GO TO 7120-NOT-FOUND
 15709         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 304
* EL130.cbl
 15710     ELSE IF DFHEIGDJ EQUAL 38
 15711         GO TO 7499-EXIT
 15712         DEPENDING ON DFHEIGDI
 15713     ELSE IF DFHEIGDJ EQUAL 39
 15714         GO TO 7500-EXIT,
 15715               7500-DUPLICATE-KEY,
 15716               7500-EXIT
 15717         DEPENDING ON DFHEIGDI
 15718     ELSE IF DFHEIGDJ EQUAL 40
 15719         GO TO 7500-END-BROWSE
 15720         DEPENDING ON DFHEIGDI
 15721     ELSE IF DFHEIGDJ EQUAL 41
 15722         GO TO 7630-END-BROWSE
 15723         DEPENDING ON DFHEIGDI
 15724     ELSE IF DFHEIGDJ EQUAL 42
 15725         GO TO 7799-EXIT,
 15726               7799-EXIT
 15727         DEPENDING ON DFHEIGDI
 15728     ELSE IF DFHEIGDJ EQUAL 43
 15729         GO TO 7790-END-BROWSE
 15730         DEPENDING ON DFHEIGDI
 15731     ELSE IF DFHEIGDJ EQUAL 44
 15732         GO TO 7992-NOT-FOUND
 15733         DEPENDING ON DFHEIGDI
 15734     ELSE IF DFHEIGDJ EQUAL 45
 15735         GO TO 8300-SEND-TEXT
 15736         DEPENDING ON DFHEIGDI.
 15737     MOVE '9%                    "   ' TO DFHEIV0
 15738     MOVE 'EL130' TO DFHEIV1
 15739     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15740     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       10512     Code:       49637
