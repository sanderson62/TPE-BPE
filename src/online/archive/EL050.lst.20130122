* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44******************************************************************
    45 ENVIRONMENT DIVISION.
    46
    47 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page   3
* EL050.cbl
    49 WORKING-STORAGE SECTION.
    50 01  DFH-START PIC X(04).
    51
    52 77  FILLER   PIC X(32) VALUE '********************************'.
    53 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    54 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    55
    56 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    57 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    58                                   USAGE POINTER.
    59 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    60 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    61 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    62                                   USAGE IS POINTER.
    63 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    64 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    65                                   USAGE IS POINTER.
    66 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    67 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    68                                   USAGE IS POINTER.
    69
    70 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    71 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    72                                   USAGE IS POINTER.
    73
    74*    COPY ELC50WS.
    75*****************************************************************
    76*                                                               *
    77*                            ELC50WS.                           *
    78*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    79*                            VMOD=2.061.                        *
    80*                                                               *
    81*   THIS IS THE WORKING STORAGE FOR EL050                       *
    82*                                   EL517                       *
    83*****************************************************************
    84******************************************************************
    85*                   C H A N G E   L O G
    86*
    87* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    88*-----------------------------------------------------------------
    89*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    90* EFFECTIVE    NUMBER
    91*-----------------------------------------------------------------
    92* 123102                   PEMA  ADD DCC PROCESSING
    93* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    94* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    95* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    96* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    97* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    98* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
    99* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   100* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   101* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   102* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   103* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   104* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   105* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   106* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page   4
* EL050.cbl
   107* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   108* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   109* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   110* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   111* 030309  CR2009021700001  PEMA  ADD ER-2883
   112* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   113* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   114* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   115* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   116* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   117* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   118* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   119* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   120* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   121* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   122* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   123* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   124* 061412  CR2011022800001  AJRA  NAPERSOFT
   125* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   126*-----------------------------------------------------------------
   127
   128 01  WORK-AREAS.
   129
   130*****************************************************************
   131*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   132*****************************************************************
   133
   134     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   135     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   136     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   137     12  WS-NAME-EDIT-WORK-AREA.
   138         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   139         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   140             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   141         16  WS-WORK-NAME.
   142             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   143             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   144             20  FILLER           PIC X(10)     VALUE SPACES.
   145         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   146             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   147
   148*****************************************************************
   149*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   150*****************************************************************
   151
   152     12  WS-ERRESC-KEY.
   153         16 WS-ERRESC-SEARCH-KEY.
   154             20  WS-ERRESC-COMPANY-CD PIC  X.
   155             20  WS-ERRESC-CARRIER    PIC  X.
   156             20  WS-ERRESC-GROUP      PIC X(6).
   157             20  WS-ERRESC-STATE      PIC XX.
   158             20  WS-ERRESC-ACCOUNT    PIC X(10).
   159         16 WS-ERRESC-RESIDUAL-KEY.
   160             20  WS-ERRESC-AGENT      PIC X(10).
   161             20  WS-ERRESC-RES-STATE  PIC XX.
   162             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   163*                                          YYYYMMDD
   164     12  WS-COMMISSION                PIC SV9(5) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page   5
* EL050.cbl
   165     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   166
   167*RESIDENT STATE TAX MASTER(ERRESS)
   168*
   169     12  WS-ERRESS-KEY.
   170         16  WS-ERRESS-COMPANY-CD      PIC  X.
   171         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   172         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   173         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   174*                                          YYYYMMDD
   175
   176     12  WS-CONTRACT-DATE              PIC 9(8).
   177*                                          YYYYMMDD
   178     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   179     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   180         16 WS-YEAR-YY                 PIC   9999.
   181         16 FILLER                     PIC 9(4).
   182*                                          YYYYMMDD
   183     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   184     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   185     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   186     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   187
   188     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   189         88  DPRB-1ST-TIME                      VALUE ' '.
   190
   191*****************************************************************
   192*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   193*****************************************************************
   194
   195     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   196     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   197     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   198     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   199     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   200     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   201     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   202     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   203     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   204     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   205         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   206         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   207     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   208         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   209         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   210     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   211
   212     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   213     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   214
   215     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   216     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   217     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   218     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   219     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   220     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   221     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   222     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page   6
* EL050.cbl
   223     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   224     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   225     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   226     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   227     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   228     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   229     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   230     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   231     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   232     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   233     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   246     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   248     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   249     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   250     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   251     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   252     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   253     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   254     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   255     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   256     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   257     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   258     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   259     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   260     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   261     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   262     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   263     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   264     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   265     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   266     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   267     12  WS-2671-SW               PIC X         VALUE SPACE.
   268     12  WS-2672-SW               PIC X         VALUE SPACE.
   269     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   270         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   271     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   272         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   273     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   274
   275     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   276         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   277         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   278         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   279         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   280
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page   7
* EL050.cbl
   281     12  WS-CREDIT-EDIT-CONTROLS.
   282         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   283         16  WS-MIN-AGE           PIC 99                VALUE  0.
   284         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   285         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   286         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   287         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   288
   289     12  WS-AGE-FIELDS.
   290         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   291         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   292         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   293         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   294
   295     12  WS-SAVE-ALLOWABLE-BENEFIT.
   296         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   297         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   298         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   299         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   300         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   301         16  FILLER                      PIC XX.
   302
   303     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   304     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   305     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   306     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   307     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   308     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   309     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   310     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   311     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   312     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   313
   314     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   315     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   316     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   317     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   318     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   319     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   320     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   321     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   322         88  WS-REDUCING              VALUE 'R'.
   323         88  WS-LEVEL                 VALUE 'L' 'P'.
   324     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   325
   326     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   327     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   328     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   329     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   330     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   331     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   332     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   333     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   334     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   335
   336     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   337     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   338     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page   8
* EL050.cbl
   339     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   340     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   341     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   342     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   343     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   344     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   345     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   346     12  WS-ACCT-SIG-SW.
   347         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   348         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   349     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   350     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   351     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   352     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   353     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   354     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   355     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   356     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   357     12  WS-INITIALS.
   358         16  WS-INIT-1            PIC X         VALUE SPACES.
   359         16  WS-INIT-2            PIC X         VALUE SPACES.
   360
   361     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   362     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   363     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   364     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   365     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   366*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   367     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   368     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   369     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   370     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   371     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   372     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   373     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   374     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   375     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   376     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   377     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   378     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   379     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   380     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   381     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   382     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   383     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   384     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   385     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   386     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   387     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   388     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   389******** FLA
   390     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   391     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   392     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   393     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   394     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   395********
   396     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page   9
* EL050.cbl
   397     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   398     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   399     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   400     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   401     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   402     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   403     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   404     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   405     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   406
   407     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   408         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   409                                         '0' THRU '9'.
   410
   411     12  NUMBER-OF-MONTHS.
   412         16  SK-MO OCCURS 12 TIMES PIC X.
   413
   414     12  WS-WORK-DATE.
   415         16  WS-YEAR            PIC 99    VALUE 00.
   416         16  WS-MONTH           PIC 99    VALUE 00.
   417         16  WS-DAY             PIC 99    VALUE 00.
   418
   419     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   420     12  WS-WORK-CRIT-DEV       REDEFINES
   421         WS-WORK-LF-CRIT-PER    PIC X(03).
   422
   423     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   424     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   425
   426     12  WS-WORK-DATE-FROM.
   427         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   428         16  FILLER             PIC X  VALUE SPACE.
   429         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   430         16  FILLER             PIC X         VALUE SPACE.
   431         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   432
   433     12  WS-WORK-DATE-THRU.
   434         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   435         16  FILLER             PIC X         VALUE SPACE.
   436         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   437         16  FILLER             PIC X         VALUE SPACE.
   438         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   439
   440     12  WS-LF-INPUT-CD.
   441         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   442         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   443
   444     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   445     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   446         16  WS-AH-INPUT-CD-1   PIC X.
   447         16  WS-AH-INPUT-CD-2-3 PIC XX.
   448
   449     12  WS-SWITCHES.
   450         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   451         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   452             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   453         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   454             88  BANK-ACCT-FOUND          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  10
* EL050.cbl
   455         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   456             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   457         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   458             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   459         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   460             88  COMP-MASTER-FOUND        VALUE 'Y'.
   461         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   462             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   463         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   464             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   465         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   466             88  STAT-MASTER-FOUND        VALUE 'Y'.
   467         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   468             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   469         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   470             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   471         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   472             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   473         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   474             88  FORM-MASTER-FOUND        VALUE 'Y'.
   475         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   476             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   477         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   478             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   479         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   480             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   481         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   482             88  NO-BENEFIT-FOUND         VALUE 'N'.
   483         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   484             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   485         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   486             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   487         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   488             88  AH-BENEFIT-FOUND         VALUE ' '.
   489             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   490         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   491             88  LF-BENEFIT-FOUND         VALUE ' '.
   492             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   493         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   494             88  NO-STATE-RECORD          VALUE '1'.
   495         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   496             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   497         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   498             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   499         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   500             88  CERT-WAS-FOUND           VALUE ' '.
   501             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   502         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   503             88  BROWSE-STARTED           VALUE 'Y'.
   504         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   505             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   506         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   507             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   508         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   509             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   510         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   511             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   512         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  11
* EL050.cbl
   513             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   514         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   515             88  APP-CERT-USED            VALUE 'Y' 'A'.
   516         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   517             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   518             88  FIRST-TIME-THROUGH       VALUE '1'.
   519             88  CTBL-NOT-FOUND           VALUE '2'.
   520
   521         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   522             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   523
   524         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   525             88  DLO-ERROR-FOUND          VALUE 'Y'.
   526
   527********FLA
   528     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   529     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   530********
   531     12  RC-SW-1                  PIC X           VALUE '0'.
   532     12  RC-SW-2                  PIC X           VALUE '0'.
   533     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   534     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   535     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   536     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   537     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   538     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   539     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   540     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   541     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   542     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   543     12  LIT-SPACES               PIC X           VALUE SPACES.
   544     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   545     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   546     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   547     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   548     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   549     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   550     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   551         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   552         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   553     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   554         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   555
   556 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   557     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   558     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   559 01  WS-CRI-SSN-WORK-AREA.
   560     05  WS-CRI-SOC-SEC-NO.
   561         10  WS-SS-REPT-CD       PIC X(5).
   562         10  WS-SS-LAST-NAME     PIC X(5).
   563         10  WS-SS-INITIAL       PIC X.
   564
   565     05  WS-CRI-REPORT-CODE.
   566         10  FILLER              PIC X(5).
   567         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   568
   569     05  WS-CRI-LAST-NAME.
   570         10  WS-CRI-NAME-MOVE    PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  12
* EL050.cbl
   571         10  FILLER              PIC X(10).
   572
   573 01  WS-NUM-TABLE                PIC X(26)  VALUE
   574     '12345678012345070923456789'.
   575 01  FILLER REDEFINES WS-NUM-TABLE.
   576     05  WS-NUM OCCURS 26        PIC 9.
   577 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   578 01  V1                          PIC S999 COMP-3.
   579 01  V2                          PIC S999 COMP-3.
   580 01  V3                          PIC S999 COMP-3.
   581 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   582 01  FILLER REDEFINES WS-WORK-VIN.
   583     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   584 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   585 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   586 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   587 01  WS-HEX-WORK.
   588     05  FILLER                  PIC X  VALUE LOW-VALUES.
   589     05  WS-HEX-BYTE             PIC X.
   590 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   591 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   592 01  WS-WORK-HIN-ROW-B.
   593     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   594
   595 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   596 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   597     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   598 01  WS-ROW-D-TABLE.
   599     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   600
   601 01  WS-HIN-TABLE-B.
   602     05  F                       PIC XX VALUE 'A2'.
   603     05  F                       PIC XX VALUE 'B3'.
   604     05  F                       PIC XX VALUE 'C4'.
   605     05  F                       PIC XX VALUE 'D5'.
   606     05  F                       PIC XX VALUE 'E6'.
   607     05  F                       PIC XX VALUE 'F7'.
   608     05  F                       PIC XX VALUE 'G8'.
   609     05  F                       PIC XX VALUE 'H9'.
   610     05  F                       PIC XX VALUE 'I1'.
   611     05  F                       PIC XX VALUE 'J2'.
   612     05  F                       PIC XX VALUE 'K3'.
   613     05  F                       PIC XX VALUE 'L4'.
   614     05  F                       PIC XX VALUE 'M5'.
   615     05  F                       PIC XX VALUE 'N6'.
   616     05  F                       PIC XX VALUE 'O0'.
   617     05  F                       PIC XX VALUE 'P7'.
   618     05  F                       PIC XX VALUE 'Q0'.
   619     05  F                       PIC XX VALUE 'R8'.
   620     05  F                       PIC XX VALUE 'S9'.
   621     05  F                       PIC XX VALUE 'T2'.
   622     05  F                       PIC XX VALUE 'U3'.
   623     05  F                       PIC XX VALUE 'V4'.
   624     05  F                       PIC XX VALUE 'W5'.
   625     05  F                       PIC XX VALUE 'X6'.
   626     05  F                       PIC XX VALUE 'Y7'.
   627     05  F                       PIC XX VALUE 'Z8'.
   628 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  13
* EL050.cbl
   629     05  WS-VAL-IN               PIC X.
   630     05  WS-VAL-OUT              PIC 9.
   631 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   632 01  WS-COMPARE-BINARY-DATES.
   633     05  WS-971231                PIC XX VALUE X'92FF'.
   634     05  WS-931231                PIC XX VALUE X'8CFF'.
   635     05  WS-791231                PIC XX VALUE X'77FF'.
   636     05  WS-771001                PIC XX VALUE X'74A1'.
   637     05  WS-820301                PIC XX VALUE X'7B41'.
   638     05  WS-831031                PIC XX VALUE X'7DBF'.
   639     05  WS-831231                PIC XX VALUE X'7DFF'.
   640     05  WS-810831                PIC XX VALUE X'7A7F'.
   641     05  WS-830901                PIC XX VALUE X'7D81'.
   642
   643 01  FILE-ACCESS-IDS.
   644     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   645     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   646     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   647     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   648     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   649     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   650     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   651     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   652     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   653     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   654     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   655     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   656     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   657     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   658     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   659     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   660     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   661 01  DD-IU-SW                    PIC X   VALUE ' '.
   662     88  DD-IU-PRESENT                 VALUE 'Y'.
   663
   664 01  ACCESS-KEYS.
   665     12  ELMSTR-KEY.
   666         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   667         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   668     12  W-CLAIM-KEY.
   669         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   670         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   671
   672     12  ELCNTL-KEY.
   673         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   674         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   675         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   676         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   677
   678     12  ELCERT-KEY.
   679         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   680         16  CERT-CARRIER         PIC X       VALUE SPACE.
   681         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   682         16  CERT-STATE           PIC XX      VALUE SPACES.
   683         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   684         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   685         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   686
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  14
* EL050.cbl
   687     12  ELCERT2-KEY.
   688         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   689         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   690
   691     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   692
   693     12  ELCERT-SAVE.
   694         16  FILLER                      PIC XX    VALUE SPACES.
   695
   696         16  WCS-CONTROL-PRIMARY.
   697             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   698             20  WCS-CARRIER             PIC X     VALUE SPACE.
   699             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   700             20  WCS-STATE               PIC XX    VALUE SPACES.
   701             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   702             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   703             20  WCS-CERT-NO.
   704                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   705                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   706
   707         16  CS-CONTROL-BY-NAME.
   708             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   709             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   710             20  CS-INSURED-INITIALS.
   711                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   712                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   713
   714         16  CS-CONTROL-BY-SSN.
   715             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   716             20  CS-SOC-SEC-NO.
   717                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   718                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   719                 24  CS-SSN-LN3.
   720                     28 CS-INSURED-INITIALS-A2   PIC XX
   721                                     VALUE SPACES.
   722                     28 CS-PART-LAST-NAME-A2     PIC X
   723                                     VALUE SPACE.
   724
   725         16  CS-CONTROL-BY-CERT-NO.
   726             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   727             20  CS-CERT-NO-A4           PIC X(11)
   728                                     VALUE SPACES.
   729
   730         16  CS-CONTROL-BY-MEMB.
   731             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   732             20  CS-MEMBER-NO.
   733                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   734                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   735                 24  CS-MEMB-LN4.
   736                     28 CS-INSURED-INITIALS-A5   PIC XX
   737                                      VALUE SPACES.
   738                     28 CS-PART-LAST-NAME-A5     PIC XX
   739                                      VALUE SPACES.
   740
   741         16  FILLER              PIC X(360) VALUE SPACES.
   742
   743     12  ERACCT-KEY.
   744         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  15
* EL050.cbl
   745         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   746         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   747         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   748         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   749         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   750
   751     12  ERCOMP-KEY.
   752         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   753         16  COMP-CARRIER         PIC X     VALUE SPACES.
   754         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   755         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   756         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   757         16  COMP-TYPE            PIC X     VALUE SPACES.
   758
   759     12  ERLOFC-KEY.
   760         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   761         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   762         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   763         16  LOFC-STATE           PIC XX    VALUE SPACES.
   764         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   765         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   766
   767     12  WS-ELCRTT-KEY.
   768         16  WS-ELCRTT-PRIMARY       PIC X(33).
   769         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   770
   771     12  ERBXRF-KEY.
   772         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   773         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   774         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   775         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   776
   777     12  ERAGTC-KEY.
   778         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   779         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   780         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   781         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   782         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   783         16  AGTC-TYPE            PIC X     VALUE SPACES.
   784
   785     12  ERPLAN-KEY.
   786         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   787         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   788         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   789         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   790         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   791         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   792         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   793         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   794
   795     12  ERFORM-KEY.
   796         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   797         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   798         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   799         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   800
   801     12  ERREIN-KEY.
   802         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  16
* EL050.cbl
   803         16  REIN-TYPE            PIC X     VALUE SPACES.
   804         16  REIN-TABLE-CO.
   805             20  REIN-CODE-1      PIC X     VALUE SPACE.
   806             20  REIN-CODE-2      PIC X     VALUE SPACE.
   807             20  REIN-CODE-3      PIC X     VALUE SPACE.
   808         16  FILLER               PIC X(3)  VALUE SPACES.
   809
   810     12  ERCTBL-KEY.
   811         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   812         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   813         16  CTBL-CNTRL-2.
   814             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   815             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   816
   817     12  ELCRTO-KEY.
   818         16  ELCRTO-COMPANY-CD       PIC X.
   819         16  ELCRTO-CARRIER          PIC X.
   820         16  ELCRTO-GROUPING         PIC X(6).
   821         16  ELCRTO-STATE            PIC XX.
   822         16  ELCRTO-ACCOUNT          PIC X(10).
   823         16  ELCRTO-CERT-EFF-DT      PIC XX.
   824         16  ELCRTO-CERT-NO.
   825             20  ELCRTO-CERT-PRIME   PIC X(10).
   826             20  ELCRTO-CERT-SFX     PIC X.
   827         16  ELCRTO-RECORD-TYPE      PIC X.
   828         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   829
   830
   831     12  WS-ACCESS.
   832         16  FILLER               PIC XX    VALUE SPACES.
   833         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   834
   835     12  WS-CARR-ACCESS.
   836         16  FILLER               PIC X(3)  VALUE SPACES.
   837         16  WS-CARR              PIC X     VALUE SPACE.
   838*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   839*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   840     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   841         88  WS-DMD-LF-RATING   VALUE 'Y'.
   842         88  WS-DMD-AH-RATING   VALUE 'Y'.
   843         88  WS-DMD-NO-RATING   VALUE 'N'.
   844
   845     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   846         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   847                                         'NJ' 'NL'
   848                                         'PJ' 'PL'
   849                                         'SJ' 'SL'.
   850     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   851         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   852                                         'NI' 'NJ' 'NL' 'NU'
   853                                         'PJ' 'PL' 'PI' 'PU'
   854                                         'SI' 'SJ' 'SL' 'SU'
   855                                         'MX' 'MY' 'MZ'.
   856 01  ERPDEF-KEY-SAVE             PIC X(18).
   857 01  ERPDEF-KEY.
   858     12  ERPDEF-COMPANY-CD       PIC X.
   859     12  ERPDEF-STATE            PIC XX.
   860     12  ERPDEF-PROD-CD          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  17
* EL050.cbl
   861     12  F                       PIC X(7).
   862     12  ERPDEF-BEN-TYPE         PIC X.
   863     12  ERPDEF-BEN-CODE         PIC XX.
   864     12  ERPDEF-EXP-DT           PIC XX.
   865
   866 01  ELSTAT-KEY-SAVE             PIC X(20).
   867 01  ELSTAT-KEY.
   868     12  ELSTAT-COMPANY-ID       PIC XXX.
   869     12  ELSTAT-CARRIER          PIC X.
   870     12  ELSTAT-GROUP            PIC X(6).
   871     12  ELSTAT-STATE            PIC XX.
   872     12  ELSTAT-EXP-DT           PIC 9(8).
   873 01  WS-ERROR-VALUES.
   874     12  ER-1570                     PIC S9(4)   VALUE +1570.
   875     12  ER-1571                     PIC S9(4)   VALUE +1571.
   876     12  ER-1575                     PIC S9(4)   VALUE +1575.
   877     12  ER-1891                     PIC S9(4)   VALUE +1891.
   878     12  ER-1892                     PIC S9(4)   VALUE +1892.
   879     12  ER-1893                     PIC S9(4)   VALUE +1893.
   880     12  ER-1894                     PIC S9(4)   VALUE +1894.
   881     12  ER-1895                     PIC S9(4)   VALUE +1895.
   882     12  ER-1896                     PIC S9(4)   VALUE +1896.
   883     12  ER-1897                     PIC S9(4)   VALUE +1897.
   884     12  ER-1898                     PIC S9(4)   VALUE +1898.
   885     12  ER-1899                     PIC S9(4)   VALUE +1899.
   886     12  ER-1900                     PIC S9(4)   VALUE +1900.
   887     12  ER-1901                     PIC S9(4)   VALUE +1901.
   888     12  ER-1902                     PIC S9(4)   VALUE +1902.
   889     12  ER-1903                     PIC S9(4)   VALUE +1903.
   890     12  ER-1904                     PIC S9(4)   VALUE +1904.
   891     12  ER-1905                     PIC S9(4)   VALUE +1905.
   892     12  ER-1906                     PIC S9(4)   VALUE +1906.
   893     12  ER-1907                     PIC S9(4)   VALUE +1907.
   894     12  ER-1909                     PIC S9(4)   VALUE +1909.
   895     12  ER-1910                     PIC S9(4)   VALUE +1910.
   896     12  ER-1911                     PIC S9(4)   VALUE +1911.
   897     12  ER-1912                     PIC S9(4)   VALUE +1912.
   898     12  ER-1913                     PIC S9(4)   VALUE +1913.
   899     12  ER-1914                     PIC S9(4)   VALUE +1914.
   900     12  ER-1915                     PIC S9(4)   VALUE +1915.
   901     12  ER-1916                     PIC S9(4)   VALUE +1916.
   902     12  ER-1917                     PIC S9(4)   VALUE +1917.
   903     12  ER-1918                     PIC S9(4)   VALUE +1918.
   904     12  ER-1919                     PIC S9(4)   VALUE +1919.
   905     12  ER-1920                     PIC S9(4)   VALUE +1920.
   906     12  ER-1921                     PIC S9(4)   VALUE +1921.
   907     12  ER-1922                     PIC S9(4)   VALUE +1922.
   908     12  ER-1923                     PIC S9(4)   VALUE +1923.
   909     12  ER-1924                     PIC S9(4)   VALUE +1924.
   910     12  ER-1925                     PIC S9(4)   VALUE +1925.
   911     12  ER-1926                     PIC S9(4)   VALUE +1926.
   912     12  ER-1927                     PIC S9(4)   VALUE +1927.
   913     12  ER-2393                     PIC S9(4)   VALUE +2393.
   914     12  ER-2600                     PIC S9(4)   VALUE +2600.
   915     12  ER-2601                     PIC S9(4)   VALUE +2601.
   916     12  ER-2602                     PIC S9(4)   VALUE +2602.
   917     12  ER-2603                     PIC S9(4)   VALUE +2603.
   918     12  ER-2604                     PIC S9(4)   VALUE +2604.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  18
* EL050.cbl
   919     12  ER-2605                     PIC S9(4)   VALUE +2605.
   920     12  ER-2606                     PIC S9(4)   VALUE +2606.
   921     12  ER-2607                     PIC S9(4)   VALUE +2607.
   922     12  ER-2608                     PIC S9(4)   VALUE +2608.
   923     12  ER-2609                     PIC S9(4)   VALUE +2609.
   924     12  ER-2610                     PIC S9(4)   VALUE +2610.
   925     12  ER-2611                     PIC S9(4)   VALUE +2611.
   926     12  ER-2612                     PIC S9(4)   VALUE +2612.
   927     12  ER-2613                     PIC S9(4)   VALUE +2613.
   928     12  ER-2614                     PIC S9(4)   VALUE +2614.
   929     12  ER-2615                     PIC S9(4)   VALUE +2615.
   930     12  ER-2616                     PIC S9(4)   VALUE +2616.
   931     12  ER-2617                     PIC S9(4)   VALUE +2617.
   932     12  ER-2618                     PIC S9(4)   VALUE +2618.
   933     12  ER-2619                     PIC S9(4)   VALUE +2619.
   934     12  ER-2620                     PIC S9(4)   VALUE +2620.
   935     12  ER-2621                     PIC S9(4)   VALUE +2621.
   936     12  ER-2622                     PIC S9(4)   VALUE +2622.
   937     12  ER-2623                     PIC S9(4)   VALUE +2623.
   938     12  ER-2624                     PIC S9(4)   VALUE +2624.
   939     12  ER-2625                     PIC S9(4)   VALUE +2625.
   940     12  ER-2626                     PIC S9(4)   VALUE +2626.
   941     12  ER-2627                     PIC S9(4)   VALUE +2627.
   942     12  ER-2628                     PIC S9(4)   VALUE +2628.
   943     12  ER-2629                     PIC S9(4)   VALUE +2629.
   944     12  ER-2630                     PIC S9(4)   VALUE +2630.
   945     12  ER-2631                     PIC S9(4)   VALUE +2631.
   946     12  ER-2632                     PIC S9(4)   VALUE +2632.
   947     12  ER-2633                     PIC S9(4)   VALUE +2633.
   948     12  ER-2634                     PIC S9(4)   VALUE +2634.
   949     12  ER-2635                     PIC S9(4)   VALUE +2635.
   950     12  ER-2636                     PIC S9(4)   VALUE +2636.
   951     12  ER-2637                     PIC S9(4)   VALUE +2637.
   952     12  ER-2638                     PIC S9(4)   VALUE +2638.
   953     12  ER-2639                     PIC S9(4)   VALUE +2639.
   954     12  ER-2640                     PIC S9(4)   VALUE +2640.
   955     12  ER-2641                     PIC S9(4)   VALUE +2641.
   956     12  ER-2642                     PIC S9(4)   VALUE +2642.
   957     12  ER-2643                     PIC S9(4)   VALUE +2643.
   958     12  ER-2644                     PIC S9(4)   VALUE +2644.
   959     12  ER-2645                     PIC S9(4)   VALUE +2645.
   960     12  ER-2646                     PIC S9(4)   VALUE +2646.
   961     12  ER-2647                     PIC S9(4)   VALUE +2647.
   962     12  ER-2648                     PIC S9(4)   VALUE +2648.
   963     12  ER-2649                     PIC S9(4)   VALUE +2649.
   964     12  ER-2650                     PIC S9(4)   VALUE +2650.
   965     12  ER-2651                     PIC S9(4)   VALUE +2651.
   966     12  ER-2652                     PIC S9(4)   VALUE +2652.
   967     12  ER-2653                     PIC S9(4)   VALUE +2653.
   968     12  ER-2654                     PIC S9(4)   VALUE +2654.
   969     12  ER-2655                     PIC S9(4)   VALUE +2655.
   970     12  ER-2656                     PIC S9(4)   VALUE +2656.
   971     12  ER-2657                     PIC S9(4)   VALUE +2657.
   972     12  ER-2658                     PIC S9(4)   VALUE +2658.
   973     12  ER-2659                     PIC S9(4)   VALUE +2659.
   974     12  ER-2660                     PIC S9(4)   VALUE +2660.
   975     12  ER-2661                     PIC S9(4)   VALUE +2661.
   976     12  ER-2662                     PIC S9(4)   VALUE +2662.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  19
* EL050.cbl
   977     12  ER-2663                     PIC S9(4)   VALUE +2663.
   978     12  ER-2664                     PIC S9(4)   VALUE +2664.
   979     12  ER-2665                     PIC S9(4)   VALUE +2665.
   980     12  ER-2666                     PIC S9(4)   VALUE +2666.
   981     12  ER-2667                     PIC S9(4)   VALUE +2667.
   982     12  ER-2668                     PIC S9(4)   VALUE +2668.
   983     12  ER-2669                     PIC S9(4)   VALUE +2669.
   984     12  ER-2670                     PIC S9(4)   VALUE +2670.
   985     12  ER-2671                     PIC S9(4)   VALUE +2671.
   986     12  ER-2672                     PIC S9(4)   VALUE +2672.
   987     12  ER-2673                     PIC S9(4)   VALUE +2673.
   988     12  ER-2674                     PIC S9(4)   VALUE +2674.
   989     12  ER-2675                     PIC S9(4)   VALUE +2675.
   990     12  ER-2676                     PIC S9(4)   VALUE +2676.
   991     12  ER-2677                     PIC S9(4)   VALUE +2677.
   992     12  ER-2678                     PIC S9(4)   VALUE +2678.
   993     12  ER-2679                     PIC S9(4)   VALUE +2679.
   994     12  ER-2680                     PIC S9(4)   VALUE +2680.
   995     12  ER-2681                     PIC S9(4)   VALUE +2681.
   996     12  ER-2682                     PIC S9(4)   VALUE +2682.
   997     12  ER-2683                     PIC S9(4)   VALUE +2683.
   998     12  ER-2684                     PIC S9(4)   VALUE +2684.
   999     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1000     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1001     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1002     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1003     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1004     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1005     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1006     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1007     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1008     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1009     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1010     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1011     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1012     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1013     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1014     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1015     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1016     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1017     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1018     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1019     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1020     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1021     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1022     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1023     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1024     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1025     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1026     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1027     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1028     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1029     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1030     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1031     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1032     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1033     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1034     12  ER-2730                     PIC S9(4)   VALUE +2730.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  20
* EL050.cbl
  1035     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1036     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1037     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1038     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1039     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1040     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1041     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1042     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1043     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1044     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1045     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1046     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1047     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1048     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1049     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1050     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1051     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1052     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1053     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1054     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1055     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1056     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1057     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1058     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1059     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1060     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1061     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1062     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1063     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1064     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1065     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1066     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1067     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1068     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1069     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1070     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1071     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1072     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1073     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1074     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1075     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1076     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1077     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1078     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1079     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1080     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1081     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1082     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1083     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1084     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1085     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1086     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1087     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1088     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1089     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1090     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1091     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1092     12  ER-2792                     PIC S9(4)   VALUE +2792.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  21
* EL050.cbl
  1093     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1094     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1095     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1096     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1097     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1098     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1099     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1100     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1101     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1102     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1103     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1104     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1105     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1106     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1107     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1108     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1109     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1110     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1111     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1112     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1113     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1114     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1115     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1116     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1117     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1118     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1119     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1120     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1121     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1122     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1123     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1124     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1125     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1126     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1127     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1128     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1129     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1130     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1131     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1132     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1133     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1134     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1135     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1136     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1137     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1138     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1139     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1140     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1141     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1142     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1143     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1144     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1145     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1146     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1147     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1148     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1149     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1150     12  ER-8043                     PIC S9(4)   VALUE +8043.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  22
* EL050.cbl
  1151     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1152     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1153     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1154     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1155     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1156     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1157     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1158     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1159     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1160     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1161     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1162     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1163     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1164     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1165     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1166     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1167     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1168     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1169     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1170     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1171     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1172     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1173     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1174     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1175     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1176     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1177     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1178     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1179     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1180     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1181     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1182     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1183     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1184     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1185     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1186     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1187     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1188     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1189     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1190     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1191     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1192     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1193     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1194     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1195     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1196     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1197     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1198     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1199     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1200     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1201     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1202     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1203     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1204     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1205     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1206     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1207     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1208     12  ER-8317                     PIC S9(4)   VALUE +8317.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  23
* EL050.cbl
  1209     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1210     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1211     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1212     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1213     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1214******************************************************************
  1215***************   END OF ELC50WS     ****************************
  1216******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  24
* EL050.cbl
  1219 01  WORKING-STORAGE-WORK-AREAS.
  1220     12  WS-RESPONSE             PIC S9(8)  COMP.
  1221         88  WS-RESP-NORMAL           VALUE +00.
  1222         88  WS-RESP-ERROR            VALUE +01.
  1223         88  WS-RESP-NOTFND           VALUE +13.
  1224         88  WS-RESP-DUPREC           VALUE +14.
  1225         88  WS-RESP-ENDFILE          VALUE +20.
  1226     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1227     12  WORK-AREAS.
  1228         16  WK-CONV-GREG.
  1229             24  WCG-CENT             PIC XX.
  1230             24  WCG-REST             PIC X(4).
  1231         16  WORK-GREGORIAN-DATE.
  1232             24  WK-GREG-CENT         PIC XX.
  1233             24  WK-GREG-DATE-YYMMDD.
  1234                 28  WK-GREG-YYMM     PIC X(4).
  1235                 28  WK-GREG-DD       PIC XX.
  1236
  1237         16  WORK-SELECT-DATE.
  1238             24  WK-SELECT-CENT            PIC XX.
  1239             24  WK-SELECT-DATE-YYMMDD.
  1240                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1241                 28  FILLER                PIC XX.
  1242
  1243         16  WK-FORM-NO.
  1244             24  WK-FORM-BANK-ID       PIC X(5).
  1245             24  WK-FORM-UNDRWRTR      PIC X(1).
  1246             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1247
  1248         16  WK-MEMBER-NO.
  1249             24  WK-MEMBER-1-6        PIC X(6).
  1250             24  WK-MEMBER-7-12       PIC X(6).
  1251
  1252         16  WK-FULL-CERT-NO.
  1253             24  WK-CERT-POS-1-2      PIC X(2).
  1254             24  WK-CERT-POS-3        PIC X(1).
  1255             24  WK-CERT-POS-4        PIC X(1).
  1256             24  WK-CERT-POS-5-6      PIC X(2).
  1257             24  WK-CERT-POS-7        PIC X(1).
  1258             24  WK-CERT-POS-8-11     PIC X(4).
  1259
  1260         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1261             88  VALID-RATE-CODE        VALUE 'Y'.
  1262             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1263
  1264         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1265         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1266         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1267         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1268         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1269         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1270         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1271         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1272         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1273         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1274
  1275* DLO001
  1276 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  25
* EL050.cbl
  1277     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1278     12  DMPF-RETURN-CODE          PIC XX.
  1279         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1280         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1281         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1282         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1283         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1284         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1285
  1286* DLO002
  1287 01  WS-DLO-INTERNAL-POLICY-FORM.
  1288     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1289     12  DIPF-RETURN-CODE          PIC XX.
  1290         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1291         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1292         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1293         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1294         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1295         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1296
  1297* DLO003
  1298 01  WS-DLO-VALID-BANK-ID.
  1299     12  DVBI-BANK-ID              PIC X(5).
  1300     12  DVBI-BANK-ID-TYPE         PIC X.
  1301         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1302         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1303         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1304         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1305         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1306     12  DVBI-RETURN-CODE          PIC XX.
  1307         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1308         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1309         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1310         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1311         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1312         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1313         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1314         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1315         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1316
  1317* DLO007
  1318 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1319     12  DCUA-RES-STATE            PIC XX.
  1320     12  DCUA-BEN-TYPE             PIC XX.
  1321     12  DCUA-SYS-IDENT            PIC X.
  1322         88  DCUA-CLAIM                        VALUE 'C'.
  1323         88  DCUA-PREMIUM                      VALUE 'P'.
  1324     12  DCUA-COVERAGE-RULE        PIC X.
  1325     12  DCUA-CLIENT-ID            PIC X(10).
  1326     12  DCUA-EFF-DATE             PIC X(8).
  1327     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1328     12  DCUA-RETURN-CODE          PIC XX.
  1329         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1330     12  DCUA-CERT-NUMBER          PIC X(11).
  1331     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1332     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1333
  1334* DLO011
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  26
* EL050.cbl
  1335 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1336     12  DPRB-RATE-CODE            PIC X(4).
  1337     12  DPRB-COVERAGE-CATEG       PIC X.
  1338     12  DPRB-RETURN-CODE          PIC XX.
  1339         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1340         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1341         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1342         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1343         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1344         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1345         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1346         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1347         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1348     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1349     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1350     12  DPRB-BEN-TYPE             PIC XX.
  1351
  1352* DLO017
  1353 01  WS-DLO-VALID-RATE-CODE.
  1354     12  DVRC-RATE-CODE            PIC X(4).
  1355     12  DVRC-RETURN-CODE          PIC XX.
  1356         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1357         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1358         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1359         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1360         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1361         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1362
  1363* DLO019
  1364 01  WS-DLO-ORIG-COV-CAT.
  1365     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1366     12  DOCC-RETURN-CODE          PIC XX.
  1367     12  DOCC-ORIG-COV-CAT         PIC X.
  1368     12  DOCC-UNDERWITER           PIC XX.
  1369     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1370     12  DOCC-FILLER               PIC X(6).
  1371
  1372* DLO021
  1373 01  WS-DLO-VALID-LOAN-OFFICER.
  1374     12  DVLO-LOAN-OFFICER.
  1375         16  DVLO-BILL-TYPE        PIC X.
  1376         16  DVLO-BILL-SOURCE      PIC X.
  1377         16  DVLO-BATCH-TYPE       PIC X.
  1378     12  DVLO-RETURN-CODE          PIC XX.
  1379         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1380         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1381         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1382         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1383         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1384         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1385
  1386* DLO022
  1387 01  WS-DLO-VALID-STATE-CODE.
  1388     12  DVSC-STATE-CODE           PIC XX.
  1389     12  DVSC-RETURN-CODE          PIC XX.
  1390         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1391
  1392* DLO023
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  27
* EL050.cbl
  1393 01  WS-DLO-VALID-CODE-VALUES.
  1394     12  DVCV-SYSTEM-ID            PIC XX.
  1395         88  DVCV-CLAIMS                       VALUE 'CL'.
  1396         88  DVCV-CREDIT                       VALUE 'CR'.
  1397     12  DVCV-RECORD-TYPE          PIC XX.
  1398         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1399         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1400         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1401         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1402         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1403         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1404         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1405         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1406     12  DVCV-RECORD-KEY           PIC X(6).
  1407     12  DVCV-RETURN-CODE          PIC XX.
  1408         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1409         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1410         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1411         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1412         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1413         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1414         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1415     12  DVCV-CODE-DESC            PIC X(60).
  1416     12  DVCV-GEN-DESC-1           PIC X(20).
  1417     12  DVCV-GEN-DESC-2           PIC X(20).
  1418     12  DVCV-GEN-DESC-3           PIC X(20).
  1419
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  28
* EL050.cbl
  1421*    COPY ERCBXRF.
  1422******************************************************************
  1423*                                                                *
  1424*                                                                *
  1425*                            ERCBXRF                             *
  1426*                                                                *
  1427*   ONLINE CREDIT SYSTEM                                         *
  1428*                                                                *
  1429*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1430*                                                                *
  1431*   FILE TYPE = VSAM,KSDS                                        *
  1432*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1433*                                                                *
  1434*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1435*       ALTERNATE PATH = NONE                                    *
  1436*                                                                *
  1437*   LOG = NO                                                     *
  1438*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1439*                                                                *
  1440******************************************************************
  1441
  1442 01  BANK-CROSS-REFERENCE.
  1443     12  BK-RECORD-ID                PIC XX.
  1444         88  VALID-BK-ID             VALUE 'BK'.
  1445
  1446     12  BK-CONTROL-PRIMARY.
  1447         16  BK-COMPANY-CD           PIC X.
  1448         16  BK-CARRIER              PIC X.
  1449         16  BK-GROUPING             PIC X(6).
  1450         16  BK-BANK-NO              PIC X(10).
  1451
  1452     12  BK-MAINT-INFORMATION.
  1453         16  BK-LAST-MAINT-DT        PIC XX.
  1454         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1455         16  BK-LAST-MAINT-USER      PIC X(4).
  1456         16  FILLER                  PIC X(9).
  1457
  1458     12  FILLER                      PIC X(37).
  1459
  1460     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1461
  1462     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1463                            DEPENDING ON BK-BANK-POINTER-CNT.
  1464         16  BK-AM-ACCOUNT           PIC X(10).
  1465         16  BK-AM-EXP-DT            PIC XX.
  1466         16  BK-AM-EFF-DT            PIC XX.
  1467         16  BK-AM-STATE             PIC XX.
  1468         16  FILLER                  PIC X(20).
  1469
  1470******************************************************************
  1471
  1472*    COPY ERCCOMP.
  1473******************************************************************
  1474*                                                                *
  1475*                                                                *
  1476*                            ERCCOMP                             *
  1477*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1478*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  29
* EL050.cbl
  1479*                                                                *
  1480*   ONLINE CREDIT SYSTEM                                         *
  1481*                                                                *
  1482*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1483*                                                                *
  1484*   FILE TYPE = VSAM,KSDS                                        *
  1485*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1486*                                                                *
  1487*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1488*       ALTERNATE PATH = NONE                                    *
  1489*                                                                *
  1490*   LOG = NO                                                     *
  1491*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1492*                                                                *
  1493******************************************************************
  1494*                   C H A N G E   L O G
  1495*
  1496* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1497*-----------------------------------------------------------------
  1498*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1499* EFFECTIVE    NUMBER
  1500*-----------------------------------------------------------------
  1501* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1502* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1503* 092205    2005050300006  PEMA  ADD LEASE FEE
  1504* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1505* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1506* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1507* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1508* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1509* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1510******************************************************************
  1511
  1512 01  COMPENSATION-MASTER.
  1513     12  CO-RECORD-ID                          PIC XX.
  1514         88  VALID-CO-ID                          VALUE 'CO'.
  1515
  1516     12  CO-CONTROL-PRIMARY.
  1517         16  CO-COMPANY-CD                     PIC X.
  1518         16  CO-CONTROL.
  1519             20  CO-CTL-1.
  1520                 24  CO-CARR-GROUP.
  1521                     28  CO-CARRIER            PIC X.
  1522                     28  CO-GROUPING.
  1523                         32  CO-GROUP-PREFIX   PIC XXX.
  1524                         32  CO-GROUP-PRIME    PIC XXX.
  1525                 24  CO-RESP-NO.
  1526                     28  CO-RESP-PREFIX        PIC X(4).
  1527                     28  CO-RESP-PRIME         PIC X(6).
  1528             20  CO-CTL-2.
  1529                 24  CO-ACCOUNT.
  1530                     28  CO-ACCT-PREFIX        PIC X(4).
  1531                     28  CO-ACCT-PRIME         PIC X(6).
  1532         16  CO-TYPE                           PIC X.
  1533             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1534             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1535             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1536
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  30
* EL050.cbl
  1537     12  CO-MAINT-INFORMATION.
  1538         16  CO-LAST-MAINT-DT                  PIC XX.
  1539         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1540         16  CO-LAST-MAINT-USER                PIC X(4).
  1541     12  FILLER                                PIC XX.
  1542     12  CO-STMT-TYPE                          PIC XXX.
  1543     12  CO-COMP-TYPE                          PIC X.
  1544         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1545     12  CO-STMT-OWNER                         PIC X(4).
  1546     12  CO-BALANCE-CONTROL                    PIC X.
  1547         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1548         88  CO-NO-BALANCE                        VALUE 'N'.
  1549
  1550     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1551         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1552         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1553         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1554
  1555     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1556         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1557         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1558
  1559     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1560     12  CO-GA-DIRECT-DEP                      PIC X.
  1561     12  CO-FUTURE-SPACE                       PIC X.
  1562         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1563
  1564     12  CO-ACCT-NAME                          PIC X(30).
  1565     12  CO-MAIL-NAME                          PIC X(30).
  1566     12  CO-ADDR-1                             PIC X(30).
  1567     12  CO-ADDR-2                             PIC X(30).
  1568     12  CO-ADDR-3.
  1569         16  CO-ADDR-CITY                      PIC X(27).
  1570         16  CO-ADDR-STATE                     PIC XX.
  1571     12  CO-CSO-1099                           PIC X.
  1572     12  CO-ZIP.
  1573         16  CO-ZIP-PRIME.
  1574             20  CO-ZIP-PRI-1ST                PIC X.
  1575                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1576             20  FILLER                        PIC X(4).
  1577         16  CO-ZIP-PLUS4                      PIC X(4).
  1578     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1579         16  CO-CAN-POSTAL-1                   PIC XXX.
  1580         16  CO-CAN-POSTAL-2                   PIC XXX.
  1581         16  FILLER                            PIC XXX.
  1582     12  CO-SOC-SEC                            PIC X(13).
  1583     12  CO-TELEPHONE.
  1584         16  CO-AREA-CODE                      PIC XXX.
  1585         16  CO-PREFIX                         PIC XXX.
  1586         16  CO-PHONE                          PIC X(4).
  1587
  1588     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1589
  1590     12  CO-AR-BAL-LEVEL                       PIC X.
  1591         88  CO-AR-REF-LVL                        VALUE '1'.
  1592         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1593         88  CO-AR-BILL-LVL                       VALUE '2'.
  1594         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  31
* EL050.cbl
  1595         88  CO-AR-FR-LVL                         VALUE '4'.
  1596
  1597     12  CO-AR-NORMAL-PRINT                    PIC X.
  1598         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1599         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1600
  1601     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1602
  1603     12  CO-AR-REPORTING                       PIC X.
  1604         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1605         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1606
  1607     12  CO-AR-PULL-CHECK                      PIC X.
  1608         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1609         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1610
  1611     12  CO-AR-BALANCE-PRINT                   PIC X.
  1612         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1613
  1614     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1615         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1616         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1617         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1618
  1619     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1620
  1621     12  CO-USER-CODE                          PIC X.
  1622     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1623
  1624******************************************************************
  1625*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1626*    THE LAST MONTH END RUN.
  1627******************************************************************
  1628
  1629     12  CO-LAST-ACTIVITY-DATE.
  1630         16  CO-ACT-YEAR                       PIC 99.
  1631         16  CO-ACT-MONTH                      PIC 99.
  1632         16  CO-ACT-DAY                        PIC 99.
  1633
  1634     12  CO-LAST-STMT-DT.
  1635         16  CO-LAST-STMT-YEAR                 PIC 99.
  1636         16  CO-LAST-STMT-MONTH                PIC 99.
  1637         16  CO-LAST-STMT-DAY                  PIC 99.
  1638
  1639     12  CO-MO-END-TOTALS.
  1640         16  CO-MONTHLY-TOTALS.
  1641             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1642             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1643             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1644             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1645             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1646
  1647         16  CO-AGING-TOTALS.
  1648             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1649             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1650             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1651             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1652
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  32
* EL050.cbl
  1653         16  CO-YTD-TOTALS.
  1654             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1655             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1656
  1657         16  CO-OVER-UNDER-TOTALS.
  1658             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1659             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1660
  1661     12  CO-MISCELLANEOUS-TOTALS.
  1662         16  CO-FICA-TOTALS.
  1663             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1664             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1665
  1666         16  CO-CLAIM-TOTALS.
  1667             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1668             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1669
  1670******************************************************************
  1671*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1672*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1673******************************************************************
  1674
  1675     12  CO-CURRENT-TOTALS.
  1676         16  CO-CURRENT-LAST-STMT-DT.
  1677             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1678             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1679             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1680
  1681         16  CO-CURRENT-MONTHLY-TOTALS.
  1682             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1683             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1684             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1685             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1686             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1687
  1688         16  CO-CURRENT-AGING-TOTALS.
  1689             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1690             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1691             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1692             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1693
  1694         16  CO-CURRENT-YTD-TOTALS.
  1695             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1696             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1697
  1698     12  CO-PAID-COMM-TOTALS.
  1699         16  CO-YTD-PAID-COMMS.
  1700             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1701             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1702
  1703     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1704         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1705         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1706
  1707     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1708         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1709         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1710         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  33
* EL050.cbl
  1711         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1712         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1713         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1714         88  CO-FINAL-LETTER                  VALUE 'F'.
  1715         88  CO-RECONCILING                   VALUE 'R'.
  1716         88  CO-PHONE-CALL                    VALUE 'P'.
  1717         88  CO-LEGAL                         VALUE 'L'.
  1718         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1719         88  CO-WRITE-OFF                     VALUE 'W'.
  1720         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1721
  1722     12  CO-CSR-CODE                       PIC X(4).
  1723
  1724     12  CO-GA-STATUS-INFO.
  1725         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1726         16  CO-GA-TERMINATION-DT          PIC XX.
  1727         16  CO-GA-STATUS-CODE             PIC X.
  1728             88  CO-GA-ACTIVE                 VALUE 'A'.
  1729             88  CO-GA-INACTIVE               VALUE 'I'.
  1730             88  CO-GA-PENDING                VALUE 'P'.
  1731         16  CO-GA-COMMENTS.
  1732             20  CO-GA-COMMENT-1           PIC X(40).
  1733             20  CO-GA-COMMENT-2           PIC X(40).
  1734             20  CO-GA-COMMENT-3           PIC X(40).
  1735             20  CO-GA-COMMENT-4           PIC X(40).
  1736
  1737     12  CO-RPTCD2                         PIC X(10).
  1738     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1739         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1740         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1741
  1742     12  CO-TYPE-AGENT                     PIC X(01).
  1743         88  CO-CORPORATION                   VALUE 'C'.
  1744         88  CO-PARTNERSHIP                   VALUE 'P'.
  1745         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1746         88  CO-TRUST                         VALUE 'T'.
  1747         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1748
  1749     12  CO-FAXNO.
  1750         16  CO-FAX-AREA-CODE                  PIC XXX.
  1751         16  CO-FAX-PREFIX                     PIC XXX.
  1752         16  CO-FAX-PHONE                      PIC X(4).
  1753
  1754     12  CO-BANK-INFORMATION.
  1755         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1756         16  CO-BANK-TRANSIT-NON REDEFINES
  1757             CO-BANK-TRANSIT-NO                PIC 9(8).
  1758
  1759         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1760     12  CO-MISC-DEDUCT-INFO REDEFINES
  1761                  CO-BANK-INFORMATION.
  1762         16  CO-MD-GL-ACCT                     PIC X(10).
  1763         16  CO-MD-DIV                         PIC XX.
  1764         16  CO-MD-CENTER                      PIC X(4).
  1765         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1766         16  CO-CREATE-AP-CHECK                PIC X.
  1767         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1768         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  34
* EL050.cbl
  1769     12  CO-ACH-STATUS                         PIC X.
  1770         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1771         88  CO-ACH-PENDING                        VALUE 'P'.
  1772
  1773     12  CO-BILL-SW                            PIC X.
  1774     12  CO-CONTROL-NAME                       PIC X(30).
  1775     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1776     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1777     12  CO-CLP-STATE                          PIC XX.
  1778     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1779     12  CO-SPP-REFUND-EDIT                    PIC X.
  1780
  1781******************************************************************
  1782
  1783*    COPY ERCAGTC.
  1784******************************************************************
  1785*                                                                *
  1786*                                                                *
  1787*                            ERCAGTC                             *
  1788*                            VMOD=2.001                          *
  1789*                                                                *
  1790*   ONLINE CREDIT SYSTEM                                         *
  1791*                                                                *
  1792*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1793*                                                                *
  1794*   FILE TYPE = VSAM,KSDS                                        *
  1795*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1796*                                                                *
  1797*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1798*       ALTERNATE PATH = NONE                                    *
  1799*                                                                *
  1800*   LOG = NO                                                     *
  1801*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1802*                                                                *
  1803******************************************************************
  1804*                   C H A N G E   L O G
  1805*
  1806* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1807*-----------------------------------------------------------------
  1808*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1809* EFFECTIVE    NUMBER
  1810*-----------------------------------------------------------------
  1811* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1812* 111004                         NEW FILE AND COPYBOOK
  1813* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1814******************************************************************
  1815 01  AGENT-COMMISSIONS.
  1816     12  AG-RECORD-ID                          PIC XX.
  1817         88  VALID-CO-ID                          VALUE 'AG'.
  1818     12  AG-CONTROL-PRIMARY.
  1819         16  AG-COMPANY-CD                     PIC X.
  1820         16  AG-CONTROL.
  1821             20  AG-CTL-1.
  1822                 24  AG-CARR-GROUP.
  1823                     28  AG-CARRIER            PIC X.
  1824                     28  AG-GROUPING           PIC X(6).
  1825                 24  AG-BANK                   PIC X(10).
  1826             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  35
* EL050.cbl
  1827                 24  AG-EXP-DT                 PIC XX.
  1828         16  AG-TYPE                           PIC X.
  1829             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1830             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1831     12  AG-MAINT-INFORMATION.
  1832         16  AG-LAST-MAINT-DT                  PIC XX.
  1833         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1834         16  AG-LAST-MAINT-USER                PIC X(4).
  1835         16  FILLER                            PIC X(10).
  1836     12  AG-EFF-DT                             PIC XX.
  1837     12  AG-COMM-STRUCTURE.
  1838         16  AG-AGT-COMMS OCCURS 10.
  1839             20  AG-AGT                PIC X(10).
  1840             20  AG-COM-TYP            PIC X.
  1841             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1842             20  AG-RECALC-LV-INDIC    PIC X.
  1843             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1844             20  AG-LRCALC-LV-INDIC    PIC X.
  1845             20  FILLER                PIC X(05).
  1846     12  FILLER                  PIC X(145).
  1847******************************************************************
  1848*    COPY ERCRESS.
  1849******************************************************************
  1850*                                                                *
  1851*                            ERCRESS                             *
  1852*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1853*                            VMOD=2.002                          *
  1854*                                                                *
  1855*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1856*                                                                *
  1857*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1858*   VSAM RESIDENT STATE TAX MASTER                              *
  1859*                                                                *
  1860*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1861*                                                                *
  1862*   FILE TYPE = VSAM,KSDS                                        *
  1863*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1864*                                                                *
  1865*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1866*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1867*                                                                *
  1868*   LOG = NO                                                     *
  1869*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1870*                                                                *
  1871*                                                                *
  1872******************************************************************
  1873
  1874 01  RESIDENT-STATE-TAX-MASTER.
  1875
  1876     10  ERRESS-PRIMARY-KEY.
  1877         15  RES-COMPANY-CD        PIC X.
  1878         15  RES-RESIDENT-STATE    PIC XX.
  1879         15  RES-COVERAGE-CATEGORY PIC X.
  1880         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1881*                                      YYYYMMDD
  1882*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1883
  1884     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  36
* EL050.cbl
  1885
  1886         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1887         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1888         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1889         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1890
  1891     10 RES-RECALC-SW              PIC   X.
  1892         88 RECALC                VALUE 'Y'.
  1893         88 NO-RECALC             VALUE 'N'.
  1894     10  RES-MAINT-BY              PIC X(4).
  1895     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1896     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1897*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  37
* EL050.cbl
  1899*    COPY ERCRESC.
  1900******************************************************************
  1901*                                                                *
  1902*                            ERCRESC                             *
  1903*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1904*                            VMOD=2.003                          *
  1905*                                                                *
  1906*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1907*                                                                *
  1908*   FILE TYPE = VSAM,KSDS                                        *
  1909*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1910*                                                                *
  1911*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1912*       ALTERNATE PATH1 = NONE                                   *
  1913*                                                                *
  1914*   LOG = NO                                                     *
  1915*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1916*                                                                *
  1917******************************************************************
  1918
  1919 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1920
  1921     10  ERRESC-RECORD-KEY.
  1922         15  RESC-COMPANY-CD           PIC   X.
  1923         15  RESC-CARRIER              PIC   X.
  1924         15  RESC-GROUP                PIC   X(6).
  1925         15  RESC-STATE                PIC   XX.
  1926         15  RESC-ACCOUNT              PIC   X(10).
  1927         15  RESC-AGENT                PIC   X(10).
  1928         15  RESC-RESIDENT-STATE       PIC   XX.
  1929         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1930*                                           YYYYMMDD
  1931     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1932
  1933     10  RESC-COMM-RECORD-DATA.
  1934         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1935             20 RESC-COVERAGE-CAT      PIC    X.
  1936             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1937             20 RESC-COMMISSION-TAB REDEFINES
  1938                RESC-COMMISSION-PER    PIC  XXX.
  1939
  1940     10  RESC-MAINT-BY                 PIC X(4).
  1941     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1942     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1943*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  38
* EL050.cbl
  1945*    COPY ERCPLAN.
  1946******************************************************************
  1947*                                                                *
  1948*                                                                *
  1949*                            ERCPLAN                             *
  1950*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1951*                            VMOD=2.003                          *
  1952*                                                                *
  1953*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1954*                                                                *
  1955*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1956*   PLAN MASTER                                                  *
  1957*                                                                *
  1958*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1959*                                                                *
  1960*   FILE TYPE = VSAM,KSDS                                        *
  1961*   RECORD SIZE = 420   RECFORM = FIX                            *
  1962*                                                                *
  1963*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1964*       ALTERNATE PATH1 = N/A                                    *
  1965*                                                                *
  1966*   LOG = NO                                                     *
  1967*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1968*                                                                *
  1969*                                                                *
  1970******************************************************************
  1971
  1972 01  PLAN-MASTER.
  1973     12  PL-RECORD-ID                      PIC XX.
  1974         88  VALID-PL-ID                      VALUE 'PL'.
  1975
  1976     12  PL-CONTROL-PRIMARY.
  1977         16  PL-COMPANY-CD                 PIC X.
  1978         16  PL-MSTR-CNTRL.
  1979             20  PL-CONTROL-A.
  1980                 24  PL-CARRIER            PIC X.
  1981                 24  PL-GROUPING           PIC X(6).
  1982                 24  PL-STATE              PIC XX.
  1983                 24  PL-ACCOUNT            PIC X(10).
  1984             20  PL-BENEFIT-TYPE           PIC X.
  1985             20  PL-BENEFIT-CODE           PIC XX.
  1986             20  PL-REVISION-NO            PIC X(3).
  1987
  1988     12  PL-CONTROL-BY-VAR-GRP.
  1989         16  PL-COMPANY-CD-A1              PIC X.
  1990         16  PL-VG-CARRIER                 PIC X.
  1991         16  PL-VG-GROUPING                PIC X(6).
  1992         16  PL-VG-STATE                   PIC XX.
  1993         16  PL-VG-ACCOUNT                 PIC X(10).
  1994         16  PL-BENEFIT-TYPE-A1            PIC X.
  1995         16  PL-BENEFIT-CODE-A1            PIC XX.
  1996         16  PL-REVISION-NO-A1             PIC 999.
  1997
  1998     12  PL-MAINT-INFORMATION.
  1999         16  PL-LAST-MAINT-DT              PIC XX.
  2000         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2001         16  PL-LAST-MAINT-USER            PIC X(4).
  2002         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  39
* EL050.cbl
  2003
  2004     12  PL-LIABILITY-LIMITS.
  2005         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2006         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2007             20  PL-LM-AGE                 PIC S99        COMP-3.
  2008             20  PL-LM-DUR                 PIC S999       COMP-3.
  2009             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2010             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2011
  2012     12  FILLER                            PIC X(30).
  2013
  2014     12  PL-GL-ACCOUNT-NOS.
  2015         16  PL-PREMIUM-GL                 PIC X(8).
  2016         16  PL-COMM-GL                    PIC X(8).
  2017         16  PL-CLAIM-GL                   PIC X(8).
  2018     12  FILLER                            PIC X(24).
  2019     12  PL-TOLERANCES.
  2020         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2021         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2022         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2023         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2024         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2025         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2026     12  PL-OVER-SHORT.
  2027         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2028         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2029     12  FILLER                            PIC X(24).
  2030     12  PLAN-MISC.
  2031         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2032         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2033         16  PL-IG                         PIC X.
  2034         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2035         16  PL-POLICY-FORM                PIC X(12).
  2036         16  PL-EDIT-FOR-FORM              PIC X(01).
  2037         16  PL-DEV-CODE                   PIC XXX.
  2038         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2039         16  PL-CALC-METHOD                PIC X.
  2040         16  PL-BENEFIT-GROUP              PIC X(05).
  2041         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2042
  2043         16  FILLER                        PIC X(99).
  2044******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  40
* EL050.cbl
  2046*    COPY ELCCERT.
  2047******************************************************************
  2048*                                                                *
  2049*                            ELCCERT.                            *
  2050*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2051*                            VMOD=2.013                          *
  2052*                                                                *
  2053*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2054*                                                                *
  2055*   FILE TYPE = VSAM,KSDS                                        *
  2056*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2057*                                                                *
  2058*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2059*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2060*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2061*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2062*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2063*                                                                *
  2064*   LOG = YES                                                    *
  2065*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2066******************************************************************
  2067*                   C H A N G E   L O G
  2068*
  2069* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2070*-----------------------------------------------------------------
  2071*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2072* EFFECTIVE    NUMBER
  2073*-----------------------------------------------------------------
  2074* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2075* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2076* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2077* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2078* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2079* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2080* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2081* 032612  CR2011110200001  PEMA  AHL CHANGES
  2082******************************************************************
  2083
  2084 01  CERTIFICATE-MASTER.
  2085     12  CM-RECORD-ID                      PIC XX.
  2086         88  VALID-CM-ID                      VALUE 'CM'.
  2087
  2088     12  CM-CONTROL-PRIMARY.
  2089         16  CM-COMPANY-CD                 PIC X.
  2090         16  CM-CARRIER                    PIC X.
  2091         16  CM-GROUPING.
  2092             20  CM-GROUPING-PREFIX        PIC X(3).
  2093             20  CM-GROUPING-PRIME         PIC X(3).
  2094         16  CM-STATE                      PIC XX.
  2095         16  CM-ACCOUNT.
  2096             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2097             20  CM-ACCOUNT-PRIME          PIC X(6).
  2098         16  CM-CERT-EFF-DT                PIC XX.
  2099         16  CM-CERT-NO.
  2100             20  CM-CERT-PRIME             PIC X(10).
  2101             20  CM-CERT-SFX               PIC X.
  2102
  2103     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  41
* EL050.cbl
  2104         16  CM-COMPANY-CD-A1              PIC X.
  2105         16  CM-INSURED-LAST-NAME          PIC X(15).
  2106         16  CM-INSURED-INITIALS.
  2107             20  CM-INSURED-INITIAL1       PIC X.
  2108             20  CM-INSURED-INITIAL2       PIC X.
  2109
  2110     12  CM-CONTROL-BY-SSN.
  2111         16  CM-COMPANY-CD-A2              PIC X.
  2112         16  CM-SOC-SEC-NO.
  2113             20  CM-SSN-STATE              PIC XX.
  2114             20  CM-SSN-ACCOUNT            PIC X(6).
  2115             20  CM-SSN-LN3.
  2116                 25  CM-INSURED-INITIALS-A2.
  2117                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2118                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2119                 25 CM-PART-LAST-NAME-A2         PIC X.
  2120
  2121     12  CM-CONTROL-BY-CERT-NO.
  2122         16  CM-COMPANY-CD-A4              PIC X.
  2123         16  CM-CERT-NO-A4                 PIC X(11).
  2124
  2125     12  CM-CONTROL-BY-MEMB.
  2126         16  CM-COMPANY-CD-A5              PIC X.
  2127         16  CM-MEMBER-NO.
  2128             20  CM-MEMB-STATE             PIC XX.
  2129             20  CM-MEMB-ACCOUNT           PIC X(6).
  2130             20  CM-MEMB-LN4.
  2131                 25  CM-INSURED-INITIALS-A5.
  2132                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2133                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2134                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2135
  2136     12  CM-INSURED-PROFILE-DATA.
  2137         16  CM-INSURED-FIRST-NAME.
  2138             20  CM-INSURED-1ST-INIT       PIC X.
  2139             20  FILLER                    PIC X(9).
  2140         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2141         16  CM-INSURED-SEX                PIC X.
  2142             88  CM-SEX-MALE                  VALUE 'M'.
  2143             88  CM-SEX-FEMAL                 VALUE 'F'.
  2144         16  CM-INSURED-JOINT-AGE          PIC 99.
  2145         16  CM-JOINT-INSURED-NAME.
  2146             20  CM-JT-LAST-NAME           PIC X(15).
  2147             20  CM-JT-FIRST-NAME.
  2148                 24  CM-JT-1ST-INIT        PIC X.
  2149                 24  FILLER                PIC X(9).
  2150             20  CM-JT-INITIAL             PIC X.
  2151
  2152     12  CM-LIFE-DATA.
  2153         16  CM-LF-BENEFIT-CD              PIC XX.
  2154         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2155         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2156         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2157         16  CM-LF-DEV-CODE                PIC XXX.
  2158         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2159         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2160         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2161         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  42
* EL050.cbl
  2162         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2163         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2164         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2165         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2166         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2167         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2168         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2169         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2170         16  FILLER                        PIC XX.
  2171
  2172     12  CM-AH-DATA.
  2173         16  CM-AH-BENEFIT-CD              PIC XX.
  2174         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2175         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2176         16  CM-AH-DEV-CODE                PIC XXX.
  2177         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2178         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2179         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2180         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2181         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2182         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2183         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2184         16  CM-AH-PAID-THRU-DT            PIC XX.
  2185             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2186         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2187         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2188         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2189         16  FILLER                        PIC X.
  2190
  2191     12  CM-LOAN-INFORMATION.
  2192         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2193         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2194                                           PIC S9(5)V99  COMP-3.
  2195         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2196         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2197         16  CM-PAY-FREQUENCY              PIC S99.
  2198         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2199         16  CM-RATE-CLASS                 PIC XX.
  2200         16  CM-BENEFICIARY                PIC X(25).
  2201         16  CM-POLICY-FORM-NO             PIC X(12).
  2202         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2203         16  CM-LAST-ADD-ON-DT             PIC XX.
  2204         16  CM-DEDUCTIBLE-AMOUNTS.
  2205             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2206             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2207         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2208             20  CM-RESIDENT-STATE         PIC XX.
  2209             20  CM-RATE-CODE              PIC X(4).
  2210             20  FILLER                    PIC XX.
  2211         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2212             20  CM-LOAN-OFFICER           PIC X(5).
  2213             20  FILLER                    PIC XXX.
  2214         16  CM-CSR-CODE                   PIC XXX.
  2215         16  CM-UNDERWRITING-CODE          PIC X.
  2216             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2217         16  CM-POST-CARD-IND              PIC X.
  2218         16  CM-NH-INTERFACE-SW            PIC X.
  2219         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  43
* EL050.cbl
  2220             88  CM-SING-PRM                  VALUE '1'.
  2221             88  CM-O-B-COVERAGE              VALUE '2'.
  2222             88  CM-OPEN-END                  VALUE '3'.
  2223         16  CM-IND-GRP-TYPE               PIC X.
  2224             88  CM-INDIVIDUAL                VALUE 'I'.
  2225             88  CM-GROUP                     VALUE 'G'.
  2226         16  CM-SKIP-CODE                  PIC X.
  2227             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2228             88  SKIP-JULY                    VALUE '1'.
  2229             88  SKIP-AUGUST                  VALUE '2'.
  2230             88  SKIP-SEPTEMBER               VALUE '3'.
  2231             88  SKIP-JULY-AUG                VALUE '4'.
  2232             88  SKIP-AUG-SEPT                VALUE '5'.
  2233             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2234             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2235             88  SKIP-JUNE                    VALUE '8'.
  2236             88  SKIP-JUNE-JULY               VALUE '9'.
  2237             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2238             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2239         16  CM-PAYMENT-MODE               PIC X.
  2240             88  PAY-MONTHLY                  VALUE SPACE.
  2241             88  PAY-WEEKLY                   VALUE '1'.
  2242             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2243             88  PAY-BI-WEEKLY                VALUE '3'.
  2244             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2245         16  CM-LOAN-NUMBER                PIC X(8).
  2246         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2247         16  CM-OLD-LOF                    PIC XXX.
  2248*        16  CM-LOAN-OFFICER               PIC XXX.
  2249         16  CM-REIN-TABLE                 PIC XXX.
  2250         16  CM-SPECIAL-REIN-CODE          PIC X.
  2251         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2252         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2253         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2254
  2255     12  CM-STATUS-DATA.
  2256         16  CM-ENTRY-STATUS               PIC X.
  2257         16  CM-ENTRY-DT                   PIC XX.
  2258
  2259         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2260         16  CM-LF-CANCEL-DT               PIC XX.
  2261         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2262
  2263         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2264         16  CM-LF-DEATH-DT                PIC XX.
  2265         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2266
  2267         16  CM-LF-CURRENT-STATUS          PIC X.
  2268             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2269                                                'M' '4' '5' '9'.
  2270             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2271             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2272             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2273             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2274             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2275             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2276             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2277             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  44
* EL050.cbl
  2278             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2279             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2280             88  CM-LF-DECLINED               VALUE 'D'.
  2281             88  CM-LF-VOIDED                 VALUE 'V'.
  2282
  2283         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2284         16  CM-AH-CANCEL-DT               PIC XX.
  2285         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2286
  2287         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2288         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2289         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2290
  2291         16  CM-AH-CURRENT-STATUS          PIC X.
  2292             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2293                                                'M' '4' '5' '9'.
  2294             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2295             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2296             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2297             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2298             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2299             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2300             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2301             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2302             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2303             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2304             88  CM-AH-DECLINED               VALUE 'D'.
  2305             88  CM-AH-VOIDED                 VALUE 'V'.
  2306
  2307         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2308             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2309             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2310             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2311         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2312
  2313         16  CM-ENTRY-BATCH                PIC X(6).
  2314         16  CM-LF-EXIT-BATCH              PIC X(6).
  2315         16  CM-AH-EXIT-BATCH              PIC X(6).
  2316         16  CM-LAST-MONTH-END             PIC XX.
  2317
  2318     12  CM-NOTE-SW                        PIC X.
  2319         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2320         88  CERT-NOTES-PRESENT               VALUE '1'.
  2321         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2322         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2323         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2324         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2325         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2326         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2327     12  CM-COMP-EXCP-SW                   PIC X.
  2328         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2329         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2330     12  CM-INSURED-ADDRESS-SW             PIC X.
  2331         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2332         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2333
  2334*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2335     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  45
* EL050.cbl
  2336     12  FILLER                            PIC X.
  2337
  2338*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2339     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2340     12  FILLER                            PIC X.
  2341*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2342     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2343
  2344     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2345         88  CERT-ADDED-BATCH                 VALUE ' '.
  2346         88  CERT-ADDED-ONLINE                VALUE '1'.
  2347         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2348         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2349         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2350     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2351         88  CERT-AS-LOADED                   VALUE ' '.
  2352         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2353         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2354         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2355         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2356         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2357         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2358         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2359
  2360     12  CM-ACCOUNT-COMM-PCTS.
  2361         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2362         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2363
  2364     12  CM-USER-FIELD                     PIC X.
  2365     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2366     12  CM-CLP-STATE                      PIC XX.
  2367     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2368     12  CM-USER-RESERVED                  PIC XXX.
  2369     12  FILLER REDEFINES CM-USER-RESERVED.
  2370         16  CM-AH-CLASS-CD                PIC XX.
  2371         16  F                             PIC X.
  2372******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  46
* EL050.cbl
  2374*    COPY ERCMAIL.
  2375******************************************************************
  2376*                                                                *
  2377*                                                                *
  2378*                            ERCMAIL                             *
  2379*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2380*                            VMOD=2.003                          *
  2381*                                                                *
  2382*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2383*                                                                *
  2384*   FILE TYPE = VSAM,KSDS                                        *
  2385*   RECORD SIZE = 374   RECFORM = FIX                            *
  2386*                                                                *
  2387*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2388*   ALTERNATE PATH    = NOT USED                                 *
  2389*                                                                *
  2390*   LOG = YES                                                    *
  2391*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2392******************************************************************
  2393*                   C H A N G E   L O G
  2394*
  2395* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2396*-----------------------------------------------------------------
  2397*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2398* EFFECTIVE    NUMBER
  2399*-----------------------------------------------------------------
  2400* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2401* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2402* 111108                   PEMA  ADD CRED BENE ADDR2
  2403******************************************************************
  2404
  2405 01  MAILING-DATA.
  2406     12  MA-RECORD-ID                      PIC XX.
  2407         88  VALID-MA-ID                       VALUE 'MA'.
  2408
  2409     12  MA-CONTROL-PRIMARY.
  2410         16  MA-COMPANY-CD                 PIC X.
  2411         16  MA-CARRIER                    PIC X.
  2412         16  MA-GROUPING.
  2413             20  MA-GROUPING-PREFIX        PIC XXX.
  2414             20  MA-GROUPING-PRIME         PIC XXX.
  2415         16  MA-STATE                      PIC XX.
  2416         16  MA-ACCOUNT.
  2417             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2418             20  MA-ACCOUNT-PRIME          PIC X(6).
  2419         16  MA-CERT-EFF-DT                PIC XX.
  2420         16  MA-CERT-NO.
  2421             20  MA-CERT-PRIME             PIC X(10).
  2422             20  MA-CERT-SFX               PIC X.
  2423
  2424     12  FILLER                            PIC XX.
  2425
  2426     12  MA-ACCESS-CONTROL.
  2427         16  MA-SOURCE-SYSTEM              PIC XX.
  2428             88  MA-FROM-CREDIT                VALUE 'CR'.
  2429             88  MA-FROM-VSI                   VALUE 'VS'.
  2430             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2431             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  47
* EL050.cbl
  2432         16  MA-RECORD-ADD-DT              PIC XX.
  2433         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2434         16  MA-LAST-MAINT-DT              PIC XX.
  2435         16  MA-LAST-MAINT-BY              PIC XXXX.
  2436         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2437
  2438     12  MA-PROFILE-INFO.
  2439         16  MA-QUALIFY-CODE-1             PIC XX.
  2440         16  MA-QUALIFY-CODE-2             PIC XX.
  2441         16  MA-QUALIFY-CODE-3             PIC XX.
  2442         16  MA-QUALIFY-CODE-4             PIC XX.
  2443         16  MA-QUALIFY-CODE-5             PIC XX.
  2444
  2445         16  MA-INSURED-LAST-NAME          PIC X(15).
  2446         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2447         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2448         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2449         16  MA-INSURED-BIRTH-DT           PIC XX.
  2450         16  MA-INSURED-SEX                PIC X.
  2451             88  MA-SEX-MALE                   VALUE 'M'.
  2452             88  MA-SEX-FEMALE                 VALUE 'F'.
  2453         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2454
  2455         16  MA-ADDRESS-CORRECTED          PIC X.
  2456         16  MA-JOINT-BIRTH-DT             PIC XX.
  2457*        16  FILLER                        PIC X(12).
  2458
  2459         16  MA-ADDRESS-LINE-1             PIC X(30).
  2460         16  MA-ADDRESS-LINE-2             PIC X(30).
  2461         16  MA-CITY-STATE.
  2462             20  MA-CITY                   PIC X(28).
  2463             20  MA-ADDR-STATE             PIC XX.
  2464         16  MA-ZIP.
  2465             20  MA-ZIP-CODE.
  2466                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2467                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2468                 24  FILLER                PIC X(4).
  2469             20  MA-ZIP-PLUS4              PIC X(4).
  2470         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2471             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2472             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2473             20  FILLER                    PIC X(3).
  2474
  2475         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2476
  2477         16  FILLER                        PIC XXX.
  2478*        16  FILLER                        PIC X(10).
  2479
  2480     12  MA-CRED-BENE-INFO.
  2481         16  MA-CRED-BENE-NAME                 PIC X(25).
  2482         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2483         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2484         16  MA-CRED-BENE-CTYST.
  2485             20  MA-CRED-BENE-CITY             PIC X(28).
  2486             20  MA-CRED-BENE-STATE            PIC XX.
  2487         16  MA-CRED-BENE-ZIP.
  2488             20  MA-CB-ZIP-CODE.
  2489                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  48
* EL050.cbl
  2490                     88  MA-CB-CANADIAN-POST-CODE
  2491                                           VALUE 'A' THRU 'Z'.
  2492                 24  FILLER                    PIC X(4).
  2493             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2494         16  MA-CB-CANADIAN-POSTAL-CODE
  2495                            REDEFINES MA-CRED-BENE-ZIP.
  2496             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2497             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2498             20  FILLER                        PIC X(3).
  2499     12  MA-POST-CARD-MAIL-DATA.
  2500         16  MA-MAIL-DATA OCCURS 7.
  2501             20  MA-MAIL-TYPE              PIC X.
  2502                 88  MA-12MO-MAILING           VALUE '1'.
  2503                 88  MA-EXP-MAILING            VALUE '2'.
  2504             20  MA-MAIL-STATUS            PIC X.
  2505                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2506                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2507                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2508             20  MA-MAIL-DATE              PIC XX.
  2509     12  FILLER                            PIC XX.
  2510     12  FILLER                            PIC XX.
  2511*    12  FILLER                            PIC X(30).
  2512******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  49
* EL050.cbl
  2514*    COPY ERCPNDM.
  2515******************************************************************
  2516*                                                                *
  2517*                                                                *
  2518*                            ERCPNDM                             *
  2519*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2520*                            VMOD=2.003                          *
  2521*                                                                *
  2522*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2523*                                                                *
  2524*   FILE TYPE = VSAM,KSDS                                        *
  2525*   RECORD SIZE = 374   RECFORM = FIX                            *
  2526*                                                                *
  2527*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2528*   ALTERNATE PATH    = NOT USED                                 *
  2529*                                                                *
  2530*   LOG = YES                                                    *
  2531*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2532******************************************************************
  2533*                   C H A N G E   L O G
  2534*
  2535* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2536*-----------------------------------------------------------------
  2537*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2538* EFFECTIVE    NUMBER
  2539*-----------------------------------------------------------------
  2540* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2541* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2542* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2543******************************************************************
  2544
  2545 01  PENDING-MAILING-DATA.
  2546     12  PM-RECORD-ID                      PIC XX.
  2547         88  VALID-MA-ID                       VALUE 'PM'.
  2548
  2549     12  PM-CONTROL-PRIMARY.
  2550         16  PM-COMPANY-CD                 PIC X.
  2551         16  PM-ENTRY-BATCH                PIC X(6).
  2552         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2553         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2554
  2555     12  FILLER                            PIC X(14).
  2556
  2557     12  PM-ACCESS-CONTROL.
  2558         16  PM-SOURCE-SYSTEM              PIC XX.
  2559             88  PM-FROM-CREDIT                VALUE 'CR'.
  2560             88  PM-FROM-VSI                   VALUE 'VS'.
  2561             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2562             88  PM-FROM-OTHER                 VALUE 'OT'.
  2563         16  PM-RECORD-ADD-DT              PIC XX.
  2564         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2565         16  PM-LAST-MAINT-DT              PIC XX.
  2566         16  PM-LAST-MAINT-BY              PIC XXXX.
  2567         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2568
  2569     12  PM-PROFILE-INFO.
  2570         16  PM-QUALIFY-CODE-1             PIC XX.
  2571         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  50
* EL050.cbl
  2572         16  PM-QUALIFY-CODE-3             PIC XX.
  2573         16  PM-QUALIFY-CODE-4             PIC XX.
  2574         16  PM-QUALIFY-CODE-5             PIC XX.
  2575
  2576         16  PM-INSURED-LAST-NAME          PIC X(15).
  2577         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2578         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2579         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2580         16  PM-INSURED-BIRTH-DT           PIC XX.
  2581         16  PM-INSURED-SEX                PIC X.
  2582             88  PM-SEX-MALE                   VALUE 'M'.
  2583             88  PM-SEX-FEMALE                 VALUE 'F'.
  2584         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2585
  2586         16  PM-ADDRESS-CORRECTED          PIC X.
  2587         16  PM-JOINT-BIRTH-DT             PIC XX.
  2588*        16  FILLER                        PIC X(12).
  2589
  2590         16  PM-ADDRESS-LINE-1             PIC X(30).
  2591         16  PM-ADDRESS-LINE-2             PIC X(30).
  2592         16  PM-CITY-STATE.
  2593             20  PM-CITY                   PIC X(28).
  2594             20  PM-STATE                  PIC XX.
  2595         16  PM-ZIP.
  2596             20  PM-ZIP-CODE.
  2597                 24  PM-ZIP-1              PIC X.
  2598                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2599                 24  FILLER                PIC X(4).
  2600             20  PM-ZIP-PLUS4              PIC X(4).
  2601         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2602             20  PM-CAN-POST1              PIC XXX.
  2603             20  PM-CAN-POST2              PIC XXX.
  2604             20  FILLER                    PIC XXX.
  2605
  2606         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2607
  2608         16  FILLER                        PIC X(03).
  2609
  2610     12  PM-CRED-BENE-INFO.
  2611         16  PM-CRED-BENE-NAME             PIC X(25).
  2612         16  PM-CRED-BENE-ADDR             PIC X(30).
  2613         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2614         16  PM-CRED-BENE-CTYST.
  2615             20  PM-CRED-BENE-CITY         PIC X(28).
  2616             20  PM-CRED-BENE-STATE        PIC XX.
  2617         16  PM-CRED-BENE-ZIP.
  2618             20  PM-CB-ZIP-CODE.
  2619                 24  PM-CB-ZIP-1           PIC X.
  2620                     88  PM-CB-CANADIAN-POST-CODE
  2621                                  VALUE 'A' THRU 'Z'.
  2622                 24  FILLER                PIC X(4).
  2623             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2624         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2625             20  PM-CB-CAN-POST1           PIC XXX.
  2626             20  PM-CB-CAN-POST2           PIC XXX.
  2627             20  FILLER                    PIC XXX.
  2628     12  PM-POST-CARD-MAIL-DATA.
  2629         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  51
* EL050.cbl
  2630             20  PM-MAIL-TYPE              PIC X.
  2631                 88  PM-12MO-MAILING           VALUE '1'.
  2632                 88  PM-EXP-MAILING            VALUE '2'.
  2633             20  PM-MAIL-STATUS            PIC X.
  2634                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2635                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2636                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2637             20  PM-MAIL-DATE              PIC XX.
  2638     12  FILLER                            PIC XX.
  2639     12  FILLER                            PIC X(12).
  2640*    12  FILLER                            PIC X(30).
  2641
  2642******************************************************************
  2643*                                COPY ERCLOFC.
  2644******************************************************************
  2645*                                                                *
  2646*                                                                *
  2647*                            ERCLOFC                             *
  2648*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2649*                            VMOD=2.003                          *
  2650*                                                                *
  2651*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2652*                                                                *
  2653*   FILE TYPE = VSAM,KSDS                                        *
  2654*   RECORD SIZE = 670   RECFORM = FIX                            *
  2655*                                                                *
  2656*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2657*                                                                *
  2658*   LOG = YES                                                    *
  2659*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2660*                                                                *
  2661******************************************************************
  2662
  2663 01  LOAN-OFFICER-MASTER.
  2664     12  LO-RECORD-ID                PIC XX.
  2665         88  VALID-LO-ID                VALUE 'LO'.
  2666
  2667     12  LO-CONTROL-PRIMARY.
  2668         16  LO-COMPANY-CD           PIC X.
  2669         16  LO-CARRIER              PIC X.
  2670         16  LO-GROUPING.
  2671             20  LO-GROUPING-PREFIX  PIC XXX.
  2672             20  LO-GROUPING-PRIME   PIC XXX.
  2673         16  LO-STATE                PIC XX.
  2674         16  LO-ACCOUNT.
  2675             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2676             20  LO-ACCOUNT-PRIME    PIC X(6).
  2677         16  LO-OFFICER-CODE         PIC X(5).
  2678
  2679     12  LO-OFFICER-NAME             PIC X(30).
  2680
  2681     12  LO-LAST-MAINT-DT            PIC XX.
  2682     12  LO-LAST-USER                PIC X(4).
  2683     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2684
  2685     12  LO-COMP-CONTROL             PIC X.
  2686             88  LO-SHOW-COMP           VALUE 'Y'.
  2687             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  52
* EL050.cbl
  2688     12  LO-DETAIL-CONTROL           PIC X.
  2689             88  LO-PRINT-DETAIL        VALUE 'D'.
  2690             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2691
  2692     12  LO-SV-CARRIER               PIC X.
  2693     12  LO-SV-GROUPING              PIC X(6).
  2694     12  LO-SV-STATE                 PIC XX.
  2695
  2696     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2697     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2698
  2699     12  LO-OFFICER-INFO.
  2700         16  FILLER OCCURS 12 TIMES.
  2701             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2702             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2703             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2704             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2705             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2706             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2707             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2708             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2709     12  FILLER                      PIC X(198).
  2710******************************************************************
  2711*                                COPY ERCPDEF.
  2712******************************************************************
  2713*                                                                *
  2714*                                                                *
  2715*                            ERCPDEF.                            *
  2716*                                                                *
  2717*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2718*                                                                *
  2719*    FILE TYPE = VSAM,KSDS                                       *
  2720*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2721*                                                                *
  2722*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2723*                                                                *
  2724*    LOG = YES                                                   *
  2725*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2726******************************************************************
  2727 01  PRODUCT-MASTER.
  2728    12  PD-RECORD-ID                 PIC X(02).
  2729        88  VALID-PD-ID                  VALUE 'PD'.
  2730    12  PD-CONTROL-PRIMARY.
  2731        16  PD-COMPANY-CD            PIC X.
  2732        16  PD-STATE                 PIC XX.
  2733        16  PD-PRODUCT-CD            PIC XXX.
  2734        16  PD-FILLER                PIC X(7).
  2735        16  PD-BEN-TYPE              PIC X.
  2736        16  PD-BEN-CODE              PIC XX.
  2737        16  PD-PROD-EXP-DT           PIC XX.
  2738    12  FILLER                       PIC X(50).
  2739    12  PD-PRODUCT-DATA OCCURS 8.
  2740        16  PD-PROD-CODE             PIC X.
  2741            88  PD-PROD-LIFE           VALUE 'L'.
  2742            88  PD-PROD-PROP           VALUE 'P'.
  2743            88  PD-PROD-AH             VALUE 'A'.
  2744            88  PD-PROD-IU             VALUE 'I'.
  2745            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  53
* EL050.cbl
  2746        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2747        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2748        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2749        16  PD-MAX-TERM              PIC S999        COMP-3.
  2750        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2751        16  FILLER                   PIC X.
  2752        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2753        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2754        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2755        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2756        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2757        16  PD-REC-CRIT-PERIOD       PIC X.
  2758        16  PD-RTW-MOS               PIC 99.
  2759        16  FILLER                   PIC X(5).
  2760    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2761    12  PD-TERM-LIMITS OCCURS 15.
  2762        16  PD-LOW-TERM              PIC S999        COMP-3.
  2763        16  PD-HI-TERM               PIC S999        COMP-3.
  2764*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2765    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2766        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2767        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2768    12  PD-EARN-FACTORS.
  2769        16  FILLER OCCURS 15.
  2770            20  FILLER OCCURS 15.
  2771                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2772    12  PD-PRODUCT-DESC              PIC X(80).
  2773    12  PD-TRUNCATED                 PIC X.
  2774    12  FILLER                       PIC X(59).
  2775    12  PD-MAINT-INFORMATION.
  2776        16  PD-LAST-MAINT-DT         PIC X(02).
  2777        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2778        16  PD-LAST-MAINT-BY         PIC X(04).
  2779*                                COPY ELCSTATE.
  2780******************************************************************
  2781*                                                                *
  2782*                                                                *
  2783*                            ELCSTATE.                           *
  2784*                                                                *
  2785*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2786*                                                                *
  2787*   FILE TYPE = VSAM,KSDS                                        *
  2788*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2789*                                                                *
  2790*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2791*       ALTERNATE INDEX = NONE                                   *
  2792*                                                                *
  2793*   LOG = YES                                                    *
  2794*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2795******************************************************************
  2796*                   C H A N G E   L O G
  2797*
  2798* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2799*-----------------------------------------------------------------
  2800*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2801* EFFECTIVE    NUMBER
  2802*-----------------------------------------------------------------
  2803* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  54
* EL050.cbl
  2804******************************************************************
  2805*
  2806 01  STATE-FILE.
  2807     12  SF-RECORD-ID                       PIC XX.
  2808         88  VALID-CF-ID                        VALUE 'SF'.
  2809     12  SF-CONTROL-PRIMARY.
  2810         16  SF-COMPANY-ID                  PIC XXX.
  2811         16  SF-CARRIER-CODE                PIC X.
  2812         16  SF-GROUPING                    PIC X(6).
  2813         16  SF-STATE-CODE                  PIC XX.
  2814         16  SF-EXPIRE-DATE                 PIC 9(8).
  2815****************************************************************
  2816*             STATE CONTROLS
  2817****************************************************************
  2818     12  SF-LAST-MAINT-DT                   PIC XX.
  2819     12  SF-LAST-MAINT-BY                   PIC X(4).
  2820     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2821     12  SF-STATE-RT-CONTROLS.
  2822         16  SF-ST-RT-CALC                  PIC X.
  2823     12  SF-ST-TAX-CONTROLS.
  2824         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2825         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2826         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2827     12  SF-ST-REFUND-OPTIONS.
  2828         16  SF-ST-RF-LR-CALC               PIC X.
  2829         16  SF-ST-RF-LL-CALC               PIC X.
  2830         16  SF-ST-RF-LN-CALC               PIC X.
  2831         16  SF-ST-RF-AH-CALC               PIC X.
  2832         16  SF-ST-RF-CP-CALC               PIC X.
  2833     12  SF-ST-UNEARN-PREM-OPTIONS.
  2834         16  SF-ST-LUEP-R78                 PIC X.
  2835         16  SF-ST-LUEP-PRO                 PIC X.
  2836         16  SF-ST-LUEP-ST                  PIC X.
  2837         16  SF-ST-LUEP-DOM                 PIC X.
  2838         16  SF-ST-AUEP-R78                 PIC X.
  2839         16  SF-ST-AUEP-PRO                 PIC X.
  2840         16  SF-ST-AUEP-ST                  PIC X.
  2841         16  SF-ST-AUEP-DOM                 PIC X.
  2842         16  SF-ST-CUEP-R78                 PIC X.
  2843         16  SF-ST-CUEP-PRO                 PIC X.
  2844         16  SF-ST-CUEP-ST                  PIC X.
  2845         16  SF-ST-CUEP-DOM                 PIC X.
  2846     12  SF-ST-EARN-PREM-OPTIONS.
  2847         16  SF-ST-LEP-R78                  PIC X.
  2848         16  SF-ST-LEP-PRO                  PIC X.
  2849         16  SF-ST-LEP-ST                   PIC X.
  2850         16  SF-ST-LEP-DOM                  PIC X.
  2851         16  SF-ST-AEP-R78                  PIC X.
  2852         16  SF-ST-AEP-PRO                  PIC X.
  2853         16  SF-ST-AEP-ST                   PIC X.
  2854         16  SF-ST-AEP-DOM                  PIC X.
  2855         16  SF-ST-CEP-R78                  PIC X.
  2856         16  SF-ST-CEP-PRO                  PIC X.
  2857         16  SF-ST-CEP-ST                   PIC X.
  2858         16  SF-ST-CEP-DOM                  PIC X.
  2859     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  55
* EL050.cbl
  2861*    COPY ELCCRTT.
  2862******************************************************************
  2863*                                                                *
  2864*                            ELCCRTT.                            *
  2865*                                                                *
  2866*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2867*                                                                *
  2868*   FILE TYPE = VSAM,KSDS                                        *
  2869*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2870*                                                                *
  2871*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2872*                                                                *
  2873*   LOG = YES                                                    *
  2874*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2875******************************************************************
  2876*                   C H A N G E   L O G
  2877*
  2878* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2879*-----------------------------------------------------------------
  2880*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2881* EFFECTIVE    NUMBER
  2882*-----------------------------------------------------------------
  2883* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2884* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2885* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2886* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2887******************************************************************
  2888
  2889 01  CERTIFICATE-TRAILERS.
  2890     12  CS-RECORD-ID                      PIC XX.
  2891         88  VALID-CS-ID                      VALUE 'CS'.
  2892
  2893     12  CS-CONTROL-PRIMARY.
  2894         16  CS-COMPANY-CD                 PIC X.
  2895         16  CS-CARRIER                    PIC X.
  2896         16  CS-GROUPING                   PIC X(6).
  2897         16  CS-STATE                      PIC XX.
  2898         16  CS-ACCOUNT                    PIC X(10).
  2899         16  CS-CERT-EFF-DT                PIC XX.
  2900         16  CS-CERT-NO.
  2901             20  CS-CERT-PRIME             PIC X(10).
  2902             20  CS-CERT-SFX               PIC X.
  2903         16  CS-TRAILER-TYPE               PIC X.
  2904             88  COMM-TRLR           VALUE 'A'.
  2905             88  FUTURE-TRLR         VALUE 'B'.
  2906             88  CERT-DATA-TRLR      VALUE 'C'.
  2907
  2908     12  CS-DATA-AREA                      PIC X(516).
  2909
  2910     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2911         16  CS-BANK-COMMISSION-AREA.
  2912             20  CS-BANK-COMMS       OCCURS 10.
  2913                 24  CS-AGT                PIC X(10).
  2914                 24  CS-COM-TYP            PIC X.
  2915                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2916                 24  CS-RECALC-LV-INDIC    PIC X.
  2917                 24  FILLER                PIC X(10).
  2918         16  FILLER                        PIC X(256).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  56
* EL050.cbl
  2919
  2920     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2921         16  CS-VIN-NUMBER                 PIC X(17).
  2922         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2923         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2924         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2925         16  FILLER                        PIC X(496).
  2926******************************************************************
  2927*    COPY ELCCRTO.
  2928******************************************************************
  2929*                                                                *
  2930*                            ELCCRTO.                            *
  2931*                                                                *
  2932*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2933*                                                                *
  2934*   FILE TYPE = VSAM,KSDS                                        *
  2935*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2936*                                                                *
  2937*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2938*                                                                *
  2939*   LOG = YES                                                    *
  2940*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2941******************************************************************
  2942*                   C H A N G E   L O G
  2943*
  2944* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2945*-----------------------------------------------------------------
  2946*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2947* EFFECTIVE    NUMBER
  2948*-----------------------------------------------------------------
  2949* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2950* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2951* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2952* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2953******************************************************************
  2954 01  ORIGINAL-CERTIFICATE.
  2955     12  OC-RECORD-ID                      PIC XX.
  2956         88  VALID-OC-ID                      VALUE 'OC'.
  2957     12  OC-CONTROL-PRIMARY.
  2958         16  OC-COMPANY-CD                 PIC X.
  2959         16  OC-CARRIER                    PIC X.
  2960         16  OC-GROUPING                   PIC X(6).
  2961         16  OC-STATE                      PIC XX.
  2962         16  OC-ACCOUNT                    PIC X(10).
  2963         16  OC-CERT-EFF-DT                PIC XX.
  2964         16  OC-CERT-NO.
  2965             20  OC-CERT-PRIME             PIC X(10).
  2966             20  OC-CERT-SFX               PIC X.
  2967         16  OC-RECORD-TYPE                PIC X.
  2968         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2969     12  OC-LAST-MAINT-DT                  PIC XX.
  2970     12  OC-LAST-MAINT-BY                  PIC X(4).
  2971     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2972     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2973     12  FILLER                            PIC X(49).
  2974     12  OC-ORIG-REC.
  2975         16  OC-INS-LAST-NAME              PIC X(15).
  2976         16  OC-INS-FIRST-NAME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  57
* EL050.cbl
  2977         16  OC-INS-MIDDLE-INIT            PIC X.
  2978         16  OC-INS-AGE                    PIC S999     COMP-3.
  2979         16  OC-JNT-LAST-NAME              PIC X(15).
  2980         16  OC-JNT-FIRST-NAME             PIC X(10).
  2981         16  OC-JNT-MIDDLE-INIT            PIC X.
  2982         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2983         16  OC-LF-BENCD                   PIC XX.
  2984         16  OC-LF-TERM                    PIC S999      COMP-3.
  2985         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2986         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2987         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2988         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2989         16  OC-LF-EXP-DT                  PIC XX.
  2990         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2991         16  OC-LF-CANCEL-DT               PIC XX.
  2992         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2993         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2994         16  OC-AH-BENCD                   PIC XX.
  2995         16  OC-AH-TERM                    PIC S999      COMP-3.
  2996         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2997         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2998         16  OC-AH-EXP-DT                  PIC XX.
  2999         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3000         16  OC-AH-CP                      PIC 99.
  3001         16  OC-AH-CANCEL-DT               PIC XX.
  3002         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3003         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3004         16  OC-CRED-BENE-NAME             PIC X(25).
  3005         16  OC-1ST-PMT-DT                 PIC XX.
  3006         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3007         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3008         16  FILLER                        PIC X(213).
  3009
  3010     12  FILLER                            PIC X(50).
  3011******************************************************************
  3012
  3013*    COPY ELCDATE.
  3014******************************************************************
  3015*                                                                *
  3016*                                                                *
  3017*                            ELCDATE.                            *
  3018*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3019*                            VMOD=2.003
  3020*                                                                *
  3021*                                                                *
  3022*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3023*                 LENGTH = 200                                   *
  3024******************************************************************
  3025
  3026 01  DATE-CONVERSION-DATA.
  3027     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3028     12  DC-OPTION-CODE                PIC X.
  3029         88  BIN-TO-GREG                VALUE ' '.
  3030         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3031         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3032         88  YMD-GREG-TO-BIN            VALUE '3'.
  3033         88  MDY-GREG-TO-BIN            VALUE '4'.
  3034         88  JULIAN-TO-BIN              VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  58
* EL050.cbl
  3035         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3036         88  FIND-CENTURY               VALUE '7'.
  3037         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3038         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3039         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3040         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3041         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3042         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3043         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3044         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3045         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3046         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3047         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3048         88  BIN-3-TO-GREG              VALUE 'I'.
  3049         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3050         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3051         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3052         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3053         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3054         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3055         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3056         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3057         88  THREE-CHARACTER-BIN
  3058                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3059         88  GREGORIAN-TO-BIN
  3060                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3061         88  BIN-TO-GREGORIAN
  3062                  VALUES ' ' '1' 'I' '8' 'G'.
  3063         88  JULIAN-TO-BINARY
  3064                  VALUES '5' 'C' 'E' 'F'.
  3065     12  DC-ERROR-CODE                 PIC X.
  3066         88  NO-CONVERSION-ERROR        VALUE ' '.
  3067         88  DATE-CONVERSION-ERROR
  3068                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3069         88  DATE-IS-ZERO               VALUE '1'.
  3070         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3071         88  DATE-IS-INVALID            VALUE '3'.
  3072         88  DATE1-GREATER-DATE2        VALUE '4'.
  3073         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3074         88  DATE-INVALID-OPTION        VALUE '9'.
  3075         88  INVALID-CENTURY            VALUE 'A'.
  3076         88  ONLY-CENTURY               VALUE 'B'.
  3077         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3078         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3079     12  DC-END-OF-MONTH               PIC X.
  3080         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3081     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3082         88  USE-NORMAL-PROCESS         VALUE ' '.
  3083         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3084         88  ADJUST-UP-100-YRS          VALUE '2'.
  3085     12  FILLER                        PIC X.
  3086     12  DC-CONVERSION-DATES.
  3087         16  DC-BIN-DATE-1             PIC XX.
  3088         16  DC-BIN-DATE-2             PIC XX.
  3089         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3090         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3091                       DC-GREG-DATE-1-EDIT.
  3092             20  DC-EDIT1-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  59
* EL050.cbl
  3093             20  SLASH1-1              PIC X.
  3094             20  DC-EDIT1-DAY          PIC 99.
  3095             20  SLASH1-2              PIC X.
  3096             20  DC-EDIT1-YEAR         PIC 99.
  3097         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3098         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3099                     DC-GREG-DATE-2-EDIT.
  3100             20  DC-EDIT2-MONTH        PIC 99.
  3101             20  SLASH2-1              PIC X.
  3102             20  DC-EDIT2-DAY          PIC 99.
  3103             20  SLASH2-2              PIC X.
  3104             20  DC-EDIT2-YEAR         PIC 99.
  3105         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3106         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3107                     DC-GREG-DATE-1-YMD.
  3108             20  DC-YMD-YEAR           PIC 99.
  3109             20  DC-YMD-MONTH          PIC 99.
  3110             20  DC-YMD-DAY            PIC 99.
  3111         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3112         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3113                      DC-GREG-DATE-1-MDY.
  3114             20  DC-MDY-MONTH          PIC 99.
  3115             20  DC-MDY-DAY            PIC 99.
  3116             20  DC-MDY-YEAR           PIC 99.
  3117         16  DC-GREG-DATE-1-ALPHA.
  3118             20  DC-ALPHA-MONTH        PIC X(10).
  3119             20  DC-ALPHA-DAY          PIC 99.
  3120             20  FILLER                PIC XX.
  3121             20  DC-ALPHA-CENTURY.
  3122                 24 DC-ALPHA-CEN-N     PIC 99.
  3123             20  DC-ALPHA-YEAR         PIC 99.
  3124         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3125         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3126         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3127         16  DC-JULIAN-DATE            PIC 9(05).
  3128         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3129                                       PIC 9(05).
  3130         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3131             20  DC-JULIAN-YEAR        PIC 99.
  3132             20  DC-JULIAN-DAYS        PIC 999.
  3133         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3134         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3135         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3136     12  DATE-CONVERSION-VARIBLES.
  3137         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3138         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3139             20  FILLER                PIC 9(3).
  3140             20  HOLD-CEN-1-CCYY.
  3141                 24  HOLD-CEN-1-CC     PIC 99.
  3142                 24  HOLD-CEN-1-YY     PIC 99.
  3143             20  HOLD-CEN-1-MO         PIC 99.
  3144             20  HOLD-CEN-1-DA         PIC 99.
  3145         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3146             20  HOLD-CEN-1-R-MO       PIC 99.
  3147             20  HOLD-CEN-1-R-DA       PIC 99.
  3148             20  HOLD-CEN-1-R-CCYY.
  3149                 24  HOLD-CEN-1-R-CC   PIC 99.
  3150                 24  HOLD-CEN-1-R-YY   PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  60
* EL050.cbl
  3151             20  FILLER                PIC 9(3).
  3152         16  HOLD-CENTURY-1-X.
  3153             20  FILLER                PIC X(3)  VALUE SPACES.
  3154             20  HOLD-CEN-1-X-CCYY.
  3155                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3156                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3157             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3158             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3159         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3160             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3161             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3162             20  HOLD-CEN-1-R-X-CCYY.
  3163                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3164                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3165             20  FILLER                PIC XXX.
  3166         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3167         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3168         16  DC-JULIAN-DATE-1          PIC 9(07).
  3169         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3170             20  DC-JULIAN-1-CCYY.
  3171                 24  DC-JULIAN-1-CC    PIC 99.
  3172                 24  DC-JULIAN-1-YR    PIC 99.
  3173             20  DC-JULIAN-DA-1        PIC 999.
  3174         16  DC-JULIAN-DATE-2          PIC 9(07).
  3175         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3176             20  DC-JULIAN-2-CCYY.
  3177                 24  DC-JULIAN-2-CC    PIC 99.
  3178                 24  DC-JULIAN-2-YR    PIC 99.
  3179             20  DC-JULIAN-DA-2        PIC 999.
  3180         16  DC-GREG-DATE-A-EDIT.
  3181             20  DC-EDITA-MONTH        PIC 99.
  3182             20  SLASHA-1              PIC X VALUE '/'.
  3183             20  DC-EDITA-DAY          PIC 99.
  3184             20  SLASHA-2              PIC X VALUE '/'.
  3185             20  DC-EDITA-CCYY.
  3186                 24  DC-EDITA-CENT     PIC 99.
  3187                 24  DC-EDITA-YEAR     PIC 99.
  3188         16  DC-GREG-DATE-B-EDIT.
  3189             20  DC-EDITB-MONTH        PIC 99.
  3190             20  SLASHB-1              PIC X VALUE '/'.
  3191             20  DC-EDITB-DAY          PIC 99.
  3192             20  SLASHB-2              PIC X VALUE '/'.
  3193             20  DC-EDITB-CCYY.
  3194                 24  DC-EDITB-CENT     PIC 99.
  3195                 24  DC-EDITB-YEAR     PIC 99.
  3196         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3197         16  DC-GREG-DATE-CYMD-R REDEFINES
  3198                              DC-GREG-DATE-CYMD.
  3199             20  DC-CYMD-CEN           PIC 99.
  3200             20  DC-CYMD-YEAR          PIC 99.
  3201             20  DC-CYMD-MONTH         PIC 99.
  3202             20  DC-CYMD-DAY           PIC 99.
  3203         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3204         16  DC-GREG-DATE-MDCY-R REDEFINES
  3205                              DC-GREG-DATE-MDCY.
  3206             20  DC-MDCY-MONTH         PIC 99.
  3207             20  DC-MDCY-DAY           PIC 99.
  3208             20  DC-MDCY-CEN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  61
* EL050.cbl
  3209             20  DC-MDCY-YEAR          PIC 99.
  3210    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3211        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3212    12  DC-EL310-DATE                  PIC X(21).
  3213    12  FILLER                         PIC X(28).
  3214
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  62
* EL050.cbl
  3216*    COPY ELCCALC.
  3217******************************************************************
  3218*                                                                *
  3219*                           ELCCALC.                            *
  3220*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3221*                            VMOD=2.025                          *
  3222*                                                                *
  3223*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3224*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3225*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3226*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3227*                                                                *
  3228*  PASSED TO ELRTRM                                              *
  3229*  -----------------                                             *
  3230*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3231*  ORIGINAL TERM                                                 *
  3232*  BEGINNING DATE                                                *
  3233*  ENDING DATE                                                   *
  3234*  COMPANY I.D.                                                  *
  3235*  ACCOUNT MASTER USER FIELD                                     *
  3236*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3237*  FREE LOOK DAYS                                                *
  3238*                                                                *
  3239*  RETURNED FROM ELRTRM                                          *
  3240*  ---------------------                                         *
  3241*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3242*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3243*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3244*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3245*----------------------------------------------------------------*
  3246*  PASSED TO ELRAMT                                              *
  3247*  ----------------                                              *
  3248*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3249*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3250*  ORIGINAL AMOUNT                                               *
  3251*  ALTERNATE BENEFIT (BALLON)                                    *
  3252*  A.P.R. - NET PAY ONLY                                         *
  3253*  METHOD
  3254*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3255*  COMPANY I.D.                                                  *
  3256*  BENEFIT TYPE                                                  *
  3257*                                                                *
  3258*  RETURNED FROM ELRAMT                                          *
  3259*  --------------------                                          *
  3260*  REMAINING AMOUNT 1 - CURRENT                                  *
  3261*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3262*  REMAINING AMOUNT FACTOR
  3263*----------------------------------------------------------------*
  3264*  PASSED TO ELRESV                                              *
  3265*  -----------------                                             *
  3266*  CERTIFICATE EFFECTIVE DATE                                    *
  3267*  VALUATION DATE                                                *
  3268*  PAID THRU DATE                                                *
  3269*  BENEFIT                                                       *
  3270*  INCURRED DATE                                                 *
  3271*  REPORTED DATE                                                 *
  3272*  ISSUE AGE                                                     *
  3273*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  63
* EL050.cbl
  3274*  CDT PERCENT                                                   *
  3275*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3276* *CLAIM TYPE (LIFE, A/H)                                        *
  3277* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3278* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3279*                                                                *
  3280*  RETURNED FROM ELRESV                                          *
  3281*  --------------------                                          *
  3282*  CDT TABLE USED                                                *
  3283*  CDT FACTOR USED                                               *
  3284*  PAY TO CURRENT RESERVE                                        *
  3285*  I.B.N.R. - A/H ONLY                                           *
  3286*  FUTURE (ACCRUED) AH ONLY                                      *
  3287*----------------------------------------------------------------*
  3288*  PASSED TO ELRATE                                              *
  3289*  ----------------                                              *
  3290*  CERT ISSUE DATE                                               *
  3291*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3292*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3293*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3294*  STATE CODE (CLIENT DEFINED)                                   *
  3295*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3296*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3297*  DEVIATION CODE                                                *
  3298*  ISSUE AGE                                                     *
  3299*  ORIGINAL BENEFIT AMOUNT                                       *
  3300*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3301*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3302*  BENEFIT KIND (LIFE OR A/H)                                    *
  3303*  A.P.R.                                                        *
  3304*  METHOD
  3305*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3306*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3307*  COMPANY I.D. (3 CHARACTER)                                    *
  3308*  BENEFIT CODE                                                  *
  3309*  BENEFIT OVERRIDE CODE                                         *
  3310*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3311*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3312*  JOINT INDICATOR (CSL ONLY)                                    *
  3313*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3314*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3315*                                                                *
  3316*  RETURNED FROM ELRATE                                          *
  3317*  --------------------                                          *
  3318*  CALCULATED PREMIUM                                            *
  3319*  PREMIUM RATE                                                  *
  3320*  MORTALITY CODE                                                *
  3321*  MAX ATTAINED AGE                                              *
  3322*  MAX AGE                                                       *
  3323*  MAX TERM                                                      *
  3324*  MAX MONTHLY BENEFIT                                           *
  3325*  MAX TOTAL BENIFIT                                             *
  3326*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3327*----------------------------------------------------------------*
  3328*  PASSED TO ELRFND                                              *
  3329*  ----------------                                              *
  3330*  CERT ISSUE DATE                                               *
  3331*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  64
* EL050.cbl
  3332*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3333*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3334*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3335*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3336*  STATE CODE (CLIENT DEFINED)                                   *
  3337*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3338*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3339*  DEVIATION CODE                                                *
  3340*  ISSUE AGE                                                     *
  3341*  ORIGINAL BENEFIT AMOUNT                                       *
  3342*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3343*  PROCESS TYPE (CANCEL)                                         *
  3344*  BENEFIT KIND (LIFE OR A/H)                                    *
  3345*  A.P.R.                                                        *
  3346*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3347*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3348*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3349*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3350*  COMPANY I.D. (3 CHARACTER)                                    *
  3351*  BENEFIT CODE                                                  *
  3352*  BENEFIT OVERRIDE CODE                                         *
  3353*                                                                *
  3354*  RETURNED FROM ELRFND                                          *
  3355*  --------------------                                          *
  3356*  CALCULATED REFUND                                             *
  3357*----------------------------------------------------------------*
  3358*  PASSED TO ELEARN                                              *
  3359*  ----------------                                              *
  3360*  CERT ISSUE DATE                                               *
  3361*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3362*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3363*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3364*  STATE CODE (CLIENT DEFINED)                                   *
  3365*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3366*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3367*  DEVIATION CODE                                                *
  3368*  ISSUE AGE                                                     *
  3369*  ORIGINAL BENEFIT AMOUNT                                       *
  3370*  BENEFIT KIND (LIFE OR A/H)                                    *
  3371*  A.P.R.                                                        *
  3372*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3373*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3374*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3375*  COMPANY I.D. (3 CHARACTER)                                    *
  3376*  BENEFIT CODE                                                  *
  3377*  BENEFIT OVERRIDE CODE                                         *
  3378*                                                                *
  3379*  RETURNED FROM ELEARN                                          *
  3380*  --------------------                                          *
  3381*  INDICATED  EARNINGS                                           *
  3382*----------------------------------------------------------------*
  3383*                 LENGTH = 450                                   *
  3384*                                                                *
  3385******************************************************************
  3386******************************************************************
  3387*                   C H A N G E   L O G
  3388*
  3389* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  65
* EL050.cbl
  3390*-----------------------------------------------------------------
  3391*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3392* EFFECTIVE    NUMBER
  3393*-----------------------------------------------------------------
  3394* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3395* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3396* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3397* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3398* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3399* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3400* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3401* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3402* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3403******************************************************************
  3404
  3405 01  CALCULATION-PASS-AREA.
  3406     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3407                                     COMP.
  3408
  3409     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3410       88  NO-CP-ERROR                             VALUE ZERO.
  3411       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3412                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3413       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3414       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3415       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3416       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3417       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3418       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3419       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3420       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3421       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3422       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3423       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3424       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3425       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3426       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3427       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3428       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3429       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3430
  3431     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3432       88  NO-CP-ERROR-2                           VALUE ZERO.
  3433***********************  INPUT AREAS ****************************
  3434
  3435     12  CP-CALCULATION-AREA.
  3436         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3437         16  CP-CERT-EFF-DT        PIC XX.
  3438         16  CP-VALUATION-DT       PIC XX.
  3439         16  CP-PAID-THRU-DT       PIC XX.
  3440         16  CP-BENEFIT-TYPE       PIC X.
  3441           88  CP-AH                               VALUE 'A' 'D'
  3442                                                   'I' 'U'.
  3443           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3444           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3445         16  CP-INCURRED-DT        PIC XX.
  3446         16  CP-REPORTED-DT        PIC XX.
  3447         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  66
* EL050.cbl
  3448         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3449         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3450                                     COMP-3.
  3451         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3452                                     COMP-3.
  3453         16  CP-CDT-METHOD         PIC X.
  3454           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3455           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3456           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3457         16  CP-CLAIM-TYPE         PIC X.
  3458           88  CP-AH-CLAIM                         VALUE 'A'.
  3459           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3460         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3461                                     COMP-3.
  3462         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3463                                     COMP-3.
  3464         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3465                                     COMP-3.
  3466         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3467                                     COMP-3.
  3468         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3469                                     COMP-3.
  3470         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3471                                     COMP-3.
  3472         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3473                                     COMP-3.
  3474         16  CP-REM-TERM-METHOD    PIC X.
  3475           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3476           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3477           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3478           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3479           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3480           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3481           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3482         16  CP-EARNING-METHOD     PIC X.
  3483           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3484           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3485           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3486           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3487           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3488           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3489           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3490           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3491           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3492           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3493           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3494           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3495           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3496           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3497         16  CP-PROCESS-TYPE       PIC X.
  3498           88  CP-CLAIM                            VALUE '1'.
  3499           88  CP-CANCEL                           VALUE '2'.
  3500           88  CP-ISSUE                            VALUE '3'.
  3501         16  CP-SPECIAL-CALC-CD    PIC X.
  3502           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3503           88  CP-1-MTH-INTEREST               VALUE ' '.
  3504           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3505           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  67
* EL050.cbl
  3506           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3507           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3508           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3509           88  CP-FARM-PLAN                    VALUE 'F'.
  3510           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3511           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3512           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3513           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3514           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3515           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3516           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3517           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3518           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3519           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3520                                                     'W' 'X'.
  3521           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3522           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3523           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3524           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3525           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3526           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3527           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3528           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3529           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3530           88  CP-CSL-METH-1                   VALUE '5'.
  3531           88  CP-CSL-METH-2                   VALUE '6'.
  3532           88  CP-CSL-METH-3                   VALUE '7'.
  3533           88  CP-CSL-METH-4                   VALUE '8'.
  3534
  3535         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3536                                     COMP-3.
  3537         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3538         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3539         16  CP-STATE              PIC XX          VALUE SPACE.
  3540         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3541         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3542           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3543               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3544         16  CP-R78-OPTION         PIC X.
  3545           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3546           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3547
  3548         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3549         16  CP-IBNR-RESERVE-SW    PIC X.
  3550         16  CP-CLAIM-STATUS       PIC X.
  3551         16  CP-RATE-FILE          PIC X.
  3552         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3553                                     COMP-3.
  3554
  3555         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3556         16  CP-AH-OVERRIDE-CODE   PIC X.
  3557
  3558         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3559                                     COMP-3.
  3560         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3561                                   PIC S9(5)V99 COMP-3.
  3562         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3563                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  68
* EL050.cbl
  3564         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3565                                     COMP-3.
  3566         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3567                                     COMP-3.
  3568         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3569                                  PIC S9(7)V99 COMP-3.
  3570
  3571         16  CP-PAID-FROM-DATE     PIC X(02).
  3572         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3573         16  CP-EXT-DAYS-CALC      PIC X.
  3574           88  CP-EXT-NO-CHG                   VALUE ' '.
  3575           88  CP-EXT-CHG-LF                   VALUE '1'.
  3576           88  CP-EXT-CHG-AH                   VALUE '2'.
  3577           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3578         16  CP-DOMICILE-STATE     PIC XX.
  3579         16  CP-CARRIER            PIC X.
  3580         16  CP-REIN-FLAG          PIC X.
  3581         16  CP-REM-TRM-CALC-OPTION PIC X.
  3582           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3583                      '2' '3' '4' '5'.
  3584           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3585           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3586           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3587           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3588           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3589           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3590           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3591           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3592         16  CP-SIG-SWITCH         PIC X.
  3593         16  CP-RATING-METHOD      PIC X.
  3594           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3595           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3596           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3597           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3598           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3599           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3600           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3601           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3602           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3603         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3604                                     COMP-3.
  3605         16  CP-BEN-CATEGORY       PIC X.
  3606         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3607         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3608                                   PIC S99V9(5) COMP-3.
  3609         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3610         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3611                                   PIC S99V9(5) COMP-3.
  3612         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3613         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3614         16  CP-EXPIRE-DT          PIC XX.
  3615         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3616         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3617         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3618         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3619         16  CP-DDF-SPEC-CALC      PIC X.
  3620             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3621             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  69
* EL050.cbl
  3622         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3623         16  CP-CANCEL-REASON      PIC X.
  3624         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3625         16  CP-PMT-MODE           PIC X.
  3626         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3627         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3628         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3629         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3630         16  FILLER                PIC X.
  3631
  3632***************    OUTPUT FROM ELRESV   ************************
  3633
  3634         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3635
  3636         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3637                                     COMP-3.
  3638         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3639                                     COMP-3.
  3640         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3641                                     COMP-3.
  3642         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3643                                     COMP-3.
  3644         16  FILLER                PIC X(09).
  3645***************    OUTPUT FROM ELRTRM   *************************
  3646
  3647         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3648                                     COMP-3.
  3649         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3650                                     COMP-3.
  3651         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3652                                     COMP-3.
  3653         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3654                                     COMP-3.
  3655         16  FILLER                PIC X(12).
  3656
  3657***************    OUTPUT FROM ELRAMT   *************************
  3658
  3659         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3660                                     COMP-3.
  3661         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3662                                     COMP-3.
  3663         16  FILLER                PIC X(12).
  3664
  3665***************    OUTPUT FROM ELRATE   *************************
  3666
  3667         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3668                                     COMP-3.
  3669         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3670                                     COMP-3.
  3671         16  CP-MORTALITY-CODE     PIC X(4).
  3672         16  CP-RATE-EDIT-FLAG     PIC X.
  3673             88  CP-RATES-NEED-APR                  VALUE '1'.
  3674         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3675                                     COMP-3.
  3676         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3677         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3678         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3679                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  70
* EL050.cbl
  3680         16  FILLER                PIC X(07).
  3681
  3682***************    OUTPUT FROM ELRFND   *************************
  3683
  3684         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3685                                     COMP-3.
  3686         16  CP-REFUND-TYPE-USED   PIC X.
  3687           88  CP-R-AS-R78                         VALUE '1'.
  3688           88  CP-R-AS-PRORATA                     VALUE '2'.
  3689           88  CP-R-AS-CALIF                       VALUE '3'.
  3690           88  CP-R-AS-TEXAS                       VALUE '4'.
  3691           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3692           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3693           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3694           88  CP-R-AS-MEAN                        VALUE '8'.
  3695           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3696           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3697           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3698           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3699           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3700           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3701         16  FILLER                PIC X(12).
  3702
  3703***************    OUTPUT FROM ELEARN   *************************
  3704
  3705         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3706                                     COMP-3.
  3707         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3708                                     COMP-3.
  3709         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3710                                     COMP-3.
  3711         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3712                                     COMP-3.
  3713         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3714                                     COMP-3.
  3715         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3716                                     COMP-3.
  3717         16  CP-EARNING-TYPE-USED  PIC X.
  3718           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3719           88  CP-E-AS-R78                         VALUE '1'.
  3720           88  CP-E-AS-PRORATA                     VALUE '2'.
  3721           88  CP-E-AS-TEXAS                       VALUE '4'.
  3722           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3723           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3724           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3725           88  CP-E-AS-MEAN                        VALUE '8'.
  3726           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3727         16  FILLER                PIC X(12).
  3728
  3729***************    OUTPUT FROM ELPMNT   *************************
  3730
  3731         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3732                                     COMP-3.
  3733         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3734                                     COMP-3.
  3735         16  FILLER                PIC X(12).
  3736
  3737***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  71
* EL050.cbl
  3738         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3739                                     COMP-3.
  3740         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3741                                     COMP-3.
  3742         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3743                                     COMP-3.
  3744         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3745                                     COMP-3.
  3746         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3747                                     COMP-3.
  3748         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3749                                     COMP-3.
  3750         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3751             88  OPEN-RATE-FILE                   VALUE 'O'.
  3752             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3753             88  IO-ERROR                         VALUE 'E'.
  3754
  3755         16  CP-FIRST-PAY-DATE     PIC XX.
  3756
  3757         16  CP-JOINT-INDICATOR    PIC X.
  3758
  3759         16  CP-RESERVE-REMAINING-TERM
  3760                                   PIC S9(4)V9    VALUE ZERO
  3761                                     COMP-3.
  3762
  3763         16  CP-INSURED-BIRTH-DT   PIC XX.
  3764
  3765         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3766                                     COMP-3.
  3767
  3768         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3769                                     COMP-3.
  3770
  3771         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3772                                     COMP-3.
  3773
  3774         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3775                                     COMP-3.
  3776
  3777         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3778                                     COMP-3.
  3779
  3780         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3781                                     COMP-3.
  3782
  3783         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3784                                     COMP-3.
  3785
  3786         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3787             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3788
  3789         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3790                                     COMP-3.
  3791         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3792                                     COMP-3.
  3793         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3794         16  FILLER                PIC X(15).
  3795******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  72
* EL050.cbl
  3797******************************************************************
  3798*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3799*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3800*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3801*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3802*** MODIFICATION.                                              ***
  3803*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3804*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3805******************************************************************
  3806*    COPY ERCPNDB.
  3807******************************************************************
  3808*                                                                *
  3809*                                                                *
  3810*                            ERCPNDB.                            *
  3811*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3812*                            VMOD=2.025                          *
  3813*                                                                *
  3814*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3815*                                                                *
  3816******************************************************************
  3817*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3818*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3819******************************************************************
  3820*                                                                *
  3821*                                                                *
  3822*   FILE TYPE = VSAM,KSDS                                        *
  3823*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3824*                                                                *
  3825*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3826*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3827*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3828*                                                 RKP=13,LEN=36  *
  3829*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3830*                                      AND CHG-SEQ.)             *
  3831*                                                RKP=49,LEN=11   *
  3832*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3833*                                      AND CHG-SEQ.)             *
  3834*                                                RKP=60,LEN=15   *
  3835*                                                                *
  3836*   LOG = NO                                                     *
  3837*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3838******************************************************************
  3839******************************************************************
  3840*                   C H A N G E   L O G
  3841*
  3842* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3843*-----------------------------------------------------------------
  3844*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3845* EFFECTIVE    NUMBER
  3846*-----------------------------------------------------------------
  3847* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3848* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3849* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3850* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3851* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3852* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3853* 032306                   PEMA  ADD BOW LOAN NUMBER
  3854* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  73
* EL050.cbl
  3855* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3856* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3857* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3858* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3859* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3860* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3861* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3862******************************************************************
  3863
  3864 01  PENDING-BUSINESS.
  3865     12  PB-RECORD-ID                     PIC XX.
  3866         88  VALID-PB-ID                        VALUE 'PB'.
  3867
  3868     12  PB-CONTROL-PRIMARY.
  3869         16  PB-COMPANY-CD                PIC X.
  3870         16  PB-ENTRY-BATCH               PIC X(6).
  3871         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3872         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3873
  3874     12  PB-CONTROL-BY-ACCOUNT.
  3875         16  PB-COMPANY-CD-A1             PIC X.
  3876         16  PB-CARRIER                   PIC X.
  3877         16  PB-GROUPING.
  3878             20  PB-GROUPING-PREFIX       PIC XXX.
  3879             20  PB-GROUPING-PRIME        PIC XXX.
  3880         16  PB-STATE                     PIC XX.
  3881         16  PB-ACCOUNT.
  3882             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3883             20  PB-ACCOUNT-PRIME         PIC X(6).
  3884         16  PB-CERT-EFF-DT               PIC XX.
  3885         16  PB-CERT-NO.
  3886             20  PB-CERT-PRIME            PIC X(10).
  3887             20  PB-CERT-SFX              PIC X.
  3888         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3889
  3890         16  PB-RECORD-TYPE               PIC X.
  3891             88  PB-MAILING-DATA                VALUE '0'.
  3892             88  PB-ISSUE                       VALUE '1'.
  3893             88  PB-CANCELLATION                VALUE '2'.
  3894             88  PB-BATCH-TRAILER               VALUE '9'.
  3895
  3896     12  PB-CONTROL-BY-ORIG-BATCH.
  3897         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3898         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3899         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3900         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3901
  3902     12  PB-CONTROL-BY-CSR.
  3903         16  PB-CSR-COMPANY-CD            PIC X.
  3904         16  PB-CSR-ID                    PIC X(4).
  3905         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3906         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3907         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3908******************************************************************
  3909*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3910******************************************************************
  3911
  3912     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  74
* EL050.cbl
  3913     12  PB-LAST-MAINT-BY                 PIC X(4).
  3914     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3915
  3916     12  PB-RECORD-BODY                   PIC X(375).
  3917
  3918     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3919         16  PB-CERT-ORIGIN               PIC X.
  3920             88  CLASIC-CREATED-CERT         VALUE '1'.
  3921         16  PB-I-NAME.
  3922             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3923             20  PB-I-INSURED-FIRST-NAME.
  3924                 24  PB-I-INSURED-1ST-INIT PIC X.
  3925                 24  FILLER                PIC X(9).
  3926             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3927         16  PB-I-AGE                     PIC S99   COMP-3.
  3928         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3929         16  PB-I-BIRTHDAY                PIC XX.
  3930         16  PB-I-INSURED-SEX             PIC X.
  3931             88  PB-SEX-MALE     VALUE 'M'.
  3932             88  PB-SEX-FEMALE   VALUE 'F'.
  3933
  3934         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3935         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3936         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3937         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3938         16  PB-I-SKIP-CODE               PIC X.
  3939             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3940             88  PB-SKIP-JULY              VALUE '1'.
  3941             88  PB-SKIP-AUGUST            VALUE '2'.
  3942             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3943             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3944             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3945             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3946             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3947             88  PB-SKIP-JUNE              VALUE '8'.
  3948             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3949             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3950             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3951         16  PB-I-TERM-TYPE               PIC X.
  3952             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3953             88  PB-PAID-WEEKLY            VALUE 'W'.
  3954             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3955             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3956             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3957         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3958         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3959         16  PB-I-DATA-ENTRY-SW           PIC X.
  3960             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3961             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3962             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3963             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3964         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3965         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3966*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3967         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3968         16  FILLER                       PIC X.
  3969
  3970         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  75
* EL050.cbl
  3971             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3972             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3973                                                   '90' THRU '99'.
  3974         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3975                                          PIC XX.
  3976         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3977         16  PB-I-AMOUNT-FINANCED REDEFINES
  3978                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3979         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3980         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3981                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3982         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3983         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3984         16  PB-I-CLP-AMOUNT REDEFINES
  3985                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3986         16  PB-I-LF-CALC-FLAG            PIC X.
  3987             88 PB-COMP-LF-PREM               VALUE '?'.
  3988         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3989         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3990         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3991         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3992         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3993         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3994         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3995         16  PB-I-LF-ABBR                 PIC XXX.
  3996         16  PB-I-LF-INPUT-CD             PIC XX.
  3997
  3998         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3999             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4000             88  PB-INVALID-AH               VALUE '  ' '00'
  4001                                                   '90' THRU '99'.
  4002         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4003         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4004         16  PB-I-AH-CALC-FLAG            PIC X.
  4005             88 PB-COMP-AH-PREM                  VALUE '?'.
  4006         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4007         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4008         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4009         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4010         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4011         16  PB-I-AH-ABBR                 PIC XXX.
  4012         16  PB-I-AH-INPUT-CD             PIC XXX.
  4013
  4014         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4015         16  PB-I-REIN-TABLE              PIC XXX.
  4016         16  PB-I-BUSINESS-TYPE           PIC 99.
  4017         16  PB-I-INDV-GRP-CD             PIC X.
  4018         16  PB-I-MORT-CODE.
  4019             20  PB-I-TABLE               PIC X.
  4020             20  PB-I-INTEREST            PIC XX.
  4021             20  PB-I-MORT-TYP            PIC X.
  4022         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4023         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4024         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4025         16  PB-I-INDV-GRP-OVRD           PIC X.
  4026         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4027         16  PB-I-SIG-SW                  PIC X.
  4028             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  76
* EL050.cbl
  4029         16  PB-I-RATE-CLASS              PIC XX.
  4030         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4031         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4032         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4033         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4034         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4035         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4036         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4037         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4038         16  PB-I-OB-FLAG                 PIC X.
  4039             88  PB-I-OB                      VALUE 'B'.
  4040             88  PB-I-SUMMARY                 VALUE 'Z'.
  4041         16  PB-I-ENTRY-STATUS            PIC X.
  4042             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4043                                              'M' '5' '9' '2'.
  4044             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4045             88  PB-I-POLICY-PENDING          VALUE '2'.
  4046             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4047             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4048             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4049             88  PB-I-REIN-ONLY               VALUE '9'.
  4050             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4051             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4052             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4053             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4054         16  PB-I-INT-CODE                PIC X.
  4055             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4056             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4057         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4058         16  PB-I-SOC-SEC-NO              PIC X(11).
  4059         16  PB-I-MEMBER-NO               PIC X(12).
  4060         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4061*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4062         16  PB-I-OLD-LOF                 PIC XXX.
  4063         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4064         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4065         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4066         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4067         16  PB-I-LIFE-INDICATOR          PIC X.
  4068             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4069         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4070         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4071                                          PIC S9(5)V99    COMP-3.
  4072         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4073             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4074             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4075         16  PB-I-1ST-PMT-DT              PIC XX.
  4076         16  PB-I-JOINT-INSURED.
  4077             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4078             20 PB-I-JOINT-FIRST-NAME.
  4079                24  PB-I-JOINT-FIRST-INIT PIC X.
  4080                24  FILLER                PIC X(9).
  4081             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4082*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4083         16  PB-I-BENEFICIARY-NAME.
  4084             20  PB-I-BANK-NUMBER         PIC X(10).
  4085             20  FILLER                   PIC X(15).
  4086         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  77
* EL050.cbl
  4087         16  PB-I-REFERENCE               PIC X(12).
  4088         16  FILLER REDEFINES PB-I-REFERENCE.
  4089             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4090             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4091             20  PB-I-CLP-STATE           PIC XX.
  4092         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4093             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4094             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4095             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4096         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4097         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4098         16  PB-I-RESIDENT-STATE          PIC XX.
  4099         16  PB-I-RATE-CODE               PIC X(4).
  4100         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4101         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4102         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4103         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4104         16  PB-I-BANK-NOCHRGB            PIC 99.
  4105         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4106         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4107
  4108     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4109         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4110             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4111         16  PB-C-CANCEL-ORIGIN           PIC X.
  4112             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4113         16  PB-C-LF-CANCEL-DT            PIC XX.
  4114         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4115         16  PB-C-LF-CALC-REQ             PIC X.
  4116             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4117         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4118         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4119         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4120             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4121         16  PB-C-AH-CANCEL-DT            PIC XX.
  4122         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4123         16  PB-C-AH-CALC-REQ             PIC X.
  4124             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4125         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4126         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4127         16  PB-C-LAST-NAME               PIC X(15).
  4128         16  PB-C-REFUND-SW               PIC X.
  4129             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4130             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4131         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4132         16  PB-C-PAYEE-CODE              PIC X(6).
  4133         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4134         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4135         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4136         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4137         16  PB-C-REFERENCE               PIC X(12).
  4138         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4139         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4140         16  PB-C-POST-CARD-IND           PIC X.
  4141         16  PB-C-CANCEL-REASON           PIC X.
  4142         16  PB-C-REF-INTERFACE-SW        PIC X.
  4143         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4144         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  78
* EL050.cbl
  4145         16  FILLER                       PIC X(01).
  4146*        16  FILLER                       PIC X(18).
  4147         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4148*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4149         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4150         16  PB-CANCELED-CERT-DATA.
  4151             20  PB-CI-INSURED-NAME.
  4152                 24  PB-CI-LAST-NAME      PIC X(15).
  4153                 24  PB-CI-INITIALS       PIC XX.
  4154             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4155             20  PB-CI-INSURED-SEX        PIC X.
  4156             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4157             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4158             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4159             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4160             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4161             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4162             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4163             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4164             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4165             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4166             20  PB-CI-RATE-CLASS         PIC XX.
  4167             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4168             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4169             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4170             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4171             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4172             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4173             20  PB-CI-LF-ABBR            PIC X(3).
  4174             20  PB-CI-AH-ABBR            PIC X(3).
  4175             20  PB-CI-OB-FLAG            PIC X.
  4176                 88  PB-CI-OB                VALUE 'B'.
  4177             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4178                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4179                                           'M' '4' '5' '9' '2'.
  4180                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4181                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4182                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4183                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4184                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4185                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4186                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4187                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4188                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4189                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4190                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4191                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4192             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4193                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4194                                           'M' '4' '5' '9' '2'.
  4195                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4196                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4197                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4198                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4199                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4200                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4201                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4202                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  79
* EL050.cbl
  4203                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4204                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4205                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4206                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4207             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4208             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4209             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4210             20  PB-CI-MEMBER-NO          PIC X(12).
  4211             20  PB-CI-INT-CODE           PIC X.
  4212                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4213                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4214             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4215             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4216             20  PB-CI-COMP-EXCP-SW       PIC X.
  4217                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4218                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4219             20  PB-CI-ENTRY-STATUS       PIC X.
  4220             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4221             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4222             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4223             20  PB-CI-DEATH-DT           PIC XX.
  4224             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4225             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4226             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4227             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4228             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4229             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4230             20  PB-CI-ENTRY-DT              PIC XX.
  4231             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4232             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4233             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4234             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4235             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4236             20  PB-CI-OLD-LOF               PIC XXX.
  4237*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4238             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4239             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4240             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4241             20  PB-CI-INDV-GRP-CD           PIC X.
  4242             20  PB-CI-BENEFICIARY-NAME.
  4243                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4244                 24  FILLER                  PIC X(15).
  4245             20  PB-CI-NOTE-SW               PIC X.
  4246             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4247             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4248             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4249             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4250             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4251             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4252             20  PB-CI-FIRST-NAME            PIC X(10).
  4253             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4254
  4255         16  FILLER                       PIC X(13).
  4256*032306  16  FILLER                       PIC X(27).
  4257*        16  FILLER                       PIC X(46).
  4258
  4259     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4260         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  80
* EL050.cbl
  4261         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4262         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4263         16  PB-M-INSURED-MID-INIT        PIC X.
  4264         16  PB-M-INSURED-AGE             PIC 99.
  4265         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4266         16  PB-M-INSURED-SEX             PIC X.
  4267         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4268         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4269         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4270         16  PB-M-INSURED-CITY-STATE.
  4271             20  PB-M-INSURED-CITY        PIC X(28).
  4272             20  PB-M-INSURED-STATE       PIC XX.
  4273         16  PB-M-INSURED-ZIP-CODE.
  4274             20  PB-M-INSURED-ZIP-PRIME.
  4275                 24  PB-M-INSURED-ZIP-1   PIC X.
  4276                     88  PB-M-CANADIAN-POST-CODE
  4277                                             VALUE 'A' THRU 'Z'.
  4278                 24  FILLER               PIC X(4).
  4279             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4280         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4281                                        PB-M-INSURED-ZIP-CODE.
  4282             20  PM-M-INS-CAN-POST1       PIC XXX.
  4283             20  PM-M-INS-CAN-POST2       PIC XXX.
  4284             20  FILLER                   PIC XXX.
  4285         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4286         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4287         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4288         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4289         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4290         16  PB-M-CRED-BENE-CITYST.
  4291             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4292             20  PB-M-CRED-BENE-STATE     PIC XX.
  4293         16  FILLER                       PIC X(92).
  4294
  4295     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4296         16  FILLER                       PIC X(10).
  4297         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4298         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4299         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4300         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4301         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4302         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4303         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4304         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4305         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4306         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4307         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4308         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4309         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4310         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4311         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4312         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4313         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4314         16  PB-ACCOUNT-NAME              PIC X(30).
  4315         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4316         16  PB-REFERENCE                 PIC X(12).
  4317         16  PB-B-RECEIVED-DT             PIC XX.
  4318         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  81
* EL050.cbl
  4319
  4320     12  PB-RECORD-STATUS.
  4321         16  PB-CREDIT-SELECT-DT          PIC XX.
  4322         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4323         16  PB-BILLED-DT                 PIC XX.
  4324         16  PB-BILLING-STATUS            PIC X.
  4325             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4326             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4327             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4328         16  PB-RECORD-BILL               PIC X.
  4329             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4330             88  PB-RECORD-RETURNED           VALUE 'R'.
  4331             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4332             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4333             88  PB-OVERRIDE-AH               VALUE 'A'.
  4334             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4335         16  PB-BATCH-ENTRY               PIC X.
  4336             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4337             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4338             88  PB-REISSUED-CERT             VALUE 'E'.
  4339             88  PB-MONTHLY-CERT              VALUE 'M'.
  4340             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4341             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4342             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4343         16  PB-FORCE-CODE                PIC X.
  4344             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4345             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4346             88  PB-CANCEL-FORCE              VALUE '8'.
  4347             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4348             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4349             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4350             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4351             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4352             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4353             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4354         16  PB-FATAL-FLAG                PIC X.
  4355             88  PB-FATAL-ERRORS              VALUE 'X'.
  4356         16  PB-FORCE-ER-CD               PIC X.
  4357             88  PB-FORCE-ERRORS              VALUE 'F'.
  4358             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4359         16  PB-WARN-ER-CD                PIC X.
  4360             88  PB-WARNING-ERRORS            VALUE 'W'.
  4361         16  FILLER                       PIC X.
  4362         16  PB-OUT-BAL-CD                PIC X.
  4363             88  PB-OUT-OF-BAL                VALUE 'O'.
  4364         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4365         16  PB-AH-OVERRIDE-L1            PIC X.
  4366         16  PB-INPUT-DT                  PIC XX.
  4367         16  PB-INPUT-BY                  PIC X(4).
  4368         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4369         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4370         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4371         16  PB-LF-EARNING-METHOD         PIC X.
  4372         16  PB-AH-EARNING-METHOD         PIC X.
  4373         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4374         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4375         16  PB-REIN-CD                   PIC XXX.
  4376         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  82
* EL050.cbl
  4377         16  PB-AH-REFUND-TYPE            PIC X.
  4378         16  PB-ACCT-EFF-DT               PIC XX.
  4379         16  PB-ACCT-EXP-DT               PIC XX.
  4380         16  PB-COMPANY-ID                PIC X(3).
  4381         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4382         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4383         16  PB-SV-CARRIER                PIC X.
  4384         16  PB-SV-GROUPING               PIC X(6).
  4385         16  PB-SV-STATE                  PIC XX.
  4386         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4387         16  PB-GA-BILLING-INFO.
  4388             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4389                                          PIC XX.
  4390         16  PB-SV-REMIT-TO  REDEFINES
  4391             PB-GA-BILLING-INFO           PIC X(10).
  4392         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4393         16  PB-I-LOAN-OFFICER            PIC X(5).
  4394         16  PB-I-VIN                     PIC X(17).
  4395
  4396         16  FILLER                       PIC X(04).
  4397         16  IMNET-BYPASS-SW              PIC X.
  4398
  4399******************************************************************
  4400*                COMMON EDIT ERRORS                              *
  4401******************************************************************
  4402
  4403     12  PB-COMMON-ERRORS.
  4404         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4405                                           PIC S9(4)     COMP.
  4406
  4407******************************************************************
  4408
  4409* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4410*    COPY ELC50W1.
  4411******************************************************************
  4412*                                                                *
  4413*                                                                *
  4414*                             ELC50W1                            *
  4415*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4416*                            VMOD=2.004                          *
  4417*                                                                *
  4418*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4419*                                                                *
  4420*                                                                *
  4421******************************************************************
  4422
  4423     12  WK-WORK-AREA.
  4424         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4425         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4426         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4427         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4428         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4429         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4430         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4431         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4432         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4433         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4434         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  83
* EL050.cbl
  4435         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4436         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4437         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4438         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4439         16  WK-CREDIT-EDIT-CONTROLS.
  4440             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4441             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4442             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4443             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4444             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4445             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4446         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4447         16  WK-SAVE-REIN-DATA.
  4448             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4449             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4450             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4451         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4452             88  ENTRY-FROM-EL6311       VALUE '6'.
  4453         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4454         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4455     12  WK-RECORD-ADDRESSES.
  4456         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4457         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4458         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4459         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4460         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4461         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4462         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4463         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4464     12  WK-OVER-SHORT-AREA.
  4465         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4466         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4467         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4468             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4469         16  FILLER                   PIC X(5) VALUE SPACES.
  4470
  4471*    COPY ELCEDITC.
  4472******************************************************************
  4473*                                                                *
  4474*                                                                *
  4475*                            ELCEDITC                            *
  4476*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4477*                            VMOD=2.012                          *
  4478*                                                                *
  4479*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4480*                     EL6313, EL050 AND EL517.                   *
  4481*                                                                *
  4482******************************************************************
  4483******************************************************************
  4484*                   C H A N G E   L O G
  4485*
  4486* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4487*-----------------------------------------------------------------
  4488*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4489* EFFECTIVE    NUMBER
  4490*-----------------------------------------------------------------
  4491* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4492******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  84
* EL050.cbl
  4493
  4494     12  EDIT-CRITERIA-DATA.
  4495         16  EC-CO-MONTH-END-DT       PIC XX.
  4496         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4497         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4498         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4499         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4500         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4501         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4502         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4503         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4504         16  EC-CO-REM-TERM-CALC      PIC X.
  4505               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4506               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4507               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4508               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4509
  4510         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4511               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4512               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4513               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4514               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4515               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4516               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4517               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4518               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4519               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4520               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4521
  4522         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4523               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4524               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4525               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4526               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4527               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4528               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4529               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4530               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4531
  4532         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4533                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4534                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4535
  4536         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4537                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4538                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4539                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4540                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4541                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4542                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4543                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4544                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4545
  4546         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4547               88  EC-BR-REDUCING                   VALUE 'R'.
  4548               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4549
  4550         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  85
* EL050.cbl
  4551         16  EC-BR-LF-DESC             PIC X(10).
  4552         16  EC-BR-AH-DESC             PIC X(10).
  4553         16  EC-BR-LF-COMMENT          PIC X(10).
  4554         16  EC-BR-AH-COMMENT          PIC X(10).
  4555
  4556         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4557               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4558               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4559               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4560               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4561
  4562         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4563               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4564               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4565               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4566               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4567
  4568         16  EC-BR-LF-REFUND-CALC      PIC X.
  4569                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4570                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4571                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4572                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4573                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4574                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4575                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4576
  4577         16  EC-BR-AH-REFUND-CALC      PIC X.
  4578                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4579                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4580                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4581                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4582                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4583                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4584                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4585                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4586
  4587         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4588                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4589                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4590                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4591
  4592         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4593                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4594                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4595                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4596
  4597         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4598         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4599         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4600         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4601
  4602         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4603         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4604                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4605                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4606                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4607                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4608
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  86
* EL050.cbl
  4609         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4610               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4611               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4612               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4613               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4614               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4615
  4616         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4617               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4618               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4619               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4620               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4621               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4622
  4623         16  EC-ST-LF-REFUND-CALC      PIC X.
  4624                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4625                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4626                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4627                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4628                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4629                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4630                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4631                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4632
  4633         16  EC-ST-AH-REFUND-CALC      PIC X.
  4634                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4635                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4636                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4637                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4638                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4639                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4640                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4641                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4642
  4643         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4644         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4645         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4646         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4647         16  EC-AM-EXPIRATION-DT       PIC XX.
  4648         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4649         16  EC-AM-CLASS-CD            PIC XX.
  4650         16  EC-AM-LF-DEVIATION        PIC XXX.
  4651         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4652         16  EC-AM-AH-DEVIATION        PIC XXX.
  4653         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4654         16  EC-AM-PHONE-NO            PIC X(10).
  4655
  4656         16  EC-AM-LF-REFUND-CALC      PIC X.
  4657                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4658                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4659                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4660                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4661                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4662                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4663                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4664
  4665         16  EC-AM-AH-REFUND-CALC      PIC X.
  4666                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  87
* EL050.cbl
  4667                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4668                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4669                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4670                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4671                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4672                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4673
  4674         16  EC-AM-BEN-I-G-CD          PIC X.
  4675                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4676                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4677                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4678
  4679         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4680         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4681         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4682         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4683         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4684         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4685         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4686         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4687         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4688
  4689         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4690         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4691         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4692         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4693         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4694         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4695         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4696         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4697         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4698         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4699         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4700         16  EC-RT-LF-NSP-ST           PIC XX.
  4701         16  EC-RT-AH-NSP-ST           PIC XX.
  4702         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4703         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4704
  4705         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4706             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4707                                             'M' '5' '9' '2'.
  4708             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4709             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4710             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4711             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4712             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4713             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4714             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4715             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4716             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4717             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4718
  4719         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4720             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4721                                             'M' '5' '9' '2'.
  4722             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4723             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4724             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  88
* EL050.cbl
  4725             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4726             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4727             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4728             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4729             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4730             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4731             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4732
  4733         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4734         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4735         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4736         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4737         16  EC-CM-DEATH-DT            PIC XX.
  4738
  4739*DMD CUSTOM CODING FIELDS BELOW
  4740*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4741         16  EC-BR-DMD-RATING-SW       PIC X.
  4742                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4743                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4744                 88  NO-DMD-RATING               VALUE 'N'.
  4745
  4746         16  EC-NEW-CERT               PIC X(11).
  4747         16  EC-NEW-STATE              PIC XX.
  4748         16  FILLER                    PIC X.
  4749*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4750         16  OVER-SHORT-EDIT-FIELDS.
  4751             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4752             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4753             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4754             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4755             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4756             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4757             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4758             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4759             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4760         16  FILLER                    PIC X(71).
  4761******************************************************************
  4762
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  89
* EL050.cbl
  4764*    COPY ELCDIFRD.
  4765******************************************************************
  4766*                                                                *
  4767*                                                                *
  4768*                            ELCDIFRD.                           *
  4769*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4770*                            VMOD=2.004                          *
  4771*                                                                *
  4772*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4773*                                                                *
  4774******************************************************************
  4775*
  4776  01  WS-DIFFERENCE-CALCULATION.
  4777        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4778        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4779        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4780        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4781        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4782        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4783        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4784        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4785        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4786        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4787        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4788
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  90
* EL050.cbl
  4790****************************************************************
  4791*
  4792* Copyright (c) 2007 by Clerity Solutions, Inc.
  4793* All rights reserved.
  4794*
  4795****************************************************************
  4796 01  DFHEIV.
  4797   02  DFHEIV0               PIC X(35).
  4798   02  DFHEIV1               PIC X(08).
  4799   02  DFHEIV2               PIC X(08).
  4800   02  DFHEIV3               PIC X(08).
  4801   02  DFHEIV4               PIC X(06).
  4802   02  DFHEIV5               PIC X(04).
  4803   02  DFHEIV6               PIC X(04).
  4804   02  DFHEIV7               PIC X(02).
  4805   02  DFHEIV8               PIC X(02).
  4806   02  DFHEIV9               PIC X(01).
  4807   02  DFHEIV10              PIC S9(7) COMP-3.
  4808   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4809   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4810   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4811   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4812   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4813   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4814   02  DFHEIV17              PIC X(04).
  4815   02  DFHEIV18              PIC X(04).
  4816   02  DFHEIV19              PIC X(04).
  4817   02  DFHEIV20              USAGE IS POINTER.
  4818   02  DFHEIV21              USAGE IS POINTER.
  4819   02  DFHEIV22              USAGE IS POINTER.
  4820   02  DFHEIV23              USAGE IS POINTER.
  4821   02  DFHEIV24              USAGE IS POINTER.
  4822   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4823   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4824   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4825   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4826   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4827   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4828   02  FILLER                PIC X(02).
  4829   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4830   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4831   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4832   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4833   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4834 LINKAGE  SECTION.
  4835*****************************************************************
  4836*                                                               *
  4837* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4838* All rights reserved.                                          *
  4839*                                                               *
  4840*****************************************************************
  4841 01  dfheiblk.
  4842     02  eibtime          pic s9(7) comp-3.
  4843     02  eibdate          pic s9(7) comp-3.
  4844     02  eibtrnid         pic x(4).
  4845     02  eibtaskn         pic s9(7) comp-3.
  4846     02  eibtrmid         pic x(4).
  4847     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  91
* EL050.cbl
  4848     02  eibcposn         pic s9(4) comp.
  4849     02  eibcalen         pic s9(4) comp.
  4850     02  eibaid           pic x(1).
  4851     02  eibfiller1       pic x(1).
  4852     02  eibfn            pic x(2).
  4853     02  eibfiller2       pic x(2).
  4854     02  eibrcode         pic x(6).
  4855     02  eibfiller3       pic x(2).
  4856     02  eibds            pic x(8).
  4857     02  eibreqid         pic x(8).
  4858     02  eibrsrce         pic x(8).
  4859     02  eibsync          pic x(1).
  4860     02  eibfree          pic x(1).
  4861     02  eibrecv          pic x(1).
  4862     02  eibsend          pic x(1).
  4863     02  eibatt           pic x(1).
  4864     02  eibeoc           pic x(1).
  4865     02  eibfmh           pic x(1).
  4866     02  eibcompl         pic x(1).
  4867     02  eibsig           pic x(1).
  4868     02  eibconf          pic x(1).
  4869     02  eiberr           pic x(1).
  4870     02  eibrldbk         pic x(1).
  4871     02  eiberrcd         pic x(4).
  4872     02  eibsynrb         pic x(1).
  4873     02  eibnodat         pic x(1).
  4874     02  eibfiller5       pic x(2).
  4875     02  eibresp          pic 9(09) comp.
  4876     02  eibresp2         pic 9(09) comp.
  4877     02  dfheigdj         pic s9(4) comp.
  4878     02  dfheigdk         pic s9(4) comp.
  4879
  4880 01  DFHCOMMAREA                   PIC X(1036).
  4881
  4882*01 PARMLIST .
  4883*    02  FILLER                    PIC S9(8)   COMP.
  4884*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4885*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4886*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4887*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4888*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4889*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4890*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4891
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  92
* EL050.cbl
  4893*    COPY ELCCNTL.
  4894******************************************************************
  4895*                                                                *
  4896*                                                                *
  4897*                            ELCCNTL.                            *
  4898*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4899*                            VMOD=2.059                          *
  4900*                                                                *
  4901*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4902*                                                                *
  4903*   FILE TYPE = VSAM,KSDS                                        *
  4904*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4905*                                                                *
  4906*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4907*       ALTERNATE INDEX = NONE                                   *
  4908*                                                                *
  4909*   LOG = YES                                                    *
  4910*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4911******************************************************************
  4912*                   C H A N G E   L O G
  4913*
  4914* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4915*-----------------------------------------------------------------
  4916*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4917* EFFECTIVE    NUMBER
  4918*-----------------------------------------------------------------
  4919* 082503                   PEMA  ADD BENEFIT GROUP
  4920* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4921* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4922* 092705    2005050300006  PEMA  ADD SPP LEASES
  4923* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4924* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4925* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4926* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4927* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4928* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4929******************************************************************
  4930*
  4931 01  CONTROL-FILE.
  4932     12  CF-RECORD-ID                       PIC XX.
  4933         88  VALID-CF-ID                        VALUE 'CF'.
  4934
  4935     12  CF-CONTROL-PRIMARY.
  4936         16  CF-COMPANY-ID                  PIC XXX.
  4937         16  CF-RECORD-TYPE                 PIC X.
  4938             88  CF-COMPANY-MASTER              VALUE '1'.
  4939             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4940             88  CF-STATE-MASTER                VALUE '3'.
  4941             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4942             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4943             88  CF-CARRIER-MASTER              VALUE '6'.
  4944             88  CF-MORTALITY-MASTER            VALUE '7'.
  4945             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4946             88  CF-TERMINAL-MASTER             VALUE '9'.
  4947             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4948             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4949             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4950             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  93
* EL050.cbl
  4951             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4952             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4953             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4954             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4955             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4956         16  CF-ACCESS-CD-GENL              PIC X(4).
  4957         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4958             20  CF-PROCESSOR               PIC X(4).
  4959         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4960             20  CF-STATE-CODE              PIC XX.
  4961             20  FILLER                     PIC XX.
  4962         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4963             20  FILLER                     PIC XX.
  4964             20  CF-HI-BEN-IN-REC           PIC XX.
  4965         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4966             20  FILLER                     PIC XXX.
  4967             20  CF-CARRIER-CNTL            PIC X.
  4968         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4969             20  FILLER                     PIC XX.
  4970             20  CF-HI-TYPE-IN-REC          PIC 99.
  4971         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4972             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4973                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4974             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4975             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4976         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4977             20  FILLER                     PIC X.
  4978             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4979         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4980             20  FILLER                     PIC XX.
  4981             20  CF-MORTGAGE-PLAN           PIC XX.
  4982         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4983
  4984     12  CF-LAST-MAINT-DT                   PIC XX.
  4985     12  CF-LAST-MAINT-BY                   PIC X(4).
  4986     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4987
  4988     12  CF-RECORD-BODY                     PIC X(728).
  4989
  4990
  4991****************************************************************
  4992*             COMPANY MASTER RECORD                            *
  4993****************************************************************
  4994
  4995     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4996         16  CF-COMPANY-ADDRESS.
  4997             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4998             20  CF-CL-IN-CARE-OF           PIC X(30).
  4999             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5000             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5001             20  CF-CL-CITY-STATE           PIC X(30).
  5002             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5003             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5004         16  CF-COMPANY-CD                  PIC X.
  5005         16  CF-COMPANY-PASSWORD            PIC X(8).
  5006         16  CF-SECURITY-OPTION             PIC X.
  5007             88  ALL-SECURITY                   VALUE '1'.
  5008             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  94
* EL050.cbl
  5009             88  PROCESSOR-VERIFY               VALUE '3'.
  5010             88  NO-SECURITY                    VALUE '4'.
  5011             88  ALL-BUT-TERM                   VALUE '5'.
  5012         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5013             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5014         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5015             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5016         16  CF-INFORCE-LOCATION            PIC X.
  5017             88  CERTS-ARE-ONLINE               VALUE '1'.
  5018             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5019             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5020         16  CF-LOWER-CASE-LETTERS          PIC X.
  5021         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5022             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5023             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5024             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5025             88  CF-ACCNT-CNTL                  VALUE '3'.
  5026             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5027
  5028         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5029         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5030
  5031         16  CF-LGX-CREDIT-USER             PIC X.
  5032             88  CO-IS-NOT-USER                 VALUE 'N'.
  5033             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5034
  5035         16 CF-CREDIT-CALC-CODES.
  5036             20  CF-CR-REM-TERM-CALC PIC X.
  5037               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5038               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5039               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5040               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5041               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5042               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5043               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5044             20  CF-CR-R78-METHOD           PIC X.
  5045               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5046               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5047
  5048         16  CF-CLAIM-CONTROL-COUNTS.
  5049             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5050                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5051
  5052             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5053                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5054
  5055             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5056                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5057
  5058             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5059                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5060
  5061         16  CF-CURRENT-MONTH-END           PIC XX.
  5062
  5063         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5064             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5065             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5066             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  95
* EL050.cbl
  5067             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5068                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5069                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5070             20  CF-CO-PREM-REJECT-SW       PIC X.
  5071                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5072                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5073             20  CF-CO-REF-REJECT-SW        PIC X.
  5074                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5075                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5076
  5077         16  CF-CO-REPORTING-DT             PIC XX.
  5078         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5079         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5080           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5081           88  CF-CO-MONTH-END                  VALUE '1'.
  5082
  5083         16  CF-LGX-CLAIM-USER              PIC X.
  5084             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5085             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5086
  5087         16  CF-CREDIT-EDIT-CONTROLS.
  5088             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5089             20  CF-MIN-AGE                 PIC 99.
  5090             20  CF-DEFAULT-AGE             PIC 99.
  5091             20  CF-MIN-TERM                PIC S999      COMP-3.
  5092             20  CF-MAX-TERM                PIC S999      COMP-3.
  5093             20  CF-DEFAULT-SEX             PIC X.
  5094             20  CF-JOINT-AGE-INPUT         PIC X.
  5095                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5096             20  CF-BIRTH-DATE-INPUT        PIC X.
  5097                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5098             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5099                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5100                 88  CF-ZERO-CARRIER            VALUE '1'.
  5101                 88  CF-ZERO-GROUPING           VALUE '2'.
  5102                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5103             20  CF-EDIT-SW                 PIC X.
  5104                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5105             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5106             20  CF-CR-PR-METHOD            PIC X.
  5107               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5108               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5109             20  FILLER                     PIC X.
  5110
  5111         16  CF-CREDIT-MISC-CONTROLS.
  5112             20  CF-REIN-TABLE-SW           PIC X.
  5113                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5114             20  CF-COMP-TABLE-SW           PIC X.
  5115                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5116             20  CF-EXPERIENCE-RETENTION-AGE
  5117                                            PIC S9        COMP-3.
  5118             20  CF-CONVERSION-DT           PIC XX.
  5119             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5120             20  CF-RUN-FREQUENCY-SW        PIC X.
  5121                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5122                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5123
  5124             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  96
* EL050.cbl
  5125                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5126                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5127                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5128                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5129                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5130                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5131
  5132                 24  CF-CR-CHECK-COUNT       REDEFINES
  5133                     CF-CR-CHECK-COUNTER      PIC X(4).
  5134
  5135                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5136                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5137
  5138                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5139                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5140                 24  CF-MAIL-PROCESSING       PIC X.
  5141                     88  MAIL-PROCESSING          VALUE 'Y'.
  5142
  5143         16  CF-MISC-SYSTEM-CONTROL.
  5144             20  CF-SYSTEM-C                 PIC X.
  5145                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5146             20  CF-SYSTEM-D                 PIC X.
  5147                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5148             20  CF-SOC-SEC-NO-SW            PIC X.
  5149                 88  SOC-SEC-NO-USED             VALUE '1'.
  5150             20  CF-MEMBER-NO-SW             PIC X.
  5151                 88  MEMBER-NO-USED              VALUE '1'.
  5152             20  CF-TAX-ID-NUMBER            PIC X(11).
  5153             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5154             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5155                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5156                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5157                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5158                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5159             20  CF-SYSTEM-E                 PIC X.
  5160                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5161
  5162         16  CF-LGX-LIFE-USER               PIC X.
  5163             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5164             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5165
  5166         16  CF-CR-MONTH-END-DT             PIC XX.
  5167
  5168         16  CF-FILE-MAINT-DATES.
  5169             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5170                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5171             20  CF-LAST-BATCH       REDEFINES
  5172                 CF-LAST-BATCH-NO               PIC X(4).
  5173             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5174             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5175             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5176             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5177             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5178             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5179             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5180             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5181             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5182             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  97
* EL050.cbl
  5183
  5184         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5185         16  FILLER                         PIC X.
  5186
  5187         16  CF-ALT-MORT-CODE               PIC X(4).
  5188         16  CF-MEMBER-CAPTION              PIC X(10).
  5189
  5190         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5191             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5192             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5193             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5194             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5195             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5196
  5197         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5198
  5199         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5200         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5201         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5202         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5203
  5204         16  CF-AH-OVERRIDE-L1              PIC X.
  5205         16  CF-AH-OVERRIDE-L2              PIC XX.
  5206         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5207         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5208
  5209         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5210         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5211
  5212         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5213         16  CF-AR-LAST-EL860-DT            PIC XX.
  5214         16  CF-MP-MONTH-END-DT             PIC XX.
  5215
  5216         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5217         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5218             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5219
  5220         16  CF-AR-MONTH-END-DT             PIC XX.
  5221
  5222         16  CF-CRDTCRD-USER                PIC X.
  5223             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5224             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5225
  5226         16  CF-CC-MONTH-END-DT             PIC XX.
  5227
  5228         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5229
  5230         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5231             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5232             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5233             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5234         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5235         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5236         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5237         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5238             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5239             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5240         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  98
* EL050.cbl
  5241         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5242         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5243             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5244         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5245
  5246         16  CF-CL-ZIP-CODE.
  5247             20  CF-CL-ZIP-PRIME.
  5248                 24  CF-CL-ZIP-1ST          PIC X.
  5249                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5250                 24  FILLER                 PIC X(4).
  5251             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5252         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5253             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5254             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5255             20  FILLER                     PIC XXX.
  5256
  5257         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5258         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5259         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5260         16  CF-CO-OPTION-START-DATE        PIC XX.
  5261         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5262           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5263                                                      '3' '4'.
  5264           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5265           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5266           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5267           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5268           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5269           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5270
  5271         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5272
  5273         16  CF-PAYMENT-APPROVAL-LEVELS.
  5274             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5275             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5276             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5277             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5278             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5279             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5280
  5281         16  CF-END-USER-REPORTING-USER     PIC X.
  5282             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5283             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5284
  5285         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5286             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5287             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5288
  5289         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5290
  5291         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5292         16  FILLER                         PIC X.
  5293
  5294         16  CF-CREDIT-ARCHIVE-CNTL.
  5295             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5296             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5297             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5298
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page  99
* EL050.cbl
  5299         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5300
  5301         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5302             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5303             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5304
  5305         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5306             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5307             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5308
  5309         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5310
  5311         16  CF-CO-ACH-ID-CODE              PIC  X.
  5312             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5313             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5314             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5315         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5316         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5317         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5318         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5319         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5320         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5321         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5322         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5323         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5324                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5325         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5326                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5327
  5328         16  CF-CO-OVER-SHORT.
  5329             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5330             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5331
  5332*         16  FILLER                         PIC X(102).
  5333         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5334             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5335             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5336
  5337         16  CF-AH-APPROVAL-DAYS.
  5338             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5339             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5340             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5341             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5342
  5343         16  FILLER                         PIC X(82).
  5344****************************************************************
  5345*             PROCESSOR/USER RECORD                            *
  5346****************************************************************
  5347
  5348     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5349         16  CF-PROCESSOR-NAME              PIC X(30).
  5350         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5351         16  CF-PROCESSOR-TITLE             PIC X(26).
  5352         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5353                 88  MESSAGE-YES                VALUE 'Y'.
  5354                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5355
  5356*****************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 100
* EL050.cbl
  5357****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5358****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5359****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5360****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5361*****************************************************
  5362
  5363         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5364             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5365             20  CF-APPLICATION-FORCE       PIC X.
  5366             20  CF-INDIVIDUAL-APP.
  5367                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5368                     28  CF-BROWSE-APP      PIC X.
  5369                     28  CF-UPDATE-APP      PIC X.
  5370
  5371         16  CF-CURRENT-TERM-ON             PIC X(4).
  5372         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5373             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5374             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5375             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5376             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5377             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5378             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5379             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5380         16  CF-PROCESSOR-CARRIER           PIC X.
  5381             88  NO-CARRIER-SECURITY            VALUE ' '.
  5382         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5383             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5384         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5385             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5386         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5387             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5388
  5389         16  CF-PROC-SYS-ACCESS-SW.
  5390             20  CF-PROC-CREDIT-CLAIMS-SW.
  5391                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5392                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5393                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5394                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5395             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5396                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5397                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5398             20  CF-PROC-LIFE-GNRLDGR-SW.
  5399                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5400                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5401                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5402                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5403             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5404                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5405                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5406         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5407             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5408             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5409         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5410
  5411         16  CF-APPROVAL-LEVEL                  PIC X.
  5412             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5413             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5414             88  APPROVAL-LEVEL-3                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 101
* EL050.cbl
  5415             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5416
  5417         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5418
  5419         16  CF-LANGUAGE-TYPE                   PIC X.
  5420             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5421             88  CF-LANG-IS-FR                      VALUE 'F'.
  5422
  5423         16  CF-CSR-IND                         PIC X.
  5424         16  FILLER                             PIC X(239).
  5425
  5426****************************************************************
  5427*             PROCESSOR/REMINDERS RECORD                       *
  5428****************************************************************
  5429
  5430     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5431         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5432             20  CF-START-REMIND-DT         PIC XX.
  5433             20  CF-END-REMIND-DT           PIC XX.
  5434             20  CF-REMINDER-TEXT           PIC X(50).
  5435         16  FILLER                         PIC X(296).
  5436
  5437
  5438****************************************************************
  5439*             STATE MASTER RECORD                              *
  5440****************************************************************
  5441
  5442     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5443         16  CF-STATE-ABBREVIATION          PIC XX.
  5444         16  CF-STATE-NAME                  PIC X(25).
  5445         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5446         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5447             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5448             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5449             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5450             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5451                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5452                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5453             20  CF-ST-PREM-REJECT-SW       PIC X.
  5454                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5455                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5456             20  CF-ST-REF-REJECT-SW        PIC X.
  5457                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5458                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5459         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5460         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5461         16  CF-ST-REFUND-RULES.
  5462             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5463             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5464             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5465         16  CF-ST-FST-PMT-EXTENSION.
  5466             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5467             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5468                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5469                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5470                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5471                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5472         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 102
* EL050.cbl
  5473             20  CF-ST-CALL-UNEARNED        PIC X.
  5474             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5475             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5476         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5477             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5478             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5479         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5480         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5481         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5482         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5483         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5484         16  FILLER                         PIC X.
  5485         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5486             20  CF-ST-BENEFIT-CD           PIC XX.
  5487             20  CF-ST-BENEFIT-KIND         PIC X.
  5488                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5489                 88  CF-ST-AH-KIND              VALUE 'A'.
  5490             20  CF-ST-REM-TERM-CALC        PIC X.
  5491                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5492                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5493                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5494                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5495                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5496                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5497                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5498                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5499
  5500             20  CF-ST-REFUND-CALC          PIC X.
  5501                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5502                 88  ST-REFD-BY-R78             VALUE '1'.
  5503                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5504                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5505                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5506                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5507                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5508                 88  ST-REFD-UTAH               VALUE '7'.
  5509                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5510                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5511                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5512
  5513             20  CF-ST-EARNING-CALC         PIC X.
  5514                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5515                 88  ST-EARN-BY-R78             VALUE '1'.
  5516                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5517                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5518                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5519                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5520                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5521                 88  ST-EARN-MEAN               VALUE '8'.
  5522                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5523
  5524             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5525                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5526                 88  ST-OVRD-BY-R78             VALUE '1'.
  5527                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5528                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5529                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5530                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 103
* EL050.cbl
  5531                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5532                 88  ST-OVRD-MEAN               VALUE '8'.
  5533                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5534             20  FILLER                     PIC X.
  5535
  5536         16  CF-ST-COMMISSION-CAPS.
  5537             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5538             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5539             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5540             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5541         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5542                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5543
  5544         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5545
  5546         16  CF-ST-STATUTORY-INTEREST.
  5547             20  CF-ST-STAT-DATE-FROM       PIC X.
  5548                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5549                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5550             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5551             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5552             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5553             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5554             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5555
  5556         16  CF-ST-OVER-SHORT.
  5557             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5558             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5559
  5560         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5561
  5562         16  CF-ST-RT-CALC                  PIC X.
  5563
  5564         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5565         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5566         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5567         16  CF-ST-RF-LR-CALC               PIC X.
  5568         16  CF-ST-RF-LL-CALC               PIC X.
  5569         16  CF-ST-RF-LN-CALC               PIC X.
  5570         16  CF-ST-RF-AH-CALC               PIC X.
  5571         16  CF-ST-RF-CP-CALC               PIC X.
  5572*        16  FILLER                         PIC X(206).
  5573*CIDMOD         16  FILLER                         PIC X(192).
  5574         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5575             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5576         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5577         16  CF-ST-VFY-2ND-BENE             PIC X.
  5578         16  FILLER                         PIC X(186).
  5579
  5580****************************************************************
  5581*             BENEFIT MASTER RECORD                            *
  5582****************************************************************
  5583
  5584     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5585         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5586             20  CF-BENEFIT-CODE            PIC XX.
  5587             20  CF-BENEFIT-NUMERIC  REDEFINES
  5588                 CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 104
* EL050.cbl
  5589             20  CF-BENEFIT-ALPHA           PIC XXX.
  5590             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5591             20  CF-BENEFIT-COMMENT         PIC X(10).
  5592
  5593             20  CF-LF-COVERAGE-TYPE        PIC X.
  5594                 88  CF-REDUCING                VALUE 'R'.
  5595                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5596
  5597             20  CF-SPECIAL-CALC-CD         PIC X.
  5598                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5599                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5600                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5601                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5602                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5603                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5604                 88  CF-FARM-PLAN               VALUE 'F'.
  5605                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5606                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5607                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5608                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5609                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5610                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5611                 88  CF-PRUDENTIAL              VALUE 'P'.
  5612                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5613                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5614                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5615                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5616                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5617                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5618
  5619             20  CF-JOINT-INDICATOR         PIC X.
  5620                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5621
  5622*            20  FILLER                     PIC X(12).
  5623             20  FILLER                     PIC X(11).
  5624             20  CF-BENEFIT-CATEGORY        PIC X.
  5625             20  CF-LOAN-TYPE               PIC X(8).
  5626
  5627             20  CF-CO-REM-TERM-CALC        PIC X.
  5628                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5629                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5630                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5631                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5632                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5633
  5634             20  CF-CO-EARNINGS-CALC        PIC X.
  5635                 88  CO-EARN-BY-R78             VALUE '1'.
  5636                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5637                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5638                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5639                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5640                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5641                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5642                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5643
  5644             20  CF-CO-REFUND-CALC          PIC X.
  5645                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5646                 88  CO-REFD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 105
* EL050.cbl
  5647                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5648                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5649                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5650                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5651                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5652                 88  CO-REFD-MEAN               VALUE '8'.
  5653                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5654                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5655                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5656
  5657             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5658                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5659                 88  CO-OVRD-BY-R78             VALUE '1'.
  5660                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5661                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5662                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5663                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5664                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5665                 88  CO-OVRD-MEAN               VALUE '8'.
  5666                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5667
  5668             20  CF-CO-BEN-I-G-CD           PIC X.
  5669                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5670                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5671                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5672
  5673         16  FILLER                         PIC X(304).
  5674
  5675
  5676****************************************************************
  5677*             CARRIER MASTER RECORD                            *
  5678****************************************************************
  5679
  5680     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5681         16  CF-ADDRESS-DATA.
  5682             20  CF-MAIL-TO-NAME            PIC X(30).
  5683             20  CF-IN-CARE-OF              PIC X(30).
  5684             20  CF-ADDRESS-LINE-1          PIC X(30).
  5685             20  CF-ADDRESS-LINE-2          PIC X(30).
  5686             20  CF-CITY-STATE              PIC X(30).
  5687             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5688             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5689
  5690         16  CF-CLAIM-NO-CONTROL.
  5691             20  CF-CLAIM-NO-METHOD         PIC X.
  5692                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5693                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5694                 88  CLAIM-NO-SEQ               VALUE '3'.
  5695                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5696             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5697                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5698                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5699                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5700
  5701         16  CF-CHECK-NO-CONTROL.
  5702             20  CF-CHECK-NO-METHOD         PIC X.
  5703                 88  CHECK-NO-MANUAL            VALUE '1'.
  5704                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 106
* EL050.cbl
  5705                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5706                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5707             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5708                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5709
  5710         16  CF-DOMICILE-STATE              PIC XX.
  5711
  5712         16  CF-EXPENSE-CONTROLS.
  5713             20  CF-EXPENSE-METHOD          PIC X.
  5714                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5715                 88  DOLLARS-PER-PMT            VALUE '2'.
  5716                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5717                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5718             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5719             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5720
  5721         16  CF-CORRESPONDENCE-CONTROL.
  5722             20  CF-LETTER-RESEND-OPT       PIC X.
  5723                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5724                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5725             20  FILLER                     PIC X(4).
  5726
  5727         16  CF-RESERVE-CONTROLS.
  5728             20  CF-MANUAL-SW               PIC X.
  5729                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5730             20  CF-FUTURE-SW               PIC X.
  5731                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5732             20  CF-PTC-SW                  PIC X.
  5733                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5734             20  CF-IBNR-SW                 PIC X.
  5735                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5736             20  CF-PTC-LF-SW               PIC X.
  5737                 88  CF-LF-PTC-USED             VALUE '1'.
  5738             20  CF-CDT-ACCESS-METHOD       PIC X.
  5739                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5740                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5741                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5742             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5743
  5744         16  CF-CLAIM-CALC-METHOD           PIC X.
  5745             88  360-PLUS-MONTHS                VALUE '1'.
  5746             88  365-PLUS-MONTHS                VALUE '2'.
  5747             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5748             88  360-DAILY                      VALUE '4'.
  5749             88  365-DAILY                      VALUE '5'.
  5750
  5751         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5752         16  FILLER                         PIC X(11).
  5753
  5754         16  CF-LIMIT-AMOUNTS.
  5755             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5756             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5757             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5758             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5759             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5760             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5761             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5762             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 107
* EL050.cbl
  5763             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5764             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5765
  5766         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5767         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5768         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5769
  5770         16  CF-ZIP-CODE.
  5771             20  CF-ZIP-PRIME.
  5772                 24  CF-ZIP-1ST             PIC X.
  5773                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5774                 24  FILLER                 PIC X(4).
  5775             20  CF-ZIP-PLUS4               PIC X(4).
  5776         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5777             20  CF-CAN-POSTAL-1            PIC XXX.
  5778             20  CF-CAN-POSTAL-2            PIC XXX.
  5779             20  FILLER                     PIC XXX.
  5780
  5781         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5782         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5783         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5784
  5785         16  CF-RATING-SWITCH               PIC X.
  5786             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5787             88  CF-NO-RATING                   VALUE 'N'.
  5788
  5789         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5790
  5791         16  CF-CARRIER-OVER-SHORT.
  5792             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5793             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5794
  5795         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5796         16  CF-SECPAY-SWITCH               PIC X.
  5797             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5798             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5799         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5800         16  FILLER                         PIC X(448).
  5801*        16  FILLER                         PIC X(452).
  5802
  5803
  5804****************************************************************
  5805*             MORTALITY MASTER RECORD                          *
  5806****************************************************************
  5807
  5808     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5809         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5810                                INDEXED BY CF-MORT-NDX.
  5811             20  CF-MORT-TABLE              PIC X(5).
  5812             20  CF-MORT-TABLE-TYPE         PIC X.
  5813                 88  CF-MORT-JOINT              VALUE 'J'.
  5814                 88  CF-MORT-SINGLE             VALUE 'S'.
  5815                 88  CF-MORT-COMBINED           VALUE 'C'.
  5816                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5817                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5818             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5819             20  CF-MORT-AGE-METHOD         PIC XX.
  5820                 88  CF-AGE-LAST                VALUE 'AL'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 108
* EL050.cbl
  5821                 88  CF-AGE-NEAR                VALUE 'AN'.
  5822             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5823             20  CF-MORT-ADJUSTMENT-DIRECTION
  5824                                            PIC X.
  5825                 88  CF-MINUS                   VALUE '-'.
  5826                 88  CF-PLUS                    VALUE '+'.
  5827             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5828             20  CF-MORT-JOINT-CODE         PIC X.
  5829                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5830             20  CF-MORT-PC-Q               PIC X.
  5831                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5832             20  CF-MORT-TABLE-CODE         PIC X(4).
  5833             20  CF-MORT-COMMENTS           PIC X(15).
  5834             20  FILLER                     PIC X(14).
  5835
  5836         16  FILLER                         PIC X(251).
  5837
  5838
  5839****************************************************************
  5840*             BUSSINESS TYPE MASTER RECORD                     *
  5841****************************************************************
  5842
  5843     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5844* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5845* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5846* AND RECORD 05 IS TYPES 81-99
  5847         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5848             20  CF-BUSINESS-TITLE          PIC  X(19).
  5849             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5850                                            PIC S9V9(4) COMP-3.
  5851             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5852             20  FILLER                     PIC  X.
  5853         16  FILLER                         PIC  X(248).
  5854
  5855
  5856****************************************************************
  5857*             TERMINAL MASTER RECORD                           *
  5858****************************************************************
  5859
  5860     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5861
  5862         16  CF-COMPANY-TERMINALS.
  5863             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5864                                  PIC X(4).
  5865         16  FILLER               PIC X(248).
  5866
  5867
  5868****************************************************************
  5869*             LIFE EDIT MASTER RECORD                          *
  5870****************************************************************
  5871
  5872     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5873         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5874             20  CF-LIFE-CODE-IN            PIC XX.
  5875             20  CF-LIFE-CODE-OUT           PIC XX.
  5876         16  FILLER                         PIC X(248).
  5877
  5878
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 109
* EL050.cbl
  5879****************************************************************
  5880*             AH EDIT MASTER RECORD                            *
  5881****************************************************************
  5882
  5883     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5884         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5885             20  CF-AH-CODE-IN              PIC XXX.
  5886             20  CF-AH-CODE-OUT             PIC XX.
  5887         16  FILLER                         PIC X(248).
  5888
  5889
  5890****************************************************************
  5891*             CREDIBILITY TABLES                               *
  5892****************************************************************
  5893
  5894     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5895         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5896                             INDEXED BY CF-CRDB-NDX.
  5897             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5898             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5899             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5900         16  FILLER                         PIC  X(332).
  5901
  5902
  5903****************************************************************
  5904*             REPORT CUSTOMIZATION RECORD                      *
  5905****************************************************************
  5906
  5907     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5908         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5909             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5910             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5911             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5912**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5913****       A T-TRANSFER.                                   ****
  5914             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5915
  5916         16  FILLER                         PIC XX.
  5917
  5918         16  CF-CARRIER-CNTL-OPT.
  5919             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5920                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5921                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5922             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5923                                            PIC X.
  5924         16  CF-GROUP-CNTL-OPT.
  5925             20  CF-GROUP-OPT-SEQ           PIC 9.
  5926                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5927                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5928             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5929                                            PIC X(6).
  5930         16  CF-STATE-CNTL-OPT.
  5931             20  CF-STATE-OPT-SEQ           PIC 9.
  5932                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5933                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5934             20  CF-STATE-SELECT OCCURS 3 TIMES
  5935                                            PIC XX.
  5936         16  CF-ACCOUNT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 110
* EL050.cbl
  5937             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5938                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5939                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5940             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5941                                            PIC X(10).
  5942         16  CF-BUS-TYP-CNTL-OPT.
  5943             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5944                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5945                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5946             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5947                                            PIC XX.
  5948         16  CF-LF-TYP-CNTL-OPT.
  5949             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5950                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5951                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5952             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5953                                            PIC XX.
  5954         16  CF-AH-TYP-CNTL-OPT.
  5955             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5956                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5957                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5958             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5959                                            PIC XX.
  5960         16  CF-REPTCD1-CNTL-OPT.
  5961             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5962                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5963                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5964             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5965                                            PIC X(10).
  5966         16  CF-REPTCD2-CNTL-OPT.
  5967             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5968                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5969                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5970             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5971                                            PIC X(10).
  5972         16  CF-USER1-CNTL-OPT.
  5973             20  CF-USER1-OPT-SEQ           PIC 9.
  5974                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5975                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5976             20  CF-USER1-SELECT OCCURS 3 TIMES
  5977                                            PIC X(10).
  5978         16  CF-USER2-CNTL-OPT.
  5979             20  CF-USER2-OPT-SEQ           PIC 9.
  5980                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5981                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5982             20  CF-USER2-SELECT OCCURS 3 TIMES
  5983                                            PIC X(10).
  5984         16  CF-USER3-CNTL-OPT.
  5985             20  CF-USER3-OPT-SEQ           PIC 9.
  5986                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5987                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5988             20  CF-USER3-SELECT OCCURS 3 TIMES
  5989                                            PIC X(10).
  5990         16  CF-USER4-CNTL-OPT.
  5991             20  CF-USER4-OPT-SEQ           PIC 9.
  5992                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5993                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5994             20  CF-USER4-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 111
* EL050.cbl
  5995                                            PIC X(10).
  5996         16  CF-USER5-CNTL-OPT.
  5997             20  CF-USER5-OPT-SEQ           PIC 9.
  5998                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5999                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6000             20  CF-USER5-SELECT OCCURS 3 TIMES
  6001                                            PIC X(10).
  6002         16  CF-REINS-CNTL-OPT.
  6003             20  CF-REINS-OPT-SEQ           PIC 9.
  6004                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6005                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6006             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6007                 24  CF-REINS-PRIME         PIC XXX.
  6008                 24  CF-REINS-SUB           PIC XXX.
  6009
  6010         16  CF-AGENT-CNTL-OPT.
  6011             20  CF-AGENT-OPT-SEQ           PIC 9.
  6012                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6013                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6014             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6015                                            PIC X(10).
  6016
  6017         16  FILLER                         PIC X(43).
  6018
  6019         16  CF-LOSS-RATIO-SELECT.
  6020             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6021             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6022         16  CF-ENTRY-DATE-SELECT.
  6023             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6024             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6025         16  CF-EFFECTIVE-DATE-SELECT.
  6026             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6027             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6028
  6029         16  CF-EXCEPTION-LIST-IND          PIC X.
  6030             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6031
  6032         16  FILLER                         PIC X(318).
  6033
  6034****************************************************************
  6035*                  EXCEPTION REPORTING RECORD                  *
  6036****************************************************************
  6037
  6038     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6039         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6040             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6041
  6042         16  CF-COMBINED-LIFE-AH-OPT.
  6043             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6044             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6045             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6046             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6047
  6048         16  CF-LIFE-OPT.
  6049             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6050             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6051             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6052             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 112
* EL050.cbl
  6053             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6054             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6055             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6056             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6057             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6058             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6059
  6060         16  CF-AH-OPT.
  6061             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6062             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6063             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6064             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6065             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6066             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6067             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6068             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6069             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6070             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6071
  6072         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6073             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6074             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6075             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6076
  6077         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6078
  6079         16  FILLER                         PIC X(673).
  6080
  6081
  6082****************************************************************
  6083*             MORTGAGE SYSTEM PLAN RECORD                      *
  6084****************************************************************
  6085
  6086     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6087         16  CF-PLAN-TYPE                   PIC X.
  6088             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6089             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6090             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6091         16  CF-PLAN-ABBREV                 PIC XXX.
  6092         16  CF-PLAN-DESCRIPT               PIC X(10).
  6093         16  CF-PLAN-NOTES                  PIC X(20).
  6094         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6095         16  CF-PLAN-UNDERWRITING.
  6096             20  CF-PLAN-TERM-DATA.
  6097                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6098                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6099             20  CF-PLAN-AGE-DATA.
  6100                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6101                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6102                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6103             20  CF-PLAN-BENEFIT-DATA.
  6104                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6105                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6106                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6107                                            PIC S9(7)V99  COMP-3.
  6108         16  CF-PLAN-POLICY-FORMS.
  6109             20  CF-POLICY-FORM             PIC X(12).
  6110             20  CF-MASTER-APPLICATION      PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 113
* EL050.cbl
  6111             20  CF-MASTER-POLICY           PIC X(12).
  6112         16  CF-PLAN-RATING.
  6113             20  CF-RATE-CODE               PIC X(5).
  6114             20  CF-SEX-RATING              PIC X.
  6115                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6116                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6117             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6118             20  CF-SUB-STD-TYPE            PIC X.
  6119                 88  CF-PCT-OF-PREM            VALUE '1'.
  6120                 88  CF-PCT-OF-BENE            VALUE '2'.
  6121         16  CF-PLAN-PREM-TOLERANCES.
  6122             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6123             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6124         16  CF-PLAN-PYMT-TOLERANCES.
  6125             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6126             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6127         16  CF-PLAN-MISC-DATA.
  6128             20  FILLER                     PIC X.
  6129             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6130             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6131         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6132         16  CF-PLAN-IND-GRP                PIC X.
  6133             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6134                                                     '1'.
  6135             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6136                                                     '2'.
  6137         16  CF-MIB-SEARCH-SW               PIC X.
  6138             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6139             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6140             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6141             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6142         16  CF-ALPHA-SEARCH-SW             PIC X.
  6143             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6144             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6145             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6146             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6147             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6148             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6149             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6150             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6151             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6152             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6153                                                     'A' 'B' 'C'
  6154                                                     'X' 'Y' 'Z'.
  6155         16  CF-EFF-DT-RULE-SW              PIC X.
  6156             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6157             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6158             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6159             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6160             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6161         16  FILLER                         PIC X(4).
  6162         16  CF-HEALTH-QUESTIONS            PIC X.
  6163             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6164         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6165         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6166         16  CF-PLAN-SNGL-JNT               PIC X.
  6167             88  CF-COMBINED-PLAN              VALUE 'C'.
  6168             88  CF-JNT-PLAN                   VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 114
* EL050.cbl
  6169             88  CF-SNGL-PLAN                  VALUE 'S'.
  6170         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6171         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6172         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6173         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6174         16  CF-RERATE-CNTL                 PIC  X.
  6175             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6176             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6177             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6178             88  CF-AUTO-RECALC                 VALUE '4'.
  6179         16  CF-BENEFIT-TYPE                PIC  X.
  6180             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6181             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6182         16  CF-POLICY-FEE                  PIC S999V99
  6183                                                    COMP-3.
  6184         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6185         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6186         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6187         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6188         16  FILLER                         PIC  X(32).
  6189         16  CF-TERMINATION-FORM            PIC  X(04).
  6190         16  FILLER                         PIC  X(08).
  6191         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6192                                                       COMP-3.
  6193         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6194         16  CF-ISSUE-LETTER                PIC  X(4).
  6195         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6196         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6197             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6198             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6199         16  CF-MP-REFUND-CALC              PIC X.
  6200             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6201             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6202             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6203             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6204             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6205             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6206             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6207             88  CF-MP-REFD-MEAN                VALUE '8'.
  6208         16  CF-ALT-RATE-CODE               PIC  X(5).
  6209
  6210
  6211         16  FILLER                         PIC X(498).
  6212****************************************************************
  6213*             MORTGAGE COMPANY MASTER RECORD                   *
  6214****************************************************************
  6215
  6216     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6217         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6218         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6219             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6220             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6221             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6222             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6223             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6224
  6225         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6226         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 115
* EL050.cbl
  6227         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6228         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6229         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6230
  6231         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6232             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6233         16  CF-MP-RECON-USE-IND            PIC X(1).
  6234             88  CF-MP-USE-RECON             VALUE 'Y'.
  6235         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6236             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6237         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6238             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6239             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6240         16  FILLER                         PIC X(1).
  6241         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6242             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6243         16  CF-MORTG-MIB-VERSION           PIC X.
  6244             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6245             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6246             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6247         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6248             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6249                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6250             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6251                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6252             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6253                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6254             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6255                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6256             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6257                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6258             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6259                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6260         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6261         16  FILLER                         PIC X(7).
  6262         16  CF-MORTG-DESTINATION-SYMBOL.
  6263             20  CF-MORTG-MIB-COMM          PIC X(5).
  6264             20  CF-MORTG-MIB-TERM          PIC X(5).
  6265         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6266             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6267         16  FILLER                         PIC X(03).
  6268         16  CF-MP-CHECK-NO-CONTROL.
  6269             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6270                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6271                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6272                                                ' ' LOW-VALUES.
  6273                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6274                                               VALUE '3'.
  6275         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6276         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6277         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6278             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6279                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6280             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6281                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6282             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6283                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6284             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 116
* EL050.cbl
  6285                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6286             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6287                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6288             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6289                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6290         16  CF-MORTG-BILLING-AREA.
  6291             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6292                                            PIC X.
  6293         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6294         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6295         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6296         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6297             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6298             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6299         16  FILLER                         PIC X.
  6300         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6301             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6302             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6303         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6304         16  FILLER                         PIC X(8).
  6305         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6306         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6307         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6308         16  CF-ACH-COMPANY-ID.
  6309             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6310                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6311                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6312                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6313             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6314         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6315             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6316         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6317             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6318             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6319         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6320         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6321         16  FILLER                         PIC X(536).
  6322
  6323****************************************************************
  6324*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6325****************************************************************
  6326
  6327     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6328         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6329             20  CF-FEMALE-HEIGHT.
  6330                 24  CF-FEMALE-FT           PIC 99.
  6331                 24  CF-FEMALE-IN           PIC 99.
  6332             20  CF-FEMALE-MIN-WT           PIC 999.
  6333             20  CF-FEMALE-MAX-WT           PIC 999.
  6334         16  FILLER                         PIC X(428).
  6335
  6336     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6337         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6338             20  CF-MALE-HEIGHT.
  6339                 24  CF-MALE-FT             PIC 99.
  6340                 24  CF-MALE-IN             PIC 99.
  6341             20  CF-MALE-MIN-WT             PIC 999.
  6342             20  CF-MALE-MAX-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 117
* EL050.cbl
  6343         16  FILLER                         PIC X(428).
  6344******************************************************************
  6345*             AUTOMATIC ACTIVITY RECORD                          *
  6346******************************************************************
  6347     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6348         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6349             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6350             20  CF-SYS-LETTER-ID           PIC X(04).
  6351             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6352             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6353             20  CF-SYS-RESET-SW            PIC X(01).
  6354             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6355             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6356
  6357         16  FILLER                         PIC X(50).
  6358
  6359         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6360             20  CF-USER-ACTIVE-SW          PIC X(01).
  6361             20  CF-USER-LETTER-ID          PIC X(04).
  6362             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6363             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6364             20  CF-USER-RESET-SW           PIC X(01).
  6365             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6366             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6367             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6368
  6369         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 118
* EL050.cbl
  6371*    COPY ERCACCT.
  6372******************************************************************
  6373*                                                                *
  6374*                                                                *
  6375*                            ERCACCT                             *
  6376*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6377*                            VMOD=2.031                          *
  6378*                                                                *
  6379*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6380*                                                                *
  6381*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6382*   VSAM ACCOUNT MASTER FILES.                                   *
  6383*                                                                *
  6384*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6385*                                                                *
  6386*   FILE TYPE = VSAM,KSDS                                        *
  6387*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6388*                                                                *
  6389*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6390*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6391*                                                                *
  6392*   LOG = NO                                                     *
  6393*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6394*                                                                *
  6395*                                                                *
  6396******************************************************************
  6397*                   C H A N G E   L O G
  6398*
  6399* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6400*-----------------------------------------------------------------
  6401*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6402* EFFECTIVE    NUMBER
  6403*-----------------------------------------------------------------
  6404* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6405* 092705    2005050300006  PEMA  ADD SPP LEASES
  6406* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6407* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6408* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6409* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6410* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6411******************************************************************
  6412
  6413 01  ACCOUNT-MASTER.
  6414     12  AM-RECORD-ID                      PIC XX.
  6415         88  VALID-AM-ID                      VALUE 'AM'.
  6416
  6417     12  AM-CONTROL-PRIMARY.
  6418         16  AM-COMPANY-CD                 PIC X.
  6419         16  AM-MSTR-CNTRL.
  6420             20  AM-CONTROL-A.
  6421                 24  AM-CARRIER            PIC X.
  6422                 24  AM-GROUPING.
  6423                     28 AM-GROUPING-PREFIX PIC XXX.
  6424                     28 AM-GROUPING-PRIME  PIC XXX.
  6425                 24  AM-STATE              PIC XX.
  6426                 24  AM-ACCOUNT.
  6427                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6428                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 119
* EL050.cbl
  6429             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6430                                           PIC X(19).
  6431             20  AM-CNTRL-B.
  6432                 24  AM-EXPIRATION-DT      PIC XX.
  6433                 24  FILLER                PIC X(4).
  6434             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6435                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6436
  6437     12  AM-CONTROL-BY-VAR-GRP.
  6438         16  AM-COMPANY-CD-A1              PIC X.
  6439         16  AM-VG-CARRIER                 PIC X.
  6440         16  AM-VG-GROUPING                PIC X(6).
  6441         16  AM-VG-STATE                   PIC XX.
  6442         16  AM-VG-ACCOUNT                 PIC X(10).
  6443         16  AM-VG-DATE.
  6444             20  AM-VG-EXPIRATION-DT       PIC XX.
  6445             20  FILLER                    PIC X(4).
  6446         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6447                                           PIC 9(11)      COMP-3.
  6448     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6449         16  FILLER                        PIC X(10).
  6450         16  AM-VG-KEY3.
  6451             20  AM-VG3-ACCOUNT            PIC X(10).
  6452             20  AM-VG3-EXP-DT             PIC XX.
  6453         16  FILLER                        PIC X(4).
  6454     12  AM-MAINT-INFORMATION.
  6455         16  AM-LAST-MAINT-DT              PIC XX.
  6456         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6457         16  AM-LAST-MAINT-USER            PIC X(4).
  6458         16  FILLER                        PIC XX.
  6459
  6460     12  AM-EFFECTIVE-DT                   PIC XX.
  6461     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6462
  6463     12  AM-PREV-DATES  COMP-3.
  6464         16  AM-PREV-EXP-DT                PIC 9(11).
  6465         16  AM-PREV-EFF-DT                PIC 9(11).
  6466
  6467     12  AM-REPORT-CODE-1                  PIC X(10).
  6468     12  AM-REPORT-CODE-2                  PIC X(10).
  6469
  6470     12  AM-CITY-CODE                      PIC X(4).
  6471     12  AM-COUNTY-PARISH                  PIC X(6).
  6472
  6473     12  AM-NAME                           PIC X(30).
  6474     12  AM-PERSON                         PIC X(30).
  6475     12  AM-ADDRS                          PIC X(30).
  6476     12  AM-CITY.
  6477         16  AM-ADDR-CITY                  PIC X(28).
  6478         16  AM-ADDR-STATE                 PIC XX.
  6479     12  AM-ZIP.
  6480         16  AM-ZIP-PRIME.
  6481             20  AM-ZIP-PRI-1ST            PIC X.
  6482                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6483             20  FILLER                    PIC X(4).
  6484         16  AM-ZIP-PLUS4                  PIC X(4).
  6485     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6486         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 120
* EL050.cbl
  6487         16  AM-CAN-POSTAL-2               PIC XXX.
  6488         16  FILLER                        PIC XXX.
  6489     12  AM-TEL-NO.
  6490         16  AM-AREA-CODE                  PIC 999.
  6491         16  AM-TEL-PRE                    PIC 999.
  6492         16  AM-TEL-NBR                    PIC 9(4).
  6493     12  AM-TEL-LOC                        PIC X.
  6494         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6495         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6496
  6497     12  AM-COMM-STRUCTURE.
  6498         16  AM-DEFN-1.
  6499             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6500                 24  AM-AGT.
  6501                     28  AM-AGT-PREFIX     PIC X(4).
  6502                     28  AM-AGT-PRIME      PIC X(6).
  6503                 24  AM-COM-TYP            PIC X.
  6504                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6505                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6506                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6507                 24  AM-RECALC-LV-INDIC    PIC X.
  6508                 24  AM-RETRO-LV-INDIC     PIC X.
  6509                 24  AM-GL-CODES           PIC X.
  6510                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6511                 24  FILLER                PIC X(01).
  6512         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6513             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6514                 24  FILLER                PIC X(11).
  6515                 24  AM-L-COMA             PIC XXX.
  6516                 24  AM-J-COMA             PIC XXX.
  6517                 24  AM-A-COMA             PIC XXX.
  6518                 24  FILLER                PIC X(6).
  6519
  6520     12  AM-COMM-CHANGE-STATUS             PIC X.
  6521         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6522
  6523     12  AM-CSR-CODE                       PIC X(4).
  6524
  6525     12  AM-BILLING-STATUS                 PIC X.
  6526         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6527         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6528     12  AM-AUTO-REFUND-SW                 PIC X.
  6529         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6530         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6531     12  AM-GPCD                           PIC 99.
  6532     12  AM-IG                             PIC X.
  6533         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6534         88  AM-HAS-GROUP                     VALUE '2'.
  6535     12  AM-STATUS                         PIC X.
  6536         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6537         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6538         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6539         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6540         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6541         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6542     12  AM-REMIT-TO                       PIC 99.
  6543     12  AM-ID-NO                          PIC X(11).
  6544
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 121
* EL050.cbl
  6545     12  AM-CAL-TABLE                      PIC XX.
  6546     12  AM-LF-DEVIATION                   PIC XXX.
  6547     12  AM-AH-DEVIATION                   PIC XXX.
  6548     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6549     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6550     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6551     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6552     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6553     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6554
  6555     12  AM-USER-FIELDS.
  6556         16  AM-FLD-1                      PIC XX.
  6557         16  AM-FLD-2                      PIC XX.
  6558         16  AM-FLD-3                      PIC XX.
  6559         16  AM-FLD-4                      PIC XX.
  6560         16  AM-FLD-5                      PIC XX.
  6561
  6562     12  AM-1ST-PROD-DATE.
  6563         16  AM-1ST-PROD-YR                PIC XX.
  6564         16  AM-1ST-PROD-MO                PIC XX.
  6565         16  AM-1ST-PROD-DA                PIC XX.
  6566     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6567     12  AM-CERTS-PURGED-DATE.
  6568         16  AM-PUR-YR                     PIC XX.
  6569         16  AM-PUR-MO                     PIC XX.
  6570         16  AM-PUR-DA                     PIC XX.
  6571     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6572     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6573     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6574     12  AM-INACTIVE-DATE.
  6575         16  AM-INA-MO                     PIC 99.
  6576         16  AM-INA-DA                     PIC 99.
  6577         16  AM-INA-YR                     PIC 99.
  6578     12  AM-AR-HI-CERT-DATE                PIC XX.
  6579
  6580     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6581     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6582
  6583     12  AM-OB-PAYMENT-MODE                PIC X.
  6584         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6585         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6586         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6587         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6588
  6589     12  AM-AH-ONLY-INDICATOR              PIC X.
  6590         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6591         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6592
  6593     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6594
  6595     12  AM-OVER-SHORT.
  6596         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6597         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6598
  6599     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6600     12  AM-DCC-CLP-STATE                  PIC XX.
  6601
  6602     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 122
* EL050.cbl
  6603     12  AM-RECALC-REIN                    PIC X.
  6604
  6605     12  AM-REI-TABLE                      PIC XXX.
  6606     12  AM-REI-ET-LF                      PIC X.
  6607     12  AM-REI-ET-AH                      PIC X.
  6608     12  AM-REI-PE-LF                      PIC X.
  6609     12  AM-REI-PE-AH                      PIC X.
  6610     12  AM-REI-PRT-ST                     PIC X.
  6611     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6612     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6613     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6614     12  AM-REI-GROUP-A                    PIC X(6).
  6615     12  AM-REI-MORT                       PIC X(4).
  6616     12  AM-REI-PRT-OW                     PIC X.
  6617     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6618     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6619     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6620     12  AM-REI-GROUP-B                    PIC X(6).
  6621
  6622     12  AM-TRUST-TYPE                     PIC X(2).
  6623
  6624     12  AM-EMPLOYER-STMT-USED             PIC X.
  6625     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6626
  6627     12  AM-STD-AH-TYPE                    PIC XX.
  6628     12  AM-EARN-METHODS.
  6629         16  AM-EARN-METHOD-R              PIC X.
  6630             88 AM-REF-RL-R78                 VALUE 'R'.
  6631             88 AM-REF-RL-PR                  VALUE 'P'.
  6632             88 AM-REF-RL-MEAN                VALUE 'M'.
  6633             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6634         16  AM-EARN-METHOD-L              PIC X.
  6635             88 AM-REF-LL-R78                 VALUE 'R'.
  6636             88 AM-REF-LL-PR                  VALUE 'P'.
  6637             88 AM-REF-LL-MEAN                VALUE 'M'.
  6638             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6639         16  AM-EARN-METHOD-A              PIC X.
  6640             88 AM-REF-AH-R78                 VALUE 'R'.
  6641             88 AM-REF-AH-PR                  VALUE 'P'.
  6642             88 AM-REF-AH-MEAN                VALUE 'M'.
  6643             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6644             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6645             88 AM-REF-AH-NET                 VALUE 'N'.
  6646
  6647     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6648     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6649     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6650
  6651     12  AM-RET-Y-N                        PIC X.
  6652     12  AM-RET-P-E                        PIC X.
  6653     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6654     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6655     12  AM-RET-GRP                        PIC X(6).
  6656     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6657         16  AM-POOL-PRIME                 PIC XXX.
  6658         16  AM-POOL-SUB                   PIC XXX.
  6659     12  AM-RETRO-EARNINGS.
  6660         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 123
* EL050.cbl
  6661         16  AM-RET-EARN-L                 PIC X.
  6662         16  AM-RET-EARN-A                 PIC X.
  6663     12  AM-RET-ST-TAX-USE                 PIC X.
  6664         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6665         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6666     12  AM-RETRO-BEG-EARNINGS.
  6667         16  AM-RET-BEG-EARN-R             PIC X.
  6668         16  AM-RET-BEG-EARN-L             PIC X.
  6669         16  AM-RET-BEG-EARN-A             PIC X.
  6670     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6671     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6672
  6673     12  AM-USER-SELECT-OPTIONS.
  6674         16  AM-USER-SELECT-1              PIC X(10).
  6675         16  AM-USER-SELECT-2              PIC X(10).
  6676         16  AM-USER-SELECT-3              PIC X(10).
  6677         16  AM-USER-SELECT-4              PIC X(10).
  6678         16  AM-USER-SELECT-5              PIC X(10).
  6679
  6680     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6681
  6682     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6683
  6684     12  AM-RPT045A-SWITCH                 PIC X.
  6685         88  RPT045A-OFF                   VALUE 'N'.
  6686
  6687     12  AM-INSURANCE-LIMITS.
  6688         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6689         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6690
  6691     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6692         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6693
  6694     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6695         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6696         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6697
  6698     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6699
  6700     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6701     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6702     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6703     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6704     12  AM-DCC-UEF-STATE                  PIC XX.
  6705     12  FILLER                            PIC XXX.
  6706     12  AM-REPORT-CODE-3                  PIC X(10).
  6707*    12  FILLER                            PIC X(22).
  6708
  6709     12  AM-RESERVE-DATE.
  6710         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6711         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6712         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6713
  6714     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6715     12  AM-NOTIFICATION-TYPES.
  6716         16  AM-NOTIF-OF-LETTERS           PIC X.
  6717         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6718         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 124
* EL050.cbl
  6719         16  AM-NOTIF-OF-STATUS            PIC X.
  6720
  6721     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6722         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6723         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6724         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6725         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6726
  6727     12  AM-BENEFIT-CONTROLS.
  6728         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6729             20  AM-BENEFIT-CODE           PIC XX.
  6730             20  AM-BENEFIT-TYPE           PIC X.
  6731             20  AM-BENEFIT-REVISION       PIC XXX.
  6732             20  AM-BENEFIT-REM-TERM       PIC X.
  6733             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6734             20  FILLER                    PIC XX.
  6735         16  FILLER                        PIC X(80).
  6736
  6737     12  AM-TRANSFER-DATA.
  6738         16  AM-TRANSFERRED-FROM.
  6739             20  AM-TRNFROM-CARRIER        PIC X.
  6740             20  AM-TRNFROM-GROUPING.
  6741                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6742                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6743             20  AM-TRNFROM-STATE          PIC XX.
  6744             20  AM-TRNFROM-ACCOUNT.
  6745                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6746                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6747             20  AM-TRNFROM-DTE            PIC XX.
  6748         16  AM-TRANSFERRED-TO.
  6749             20  AM-TRNTO-CARRIER          PIC X.
  6750             20  AM-TRNTO-GROUPING.
  6751                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6752                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6753             20  AM-TRNTO-STATE            PIC XX.
  6754             20  AM-TRNTO-ACCOUNT.
  6755                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6756                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6757             20  AM-TRNTO-DTE              PIC XX.
  6758         16  FILLER                        PIC X(10).
  6759
  6760     12  AM-SAVED-REMIT-TO                 PIC 99.
  6761
  6762     12  AM-COMM-STRUCTURE-SAVED.
  6763         16  AM-DEFN-1-SAVED.
  6764             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6765                 24  AM-AGT-SV             PIC X(10).
  6766                 24  AM-COM-TYP-SV         PIC X.
  6767                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6768                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6769                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6770                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6771                 24  FILLER                PIC X.
  6772                 24  AM-GL-CODES-SV        PIC X.
  6773                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6774                 24  FILLER                PIC X.
  6775         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6776             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 125
* EL050.cbl
  6777                 24  FILLER                PIC X(11).
  6778                 24  AM-L-COMA-SV          PIC XXX.
  6779                 24  AM-J-COMA-SV          PIC XXX.
  6780                 24  AM-A-COMA-SV          PIC XXX.
  6781                 24  FILLER                PIC X(6).
  6782
  6783     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6784         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6785            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6786            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6787            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6788
  6789     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6790     12  FILLER                            PIC X(120).
  6791
  6792     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6793         16  AM-CONTROL-NAME               PIC X(30).
  6794         16  AM-EXECUTIVE-ONE.
  6795             20  AM-EXEC1-NAME             PIC X(15).
  6796             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6797                                                          COMP-3.
  6798             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6799                                                          COMP-3.
  6800         16  AM-EXECUTIVE-TWO.
  6801             20  AM-EXEC2-NAME             PIC X(15).
  6802             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6803                                                          COMP-3.
  6804             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6805                                                          COMP-3.
  6806
  6807     12  AM-RETRO-ADDITIONAL-DATA.
  6808         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6809         16  AM-RETRO-PREM-P-E             PIC X.
  6810         16  AM-RETRO-CLMS-P-I             PIC X.
  6811         16  AM-RETRO-RET-BRACKET-LF.
  6812             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6813                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6814                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6815             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6816                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6817                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6818             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6819                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6820                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6821         16  AM-RETRO-RET-BRACKET-AH.
  6822             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6823                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6824                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6825                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6826             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6827                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6828                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6829             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6830                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6831                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6832
  6833     12  AM-COMMENTS.
  6834         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 126
* EL050.cbl
  6835
  6836     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6837         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6838         16  AM-FLI-BILLING-CODE           PIC X.
  6839         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6840         16  AM-FLI-UNITED-IDENT           PIC X.
  6841         16  AM-FLI-INTEREST-LOST-DATA.
  6842             20  AM-FLI-BANK-NO            PIC X(5).
  6843             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6844             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6845             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6846         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6847             20  AM-FLI-AGT                PIC X(9).
  6848             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6849             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6850         16  FILLER                        PIC X(102).
  6851
  6852     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6853         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6854             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6855             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6856             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6857             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6858             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6859         16  FILLER                          PIC X(10).
  6860******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 127
* EL050.cbl
  6862*    COPY ERCREIN.
  6863******************************************************************
  6864*                                                                *
  6865*                            ERCREIN                             *
  6866*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6867*                            VMOD=2.010                          *
  6868*                                                                *
  6869*   ONLINE CREDIT SYSTEM                                         *
  6870*                                                                *
  6871*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6872*                                                                *
  6873*   FILE TYPE = VSAM,KSDS                                        *
  6874*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6875*                                                                *
  6876*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6877*       ALTERNATE PATH = NONE                                    *
  6878*                                                                *
  6879*   LOG = NO                                                     *
  6880*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6881*                                                                *
  6882******************************************************************
  6883*                   C H A N G E   L O G
  6884*
  6885* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6886*-----------------------------------------------------------------
  6887*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6888* EFFECTIVE    NUMBER
  6889*-----------------------------------------------------------------
  6890* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6891* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6892******************************************************************
  6893 01  REINSURANCE-RECORD.
  6894     12  RE-RECORD-ID                      PIC XX.
  6895         88  VALID-RE-ID                      VALUE 'RE'.
  6896
  6897     12  RE-CONTROL-PRIMARY.
  6898         16  RE-COMPANY-CD                 PIC X.
  6899         16  RE-KEY.
  6900             20  RE-CODE                   PIC X.
  6901                 88  RE-TABLE-RECORD          VALUE 'A'.
  6902                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6903             20  RE-TABLE                  PIC XXX.
  6904             20  FILLER                    PIC XXX.
  6905         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6906             20  FILLER                    PIC X.
  6907             20  RE-COMPANY.
  6908                 24  RE-COMP-PRIME         PIC XXX.
  6909                 24  RE-COMP-SUB           PIC XXX.
  6910
  6911     12  RE-MAINT-INFORMATION.
  6912         16  RE-LAST-MAINT-DT              PIC XX.
  6913         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6914         16  RE-LAST-MAINT-USER            PIC X(4).
  6915         16  FILLER                        PIC X(10).
  6916
  6917     12  RE-TABLE-DATA.
  6918         16  RE-100-COMP                   PIC 99.
  6919
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 128
* EL050.cbl
  6920         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6921             20  RE-REI-COMP-NO.
  6922                 24  RE-REI-COMP           PIC XXX.
  6923                 24  RE-REI-COMP-SUB       PIC XXX.
  6924             20  RE-LF-QC                  PIC X.
  6925             20  RE-AH-QC                  PIC X.
  6926             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6927             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6928             20  RE-LFAGE-LO               PIC 99.
  6929             20  RE-LFAGE-HI               PIC 99.
  6930             20  RE-AHAGE-LO               PIC 99.
  6931             20  RE-AHAGE-HI               PIC 99.
  6932             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6933             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6934             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6935             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6936             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6937             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6938             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6939             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6940             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6941             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6942             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6943             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6944             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6945             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6946             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6947             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6948             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6949             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6950             20  RE-LF-BEN-CODE            PIC X.
  6951             20  RE-AH-BEN-CODE            PIC X.
  6952             20  RE-INTERACTIVE            PIC X.
  6953             20  RE-REMAINING              PIC X.
  6954             20  RE-LF-RUNOFF-SW           PIC X.
  6955             20  RE-AH-RUNOFF-SW           PIC X.
  6956             20  FILLER                    PIC X(19).
  6957
  6958         16  RE-COMP-INFO-END              PIC X(6).
  6959         16  RE-NSP-ST-CD-LF               PIC XX.
  6960         16  RE-NSP-ST-CD-AH               PIC XX.
  6961         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6962             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6963
  6964         16  FILLER                        PIC X(27).
  6965
  6966     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6967         16  RE-NAME                       PIC X(30).
  6968         16  RE-LF-PE                      PIC X.
  6969         16  RE-AH-PE                      PIC X.
  6970         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6971         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6972         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6973         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6974         16  RE-PRT-ST                     PIC X.
  6975         16  RE-PRT-OW                     PIC X.
  6976         16  RE-MORT-CODE                  PIC X(4).
  6977         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 129
* EL050.cbl
  6978         16  RE-ZERO-LF-FEE                PIC X.
  6979         16  RE-ZERO-AH-FEE                PIC X.
  6980         16  RE-CEDE-NAME                  PIC X(30).
  6981         16  RE-LF-COMM                    PIC X.
  6982         16  RE-AH-COMM                    PIC X.
  6983         16  RE-LF-TAX                     PIC X.
  6984         16  RE-AH-TAX                     PIC X.
  6985         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6986         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6987         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6988
  6989         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6990             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6991
  6992         16  RE-LF-CEDING-FEE-BRACKETS.
  6993             20  RE-LF-FEE-METHOD          PIC X.
  6994                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6995                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6996                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6997                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6998             20  RE-LF-FEE-BASIS           PIC X.
  6999                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7000                 88  RE-LF-NET-CEDED               VALUE '2'.
  7001                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7002                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7003                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7004                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7005                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7006                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7007             20  FILLER                    PIC XXX.
  7008             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7009                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7010                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7011
  7012         16  RE-AH-CEDING-FEE-BRACKETS.
  7013             20  RE-AH-FEE-METHOD          PIC X.
  7014                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7015                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7016                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7017                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7018             20  RE-AH-FEE-BASIS           PIC X.
  7019                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7020                 88  RE-AH-NET-CEDED               VALUE '2'.
  7021                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7022                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7023                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7024                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7025                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7026                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7027             20  FILLER                    PIC XXX.
  7028             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7029                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7030                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7031
  7032         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7033
  7034         16  RE-OLD-CEDING-STMT            PIC X.
  7035
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 130
* EL050.cbl
  7036         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7037         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7038         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7039         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7040         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7041         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7042         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7043         16  RE-MORT-SW                    PIC X.
  7044         16  RE-CEDING-TYPE-FLAG           PIC X.
  7045             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7046             88  RE-CEDED                          VALUE 'C'.
  7047             88  RE-ASSUMED                        VALUE 'A'.
  7048             88  RE-PHANTOM                        VALUE 'P'.
  7049
  7050         16  RE-CEDING-STMT-OPT-A          PIC X.
  7051             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7052         16  RE-CEDING-STMT-OPT-B          PIC X.
  7053             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7054         16  RE-CEDING-STMT-OPT-C          PIC X.
  7055             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7056         16  RE-CEDING-STMT-OPT-D          PIC X.
  7057             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7058         16  RE-CEDING-STMT-OPT-E          PIC X.
  7059             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7060
  7061         16  RE-PRT-CRSV                   PIC X.
  7062
  7063         16  RE-GL-CENTER                  PIC X(4).
  7064
  7065         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7066
  7067         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7068
  7069         16  RE-EARN-STOP-CODE             PIC X.
  7070             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7071             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7072
  7073         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7074             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7075
  7076         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7077         16  FILLER                        PIC X(2281).
  7078
  7079         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7080
  7081******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 131
* EL050.cbl
  7083*    COPY ERCCTBL.
  7084******************************************************************
  7085*                                                                *
  7086*                                                                *
  7087*                            ERCCTBL                             *
  7088*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7089*                            VMOD=2.003
  7090*                                                                *
  7091*   ONLINE CREDIT SYSTEM                                         *
  7092*                                                                *
  7093*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7094*                                                                *
  7095*   FILE TYPE = VSAM,KSDS                                        *
  7096*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7097*                                                                *
  7098*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7099*       ALTERNATE PATH = NONE                                    *
  7100*                                                                *
  7101*   LOG = NO                                                     *
  7102*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7103*                                                                *
  7104*                                                                *
  7105******************************************************************
  7106
  7107 01  COMM-TABLE-RECORD.
  7108     12  CT-RECORD-ID                      PIC XX.
  7109         88  VALID-CT-ID                      VALUE 'CT'.
  7110
  7111     12  CT-CONTROL-PRIMARY.
  7112         16  CT-COMPANY-CD                 PIC X.
  7113         16  CT-TABLE                      PIC XXX.
  7114         16  CT-CNTRL-2.
  7115             20  CT-BEN-TYPE               PIC X.
  7116             20  CT-BEN-CODE               PIC XX.
  7117
  7118     12  CT-MAINT-INFORMATION.
  7119         16  CT-LAST-MAINT-DT              PIC XX.
  7120         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7121         16  CT-LAST-MAINT-USER            PIC X(4).
  7122         16  FILLER                        PIC X(31).
  7123
  7124     12  CT-LIMITS.
  7125         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7126
  7127         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7128
  7129         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7130
  7131     12  CT-RATES.
  7132         16  CT-RTX          OCCURS 27 TIMES.
  7133             20  CT-RT                     PIC SV9(5)     COMP-3.
  7134             20  CT-RT-R   REDEFINES
  7135                 CT-RT                     PIC XXX.
  7136
  7137     12  FILLER                            PIC  X(42).
  7138
  7139******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 132
* EL050.cbl
  7141*    COPY ERCFORM.
  7142******************************************************************
  7143*                                                                *
  7144*                                                                *
  7145*                            ERCFORM.                            *
  7146*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7147*                            VMOD=2.003                          *
  7148*                                                                *
  7149*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7150*                                                                *
  7151*    FILE TYPE = VSAM,KSDS                                       *
  7152*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7153*                                                                *
  7154*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7155*                                                                *
  7156*    LOG = YES                                                   *
  7157*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7158******************************************************************
  7159 01  FORM-MASTER.
  7160    12  FO-RECORD-ID                 PIC X(02).
  7161        88  VALID-FO-ID                  VALUE 'FO'.
  7162
  7163    12  FO-CONTROL-PRIMARY.
  7164        16  FO-COMPANY-CD            PIC X(01).
  7165        16  FO-STATE                 PIC X(02).
  7166        16  FO-FORM-ID               PIC X(12).
  7167        16  FO-FORM-EXP-DT           PIC X(02).
  7168
  7169    12  FO-POLICY-FORM-DATA.
  7170        16  FO-IND-GRP-CD            PIC X(01).
  7171        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7172        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7173        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7174        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7175        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7176        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7177        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7178        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7179        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7180        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7181        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7182        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7183        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7184        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7185        16  FO-APP-CERT-USE-CD       PIC X(01).
  7186
  7187    12  FILLER                       PIC X(29).
  7188
  7189    12  FO-FORM-PLAN-TABLE.
  7190        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7191            20  FO-PLAN-TYPE         PIC X(01).
  7192            20  FO-PLAN-ID           PIC X(02).
  7193            20  FO-PLAN-TERM         PIC 9(03).
  7194            20  FO-PLAN-REFUND-METHOD
  7195                                     PIC X.
  7196
  7197    12  FILLER                       PIC X(30).
  7198
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 133
* EL050.cbl
  7199    12  FO-COMMENTS-AREA.
  7200        16  FO-COMMENT-LINE-1        PIC X(78).
  7201
  7202    12  FILLER                       PIC X(20).
  7203
  7204    12  FO-MAINT-INFORMATION.
  7205        16  FO-LAST-MAINT-DT         PIC X(02).
  7206        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7207        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 134
* EL050.cbl
  7209*    COPY ELCMSTR.
  7210******************************************************************
  7211*                                                                *
  7212*                            ELCMSTR.                            *
  7213*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7214*                            VMOD=2.012                          *
  7215*                                                                *
  7216*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7217*                                                                *
  7218*   FILE TYPE = VSAM,KSDS                                        *
  7219*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7220*                                                                *
  7221*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7222*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7223*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7224*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7225*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7226*                                                 RKP=75,LEN=21  *
  7227*                                                                *
  7228*   **** NOTE ****                                               *
  7229*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7230*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7231*                                                                *
  7232*   LOG = YES                                                    *
  7233*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7234******************************************************************
  7235*                   C H A N G E   L O G
  7236*
  7237* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7238*-----------------------------------------------------------------
  7239*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7240* EFFECTIVE    NUMBER
  7241*-----------------------------------------------------------------
  7242* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7243* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7244******************************************************************
  7245 01  CLAIM-MASTER.
  7246     12  CL-RECORD-ID                PIC XX.
  7247         88  VALID-CL-ID         VALUE 'CL'.
  7248
  7249     12  CL-CONTROL-PRIMARY.
  7250         16  CL-COMPANY-CD           PIC X.
  7251         16  CL-CARRIER              PIC X.
  7252         16  CL-CLAIM-NO             PIC X(7).
  7253         16  CL-CERT-NO.
  7254             20  CL-CERT-PRIME       PIC X(10).
  7255             20  CL-CERT-SFX         PIC X.
  7256
  7257     12  CL-CONTROL-BY-NAME.
  7258         16  CL-COMPANY-CD-A1        PIC X.
  7259         16  CL-INSURED-LAST-NAME    PIC X(15).
  7260         16  CL-INSURED-NAME.
  7261             20  CL-INSURED-1ST-NAME PIC X(12).
  7262             20  CL-INSURED-MID-INIT PIC X.
  7263
  7264     12  CL-CONTROL-BY-SSN.
  7265         16  CL-COMPANY-CD-A2        PIC X.
  7266         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 135
* EL050.cbl
  7267             20  CL-SSN-STATE        PIC XX.
  7268             20  CL-SSN-ACCOUNT      PIC X(6).
  7269             20  CL-SSN-LN3          PIC X(3).
  7270
  7271     12  CL-CONTROL-BY-CERT-NO.
  7272         16  CL-COMPANY-CD-A4        PIC X.
  7273         16  CL-CERT-NO-A4.
  7274             20  CL-CERT-A4-PRIME    PIC X(10).
  7275             20  CL-CERT-A4-SFX      PIC X.
  7276
  7277     12  CL-CONTROL-BY-CCN.
  7278         16  CL-COMPANY-CD-A5        PIC X.
  7279         16  CL-CCN-A5.
  7280             20  CL-CCN.
  7281                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7282                 24  CL-CCN-PRIME-A5 PIC X(12).
  7283             20  CL-CCN-FILLER-A5    PIC X(4).
  7284
  7285     12  CL-INSURED-PROFILE-DATA.
  7286         16  CL-INSURED-BIRTH-DT     PIC XX.
  7287         16  CL-INSURED-SEX-CD       PIC X.
  7288             88  INSURED-IS-MALE        VALUE 'M'.
  7289             88  INSURED-IS-FEMALE      VALUE 'F'.
  7290             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7291         16  CL-INSURED-OCC-CD       PIC X(6).
  7292         16  FILLER                  PIC X(5).
  7293
  7294     12  CL-PROCESSING-INFO.
  7295         16  CL-PROCESSOR-ID         PIC X(4).
  7296         16  CL-CLAIM-STATUS         PIC X.
  7297             88  CLAIM-IS-OPEN          VALUE 'O'.
  7298             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7299         16  CL-CLAIM-TYPE           PIC X.
  7300*            88  AH-CLAIM               VALUE 'A'.
  7301*            88  LIFE-CLAIM             VALUE 'L'.
  7302*            88  PROPERTY-CLAIM         VALUE 'P'.
  7303*            88  IUI-CLAIM              VALUE 'I'.
  7304*            88  GAP-CLAIM              VALUE 'G'.
  7305         16  CL-CLAIM-PREM-TYPE      PIC X.
  7306             88  SINGLE-PREMIUM         VALUE '1'.
  7307             88  O-B-COVERAGE           VALUE '2'.
  7308             88  OPEN-END-COVERAGE      VALUE '3'.
  7309         16  CL-INCURRED-DT          PIC XX.
  7310         16  CL-REPORTED-DT          PIC XX.
  7311         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7312         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7313         16  CL-LAST-PMT-DT          PIC XX.
  7314         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7315         16  CL-PAID-THRU-DT         PIC XX.
  7316         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7317         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7318         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7319         16  CL-PMT-CALC-METHOD      PIC X.
  7320             88  CL-360-DAY-YR          VALUE '1'.
  7321             88  CL-365-DAY-YR          VALUE '2'.
  7322             88  CL-FULL-MONTHS         VALUE '3'.
  7323         16  CL-CAUSE-CD             PIC X(6).
  7324
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 136
* EL050.cbl
  7325         16  CL-PRIME-CERT-NO.
  7326             20  CL-PRIME-CERT-PRIME PIC X(10).
  7327             20  CL-PRIME-CERT-SFX   PIC X.
  7328
  7329         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7330             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7331             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7332
  7333         16  CL-MICROFILM-NO         PIC X(10).
  7334         16  CL-PROG-FORM-TYPE       PIC X.
  7335         16  CL-LAST-ADD-ON-DT       PIC XX.
  7336
  7337         16  CL-LAST-REOPEN-DT       PIC XX.
  7338         16  CL-LAST-CLOSE-DT        PIC XX.
  7339         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7340             88  FINAL-PAID             VALUE '1'.
  7341             88  CLAIM-DENIED           VALUE '2'.
  7342             88  AUTO-CLOSE             VALUE '3'.
  7343             88  MANUAL-CLOSE           VALUE '4'.
  7344             88  BENEFITS-CHANGED       VALUE 'C'.
  7345             88  SETUP-ERRORS           VALUE 'E'.
  7346         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7347         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7348         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7349             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7350         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7351         16  FILLER                  PIC X.
  7352
  7353     12  CL-CERTIFICATE-DATA.
  7354         16  CL-CERT-ORIGIN          PIC X.
  7355             88  CERT-WAS-ONLINE        VALUE '1'.
  7356             88  CERT-WAS-CREATED       VALUE '2'.
  7357             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7358         16  CL-CERT-KEY-DATA.
  7359             20  CL-CERT-CARRIER     PIC X.
  7360             20  CL-CERT-GROUPING    PIC X(6).
  7361             20  CL-CERT-STATE       PIC XX.
  7362             20  CL-CERT-ACCOUNT.
  7363                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7364                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7365             20  CL-CERT-EFF-DT      PIC XX.
  7366
  7367     12  CL-STATUS-CONTROLS.
  7368         16  CL-PRIORITY-CD          PIC X.
  7369             88  CONFIDENTIAL-DATA      VALUE '8'.
  7370             88  HIGHEST-PRIORITY       VALUE '9'.
  7371         16  CL-SUPV-ATTN-CD         PIC X.
  7372             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7373             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7374         16  CL-PURGED-DT            PIC XX.
  7375         16  CL-RESTORED-DT          PIC XX.
  7376         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7377         16  CL-NEXT-RESEND-DT       PIC XX.
  7378         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7379         16  FILLER                  PIC XX.
  7380         16  CL-LAST-MAINT-DT        PIC XX.
  7381         16  CL-LAST-MAINT-USER      PIC X(4).
  7382         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 137
* EL050.cbl
  7383         16  CL-LAST-MAINT-TYPE      PIC X.
  7384             88  CLAIM-SET-UP           VALUE ' '.
  7385             88  PAYMENT-MADE           VALUE '1'.
  7386             88  LETTER-SENT            VALUE '2'.
  7387             88  MASTER-WAS-ALTERED     VALUE '3'.
  7388             88  MASTER-WAS-RESTORED    VALUE '4'.
  7389             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7390             88  FILE-CONVERTED         VALUE '6'.
  7391             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7392             88  ERROR-CORRECTION       VALUE 'E'.
  7393         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7394         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7395         16  CL-BENEFICIARY          PIC X(10).
  7396         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7397         16  CL-DENIAL-TYPE          PIC X.
  7398             88  CL-TYPE-DENIAL          VALUE '1'.
  7399             88  CL-TYPE-RESCISSION      VALUE '2'.
  7400             88  CL-TYPE-REFORMATION     VALUE '3'.
  7401             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7402             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7403         16  FILLER                  PIC X(5).
  7404
  7405     12  CL-TRAILER-CONTROLS.
  7406         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7407             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7408             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7409             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7410         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7411         16  FILLER                  PIC XX.
  7412         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7413         16  CL-ADDRESS-TRAILER-CNT.
  7414             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7415                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7416             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7417                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7418             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7419                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7420             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7421                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7422             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7423                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7424             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7425                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7426             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7427                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7428
  7429     12  CL-CV-REFERENCE-NO.
  7430         16  CL-CV-REFNO-PRIME       PIC X(18).
  7431         16  CL-CV-REFNO-SFX         PIC XX.
  7432
  7433     12  CL-FILE-LOCATION            PIC X(4).
  7434
  7435     12  CL-PROCESS-ERRORS.
  7436         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7437             88  NO-FATAL-ERRORS        VALUE ZERO.
  7438         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7439             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7440
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 138
* EL050.cbl
  7441     12  CL-PRODUCT-CD               PIC X.
  7442
  7443     12  CL-CURRENT-KEY-DATA.
  7444         16  CL-CURRENT-CARRIER      PIC X.
  7445         16  CL-CURRENT-GROUPING     PIC X(6).
  7446         16  CL-CURRENT-STATE        PIC XX.
  7447         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7448
  7449     12  CL-ASSOCIATES               PIC X.
  7450         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7451         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7452         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7453         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7454
  7455     12  CL-ACTIVITY-CODE            PIC 99.
  7456     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7457     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7458
  7459     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7460     12  CL-LAG-REPORT-CODE          PIC 9.
  7461     12  CL-LOAN-TYPE                PIC XX.
  7462     12  CL-LEGAL-STATE              PIC XX.
  7463
  7464*    12  FILLER                      PIC X(5).
  7465     12  CL-YESNOSW                  PIC X.
  7466     12  FILLER                      PIC X(4).
  7467
  7468 01  PLAN-RECORDS.
  7469     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7470     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7471
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 139
* EL050.cbl
  7473 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7474                          ACCOUNT-MASTER REINSURANCE-RECORD
  7475                          COMM-TABLE-RECORD FORM-MASTER
  7476                          CLAIM-MASTER PLAN-RECORDS.
  7477 0000-DFHEXIT SECTION.
  7478     MOVE '9#                    $   ' TO DFHEIV0.
  7479     MOVE 'EL050' TO DFHEIV1.
  7480     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7481
  7482     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7483
  7484
  7485* EXEC CICS  HANDLE CONDITION
  7486*           ERROR    (9300-ABEND)
  7487*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7488*    END-EXEC.
  7489*    MOVE '"$.J                  ! " #00007480' TO DFHEIV0
  7490     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7491     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7492     MOVE X'2220233030303037343830' TO DFHEIV0(25:11)
  7493     CALL 'kxdfhei1' USING DFHEIV0
  7494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7495
  7496
  7497 0000-COPY-PROCEDURE-DIV.
  7498*                          COPY ELC50PD.
  7499******************************************************************
  7500*                                                                *
  7501*                            ELC50PD                             *
  7502*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7503*                            VMOD=2.188                          *
  7504*                                                                *
  7505******************************************************************
  7506*                   C H A N G E   L O G
  7507*
  7508* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7509*-----------------------------------------------------------------
  7510*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7511* EFFECTIVE    NUMBER
  7512*-----------------------------------------------------------------
  7513* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7514* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7515* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7516*                             2709 AND 2718
  7517* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7518* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7519* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7520* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7521* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7522*                                IS OPEN OR CNC DT < PD THRU
  7523* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7524* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7525* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7526* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7527* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7528* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7529* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7530* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 140
* EL050.cbl
  7531* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7532* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7533* 020906                   PEMA  EXPAND LOAN OFFICER
  7534* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7535* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7536* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7537* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7538* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7539* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7540* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7541* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7542* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7543* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7544* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7545* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7546* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7547* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7548* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7549* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7550* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7551* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7552* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7553* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7554* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7555* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7556* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7557* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7558* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7559*                                UPDATE VIN ON CERT TRAILER
  7560* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7561* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7562* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7563* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7564* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7565* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7566* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7567* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7568* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7569* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7570* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7571* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7572* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7573* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7574* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7575* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7576* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7577* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7578* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7579* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7580* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7581* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7582* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7583* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7584* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7585* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7586* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7587* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7588* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 141
* EL050.cbl
  7589* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7590* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7591* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7592* 032912  CR2011110200001  PEMA  AHL CHANGES
  7593* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7594* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7595* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7596* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7597* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7598* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7599* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7600* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7601* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7602******************************************************************
  7603************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7604******************************************************************
  7605
  7606     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7607
  7608     MOVE SPACES                 TO PB-FATAL-FLAG
  7609                                    PB-FORCE-ER-CD
  7610                                    PB-WARN-ER-CD
  7611                                    PB-OUT-BAL-CD.
  7612
  7613     MOVE SPACE                  TO WS-IG-OVRD-AH
  7614                                    WS-IG-OVRD-LF
  7615                                    WS-IG-OVRD-AM
  7616                                    WS-IG-OVRD
  7617                                    WS-IG-OVRD-AH-PL
  7618                                    WS-IG-OVRD-LF-PL
  7619                                    WS-IG-OVRD-AH-BEN
  7620                                    WS-IG-OVRD-LF-BEN.
  7621
  7622******************************************************************
  7623*************       INITIALIZE COMMON ERRORS       ***************
  7624******************************************************************
  7625
  7626     MOVE +0                     TO PB-NO-OF-ERRORS.
  7627     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7628
  7629******************************************************************
  7630
  7631     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7632     SET JULIAN-TO-BIN           TO TRUE.
  7633*    MOVE 5                      TO DC-OPTION-CODE.
  7634     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7635     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7636
  7637     MOVE ZERO                   TO  SUB4.
  7638
  7639 0040-INITIALIZE-GA-BILL-DT.
  7640
  7641     ADD +1                      TO  SUB4.
  7642
  7643     IF  SUB4 GREATER THAN +5
  7644         GO TO 0050-CHECK-CNTL-FOUND.
  7645
  7646     IF  PB-GA-BILL-DT (SUB4) = SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 142
* EL050.cbl
  7647         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7648
  7649     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7650
  7651 0050-CHECK-CNTL-FOUND.
  7652
  7653     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7654        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7655                                         WS-AH-REM-TERM-CALC
  7656                                         EC-CO-REM-TERM-CALC
  7657        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7658        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7659        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7660                                         WS-TOL-AH-CLAIM
  7661        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7662                                         WS-TOL-AH-PREM
  7663                                         EC-CO-TOL-PREM
  7664        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7665                                         WS-TOL-AH-REFUND
  7666                                         EC-CO-TOL-REFUND
  7667        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7668                                         WS-AH-REFUND-OVS-AMT
  7669                                         EC-CO-OVR-SHT-AMT
  7670        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7671                                         WS-TOL-AH-PREM-PCT
  7672                                         EC-CO-TOL-PREM-PCT
  7673        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7674                                         WS-TOL-AH-REFUND-PCT
  7675                                         EC-CO-TOL-REFUND-PCT
  7676        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7677                                         WS-AH-REFUND-OVS-PCT
  7678                                         EC-CO-OVR-SHT-PCT
  7679        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7680        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7681        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7682        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7683        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7684        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7685        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7686        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7687        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7688        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7689        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7690        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7691                                         EC-CO-MONTH-END-DT
  7692        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7693          GO TO 0100-READ-ACCT.
  7694
  7695     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7696     MOVE SPACES                 TO CNTL-ACCESS.
  7697     MOVE '1'                    TO CNTL-REC-TYPE.
  7698     MOVE +0                     TO CNTL-SEQ-NO.
  7699
  7700     MOVE '1' TO RC-SW-1.
  7701     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7702     IF NOT CF-COMPANY-MASTER
  7703         MOVE ZEROS             TO WK-CO-TOL-PREM
  7704                                   WK-CO-TOL-CLAIM
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 143
* EL050.cbl
  7705                                   WK-CO-TOL-REFUND
  7706                                   WK-REFUND-OVS-AMT
  7707                                   WK-REFUND-OVS-PCT
  7708                                   WK-CO-TOL-PREM-PCT
  7709                                   WK-CO-TOL-REFUND-PCT
  7710                                   WK-DEFAULT-APR
  7711                                   WK-CO-MAX-CAP
  7712        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7713                                   WK-CR-R78-METHOD
  7714                                   WK-CO-REF-REJECT-SW
  7715                                   WK-CO-PREM-REJECT-SW
  7716                                   WK-REM-TRM-CALC-OPTION
  7717                                   WK-BIRTH-DATE-INPUT
  7718                                   WK-JOINT-AGE-INPUT
  7719        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7720        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7721        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7722        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7723          GO TO 0099-COMPANY-NOT-FOUND.
  7724
  7725     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7726        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7727     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7728        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7729     IF CF-CO-TOL-CAP NOT NUMERIC
  7730        MOVE +0                    TO CF-CO-TOL-CAP.
  7731     IF CF-DEFAULT-APR NOT NUMERIC
  7732        MOVE +0                    TO CF-DEFAULT-APR.
  7733
  7734     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7735     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7736     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7737     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7738     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7739     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7740     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7741     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7742     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7743     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7744     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7745     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7746
  7747     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7748          CF-CO-OVR-SHT-AMT > +0
  7749        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7750
  7751     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7752          CF-CO-OVR-SHT-PCT > +0
  7753        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7754
  7755     IF CF-VALID-REM-TRM-OPTION
  7756         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7757     ELSE
  7758         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7759
  7760     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7761     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7762     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 144
* EL050.cbl
  7763     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7764
  7765     GO TO 0050-CHECK-CNTL-FOUND.
  7766
  7767 0099-COMPANY-NOT-FOUND.
  7768
  7769     MOVE ER-2616                TO WS-ERROR.
  7770     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7771
  7772 0100-READ-ACCT.
  7773
  7774     MOVE SPACES                 TO DATE-RANGE-SW.
  7775
  7776     IF WK-ACCT-ADDR = ZEROS
  7777        GO TO 0102-ACCT-GETMAIN.
  7778
  7779     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7780     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7781     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7782
  7783     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7784        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7785        GO TO 0105-READ-ACCT
  7786     END-IF
  7787
  7788     IF PB-CARRIER NOT = SPACES
  7789        IF PB-CARRIER NOT = AM-VG-CARRIER
  7790           GO TO 0105-READ-ACCT.
  7791
  7792     IF PB-STATE NOT = SPACES
  7793        IF PB-STATE NOT = AM-VG-STATE
  7794           GO TO 0105-READ-ACCT.
  7795
  7796     IF PB-GROUPING NOT = SPACES
  7797        IF PB-GROUPING NOT = AM-VG-GROUPING
  7798           GO TO 0105-READ-ACCT.
  7799
  7800     MOVE 'X'                 TO DATE-RANGE-SW.
  7801
  7802     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7803        MOVE 'X'                 TO DATE-RANGE-SW
  7804        GO TO 0105-READ-ACCT.
  7805
  7806     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7807        GO TO 0105-READ-ACCT.
  7808
  7809     GO TO 0180-ACCOUNT-FOUND.
  7810
  7811 0102-ACCT-GETMAIN.
  7812     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7813     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7814
  7815 0105-READ-ACCT.
  7816     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7817     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7818     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7819     MOVE PB-STATE               TO ACCT-STATE.
  7820     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 145
* EL050.cbl
  7821     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7822
  7823     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7824
  7825     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7826
  7827 0110-FIND-ACCT-TOLERANCES-LOOP.
  7828     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7829
  7830     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7831        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7832        GO TO 0199-ACCT-NOT-FOUND
  7833     END-IF
  7834     IF PB-CARRIER NOT = SPACES
  7835        IF PB-CARRIER NOT = AM-VG-CARRIER
  7836           GO TO 0199-ACCT-NOT-FOUND.
  7837
  7838     IF PB-STATE NOT = SPACES
  7839        IF PB-STATE NOT = AM-VG-STATE
  7840           GO TO 0199-ACCT-NOT-FOUND.
  7841
  7842     IF PB-GROUPING NOT = SPACES
  7843        IF PB-GROUPING NOT = AM-VG-GROUPING
  7844           GO TO 0199-ACCT-NOT-FOUND.
  7845
  7846     MOVE 'X'                    TO DATE-RANGE-SW.
  7847
  7848     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7849        MOVE 'X'                 TO DATE-RANGE-SW
  7850        GO TO 0199-ACCT-NOT-FOUND.
  7851
  7852     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7853        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7854
  7855 0180-ACCOUNT-FOUND.
  7856     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7857     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7858     MOVE AM-STATE               TO PB-SV-STATE.
  7859     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7860
  7861     IF AM-CANCEL-FEE  NOT NUMERIC
  7862        MOVE ZEROS TO AM-CANCEL-FEE.
  7863
  7864     IF AM-MAX-MON-BEN NOT NUMERIC
  7865        MOVE ZEROS TO AM-MAX-MON-BEN.
  7866
  7867     IF AM-MAX-TOT-BEN NOT NUMERIC
  7868        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7869
  7870     IF AM-CLP-TOL-PCT NOT NUMERIC
  7871        MOVE +0                  TO AM-CLP-TOL-PCT
  7872     END-IF
  7873     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7874        MOVE +0                  TO AM-SPP-LEASE-COMM
  7875     END-IF
  7876     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7877        MOVE ER-2611             TO   WS-ERROR
  7878        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 146
* EL050.cbl
  7879
  7880     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7881        MOVE ER-2621             TO   WS-ERROR
  7882        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7883
  7884     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7885        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7886        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7887        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7888         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7889
  7890     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7891     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7892     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7893     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7894     IF AM-CLP-TOL-PCT NOT = ZEROS
  7895        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7896     END-IF
  7897     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7898        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7899     END-IF
  7900*    IF PB-COMPANY-ID = 'DCC'
  7901*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7902*                                   WS-ADMIN-FEES
  7903*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7904*          (SUB5 > +10)
  7905*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7906*             AND (AM-A-COM (SUB5) NUMERIC)
  7907*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7908*                + (AM-A-COM (SUB5) * 1000)
  7909*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7910*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7911*                + (AM-A-COM (SUB5) * 1000)
  7912*             END-IF
  7913*             IF AM-COM-TYP (SUB5) = 'N'
  7914*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7915*                + (AM-A-COM (SUB5) * 1000)
  7916*             END-IF
  7917*          END-IF
  7918*       END-PERFORM
  7919*    END-IF
  7920     IF (PB-COMPANY-ID = 'DCC')
  7921        AND (PB-ISSUE)
  7922        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7923        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7924           (SUB5 > +10)
  7925           MOVE +0 TO WS-WK-RATE
  7926           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7927              IF (AM-A-COM (SUB5) NUMERIC)
  7928                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7929                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7930              ELSE
  7931                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7932                 IF PB-ISSUE
  7933                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7934                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7935                 ELSE
  7936                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 147
* EL050.cbl
  7937                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7938                 END-IF
  7939                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7940                 MOVE ZEROS             TO WS-SUB1
  7941                                           WS-COMMISSION
  7942                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7943                 MOVE '0530'               TO CTBL-SW
  7944                 MOVE ' '                  TO WS-CTBL-READ-SW
  7945                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7946                 IF FIRST-TIME-THROUGH
  7947                    MOVE 'AA'              TO CTBL-BEN-CODE
  7948                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7949                 END-IF
  7950                 IF CTBL-TABLE-FOUND
  7951                    IF PB-ISSUE
  7952                       COMPUTE WS-COMM-CK-AMT =
  7953                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7954                    ELSE
  7955                       COMPUTE WS-COMM-CK-AMT =
  7956                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7957                    END-IF
  7958                    PERFORM 8800-GET-COMP-RATE
  7959                              THRU 8800-EXIT
  7960                 END-IF
  7961              END-IF
  7962              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7963                + (WS-WK-RATE * 1000)
  7964           END-IF
  7965        END-PERFORM
  7966     END-IF
  7967     IF PB-COMPANY-ID EQUAL 'CRI'
  7968         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7969
  7970     IF PB-COMPANY-ID EQUAL 'NCL'
  7971         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7972     END-IF
  7973
  7974     GO TO 0200-READ-CERT.
  7975
  7976 0199-ACCT-NOT-FOUND.
  7977
  7978     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7979
  7980     IF DATE-RANGE-SW NOT = SPACES
  7981        MOVE ER-2601             TO WS-ERROR
  7982        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7983     ELSE
  7984        MOVE ER-2619             TO WS-ERROR
  7985        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7986
  7987     GO TO 9990-RETURN.
  7988
  7989 0200-READ-CERT.
  7990
  7991     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  7992     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7993     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7994     MOVE PB-SV-STATE            TO CERT-STATE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 148
* EL050.cbl
  7995     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  7996     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  7997     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  7998
  7999     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8000
  8001     IF CERT-WAS-NOT-FOUND
  8002        GO TO 0299-CERT-NOT-FOUND.
  8003
  8004     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8005        MOVE ER-2759             TO WS-ERROR
  8006        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8007        GO TO 0298-UNLOCK-RETURN.
  8008
  8009     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8010         MOVE ER-2758            TO WS-ERROR
  8011         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8012         GO TO 0298-UNLOCK-RETURN.
  8013
  8014     IF PB-ISSUE
  8015        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8016           IF CERT-WAS-CREATED-FOR-CLAIM
  8017              NEXT SENTENCE
  8018            ELSE
  8019              MOVE ER-2626       TO WS-ERROR
  8020              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8021              GO TO 0298-UNLOCK-RETURN.
  8022
  8023     IF NOT PB-CANCELLATION
  8024        GO TO 0300-CONTINUE-EDIT.
  8025
  8026     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8027     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8028     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8029     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8030     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8031     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8032
  8033     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8034     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8035     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8036     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8037     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8038     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8039     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8040     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8041     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8042
  8043     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8044     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8045     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8046     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8047     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8048     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8049     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8050
  8051     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8052     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 149
* EL050.cbl
  8053
  8054     MOVE CM-CREDIT-INTERFACE-SW-1
  8055                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8056     MOVE CM-CREDIT-INTERFACE-SW-2
  8057                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8058
  8059     IF CM-O-B-COVERAGE
  8060         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8061
  8062     IF CM-LIVES NOT NUMERIC
  8063         MOVE ZERO                TO CM-LIVES.
  8064
  8065     IF CM-BILLED NOT NUMERIC
  8066         MOVE ZERO                TO CM-BILLED.
  8067
  8068     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8069         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8070         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8071         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8072         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8073         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8074         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8075         MOVE CM-LIVES             TO PB-CI-LIVES
  8076*The next line causes a problem with my change  I dont think it is
  8077*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8078
  8079     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8080     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8081     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8082     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8083     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8084     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8085
  8086     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8087     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8088     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8089     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8090
  8091     IF CM-LIFE-COMM-PCT NUMERIC
  8092         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8093     ELSE
  8094         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8095
  8096     IF CM-AH-COMM-PCT NUMERIC
  8097         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8098     ELSE
  8099         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8100
  8101     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8102
  8103     IF CM-LOAN-APR       NOT NUMERIC
  8104           MOVE ZERO               TO CM-LOAN-APR.
  8105
  8106     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8107           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8108
  8109     IF CM-LOAN-TERM      NOT NUMERIC
  8110           MOVE ZERO               TO CM-LOAN-TERM.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 150
* EL050.cbl
  8111
  8112     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8113           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8114
  8115     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8116           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8117
  8118     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8119     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8120     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8121     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8122     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8123     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8124     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8125     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8126     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8127     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8128     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8129     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8130
  8131     IF CM-STATE = CM-SSN-STATE
  8132         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8133
  8134     IF CM-STATE NOT = CM-MEMB-STATE
  8135         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8136
  8137     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8138
  8139     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8140        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8141        IF CM-ADDL-CLP NOT NUMERIC
  8142           MOVE +0               TO CM-ADDL-CLP
  8143        END-IF
  8144        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8145        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8146           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8147        END-IF
  8148     END-IF
  8149     IF PB-COMPANY-ID = 'DCC'
  8150        MOVE +0                  TO WS-ADMIN-FEES
  8151                                    WS-CSO-ADMIN-FEE
  8152                                    WS-COMM-AND-MFEE
  8153                                    WS-1ST-YR-ALLOW
  8154        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8155           (SUB5 > +10)
  8156           MOVE +0 TO WS-WK-RATE
  8157           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8158              IF (AM-A-COM (SUB5) NUMERIC)
  8159                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8160                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8161              ELSE
  8162                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8163                 IF PB-ISSUE
  8164                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8165                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8166                 ELSE
  8167                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8168                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 151
* EL050.cbl
  8169                 END-IF
  8170                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8171                 MOVE ZEROS             TO WS-SUB1
  8172                                           WS-COMMISSION
  8173                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8174                 MOVE '0530'               TO CTBL-SW
  8175                 MOVE ' '                  TO WS-CTBL-READ-SW
  8176                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8177                 IF FIRST-TIME-THROUGH
  8178                    MOVE 'AA'              TO CTBL-BEN-CODE
  8179                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8180                 END-IF
  8181                 IF CTBL-TABLE-FOUND
  8182                    IF PB-ISSUE
  8183                       COMPUTE WS-COMM-CK-AMT =
  8184                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8185                    ELSE
  8186                       COMPUTE WS-COMM-CK-AMT =
  8187                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8188                    END-IF
  8189                    PERFORM 8800-GET-COMP-RATE
  8190                              THRU 8800-EXIT
  8191                 END-IF
  8192              END-IF
  8193              IF AM-COM-TYP (SUB5) = 'I'
  8194                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8195                   + (WS-WK-RATE * 1000)
  8196              END-IF
  8197              IF AM-COM-TYP (SUB5) = 'N'
  8198                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8199                   + (WS-WK-RATE * 1000)
  8200              END-IF
  8201              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8202                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8203                   + (WS-WK-RATE * 1000)
  8204              END-IF
  8205              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8206                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8207                   + (WS-WK-RATE * 1000)
  8208              END-IF
  8209           END-IF
  8210        END-PERFORM
  8211     END-IF
  8212     GO TO 0300-CONTINUE-EDIT.
  8213
  8214 0298-UNLOCK-RETURN.
  8215      PERFORM 9250-UNLOCK-RETURN
  8216      GO TO 9990-RETURN.
  8217
  8218 0299-CERT-NOT-FOUND.
  8219
  8220     MOVE '1'                     TO CERT-STATUS-SW.
  8221
  8222     IF PB-COMPANY-ID = 'UCL'
  8223         IF WS-ERROR = ER-2799
  8224             GO TO 3000-CONTINUE-EDIT.
  8225
  8226     IF NOT PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 152
* EL050.cbl
  8227         GO TO 0300-CONTINUE-EDIT.
  8228
  8229     MOVE ER-2726                  TO  WS-ERROR.
  8230     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8231     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8232     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8233                                    PB-CI-LF-TERM
  8234                                    PB-C-LF-REM-TERM
  8235                                    PB-CI-AH-TERM
  8236                                    PB-C-AH-REM-TERM
  8237                                    PB-CI-LF-BENEFIT-CD
  8238                                    PB-CI-LF-BENEFIT-AMT
  8239                                    PB-CI-LF-ALT-BENEFIT-AMT
  8240                                    PB-CI-LF-PREMIUM-AMT
  8241                                    PB-CI-LF-ALT-PREMIUM-AMT
  8242                                    PB-CI-AH-BENEFIT-CD
  8243                                    PB-CI-AH-BENEFIT-AMT
  8244                                    PB-CI-AH-PREMIUM-AMT
  8245                                    PB-CI-PAY-FREQUENCY
  8246                                    PB-CI-LOAN-APR
  8247                                    PB-CI-LOAN-TERM
  8248                                    PB-CI-LIFE-COMMISSION
  8249                                    PB-CI-AH-COMMISSION
  8250                                    PB-CI-CURR-SEQ
  8251                                    PB-CI-AH-CANCEL-AMT
  8252                                    PB-CI-LF-CANCEL-AMT
  8253                                    PB-CI-RATE-DEV-PCT-LF
  8254                                    PB-CI-RATE-DEV-PCT-AH
  8255                                    PB-CI-EXTENTION-DAYS
  8256                                    PB-CI-TERM-IN-DAYS
  8257                                    PB-CI-LIVES
  8258                                    PB-CI-LF-CRIT-PER
  8259                                    PB-CI-AH-CRIT-PER
  8260                                    PB-CI-ADDL-CLP
  8261                                    PB-CI-DDF-IU-RATE-UP.
  8262
  8263     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8264                                    PB-CI-AH-SETTLEMENT-DT
  8265                                    PB-CI-DEATH-DT
  8266                                    PB-CI-LF-PRIOR-CANCEL-DT
  8267                                    PB-CI-AH-PRIOR-CANCEL-DT
  8268                                    PB-CI-ENTRY-DT
  8269                                    PB-CI-LF-EXPIRE-DT
  8270                                    PB-CI-AH-EXPIRE-DT
  8271                                    PB-CI-LOAN-1ST-PMT-DT.
  8272
  8273     IF ACCOUNT-MAST-FOUND
  8274        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8275        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8276
  8277     GO TO 3000-CONTINUE-EDIT.
  8278
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 153
* EL050.cbl
  8280
  8281 0300-CONTINUE-EDIT.
  8282
  8283     IF PB-ISSUE
  8284        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8285            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8286
  8287     IF PB-ISSUE
  8288        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8289            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8290
  8291     IF PB-ISSUE
  8292       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8293          (AM-NO-AH-ONLY)
  8294           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8295               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8296                   MOVE ER-2679 TO WS-ERROR
  8297                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8298
  8299     IF PB-ISSUE
  8300        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8301        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8302        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8303     ELSE
  8304        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8305        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8306        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8307
  8308     MOVE 'N'                    TO PLAN-MASTER-SW
  8309                                    PLAN-MASTER-LIFE-SW
  8310                                    FORM-MASTER-SW
  8311                                    WS-APP-CERT-SW.
  8312
  8313     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8314                                    WS-PL-TOL-LF-REFUND
  8315                                    WS-PL-REF-OVS-AMT
  8316                                    WS-PL-TOL-LF-PREM-PCT
  8317                                    WS-PL-TOL-LF-REFUND-PCT
  8318                                    WS-PL-REF-OVS-PCT
  8319                                    WS-PL-TOL-LF-CLAIM.
  8320
  8321     IF PB-COMPANY-ID = 'NCL'
  8322       IF PB-ISSUE
  8323         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8324             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8325             IF FORM-MASTER-FOUND
  8326                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8327
  8328     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8329        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8330
  8331********************** MON CODE **********************
  8332     IF PB-COMPANY-ID = 'MON'
  8333     IF PB-ISSUE
  8334     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8335        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8336             PB-I-LOAN-APR = ZERO)
  8337               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 154
* EL050.cbl
  8338******************************************************
  8339
  8340     IF PB-COMPANY-ID = 'NCL'
  8341       IF PB-ISSUE
  8342           IF FORM-MASTER-FOUND
  8343             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8344                AM-DISMBR-COVERAGE
  8345                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8346                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8347                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8348                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8349                                           PB-I-LIFE-BENEFIT-CD.
  8350
  8351     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8352
  8353     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8354         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8355         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8356         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8357         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8358         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8359           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8360             GO TO 0301-LIFE-BENEFIT-SEARCH
  8361         ELSE
  8362             NEXT SENTENCE
  8363     ELSE
  8364         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8365
  8366     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8367     MOVE '4'                    TO CNTL-REC-TYPE.
  8368     MOVE +0                     TO CNTL-SEQ-NO.
  8369     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8370
  8371     MOVE '1' TO RC-SW-2.
  8372     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8373
  8374     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8375        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8376         GO TO 0305-BENEFIT-NOT-FOUND.
  8377
  8378     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8379
  8380 0301-LIFE-BENEFIT-SEARCH.
  8381
  8382     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8383
  8384     IF NO-BENEFIT-FOUND
  8385        GO TO 0305-BENEFIT-NOT-FOUND.
  8386
  8387     IF WS-BEN-CD = '99'
  8388        GO TO 0305-BENEFIT-NOT-FOUND.
  8389
  8390     IF PB-COMPANY-ID = 'NCL'
  8391         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8392             GO TO 0304-LIFE-BENEFIT-FOUND.
  8393
  8394     MOVE +1                     TO SUB5.
  8395     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 155
* EL050.cbl
  8396
  8397* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8398* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8399     IF PB-COMPANY-ID = 'DMD'
  8400         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8401
  8402 0302-EDIT-ACCT-LF-BENEFITS.
  8403
  8404     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8405        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8406           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8407                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8408           GO TO 03XX-GET-LIFE-ERPLAN.
  8409
  8410     IF SUB5 LESS THAN +20
  8411        ADD +1                   TO SUB5
  8412        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8413
  8414     MOVE +1                     TO SUB5.
  8415
  8416     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8417        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8418
  8419 0303-EDIT-DMD-EXTRA-BENEFITS.
  8420
  8421     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8422        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8423           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8424                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8425           GO TO 03XX-GET-LIFE-ERPLAN.
  8426
  8427     IF SUB5 LESS THAN +30
  8428        ADD +1                   TO SUB5
  8429        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8430
  8431     MOVE +1                     TO SUB5.
  8432
  8433 03XX-EDIT-FOR-NINETY-LF.
  8434
  8435***************************************************************
  8436*                                                             *
  8437*    NINETY BENEFIT PLAN TYPES:                               *
  8438*                                                             *
  8439*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8440*      92 = ALL GROUP REDUCING BENEFITS                       *
  8441*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8442*      94 = ALL GROUP LEVEL BENEFITS                          *
  8443*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8444*           BENEFIT CONTROLS.                                 *
  8445*      99 = ALL BENEFITS                                      *
  8446*                                                             *
  8447***************************************************************
  8448
  8449     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8450                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8451
  8452     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8453       AND
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 156
* EL050.cbl
  8454        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8455        GO TO 03XX-GET-LIFE-ERPLAN.
  8456
  8457     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8458       AND
  8459        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8460        IF CF-REDUCING (SUB3)
  8461           IF (PB-I-INDV-GRP-OVRD = 'I')
  8462              OR
  8463           ((AM-IG = '1') AND
  8464           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8465              OR
  8466           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8467           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8468           (AM-IG NOT = '2'))
  8469              GO TO 03XX-GET-LIFE-ERPLAN.
  8470
  8471     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8472       AND
  8473        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8474        IF CF-REDUCING (SUB3)
  8475           IF (PB-I-INDV-GRP-OVRD = 'G')
  8476              OR
  8477           ((AM-IG = '2') AND
  8478           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8479              OR
  8480           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8481           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8482           (AM-IG NOT = '1'))
  8483              GO TO 03XX-GET-LIFE-ERPLAN.
  8484
  8485     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8486       AND
  8487        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8488        IF CF-LEVEL    (SUB3)
  8489           IF (PB-I-INDV-GRP-OVRD = 'I')
  8490              OR
  8491           ((AM-IG = '1') AND
  8492           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8493              OR
  8494           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8495           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8496            (AM-IG NOT = '2'))
  8497              GO TO 03XX-GET-LIFE-ERPLAN.
  8498
  8499     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8500       AND
  8501        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8502        IF CF-LEVEL    (SUB3)
  8503           IF (PB-I-INDV-GRP-OVRD = 'G')
  8504              OR
  8505           ((AM-IG = '2') AND
  8506           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8507              OR
  8508           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8509           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8510           (AM-IG NOT = '1'))
  8511              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 157
* EL050.cbl
  8512
  8513     IF SUB5 LESS THAN +20
  8514        ADD +1                   TO SUB5
  8515        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8516
  8517     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8518
  8519     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8520        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8521
  8522     MOVE +1                     TO SUB5.
  8523
  8524 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8525
  8526     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8527                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8528
  8529     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8530       AND
  8531        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8532        GO TO 03XX-GET-LIFE-ERPLAN.
  8533
  8534     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8535       AND
  8536        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8537        IF CF-REDUCING (SUB3)
  8538           IF (PB-I-INDV-GRP-OVRD = 'I')
  8539              OR
  8540           ((AM-IG = '1') AND
  8541           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8542              OR
  8543           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8544           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8545           (AM-IG NOT = '2'))
  8546              GO TO 03XX-GET-LIFE-ERPLAN.
  8547
  8548     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8549       AND
  8550        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8551        IF CF-REDUCING (SUB3)
  8552           IF (PB-I-INDV-GRP-OVRD = 'G')
  8553              OR
  8554           ((AM-IG = '2') AND
  8555           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8556              OR
  8557           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8558           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8559           (AM-IG NOT = '1'))
  8560              GO TO 03XX-GET-LIFE-ERPLAN.
  8561
  8562     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8563       AND
  8564        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8565        IF CF-LEVEL    (SUB3)
  8566           IF (PB-I-INDV-GRP-OVRD = 'I')
  8567              OR
  8568           ((AM-IG = '1') AND
  8569           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 158
* EL050.cbl
  8570              OR
  8571           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8572           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8573            (AM-IG NOT = '2'))
  8574              GO TO 03XX-GET-LIFE-ERPLAN.
  8575
  8576     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8577       AND
  8578        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8579        IF CF-LEVEL    (SUB3)
  8580           IF (PB-I-INDV-GRP-OVRD = 'G')
  8581              OR
  8582           ((AM-IG = '2') AND
  8583           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8584              OR
  8585           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8586           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8587           (AM-IG NOT = '1'))
  8588              GO TO 03XX-GET-LIFE-ERPLAN.
  8589
  8590     IF SUB5 LESS THAN +30
  8591        ADD +1                   TO SUB5
  8592        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8593
  8594     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8595
  8596 03XX-EDIT-FOR-NINETY-LF-CONT.
  8597
  8598     MOVE +99                    TO SUB5.
  8599
  8600     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8601        IF PB-ISSUE
  8602           MOVE ER-1924          TO  WS-ERROR
  8603           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8604
  8605     GO TO 0304-LIFE-BENEFIT-FOUND.
  8606
  8607 03XX-GET-LIFE-ERPLAN.
  8608
  8609     IF WK-PLAN-ADDR EQUAL +0
  8610        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8611
  8612     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8613     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8614     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8615     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8616     MOVE 'Y'                    TO PLAN-MASTER-SW
  8617                                    PLAN-MASTER-LIFE-SW.
  8618     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8619
  8620 03XX-ERPLAN-LIFE-GETMAIN.
  8621
  8622     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8623     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8624
  8625 03XX-ERPLAN-LIFE-READ.
  8626
  8627     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 159
* EL050.cbl
  8628     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8629     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8630     MOVE PB-SV-STATE            TO PLAN-STATE.
  8631     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8632     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8633     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8634     MOVE WS-SAVE-BENEFIT-REVISION
  8635                                 TO PLAN-REVISION-NO.
  8636
  8637     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8638     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8639
  8640     IF PB-COMPANY-ID = 'NCL'
  8641       IF NOT LF-PLAN-MASTER-FOUND
  8642         IF NOT PB-POLICY-IS-DECLINED  AND
  8643            NOT PB-POLICY-IS-VOIDED
  8644             MOVE  ER-1921         TO  WS-ERROR
  8645             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8646             GO TO 0304-LIFE-BENEFIT-FOUND.
  8647
  8648     IF NOT LF-PLAN-MASTER-FOUND
  8649        GO TO 0304-LIFE-BENEFIT-FOUND.
  8650
  8651 XXXX-CHECK-LF-PLAN-KEY.
  8652
  8653     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8654        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8655        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8656        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8657        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8658        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8659        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8660        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8661        MOVE 'N'                 TO PLAN-MASTER-SW
  8662          GO TO 03XX-ERPLAN-LIFE-READ.
  8663
  8664     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8665
  8666     IF  PB-CANCELLATION
  8667         GO TO  0303-LF-ACCT-BEN-FOUND.
  8668
  8669     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8670        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8671           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8672           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8673              MOVE ER-2644             TO WS-ERROR
  8674              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8675           ELSE
  8676              NEXT SENTENCE
  8677        ELSE
  8678           IF PB-COMPANY-ID NOT = 'NCL'
  8679              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8680                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8681
  8682 0303-LF-ACCT-BEN-FOUND.
  8683
  8684     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8685
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 160
* EL050.cbl
  8686     IF PL-DEV-CODE NOT = SPACES
  8687        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8688
  8689     IF PL-DEV-PCT NUMERIC AND
  8690        PL-DEV-PCT NOT = ZEROS
  8691        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8692
  8693     IF PL-TOL-PREM-AMT GREATER THAN +0
  8694        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8695
  8696     IF PL-TOL-REF-AMT GREATER THAN +0
  8697        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8698
  8699     IF PL-TOL-PREM-PCT GREATER THAN +0
  8700        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8701
  8702     IF PL-TOL-REF-PCT GREATER THAN +0
  8703        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8704
  8705     IF PL-TOL-CLM-AMT GREATER THAN +0
  8706        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8707
  8708     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8709                          PL-OVER-SHORT-AMT > +0
  8710        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8711
  8712     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8713                          PL-OVER-SHORT-PCT > +0
  8714        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8715
  8716     IF PL-SALES-TAX NUMERIC AND
  8717                          PL-SALES-TAX > +0
  8718         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8719
  8720     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8721        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8722                                    WS-IG-OVRD-AM.
  8723
  8724 0304-LIFE-BENEFIT-FOUND.
  8725
  8726     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8727
  8728     IF PB-ISSUE
  8729        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8730     ELSE
  8731        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8732
  8733     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8734     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8735     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8736     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8737     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8738                                         WS-LF-REFUND-CALC.
  8739
  8740     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8741        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8742
  8743     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 161
* EL050.cbl
  8744        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8745     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8746
  8747     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8748     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8749     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8750     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8751     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8752     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8753
  8754     IF PB-COMPANY-ID = 'NCL'  AND
  8755        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8756         NEXT SENTENCE
  8757     ELSE
  8758         IF SUB5 NOT GREATER THAN +20
  8759            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8760               MOVE WS-SAVE-BENEFIT-REM-TERM
  8761                                      TO WS-AM-LF-BENE-REM-TERM
  8762                                         EC-BR-LF-REM-TERM-CALC.
  8763
  8764     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8765     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8766
  8767     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8768
  8769 0305-BENEFIT-NOT-FOUND.
  8770
  8771     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8772     MOVE ER-2604                TO WS-ERROR.
  8773     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8774
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 162
* EL050.cbl
  8776
  8777 0310-FIND-AH-BENEFIT-RECORD.
  8778
  8779     MOVE 'N'                    TO PLAN-MASTER-SW
  8780                                    PLAN-MASTER-AH-SW.
  8781
  8782     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8783                                    WS-PL-TOL-AH-REFUND
  8784                                    WS-AH-PL-REF-OVS-AMT
  8785                                    WS-PL-TOL-AH-PREM-PCT
  8786                                    WS-PL-TOL-AH-REFUND-PCT
  8787                                    WS-AH-PL-REF-OVS-PCT
  8788                                    WS-PL-TOL-AH-CLAIM.
  8789     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8790
  8791
  8792     if pb-issue
  8793        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8794           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8795        end-if
  8796        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8797           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8798           GO TO 0399-BENEFIT-NOT-FOUND
  8799        end-if
  8800     end-if
  8801
  8802     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8803        GO TO 0400-FIND-CARRIER.
  8804
  8805     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8806
  8807     IF WK-AH-BEN-ADDR NOT = ZEROS
  8808         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8809         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8810         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8811         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8812           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8813             GO TO 0311-AH-BENEFIT-SEARCH
  8814         ELSE
  8815             NEXT SENTENCE
  8816     ELSE
  8817         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8818
  8819     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8820     MOVE '5'                    TO CNTL-REC-TYPE.
  8821     MOVE +0                     TO CNTL-SEQ-NO.
  8822     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8823
  8824     MOVE '2' TO RC-SW-2.
  8825     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8826
  8827     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8828        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8829          GO TO 0399-BENEFIT-NOT-FOUND.
  8830
  8831     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8832
  8833 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 163
* EL050.cbl
  8834
  8835     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8836
  8837     IF NO-BENEFIT-FOUND
  8838         GO TO 0399-BENEFIT-NOT-FOUND.
  8839
  8840     IF WS-BEN-CD = '99'
  8841        GO TO 0399-BENEFIT-NOT-FOUND.
  8842
  8843     IF PB-COMPANY-ID  =  'NCL'
  8844         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8845             GO TO 0314-A-H-BENEFIT-FOUND.
  8846
  8847     MOVE +1                     TO SUB5.
  8848     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8849
  8850* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8851* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8852     IF PB-COMPANY-ID = 'DMD'
  8853         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8854
  8855 0312-EDIT-ACCT-AH-BENEFITS.
  8856
  8857     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8858        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8859           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8860                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8861           GO TO 03XX-GET-AH-ERPLAN.
  8862
  8863     IF SUB5 LESS THAN +20
  8864        ADD +1                   TO SUB5
  8865        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8866
  8867     MOVE +1                     TO SUB5.
  8868
  8869     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8870        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8871
  8872 0313-EDIT-DMD-EXTRA-BENEFITS.
  8873
  8874     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8875        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8876           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8877                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8878           GO TO 03XX-GET-AH-ERPLAN.
  8879
  8880     IF SUB5 LESS THAN +30
  8881        ADD +1                   TO SUB5
  8882        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8883
  8884     MOVE +1                     TO SUB5.
  8885
  8886 03XX-EDIT-FOR-NINETY-AH.
  8887
  8888***************************************************************
  8889*                                                             *
  8890*    NINETY BENEFIT PLAN TYPES:                               *
  8891*                                                             *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 164
* EL050.cbl
  8892*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8893*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8894*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8895*           BENEFIT CONTROLS.                                 *
  8896*      99 = ALL BENEFITS.                                     *
  8897*                                                             *
  8898***************************************************************
  8899
  8900     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8901                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8902
  8903     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8904       AND
  8905        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8906        GO TO 03XX-GET-AH-ERPLAN.
  8907
  8908     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8909       AND
  8910        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8911           IF (PB-I-INDV-GRP-OVRD = 'I')
  8912              OR
  8913           ((AM-IG = '1') AND
  8914           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8915              OR
  8916           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8917           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8918           (AM-IG NOT = '2'))
  8919              GO TO 03XX-GET-AH-ERPLAN.
  8920
  8921     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8922       AND
  8923        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8924           IF (PB-I-INDV-GRP-OVRD = 'G')
  8925              OR
  8926           ((AM-IG = '2') AND
  8927           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8928              OR
  8929           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8930           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8931           (AM-IG NOT = '1'))
  8932              GO TO 03XX-GET-AH-ERPLAN.
  8933
  8934     IF SUB5 LESS THAN +20
  8935        ADD +1                   TO SUB5
  8936        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8937
  8938     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8939        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8940
  8941     MOVE +1                    TO SUB5.
  8942
  8943 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8944
  8945     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8946                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8947
  8948     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8949       AND
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 165
* EL050.cbl
  8950        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8951        GO TO 03XX-GET-AH-ERPLAN.
  8952
  8953     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  8954       AND
  8955        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8956           IF (PB-I-INDV-GRP-OVRD = 'I')
  8957              OR
  8958           ((AM-IG = '1') AND
  8959           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8960              OR
  8961           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8962           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8963           (AM-IG NOT = '2'))
  8964              GO TO 03XX-GET-AH-ERPLAN.
  8965
  8966     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8967       AND
  8968        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8969           IF (PB-I-INDV-GRP-OVRD = 'G')
  8970              OR
  8971           ((AM-IG = '2') AND
  8972           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8973              OR
  8974           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8975           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8976           (AM-IG NOT = '1'))
  8977              GO TO 03XX-GET-AH-ERPLAN.
  8978
  8979     IF SUB5 LESS THAN +30
  8980        ADD +1                   TO SUB5
  8981        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8982
  8983 03XX-EDIT-FOR-NINETY-AH-CONT.
  8984
  8985     MOVE +99                    TO SUB5.
  8986
  8987     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8988
  8989     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8990        IF PB-ISSUE
  8991           MOVE ER-1925          TO  WS-ERROR
  8992           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8993
  8994     GO TO 0314-A-H-BENEFIT-FOUND.
  8995
  8996 03XX-GET-AH-ERPLAN.
  8997
  8998     IF WK-PLAN-ADDR EQUAL +0
  8999         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9000
  9001     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9002     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9003     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9004     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9005     MOVE 'Y'                    TO PLAN-MASTER-SW
  9006                                    PLAN-MASTER-AH-SW.
  9007*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 166
* EL050.cbl
  9008     GO TO 03XX-ERPLAN-AH-READ.
  9009
  9010 03XX-ERPLAN-AH-GETMAIN.
  9011
  9012     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9013     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9014
  9015 03XX-ERPLAN-AH-READ.
  9016
  9017     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9018     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9019     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9020     MOVE PB-SV-STATE            TO PLAN-STATE.
  9021     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9022     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9023     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9024     MOVE WS-SAVE-BENEFIT-REVISION
  9025                                 TO PLAN-REVISION-NO.
  9026
  9027     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9028     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9029
  9030     IF PB-COMPANY-ID = 'NCL'
  9031       IF NOT AH-PLAN-MASTER-FOUND
  9032         IF NOT PB-POLICY-IS-DECLINED  AND
  9033            NOT PB-POLICY-IS-VOIDED
  9034             MOVE  ER-1922         TO  WS-ERROR
  9035             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9036             GO TO 0314-A-H-BENEFIT-FOUND.
  9037
  9038     IF NOT AH-PLAN-MASTER-FOUND
  9039        GO TO 0314-A-H-BENEFIT-FOUND.
  9040
  9041 XXXX-CHECK-AH-PLAN-KEY.
  9042
  9043     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9044        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9045        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9046        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9047        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9048        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9049        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9050        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9051        MOVE 'N'                 TO PLAN-MASTER-SW
  9052          GO TO 03XX-ERPLAN-AH-READ.
  9053
  9054     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9055
  9056     IF  PB-CANCELLATION
  9057         GO TO  0313-AH-ACCT-BEN-FOUND.
  9058
  9059     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9060       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9061          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9062          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9063             MOVE ER-2644             TO WS-ERROR
  9064             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9065          ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 167
* EL050.cbl
  9066             NEXT SENTENCE
  9067       ELSE
  9068          IF PB-COMPANY-ID NOT = 'NCL'
  9069             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9070                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9071
  9072 0313-AH-ACCT-BEN-FOUND.
  9073
  9074     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9075
  9076     IF PL-DEV-CODE NOT = SPACES
  9077        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9078
  9079     IF PL-DEV-PCT NUMERIC AND
  9080        PL-DEV-PCT NOT = ZEROS
  9081        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9082
  9083     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9084        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9085
  9086     IF PL-TOL-REF-AMT NOT EQUAL +0
  9087        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9088
  9089     IF PL-TOL-PREM-PCT GREATER THAN +0
  9090        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9091
  9092     IF PL-TOL-REF-PCT GREATER THAN +0
  9093        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9094
  9095     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9096        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9097
  9098     IF PL-OVER-SHORT-AMT NUMERIC AND
  9099                          PL-OVER-SHORT-AMT > +0
  9100        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9101
  9102     IF PL-OVER-SHORT-PCT NUMERIC AND
  9103                          PL-OVER-SHORT-PCT > +0
  9104        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9105
  9106     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9107        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9108        IF WS-IG-OVRD-AM EQUAL SPACES
  9109            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9110
  9111 0314-A-H-BENEFIT-FOUND.
  9112
  9113     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9114
  9115     IF PB-ISSUE
  9116        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9117       ELSE
  9118        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9119
  9120     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9121     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9122     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9123     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 168
* EL050.cbl
  9124                                         WS-AH-REFUND-CALC.
  9125
  9126     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9127        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9128
  9129     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9130        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9131     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9132
  9133     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9134     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9135     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9136     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9137     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9138     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9139
  9140     IF PB-COMPANY-ID = 'NCL'  AND
  9141        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9142         NEXT SENTENCE
  9143     ELSE
  9144         IF SUB5 NOT GREATER THAN +20
  9145            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9146                MOVE WS-SAVE-BENEFIT-REM-TERM
  9147                                      TO WS-AM-AH-BENE-REM-TERM
  9148                                         EC-BR-AH-REM-TERM-CALC.
  9149
  9150     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9151     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9152
  9153     GO TO 0400-FIND-CARRIER.
  9154
  9155 0399-BENEFIT-NOT-FOUND.
  9156
  9157     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9158     MOVE ER-2605                TO WS-ERROR.
  9159     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9160
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 169
* EL050.cbl
  9162
  9163 0400-FIND-CARRIER.
  9164
  9165     MOVE PB-SV-CARRIER          TO WS-CARR.
  9166
  9167     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9168     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9169     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9170     MOVE '6'                    TO CNTL-REC-TYPE.
  9171
  9172*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9173     MOVE SPACE                  TO WS-DMD-RATING-SW
  9174                                    EC-BR-DMD-RATING-SW.
  9175
  9176     MOVE '2'                    TO RC-SW-1.
  9177     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9178
  9179     IF NOT CF-CARRIER-MASTER
  9180        GO TO 0400-CARRIER-NOT-FOUND.
  9181
  9182 0400-BUILD-CARR-TOL.
  9183
  9184     IF CF-CR-TOL-PREM NUMERIC AND
  9185        CF-CR-TOL-PREM GREATER THAN +0
  9186        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9187                                    WS-TOL-AH-PREM.
  9188
  9189     IF CF-CR-TOL-REFUND NUMERIC AND
  9190        CF-CR-TOL-REFUND GREATER THAN +0
  9191        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9192                                    WS-TOL-AH-REFUND.
  9193
  9194     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9195        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9196        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9197                                    WS-AH-REFUND-OVS-AMT.
  9198
  9199     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9200        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9201        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9202                                    WS-AH-REFUND-OVS-PCT.
  9203
  9204     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9205        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9206        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9207                                    WS-TOL-AH-PREM-PCT.
  9208
  9209     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9210        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9211        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9212                                     WS-TOL-AH-REFUND-PCT.
  9213
  9214     IF CF-COMPANY-ID EQUAL 'DMD'
  9215         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9216                                    EC-BR-DMD-RATING-SW.
  9217
  9218     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9219     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 170
* EL050.cbl
  9220        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9221     END-IF
  9222     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9223        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9224     END-IF
  9225     IF WS-TOL-CLP-PCT = ZEROS
  9226        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9227     END-IF
  9228
  9229     IF WS-SPP-LEASE-COMM = ZEROS
  9230        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9231     END-IF
  9232     GO TO 0400-FIND-ERPDEF.
  9233
  9234 0400-CARRIER-NOT-FOUND.
  9235
  9236     MOVE ER-2602                TO WS-ERROR.
  9237     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9238
  9239 0400-FIND-ERPDEF.
  9240     IF PB-COMPANY-ID = 'DCC'
  9241        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9242        CONTINUE
  9243     ELSE
  9244        GO TO 0400-FIND-ERCOMP
  9245     END-IF
  9246     MOVE ' '                    TO PDEF-MASTER-SW
  9247     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9248     MOVE PB-STATE               TO ERPDEF-STATE
  9249     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9250     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9251     IF PB-ISSUE
  9252        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9253     ELSE
  9254        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9255     END-IF
  9256     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9257     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9258     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9259     IF PDEF-MASTER-FOUND
  9260        MOVE 'N'                 TO PDEF-MASTER-SW
  9261        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9262        IF PDEF-MASTER-FOUND
  9263           IF (ERPDEF-KEY-SAVE (1:16) =
  9264                        PD-CONTROL-PRIMARY (1:16))
  9265              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9266              CONTINUE
  9267           ELSE
  9268              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9269              IF (ERPDEF-KEY-SAVE (1:16) =
  9270                        PD-CONTROL-PRIMARY (1:16))
  9271                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9272                 CONTINUE
  9273              ELSE
  9274                 MOVE 'N'        TO PDEF-MASTER-SW
  9275              END-IF
  9276           END-IF
  9277        END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 171
* EL050.cbl
  9278        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9279     END-IF
  9280     IF PDEF-MASTER-FOUND
  9281        IF PD-TRUNCATED = 'Y'
  9282           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9283        END-IF
  9284     END-IF
  9285     .
  9286 0400-FIND-ERCOMP.
  9287     IF PB-COMPANY-ID = 'DCC'
  9288        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9289           (WS-SUB1 > +10)
  9290           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9291                 OR 'A' OR 'N'
  9292              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9293              MOVE PB-CARRIER    TO COMP-CARRIER
  9294              MOVE PB-GROUPING   TO COMP-GROUPING
  9295              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9296              MOVE AM-AGT (WS-SUB1)
  9297                                 TO COMP-FIN-RESP
  9298              MOVE 'G'           TO COMP-TYPE
  9299              PERFORM 8582-READ-COMPENSATION-MASTER
  9300                                 THRU 8582-EXIT
  9301              IF COMP-MASTER-FOUND
  9302                 IF CO-GA-INACTIVE
  9303                    MOVE ER-2763 TO WS-ERROR
  9304                    PERFORM 9900-ERROR-FORMAT
  9305                                 THRU 9900-EXIT
  9306                    MOVE +11     TO WS-SUB1
  9307                 END-IF
  9308                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9309                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9310                    MOVE ER-2788 TO WS-ERROR
  9311                    PERFORM 9900-ERROR-FORMAT
  9312                                 THRU 9900-EXIT
  9313                    MOVE +11     TO WS-SUB1
  9314                 END-IF
  9315              END-IF
  9316           END-IF
  9317        END-PERFORM
  9318     END-IF
  9319     IF PB-COMPANY-ID = 'DCC'
  9320        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9321           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9322                                    WS-CLP-STATE
  9323        ELSE
  9324           MOVE SPACES           TO PB-I-CLP-STATE
  9325                                    WS-CLP-STATE
  9326        END-IF
  9327     END-IF
  9328
  9329     IF (PB-COMPANY-ID = 'DCC')
  9330        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9331        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9332        CONTINUE
  9333     ELSE
  9334        GO TO 0400-FIND-STATE-RECORD
  9335     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 172
* EL050.cbl
  9336     MOVE SPACES                 TO WS-CLP-STATE
  9337     MOVE +0                     TO WS-BANK-FEE
  9338                                    WS-BANK-LFEE
  9339                                    WS-BANK-NOCHRGB
  9340
  9341     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9342     IF (PB-ISSUE)
  9343        AND (PB-I-BANK-NUMBER NOT =
  9344            SPACES AND ZEROS AND LOW-VALUES)
  9345        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9346     ELSE
  9347        IF (PB-CANCELLATION)
  9348           AND (PB-CI-BANK-NUMBER NOT =
  9349                SPACES AND ZEROS AND LOW-VALUES)
  9350           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9351        END-IF
  9352     END-IF
  9353     IF COMP-FIN-RESP NOT = LOW-VALUES
  9354        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9355        MOVE PB-CARRIER          TO COMP-CARRIER
  9356        MOVE PB-GROUPING         TO COMP-GROUPING
  9357        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9358        MOVE 'B'                 TO COMP-TYPE
  9359        PERFORM 8582-READ-COMPENSATION-MASTER
  9360                                 THRU 8582-EXIT
  9361        IF COMP-MASTER-FOUND
  9362           IF CO-MAX-BANK-FEE NOT NUMERIC
  9363              MOVE +0            TO CO-MAX-BANK-FEE
  9364           END-IF
  9365           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9366              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9367           END-IF
  9368           IF CO-GA-INACTIVE
  9369              MOVE ER-2763       TO WS-ERROR
  9370              PERFORM 9900-ERROR-FORMAT
  9371                                 THRU 9900-EXIT
  9372           END-IF
  9373           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9374              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9375              MOVE ER-2788 TO WS-ERROR
  9376              PERFORM 9900-ERROR-FORMAT
  9377                                 THRU 9900-EXIT
  9378              MOVE +11     TO WS-SUB1
  9379           END-IF
  9380           IF WS-AH-BEN-CATEGORY = 'G'
  9381              MOVE CO-MAX-BANK-FEE
  9382                                 TO WS-BANK-FEE
  9383                                    PB-I-BANK-FEE
  9384           ELSE
  9385              MOVE CO-MAX-BANK-FEE-LEASE
  9386                                 TO WS-BANK-LFEE
  9387                                    PB-I-BANK-FEE
  9388           END-IF
  9389           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9390              AND (WS-AH-REFUND-CALC = 'G'))
  9391                        OR
  9392              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9393              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 173
* EL050.cbl
  9394              CONTINUE
  9395           ELSE
  9396              MOVE ER-2789 TO WS-ERROR
  9397              PERFORM 9900-ERROR-FORMAT
  9398                                 THRU 9900-EXIT
  9399           END-IF
  9400           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9401                                    PB-I-CLP-STATE
  9402           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9403           MOVE CO-CARRIER       TO BXRF-CARRIER
  9404           MOVE CO-GROUPING      TO BXRF-GROUPING
  9405           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9406           MOVE BXRF-MAX-REC-LENGTH
  9407                                 TO BXRF-REC-LENGTH
  9408           PERFORM 8584-READ-BANK-CROSS-REF
  9409                                 THRU 8584-EXIT
  9410           IF BXRF-MASTER-FOUND
  9411              MOVE ' '           TO BANK-ACCT-SW
  9412              MOVE BK-BANK-POINTER-CNT
  9413                                 TO BK-BANK-POINTER-CNT
  9414              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9415                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9416                 OR (BANK-ACCT-FOUND)
  9417                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9418                    AND (BK-AM-EXP-DT (WS-SUB1)
  9419                                 > PB-CERT-EFF-DT)
  9420                    AND (BK-AM-EFF-DT (WS-SUB1)
  9421                                 NOT > PB-CERT-EFF-DT)
  9422                    SET BANK-ACCT-FOUND TO TRUE
  9423                 END-IF
  9424              END-PERFORM
  9425              IF NOT BANK-ACCT-FOUND
  9426                 MOVE ZEROS      TO WS-BANK-FEE
  9427                                    WS-BANK-LFEE
  9428                 MOVE ER-2869    TO WS-ERROR
  9429                 PERFORM 9900-ERROR-FORMAT
  9430                                 THRU 9900-EXIT
  9431              ELSE
  9432                 PERFORM 5000-PROCESS-REPS
  9433                                 THRU 5000-EXIT
  9434                 IF AGENT-MASTER-FOUND
  9435                    MOVE +0      TO WS-BANK-FEE
  9436                                    WS-BANK-LFEE
  9437*                   MOVE AG-SPP-FEES (1)
  9438*                                TO PB-I-BANK-FEE
  9439*                                   WS-BANK-FEE
  9440                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9441                       (WS-SUB1 > +10)
  9442                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9443                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9444                       END-IF
  9445                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9446                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9447                       END-IF
  9448                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9449                          AG-SPP-FEES (WS-SUB1)
  9450                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9451                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 174
* EL050.cbl
  9452                    END-PERFORM
  9453                    IF WS-AH-BEN-CATEGORY = 'G'
  9454                       MOVE WS-BANK-FEE
  9455                                 TO PB-I-BANK-FEE
  9456                    ELSE
  9457                       MOVE WS-BANK-LFEE
  9458                                 TO PB-I-BANK-FEE
  9459                    END-IF
  9460                 END-IF
  9461              END-IF
  9462           END-IF
  9463        ELSE
  9464           MOVE ER-2879          TO WS-ERROR
  9465           PERFORM 9900-ERROR-FORMAT
  9466                                 THRU 9900-EXIT
  9467        END-IF
  9468     ELSE
  9469        MOVE ER-2879             TO WS-ERROR
  9470        PERFORM 9900-ERROR-FORMAT
  9471                                 THRU 9900-EXIT
  9472     END-IF
  9473     IF WS-AH-BEN-CATEGORY = 'G'
  9474        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9475        + WS-BANK-FEE
  9476     ELSE
  9477        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9478        + WS-BANK-LFEE
  9479     END-IF
  9480     .
  9481 0400-FIND-STATE-RECORD.
  9482
  9483     IF WK-STATE-ADDR NOT = ZEROS
  9484         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9485         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9486         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9487         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9488         IF PB-SV-STATE = CF-STATE-CODE
  9489             GO TO 0405-CONTINUE-EDIT
  9490         ELSE
  9491             NEXT SENTENCE
  9492     ELSE
  9493         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9494
  9495     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9496     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9497     MOVE '3'                    TO CNTL-REC-TYPE.
  9498     MOVE +0                     TO CNTL-SEQ-NO.
  9499
  9500     MOVE '3'                    TO RC-SW-2.
  9501     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9502
  9503     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9504        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9505        PB-SV-STATE   NOT = CF-STATE-CODE)
  9506        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9507                                    WS-TOL-AH-CLAIM
  9508                                    WS-MINIMUM-REFUND
  9509                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 175
* EL050.cbl
  9510                                    WS-TOL-AH-PREM
  9511                                    WS-TOL-LF-REFUND
  9512                                    WS-TOL-AH-REFUND
  9513                                    EC-ST-TOL-PREM-PCT
  9514                                    WS-TOL-LF-PREM-PCT
  9515                                    WS-TOL-AH-PREM-PCT
  9516                                    EC-ST-TOL-REFUND-PCT
  9517                                    WS-TOL-LF-REFUND-PCT
  9518                                    WS-TOL-AH-REFUND-PCT
  9519                                    EC-ST-TOL-PREM
  9520                                    EC-ST-TOL-REFUND
  9521                                    EC-ST-FST-PMT-DAYS-MAX
  9522                                    WS-FREE-LOOK-PERIOD
  9523                                    WS-ST-LF-PREM-TAX
  9524                                    WS-ST-AH-PREM-TAX-I
  9525                                    WS-ST-AH-PREM-TAX-G
  9526                                    WS-BANK-FEE
  9527                                    WS-BANK-LFEE
  9528                                    WS-TOL-CLP-PCT
  9529                                    WS-SPP-LEASE-COMM
  9530        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9531                                    EC-ST-FST-PMT-DAYS-CHG
  9532                                    WS-LF-REM-TERM-CALC
  9533                                    WS-LF-REFUND-CALC
  9534                                    EC-ST-LF-REM-TERM-CALC
  9535                                    EC-ST-LF-REFUND-CALC
  9536                                    WS-AH-REM-TERM-CALC
  9537                                    WS-AH-REFUND-CALC
  9538                                    WS-LF-BEN-CATEGORY
  9539                                    WS-AH-BEN-CATEGORY
  9540                                    WS-CLP-STATE
  9541                                    WS-ST-REFUND-CLAIM-FLAG
  9542                                    EC-ST-AH-REM-TERM-CALC
  9543                                    EC-ST-AH-REFUND-CALC
  9544          GO TO 0499-STATE-NOT-FOUND.
  9545
  9546     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9547
  9548 0405-CONTINUE-EDIT.
  9549
  9550     if pb-company-id = 'AHL'
  9551        continue
  9552     else
  9553        IF PB-CERT-PRIME NOT NUMERIC
  9554           MOVE ER-2722          TO WS-ERROR
  9555           PERFORM 9900-ERROR-FORMAT
  9556                                 THRU 9900-EXIT
  9557        end-if
  9558     END-IF
  9559*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9560*       MOVE +0                  TO SUB3
  9561*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9562*       IF SUB3 > +0
  9563*          MOVE ER-2722          TO WS-ERROR
  9564*          PERFORM 9900-ERROR-FORMAT
  9565*                                THRU 9900-EXIT
  9566*       END-IF
  9567*    END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 176
* EL050.cbl
  9568*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9569*       IF PB-CERT-PRIME NOT NUMERIC
  9570*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9571*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9572*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9573*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9574*
  9575*          MOVE ER-2722          TO WS-ERROR
  9576*          PERFORM 9900-ERROR-FORMAT
  9577*                                THRU 9900-EXIT
  9578*       END-IF
  9579*    END-IF
  9580
  9581     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9582
  9583     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9584        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9585                                    WS-TOL-AH-CLAIM.
  9586
  9587     IF CF-ST-REFUND-MIN NOT NUMERIC
  9588        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9589
  9590     IF CF-ST-REFUND-MIN NOT = ZEROS
  9591        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9592
  9593     IF CF-ST-TOL-PREM  NOT = ZEROS
  9594        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9595                                    WS-TOL-AH-PREM
  9596        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9597
  9598     IF CF-ST-TOL-REFUND NOT = ZEROS
  9599        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9600                                    WS-TOL-AH-REFUND
  9601        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9602
  9603     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9604        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9605        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9606                                    WS-AH-REFUND-OVS-AMT
  9607                                    EC-ST-OVR-SHT-AMT.
  9608
  9609     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9610        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9611        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9612                                    WS-TOL-LF-PREM-PCT
  9613                                    WS-TOL-AH-PREM-PCT.
  9614
  9615     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9616        CF-ST-TOL-REF-PCT GREATER THAN +0
  9617        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9618                                    WS-TOL-LF-REFUND-PCT
  9619                                    WS-TOL-AH-REFUND-PCT.
  9620
  9621     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9622        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9623        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9624                                    WS-AH-REFUND-OVS-PCT
  9625                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 177
* EL050.cbl
  9626
  9627     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9628     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9629
  9630     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9631          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9632
  9633     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9634     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9635     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9636
  9637     IF CF-ST-LF-PREM-TAX NUMERIC
  9638        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9639     END-IF
  9640     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9641        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9642     END-IF
  9643     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9644        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9645     END-IF
  9646
  9647     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9648         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9649     END-IF.
  9650
  9651     IF WS-LF-BENEFIT-CD = ZEROS
  9652        GO TO 0410-CHECK-AH.
  9653
  9654     IF CF-ST-RT-CALC NOT = SPACES
  9655        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9656                                    EC-ST-LF-REM-TERM-CALC
  9657     END-IF
  9658
  9659     IF WS-LF-COVERAGE-TYPE = 'R'
  9660        IF WS-LF-EARNINGS-CALC = '5'
  9661           IF CF-ST-RF-LN-CALC > '0'
  9662              MOVE CF-ST-RF-LN-CALC
  9663                                 TO WS-LF-REFUND-CALC
  9664                                    EC-ST-LF-REFUND-CALC
  9665           END-IF
  9666        ELSE
  9667           IF CF-ST-RF-LR-CALC > '0'
  9668              MOVE CF-ST-RF-LR-CALC
  9669                                 TO WS-LF-REFUND-CALC
  9670                                    EC-ST-LF-REFUND-CALC
  9671           END-IF
  9672        END-IF
  9673     ELSE
  9674        IF CF-ST-RF-LL-CALC > '0'
  9675           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9676                                    EC-ST-LF-REFUND-CALC
  9677        END-IF
  9678     END-IF
  9679
  9680     IF CF-ST-RT-CALC NOT = SPACES
  9681        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9682                                    EC-ST-LF-REM-TERM-CALC
  9683     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 178
* EL050.cbl
  9684
  9685     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9686     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9687
  9688     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9689
  9690     IF NO-BENEFIT-FOUND
  9691        GO TO 0410-CHECK-AH.
  9692
  9693     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9694        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9695                                 TO EC-ST-LF-REM-TERM-CALC
  9696                                    WS-LF-REM-TERM-CALC
  9697     END-IF
  9698
  9699     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9700        MOVE CF-ST-REFUND-CALC (SUB3)
  9701                                 TO WS-LF-REFUND-CALC
  9702                                    EC-ST-LF-REFUND-CALC
  9703     END-IF
  9704*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9705
  9706     .
  9707 0410-CHECK-AH.
  9708
  9709     IF WS-AH-BENEFIT-CD = ZEROS
  9710        GO TO 0500-SET-ACCOUNT.
  9711
  9712     IF CF-ST-RT-CALC NOT = SPACES
  9713        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9714                                    EC-ST-AH-REM-TERM-CALC
  9715     END-IF
  9716
  9717     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9718        IF CF-ST-RF-CP-CALC > '0'
  9719           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9720                                    EC-ST-AH-REFUND-CALC
  9721        END-IF
  9722     ELSE
  9723        IF CF-ST-RF-AH-CALC > '0'
  9724           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9725                                    EC-ST-AH-REFUND-CALC
  9726        END-IF
  9727     END-IF
  9728     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9729     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9730
  9731     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9732
  9733     IF NO-BENEFIT-FOUND
  9734        GO TO 0500-SET-ACCOUNT.
  9735
  9736     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9737        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9738                                 TO WS-AH-REM-TERM-CALC
  9739                                    EC-ST-AH-REM-TERM-CALC
  9740     END-IF
  9741
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 179
* EL050.cbl
  9742     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9743        MOVE CF-ST-REFUND-CALC (SUB3)
  9744                                 TO WS-AH-REFUND-CALC
  9745                                    EC-ST-AH-REFUND-CALC
  9746     END-IF
  9747
  9748*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9749
  9750     GO TO 0500-SET-ACCOUNT.
  9751
  9752 0499-STATE-NOT-FOUND.
  9753
  9754     MOVE ER-2603                TO WS-ERROR.
  9755     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9756
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 180
* EL050.cbl
  9758
  9759 0500-SET-ACCOUNT.
  9760*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9761     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9762        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9763        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9764        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9765        MOVE '3'                 TO CNTL-REC-TYPE
  9766        MOVE +0                  TO CNTL-SEQ-NO
  9767
  9768        MOVE '3'                 TO RC-SW-2
  9769        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9770
  9771        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9772           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9773           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9774           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9775                                    WS-ST-AH-PREM-TAX-I
  9776                                    WS-ST-AH-PREM-TAX-G
  9777        ELSE
  9778           IF CF-ST-LF-PREM-TAX NUMERIC
  9779              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9780           END-IF
  9781           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9782              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9783           END-IF
  9784           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9785              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9786           END-IF
  9787        END-IF
  9788        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9789     END-IF
  9790*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9791*  FOR DCC ONLY
  9792     IF PB-COMPANY-ID = 'DCC'
  9793
  9794     MOVE ' '                    TO STAT-MASTER-SW
  9795     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9796     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9797     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9798     MOVE PB-STATE               TO ELSTAT-STATE
  9799     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9800        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9801     END-IF
  9802
  9803     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9804     SET BIN-TO-GREG             TO TRUE
  9805     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9806     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9807     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9808
  9809     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9810     IF STAT-MASTER-FOUND
  9811        MOVE 'N'                 TO STAT-MASTER-SW
  9812        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9813        IF STAT-MASTER-FOUND
  9814           IF (ELSTAT-KEY-SAVE (1:12) =
  9815                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 181
* EL050.cbl
  9816              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9817                 MOVE 'F'        TO STAT-MASTER-SW
  9818              ELSE
  9819                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9820                 IF (STAT-MASTER-FOUND)
  9821                    AND (ELSTAT-KEY-SAVE (1:12) =
  9822                        SF-CONTROL-PRIMARY (1:12))
  9823                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9824                    MOVE 'F'     TO STAT-MASTER-SW
  9825                 END-IF
  9826              END-IF
  9827           END-IF
  9828        END-IF
  9829     END-IF
  9830
  9831     IF STAT-MASTER-SW = 'F'
  9832        IF SF-ST-LF-PREM-TAX NUMERIC
  9833           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9834        END-IF
  9835        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9836           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9837        END-IF
  9838        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9839           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9840        END-IF
  9841     END-IF
  9842
  9843     END-IF
  9844     IF (PB-COMPANY-ID = 'DCC')
  9845        AND (PB-ISSUE)
  9846        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9847        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9848        AND (AM-GPCD = 06)
  9849        MOVE 'Y'                 TO WS-GOOD-HIN
  9850        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9851           MOVE PB-I-VIN         TO WS-WORK-VIN
  9852           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9853              (V1 > 16)
  9854              IF WS-WORK-VIN (V1:1) NUMERIC
  9855                 MOVE WS-WORK-VIN-N (V1)
  9856                                 TO WS-ROW-B-VAL (V1)
  9857              ELSE
  9858                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9859                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9860                    OR (V2 > 26)
  9861                 END-PERFORM
  9862                 IF V2 < 27
  9863                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9864                 ELSE
  9865                    MOVE 'N'     TO WS-GOOD-HIN
  9866                 END-IF
  9867              END-IF
  9868              COMPUTE WS-ROW-D-VAL (V1) =
  9869                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9870              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9871                 WS-ROW-D-VAL (V1)
  9872           END-PERFORM
  9873           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 182
* EL050.cbl
  9874           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9875             REMAINDER WS-VIN-REMAINDER
  9876           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9877              CONTINUE
  9878           ELSE
  9879              MOVE 'N'           TO WS-GOOD-HIN
  9880           END-IF
  9881        ELSE
  9882           MOVE 'N'              TO WS-GOOD-HIN
  9883        END-IF
  9884        IF WS-GOOD-HIN NOT = 'Y'
  9885           MOVE ER-3826           TO WS-ERROR
  9886           PERFORM 9900-ERROR-FORMAT
  9887                                 THRU 9900-EXIT
  9888        END-IF
  9889     END-IF
  9890     IF (PB-COMPANY-ID = 'DCC')
  9891        AND (PB-ISSUE)
  9892        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9893        AND (AM-GPCD NOT = 06)
  9894        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9895          MOVE PB-I-VIN          TO WS-WORK-VIN
  9896          MOVE +8                TO V2
  9897          MOVE ZEROS             TO WS-VIN-TOTAL
  9898          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9899           (V1 > 17)
  9900             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9901                MOVE ER-3825     TO WS-ERROR
  9902                PERFORM 9900-ERROR-FORMAT
  9903                                 THRU 9900-EXIT
  9904             ELSE
  9905                IF V1 = 8
  9906                   MOVE 10       TO V2
  9907                END-IF
  9908                IF V1 = 9
  9909                   MOVE 0        TO V2
  9910                END-IF
  9911                IF V1 = 10
  9912                   MOVE 9        TO V2
  9913                END-IF
  9914                IF WS-WORK-VIN (V1:1) NUMERIC
  9915                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9916                    + (WS-WORK-VIN-N (V1) * V2)
  9917                ELSE
  9918                   MOVE WS-WORK-VIN (V1:1)
  9919                                 TO WS-HEX-BYTE
  9920                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9921                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9922                    + (WS-NUM (V3) * V2)
  9923                END-IF
  9924                COMPUTE V2 = V2 - 1
  9925             END-IF
  9926          END-PERFORM
  9927          MOVE ZEROS TO WS-VIN-REMAINDER
  9928          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9929             REMAINDER WS-VIN-REMAINDER
  9930          IF ((WS-WORK-VIN (9:1) = 'X')
  9931             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 183
* EL050.cbl
  9932                     OR
  9933             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9934             CONTINUE
  9935          ELSE
  9936             MOVE ER-3826        TO WS-ERROR
  9937             PERFORM 9900-ERROR-FORMAT
  9938                                 THRU 9900-EXIT
  9939          END-IF
  9940        ELSE
  9941          MOVE ER-3826           TO WS-ERROR
  9942          PERFORM 9900-ERROR-FORMAT
  9943                                 THRU 9900-EXIT
  9944        END-IF
  9945     END-IF
  9946******************************************************************
  9947******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9948******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9949******* METHODS.
  9950******************************************************************
  9951     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9952        IF PB-CANCELLATION
  9953           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9954              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9955                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9956                IF FORM-MASTER-FOUND
  9957                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9958******************************************************************
  9959
  9960     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9961     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9962
  9963     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9964     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9965     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9966     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9967
  9968
  9969     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9970     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9971     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9972
  9973     IF AM-LF-OB-RATE NOT NUMERIC
  9974         MOVE ZERO               TO AM-LF-OB-RATE.
  9975
  9976     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9977         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9978
  9979     IF AM-AH-OB-RATE NOT NUMERIC
  9980         MOVE ZERO               TO AM-AH-OB-RATE.
  9981
  9982     IF WS-LF-JOINT-INDICATOR = 'J'
  9983         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9984     ELSE
  9985         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9986
  9987     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9988
  9989     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 184
* EL050.cbl
  9990         MOVE AM-IG              TO WS-IG-OVRD-AM.
  9991
  9992     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
  9993         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
  9994                                       WS-IG-OVRD
  9995     ELSE
  9996         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
  9997             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
  9998                                       WS-IG-OVRD
  9999         ELSE
 10000             MOVE AM-IG             TO WS-IG-OVRD-AH
 10001                                       WS-IG-OVRD.
 10002
 10003     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10004         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10005                                       WS-IG-OVRD
 10006     ELSE
 10007         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10008             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10009                                       WS-IG-OVRD
 10010         ELSE
 10011             MOVE AM-IG             TO WS-IG-OVRD-LF
 10012                                       WS-IG-OVRD.
 10013
 10014     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10015     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10016     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10017     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10018     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10019
 10020     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10021     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10022     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10023     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10024
 10025     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10026     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10027     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10028     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10029     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10030     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10031     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10032
 10033     IF WS-ACCT-AH-DEV-PCT > +0
 10034        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10035     ELSE
 10036        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10037
 10038     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10039        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10040     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10041        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10042
 10043        IF AM-EARN-METHOD-L = 'S'
 10044            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10045                                        WS-LF-REFUND-CALC.
 10046
 10047        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 185
* EL050.cbl
 10048            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10049                                        WS-LF-REFUND-CALC.
 10050
 10051     IF WS-LF-COVERAGE-TYPE = 'R'
 10052         IF AM-EARN-METHOD-R = 'R'
 10053            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10054                                    WS-LF-REFUND-CALC.
 10055     IF WS-LF-COVERAGE-TYPE = 'R'
 10056         IF AM-EARN-METHOD-R = 'P'
 10057            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10058                                    WS-LF-REFUND-CALC.
 10059     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10060         IF AM-EARN-METHOD-L = 'R'
 10061            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10062                                    WS-LF-REFUND-CALC.
 10063     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10064         IF AM-EARN-METHOD-L = 'P'
 10065            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10066                                    WS-LF-REFUND-CALC.
 10067     IF WS-LF-COVERAGE-TYPE = 'R'
 10068         IF AM-EARN-METHOD-R = 'A'
 10069            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10070                                    WS-LF-REFUND-CALC.
 10071     IF WS-LF-COVERAGE-TYPE = 'R'
 10072         IF AM-EARN-METHOD-R = 'M'
 10073            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10074                                    WS-LF-REFUND-CALC.
 10075     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10076         IF AM-EARN-METHOD-L = 'A'
 10077            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10078                                    WS-LF-REFUND-CALC.
 10079     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10080         IF AM-EARN-METHOD-L = 'M'
 10081            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10082                                    WS-LF-REFUND-CALC.
 10083
 10084     IF AM-EARN-METHOD-A = 'R'
 10085        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10086                                    WS-AH-REFUND-CALC.
 10087     IF AM-EARN-METHOD-A = 'P'
 10088        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10089                                    WS-AH-REFUND-CALC.
 10090     IF AM-EARN-METHOD-A = 'C'
 10091        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10092                                    WS-AH-REFUND-CALC.
 10093     IF AM-EARN-METHOD-A = 'A'
 10094        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10095                                    WS-AH-REFUND-CALC.
 10096     IF AM-EARN-METHOD-A = 'M'
 10097        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10098                                    WS-AH-REFUND-CALC.
 10099     IF AM-EARN-METHOD-A = 'N'
 10100        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10101                                    WS-AH-REFUND-CALC.
 10102     IF AM-EARN-METHOD-A = 'S'
 10103        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10104                                    WS-AH-REFUND-CALC.
 10105
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 186
* EL050.cbl
 10106     IF AM-TOL-PREM NOT = ZEROS
 10107        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10108                                    WS-TOL-AH-PREM.
 10109
 10110     IF AM-OVR-SHT-AMT NUMERIC AND
 10111                  AM-OVR-SHT-AMT > 0
 10112        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10113                                    EC-AM-LF-OVR-SHT-AMT
 10114                                    WS-AH-REFUND-OVS-AMT
 10115                                    EC-AM-AH-OVR-SHT-AMT.
 10116
 10117     IF AM-OVR-SHT-PCT NUMERIC AND
 10118                    AM-OVR-SHT-PCT > 0
 10119        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10120                                    EC-AM-LF-OVR-SHT-PCT
 10121                                    WS-AH-REFUND-OVS-PCT
 10122                                    EC-AM-AH-OVR-SHT-PCT.
 10123
 10124     IF AM-TOL-REF-PCT NUMERIC AND
 10125                  AM-TOL-REF-PCT > 0
 10126        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10127                                    WS-TOL-AH-REFUND-PCT.
 10128
 10129     IF AM-TOL-REF  NOT = ZEROS  AND
 10130                  AM-TOL-REF NUMERIC
 10131        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10132                                    EC-AM-LF-TOL-REFUND
 10133                                    WS-TOL-AH-REFUND
 10134                                    EC-AM-AH-TOL-REFUND.
 10135
 10136     IF AM-TOL-CLM  NOT = ZEROS
 10137        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10138                                    WS-TOL-AH-CLAIM.
 10139
 10140     IF AM-CLP-TOL-PCT NOT NUMERIC
 10141        MOVE +0                  TO AM-CLP-TOL-PCT
 10142     END-IF
 10143
 10144     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10145        MOVE +0                  TO AM-SPP-LEASE-COMM
 10146     END-IF
 10147     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10148        MOVE WS-PL-TOL-LF-PREM-PCT
 10149                                 TO WS-TOL-LF-PREM-PCT.
 10150
 10151     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10152        MOVE WS-PL-TOL-AH-PREM-PCT
 10153                                 TO WS-TOL-AH-PREM-PCT.
 10154
 10155     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10156        MOVE WS-PL-TOL-LF-REFUND-PCT
 10157                                 TO WS-TOL-LF-REFUND-PCT.
 10158
 10159     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10160        MOVE WS-PL-TOL-AH-REFUND-PCT
 10161                                 TO WS-TOL-AH-REFUND-PCT.
 10162
 10163     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 187
* EL050.cbl
 10164        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10165
 10166     IF WS-PL-REF-OVS-PCT > +0
 10167        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10168
 10169     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10170        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10171     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10172        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10173     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10174        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10175     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10176        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10177     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10178        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10179     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10180        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10181
 10182     IF WS-AH-PL-REF-OVS-AMT > +0
 10183        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10184
 10185     IF WS-AH-PL-REF-OVS-PCT > +0
 10186        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10187
 10188     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10189     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10190
 10191     IF PB-CANCELLATION
 10192        GO TO 3000-CONTINUE-EDIT.
 10193
 10194     MOVE +1 TO SUB1.
 10195     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10196     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10197
 10198     IF CF-COMPANY-ID = 'DMD'
 10199       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10200         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10201        ELSE
 10202         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10203
 10204  0525-FIND-ACCT-COMM.
 10205     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10206        NEXT SENTENCE
 10207      ELSE
 10208         ADD +1 TO SUB1
 10209         IF SUB1 LESS +11
 10210            GO TO 0525-FIND-ACCT-COMM
 10211          ELSE
 10212             GO TO 0560-EDIT-CONTINUE.
 10213
 10214     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10215     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10216                                    PB-I-LIFE-COMMISSION.
 10217***  IF PB-COMPANY-ID = 'CRI'
 10218     IF PB-PREM-ACCTNG-ONLY
 10219         GO TO 0560-EDIT-CONTINUE.
 10220
 10221     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 188
* EL050.cbl
 10222     MOVE ' '    TO WS-CTBL-READ-SW.
 10223
 10224
 10225 0530-GET-AH-COMP.
 10226     IF NO-AH-COVERAGE  OR
 10227        NO-AH-BENEFIT-MATCH
 10228           GO TO 0540-NEXT-READ-STEP.
 10229
 10230     IF AM-A-COM (SUB1) NUMERIC
 10231        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10232         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10233         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10234         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10235         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10236     ELSE
 10237          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10238          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10239          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10240          MOVE ZEROS             TO WS-SUB1
 10241                                    WS-COMMISSION
 10242          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10243          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10244          IF WS-COMMISSION > ZEROS
 10245             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10246             GO TO 0540-NEXT-READ-STEP
 10247          END-IF
 10248          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10249          IF CTBL-TABLE-FOUND
 10250             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10251                                        PB-I-AH-TERM
 10252             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10253             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10254             GO TO 0540-NEXT-READ-STEP
 10255          ELSE
 10256             IF FIRST-TIME-THROUGH
 10257                 GO TO 0530-GET-AH-COMP
 10258             ELSE
 10259                 MOVE ER-2609                TO WS-ERROR
 10260                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10261
 10262 0540-NEXT-READ-STEP.
 10263     MOVE '0540' TO CTBL-SW.
 10264     MOVE ' '    TO WS-CTBL-READ-SW.
 10265
 10266 0540-GET-LF-COMP.
 10267     IF NO-LIFE-COVERAGE  OR
 10268        NO-LF-BENEFIT-MATCH
 10269           GO TO 0560-EDIT-CONTINUE.
 10270
 10271     IF WS-LF-JOINT-INDICATOR = 'J'
 10272        IF AM-J-COM (SUB1) NUMERIC
 10273           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10274           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10275           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10276           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10277           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10278        ELSE
 10279           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 189
* EL050.cbl
 10280           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10281           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10282           MOVE ZEROS                TO WS-SUB1
 10283                                        WS-COMMISSION
 10284           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10285           IF WS-COMMISSION > ZEROS
 10286              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10287              GO TO 0560-EDIT-CONTINUE
 10288           END-IF
 10289           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10290           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10291           IF CTBL-TABLE-FOUND
 10292              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10293              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10294              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10295              GO TO 0560-EDIT-CONTINUE
 10296           ELSE
 10297              IF FIRST-TIME-THROUGH
 10298                  GO TO 0540-GET-LF-COMP
 10299              ELSE
 10300                  MOVE ER-2609                TO WS-ERROR
 10301                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10302                  GO TO 0560-EDIT-CONTINUE.
 10303
 10304     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10305        IF AM-L-COM (SUB1) NUMERIC
 10306           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10307           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10308           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10309           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10310           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10311        ELSE
 10312           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10313           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10314           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10315           MOVE ZEROS                TO WS-SUB1
 10316                                        WS-COMMISSION
 10317           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10318           IF WS-COMMISSION IS GREATER THAN ZEROS
 10319              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10320              GO TO 0560-EDIT-CONTINUE
 10321           END-IF
 10322           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10323           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10324           IF CTBL-TABLE-FOUND
 10325              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10326              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10327              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10328              GO TO 0560-EDIT-CONTINUE
 10329           ELSE
 10330              IF FIRST-TIME-THROUGH
 10331                  GO TO 0540-GET-LF-COMP
 10332              ELSE
 10333                  MOVE ER-2609                TO WS-ERROR
 10334                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10335
 10336*    GO TO 0560-EDIT-CONTINUE.
 10337
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 190
* EL050.cbl
 10338 0560-EDIT-CONTINUE.
 10339     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10340                                    WS-AH-PMF-COMM
 10341*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10342*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10343     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10344        (SUB1 > +10)
 10345        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10346           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10347           MOVE '0530'           TO CTBL-SW
 10348           MOVE ' '              TO WS-CTBL-READ-SW
 10349           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10350           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10351           MOVE '0540'           TO CTBL-SW
 10352           MOVE ' '              TO WS-CTBL-READ-SW
 10353           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10354        END-IF
 10355     END-PERFORM
 10356     GO TO 0564-EDIT-CONTINUE
 10357     .
 10358 0561-CHECK-AH.
 10359     IF (NO-AH-COVERAGE)
 10360        OR (NO-AH-BENEFIT-MATCH)
 10361        CONTINUE
 10362     ELSE
 10363        IF (AM-A-COM (SUB1) NUMERIC)
 10364           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10365           IF (AM-COM-TYP (SUB1) = 'A')
 10366              AND (WS-AH-PMF-COMM = ZEROS)
 10367              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10368           END-IF
 10369           CONTINUE
 10370        ELSE
 10371           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10372           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10373           MOVE PB-AH-OVERRIDE-L1
 10374                                 TO CTBL-BEN-TYPE
 10375           MOVE ZEROS            TO WS-SUB1
 10376                                    WS-COMMISSION
 10377           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10378           PERFORM 8300-READ-CTBL-TABLE
 10379                                 THRU 8300-EXIT
 10380           IF CTBL-TABLE-FOUND
 10381              IF (AM-COM-TYP (SUB1) = 'A')
 10382                 AND (WS-AH-PMF-COMM = ZEROS)
 10383                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10384                                        PB-I-AH-TERM
 10385                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10386                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10387              END-IF
 10388              CONTINUE
 10389           ELSE
 10390              IF FIRST-TIME-THROUGH
 10391                 GO TO 0561-CHECK-AH
 10392              ELSE
 10393                 MOVE ER-2609    TO WS-ERROR
 10394                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10395              END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 191
* EL050.cbl
 10396           END-IF
 10397        END-IF
 10398     END-IF
 10399     .
 10400 0561-EXIT.
 10401     EXIT.
 10402 0563-CHECK-LF.
 10403     IF (NO-LIFE-COVERAGE)
 10404        OR (NO-LF-BENEFIT-MATCH)
 10405        CONTINUE
 10406     ELSE
 10407        IF WS-LF-JOINT-INDICATOR = 'J'
 10408           IF AM-J-COM (SUB1) NUMERIC
 10409              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10410              IF (AM-COM-TYP (SUB1) = 'A')
 10411                 AND (WS-LF-PMF-COMM = ZEROS)
 10412                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10413              END-IF
 10414              CONTINUE
 10415           ELSE
 10416              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10417              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10418              MOVE PB-LIFE-OVERRIDE-L1
 10419                                 TO CTBL-BEN-TYPE
 10420              MOVE ZEROS         TO WS-SUB1
 10421                                    WS-COMMISSION
 10422              MOVE AM-J-COMA (SUB1)
 10423                                 TO CTBL-TABLE
 10424              PERFORM 8300-READ-CTBL-TABLE
 10425                                 THRU 8300-EXIT
 10426              IF CTBL-TABLE-FOUND
 10427                 IF (AM-COM-TYP (SUB1) = 'A')
 10428                    AND (WS-LF-PMF-COMM = ZEROS)
 10429                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10430                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10431                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10432                 END-IF
 10433                 CONTINUE
 10434              ELSE
 10435                 IF FIRST-TIME-THROUGH
 10436                    GO TO 0563-CHECK-LF
 10437                 ELSE
 10438                    MOVE ER-2609 TO WS-ERROR
 10439                    PERFORM 9900-ERROR-FORMAT
 10440                                 THRU 9900-EXIT
 10441*                   GO TO 0560-EDIT-CONTINUE
 10442                 END-IF
 10443              END-IF
 10444           END-IF
 10445        ELSE
 10446           IF AM-L-COM (SUB1) NUMERIC
 10447              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10448              IF (AM-COM-TYP (SUB1) = 'A')
 10449                 AND (WS-LF-PMF-COMM = ZEROS)
 10450                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10451              END-IF
 10452              CONTINUE
 10453           ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 192
* EL050.cbl
 10454              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10455              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10456              MOVE PB-LIFE-OVERRIDE-L1
 10457                                 TO CTBL-BEN-TYPE
 10458              MOVE ZEROS         TO WS-SUB1
 10459                                    WS-COMMISSION
 10460              MOVE AM-L-COMA (SUB1)
 10461                                 TO CTBL-TABLE
 10462              PERFORM 8300-READ-CTBL-TABLE
 10463                                 THRU 8300-EXIT
 10464              IF CTBL-TABLE-FOUND
 10465                 CONTINUE
 10466              ELSE
 10467                 IF FIRST-TIME-THROUGH
 10468                    GO TO 0563-CHECK-LF
 10469                 ELSE
 10470                    MOVE ER-2609 TO WS-ERROR
 10471                    PERFORM 9900-ERROR-FORMAT
 10472                                 THRU 9900-EXIT
 10473                 END-IF
 10474              END-IF
 10475           END-IF
 10476        END-IF
 10477     END-IF
 10478     .
 10479 0563-EXIT.
 10480     EXIT.
 10481 0564-EDIT-CONTINUE.
 10482
 10483     IF  PB-COMPANY-ID EQUAL 'DMD'
 10484         IF PB-I-NUM-BILLED EQUAL ZEROS
 10485            MOVE ER-8148       TO WS-ERROR
 10486            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10487
 10488*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10489*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10490*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10491*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10492*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10493*         IF NO-CONVERSION-ERROR
 10494*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10495*         ELSE
 10496*             IF PB-COMPANY-ID EQUAL 'HAN'
 10497*                 MOVE ZEROS     TO PB-I-AGE.
 10498     IF PB-I-BIRTHDAY > LOW-VALUES
 10499        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10500        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10501        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10502        PERFORM 8500-DATE-CONVERT
 10503                                 THRU 8500-EXIT
 10504        IF NO-CONVERSION-ERROR
 10505           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10506           IF PB-I-AGE > ZEROS
 10507              IF WS-WORK-AGE NOT = PB-I-AGE
 10508                 MOVE ER-9501    TO WS-ERROR
 10509                 PERFORM 9900-ERROR-FORMAT
 10510                                 THRU 9900-EXIT
 10511              END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 193
* EL050.cbl
 10512           ELSE
 10513              MOVE WS-WORK-AGE   TO PB-I-AGE
 10514           END-IF
 10515        END-IF
 10516     END-IF
 10517     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10518                                   WS-INS-AGE-SET
 10519     IF PB-I-AGE = ZEROS
 10520        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10521           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10522                                   WS-INS-AGE-SET
 10523           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10524
 10525     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10526                                   WS-AH-EDIT-AGE.
 10527
 10528     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10529        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10530        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10531        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10532        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10533        IF NO-CONVERSION-ERROR
 10534           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10535           IF PB-I-JOINT-AGE > 0
 10536              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10537                 MOVE ER-9503    TO WS-ERROR
 10538                 PERFORM 9900-ERROR-FORMAT
 10539                                 THRU 9900-EXIT
 10540              END-IF
 10541           ELSE
 10542              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10543           END-IF
 10544        ELSE
 10545           MOVE ZEROS            TO PB-I-JOINT-AGE
 10546        END-IF
 10547     END-IF
 10548     IF PB-I-JOINT-AGE NOT NUMERIC
 10549        MOVE ZERO               TO PB-I-JOINT-AGE.
 10550
 10551     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10552                                   WS-JNT-AGE-SET
 10553     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10554        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10555           (WS-AH-JOINT-INDICATOR = 'J')
 10556           IF PB-I-JOINT-AGE = ZEROS
 10557               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10558                                          WS-JNT-AGE-SET
 10559               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10560           END-IF
 10561        END-IF
 10562     END-IF
 10563
 10564     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10565     IF WS-LF-JOINT-INDICATOR = 'J'
 10566        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10567        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10568            IF  PB-I-JOINT-AGE = ZERO
 10569                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 194
* EL050.cbl
 10570                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10571            ELSE
 10572                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10573                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10574                    IF PB-COMPANY-ID NOT = 'LBL'
 10575                        MOVE ER-2685    TO WS-ERROR
 10576                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10577
 10578     IF WS-AH-JOINT-INDICATOR = 'J'
 10579        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10580            IF  PB-I-JOINT-AGE = ZERO
 10581                MOVE ER-2686       TO WS-ERROR
 10582                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10583            ELSE
 10584                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10585                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10586                                           WS-EDIT-AGE
 10587                    IF PB-COMPANY-ID NOT = 'LBL'
 10588                        MOVE ER-2685    TO WS-ERROR
 10589                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10590
 10591******************************************************************
 10592*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10593******************************************************************
 10594
 10595     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10596        (WS-AH-SPECIAL-CALC-CD = 'O')
 10597        NEXT SENTENCE
 10598     ELSE
 10599        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10600          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10601           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10602            WS-AH-JOINT-INDICATOR = 'J')  AND
 10603           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10604            MOVE ER-2627             TO WS-ERROR
 10605            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10606
 10607     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10608        (WS-AH-SPECIAL-CALC-CD = 'O')
 10609         NEXT SENTENCE
 10610     ELSE
 10611         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10612            WS-AH-JOINT-INDICATOR = 'J'
 10613             IF PB-I-JOINT-INSURED = SPACES
 10614                 IF PB-COMPANY-ID NOT = 'JAL'
 10615                     MOVE ER-2696    TO WS-ERROR
 10616                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10617
 10618     IF PB-COMPANY-ID NOT = 'BOA'
 10619        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10620           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10621           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10622               PB-I-JOINT-INSURED NOT = SPACES)
 10623                MOVE ER-2691         TO WS-ERROR
 10624                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10625
 10626     IF PB-COMPANY-ID = 'BOA'
 10627        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 195
* EL050.cbl
 10628           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10629            IF PB-I-JOINT-AGE NOT = ZEROS
 10630                MOVE ER-2691         TO WS-ERROR
 10631                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10632
 10633     IF PB-COMPANY-ID = 'CRI'
 10634        IF PB-I-SIG-SW = 'J'
 10635           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10636              WS-AH-JOINT-INDICATOR NOT = 'J'
 10637              MOVE ER-2675       TO WS-ERROR
 10638              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10639
 10640     IF PB-COMPANY-ID = 'CRI'
 10641        IF PB-I-SIG-SW = 'S'
 10642           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10643              WS-AH-JOINT-INDICATOR = 'J'
 10644              MOVE ER-2676       TO WS-ERROR
 10645              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10646
 10647     IF PB-COMPANY-ID = 'CVL'
 10648         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10649            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10650              MOVE ER-2783           TO WS-ERROR
 10651              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10652     IF (WS-LF-JOINT-INDICATOR = 'J')
 10653        AND (WS-AH-JOINT-INDICATOR = 'J')
 10654        AND (PB-I-LF-TERM > 120)
 10655        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10656        MOVE ER-2783             TO WS-ERROR
 10657        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10658     END-IF
 10659     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10660
 10661     IF PB-I-INDV-GRP-OVRD = 'I'
 10662        MOVE ER-2666             TO WS-ERROR
 10663        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10664        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10665
 10666     IF PB-I-INDV-GRP-OVRD = 'G'
 10667        MOVE ER-2666             TO WS-ERROR
 10668        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10669        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10670
 10671     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10672        NEXT SENTENCE
 10673     ELSE
 10674        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10675
 10676     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10677        IF WS-ERROR = ER-2666
 10678           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10679           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10680
 10681     IF PB-COMPANY-ID = 'CID'
 10682        IF PB-STATE = 'UT' OR 'MO'
 10683           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10684                 OR '76' OR '77')
 10685                      OR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 196
* EL050.cbl
 10686               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10687                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10688                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10689                   OR '2K' OR '2L'))
 10690              AND PB-I-INDV-GRP-CD = 'I'
 10691              MOVE ER-2721             TO WS-ERROR
 10692              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10693           END-IF
 10694        END-IF
 10695     END-IF
 10696
 10697     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10698     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10699        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10700     ELSE
 10701        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10702     END-IF
 10703
 10704*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10705*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10706     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10707                                    ACCOUNT-AH-CK-SW.
 10708
 10709     IF PB-REISSUED-CERT       OR
 10710        PB-REIN-ONLY-CERT      OR
 10711        PB-POLICY-IS-DECLINED  OR
 10712        PB-POLICY-IS-VOIDED
 10713*       OR PB-MONTHLY-CERT
 10714         GO TO 3000-CONTINUE-EDIT.
 10715
 10716     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10717        IF WS-EDIT-AGE           > +65
 10718           MOVE ER-2709          TO WS-ERROR
 10719           PERFORM 9900-ERROR-FORMAT
 10720                                 THRU 9900-EXIT
 10721        ELSE
 10722           IF WS-EDIT-AGE        > +55
 10723              MOVE ER-2718       TO WS-ERROR
 10724              PERFORM 9900-ERROR-FORMAT
 10725                                 THRU 9900-EXIT
 10726           END-IF
 10727        END-IF
 10728     IF PB-COMPANY-ID = 'DCC'
 10729        IF WS-EDIT-AGE           > +65
 10730           MOVE ER-2709          TO WS-ERROR
 10731           PERFORM 9900-ERROR-FORMAT
 10732                                 THRU 9900-EXIT
 10733        END-IF
 10734     END-IF
 10735     .
 10736
 10737 0565-LIFE-PLAN-LIMIT-EDITS.
 10738
 10739     IF NOT LF-PLAN-MASTER-FOUND
 10740        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10741                                    EC-AM-LF-MAX-TOT-BEN
 10742        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10743
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 197
* EL050.cbl
 10744     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10745
 10746     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10747         IF PL-LM-AGE (1) = ZEROS
 10748             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10749
 10750     IF NO-LF-BENEFIT-MATCH          OR
 10751        WS-LF-BENEFIT-CD = ZEROS     OR
 10752        WS-LF-SPECIAL-CALC-CD = 'M'
 10753        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10754
 10755     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10756     MOVE +1                     TO SUB2.
 10757
 10758     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10759        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10760           MOVE +5   TO SUB2
 10761           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10762              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10763              (PL-LM-AGE (SUB2) EQUAL +0)
 10764              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10765              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10766
 10767     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10768
 10769     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10770                               + PB-I-LF-ALT-BENEFIT-AMT.
 10771
 10772 0568-CHECK-LIFE-ATT-AGE.
 10773
 10774     IF PL-ATT-AGE NUMERIC AND
 10775        PL-ATT-AGE > +0
 10776        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10777     END-IF
 10778*    IF PL-ATT-AGE NUMERIC AND
 10779*       PL-ATT-AGE > +0
 10780*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10781*       IF PB-I-BIRTHDAY > LOW-VALUES
 10782*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10783*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10784*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10785*          SET BIN-PLUS-ELAPSED  TO TRUE
 10786*          PERFORM 8500-DATE-CONVERT
 10787*                                THRU 8500-EXIT
 10788*          IF NO-CONVERSION-ERROR
 10789*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10790*             MOVE ER-2669       TO WS-ERROR
 10791*             PERFORM 9900-ERROR-FORMAT
 10792*                                THRU 9900-EXIT
 10793*          END-IF
 10794*       ELSE
 10795*          IF WS-ATT-AGE >= PL-ATT-AGE
 10796*             MOVE ER-2669       TO WS-ERROR
 10797*             PERFORM 9900-ERROR-FORMAT
 10798*                                THRU 9900-EXIT
 10799*          END-IF
 10800*       END-IF
 10801*    END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 198
* EL050.cbl
 10802     .
 10803 0570-CHECK-LIFE-LIMITS.
 10804
 10805     IF PB-COMPANY-ID EQUAL 'CRI'
 10806        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10807           IF SUB2 GREATER THAN +4
 10808              MOVE ER-2637 TO WS-ERROR
 10809              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10810              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10811
 10812     IF PB-COMPANY-ID  =  'NCL'
 10813        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10814            SUB2 GREATER THAN +8
 10815             MOVE 'U'         TO PB-BATCH-ENTRY
 10816             MOVE ER-2637     TO WS-ERROR
 10817             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10818             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10819
 10820     IF SUB2 > +8
 10821        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10822           AND (PB-I-SIG-SW = 'Y')
 10823           CONTINUE
 10824        ELSE
 10825           MOVE ER-2637          TO WS-ERROR
 10826           PERFORM 9900-ERROR-FORMAT
 10827                                 THRU 9900-EXIT
 10828        END-IF
 10829        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10830     END-IF
 10831     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10832     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10833     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10834
 10835     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10836        ADD +1  TO SUB2
 10837        GO TO 0570-CHECK-LIFE-LIMITS.
 10838
 10839     IF PB-COMPANY-ID = 'NCL'
 10840         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10841
 10842     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10843        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10844        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10845           AND (PB-I-SIG-SW = 'Y')
 10846           CONTINUE
 10847        ELSE
 10848           MOVE ER-2637          TO WS-ERROR
 10849           PERFORM 9900-ERROR-FORMAT
 10850                                 THRU 9900-EXIT
 10851        END-IF
 10852     END-IF
 10853     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10854
 10855
 10856 0570-CHECK-NCL-LIFE-LIMITS.
 10857
 10858     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10859        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 199
* EL050.cbl
 10860         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10861
 10862     IF APP-CERT-USED
 10863         IF SUB2  LESS THAN  +5
 10864             MOVE +5          TO SUB2
 10865             GO TO 0570-CHECK-LIFE-LIMITS.
 10866
 10867     MOVE ER-2637             TO WS-ERROR.
 10868     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10869
 10870     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10871
 10872 0575-CHECK-NCL-SIG-SWITCH.
 10873
 10874     IF NOT APP-CERT-USED
 10875         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10876
 10877     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10878        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10879        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10880        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10881         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10882
 10883     IF SUB2 GREATER THAN +4
 10884         IF PL-LM-AGE (5) = ZEROS  AND
 10885            PL-LM-AGE (6) = ZEROS  AND
 10886            PL-LM-AGE (7) = ZEROS  AND
 10887            PL-LM-AGE (8) = ZEROS
 10888             MOVE  ER-1927        TO WS-ERROR
 10889             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10890             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10891         ELSE
 10892             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10893                 MOVE  ER-1920    TO WS-ERROR
 10894                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10895
 10896     IF PB-I-SIG-SW  = 'Y'
 10897       IF NOT PB-I-POLICY-ACCEPTED  AND
 10898          NOT PB-I-POLICY-DECLINED
 10899           MOVE 'U'               TO PB-BATCH-ENTRY
 10900           MOVE  ER-1926          TO WS-ERROR
 10901           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10902
 10903
 10904 0580-AH-PLAN-LIMIT-EDITS.
 10905
 10906     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10907        IF PB-I-AH-BENEFIT-AMT > +1250
 10908           MOVE ER-2702          TO WS-ERROR
 10909           PERFORM 9900-ERROR-FORMAT
 10910                                 THRU 9900-EXIT
 10911        END-IF
 10912     END-IF
 10913
 10914     IF (PB-COMPANY-ID = 'DCC')
 10915        AND (PB-MONTHLY-CERT)
 10916        IF PB-I-AH-BENEFIT-AMT > +3000
 10917           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 200
* EL050.cbl
 10918           PERFORM 9900-ERROR-FORMAT
 10919                                 THRU 9900-EXIT
 10920        END-IF
 10921     END-IF
 10922     IF NOT AH-PLAN-MASTER-FOUND
 10923        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10924        GO TO 3000-CONTINUE-EDIT.
 10925
 10926     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10927
 10928     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10929         IF PL-LM-AGE (1) = ZEROS
 10930             GO TO 3000-CONTINUE-EDIT.
 10931
 10932     IF NO-AH-BENEFIT-MATCH          OR
 10933        WS-AH-BENEFIT-CD = ZEROS     OR
 10934        WS-AH-SPECIAL-CALC-CD = 'M'
 10935        GO TO 3000-CONTINUE-EDIT.
 10936
 10937     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10938     MOVE +1                     TO SUB2.
 10939
 10940     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10941        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10942           MOVE +5 TO SUB2
 10943           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10944              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10945              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10946              (PL-LM-AGE (SUB2) EQUAL +0)
 10947              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10948              GO TO 3000-CONTINUE-EDIT.
 10949
 10950     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10951
 10952 0590-CHECK-AH-ATT-AGE.
 10953
 10954     IF PL-ATT-AGE NUMERIC AND
 10955        PL-ATT-AGE GREATER THAN +0
 10956        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10957     END-IF
 10958*       IF WS-ATT-AGE >= PL-ATT-AGE
 10959*          MOVE ER-3054          TO WS-ERROR
 10960*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10961     .
 10962 0597-CHECK-AH-LIMITS.
 10963
 10964     IF PB-COMPANY-ID EQUAL 'CRI'
 10965        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10966           IF SUB2 GREATER THAN +4
 10967              MOVE ER-2638       TO WS-ERROR
 10968              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10969              GO TO 3000-CONTINUE-EDIT.
 10970
 10971     IF PB-COMPANY-ID  =  'NCL'
 10972        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10973            SUB2 GREATER THAN +8
 10974             MOVE 'U'            TO PB-BATCH-ENTRY
 10975             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 201
* EL050.cbl
 10976             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10977             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10978
 10979     IF SUB2 > +8
 10980        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10981           AND (PB-I-SIG-SW = 'Y')
 10982           CONTINUE
 10983        ELSE
 10984           MOVE ER-2638          TO WS-ERROR
 10985           PERFORM 9900-ERROR-FORMAT
 10986                                 THRU 9900-EXIT
 10987        END-IF
 10988        GO TO 3000-CONTINUE-EDIT
 10989     END-IF
 10990
 10991     IF PB-COMPANY-ID = 'CRI'
 10992        IF WS-ERROR = ER-2638
 10993           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 10994
 10995     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 10996     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 10997     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 10998     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 10999
 11000     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11001        ADD +1                   TO SUB2
 11002        GO TO 0597-CHECK-AH-LIMITS.
 11003
 11004     IF PB-COMPANY-ID = 'NCL'
 11005         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11006
 11007     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11008        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11009        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11010                                 > PL-LM-AMT (SUB2))
 11011        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11012           AND (PB-I-SIG-SW = 'Y')
 11013           CONTINUE
 11014        ELSE
 11015           MOVE ER-2638          TO WS-ERROR
 11016           PERFORM 9900-ERROR-FORMAT
 11017                                 THRU 9900-EXIT
 11018        END-IF
 11019     END-IF
 11020
 11021     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11022         IF  WS-ERROR    EQUAL    ER-2638
 11023             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11024                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11025                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11026                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11027                MOVE  ER-1910    TO  WS-ERROR
 11028                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11029
 11030     IF PB-COMPANY-ID = 'CRI'
 11031        IF WS-ERROR = ER-2638
 11032            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11033            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 202
* EL050.cbl
 11034            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11035
 11036     GO TO 3000-CONTINUE-EDIT.
 11037
 11038 0597-CHECK-NCL-AH-LIMITS.
 11039
 11040     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11041        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11042        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11043                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11044         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11045
 11046     IF APP-CERT-USED
 11047         IF SUB2  LESS THAN  +5
 11048             MOVE +5             TO SUB2
 11049             GO TO 0597-CHECK-AH-LIMITS.
 11050
 11051     MOVE ER-2638                TO WS-ERROR.
 11052     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11053
 11054     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11055
 11056 0599-CHECK-NCL-SIG-SWITCH.
 11057
 11058     IF NOT APP-CERT-USED
 11059         GO TO 3000-CONTINUE-EDIT.
 11060
 11061     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11062        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11063        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11064        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11065         GO TO 3000-CONTINUE-EDIT.
 11066
 11067     IF SUB2 GREATER THAN +4
 11068         IF PL-LM-AGE (5) = ZEROS  AND
 11069            PL-LM-AGE (6) = ZEROS  AND
 11070            PL-LM-AGE (7) = ZEROS  AND
 11071            PL-LM-AGE (8) = ZEROS
 11072             MOVE  ER-1927        TO WS-ERROR
 11073             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11074             GO TO 3000-CONTINUE-EDIT
 11075         ELSE
 11076             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11077                 MOVE  ER-1920    TO WS-ERROR
 11078                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11079
 11080     IF PB-I-SIG-SW  = 'Y'
 11081       IF NOT PB-I-POLICY-ACCEPTED  AND
 11082          NOT PB-I-POLICY-DECLINED
 11083           MOVE 'U'               TO PB-BATCH-ENTRY
 11084           MOVE  ER-1926          TO WS-ERROR
 11085           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11086
 11087******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 203
* EL050.cbl
 11089
 11090 3000-CONTINUE-EDIT.
 11091
 11092     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11093     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11094     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11095     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11096     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11097
 11098     IF BROWSE-STARTED
 11099        PERFORM 9990-RETURN THRU 9990-EXIT
 11100        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11101
 11102     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11103        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11104        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11105        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11106*       MOVE 1                   TO DC-OPTION-CODE
 11107        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11108        IF DATE-CONVERSION-ERROR
 11109           MOVE ER-2622          TO WS-ERROR
 11110           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11111        ELSE
 11112           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11113              MOVE ER-2623       TO WS-ERROR
 11114              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11115           ELSE
 11116              MOVE ER-2622       TO WS-ERROR
 11117              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11118
 11119     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11120     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11121     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11122*    MOVE 1                      TO DC-OPTION-CODE.
 11123     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11124     IF DATE-CONVERSION-ERROR
 11125        GO TO 3005-EDIT-CONTINUE
 11126     ELSE
 11127        IF DC-ELAPSED-DAYS GREATER +180
 11128           MOVE ER-2613          TO WS-ERROR
 11129           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11130        ELSE
 11131           IF DC-ELAPSED-DAYS GREATER +90
 11132              MOVE ER-2612       TO WS-ERROR
 11133              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11134           ELSE
 11135             IF DC-ELAPSED-DAYS GREATER +60
 11136                MOVE ER-2614     TO WS-ERROR
 11137                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11138
 11139 3005-EDIT-CONTINUE.
 11140
 11141     IF PB-CANCELLATION
 11142         GO TO 3700-EDIT-CANCEL.
 11143
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 204
* EL050.cbl
 11145******************************************************************
 11146*                  E D I T   I S S U E                           *
 11147******************************************************************
 11148
 11149 3020-EDIT-ISSUE.
 11150
 11151      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11152      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11153      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11154      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11155      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11156
 11157     IF PB-ISSUE-FORCE
 11158        OR PB-ISSUE-DATE-FORCED
 11159        OR PB-FORCE-OFF
 11160        OR PB-OVERCHARGE-FORCE
 11161        CONTINUE
 11162     ELSE
 11163        MOVE ER-2670             TO WS-ERROR
 11164        PERFORM 9900-ERROR-FORMAT
 11165                                 THRU 9900-EXIT
 11166     END-IF
 11167     .
 11168 3022-SET-POLICY-STATUS.
 11169
 11170     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11171
 11172     IF (PB-REISSUED-CERT)
 11173             OR
 11174        ((PB-COMPANY-ID NOT = 'DCC')
 11175         AND (PB-MONTHLY-CERT))
 11176         MOVE '5'                TO PB-I-ENTRY-STATUS
 11177         MOVE 'E'                TO PB-BATCH-ENTRY
 11178     END-IF
 11179
 11180     IF PB-COMPANY-ID = 'DCC'
 11181        IF PB-MONTHLY-CERT
 11182           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11183        END-IF
 11184     END-IF
 11185     IF PB-POLICY-IS-DECLINED
 11186         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11187     IF PB-POLICY-IS-VOIDED
 11188         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11189     IF PB-NEEDS-UNDERWRITING
 11190         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11191     IF PB-REIN-ONLY-CERT
 11192         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11193     IF PB-PREM-ACCTNG-ONLY
 11194         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11195
 11196     MOVE SPACE                  TO PB-I-OB-FLAG.
 11197
 11198     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11199         MOVE ER-2665            TO WS-ERROR
 11200         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11201         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11202
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 205
* EL050.cbl
 11203     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11204        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11205           MOVE 'Z'             TO PB-I-OB-FLAG.
 11206
 11207     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11208        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11209           MOVE 'Z'             TO PB-I-OB-FLAG.
 11210
 11211     IF ACCOUNT-MAST-FOUND
 11212         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11213         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11214         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11215         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11216         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11217         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11218         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11219     END-IF
 11220
 11221     IF ACCOUNT-MAST-FOUND
 11222        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11223         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11224
 11225     IF (ACCOUNT-MAST-FOUND)
 11226        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11227        IF PB-REISSUED-CERT
 11228           CONTINUE
 11229        ELSE
 11230           MOVE ER-2608          TO WS-ERROR
 11231           PERFORM 9900-ERROR-FORMAT
 11232                                 THRU 9900-EXIT
 11233         END-IF
 11234     END-IF
 11235
 11236     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11237        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11238        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11239
 11240**********   DMD CUSTOM CODE FOLLOWS  **********
 11241 3024-EDIT-DMD-FIELDS.
 11242     IF PB-COMPANY-ID NOT = 'DMD'
 11243        GO TO 3025-EDIT-REINSURANCE.
 11244
 11245*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11246*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11247*** ERROR IF THEY ARE NOT EQUAL.
 11248
 11249     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11250     SET BIN-TO-GREG               TO TRUE.
 11251     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11252     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11253**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11254
 11255     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11256     SET BIN-TO-GREG               TO TRUE.
 11257     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11258     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11259**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11260
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 206
* EL050.cbl
 11261     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11262        MOVE ER-8116               TO WS-ERROR
 11263        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11264
 11265     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11266
 11267     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11268                                      WK-FULL-CERT-NO.
 11269     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11270
 11271     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11272
 11273     IF PB-VALID-LIFE
 11274        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11275     ELSE
 11276        IF PB-VALID-AH
 11277          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11278
 11279
 11280     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11281     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11282     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11283                                      DCUA-UNDRWRTR-CODE
 11284                                      DCUA-UNDRWRTR-GROUP-CODE
 11285                                      DCUA-RETURN-CODE.
 11286
 11287****************************************************************
 11288*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11289***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11290***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11291***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11292***   TO THIS RECORD.                                        ***
 11293****************************************************************
 11294     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11295     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11296     IF DCUA-SUCCESSFUL-PROCESS
 11297        GO TO 3024-EDIT-DL7-CONT.
 11298
 11299     IF DCUA-RETURN-CODE EQUAL '01'
 11300        MOVE ER-8110               TO WS-ERROR
 11301        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11302        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11303        GO TO 3024-EDIT-DL7-CONT.
 11304
 11305     IF DCUA-RETURN-CODE EQUAL '02'
 11306        MOVE ER-8111               TO WS-ERROR
 11307        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11308        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11309        GO TO 3024-EDIT-DL7-CONT.
 11310
 11311     IF DCUA-RETURN-CODE EQUAL '03'
 11312        MOVE ER-8074               TO WS-ERROR
 11313        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11314        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11315        GO TO 3024-EDIT-DL7-CONT.
 11316
 11317     IF DCUA-RETURN-CODE EQUAL '04'
 11318        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 207
* EL050.cbl
 11319        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11320        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11321        GO TO 3024-EDIT-DL7-CONT.
 11322
 11323     IF DCUA-RETURN-CODE EQUAL '05'
 11324        MOVE ER-8076               TO WS-ERROR
 11325        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11326        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11327        GO TO 3024-EDIT-DL7-CONT.
 11328
 11329     IF DCUA-RETURN-CODE EQUAL '06'
 11330        MOVE ER-8077               TO WS-ERROR
 11331        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11332        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11333        GO TO 3024-EDIT-DL7-CONT.
 11334
 11335     IF DCUA-RETURN-CODE EQUAL '07'
 11336        MOVE ER-8078               TO WS-ERROR
 11337        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11338        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11339        GO TO 3024-EDIT-DL7-CONT.
 11340
 11341     IF DCUA-RETURN-CODE EQUAL 'E1'
 11342        MOVE ER-8079               TO WS-ERROR
 11343        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11344        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11345        GO TO 3024-EDIT-DL7-CONT.
 11346
 11347     IF DCUA-RETURN-CODE EQUAL 'E2'
 11348        MOVE ER-8080               TO WS-ERROR
 11349        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11350        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11351        GO TO 3024-EDIT-DL7-CONT.
 11352
 11353     IF DCUA-RETURN-CODE EQUAL 'E3'
 11354        MOVE ER-8098               TO WS-ERROR
 11355        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11356        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11357        GO TO 3024-EDIT-DL7-CONT.
 11358
 11359     IF DCUA-RETURN-CODE EQUAL 'C1'
 11360        MOVE ER-8099               TO WS-ERROR
 11361        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11362        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11363        GO TO 3024-EDIT-DL7-CONT.
 11364
 11365     IF DCUA-RETURN-CODE EQUAL 'U1'
 11366        MOVE ER-8109               TO WS-ERROR
 11367        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11368        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11369        GO TO 3024-EDIT-DL7-CONT.
 11370
 11371     IF DCUA-RETURN-CODE EQUAL 'N1'
 11372        MOVE ER-8112               TO WS-ERROR
 11373        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11374        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11375        GO TO 3024-EDIT-DL7-CONT.
 11376
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 208
* EL050.cbl
 11377     IF DCUA-RETURN-CODE EQUAL 'N2'
 11378        MOVE ER-8113               TO WS-ERROR
 11379        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11380        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11381        GO TO 3024-EDIT-DL7-CONT.
 11382
 11383     IF DCUA-RETURN-CODE EQUAL 'N3'
 11384        MOVE ER-8114               TO WS-ERROR
 11385        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11386        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11387        GO TO 3024-EDIT-DL7-CONT.
 11388
 11389     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11390     MOVE ER-8097                  TO WS-ERROR.
 11391     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11392     GO TO 3024-EDIT-DL7-CONT.
 11393
 11394 3024-EDIT-DL7-CONT.
 11395
 11396     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11397     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11398     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11399        NEXT SENTENCE
 11400     ELSE
 11401        MOVE ER-9263               TO WS-ERROR
 11402        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11403
 11404******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11405******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11406     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11407        NEXT SENTENCE
 11408     ELSE
 11409        MOVE ER-8039               TO WS-ERROR
 11410        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11411
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 209
* EL050.cbl
 11413****************************************************************
 11414*** VALIDATE STATE  : DLO022                                 ***
 11415****************************************************************
 11416     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11417     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11418
 11419     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11420     IF DVSC-SUCCESSFUL-EDIT
 11421        GO TO 3024-EDIT-DL22-CONT.
 11422
 11423     IF DVSC-RETURN-CODE EQUAL '01'
 11424        MOVE ER-8300               TO WS-ERROR
 11425        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11426        GO TO 3024-EDIT-DL22-CONT.
 11427
 11428     IF DVSC-RETURN-CODE EQUAL '02'
 11429        MOVE ER-8301               TO WS-ERROR
 11430        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11431        GO TO 3024-EDIT-DL22-CONT.
 11432
 11433     IF DVSC-RETURN-CODE EQUAL '03'
 11434        MOVE ER-8302               TO WS-ERROR
 11435        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11436        GO TO 3024-EDIT-DL22-CONT.
 11437
 11438     IF DVSC-RETURN-CODE EQUAL 'N1'
 11439        MOVE ER-8304               TO WS-ERROR
 11440        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11441        GO TO 3024-EDIT-DL22-CONT.
 11442
 11443     MOVE ER-8303                  TO WS-ERROR
 11444     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11445
 11446 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 210
* EL050.cbl
 11448****************************************************************
 11449*** VALIDATE LOAN OFFICER : DLO021                           ***
 11450****************************************************************
 11451
 11452     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11453     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11454     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11455     IF DVLO-SUCCESSFUL-EDIT
 11456        GO TO 3024-EDIT-DL21-CONT.
 11457
 11458     IF DVLO-RETURN-CODE EQUAL '01'
 11459        MOVE ER-8081               TO WS-ERROR
 11460        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11461        GO TO 3024-EDIT-DL21-CONT.
 11462
 11463     IF DVLO-RETURN-CODE EQUAL '02'
 11464        MOVE ER-8082               TO WS-ERROR
 11465        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11466        GO TO 3024-EDIT-DL21-CONT.
 11467
 11468     IF DVLO-RETURN-CODE EQUAL '03'
 11469        MOVE ER-8083               TO WS-ERROR
 11470        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11471        GO TO 3024-EDIT-DL21-CONT.
 11472
 11473     IF DVLO-RETURN-CODE EQUAL '04'
 11474        MOVE ER-8084               TO WS-ERROR
 11475        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11476        GO TO 3024-EDIT-DL21-CONT.
 11477
 11478     IF DVLO-RETURN-CODE EQUAL '05'
 11479        MOVE ER-8085               TO WS-ERROR
 11480        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11481        GO TO 3024-EDIT-DL21-CONT.
 11482
 11483     MOVE ER-7825                  TO WS-ERROR
 11484     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11485     GO TO 3024-EDIT-DL21-CONT.
 11486
 11487 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 211
* EL050.cbl
 11489
 11490****************************************************************
 11491*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11492****************************************************************
 11493
 11494     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11495     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11496     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11497     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11498     IF DIPF-SUCCESSFUL-EDIT
 11499        GO TO 3024-EDIT-DL02-CONT.
 11500
 11501     IF DIPF-RETURN-CODE EQUAL '01'
 11502        MOVE ER-8086               TO WS-ERROR
 11503        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11504        GO TO 3024-EDIT-DL02-CONT.
 11505
 11506     IF DIPF-RETURN-CODE EQUAL '02'
 11507        MOVE ER-8087               TO WS-ERROR
 11508        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11509        GO TO 3024-EDIT-DL02-CONT.
 11510
 11511     IF DIPF-RETURN-CODE EQUAL '03'
 11512        MOVE ER-8088               TO WS-ERROR
 11513        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11514        GO TO 3024-EDIT-DL02-CONT.
 11515
 11516     MOVE ER-8095                  TO WS-ERROR
 11517     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11518     GO TO 3024-EDIT-DL02-CONT.
 11519
 11520 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 212
* EL050.cbl
 11522
 11523****************************************************************
 11524*** VALIDATE BANK ID : DLO003                                ***
 11525****************************************************************
 11526
 11527     MOVE WK-GREG-CENT           TO WCG-CENT.
 11528     MOVE WK-GREG-YYMM           TO WCG-REST.
 11529     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11530        MOVE ER-8040               TO WS-ERROR
 11531        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11532
 11533     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11534     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11535     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11536     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11537     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11538     IF DVBI-SUCCESSFUL-EDIT
 11539        GO TO 3024-EDIT-DL03-CONT.
 11540
 11541     IF DVBI-RETURN-CODE EQUAL '01'
 11542        MOVE ER-8089               TO WS-ERROR
 11543        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11544        GO TO 3024-EDIT-DL03-CONT.
 11545
 11546     IF DVBI-RETURN-CODE EQUAL '02'
 11547        MOVE ER-8090               TO WS-ERROR
 11548        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11549        GO TO 3024-EDIT-DL03-CONT.
 11550
 11551     IF DVBI-RETURN-CODE EQUAL '03'
 11552        MOVE ER-8091               TO WS-ERROR
 11553        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11554        GO TO 3024-EDIT-DL03-CONT.
 11555
 11556     IF DVBI-RETURN-CODE EQUAL '04'
 11557        MOVE ER-8092               TO WS-ERROR
 11558        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11559        GO TO 3024-EDIT-DL03-CONT.
 11560
 11561     IF DVBI-RETURN-CODE EQUAL '05'
 11562        MOVE ER-8093               TO WS-ERROR
 11563        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11564        GO TO 3024-EDIT-DL03-CONT.
 11565
 11566     IF DVBI-RETURN-CODE EQUAL '06'
 11567        MOVE ER-8094               TO WS-ERROR
 11568        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11569        GO TO 3024-EDIT-DL03-CONT.
 11570
 11571     MOVE ER-8096                  TO WS-ERROR
 11572     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11573     GO TO 3024-EDIT-DL03-CONT.
 11574
 11575 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 213
* EL050.cbl
 11577
 11578     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11579        NEXT SENTENCE
 11580     ELSE
 11581        MOVE ER-8042               TO WS-ERROR
 11582        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11583
 11584     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11585     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11586     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11587
 11588     IF DMPF-RETURN-CODE = '01'
 11589        MOVE ER-8067               TO WS-ERROR
 11590        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11591        GO TO 3024-EDIT-DL01-CONT.
 11592
 11593     IF DMPF-RETURN-CODE = '02'
 11594        MOVE ER-8068               TO WS-ERROR
 11595        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11596        GO TO 3024-EDIT-DL01-CONT.
 11597
 11598     IF DMPF-RETURN-CODE = '03'
 11599        MOVE ER-8069               TO WS-ERROR
 11600        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11601        GO TO 3024-EDIT-DL01-CONT.
 11602
 11603     IF DMPF-RETURN-CODE = 'E1'
 11604        MOVE ER-8070               TO WS-ERROR
 11605        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11606        GO TO 3024-EDIT-DL01-CONT.
 11607
 11608     IF DMPF-RETURN-CODE = 'N1'
 11609        MOVE ER-8071               TO WS-ERROR
 11610        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11611        GO TO 3024-EDIT-DL01-CONT.
 11612
 11613     IF DMPF-RETURN-CODE NOT = 'OK'
 11614        MOVE ER-8072               TO WS-ERROR
 11615        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11616
 11617 3024-EDIT-DL01-CONT.
 11618******************************************************************
 11619***  VALIDATES RATE CODES : DLO017                             ***
 11620******************************************************************
 11621
 11622      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11623      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11624      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11625      IF DVRC-SUCCESSFUL-EDIT
 11626        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11627        GO TO 3024-CHECK-VALID-RATE.
 11628
 11629      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11630
 11631      IF DVRC-RETURN-CODE EQUAL '01'
 11632         MOVE ER-7817                   TO WS-ERROR
 11633         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11634         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 214
* EL050.cbl
 11635
 11636      IF DVRC-RETURN-CODE EQUAL '02'
 11637         MOVE ER-7818                   TO WS-ERROR
 11638         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11639         GO TO 3025-EDIT-REINSURANCE.
 11640
 11641      IF DVRC-RETURN-CODE EQUAL '03'
 11642         MOVE ER-7819                   TO WS-ERROR
 11643         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11644         GO TO 3025-EDIT-REINSURANCE.
 11645
 11646       MOVE ER-7820                     TO WS-ERROR.
 11647       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11648       GO TO 3025-EDIT-REINSURANCE.
 11649
 11650******************************************************************
 11651***  GET PREMIUM RATES : DLO011                                ***
 11652******************************************************************
 11653
 11654 3024-CHECK-VALID-RATE.
 11655
 11656     IF VALID-RATE-CODE
 11657        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11658        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11659        MOVE SPACES                TO DPRB-RETURN-CODE
 11660        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11661     ELSE
 11662         GO TO 3025-EDIT-REINSURANCE.
 11663
 11664      IF DPRB-SUCCESSFUL-PROCESS
 11665         IF PB-VALID-LIFE
 11666             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11667             GO TO 3025-EDIT-REINSURANCE
 11668         ELSE
 11669             IF PB-VALID-AH
 11670                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11671                 GO TO 3025-EDIT-REINSURANCE.
 11672
 11673      IF DPRB-RETURN-CODE EQUAL '01'
 11674         MOVE ER-7812                   TO WS-ERROR
 11675         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11676         GO TO 3025-EDIT-REINSURANCE.
 11677
 11678      IF DPRB-RETURN-CODE EQUAL '02'
 11679         MOVE ER-7813                   TO WS-ERROR
 11680         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11681         GO TO 3025-EDIT-REINSURANCE.
 11682
 11683      IF DPRB-RETURN-CODE EQUAL '03'
 11684         MOVE ER-7814                   TO WS-ERROR
 11685         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11686         GO TO 3025-EDIT-REINSURANCE.
 11687
 11688      IF DPRB-RETURN-CODE EQUAL '04'
 11689         IF NOT DPRB-1ST-TIME
 11690            MOVE ER-7815                   TO WS-ERROR
 11691            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11692            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 215
* EL050.cbl
 11693          ELSE
 11694         IF PB-VALID-LIFE
 11695            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11696          ELSE
 11697            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11698         END-IF
 11699         MOVE SPACES                TO DOCC-RETURN-CODE
 11700         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11701         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11702         IF DOCC-RETURN-CODE = 'OK'
 11703             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11704             GO TO 3024-CHECK-VALID-RATE
 11705           ELSE
 11706             MOVE ER-7823               TO WS-ERROR
 11707             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11708             GO TO 3025-EDIT-REINSURANCE.
 11709
 11710       MOVE ER-7816                     TO WS-ERROR.
 11711       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11712       GO TO 3025-EDIT-REINSURANCE.
 11713
 11714**********   DMD CUSTOM CODE ABOVE    **********
 11715
 11716 3025-EDIT-REINSURANCE.
 11717     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11718         GO TO 3027-EDIT-CONTINUE.
 11719
 11720     MOVE LOW-VALUES               TO ERREIN-KEY.
 11721     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11722     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11723                                      REIN-CODE-2
 11724                                      REIN-CODE-3.
 11725     MOVE 'A'                      TO REIN-TYPE.
 11726
 11727     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11728
 11729     MOVE '3026' TO REIN-SW.
 11730     MOVE ' '                   TO WS-REIN-READ-SW.
 11731
 11732     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11733     IF REIN-TABLE-NOT-FOUND
 11734         GO TO 3026-NO-SPEC-TABLE.
 11735
 11736     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11737     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11738                                   WS-NSP-ST-CD-LF.
 11739     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11740                                   WS-NSP-ST-CD-AH.
 11741
 11742     GO TO 3040-EDIT-CONTINUE.
 11743
 11744 3026-NO-SPEC-TABLE.
 11745
 11746     MOVE ER-2664                TO WS-ERROR.
 11747     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11748     GO TO 3040-EDIT-CONTINUE.
 11749
 11750 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 216
* EL050.cbl
 11751
 11752     IF PB-I-REIN-TABLE = SPACES
 11753       GO TO 3040-EDIT-CONTINUE.
 11754
 11755     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11756          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11757          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11758           GO TO 3040-EDIT-CONTINUE.
 11759
 11760     MOVE LOW-VALUES            TO ERREIN-KEY.
 11761     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11762     MOVE 'A'                   TO REIN-TYPE.
 11763     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11764
 11765     MOVE '3028'                TO REIN-SW.
 11766     MOVE ' '                   TO WS-REIN-READ-SW.
 11767
 11768     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11769     IF REIN-TABLE-NOT-FOUND
 11770         GO TO 3028-NO-REIN-TABLE.
 11771
 11772     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11773     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11774                                   WS-NSP-ST-CD-LF.
 11775     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11776                                   WS-NSP-ST-CD-AH.
 11777
 11778     GO TO 3040-EDIT-CONTINUE.
 11779
 11780 3028-NO-REIN-TABLE.
 11781
 11782     MOVE ER-2615                TO WS-ERROR.
 11783     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11784     GO TO 3040-EDIT-CONTINUE.
 11785
 11786 3040-EDIT-CONTINUE.
 11787
 11788     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11789         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11790
 11791     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11792         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11793
 11794     IF (NOT PB-REISSUED-CERT)
 11795        AND (NOT PB-MONTHLY-CERT)
 11796        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11797            MOVE '001'           TO PB-I-LF-TERM
 11798            MOVE 'M'             TO PB-I-INSURED-SEX.
 11799
 11800     IF (NOT PB-REISSUED-CERT)
 11801        AND (NOT PB-MONTHLY-CERT)
 11802        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11803            MOVE '001'           TO PB-I-AH-TERM
 11804            MOVE 'M'             TO PB-I-INSURED-SEX.
 11805
 11806 3040-EDIT-1ST-PMT-DT.
 11807     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11808     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 217
* EL050.cbl
 11809         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11810
 11811******************************************************************
 11812*                                                                *
 11813*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11814*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11815*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11816*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11817*                                                                *
 11818******************************************************************
 11819
 11820     IF PB-EFF-DT-PROCESSING
 11821        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11822                                    PB-I-LF-EXPIRE-DT
 11823                                    PB-I-AH-EXPIRE-DT
 11824        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11825        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11826        MOVE ZERO                TO DC-ELAPSED-DAYS
 11827        MOVE +1                  TO DC-ELAPSED-MONTHS
 11828        SET BIN-PLUS-ELAPSED     TO TRUE
 11829*       MOVE 6                   TO DC-OPTION-CODE
 11830        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11831        IF NO-CONVERSION-ERROR
 11832           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11833
 11834******************************************************************
 11835*                                                                *
 11836*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11837*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11838*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11839*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11840*                                                                *
 11841******************************************************************
 11842
 11843     IF PB-EXT-DAYS-PROCESSING
 11844          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11845                                         PB-I-LF-EXPIRE-DT
 11846                                         PB-I-AH-EXPIRE-DT
 11847          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11848          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11849          MOVE +1                     TO DC-ELAPSED-MONTHS
 11850          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11851          SET BIN-PLUS-ELAPSED        TO TRUE
 11852*         MOVE 6                      TO DC-OPTION-CODE
 11853          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11854          IF NO-CONVERSION-ERROR
 11855             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11856
 11857******************************************************************
 11858*                                                                *
 11859*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11860*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11861*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11862*        (EXPIRE DATE - (TERM -1))  *  -1.
 11863*                                                                *
 11864******************************************************************
 11865
 11866     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 218
* EL050.cbl
 11867        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11868           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11869              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11870              MOVE PB-I-AH-TERM      TO WS-TERM
 11871           ELSE
 11872              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11873              MOVE PB-I-LF-TERM      TO WS-TERM
 11874        ELSE
 11875           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11876              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11877              MOVE PB-I-LF-TERM      TO WS-TERM
 11878           ELSE
 11879              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11880              MOVE PB-I-AH-TERM      TO WS-TERM.
 11881
 11882     IF PB-EXPIRE-DT-PROCESSING
 11883        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11884        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11885        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11886        MOVE ZERO                TO DC-ELAPSED-DAYS
 11887                                    DC-ODD-DAYS-OVER
 11888          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11889          SET BIN-PLUS-ELAPSED    TO TRUE
 11890*         MOVE 6                  TO DC-OPTION-CODE
 11891          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11892          IF NO-CONVERSION-ERROR
 11893             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11894
 11895******************************************************************
 11896*                                                                *
 11897*            1ST PAYMENT DATE PROCESSING                         *
 11898*                                                                *
 11899******************************************************************
 11900
 11901     IF PB-1ST-PMT-DT-PROCESSING
 11902        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11903                                    PB-I-AH-EXPIRE-DT
 11904        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11905
 11906     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11907         NEXT SENTENCE
 11908     ELSE
 11909         MOVE ER-2680                 TO WS-ERROR
 11910         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11911         GO TO 3060-ORIG-TERM-CHECK.
 11912
 11913     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11914     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11915     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11916*    MOVE 1                      TO DC-OPTION-CODE.
 11917     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11918                                    DC-ELAPSED-DAYS
 11919                                    DC-ODD-DAYS-OVER.
 11920
 11921     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11922
 11923     IF DATE-CONVERSION-ERROR
 11924        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 219
* EL050.cbl
 11925
 11926     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11927     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11928        AND (WS-LF-COVERAGE-TYPE = 'L')
 11929        IF (DC-ELAPSED-MONTHS > 1)
 11930                      OR
 11931           ((DC-ELAPSED-MONTHS = 1)
 11932           AND (DC-ODD-DAYS-OVER > 0))
 11933           MOVE ER-2882          TO WS-ERROR
 11934           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11935        END-IF
 11936     END-IF
 11937     IF PB-EXT-DAYS-PROCESSING
 11938        CONTINUE
 11939     ELSE
 11940        IF DC-ELAPSED-MONTHS = +0
 11941           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11942        ELSE
 11943           IF (WS-LF-EARNINGS-CALC = '4')
 11944              AND (DC-ELAPSED-MONTHS > ZERO)
 11945              AND (DC-ELAPSED-DAYS > ZERO)
 11946              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11947           ELSE
 11948              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11949                                 THRU 6499-EXIT
 11950              MOVE WS-ODD-DAYS-OVER
 11951                                 TO PB-I-EXTENTION-DAYS
 11952           END-IF
 11953        END-IF
 11954     END-IF
 11955******************************************************************
 11956*                                                                *
 11957*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11958*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11959*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11960*            AND ANY ODD DAYS.                                   *
 11961*                                                                *
 11962******************************************************************
 11963
 11964     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11965                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11966     IF WS-LF-EARNINGS-CALC NOT = '4'
 11967        IF DC-ELAPSED-DAYS > ZEROS
 11968           MOVE ER-2681          TO WS-ERROR
 11969           PERFORM 9900-ERROR-FORMAT
 11970                                 THRU 9900-EXIT
 11971        END-IF
 11972     END-IF
 11973
 11974     IF WS-LF-EARNINGS-CALC NOT = '4'
 11975        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11976           MOVE ER-2681          TO WS-ERROR
 11977           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11978
 11979     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11980        (PB-I-LF-TERM NOT = ZERO) AND
 11981         NOT NO-LIFE-COVERAGE
 11982          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 220
* EL050.cbl
 11983          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11984          IF WS-LF-EARNINGS-CALC = '4'
 11985             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 11986             PB-I-PAY-FREQUENCY
 11987          END-IF
 11988          MOVE ZERO              TO DC-ELAPSED-DAYS
 11989                                    DC-ODD-DAYS-OVER
 11990          MOVE 1                 TO DC-END-OF-MONTH
 11991          SET BIN-PLUS-ELAPSED        TO TRUE
 11992*         MOVE 6                 TO DC-OPTION-CODE
 11993          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11994          IF NO-CONVERSION-ERROR
 11995             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 11996             IF (WS-LF-EARNINGS-CALC = 'B') AND
 11997                (WS-LF-SPECIAL-CALC-CD = 'L')
 11998                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 11999                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12000                  MOVE +1             TO DC-ELAPSED-MONTHS
 12001                  SET BIN-PLUS-ELAPSED  TO TRUE
 12002*                 MOVE 6              TO DC-OPTION-CODE
 12003                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12004                  IF NO-CONVERSION-ERROR
 12005                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12006
 12007* okay, i had to move the new att age edit down here because the
 12008* expiration date could get recalculated and i need the exp date
 12009     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12010        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12011        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12012        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12013           AND ZEROS
 12014           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12015           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12016           SET ELAPSED-BETWEEN-BIN TO TRUE
 12017           PERFORM 8500-DATE-CONVERT
 12018                                 THRU 8500-EXIT
 12019           IF NO-CONVERSION-ERROR
 12020              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12021                 MOVE ER-2669       TO WS-ERROR
 12022*                PERFORM 9900-ERROR-FORMAT
 12023*                                THRU 9900-EXIT
 12024              END-IF
 12025           END-IF
 12026        ELSE
 12027           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12028           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12029              MOVE ER-2669       TO WS-ERROR
 12030*             PERFORM 9900-ERROR-FORMAT
 12031*                                THRU 9900-EXIT
 12032           ELSE
 12033              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12034                 MOVE ER-1570    TO WS-ERROR
 12035                 PERFORM 9900-ERROR-FORMAT
 12036                                 THRU 9900-EXIT
 12037              END-IF
 12038           END-IF
 12039        END-IF
 12040        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 221
* EL050.cbl
 12041           AND ZEROS
 12042           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12043           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12044           SET ELAPSED-BETWEEN-BIN TO TRUE
 12045           PERFORM 8500-DATE-CONVERT
 12046                                 THRU 8500-EXIT
 12047           IF NO-CONVERSION-ERROR
 12048              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12049                 MOVE ER-2669       TO WS-ERROR
 12050*                PERFORM 9900-ERROR-FORMAT
 12051*                                THRU 9900-EXIT
 12052              END-IF
 12053           END-IF
 12054        ELSE
 12055           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12056             (PB-I-LF-TERM / 12)
 12057           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12058              MOVE ER-2669       TO WS-ERROR
 12059*             PERFORM 9900-ERROR-FORMAT
 12060*                                THRU 9900-EXIT
 12061           ELSE
 12062              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12063                 MOVE ER-1571    TO WS-ERROR
 12064                 PERFORM 9900-ERROR-FORMAT
 12065                                 THRU 9900-EXIT
 12066              END-IF
 12067           END-IF
 12068        END-IF
 12069        IF WS-ERROR = ER-2669
 12070           PERFORM 9900-ERROR-FORMAT
 12071                                 THRU 9900-EXIT
 12072        END-IF
 12073     END-IF
 12074     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12075        (PB-I-AH-TERM NOT = ZERO) AND
 12076         NOT NO-AH-COVERAGE
 12077          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12078             AND (PB-COMPANY-ID = 'DCC')
 12079             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12080             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12081          ELSE
 12082             IF WS-LF-EARNINGS-CALC = '4'
 12083                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12084                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12085                PB-I-PAY-FREQUENCY
 12086             ELSE
 12087                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12088                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12089             END-IF
 12090          END-IF
 12091          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12092                                         DC-ODD-DAYS-OVER
 12093          MOVE 1                      TO DC-END-OF-MONTH
 12094          SET BIN-PLUS-ELAPSED        TO TRUE
 12095*         MOVE 6                      TO DC-OPTION-CODE
 12096          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12097          IF NO-CONVERSION-ERROR
 12098             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 222
* EL050.cbl
 12099     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12100        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12101        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12102        IF PB-I-BIRTHDAY > LOW-VALUES
 12103           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12104           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12105           SET ELAPSED-BETWEEN-BIN TO TRUE
 12106           PERFORM 8500-DATE-CONVERT
 12107                                 THRU 8500-EXIT
 12108           IF NO-CONVERSION-ERROR
 12109              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12110                 MOVE ER-3054       TO WS-ERROR
 12111*                PERFORM 9900-ERROR-FORMAT
 12112*                                THRU 9900-EXIT
 12113              END-IF
 12114           END-IF
 12115        ELSE
 12116           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12117           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12118              MOVE ER-3054       TO WS-ERROR
 12119*             PERFORM 9900-ERROR-FORMAT
 12120*                                THRU 9900-EXIT
 12121           END-IF
 12122        END-IF
 12123        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12124           AND ZEROS
 12125           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12126           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12127           SET ELAPSED-BETWEEN-BIN TO TRUE
 12128           PERFORM 8500-DATE-CONVERT
 12129                                 THRU 8500-EXIT
 12130           IF NO-CONVERSION-ERROR
 12131              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12132                 MOVE ER-3054       TO WS-ERROR
 12133*                PERFORM 9900-ERROR-FORMAT
 12134*                                THRU 9900-EXIT
 12135              END-IF
 12136           END-IF
 12137        ELSE
 12138           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12139             (PB-I-AH-TERM / 12)
 12140           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12141              MOVE ER-3054       TO WS-ERROR
 12142*             PERFORM 9900-ERROR-FORMAT
 12143*                                THRU 9900-EXIT
 12144           END-IF
 12145        END-IF
 12146        IF WS-ERROR = ER-3054
 12147           PERFORM 9900-ERROR-FORMAT
 12148                                 THRU 9900-EXIT
 12149        END-IF
 12150     END-IF
 12151     MOVE SPACE                       TO DC-END-OF-MONTH.
 12152
 12153     IF PB-COMPANY-ID = 'NCB'
 12154        GO TO 3040-EDIT-EXTENSION-DAYS.
 12155
 12156     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 223
* EL050.cbl
 12157       AND
 12158        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12159        NEXT SENTENCE
 12160     ELSE
 12161        GO TO 3040-EDIT-EXTENSION-DAYS.
 12162
 12163     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12164        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12165        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12166     ELSE
 12167        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12168        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12169
 12170     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12171*    MOVE '1'      TO DC-OPTION-CODE
 12172     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12173     IF (NO-CONVERSION-ERROR)
 12174        AND (DC-ELAPSED-MONTHS > +1)
 12175        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12176        MOVE ER-2668   TO WS-ERROR
 12177        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12178
 12179 3040-EDIT-EXTENSION-DAYS.
 12180
 12181     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12182        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12183         GO TO 3050-EDIT-TERM-IN-DAYS
 12184     ELSE
 12185         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12186
 12187     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12188         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12189     ELSE
 12190        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12191           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12192           MOVE ER-2681         TO WS-ERROR
 12193           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12194
 12195     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12196        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12197        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12198         GO TO 3060-ORIG-TERM-CHECK.
 12199
 12200     GO TO 3060-ORIG-TERM-CHECK.
 12201
 12202 3050-EDIT-TERM-IN-DAYS.
 12203
 12204     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12205
 12206     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12207         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12208     ELSE
 12209         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12210            MOVE ER-2682         TO WS-ERROR
 12211            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12212
 12213     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12214                                       REMAINDER WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 224
* EL050.cbl
 12215     IF WS-WORK-TERM GREATER THAN ZERO
 12216         ADD +1 TO PB-I-LF-TERM.
 12217
 12218     IF NOT NO-AH-COVERAGE
 12219         MOVE ER-2684            TO WS-ERROR
 12220         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12221
 12222
 12223 3060-ORIG-TERM-CHECK.
 12224
 12225******************************************************************
 12226*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12227******************************************************************
 12228
 12229     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12230        NEXT SENTENCE
 12231     ELSE
 12232        IF NOT NO-LIFE-COVERAGE
 12233           IF PB-I-LF-TERM NUMERIC
 12234              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12235              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12236              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12237                  NEXT SENTENCE
 12238           ELSE
 12239              MOVE ER-2647       TO WS-ERROR
 12240              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12241
 12242     IF NOT NO-AH-COVERAGE
 12243         IF PB-I-AH-TERM NUMERIC
 12244            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12245            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12246            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12247             NEXT SENTENCE
 12248          ELSE
 12249              MOVE ER-2658       TO WS-ERROR
 12250              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12251
 12252     IF PB-COMPANY-ID = 'NCB'
 12253        GO TO 3070-LOAN-TERM-CHECK.
 12254
 12255     IF POLICY-HAS-AH
 12256       AND
 12257        POLICY-HAS-LIFE
 12258       AND
 12259        PB-I-LF-TERM NUMERIC
 12260       AND
 12261        PB-I-AH-TERM NUMERIC
 12262        NEXT SENTENCE
 12263     ELSE
 12264        GO TO 3070-LOAN-TERM-CHECK.
 12265
 12266     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12267     IF WS-TEX-FACT-2 LESS THAN +0
 12268        MULTIPLY +1 BY WS-TEX-FACT-2.
 12269
 12270     IF WS-TEX-FACT-2 GREATER THAN +1
 12271        MOVE ER-2668             TO WS-ERROR
 12272        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 225
* EL050.cbl
 12273
 12274 3070-LOAN-TERM-CHECK.
 12275
 12276     IF (WS-LF-BENEFIT-CD = ZERO)
 12277         OR (NO-LF-BENEFIT-MATCH)
 12278            GO TO 3125-EDIT-PMT-FREQ.
 12279*    IF PB-COMPANY-ID NOT = 'DCC'
 12280*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12281*          AND 'V' AND 'W' AND 'X'
 12282*          GO TO 3125-EDIT-PMT-FREQ
 12283*       END-IF
 12284*    ELSE
 12285*       IF WS-AH-DCC-TRUNC = 'T'
 12286*          CONTINUE
 12287*       ELSE
 12288*          GO TO 3125-EDIT-PMT-FREQ
 12289*       END-IF
 12290*    END-IF
 12291     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12292                    OR
 12293        ((PB-COMPANY-ID = 'DCC')
 12294        AND (WS-AH-DCC-TRUNC = 'T'))
 12295        CONTINUE
 12296     ELSE
 12297        GO TO 3125-EDIT-PMT-FREQ
 12298     END-IF
 12299     IF PB-I-LOAN-TERM NOT NUMERIC
 12300         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12301
 12302     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12303        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12304        PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12305        PB-I-LOAN-TERM NOT GREATER THAN +360
 12306         NEXT SENTENCE
 12307     ELSE
 12308         MOVE ER-2648            TO WS-ERROR
 12309         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12310
 12311     IF WS-STATE-ABBREVIATION = 'NC'
 12312        IF PB-I-LOAN-TERM > +59
 12313           CONTINUE
 12314        ELSE
 12315           MOVE ER-2792          TO WS-ERROR
 12316           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12317        END-IF
 12318     END-IF
 12319
 12320     .
 12321 3125-EDIT-PMT-FREQ.
 12322     IF (WS-LF-BENEFIT-CD = ZERO)
 12323         OR (NO-LF-BENEFIT-MATCH)
 12324            GO TO 3127-EDIT-LOAN-OFFICER.
 12325     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12326                    OR
 12327        ((PB-COMPANY-ID = 'DCC')
 12328        AND (WS-AH-DCC-TRUNC = 'T'))
 12329                    OR
 12330         (PB-COMPANY-ID = 'AHL')
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 226
* EL050.cbl
 12331        CONTINUE
 12332     ELSE
 12333        IF (PB-I-LOAN-TERM > ZEROS)
 12334           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12335           MOVE ER-1575          TO WS-ERROR
 12336           PERFORM 9900-ERROR-FORMAT
 12337                                 THRU 9900-EXIT
 12338        END-IF
 12339     END-IF
 12340     IF WS-LF-EARNINGS-CALC NOT = '4'
 12341         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12342            MOVE ER-2653         TO WS-ERROR
 12343            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12344            GO TO 3127-EDIT-LOAN-OFFICER
 12345         ELSE
 12346            GO TO 3127-EDIT-LOAN-OFFICER.
 12347
 12348     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12349         MOVE ER-2655            TO WS-ERROR
 12350         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12351         GO TO 3127-EDIT-LOAN-OFFICER.
 12352
 12353     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12354         MOVE ER-2654            TO WS-ERROR
 12355         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12356         GO TO 3127-EDIT-LOAN-OFFICER.
 12357
 12358     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12359         GIVING WS-TEX-FACT-2
 12360             REMAINDER WS-TEX-FACT-3.
 12361
 12362*    IF WS-TEX-FACT-3 NOT = ZERO
 12363*       MOVE ER-2654             TO WS-ERROR
 12364*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12365
 12366
 12367 3127-EDIT-LOAN-OFFICER.
 12368
 12369     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12370        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12371           MOVE ER-2690          TO WS-ERROR
 12372           PERFORM 9900-ERROR-FORMAT
 12373                                 THRU 9900-EXIT
 12374        ELSE
 12375           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12376           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12377           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12378           MOVE PB-SV-STATE      TO LOFC-STATE
 12379           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 12380           MOVE PB-I-LOAN-OFFICER
 12381                                 TO LOFC-CODE
 12382           PERFORM 8586-READ-LOAN-OFFICER
 12383                                 THRU 8586-EXIT
 12384           IF (NOT LOFC-MASTER-FOUND)
 12385              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12386              MOVE ER-3006       TO WS-ERROR
 12387              PERFORM 9900-ERROR-FORMAT
 12388                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 227
* EL050.cbl
 12389           END-IF
 12390        END-IF
 12391     END-IF
 12392     .
 12393 3129-EDIT-APR.
 12394
 12395     IF (WS-LF-BENEFIT-CD = ZERO)
 12396        OR (NO-LF-BENEFIT-MATCH)
 12397        IF PB-COMPANY-ID NOT = 'DCC'
 12398           GO TO 3130-EDIT-AGE
 12399*       ELSE
 12400*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12401*             GO TO 3130-EDIT-AGE
 12402*          END-IF
 12403        END-IF
 12404     END-IF
 12405
 12406     IF (WS-STATE-ABBREVIATION = 'OH')
 12407         AND (PB-I-RATE-CLASS NOT = 'L ')
 12408         AND (PB-I-LF-TERM GREATER THAN 60)
 12409         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12410         GO TO 3129-APR-CONT.
 12411
 12412     IF (WS-STATE-ABBREVIATION = 'RI')
 12413         AND (PB-I-LF-TERM GREATER THAN 60)
 12414         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12415         GO TO 3129-APR-CONT.
 12416
 12417     IF (WS-STATE-ABBREVIATION = 'UT')
 12418         AND (PB-I-LF-TERM GREATER THAN 62)
 12419         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12420         AND (PB-CERT-EFF-DT LESS WS-830901)
 12421         GO TO 3129-APR-CONT.
 12422
 12423     IF PB-COMPANY-ID = 'LAP'
 12424        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12425           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12426              MOVE ER-2656         TO WS-ERROR
 12427              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12428              GO TO 3130-EDIT-AGE.
 12429
 12430     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12431        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12432        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12433        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12434        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12435        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12436         GO TO 3130-EDIT-AGE.
 12437
 12438 3129-APR-CONT.
 12439     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12440         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12441         GO TO 3130-EDIT-AGE.
 12442
 12443     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12444         WS-AH-BENEFIT-CD (1:1) = 'S')
 12445        AND (PB-COMPANY-ID = 'DCC')
 12446        AND (PB-I-LOAN-APR = ZERO)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 228
* EL050.cbl
 12447        MOVE ER-2657             TO WS-ERROR
 12448        PERFORM 9900-ERROR-FORMAT
 12449                                 THRU 9900-EXIT
 12450        GO TO 3130-EDIT-AGE
 12451     END-IF
 12452     IF PB-I-LOAN-APR = ZERO
 12453        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12454     END-IF
 12455
 12456     IF PB-I-LOAN-APR = ZERO
 12457        MOVE ER-2656             TO WS-ERROR
 12458        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12459        GO TO 3130-EDIT-AGE.
 12460
 12461*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12462     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12463        MOVE ER-2657             TO WS-ERROR
 12464        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12465
 12466 3130-EDIT-AGE.
 12467
 12468******************************************************************
 12469*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12470******************************************************************
 12471
 12472     IF NOT NO-LIFE-COVERAGE
 12473        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12474           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12475               MOVE ER-2628             TO WS-ERROR
 12476               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12477
 12478     IF NOT NO-AH-COVERAGE
 12479        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12480           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12481               MOVE ER-2628         TO WS-ERROR
 12482               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12483
 12484 3133-SEX-CODE.
 12485     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12486         IF WS-DEFAULT-SEX = 'M'
 12487             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12488          ELSE
 12489             IF WS-DEFAULT-SEX = 'F'
 12490             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12491
 12492     IF PB-I-INSURED-SEX = '1'
 12493         MOVE 'M' TO PB-I-INSURED-SEX.
 12494
 12495     IF PB-I-INSURED-SEX = '2'
 12496         MOVE 'F' TO PB-I-INSURED-SEX.
 12497
 12498 3134-SIG-SW-EDIT.
 12499     IF PB-I-SIG-SW = SPACE
 12500         MOVE 'N'                TO  PB-I-SIG-SW.
 12501
 12502     IF PB-COMPANY-ID = 'NCL'
 12503         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12504             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 229
* EL050.cbl
 12505         ELSE
 12506             MOVE ER-1923        TO  WS-ERROR
 12507             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12508     ELSE
 12509     IF PB-COMPANY-ID = 'CRI'
 12510         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12511             NEXT SENTENCE
 12512         ELSE
 12513             MOVE ER-2606        TO  WS-ERROR
 12514             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12515     ELSE
 12516     IF PB-COMPANY-ID = 'TMS'
 12517         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12518             NEXT SENTENCE
 12519         ELSE
 12520             MOVE ER-2689        TO  WS-ERROR
 12521             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12522     ELSE
 12523         IF PB-I-SIG-SW = 'Y' OR 'N'
 12524             NEXT SENTENCE
 12525         ELSE
 12526             MOVE ER-2651        TO  WS-ERROR
 12527             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12528
 12529     IF PB-COMPANY-ID = 'FLA'
 12530         IF (WS-EDIT-AGE GREATER 54  OR
 12531             WS-AH-EDIT-AGE GREATER 54)  AND
 12532            PB-I-SIG-SW = 'N'
 12533            MOVE ER-2651         TO  WS-ERROR
 12534            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12535
 12536 3135-NAME-EDIT.
 12537
 12538     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12539        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12540        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12541           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12542                                 TO PB-I-JOINT-FIRST-NAME
 12543        END-PERFORM
 12544     END-IF
 12545     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12546        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12547        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12548           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12549                                 TO PB-I-JOINT-LAST-NAME
 12550        END-PERFORM
 12551     END-IF
 12552     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12553        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12554        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12555           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12556                                 TO PB-I-INSURED-FIRST-NAME
 12557        END-PERFORM
 12558     END-IF
 12559     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12560        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12561        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12562           MOVE PB-I-INSURED-LAST-NAME (2:14)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 230
* EL050.cbl
 12563                                 TO PB-I-INSURED-LAST-NAME
 12564        END-PERFORM
 12565     END-IF
 12566     IF PB-I-INSURED-LAST-NAME = SPACES
 12567       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12568       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12569           MOVE ER-2660    TO WS-ERROR
 12570           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12571
 12572 3136-EDIT-SEX.
 12573
 12574******************************************************************
 12575*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12576******************************************************************
 12577
 12578     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12579        (WS-AH-SPECIAL-CALC-CD = 'O')
 12580        NEXT SENTENCE
 12581     ELSE
 12582        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12583           NEXT SENTENCE
 12584        ELSE
 12585           MOVE ER-2629            TO WS-ERROR
 12586           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12587
 12588 3137-EDIT-EFF-DATE.
 12589
 12590     IF PB-REISSUED-CERT       OR
 12591        PB-POLICY-IS-DECLINED  OR
 12592        PB-POLICY-IS-VOIDED
 12593         GO TO 3139-EDIT-COVERAGE-CODES.
 12594
 12595     MOVE SPACE                  TO WS-2671-SW
 12596                                    WS-2672-SW.
 12597
 12598     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12599         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12600             MOVE ER-2703        TO WS-ERROR
 12601             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12602             GO TO 3139-EDIT-COVERAGE-CODES.
 12603
 12604     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12605         GO TO 3139-EDIT-COVERAGE-CODES.
 12606
 12607     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12608     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12609*    MOVE '1'                    TO DC-OPTION-CODE.
 12610     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12611     MOVE +0                     TO DC-ELAPSED-MONTHS
 12612                                    DC-ELAPSED-DAYS.
 12613     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12614
 12615     IF DATE-CONVERSION-ERROR
 12616         GO TO 3139-EDIT-COVERAGE-CODES.
 12617
 12618     IF DC-ELAPSED-DAYS GREATER +180
 12619         MOVE ER-2672            TO WS-ERROR
 12620         MOVE 'Y'                TO WS-2672-SW
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 231
* EL050.cbl
 12621         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12622     END-IF
 12623
 12624     IF WS-ERROR = ER-2671  AND
 12625        PB-COMPANY-ID  = 'LBL'
 12626        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12627        MOVE SPACE               TO WS-2671-SW
 12628        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12629
 12630     IF PB-ISSUE-DATE-FORCED  AND
 12631      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12632         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12633         MOVE ER-2673            TO WS-ERROR
 12634         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12635         MOVE SPACE              TO WS-2671-SW
 12636                                    WS-2672-SW.
 12637
 12638     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12639         IF PB-ISSUE-DATE-FORCED
 12640             MOVE ER-2600          TO  WS-ERROR
 12641             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12642         ELSE
 12643             MOVE ER-2692          TO  WS-ERROR
 12644             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12645
 12646
 12647 3139-EDIT-COVERAGE-CODES.
 12648
 12649     if pb-company-id not = 'AHL'
 12650        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12651           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12652           MOVE ER-2787          TO WS-ERROR
 12653           PERFORM 9900-ERROR-FORMAT
 12654                                 THRU 9900-EXIT
 12655        END-IF
 12656     end-if
 12657     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12658        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12659                                 > 250000.00
 12660           MOVE ER-2719          TO WS-ERROR
 12661           PERFORM 9900-ERROR-FORMAT
 12662                                 THRU 9900-EXIT
 12663        END-IF
 12664     END-IF
 12665
 12666     IF PB-POLICY-IS-DECLINED  OR
 12667        PB-POLICY-IS-VOIDED
 12668         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12669
 12670     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12671        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12672         MOVE ER-2630                TO WS-ERROR
 12673         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12674
 12675     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12676        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12677        PB-I-LF-PREMIUM-AMT = ZERO
 12678         GO TO 3140-CHECK-AH-FOR-ZERO.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 232
* EL050.cbl
 12679
 12680     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12681        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12682        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12683         GO TO 3140-CHECK-AH-FOR-ZERO.
 12684
 12685     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12686        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12687        MOVE ER-2631             TO WS-ERROR
 12688        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12689     END-IF
 12690
 12691
 12692******************************************************************
 12693*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12694******************************************************************
 12695
 12696     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12697        NEXT SENTENCE
 12698     ELSE
 12699        IF PB-I-LF-BENEFIT-AMT = ZERO
 12700           MOVE ER-2632             TO WS-ERROR
 12701           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12702
 12703
 12704******************************************************************
 12705*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12706******************************************************************
 12707
 12708     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12709        CONTINUE
 12710     ELSE
 12711        IF PB-I-LF-PREMIUM-AMT = ZERO
 12712           IF (NOT PB-COMP-LF-PREM)
 12713              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12714              MOVE ER-2633       TO WS-ERROR
 12715              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12716           END-IF
 12717        END-IF
 12718     END-IF
 12719     .
 12720 3140-CHECK-AH-FOR-ZERO.
 12721
 12722     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12723        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12724        PB-I-AH-PREMIUM-AMT = ZERO
 12725         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12726
 12727     IF PB-COMPANY-ID = 'CSL'  AND
 12728        PB-I-AH-BENEFIT-CD = ZERO  AND
 12729        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12730        PB-I-AH-PREMIUM-AMT = ZERO
 12731         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12732
 12733     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12734        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12735        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12736         GO TO 3140-EDIT-MAX-AMT-SIZES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 233
* EL050.cbl
 12737
 12738     IF PB-I-AH-BENEFIT-CD = ZERO
 12739         MOVE ER-2634            TO WS-ERROR
 12740         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12741
 12742******************************************************************
 12743*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12744******************************************************************
 12745
 12746     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12747        NEXT SENTENCE
 12748     ELSE
 12749        IF PB-I-AH-BENEFIT-AMT = ZERO
 12750           MOVE ER-2635             TO WS-ERROR
 12751           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12752
 12753******************************************************************
 12754*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12755******************************************************************
 12756
 12757     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12758        NEXT SENTENCE
 12759     ELSE
 12760        IF PB-I-AH-PREMIUM-AMT = ZERO
 12761            IF NOT PB-COMP-AH-PREM
 12762                MOVE ER-2636    TO WS-ERROR
 12763                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12764
 12765
 12766 3140-EDIT-MAX-AMT-SIZES.
 12767* CUSTOM CODE FOR CLIENT    'DMD'
 12768     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12769                                     WS-RES-MUNI-TAX
 12770                                     PB-I-STATE-TAX
 12771                                     PB-I-MUNI-TAX.
 12772
 12773     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12774
 12775     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12776        GO TO 3150-RATE-OUTSTAND-BAL.
 12777
 12778     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12779        GO TO 3150-RATE-OUTSTAND-BAL.
 12780
 12781     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12782        GO TO 3150-RATE-OUTSTAND-BAL.
 12783
 12784     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12785                             OR 'RIC')
 12786        GO TO 3150-RATE-OUTSTAND-BAL.
 12787
 12788     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12789        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12790            GO TO 3150-RATE-OUTSTAND-BAL
 12791        ELSE
 12792           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12793               GO TO 3150-RATE-OUTSTAND-BAL.
 12794
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 234
* EL050.cbl
 12795     IF NOT PB-NO-MONTHS-SKIPPED
 12796        GO TO 3150-RATE-OUTSTAND-BAL.
 12797
 12798     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12799        GO TO 3150-RATE-OUTSTAND-BAL.
 12800
 12801     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12802        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12803           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12804             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12805           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12806           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12807              MOVE ER-2693     TO WS-ERROR
 12808              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12809              GO TO 3150-RATE-OUTSTAND-BAL
 12810           ELSE
 12811              GO TO 3150-RATE-OUTSTAND-BAL.
 12812
 12813 3150-RATE-OUTSTAND-BAL.
 12814
 12815* DMD RATING TEST
 12816     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12817         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12818         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12819         MOVE ER-2687                 TO WS-ERROR
 12820         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12821         MOVE 'B'                     TO PB-I-OB-FLAG
 12822         GO TO 3260-EDIT-CONTINUE.
 12823
 12824     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12825         IF  WS-ERROR    EQUAL    ER-2693
 12826             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12827                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12828                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12829                 MOVE  +0            TO  WS-ERROR.
 12830
 12831     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12832         IF  WS-ERROR    EQUAL    ER-2693
 12833             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12834                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12835                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12836                 MOVE  +0            TO  WS-ERROR.
 12837
 12838     IF PLAN-MASTER-AH-SW = 'Y'
 12839        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12840            IF  WS-ERROR    EQUAL    ER-2693
 12841              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12842                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12843                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12844                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12845                 MOVE  ER-1910           TO  WS-ERROR
 12846                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12847
 12848     IF PLAN-MASTER-AH-SW = 'Y'
 12849        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12850            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12851               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12852               MOVE  ER-1910           TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 235
* EL050.cbl
 12853               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12854
 12855     IF PLAN-MASTER-AH-SW = 'Y'
 12856        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12857            IF  WS-ERROR    EQUAL    ER-2693
 12858                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12859                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12860                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12861                 MOVE  +0       TO  WS-ERROR.
 12862
 12863     IF WS-ERROR = ER-2693
 12864        IF PB-COMPANY-ID = 'JAL' AND
 12865           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12866           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12867           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12868
 12869     IF WS-ERROR = ER-2693
 12870        IF PB-COMPANY-ID = 'NCL'  AND
 12871           PB-I-AH-BENEFIT-CD = 'OA'
 12872           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12873           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12874
 12875     IF WS-ERROR = ER-2693
 12876        IF PB-COMPANY-ID = 'CNL' AND
 12877           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12878           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12879           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12880
 12881     IF WS-ERROR = ER-2693
 12882        IF PB-COMPANY-ID = 'HER'
 12883           IF WS-LEVEL
 12884              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12885              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12886
 12887     IF ((LF-BENEFIT-FOUND) AND
 12888         (NOT NO-LIFE-COVERAGE)  AND
 12889         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12890       OR   ((AH-BENEFIT-FOUND) AND
 12891             (NOT NO-AH-COVERAGE)    AND
 12892             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12893         NEXT SENTENCE
 12894     ELSE
 12895         GO TO 3215-EDIT-RATES.
 12896
 12897     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12898        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12899           MOVE ER-2674          TO WS-ERROR
 12900           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12901           GO TO 3215-EDIT-RATES.
 12902
 12903     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12904        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12905           MOVE ER-2674          TO WS-ERROR
 12906           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12907           GO TO 3215-EDIT-RATES.
 12908
 12909     MOVE 'B'                    TO PB-I-OB-FLAG.
 12910
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 236
* EL050.cbl
 12911     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12912         NEXT SENTENCE
 12913     ELSE
 12914         IF NOT NO-LIFE-COVERAGE
 12915             IF WS-ACCT-LF-OB-RT = ZERO
 12916                MOVE ER-2641    TO WS-ERROR
 12917                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12918
 12919     IF PB-COMPANY-ID = 'CRI'
 12920       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12921         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12922         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12923         IF WS-ERROR = ER-2675
 12924            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12925            MOVE ER-2687              TO WS-ERROR
 12926            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12927         ELSE
 12928            MOVE ER-2687              TO WS-ERROR
 12929            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12930
 12931
 12932     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12933         NEXT SENTENCE
 12934     ELSE
 12935       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 12936            NEXT SENTENCE
 12937       ELSE
 12938         IF NOT NO-AH-COVERAGE
 12939             IF WS-ACCT-AH-OB-RT = ZERO
 12940                MOVE ER-2642    TO WS-ERROR
 12941                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12942
 12943     IF PB-COMPANY-ID = 'CRI'
 12944       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12945         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12946         IF WS-ERROR = ER-2676
 12947            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12948            MOVE ER-2687              TO WS-ERROR
 12949            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12950         ELSE
 12951            MOVE ER-2687              TO WS-ERROR
 12952            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12953
 12954     IF PB-COMPANY-ID NOT = 'GIC'
 12955         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12956            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12957     ELSE
 12958         IF PB-I-LF-PREM-CALC = ZEROS
 12959             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12960                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12961
 12962     IF PB-COMPANY-ID NOT = 'GIC'
 12963         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12964            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12965     ELSE
 12966         IF PB-I-AH-PREM-CALC = ZEROS
 12967             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12968                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 237
* EL050.cbl
 12969
 12970     MOVE ZEROS TO PB-I-MORT-CODE.
 12971
 12972     GO TO 3260-EDIT-CONTINUE.
 12973
 12974
 12975 3215-EDIT-RATES.
 12976     IF ACCOUNT-MAST-FOUND
 12977         NEXT SENTENCE
 12978     ELSE
 12979         GO TO 3999-END-EDIT.
 12980
 12981 3220-CHECK-LF-RATES.
 12982
 12983     IF PB-COMPANY-ID = 'DCC'
 12984        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 12985        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 12986        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12987           AND (NOT WS-LF-CASH))
 12988                           OR
 12989           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12990           AND (NOT WS-AH-CASH)))
 12991                       AND
 12992           (PB-I-ENTRY-STATUS NOT = '5')
 12993           MOVE 'M'              TO PB-BATCH-ENTRY
 12994                                    PB-I-ENTRY-STATUS
 12995        END-IF
 12996     END-IF
 12997     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 12998                                    PB-I-AH-PREM-CALC
 12999                                    PB-I-LF-ALT-PREM-CALC
 13000                                    PB-I-LF-ALT-RATE
 13001                                    PB-I-LF-REI-RATE
 13002                                    PB-I-LF-ALT-REI-RATE
 13003                                    PB-I-AH-REI-RATE
 13004                                    PB-I-TOT-FEES-CALC.
 13005
 13006     IF PB-COMPANY-ID EQUAL 'DMD'
 13007        NEXT SENTENCE
 13008     ELSE
 13009        MOVE ZEROS               TO PB-I-LF-RATE
 13010                                    PB-I-AH-RATE.
 13011
 13012     IF PB-I-TOT-FEES NOT NUMERIC
 13013        MOVE ZEROS               TO PB-I-TOT-FEES
 13014     END-IF
 13015     IF PB-I-LIVES NOT NUMERIC
 13016         MOVE ZERO               TO PB-I-LIVES.
 13017
 13018     IF PB-I-NUM-BILLED NOT NUMERIC
 13019         MOVE ZERO               TO PB-I-NUM-BILLED.
 13020
 13021     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13022        MOVE +0                  TO PB-I-LF-PREM-TAX
 13023     END-IF
 13024
 13025     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13026        MOVE +0                  TO PB-I-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 238
* EL050.cbl
 13027     END-IF
 13028
 13029     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13030        PB-I-PAY-FREQUENCY = ZEROS
 13031            MOVE 12 TO CP-PAY-FREQUENCY
 13032     ELSE
 13033            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13034
 13035     IF PB-I-STATE-TAX NOT NUMERIC
 13036         MOVE ZEROS               TO PB-I-STATE-TAX.
 13037
 13038     IF PB-I-MUNI-TAX NOT NUMERIC
 13039         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13040
 13041     MOVE SPACES                 TO CP-BEN-CATEGORY
 13042     IF PB-COMPANY-ID  = 'CSL'  AND
 13043        PB-I-LF-TERM NOT = ZERO
 13044        COMPUTE WS-PAYMENT-AMT =
 13045             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13046        COMPUTE WS-CSL-AMT1 =
 13047             PB-I-LF-TERM * AM-MAX-MON-BEN
 13048        COMPUTE WS-CSL-AMT2 =
 13049             WS-PAYMENT-AMT * PB-I-LF-TERM
 13050        IF CP-PAY-FREQUENCY NOT = 12
 13051           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13052           MOVE '8' TO WS-CSL-CALC-CD
 13053        ELSE
 13054           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13055              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13056               AM-MAX-TOT-BEN
 13057               MOVE '6' TO WS-CSL-CALC-CD
 13058           ELSE
 13059              IF (WS-CSL-AMT1  GREATER THAN
 13060                 AM-MAX-TOT-BEN) AND
 13061                 (WS-CSL-AMT2  GREATER THAN
 13062                 AM-MAX-TOT-BEN)
 13063                 MOVE '7' TO WS-CSL-CALC-CD
 13064              ELSE
 13065                 MOVE '5' TO WS-CSL-CALC-CD.
 13066
 13067     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13068         NEXT SENTENCE
 13069     ELSE
 13070         GO TO 3300-CHECK-AH-RATES.
 13071
 13072*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13073
 13074     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13075        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13076              OR
 13077           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13078           MOVE ER-2618          TO WS-ERROR
 13079           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13080           GO TO 3300-CHECK-AH-RATES.
 13081
 13082     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13083           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13084                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 239
* EL050.cbl
 13085
 13086     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13087         MOVE ER-2687             TO WS-ERROR
 13088         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13089         MOVE 'Z000'              TO PB-I-MORT-CODE
 13090         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13091         GO TO 3300-CHECK-AH-RATES.
 13092
 13093     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13094        IF PB-I-LIVES = ZERO
 13095           MOVE ER-2688          TO WS-ERROR
 13096           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13097
 13098     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13099
 13100     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13101     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13102     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13103     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13104     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13105     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13106     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13107     MOVE '3'                    TO CP-PROCESS-TYPE.
 13108     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13109     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13110
 13111******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13112     IF PB-COMPANY-ID EQUAL 'CDL'
 13113         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13114            CP-EARN-AS-NET-PAY)
 13115             IF PB-CERT-EFF-DT GREATER  WS-931231
 13116                 MOVE '1'        TO CP-EARNING-METHOD.
 13117*******
 13118
 13119     MOVE PB-SV-STATE            TO CP-STATE.
 13120     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13121     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13122     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13123     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13124     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13125                                    CP-RATING-BENEFIT-AMT.
 13126     IF CP-STATE-STD-ABBRV = 'OR'
 13127         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13128                                         PB-I-LF-ALT-BENEFIT-AMT.
 13129     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13130     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13131     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13132     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13133     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13134     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13135     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13136     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13137     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13138                                    CP-REMAINING-TERM
 13139                                    CP-LOAN-TERM.
 13140
 13141     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13142         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 240
* EL050.cbl
 13143     ELSE
 13144         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13145             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13146                                           PB-I-LF-PREMIUM-AMT.
 13147
 13148     IF PB-COMPANY-ID EQUAL 'CSL'
 13149        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13150           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13151                                         PB-I-LF-PREMIUM-AMT.
 13152
 13153     IF PB-COMPANY-ID EQUAL 'NCB'
 13154         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13155            CP-EARN-AS-NET-PAY
 13156             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13157                 PB-I-LF-PREMIUM-AMT.
 13158
 13159     IF (CP-TRUNCATED-LIFE)
 13160        or ((pb-company-id = 'AHL')
 13161           and (pb-i-loan-term > pb-i-lf-term))
 13162        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13163
 13164     IF PB-COMPANY-ID EQUAL 'CRI'
 13165        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13166
 13167     IF CP-TERM-IS-DAYS
 13168         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13169     ELSE
 13170         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13171     IF PB-COMPANY-ID = 'DCC'
 13172        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13173        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13174        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13175        IF WS-LF-BEN-CATEGORY = 'D'
 13176           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13177           MOVE PB-I-LIFE-COMMISSION
 13178                                 TO CP-DCC-ACT-COMM
 13179           MOVE WS-LF-BEN-CATEGORY
 13180                                 TO CP-BEN-CATEGORY
 13181        END-IF
 13182        IF (CP-BENEFIT-CD (1:1) = 'P')
 13183           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13184           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13185        END-IF
 13186     END-IF
 13187     IF PB-COMPANY-ID = 'CSL'
 13188         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13189         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13190         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13191
 13192     IF PB-COMPANY-ID = 'CSL'
 13193        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13194
 13195     IF (CP-SPECIAL-CALC-CD = 'H')
 13196        OR (PB-COMPANY-ID = 'DCC')
 13197         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13198                                    TO CP-ALTERNATE-BENEFIT
 13199         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13200
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 241
* EL050.cbl
 13201     IF (PB-COMPANY-ID = 'CID')
 13202        AND (WS-LF-EARNINGS-CALC = 'B')
 13203        AND (CP-STATE-STD-ABBRV = 'MN')
 13204        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13205                                 TO CP-ALTERNATE-BENEFIT
 13206        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13207     END-IF
 13208     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13209     MOVE 'R'                   TO CP-RATE-FILE.
 13210     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13211
 13212     IF CP-ERROR-RATE-NOT-FOUND
 13213        MOVE ER-2641            TO WS-ERROR
 13214        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13215        GO TO 3300-CHECK-AH-RATES.
 13216
 13217     IF PB-COMPANY-ID EQUAL 'CRI'
 13218        IF CP-ERROR-NO-LIMITS-CRI
 13219           IF NOT ACCOUNT-LIFE-CHECKED
 13220              MOVE ER-2607      TO WS-ERROR
 13221              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13222
 13223******************************************************************
 13224*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13225*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13226******************************************************************
 13227
 13228* CALC LIFE AGE AT EXPIRATION.
 13229
 13230     COMPUTE WS-AGE-AT-EXPIRE =
 13231          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13232
 13233*    IF PB-STATE = 'CO' OR 'UT'
 13234*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13235*        MOVE 'F'            TO PB-FATAL-FLAG
 13236*        MOVE ER-2709        TO WS-ERROR
 13237*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13238*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13239
 13240*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13241*        MOVE 'X'            TO PB-FATAL-FLAG
 13242*        MOVE ER-2718        TO WS-ERROR
 13243*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13244*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13245
 13246* CALC A & H AGE AT EXPIRATION.
 13247
 13248     COMPUTE WS-AGE-AT-EXPIRE =
 13249          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13250
 13251*    IF PB-STATE = 'CO' OR 'UT'
 13252*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13253*        MOVE 'F'            TO PB-FATAL-FLAG
 13254*        MOVE ER-2709        TO WS-ERROR
 13255*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13256*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13257
 13258*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 242
* EL050.cbl
 13259*        MOVE 'X'            TO PB-FATAL-FLAG
 13260*        MOVE ER-2718        TO WS-ERROR
 13261*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13262*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13263
 13264     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13265        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13266
 13267     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13268        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13269
 13270     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13271        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13272
 13273     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13274         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13275         MOVE ER-2639        TO WS-ERROR
 13276         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13277
 13278
 13279******************************************************************
 13280*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13281******************************************************************
 13282
 13283 PREMIUM-EDITING-IS-BYPASSED.
 13284     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13285        AND (CP-R-MAX-ATT-AGE > +0)
 13286        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13287        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13288           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13289           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13290           MOVE '1'              TO DC-OPTION-CODE
 13291           PERFORM 8500-DATE-CONVERT
 13292                                 THRU 8500-EXIT
 13293           IF NO-CONVERSION-ERROR
 13294              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13295                 MOVE ER-2661       TO WS-ERROR
 13296*                PERFORM 9900-ERROR-FORMAT
 13297*                                THRU 9900-EXIT
 13298              END-IF
 13299           END-IF
 13300        ELSE
 13301           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13302           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13303              MOVE ER-2661       TO WS-ERROR
 13304*             PERFORM 9900-ERROR-FORMAT
 13305*                                THRU 9900-EXIT
 13306           ELSE
 13307              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13308                 MOVE ER-1570    TO WS-ERROR
 13309                 PERFORM 9900-ERROR-FORMAT
 13310                                 THRU 9900-EXIT
 13311              END-IF
 13312           END-IF
 13313        END-IF
 13314        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13315           MOVE PB-I-JOINT-BIRTHDAY
 13316                                 TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 243
* EL050.cbl
 13317           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13318           MOVE '1'              TO DC-OPTION-CODE
 13319           PERFORM 8500-DATE-CONVERT
 13320                                 THRU 8500-EXIT
 13321           IF NO-CONVERSION-ERROR
 13322              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13323                 MOVE ER-2661       TO WS-ERROR
 13324*                PERFORM 9900-ERROR-FORMAT
 13325*                                THRU 9900-EXIT
 13326              END-IF
 13327           ELSE
 13328              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13329           END-IF
 13330        ELSE
 13331           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13332             (PB-I-LF-TERM / 12)
 13333           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13334              MOVE ER-2661       TO WS-ERROR
 13335*             PERFORM 9900-ERROR-FORMAT
 13336*                                THRU 9900-EXIT
 13337           ELSE
 13338              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13339                 MOVE ER-1571    TO WS-ERROR
 13340                 PERFORM 9900-ERROR-FORMAT
 13341                                 THRU 9900-EXIT
 13342              END-IF
 13343           END-IF
 13344        END-IF
 13345        IF WS-ERROR = ER-2661
 13346           PERFORM 9900-ERROR-FORMAT
 13347                                 THRU 9900-EXIT
 13348        END-IF
 13349     END-IF
 13350*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13351*       MOVE ER-2661             TO WS-ERROR
 13352*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13353
 13354     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13355        MOVE ER-2662             TO WS-ERROR
 13356        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13357
 13358     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13359        MOVE ER-2677             TO WS-ERROR
 13360        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13361
 13362     IF CP-ERROR-LOAN-TERM
 13363        MOVE ER-2648             TO WS-ERROR
 13364        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13365
 13366 3221-CHECK-ERROR-RATE-OPEN.
 13367
 13368     IF CP-ERROR-RATE-FILE-NOTOPEN
 13369         GO TO 3990-FILES-NOT-OPEN.
 13370
 13371     IF PB-COMPANY-ID NOT = 'DMD'
 13372        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13373     END-IF
 13374     .
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 244
* EL050.cbl
 13375 3221-CONTINUE.
 13376     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13377                                    WS-DCC-AH-RATE
 13378     IF PB-COMPANY-ID = 'DCC'
 13379        IF WS-LF-BEN-CATEGORY = 'D'
 13380           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13381              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13382        END-IF
 13383     END-IF
 13384     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13385*   X'A4FF' = 12/31/2009
 13386     IF (PB-COMPANY-ID = 'CID')
 13387        AND (WS-LF-EARNINGS-CALC = 'B')
 13388        AND (CP-STATE-STD-ABBRV = 'MN')
 13389        AND (PB-CERT-EFF-DT > X'A4FF')
 13390        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13391     END-IF
 13392     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13393
 13394     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13395     IF (PB-COMPANY-ID = 'DCC')
 13396        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13397        AND (PB-I-POLICY-IS-MONTHLY)
 13398        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13399        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13400     END-IF
 13401     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13402     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13403     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13404     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13405     IF (PB-COMPANY-ID = 'DCC')
 13406        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13407        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13408        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13409        MOVE ER-2786             TO WS-ERROR
 13410        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13411     END-IF
 13412
 13413     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13414
 13415******************************************************************
 13416*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13417******************************************************************
 13418     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13419        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13420
 13421     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13422        GO TO 3225-CHECK-ALT-LIFE-RATE
 13423     ELSE
 13424       IF PB-I-LF-RATE = ZERO
 13425          MOVE ER-2641          TO WS-ERROR
 13426          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13427
 13428 3225-CHECK-ALT-LIFE-RATE.
 13429
 13430     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13431        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13432        (CP-SPECIAL-CALC-CD EQUAL 'H')
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 245
* EL050.cbl
 13433         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13434
 13435     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13436         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13437             AND PB-COMPANY-ID NOT = 'DCC')
 13438                   OR
 13439              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13440              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13441              AND PB-COMPANY-ID NOT = 'DCC')
 13442             MOVE ER-2720        TO  WS-ERROR
 13443             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13444             GO TO 3225-RATING-CONT
 13445         ELSE
 13446             GO TO 3225-RATING-CONT.
 13447     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13448        AND (AM-GPCD = 01 OR 06 OR 15)
 13449        MOVE ER-2798             TO WS-ERROR
 13450        PERFORM 9900-ERROR-FORMAT
 13451                                 THRU 9900-EXIT
 13452*       GO TO 3225-RATING-CONT
 13453     END-IF
 13454     IF (PB-COMPANY-ID = 'CID')
 13455        AND (WS-LF-EARNINGS-CALC = 'B')
 13456        AND (CP-STATE-STD-ABBRV = 'MN')
 13457        AND (PB-CERT-EFF-DT > X'A4FF')
 13458        GO TO 3225-RATING-CONT
 13459     END-IF
 13460     IF PB-COMPANY-ID = 'DCC'
 13461        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13462           AND (PB-I-POLICY-IS-MONTHLY)
 13463           GO TO 3225-RATING-CONT
 13464        END-IF
 13465     END-IF
 13466
 13467     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13468        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13469        CP-EARN-AS-REG-BALLOON
 13470        NEXT SENTENCE
 13471     ELSE
 13472        MOVE '2'                 TO CP-EARNING-METHOD.
 13473
 13474 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13475
 13476     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13477
 13478     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13479        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13480        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13481         NEXT SENTENCE
 13482     ELSE
 13483         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13484
 13485     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13486     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13487     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13488                                     CP-RATING-BENEFIT-AMT.
 13489     IF CP-STATE-STD-ABBRV = 'OR'
 13490         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 246
* EL050.cbl
 13491                                         PB-I-LF-ALT-BENEFIT-AMT.
 13492     IF PB-COMPANY-ID = 'DCC'
 13493        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13494     END-IF
 13495     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13496     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13497     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13498                                    CP-REMAINING-TERM
 13499                                    CP-LOAN-TERM.
 13500     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13501        ADD +1                   TO CP-ORIGINAL-TERM
 13502                                    CP-REMAINING-TERM
 13503                                    CP-LOAN-TERM.
 13504
 13505     MOVE 'R'                   TO CP-RATE-FILE.
 13506     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13507
 13508     IF CP-ERROR-RATE-NOT-FOUND
 13509         MOVE ER-2641            TO WS-ERROR
 13510         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13511         GO TO 3300-CHECK-AH-RATES.
 13512
 13513     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13514     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13515
 13516     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13517         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13518
 13519     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13520                               + PB-I-LF-ALT-BENEFIT-AMT.
 13521
 13522     IF ACCOUNT-LIFE-CHECKED  OR
 13523        PB-POLICY-IS-VOIDED   OR
 13524        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13525        GO TO 3225-CONTINUE.
 13526
 13527     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13528        GO TO 3225-CONTINUE.
 13529
 13530     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13531                             EC-RT-LF-MAX-TOT-BEN
 13532        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13533        MOVE ER-2639       TO WS-ERROR
 13534        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13535
 13536 3225-CONTINUE.
 13537     IF PB-I-LF-ALT-RATE = ZERO
 13538         MOVE ER-2659            TO WS-ERROR
 13539         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13540
 13541     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13542        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13543        MOVE ER-2698             TO WS-ERROR
 13544        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13545
 13546 3225-RATING-CONT.
 13547
 13548     IF WS-LF-SPECIAL-CALC-CD = 'E'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 247
* EL050.cbl
 13549         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13550         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13551         IF (PB-COMPANY-ID = 'DCC')
 13552            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13553            CONTINUE
 13554         ELSE
 13555            MOVE ER-2687         TO WS-ERROR
 13556            PERFORM 9900-ERROR-FORMAT
 13557                                 THRU 9900-EXIT
 13558         END-IF
 13559         GO TO 3290-EDIT-LF-REIN-RATE
 13560     END-IF
 13561
 13562* DMD RATING TEST
 13563     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13564         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13565         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13566         MOVE ER-2687                 TO WS-ERROR
 13567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13568         GO TO 3290-EDIT-LF-REIN-RATE.
 13569
 13570 3230-CLIENT-MORT-CD-SPECIALS.
 13571
 13572     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13573     SET BIN-TO-GREG          TO TRUE.
 13574*    MOVE ' '                 TO DC-OPTION-CODE.
 13575     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13576     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13577
 13578 C-POS-3230-MORT-CD.
 13579     IF PB-COMPANY-ID = 'POS' AND
 13580        PB-SV-CARRIER = '2'
 13581         NEXT SENTENCE
 13582     ELSE
 13583         GO TO C-POS-3240-MORT-CD.
 13584
 13585     IF PB-SV-GROUPING = '030'
 13586        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13587         MOVE '2350' TO PB-I-MORT-CODE
 13588      ELSE
 13589         MOVE '3300' TO PB-I-MORT-CODE.
 13590
 13591
 13592 C-POS-3240-MORT-CD.
 13593     IF PB-COMPANY-ID = 'POS' AND
 13594        PB-SV-CARRIER = '1'
 13595         NEXT SENTENCE
 13596     ELSE
 13597         GO TO 3230-CONTINUE.
 13598
 13599     IF PB-SV-STATE = '45' OR '47'
 13600        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13601         MOVE '5200' TO PB-I-MORT-CODE
 13602     ELSE
 13603         MOVE '8300' TO PB-I-MORT-CODE.
 13604
 13605 3230-CONTINUE.
 13606
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 248
* EL050.cbl
 13607     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13608        GO TO 3240-CONTINUE
 13609     END-IF
 13610
 13611     IF PB-CERT-EFF-DT > WS-971231
 13612        GO TO 3240-CONTINUE
 13613     END-IF
 13614
 13615     IF LF-BENEFIT-FOUND AND
 13616        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13617         MOVE 'F250'       TO PB-I-MORT-CODE
 13618     ELSE
 13619         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13620             MOVE '7250'   TO PB-I-MORT-CODE
 13621         ELSE
 13622             MOVE '4251'   TO PB-I-MORT-CODE
 13623         END-IF
 13624     END-IF
 13625
 13626     .
 13627 3240-CONTINUE.
 13628
 13629     IF PB-COMPANY-ID NOT = 'GNL'
 13630         GO TO 3256-CONTINUE.
 13631
 13632     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13633         MOVE 'A300' TO PB-I-MORT-CODE
 13634     ELSE
 13635         MOVE '8350' TO PB-I-MORT-CODE.
 13636
 13637 3256-CONTINUE.
 13638     IF PB-COMPANY-ID NOT = 'ABL'
 13639         GO TO 3260-EDIT-CONTINUE.
 13640
 13641     IF PB-I-LF-TERM GREATER THAN 59
 13642         MOVE 'F550' TO PB-I-MORT-CODE
 13643     ELSE
 13644         MOVE 'E550' TO PB-I-MORT-CODE.
 13645
 13646 3260-EDIT-CONTINUE.
 13647     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13648
 13649 3290-EDIT-LF-REIN-RATE.
 13650     IF LF-REIN-NSP-NOT-USED
 13651         GO TO 3290-RATING-CONT.
 13652
 13653     IF PB-COMPANY-ID = 'DCC'
 13654        GO TO 3290-RATING-CONT.
 13655     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13656     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13657     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13658     MOVE '3'                   TO CP-PROCESS-TYPE.
 13659     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13660
 13661******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13662     IF PB-COMPANY-ID EQUAL 'CDL'
 13663         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13664            CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 249
* EL050.cbl
 13665             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13666*            MOVE SPACE          TO DC-OPTION-CODE
 13667             SET BIN-TO-GREG     TO TRUE
 13668             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13669***  Y2K PROJ 7744
 13670             IF DC-GREG-DATE-CYMD GREATER 19931231
 13671                 MOVE '1'        TO CP-EARNING-METHOD.
 13672***  Y2K PROJ 7744
 13673*******
 13674
 13675     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13676     MOVE PB-SV-STATE           TO CP-STATE.
 13677     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13678     MOVE ZERO                  TO CP-DEVIATION-CODE
 13679                                   CP-RATE-DEV-PCT.
 13680     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13681     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13682                                   CP-RATING-BENEFIT-AMT.
 13683
 13684************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13685     IF PB-COMPANY-ID EQUAL 'NCB'
 13686         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13687            CP-EARN-AS-NET-PAY
 13688             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13689                 PB-I-LF-PREMIUM-AMT.
 13690************
 13691
 13692     IF CP-STATE-STD-ABBRV = 'OR'
 13693         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13694                                         PB-I-LF-ALT-BENEFIT-AMT.
 13695     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13696     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13697     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13698     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13699     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13700     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13701     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13702     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13703                                   CP-REMAINING-TERM
 13704                                   CP-LOAN-TERM.
 13705     IF CP-TRUNCATED-LIFE
 13706        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13707
 13708     IF CP-TERM-IS-DAYS
 13709         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13710     ELSE
 13711         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13712
 13713     IF PB-COMPANY-ID = 'DCC'
 13714        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13715     END-IF
 13716     IF PB-COMPANY-ID NOT = 'TIC'
 13717          MOVE ZERO          TO CP-CLASS-CODE.
 13718
 13719     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13720
 13721     MOVE 'R'                   TO CP-RATE-FILE.
 13722     PERFORM 7000-GET-RATE THRU 7000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 250
* EL050.cbl
 13723
 13724     IF CP-ERROR-RATE-NOT-FOUND
 13725        IF PB-I-OB
 13726           MOVE ER-2625      TO WS-ERROR
 13727           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13728           GO TO 3299-EDIT-CONTINUE
 13729        ELSE
 13730           MOVE ER-2643      TO WS-ERROR
 13731           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13732           GO TO 3299-EDIT-CONTINUE.
 13733
 13734     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13735
 13736     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13737     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13738
 13739     IF PB-I-LF-REI-RATE = ZERO
 13740         MOVE ER-2643        TO WS-ERROR
 13741         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13742
 13743 3290-CHECK-ALT-REIN-RATE.
 13744
 13745     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13746        GO TO 3290-RATING-CONT.
 13747
 13748     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13749     MOVE '2'                    TO CP-EARNING-METHOD.
 13750     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13751     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13752     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13753     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13754                                     CP-RATING-BENEFIT-AMT.
 13755     IF CP-STATE-STD-ABBRV = 'OR'
 13756         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13757                                         PB-I-LF-ALT-BENEFIT-AMT.
 13758     IF PB-COMPANY-ID = 'DCC'
 13759        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13760     END-IF
 13761     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13762     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13763     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13764                                    CP-REMAINING-TERM
 13765                                    CP-LOAN-TERM.
 13766     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13767        ADD +1                   TO CP-ORIGINAL-TERM
 13768                                    CP-REMAINING-TERM
 13769                                    CP-LOAN-TERM.
 13770
 13771     MOVE 'R'                   TO CP-RATE-FILE.
 13772     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13773
 13774     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13775
 13776     IF PB-I-LF-ALT-REI-RATE = ZERO
 13777         MOVE ER-2643            TO WS-ERROR
 13778         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13779
 13780 3290-RATING-CONT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 251
* EL050.cbl
 13781
 13782     IF PB-I-OB
 13783*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13784        GO TO 3300-CHECK-AH-RATES.
 13785
 13786 3299-EDIT-CONTINUE.
 13787
 13788     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13789         NEXT SENTENCE
 13790     ELSE
 13791         MOVE ER-2620           TO WS-ERROR
 13792         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13793
 13794 3300-CHECK-AH-RATES.
 13795     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13796         NEXT SENTENCE
 13797     ELSE
 13798         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13799
 13800     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13801        ((CF-COMPANY-ID = 'DMD') AND
 13802                (NO-DMD-RATING))
 13803         IF (PB-COMPANY-ID = 'DCC')
 13804            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13805            CONTINUE
 13806         ELSE
 13807            MOVE ER-2687         TO WS-ERROR
 13808            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13809         END-IF
 13810         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13811         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13812     END-IF
 13813
 13814     IF PB-I-OB
 13815        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13816
 13817     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13818         MOVE ER-2687             TO WS-ERROR
 13819         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13820         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13821         GO TO 3999-END-EDIT.
 13822
 13823*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13824
 13825     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13826        IF PB-I-AH-CRIT-PER = ZERO
 13827           IF PB-COMPANY-ID = 'DCC'
 13828              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13829              CONTINUE
 13830           ELSE
 13831              MOVE ER-2618       TO WS-ERROR
 13832              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13833              GO TO 3999-END-EDIT
 13834           END-IF
 13835        END-IF
 13836     END-IF
 13837     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13838     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 252
* EL050.cbl
 13839     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13840     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13841     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13842     MOVE PB-SV-STATE            TO CP-STATE.
 13843     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13844     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13845     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13846*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13847     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13848     MOVE '3'                    TO CP-PROCESS-TYPE.
 13849     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13850     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13851                                    CP-RATING-BENEFIT-AMT.
 13852     IF PB-COMPANY-ID = 'CID'
 13853               OR
 13854        CP-STATE-STD-ABBRV = 'OR'
 13855         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13856                                         PB-I-AH-TERM.
 13857     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13858        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13859           AND (PB-I-POLICY-IS-MONTHLY)
 13860           MOVE PB-I-LF-BENEFIT-AMT
 13861                                 TO CP-NET-BENEFIT-AMT
 13862           move pb-i-ah-premium-amt to cp-original-premium
 13863        END-IF
 13864     END-IF
 13865     MOVE SPACES                 TO CP-BEN-CATEGORY
 13866     IF PB-COMPANY-ID = 'DCC'
 13867        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13868        EVALUATE TRUE
 13869           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13870              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13871              MOVE PB-I-LF-BENEFIT-AMT
 13872                                 TO CP-RATING-BENEFIT-AMT
 13873              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13874           WHEN WS-AH-BEN-CATEGORY = 'G'
 13875              MOVE PB-I-UNPAID-CASH-PRICE
 13876                                 TO CP-RATING-BENEFIT-AMT
 13877           WHEN WS-AH-BEN-CATEGORY = 'D'
 13878              MOVE WS-AH-PMF-COMM
 13879                                 TO CP-DCC-PMF-COMM
 13880              MOVE PB-I-AH-COMMISSION
 13881                                 TO CP-DCC-ACT-COMM
 13882        END-EVALUATE
 13883     END-IF
 13884     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13885     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13886     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13887     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13888     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13889     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13890     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13891                                    CP-REMAINING-TERM
 13892                                    WS-WORK-TERM.
 13893     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13894
 13895     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13896     SET BIN-TO-GREG             TO TRUE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 253
* EL050.cbl
 13897*    MOVE ' '                    TO DC-OPTION-CODE.
 13898     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13899     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13900
 13901     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13902     IF NOT VALID-SKIP-CODE
 13903         MOVE ER-2683            TO WS-ERROR
 13904         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13905         GO TO 3320-RATE-CONTINUE.
 13906
 13907     IF PB-NO-MONTHS-SKIPPED
 13908         GO TO 3320-RATE-CONTINUE.
 13909
 13910     MOVE SPACE TO NUMBER-OF-MONTHS.
 13911
 13912     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13913         MOVE 'S'                TO SK-MO (6).
 13914     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13915         MOVE 'S'                TO SK-MO (7).
 13916     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13917         MOVE 'S'                TO SK-MO (8).
 13918     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13919         MOVE 'S'                TO SK-MO (9).
 13920     IF PB-I-SKIP-CODE = 'A'
 13921         MOVE 'S'                TO SK-MO (10).
 13922
 13923     MOVE 1                      TO SUB2.
 13924     MOVE PB-I-AH-TERM           TO SUB3.
 13925     MOVE WS-MONTH               TO SUB1.
 13926     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13927     GO TO 3320-RATE-CONTINUE.
 13928
 13929 3310-GET-SKIP-MO.
 13930     IF SUB1 = 13
 13931         MOVE 1                  TO SUB1.
 13932
 13933     IF SK-MO (SUB1) = 'S'
 13934         SUBTRACT 1 FROM WS-WORK-TERM.
 13935
 13936     ADD 1 TO SUB2
 13937              SUB1.
 13938
 13939 3320-RATE-CONTINUE.
 13940
 13941     IF WS-WORK-TERM = ZERO
 13942         MOVE 1                  TO WS-WORK-TERM.
 13943
 13944     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13945                                    CP-LOAN-TERM.
 13946
 13947     IF PB-COMPANY-ID EQUAL 'DMD'
 13948         NEXT SENTENCE
 13949     ELSE
 13950         MOVE ZERO               TO PB-I-AH-RATE
 13951                                    PB-I-AH-REI-RATE.
 13952
 13953
 13954     IF PB-COMPANY-ID EQUAL 'CRI'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 254
* EL050.cbl
 13955        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13956
 13957     IF PB-COMPANY-ID = 'CSL'
 13958         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13959         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13960         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13961         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13962
 13963     IF PB-COMPANY-ID = 'DCC'
 13964        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13965           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13966              PB-I-RATE-DEV-PCT-LF
 13967        END-IF
 13968        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13969                                 TO CP-ALTERNATE-BENEFIT
 13970        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13971        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13972        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13973     END-IF
 13974     IF (PB-COMPANY-ID = 'CID')
 13975        AND (WS-LF-EARNINGS-CALC = 'B')
 13976        AND (CP-STATE-STD-ABBRV = 'MN')
 13977        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 13978     ELSE
 13979        MOVE ' '                 TO CP-AH-BALLOON-SW
 13980     END-IF
 13981     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 13982     MOVE 'R'                   TO CP-RATE-FILE.
 13983     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13984
 13985     IF CP-ERROR-RATE-NOT-FOUND
 13986        IF PB-I-OB
 13987           MOVE ER-2624          TO WS-ERROR
 13988           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13989           GO TO 3340-CALCULATE-PREMIUM-AMT
 13990        ELSE
 13991          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13992              NEXT SENTENCE
 13993          ELSE
 13994           MOVE ER-2642          TO WS-ERROR
 13995           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13996           GO TO 3340-CALCULATE-PREMIUM-AMT.
 13997
 13998     IF PB-COMPANY-ID EQUAL 'CSL' AND
 13999        CP-ERROR-DIV-BY-ZERO
 14000           MOVE ER-3782          TO WS-ERROR
 14001           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14002
 14003     IF PB-COMPANY-ID EQUAL 'CRI'
 14004        IF CP-ERROR-NO-LIMITS-CRI
 14005           IF NOT ACCOUNT-AH-CHECKED
 14006              MOVE ER-2607          TO WS-ERROR
 14007              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14008
 14009     IF ACCOUNT-AH-CHECKED
 14010        NEXT SENTENCE
 14011     ELSE
 14012       IF CP-ERROR-AMT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 255
* EL050.cbl
 14013          MOVE ER-2640           TO WS-ERROR
 14014          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14015
 14016     IF PB-COMPANY-ID = 'CRI'
 14017         IF WS-ERROR = ER-2640
 14018             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14019     IF ACCOUNT-AH-CHECKED
 14020        CONTINUE
 14021     ELSE
 14022        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14023           AND (CP-R-MAX-ATT-AGE > +0)
 14024           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14025           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14026              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14027              MOVE PB-I-AH-EXPIRE-DT
 14028                                 TO DC-BIN-DATE-2
 14029              MOVE '1'           TO DC-OPTION-CODE
 14030              PERFORM 8500-DATE-CONVERT
 14031                                 THRU 8500-EXIT
 14032              IF NO-CONVERSION-ERROR
 14033                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14034                    MOVE ER-2661       TO WS-ERROR
 14035*                   PERFORM 9900-ERROR-FORMAT
 14036*                                THRU 9900-EXIT
 14037                 END-IF
 14038              END-IF
 14039           ELSE
 14040              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14041              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14042                 MOVE ER-2661    TO WS-ERROR
 14043*                PERFORM 9900-ERROR-FORMAT
 14044*                                THRU 9900-EXIT
 14045              ELSE
 14046                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14047                    MOVE ER-1570 TO WS-ERROR
 14048                    PERFORM 9900-ERROR-FORMAT
 14049                                 THRU 9900-EXIT
 14050                 END-IF
 14051              END-IF
 14052           END-IF
 14053           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14054              MOVE PB-I-JOINT-BIRTHDAY
 14055                                    TO DC-BIN-DATE-1
 14056              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14057              MOVE '1'              TO DC-OPTION-CODE
 14058              PERFORM 8500-DATE-CONVERT
 14059                                    THRU 8500-EXIT
 14060              IF NO-CONVERSION-ERROR
 14061                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14062                    MOVE ER-2661       TO WS-ERROR
 14063*                   PERFORM 9900-ERROR-FORMAT
 14064*                                   THRU 9900-EXIT
 14065                 END-IF
 14066              END-IF
 14067           ELSE
 14068              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14069                (PB-I-AH-TERM / 12)
 14070              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 256
* EL050.cbl
 14071                 MOVE ER-2661       TO WS-ERROR
 14072*                PERFORM 9900-ERROR-FORMAT
 14073*                                   THRU 9900-EXIT
 14074              ELSE
 14075                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14076                    MOVE ER-1571 TO WS-ERROR
 14077                    PERFORM 9900-ERROR-FORMAT
 14078                                 THRU 9900-EXIT
 14079                 END-IF
 14080              END-IF
 14081           END-IF
 14082           IF WS-ERROR = ER-2661
 14083              PERFORM 9900-ERROR-FORMAT
 14084                                    THRU 9900-EXIT
 14085           END-IF
 14086        END-IF
 14087     END-IF
 14088*    IF ACCOUNT-AH-CHECKED
 14089*       NEXT SENTENCE
 14090*    ELSE
 14091*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14092*          MOVE ER-2661          TO WS-ERROR
 14093*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14094
 14095     IF ACCOUNT-AH-CHECKED
 14096        NEXT SENTENCE
 14097     ELSE
 14098        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14099           MOVE ER-2663          TO WS-ERROR
 14100           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14101
 14102     IF ACCOUNT-AH-CHECKED OR
 14103        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14104         PB-POLICY-IS-VOIDED
 14105        NEXT SENTENCE
 14106     ELSE
 14107        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14108           MOVE ER-2667            TO WS-ERROR
 14109           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14110
 14111     IF PB-COMPANY-ID = 'CRI'
 14112         IF WS-ERROR = ER-2667
 14113             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14114
 14115     IF ACCOUNT-AH-CHECKED
 14116        NEXT SENTENCE
 14117     ELSE
 14118        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14119           MOVE ER-2678            TO WS-ERROR
 14120           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14121
 14122     IF CP-ERROR-RATE-FILE-NOTOPEN
 14123         GO TO 3990-FILES-NOT-OPEN.
 14124
 14125 3321-CONTINUE.
 14126     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14127     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14128     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 257
* EL050.cbl
 14129        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14130        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14131                                    PB-I-LF-ALT-PREM-CALC
 14132        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14133        IF WS-AH-BEN-CATEGORY = 'G'
 14134           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14135           + PB-I-ADDL-CLP)
 14136           * (1 + WS-TOL-CLP-PCT)
 14137*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14138        ELSE
 14139           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14140           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14141*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14142        END-IF
 14143        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14144                                 TO PB-I-AH-PREM-CALC
 14145        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14146           MOVE ER-8152          TO WS-ERROR
 14147           PERFORM 9900-ERROR-FORMAT
 14148                                 THRU 9900-EXIT
 14149        ELSE
 14150           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14151                 PB-I-ADDL-CLP)
 14152              MOVE ER-8148       TO WS-ERROR
 14153              PERFORM 9900-ERROR-FORMAT
 14154                                 THRU 9900-EXIT
 14155           END-IF
 14156        END-IF
 14157     END-IF
 14158     IF (PB-COMPANY-ID = 'DCC')
 14159        AND (PB-I-POLICY-IS-MONTHLY)
 14160        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14161        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14162        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14163           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14164        END-IF
 14165     END-IF
 14166     IF (PB-COMPANY-ID = 'DCC')
 14167        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14168        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14169        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14170        MOVE ER-2786             TO WS-ERROR
 14171        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14172     END-IF
 14173     MOVE +0                     TO PB-I-AH-CLP
 14174     IF PB-COMPANY-ID = 'DCC'
 14175        IF WS-AH-BEN-CATEGORY = 'D'
 14176           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14177              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14178        ELSE
 14179           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14180              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14181           END-IF
 14182        END-IF
 14183     END-IF
 14184     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14185
 14186     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 258
* EL050.cbl
 14187         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14188
 14189     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14190         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14191
 14192     IF PB-COMPANY-ID = 'CRI'
 14193         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14194            PB-I-PAYMENT-AMOUNT = ZERO
 14195             NEXT SENTENCE
 14196         ELSE
 14197             COMPUTE PB-I-AH-PREM-CALC =
 14198                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14199                 (CP-PREMIUM-RATE / 100)
 14200             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14201                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14202                                             PB-I-RATE-DEV-PCT-AH.
 14203
 14204     IF PB-I-AH-RATE  = ZERO
 14205       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14206           NEXT SENTENCE
 14207       ELSE
 14208         MOVE ER-2642            TO WS-ERROR
 14209         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14210
 14211     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14212     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14213     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14214     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14215     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14216     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14217
 14218     IF (PB-COMPANY-ID = 'DCC')
 14219        AND (WS-AH-BEN-CATEGORY = 'G')
 14220        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14221        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14222        IF CP-DEVIATION-CODE NOT = '000'
 14223           MOVE '000'            TO CP-DEVIATION-CODE
 14224           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14225           IF NO-CP-ERROR
 14226              COMPUTE PB-I-DDF-IU-RATE-UP =
 14227              PB-I-AH-CLP - CP-CALC-PREMIUM
 14228           ELSE
 14229              MOVE ER-3057        TO WS-ERROR
 14230              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14231           END-IF
 14232        END-IF
 14233     END-IF
 14234     .
 14235 3335-EDIT-AH-REIN-NSP-RATE.
 14236     IF AH-REIN-NSP-NOT-USED
 14237         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14238
 14239     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14240     IF PB-COMPANY-ID = 'DCC'
 14241         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14242     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14243     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14244     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 259
* EL050.cbl
 14245     MOVE PB-SV-STATE            TO CP-STATE.
 14246     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14247     MOVE ZERO                   TO CP-DEVIATION-CODE
 14248                                    CP-RATE-DEV-PCT.
 14249*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14250     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14251     MOVE '3'                    TO CP-PROCESS-TYPE.
 14252     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14253     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14254                                    CP-RATING-BENEFIT-AMT.
 14255     IF CP-STATE-STD-ABBRV = 'OR'
 14256         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14257                                         PB-I-AH-TERM.
 14258     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14259     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14260     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14261     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14262     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14263     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14264                                    CP-REMAINING-TERM
 14265                                    WS-WORK-TERM.
 14266     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14267     IF PB-COMPANY-ID = 'DCC'
 14268        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14269     END-IF
 14270     IF  PB-COMPANY-ID = 'TIC'
 14271         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14272            MOVE ZERO TO CP-CLASS-CODE.
 14273
 14274     IF PB-COMPANY-ID NOT = 'TIC'
 14275          MOVE ZERO          TO CP-CLASS-CODE.
 14276
 14277     MOVE ZERO               TO CP-DEVIATION-CODE.
 14278
 14279     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14280
 14281     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14282
 14283     MOVE 'R'                   TO CP-RATE-FILE.
 14284     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14285
 14286     IF CP-ERROR-RATE-NOT-FOUND
 14287         MOVE ER-2645        TO WS-ERROR
 14288         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14289         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14290
 14291     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14292
 14293     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14294     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14295
 14296     IF PB-I-AH-REI-RATE = ZERO
 14297         MOVE ER-2645        TO WS-ERROR
 14298         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14299
 14300
 14301 3340-CALCULATE-PREMIUM-AMT.
 14302
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 260
* EL050.cbl
 14303     IF PB-COMPANY-ID = 'NCL'
 14304         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14305             WS-AH-SPECIAL-CALC-CD = 'O')
 14306             GO TO 3999-END-EDIT.
 14307
 14308     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14309                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14310                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14311                         OR 'AHL'
 14312         NEXT SENTENCE
 14313     ELSE
 14314         IF WS-STATE-ABBREVIATION = 'CT'
 14315             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14316                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14317                 COMPUTE PB-I-LF-PREM-CALC =
 14318                                     PB-I-LF-PREM-CALC * .90
 14319                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14320                                     PB-I-LF-ALT-PREM-CALC * .90
 14321                 COMPUTE PB-I-AH-PREM-CALC =
 14322                                     PB-I-AH-PREM-CALC * .90.
 14323
 14324     IF PB-COMP-LF-PREM
 14325        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14326        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14327
 14328     IF PB-COMP-AH-PREM
 14329        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14330
 14331 3340-CHECK-DCC-TOT-FEES.
 14332     IF (PB-COMPANY-ID = 'DCC')
 14333        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14334        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14335        AND (PB-I-POLICY-IS-MONTHLY)
 14336        CONTINUE
 14337     ELSE
 14338        GO TO 3340-EDIT-LF-AH-TOL
 14339     END-IF
 14340     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14341     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14342     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14343        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14344           PB-I-RATE-DEV-PCT-LF
 14345     END-IF
 14346     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14347        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14348           PB-I-RATE-DEV-PCT-AH
 14349     END-IF
 14350     MOVE 'N'                    TO CP-BEN-CATEGORY
 14351     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14352
 14353     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14354     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14355     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14356     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14357     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14358     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14359     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14360     MOVE '3'                    TO CP-PROCESS-TYPE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 261
* EL050.cbl
 14361     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14362     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14363
 14364     MOVE PB-SV-STATE            TO CP-STATE.
 14365     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14366     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14367     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14368     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14369     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14370                                    CP-RATING-BENEFIT-AMT.
 14371     IF CP-STATE-STD-ABBRV = 'OR'
 14372         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14373                                         PB-I-LF-ALT-BENEFIT-AMT.
 14374     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14375     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14376     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14377     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14378     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14379     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14380     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14381     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14382     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14383                                    CP-REMAINING-TERM
 14384                                    CP-LOAN-TERM.
 14385
 14386     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14387         NEXT SENTENCE
 14388     ELSE
 14389         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14390             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14391                                           PB-I-LF-PREMIUM-AMT.
 14392
 14393     IF CP-TRUNCATED-LIFE
 14394        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14395
 14396     IF CP-TERM-IS-DAYS
 14397         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14398     ELSE
 14399         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14400
 14401     IF PB-COMPANY-ID = 'DCC'
 14402        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14403     END-IF
 14404     IF CP-SPECIAL-CALC-CD = 'H'
 14405         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14406                                    TO CP-ALTERNATE-BENEFIT
 14407         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14408     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14409     MOVE 'R'                    TO CP-RATE-FILE
 14410     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14411     IF NOT CP-ERROR-RATE-NOT-FOUND
 14412        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14413        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14414           AND (CP-BENEFIT-CD (1:1) = 'S')
 14415           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14416                                    PB-I-LF-PREMIUM-AMT
 14417        END-IF
 14418     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 262
* EL050.cbl
 14419        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14420     END-IF
 14421     .
 14422 3340-EDIT-LF-AH-TOL.
 14423
 14424***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14425***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14426***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14427***
 14428     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14429         PB-I-AH-PREMIUM-AMT
 14430          GIVING WS-CALC-WORK.
 14431
 14432     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14433        AND WS-CALC-WORK NOT = ZERO
 14434         MOVE ER-2649            TO WS-ERROR
 14435         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14436
 14437     SUBTRACT PB-I-LF-PREM-CALC
 14438             FROM PB-I-LF-PREMIUM-AMT
 14439                 GIVING WS-UNSIGN-WRK1.
 14440
 14441     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14442             FROM PB-I-LF-ALT-PREMIUM-AMT
 14443                 GIVING WS-UNSIGN-WRK4.
 14444
 14445     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14446                                + WS-UNSIGN-WRK4.
 14447
 14448     SUBTRACT PB-I-AH-PREM-CALC
 14449             FROM PB-I-AH-PREMIUM-AMT
 14450                 GIVING WS-UNSIGN-WRK2.
 14451
 14452******************************************************************
 14453*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14454******************************************************************
 14455
 14456     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14457         MOVE ZERO TO WS-UNSIGN-WRK1.
 14458
 14459     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14460         MOVE ZERO TO WS-UNSIGN-WRK2.
 14461
 14462     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14463             GIVING WS-UNSIGN-WRK3.
 14464
 14465 3342-CONTINUE.
 14466
 14467     IF (PB-I-LF-RATE = ZERO  AND
 14468         PB-I-AH-RATE = ZERO)
 14469         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14470            WS-AH-SPECIAL-CALC-CD = 'O'
 14471              NEXT SENTENCE
 14472         ELSE
 14473             GO TO 3345-EDIT-CONTINUE.
 14474
 14475     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14476         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 263
* EL050.cbl
 14477     ELSE
 14478     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14479        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14480           IF (PB-REISSUED-CERT         OR
 14481               PB-POLICY-IS-DECLINED    OR
 14482               PB-POLICY-IS-VOIDED)
 14483              NEXT SENTENCE
 14484           ELSE
 14485              IF WS-PREM-REJECT-SW = SPACE
 14486                 MOVE ER-2652    TO WS-ERROR
 14487                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14488                 GO TO 3344-CHECK-AH
 14489              ELSE
 14490                 MOVE ER-2650    TO WS-ERROR
 14491                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14492                 GO TO 3344-CHECK-AH.
 14493
 14494***
 14495***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14496***
 14497
 14498     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14499         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14500            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14501             (1 + WS-TOL-LF-PREM-PCT)
 14502         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14503            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14504             (1 - WS-TOL-LF-PREM-PCT)
 14505     ELSE
 14506         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 14507         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14508
 14509***
 14510***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14511***
 14512
 14513     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14514         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14515          WS-TOL-LF-PREM.
 14516
 14517     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14518         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14519          WS-TOL-LF-PREM.
 14520
 14521     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14522        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14523
 14524     IF (PB-REISSUED-CERT        OR
 14525         PB-POLICY-IS-DECLINED   OR
 14526         PB-POLICY-IS-VOIDED)
 14527        NEXT SENTENCE
 14528     ELSE
 14529     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14530           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 14531       OR
 14532        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14533           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 14534       AND
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 264
* EL050.cbl
 14535        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14536           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 14537         OR
 14538          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14539           LESS WS-TOL-LF-LOW-PREM-PCT))
 14540              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14541                  MOVE ER-2652   TO  WS-ERROR
 14542                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14543              ELSE
 14544                  MOVE ER-2650   TO  WS-ERROR
 14545                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14546
 14547*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14548*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14549*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14550*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14551
 14552     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14553        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14554                      OR
 14555           ((PB-COMPANY-ID = 'DCC')
 14556           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 14557           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14558           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14559        END-IF
 14560     END-IF
 14561
 14562     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14563        IF WS-COMP-MAX-CAP GREATER THAN +0
 14564           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14565              IF (PB-REISSUED-CERT         OR
 14566                  PB-POLICY-IS-DECLINED    OR
 14567                  PB-POLICY-IS-VOIDED)
 14568                 NEXT SENTENCE
 14569              ELSE
 14570                  MOVE ER-2646   TO  WS-ERROR
 14571                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14572
 14573 3344-CVL-TOLERANCE-CHECK.
 14574
 14575      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14576          GO TO 3344-CHECK-AH.
 14577
 14578      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14579          GO TO 3344-CHECK-AH.
 14580
 14581      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14582                                     WS-UNSIGN-WRK6.
 14583
 14584      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14585          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14586                                 + PB-I-LF-PREMIUM-AMT
 14587                                 - PB-I-LF-PREM-CALC.
 14588
 14589      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14590          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14591                                 + PB-I-LF-ALT-PREMIUM-AMT
 14592                                 - PB-I-LF-ALT-PREM-CALC.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 265
* EL050.cbl
 14593
 14594      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14595          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14596              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14597                 MOVE ER-2652    TO  WS-ERROR
 14598                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14599              ELSE
 14600                 MOVE ER-2650    TO  WS-ERROR
 14601                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14602
 14603      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14604          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14605              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14606                 MOVE ER-2652    TO  WS-ERROR
 14607                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14608              ELSE
 14609                 MOVE ER-2650    TO  WS-ERROR
 14610                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14611
 14612 3344-CHECK-AH.
 14613
 14614****************************************************************
 14615***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14616***
 14617
 14618     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14619         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14620             (1 + WS-TOL-AH-PREM-PCT)
 14621         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14622             (1 - WS-TOL-AH-PREM-PCT)
 14623     ELSE
 14624         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 14625         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14626
 14627***
 14628***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14629***
 14630
 14631     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14632         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14633
 14634     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14635         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14636
 14637     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14638        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14639
 14640     IF (PB-REISSUED-CERT)
 14641        OR (PB-POLICY-IS-DECLINED)
 14642        OR (PB-POLICY-IS-VOIDED)
 14643        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14644        CONTINUE
 14645     ELSE
 14646        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14647            OR
 14648           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14649           AND
 14650           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 266
* EL050.cbl
 14651           OR
 14652           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14653           IF WS-PREM-REJECT-SW = SPACE
 14654              MOVE ER-3052       TO WS-ERROR
 14655              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14656           ELSE
 14657              MOVE ER-3050       TO WS-ERROR
 14658              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14659           END-IF
 14660        END-IF
 14661     END-IF
 14662
 14663     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14664         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14665             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14666             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14667
 14668     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14669        IF WS-COMP-MAX-CAP GREATER THAN +0
 14670           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14671              IF (PB-REISSUED-CERT         OR
 14672                  PB-POLICY-IS-DECLINED    OR
 14673                  PB-POLICY-IS-VOIDED)
 14674                 NEXT SENTENCE
 14675              ELSE
 14676                  MOVE ER-2646   TO  WS-ERROR
 14677                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14678
 14679     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14680        (WS-COMP-MAX-CAP EQUAL +0)
 14681           GO TO 3345-EDIT-CONTINUE.
 14682
 14683     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14684        GREATER THAN WS-COMP-MAX-CAP
 14685           MOVE ER-2646          TO  WS-ERROR
 14686           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14687
 14688 3345-EDIT-CONTINUE.
 14689
 14690*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14691*       IF PB-ENTRY-BATCH   NUMERIC
 14692*          IF PB-ISSUE
 14693*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14694*          ELSE
 14695*              IF PB-CANCELLATION
 14696*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14697
 14698*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14699*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14700*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14701*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14702*        ELSE
 14703*            MOVE  ER-1909            TO  WS-ERROR
 14704*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14705
 14706     IF PB-I-POLICY-ACCEPTED
 14707        IF PB-POLICY-IS-DECLINED  OR
 14708           PB-REISSUED-CERT  OR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 267
* EL050.cbl
 14709           PB-REIN-ONLY-CERT  OR
 14710           PB-POLICY-IS-VOIDED
 14711            MOVE  ER-1891         TO  WS-ERROR
 14712            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14713        ELSE
 14714            MOVE SPACE            TO  PB-BATCH-ENTRY
 14715            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14716
 14717     IF PB-I-POLICY-DECLINED
 14718        IF PB-REISSUED-CERT  OR
 14719           PB-REIN-ONLY-CERT  OR
 14720           PB-POLICY-IS-VOIDED
 14721            MOVE  ER-1906         TO  WS-ERROR
 14722            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14723        ELSE
 14724            MOVE  'D'             TO  PB-BATCH-ENTRY
 14725                                      PB-I-ENTRY-STATUS.
 14726
 14727     IF PB-I-NEEDS-UNDERWRITING
 14728        IF PB-POLICY-IS-DECLINED OR
 14729           PB-REISSUED-CERT  OR
 14730           PB-REIN-ONLY-CERT  OR
 14731           PB-POLICY-IS-VOIDED
 14732            MOVE  ER-1907         TO  WS-ERROR
 14733            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14734        ELSE
 14735            MOVE 'U'              TO  PB-BATCH-ENTRY
 14736                                      PB-I-ENTRY-STATUS.
 14737
 14738     IF PB-NEEDS-UNDERWRITING
 14739        MOVE  ER-1901             TO  WS-ERROR
 14740        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14741     IF PB-COMPANY-ID = 'DCC'
 14742        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14743        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14744        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14745           AND (NOT WS-LF-CASH))
 14746                           OR
 14747           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14748           AND (NOT WS-AH-CASH)))
 14749                       AND
 14750           (PB-I-ENTRY-STATUS NOT = '5')
 14751           MOVE 'M'              TO PB-BATCH-ENTRY
 14752                                    PB-I-ENTRY-STATUS
 14753        END-IF
 14754     END-IF
 14755     IF  PB-COMPANY-ID NOT = 'NCL'
 14756         GO TO 3999-END-EDIT.
 14757
 14758     IF PB-REISSUED-CERT  OR
 14759        PB-POLICY-IS-DECLINED  OR
 14760        PB-POLICY-IS-VOIDED  OR
 14761        PB-I-OB
 14762         GO TO 3999-END-EDIT.
 14763
 14764     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14765         MOVE  ER-2644            TO  WS-ERROR
 14766         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 268
* EL050.cbl
 14767         GO TO 3999-END-EDIT.
 14768
 14769     MOVE 'N'                     TO  FORM-MASTER-SW.
 14770     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14771
 14772     IF NOT FORM-MASTER-FOUND
 14773         GO TO 3999-END-EDIT.
 14774
 14775     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14776                                      FORM-MASTER-AH-SW.
 14777
 14778     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14779         MOVE  +1                 TO SUB6
 14780         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14781
 14782     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14783         MOVE  +1                 TO SUB6
 14784         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14785
 14786     IF LF-FORM-MASTER-FOUND  OR
 14787        AH-FORM-MASTER-FOUND
 14788         GO TO 3360-CHECK-FORM-LIMITS
 14789     ELSE
 14790         GO TO 3999-END-EDIT.
 14791
 14792******************************************************************
 14793*                  3350-GET-ERFORM                               *
 14794*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14795*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14796******************************************************************
 14797
 14798 3350-GET-ERFORM.
 14799
 14800     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14801         GO TO  3350-ERFORM-GETMAIN.
 14802
 14803     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14804     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14805     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14806     MOVE 'Y'                     TO FORM-MASTER-SW.
 14807
 14808     IF PB-CANCELLATION
 14809         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14810            PB-SV-STATE          EQUAL   FO-STATE       AND
 14811            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14812              GO TO 3350-EXIT
 14813         ELSE
 14814             NEXT SENTENCE
 14815     ELSE
 14816         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14817            PB-SV-STATE          EQUAL   FO-STATE       AND
 14818            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14819              GO TO 3350-EXIT.
 14820
 14821 3350-ERFORM-GETMAIN.
 14822
 14823     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14824     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 269
* EL050.cbl
 14825
 14826 3350-ERFORM-READ.
 14827
 14828     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14829     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14830     IF PB-CANCELLATION
 14831         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14832     ELSE
 14833         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14834     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14835
 14836     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14837
 14838     IF FORM-MASTER-FOUND
 14839       IF PB-CANCELLATION
 14840          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14841             PB-SV-STATE          EQUAL   FO-STATE       AND
 14842             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14843              GO  TO 3350-EXIT
 14844          ELSE
 14845              NEXT SENTENCE
 14846       ELSE
 14847          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14848             PB-SV-STATE          EQUAL   FO-STATE       AND
 14849             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14850              GO  TO 3350-EXIT.
 14851
 14852     MOVE  'N'                    TO  FORM-MASTER-SW.
 14853     MOVE  ER-1895                TO  WS-ERROR.
 14854     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14855
 14856 3350-EXIT.
 14857      EXIT.
 14858
 14859******************************************************************
 14860*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14861*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14862*   VALID FOR THE POLICY FORM USED.                              *
 14863******************************************************************
 14864
 14865 3355-EDIT-FORM-LF-BENEFITS.
 14866
 14867     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14868        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14869         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14870         GO TO   3355-EXIT.
 14871
 14872     IF  SUB6    LESS THAN   +40
 14873         ADD  +1      TO  SUB6
 14874         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14875
 14876     MOVE  ER-1896         TO  WS-ERROR.
 14877     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14878
 14879 3355-EXIT.
 14880      EXIT.
 14881
 14882******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 270
* EL050.cbl
 14883*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14884*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14885*   VALID FOR THE POLICY FORM USED.                              *
 14886******************************************************************
 14887
 14888 3356-EDIT-FORM-AH-BENEFITS.
 14889
 14890     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14891        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14892         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14893         GO TO  3356-EXIT.
 14894
 14895      IF  SUB6    LESS THAN     +40
 14896          ADD  +1      TO  SUB6
 14897          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14898
 14899     MOVE  ER-1897         TO  WS-ERROR.
 14900     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14901
 14902 3356-EXIT.
 14903      EXIT.
 14904
 14905******************************************************************
 14906*                  3357-BENEFIT-SEARCH                           *
 14907*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14908*   CANCELLATIONS ONLY.                                          *
 14909******************************************************************
 14910 3357-BENEFIT-SEARCH.
 14911     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14912         MOVE +1                          TO SUB6
 14913         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14914
 14915     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14916         MOVE +1                          TO SUB6
 14917         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14918
 14919 3357-EXIT.
 14920     EXIT.
 14921
 14922******************************************************************
 14923*                  3358-BENEFIT-LIFE-SEARCH                      *
 14924*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14925*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14926*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14927******************************************************************
 14928 3358-BENEFIT-LIFE-SEARCH.
 14929     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14930       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14931         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14932           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14933              IF FO-PLAN-REFUND-METHOD (SUB6)
 14934                     IS GREATER THAN SPACES
 14935                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14936                                          WS-LF-REFUND-CALC
 14937                 GO TO 3358-EXIT.
 14938
 14939     IF SUB6 LESS THAN +40
 14940         ADD +1                 TO SUB6
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 271
* EL050.cbl
 14941         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14942
 14943 3358-EXIT.
 14944     EXIT.
 14945******************************************************************
 14946*                  3359-BENEFIT-AH-SEARCH                        *
 14947*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 14948*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14949*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14950******************************************************************
 14951 3359-BENEFIT-AH-SEARCH.
 14952     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14953       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14954         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14955           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14956              IF FO-PLAN-REFUND-METHOD (SUB6)
 14957                      IS GREATER THAN SPACES
 14958                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14959                                          WS-AH-REFUND-CALC
 14960                 GO TO 3359-EXIT.
 14961
 14962     IF SUB6 LESS THAN +40
 14963         ADD +1                 TO SUB6
 14964         GO TO 3359-BENEFIT-AH-SEARCH.
 14965
 14966 3359-EXIT.
 14967     EXIT.
 14968
 14969******************************************************************
 14970*                  3360-CHECK-FORM-LIMITS                        *
 14971*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14972*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14973******************************************************************
 14974
 14975 3360-CHECK-FORM-LIMITS.
 14976
 14977     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14978         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 14979
 14980     IF NOT LF-FORM-MASTER-FOUND
 14981         GO TO 3360-CHECK-FORM-AH-LIMITS.
 14982
 14983 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 14984
 14985     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 14986       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 14987        WS-LF-JOINT-INDICATOR = 'J'  AND
 14988        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14989         IF PB-COMPANY-ID = 'NCL'
 14990            MOVE  ER-1911          TO  WS-ERROR
 14991            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14992         ELSE
 14993            MOVE  ER-1892          TO  WS-ERROR
 14994            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14995
 14996 3360-CHECK-FORM-LF-ATT-AGE.
 14997
 14998     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 272
* EL050.cbl
 14999
 15000     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15001         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15002         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15003            IF PB-COMPANY-ID = 'NCL'
 15004                MOVE  ER-1913      TO  WS-ERROR
 15005                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15006            ELSE
 15007                MOVE  ER-1894      TO  WS-ERROR
 15008                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15009
 15010 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15011
 15012     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15013         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15014         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15015            IF PB-COMPANY-ID = 'NCL'
 15016                MOVE  ER-1914      TO  WS-ERROR
 15017                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15018            ELSE
 15019                MOVE  ER-1899      TO  WS-ERROR
 15020                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15021
 15022 3360-CHECK-FORM-LF-TERM-BAMT.
 15023
 15024     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15025         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15026         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15027           IF  PB-COMPANY-ID = 'NCL'
 15028               MOVE  ER-1916       TO  WS-ERROR
 15029               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15030           ELSE
 15031               MOVE  ER-1902       TO  WS-ERROR
 15032               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15033
 15034     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15035                                    PB-I-LF-ALT-BENEFIT-AMT.
 15036
 15037     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15038         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15039         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15040             IF  PB-COMPANY-ID = 'NCL'
 15041                 MOVE  ER-1918     TO  WS-ERROR
 15042                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15043             ELSE
 15044                 MOVE  ER-1904     TO  WS-ERROR
 15045                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15046
 15047******************************************************************
 15048*                  3360-CHECK-FORM-AH-LIMITS                     *
 15049*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15050*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15051******************************************************************
 15052
 15053 3360-CHECK-FORM-AH-LIMITS.
 15054
 15055     IF NOT AH-FORM-MASTER-FOUND
 15056         GO TO 3999-END-EDIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 273
* EL050.cbl
 15057
 15058 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15059
 15060     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15061       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15062        WS-AH-JOINT-INDICATOR = 'J'  AND
 15063        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15064         IF PB-COMPANY-ID = 'NCL'
 15065            MOVE  ER-1912          TO  WS-ERROR
 15066            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15067         ELSE
 15068            MOVE  ER-1893          TO  WS-ERROR
 15069            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15070
 15071 3360-CHECK-FORM-AH-ATT-AGE.
 15072
 15073     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15074
 15075     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15076         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15077         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15078            IF PB-COMPANY-ID = 'NCL'
 15079                MOVE  ER-1913      TO  WS-ERROR
 15080                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15081            ELSE
 15082                MOVE  ER-1894      TO  WS-ERROR
 15083                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15084
 15085 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15086
 15087     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15088         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15089         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15090            IF PB-COMPANY-ID = 'NCL'
 15091                MOVE  ER-1915      TO  WS-ERROR
 15092                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15093            ELSE
 15094                MOVE  ER-1900      TO  WS-ERROR
 15095                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15096
 15097 3360-CHECK-FORM-AH-TERM-BAMT.
 15098
 15099     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15100         FO-AH-MAX-TERM    GREATER THAN  +0
 15101         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15102             IF  PB-COMPANY-ID = 'NCL'
 15103                 MOVE  ER-1917     TO  WS-ERROR
 15104                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15105             ELSE
 15106                  MOVE  ER-1903    TO  WS-ERROR
 15107                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15108
 15109     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15110         FO-MAX-AH-AMT    GREATER THAN  +0
 15111         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15112             IF  PB-COMPANY-ID = 'NCL'
 15113                 MOVE  ER-1919     TO  WS-ERROR
 15114                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 274
* EL050.cbl
 15115             ELSE
 15116                 MOVE  ER-1905     TO  WS-ERROR
 15117                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15118
 15119     GO TO 3999-END-EDIT.
 15120
 15121******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 275
* EL050.cbl
 15123******************************************************************
 15124*                  E D I T   C A N C E L                         *
 15125******************************************************************
 15126
 15127 3700-EDIT-CANCEL.
 15128     IF PB-COMPANY-ID = 'DMD'
 15129         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15130                                         WS-RES-MUNI-TAX
 15131                                         PB-CI-STATE-TAX
 15132                                         PB-CI-MUNI-TAX
 15133         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15134
 15135*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15136*       IF PB-ENTRY-BATCH  NUMERIC
 15137*          IF PB-CANCELLATION
 15138*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15139*          ELSE
 15140*             IF PB-ISSUE
 15141*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15142
 15143     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15144        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15145     END-IF
 15146*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15147*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15148
 15149     IF CM-ENTRY-STATUS = 'V'
 15150        MOVE ER-2780             TO WS-ERROR
 15151        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15152        GO TO 3999-END-EDIT.
 15153
 15154     IF CM-ENTRY-STATUS = 'D'
 15155        MOVE ER-2781             TO WS-ERROR
 15156        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15157        GO TO 3999-END-EDIT.
 15158
 15159     IF CM-ENTRY-STATUS = 'U'
 15160        MOVE ER-2782             TO WS-ERROR
 15161        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15162
 15163***************************************************************
 15164*                                                             *
 15165*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15166*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15167*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15168*   OF ANOTHER COVERAGE.                                      *
 15169*                                                             *
 15170***************************************************************
 15171
 15172     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15173                                    PB-C-AH-CANCEL-VOID-SW.
 15174
 15175     IF PB-C-LF-CANCEL-AMT = ZERO
 15176        NEXT SENTENCE
 15177     ELSE
 15178        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15179           AND
 15180           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 276
* EL050.cbl
 15181               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15182               MOVE ER-2745           TO WS-ERROR
 15183               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15184
 15185     IF PB-C-AH-CANCEL-AMT = ZERO
 15186        NEXT SENTENCE
 15187     ELSE
 15188        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15189           AND
 15190           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15191               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15192               MOVE ER-2745           TO WS-ERROR
 15193               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15194
 15195     IF WS-LF-EARNINGS-CALC = '4'
 15196        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15197
 15198     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15199     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15200     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15201     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15202     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15203     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15204
 15205     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15206                                      PB-C-AH-REF-CALC.
 15207     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15208
 15209******************************************************************
 15210*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15211*             TO VALIDATE COVERAGE.                              *
 15212******************************************************************
 15213
 15214     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15215        PB-C-LF-CANCEL-AMT = ZEROS
 15216          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15217      ELSE
 15218          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15219
 15220     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15221        PB-C-AH-CANCEL-AMT = ZEROS
 15222          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15223      ELSE
 15224          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15225
 15226     EVALUATE TRUE
 15227         WHEN PB-CANCEL-FORCE             OR
 15228              PB-CANCEL-DATE-FORCED       OR
 15229              PB-FORCE-OFF
 15230                  IF PB-COMPANY-ID = 'ACE'
 15231                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15232                  END-IF
 15233         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15234               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15235              (PB-COMPANY-ID = 'ACE' )
 15236                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15237         WHEN OTHER
 15238              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 277
* EL050.cbl
 15239                 MOVE ER-2794              TO WS-ERROR
 15240              ELSE
 15241                 MOVE ER-2749              TO WS-ERROR
 15242              END-IF
 15243              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15244     END-EVALUATE.
 15245
 15246
 15247*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15248*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15249*            MOVE  ER-1909            TO  WS-ERROR
 15250*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15251*        ELSE
 15252*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15253
 15254     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15255     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15256        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15257     ELSE
 15258        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15259     END-IF
 15260     .
 15261 3705-EDIT-CANCEL-DT.
 15262
 15263     IF LF-COVERAGE-CANCELLED
 15264        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15265         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15266         MOVE WS-CURRENT-MONTH-END
 15267                                 TO DC-BIN-DATE-2
 15268         SET ELAPSED-BETWEEN-BIN TO TRUE
 15269*        MOVE 1                  TO DC-OPTION-CODE
 15270         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15271         IF DATE-CONVERSION-ERROR
 15272            NEXT SENTENCE
 15273          ELSE
 15274             IF DC-ELAPSED-DAYS GREATER +180
 15275                IF PB-CANCEL-DATE-FORCED  OR
 15276                   PB-CANCEL-DATE-FORCED-NO-FEE
 15277                      MOVE ER-2751  TO WS-ERROR
 15278                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15279                 ELSE
 15280                   MOVE ER-2752  TO WS-ERROR
 15281                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15282
 15283     IF AH-COVERAGE-CANCELLED
 15284        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15285         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15286         MOVE WS-CURRENT-MONTH-END
 15287                                 TO DC-BIN-DATE-2
 15288         SET ELAPSED-BETWEEN-BIN TO TRUE
 15289*        MOVE 1                  TO DC-OPTION-CODE
 15290         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15291         IF DATE-CONVERSION-ERROR
 15292            NEXT SENTENCE
 15293          ELSE
 15294             IF DC-ELAPSED-DAYS GREATER +180
 15295                IF PB-CANCEL-DATE-FORCED OR
 15296                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 278
* EL050.cbl
 15297                      MOVE ER-2751  TO WS-ERROR
 15298                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15299                 ELSE
 15300                   MOVE ER-2752  TO WS-ERROR
 15301                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15302
 15303     IF WS-ERROR = ER-2752
 15304        AND (PB-COMPANY-ID = 'ABL'
 15305         OR  PB-COMPANY-ID = 'FGL'
 15306         OR  PB-COMPANY-ID = 'IST'
 15307         OR  PB-COMPANY-ID = 'JHL'
 15308         OR  PB-COMPANY-ID = 'LAP'
 15309         OR  PB-COMPANY-ID = 'LBL'
 15310         OR  PB-COMPANY-ID = 'NCB'
 15311         OR  PB-COMPANY-ID = 'NLI'
 15312         OR  PB-COMPANY-ID = 'OFI'
 15313         OR  PB-COMPANY-ID = 'PLI'
 15314         OR  PB-COMPANY-ID = 'TAO'
 15315         OR  PB-COMPANY-ID = 'TIC'
 15316         OR  PB-COMPANY-ID = 'HER'
 15317         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15318         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15319            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15320            MOVE ER-2762     TO WS-ERROR
 15321            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15322
 15323     IF LF-COVERAGE-CANCELLED
 15324        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15325        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15326             MOVE ER-2733         TO WS-ERROR
 15327             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15328
 15329     IF AH-COVERAGE-CANCELLED
 15330        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15331        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15332              MOVE ER-2733        TO WS-ERROR
 15333              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15334
 15335     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15336        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15337        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15338           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15339            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15340              IF PB-COMPANY-ID NOT = 'LAP'
 15341               MOVE ER-2704            TO WS-ERROR
 15342               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15343
 15344     IF CERT-WAS-NOT-FOUND
 15345         GO TO 3999-END-EDIT.
 15346
 15347     IF PB-COMPANY-ID EQUAL 'CDC'
 15348        IF LF-COVERAGE-CANCELLED
 15349           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15350            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15351            MOVE PB-C-LF-CANCEL-DT
 15352                                 TO DC-BIN-DATE-2
 15353            SET ELAPSED-BETWEEN-BIN TO TRUE
 15354*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 279
* EL050.cbl
 15355            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15356            IF DATE-CONVERSION-ERROR
 15357               NEXT SENTENCE
 15358             ELSE
 15359                IF DC-ELAPSED-DAYS GREATER +60
 15360                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15361
 15362     IF PB-COMPANY-ID EQUAL 'CDC'
 15363        IF AH-COVERAGE-CANCELLED
 15364           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15365            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15366            MOVE PB-C-AH-CANCEL-DT
 15367                                 TO DC-BIN-DATE-2
 15368            MOVE +0              TO DC-ELAPSED-DAYS
 15369                                    DC-ELAPSED-MONTHS
 15370            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15371*           MOVE 1               TO DC-OPTION-CODE
 15372            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15373            IF DATE-CONVERSION-ERROR
 15374               NEXT SENTENCE
 15375             ELSE
 15376                IF DC-ELAPSED-DAYS GREATER +60
 15377                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15378
 15379     MOVE +0                     TO DC-ELAPSED-DAYS
 15380                                    DC-ELAPSED-MONTHS.
 15381
 15382     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15383        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15384          MOVE 'Z'                TO PB-CI-OB-FLAG
 15385          MOVE ER-2767            TO WS-ERROR
 15386          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15387          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15388          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15389          GO TO 3775-OVER-REF-CHK
 15390        ELSE
 15391          MOVE ZEROS              TO PB-CI-LIVES
 15392                                     PB-C-LIVES
 15393          IF PB-CI-OB-FLAG NOT = 'B'
 15394             MOVE SPACE           TO PB-CI-OB-FLAG.
 15395
 15396     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15397         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15398     ELSE
 15399         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15400
 15401     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15402        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15403            MOVE ER-2760         TO WS-ERROR
 15404            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15405
 15406     IF LF-COVERAGE-CANCELLED
 15407        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15408         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15409            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15410               MOVE ER-2774       TO WS-ERROR
 15411               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15412
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 280
* EL050.cbl
 15413     IF AH-COVERAGE-CANCELLED
 15414        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15415         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15416            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15417               MOVE ER-2775       TO WS-ERROR
 15418               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15419
 15420     IF LF-COVERAGE-CANCELLED
 15421        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15422         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15423            MOVE ER-2776         TO WS-ERROR
 15424            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15425
 15426     IF AH-COVERAGE-CANCELLED
 15427        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15428         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15429            MOVE ER-2777         TO WS-ERROR
 15430            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15431
 15432     IF LF-COVERAGE-CANCELLED
 15433        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15434         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15435         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15436         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15437*        MOVE 6                    TO DC-OPTION-CODE
 15438         SET BIN-PLUS-ELAPSED      TO TRUE
 15439         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15440         IF DATE-CONVERSION-ERROR
 15441            NEXT SENTENCE
 15442          ELSE
 15443            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15444              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15445                             OR  'FIA'
 15446                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15447               ELSE
 15448                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15449                MOVE ER-2731       TO WS-ERROR
 15450                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15451
 15452 3705-EDIT-AH-CANCEL-DT.
 15453
 15454     IF AH-COVERAGE-CANCELLED
 15455        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15456         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15457         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15458         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15459*        MOVE 6                    TO DC-OPTION-CODE
 15460         SET BIN-PLUS-ELAPSED      TO TRUE
 15461         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15462         IF DATE-CONVERSION-ERROR
 15463            NEXT SENTENCE
 15464          ELSE
 15465            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15466              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15467                              OR 'FIA'
 15468                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15469              ELSE
 15470               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 281
* EL050.cbl
 15471               MOVE ER-2771       TO WS-ERROR
 15472               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15473
 15474 3705-EDIT-CONTINUED.
 15475
 15476*    IF LF-COVERAGE-CANCELLED
 15477*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15478*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15479*            MOVE ER-2727         TO WS-ERROR
 15480*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15481*
 15482*    IF AH-COVERAGE-CANCELLED
 15483*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15484*        IF PB-COMPANY-ID = 'ACE'
 15485*           MOVE ER-2727        TO WS-ERROR
 15486*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15487*        ELSE
 15488*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15489*              MOVE ER-2727     TO WS-ERROR
 15490*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15491
 15492     IF PB-COMPANY-ID = 'ACE'
 15493       IF AH-COVERAGE-CANCELLED
 15494         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15495           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15496              MOVE ER-2732      TO WS-ERROR
 15497              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15498
 15499     IF PB-COMPANY-ID      EQUAL   'HER'
 15500        IF WS-ERROR        EQUAL   ER-2727
 15501            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15502            MOVE  ER-2725          TO  WS-ERROR
 15503            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15504
 15505     IF PB-C-CLAIM-CREATED-CANCEL
 15506            MOVE ER-2748         TO WS-ERROR
 15507            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15508
 15509     IF PB-C-LAST-NAME NOT = SPACES
 15510         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15511            MOVE ER-2747         TO WS-ERROR
 15512            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15513
 15514 3710-EDIT-LUMP-SUM-PRIOR.
 15515
 15516     IF AH-COVERAGE-CANCELLED
 15517         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15518             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15519                MOVE ER-2735    TO WS-ERROR
 15520                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15521
 15522     IF LF-COVERAGE-CANCELLED
 15523         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15524             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15525                MOVE ER-2735    TO WS-ERROR
 15526                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15527
 15528 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 282
* EL050.cbl
 15529
 15530*    IF LF-COVERAGE-CANCELLED
 15531*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15532*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15533*           (NOT PB-CI-OB)
 15534*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15535*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15536*                   MOVE ER-2732  TO WS-ERROR
 15537*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15538*
 15539*    IF AH-COVERAGE-CANCELLED
 15540*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15541*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15542*           (NOT PB-CI-OB)
 15543*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15544*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15545*                   MOVE ER-2732  TO WS-ERROR
 15546*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15547
 15548     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15549         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15550            (NOT PB-COMP-LF-CANCEL)
 15551             NEXT SENTENCE
 15552         ELSE
 15553           IF PB-C-LF-CANCEL-VOIDED
 15554              NEXT SENTENCE
 15555           ELSE
 15556              MOVE ER-2753      TO WS-ERROR
 15557              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15558
 15559     IF CANCEL-FUTURE-DT
 15560         GO TO 3999-END-EDIT.
 15561
 15562 3715-GET-REMAIN-TERM-LF.
 15563
 15564     IF NO-LF-BENEFIT-MATCH  OR
 15565        WS-LF-BENEFIT-CD = ZEROS
 15566        GO TO 3730-GET-AH-REMAIN-TERM.
 15567
 15568     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15569     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15570     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15571     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15572     MOVE PB-SV-STATE            TO CP-STATE.
 15573     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15574     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15575     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15576     MOVE '2'                    TO CP-PROCESS-TYPE.
 15577     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15578     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15579     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15580     IF (PB-COMPANY-ID = 'CID')
 15581        AND (CP-STATE-STD-ABBRV = 'WI')
 15582        MOVE '7'                 TO CP-REM-TERM-METHOD
 15583        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15584     ELSE
 15585        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15586        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 283
* EL050.cbl
 15587                                 TO CP-REM-TRM-CALC-OPTION
 15588     END-IF
 15589**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15590     IF (PB-COMPANY-ID = 'CID')
 15591        AND (CP-STATE-STD-ABBRV = 'MO')
 15592        AND (PB-CERT-EFF-DT >= X'9B41')
 15593        AND (PB-CERT-EFF-DT <= X'A2FB')
 15594        MOVE '7'                 TO CP-REM-TERM-METHOD
 15595        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15596     END-IF
 15597     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15598                                    CP-LOAN-TERM.
 15599     IF CP-TRUNCATED-LIFE
 15600        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15601
 15602     IF CP-TERM-IS-DAYS
 15603         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15604     ELSE
 15605         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15606
 15607     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15608
 15609     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15610
 15611     IF LF-COVERAGE-CANCELLED
 15612        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15613        NEXT SENTENCE
 15614      ELSE
 15615          GO TO 3730-GET-AH-REMAIN-TERM.
 15616
 15617 3720-GET-LF-REFUND.
 15618
 15619     IF PB-C-LF-CANCEL-VOIDED OR
 15620        PB-C-AH-CANCEL-VOIDED
 15621        GO TO 3780-UPDATE-CANCEL-CERT.
 15622
 15623     IF PB-COMPANY-ID EQUAL 'BOA'
 15624         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15625         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15626         GO TO 3730-GET-AH-REMAIN-TERM.
 15627
 15628     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15629        (WS-AH-SPECIAL-CALC-CD = 'M')
 15630         MOVE ER-2767            TO WS-ERROR
 15631         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15632         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15633         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15634         GO TO 3780-UPDATE-CANCEL-CERT.
 15635
 15636     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15637
 15638     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15639     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15640     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15641     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15642     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15643     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15644     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 284
* EL050.cbl
 15645        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15646        IF PDEF-MASTER-FOUND
 15647           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15648              (V1 > +8)
 15649              OR (PD-PROD-CODE (V1) = 'L')
 15650           END-PERFORM
 15651           IF V1 < +9
 15652              MOVE PD-MAX-AMT (V1)
 15653                           TO CP-R-MAX-TOT-BEN
 15654                              EC-AM-LF-MAX-TOT-BEN
 15655           END-IF
 15656        ELSE
 15657        MOVE ' '                 TO PDEF-MASTER-SW
 15658        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15659        MOVE PB-STATE            TO ERPDEF-STATE
 15660        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15661        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15662        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15663        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15664        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15665        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15666        IF PDEF-MASTER-FOUND
 15667           MOVE 'N'              TO PDEF-MASTER-SW
 15668           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15669           IF PDEF-MASTER-FOUND
 15670              IF (ERPDEF-KEY-SAVE (1:16) =
 15671                           PD-CONTROL-PRIMARY (1:16))
 15672                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15673                 CONTINUE
 15674              ELSE
 15675                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15676                 IF (ERPDEF-KEY-SAVE (1:16) =
 15677                           PD-CONTROL-PRIMARY (1:16))
 15678                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15679                    CONTINUE
 15680                 ELSE
 15681                    MOVE 'N'     TO PDEF-MASTER-SW
 15682                 END-IF
 15683              END-IF
 15684              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15685
 15686              IF PDEF-MASTER-FOUND
 15687                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15688                    (V1 > +8)
 15689                    OR (PD-PROD-CODE (V1) = 'L')
 15690                 END-PERFORM
 15691                 IF V1 < +9
 15692                    MOVE PD-MAX-AMT (V1)
 15693                                 TO CP-R-MAX-TOT-BEN
 15694                                    EC-AM-LF-MAX-TOT-BEN
 15695                 END-IF
 15696              END-IF
 15697           END-IF
 15698           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15699        END-IF
 15700        END-IF
 15701     END-IF
 15702     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 285
* EL050.cbl
 15703
 15704     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15705
 15706     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15707                                    PB-C-LF-REM-TERM.
 15708
 15709     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15710     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15711
 15712     IF PB-COMPANY-ID EQUAL 'FLC'
 15713        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15714           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15715           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15716                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15717                    - CM-LF-ITD-DEATH-AMT
 15718           IF PB-C-LF-REF-CALC LESS THAN +0
 15719              MOVE +0            TO PB-C-LF-REF-CALC
 15720              GO TO 3730-GET-AH-REMAIN-TERM
 15721           ELSE
 15722              GO TO 3730-GET-AH-REMAIN-TERM.
 15723
 15724     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15725                            OR '4' OR '5' OR '6' OR '8'
 15726                            OR '9' OR 'G'
 15727        MOVE PB-C-LF-REFUND-OVERRIDE
 15728                                 TO CP-EARNING-METHOD.
 15729
 15730     if pb-company-id = 'AHL'
 15731        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15732        if cp-class-code = spaces
 15733           move zeros            to cp-class-code
 15734        end-if
 15735     ELSE
 15736        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15737     END-IF
 15738*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15739     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15740     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15741                                    CP-RATING-BENEFIT-AMT.
 15742     IF CP-STATE-STD-ABBRV = 'OR'
 15743         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15744                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15745     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15746     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15747     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15748     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15749     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15750     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15751     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15752     IF WS-DEFAULT-APR NOT NUMERIC
 15753         MOVE ZEROS TO WS-DEFAULT-APR.
 15754****   N O T E   ****
 15755*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15756*      THE OH HARD CODING IN ELCRFNDP
 15757
 15758     IF PB-COMPANY-ID = 'CID'
 15759        IF CP-STATE-STD-ABBRV = 'OH'
 15760           MOVE WS-LF-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 286
* EL050.cbl
 15761                                 TO CP-EARNING-METHOD
 15762        END-IF
 15763     END-IF
 15764
 15765****   N O T E   ****
 15766
 15767     IF CP-EARN-AS-NET-PAY
 15768         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15769            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15770                MOVE WS-DEFAULT-APR
 15771                                 TO  CP-LOAN-APR
 15772                MOVE ER-3780     TO  WS-ERROR
 15773                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15774            ELSE
 15775                MOVE ER-3781     TO  WS-ERROR
 15776                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15777     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15778     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15779
 15780     IF CP-REFUND-TYPE-USED NOT = SPACE
 15781         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15782
 15783     IF CP-ERROR-RATE-IS-ZERO OR
 15784        CP-ERROR-RATE-NOT-FOUND
 15785        MOVE ER-2740             TO WS-ERROR
 15786        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15787
 15788     IF CP-ERROR-RATE-FILE-NOTOPEN
 15789        MOVE ER-2617             TO WS-ERROR
 15790        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15791
 15792     IF PB-COMPANY-ID = 'DCC'
 15793        AND PB-CI-ENTRY-STATUS = 'M'
 15794        MOVE +0                  TO PB-C-LF-REF-CALC
 15795     ELSE
 15796        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15797     END-IF
 15798
 15799     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15800         GO TO 3730-GET-AH-REMAIN-TERM.
 15801
 15802*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15803*       ADD +1                   TO PB-C-LF-REM-TERM
 15804*                                   CP-REMAINING-TERM
 15805*                                   CP-ORIGINAL-TERM.
 15806
 15807     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15808     MOVE '2'                    TO CP-EARNING-METHOD
 15809                                    CP-RATING-METHOD.
 15810     IF PB-COMPANY-ID = 'CID'
 15811        IF (CP-STATE-STD-ABBRV = 'MN')
 15812           AND (PB-CERT-EFF-DT > X'A4FF')
 15813           AND (WS-LF-EARNINGS-CALC = 'B')
 15814           MOVE '5'              TO CP-EARNING-METHOD
 15815           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15816        END-IF
 15817     END-IF
 15818     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 287
* EL050.cbl
 15819                                        CP-REMAINING-BENEFIT
 15820                                        CP-RATING-BENEFIT-AMT.
 15821     IF CP-STATE-STD-ABBRV = 'OR'
 15822         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15823                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15824     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15825     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15826
 15827     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15828
 15829     IF CP-ERROR-RATE-IS-ZERO OR
 15830        CP-ERROR-RATE-NOT-FOUND
 15831        MOVE ER-2740             TO WS-ERROR
 15832        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15833
 15834     IF CP-ERROR-RATE-FILE-NOTOPEN
 15835        MOVE ER-2617             TO WS-ERROR
 15836        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15837
 15838     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15839
 15840******************************************************************
 15841
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 288
* EL050.cbl
 15843 3730-GET-AH-REMAIN-TERM.
 15844     IF NO-AH-BENEFIT-MATCH  OR
 15845        WS-AH-BENEFIT-CD = ZEROS
 15846         GO TO 3770-CHECK-REFUNDS.
 15847
 15848     IF PB-CI-AH-LUMP-SUM-DISAB
 15849         IF  PB-C-AH-CANCEL-AMT = ZERO
 15850            IF NOT PB-COMP-AH-CANCEL
 15851             GO TO 3770-CHECK-REFUNDS.
 15852
 15853     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15854     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15855     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15856     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15857     MOVE PB-SV-STATE            TO CP-STATE.
 15858     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15859     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15860     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15861     MOVE '2'                    TO CP-PROCESS-TYPE.
 15862     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15863     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15864     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15865     IF (PB-COMPANY-ID = 'CID')
 15866        AND (CP-STATE-STD-ABBRV = 'WI')
 15867        MOVE '7'                 TO CP-REM-TERM-METHOD
 15868        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15869     ELSE
 15870        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15871        MOVE WS-REM-TRM-CALC-OPTION
 15872                                 TO CP-REM-TRM-CALC-OPTION
 15873     END-IF
 15874     IF (PB-COMPANY-ID = 'CID')
 15875        AND (CP-STATE-STD-ABBRV = 'MO')
 15876        AND (PB-CERT-EFF-DT >= X'9B41')
 15877        AND (PB-CERT-EFF-DT <= X'A2FB')
 15878        MOVE '7'                 TO CP-REM-TERM-METHOD
 15879        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15880     END-IF
 15881     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15882                                    CP-LOAN-TERM.
 15883     IF NOT CP-TERM-IS-DAYS
 15884         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15885
 15886     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15887
 15888     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15889
 15890     IF AH-COVERAGE-CANCELLED
 15891        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15892        NEXT SENTENCE
 15893      ELSE
 15894         GO TO 3770-CHECK-REFUNDS.
 15895
 15896 3740-GET-AH-REFUND.
 15897
 15898     IF PB-C-LF-CANCEL-VOIDED OR
 15899        PB-C-AH-CANCEL-VOIDED
 15900        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 289
* EL050.cbl
 15901
 15902     IF PB-COMPANY-ID = 'BOA'
 15903         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15904         GO TO 3770-CHECK-REFUNDS.
 15905
 15906     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15907*    MOVE ' '                    TO DC-OPTION-CODE
 15908     SET BIN-TO-GREG             TO TRUE
 15909     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15910     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15911                                    PB-C-AH-REM-TERM.
 15912     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15913     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15914
 15915     IF PB-COMPANY-ID EQUAL 'FLC'
 15916        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15917           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15918           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15919                    - CM-AH-ITD-AH-PMT)
 15920           IF PB-C-AH-REF-CALC LESS THAN +0
 15921              MOVE +0            TO PB-C-AH-REF-CALC
 15922              GO TO 3770-CHECK-REFUNDS
 15923           ELSE
 15924              GO TO 3770-CHECK-REFUNDS.
 15925
 15926     IF PB-COMPANY-ID = 'DCC'
 15927        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15928            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15929           MOVE 'S'              TO CP-EARNING-METHOD
 15930        END-IF
 15931     END-IF
 15932     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15933                            OR '4' OR '5' OR '6' OR '8'
 15934                            OR '9' OR 'G' OR 'S'
 15935        MOVE PB-C-AH-REFUND-OVERRIDE
 15936                                 TO CP-EARNING-METHOD.
 15937
 15938     if pb-company-id = 'AHL'
 15939        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 15940        if cp-class-code = spaces
 15941           move zeros            to cp-class-code
 15942        end-if
 15943     ELSE
 15944        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15945     END-IF
 15946*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15947     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15948     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15949                                    CP-RATING-BENEFIT-AMT.
 15950     IF CP-STATE-STD-ABBRV = 'OR'
 15951         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15952                                         PB-CI-AH-TERM.
 15953     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15954     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15955     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15956     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15957     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15958     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 290
* EL050.cbl
 15959
 15960     IF CP-STATE-STD-ABBRV = 'OH'
 15961        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15962                                AND 'CID' AND 'DCC' AND 'AHL')
 15963           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15964              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15965              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15966              MOVE '6' TO CP-EARNING-METHOD
 15967           END-IF
 15968        END-IF
 15969        IF PB-COMPANY-ID = 'CID'
 15970           IF NO-LIFE-COVERAGE
 15971              IF CP-CRITICAL-PERIOD
 15972                 MOVE '2'       TO CP-EARNING-METHOD
 15973              ELSE
 15974                 MOVE '6'       TO CP-EARNING-METHOD
 15975              END-IF
 15976           ELSE
 15977              IF WS-LF-COVERAGE-TYPE = 'L'
 15978                 MOVE '2'       TO CP-EARNING-METHOD
 15979              ELSE
 15980                 IF (PB-CI-LF-TERM > +60) OR
 15981                    (WS-LF-EARNINGS-CALC = '5')
 15982                    IF CP-CRITICAL-PERIOD
 15983                       MOVE '2'  TO CP-EARNING-METHOD
 15984                    ELSE
 15985                       MOVE '6'  TO CP-EARNING-METHOD
 15986                    END-IF
 15987                 ELSE
 15988                    MOVE '1'     TO CP-EARNING-METHOD
 15989                 END-IF
 15990              END-IF
 15991           END-IF
 15992        END-IF
 15993     END-IF
 15994
 15995*    IF CP-STATE-STD-ABBRV = 'VA'
 15996*       IF DC-GREG-DATE-CYMD GREATER 19921231
 15997*          IF CP-ORIGINAL-TERM GREATER 61
 15998*             MOVE '6' TO CP-EARNING-METHOD
 15999*          ELSE
 16000*             MOVE '1' TO CP-EARNING-METHOD.
 16001
 16002     IF WS-DEFAULT-APR NOT NUMERIC
 16003         MOVE ZEROS TO WS-DEFAULT-APR.
 16004     IF CP-EARN-AS-NET-PAY
 16005         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16006            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16007                MOVE WS-DEFAULT-APR
 16008                                 TO  CP-LOAN-APR
 16009                MOVE ER-3780     TO  WS-ERROR
 16010                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16011            ELSE
 16012                MOVE ER-3781     TO  WS-ERROR
 16013                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16014     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16015     IF PB-COMPANY-ID = 'DCC'
 16016        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 291
* EL050.cbl
 16017        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16018        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16019     END-IF
 16020     IF PB-COMPANY-ID = 'DCC'
 16021        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16022        AND (CP-EARNING-METHOD = 'D')
 16023        AND (CP-CANCEL-REASON NOT = 'R')
 16024        CONTINUE
 16025     ELSE
 16026        GO TO 3750-CONTINUE
 16027     END-IF
 16028     MOVE ' '                    TO DD-IU-SW
 16029     IF NOT PDEF-MASTER-FOUND
 16030        MOVE ' '                 TO PDEF-MASTER-SW
 16031        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16032        MOVE PB-STATE            TO ERPDEF-STATE
 16033        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16034        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16035        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16036        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16037        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16038        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16039        IF PDEF-MASTER-FOUND
 16040           MOVE 'N'              TO PDEF-MASTER-SW
 16041           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16042           IF PDEF-MASTER-FOUND
 16043              IF (ERPDEF-KEY-SAVE (1:16) =
 16044                           PD-CONTROL-PRIMARY (1:16))
 16045                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16046                 CONTINUE
 16047              ELSE
 16048                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16049                 IF (ERPDEF-KEY-SAVE (1:16) =
 16050                           PD-CONTROL-PRIMARY (1:16))
 16051                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16052                    CONTINUE
 16053                 ELSE
 16054                    MOVE ER-2740 TO WS-ERROR
 16055                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16056                    GO TO 3770-CHECK-REFUNDS
 16057                 END-IF
 16058              END-IF
 16059           END-IF
 16060           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16061        END-IF
 16062     END-IF
 16063     IF PDEF-MASTER-FOUND
 16064        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16065           (V1 > +8)
 16066           OR (PD-PROD-CODE (V1) = 'I')
 16067        END-PERFORM
 16068        IF V1 < +9
 16069           SET DD-IU-PRESENT        TO TRUE
 16070        END-IF
 16071        IF WS-AH-DCC-TRUNC = 'T'
 16072           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16073        ELSE
 16074           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 292
* EL050.cbl
 16075        END-IF
 16076        EVALUATE TRUE
 16077           WHEN WS-TERM > +168
 16078              MOVE 15               TO V1
 16079           WHEN WS-TERM > +156
 16080              MOVE 14               TO V1
 16081           WHEN WS-TERM > +144
 16082              MOVE 13               TO V1
 16083           WHEN WS-TERM > +132
 16084              MOVE 12               TO V1
 16085           WHEN WS-TERM > +120
 16086              MOVE 11               TO V1
 16087           WHEN WS-TERM > +108
 16088              MOVE 10               TO V1
 16089           WHEN WS-TERM > +96
 16090              MOVE 9                TO V1
 16091           WHEN WS-TERM > +84
 16092              MOVE 8                TO V1
 16093           WHEN WS-TERM > +72
 16094              MOVE 7                TO V1
 16095           WHEN WS-TERM > +60
 16096              MOVE 6                TO V1
 16097           WHEN WS-TERM > +48
 16098              MOVE 5                TO V1
 16099           WHEN WS-TERM > +36
 16100              MOVE 4                TO V1
 16101           WHEN WS-TERM > +24
 16102              MOVE 3                TO V1
 16103           WHEN WS-TERM > +12
 16104              MOVE 2                TO V1
 16105           WHEN OTHER
 16106              MOVE 1                TO V1
 16107        END-EVALUATE
 16108
 16109        EVALUATE TRUE
 16110*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16111*             < +13)
 16112*             AND (DD-IU-PRESENT)
 16113*             MOVE 2                TO V2
 16114*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16115*             MOVE 1                TO V2
 16116           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16117              MOVE 2                TO V2
 16118           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16119              MOVE 3                TO V2
 16120           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16121              MOVE 4                TO V2
 16122           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16123              MOVE 5                TO V2
 16124           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16125              MOVE 6                TO V2
 16126           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16127              MOVE 7                TO V2
 16128           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16129              MOVE 8                TO V2
 16130           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16131              MOVE 9                TO V2
 16132           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 293
* EL050.cbl
 16133              MOVE 10               TO V2
 16134           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16135              MOVE 11               TO V2
 16136           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16137              MOVE 12               TO V2
 16138           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16139              MOVE 13               TO V2
 16140           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16141              MOVE 14               TO V2
 16142           WHEN OTHER
 16143              MOVE 15               TO V2
 16144        END-EVALUATE
 16145
 16146        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16147                                 TO CP-DDF-LO-FACT
 16148        MOVE PD-UEP-FACTOR (V1 V2)
 16149                                 TO CP-DDF-HI-FACT
 16150
 16151        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16152        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16153        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16154           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16155        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16156        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16157        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16158           + PD-1ST-YR-ADMIN-ALLOW
 16159
 16160        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16161*       IF PI-CLP-YN = 'Y'
 16162*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16163*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16164*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16165*       END-IF
 16166
 16167        IF DD-IU-PRESENT
 16168           MOVE 'I'              TO CP-EARNING-METHOD
 16169        END-IF
 16170        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16171                                     CP-CLP-RATE-UP
 16172        IF CP-IU-RATE-UP NOT = ZEROS
 16173           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16174              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16175           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16176              / (1 - WS-WORK-FACT)
 16177        END-IF
 16178     END-IF
 16179     .
 16180 3750-CONTINUE.
 16181     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16182
 16183     IF CP-REFUND-TYPE-USED NOT = SPACE
 16184         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16185
 16186     IF CP-ERROR-RATE-IS-ZERO OR
 16187        CP-ERROR-RATE-NOT-FOUND
 16188        MOVE ER-2740             TO WS-ERROR
 16189        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16190
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 294
* EL050.cbl
 16191     IF CP-ERROR-RATE-FILE-NOTOPEN
 16192        MOVE ER-2617             TO WS-ERROR
 16193        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16194     IF PB-COMPANY-ID = 'DCC'
 16195        AND PB-CI-ENTRY-STATUS = 'M'
 16196        MOVE +0                  TO PB-C-AH-REF-CALC
 16197     ELSE
 16198        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16199     END-IF
 16200     IF PB-COMPANY-ID = 'DCC'
 16201        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16202        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16203        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16204        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16205        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16206        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16207        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16208        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16209        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16210     END-IF
 16211     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 295
* EL050.cbl
 16213
 16214 3770-CHECK-REFUNDS.
 16215
 16216     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16217        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16218           MOVE ER-2766          TO WS-ERROR
 16219           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16220           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16221           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16222              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16223
 16224     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16225        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16226           MOVE ER-2766          TO WS-ERROR
 16227           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16228           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16229           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16230              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16231
 16232     IF PB-COMP-LF-CANCEL
 16233        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16234        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16235           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16236              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16237
 16238     IF PB-COMP-AH-CANCEL
 16239        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16240        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16241           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16242              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16243
 16244     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16245             GIVING WS-UNSIGN-WRK1
 16246     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16247             GIVING WS-UNSIGN-WRK2.
 16248
 16249     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16250         MOVE ZERO TO WS-UNSIGN-WRK1.
 16251
 16252     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16253         MOVE ZERO TO WS-UNSIGN-WRK2.
 16254
 16255     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16256
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 296
* EL050.cbl
 16258
 16259 3772-CONTINUE.
 16260
 16261**********************************
 16262*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16263*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16264*** DOUBLES THE TOLERANCE AMOUNT.
 16265***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16266**********************************
 16267     IF PB-COMPANY-ID = 'MON'
 16268     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16269         IF WS-REF-REJECT-SW = SPACE
 16270             MOVE ER-2754        TO WS-ERROR
 16271             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16272           ELSE
 16273             MOVE ER-2736        TO WS-ERROR
 16274             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16275**********************************
 16276
 16277 3773-CONTINUE.
 16278
 16279     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16280        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16281           MOVE ER-2723          TO WS-ERROR
 16282           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16283
 16284     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16285        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16286           MOVE ER-2724          TO WS-ERROR
 16287           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16288
 16289     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16290         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16291             (1 + WS-LF-REFUND-OVS-PCT)
 16292     ELSE
 16293         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16294
 16295     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16296         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16297             (1 - WS-TOL-LF-REFUND-PCT)
 16298     ELSE
 16299         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16300
 16301     IF (PB-COMPANY-ID = 'DCC')
 16302        AND (PB-CI-ENTRY-STATUS = 'M')
 16303        AND (PB-C-LF-CANCEL-AMT > +0)
 16304        MOVE ER-3843             TO WS-ERROR
 16305        PERFORM 9900-ERROR-FORMAT
 16306                                 THRU 9900-EXIT
 16307     END-IF
 16308     EVALUATE TRUE
 16309        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16310           CONTINUE
 16311        WHEN PB-C-LF-CANCEL-AMT = +0
 16312                 AND PB-C-LF-REF-CALC > +0
 16313           CONTINUE
 16314        WHEN WS-LF-REFUND-OVS-AMT = 0
 16315                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 297
* EL050.cbl
 16316           CONTINUE
 16317        WHEN OTHER
 16318           IF WS-TOL-LF-REFUND  = +0
 16319              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16320           END-IF
 16321           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16322                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16323                          (PB-C-LF-CANCEL-AMT))
 16324              CONTINUE
 16325           ELSE
 16326              IF WS-LF-REFUND-OVS-AMT = +0
 16327                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16328              END-IF
 16329              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16330                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16331                                       PB-C-LF-CANCEL-AMT)
 16332                 CONTINUE
 16333              ELSE
 16334                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16335                   MOVE ER-2754   TO  WS-ERROR
 16336                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16337                 ELSE
 16338                    MOVE ER-2736   TO  WS-ERROR
 16339                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16340                 END-IF
 16341              END-IF
 16342           END-IF
 16343     END-EVALUATE.
 16344
 16345     EVALUATE TRUE
 16346        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16347           CONTINUE
 16348        WHEN PB-C-LF-CANCEL-AMT = +0
 16349                 AND PB-C-LF-REF-CALC > +0
 16350           CONTINUE
 16351        WHEN OTHER
 16352           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16353               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16354              CONTINUE
 16355           ELSE
 16356              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16357               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16358                CONTINUE
 16359              ELSE
 16360                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16361                     MOVE ER-2754   TO  WS-ERROR
 16362                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16363                 ELSE
 16364                     MOVE ER-2736   TO  WS-ERROR
 16365                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16366                 END-IF
 16367              END-IF
 16368           END-IF
 16369     END-EVALUATE.
 16370
 16371     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16372         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16373             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 298
* EL050.cbl
 16374     ELSE
 16375         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16376
 16377     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16378         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16379             (1 - WS-TOL-AH-REFUND-PCT)
 16380     ELSE
 16381         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16382
 16383     IF (PB-COMPANY-ID = 'DCC')
 16384        AND (PB-CI-ENTRY-STATUS = 'M')
 16385        AND (PB-C-AH-CANCEL-AMT > +0)
 16386        MOVE ER-3843             TO WS-ERROR
 16387        PERFORM 9900-ERROR-FORMAT
 16388                                 THRU 9900-EXIT
 16389     END-IF
 16390     EVALUATE TRUE
 16391        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16392           CONTINUE
 16393*       WHEN PB-C-AH-REF-CALC = +0 AND
 16394*                  PB-C-AH-CANCEL-AMT > +0
 16395        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16396                   PB-C-AH-REF-CALC > +0
 16397           CONTINUE
 16398        WHEN WS-AH-REFUND-OVS-AMT = +0
 16399                AND WS-TOL-AH-REFUND = +0
 16400           CONTINUE
 16401        WHEN OTHER
 16402           IF WS-TOL-AH-REFUND = +0
 16403              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16404           END-IF
 16405           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16406               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16407                                         PB-C-AH-CANCEL-AMT)
 16408              CONTINUE
 16409           ELSE
 16410              IF WS-AH-REFUND-OVS-AMT = +0
 16411                 MOVE +9999999.99 TO
 16412                         WS-AH-REFUND-OVS-AMT
 16413              END-IF
 16414              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16415                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16416                                         PB-C-AH-CANCEL-AMT)
 16417                 CONTINUE
 16418              ELSE
 16419                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16420                    MOVE ER-2754   TO  WS-ERROR
 16421                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16422                 ELSE
 16423                    MOVE ER-2736   TO  WS-ERROR
 16424                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16425                 END-IF
 16426              END-IF
 16427           END-IF
 16428     END-EVALUATE.
 16429
 16430     EVALUATE TRUE
 16431        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 299
* EL050.cbl
 16432           CONTINUE
 16433*       WHEN PB-C-AH-REF-CALC > +0 AND
 16434*                  PB-C-AH-CANCEL-AMT = +0
 16435        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16436                   PB-C-AH-REF-CALC = +0
 16437           CONTINUE
 16438        WHEN OTHER
 16439           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16440               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16441              CONTINUE
 16442           ELSE
 16443              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16444                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16445                 CONTINUE
 16446              ELSE
 16447                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16448                     MOVE ER-2754   TO  WS-ERROR
 16449                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16450                 ELSE
 16451                     MOVE ER-2736   TO  WS-ERROR
 16452                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16453                 END-IF
 16454              END-IF
 16455           END-IF
 16456     END-EVALUATE.
 16457
 16458     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16459        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16460        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16461           AND  PB-C-LF-REF-CALC < +1.00
 16462           AND  PB-C-AH-REF-CALC < +1.00
 16463           CONTINUE
 16464        ELSE
 16465           IF (PB-COMPANY-ID = 'DCC')
 16466              AND (PB-CI-ENTRY-STATUS = 'M')
 16467              CONTINUE
 16468           ELSE
 16469              MOVE ER-2741       TO WS-ERROR
 16470              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16471           END-IF
 16472        END-IF
 16473     END-IF
 16474
 16475     IF (PB-C-LF-CANCEL-AMT = ZERO
 16476        AND WS-LF-BENEFIT-CD NOT = ZERO
 16477        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16478        AND PB-C-LF-REF-CALC NOT = ZERO)
 16479        OR
 16480        (PB-C-LF-CANCEL-AMT = ZERO
 16481        AND WS-LF-BENEFIT-CD NOT = ZERO
 16482        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16483             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16484                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16485                NEXT SENTENCE
 16486             ELSE
 16487                MOVE ER-2739        TO WS-ERROR
 16488                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16489
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 300
* EL050.cbl
 16490     IF (PB-C-AH-CANCEL-AMT = ZERO
 16491        AND WS-AH-BENEFIT-CD NOT = ZERO
 16492        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16493        AND PB-C-AH-REF-CALC NOT = ZERO)
 16494        OR
 16495        (PB-C-AH-CANCEL-AMT = ZERO
 16496        AND WS-AH-BENEFIT-CD NOT = ZERO
 16497        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16498             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16499                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16500                NEXT SENTENCE
 16501             ELSE
 16502                MOVE ER-2738        TO WS-ERROR
 16503                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16504
 16505 3775-OVER-REF-CHK.
 16506
 16507     IF PB-CI-ENTRY-STATUS = '5'
 16508        GO TO 3780-UPDATE-CANCEL-CERT.
 16509
 16510     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16511                              PB-CI-LF-ALT-PREMIUM-AMT.
 16512
 16513     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16514        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16515                                 PB-C-LF-REF-CALC
 16516      ELSE
 16517        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16518                                 PB-C-LF-CANCEL-AMT.
 16519
 16520     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16521        MOVE ER-2755             TO WS-ERROR
 16522        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16523
 16524     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16525
 16526     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16527        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16528                                 PB-C-AH-REF-CALC
 16529      ELSE
 16530        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16531                                 PB-C-AH-CANCEL-AMT.
 16532
 16533     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16534        MOVE ER-2778             TO WS-ERROR
 16535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16536
 16537     IF PB-CI-OB-FLAG NOT = 'Z'
 16538        NEXT SENTENCE
 16539       ELSE
 16540         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16541            MOVE ER-2757           TO WS-ERROR
 16542            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16543
 16544 3780-UPDATE-CANCEL-CERT.
 16545
 16546     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16547        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 301
* EL050.cbl
 16548        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16549
 16550     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16551         MOVE ER-2729              TO WS-ERROR
 16552         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16553
 16554     IF PB-CI-LF-BENEFIT-CD = ZERO
 16555         GO TO 3780-UPDATE-CONT-1.
 16556
 16557     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16558         GO TO 3780-UPDATE-CONT-1.
 16559
 16560     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16561       AND
 16562        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16563       AND
 16564        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16565       AND
 16566        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16567            NEXT SENTENCE
 16568       ELSE
 16569        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16570          AND
 16571***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16572***       AND
 16573           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16574            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16575               MOVE ER-2730      TO WS-ERROR
 16576               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16577               GO TO 3999-END-EDIT
 16578            ELSE
 16579               GO TO 3999-END-EDIT
 16580        ELSE
 16581            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16582               MOVE ER-2765           TO WS-ERROR
 16583               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16584               GO TO 3785-CHECK-NH.
 16585*              GO TO 3999-END-EDIT.
 16586
 16587 3780-UPDATE-CONT-1.
 16588     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16589
 16590     IF PB-CI-AH-BENEFIT-CD = ZERO
 16591         GO TO 3780-UPDATE-CONT-2.
 16592
 16593     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16594         GO TO 3780-UPDATE-CONT-2.
 16595
 16596     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16597
 16598     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16599       AND
 16600        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16601       AND
 16602        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16603       AND
 16604        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16605            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 302
* EL050.cbl
 16606       ELSE
 16607        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16608          AND
 16609***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16610***       AND
 16611           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16612           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16613            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16614               MOVE ER-2773      TO WS-ERROR
 16615               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16616               GO TO 3999-END-EDIT
 16617            ELSE
 16618               GO TO 3999-END-EDIT
 16619            END-IF
 16620           ELSE
 16621             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16622                MOVE ER-2890 TO WS-ERROR
 16623                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16624                GO TO 3999-END-EDIT
 16625             ELSE
 16626                GO TO 3785-CHECK-NH
 16627             END-IF
 16628           END-IF
 16629          ELSE
 16630            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16631              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16632                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16633                   MOVE ER-2890 TO WS-ERROR
 16634                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16635                   GO TO 3999-END-EDIT
 16636                ELSE
 16637                   MOVE ER-2765 TO WS-ERROR
 16638                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16639                   GO TO 3785-CHECK-NH
 16640                END-IF
 16641              ELSE
 16642               MOVE ER-2765      TO WS-ERROR
 16643               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16644               GO TO 3785-CHECK-NH.
 16645*              GO TO 3999-END-EDIT.
 16646
 16647 3780-UPDATE-CONT-2.
 16648
 16649     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16650        AND WS-LF-BENEFIT-CD = ZERO
 16651           MOVE ER-2743           TO WS-ERROR
 16652           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16653
 16654     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16655        AND WS-AH-BENEFIT-CD = ZERO
 16656           MOVE ER-2744           TO WS-ERROR
 16657           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16658
 16659     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16660        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16661        AND
 16662        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16663         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 303
* EL050.cbl
 16664           MOVE ER-2746           TO WS-ERROR
 16665           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16666
 16667     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16668       AND
 16669        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16670             MOVE ER-2737        TO WS-ERROR
 16671             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16672
 16673     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16674       AND
 16675        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16676             MOVE ER-2737        TO WS-ERROR
 16677             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16678
 16679     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16680         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16681             OR 'CID' OR 'DCC' OR 'AHL'
 16682             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16683         ELSE
 16684             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16685                 MOVE ER-2768    TO WS-ERROR
 16686                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16687             ELSE
 16688                 MOVE ER-2756    TO WS-ERROR
 16689                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16690
 16691     IF CERT-PEND-ISSUE-RETURNED
 16692        MOVE ER-2772             TO WS-ERROR
 16693        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16694 3785-CHECK-NH.
 16695     IF PB-STATE NOT = 'NH'
 16696        GO TO 3999-END-EDIT
 16697     END-IF
 16698
 16699     MOVE ER-2796                TO WS-ERROR
 16700     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16701     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16702        OR (CM-NH-INTERFACE-SW = 'Y')
 16703        MOVE ER-2793             TO WS-ERROR
 16704        PERFORM 9900-ERROR-FORMAT
 16705                                 THRU 9900-EXIT
 16706     END-IF
 16707     MOVE +0                     TO WS-PAYMENT-AMT
 16708     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16709        GO TO 3999-END-EDIT
 16710     END-IF
 16711     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16712        GO TO 3999-END-EDIT
 16713     END-IF
 16714     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16715     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16716     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16717        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16718     END-IF
 16719     MOVE '1'                    TO DC-OPTION-CODE
 16720     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16721     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 304
* EL050.cbl
 16722        IF DC-ELAPSED-DAYS < +16
 16723           GO TO 3999-END-EDIT
 16724        END-IF
 16725     END-IF
 16726     MOVE +0                     TO DC-ELAPSED-DAYS
 16727     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16728     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16729     MOVE '1'                    TO DC-OPTION-CODE
 16730     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16731     IF NO-CONVERSION-ERROR
 16732        IF DC-ELAPSED-DAYS > +30
 16733           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16734        ELSE
 16735           GO TO 3999-END-EDIT
 16736        END-IF
 16737     ELSE
 16738        GO TO 3999-END-EDIT
 16739     END-IF
 16740     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16741        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16742           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16743     IF WS-PAYMENT-AMT < 600.00
 16744        GO TO 3999-END-EDIT
 16745     END-IF
 16746     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16747
 16748     IF (ERMAIL-FOUND = ' ')
 16749         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16750         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16751        GO TO 3999-END-EDIT
 16752     END-IF
 16753     MOVE ER-2795                TO WS-ERROR
 16754     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16755
 16756     GO TO 3999-END-EDIT.
 16757******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 305
* EL050.cbl
 16759 3990-FILES-NOT-OPEN.
 16760
 16761     MOVE ER-2617                TO WS-ERROR.
 16762     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16763     GO TO 9990-RETURN.
 16764
 16765 3999-END-EDIT.
 16766
 16767     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16768
 16769     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16770         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16771         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16772             PERFORM 9250-UNLOCK-RETURN
 16773             GO TO 9990-RETURN
 16774          ELSE
 16775             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16776             GO TO 9990-RETURN.
 16777
 16778     IF PB-CANCELLATION
 16779          GO TO 9990-RETURN.
 16780
 16781     IF CERT-WAS-NOT-FOUND
 16782        MOVE SPACES              TO CERTIFICATE-MASTER.
 16783
 16784     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16785
 16786     IF CERT-WAS-FOUND
 16787         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16788             PERFORM 9250-UNLOCK-RETURN
 16789          ELSE
 16790            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16791      ELSE
 16792         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16793
 16794     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16795        IF PB-COMPANY-ID = 'DCC' AND
 16796           (PB-CARRIER = '2' OR '4' OR '6')
 16797              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16798        END-IF
 16799     END-IF.
 16800
 16801     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 16802         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 16803     END-IF.
 16804
 16805     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16806     IF ((PB-COMPANY-ID = 'DCC')
 16807        AND (WS-NO-SECURE-PAY))
 16808                  OR
 16809        (WS-LF-SPECIAL-CALC-CD = 'O'
 16810        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16811        SET SKIP-ADDR-EDIT       TO TRUE
 16812     END-IF
 16813     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16814        AND (NOT SKIP-ADDR-EDIT)
 16815        MOVE ER-2963             TO WS-ERROR
 16816        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 306
* EL050.cbl
 16817                                 THRU 9900-EXIT
 16818        GO TO 9990-RETURN
 16819     END-IF
 16820     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 16821     IF ERPNDM-FOUND NOT = 'X'
 16822        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16823           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16824           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16825           AND (NOT SKIP-ADDR-EDIT)
 16826           MOVE ER-2694          TO WS-ERROR
 16827           PERFORM 9900-ERROR-FORMAT
 16828                                 THRU 9900-EXIT
 16829        END-IF
 16830        MOVE ' '                 TO STATE-RECORD-ERROR
 16831        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16832        MOVE PM-STATE            TO CNTL-ACCESS
 16833        MOVE '3'                 TO CNTL-REC-TYPE
 16834        MOVE +0                  TO CNTL-SEQ-NO
 16835        MOVE '0'                 TO RC-SW-2
 16836        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16837        IF (NO-STATE-RECORD)
 16838           OR (CF-RECORD-TYPE NOT = '3')
 16839           OR (PM-STATE NOT = CF-STATE-CODE)
 16840           IF (PM-STATE = SPACES)
 16841              AND (SKIP-ADDR-EDIT)
 16842              CONTINUE
 16843           ELSE
 16844              MOVE ER-2963       TO WS-ERROR
 16845              PERFORM 9900-ERROR-FORMAT
 16846                                 THRU 9900-EXIT
 16847           END-IF
 16848        END-IF
 16849        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16850           MOVE ER-2883          TO WS-ERROR
 16851           PERFORM 9900-ERROR-FORMAT
 16852                                 THRU 9900-EXIT
 16853        END-IF
 16854        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16855           MOVE ' '                 TO STATE-RECORD-ERROR
 16856           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16857           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16858           MOVE '3'                 TO CNTL-REC-TYPE
 16859           MOVE +0                  TO CNTL-SEQ-NO
 16860           MOVE '0'                 TO RC-SW-2
 16861           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16862           IF NO-STATE-RECORD
 16863              OR (CF-RECORD-TYPE NOT = '3')
 16864              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16865              MOVE ER-2964          TO WS-ERROR
 16866              PERFORM 9900-ERROR-FORMAT
 16867                                    THRU 9900-EXIT
 16868           END-IF
 16869        END-IF
 16870     ELSE
 16871        IF NOT SKIP-ADDR-EDIT
 16872           MOVE ER-2393          TO WS-ERROR
 16873           PERFORM 9900-ERROR-FORMAT
 16874                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 307
* EL050.cbl
 16875        END-IF
 16876     END-IF
 16877
 16878     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16879
 16880     IF (ERMAIL-FOUND = ' ' AND
 16881        ERPNDM-FOUND = ' ')
 16882        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16883           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16884           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16885          OR
 16886           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16887          OR
 16888           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16889           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16890           GO TO 3999-UNLOCK-ERMAIL.
 16891
 16892     IF ERPNDM-FOUND = 'X'
 16893        GO TO 3999-UNLOCK-ERMAIL.
 16894
 16895     IF PM-INSURED-LAST-NAME      = SPACES
 16896        AND PM-INSURED-FIRST-NAME = SPACES
 16897        AND PM-ADDRESS-LINE-1     = SPACES
 16898        AND PM-ADDRESS-LINE-2     = SPACES
 16899        AND PM-CITY-STATE         = SPACES
 16900        AND PM-CRED-BENE-NAME     = SPACES
 16901        AND PM-CRED-BENE-ADDR     = SPACES
 16902        AND PM-CRED-BENE-CTYST    = SPACES
 16903        GO TO 3999-UNLOCK-ERMAIL
 16904     END-IF
 16905
 16906     MOVE SPACES                 TO MAILING-DATA.
 16907
 16908     MOVE 'MA'                   TO MA-RECORD-ID.
 16909     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16910     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16911     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16912     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16913     MOVE PB-SV-STATE            TO MA-STATE.
 16914     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16915     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16916
 16917     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16918     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16919
 16920     IF ERMAIL-FOUND = ' '
 16921        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16922     ELSE
 16923        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16924        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16925        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16926
 16927     GO TO 9990-RETURN.
 16928
 16929 3999-UNLOCK-ERMAIL.
 16930     IF ERMAIL-FOUND = ' '
 16931        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16932
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 308
* EL050.cbl
 16933     GO TO 9990-RETURN.
 16934******************************************************************
 16935
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 309
* EL050.cbl
 16937 4000-UPDATE-CANCELLED-CERT.
 16938     IF CERT-WAS-NOT-FOUND
 16939        GO TO 4299-EXIT.
 16940
 16941*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16942     IF PB-C-NH-INT-ON-REFS > ZEROS
 16943        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16944     END-IF
 16945     IF PB-C-REF-INTERFACE-SW = 'Y'
 16946        MOVE PB-C-REF-INTERFACE-SW
 16947                                 TO CM-NH-INTERFACE-SW
 16948     END-IF
 16949     IF PB-C-POST-CARD-IND = 'Y'
 16950        MOVE +8                  TO SUB
 16951        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 16952        IF ERMAIL-FOUND = ' '
 16953           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 16954              (SUB > +7)
 16955              OR (MA-MAIL-STATUS (SUB) = '1')
 16956           END-PERFORM
 16957        END-IF
 16958        IF (SUB > +7)
 16959           OR (ERMAIL-FOUND = 'X')
 16960           MOVE ER-3789          TO WS-ERROR
 16961           PERFORM 9900-ERROR-FORMAT
 16962                                 THRU 9900-EXIT
 16963        END-IF
 16964     ELSE
 16965        MOVE 'N'                 TO PB-C-POST-CARD-IND
 16966     END-IF
 16967     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 16968
 16969     IF PB-CI-OB-FLAG = 'Z'
 16970        GO TO 4150-SUMMARY-CERT-CANCEL.
 16971
 16972     IF PB-C-LF-CANCEL-VOIDED
 16973         PERFORM 4200-REVERSE-LF-CANCEL.
 16974     IF PB-C-AH-CANCEL-VOIDED
 16975         PERFORM 4200-REVERSE-AH-CANCEL.
 16976
 16977 4100-APPLY-LF-CANCEL.
 16978
 16979     MOVE +0                     TO WS-SUB.
 16980
 16981 4100-CHECK-LF-ERRORS.
 16982
 16983     ADD +1                       TO WS-SUB.
 16984
 16985     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16986        IF LF-COVERAGE-CANCELLED
 16987           GO TO 4100-LF-CANCEL-CONT
 16988        ELSE
 16989           GO TO 4100-UPDATE-LF-COVERAGE.
 16990
 16991     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16992                                   ER-2729 OR
 16993                                   ER-2730 OR
 16994                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 310
* EL050.cbl
 16995                                   ER-2732 OR
 16996                                   ER-2737 OR
 16997                                   ER-2740 OR
 16998                                   ER-2743 OR
 16999                                   ER-2749 OR
 17000                                   ER-2750 OR
 17001                                   ER-2755 OR
 17002                                   ER-2757 OR
 17003                                   ER-2760 OR
 17004                                   ER-2772 OR
 17005                                   ER-2774 OR
 17006                                   ER-2776 OR
 17007                                   ER-2794
 17008        GO TO 4100-UPDATE-LF-COVERAGE.
 17009
 17010     GO TO 4100-CHECK-LF-ERRORS.
 17011
 17012 4100-UPDATE-LF-COVERAGE.
 17013
 17014     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17015     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17016     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17017        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17018     END-IF
 17019     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17020                                      TO CM-CREDIT-INTERFACE-SW-2.
 17021     IF CM-LF-CANCEL-DT = LOW-VALUE
 17022         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17023
 17024     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17025         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17026                                         CM-LF-STATUS-AT-CANCEL.
 17027
 17028     GO TO 4100-APPLY-AH-CANCEL.
 17029
 17030 4100-LF-CANCEL-CONT.
 17031     IF PB-C-LF-CANCEL-VOIDED
 17032         GO TO 4100-APPLY-AH-CANCEL.
 17033
 17034     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17035         GO TO 4100-APPLY-AH-CANCEL.
 17036
 17037     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 17038        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17039           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17040        ELSE
 17041           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17042
 17043     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17044     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17045
 17046     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17047         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17048
 17049     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17050        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17051         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17052         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 311
* EL050.cbl
 17053
 17054     IF PB-RECORD-RETURNED
 17055        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17056      ELSE
 17057        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17058
 17059 4100-APPLY-AH-CANCEL.
 17060
 17061     MOVE +0                      TO WS-SUB.
 17062
 17063 4100-CHECK-AH-ERRORS.
 17064
 17065     ADD +1                       TO WS-SUB.
 17066
 17067     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17068        IF AH-COVERAGE-CANCELLED
 17069           GO TO 4100-AH-CANCEL-CONT
 17070        ELSE
 17071           GO TO 4100-UPDATE-AH-COVERAGE.
 17072
 17073     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17074                                   ER-2729 OR
 17075                                   ER-2732 OR
 17076                                   ER-2737 OR
 17077                                   ER-2740 OR
 17078                                   ER-2744 OR
 17079                                   ER-2749 OR
 17080                                   ER-2750 OR
 17081                                   ER-2755 OR
 17082                                   ER-2757 OR
 17083                                   ER-2760 OR
 17084                                   ER-2771 OR
 17085                                   ER-2772 OR
 17086                                   ER-2773 OR
 17087                                   ER-2775 OR
 17088                                   ER-2777 OR
 17089                                   ER-2794
 17090        GO TO 4100-UPDATE-AH-COVERAGE.
 17091
 17092     GO TO 4100-CHECK-AH-ERRORS.
 17093
 17094 4100-UPDATE-AH-COVERAGE.
 17095
 17096     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17097     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17098     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17099     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17100                                      TO CM-CREDIT-INTERFACE-SW-2.
 17101     IF CM-AH-CANCEL-DT = LOW-VALUE
 17102         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17103
 17104     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17105         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17106                                         CM-AH-STATUS-AT-CANCEL.
 17107
 17108     IF LF-COVERAGE-CANCELLED
 17109         IF PB-RECORD-RETURNED
 17110              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 312
* EL050.cbl
 17111          ELSE
 17112              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17113
 17114     GO TO 4299-EXIT.
 17115
 17116 4100-AH-CANCEL-CONT.
 17117     IF PB-C-AH-CANCEL-VOIDED
 17118         GO TO 4299-EXIT.
 17119
 17120     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17121         GO TO 4299-EXIT.
 17122
 17123     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17124        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17125           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17126        ELSE
 17127           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17128
 17129     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17130     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17131
 17132     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17133         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17134
 17135     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17136         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17137         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17138
 17139     IF PB-RECORD-RETURNED
 17140        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17141      ELSE
 17142        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17143
 17144     GO TO 4299-EXIT.
 17145
 17146 4150-SUMMARY-CERT-CANCEL.
 17147     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17148
 17149     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17150        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17151                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17152     ELSE
 17153        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17154                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17155
 17156     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17157        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17158                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17159     ELSE
 17160        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17161                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17162
 17163     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17164        NEXT SENTENCE
 17165     ELSE
 17166        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17167
 17168     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 313
* EL050.cbl
 17169
 17170 4200-REVERSE-LF-CANCEL.
 17171     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17172
 17173     IF CM-LF-CANCEL-APPLIED
 17174        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17175        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17176        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17177
 17178     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17179
 17180     IF PB-RECORD-RETURNED
 17181        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17182       ELSE
 17183        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17184
 17185 4200-REVERSE-LF-EXIT.
 17186       EXIT.
 17187
 17188 4200-REVERSE-AH-CANCEL.
 17189     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17190
 17191     IF CM-AH-CANCEL-APPLIED
 17192        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17193        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17194        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17195
 17196     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17197
 17198     IF PB-RECORD-RETURNED
 17199        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17200       ELSE
 17201        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17202
 17203 4200-REVERSE-AH-EXIT.
 17204       EXIT.
 17205
 17206 4299-EXIT.
 17207       EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 314
* EL050.cbl
 17209
 17210 4500-UPDATE-NEW-CERT.
 17211     IF CERT-WAS-FOUND
 17212         NEXT SENTENCE
 17213       ELSE
 17214         GO TO 4520-BUILD-NEW-KEY.
 17215
 17216     IF  CLASIC-CREATED-CERT
 17217         GO TO 4999-EXIT.
 17218
 17219     IF  CERT-WAS-CREATED-FOR-CLAIM
 17220         GO TO 4520-BUILD-NEW-KEY.
 17221
 17222     IF CERT-ADDED-BATCH
 17223        IF CM-RECORD-ID = 'CM'
 17224            GO TO 4999-EXIT.
 17225
 17226 4520-BUILD-NEW-KEY.
 17227* BUILD CONTROL PRIMARY
 17228
 17229     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17230                                       CM-COMPANY-CD-A1
 17231                                       CM-COMPANY-CD-A2
 17232                                       CM-COMPANY-CD-A4
 17233                                       CM-COMPANY-CD-A5.
 17234
 17235     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17236     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17237     MOVE PB-SV-STATE               TO CM-STATE.
 17238     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17239     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17240     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17241     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17242
 17243     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17244
 17245     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17246     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17247     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17248     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17249
 17250     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17251        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17252
 17253     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17254         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17255         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17256         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17257         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17258     ELSE
 17259         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17260
 17261     IF PB-COMPANY-ID   EQUAL  'CRI'
 17262         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17263         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17264         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17265         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17266         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 315
* EL050.cbl
 17267
 17268     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17269        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17270         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17271
 17272     IF PB-COMPANY-ID  = 'LBL'
 17273        IF PB-I-JOINT-COVERAGE
 17274            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17275                                           PB-I-MEMBER-NO
 17276            GO TO 4550-CONT-CERT-PROCESS.
 17277
 17278     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17279        NEXT SENTENCE
 17280     ELSE
 17281        GO TO 4540-BUILD-MEMBER-NO.
 17282
 17283******************************************************************
 17284*                                                                *
 17285*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17286*    FOR 'MON'.                                                  *
 17287*                                                                *
 17288******************************************************************
 17289
 17290     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17291     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17292     MOVE +1                     TO WS-SUB1
 17293                                    WS-SUB2.
 17294
 17295 4530-EDIT-MEMB-NAME.
 17296
 17297     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17298        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17299        ADD +1                       TO WS-SUB2.
 17300
 17301     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17302        ADD +1                       TO WS-SUB1
 17303        GO TO 4530-EDIT-MEMB-NAME.
 17304
 17305     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17306     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17307     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17308*    MOVE SPACE                      TO DC-OPTION-CODE.
 17309     SET  BIN-TO-GREG                TO TRUE.
 17310     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17311     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17312
 17313     GO TO 4550-CONT-CERT-PROCESS.
 17314
 17315******************************************************************
 17316*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17317******************************************************************
 17318
 17319 4540-BUILD-MEMBER-NO.
 17320
 17321     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17322         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17323         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17324         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 316
* EL050.cbl
 17325         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17326     ELSE
 17327         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17328
 17329     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17330        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17331         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17332
 17333 4550-CONT-CERT-PROCESS.
 17334
 17335*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17336*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17337*    ELSE
 17338*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17339
 17340     IF CERT-WAS-CREATED-FOR-CLAIM
 17341        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17342        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17343
 17344     IF CERT-AND-CLAIM-ONLINE
 17345        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17346        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17347
 17348     MOVE 'CM'                     TO CM-RECORD-ID.
 17349     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17350
 17351     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17352        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17353        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17354     ELSE
 17355        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17356        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17357
 17358     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17359     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17360     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17361     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17362     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17363     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17364     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17365                                      CM-LF-ITD-CANCEL-AMT
 17366                                      CM-LF-ITD-DEATH-AMT
 17367                                      CM-AH-ITD-AH-PMT
 17368                                      CM-AH-ITD-LUMP-PMT
 17369                                      CM-AH-ITD-CANCEL-AMT
 17370                                      CM-LF-NSP-PREMIUM-AMT
 17371                                      CM-AH-NSP-PREMIUM-AMT.
 17372*                                     CM-CLAIM-DEDUCT-WITHHELD
 17373*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17374     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17375     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17376     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17377     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17378     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17379     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17380     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17381     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17382     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 317
* EL050.cbl
 17383     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17384     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17385     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17386
 17387     IF PB-I-LIVES NOT NUMERIC
 17388         MOVE ZERO                 TO PB-I-LIVES.
 17389
 17390     IF PB-I-NUM-BILLED NOT NUMERIC
 17391         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17392
 17393     MOVE PB-I-LIVES               TO CM-LIVES.
 17394     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17395
 17396     IF PB-COMPANY-ID EQUAL  'DMD'
 17397         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17398         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17399
 17400     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17401     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17402     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17403     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17404     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17405     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17406
 17407     IF PB-I-LF-POLICY-FEE NUMERIC
 17408        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17409     ELSE
 17410        MOVE +0                    TO CM-LF-POLICY-FEE.
 17411
 17412     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17413        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17414        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17415     ELSE
 17416        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17417
 17418     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17419     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17420     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17421     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17422     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17423     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17424     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17425     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17426     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17427
 17428     IF PB-I-AH-POLICY-FEE NUMERIC
 17429        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17430     ELSE
 17431        MOVE +0                    TO CM-AH-POLICY-FEE.
 17432
 17433     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17434        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17435     ELSE
 17436        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17437
 17438     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17439     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17440
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 318
* EL050.cbl
 17441     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17442                                      CM-LF-DEATH-EXIT-DT
 17443                                      CM-AH-SETTLEMENT-EXIT-DT.
 17444
 17445*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17446*                       'TIH' OR 'OFL' OR 'FLA' OR
 17447*                       'TII' OR 'TMS' OR 'CRI' OR
 17448*                       'NCL'
 17449     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17450
 17451     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17452         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17453            MOVE '2'                TO CM-PREMIUM-TYPE.
 17454
 17455     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17456         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17457            MOVE '2'                TO CM-PREMIUM-TYPE.
 17458
 17459     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17460         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17461     ELSE
 17462         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17463         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17464
 17465     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17466     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17467     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17468     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17469     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17470     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17471     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17472     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17473
 17474     IF PB-NO-MONTHS-SKIPPED
 17475         MOVE SPACE                 TO CM-SKIP-CODE
 17476     ELSE
 17477         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17478
 17479     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17480     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17481                                       CM-LF-STATUS-AT-CANCEL.
 17482
 17483     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17484     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17485                                       CM-AH-STATUS-AT-CANCEL.
 17486
 17487     MOVE '1'                       TO CM-ENTRY-STATUS.
 17488
 17489     IF PB-REISSUED-CERT
 17490        MOVE '5'                    TO CM-ENTRY-STATUS.
 17491
 17492     IF PB-MONTHLY-CERT
 17493        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17494
 17495     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17496     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17497     IF PB-POLICY-IS-DECLINED
 17498        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 319
* EL050.cbl
 17499
 17500     IF PB-POLICY-IS-VOIDED
 17501        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17502
 17503     IF PB-NEEDS-UNDERWRITING
 17504        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17505
 17506     IF PB-REIN-ONLY-CERT
 17507        MOVE '9'                    TO CM-ENTRY-STATUS.
 17508
 17509     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17510         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17511     ELSE
 17512         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17513
 17514     IF PB-RECORD-RETURNED
 17515        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17516      ELSE
 17517        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17518
 17519     IF PB-I-MAIL-ADDRS-PRESENT
 17520        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17521
 17522     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17523                                       CM-ENTRY-DT.
 17524
 17525 4999-EXIT.
 17526     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 320
* EL050.cbl
 17528
 17529 5000-PROCESS-REPS.
 17530     MOVE ' '                    TO AGTC-MASTER-SW
 17531     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17532     MOVE CO-TYPE                TO AGTC-TYPE
 17533     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17534     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17535     IF (AGTC-MASTER-SW NOT = 'N')
 17536        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17537        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17538        PERFORM 8583-READ-ERAGTC-NEXT
 17539                                 THRU 8583-EXIT
 17540     END-IF
 17541     IF AGTC-MASTER-SW = 'N'
 17542        CONTINUE
 17543     ELSE
 17544        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17545           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17546              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17547              MOVE 'Y'           TO AGTC-MASTER-SW
 17548           END-IF
 17549        END-IF
 17550     END-IF
 17551     .
 17552 5000-EXIT.
 17553     EXIT.
 17554 6370-EDIT-INPUT-LF-CODE.
 17555     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17556        MOVE +1                  TO SUB
 17557        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17558        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17559        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17560        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17561        GO TO 6370-SEARCH-LOOP.
 17562
 17563     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17564
 17565     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17566     MOVE SPACES                 TO CNTL-ACCESS.
 17567*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17568     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17569     MOVE +0                     TO CNTL-SEQ-NO.
 17570     MOVE '4' TO RC-SW-2.
 17571     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17572
 17573     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17574        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17575        GO TO 6370-NO-LF-FOUND.
 17576
 17577     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17578     MOVE +1                     TO SUB.
 17579
 17580 6370-SEARCH-LOOP.
 17581     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17582         GO TO 6370-NO-LF-FOUND.
 17583
 17584     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17585         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 321
* EL050.cbl
 17586         GO TO 6370-HER-NET-PAY-CHECK.
 17587
 17588     ADD 1   TO SUB.
 17589*    IF SUB GREATER 120
 17590     IF SUB GREATER 200
 17591         GO TO 6370-NO-LF-FOUND.
 17592
 17593     GO TO 6370-SEARCH-LOOP.
 17594
 17595 6370-NO-LF-FOUND.
 17596
 17597     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17598
 17599 6370-HER-NET-PAY-CHECK.
 17600
 17601     IF PB-COMPANY-ID = 'CID'
 17602        IF PB-SV-STATE = 'CA' OR 'MN'
 17603           IF PB-I-LF-BENEFIT-CD = '02'
 17604              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17605           ELSE
 17606              IF PB-I-LF-BENEFIT-CD = '04'
 17607                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17608              END-IF
 17609           END-IF
 17610        END-IF
 17611     END-IF
 17612
 17613     IF PB-COMPANY-ID NOT = 'HER'
 17614         GO TO 6370-EXIT.
 17615
 17616     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17617         GO TO 6370-EXIT.
 17618
 17619     IF PB-I-LF-TERM NOT NUMERIC
 17620         MOVE ZEROS              TO PB-I-LF-TERM.
 17621
 17622     IF PB-I-LOAN-TERM NOT NUMERIC
 17623         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17624
 17625     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17626         GO TO 6370-EXIT.
 17627
 17628     IF PB-I-LF-BENEFIT-CD = '33'
 17629         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17630
 17631     IF PB-I-LF-BENEFIT-CD = '34'
 17632         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17633
 17634 6370-EXIT.
 17635     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 322
* EL050.cbl
 17637
 17638 6380-EDIT-INPUT-AH-CODE.
 17639     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17640        MOVE +1                  TO SUB
 17641        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17642        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17643        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17644        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17645        GO TO 6380-SEARCH-LOOP.
 17646
 17647     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17648
 17649     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17650     MOVE SPACES                 TO CNTL-ACCESS.
 17651     MOVE 'A'                    TO CNTL-REC-TYPE.
 17652*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17653     MOVE +0                     TO CNTL-SEQ-NO.
 17654     MOVE '5' TO RC-SW-2.
 17655     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17656
 17657     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17658        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17659        GO TO 6380-NO-AH-FOUND.
 17660
 17661     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17662     MOVE +1 TO SUB.
 17663
 17664 6380-SEARCH-LOOP.
 17665     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17666         GO TO 6380-NO-AH-FOUND.
 17667
 17668     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17669         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17670         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17671
 17672     ADD 1   TO SUB.
 17673     IF SUB GREATER THAN 96
 17674*    IF SUB GREATER THAN 300
 17675         GO TO 6380-NO-AH-FOUND.
 17676
 17677     GO TO 6380-SEARCH-LOOP.
 17678
 17679 6380-NO-AH-FOUND.
 17680
 17681     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17682
 17683     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17684         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17685     ELSE
 17686         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17687
 17688 6380-CSO-AH-ONLY-CHECKS.
 17689
 17690     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17691        NEXT SENTENCE
 17692      ELSE
 17693        GO TO 6380-EXIT.
 17694
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 323
* EL050.cbl
 17695     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17696         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17697
 17698
 17699     GO TO 6380-EXIT
 17700     .
 17701 6380-CSO-LIFE-WITH-AH-CHECKS.
 17702
 17703
 17704     .
 17705 6380-EXIT.
 17706     EXIT.
 17707
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 324
* EL050.cbl
 17709
 17710 6400-COMPUTE-EXTENSION-DAYS.
 17711
 17712******************************************************************
 17713*                                                                *
 17714*                   COMPUTE EXTENSION DAYS                       *
 17715*                                                                *
 17716*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17717*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17718*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17719*    THE EXTENSION DAYS.                                         *
 17720*                                                                *
 17721******************************************************************
 17722
 17723     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17724     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17725
 17726******************************************************************
 17727*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17728*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17729******************************************************************
 17730
 17731     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17732        COMPUTE WS-ODD-DAYS-OVER =
 17733               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17734     ELSE
 17735        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17736
 17737     IF WS-ODD-DAYS-OVER = ZEROS
 17738           GO TO 6499-EXIT
 17739     ELSE
 17740        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17741           IF WS-WDF-MONTH = 02
 17742              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17743              ADD 2       TO  WS-ODD-DAYS-OVER
 17744              GO TO 6499-EXIT
 17745           ELSE
 17746              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17747                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17748                 GO TO 6499-EXIT
 17749               ELSE
 17750                 GO TO 6499-EXIT
 17751        ELSE
 17752           GO TO 6499-EXIT.
 17753
 17754 6412-CHECK-TO-DAY.
 17755
 17756        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17757           IF WS-WDT-DAY = 28
 17758              ADD 2              TO WS-ODD-DAYS-OVER
 17759           ELSE
 17760              IF WS-WDT-DAY = 29
 17761                 ADD 1           TO WS-ODD-DAYS-OVER
 17762              ELSE
 17763                 NEXT SENTENCE
 17764        ELSE
 17765           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17766              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 325
* EL050.cbl
 17767
 17768     GO TO 6499-EXIT.
 17769
 17770
 17771 6415-CHECK-LEAP-YEAR.
 17772
 17773     IF DC-DAYS-IN-MONTH = 29
 17774        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17775
 17776 6415-EXIT.
 17777     EXIT.
 17778
 17779 6499-EXIT.
 17780      EXIT.
 17781
 17782 6500-END.
 17783     EXIT.
 17784
 17785
 17786******************************************************************
 17787************* PROCEDURE DIVISION FOR EL050 ***********************
 17788********************** ELC50PD END *******************************
 17789
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 326
* EL050.cbl
 17791
 17792**START***********************************************************
 17793*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17794*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17795******************************************************************
 17796*
 17797 6600-GET-STATE-MUNICIPAL-TAX.
 17798
 17799     IF PB-COMPANY-ID NOT = 'DMD'
 17800         GO TO 6640-EXIT.
 17801
 17802     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17803     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17804     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17805*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17806*
 17807***  Y2K PROJ 7744
 17808     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17809     SET BIN-TO-GREG          TO TRUE.
 17810     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17811
 17812     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17813
 17814     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17815     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17816
 17817
 17818* EXEC CICS HANDLE CONDITION
 17819*        INVREQ    (6610-START-BROWSE)
 17820*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17821*        NOTFND    (6630-END-OF-FILE)
 17822*    END-EXEC.
 17823*    MOVE '"$8JI                 ! # #00017805' TO DFHEIV0
 17824     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17825     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17826     MOVE X'2320233030303137383035' TO DFHEIV0(25:11)
 17827     CALL 'kxdfhei1' USING DFHEIV0
 17828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17829
 17830
 17831 6610-START-BROWSE.
 17832
 17833
 17834* EXEC CICS HANDLE CONDITION
 17835*        NOTFND    (6630-END-OF-FILE)
 17836*        DISABLED  (6630-ERRESS-PROBLEM)
 17837*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17838*        ENDFILE   (6630-END-OF-FILE)
 17839*    END-EXEC.
 17840*    MOVE '"$IcJ''                ! $ #00017813' TO DFHEIV0
 17841     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17842     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17843     MOVE X'2420233030303137383133' TO DFHEIV0(25:11)
 17844     CALL 'kxdfhei1' USING DFHEIV0
 17845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17846
 17847
 17848
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 327
* EL050.cbl
 17849* EXEC CICS STARTBR
 17850*        DATASET (FILE-ID-ERRESS)
 17851*        RIDFLD  (WS-ERRESS-KEY)
 17852*        GTEQ
 17853*    END-EXEC.
 17854     MOVE 0
 17855       TO DFHEIV11
 17856*    MOVE '&,         G          &   #00017820' TO DFHEIV0
 17857     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17858     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17859     MOVE X'2020233030303137383230' TO DFHEIV0(25:11)
 17860     CALL 'kxdfhei1' USING DFHEIV0,
 17861           FILE-ID-ERRESS,
 17862           WS-ERRESS-KEY,
 17863           DFHEIV99,
 17864           DFHEIV11,
 17865           DFHEIV99
 17866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17867
 17868
 17869 6620-READ-NEXT-ERRESS-MASTER.
 17870
 17871
 17872* EXEC CICS HANDLE CONDITION
 17873*        NOTFND    (6630-END-OF-FILE)
 17874*        ENDFILE   (6630-END-OF-FILE)
 17875*        DISABLED  (6630-ERRESS-PROBLEM)
 17876*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17877*    END-EXEC.
 17878*    MOVE '"$I''cJ                ! % #00017828' TO DFHEIV0
 17879     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17881     MOVE X'2520233030303137383238' TO DFHEIV0(25:11)
 17882     CALL 'kxdfhei1' USING DFHEIV0
 17883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17884
 17885
 17886
 17887* EXEC CICS READNEXT
 17888*        DATASET (FILE-ID-ERRESS)
 17889*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17890*        RIDFLD  (WS-ERRESS-KEY)
 17891*    END-EXEC.
 17892     MOVE LENGTH OF
 17893      RESIDENT-STATE-TAX-MASTER
 17894       TO DFHEIV12
 17895     MOVE 0
 17896       TO DFHEIV11
 17897*    MOVE '&.IL                  )   #00017835' TO DFHEIV0
 17898     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17899     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17900     MOVE X'2020233030303137383335' TO DFHEIV0(25:11)
 17901     CALL 'kxdfhei1' USING DFHEIV0,
 17902           FILE-ID-ERRESS,
 17903           RESIDENT-STATE-TAX-MASTER,
 17904           DFHEIV12,
 17905           WS-ERRESS-KEY,
 17906           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 328
* EL050.cbl
 17907           DFHEIV11,
 17908           DFHEIV99,
 17909           DFHEIV99
 17910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17911
 17912
 17913     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17914
 17915* EXEC CICS ENDBR
 17916*            DATASET (FILE-ID-ERRESS)
 17917*       END-EXEC
 17918     MOVE 0
 17919       TO DFHEIV11
 17920*    MOVE '&2                    $   #00017842' TO DFHEIV0
 17921     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17922     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17923     MOVE X'2020233030303137383432' TO DFHEIV0(25:11)
 17924     CALL 'kxdfhei1' USING DFHEIV0,
 17925           FILE-ID-ERRESS,
 17926           DFHEIV11,
 17927           DFHEIV99
 17928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17929        GO TO 6630-END-OF-FILE.
 17930
 17931     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17932        NEXT SENTENCE
 17933      ELSE
 17934        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17935
 17936*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17937*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17938*
 17939     MOVE +2                     TO WS-SUB1.
 17940
 17941     IF PB-ISSUE
 17942     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17943        MOVE +1                  TO WS-SUB1.
 17944
 17945     IF PB-CANCELLATION
 17946     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 17947        MOVE +1                  TO WS-SUB1.
 17948*
 17949*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 17950*
 17951***  Y2K PROJ 7744
 17952     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 17953***  Y2K PROJ 7744
 17954
 17955*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 17956* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 17957* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 17958
 17959     ADD 1                    TO WS-YEAR-YY.
 17960
 17961     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 17962         MOVE RES-REN-STATE-TAX (WS-SUB1)
 17963                              TO WS-RES-STATE-TAX
 17964         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 329
* EL050.cbl
 17965                              TO WS-RES-MUNI-TAX
 17966     ELSE
 17967         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 17968                              TO WS-RES-STATE-TAX
 17969         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 17970                              TO WS-RES-MUNI-TAX.
 17971
 17972*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 17973
 17974     IF PB-CANCELLATION
 17975         GO TO 6640-CANCEL-TAX.
 17976
 17977     IF PB-I-LF-PREMIUM-AMT > ZEROS
 17978         COMPUTE PB-I-STATE-TAX ROUNDED =
 17979                                   PB-I-LF-PREMIUM-AMT
 17980                                 * WS-RES-STATE-TAX
 17981         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17982                                   PB-I-LF-PREMIUM-AMT
 17983                                 * WS-RES-MUNI-TAX
 17984     ELSE
 17985     IF PB-I-AH-PREMIUM-AMT > ZEROS
 17986         COMPUTE PB-I-STATE-TAX ROUNDED =
 17987                                   PB-I-AH-PREMIUM-AMT
 17988                                 * WS-RES-STATE-TAX
 17989         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17990                                   PB-I-AH-PREMIUM-AMT
 17991                                 * WS-RES-MUNI-TAX.
 17992
 17993
 17994* EXEC CICS ENDBR
 17995*         DATASET (FILE-ID-ERRESS)
 17996*    END-EXEC.
 17997     MOVE 0
 17998       TO DFHEIV11
 17999*    MOVE '&2                    $   #00017909' TO DFHEIV0
 18000     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18001     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18002     MOVE X'2020233030303137393039' TO DFHEIV0(25:11)
 18003     CALL 'kxdfhei1' USING DFHEIV0,
 18004           FILE-ID-ERRESS,
 18005           DFHEIV11,
 18006           DFHEIV99
 18007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18008
 18009
 18010     GO TO 6640-EXIT.
 18011
 18012 6640-CANCEL-TAX.
 18013     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18014
 18015     IF PB-C-LF-CANCEL-AMT > ZEROS
 18016         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18017                                   PB-C-LF-CANCEL-AMT
 18018                                 * WS-RES-STATE-TAX
 18019         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18020                                   PB-C-LF-CANCEL-AMT
 18021                                *  WS-RES-MUNI-TAX
 18022     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 330
* EL050.cbl
 18023     IF PB-C-AH-CANCEL-AMT > ZEROS
 18024         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18025                                   PB-C-AH-CANCEL-AMT
 18026                                 * WS-RES-STATE-TAX
 18027         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18028                                   PB-C-AH-CANCEL-AMT
 18029                                *  WS-RES-MUNI-TAX.
 18030
 18031
 18032* EXEC CICS ENDBR
 18033*         DATASET (FILE-ID-ERRESS)
 18034*    END-EXEC.
 18035     MOVE 0
 18036       TO DFHEIV11
 18037*    MOVE '&2                    $   #00017934' TO DFHEIV0
 18038     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18039     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18040     MOVE X'2020233030303137393334' TO DFHEIV0(25:11)
 18041     CALL 'kxdfhei1' USING DFHEIV0,
 18042           FILE-ID-ERRESS,
 18043           DFHEIV11,
 18044           DFHEIV99
 18045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18046
 18047
 18048     GO TO 6640-EXIT.
 18049
 18050 6630-END-OF-FILE.
 18051     MOVE ER-8002              TO WS-ERROR.
 18052     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18053
 18054     GO TO 6640-EXIT.
 18055
 18056 6630-ERRESS-PROBLEM.
 18057     MOVE ER-8044              TO WS-ERROR.
 18058     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18059
 18060 6640-EXIT.
 18061     EXIT.
 18062
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 331
* EL050.cbl
 18064 6650-GET-RES-STATE-COMM.
 18065
 18066     IF PB-COMPANY-ID NOT = 'DMD'
 18067         GO TO 6700-COMM-EXIT.
 18068
 18069     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18070     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18071     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18072     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18073     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18074     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18075     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18076
 18077*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18078*
 18079***  Y2K PROJ 7744
 18080     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18081     SET BIN-TO-GREG          TO TRUE.
 18082     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18083
 18084     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18085***  Y2K PROJ 7744
 18086
 18087     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18088
 18089
 18090* EXEC CICS HANDLE CONDITION
 18091*        INVREQ    (6660-START-BROWSE)
 18092*        DISABLED  (6690-ERRESC-PROBLEM)
 18093*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18094*        NOTFND    (6690-END-OF-FILE)
 18095*    END-EXEC.
 18096*    MOVE '"$8cJI                ! & #00017979' TO DFHEIV0
 18097     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18098     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18099     MOVE X'2620233030303137393739' TO DFHEIV0(25:11)
 18100     CALL 'kxdfhei1' USING DFHEIV0
 18101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18102
 18103
 18104
 18105* EXEC CICS RESETBR
 18106*        DATASET (FILE-ID-ERRESC)
 18107*        RIDFLD  (WS-ERRESC-KEY)
 18108*    END-EXEC.
 18109     MOVE 0
 18110       TO DFHEIV11
 18111*    MOVE '&4         G          &   #00017986' TO DFHEIV0
 18112     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18113     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18114     MOVE X'2020233030303137393836' TO DFHEIV0(25:11)
 18115     CALL 'kxdfhei1' USING DFHEIV0,
 18116           FILE-ID-ERRESC,
 18117           WS-ERRESC-KEY,
 18118           DFHEIV99,
 18119           DFHEIV11,
 18120           DFHEIV99
 18121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 332
* EL050.cbl
 18122
 18123
 18124 6660-START-BROWSE.
 18125
 18126
 18127* EXEC CICS HANDLE CONDITION
 18128*        NOTFND    (6690-END-OF-FILE)
 18129*        DISABLED  (6690-ERRESC-PROBLEM)
 18130*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18131*        ENDFILE   (6690-END-OF-FILE)
 18132*    END-EXEC.
 18133*    MOVE '"$IcJ''                ! '' #00017993' TO DFHEIV0
 18134     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18135     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18136     MOVE X'2720233030303137393933' TO DFHEIV0(25:11)
 18137     CALL 'kxdfhei1' USING DFHEIV0
 18138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18139
 18140
 18141
 18142* EXEC CICS STARTBR
 18143*        DATASET (FILE-ID-ERRESC)
 18144*        RIDFLD  (WS-ERRESC-KEY)
 18145*        GTEQ
 18146*    END-EXEC.
 18147     MOVE 0
 18148       TO DFHEIV11
 18149*    MOVE '&,         G          &   #00018000' TO DFHEIV0
 18150     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18151     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18152     MOVE X'2020233030303138303030' TO DFHEIV0(25:11)
 18153     CALL 'kxdfhei1' USING DFHEIV0,
 18154           FILE-ID-ERRESC,
 18155           WS-ERRESC-KEY,
 18156           DFHEIV99,
 18157           DFHEIV11,
 18158           DFHEIV99
 18159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18160
 18161
 18162     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18163
 18164 6670-READ-NEXT-ERRESC-MASTER.
 18165
 18166
 18167* EXEC CICS HANDLE CONDITION
 18168*        NOTFND    (6690-END-OF-FILE)
 18169*        DISABLED  (6690-ERRESC-PROBLEM)
 18170*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18171*        ENDFILE   (6690-END-OF-FILE)
 18172*    END-EXEC.
 18173*    MOVE '"$IcJ''                ! ( #00018010' TO DFHEIV0
 18174     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18175     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18176     MOVE X'2820233030303138303130' TO DFHEIV0(25:11)
 18177     CALL 'kxdfhei1' USING DFHEIV0
 18178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18179
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 333
* EL050.cbl
 18180
 18181
 18182* EXEC CICS READNEXT
 18183*        DATASET (FILE-ID-ERRESC)
 18184*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18185*        RIDFLD  (ERRESC-RECORD-KEY)
 18186*    END-EXEC.
 18187     MOVE LENGTH OF
 18188      ACCOUNT-RESIDENT-ST-COMMISSION
 18189       TO DFHEIV12
 18190     MOVE 0
 18191       TO DFHEIV11
 18192*    MOVE '&.IL                  )   #00018017' TO DFHEIV0
 18193     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18194     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18195     MOVE X'2020233030303138303137' TO DFHEIV0(25:11)
 18196     CALL 'kxdfhei1' USING DFHEIV0,
 18197           FILE-ID-ERRESC,
 18198           ACCOUNT-RESIDENT-ST-COMMISSION,
 18199           DFHEIV12,
 18200           ERRESC-RECORD-KEY,
 18201           DFHEIV99,
 18202           DFHEIV11,
 18203           DFHEIV99,
 18204           DFHEIV99
 18205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18206
 18207
 18208     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18209        NEXT SENTENCE
 18210     ELSE
 18211
 18212* EXEC CICS ENDBR
 18213*            DATASET (FILE-ID-ERRESC)
 18214*       END-EXEC
 18215     MOVE 0
 18216       TO DFHEIV11
 18217*    MOVE '&2                    $   #00018026' TO DFHEIV0
 18218     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18219     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18220     MOVE X'2020233030303138303236' TO DFHEIV0(25:11)
 18221     CALL 'kxdfhei1' USING DFHEIV0,
 18222           FILE-ID-ERRESC,
 18223           DFHEIV11,
 18224           DFHEIV99
 18225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18226        GO TO 6690-END-OF-FILE.
 18227
 18228     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18229
 18230* EXEC CICS ENDBR
 18231*            DATASET (FILE-ID-ERRESC)
 18232*       END-EXEC
 18233     MOVE 0
 18234       TO DFHEIV11
 18235*    MOVE '&2                    $   #00018032' TO DFHEIV0
 18236     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18237     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 334
* EL050.cbl
 18238     MOVE X'2020233030303138303332' TO DFHEIV0(25:11)
 18239     CALL 'kxdfhei1' USING DFHEIV0,
 18240           FILE-ID-ERRESC,
 18241           DFHEIV11,
 18242           DFHEIV99
 18243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18244        GO TO 6690-END-OF-FILE.
 18245
 18246     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18247        NEXT SENTENCE
 18248      ELSE
 18249        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18250
 18251* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18252*
 18253     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18254
 18255     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18256
 18257     IF WS-SUB1 > ZERO
 18258         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18259             PERFORM 6680-SET-COMMISSION
 18260         ELSE
 18261             PERFORM 6680-SET-TABLE-CODE.
 18262
 18263
 18264* EXEC CICS ENDBR
 18265*         DATASET (FILE-ID-ERRESC)
 18266*    END-EXEC.
 18267     MOVE 0
 18268       TO DFHEIV11
 18269*    MOVE '&2                    $   #00018054' TO DFHEIV0
 18270     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18271     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18272     MOVE X'2020233030303138303534' TO DFHEIV0(25:11)
 18273     CALL 'kxdfhei1' USING DFHEIV0,
 18274           FILE-ID-ERRESC,
 18275           DFHEIV11,
 18276           DFHEIV99
 18277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18278
 18279
 18280     GO TO 6700-COMM-EXIT.
 18281
 18282 6680-SET-TABLE-CODE.
 18283     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18284        MOVE ZEROS             TO WS-SUB1
 18285     ELSE
 18286* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18287* TO COMPUTE AH COMMISSION.
 18288        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18289        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18290        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18291        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18292        PERFORM 6680-READ-CTBL-TABLE
 18293        IF WS-CTBL-READ-SW NOT = 'Y'
 18294           MOVE ZEROS          TO WS-SUB1.
 18295
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 335
* EL050.cbl
 18296 6680-READ-CTBL-TABLE.
 18297*
 18298* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18299* TO COMPUTE LIFE COMMISSION
 18300
 18301     IF CTBL-SW = '0540'
 18302        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18303        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18304        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18305
 18306     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18307
 18308     IF CTBL-TABLE-FOUND
 18309        IF CTBL-SW = '0530'
 18310             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18311                                    * PB-I-AH-TERM
 18312             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18313             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18314        ELSE
 18315             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18316             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18317             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18318     ELSE
 18319        IF FIRST-TIME-THROUGH
 18320            GO TO 6680-READ-CTBL-TABLE
 18321        ELSE
 18322            MOVE ZEROS         TO WS-SUB1.
 18323
 18324 6680-SET-COMMISSION.
 18325     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18326           MOVE ZEROS          TO WS-SUB1
 18327       ELSE
 18328           MOVE RESC-COMMISSION-PER (WS-SUB)
 18329                               TO WS-COMMISSION
 18330           IF CTBL-SW = '0530'
 18331               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18332           ELSE
 18333               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18334
 18335 6680-SEARCH-CATEGORY.
 18336     ADD +1                   TO WS-SUB.
 18337     IF WS-SUB > +12
 18338         GO TO 6680-EXIT.
 18339
 18340     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18341          MOVE WS-SUB         TO WS-SUB1
 18342          GO TO 6680-EXIT.
 18343
 18344     GO TO 6680-SEARCH-CATEGORY.
 18345
 18346 6680-EXIT.
 18347     EXIT.
 18348
 18349 6690-END-OF-FILE.
 18350     GO TO 6700-COMM-EXIT.
 18351
 18352 6690-ERRESC-PROBLEM.
 18353      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 336
* EL050.cbl
 18354      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18355
 18356      GO TO 6700-COMM-EXIT.
 18357
 18358 6700-COMM-EXIT.
 18359     EXIT.
 18360
 18361 7000-GET-RATE.
 18362
 18363* EXEC CICS LINK
 18364*        PROGRAM    ('ELRATE')
 18365*        COMMAREA   (CALCULATION-PASS-AREA)
 18366*        LENGTH     (CP-COMM-LENGTH)
 18367*    END-EXEC.
 18368     MOVE 'ELRATE' TO DFHEIV1
 18369*    MOVE '."C                   (   #00018140' TO DFHEIV0
 18370     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18371     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18372     MOVE X'2020233030303138313430' TO DFHEIV0(25:11)
 18373     CALL 'kxdfhei1' USING DFHEIV0,
 18374           DFHEIV1,
 18375           CALCULATION-PASS-AREA,
 18376           CP-COMM-LENGTH,
 18377           DFHEIV99,
 18378           DFHEIV99,
 18379           DFHEIV99,
 18380           DFHEIV99
 18381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18382
 18383
 18384 7000-EXIT.
 18385     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 337
* EL050.cbl
 18387 7100-FIND-BENEFIT-IN-STATE.
 18388     MOVE 'N'                    TO BEN-SEARCH-SW.
 18389
 18390     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18391         VARYING SUB3 FROM 1 BY 1 UNTIL
 18392            ((SUB3 GREATER 50) OR
 18393              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18394               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18395
 18396     IF SUB3 NOT = 51
 18397         MOVE 'Y'                TO BEN-SEARCH-SW.
 18398
 18399     GO TO 7199-EXIT.
 18400
 18401 7100-BENEFIT-DUMMY.
 18402
 18403 7100-DUMMY-EXIT.
 18404     EXIT.
 18405
 18406 7199-EXIT.
 18407     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 338
* EL050.cbl
 18409 7200-FIND-BENEFIT.
 18410     MOVE 'N'                    TO BEN-SEARCH-SW.
 18411
 18412     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18413         VARYING SUB3 FROM 1 BY 1 UNTIL
 18414            ((SUB3 GREATER 8) OR
 18415            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18416
 18417     IF SUB3 NOT = 9
 18418         MOVE 'Y'                TO BEN-SEARCH-SW.
 18419
 18420     GO TO 7200-EXIT.
 18421
 18422 7200-BENEFIT-DUMMY.
 18423
 18424 7200-DUMMY-EXIT.
 18425     EXIT.
 18426
 18427 7200-EXIT.
 18428     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 339
* EL050.cbl
 18430 7250-LOOK-FOR-RESCINDED-CLAIM.
 18431     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18432                                    W-CL-COMP-CD.
 18433     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18434                                    W-CL-CERT-NO.
 18435
 18436
 18437* EXEC CICS HANDLE CONDITION
 18438*        NOTFND  (7250-CONTINUE)
 18439*        ENDFILE (7250-CONTINUE)
 18440*    END-EXEC.
 18441*    MOVE '"$I''                  ! ) #00018198' TO DFHEIV0
 18442     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18443     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18444     MOVE X'2920233030303138313938' TO DFHEIV0(25:11)
 18445     CALL 'kxdfhei1' USING DFHEIV0
 18446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18447
 18448
 18449
 18450* EXEC CICS IGNORE CONDITION
 18451*        DUPKEY
 18452*    END-EXEC.
 18453*    MOVE '"*$                   !   #00018203' TO DFHEIV0
 18454     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18456     MOVE X'2020233030303138323033' TO DFHEIV0(25:11)
 18457     CALL 'kxdfhei1' USING DFHEIV0
 18458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18459
 18460
 18461
 18462* EXEC CICS STARTBR
 18463*        DATASET   (CLMS-ID)
 18464*        RIDFLD    (ELMSTR-KEY)
 18465*        GENERIC   EQUAL
 18466*        KEYLENGTH (ELMSTR-LENGTH)
 18467*    END-EXEC.
 18468     MOVE 0
 18469       TO DFHEIV11
 18470*    MOVE '&,   KG    E          &   #00018207' TO DFHEIV0
 18471     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18472     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18473     MOVE X'2020233030303138323037' TO DFHEIV0(25:11)
 18474     CALL 'kxdfhei1' USING DFHEIV0,
 18475           CLMS-ID,
 18476           ELMSTR-KEY,
 18477           ELMSTR-LENGTH,
 18478           DFHEIV11,
 18479           DFHEIV99
 18480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18481
 18482
 18483     MOVE 'Y'                    TO W-BROWSE-SW.
 18484
 18485 7250-NEXT-CLAIM.
 18486
 18487
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 340
* EL050.cbl
 18488* EXEC CICS READNEXT
 18489*        DATASET   (CLMS-ID)
 18490*        RIDFLD    (ELMSTR-KEY)
 18491*        SET       (ADDRESS OF CLAIM-MASTER)
 18492*    END-EXEC.
 18493     MOVE 0
 18494       TO DFHEIV11
 18495*    MOVE '&.S                   )   #00018218' TO DFHEIV0
 18496     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18497     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18498     MOVE X'2020233030303138323138' TO DFHEIV0(25:11)
 18499     CALL 'kxdfhei1' USING DFHEIV0,
 18500           CLMS-ID,
 18501           DFHEIV20,
 18502           DFHEIV99,
 18503           ELMSTR-KEY,
 18504           DFHEIV99,
 18505           DFHEIV11,
 18506           DFHEIV99,
 18507           DFHEIV99
 18508     SET ADDRESS OF CLAIM-MASTER TO
 18509         DFHEIV20
 18510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18511
 18512
 18513     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18514        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18515         GO TO 7250-CONTINUE
 18516     END-IF.
 18517
 18518     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18519        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18520        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18521        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18522        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18523         GO TO 7250-NEXT-CLAIM
 18524     END-IF.
 18525
 18526     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18527        OR (CL-CLAIM-TYPE = 'I')
 18528        OR (CL-CLAIM-TYPE = 'G')
 18529          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18530              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18531              GO TO 7250-CONTINUE
 18532          END-IF
 18533     END-IF.
 18534
 18535     GO TO 7250-NEXT-CLAIM.
 18536
 18537 7250-CONTINUE.
 18538
 18539     IF W-BROWSE-SW = 'Y'
 18540
 18541* EXEC CICS ENDBR
 18542*            DATASET   (CLMS-ID)
 18543*        END-EXEC
 18544     MOVE 0
 18545       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 341
* EL050.cbl
 18546*    MOVE '&2                    $   #00018251' TO DFHEIV0
 18547     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18548     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18549     MOVE X'2020233030303138323531' TO DFHEIV0(25:11)
 18550     CALL 'kxdfhei1' USING DFHEIV0,
 18551           CLMS-ID,
 18552           DFHEIV11,
 18553           DFHEIV99
 18554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18555         MOVE 'N' TO W-BROWSE-SW
 18556     END-IF.
 18557
 18558 7250-EXIT.
 18559     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 342
* EL050.cbl
 18561 7300-CHECK-FOR-OPEN-CLMS.
 18562
 18563*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18564*    MOVE SPACES                 TO CNTL-ACCESS.
 18565*    MOVE '1'                    TO CNTL-REC-TYPE.
 18566*    MOVE +0                     TO CNTL-SEQ-NO.
 18567
 18568*    MOVE '3'                    TO RC-SW-1.
 18569*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18570
 18571*    IF NOT CF-COMPANY-MASTER
 18572*         PERFORM 0099-COMPANY-NOT-FOUND
 18573*         GO TO 7300-EXIT.
 18574
 18575     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18576                                    W-CL-COMP-CD.
 18577     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18578                                    W-CL-CERT-NO.
 18579
 18580
 18581* EXEC CICS HANDLE CONDITION
 18582*        NOTFND  (7300-CONTINUE)
 18583*        ENDFILE (7300-CONTINUE)
 18584*    END-EXEC.
 18585*    MOVE '"$I''                  ! * #00018279' TO DFHEIV0
 18586     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18587     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18588     MOVE X'2A20233030303138323739' TO DFHEIV0(25:11)
 18589     CALL 'kxdfhei1' USING DFHEIV0
 18590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18591
 18592
 18593
 18594* EXEC CICS IGNORE CONDITION
 18595*        DUPKEY
 18596*    END-EXEC.
 18597*    MOVE '"*$                   !   #00018284' TO DFHEIV0
 18598     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18599     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18600     MOVE X'2020233030303138323834' TO DFHEIV0(25:11)
 18601     CALL 'kxdfhei1' USING DFHEIV0
 18602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18603
 18604
 18605
 18606* EXEC CICS STARTBR
 18607*        DATASET   (CLMS-ID)
 18608*        RIDFLD    (ELMSTR-KEY)
 18609*        GENERIC   EQUAL
 18610*        KEYLENGTH (ELMSTR-LENGTH)
 18611*    END-EXEC.
 18612     MOVE 0
 18613       TO DFHEIV11
 18614*    MOVE '&,   KG    E          &   #00018288' TO DFHEIV0
 18615     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18616     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18617     MOVE X'2020233030303138323838' TO DFHEIV0(25:11)
 18618     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 343
* EL050.cbl
 18619           CLMS-ID,
 18620           ELMSTR-KEY,
 18621           ELMSTR-LENGTH,
 18622           DFHEIV11,
 18623           DFHEIV99
 18624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18625
 18626
 18627     MOVE 'Y'                    TO W-BROWSE-SW.
 18628
 18629 7300-NEXT-CLAIM.
 18630
 18631
 18632* EXEC CICS READNEXT
 18633*        DATASET   (CLMS-ID)
 18634*        RIDFLD    (ELMSTR-KEY)
 18635*        SET       (ADDRESS OF CLAIM-MASTER)
 18636*    END-EXEC.
 18637     MOVE 0
 18638       TO DFHEIV11
 18639*    MOVE '&.S                   )   #00018299' TO DFHEIV0
 18640     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18641     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18642     MOVE X'2020233030303138323939' TO DFHEIV0(25:11)
 18643     CALL 'kxdfhei1' USING DFHEIV0,
 18644           CLMS-ID,
 18645           DFHEIV20,
 18646           DFHEIV99,
 18647           ELMSTR-KEY,
 18648           DFHEIV99,
 18649           DFHEIV11,
 18650           DFHEIV99,
 18651           DFHEIV99
 18652     SET ADDRESS OF CLAIM-MASTER TO
 18653         DFHEIV20
 18654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18655
 18656
 18657     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18658        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18659         GO TO 7300-CONTINUE.
 18660
 18661     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18662        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18663        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18664        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18665        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18666         GO TO 7300-NEXT-CLAIM.
 18667
 18668*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18669     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18670        OR (CL-CLAIM-TYPE = 'I')
 18671        OR (CL-CLAIM-TYPE = 'G')
 18672        IF CLAIM-IS-OPEN
 18673           EVALUATE TRUE
 18674             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18675                 MOVE ER-2884      TO WS-ERROR
 18676             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 344
* EL050.cbl
 18677                 MOVE ER-2887      TO WS-ERROR
 18678             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18679                 MOVE ER-2886      TO WS-ERROR
 18680             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18681                 MOVE ER-2888      TO WS-ERROR
 18682             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18683                 MOVE ER-2885      TO WS-ERROR
 18684             WHEN OTHER
 18685                 MOVE ER-2768      TO WS-ERROR
 18686           END-EVALUATE
 18687           IF PB-C-AH-CANCEL-VOIDED OR
 18688              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18689                NOT AH-COVERAGE-CANCELLED)
 18690               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18691               MOVE ER-2768      TO WS-ERROR
 18692           END-IF
 18693           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18694           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18695              PB-FORCE-CODE NOT EQUAL '8'
 18696               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18697           END-IF
 18698           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18699           GO TO 7300-CONTINUE
 18700        ELSE
 18701           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18702*****THIS IS A RESCISSION OR REFORMATION
 18703              IF (AH-COVERAGE-CANCELLED AND
 18704                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18705                    MOVE ER-2890 TO WS-ERROR
 18706                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18707                    GO TO 7300-CONTINUE
 18708              END-IF
 18709           ELSE
 18710              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18711               AND PB-C-AH-CANCEL-DT > SPACES
 18712                 MOVE ER-2756        TO WS-ERROR
 18713                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18714                 GO TO 7300-CONTINUE
 18715              END-IF
 18716           END-IF
 18717        END-IF
 18718     ELSE
 18719*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18720        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18721           IF CLAIM-IS-OPEN
 18722              MOVE ER-2889      TO WS-ERROR
 18723              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18724              GO TO 7300-CONTINUE
 18725           ELSE
 18726              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18727*****THIS IS A RESCISSION OR REFORMATION
 18728                 IF (LF-COVERAGE-CANCELLED AND
 18729                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18730                       MOVE ER-2890 TO WS-ERROR
 18731                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18732                       GO TO 7300-CONTINUE
 18733                 END-IF
 18734              ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 345
* EL050.cbl
 18735                 IF (AH-COVERAGE-CANCELLED AND
 18736                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18737                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18738                    (LF-COVERAGE-CANCELLED AND
 18739                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18740                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18741                       MOVE ER-2965 TO WS-ERROR
 18742                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18743                       GO TO 7300-CONTINUE
 18744                 END-IF
 18745                 IF LF-COVERAGE-CANCELLED
 18746                  IF CL-TOTAL-PAID-AMT > 0
 18747                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18748                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18749                        MOVE ER-2891 TO WS-ERROR
 18750                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18751                        GO TO 7300-CONTINUE
 18752                      END-IF
 18753                    ELSE
 18754                      MOVE ER-2892 TO WS-ERROR
 18755                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18756                      GO TO 7300-CONTINUE
 18757                    END-IF
 18758                  END-IF
 18759                 END-IF
 18760              END-IF
 18761           END-IF
 18762        END-IF
 18763     END-IF
 18764
 18765     GO TO 7300-NEXT-CLAIM.
 18766
 18767 7300-CONTINUE.
 18768
 18769     IF W-BROWSE-SW = 'Y'
 18770
 18771* EXEC CICS ENDBR
 18772*            DATASET   (CLMS-ID)
 18773*        END-EXEC.
 18774     MOVE 0
 18775       TO DFHEIV11
 18776*    MOVE '&2                    $   #00018418' TO DFHEIV0
 18777     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18778     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18779     MOVE X'2020233030303138343138' TO DFHEIV0(25:11)
 18780     CALL 'kxdfhei1' USING DFHEIV0,
 18781           CLMS-ID,
 18782           DFHEIV11,
 18783           DFHEIV99
 18784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18785
 18786
 18787 7300-EXIT.
 18788     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 346
* EL050.cbl
 18790
 18791 7400-GET-REMAIN-TERM.
 18792
 18793* EXEC CICS LINK
 18794*        PROGRAM    ('ELRTRM')
 18795*        COMMAREA   (CALCULATION-PASS-AREA)
 18796*        LENGTH     (CP-COMM-LENGTH)
 18797*    END-EXEC.
 18798     MOVE 'ELRTRM' TO DFHEIV1
 18799*    MOVE '."C                   (   #00018427' TO DFHEIV0
 18800     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18801     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18802     MOVE X'2020233030303138343237' TO DFHEIV0(25:11)
 18803     CALL 'kxdfhei1' USING DFHEIV0,
 18804           DFHEIV1,
 18805           CALCULATION-PASS-AREA,
 18806           CP-COMM-LENGTH,
 18807           DFHEIV99,
 18808           DFHEIV99,
 18809           DFHEIV99,
 18810           DFHEIV99
 18811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18812
 18813
 18814 7400-EXIT.
 18815     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 347
* EL050.cbl
 18817
 18818 7500-GET-REMAIN-AMOUNT.
 18819
 18820* EXEC CICS LINK
 18821*        PROGRAM    ('ELRAMT')
 18822*        COMMAREA   (CALCULATION-PASS-AREA)
 18823*        LENGTH     (CP-COMM-LENGTH)
 18824*    END-EXEC.
 18825     MOVE 'ELRAMT' TO DFHEIV1
 18826*    MOVE '."C                   (   #00018438' TO DFHEIV0
 18827     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18828     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18829     MOVE X'2020233030303138343338' TO DFHEIV0(25:11)
 18830     CALL 'kxdfhei1' USING DFHEIV0,
 18831           DFHEIV1,
 18832           CALCULATION-PASS-AREA,
 18833           CP-COMM-LENGTH,
 18834           DFHEIV99,
 18835           DFHEIV99,
 18836           DFHEIV99,
 18837           DFHEIV99
 18838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18839
 18840
 18841 7500-EXIT.
 18842     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 348
* EL050.cbl
 18844
 18845 7600-GET-REFUND.
 18846
 18847* EXEC CICS LINK
 18848*        PROGRAM    ('ELRFND')
 18849*        COMMAREA   (CALCULATION-PASS-AREA)
 18850*        LENGTH     (CP-COMM-LENGTH)
 18851*    END-EXEC.
 18852     MOVE 'ELRFND' TO DFHEIV1
 18853*    MOVE '."C                   (   #00018449' TO DFHEIV0
 18854     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18855     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18856     MOVE X'2020233030303138343439' TO DFHEIV0(25:11)
 18857     CALL 'kxdfhei1' USING DFHEIV0,
 18858           DFHEIV1,
 18859           CALCULATION-PASS-AREA,
 18860           CP-COMM-LENGTH,
 18861           DFHEIV99,
 18862           DFHEIV99,
 18863           DFHEIV99,
 18864           DFHEIV99
 18865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18866
 18867
 18868 7600-EXIT.
 18869     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 349
* EL050.cbl
 18871 7700-CALL-DL1.
 18872
 18873* EXEC CICS LINK
 18874*        PROGRAM    ('DLO001')
 18875*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18876*        LENGTH     (DLO001-COMM-LENGTH)
 18877*    END-EXEC.
 18878     MOVE 'DLO001' TO DFHEIV1
 18879*    MOVE '."C                   (   #00018459' TO DFHEIV0
 18880     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18881     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18882     MOVE X'2020233030303138343539' TO DFHEIV0(25:11)
 18883     CALL 'kxdfhei1' USING DFHEIV0,
 18884           DFHEIV1,
 18885           WS-DLO-MASTER-POLICY-FORM,
 18886           DLO001-COMM-LENGTH,
 18887           DFHEIV99,
 18888           DFHEIV99,
 18889           DFHEIV99,
 18890           DFHEIV99
 18891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18892
 18893
 18894 7700-EXIT.
 18895     EXIT.
 18896
 18897 7710-CALL-DL2.
 18898
 18899* EXEC CICS LINK
 18900*        PROGRAM    ('DLO002')
 18901*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18902*        LENGTH     (DLO002-COMM-LENGTH)
 18903*    END-EXEC.
 18904     MOVE 'DLO002' TO DFHEIV1
 18905*    MOVE '."C                   (   #00018469' TO DFHEIV0
 18906     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18907     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18908     MOVE X'2020233030303138343639' TO DFHEIV0(25:11)
 18909     CALL 'kxdfhei1' USING DFHEIV0,
 18910           DFHEIV1,
 18911           WS-DLO-INTERNAL-POLICY-FORM,
 18912           DLO002-COMM-LENGTH,
 18913           DFHEIV99,
 18914           DFHEIV99,
 18915           DFHEIV99,
 18916           DFHEIV99
 18917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18918
 18919
 18920 7710-EXIT.
 18921     EXIT.
 18922
 18923 7720-CALL-DL3.
 18924
 18925* EXEC CICS LINK
 18926*        PROGRAM    ('DLO003')
 18927*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18928*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 350
* EL050.cbl
 18929*    END-EXEC.
 18930     MOVE 'DLO003' TO DFHEIV1
 18931*    MOVE '."C                   (   #00018479' TO DFHEIV0
 18932     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18933     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18934     MOVE X'2020233030303138343739' TO DFHEIV0(25:11)
 18935     CALL 'kxdfhei1' USING DFHEIV0,
 18936           DFHEIV1,
 18937           WS-DLO-VALID-BANK-ID,
 18938           DLO003-COMM-LENGTH,
 18939           DFHEIV99,
 18940           DFHEIV99,
 18941           DFHEIV99,
 18942           DFHEIV99
 18943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18944
 18945
 18946 7720-EXIT.
 18947     EXIT.
 18948
 18949 7730-CALL-DL7.
 18950
 18951* EXEC CICS LINK
 18952*        PROGRAM    ('DLO007')
 18953*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 18954*        LENGTH     (DLO007-COMM-LENGTH)
 18955*    END-EXEC.
 18956     MOVE 'DLO007' TO DFHEIV1
 18957*    MOVE '."C                   (   #00018489' TO DFHEIV0
 18958     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18959     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18960     MOVE X'2020233030303138343839' TO DFHEIV0(25:11)
 18961     CALL 'kxdfhei1' USING DFHEIV0,
 18962           DFHEIV1,
 18963           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 18964           DLO007-COMM-LENGTH,
 18965           DFHEIV99,
 18966           DFHEIV99,
 18967           DFHEIV99,
 18968           DFHEIV99
 18969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18970
 18971
 18972 7730-EXIT.
 18973     EXIT.
 18974
 18975 7740-CALL-DL11.
 18976
 18977* EXEC CICS LINK
 18978*        PROGRAM    ('DLO011')
 18979*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 18980*        LENGTH     (DLO011-COMM-LENGTH)
 18981*    END-EXEC.
 18982     MOVE 'DLO011' TO DFHEIV1
 18983*    MOVE '."C                   (   #00018499' TO DFHEIV0
 18984     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18985     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18986     MOVE X'2020233030303138343939' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 351
* EL050.cbl
 18987     CALL 'kxdfhei1' USING DFHEIV0,
 18988           DFHEIV1,
 18989           WS-DLO-PREM-RATES-BEN-TYPE,
 18990           DLO011-COMM-LENGTH,
 18991           DFHEIV99,
 18992           DFHEIV99,
 18993           DFHEIV99,
 18994           DFHEIV99
 18995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18996
 18997
 18998 7740-EXIT.
 18999     EXIT.
 19000
 19001 7750-CALL-DL17.
 19002
 19003* EXEC CICS LINK
 19004*        PROGRAM    ('DLO017')
 19005*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19006*        LENGTH     (DLO017-COMM-LENGTH)
 19007*    END-EXEC.
 19008     MOVE 'DLO017' TO DFHEIV1
 19009*    MOVE '."C                   (   #00018509' TO DFHEIV0
 19010     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19011     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19012     MOVE X'2020233030303138353039' TO DFHEIV0(25:11)
 19013     CALL 'kxdfhei1' USING DFHEIV0,
 19014           DFHEIV1,
 19015           WS-DLO-VALID-RATE-CODE,
 19016           DLO017-COMM-LENGTH,
 19017           DFHEIV99,
 19018           DFHEIV99,
 19019           DFHEIV99,
 19020           DFHEIV99
 19021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19022
 19023
 19024 7750-EXIT.
 19025     EXIT.
 19026
 19027 7755-CALL-DL19.
 19028
 19029* EXEC CICS LINK
 19030*        PROGRAM    ('DLO019')
 19031*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19032*        LENGTH     (DLO019-COMM-LENGTH)
 19033*    END-EXEC.
 19034     MOVE 'DLO019' TO DFHEIV1
 19035*    MOVE '."C                   (   #00018519' TO DFHEIV0
 19036     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19037     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19038     MOVE X'2020233030303138353139' TO DFHEIV0(25:11)
 19039     CALL 'kxdfhei1' USING DFHEIV0,
 19040           DFHEIV1,
 19041           WS-DLO-ORIG-COV-CAT,
 19042           DLO019-COMM-LENGTH,
 19043           DFHEIV99,
 19044           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 352
* EL050.cbl
 19045           DFHEIV99,
 19046           DFHEIV99
 19047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19048
 19049
 19050 7755-EXIT.
 19051     EXIT.
 19052
 19053 7760-CALL-DL21.
 19054
 19055* EXEC CICS LINK
 19056*        PROGRAM    ('DLO021')
 19057*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19058*        LENGTH     (DLO021-COMM-LENGTH)
 19059*    END-EXEC.
 19060     MOVE 'DLO021' TO DFHEIV1
 19061*    MOVE '."C                   (   #00018529' TO DFHEIV0
 19062     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19063     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19064     MOVE X'2020233030303138353239' TO DFHEIV0(25:11)
 19065     CALL 'kxdfhei1' USING DFHEIV0,
 19066           DFHEIV1,
 19067           WS-DLO-VALID-LOAN-OFFICER,
 19068           DLO021-COMM-LENGTH,
 19069           DFHEIV99,
 19070           DFHEIV99,
 19071           DFHEIV99,
 19072           DFHEIV99
 19073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19074
 19075
 19076 7760-EXIT.
 19077     EXIT.
 19078
 19079 7770-CALL-DL22.
 19080
 19081* EXEC CICS LINK
 19082*        PROGRAM    ('DLO022')
 19083*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19084*        LENGTH     (DLO022-COMM-LENGTH)
 19085*    END-EXEC.
 19086     MOVE 'DLO022' TO DFHEIV1
 19087*    MOVE '."C                   (   #00018539' TO DFHEIV0
 19088     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19089     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19090     MOVE X'2020233030303138353339' TO DFHEIV0(25:11)
 19091     CALL 'kxdfhei1' USING DFHEIV0,
 19092           DFHEIV1,
 19093           WS-DLO-VALID-STATE-CODE,
 19094           DLO022-COMM-LENGTH,
 19095           DFHEIV99,
 19096           DFHEIV99,
 19097           DFHEIV99,
 19098           DFHEIV99
 19099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19100
 19101
 19102 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 353
* EL050.cbl
 19103     EXIT.
 19104
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 354
* EL050.cbl
 19106
 19107 7800-REWRITE-CERT.
 19108******************************************************************
 19109*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19110*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19111******************************************************************
 19112
 19113     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19114        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19115        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19116        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19117
 19118* EXEC CICS REWRITE
 19119*                  DATASET (CERT-ID)
 19120*                  FROM    (CERTIFICATE-MASTER)
 19121*              END-EXEC
 19122     MOVE LENGTH OF
 19123      CERTIFICATE-MASTER
 19124       TO DFHEIV11
 19125*    MOVE '&& L                  %   #00018560' TO DFHEIV0
 19126     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19127     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19128     MOVE X'2020233030303138353630' TO DFHEIV0(25:11)
 19129     CALL 'kxdfhei1' USING DFHEIV0,
 19130           CERT-ID,
 19131           CERTIFICATE-MASTER,
 19132           DFHEIV11,
 19133           DFHEIV99
 19134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19135        GO TO 7800-EXIT.
 19136
 19137       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19138       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19139
 19140 7800-EXIT.
 19141      EXIT.
 19142
 19143 7900-DELETE-CERT.
 19144
 19145* EXEC CICS DELETE
 19146*        DATASET (CERT-ID)
 19147*    END-EXEC.
 19148*    MOVE '&(                    &   #00018573' TO DFHEIV0
 19149     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19150     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19151     MOVE X'2020233030303138353733' TO DFHEIV0(25:11)
 19152     CALL 'kxdfhei1' USING DFHEIV0,
 19153           CERT-ID,
 19154           DFHEIV99,
 19155           DFHEIV99,
 19156           DFHEIV99,
 19157           DFHEIV99
 19158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19159
 19160
 19161 7900-EXIT.
 19162     EXIT.
 19163
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 355
* EL050.cbl
 19164 8000-WRITE-CERT.
 19165
 19166* EXEC CICS HANDLE CONDITION
 19167*        DUPKEY    (8000-FREE-MAIN)
 19168*    END-EXEC.
 19169*    MOVE '"$$                   ! + #00018581' TO DFHEIV0
 19170     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19171     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19172     MOVE X'2B20233030303138353831' TO DFHEIV0(25:11)
 19173     CALL 'kxdfhei1' USING DFHEIV0
 19174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19175
 19176
 19177
 19178* EXEC CICS WRITE
 19179*        DATASET     (CERT-ID)
 19180*        FROM        (CERTIFICATE-MASTER)
 19181*        RIDFLD      (ELCERT-KEY)
 19182*    END-EXEC.
 19183     MOVE LENGTH OF
 19184      CERTIFICATE-MASTER
 19185       TO DFHEIV11
 19186*    MOVE '&$ L                  ''   #00018585' TO DFHEIV0
 19187     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19188     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19189     MOVE X'2020233030303138353835' TO DFHEIV0(25:11)
 19190     CALL 'kxdfhei1' USING DFHEIV0,
 19191           CERT-ID,
 19192           CERTIFICATE-MASTER,
 19193           DFHEIV11,
 19194           ELCERT-KEY,
 19195           DFHEIV99,
 19196           DFHEIV99
 19197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19198
 19199
 19200 8000-FREE-MAIN.
 19201
 19202 8000-EXIT.
 19203      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 356
* EL050.cbl
 19205
 19206 8100-READ-ERPNDM.
 19207
 19208* EXEC CICS HANDLE CONDITION
 19209*         NOTFND     (8100-NOTFND)
 19210*         ENDFILE    (8100-NOTFND)
 19211*    END-EXEC.
 19212*    MOVE '"$I''                  ! , #00018598' TO DFHEIV0
 19213     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19214     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19215     MOVE X'2C20233030303138353938' TO DFHEIV0(25:11)
 19216     CALL 'kxdfhei1' USING DFHEIV0
 19217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19218
 19219
 19220     MOVE SPACES                 TO ERPNDM-FOUND.
 19221     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19222
 19223
 19224* EXEC CICS READ
 19225*         DATASET   (FILE-ERPNDM)
 19226*         RIDFLD    (PM-CONTROL-PRIMARY)
 19227*         INTO      (PENDING-MAILING-DATA)
 19228*    END-EXEC.
 19229     MOVE LENGTH OF
 19230      PENDING-MAILING-DATA
 19231       TO DFHEIV11
 19232*    MOVE '&"IL       E          (   #00018606' TO DFHEIV0
 19233     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19234     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19235     MOVE X'2020233030303138363036' TO DFHEIV0(25:11)
 19236     CALL 'kxdfhei1' USING DFHEIV0,
 19237           FILE-ERPNDM,
 19238           PENDING-MAILING-DATA,
 19239           DFHEIV11,
 19240           PM-CONTROL-PRIMARY,
 19241           DFHEIV99,
 19242           DFHEIV99,
 19243           DFHEIV99
 19244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19245
 19246
 19247     GO TO 8100-EXIT.
 19248
 19249 8100-NOTFND.
 19250
 19251     MOVE 'X'                    TO ERPNDM-FOUND.
 19252     MOVE ER-2694                TO WS-ERROR.
 19253     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19254     MOVE ER-2883                TO WS-ERROR
 19255     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19256     .
 19257 8100-EXIT.
 19258     EXIT.
 19259
 19260 8110-READ-ERMAIL.
 19261
 19262* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 357
* EL050.cbl
 19263*         NOTFND     (8110-NOTFND)
 19264*         ENDFILE    (8110-NOTFND)
 19265*    END-EXEC.
 19266*    MOVE '"$I''                  ! - #00018626' TO DFHEIV0
 19267     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19268     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19269     MOVE X'2D20233030303138363236' TO DFHEIV0(25:11)
 19270     CALL 'kxdfhei1' USING DFHEIV0
 19271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19272
 19273
 19274     MOVE SPACES                 TO ERMAIL-FOUND.
 19275     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19276     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19277     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19278     MOVE PB-SV-STATE            TO MA-STATE.
 19279
 19280
 19281* EXEC CICS READ
 19282*         UPDATE
 19283*         DATASET   (FILE-ERMAIL)
 19284*         RIDFLD    (MA-CONTROL-PRIMARY)
 19285*         INTO      (MAILING-DATA)
 19286*    END-EXEC.
 19287     MOVE LENGTH OF
 19288      MAILING-DATA
 19289       TO DFHEIV11
 19290*    MOVE '&"IL       EU         (   #00018637' TO DFHEIV0
 19291     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19292     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19293     MOVE X'2020233030303138363337' TO DFHEIV0(25:11)
 19294     CALL 'kxdfhei1' USING DFHEIV0,
 19295           FILE-ERMAIL,
 19296           MAILING-DATA,
 19297           DFHEIV11,
 19298           MA-CONTROL-PRIMARY,
 19299           DFHEIV99,
 19300           DFHEIV99,
 19301           DFHEIV99
 19302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19303
 19304
 19305     GO TO 8110-EXIT.
 19306
 19307 8110-NOTFND.
 19308     MOVE 'X'                    TO ERMAIL-FOUND.
 19309
 19310 8110-EXIT.
 19311     EXIT.
 19312
 19313 8120-REWRITE-ERMAIL.
 19314
 19315* EXEC CICS REWRITE
 19316*         DATASET    (FILE-ERMAIL)
 19317*         FROM       (MAILING-DATA)
 19318*    END-EXEC.
 19319     MOVE LENGTH OF
 19320      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 358
* EL050.cbl
 19321       TO DFHEIV11
 19322*    MOVE '&& L                  %   #00018653' TO DFHEIV0
 19323     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19324     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19325     MOVE X'2020233030303138363533' TO DFHEIV0(25:11)
 19326     CALL 'kxdfhei1' USING DFHEIV0,
 19327           FILE-ERMAIL,
 19328           MAILING-DATA,
 19329           DFHEIV11,
 19330           DFHEIV99
 19331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19332
 19333
 19334 8120-EXIT.
 19335     EXIT.
 19336
 19337 8130-WRITE-ERMAIL.
 19338
 19339* EXEC CICS HANDLE CONDITION
 19340*         DUPKEY   (8130-EXIT)
 19341*    END-EXEC.
 19342*    MOVE '"$$                   ! . #00018662' TO DFHEIV0
 19343     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19345     MOVE X'2E20233030303138363632' TO DFHEIV0(25:11)
 19346     CALL 'kxdfhei1' USING DFHEIV0
 19347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19348
 19349
 19350
 19351* EXEC CICS WRITE
 19352*         DATASET     (FILE-ERMAIL)
 19353*         RIDFLD      (MA-CONTROL-PRIMARY)
 19354*         FROM        (MAILING-DATA)
 19355*    END-EXEC.
 19356     MOVE LENGTH OF
 19357      MAILING-DATA
 19358       TO DFHEIV11
 19359*    MOVE '&$ L                  ''   #00018666' TO DFHEIV0
 19360     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19361     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19362     MOVE X'2020233030303138363636' TO DFHEIV0(25:11)
 19363     CALL 'kxdfhei1' USING DFHEIV0,
 19364           FILE-ERMAIL,
 19365           MAILING-DATA,
 19366           DFHEIV11,
 19367           MA-CONTROL-PRIMARY,
 19368           DFHEIV99,
 19369           DFHEIV99
 19370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19371
 19372
 19373 8130-EXIT.
 19374     EXIT.
 19375
 19376 8140-UNLOCK-ERMAIL.
 19377
 19378* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 359
* EL050.cbl
 19379*         DATASET   (FILE-ERMAIL)
 19380*    END-EXEC.
 19381*    MOVE '&*                    #   #00018676' TO DFHEIV0
 19382     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19383     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19384     MOVE X'2020233030303138363736' TO DFHEIV0(25:11)
 19385     CALL 'kxdfhei1' USING DFHEIV0,
 19386           FILE-ERMAIL,
 19387           DFHEIV99
 19388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19389
 19390
 19391 8140-EXIT.
 19392     EXIT.
 19393
 19394 8180-UPDATE-VIN-NUMBER.
 19395
 19396* EXEC CICS HANDLE CONDITION
 19397*        NOTFND   (8180-NOTFND)
 19398*    END-EXEC.
 19399*    MOVE '"$I                   ! / #00018684' TO DFHEIV0
 19400     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19401     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19402     MOVE X'2F20233030303138363834' TO DFHEIV0(25:11)
 19403     CALL 'kxdfhei1' USING DFHEIV0
 19404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19405
 19406
 19407     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19408     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19409
 19410
 19411* EXEC CICS READ
 19412*        UPDATE
 19413*        DATASET  (CRTT-ID)
 19414*        RIDFLD   (WS-ELCRTT-KEY)
 19415*        INTO     (CERTIFICATE-TRAILERS)
 19416*    END-EXEC.
 19417     MOVE LENGTH OF
 19418      CERTIFICATE-TRAILERS
 19419       TO DFHEIV11
 19420*    MOVE '&"IL       EU         (   #00018691' TO DFHEIV0
 19421     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19422     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19423     MOVE X'2020233030303138363931' TO DFHEIV0(25:11)
 19424     CALL 'kxdfhei1' USING DFHEIV0,
 19425           CRTT-ID,
 19426           CERTIFICATE-TRAILERS,
 19427           DFHEIV11,
 19428           WS-ELCRTT-KEY,
 19429           DFHEIV99,
 19430           DFHEIV99,
 19431           DFHEIV99
 19432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19433
 19434
 19435     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19436         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 360
* EL050.cbl
 19437
 19438* EXEC CICS REWRITE
 19439*           DATASET  (CRTT-ID)
 19440*           FROM     (CERTIFICATE-TRAILERS)
 19441*        END-EXEC
 19442     MOVE LENGTH OF
 19443      CERTIFICATE-TRAILERS
 19444       TO DFHEIV11
 19445*    MOVE '&& L                  %   #00018700' TO DFHEIV0
 19446     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19447     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19448     MOVE X'2020233030303138373030' TO DFHEIV0(25:11)
 19449     CALL 'kxdfhei1' USING DFHEIV0,
 19450           CRTT-ID,
 19451           CERTIFICATE-TRAILERS,
 19452           DFHEIV11,
 19453           DFHEIV99
 19454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19455     ELSE
 19456
 19457* EXEC CICS UNLOCK
 19458*          DATASET  (CRTT-ID)
 19459*       END-EXEC
 19460*    MOVE '&*                    #   #00018705' TO DFHEIV0
 19461     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19462     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19463     MOVE X'2020233030303138373035' TO DFHEIV0(25:11)
 19464     CALL 'kxdfhei1' USING DFHEIV0,
 19465           CRTT-ID,
 19466           DFHEIV99
 19467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19468     END-IF.
 19469
 19470     GO TO 8180-EXIT.
 19471
 19472 8180-NOTFND.
 19473
 19474     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19475     MOVE 'CS'         TO CS-RECORD-ID.
 19476     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19477     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19478     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19479     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19480
 19481* EXEC CICS WRITE
 19482*       DATASET  (CRTT-ID)
 19483*       RIDFLD   (WS-ELCRTT-KEY)
 19484*       FROM     (CERTIFICATE-TRAILERS)
 19485*    END-EXEC.
 19486     MOVE LENGTH OF
 19487      CERTIFICATE-TRAILERS
 19488       TO DFHEIV11
 19489*    MOVE '&$ L                  ''   #00018720' TO DFHEIV0
 19490     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19491     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19492     MOVE X'2020233030303138373230' TO DFHEIV0(25:11)
 19493     CALL 'kxdfhei1' USING DFHEIV0,
 19494           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 361
* EL050.cbl
 19495           CERTIFICATE-TRAILERS,
 19496           DFHEIV11,
 19497           WS-ELCRTT-KEY,
 19498           DFHEIV99,
 19499           DFHEIV99
 19500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19501
 19502
 19503 8180-EXIT.
 19504     EXIT.
 19505
 19506 8190-UPDATE-REFUND-CLAIM-FLAG.
 19507
 19508* EXEC CICS HANDLE CONDITION
 19509*        NOTFND   (8190-NOTFND)
 19510*    END-EXEC.
 19511*    MOVE '"$I                   ! 0 #00018730' TO DFHEIV0
 19512     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19513     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19514     MOVE X'3020233030303138373330' TO DFHEIV0(25:11)
 19515     CALL 'kxdfhei1' USING DFHEIV0
 19516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19517
 19518
 19519     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19520     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19521
 19522
 19523* EXEC CICS READ
 19524*        UPDATE
 19525*        DATASET  (CRTT-ID)
 19526*        RIDFLD   (WS-ELCRTT-KEY)
 19527*        INTO     (CERTIFICATE-TRAILERS)
 19528*    END-EXEC.
 19529     MOVE LENGTH OF
 19530      CERTIFICATE-TRAILERS
 19531       TO DFHEIV11
 19532*    MOVE '&"IL       EU         (   #00018737' TO DFHEIV0
 19533     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19534     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19535     MOVE X'2020233030303138373337' TO DFHEIV0(25:11)
 19536     CALL 'kxdfhei1' USING DFHEIV0,
 19537           CRTT-ID,
 19538           CERTIFICATE-TRAILERS,
 19539           DFHEIV11,
 19540           WS-ELCRTT-KEY,
 19541           DFHEIV99,
 19542           DFHEIV99,
 19543           DFHEIV99
 19544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19545
 19546
 19547     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19548
 19549* EXEC CICS REWRITE
 19550*       DATASET  (CRTT-ID)
 19551*       FROM     (CERTIFICATE-TRAILERS)
 19552*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 362
* EL050.cbl
 19553     MOVE LENGTH OF
 19554      CERTIFICATE-TRAILERS
 19555       TO DFHEIV11
 19556*    MOVE '&& L                  %   #00018745' TO DFHEIV0
 19557     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19558     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19559     MOVE X'2020233030303138373435' TO DFHEIV0(25:11)
 19560     CALL 'kxdfhei1' USING DFHEIV0,
 19561           CRTT-ID,
 19562           CERTIFICATE-TRAILERS,
 19563           DFHEIV11,
 19564           DFHEIV99
 19565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19566
 19567
 19568     GO TO 8190-EXIT.
 19569
 19570 8190-NOTFND.
 19571
 19572     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19573     MOVE 'CS'         TO CS-RECORD-ID.
 19574     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19575     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19576     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19577     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19578
 19579* EXEC CICS WRITE
 19580*       DATASET  (CRTT-ID)
 19581*       RIDFLD   (WS-ELCRTT-KEY)
 19582*       FROM     (CERTIFICATE-TRAILERS)
 19583*    END-EXEC.
 19584     MOVE LENGTH OF
 19585      CERTIFICATE-TRAILERS
 19586       TO DFHEIV11
 19587*    MOVE '&$ L                  ''   #00018760' TO DFHEIV0
 19588     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19589     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19590     MOVE X'2020233030303138373630' TO DFHEIV0(25:11)
 19591     CALL 'kxdfhei1' USING DFHEIV0,
 19592           CRTT-ID,
 19593           CERTIFICATE-TRAILERS,
 19594           DFHEIV11,
 19595           WS-ELCRTT-KEY,
 19596           DFHEIV99,
 19597           DFHEIV99
 19598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19599
 19600
 19601 8190-EXIT.
 19602     EXIT.
 19603
 19604 8195-UPDATE-AGE-FLAGS.
 19605
 19606* EXEC CICS HANDLE CONDITION
 19607*        NOTFND   (8195-NOTFND)
 19608*    END-EXEC.
 19609*    MOVE '"$I                   ! 1 #00018770' TO DFHEIV0
 19610     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 363
* EL050.cbl
 19611     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19612     MOVE X'3120233030303138373730' TO DFHEIV0(25:11)
 19613     CALL 'kxdfhei1' USING DFHEIV0
 19614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19615
 19616
 19617     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19618     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19619
 19620
 19621* EXEC CICS READ
 19622*        UPDATE
 19623*        DATASET  (CRTT-ID)
 19624*        RIDFLD   (WS-ELCRTT-KEY)
 19625*        INTO     (CERTIFICATE-TRAILERS)
 19626*    END-EXEC.
 19627     MOVE LENGTH OF
 19628      CERTIFICATE-TRAILERS
 19629       TO DFHEIV11
 19630*    MOVE '&"IL       EU         (   #00018777' TO DFHEIV0
 19631     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19632     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19633     MOVE X'2020233030303138373737' TO DFHEIV0(25:11)
 19634     CALL 'kxdfhei1' USING DFHEIV0,
 19635           CRTT-ID,
 19636           CERTIFICATE-TRAILERS,
 19637           DFHEIV11,
 19638           WS-ELCRTT-KEY,
 19639           DFHEIV99,
 19640           DFHEIV99,
 19641           DFHEIV99
 19642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19643
 19644
 19645     IF WS-INS-AGE-SET = 'Y'
 19646        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19647     END-IF
 19648     IF WS-JNT-AGE-SET = 'Y'
 19649        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19650     END-IF
 19651
 19652
 19653* EXEC CICS REWRITE
 19654*       DATASET  (CRTT-ID)
 19655*       FROM     (CERTIFICATE-TRAILERS)
 19656*    END-EXEC.
 19657     MOVE LENGTH OF
 19658      CERTIFICATE-TRAILERS
 19659       TO DFHEIV11
 19660*    MOVE '&& L                  %   #00018791' TO DFHEIV0
 19661     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19662     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19663     MOVE X'2020233030303138373931' TO DFHEIV0(25:11)
 19664     CALL 'kxdfhei1' USING DFHEIV0,
 19665           CRTT-ID,
 19666           CERTIFICATE-TRAILERS,
 19667           DFHEIV11,
 19668           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 364
* EL050.cbl
 19669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19670
 19671
 19672     GO TO 8195-EXIT.
 19673
 19674 8195-NOTFND.
 19675
 19676     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19677     MOVE 'CS'         TO CS-RECORD-ID.
 19678     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19679     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19680     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19681     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 19682     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19683
 19684* EXEC CICS WRITE
 19685*       DATASET  (CRTT-ID)
 19686*       RIDFLD   (WS-ELCRTT-KEY)
 19687*       FROM     (CERTIFICATE-TRAILERS)
 19688*    END-EXEC.
 19689     MOVE LENGTH OF
 19690      CERTIFICATE-TRAILERS
 19691       TO DFHEIV11
 19692*    MOVE '&$ L                  ''   #00018807' TO DFHEIV0
 19693     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19694     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19695     MOVE X'2020233030303138383037' TO DFHEIV0(25:11)
 19696     CALL 'kxdfhei1' USING DFHEIV0,
 19697           CRTT-ID,
 19698           CERTIFICATE-TRAILERS,
 19699           DFHEIV11,
 19700           WS-ELCRTT-KEY,
 19701           DFHEIV99,
 19702           DFHEIV99
 19703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19704
 19705
 19706 8195-EXIT.
 19707     EXIT.
 19708
 19709 8200-READ-REIN-TABLE.
 19710
 19711* EXEC CICS HANDLE CONDITION
 19712*         NOTFND   (8200-NOTFND)
 19713*    END-EXEC.
 19714*    MOVE '"$I                   ! 2 #00018817' TO DFHEIV0
 19715     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19716     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19717     MOVE X'3220233030303138383137' TO DFHEIV0(25:11)
 19718     CALL 'kxdfhei1' USING DFHEIV0
 19719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19720
 19721
 19722
 19723* EXEC CICS READ
 19724*        DATASET     (REIN-ID)
 19725*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19726*        RIDFLD      (ERREIN-KEY)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 365
* EL050.cbl
 19727*    END-EXEC.
 19728*    MOVE '&"S        E          (   #00018821' TO DFHEIV0
 19729     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19730     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19731     MOVE X'2020233030303138383231' TO DFHEIV0(25:11)
 19732     CALL 'kxdfhei1' USING DFHEIV0,
 19733           REIN-ID,
 19734           DFHEIV20,
 19735           DFHEIV99,
 19736           ERREIN-KEY,
 19737           DFHEIV99,
 19738           DFHEIV99,
 19739           DFHEIV99
 19740     SET ADDRESS OF REINSURANCE-RECORD TO
 19741         DFHEIV20
 19742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19743
 19744
 19745     GO TO 8200-EXIT.
 19746
 19747 8200-NOTFND.
 19748     MOVE 'N'             TO WS-REIN-READ-SW.
 19749
 19750 8200-EXIT.
 19751      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 366
* EL050.cbl
 19753
 19754 8300-READ-CTBL-TABLE.
 19755
 19756* EXEC CICS HANDLE CONDITION
 19757*        NOTFND    (8300-NOTFND)
 19758*        DISABLED  (8300-ERRESS-PROBLEM)
 19759*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19760*        ENDFILE   (8300-NOTFND)
 19761*    END-EXEC.
 19762*    MOVE '"$IcJ''                ! 3 #00018837' TO DFHEIV0
 19763     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19764     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19765     MOVE X'3320233030303138383337' TO DFHEIV0(25:11)
 19766     CALL 'kxdfhei1' USING DFHEIV0
 19767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19768
 19769
 19770
 19771* EXEC CICS READ
 19772*        DATASET     (CTBL-ID)
 19773*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19774*        RIDFLD      (ERCTBL-KEY)
 19775*    END-EXEC.
 19776*    MOVE '&"S        E          (   #00018844' TO DFHEIV0
 19777     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19778     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19779     MOVE X'2020233030303138383434' TO DFHEIV0(25:11)
 19780     CALL 'kxdfhei1' USING DFHEIV0,
 19781           CTBL-ID,
 19782           DFHEIV20,
 19783           DFHEIV99,
 19784           ERCTBL-KEY,
 19785           DFHEIV99,
 19786           DFHEIV99,
 19787           DFHEIV99
 19788     SET ADDRESS OF COMM-TABLE-RECORD TO
 19789         DFHEIV20
 19790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19791
 19792
 19793     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19794
 19795     GO TO 8300-EXIT.
 19796
 19797 8300-NOTFND.
 19798
 19799     IF CTBL-SW = '0530'
 19800         MOVE 'AA'                     TO WS-AH-COMP-CD
 19801         MOVE '0550'                   TO CTBL-SW
 19802         MOVE '1'                      TO WS-CTBL-READ-SW
 19803         GO TO 8300-EXIT.
 19804
 19805     IF CTBL-SW = '0540'
 19806         MOVE 'AA'                     TO WS-LF-COMP-CD
 19807         MOVE '0550'                   TO CTBL-SW
 19808         MOVE '1'                      TO WS-CTBL-READ-SW
 19809         GO TO 8300-EXIT.
 19810
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 367
* EL050.cbl
 19811     IF CTBL-SW = '0550'
 19812         MOVE '2'                      TO WS-CTBL-READ-SW
 19813         GO TO 8300-EXIT.
 19814
 19815     GO TO 8300-EXIT.
 19816
 19817 8300-ERRESS-PROBLEM.
 19818
 19819      MOVE ER-8050              TO WS-ERROR.
 19820      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19821
 19822     GO TO 8300-EXIT.
 19823
 19824 8300-EXIT.
 19825      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 368
* EL050.cbl
 19827
 19828
 19829 8400-GETMAIN-ERFORM.
 19830
 19831
 19832* EXEC CICS   GETMAIN
 19833*        LENGTH  (500)
 19834*        SET     (ADDRESS OF FORM-MASTER)
 19835*    END-EXEC.
 19836     MOVE 500
 19837       TO DFHEIV11
 19838*    MOVE '," L                  $   #00018888' TO DFHEIV0
 19839     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19840     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19841     MOVE X'2020233030303138383838' TO DFHEIV0(25:11)
 19842     CALL 'kxdfhei1' USING DFHEIV0,
 19843           DFHEIV20,
 19844           DFHEIV11,
 19845           DFHEIV99
 19846     SET ADDRESS OF FORM-MASTER TO
 19847         DFHEIV20
 19848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19849
 19850
 19851     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19852
 19853 8400-EXIT.
 19854      EXIT.
 19855
 19856 8450-READ-FORM-MASTER.
 19857
 19858
 19859* EXEC CICS  HANDLE CONDITION
 19860*        NOTFND   (8450-FORM-NOT-FOUND)
 19861*        ENDFILE  (8450-FORM-NOT-FOUND)
 19862*    END-EXEC.
 19863*    MOVE '"$I''                  ! 4 #00018900' TO DFHEIV0
 19864     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19865     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19866     MOVE X'3420233030303138393030' TO DFHEIV0(25:11)
 19867     CALL 'kxdfhei1' USING DFHEIV0
 19868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19869
 19870
 19871
 19872* EXEC CICS   READ
 19873*        DATASET   (FORM-ID)
 19874*        RIDFLD    (ERFORM-KEY)
 19875*        INTO      (FORM-MASTER)
 19876*        GTEQ
 19877*    END-EXEC.
 19878     MOVE LENGTH OF
 19879      FORM-MASTER
 19880       TO DFHEIV11
 19881*    MOVE '&"IL       G          (   #00018905' TO DFHEIV0
 19882     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19883     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19884     MOVE X'2020233030303138393035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 369
* EL050.cbl
 19885     CALL 'kxdfhei1' USING DFHEIV0,
 19886           FORM-ID,
 19887           FORM-MASTER,
 19888           DFHEIV11,
 19889           ERFORM-KEY,
 19890           DFHEIV99,
 19891           DFHEIV99,
 19892           DFHEIV99
 19893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19894
 19895
 19896     MOVE  'Y'           TO  FORM-MASTER-SW.
 19897
 19898     GO TO  8450-EXIT.
 19899
 19900 8450-FORM-NOT-FOUND.
 19901
 19902     MOVE  'N'           TO  FORM-MASTER-SW.
 19903
 19904 8450-EXIT.
 19905      EXIT.
 19906
 19907 8500-DATE-CONVERT.
 19908
 19909* EXEC CICS LINK
 19910*        PROGRAM    ('ELDATCV')
 19911*        COMMAREA   (DATE-CONVERSION-DATA)
 19912*        LENGTH     (DC-COMM-LENGTH)
 19913*    END-EXEC.
 19914     MOVE 'ELDATCV' TO DFHEIV1
 19915*    MOVE '."C                   (   #00018924' TO DFHEIV0
 19916     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19917     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19918     MOVE X'2020233030303138393234' TO DFHEIV0(25:11)
 19919     CALL 'kxdfhei1' USING DFHEIV0,
 19920           DFHEIV1,
 19921           DATE-CONVERSION-DATA,
 19922           DC-COMM-LENGTH,
 19923           DFHEIV99,
 19924           DFHEIV99,
 19925           DFHEIV99,
 19926           DFHEIV99
 19927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19928
 19929
 19930 8500-EXIT.
 19931     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 370
* EL050.cbl
 19933
 19934 8555-RELOAD-CONTROL-FILE.
 19935     CONTINUE.
 19936
 19937 8555-EXIT.
 19938     EXIT.
 19939
 19940 8557-GETMAIN-ERPLAN.
 19941
 19942
 19943* EXEC CICS GETMAIN
 19944*        LENGTH    (840)
 19945*        SET       (ADDRESS OF PLAN-RECORDS)
 19946*    END-EXEC.
 19947     MOVE 840
 19948       TO DFHEIV11
 19949*    MOVE '," L                  $   #00018942' TO DFHEIV0
 19950     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19951     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19952     MOVE X'2020233030303138393432' TO DFHEIV0(25:11)
 19953     CALL 'kxdfhei1' USING DFHEIV0,
 19954           DFHEIV20,
 19955           DFHEIV11,
 19956           DFHEIV99
 19957     SET ADDRESS OF PLAN-RECORDS TO
 19958         DFHEIV20
 19959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19960
 19961
 19962     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 19963
 19964 8557-EXIT.
 19965     EXIT.
 19966
 19967 8560-GETMAIN.
 19968
 19969* EXEC CICS GETMAIN
 19970*        LENGTH    (2000)
 19971*        SET       (ADDRESS OF ACCOUNT-MASTER)
 19972*    END-EXEC.
 19973     MOVE 2000
 19974       TO DFHEIV11
 19975*    MOVE '," L                  $   #00018953' TO DFHEIV0
 19976     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19977     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19978     MOVE X'2020233030303138393533' TO DFHEIV0(25:11)
 19979     CALL 'kxdfhei1' USING DFHEIV0,
 19980           DFHEIV20,
 19981           DFHEIV11,
 19982           DFHEIV99
 19983     SET ADDRESS OF ACCOUNT-MASTER TO
 19984         DFHEIV20
 19985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19986
 19987
 19988     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 19989
 19990 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 371
* EL050.cbl
 19991     EXIT.
 19992
 19993 8570-START-ACCOUNT-MASTER.
 19994
 19995* EXEC CICS HANDLE CONDITION
 19996*        NOTFND    (0199-ACCT-NOT-FOUND)
 19997*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19998*    END-EXEC.
 19999*    MOVE '"$I''                  ! 5 #00018964' TO DFHEIV0
 20000     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20001     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20002     MOVE X'3520233030303138393634' TO DFHEIV0(25:11)
 20003     CALL 'kxdfhei1' USING DFHEIV0
 20004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20005
 20006
 20007
 20008* EXEC CICS STARTBR
 20009*        DATASET    (ACCT-ID)
 20010*        RIDFLD     (ERACCT-KEY)
 20011*        GTEQ
 20012*    END-EXEC.
 20013     MOVE 0
 20014       TO DFHEIV11
 20015*    MOVE '&,         G          &   #00018969' TO DFHEIV0
 20016     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20017     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20018     MOVE X'2020233030303138393639' TO DFHEIV0(25:11)
 20019     CALL 'kxdfhei1' USING DFHEIV0,
 20020           ACCT-ID,
 20021           ERACCT-KEY,
 20022           DFHEIV99,
 20023           DFHEIV11,
 20024           DFHEIV99
 20025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20026
 20027
 20028 8570-EXIT.
 20029     EXIT.
 20030
 20031 8580-READ-ACCOUNT-MASTER.
 20032
 20033* EXEC CICS HANDLE CONDITION
 20034*        NOTFND    (0199-ACCT-NOT-FOUND)
 20035*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20036*    END-EXEC.
 20037*    MOVE '"$I''                  ! 6 #00018979' TO DFHEIV0
 20038     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20039     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20040     MOVE X'3620233030303138393739' TO DFHEIV0(25:11)
 20041     CALL 'kxdfhei1' USING DFHEIV0
 20042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20043
 20044
 20045
 20046* EXEC CICS READNEXT
 20047*        DATASET     (ACCT-ID)
 20048*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 372
* EL050.cbl
 20049*        RIDFLD      (ERACCT-KEY)
 20050*    END-EXEC.
 20051     MOVE LENGTH OF
 20052      ACCOUNT-MASTER
 20053       TO DFHEIV12
 20054     MOVE 0
 20055       TO DFHEIV11
 20056*    MOVE '&.IL                  )   #00018984' TO DFHEIV0
 20057     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20058     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20059     MOVE X'2020233030303138393834' TO DFHEIV0(25:11)
 20060     CALL 'kxdfhei1' USING DFHEIV0,
 20061           ACCT-ID,
 20062           ACCOUNT-MASTER,
 20063           DFHEIV12,
 20064           ERACCT-KEY,
 20065           DFHEIV99,
 20066           DFHEIV11,
 20067           DFHEIV99,
 20068           DFHEIV99
 20069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20070
 20071
 20072 8580-EXIT.
 20073     EXIT.
 20074
 20075 8582-READ-COMPENSATION-MASTER.
 20076
 20077* EXEC CICS HANDLE CONDITION
 20078*        NOTFND    (8582-COMP-NOT-FOUND)
 20079*        ENDFILE   (8582-COMP-NOT-FOUND)
 20080*    END-EXEC.
 20081*    MOVE '"$I''                  ! 7 #00018994' TO DFHEIV0
 20082     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20083     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20084     MOVE X'3720233030303138393934' TO DFHEIV0(25:11)
 20085     CALL 'kxdfhei1' USING DFHEIV0
 20086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20087
 20088
 20089
 20090* EXEC CICS READ
 20091*        DATASET     (COMP-ID)
 20092*        INTO        (COMPENSATION-MASTER)
 20093*        RIDFLD      (ERCOMP-KEY)
 20094*    END-EXEC.
 20095     MOVE LENGTH OF
 20096      COMPENSATION-MASTER
 20097       TO DFHEIV11
 20098*    MOVE '&"IL       E          (   #00018999' TO DFHEIV0
 20099     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20100     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20101     MOVE X'2020233030303138393939' TO DFHEIV0(25:11)
 20102     CALL 'kxdfhei1' USING DFHEIV0,
 20103           COMP-ID,
 20104           COMPENSATION-MASTER,
 20105           DFHEIV11,
 20106           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 373
* EL050.cbl
 20107           DFHEIV99,
 20108           DFHEIV99,
 20109           DFHEIV99
 20110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20111
 20112
 20113     MOVE 'Y'                    TO COMP-MASTER-SW
 20114
 20115     GO TO 8582-EXIT
 20116     .
 20117 8582-COMP-NOT-FOUND.
 20118
 20119     MOVE 'N'                    TO COMP-MASTER-SW.
 20120
 20121 8582-EXIT.
 20122     EXIT.
 20123
 20124 8583-READ-ERAGTC.
 20125
 20126* EXEC CICS HANDLE CONDITION
 20127*        NOTFND    (8583-AGTC-NOT-FOUND)
 20128*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20129*    END-EXEC.
 20130*    MOVE '"$I''                  ! 8 #00019017' TO DFHEIV0
 20131     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20132     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20133     MOVE X'3820233030303139303137' TO DFHEIV0(25:11)
 20134     CALL 'kxdfhei1' USING DFHEIV0
 20135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20136
 20137
 20138
 20139* EXEC CICS STARTBR
 20140*        DATASET    (AGTC-ID)
 20141*        RIDFLD     (ERAGTC-KEY)
 20142*        GTEQ
 20143*    END-EXEC.
 20144     MOVE 0
 20145       TO DFHEIV11
 20146*    MOVE '&,         G          &   #00019022' TO DFHEIV0
 20147     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20148     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20149     MOVE X'2020233030303139303232' TO DFHEIV0(25:11)
 20150     CALL 'kxdfhei1' USING DFHEIV0,
 20151           AGTC-ID,
 20152           ERAGTC-KEY,
 20153           DFHEIV99,
 20154           DFHEIV11,
 20155           DFHEIV99
 20156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20157
 20158
 20159 8583-READ-ERAGTC-NEXT.
 20160
 20161* EXEC CICS READNEXT
 20162*        DATASET     (AGTC-ID)
 20163*        INTO        (AGENT-COMMISSIONS)
 20164*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 374
* EL050.cbl
 20165*    END-EXEC.
 20166     MOVE LENGTH OF
 20167      AGENT-COMMISSIONS
 20168       TO DFHEIV12
 20169     MOVE 0
 20170       TO DFHEIV11
 20171*    MOVE '&.IL                  )   #00019029' TO DFHEIV0
 20172     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20173     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20174     MOVE X'2020233030303139303239' TO DFHEIV0(25:11)
 20175     CALL 'kxdfhei1' USING DFHEIV0,
 20176           AGTC-ID,
 20177           AGENT-COMMISSIONS,
 20178           DFHEIV12,
 20179           ERAGTC-KEY,
 20180           DFHEIV99,
 20181           DFHEIV11,
 20182           DFHEIV99,
 20183           DFHEIV99
 20184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20185
 20186
 20187*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20188
 20189     GO TO 8583-EXIT
 20190     .
 20191 8583-AGTC-NOT-FOUND.
 20192
 20193     MOVE 'N'                    TO AGTC-MASTER-SW.
 20194
 20195 8583-EXIT.
 20196     EXIT.
 20197
 20198 8584-READ-BANK-CROSS-REF.
 20199
 20200* EXEC CICS HANDLE CONDITION
 20201*        NOTFND    (8584-BXRF-NOT-FOUND)
 20202*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20203*    END-EXEC.
 20204*    MOVE '"$I''                  ! 9 #00019047' TO DFHEIV0
 20205     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20206     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20207     MOVE X'3920233030303139303437' TO DFHEIV0(25:11)
 20208     CALL 'kxdfhei1' USING DFHEIV0
 20209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20210
 20211
 20212
 20213* EXEC CICS READ
 20214*        DATASET     (BXRF-ID)
 20215*        INTO        (BANK-CROSS-REFERENCE)
 20216*        RIDFLD      (ERBXRF-KEY)
 20217*        LENGTH      (BXRF-REC-LENGTH)
 20218*    END-EXEC.
 20219*    MOVE '&"IL       E          (   #00019052' TO DFHEIV0
 20220     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20221     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20222     MOVE X'2020233030303139303532' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 375
* EL050.cbl
 20223     CALL 'kxdfhei1' USING DFHEIV0,
 20224           BXRF-ID,
 20225           BANK-CROSS-REFERENCE,
 20226           BXRF-REC-LENGTH,
 20227           ERBXRF-KEY,
 20228           DFHEIV99,
 20229           DFHEIV99,
 20230           DFHEIV99
 20231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20232
 20233
 20234     MOVE 'Y'                    TO BXRF-MASTER-SW
 20235
 20236     GO TO 8584-EXIT
 20237     .
 20238 8584-BXRF-NOT-FOUND.
 20239
 20240     MOVE 'N'                    TO BXRF-MASTER-SW.
 20241
 20242 8584-EXIT.
 20243     EXIT.
 20244
 20245 8585-READ-PLAN-MASTER.
 20246
 20247
 20248* EXEC CICS HANDLE CONDITION
 20249*        NOTFND    (8585-PLAN-NOT-FOUND)
 20250*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20251*    END-EXEC.
 20252*    MOVE '"$I''                  ! : #00019072' TO DFHEIV0
 20253     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20254     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20255     MOVE X'3A20233030303139303732' TO DFHEIV0(25:11)
 20256     CALL 'kxdfhei1' USING DFHEIV0
 20257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20258
 20259
 20260
 20261* EXEC CICS READ
 20262*        DATASET     (PLAN-ID)
 20263*        INTO        (PLAN-MASTER)
 20264*        RIDFLD      (ERPLAN-KEY)
 20265*    END-EXEC.
 20266     MOVE LENGTH OF
 20267      PLAN-MASTER
 20268       TO DFHEIV11
 20269*    MOVE '&"IL       E          (   #00019077' TO DFHEIV0
 20270     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20271     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20272     MOVE X'2020233030303139303737' TO DFHEIV0(25:11)
 20273     CALL 'kxdfhei1' USING DFHEIV0,
 20274           PLAN-ID,
 20275           PLAN-MASTER,
 20276           DFHEIV11,
 20277           ERPLAN-KEY,
 20278           DFHEIV99,
 20279           DFHEIV99,
 20280           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 376
* EL050.cbl
 20281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20282
 20283
 20284     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20285
 20286     GO TO 8585-EXIT.
 20287
 20288 8585-PLAN-NOT-FOUND.
 20289
 20290     MOVE 'N'                    TO PLAN-MASTER-SW.
 20291
 20292 8585-EXIT.
 20293     EXIT.
 20294
 20295 8586-READ-LOAN-OFFICER.
 20296
 20297* EXEC CICS READ
 20298*        DATASET     (LOFC-ID)
 20299*        INTO        (LOAN-OFFICER-MASTER)
 20300*        RIDFLD      (ERLOFC-KEY)
 20301*        RESP        (WS-RESPONSE)
 20302*    END-EXEC
 20303     MOVE LENGTH OF
 20304      LOAN-OFFICER-MASTER
 20305       TO DFHEIV11
 20306*    MOVE '&"IL       E          (  N#00019095' TO DFHEIV0
 20307     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20308     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20309     MOVE X'204E233030303139303935' TO DFHEIV0(25:11)
 20310     CALL 'kxdfhei1' USING DFHEIV0,
 20311           LOFC-ID,
 20312           LOAN-OFFICER-MASTER,
 20313           DFHEIV11,
 20314           ERLOFC-KEY,
 20315           DFHEIV99,
 20316           DFHEIV99,
 20317           DFHEIV99
 20318     MOVE EIBRESP  TO WS-RESPONSE
 20319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20320
 20321     IF WS-RESP-NORMAL
 20322        MOVE 'Y'                 TO LOFC-MASTER-SW
 20323     ELSE
 20324        MOVE 'N'                 TO LOFC-MASTER-SW
 20325     END-IF
 20326     .
 20327 8586-EXIT.
 20328     EXIT.
 20329 8587-START-ERPDEF.
 20330
 20331* EXEC CICS STARTBR
 20332*       DATASET   (PDEF-ID)
 20333*       RIDFLD    (ERPDEF-KEY)
 20334*       GTEQ
 20335*       RESP      (WS-RESPONSE)
 20336*    END-EXEC
 20337     MOVE 0
 20338       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 377
* EL050.cbl
 20339*    MOVE '&,         G          &  N#00019111' TO DFHEIV0
 20340     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20341     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20342     MOVE X'204E233030303139313131' TO DFHEIV0(25:11)
 20343     CALL 'kxdfhei1' USING DFHEIV0,
 20344           PDEF-ID,
 20345           ERPDEF-KEY,
 20346           DFHEIV99,
 20347           DFHEIV11,
 20348           DFHEIV99
 20349     MOVE EIBRESP  TO WS-RESPONSE
 20350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20351     IF WS-RESP-NORMAL
 20352        MOVE 'Y'                 TO PDEF-MASTER-SW
 20353     ELSE
 20354        MOVE 'N'                 TO PDEF-MASTER-SW
 20355     END-IF
 20356     .
 20357 8587-EXIT.
 20358     EXIT.
 20359 8588-READ-ERPDEF.
 20360
 20361* EXEC CICS READNEXT
 20362*       DATASET   (PDEF-ID)
 20363*       RIDFLD    (ERPDEF-KEY)
 20364*       INTO      (PRODUCT-MASTER)
 20365*       RESP      (WS-RESPONSE)
 20366*    END-EXEC
 20367     MOVE LENGTH OF
 20368      PRODUCT-MASTER
 20369       TO DFHEIV12
 20370     MOVE 0
 20371       TO DFHEIV11
 20372*    MOVE '&.IL                  )  N#00019126' TO DFHEIV0
 20373     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20374     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20375     MOVE X'204E233030303139313236' TO DFHEIV0(25:11)
 20376     CALL 'kxdfhei1' USING DFHEIV0,
 20377           PDEF-ID,
 20378           PRODUCT-MASTER,
 20379           DFHEIV12,
 20380           ERPDEF-KEY,
 20381           DFHEIV99,
 20382           DFHEIV11,
 20383           DFHEIV99,
 20384           DFHEIV99
 20385     MOVE EIBRESP  TO WS-RESPONSE
 20386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20387     IF WS-RESP-NORMAL
 20388        MOVE 'Y'                 TO PDEF-MASTER-SW
 20389     ELSE
 20390        MOVE 'N'                 TO PDEF-MASTER-SW
 20391     END-IF
 20392     .
 20393 8588-EXIT.
 20394     EXIT.
 20395 8589-ENDBR-ERPDEF.
 20396
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 378
* EL050.cbl
 20397* EXEC CICS ENDBR
 20398*       DATASET   (PDEF-ID)
 20399*    END-EXEC
 20400     MOVE 0
 20401       TO DFHEIV11
 20402*    MOVE '&2                    $   #00019141' TO DFHEIV0
 20403     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20404     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20405     MOVE X'2020233030303139313431' TO DFHEIV0(25:11)
 20406     CALL 'kxdfhei1' USING DFHEIV0,
 20407           PDEF-ID,
 20408           DFHEIV11,
 20409           DFHEIV99
 20410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20411     .
 20412 8589-EXIT.
 20413     EXIT.
 20414 8590-READ-CERT-MASTER.
 20415     IF PB-COMPANY-ID = 'UCL'
 20416         GO TO 8690-READ-CERT-MASTER-UCL.
 20417
 20418
 20419* EXEC CICS HANDLE CONDITION
 20420*         NOTFND    (0299-CERT-NOT-FOUND)
 20421*    END-EXEC.
 20422*    MOVE '"$I                   ! ; #00019151' TO DFHEIV0
 20423     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20424     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20425     MOVE X'3B20233030303139313531' TO DFHEIV0(25:11)
 20426     CALL 'kxdfhei1' USING DFHEIV0
 20427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20428
 20429
 20430
 20431* EXEC CICS READ
 20432*        DATASET     (CERT-ID)
 20433*        INTO        (CERTIFICATE-MASTER)
 20434*        RIDFLD      (ELCERT-KEY)
 20435*        UPDATE
 20436*    END-EXEC.
 20437     MOVE LENGTH OF
 20438      CERTIFICATE-MASTER
 20439       TO DFHEIV11
 20440*    MOVE '&"IL       EU         (   #00019155' TO DFHEIV0
 20441     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20442     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20443     MOVE X'2020233030303139313535' TO DFHEIV0(25:11)
 20444     CALL 'kxdfhei1' USING DFHEIV0,
 20445           CERT-ID,
 20446           CERTIFICATE-MASTER,
 20447           DFHEIV11,
 20448           ELCERT-KEY,
 20449           DFHEIV99,
 20450           DFHEIV99,
 20451           DFHEIV99
 20452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20453
 20454
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 379
* EL050.cbl
 20455 8590-EXIT.
 20456     EXIT.
 20457
 20458 8690-READ-CERT-MASTER-UCL.
 20459
 20460* EXEC CICS HANDLE CONDITION
 20461*         NOTFND    (8700-READ-CERT-MASTER)
 20462*    END-EXEC.
 20463*    MOVE '"$I                   ! < #00019166' TO DFHEIV0
 20464     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20466     MOVE X'3C20233030303139313636' TO DFHEIV0(25:11)
 20467     CALL 'kxdfhei1' USING DFHEIV0
 20468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20469
 20470
 20471 8690-READ-CERT-CONT.
 20472
 20473* EXEC CICS READ
 20474*        DATASET     (CERT-ID)
 20475*        INTO        (CERTIFICATE-MASTER)
 20476*        RIDFLD      (ELCERT-KEY)
 20477*        UPDATE
 20478*    END-EXEC.
 20479     MOVE LENGTH OF
 20480      CERTIFICATE-MASTER
 20481       TO DFHEIV11
 20482*    MOVE '&"IL       EU         (   #00019171' TO DFHEIV0
 20483     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20484     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20485     MOVE X'2020233030303139313731' TO DFHEIV0(25:11)
 20486     CALL 'kxdfhei1' USING DFHEIV0,
 20487           CERT-ID,
 20488           CERTIFICATE-MASTER,
 20489           DFHEIV11,
 20490           ELCERT-KEY,
 20491           DFHEIV99,
 20492           DFHEIV99,
 20493           DFHEIV99
 20494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20495
 20496
 20497     GO TO 8590-EXIT.
 20498
 20499 8700-READ-CERT-MASTER.
 20500     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20501     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20502
 20503* EXEC CICS HANDLE CONDITION
 20504*         DUPKEY    (8720-COMP-ACCOUNTS)
 20505*         ENDFILE   (8730-END-BROWSE)
 20506*         NOTFND    (8740-NOT-FOUND)
 20507*    END-EXEC.
 20508*    MOVE '"$$''I                 ! = #00019183' TO DFHEIV0
 20509     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20510     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20511     MOVE X'3D20233030303139313833' TO DFHEIV0(25:11)
 20512     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 380
* EL050.cbl
 20513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20514
 20515
 20516
 20517* EXEC CICS STARTBR
 20518*        DATASET     ('ELCERT5')
 20519*        RIDFLD      (ELCERT2-KEY)
 20520*        EQUAL
 20521*    END-EXEC.
 20522     MOVE 'ELCERT5' TO DFHEIV1
 20523     MOVE 0
 20524       TO DFHEIV11
 20525*    MOVE '&,         E          &   #00019189' TO DFHEIV0
 20526     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20527     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20528     MOVE X'2020233030303139313839' TO DFHEIV0(25:11)
 20529     CALL 'kxdfhei1' USING DFHEIV0,
 20530           DFHEIV1,
 20531           ELCERT2-KEY,
 20532           DFHEIV99,
 20533           DFHEIV11,
 20534           DFHEIV99
 20535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20536
 20537
 20538 8710-READ-NEXT.
 20539
 20540* EXEC CICS READNEXT
 20541*        DATASET     ('ELCERT5')
 20542*        INTO        (CERTIFICATE-MASTER)
 20543*        RIDFLD      (ELCERT2-KEY)
 20544*    END-EXEC.
 20545     MOVE LENGTH OF
 20546      CERTIFICATE-MASTER
 20547       TO DFHEIV12
 20548     MOVE 'ELCERT5' TO DFHEIV1
 20549     MOVE 0
 20550       TO DFHEIV11
 20551*    MOVE '&.IL                  )   #00019196' TO DFHEIV0
 20552     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20553     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20554     MOVE X'2020233030303139313936' TO DFHEIV0(25:11)
 20555     CALL 'kxdfhei1' USING DFHEIV0,
 20556           DFHEIV1,
 20557           CERTIFICATE-MASTER,
 20558           DFHEIV12,
 20559           ELCERT2-KEY,
 20560           DFHEIV99,
 20561           DFHEIV11,
 20562           DFHEIV99,
 20563           DFHEIV99
 20564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20565
 20566
 20567 8720-COMP-ACCOUNTS.
 20568
 20569* EXEC CICS ENTER
 20570*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 381
* EL050.cbl
 20571*         FROM (PB-C-LAST-NAME)
 20572*    END-EXEC.
 20573     MOVE 001
 20574       TO DFHEIV11
 20575*    MOVE ':$F                   %   #00019203' TO DFHEIV0
 20576     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20577     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20578     MOVE X'2020233030303139323033' TO DFHEIV0(25:11)
 20579     CALL 'kxdfhei1' USING DFHEIV0,
 20580           DFHEIV11,
 20581           PB-C-LAST-NAME,
 20582           DFHEIV99,
 20583           DFHEIV99
 20584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20585
 20586
 20587
 20588* EXEC CICS ENTER
 20589*         TRACEID (002)
 20590*         FROM (CM-INSURED-LAST-NAME)
 20591*    END-EXEC.
 20592     MOVE 002
 20593       TO DFHEIV11
 20594*    MOVE ':$F                   %   #00019208' TO DFHEIV0
 20595     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20596     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20597     MOVE X'2020233030303139323038' TO DFHEIV0(25:11)
 20598     CALL 'kxdfhei1' USING DFHEIV0,
 20599           DFHEIV11,
 20600           CM-INSURED-LAST-NAME,
 20601           DFHEIV99,
 20602           DFHEIV99
 20603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20604
 20605
 20606     IF PB-CERT-NO NOT = CM-CERT-NO
 20607         GO TO 8730-END-BROWSE.
 20608
 20609     IF PB-ACCOUNT = CM-ACCOUNT
 20610         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20611             MOVE ER-2799        TO WS-ERROR
 20612             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20613             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20614             GO TO 8730-END-BROWSE.
 20615
 20616     GO TO 8710-READ-NEXT.
 20617
 20618 8730-END-BROWSE.
 20619
 20620* EXEC CICS ENDBR
 20621*         DATASET    ('ELCERT5')
 20622*    END-EXEC.
 20623     MOVE 'ELCERT5' TO DFHEIV1
 20624     MOVE 0
 20625       TO DFHEIV11
 20626*    MOVE '&2                    $   #00019226' TO DFHEIV0
 20627     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20628     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 382
* EL050.cbl
 20629     MOVE X'2020233030303139323236' TO DFHEIV0(25:11)
 20630     CALL 'kxdfhei1' USING DFHEIV0,
 20631           DFHEIV1,
 20632           DFHEIV11,
 20633           DFHEIV99
 20634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20635
 20636
 20637 8740-NOT-FOUND.
 20638     GO TO 0299-CERT-NOT-FOUND.
 20639
 20640 8750-START-ELSTAT.
 20641
 20642* EXEC CICS STARTBR
 20643*       DATASET   (STAT-ID)
 20644*       RIDFLD    (ELSTAT-KEY)
 20645*       GTEQ
 20646*       RESP      (WS-RESPONSE)
 20647*    END-EXEC
 20648     MOVE 0
 20649       TO DFHEIV11
 20650*    MOVE '&,         G          &  N#00019234' TO DFHEIV0
 20651     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20652     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20653     MOVE X'204E233030303139323334' TO DFHEIV0(25:11)
 20654     CALL 'kxdfhei1' USING DFHEIV0,
 20655           STAT-ID,
 20656           ELSTAT-KEY,
 20657           DFHEIV99,
 20658           DFHEIV11,
 20659           DFHEIV99
 20660     MOVE EIBRESP  TO WS-RESPONSE
 20661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20662     IF WS-RESP-NORMAL
 20663        MOVE 'Y'                 TO STAT-MASTER-SW
 20664     ELSE
 20665        MOVE 'N'                 TO STAT-MASTER-SW
 20666     END-IF
 20667     .
 20668 8750-EXIT.
 20669     EXIT.
 20670 8752-READ-ELSTAT.
 20671
 20672* EXEC CICS READNEXT
 20673*       DATASET   (STAT-ID)
 20674*       RIDFLD    (ELSTAT-KEY)
 20675*       INTO      (STATE-FILE)
 20676*       RESP      (WS-RESPONSE)
 20677*    END-EXEC
 20678     MOVE LENGTH OF
 20679      STATE-FILE
 20680       TO DFHEIV12
 20681     MOVE 0
 20682       TO DFHEIV11
 20683*    MOVE '&.IL                  )  N#00019249' TO DFHEIV0
 20684     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20685     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20686     MOVE X'204E233030303139323439' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 383
* EL050.cbl
 20687     CALL 'kxdfhei1' USING DFHEIV0,
 20688           STAT-ID,
 20689           STATE-FILE,
 20690           DFHEIV12,
 20691           ELSTAT-KEY,
 20692           DFHEIV99,
 20693           DFHEIV11,
 20694           DFHEIV99,
 20695           DFHEIV99
 20696     MOVE EIBRESP  TO WS-RESPONSE
 20697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20698     IF WS-RESP-NORMAL
 20699        MOVE 'Y'                 TO STAT-MASTER-SW
 20700     ELSE
 20701        MOVE 'N'                 TO STAT-MASTER-SW
 20702     END-IF
 20703     .
 20704 8752-EXIT.
 20705     EXIT.
 20706 8800-GET-COMP-RATE.
 20707     MOVE +1 TO IB.
 20708     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20709         ADD +9 TO IB
 20710         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20711             ADD +9 TO IB
 20712             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20713                MOVE ZEROS       TO WS-WK-RATE
 20714                GO TO 8800-EXIT.
 20715
 20716     IF PB-I-AGE GREATER CT-AGE (1)
 20717         ADD +3 TO IB
 20718         IF PB-I-AGE GREATER CT-AGE (2)
 20719             ADD +3 TO IB
 20720             IF PB-I-AGE GREATER CT-AGE (3)
 20721                MOVE ZEROS       TO WS-WK-RATE
 20722                GO TO 8800-EXIT.
 20723
 20724     IF WS-WORK-TERM GREATER CT-TRM (1)
 20725         ADD +1 TO IB
 20726         IF WS-WORK-TERM GREATER CT-TRM (2)
 20727             ADD +1 TO IB
 20728             IF WS-WORK-TERM GREATER CT-TRM (3)
 20729                MOVE ZEROS       TO WS-WK-RATE
 20730                GO TO 8800-EXIT.
 20731
 20732     IF CT-RT (IB) NOT NUMERIC
 20733         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20734         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20735         GO TO 8800-GET-COMP-RATE.
 20736
 20737     MOVE CT-RT (IB) TO WS-WK-RATE.
 20738
 20739 8800-EXIT.
 20740     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 384
* EL050.cbl
 20742 8900-ADDRESS-FILE.
 20743     IF ERACCT-FILE-ADDRESSED
 20744         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20745         GO TO 8900-ADDRESS-EXIT.
 20746
 20747     IF ELCNTL-FILE-ADDRESSED
 20748         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20749         GO TO 8900-ADDRESS-EXIT.
 20750
 20751     IF ERPLAN-FILE-ADDRESSED
 20752         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20753         GO TO 8900-ADDRESS-EXIT.
 20754
 20755     IF ERFORM-FILE-ADDRESSED
 20756         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20757         GO TO 8900-ADDRESS-EXIT.
 20758
 20759 8900-ADDRESS-EXIT.
 20760     EXIT.
 20761
 20762 9000-READ-CONTROL.
 20763
 20764* EXEC CICS HANDLE CONDITION
 20765*        NOTFND    (9000-NOTFND)
 20766*    END-EXEC.
 20767*    MOVE '"$I                   ! > #00019320' TO DFHEIV0
 20768     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20769     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20770     MOVE X'3E20233030303139333230' TO DFHEIV0(25:11)
 20771     CALL 'kxdfhei1' USING DFHEIV0
 20772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20773
 20774
 20775
 20776* EXEC CICS READ
 20777*        DATASET     (CNTL-ID)
 20778*        SET         (ADDRESS OF CONTROL-FILE)
 20779*        RIDFLD      (ELCNTL-KEY)
 20780*        GTEQ
 20781*    END-EXEC.
 20782*    MOVE '&"S        G          (   #00019324' TO DFHEIV0
 20783     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20784     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20785     MOVE X'2020233030303139333234' TO DFHEIV0(25:11)
 20786     CALL 'kxdfhei1' USING DFHEIV0,
 20787           CNTL-ID,
 20788           DFHEIV20,
 20789           DFHEIV99,
 20790           ELCNTL-KEY,
 20791           DFHEIV99,
 20792           DFHEIV99,
 20793           DFHEIV99
 20794     SET ADDRESS OF CONTROL-FILE TO
 20795         DFHEIV20
 20796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20797
 20798
 20799     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 385
* EL050.cbl
 20800
 20801 9000-NOTFND.
 20802     IF RC-SW-1 = '1'
 20803        MOVE ER-2616              TO WS-ERROR
 20804        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20805        GO TO 9000-EXIT.
 20806
 20807     IF RC-SW-1 = '2'
 20808        MOVE ER-2602              TO WS-ERROR
 20809        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20810
 20811 9000-EXIT.
 20812      EXIT.
 20813
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 386
* EL050.cbl
 20815 9100-READ-CONTROL.
 20816
 20817* EXEC CICS HANDLE CONDITION
 20818*        NOTFND  (9100-NOTFND)
 20819*        ENDFILE (9100-NOTFND)
 20820*    END-EXEC.
 20821*    MOVE '"$I''                  ! ? #00019348' TO DFHEIV0
 20822     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20823     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20824     MOVE X'3F20233030303139333438' TO DFHEIV0(25:11)
 20825     CALL 'kxdfhei1' USING DFHEIV0
 20826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20827
 20828
 20829
 20830* EXEC CICS READ
 20831*        DATASET     (CNTL-ID)
 20832*        INTO        (CONTROL-FILE)
 20833*        RIDFLD      (ELCNTL-KEY)
 20834*        GTEQ
 20835*    END-EXEC.
 20836     MOVE LENGTH OF
 20837      CONTROL-FILE
 20838       TO DFHEIV11
 20839*    MOVE '&"IL       G          (   #00019353' TO DFHEIV0
 20840     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20841     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20842     MOVE X'2020233030303139333533' TO DFHEIV0(25:11)
 20843     CALL 'kxdfhei1' USING DFHEIV0,
 20844           CNTL-ID,
 20845           CONTROL-FILE,
 20846           DFHEIV11,
 20847           ELCNTL-KEY,
 20848           DFHEIV99,
 20849           DFHEIV99,
 20850           DFHEIV99
 20851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20852
 20853
 20854     GO TO 9100-EXIT.
 20855
 20856 9100-NOTFND.
 20857     IF RC-SW-2 = '0'
 20858        MOVE '1'                  TO STATE-RECORD-ERROR
 20859        GO TO 9100-EXIT
 20860     END-IF
 20861     IF RC-SW-2 = '1'
 20862        MOVE '1'                  TO LF-BENEFIT-ERROR
 20863        MOVE ER-2604              TO WS-ERROR
 20864        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20865        GO TO 9100-EXIT.
 20866
 20867     IF RC-SW-2 = '2'
 20868        MOVE '1'                  TO AH-BENEFIT-ERROR
 20869        MOVE ER-2605              TO WS-ERROR
 20870        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20871        GO TO 9100-EXIT.
 20872
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 387
* EL050.cbl
 20873     IF RC-SW-2 = '3'
 20874         MOVE ER-2603           TO WS-ERROR
 20875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20876         GO TO 9100-EXIT.
 20877
 20878     IF RC-SW-2 = '4'
 20879         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20880         GO TO 9100-EXIT.
 20881
 20882     IF RC-SW-2 = '5'
 20883         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20884         IF WS-AH-INPUT-CD-1 = SPACE
 20885             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20886         ELSE
 20887             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20888
 20889 9100-EXIT.
 20890      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 388
* EL050.cbl
 20892 9200-CONTROL-GETMAIN.
 20893
 20894* EXEC CICS GETMAIN
 20895*         LENGTH   (750)
 20896*         SET      (ADDRESS OF CONTROL-FILE)
 20897*    END-EXEC.
 20898     MOVE 750
 20899       TO DFHEIV11
 20900*    MOVE '," L                  $   #00019399' TO DFHEIV0
 20901     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20902     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20903     MOVE X'2020233030303139333939' TO DFHEIV0(25:11)
 20904     CALL 'kxdfhei1' USING DFHEIV0,
 20905           DFHEIV20,
 20906           DFHEIV11,
 20907           DFHEIV99
 20908     SET ADDRESS OF CONTROL-FILE TO
 20909         DFHEIV20
 20910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20911
 20912
 20913     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20914
 20915 9200-EXIT.
 20916     EXIT.
 20917
 20918 9250-UNLOCK-RETURN.
 20919
 20920* EXEC CICS UNLOCK
 20921*        DATASET   (CERT-ID)
 20922*    END-EXEC.
 20923*    MOVE '&*                    #   #00019410' TO DFHEIV0
 20924     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20925     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20926     MOVE X'2020233030303139343130' TO DFHEIV0(25:11)
 20927     CALL 'kxdfhei1' USING DFHEIV0,
 20928           CERT-ID,
 20929           DFHEIV99
 20930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20931
 20932
 20933 9300-ABEND.
 20934     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20935
 20936
 20937* EXEC CICS LINK
 20938*        PROGRAM   ('EL004')
 20939*        COMMAREA  (WS-ERROR-LINE)
 20940*        LENGTH    (72)
 20941*    END-EXEC.
 20942     MOVE 'EL004' TO DFHEIV1
 20943     MOVE 72
 20944       TO DFHEIV11
 20945*    MOVE '."C                   (   #00019417' TO DFHEIV0
 20946     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20948     MOVE X'2020233030303139343137' TO DFHEIV0(25:11)
 20949     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 389
* EL050.cbl
 20950           DFHEIV1,
 20951           WS-ERROR-LINE,
 20952           DFHEIV11,
 20953           DFHEIV99,
 20954           DFHEIV99,
 20955           DFHEIV99,
 20956           DFHEIV99
 20957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20958
 20959
 20960     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 20961
 20962
 20963* EXEC CICS ABEND
 20964*        ABCODE ('EL50')
 20965*    END-EXEC.
 20966     MOVE 'EL50' TO DFHEIV5
 20967*    MOVE '.,A                   "   #00019425' TO DFHEIV0
 20968     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 20969     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 20970     MOVE X'2020233030303139343235' TO DFHEIV0(25:11)
 20971     CALL 'kxdfhei1' USING DFHEIV0,
 20972           DFHEIV5
 20973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20974
 20975
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 390
* EL050.cbl
 20977
 20978******************************************************************
 20979*                                                                *
 20980*            E R R O R   F O R M A T   R O U T I N E             *
 20981*                                                                *
 20982******************************************************************
 20983
 20984 9900-ERROR-FORMAT.
 20985
 20986     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 20987                    PB-COMMON-ERROR (2) OR
 20988                    PB-COMMON-ERROR (3) OR
 20989                    PB-COMMON-ERROR (4) OR
 20990                    PB-COMMON-ERROR (5) OR
 20991                    PB-COMMON-ERROR (6) OR
 20992                    PB-COMMON-ERROR (7) OR
 20993                    PB-COMMON-ERROR (8) OR
 20994                    PB-COMMON-ERROR (9) OR
 20995                    PB-COMMON-ERROR (10)
 20996        GO TO 9900-EXIT.
 20997
 20998     IF PB-NO-OF-ERRORS = +10
 20999        GO TO 9900-EXIT.
 21000
 21001     ADD +1  TO PB-NO-OF-ERRORS.
 21002     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21003                                       (PB-NO-OF-ERRORS).
 21004 9900-EXIT.
 21005     EXIT.
 21006
 21007 9990-RETURN.
 21008     IF BROWSE-STARTED
 21009
 21010* EXEC CICS ENDBR
 21011*            DATASET  (ACCT-ID)
 21012*       END-EXEC.
 21013     MOVE 0
 21014       TO DFHEIV11
 21015*    MOVE '&2                    $   #00019462' TO DFHEIV0
 21016     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21017     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21018     MOVE X'2020233030303139343632' TO DFHEIV0(25:11)
 21019     CALL 'kxdfhei1' USING DFHEIV0,
 21020           ACCT-ID,
 21021           DFHEIV11,
 21022           DFHEIV99
 21023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21024
 21025
 21026 9990-EXIT.
 21027     EXIT.
 21028
 21029
 21030****Check for CRTO record, add one if not found.
 21031 9991-CHECK-FOR-ELCRTO.
 21032
 21033* EXEC CICS HANDLE CONDITION
 21034*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 391
* EL050.cbl
 21035*         ENDFILE (9991-CRTO-NOT-FOUND)
 21036*     END-EXEC.
 21037*    MOVE '"$I''                  ! @ #00019472' TO DFHEIV0
 21038     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21039     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21040     MOVE X'4020233030303139343732' TO DFHEIV0(25:11)
 21041     CALL 'kxdfhei1' USING DFHEIV0
 21042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21043
 21044     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21045     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21046     MOVE +0                     TO ELCRTO-SEQ-NO
 21047
 21048
 21049* EXEC CICS READ
 21050*       DATASET   ('ELCRTO')
 21051*       INTO      (ORIGINAL-CERTIFICATE)
 21052*       RIDFLD    (ELCRTO-KEY)
 21053*       GTEQ
 21054*       RESP      (WS-RESPONSE)
 21055*    END-EXEC
 21056     MOVE LENGTH OF
 21057      ORIGINAL-CERTIFICATE
 21058       TO DFHEIV11
 21059     MOVE 'ELCRTO' TO DFHEIV1
 21060*    MOVE '&"IL       G          (  N#00019480' TO DFHEIV0
 21061     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21062     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21063     MOVE X'204E233030303139343830' TO DFHEIV0(25:11)
 21064     CALL 'kxdfhei1' USING DFHEIV0,
 21065           DFHEIV1,
 21066           ORIGINAL-CERTIFICATE,
 21067           DFHEIV11,
 21068           ELCRTO-KEY,
 21069           DFHEIV99,
 21070           DFHEIV99,
 21071           DFHEIV99
 21072     MOVE EIBRESP  TO WS-RESPONSE
 21073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21074
 21075     IF WS-RESP-NORMAL
 21076        AND (OC-CONTROL-PRIMARY (1:33) =
 21077                 PB-CONTROL-BY-ACCOUNT (1:33))
 21078        AND (OC-RECORD-TYPE =  'I')
 21079           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21080               GO TO 9991-EXIT
 21081           ELSE
 21082               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21083               GO TO 9991-CRTO-ADD-REC
 21084           END-IF
 21085     END-IF.
 21086
 21087 9991-CRTO-NOT-FOUND.
 21088
 21089     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21090     MOVE 'OC'                TO OC-RECORD-ID
 21091     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21092                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 392
* EL050.cbl
 21093     MOVE +4096               TO OC-KEY-SEQ-NO.
 21094
 21095 9991-CRTO-ADD-REC.
 21096
 21097     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21098     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21099     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21100     MOVE 'I'                 TO OC-RECORD-TYPE
 21101     IF PB-ISSUE
 21102         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21103         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21104         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21105         MOVE PB-I-AGE               TO OC-INS-AGE
 21106         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21107         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21108         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21109         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21110         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21111         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21112         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21113         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21114         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21115         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21116         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21117         IF PB-I-JOINT-COMMISSION > +0
 21118             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21119         ELSE
 21120             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21121         END-IF
 21122         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21123         MOVE +0                     TO OC-LF-CANCEL-AMT
 21124                                        OC-LF-ITD-CANCEL-AMT
 21125         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21126         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21127         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21128         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21129         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21130         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21131         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21132         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21133         MOVE +0                     TO OC-AH-CANCEL-AMT
 21134                                        OC-AH-ITD-CANCEL-AMT
 21135         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21136     ELSE
 21137         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21138         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21139         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21140         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21141         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21142         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21143         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21144         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21145         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21146          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21147             MOVE SPACES             TO OC-LF-BENCD
 21148             MOVE ZEROS              TO OC-LF-TERM
 21149                                        OC-LF-BEN-AMT
 21150                                        OC-LF-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 393
* EL050.cbl
 21151                                        OC-LF-ALT-BEN-AMT
 21152                                        OC-LF-ALT-PRM-AMT
 21153                                        OC-LF-COMM-PCT
 21154                                        OC-LF-CANCEL-AMT
 21155             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21156             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21157         ELSE
 21158             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21159             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21160             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21161             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21162             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21163             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21164             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21165             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21166             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21167             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21168         END-IF
 21169         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21170         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21171          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21172             MOVE SPACES             TO OC-AH-BENCD
 21173             MOVE ZEROS              TO OC-AH-TERM
 21174                                        OC-AH-BEN-AMT
 21175                                        OC-AH-PRM-AMT
 21176                                        OC-AH-COMM-PCT
 21177                                        OC-AH-CANCEL-AMT
 21178                                        OC-AH-CP
 21179             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21180             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21181         ELSE
 21182             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21183             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21184             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21185             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21186             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21187             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21188             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21189             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21190             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21191         END-IF
 21192         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21193         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21194     END-IF
 21195     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21196
 21197     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21198
 21199
 21200* EXEC CICS READ
 21201*         DATASET   (FILE-ERMAIL)
 21202*         RIDFLD    (MA-CONTROL-PRIMARY)
 21203*         INTO      (MAILING-DATA)
 21204*         RESP      (WS-RESPONSE)
 21205*    END-EXEC
 21206     MOVE LENGTH OF
 21207      MAILING-DATA
 21208       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 394
* EL050.cbl
 21209*    MOVE '&"IL       E          (  N#00019612' TO DFHEIV0
 21210     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21211     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21212     MOVE X'204E233030303139363132' TO DFHEIV0(25:11)
 21213     CALL 'kxdfhei1' USING DFHEIV0,
 21214           FILE-ERMAIL,
 21215           MAILING-DATA,
 21216           DFHEIV11,
 21217           MA-CONTROL-PRIMARY,
 21218           DFHEIV99,
 21219           DFHEIV99,
 21220           DFHEIV99
 21221     MOVE EIBRESP  TO WS-RESPONSE
 21222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21223
 21224     IF WS-RESP-NORMAL
 21225         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21226     END-IF.
 21227
 21228     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21229     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21230
 21231
 21232* EXEC CICS READ
 21233*         DATASET  (CRTT-ID)
 21234*         RIDFLD   (WS-ELCRTT-KEY)
 21235*         INTO     (CERTIFICATE-TRAILERS)
 21236*         RESP     (WS-RESPONSE)
 21237*    END-EXEC
 21238     MOVE LENGTH OF
 21239      CERTIFICATE-TRAILERS
 21240       TO DFHEIV11
 21241*    MOVE '&"IL       E          (  N#00019626' TO DFHEIV0
 21242     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21244     MOVE X'204E233030303139363236' TO DFHEIV0(25:11)
 21245     CALL 'kxdfhei1' USING DFHEIV0,
 21246           CRTT-ID,
 21247           CERTIFICATE-TRAILERS,
 21248           DFHEIV11,
 21249           WS-ELCRTT-KEY,
 21250           DFHEIV99,
 21251           DFHEIV99,
 21252           DFHEIV99
 21253     MOVE EIBRESP  TO WS-RESPONSE
 21254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21255
 21256     IF WS-RESP-NORMAL
 21257         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21258         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21259     END-IF.
 21260
 21261
 21262* EXEC CICS WRITE
 21263*       DATASET   ('ELCRTO')
 21264*       FROM      (ORIGINAL-CERTIFICATE)
 21265*       RIDFLD    (OC-CONTROL-PRIMARY)
 21266*       RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 395
* EL050.cbl
 21267*    END-EXEC.
 21268     MOVE LENGTH OF
 21269      ORIGINAL-CERTIFICATE
 21270       TO DFHEIV11
 21271     MOVE 'ELCRTO' TO DFHEIV1
 21272*    MOVE '&$ L                  ''  N#00019638' TO DFHEIV0
 21273     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21274     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21275     MOVE X'204E233030303139363338' TO DFHEIV0(25:11)
 21276     CALL 'kxdfhei1' USING DFHEIV0,
 21277           DFHEIV1,
 21278           ORIGINAL-CERTIFICATE,
 21279           DFHEIV11,
 21280           OC-CONTROL-PRIMARY,
 21281           DFHEIV99,
 21282           DFHEIV99
 21283     MOVE EIBRESP  TO WS-RESPONSE
 21284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21285
 21286
 21287 9991-EXIT.
 21288     EXIT.
 21289
 21290
 21291 9999-RETURN.
 21292     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21293
 21294
 21295* EXEC CICS RETURN
 21296*    END-EXEC.
 21297*    MOVE '.(                    ''   #00019652' TO DFHEIV0
 21298     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21299     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21300     MOVE X'2020233030303139363532' TO DFHEIV0(25:11)
 21301     CALL 'kxdfhei1' USING DFHEIV0,
 21302           DFHEIV99,
 21303           DFHEIV99,
 21304           DFHEIV99,
 21305           DFHEIV99,
 21306           DFHEIV99,
 21307           DFHEIV99
 21308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21309
 21310
 21311
 21312* GOBACK.
 21313     MOVE '9%                    "   ' TO DFHEIV0
 21314     MOVE 'EL050' TO DFHEIV1
 21315     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21316     GOBACK.
 21317
 21318 9999-DFHBACK SECTION.
 21319     MOVE '9%                    "   ' TO DFHEIV0
 21320     MOVE 'EL050' TO DFHEIV1
 21321     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21322     GOBACK.
 21323 9999-DFHEXIT.
 21324     IF DFHEIGDJ EQUAL 0001
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 396
* EL050.cbl
 21325         NEXT SENTENCE
 21326     ELSE IF DFHEIGDJ EQUAL 2
 21327         GO TO 9300-ABEND,
 21328               3990-FILES-NOT-OPEN
 21329         DEPENDING ON DFHEIGDI
 21330     ELSE IF DFHEIGDJ EQUAL 3
 21331         GO TO 6610-START-BROWSE,
 21332               6630-ERRESS-PROBLEM,
 21333               6630-END-OF-FILE
 21334         DEPENDING ON DFHEIGDI
 21335     ELSE IF DFHEIGDJ EQUAL 4
 21336         GO TO 6630-END-OF-FILE,
 21337               6630-ERRESS-PROBLEM,
 21338               6630-ERRESS-PROBLEM,
 21339               6630-END-OF-FILE
 21340         DEPENDING ON DFHEIGDI
 21341     ELSE IF DFHEIGDJ EQUAL 5
 21342         GO TO 6630-END-OF-FILE,
 21343               6630-END-OF-FILE,
 21344               6630-ERRESS-PROBLEM,
 21345               6630-ERRESS-PROBLEM
 21346         DEPENDING ON DFHEIGDI
 21347     ELSE IF DFHEIGDJ EQUAL 6
 21348         GO TO 6660-START-BROWSE,
 21349               6690-ERRESC-PROBLEM,
 21350               6690-ERRESC-PROBLEM,
 21351               6690-END-OF-FILE
 21352         DEPENDING ON DFHEIGDI
 21353     ELSE IF DFHEIGDJ EQUAL 7
 21354         GO TO 6690-END-OF-FILE,
 21355               6690-ERRESC-PROBLEM,
 21356               6690-ERRESC-PROBLEM,
 21357               6690-END-OF-FILE
 21358         DEPENDING ON DFHEIGDI
 21359     ELSE IF DFHEIGDJ EQUAL 8
 21360         GO TO 6690-END-OF-FILE,
 21361               6690-ERRESC-PROBLEM,
 21362               6690-ERRESC-PROBLEM,
 21363               6690-END-OF-FILE
 21364         DEPENDING ON DFHEIGDI
 21365     ELSE IF DFHEIGDJ EQUAL 9
 21366         GO TO 7250-CONTINUE,
 21367               7250-CONTINUE
 21368         DEPENDING ON DFHEIGDI
 21369     ELSE IF DFHEIGDJ EQUAL 10
 21370         GO TO 7300-CONTINUE,
 21371               7300-CONTINUE
 21372         DEPENDING ON DFHEIGDI
 21373     ELSE IF DFHEIGDJ EQUAL 11
 21374         GO TO 8000-FREE-MAIN
 21375         DEPENDING ON DFHEIGDI
 21376     ELSE IF DFHEIGDJ EQUAL 12
 21377         GO TO 8100-NOTFND,
 21378               8100-NOTFND
 21379         DEPENDING ON DFHEIGDI
 21380     ELSE IF DFHEIGDJ EQUAL 13
 21381         GO TO 8110-NOTFND,
 21382               8110-NOTFND
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 397
* EL050.cbl
 21383         DEPENDING ON DFHEIGDI
 21384     ELSE IF DFHEIGDJ EQUAL 14
 21385         GO TO 8130-EXIT
 21386         DEPENDING ON DFHEIGDI
 21387     ELSE IF DFHEIGDJ EQUAL 15
 21388         GO TO 8180-NOTFND
 21389         DEPENDING ON DFHEIGDI
 21390     ELSE IF DFHEIGDJ EQUAL 16
 21391         GO TO 8190-NOTFND
 21392         DEPENDING ON DFHEIGDI
 21393     ELSE IF DFHEIGDJ EQUAL 17
 21394         GO TO 8195-NOTFND
 21395         DEPENDING ON DFHEIGDI
 21396     ELSE IF DFHEIGDJ EQUAL 18
 21397         GO TO 8200-NOTFND
 21398         DEPENDING ON DFHEIGDI
 21399     ELSE IF DFHEIGDJ EQUAL 19
 21400         GO TO 8300-NOTFND,
 21401               8300-ERRESS-PROBLEM,
 21402               8300-ERRESS-PROBLEM,
 21403               8300-NOTFND
 21404         DEPENDING ON DFHEIGDI
 21405     ELSE IF DFHEIGDJ EQUAL 20
 21406         GO TO 8450-FORM-NOT-FOUND,
 21407               8450-FORM-NOT-FOUND
 21408         DEPENDING ON DFHEIGDI
 21409     ELSE IF DFHEIGDJ EQUAL 21
 21410         GO TO 0199-ACCT-NOT-FOUND,
 21411               0199-ACCT-NOT-FOUND
 21412         DEPENDING ON DFHEIGDI
 21413     ELSE IF DFHEIGDJ EQUAL 22
 21414         GO TO 0199-ACCT-NOT-FOUND,
 21415               0199-ACCT-NOT-FOUND
 21416         DEPENDING ON DFHEIGDI
 21417     ELSE IF DFHEIGDJ EQUAL 23
 21418         GO TO 8582-COMP-NOT-FOUND,
 21419               8582-COMP-NOT-FOUND
 21420         DEPENDING ON DFHEIGDI
 21421     ELSE IF DFHEIGDJ EQUAL 24
 21422         GO TO 8583-AGTC-NOT-FOUND,
 21423               8583-AGTC-NOT-FOUND
 21424         DEPENDING ON DFHEIGDI
 21425     ELSE IF DFHEIGDJ EQUAL 25
 21426         GO TO 8584-BXRF-NOT-FOUND,
 21427               8584-BXRF-NOT-FOUND
 21428         DEPENDING ON DFHEIGDI
 21429     ELSE IF DFHEIGDJ EQUAL 26
 21430         GO TO 8585-PLAN-NOT-FOUND,
 21431               8585-PLAN-NOT-FOUND
 21432         DEPENDING ON DFHEIGDI
 21433     ELSE IF DFHEIGDJ EQUAL 27
 21434         GO TO 0299-CERT-NOT-FOUND
 21435         DEPENDING ON DFHEIGDI
 21436     ELSE IF DFHEIGDJ EQUAL 28
 21437         GO TO 8700-READ-CERT-MASTER
 21438         DEPENDING ON DFHEIGDI
 21439     ELSE IF DFHEIGDJ EQUAL 29
 21440         GO TO 8720-COMP-ACCOUNTS,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:57 Page 398
* EL050.cbl
 21441               8730-END-BROWSE,
 21442               8740-NOT-FOUND
 21443         DEPENDING ON DFHEIGDI
 21444     ELSE IF DFHEIGDJ EQUAL 30
 21445         GO TO 9000-NOTFND
 21446         DEPENDING ON DFHEIGDI
 21447     ELSE IF DFHEIGDJ EQUAL 31
 21448         GO TO 9100-NOTFND,
 21449               9100-NOTFND
 21450         DEPENDING ON DFHEIGDI
 21451     ELSE IF DFHEIGDJ EQUAL 32
 21452         GO TO 9991-CRTO-NOT-FOUND,
 21453               9991-CRTO-NOT-FOUND
 21454         DEPENDING ON DFHEIGDI.
 21455     MOVE '9%                    "   ' TO DFHEIV0
 21456     MOVE 'EL050' TO DFHEIV1
 21457     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21458     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39984     Code:       86322
