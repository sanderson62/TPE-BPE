* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   1
* SOCK03.cbl
* Options: int("SOCK03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK03.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   2
* SOCK03.cbl
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35******************************************************************
    36*                   C H A N G E   L O G
    37*
    38* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    39*-----------------------------------------------------------------
    40*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    41* EFFECTIVE    NUMBER
    42*-----------------------------------------------------------------
    43* 071112  IR2012042700001  PEMA  AHL CHANGES
    44* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
    45* 010213  CR2011083000005  PEMA  ADD SPECIAL DCC SPP DDF REFUND
    46* 101813  IR2013101700003  PEMA  FIX MN Net Balloon calc.
    47* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    48* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    49* 072415  IR2015071500003  PEMA  REMOVE CLOSE STATEMENT
    50* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    51******************************************************************
    52 environment division.
    53 data division.
    54 working-storage section.
    55 01  DFH-START PIC X(04).
    56*
    57* program buffers
    58*
    59 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    60     88  ALREADY-SENT              VALUE 'Y'.
    61 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    62 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    63     88  ELCERT-FINISHED            VALUE 'Y'.
    64 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    65 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    66     88  ERACCT-FOUND               VALUE 'Y'.
    67 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    68 77 ws-send-msg-size           pic s9(8) comp value 4096.
    69 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    70 77 ws-recv-buf                pic x(4096).
    71 77 ws-send-buf                pic x(4096) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   3
* SOCK03.cbl
    72 77 ws-recv-total              pic s9(8) comp value 0.
    73 77 ws-recv-left               pic s9(8) comp value 0.
    74 77 ws-seq-num                 pic s9(8) comp value 0.
    75 77 ws-flags                   pic s9(8) comp value 0.
    76 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    77 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    78 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    79 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    80 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    81 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    82 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    83 77  ws-cancel-reason            pic x   value spaces.
    84 77  P1                          PIC S999 COMP-3 VALUE +0.
    85 77  P2                          PIC S999 COMP-3 VALUE +0.
    86 77  C0                          PIC S999 COMP-3 VALUE +0.
    87 77  C1                          PIC S999 COMP-3 VALUE +0.
    88 77  C2                          PIC S999 COMP-3 VALUE +0.
    89 77  C3                          PIC S999 COMP-3 VALUE +0.
    90 77 S1                           PIC S999 COMP-3 VALUE +0.
    91 77 S2                           PIC S999 COMP-3 VALUE +0.
    92 77 L1                           PIC S999 COMP-3 VALUE +0.
    93 77 L2                           PIC S999 COMP-3 VALUE +0.
    94 77 F1                           PIC S999 COMP-3 VALUE +0.
    95 77 WS-BUILD-SW                  PIC X.
    96    88  TIME-TO-BUILD               VALUE 'Y'.
    97 77 WS-SAVE-ERACCT               PIC X(2000).
    98 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    99 77 WS-STOP-SW                   PIC X  VALUE ' '.
   100    88  TOLD-TO-STOP               VALUE 'Y'.
   101 77 WS-PERFORM-SW                PIC X VALUE SPACES.
   102    88  GET-RATES                    VALUE 'R'.
   103    88  GET-ACT-ACCTS                VALUE 'A'.
   104 77 ws-bin-1st-pay-dt            pic xx  value low-values.
   105 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
   106 77 ws-disp-rate                 pic z9.99999.
   107 77  WS-ERCTBL-SW                PIC X VALUE ' '.
   108     88  END-OF-ERCTBL                 VALUE 'Y'.
   109 77  WS-STATUS                   PIC X.
   110 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
   111 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
   112 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
   113 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
   114 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   115 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   116 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   117 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   118 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   119 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   120 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
   121 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
   122     88  WS-ELCERT-FULL             VALUE '1'.
   123     88  WS-ELCERT-NAME             VALUE '2'.
   124     88  WS-ELCERT-CERT-NO          VALUE '3'.
   125     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   126 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   127 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   128     88  I-SAY-TO-STOP      VALUE 'Y'.
   129 77  WS-HEX-0A                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   4
* SOCK03.cbl
   130 77  WS-CALL-TYPE                PIC X(6).
   131 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   132 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   133 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   134 77  DD-IU-SW                    PIC X   VALUE ' '.
   135     88  DD-IU-PRESENT                 VALUE 'Y'.
   136 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   137 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   138 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   139 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   140 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   141 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   142 77  ws-ah-rfnd-clp              pic s9(7)v99 comp-3 value +0.
   143 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   144 77  WS-PDEF-RECORD-SW           PIC X           VALUE ' '.
   145     88  PDEF-FOUND                              VALUE 'Y'.
   146 77  ws-epiq-sw                  pic x  value ' '.
   147     88  ws-epiq-request           value 'Y'.
   148 77  ws-epiq-max                 pic s999 value +0 comp-3.
   149 01  WS-STRING-DATA.
   150     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   151     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   152     05  WS-CARRIER              PIC X        VALUE SPACES.
   153     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   154     05  WS-STATE                PIC XX       VALUE SPACES.
   155     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   156     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   157     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   158     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   159     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   160     05  WS-MID-INIT             PIC X        VALUE SPACES.
   161     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   162     05  WS-LF-COVERAGE-TYPE     PIC X        VALUE SPACES.
   163     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   164     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   165     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   166     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   167     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   168     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   169     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   170     05  WS-LF-METHOD            PIC X(10)    VALUE SPACES.
   171     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   172     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
   173     05  WS-AH-COVERAGE-TYPE     PIC X        VALUE SPACES.
   174     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   175     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   176     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   177     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   178     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   179     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   180     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   181     05  WS-AH-METHOD            PIC X(10)    VALUE SPACES.
   182     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   183     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   184     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   185     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   186     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   187     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   5
* SOCK03.cbl
   188     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   189     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   190     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   191     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   192     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   193     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   194     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   195     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   196     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   197     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   198     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   199     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   200 01  ws-work-date.
   201     05  ws-work-ccyy            pic x(4).
   202     05  ws-work-mm              pic xx.
   203     05  ws-work-dd              pic xx.
   204 01  ws-work-date-num redefines ws-work-date
   205                                 pic 9(8).
   206 01  FILLER.
   207     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   208     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   209     12  WS-STATE-ABBREVIATION   PIC XX.
   210     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   211     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   212     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   213     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   214     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   215     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   216     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   217     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   218     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   219     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   220     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   221     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   222     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   223     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   224     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   225     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   226     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   227     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   228     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   229     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   230     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   231     12  WS-LF-OVERRIDE-L1       PIC  X(01).
   232     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   233     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   234     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   235     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   236         88  WS-REDUCING                         VALUE 'R'.
   237         88  WS-LEVEL                            VALUE 'L'  'P'.
   238 01  ELMSTR-KEY.
   239     12  ELMSTR-COMP-CD          PIC X.
   240     12  ELMSTR-CERT-NO          PIC X(11).
   241 01  CTBL-KEY-SAVE               PIC X(5).
   242 01  CTBL-KEY.
   243     05  CTBL-COMPANY-CD         PIC X.
   244     05  CTBL-TABLE              PIC XXX.
   245     05  CTBL-BEN-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   6
* SOCK03.cbl
   246     05  CTBL-BEN-CODE           PIC XX.
   247 01  ERPDEF-KEY-SAVE             PIC X(18).
   248 01  ERPDEF-KEY.
   249     12  ERPDEF-COMPANY-CD       PIC X.
   250     12  ERPDEF-STATE            PIC XX.
   251     12  ERPDEF-PROD-CD          PIC XXX.
   252     12  F                       PIC X(7).
   253     12  ERPDEF-BEN-TYPE         PIC X.
   254     12  ERPDEF-BEN-CODE         PIC XX.
   255     12  ERPDEF-EXP-DT           PIC XX.
   256 01  WS-AM3-KEY.
   257     12  WS-AM3-ACCOUNT          PIC X(10).
   258     12  WS-AM3-EXP-DT           PIC XX.
   259 01  WS-AM-KEY.
   260     12  WS-AM-COMPANY-CD        PIC X.
   261     12  WS-AM-CARRIER           PIC X.
   262     12  WS-AM-GROUPING          PIC X(6).
   263     12  WS-AM-STATE             PIC XX.
   264     12  WS-AM-ACCOUNT           PIC X(10).
   265     12  WS-AM-EXPIRATION-DT     PIC XX.
   266     12  WS-AM-FILLER            PIC XXXX.
   267 01  WS-CO-DATA.
   268     05  WS-CO-NUM               PIC X(10).
   269     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   270     05  WS-CO-NAME              PIC X(30).
   271     05  WS-CO-MAIL-NAME         PIC X(30).
   272     05  WS-CO-ADDR1             PIC X(30).
   273     05  WS-CO-ADDR2             PIC X(30).
   274     05  WS-CO-ADDR3             PIC X(30).
   275     05  WS-CO-ZIP               PIC X(9).
   276     05  WS-CO-PHONE             PIC X(10).
   277 01  WS-CF-KEY.
   278     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   279     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   280*        88  COMPANY-MASTER                      VALUE '1'.
   281*        88  STATE-MASTER                        VALUE '3'.
   282*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   283*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   284     12  WS-CF-ACCESS.
   285         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   286         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   287             20  FILLER          PIC  X(01).
   288             20  WS-CF-CARRIER   PIC  X(01).
   289     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   290 01  WS-CM-KEY.
   291     05  WS-CM-COMPANY-CD        PIC X.
   292     05  WS-CM-CARRIER           PIC X.
   293     05  WS-CM-GROUP             PIC X(6).
   294     05  WS-CM-STATE             PIC XX.
   295     05  WS-CM-ACCOUNT           PIC X(10).
   296     05  WS-CM-EFF-DT            PIC XX.
   297     05  WS-CM-CERT-NO           PIC X(11).
   298 01  WS-CM-KEY-A1.
   299     05  WS-CM-COMPANY-CD-A1     PIC X.
   300     05  WS-CM-LAST-NAME         PIC X(15).
   301     05  WS-CM-INITIALS          PIC XX.
   302 01  WS-CM-KEY-A4.
   303     05  WS-CM-COMPANY-CD-A4     PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   7
* SOCK03.cbl
   304     05  WS-CM-CERT-NO-A4        PIC X(11).
   305 01  WS-CID-NO                   PIC X(8).
   306 01  WS-DISP-RESP                PIC 9(5).
   307 01  WS-RESPONSE                 PIC S9(8)   COMP.
   308     88  RESP-NORMAL                  VALUE +00.
   309     88  RESP-NOTFND                  VALUE +13.
   310     88  RESP-DUPKEY                  VALUE +15.
   311     88  RESP-NOTOPEN                 VALUE +19.
   312     88  RESP-ENDFILE                 VALUE +20.
   313*                                 COPY ELCCERT.
   314******************************************************************
   315*                                                                *
   316*                            ELCCERT.                            *
   317*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   318*                            VMOD=2.013                          *
   319*                                                                *
   320*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   321*                                                                *
   322*   FILE TYPE = VSAM,KSDS                                        *
   323*   RECORD SIZE = 450  RECFORM = FIXED                           *
   324*                                                                *
   325*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   326*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   327*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   328*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   329*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   330*                                                                *
   331*   LOG = YES                                                    *
   332*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   333******************************************************************
   334*                   C H A N G E   L O G
   335*
   336* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   337*-----------------------------------------------------------------
   338*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   339* EFFECTIVE    NUMBER
   340*-----------------------------------------------------------------
   341* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   342* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   343* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   344* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   345* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   346* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   347* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   348* 032612  CR2011110200001  PEMA  AHL CHANGES
   349* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   350******************************************************************
   351
   352 01  CERTIFICATE-MASTER.
   353     12  CM-RECORD-ID                      PIC XX.
   354         88  VALID-CM-ID                      VALUE 'CM'.
   355
   356     12  CM-CONTROL-PRIMARY.
   357         16  CM-COMPANY-CD                 PIC X.
   358         16  CM-CARRIER                    PIC X.
   359         16  CM-GROUPING.
   360             20  CM-GROUPING-PREFIX        PIC X(3).
   361             20  CM-GROUPING-PRIME         PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   8
* SOCK03.cbl
   362         16  CM-STATE                      PIC XX.
   363         16  CM-ACCOUNT.
   364             20  CM-ACCOUNT-PREFIX         PIC X(4).
   365             20  CM-ACCOUNT-PRIME          PIC X(6).
   366         16  CM-CERT-EFF-DT                PIC XX.
   367         16  CM-CERT-NO.
   368             20  CM-CERT-PRIME             PIC X(10).
   369             20  CM-CERT-SFX               PIC X.
   370
   371     12  CM-CONTROL-BY-NAME.
   372         16  CM-COMPANY-CD-A1              PIC X.
   373         16  CM-INSURED-LAST-NAME          PIC X(15).
   374         16  CM-INSURED-INITIALS.
   375             20  CM-INSURED-INITIAL1       PIC X.
   376             20  CM-INSURED-INITIAL2       PIC X.
   377
   378     12  CM-CONTROL-BY-SSN.
   379         16  CM-COMPANY-CD-A2              PIC X.
   380         16  CM-SOC-SEC-NO.
   381             20  CM-SSN-STATE              PIC XX.
   382             20  CM-SSN-ACCOUNT            PIC X(6).
   383             20  CM-SSN-LN3.
   384                 25  CM-INSURED-INITIALS-A2.
   385                     30 CM-INSURED-INITIAL1-A2   PIC X.
   386                     30 CM-INSURED-INITIAL2-A2   PIC X.
   387                 25 CM-PART-LAST-NAME-A2         PIC X.
   388
   389     12  CM-CONTROL-BY-CERT-NO.
   390         16  CM-COMPANY-CD-A4              PIC X.
   391         16  CM-CERT-NO-A4                 PIC X(11).
   392
   393     12  CM-CONTROL-BY-MEMB.
   394         16  CM-COMPANY-CD-A5              PIC X.
   395         16  CM-MEMBER-NO.
   396             20  CM-MEMB-STATE             PIC XX.
   397             20  CM-MEMB-ACCOUNT           PIC X(6).
   398             20  CM-MEMB-LN4.
   399                 25  CM-INSURED-INITIALS-A5.
   400                     30 CM-INSURED-INITIAL1-A5   PIC X.
   401                     30 CM-INSURED-INITIAL2-A5   PIC X.
   402                 25 CM-PART-LAST-NAME-A5         PIC XX.
   403
   404     12  CM-INSURED-PROFILE-DATA.
   405         16  CM-INSURED-FIRST-NAME.
   406             20  CM-INSURED-1ST-INIT       PIC X.
   407             20  FILLER                    PIC X(9).
   408         16  CM-INSURED-ISSUE-AGE          PIC 99.
   409         16  CM-INSURED-SEX                PIC X.
   410             88  CM-SEX-MALE                  VALUE 'M'.
   411             88  CM-SEX-FEMAL                 VALUE 'F'.
   412         16  CM-INSURED-JOINT-AGE          PIC 99.
   413         16  CM-JOINT-INSURED-NAME.
   414             20  CM-JT-LAST-NAME           PIC X(15).
   415             20  CM-JT-FIRST-NAME.
   416                 24  CM-JT-1ST-INIT        PIC X.
   417                 24  FILLER                PIC X(9).
   418             20  CM-JT-INITIAL             PIC X.
   419
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   9
* SOCK03.cbl
   420     12  CM-LIFE-DATA.
   421         16  CM-LF-BENEFIT-CD              PIC XX.
   422         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   423         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   424         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   425         16  CM-LF-DEV-CODE                PIC XXX.
   426         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   427         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   428         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   429         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   430         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   431         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   432         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   433         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   434         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   435         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   436         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   437         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   438         16  cm-temp-epiq                  pic xx.
   439             88  EPIQ-CLASS                  value 'EQ'.
   440*        16  FILLER                        PIC XX.
   441
   442     12  CM-AH-DATA.
   443         16  CM-AH-BENEFIT-CD              PIC XX.
   444         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   445         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   446         16  CM-AH-DEV-CODE                PIC XXX.
   447         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   448         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   449         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   450         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   451         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   452         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   453         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   454         16  CM-AH-PAID-THRU-DT            PIC XX.
   455             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   456         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   457         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
   458         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   459         16  FILLER                        PIC X.
   460
   461     12  CM-LOAN-INFORMATION.
   462         16  CM-LIVES                      PIC S9(7)     COMP-3.
   463         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   464                                           PIC S9(5)V99  COMP-3.
   465         16  CM-BILLED                     PIC S9(7)     COMP-3.
   466         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   467         16  CM-PAY-FREQUENCY              PIC S99.
   468         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   469         16  CM-RATE-CLASS                 PIC XX.
   470         16  CM-BENEFICIARY                PIC X(25).
   471         16  CM-POLICY-FORM-NO             PIC X(12).
   472         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   473         16  CM-LAST-ADD-ON-DT             PIC XX.
   474         16  CM-DEDUCTIBLE-AMOUNTS.
   475             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   476             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   477         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  10
* SOCK03.cbl
   478             20  CM-RESIDENT-STATE         PIC XX.
   479             20  CM-RATE-CODE              PIC X(4).
   480             20  FILLER                    PIC XX.
   481         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   482             20  CM-LOAN-OFFICER           PIC X(5).
   483             20  FILLER                    PIC XXX.
   484         16  CM-CSR-CODE                   PIC XXX.
   485         16  CM-UNDERWRITING-CODE          PIC X.
   486             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   487         16  CM-POST-CARD-IND              PIC X.
   488         16  CM-NH-INTERFACE-SW            PIC X.
   489         16  CM-PREMIUM-TYPE               PIC X.
   490             88  CM-SING-PRM                  VALUE '1'.
   491             88  CM-O-B-COVERAGE              VALUE '2'.
   492             88  CM-OPEN-END                  VALUE '3'.
   493         16  CM-IND-GRP-TYPE               PIC X.
   494             88  CM-INDIVIDUAL                VALUE 'I'.
   495             88  CM-GROUP                     VALUE 'G'.
   496         16  CM-SKIP-CODE                  PIC X.
   497             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   498             88  SKIP-JULY                    VALUE '1'.
   499             88  SKIP-AUGUST                  VALUE '2'.
   500             88  SKIP-SEPTEMBER               VALUE '3'.
   501             88  SKIP-JULY-AUG                VALUE '4'.
   502             88  SKIP-AUG-SEPT                VALUE '5'.
   503             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   504             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   505             88  SKIP-JUNE                    VALUE '8'.
   506             88  SKIP-JUNE-JULY               VALUE '9'.
   507             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   508             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   509         16  CM-PAYMENT-MODE               PIC X.
   510             88  PAY-MONTHLY                  VALUE SPACE.
   511             88  PAY-WEEKLY                   VALUE '1'.
   512             88  PAY-SEMI-MONTHLY             VALUE '2'.
   513             88  PAY-BI-WEEKLY                VALUE '3'.
   514             88  PAY-SEMI-ANUALLY             VALUE '4'.
   515         16  CM-LOAN-NUMBER                PIC X(8).
   516         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   517         16  CM-OLD-LOF                    PIC XXX.
   518*        16  CM-LOAN-OFFICER               PIC XXX.
   519         16  CM-REIN-TABLE                 PIC XXX.
   520         16  CM-SPECIAL-REIN-CODE          PIC X.
   521         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   522         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   523         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   524
   525     12  CM-STATUS-DATA.
   526         16  CM-ENTRY-STATUS               PIC X.
   527         16  CM-ENTRY-DT                   PIC XX.
   528
   529         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   530         16  CM-LF-CANCEL-DT               PIC XX.
   531         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   532
   533         16  CM-LF-STATUS-AT-DEATH         PIC X.
   534         16  CM-LF-DEATH-DT                PIC XX.
   535         16  CM-LF-DEATH-EXIT-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  11
* SOCK03.cbl
   536
   537         16  CM-LF-CURRENT-STATUS          PIC X.
   538             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   539                                                'M' '4' '5' '9'.
   540             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   541             88  CM-LF-POLICY-PENDING         VALUE '2'.
   542             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   543             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   544             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   545             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   546             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   547             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   548             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   549             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   550             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   551             88  CM-LF-DECLINED               VALUE 'D'.
   552             88  CM-LF-VOIDED                 VALUE 'V'.
   553
   554         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   555         16  CM-AH-CANCEL-DT               PIC XX.
   556         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   557
   558         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   559         16  CM-AH-SETTLEMENT-DT           PIC XX.
   560         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   561
   562         16  CM-AH-CURRENT-STATUS          PIC X.
   563             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   564                                                'M' '4' '5' '9'.
   565             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   566             88  CM-AH-POLICY-PENDING         VALUE '2'.
   567             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   568             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   569             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   570             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   571             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   572             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   573             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   574             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   575             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   576             88  CM-AH-DECLINED               VALUE 'D'.
   577             88  CM-AH-VOIDED                 VALUE 'V'.
   578
   579         16  CM-CLAIM-INTERFACE-SW         PIC X.
   580             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   581             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   582             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   583         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   584
   585         16  CM-ENTRY-BATCH                PIC X(6).
   586         16  CM-LF-EXIT-BATCH              PIC X(6).
   587         16  CM-AH-EXIT-BATCH              PIC X(6).
   588         16  CM-LAST-MONTH-END             PIC XX.
   589
   590     12  CM-NOTE-SW                        PIC X.
   591         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   592         88  CERT-NOTES-PRESENT               VALUE '1'.
   593         88  BILLING-NOTES-PRESENT            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  12
* SOCK03.cbl
   594         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   595         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   596         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   597         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   598         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   599     12  CM-COMP-EXCP-SW                   PIC X.
   600         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   601         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   602     12  CM-INSURED-ADDRESS-SW             PIC X.
   603         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   604         88  INSURED-ADDR-PRESENT             VALUE '1'.
   605
   606*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   607     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   608     12  FILLER                            PIC X.
   609
   610*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   611     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   612     12  FILLER                            PIC X.
   613*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   614     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
   615
   616     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   617         88  CERT-ADDED-BATCH                 VALUE ' '.
   618         88  CERT-ADDED-ONLINE                VALUE '1'.
   619         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   620         88  CERT-PURGED-OFFLINE              VALUE '3'.
   621         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   622     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   623         88  CERT-AS-LOADED                   VALUE ' '.
   624         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   625         88  CERT-CLAIM-ONLINE                VALUE '2'.
   626         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   627         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   628         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   629         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   630         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   631
   632     12  CM-ACCOUNT-COMM-PCTS.
   633         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   634         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   635
   636     12  CM-USER-FIELD                     PIC X.
   637     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   638     12  CM-CLP-STATE                      PIC XX.
   639     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   640     12  CM-USER-RESERVED                  PIC XXX.
   641     12  FILLER REDEFINES CM-USER-RESERVED.
   642         16  CM-AH-CLASS-CD                PIC XX.
   643         16  F                             PIC X.
   644******************************************************************
   645*                                 COPY ELCMSTR.
   646******************************************************************
   647*                                                                *
   648*                            ELCMSTR.                            *
   649*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   650*                            VMOD=2.012                          *
   651*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  13
* SOCK03.cbl
   652*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   653*                                                                *
   654*   FILE TYPE = VSAM,KSDS                                        *
   655*   RECORD SIZE = 350  RECFORM = FIXED                           *
   656*                                                                *
   657*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   658*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   659*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   660*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   661*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   662*                                                 RKP=75,LEN=21  *
   663*                                                                *
   664*   **** NOTE ****                                               *
   665*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   666*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   667*                                                                *
   668*   LOG = YES                                                    *
   669*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   670******************************************************************
   671*                   C H A N G E   L O G
   672*
   673* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   674*-----------------------------------------------------------------
   675*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   676* EFFECTIVE    NUMBER
   677*-----------------------------------------------------------------
   678* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   679* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   680* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   681* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   682* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   683******************************************************************
   684 01  CLAIM-MASTER.
   685     12  CL-RECORD-ID                PIC XX.
   686         88  VALID-CL-ID         VALUE 'CL'.
   687
   688     12  CL-CONTROL-PRIMARY.
   689         16  CL-COMPANY-CD           PIC X.
   690         16  CL-CARRIER              PIC X.
   691         16  CL-CLAIM-NO             PIC X(7).
   692         16  CL-CERT-NO.
   693             20  CL-CERT-PRIME       PIC X(10).
   694             20  CL-CERT-SFX         PIC X.
   695
   696     12  CL-CONTROL-BY-NAME.
   697         16  CL-COMPANY-CD-A1        PIC X.
   698         16  CL-INSURED-LAST-NAME    PIC X(15).
   699         16  CL-INSURED-NAME.
   700             20  CL-INSURED-1ST-NAME PIC X(12).
   701             20  CL-INSURED-MID-INIT PIC X.
   702
   703     12  CL-CONTROL-BY-SSN.
   704         16  CL-COMPANY-CD-A2        PIC X.
   705         16  CL-SOC-SEC-NO.
   706             20  CL-SSN-STATE        PIC XX.
   707             20  CL-SSN-ACCOUNT      PIC X(6).
   708             20  CL-SSN-LN3          PIC X(3).
   709
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  14
* SOCK03.cbl
   710     12  CL-CONTROL-BY-CERT-NO.
   711         16  CL-COMPANY-CD-A4        PIC X.
   712         16  CL-CERT-NO-A4.
   713             20  CL-CERT-A4-PRIME    PIC X(10).
   714             20  CL-CERT-A4-SFX      PIC X.
   715
   716     12  CL-CONTROL-BY-CCN.
   717         16  CL-COMPANY-CD-A5        PIC X.
   718         16  CL-CCN-A5.
   719             20  CL-CCN.
   720                 24  CL-CCN-PREFIX-A5 PIC X(4).
   721                 24  CL-CCN-PRIME-A5 PIC X(12).
   722             20  CL-CCN-FILLER-A5    PIC X(4).
   723
   724     12  CL-INSURED-PROFILE-DATA.
   725         16  CL-INSURED-BIRTH-DT     PIC XX.
   726         16  CL-INSURED-SEX-CD       PIC X.
   727             88  INSURED-IS-MALE        VALUE 'M'.
   728             88  INSURED-IS-FEMALE      VALUE 'F'.
   729             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   730         16  CL-INSURED-OCC-CD       PIC X(6).
   731         16  FILLER                  PIC X(5).
   732
   733     12  CL-PROCESSING-INFO.
   734         16  CL-PROCESSOR-ID         PIC X(4).
   735         16  CL-CLAIM-STATUS         PIC X.
   736             88  CLAIM-IS-OPEN          VALUE 'O'.
   737             88  CLAIM-IS-CLOSED        VALUE 'C'.
   738         16  CL-CLAIM-TYPE           PIC X.
   739*            88  AH-CLAIM               VALUE 'A'.
   740*            88  LIFE-CLAIM             VALUE 'L'.
   741*            88  PROPERTY-CLAIM         VALUE 'P'.
   742*            88  IUI-CLAIM              VALUE 'I'.
   743*            88  GAP-CLAIM              VALUE 'G'.
   744*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   745         16  CL-CLAIM-PREM-TYPE      PIC X.
   746             88  SINGLE-PREMIUM         VALUE '1'.
   747             88  O-B-COVERAGE           VALUE '2'.
   748             88  OPEN-END-COVERAGE      VALUE '3'.
   749         16  CL-INCURRED-DT          PIC XX.
   750         16  CL-REPORTED-DT          PIC XX.
   751         16  CL-FILE-ESTABLISH-DT    PIC XX.
   752         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   753         16  CL-LAST-PMT-DT          PIC XX.
   754         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   755         16  CL-PAID-THRU-DT         PIC XX.
   756         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   757         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   758         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   759         16  CL-PMT-CALC-METHOD      PIC X.
   760             88  CL-360-DAY-YR          VALUE '1'.
   761             88  CL-365-DAY-YR          VALUE '2'.
   762             88  CL-FULL-MONTHS         VALUE '3'.
   763         16  CL-CAUSE-CD             PIC X(6).
   764
   765         16  CL-PRIME-CERT-NO.
   766             20  CL-PRIME-CERT-PRIME PIC X(10).
   767             20  CL-PRIME-CERT-SFX   PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  15
* SOCK03.cbl
   768
   769         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   770             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   771             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   772
   773         16  CL-MICROFILM-NO         PIC X(10).
   774         16  FILLER REDEFINES CL-MICROFILM-NO.
   775             20  CL-BENEFIT-PERIOD   PIC 99.
   776             20  FILLER              PIC X(8).
   777         16  CL-PROG-FORM-TYPE       PIC X.
   778         16  CL-LAST-ADD-ON-DT       PIC XX.
   779
   780         16  CL-LAST-REOPEN-DT       PIC XX.
   781         16  CL-LAST-CLOSE-DT        PIC XX.
   782         16  CL-LAST-CLOSE-REASON    PIC X(01).
   783             88  FINAL-PAID             VALUE '1'.
   784             88  CLAIM-DENIED           VALUE '2'.
   785             88  AUTO-CLOSE             VALUE '3'.
   786             88  MANUAL-CLOSE           VALUE '4'.
   787             88  BENEFITS-CHANGED       VALUE 'C'.
   788             88  SETUP-ERRORS           VALUE 'E'.
   789         16  CL-ASSOC-CERT-SEQU      PIC S99.
   790         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   791         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   792             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   793         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   794         16  FILLER                  PIC X.
   795
   796     12  CL-CERTIFICATE-DATA.
   797         16  CL-CERT-ORIGIN          PIC X.
   798             88  CERT-WAS-ONLINE        VALUE '1'.
   799             88  CERT-WAS-CREATED       VALUE '2'.
   800             88  COVERAGE-WAS-ADDED     VALUE '3'.
   801         16  CL-CERT-KEY-DATA.
   802             20  CL-CERT-CARRIER     PIC X.
   803             20  CL-CERT-GROUPING    PIC X(6).
   804             20  CL-CERT-STATE       PIC XX.
   805             20  CL-CERT-ACCOUNT.
   806                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   807                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   808             20  CL-CERT-EFF-DT      PIC XX.
   809
   810     12  CL-STATUS-CONTROLS.
   811         16  CL-PRIORITY-CD          PIC X.
   812             88  CONFIDENTIAL-DATA      VALUE '8'.
   813             88  HIGHEST-PRIORITY       VALUE '9'.
   814         16  CL-SUPV-ATTN-CD         PIC X.
   815             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   816             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   817         16  CL-PURGED-DT            PIC XX.
   818         16  CL-RESTORED-DT          PIC XX.
   819         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   820         16  CL-NEXT-RESEND-DT       PIC XX.
   821         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   822         16  CL-CRITICAL-PERIOD      PIC 99.
   823*        16  FILLER                  PIC XX.
   824         16  CL-LAST-MAINT-DT        PIC XX.
   825         16  CL-LAST-MAINT-USER      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  16
* SOCK03.cbl
   826         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   827         16  CL-LAST-MAINT-TYPE      PIC X.
   828             88  CLAIM-SET-UP           VALUE ' '.
   829             88  PAYMENT-MADE           VALUE '1'.
   830             88  LETTER-SENT            VALUE '2'.
   831             88  MASTER-WAS-ALTERED     VALUE '3'.
   832             88  MASTER-WAS-RESTORED    VALUE '4'.
   833             88  INCURRED-DATE-CHANGED  VALUE '5'.
   834             88  FILE-CONVERTED         VALUE '6'.
   835             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   836             88  ERROR-CORRECTION       VALUE 'E'.
   837         16  CL-RELATED-CLAIM-NO     PIC X(7).
   838         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   839         16  CL-BENEFICIARY          PIC X(10).
   840         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   841         16  CL-DENIAL-TYPE          PIC X.
   842             88  CL-TYPE-DENIAL          VALUE '1'.
   843             88  CL-TYPE-RESCISSION      VALUE '2'.
   844             88  CL-TYPE-REFORMATION     VALUE '3'.
   845             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   846             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   847         16  filler                  pic x(5).
   848*        16  CL-CRIT-PER-RECURRENT   PIC X.
   849*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   850*        16  CL-RTW-DT               PIC XX.
   851
   852     12  CL-TRAILER-CONTROLS.
   853         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   854             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   855             88  CL-LAST-TRL-AVAIL      VALUE +100.
   856             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   857         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   858         16  FILLER                  PIC XX.
   859         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   860         16  CL-ADDRESS-TRAILER-CNT.
   861             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   862                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   863             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   864                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   865             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   866                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   867             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   868                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   869             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   870                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   871             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   872                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   873             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   874                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   875
   876     12  CL-CV-REFERENCE-NO.
   877         16  CL-CV-REFNO-PRIME       PIC X(18).
   878         16  CL-CV-REFNO-SFX         PIC XX.
   879
   880     12  CL-FILE-LOCATION            PIC X(4).
   881
   882     12  CL-PROCESS-ERRORS.
   883         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  17
* SOCK03.cbl
   884             88  NO-FATAL-ERRORS        VALUE ZERO.
   885         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   886             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   887
   888     12  CL-PRODUCT-CD               PIC X.
   889
   890     12  CL-CURRENT-KEY-DATA.
   891         16  CL-CURRENT-CARRIER      PIC X.
   892         16  CL-CURRENT-GROUPING     PIC X(6).
   893         16  CL-CURRENT-STATE        PIC XX.
   894         16  CL-CURRENT-ACCOUNT      PIC X(10).
   895
   896     12  CL-ASSOCIATES               PIC X.
   897         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   898         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   899         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   900         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   901
   902     12  CL-ACTIVITY-CODE            PIC 99.
   903     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   904     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   905
   906     12  CL-LAPSE-REPORT-CODE        PIC 9.
   907     12  CL-LAG-REPORT-CODE          PIC 9.
   908     12  CL-LOAN-TYPE                PIC XX.
   909     12  CL-LEGAL-STATE              PIC XX.
   910
   911     12  CL-YESNOSW                  PIC X.
   912     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   913         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   914         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   915         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   916     12  cl-insured-type             pic x.
   917         88  cl-claim-on-primary         value 'P'.
   918         88  cl-claim-on-co-borrower     value 'C'.
   919     12  cl-benefit-expiration-dt    PIC XX.
   920*                                 COPY ERCPDEF.
   921******************************************************************
   922*                                                                *
   923*                                                                *
   924*                            ERCPDEF.                            *
   925*                                                                *
   926*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   927*                                                                *
   928*    FILE TYPE = VSAM,KSDS                                       *
   929*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   930*                                                                *
   931*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   932*                                                                *
   933*    LOG = YES                                                   *
   934*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   935******************************************************************
   936*                   C H A N G E   L O G
   937*
   938* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   939*-----------------------------------------------------------------
   940*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   941* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  18
* SOCK03.cbl
   942*-----------------------------------------------------------------
   943* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   944* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   945* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   946******************************************************************
   947 01  PRODUCT-MASTER.
   948    12  PD-RECORD-ID                 PIC X(02).
   949        88  VALID-PD-ID                  VALUE 'PD'.
   950    12  PD-CONTROL-PRIMARY.
   951        16  PD-COMPANY-CD            PIC X.
   952        16  PD-STATE                 PIC XX.
   953        16  PD-PRODUCT-CD            PIC XXX.
   954        16  PD-FILLER                PIC X(7).
   955        16  PD-BEN-TYPE              PIC X.
   956        16  PD-BEN-CODE              PIC XX.
   957        16  PD-PROD-EXP-DT           PIC XX.
   958    12  FILLER                       PIC X(50).
   959    12  PD-PRODUCT-DATA OCCURS 8.
   960        16  PD-PROD-CODE             PIC X.
   961            88  PD-PROD-LIFE           VALUE 'L'.
   962            88  PD-PROD-PROP           VALUE 'P'.
   963            88  PD-PROD-AH             VALUE 'A'.
   964            88  PD-PROD-IU             VALUE 'I'.
   965            88  PD-PROD-GAP            VALUE 'G'.
   966            88  PD-PROD-FAML           VALUE 'F'.
   967        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   968        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   969        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   970        16  PD-MAX-TERM              PIC S999        COMP-3.
   971        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   972        16  FILLER                   PIC X.
   973        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   974        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   975        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   976        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   977        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   978        16  PD-REC-CRIT-PERIOD       PIC 99.
   979        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   980            20  PD-RECURRING-YN      PIC X.
   981            20  FILLER               PIC X.
   982        16  PD-RTW-MOS               PIC 99.
   983        16  PD-MAX-EXTENSION         PIC 99.
   984        16  pd-ben-pct               pic sv999 comp-3.
   985*       16  FILLER                   PIC XX.
   986    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   987    12  PD-TERM-LIMITS OCCURS 15.
   988        16  PD-LOW-TERM              PIC S999        COMP-3.
   989        16  PD-HI-TERM               PIC S999        COMP-3.
   990*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   991    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   992        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   993        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   994    12  PD-EARN-FACTORS.
   995        16  FILLER OCCURS 15.
   996            20  FILLER OCCURS 15.
   997                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   998    12  PD-PRODUCT-DESC              PIC X(80).
   999    12  PD-TRUNCATED                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  19
* SOCK03.cbl
  1000    12  FILLER                       PIC X(59).
  1001    12  PD-MAINT-INFORMATION.
  1002        16  PD-LAST-MAINT-DT         PIC X(02).
  1003        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  1004        16  PD-LAST-MAINT-BY         PIC X(04).
  1005*                                 COPY ERCCTBL.
  1006******************************************************************
  1007*                                                                *
  1008*                                                                *
  1009*                            ERCCTBL                             *
  1010*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1011*                            VMOD=2.003
  1012*                                                                *
  1013*   ONLINE CREDIT SYSTEM                                         *
  1014*                                                                *
  1015*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  1016*                                                                *
  1017*   FILE TYPE = VSAM,KSDS                                        *
  1018*   RECORD SIZE = 200   RECFORM = FIXED                          *
  1019*                                                                *
  1020*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  1021*       ALTERNATE PATH = NONE                                    *
  1022*                                                                *
  1023*   LOG = NO                                                     *
  1024*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1025*                                                                *
  1026*                                                                *
  1027******************************************************************
  1028
  1029 01  COMM-TABLE-RECORD.
  1030     12  CT-RECORD-ID                      PIC XX.
  1031         88  VALID-CT-ID                      VALUE 'CT'.
  1032
  1033     12  CT-CONTROL-PRIMARY.
  1034         16  CT-COMPANY-CD                 PIC X.
  1035         16  CT-TABLE                      PIC XXX.
  1036         16  CT-CNTRL-2.
  1037             20  CT-BEN-TYPE               PIC X.
  1038             20  CT-BEN-CODE               PIC XX.
  1039
  1040     12  CT-MAINT-INFORMATION.
  1041         16  CT-LAST-MAINT-DT              PIC XX.
  1042         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1043         16  CT-LAST-MAINT-USER            PIC X(4).
  1044         16  FILLER                        PIC X(31).
  1045
  1046     12  CT-LIMITS.
  1047         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  1048
  1049         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  1050
  1051         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  1052
  1053     12  CT-RATES.
  1054         16  CT-RTX          OCCURS 27 TIMES.
  1055             20  CT-RT                     PIC SV9(5)     COMP-3.
  1056             20  CT-RT-R   REDEFINES
  1057                 CT-RT                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  20
* SOCK03.cbl
  1058
  1059     12  FILLER                            PIC  X(42).
  1060
  1061******************************************************************
  1062*                                 COPY ELCCNTL.
  1063******************************************************************
  1064*                                                                *
  1065*                                                                *
  1066*                            ELCCNTL.                            *
  1067*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1068*                            VMOD=2.059                          *
  1069*                                                                *
  1070*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1071*                                                                *
  1072*   FILE TYPE = VSAM,KSDS                                        *
  1073*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1074*                                                                *
  1075*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1076*       ALTERNATE INDEX = NONE                                   *
  1077*                                                                *
  1078*   LOG = YES                                                    *
  1079*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1080******************************************************************
  1081*                   C H A N G E   L O G
  1082*
  1083* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1084*-----------------------------------------------------------------
  1085*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1086* EFFECTIVE    NUMBER
  1087*-----------------------------------------------------------------
  1088* 082503                   PEMA  ADD BENEFIT GROUP
  1089* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1090* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1091* 092705    2005050300006  PEMA  ADD SPP LEASES
  1092* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1093* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1094* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1095* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1096* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1097* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1098* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1099* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1100* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1101* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1102******************************************************************
  1103*
  1104 01  CONTROL-FILE.
  1105     12  CF-RECORD-ID                       PIC XX.
  1106         88  VALID-CF-ID                        VALUE 'CF'.
  1107
  1108     12  CF-CONTROL-PRIMARY.
  1109         16  CF-COMPANY-ID                  PIC XXX.
  1110         16  CF-RECORD-TYPE                 PIC X.
  1111             88  CF-COMPANY-MASTER              VALUE '1'.
  1112             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1113             88  CF-STATE-MASTER                VALUE '3'.
  1114             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1115             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  21
* SOCK03.cbl
  1116             88  CF-CARRIER-MASTER              VALUE '6'.
  1117             88  CF-MORTALITY-MASTER            VALUE '7'.
  1118             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1119             88  CF-TERMINAL-MASTER             VALUE '9'.
  1120             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1121             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1122             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1123             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1124             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1125             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1126             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1127             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1128             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1129         16  CF-ACCESS-CD-GENL              PIC X(4).
  1130         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1131             20  CF-PROCESSOR               PIC X(4).
  1132         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1133             20  CF-STATE-CODE              PIC XX.
  1134             20  FILLER                     PIC XX.
  1135         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1136             20  FILLER                     PIC XX.
  1137             20  CF-HI-BEN-IN-REC           PIC XX.
  1138         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1139             20  FILLER                     PIC XXX.
  1140             20  CF-CARRIER-CNTL            PIC X.
  1141         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1142             20  FILLER                     PIC XX.
  1143             20  CF-HI-TYPE-IN-REC          PIC 99.
  1144         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1145             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1146                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1147             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1148             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1149         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1150             20  FILLER                     PIC X.
  1151             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1152         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1153             20  FILLER                     PIC XX.
  1154             20  CF-MORTGAGE-PLAN           PIC XX.
  1155         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1156
  1157     12  CF-LAST-MAINT-DT                   PIC XX.
  1158     12  CF-LAST-MAINT-BY                   PIC X(4).
  1159     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1160
  1161     12  CF-RECORD-BODY                     PIC X(728).
  1162
  1163
  1164****************************************************************
  1165*             COMPANY MASTER RECORD                            *
  1166****************************************************************
  1167
  1168     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1169         16  CF-COMPANY-ADDRESS.
  1170             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1171             20  CF-CL-IN-CARE-OF           PIC X(30).
  1172             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1173             20  CF-CL-ADDR-LINE-2          PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  22
* SOCK03.cbl
  1174             20  CF-CL-CITY-STATE           PIC X(30).
  1175             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1176             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1177         16  CF-COMPANY-CD                  PIC X.
  1178         16  CF-COMPANY-PASSWORD            PIC X(8).
  1179         16  CF-SECURITY-OPTION             PIC X.
  1180             88  ALL-SECURITY                   VALUE '1'.
  1181             88  COMPANY-VERIFY                 VALUE '2'.
  1182             88  PROCESSOR-VERIFY               VALUE '3'.
  1183             88  NO-SECURITY                    VALUE '4'.
  1184             88  ALL-BUT-TERM                   VALUE '5'.
  1185         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1186             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1187         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1188             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1189         16  CF-INFORCE-LOCATION            PIC X.
  1190             88  CERTS-ARE-ONLINE               VALUE '1'.
  1191             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1192             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1193         16  CF-LOWER-CASE-LETTERS          PIC X.
  1194         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1195             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1196             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1197             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1198             88  CF-ACCNT-CNTL                  VALUE '3'.
  1199             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1200
  1201         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1202         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1203
  1204         16  CF-LGX-CREDIT-USER             PIC X.
  1205             88  CO-IS-NOT-USER                 VALUE 'N'.
  1206             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1207
  1208         16 CF-CREDIT-CALC-CODES.
  1209             20  CF-CR-REM-TERM-CALC PIC X.
  1210               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1211               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1212               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1213               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1214               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1215               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1216               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1217             20  CF-CR-R78-METHOD           PIC X.
  1218               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1219               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1220
  1221         16  CF-CLAIM-CONTROL-COUNTS.
  1222             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1223                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1224
  1225             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1226                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1227
  1228             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1229                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1230
  1231             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  23
* SOCK03.cbl
  1232                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1233
  1234         16  CF-CURRENT-MONTH-END           PIC XX.
  1235
  1236         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1237             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1238             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1239             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1240             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1241                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1242                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1243             20  CF-CO-PREM-REJECT-SW       PIC X.
  1244                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1245                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1246             20  CF-CO-REF-REJECT-SW        PIC X.
  1247                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1248                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1249
  1250         16  CF-CO-REPORTING-DT             PIC XX.
  1251         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1252         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1253           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1254           88  CF-CO-MONTH-END                  VALUE '1'.
  1255
  1256         16  CF-LGX-CLAIM-USER              PIC X.
  1257             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1258             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1259
  1260         16  CF-CREDIT-EDIT-CONTROLS.
  1261             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1262             20  CF-MIN-AGE                 PIC 99.
  1263             20  CF-DEFAULT-AGE             PIC 99.
  1264             20  CF-MIN-TERM                PIC S999      COMP-3.
  1265             20  CF-MAX-TERM                PIC S999      COMP-3.
  1266             20  CF-DEFAULT-SEX             PIC X.
  1267             20  CF-JOINT-AGE-INPUT         PIC X.
  1268                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1269             20  CF-BIRTH-DATE-INPUT        PIC X.
  1270                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1271             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1272                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1273                 88  CF-ZERO-CARRIER            VALUE '1'.
  1274                 88  CF-ZERO-GROUPING           VALUE '2'.
  1275                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1276             20  CF-EDIT-SW                 PIC X.
  1277                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1278             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1279             20  CF-CR-PR-METHOD            PIC X.
  1280               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1281               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1282             20  FILLER                     PIC X.
  1283
  1284         16  CF-CREDIT-MISC-CONTROLS.
  1285             20  CF-REIN-TABLE-SW           PIC X.
  1286                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1287             20  CF-COMP-TABLE-SW           PIC X.
  1288                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1289             20  CF-EXPERIENCE-RETENTION-AGE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  24
* SOCK03.cbl
  1290                                            PIC S9        COMP-3.
  1291             20  CF-CONVERSION-DT           PIC XX.
  1292             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1293             20  CF-RUN-FREQUENCY-SW        PIC X.
  1294                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1295                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1296
  1297             20  CF-CR-CHECK-NO-CONTROL.
  1298                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1299                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1300                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1301                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1302                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1303                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1304
  1305                 24  CF-CR-CHECK-COUNT       REDEFINES
  1306                     CF-CR-CHECK-COUNTER      PIC X(4).
  1307
  1308                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1309                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1310
  1311                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1312                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1313                 24  CF-MAIL-PROCESSING       PIC X.
  1314                     88  MAIL-PROCESSING          VALUE 'Y'.
  1315
  1316         16  CF-MISC-SYSTEM-CONTROL.
  1317             20  CF-SYSTEM-C                 PIC X.
  1318                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1319             20  CF-SYSTEM-D                 PIC X.
  1320                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1321             20  CF-SOC-SEC-NO-SW            PIC X.
  1322                 88  SOC-SEC-NO-USED             VALUE '1'.
  1323             20  CF-MEMBER-NO-SW             PIC X.
  1324                 88  MEMBER-NO-USED              VALUE '1'.
  1325             20  CF-TAX-ID-NUMBER            PIC X(11).
  1326             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1327             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1328                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1329                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1330                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1331                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1332             20  CF-SYSTEM-E                 PIC X.
  1333                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1334
  1335         16  CF-LGX-LIFE-USER               PIC X.
  1336             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1337             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1338
  1339         16  CF-CR-MONTH-END-DT             PIC XX.
  1340
  1341         16  CF-FILE-MAINT-DATES.
  1342             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1343                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1344             20  CF-LAST-BATCH       REDEFINES
  1345                 CF-LAST-BATCH-NO               PIC X(4).
  1346             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1347             20  CF-RATES-FILE-CREATE-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  25
* SOCK03.cbl
  1348             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1349             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1350             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1351             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1352             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1353             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1354             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1355             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1356
  1357         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1358         16  FILLER                         PIC X.
  1359
  1360         16  CF-ALT-MORT-CODE               PIC X(4).
  1361         16  CF-MEMBER-CAPTION              PIC X(10).
  1362
  1363         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1364             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1365             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1366             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1367             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1368             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1369
  1370         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1371
  1372         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1373         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1374         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1375         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1376
  1377         16  CF-AH-OVERRIDE-L1              PIC X.
  1378         16  CF-AH-OVERRIDE-L2              PIC XX.
  1379         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1380         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1381
  1382         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1383         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1384
  1385         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1386         16  CF-AR-LAST-EL860-DT            PIC XX.
  1387         16  CF-MP-MONTH-END-DT             PIC XX.
  1388
  1389         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1390         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1391             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1392
  1393         16  CF-AR-MONTH-END-DT             PIC XX.
  1394
  1395         16  CF-CRDTCRD-USER                PIC X.
  1396             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1397             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1398
  1399         16  CF-CC-MONTH-END-DT             PIC XX.
  1400
  1401         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1402
  1403         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1404             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1405             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  26
* SOCK03.cbl
  1406             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1407         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1408         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1409         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1410         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1411             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1412             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1413         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1414         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1415         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1416             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1417         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1418
  1419         16  CF-CL-ZIP-CODE.
  1420             20  CF-CL-ZIP-PRIME.
  1421                 24  CF-CL-ZIP-1ST          PIC X.
  1422                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1423                 24  FILLER                 PIC X(4).
  1424             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1425         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1426             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1427             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1428             20  FILLER                     PIC XXX.
  1429
  1430         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1431         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1432         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1433         16  CF-CO-OPTION-START-DATE        PIC XX.
  1434         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1435           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1436                                                      '3' '4'.
  1437           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1438           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1439           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1440           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1441           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1442           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1443
  1444         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1445
  1446         16  CF-PAYMENT-APPROVAL-LEVELS.
  1447             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1448             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1449             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1450             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1451             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1452             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1453
  1454         16  CF-END-USER-REPORTING-USER     PIC X.
  1455             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1456             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1457
  1458         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1459             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1460             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1461
  1462         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1463
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  27
* SOCK03.cbl
  1464         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1465         16  FILLER                         PIC X.
  1466
  1467         16  CF-CREDIT-ARCHIVE-CNTL.
  1468             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1469             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1470             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1471
  1472         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1473
  1474         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1475             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1476             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1477
  1478         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1479             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1480             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1481
  1482         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1483
  1484         16  CF-CO-ACH-ID-CODE              PIC  X.
  1485             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1486             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1487             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1488         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1489         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1490         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1491         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1492         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1493         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1494         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1495         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1496         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1497                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1498         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1499                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1500
  1501         16  CF-CO-OVER-SHORT.
  1502             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1503             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1504
  1505*         16  FILLER                         PIC X(102).
  1506         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1507             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1508             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1509
  1510         16  CF-AH-APPROVAL-DAYS.
  1511             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1512             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1513             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1514             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1515
  1516         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1517
  1518         16  CF-APPROV-LEV-5.
  1519             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1520             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1521             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  28
* SOCK03.cbl
  1522
  1523         16  FILLER                         PIC X(68).
  1524****************************************************************
  1525*             PROCESSOR/USER RECORD                            *
  1526****************************************************************
  1527
  1528     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1529         16  CF-PROCESSOR-NAME              PIC X(30).
  1530         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1531         16  CF-PROCESSOR-TITLE             PIC X(26).
  1532         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1533                 88  MESSAGE-YES                VALUE 'Y'.
  1534                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1535
  1536*****************************************************
  1537****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1538****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1539****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1540****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1541*****************************************************
  1542
  1543         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1544             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1545             20  CF-APPLICATION-FORCE       PIC X.
  1546             20  CF-INDIVIDUAL-APP.
  1547                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1548                     28  CF-BROWSE-APP      PIC X.
  1549                     28  CF-UPDATE-APP      PIC X.
  1550
  1551         16  CF-CURRENT-TERM-ON             PIC X(4).
  1552         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1553             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1554             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1555             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1556             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1557             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1558             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1559             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1560         16  CF-PROCESSOR-CARRIER           PIC X.
  1561             88  NO-CARRIER-SECURITY            VALUE ' '.
  1562         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1563             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1564         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1565             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1566         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1567             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1568
  1569         16  CF-PROC-SYS-ACCESS-SW.
  1570             20  CF-PROC-CREDIT-CLAIMS-SW.
  1571                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1572                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1573                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1574                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1575             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1576                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1577                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1578             20  CF-PROC-LIFE-GNRLDGR-SW.
  1579                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  29
* SOCK03.cbl
  1580                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1581                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1582                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1583             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1584                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1585                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1586         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1587             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1588             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1589         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1590
  1591         16  CF-APPROVAL-LEVEL                  PIC X.
  1592             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1593             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1594             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1595             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1596             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1597
  1598         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1599
  1600         16  CF-LANGUAGE-TYPE                   PIC X.
  1601             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1602             88  CF-LANG-IS-FR                      VALUE 'F'.
  1603
  1604         16  CF-CSR-IND                         PIC X.
  1605         16  FILLER                             PIC X(239).
  1606
  1607****************************************************************
  1608*             PROCESSOR/REMINDERS RECORD                       *
  1609****************************************************************
  1610
  1611     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1612         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1613             20  CF-START-REMIND-DT         PIC XX.
  1614             20  CF-END-REMIND-DT           PIC XX.
  1615             20  CF-REMINDER-TEXT           PIC X(50).
  1616         16  FILLER                         PIC X(296).
  1617
  1618
  1619****************************************************************
  1620*             STATE MASTER RECORD                              *
  1621****************************************************************
  1622
  1623     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1624         16  CF-STATE-ABBREVIATION          PIC XX.
  1625         16  CF-STATE-NAME                  PIC X(25).
  1626         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1627         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1628             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1629             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1630             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1631             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1632                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1633                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1634             20  CF-ST-PREM-REJECT-SW       PIC X.
  1635                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1636                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1637             20  CF-ST-REF-REJECT-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  30
* SOCK03.cbl
  1638                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1639                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1640         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1641         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1642         16  CF-ST-REFUND-RULES.
  1643             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1644             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1645             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1646         16  CF-ST-FST-PMT-EXTENSION.
  1647             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1648             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1649                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1650                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1651                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1652                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1653         16  CF-ST-STATE-CALL.
  1654             20  CF-ST-CALL-UNEARNED        PIC X.
  1655             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1656             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1657         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1658             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1659             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1660         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1661         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1662         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1663         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1664         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1665         16  FILLER                         PIC X.
  1666         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1667             20  CF-ST-BENEFIT-CD           PIC XX.
  1668             20  CF-ST-BENEFIT-KIND         PIC X.
  1669                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1670                 88  CF-ST-AH-KIND              VALUE 'A'.
  1671             20  CF-ST-REM-TERM-CALC        PIC X.
  1672                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1673                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1674                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1675                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1676                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1677                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1678                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1679                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1680
  1681             20  CF-ST-REFUND-CALC          PIC X.
  1682                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1683                 88  ST-REFD-BY-R78             VALUE '1'.
  1684                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1685                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1686                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1687                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1688                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1689                 88  ST-REFD-UTAH               VALUE '7'.
  1690                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1691                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1692                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1693
  1694             20  CF-ST-EARNING-CALC         PIC X.
  1695                 88  ST-EARNING-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  31
* SOCK03.cbl
  1696                 88  ST-EARN-BY-R78             VALUE '1'.
  1697                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1698                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1699                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1700                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1701                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1702                 88  ST-EARN-MEAN               VALUE '8'.
  1703                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1704
  1705             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1706                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1707                 88  ST-OVRD-BY-R78             VALUE '1'.
  1708                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1709                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1710                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1711                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1712                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1713                 88  ST-OVRD-MEAN               VALUE '8'.
  1714                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1715             20  cf-st-extra-periods        pic 9.
  1716*            20  FILLER                     PIC X.
  1717
  1718         16  CF-ST-COMMISSION-CAPS.
  1719             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1720             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1721             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1722             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1723         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1724                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1725
  1726         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1727
  1728         16  CF-ST-STATUTORY-INTEREST.
  1729             20  CF-ST-STAT-DATE-FROM       PIC X.
  1730                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1731                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1732             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1733             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1734             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1735             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1736             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1737
  1738         16  CF-ST-OVER-SHORT.
  1739             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1740             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1741
  1742         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1743
  1744         16  CF-ST-RT-CALC                  PIC X.
  1745
  1746         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1747         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1748         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1749         16  CF-ST-RF-LR-CALC               PIC X.
  1750         16  CF-ST-RF-LL-CALC               PIC X.
  1751         16  CF-ST-RF-LN-CALC               PIC X.
  1752         16  CF-ST-RF-AH-CALC               PIC X.
  1753         16  CF-ST-RF-CP-CALC               PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  32
* SOCK03.cbl
  1754*        16  FILLER                         PIC X(206).
  1755*CIDMOD         16  FILLER                         PIC X(192).
  1756         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1757             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1758         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1759         16  CF-ST-VFY-2ND-BENE             PIC X.
  1760         16  CF-ST-CAUSAL-STATE             PIC X.
  1761         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1762         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1763         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1764             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1765         16  CF-ST-NET-ONLY-STATE           PIC X.
  1766             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1767         16  FILLER                         PIC X(181).
  1768
  1769****************************************************************
  1770*             BENEFIT MASTER RECORD                            *
  1771****************************************************************
  1772
  1773     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1774         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1775             20  CF-BENEFIT-CODE            PIC XX.
  1776             20  CF-BENEFIT-NUMERIC  REDEFINES
  1777                 CF-BENEFIT-CODE            PIC XX.
  1778             20  CF-BENEFIT-ALPHA           PIC XXX.
  1779             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1780             20  CF-BENEFIT-COMMENT         PIC X(10).
  1781
  1782             20  CF-LF-COVERAGE-TYPE        PIC X.
  1783                 88  CF-REDUCING                VALUE 'R'.
  1784                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1785
  1786             20  CF-SPECIAL-CALC-CD         PIC X.
  1787                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1788                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1789                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1790                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1791                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1792                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1793                 88  CF-FARM-PLAN               VALUE 'F'.
  1794                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1795                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1796                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1797                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1798                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1799                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1800                 88  CF-PRUDENTIAL              VALUE 'P'.
  1801                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1802                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1803                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1804                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1805                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1806                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1807
  1808             20  CF-JOINT-INDICATOR         PIC X.
  1809                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1810
  1811*            20  FILLER                     PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  33
* SOCK03.cbl
  1812             20  cf-maximum-benefits        pic s999 comp-3.
  1813             20  FILLER                     PIC X(09).
  1814             20  CF-BENEFIT-CATEGORY        PIC X.
  1815             20  CF-LOAN-TYPE               PIC X(8).
  1816
  1817             20  CF-CO-REM-TERM-CALC        PIC X.
  1818                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1819                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1820                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1821                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1822                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1823
  1824             20  CF-CO-EARNINGS-CALC        PIC X.
  1825                 88  CO-EARN-BY-R78             VALUE '1'.
  1826                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1827                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1828                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1829                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1830                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1831                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1832                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1833
  1834             20  CF-CO-REFUND-CALC          PIC X.
  1835                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1836                 88  CO-REFD-BY-R78             VALUE '1'.
  1837                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1838                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1839                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1840                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1841                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1842                 88  CO-REFD-MEAN               VALUE '8'.
  1843                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1844                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1845                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1846
  1847             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1848                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1849                 88  CO-OVRD-BY-R78             VALUE '1'.
  1850                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1851                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1852                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1853                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1854                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1855                 88  CO-OVRD-MEAN               VALUE '8'.
  1856                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1857
  1858             20  CF-CO-BEN-I-G-CD           PIC X.
  1859                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1860                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1861                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1862
  1863         16  FILLER                         PIC X(304).
  1864
  1865
  1866****************************************************************
  1867*             CARRIER MASTER RECORD                            *
  1868****************************************************************
  1869
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  34
* SOCK03.cbl
  1870     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1871         16  CF-ADDRESS-DATA.
  1872             20  CF-MAIL-TO-NAME            PIC X(30).
  1873             20  CF-IN-CARE-OF              PIC X(30).
  1874             20  CF-ADDRESS-LINE-1          PIC X(30).
  1875             20  CF-ADDRESS-LINE-2          PIC X(30).
  1876             20  CF-CITY-STATE              PIC X(30).
  1877             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1878             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1879
  1880         16  CF-CLAIM-NO-CONTROL.
  1881             20  CF-CLAIM-NO-METHOD         PIC X.
  1882                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1883                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1884                 88  CLAIM-NO-SEQ               VALUE '3'.
  1885                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1886             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1887                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1888                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1889                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1890
  1891         16  CF-CHECK-NO-CONTROL.
  1892             20  CF-CHECK-NO-METHOD         PIC X.
  1893                 88  CHECK-NO-MANUAL            VALUE '1'.
  1894                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1895                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1896                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1897             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1898                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1899
  1900         16  CF-DOMICILE-STATE              PIC XX.
  1901
  1902         16  CF-EXPENSE-CONTROLS.
  1903             20  CF-EXPENSE-METHOD          PIC X.
  1904                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1905                 88  DOLLARS-PER-PMT            VALUE '2'.
  1906                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1907                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1908             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1909             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1910
  1911         16  CF-CORRESPONDENCE-CONTROL.
  1912             20  CF-LETTER-RESEND-OPT       PIC X.
  1913                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1914                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1915             20  FILLER                     PIC X(4).
  1916
  1917         16  CF-RESERVE-CONTROLS.
  1918             20  CF-MANUAL-SW               PIC X.
  1919                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1920             20  CF-FUTURE-SW               PIC X.
  1921                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1922             20  CF-PTC-SW                  PIC X.
  1923                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1924             20  CF-IBNR-SW                 PIC X.
  1925                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1926             20  CF-PTC-LF-SW               PIC X.
  1927                 88  CF-LF-PTC-USED             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  35
* SOCK03.cbl
  1928             20  CF-CDT-ACCESS-METHOD       PIC X.
  1929                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1930                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1931                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1932             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1933
  1934         16  CF-CLAIM-CALC-METHOD           PIC X.
  1935             88  360-PLUS-MONTHS                VALUE '1'.
  1936             88  365-PLUS-MONTHS                VALUE '2'.
  1937             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1938             88  360-DAILY                      VALUE '4'.
  1939             88  365-DAILY                      VALUE '5'.
  1940
  1941         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1942         16  FILLER                         PIC X(11).
  1943
  1944         16  CF-LIMIT-AMOUNTS.
  1945             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1946             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1947             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1948             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1949             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1950             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1951             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1952             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1953             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1954             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1955
  1956         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1957         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1958         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1959
  1960         16  CF-ZIP-CODE.
  1961             20  CF-ZIP-PRIME.
  1962                 24  CF-ZIP-1ST             PIC X.
  1963                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1964                 24  FILLER                 PIC X(4).
  1965             20  CF-ZIP-PLUS4               PIC X(4).
  1966         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1967             20  CF-CAN-POSTAL-1            PIC XXX.
  1968             20  CF-CAN-POSTAL-2            PIC XXX.
  1969             20  FILLER                     PIC XXX.
  1970
  1971         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1972         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1973         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1974
  1975         16  CF-RATING-SWITCH               PIC X.
  1976             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1977             88  CF-NO-RATING                   VALUE 'N'.
  1978
  1979         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1980
  1981         16  CF-CARRIER-OVER-SHORT.
  1982             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1983             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1984
  1985         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  36
* SOCK03.cbl
  1986         16  CF-SECPAY-SWITCH               PIC X.
  1987             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1988             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1989         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1990         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1991         16  FILLER                         PIC X(444).
  1992*        16  FILLER                         PIC X(452).
  1993
  1994
  1995****************************************************************
  1996*             MORTALITY MASTER RECORD                          *
  1997****************************************************************
  1998
  1999     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2000         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2001                                INDEXED BY CF-MORT-NDX.
  2002             20  CF-MORT-TABLE              PIC X(5).
  2003             20  CF-MORT-TABLE-TYPE         PIC X.
  2004                 88  CF-MORT-JOINT              VALUE 'J'.
  2005                 88  CF-MORT-SINGLE             VALUE 'S'.
  2006                 88  CF-MORT-COMBINED           VALUE 'C'.
  2007                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2008                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2009             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2010             20  CF-MORT-AGE-METHOD         PIC XX.
  2011                 88  CF-AGE-LAST                VALUE 'AL'.
  2012                 88  CF-AGE-NEAR                VALUE 'AN'.
  2013             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2014             20  CF-MORT-ADJUSTMENT-DIRECTION
  2015                                            PIC X.
  2016                 88  CF-MINUS                   VALUE '-'.
  2017                 88  CF-PLUS                    VALUE '+'.
  2018             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2019             20  CF-MORT-JOINT-CODE         PIC X.
  2020                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2021             20  CF-MORT-PC-Q               PIC X.
  2022                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2023             20  CF-MORT-TABLE-CODE         PIC X(4).
  2024             20  CF-MORT-COMMENTS           PIC X(15).
  2025             20  FILLER                     PIC X(14).
  2026
  2027         16  FILLER                         PIC X(251).
  2028
  2029
  2030****************************************************************
  2031*             BUSSINESS TYPE MASTER RECORD                     *
  2032****************************************************************
  2033
  2034     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2035* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2036* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2037* AND RECORD 05 IS TYPES 81-99
  2038         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2039             20  CF-BUSINESS-TITLE          PIC  X(19).
  2040             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2041                                            PIC S9V9(4) COMP-3.
  2042             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2043             20  FILLER                     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  37
* SOCK03.cbl
  2044         16  FILLER                         PIC  X(248).
  2045
  2046
  2047****************************************************************
  2048*             TERMINAL MASTER RECORD                           *
  2049****************************************************************
  2050
  2051     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2052
  2053         16  CF-COMPANY-TERMINALS.
  2054             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2055                                  PIC X(4).
  2056         16  FILLER               PIC X(248).
  2057
  2058
  2059****************************************************************
  2060*             LIFE EDIT MASTER RECORD                          *
  2061****************************************************************
  2062
  2063     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2064         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2065             20  CF-LIFE-CODE-IN            PIC XX.
  2066             20  CF-LIFE-CODE-OUT           PIC XX.
  2067         16  FILLER                         PIC X(248).
  2068
  2069
  2070****************************************************************
  2071*             AH EDIT MASTER RECORD                            *
  2072****************************************************************
  2073
  2074     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2075         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2076             20  CF-AH-CODE-IN              PIC XXX.
  2077             20  CF-AH-CODE-OUT             PIC XX.
  2078         16  FILLER                         PIC X(248).
  2079
  2080
  2081****************************************************************
  2082*             CREDIBILITY TABLES                               *
  2083****************************************************************
  2084
  2085     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2086         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2087                             INDEXED BY CF-CRDB-NDX.
  2088             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2089             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2090             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2091         16  FILLER                         PIC  X(332).
  2092
  2093
  2094****************************************************************
  2095*             REPORT CUSTOMIZATION RECORD                      *
  2096****************************************************************
  2097
  2098     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2099         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2100             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2101             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  38
* SOCK03.cbl
  2102             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2103**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2104****       A T-TRANSFER.                                   ****
  2105             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2106
  2107         16  FILLER                         PIC XX.
  2108
  2109         16  CF-CARRIER-CNTL-OPT.
  2110             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2111                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2112                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2113             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2114                                            PIC X.
  2115         16  CF-GROUP-CNTL-OPT.
  2116             20  CF-GROUP-OPT-SEQ           PIC 9.
  2117                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2118                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2119             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2120                                            PIC X(6).
  2121         16  CF-STATE-CNTL-OPT.
  2122             20  CF-STATE-OPT-SEQ           PIC 9.
  2123                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2124                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2125             20  CF-STATE-SELECT OCCURS 3 TIMES
  2126                                            PIC XX.
  2127         16  CF-ACCOUNT-CNTL-OPT.
  2128             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2129                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2130                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2131             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2132                                            PIC X(10).
  2133         16  CF-BUS-TYP-CNTL-OPT.
  2134             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2135                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2136                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2137             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2138                                            PIC XX.
  2139         16  CF-LF-TYP-CNTL-OPT.
  2140             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2141                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2142                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2143             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2144                                            PIC XX.
  2145         16  CF-AH-TYP-CNTL-OPT.
  2146             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2147                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2148                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2149             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2150                                            PIC XX.
  2151         16  CF-REPTCD1-CNTL-OPT.
  2152             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2153                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2154                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2155             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2156                                            PIC X(10).
  2157         16  CF-REPTCD2-CNTL-OPT.
  2158             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2159                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  39
* SOCK03.cbl
  2160                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2161             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2162                                            PIC X(10).
  2163         16  CF-USER1-CNTL-OPT.
  2164             20  CF-USER1-OPT-SEQ           PIC 9.
  2165                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2166                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2167             20  CF-USER1-SELECT OCCURS 3 TIMES
  2168                                            PIC X(10).
  2169         16  CF-USER2-CNTL-OPT.
  2170             20  CF-USER2-OPT-SEQ           PIC 9.
  2171                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2172                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2173             20  CF-USER2-SELECT OCCURS 3 TIMES
  2174                                            PIC X(10).
  2175         16  CF-USER3-CNTL-OPT.
  2176             20  CF-USER3-OPT-SEQ           PIC 9.
  2177                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2178                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2179             20  CF-USER3-SELECT OCCURS 3 TIMES
  2180                                            PIC X(10).
  2181         16  CF-USER4-CNTL-OPT.
  2182             20  CF-USER4-OPT-SEQ           PIC 9.
  2183                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2184                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2185             20  CF-USER4-SELECT OCCURS 3 TIMES
  2186                                            PIC X(10).
  2187         16  CF-USER5-CNTL-OPT.
  2188             20  CF-USER5-OPT-SEQ           PIC 9.
  2189                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2190                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2191             20  CF-USER5-SELECT OCCURS 3 TIMES
  2192                                            PIC X(10).
  2193         16  CF-REINS-CNTL-OPT.
  2194             20  CF-REINS-OPT-SEQ           PIC 9.
  2195                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2196                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2197             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2198                 24  CF-REINS-PRIME         PIC XXX.
  2199                 24  CF-REINS-SUB           PIC XXX.
  2200
  2201         16  CF-AGENT-CNTL-OPT.
  2202             20  CF-AGENT-OPT-SEQ           PIC 9.
  2203                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2204                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2205             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2206                                            PIC X(10).
  2207
  2208         16  FILLER                         PIC X(43).
  2209
  2210         16  CF-LOSS-RATIO-SELECT.
  2211             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2212             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2213         16  CF-ENTRY-DATE-SELECT.
  2214             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2215             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2216         16  CF-EFFECTIVE-DATE-SELECT.
  2217             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  40
* SOCK03.cbl
  2218             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2219
  2220         16  CF-EXCEPTION-LIST-IND          PIC X.
  2221             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2222
  2223         16  FILLER                         PIC X(318).
  2224
  2225****************************************************************
  2226*                  EXCEPTION REPORTING RECORD                  *
  2227****************************************************************
  2228
  2229     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2230         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2231             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2232
  2233         16  CF-COMBINED-LIFE-AH-OPT.
  2234             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2235             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2236             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2237             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2238
  2239         16  CF-LIFE-OPT.
  2240             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2241             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2242             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2243             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2244             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2245             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2246             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2247             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2248             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2249             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2250
  2251         16  CF-AH-OPT.
  2252             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2253             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2254             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2255             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2256             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2257             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2258             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2259             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2260             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2261             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2262
  2263         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2264             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2265             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2266             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2267
  2268         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2269
  2270         16  FILLER                         PIC X(673).
  2271
  2272
  2273****************************************************************
  2274*             MORTGAGE SYSTEM PLAN RECORD                      *
  2275****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  41
* SOCK03.cbl
  2276
  2277     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2278         16  CF-PLAN-TYPE                   PIC X.
  2279             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2280             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2281             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2282         16  CF-PLAN-ABBREV                 PIC XXX.
  2283         16  CF-PLAN-DESCRIPT               PIC X(10).
  2284         16  CF-PLAN-NOTES                  PIC X(20).
  2285         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2286         16  CF-PLAN-UNDERWRITING.
  2287             20  CF-PLAN-TERM-DATA.
  2288                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2289                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2290             20  CF-PLAN-AGE-DATA.
  2291                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2292                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2293                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2294             20  CF-PLAN-BENEFIT-DATA.
  2295                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2296                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2297                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2298                                            PIC S9(7)V99  COMP-3.
  2299         16  CF-PLAN-POLICY-FORMS.
  2300             20  CF-POLICY-FORM             PIC X(12).
  2301             20  CF-MASTER-APPLICATION      PIC X(12).
  2302             20  CF-MASTER-POLICY           PIC X(12).
  2303         16  CF-PLAN-RATING.
  2304             20  CF-RATE-CODE               PIC X(5).
  2305             20  CF-SEX-RATING              PIC X.
  2306                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2307                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2308             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2309             20  CF-SUB-STD-TYPE            PIC X.
  2310                 88  CF-PCT-OF-PREM            VALUE '1'.
  2311                 88  CF-PCT-OF-BENE            VALUE '2'.
  2312         16  CF-PLAN-PREM-TOLERANCES.
  2313             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2314             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2315         16  CF-PLAN-PYMT-TOLERANCES.
  2316             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2317             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2318         16  CF-PLAN-MISC-DATA.
  2319             20  FILLER                     PIC X.
  2320             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2321             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2322         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2323         16  CF-PLAN-IND-GRP                PIC X.
  2324             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2325                                                     '1'.
  2326             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2327                                                     '2'.
  2328         16  CF-MIB-SEARCH-SW               PIC X.
  2329             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2330             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2331             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2332             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2333         16  CF-ALPHA-SEARCH-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  42
* SOCK03.cbl
  2334             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2335             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2336             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2337             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2338             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2339             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2340             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2341             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2342             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2343             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2344                                                     'A' 'B' 'C'
  2345                                                     'X' 'Y' 'Z'.
  2346         16  CF-EFF-DT-RULE-SW              PIC X.
  2347             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2348             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2349             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2350             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2351             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2352         16  FILLER                         PIC X(4).
  2353         16  CF-HEALTH-QUESTIONS            PIC X.
  2354             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2355         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2356         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2357         16  CF-PLAN-SNGL-JNT               PIC X.
  2358             88  CF-COMBINED-PLAN              VALUE 'C'.
  2359             88  CF-JNT-PLAN                   VALUE 'J'.
  2360             88  CF-SNGL-PLAN                  VALUE 'S'.
  2361         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2362         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2363         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2364         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2365         16  CF-RERATE-CNTL                 PIC  X.
  2366             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2367             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2368             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2369             88  CF-AUTO-RECALC                 VALUE '4'.
  2370         16  CF-BENEFIT-TYPE                PIC  X.
  2371             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2372             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2373         16  CF-POLICY-FEE                  PIC S999V99
  2374                                                    COMP-3.
  2375         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2376         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2377         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2378         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2379         16  FILLER                         PIC  X(32).
  2380         16  CF-TERMINATION-FORM            PIC  X(04).
  2381         16  FILLER                         PIC  X(08).
  2382         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2383                                                       COMP-3.
  2384         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2385         16  CF-ISSUE-LETTER                PIC  X(4).
  2386         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2387         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2388             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2389             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2390         16  CF-MP-REFUND-CALC              PIC X.
  2391             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  43
* SOCK03.cbl
  2392             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2393             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2394             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2395             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2396             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2397             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2398             88  CF-MP-REFD-MEAN                VALUE '8'.
  2399         16  CF-ALT-RATE-CODE               PIC  X(5).
  2400
  2401
  2402         16  FILLER                         PIC X(498).
  2403****************************************************************
  2404*             MORTGAGE COMPANY MASTER RECORD                   *
  2405****************************************************************
  2406
  2407     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2408         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2409         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2410             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2411             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2412             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2413             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2414             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2415
  2416         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2417         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2418         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2419         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2420         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2421
  2422         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2423             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2424         16  CF-MP-RECON-USE-IND            PIC X(1).
  2425             88  CF-MP-USE-RECON             VALUE 'Y'.
  2426         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2427             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2428         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2429             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2430             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2431         16  FILLER                         PIC X(1).
  2432         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2433             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2434         16  CF-MORTG-MIB-VERSION           PIC X.
  2435             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2436             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2437             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2438         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2439             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2440                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2441             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2442                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2443             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2444                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2445             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2446                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2447             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2448                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2449             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  44
* SOCK03.cbl
  2450                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2451         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2452         16  FILLER                         PIC X(7).
  2453         16  CF-MORTG-DESTINATION-SYMBOL.
  2454             20  CF-MORTG-MIB-COMM          PIC X(5).
  2455             20  CF-MORTG-MIB-TERM          PIC X(5).
  2456         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2457             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2458         16  FILLER                         PIC X(03).
  2459         16  CF-MP-CHECK-NO-CONTROL.
  2460             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2461                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2462                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2463                                                ' ' LOW-VALUES.
  2464                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2465                                               VALUE '3'.
  2466         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2467         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2468         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2469             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2470                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2471             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2472                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2473             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2474                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2475             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2476                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2477             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2478                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2479             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2480                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2481         16  CF-MORTG-BILLING-AREA.
  2482             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2483                                            PIC X.
  2484         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2485         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2486         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2487         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2488             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2489             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2490         16  FILLER                         PIC X.
  2491         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2492             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2493             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2494         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2495         16  FILLER                         PIC X(8).
  2496         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2497         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2498         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2499         16  CF-ACH-COMPANY-ID.
  2500             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2501                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2502                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2503                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2504             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2505         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2506             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2507         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  45
* SOCK03.cbl
  2508             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2509             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2510         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2511         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2512         16  FILLER                         PIC X(536).
  2513
  2514****************************************************************
  2515*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2516****************************************************************
  2517
  2518     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2519         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2520             20  CF-FEMALE-HEIGHT.
  2521                 24  CF-FEMALE-FT           PIC 99.
  2522                 24  CF-FEMALE-IN           PIC 99.
  2523             20  CF-FEMALE-MIN-WT           PIC 999.
  2524             20  CF-FEMALE-MAX-WT           PIC 999.
  2525         16  FILLER                         PIC X(428).
  2526
  2527     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2528         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2529             20  CF-MALE-HEIGHT.
  2530                 24  CF-MALE-FT             PIC 99.
  2531                 24  CF-MALE-IN             PIC 99.
  2532             20  CF-MALE-MIN-WT             PIC 999.
  2533             20  CF-MALE-MAX-WT             PIC 999.
  2534         16  FILLER                         PIC X(428).
  2535******************************************************************
  2536*             AUTOMATIC ACTIVITY RECORD                          *
  2537******************************************************************
  2538     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2539         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2540             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2541             20  CF-SYS-LETTER-ID           PIC X(04).
  2542             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2543             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2544             20  CF-SYS-RESET-SW            PIC X(01).
  2545             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2546             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2547
  2548         16  FILLER                         PIC X(50).
  2549
  2550         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2551             20  CF-USER-ACTIVE-SW          PIC X(01).
  2552             20  CF-USER-LETTER-ID          PIC X(04).
  2553             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2554             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2555             20  CF-USER-RESET-SW           PIC X(01).
  2556             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2557             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2558             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2559
  2560         16  FILLER                         PIC X(246).
  2561*                                 COPY ERCACCT.
  2562******************************************************************
  2563*                                                                *
  2564*                                                                *
  2565*                            ERCACCT                             *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  46
* SOCK03.cbl
  2566*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2567*                            VMOD=2.031                          *
  2568*                                                                *
  2569*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2570*                                                                *
  2571*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2572*   VSAM ACCOUNT MASTER FILES.                                   *
  2573*                                                                *
  2574*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2575*                                                                *
  2576*   FILE TYPE = VSAM,KSDS                                        *
  2577*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2578*                                                                *
  2579*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2580*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2581*                                                                *
  2582*   LOG = NO                                                     *
  2583*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2584*                                                                *
  2585*                                                                *
  2586******************************************************************
  2587*                   C H A N G E   L O G
  2588*
  2589* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2590*-----------------------------------------------------------------
  2591*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2592* EFFECTIVE    NUMBER
  2593*-----------------------------------------------------------------
  2594* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2595* 092705    2005050300006  PEMA  ADD SPP LEASES
  2596* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2597* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2598* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2599* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2600* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2601******************************************************************
  2602
  2603 01  ACCOUNT-MASTER.
  2604     12  AM-RECORD-ID                      PIC XX.
  2605         88  VALID-AM-ID                      VALUE 'AM'.
  2606
  2607     12  AM-CONTROL-PRIMARY.
  2608         16  AM-COMPANY-CD                 PIC X.
  2609         16  AM-MSTR-CNTRL.
  2610             20  AM-CONTROL-A.
  2611                 24  AM-CARRIER            PIC X.
  2612                 24  AM-GROUPING.
  2613                     28 AM-GROUPING-PREFIX PIC XXX.
  2614                     28 AM-GROUPING-PRIME  PIC XXX.
  2615                 24  AM-STATE              PIC XX.
  2616                 24  AM-ACCOUNT.
  2617                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2618                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2619             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2620                                           PIC X(19).
  2621             20  AM-CNTRL-B.
  2622                 24  AM-EXPIRATION-DT      PIC XX.
  2623                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  47
* SOCK03.cbl
  2624             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2625                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2626
  2627     12  AM-CONTROL-BY-VAR-GRP.
  2628         16  AM-COMPANY-CD-A1              PIC X.
  2629         16  AM-VG-CARRIER                 PIC X.
  2630         16  AM-VG-GROUPING                PIC X(6).
  2631         16  AM-VG-STATE                   PIC XX.
  2632         16  AM-VG-ACCOUNT                 PIC X(10).
  2633         16  AM-VG-DATE.
  2634             20  AM-VG-EXPIRATION-DT       PIC XX.
  2635             20  FILLER                    PIC X(4).
  2636         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2637                                           PIC 9(11)      COMP-3.
  2638     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2639         16  FILLER                        PIC X(10).
  2640         16  AM-VG-KEY3.
  2641             20  AM-VG3-ACCOUNT            PIC X(10).
  2642             20  AM-VG3-EXP-DT             PIC XX.
  2643         16  FILLER                        PIC X(4).
  2644     12  AM-MAINT-INFORMATION.
  2645         16  AM-LAST-MAINT-DT              PIC XX.
  2646         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2647         16  AM-LAST-MAINT-USER            PIC X(4).
  2648         16  FILLER                        PIC XX.
  2649
  2650     12  AM-EFFECTIVE-DT                   PIC XX.
  2651     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2652
  2653     12  AM-PREV-DATES  COMP-3.
  2654         16  AM-PREV-EXP-DT                PIC 9(11).
  2655         16  AM-PREV-EFF-DT                PIC 9(11).
  2656
  2657     12  AM-REPORT-CODE-1                  PIC X(10).
  2658     12  AM-REPORT-CODE-2                  PIC X(10).
  2659
  2660     12  AM-CITY-CODE                      PIC X(4).
  2661     12  AM-COUNTY-PARISH                  PIC X(6).
  2662
  2663     12  AM-NAME                           PIC X(30).
  2664     12  AM-PERSON                         PIC X(30).
  2665     12  AM-ADDRS                          PIC X(30).
  2666     12  AM-CITY.
  2667         16  AM-ADDR-CITY                  PIC X(28).
  2668         16  AM-ADDR-STATE                 PIC XX.
  2669     12  AM-ZIP.
  2670         16  AM-ZIP-PRIME.
  2671             20  AM-ZIP-PRI-1ST            PIC X.
  2672                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2673             20  FILLER                    PIC X(4).
  2674         16  AM-ZIP-PLUS4                  PIC X(4).
  2675     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2676         16  AM-CAN-POSTAL-1               PIC XXX.
  2677         16  AM-CAN-POSTAL-2               PIC XXX.
  2678         16  FILLER                        PIC XXX.
  2679     12  AM-TEL-NO.
  2680         16  AM-AREA-CODE                  PIC 999.
  2681         16  AM-TEL-PRE                    PIC 999.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  48
* SOCK03.cbl
  2682         16  AM-TEL-NBR                    PIC 9(4).
  2683     12  AM-TEL-LOC                        PIC X.
  2684         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2685         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2686
  2687     12  AM-COMM-STRUCTURE.
  2688         16  AM-DEFN-1.
  2689             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2690                 24  AM-AGT.
  2691                     28  AM-AGT-PREFIX     PIC X(4).
  2692                     28  AM-AGT-PRIME      PIC X(6).
  2693                 24  AM-COM-TYP            PIC X.
  2694                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2695                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2696                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2697                 24  AM-RECALC-LV-INDIC    PIC X.
  2698                 24  AM-RETRO-LV-INDIC     PIC X.
  2699                 24  AM-GL-CODES           PIC X.
  2700                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2701                 24  FILLER                PIC X(01).
  2702         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2703             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2704                 24  FILLER                PIC X(11).
  2705                 24  AM-L-COMA             PIC XXX.
  2706                 24  AM-J-COMA             PIC XXX.
  2707                 24  AM-A-COMA             PIC XXX.
  2708                 24  FILLER                PIC X(6).
  2709
  2710     12  AM-COMM-CHANGE-STATUS             PIC X.
  2711         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2712
  2713     12  AM-CSR-CODE                       PIC X(4).
  2714
  2715     12  AM-BILLING-STATUS                 PIC X.
  2716         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2717         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2718     12  AM-AUTO-REFUND-SW                 PIC X.
  2719         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2720         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2721     12  AM-GPCD                           PIC 99.
  2722     12  AM-IG                             PIC X.
  2723         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2724         88  AM-HAS-GROUP                     VALUE '2'.
  2725     12  AM-STATUS                         PIC X.
  2726         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2727         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2728         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2729         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2730         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2731         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2732     12  AM-REMIT-TO                       PIC 99.
  2733     12  AM-ID-NO                          PIC X(11).
  2734
  2735     12  AM-CAL-TABLE                      PIC XX.
  2736     12  AM-LF-DEVIATION                   PIC XXX.
  2737     12  AM-AH-DEVIATION                   PIC XXX.
  2738     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2739     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  49
* SOCK03.cbl
  2740     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2741     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2742     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2743     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2744
  2745     12  AM-USER-FIELDS.
  2746         16  AM-FLD-1                      PIC XX.
  2747         16  AM-FLD-2                      PIC XX.
  2748         16  AM-FLD-3                      PIC XX.
  2749         16  AM-FLD-4                      PIC XX.
  2750         16  AM-FLD-5                      PIC XX.
  2751
  2752     12  AM-1ST-PROD-DATE.
  2753         16  AM-1ST-PROD-YR                PIC XX.
  2754         16  AM-1ST-PROD-MO                PIC XX.
  2755         16  AM-1ST-PROD-DA                PIC XX.
  2756     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2757     12  AM-CERTS-PURGED-DATE.
  2758         16  AM-PUR-YR                     PIC XX.
  2759         16  AM-PUR-MO                     PIC XX.
  2760         16  AM-PUR-DA                     PIC XX.
  2761     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2762     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2763     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2764     12  AM-INACTIVE-DATE.
  2765         16  AM-INA-MO                     PIC 99.
  2766         16  AM-INA-DA                     PIC 99.
  2767         16  AM-INA-YR                     PIC 99.
  2768     12  AM-AR-HI-CERT-DATE                PIC XX.
  2769
  2770     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2771     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2772
  2773     12  AM-OB-PAYMENT-MODE                PIC X.
  2774         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2775         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2776         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2777         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2778
  2779     12  AM-AH-ONLY-INDICATOR              PIC X.
  2780         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2781         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2782
  2783     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2784
  2785     12  AM-OVER-SHORT.
  2786         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2787         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2788
  2789     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2790     12  AM-DCC-CLP-STATE                  PIC XX.
  2791
  2792     12  AM-RECALC-COMM                    PIC X.
  2793     12  AM-RECALC-REIN                    PIC X.
  2794
  2795     12  AM-REI-TABLE                      PIC XXX.
  2796     12  AM-REI-ET-LF                      PIC X.
  2797     12  AM-REI-ET-AH                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  50
* SOCK03.cbl
  2798     12  AM-REI-PE-LF                      PIC X.
  2799     12  AM-REI-PE-AH                      PIC X.
  2800     12  AM-REI-PRT-ST                     PIC X.
  2801     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2802     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2803     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2804     12  AM-REI-GROUP-A                    PIC X(6).
  2805     12  AM-REI-MORT                       PIC X(4).
  2806     12  AM-REI-PRT-OW                     PIC X.
  2807     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2808     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2809     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2810     12  AM-REI-GROUP-B                    PIC X(6).
  2811
  2812     12  AM-TRUST-TYPE                     PIC X(2).
  2813
  2814     12  AM-EMPLOYER-STMT-USED             PIC X.
  2815     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2816
  2817     12  AM-STD-AH-TYPE                    PIC XX.
  2818     12  AM-EARN-METHODS.
  2819         16  AM-EARN-METHOD-R              PIC X.
  2820             88 AM-REF-RL-R78                 VALUE 'R'.
  2821             88 AM-REF-RL-PR                  VALUE 'P'.
  2822             88 AM-REF-RL-MEAN                VALUE 'M'.
  2823             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2824         16  AM-EARN-METHOD-L              PIC X.
  2825             88 AM-REF-LL-R78                 VALUE 'R'.
  2826             88 AM-REF-LL-PR                  VALUE 'P'.
  2827             88 AM-REF-LL-MEAN                VALUE 'M'.
  2828             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2829         16  AM-EARN-METHOD-A              PIC X.
  2830             88 AM-REF-AH-R78                 VALUE 'R'.
  2831             88 AM-REF-AH-PR                  VALUE 'P'.
  2832             88 AM-REF-AH-MEAN                VALUE 'M'.
  2833             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2834             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2835             88 AM-REF-AH-NET                 VALUE 'N'.
  2836
  2837     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2838     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2839     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2840
  2841     12  AM-RET-Y-N                        PIC X.
  2842     12  AM-RET-P-E                        PIC X.
  2843     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2844     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2845     12  AM-RET-GRP                        PIC X(6).
  2846     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2847         16  AM-POOL-PRIME                 PIC XXX.
  2848         16  AM-POOL-SUB                   PIC XXX.
  2849     12  AM-RETRO-EARNINGS.
  2850         16  AM-RET-EARN-R                 PIC X.
  2851         16  AM-RET-EARN-L                 PIC X.
  2852         16  AM-RET-EARN-A                 PIC X.
  2853     12  AM-RET-ST-TAX-USE                 PIC X.
  2854         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2855         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  51
* SOCK03.cbl
  2856     12  AM-RETRO-BEG-EARNINGS.
  2857         16  AM-RET-BEG-EARN-R             PIC X.
  2858         16  AM-RET-BEG-EARN-L             PIC X.
  2859         16  AM-RET-BEG-EARN-A             PIC X.
  2860     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2861     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2862
  2863     12  AM-USER-SELECT-OPTIONS.
  2864         16  AM-USER-SELECT-1              PIC X(10).
  2865         16  AM-USER-SELECT-2              PIC X(10).
  2866         16  AM-USER-SELECT-3              PIC X(10).
  2867         16  AM-USER-SELECT-4              PIC X(10).
  2868         16  AM-USER-SELECT-5              PIC X(10).
  2869
  2870     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2871
  2872     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2873
  2874     12  AM-RPT045A-SWITCH                 PIC X.
  2875         88  RPT045A-OFF                   VALUE 'N'.
  2876
  2877     12  AM-INSURANCE-LIMITS.
  2878         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2879         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2880
  2881     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2882         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2883
  2884     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2885         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2886         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2887
  2888     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2889
  2890     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2891     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2892     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2893     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2894     12  AM-DCC-UEF-STATE                  PIC XX.
  2895     12  FILLER                            PIC XXX.
  2896     12  AM-REPORT-CODE-3                  PIC X(10).
  2897*    12  FILLER                            PIC X(22).
  2898
  2899     12  AM-RESERVE-DATE.
  2900         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2901         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2902         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2903
  2904     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2905     12  AM-NOTIFICATION-TYPES.
  2906         16  AM-NOTIF-OF-LETTERS           PIC X.
  2907         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2908         16  AM-NOTIF-OF-REPORTS           PIC X.
  2909         16  AM-NOTIF-OF-STATUS            PIC X.
  2910
  2911     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2912         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2913         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  52
* SOCK03.cbl
  2914         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2915         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2916
  2917     12  AM-BENEFIT-CONTROLS.
  2918         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2919             20  AM-BENEFIT-CODE           PIC XX.
  2920             20  AM-BENEFIT-TYPE           PIC X.
  2921             20  AM-BENEFIT-REVISION       PIC XXX.
  2922             20  AM-BENEFIT-REM-TERM       PIC X.
  2923             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2924             20  FILLER                    PIC XX.
  2925         16  FILLER                        PIC X(80).
  2926
  2927     12  AM-TRANSFER-DATA.
  2928         16  AM-TRANSFERRED-FROM.
  2929             20  AM-TRNFROM-CARRIER        PIC X.
  2930             20  AM-TRNFROM-GROUPING.
  2931                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2932                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2933             20  AM-TRNFROM-STATE          PIC XX.
  2934             20  AM-TRNFROM-ACCOUNT.
  2935                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2936                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2937             20  AM-TRNFROM-DTE            PIC XX.
  2938         16  AM-TRANSFERRED-TO.
  2939             20  AM-TRNTO-CARRIER          PIC X.
  2940             20  AM-TRNTO-GROUPING.
  2941                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2942                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2943             20  AM-TRNTO-STATE            PIC XX.
  2944             20  AM-TRNTO-ACCOUNT.
  2945                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2946                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2947             20  AM-TRNTO-DTE              PIC XX.
  2948         16  FILLER                        PIC X(10).
  2949
  2950     12  AM-SAVED-REMIT-TO                 PIC 99.
  2951
  2952     12  AM-COMM-STRUCTURE-SAVED.
  2953         16  AM-DEFN-1-SAVED.
  2954             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2955                 24  AM-AGT-SV             PIC X(10).
  2956                 24  AM-COM-TYP-SV         PIC X.
  2957                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2958                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2959                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2960                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2961                 24  FILLER                PIC X.
  2962                 24  AM-GL-CODES-SV        PIC X.
  2963                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2964                 24  FILLER                PIC X.
  2965         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2966             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2967                 24  FILLER                PIC X(11).
  2968                 24  AM-L-COMA-SV          PIC XXX.
  2969                 24  AM-J-COMA-SV          PIC XXX.
  2970                 24  AM-A-COMA-SV          PIC XXX.
  2971                 24  FILLER                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  53
* SOCK03.cbl
  2972
  2973     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2974         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2975            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2976            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2977            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2978
  2979     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2980     12  FILLER                            PIC X(120).
  2981
  2982     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2983         16  AM-CONTROL-NAME               PIC X(30).
  2984         16  AM-EXECUTIVE-ONE.
  2985             20  AM-EXEC1-NAME             PIC X(15).
  2986             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2987                                                          COMP-3.
  2988             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2989                                                          COMP-3.
  2990         16  AM-EXECUTIVE-TWO.
  2991             20  AM-EXEC2-NAME             PIC X(15).
  2992             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2993                                                          COMP-3.
  2994             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2995                                                          COMP-3.
  2996
  2997     12  AM-RETRO-ADDITIONAL-DATA.
  2998         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2999         16  AM-RETRO-PREM-P-E             PIC X.
  3000         16  AM-RETRO-CLMS-P-I             PIC X.
  3001         16  AM-RETRO-RET-BRACKET-LF.
  3002             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3003                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3004                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3005             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3006                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3007                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3008             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3009                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3010                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3011         16  AM-RETRO-RET-BRACKET-AH.
  3012             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3013                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3014                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3015                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3016             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3017                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3018                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3019             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3020                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3021                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3022
  3023     12  AM-COMMENTS.
  3024         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3025
  3026     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3027         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3028         16  AM-FLI-BILLING-CODE           PIC X.
  3029         16  AM-FLI-ALT-STATE-CODE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  54
* SOCK03.cbl
  3030         16  AM-FLI-UNITED-IDENT           PIC X.
  3031         16  AM-FLI-INTEREST-LOST-DATA.
  3032             20  AM-FLI-BANK-NO            PIC X(5).
  3033             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3034             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3035             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3036         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3037             20  AM-FLI-AGT                PIC X(9).
  3038             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3039             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3040         16  FILLER                        PIC X(102).
  3041
  3042     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3043         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3044             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3045             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3046             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3047             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3048             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3049         16  FILLER                          PIC X(10).
  3050******************************************************************
  3051*                                 COPY ELCDATE.
  3052******************************************************************
  3053*                                                                *
  3054*                                                                *
  3055*                            ELCDATE.                            *
  3056*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3057*                            VMOD=2.003
  3058*                                                                *
  3059*                                                                *
  3060*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3061*                 LENGTH = 200                                   *
  3062******************************************************************
  3063
  3064 01  DATE-CONVERSION-DATA.
  3065     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3066     12  DC-OPTION-CODE                PIC X.
  3067         88  BIN-TO-GREG                VALUE ' '.
  3068         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3069         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3070         88  YMD-GREG-TO-BIN            VALUE '3'.
  3071         88  MDY-GREG-TO-BIN            VALUE '4'.
  3072         88  JULIAN-TO-BIN              VALUE '5'.
  3073         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3074         88  FIND-CENTURY               VALUE '7'.
  3075         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3076         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3077         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3078         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3079         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3080         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3081         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3082         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3083         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3084         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3085         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3086         88  BIN-3-TO-GREG              VALUE 'I'.
  3087         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  55
* SOCK03.cbl
  3088         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3089         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3090         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3091         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3092         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3093         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3094         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3095         88  THREE-CHARACTER-BIN
  3096                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3097         88  GREGORIAN-TO-BIN
  3098                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3099         88  BIN-TO-GREGORIAN
  3100                  VALUES ' ' '1' 'I' '8' 'G'.
  3101         88  JULIAN-TO-BINARY
  3102                  VALUES '5' 'C' 'E' 'F'.
  3103     12  DC-ERROR-CODE                 PIC X.
  3104         88  NO-CONVERSION-ERROR        VALUE ' '.
  3105         88  DATE-CONVERSION-ERROR
  3106                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3107         88  DATE-IS-ZERO               VALUE '1'.
  3108         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3109         88  DATE-IS-INVALID            VALUE '3'.
  3110         88  DATE1-GREATER-DATE2        VALUE '4'.
  3111         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3112         88  DATE-INVALID-OPTION        VALUE '9'.
  3113         88  INVALID-CENTURY            VALUE 'A'.
  3114         88  ONLY-CENTURY               VALUE 'B'.
  3115         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3116         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3117     12  DC-END-OF-MONTH               PIC X.
  3118         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3119     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3120         88  USE-NORMAL-PROCESS         VALUE ' '.
  3121         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3122         88  ADJUST-UP-100-YRS          VALUE '2'.
  3123     12  FILLER                        PIC X.
  3124     12  DC-CONVERSION-DATES.
  3125         16  DC-BIN-DATE-1             PIC XX.
  3126         16  DC-BIN-DATE-2             PIC XX.
  3127         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3128         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3129                       DC-GREG-DATE-1-EDIT.
  3130             20  DC-EDIT1-MONTH        PIC 99.
  3131             20  SLASH1-1              PIC X.
  3132             20  DC-EDIT1-DAY          PIC 99.
  3133             20  SLASH1-2              PIC X.
  3134             20  DC-EDIT1-YEAR         PIC 99.
  3135         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3136         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3137                     DC-GREG-DATE-2-EDIT.
  3138             20  DC-EDIT2-MONTH        PIC 99.
  3139             20  SLASH2-1              PIC X.
  3140             20  DC-EDIT2-DAY          PIC 99.
  3141             20  SLASH2-2              PIC X.
  3142             20  DC-EDIT2-YEAR         PIC 99.
  3143         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3144         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3145                     DC-GREG-DATE-1-YMD.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  56
* SOCK03.cbl
  3146             20  DC-YMD-YEAR           PIC 99.
  3147             20  DC-YMD-MONTH          PIC 99.
  3148             20  DC-YMD-DAY            PIC 99.
  3149         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3150         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3151                      DC-GREG-DATE-1-MDY.
  3152             20  DC-MDY-MONTH          PIC 99.
  3153             20  DC-MDY-DAY            PIC 99.
  3154             20  DC-MDY-YEAR           PIC 99.
  3155         16  DC-GREG-DATE-1-ALPHA.
  3156             20  DC-ALPHA-MONTH        PIC X(10).
  3157             20  DC-ALPHA-DAY          PIC 99.
  3158             20  FILLER                PIC XX.
  3159             20  DC-ALPHA-CENTURY.
  3160                 24 DC-ALPHA-CEN-N     PIC 99.
  3161             20  DC-ALPHA-YEAR         PIC 99.
  3162         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3163         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3164         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3165         16  DC-JULIAN-DATE            PIC 9(05).
  3166         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3167                                       PIC 9(05).
  3168         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3169             20  DC-JULIAN-YEAR        PIC 99.
  3170             20  DC-JULIAN-DAYS        PIC 999.
  3171         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3172         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3173         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3174     12  DATE-CONVERSION-VARIBLES.
  3175         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3176         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3177             20  FILLER                PIC 9(3).
  3178             20  HOLD-CEN-1-CCYY.
  3179                 24  HOLD-CEN-1-CC     PIC 99.
  3180                 24  HOLD-CEN-1-YY     PIC 99.
  3181             20  HOLD-CEN-1-MO         PIC 99.
  3182             20  HOLD-CEN-1-DA         PIC 99.
  3183         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3184             20  HOLD-CEN-1-R-MO       PIC 99.
  3185             20  HOLD-CEN-1-R-DA       PIC 99.
  3186             20  HOLD-CEN-1-R-CCYY.
  3187                 24  HOLD-CEN-1-R-CC   PIC 99.
  3188                 24  HOLD-CEN-1-R-YY   PIC 99.
  3189             20  FILLER                PIC 9(3).
  3190         16  HOLD-CENTURY-1-X.
  3191             20  FILLER                PIC X(3)  VALUE SPACES.
  3192             20  HOLD-CEN-1-X-CCYY.
  3193                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3194                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3195             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3196             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3197         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3198             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3199             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3200             20  HOLD-CEN-1-R-X-CCYY.
  3201                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3202                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3203             20  FILLER                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  57
* SOCK03.cbl
  3204         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3205         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3206         16  DC-JULIAN-DATE-1          PIC 9(07).
  3207         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3208             20  DC-JULIAN-1-CCYY.
  3209                 24  DC-JULIAN-1-CC    PIC 99.
  3210                 24  DC-JULIAN-1-YR    PIC 99.
  3211             20  DC-JULIAN-DA-1        PIC 999.
  3212         16  DC-JULIAN-DATE-2          PIC 9(07).
  3213         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3214             20  DC-JULIAN-2-CCYY.
  3215                 24  DC-JULIAN-2-CC    PIC 99.
  3216                 24  DC-JULIAN-2-YR    PIC 99.
  3217             20  DC-JULIAN-DA-2        PIC 999.
  3218         16  DC-GREG-DATE-A-EDIT.
  3219             20  DC-EDITA-MONTH        PIC 99.
  3220             20  SLASHA-1              PIC X VALUE '/'.
  3221             20  DC-EDITA-DAY          PIC 99.
  3222             20  SLASHA-2              PIC X VALUE '/'.
  3223             20  DC-EDITA-CCYY.
  3224                 24  DC-EDITA-CENT     PIC 99.
  3225                 24  DC-EDITA-YEAR     PIC 99.
  3226         16  DC-GREG-DATE-B-EDIT.
  3227             20  DC-EDITB-MONTH        PIC 99.
  3228             20  SLASHB-1              PIC X VALUE '/'.
  3229             20  DC-EDITB-DAY          PIC 99.
  3230             20  SLASHB-2              PIC X VALUE '/'.
  3231             20  DC-EDITB-CCYY.
  3232                 24  DC-EDITB-CENT     PIC 99.
  3233                 24  DC-EDITB-YEAR     PIC 99.
  3234         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3235         16  DC-GREG-DATE-CYMD-R REDEFINES
  3236                              DC-GREG-DATE-CYMD.
  3237             20  DC-CYMD-CEN           PIC 99.
  3238             20  DC-CYMD-YEAR          PIC 99.
  3239             20  DC-CYMD-MONTH         PIC 99.
  3240             20  DC-CYMD-DAY           PIC 99.
  3241         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3242         16  DC-GREG-DATE-MDCY-R REDEFINES
  3243                              DC-GREG-DATE-MDCY.
  3244             20  DC-MDCY-MONTH         PIC 99.
  3245             20  DC-MDCY-DAY           PIC 99.
  3246             20  DC-MDCY-CEN           PIC 99.
  3247             20  DC-MDCY-YEAR          PIC 99.
  3248    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3249        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3250    12  DC-EL310-DATE                  PIC X(21).
  3251    12  FILLER                         PIC X(28).
  3252*                                 COPY ELCCALC.
  3253******************************************************************
  3254*                                                                *
  3255*                           ELCCALC.                            *
  3256*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3257*                            VMOD=2.025                          *
  3258*                                                                *
  3259*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3260*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3261*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  58
* SOCK03.cbl
  3262*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3263*                                                                *
  3264*  PASSED TO ELRTRM                                              *
  3265*  -----------------                                             *
  3266*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3267*  ORIGINAL TERM                                                 *
  3268*  BEGINNING DATE                                                *
  3269*  ENDING DATE                                                   *
  3270*  COMPANY I.D.                                                  *
  3271*  ACCOUNT MASTER USER FIELD                                     *
  3272*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3273*  FREE LOOK DAYS                                                *
  3274*                                                                *
  3275*  RETURNED FROM ELRTRM                                          *
  3276*  ---------------------                                         *
  3277*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3278*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3279*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3280*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3281*----------------------------------------------------------------*
  3282*  PASSED TO ELRAMT                                              *
  3283*  ----------------                                              *
  3284*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3285*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3286*  ORIGINAL AMOUNT                                               *
  3287*  ALTERNATE BENEFIT (BALLON)                                    *
  3288*  A.P.R. - NET PAY ONLY                                         *
  3289*  METHOD
  3290*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3291*  COMPANY I.D.                                                  *
  3292*  BENEFIT TYPE                                                  *
  3293*                                                                *
  3294*  RETURNED FROM ELRAMT                                          *
  3295*  --------------------                                          *
  3296*  REMAINING AMOUNT 1 - CURRENT                                  *
  3297*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3298*  REMAINING AMOUNT FACTOR
  3299*----------------------------------------------------------------*
  3300*  PASSED TO ELRESV                                              *
  3301*  -----------------                                             *
  3302*  CERTIFICATE EFFECTIVE DATE                                    *
  3303*  VALUATION DATE                                                *
  3304*  PAID THRU DATE                                                *
  3305*  BENEFIT                                                       *
  3306*  INCURRED DATE                                                 *
  3307*  REPORTED DATE                                                 *
  3308*  ISSUE AGE                                                     *
  3309*  TERM                                                          *
  3310*  CDT PERCENT                                                   *
  3311*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3312* *CLAIM TYPE (LIFE, A/H)                                        *
  3313* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3314* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3315*                                                                *
  3316*  RETURNED FROM ELRESV                                          *
  3317*  --------------------                                          *
  3318*  CDT TABLE USED                                                *
  3319*  CDT FACTOR USED                                               *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  59
* SOCK03.cbl
  3320*  PAY TO CURRENT RESERVE                                        *
  3321*  I.B.N.R. - A/H ONLY                                           *
  3322*  FUTURE (ACCRUED) AH ONLY                                      *
  3323*----------------------------------------------------------------*
  3324*  PASSED TO ELRATE                                              *
  3325*  ----------------                                              *
  3326*  CERT ISSUE DATE                                               *
  3327*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3328*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3329*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3330*  STATE CODE (CLIENT DEFINED)                                   *
  3331*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3332*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3333*  DEVIATION CODE                                                *
  3334*  ISSUE AGE                                                     *
  3335*  ORIGINAL BENEFIT AMOUNT                                       *
  3336*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3337*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3338*  BENEFIT KIND (LIFE OR A/H)                                    *
  3339*  A.P.R.                                                        *
  3340*  METHOD
  3341*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3342*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3343*  COMPANY I.D. (3 CHARACTER)                                    *
  3344*  BENEFIT CODE                                                  *
  3345*  BENEFIT OVERRIDE CODE                                         *
  3346*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3347*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3348*  JOINT INDICATOR (CSL ONLY)                                    *
  3349*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3350*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3351*                                                                *
  3352*  RETURNED FROM ELRATE                                          *
  3353*  --------------------                                          *
  3354*  CALCULATED PREMIUM                                            *
  3355*  PREMIUM RATE                                                  *
  3356*  MORTALITY CODE                                                *
  3357*  MAX ATTAINED AGE                                              *
  3358*  MAX AGE                                                       *
  3359*  MAX TERM                                                      *
  3360*  MAX MONTHLY BENEFIT                                           *
  3361*  MAX TOTAL BENIFIT                                             *
  3362*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3363*----------------------------------------------------------------*
  3364*  PASSED TO ELRFND                                              *
  3365*  ----------------                                              *
  3366*  CERT ISSUE DATE                                               *
  3367*  REFUND DATE                                                   *
  3368*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3369*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3370*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3371*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3372*  STATE CODE (CLIENT DEFINED)                                   *
  3373*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3374*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3375*  DEVIATION CODE                                                *
  3376*  ISSUE AGE                                                     *
  3377*  ORIGINAL BENEFIT AMOUNT                                       *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  60
* SOCK03.cbl
  3378*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3379*  PROCESS TYPE (CANCEL)                                         *
  3380*  BENEFIT KIND (LIFE OR A/H)                                    *
  3381*  A.P.R.                                                        *
  3382*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3383*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3384*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3385*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3386*  COMPANY I.D. (3 CHARACTER)                                    *
  3387*  BENEFIT CODE                                                  *
  3388*  BENEFIT OVERRIDE CODE                                         *
  3389*                                                                *
  3390*  RETURNED FROM ELRFND                                          *
  3391*  --------------------                                          *
  3392*  CALCULATED REFUND                                             *
  3393*----------------------------------------------------------------*
  3394*  PASSED TO ELEARN                                              *
  3395*  ----------------                                              *
  3396*  CERT ISSUE DATE                                               *
  3397*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3398*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3399*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3400*  STATE CODE (CLIENT DEFINED)                                   *
  3401*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3402*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3403*  DEVIATION CODE                                                *
  3404*  ISSUE AGE                                                     *
  3405*  ORIGINAL BENEFIT AMOUNT                                       *
  3406*  BENEFIT KIND (LIFE OR A/H)                                    *
  3407*  A.P.R.                                                        *
  3408*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3409*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3410*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3411*  COMPANY I.D. (3 CHARACTER)                                    *
  3412*  BENEFIT CODE                                                  *
  3413*  BENEFIT OVERRIDE CODE                                         *
  3414*                                                                *
  3415*  RETURNED FROM ELEARN                                          *
  3416*  --------------------                                          *
  3417*  INDICATED  EARNINGS                                           *
  3418*----------------------------------------------------------------*
  3419*                 LENGTH = 450                                   *
  3420*                                                                *
  3421******************************************************************
  3422******************************************************************
  3423*                   C H A N G E   L O G
  3424*
  3425* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3426*-----------------------------------------------------------------
  3427*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3428* EFFECTIVE    NUMBER
  3429*-----------------------------------------------------------------
  3430* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3431* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3432* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3433* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3434* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3435* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  61
* SOCK03.cbl
  3436* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3437* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3438* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3439* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3440******************************************************************
  3441
  3442 01  CALCULATION-PASS-AREA.
  3443     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3444                                     COMP.
  3445
  3446     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3447       88  NO-CP-ERROR                             VALUE ZERO.
  3448       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3449                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3450       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3451       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3452       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3453       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3454       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3455       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3456       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3457       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3458       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3459       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3460       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3461       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3462       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3463       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3464       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3465       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3466       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3467
  3468     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3469       88  NO-CP-ERROR-2                           VALUE ZERO.
  3470***********************  INPUT AREAS ****************************
  3471
  3472     12  CP-CALCULATION-AREA.
  3473         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3474         16  CP-CERT-EFF-DT        PIC XX.
  3475         16  CP-VALUATION-DT       PIC XX.
  3476         16  CP-PAID-THRU-DT       PIC XX.
  3477         16  CP-BENEFIT-TYPE       PIC X.
  3478           88  CP-AH                               VALUE 'A' 'D'
  3479                                                   'I' 'U'.
  3480           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3481           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3482         16  CP-INCURRED-DT        PIC XX.
  3483         16  CP-REPORTED-DT        PIC XX.
  3484         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3485         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3486         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3487                                     COMP-3.
  3488         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3489                                     COMP-3.
  3490         16  CP-CDT-METHOD         PIC X.
  3491           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3492           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3493           88  CP-CDT-INTERPOLATED                 VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  62
* SOCK03.cbl
  3494         16  CP-CLAIM-TYPE         PIC X.
  3495           88  CP-AH-CLAIM                         VALUE 'A'.
  3496           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3497         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3498                                     COMP-3.
  3499         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3500                                     COMP-3.
  3501         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3502                                     COMP-3.
  3503         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3504                                     COMP-3.
  3505         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3506                                     COMP-3.
  3507         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3508                                     COMP-3.
  3509         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3510                                     COMP-3.
  3511         16  CP-REM-TERM-METHOD    PIC X.
  3512           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3513           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3514           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3515           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3516           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3517           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3518           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3519         16  CP-EARNING-METHOD     PIC X.
  3520           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3521           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3522           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3523           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3524           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3525           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3526           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3527           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3528           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3529           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3530           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3531           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3532           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3533           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3534         16  CP-PROCESS-TYPE       PIC X.
  3535           88  CP-CLAIM                            VALUE '1'.
  3536           88  CP-CANCEL                           VALUE '2'.
  3537           88  CP-ISSUE                            VALUE '3'.
  3538         16  CP-SPECIAL-CALC-CD    PIC X.
  3539           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3540           88  CP-1-MTH-INTEREST               VALUE ' '.
  3541           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3542           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3543           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3544           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3545           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3546           88  CP-FARM-PLAN                    VALUE 'F'.
  3547           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3548           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3549           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3550           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3551           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  63
* SOCK03.cbl
  3552           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3553           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3554           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3555           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3556           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3557                                                     'W' 'X'.
  3558           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3559           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3560           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3561           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3562           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3563           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3564           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3565           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3566           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3567           88  CP-CSL-METH-1                   VALUE '5'.
  3568           88  CP-CSL-METH-2                   VALUE '6'.
  3569           88  CP-CSL-METH-3                   VALUE '7'.
  3570           88  CP-CSL-METH-4                   VALUE '8'.
  3571
  3572         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3573                                     COMP-3.
  3574         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3575         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3576         16  CP-STATE              PIC XX          VALUE SPACE.
  3577         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3578         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3579           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3580               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3581         16  CP-R78-OPTION         PIC X.
  3582           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3583           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3584
  3585         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3586         16  CP-IBNR-RESERVE-SW    PIC X.
  3587         16  CP-CLAIM-STATUS       PIC X.
  3588         16  CP-RATE-FILE          PIC X.
  3589         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3590                                     COMP-3.
  3591
  3592         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3593         16  CP-AH-OVERRIDE-CODE   PIC X.
  3594
  3595         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3596                                     COMP-3.
  3597         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3598                                   PIC S9(5)V99 COMP-3.
  3599         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3600                                     COMP-3.
  3601         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3602                                     COMP-3.
  3603         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3604                                     COMP-3.
  3605         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3606                                  PIC S9(7)V99 COMP-3.
  3607
  3608         16  CP-PAID-FROM-DATE     PIC X(02).
  3609         16  CP-CLAIM-CALC-METHOD  PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  64
* SOCK03.cbl
  3610         16  CP-EXT-DAYS-CALC      PIC X.
  3611           88  CP-EXT-NO-CHG                   VALUE ' '.
  3612           88  CP-EXT-CHG-LF                   VALUE '1'.
  3613           88  CP-EXT-CHG-AH                   VALUE '2'.
  3614           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3615         16  CP-DOMICILE-STATE     PIC XX.
  3616         16  CP-CARRIER            PIC X.
  3617         16  CP-REIN-FLAG          PIC X.
  3618         16  CP-REM-TRM-CALC-OPTION PIC X.
  3619           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3620                      '2' '3' '4' '5'.
  3621           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3622           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3623           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3624           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3625           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3626           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3627           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3628           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3629         16  CP-SIG-SWITCH         PIC X.
  3630         16  CP-RATING-METHOD      PIC X.
  3631           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3632           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3633           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3634           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3635           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3636           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3637           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3638           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3639           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3640         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3641                                     COMP-3.
  3642         16  CP-BEN-CATEGORY       PIC X.
  3643         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3644         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3645                                   PIC S99V9(5) COMP-3.
  3646         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3647         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3648                                   PIC S99V9(5) COMP-3.
  3649         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3650         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3651         16  CP-EXPIRE-DT          PIC XX.
  3652         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3653         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3654         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3655         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3656         16  CP-DDF-SPEC-CALC      PIC X.
  3657             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3658             88  CP-CALC-CLP              VALUE 'C'.
  3659         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3660         16  CP-CANCEL-REASON      PIC X.
  3661         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3662         16  CP-PMT-MODE           PIC X.
  3663         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3664         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3665         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3666         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3667         16  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  65
* SOCK03.cbl
  3668
  3669***************    OUTPUT FROM ELRESV   ************************
  3670
  3671         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3672
  3673         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3674                                     COMP-3.
  3675         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3676                                     COMP-3.
  3677         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3678                                     COMP-3.
  3679         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3680                                     COMP-3.
  3681         16  FILLER                PIC X(09).
  3682***************    OUTPUT FROM ELRTRM   *************************
  3683
  3684         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3685                                     COMP-3.
  3686         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3687                                     COMP-3.
  3688         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3689                                     COMP-3.
  3690         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3691                                     COMP-3.
  3692         16  FILLER                PIC X(12).
  3693
  3694***************    OUTPUT FROM ELRAMT   *************************
  3695
  3696         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3697                                     COMP-3.
  3698         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3699                                     COMP-3.
  3700         16  FILLER                PIC X(12).
  3701
  3702***************    OUTPUT FROM ELRATE   *************************
  3703
  3704         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3705                                     COMP-3.
  3706         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3707                                     COMP-3.
  3708         16  CP-MORTALITY-CODE     PIC X(4).
  3709         16  CP-RATE-EDIT-FLAG     PIC X.
  3710             88  CP-RATES-NEED-APR                  VALUE '1'.
  3711         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3712                                     COMP-3.
  3713         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3714         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3715         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3716                                   PIC S9(7)V99 COMP-3.
  3717         16  FILLER                PIC X(07).
  3718
  3719***************    OUTPUT FROM ELRFND   *************************
  3720
  3721         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3722                                     COMP-3.
  3723         16  CP-REFUND-TYPE-USED   PIC X.
  3724           88  CP-R-AS-R78                         VALUE '1'.
  3725           88  CP-R-AS-PRORATA                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  66
* SOCK03.cbl
  3726           88  CP-R-AS-CALIF                       VALUE '3'.
  3727           88  CP-R-AS-TEXAS                       VALUE '4'.
  3728           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3729           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3730           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3731           88  CP-R-AS-MEAN                        VALUE '8'.
  3732           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3733           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3734           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3735           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3736           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3737           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3738         16  FILLER                PIC X(12).
  3739
  3740***************    OUTPUT FROM ELEARN   *************************
  3741
  3742         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3743                                     COMP-3.
  3744         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3745                                     COMP-3.
  3746         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3747                                     COMP-3.
  3748         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3749                                     COMP-3.
  3750         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3751                                     COMP-3.
  3752         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3753                                     COMP-3.
  3754         16  CP-EARNING-TYPE-USED  PIC X.
  3755           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3756           88  CP-E-AS-R78                         VALUE '1'.
  3757           88  CP-E-AS-PRORATA                     VALUE '2'.
  3758           88  CP-E-AS-TEXAS                       VALUE '4'.
  3759           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3760           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3761           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3762           88  CP-E-AS-MEAN                        VALUE '8'.
  3763           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3764         16  FILLER                PIC X(12).
  3765
  3766***************    OUTPUT FROM ELPMNT   *************************
  3767
  3768         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3769                                     COMP-3.
  3770         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3771                                     COMP-3.
  3772         16  FILLER                PIC X(12).
  3773
  3774***************   MISC WORK AREAS    *****************************
  3775         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3776                                     COMP-3.
  3777         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3778                                     COMP-3.
  3779         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3780                                     COMP-3.
  3781         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3782                                     COMP-3.
  3783         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  67
* SOCK03.cbl
  3784                                     COMP-3.
  3785         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3786                                     COMP-3.
  3787         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3788             88  OPEN-RATE-FILE                   VALUE 'O'.
  3789             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3790             88  IO-ERROR                         VALUE 'E'.
  3791
  3792         16  CP-FIRST-PAY-DATE     PIC XX.
  3793
  3794         16  CP-JOINT-INDICATOR    PIC X.
  3795
  3796         16  CP-RESERVE-REMAINING-TERM
  3797                                   PIC S9(4)V9    VALUE ZERO
  3798                                     COMP-3.
  3799
  3800         16  CP-INSURED-BIRTH-DT   PIC XX.
  3801
  3802         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3803                                     COMP-3.
  3804
  3805         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3806                                     COMP-3.
  3807
  3808         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3809                                     COMP-3.
  3810
  3811         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3812                                     COMP-3.
  3813
  3814         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3815                                     COMP-3.
  3816
  3817         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3818                                     COMP-3.
  3819
  3820         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3821                                     COMP-3.
  3822
  3823         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3824             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3825
  3826         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3829                                     COMP-3.
  3830         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3831         16  cp-extra-periods      pic 9 value zeros.
  3832         16  cp-net-only-state     pic x value spaces.
  3833         16  FILLER                PIC X(13).
  3834******************************************************************
  3835****************************************************************
  3836*
  3837* Copyright (c) 2007 by Clerity Solutions, Inc.
  3838* All rights reserved.
  3839*
  3840****************************************************************
  3841 01  DFHEIV.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  68
* SOCK03.cbl
  3842   02  DFHEIV0               PIC X(35).
  3843   02  DFHEIV1               PIC X(08).
  3844   02  DFHEIV2               PIC X(08).
  3845   02  DFHEIV3               PIC X(08).
  3846   02  DFHEIV4               PIC X(06).
  3847   02  DFHEIV5               PIC X(04).
  3848   02  DFHEIV6               PIC X(04).
  3849   02  DFHEIV7               PIC X(02).
  3850   02  DFHEIV8               PIC X(02).
  3851   02  DFHEIV9               PIC X(01).
  3852   02  DFHEIV10              PIC S9(7) COMP-3.
  3853   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3854   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3855   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3856   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3857   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3858   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3859   02  DFHEIV17              PIC X(04).
  3860   02  DFHEIV18              PIC X(04).
  3861   02  DFHEIV19              PIC X(04).
  3862   02  DFHEIV20              USAGE IS POINTER.
  3863   02  DFHEIV21              USAGE IS POINTER.
  3864   02  DFHEIV22              USAGE IS POINTER.
  3865   02  DFHEIV23              USAGE IS POINTER.
  3866   02  DFHEIV24              USAGE IS POINTER.
  3867   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3868   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3869   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3870   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3871   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3872   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3873   02  FILLER                PIC X(02).
  3874   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3875   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3876   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3877   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3878   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3879 LINKAGE  SECTION.
  3880*****************************************************************
  3881*                                                               *
  3882* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3883* All rights reserved.                                          *
  3884*                                                               *
  3885*****************************************************************
  3886 01  dfheiblk.
  3887     02  eibtime          pic s9(7) comp-3.
  3888     02  eibdate          pic s9(7) comp-3.
  3889     02  eibtrnid         pic x(4).
  3890     02  eibtaskn         pic s9(7) comp-3.
  3891     02  eibtrmid         pic x(4).
  3892     02  dfheigdi         pic s9(4) comp.
  3893     02  eibcposn         pic s9(4) comp.
  3894     02  eibcalen         pic s9(4) comp.
  3895     02  eibaid           pic x(1).
  3896     02  eibfiller1       pic x(1).
  3897     02  eibfn            pic x(2).
  3898     02  eibfiller2       pic x(2).
  3899     02  eibrcode         pic x(6).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  69
* SOCK03.cbl
  3900     02  eibfiller3       pic x(2).
  3901     02  eibds            pic x(8).
  3902     02  eibreqid         pic x(8).
  3903     02  eibrsrce         pic x(8).
  3904     02  eibsync          pic x(1).
  3905     02  eibfree          pic x(1).
  3906     02  eibrecv          pic x(1).
  3907     02  eibsend          pic x(1).
  3908     02  eibatt           pic x(1).
  3909     02  eibeoc           pic x(1).
  3910     02  eibfmh           pic x(1).
  3911     02  eibcompl         pic x(1).
  3912     02  eibsig           pic x(1).
  3913     02  eibconf          pic x(1).
  3914     02  eiberr           pic x(1).
  3915     02  eibrldbk         pic x(1).
  3916     02  eiberrcd         pic x(4).
  3917     02  eibsynrb         pic x(1).
  3918     02  eibnodat         pic x(1).
  3919     02  eibfiller5       pic x(2).
  3920     02  eibresp          pic 9(09) comp.
  3921     02  eibresp2         pic 9(09) comp.
  3922     02  dfheigdj         pic s9(4) comp.
  3923     02  dfheigdk         pic s9(4) comp.
  3924 01  DFHCOMMAREA.
  3925   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3926   05 LSTN-NAME                PIC X(8).
  3927   05 LSTN-SUBNAME             PIC X(8).
  3928   05 CLIENT-IN-DATA.
  3929      15  CLIENT-CAR           PIC X.
  3930      15  CLIENT-GRP           PIC X(6).
  3931      15  CLIENT-STATE         PIC XX.
  3932      15  CLIENT-ACCOUNT       PIC X(10).
  3933*  DATES ARE IN FORMAT CCYYMMDD  ie. 20090330
  3934      15  CLIENT-EFF-DT        PIC X(8).
  3935      15  CLIENT-CERT-NO       PIC X(11).
  3936      15  CLIENT-LAST-NAME     PIC X(15).
  3937      15  CLIENT-FIRST-NAME    PIC X(10).
  3938      15  CLIENT-VAL-DT        PIC X(8).
  3939      15  CLIENT-CAN-REASON    PIC X.
  3940   05 SOCKADDR-IN-PARM.
  3941     15 SIN-FAMILY             PIC 9(4) COMP.
  3942     15 SIN-PORT               PIC 9(4) COMP.
  3943     15 SIN-ADDRESS            PIC 9(8) COMP.
  3944     15 SIN-ZERO               PIC X(8).
  3945 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3946 0000-DFHEXIT SECTION.
  3947     MOVE '9#                    $   ' TO DFHEIV0.
  3948     MOVE 'SOCK03' TO DFHEIV1.
  3949     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3950     display '  BEGIN SOCK03 '
  3951     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  3952     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  3953     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  3954        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  3955        evaluate true
  3956           when client-in-data (8:3) = 'AHL'
  3957              MOVE X'06'         TO WS-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  70
* SOCK03.cbl
  3958              MOVE 'AHL'         TO WS-SEND-BUF (5:3)
  3959                                    WS-COMP-ID
  3960           when CLIENT-IN-DATA (8:3) = 'DCC'
  3961              MOVE X'05'         TO WS-COMP-CD
  3962              MOVE 'DCC'         TO WS-SEND-BUF (5:3)
  3963                                    WS-COMP-ID
  3964           when CLIENT-IN-DATA (8:3) = 'CAP'
  3965              MOVE X'07'         TO WS-COMP-CD
  3966              MOVE 'CAP'         TO WS-SEND-BUF (5:3)
  3967                                    WS-COMP-ID
  3968           when other
  3969              MOVE X'04'         TO WS-COMP-CD
  3970              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  3971                                    WS-COMP-ID
  3972        end-evaluate
  3973        move 'CSO'               to ws-send-buf (1:3)
  3974        move +25                 to ws-send-msg-size
  3975     END-IF
  3976     display 'SOCK03:sequence number  =', ws-seq-num.
  3977     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  3978     call "send" using by value GIVE-TAKE-SOCKET,
  3979         by reference ws-send-buf,
  3980         by value ws-send-msg-size,
  3981         by value ws-flags.
  3982     if return-code <= zero
  3983         display 'SOCK03:send error ',
  3984         go to socket-error.
  3985     move low-values to ws-recv-buf.
  3986     set ws-recv-total to zero.
  3987     compute ws-recv-left = ws-recv-msg-size.
  3988     display 'SOCK03:About to recv '
  3989     call "recv" using by value GIVE-TAKE-SOCKET,
  3990         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3991         by value ws-recv-left,
  3992         by value ws-flags.
  3993     if return-code < zero
  3994        display 'SOCK03:recv error ',
  3995        go to socket-error.
  3996     if return-code = zero
  3997        display 'SOCK03:client disconnected',
  3998        go to socket-error.
  3999*
  4000     display 'SOCK03:Good recv  '
  4001     display 'SOCK03:return code      = ', return-code
  4002     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:75)
  4003     move +4096                  to ws-send-msg-size
  4004*    move +750                   to ws-send-msg-size
  4005     move ws-recv-buf (1:72)     to client-in-data
  4006     MOVE SPACES                 TO WS-ELCERT-SW
  4007     MOVE X'0A'                  TO WS-HEX-0A
  4008     if client-account = 'EPIQ000001'
  4009        set ws-epiq-request to true
  4010        move spaces              to client-account
  4011     end-if
  4012     move +0 to ws-epiq-max
  4013     EVALUATE TRUE
  4014        WHEN (CLIENT-CAR NOT = SPACES)
  4015           AND (CLIENT-STATE NOT = SPACES)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  71
* SOCK03.cbl
  4016           AND (CLIENT-ACCOUNT NOT = SPACES)
  4017           AND (CLIENT-EFF-DT NOT = SPACES)
  4018           AND (CLIENT-CERT-NO NOT = SPACES)
  4019           SET WS-ELCERT-FULL    TO TRUE
  4020           DISPLAY ' SETTING FULL '
  4021        WHEN (CLIENT-CERT-NO NOT = SPACES)
  4022           SET WS-ELCERT-CERT-NO TO TRUE
  4023           DISPLAY ' SETTING CERT NO '
  4024*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  4025*          AND (CLIENT-LAST-NAME NOT = SPACES)
  4026        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  4027           AND (CLIENT-LAST-NAME NOT = SPACES)
  4028           SET WS-ELCERT-ACT-NAME TO TRUE
  4029        WHEN CLIENT-LAST-NAME NOT = SPACES
  4030           SET WS-ELCERT-NAME    TO TRUE
  4031           DISPLAY ' SETTING NAME '
  4032        WHEN OTHER
  4033           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  4034           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4035           MOVE ZEROS            TO WS-RESP
  4036           PERFORM 0030-BUILD-BUFFER
  4037                                 THRU 0030-EXIT
  4038           PERFORM 0020-SEND-BUFFER
  4039                                 THRU 0020-EXIT
  4040           PERFORM 0025-CLOSE-SOCKET
  4041                                 THRU 0025-EXIT
  4042           GO TO 0010-RETURN
  4043     END-EVALUATE
  4044     IF CLIENT-CAN-REASON = 'R'
  4045        MOVE 'R'                 TO WS-CANCEL-REASON
  4046     ELSE
  4047        MOVE ' '                 TO WS-CANCEL-REASON
  4048     END-IF
  4049     IF WS-ELCERT-KEY-SW NOT = SPACES
  4050        PERFORM 0050-BEGIN-REFUND-PROCESS
  4051                                 THRU 0050-EXIT
  4052     END-IF
  4053     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  4054     .
  4055 0010-RETURN.
  4056
  4057* exec cics return end-exec.
  4058*    MOVE '.(                    ''   #00004052' TO DFHEIV0
  4059     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4060     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4061     MOVE X'2020233030303034303532' TO DFHEIV0(25:11)
  4062     CALL 'kxdfhei1' USING DFHEIV0,
  4063           DFHEIV99,
  4064           DFHEIV99,
  4065           DFHEIV99,
  4066           DFHEIV99,
  4067           DFHEIV99,
  4068           DFHEIV99
  4069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4070
  4071
  4072* goback.
  4073     MOVE '9%                    "   ' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  72
* SOCK03.cbl
  4074     MOVE 'SOCK03' TO DFHEIV1
  4075     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4076     goback.
  4077*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4078     .
  4079 0020-SEND-BUFFER.
  4080     display 'SOCK03:About to send      '
  4081     display 'SOCK03:sequence number  =', ws-seq-num.
  4082     display 'SOCK03:send buffer      =', ws-send-buf(1:300).
  4083     call "send" using by value GIVE-TAKE-SOCKET,
  4084         by reference ws-send-buf,
  4085         by value ws-send-msg-size,
  4086         by value ws-flags.
  4087     if return-code <= zero
  4088         display 'SOCK03:send error ' return-code,
  4089         go to socket-error.
  4090 0020-EXIT.
  4091     EXIT.
  4092 0025-CLOSE-SOCKET.
  4093*    display 'SOCK03:closing socket'.
  4094*    call "close" using by value GIVE-TAKE-SOCKET .
  4095     display 'SOCK03:done'.
  4096     .
  4097 0025-EXIT.
  4098     EXIT.
  4099*
  4100* set up the receive buffer
  4101*
  4102     move low-values to ws-recv-buf.
  4103     set ws-recv-total to zero.
  4104     compute ws-recv-left = ws-recv-msg-size.
  4105*
  4106* receive data
  4107*
  4108 recv-1.
  4109     call "recv" using by value GIVE-TAKE-SOCKET,
  4110         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4111         by value ws-recv-left,
  4112         by value ws-flags.
  4113*
  4114* test what was received and decide what we should do
  4115*
  4116     if return-code < zero
  4117        display 'SOCK03:recv error ',
  4118        go to socket-error.
  4119     if return-code = zero
  4120        display 'SOCK03:client disconnected',
  4121        go to socket-error.
  4122*
  4123* have we received all the data yet?
  4124*
  4125     compute ws-recv-total = ws-recv-total + return-code.
  4126     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  4127*
  4128* not yet
  4129*
  4130     if ws-recv-left > 0 go to recv-1.
  4131*
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  73
* SOCK03.cbl
  4132* received all the data
  4133*
  4134     display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  4135*
  4136* make sure what we received was what we sent
  4137*
  4138*    if ws-recv-buf <> ws-send-buf
  4139*        display "SOCK03:data doesn't match",
  4140*        go to socket-error.
  4141*
  4142* end of pass
  4143*
  4144*loop-end.
  4145*    if ws-seq-num = 5 go to socket-error.
  4146*    go to loop-1.
  4147*
  4148* program end
  4149*
  4150 socket-error.
  4151     if ws-seq-num <> 0
  4152         display "SOCK03:did not complete".
  4153*
  4154* flush the send buffer and deallocate
  4155*
  4156*    display 'SOCK03:closing socket'.
  4157*    call "close" using by value GIVE-TAKE-SOCKET .
  4158*
  4159* finised return to cics
  4160*
  4161 socket-fin.
  4162*    display 'SOCK03:closing socket'.
  4163*    call "close" using by value GIVE-TAKE-SOCKET .
  4164     display 'SOCK03:done'.
  4165
  4166* exec cics return end-exec.
  4167*    MOVE '.(                    ''   #00004142' TO DFHEIV0
  4168     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4169     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4170     MOVE X'2020233030303034313432' TO DFHEIV0(25:11)
  4171     CALL 'kxdfhei1' USING DFHEIV0,
  4172           DFHEIV99,
  4173           DFHEIV99,
  4174           DFHEIV99,
  4175           DFHEIV99,
  4176           DFHEIV99,
  4177           DFHEIV99
  4178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4179
  4180
  4181* goback.
  4182     MOVE '9%                    "   ' TO DFHEIV0
  4183     MOVE 'SOCK03' TO DFHEIV1
  4184     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4185     goback.
  4186 0030-BUILD-BUFFER.
  4187     MOVE SPACES                 TO WS-SEND-BUF
  4188     IF WS-CALL-TYPE = 'NEWBUS'
  4189        STRING
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  74
* SOCK03.cbl
  4190           WS-COMMENT            ';'
  4191           WS-RESP               ';'
  4192           WS-CARRIER            ';'
  4193           WS-GROUPING           ';'
  4194           WS-STATE              ';'
  4195           WS-ACCOUNT            ';'
  4196           WS-CERT-EFF-DATE      ';'
  4197           WS-CERT-NO            ';'
  4198           WS-LAST-NAME          ';'
  4199           WS-FIRST-NAME         ';'
  4200           WS-MID-INIT           ';'
  4201           WS-LAST-JNAME         ';'
  4202           WS-FIRST-JNAME        ';'
  4203           WS-MID-JINIT          ';'
  4204           WS-POST-CARD-SW       ';'
  4205           ws-lf-coverage-type   ';'
  4206           WS-LF-STATUS          ';'
  4207           WS-LF-BEN-CODE        ';'
  4208           WS-LF-BEN-CODE-DESC   ';'
  4209           WS-LF-TERM            ';'
  4210           WS-LF-REM-TERM        ';'
  4211           WS-LF-PREM            ';'
  4212           WS-LF-REFUND          ';'
  4213           WS-LF-METHOD          ';'
  4214           WS-LF-ORIG-BENEFIT    ';'
  4215           WS-LF-REM-BEN         ';'
  4216           WS-LF-EXPIRE-DATE     ';'
  4217           WS-LF-COMM            ';'
  4218           WS-LF-UEC             ';'
  4219           WS-AH-COVERAGE-TYPE   ';'
  4220           WS-AH-STATUS          ';'
  4221           WS-AH-BEN-CODE        ';'
  4222           WS-AH-BEN-CODE-DESC   ';'
  4223           WS-AH-TERM            ';'
  4224           WS-AH-REM-TERM        ';'
  4225           WS-AH-PREM            ';'
  4226           WS-AH-REFUND          ';'
  4227           WS-AH-METHOD          ';'
  4228           WS-AH-ORIG-BENEFIT    ';'
  4229           WS-AH-REM-BEN         ';'
  4230           WS-AH-EXPIRE-DATE     ';'
  4231           WS-AH-COMM            ';'
  4232           WS-AH-UEC             ';'
  4233           WS-ACCOUNT-NAME       ';'
  4234           WS-REPORT-CODE-1      ';'
  4235           WS-REPORT-CODE-2      ';'
  4236           WS-REPORT-CODE-3      ';'
  4237           WS-CLM-PAID-THRU-DT   ';'
  4238           WS-HEX-0A
  4239            DELIMITED BY '  ' INTO WS-SEND-BUF
  4240        END-STRING
  4241     ELSE
  4242        STRING
  4243           WS-COMMENT            ';'
  4244           WS-RESP               ';'
  4245           WS-CARRIER            ';'
  4246           WS-GROUPING           ';'
  4247           WS-STATE              ';'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  75
* SOCK03.cbl
  4248           WS-ACCOUNT            ';'
  4249           WS-CERT-EFF-DATE      ';'
  4250           WS-CERT-NO            ';'
  4251           WS-LAST-NAME          ';'
  4252           WS-FIRST-NAME         ';'
  4253           WS-MID-INIT           ';'
  4254           WS-LAST-JNAME         ';'
  4255           WS-FIRST-JNAME        ';'
  4256           WS-MID-JINIT          ';'
  4257           WS-POST-CARD-SW       ';'
  4258           WS-LF-STATUS          ';'
  4259           WS-LF-BEN-CODE        ';'
  4260           WS-LF-BEN-CODE-DESC   ';'
  4261           WS-LF-TERM            ';'
  4262           WS-LF-REM-TERM        ';'
  4263           WS-LF-PREM            ';'
  4264           WS-LF-REFUND          ';'
  4265           WS-LF-METHOD          ';'
  4266           WS-LF-ORIG-BENEFIT    ';'
  4267           WS-LF-REM-BEN         ';'
  4268           WS-LF-EXPIRE-DATE     ';'
  4269           WS-LF-COMM            ';'
  4270           WS-LF-UEC             ';'
  4271           WS-AH-STATUS          ';'
  4272           WS-AH-BEN-CODE        ';'
  4273           WS-AH-BEN-CODE-DESC   ';'
  4274           WS-AH-TERM            ';'
  4275           WS-AH-REM-TERM        ';'
  4276           WS-AH-PREM            ';'
  4277           WS-AH-REFUND          ';'
  4278           WS-AH-METHOD          ';'
  4279           WS-AH-ORIG-BENEFIT    ';'
  4280           WS-AH-REM-BEN         ';'
  4281           WS-AH-EXPIRE-DATE     ';'
  4282           WS-AH-COMM            ';'
  4283           WS-AH-UEC             ';'
  4284           WS-ACCOUNT-NAME       ';'
  4285           WS-REPORT-CODE-1      ';'
  4286           WS-REPORT-CODE-2      ';'
  4287           WS-REPORT-CODE-3      ';'
  4288           WS-CLM-PAID-THRU-DT   ';'
  4289           'E'                   ';'
  4290            DELIMITED BY '  ' INTO WS-SEND-BUF
  4291        END-STRING
  4292     END-IF
  4293     .
  4294 0030-EXIT.
  4295     EXIT.
  4296 0050-BEGIN-REFUND-PROCESS.
  4297     IF WS-ELCERT-ACT-NAME
  4298        PERFORM 0060-FIND-FULL-KEY
  4299                                 THRU 0060-EXIT
  4300        MOVE AM-CARRIER          TO CLIENT-CAR
  4301        MOVE AM-GROUPING         TO CLIENT-GRP
  4302        MOVE AM-STATE            TO CLIENT-STATE
  4303     END-IF
  4304     PERFORM 0100-START-ELCERT     THRU 0100-EXIT
  4305     IF NOT RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  76
* SOCK03.cbl
  4306        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4307        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4308        MOVE WS-RESPONSE         TO WS-RESP
  4309        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4310        PERFORM 0020-SEND-BUFFER
  4311                                 THRU 0020-EXIT
  4312        PERFORM 0025-CLOSE-SOCKET
  4313                                 THRU 0025-EXIT
  4314        GO TO 0010-RETURN
  4315     END-IF
  4316     PERFORM 0150-READ-NEXT-ELCERT
  4317                                 THRU 0150-EXIT
  4318*    display ' came back from 0150 ' ws-response
  4319     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4320        DISPLAY ' CERT NOT FOUND '
  4321        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4322        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4323        MOVE WS-RESPONSE         TO WS-RESP
  4324        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4325        PERFORM 0020-SEND-BUFFER
  4326                                 THRU 0020-EXIT
  4327        PERFORM 0025-CLOSE-SOCKET
  4328                                 THRU 0025-EXIT
  4329        GO TO 0010-RETURN
  4330     END-IF
  4331     PERFORM 0200-BEGIN-REFUND-PROCESS
  4332                                 THRU 0200-EXIT UNTIL
  4333        ELCERT-FINISHED
  4334     .
  4335 0050-EXIT.
  4336     EXIT.
  4337 0060-FIND-FULL-KEY.
  4338     MOVE ' ' TO WS-STOP-SW
  4339     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4340     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4341
  4342* EXEC CICS STARTBR
  4343*       DATASET  ('ERACCT3')
  4344*       RIDFLD   (WS-AM3-KEY)
  4345*       GTEQ
  4346*       RESP (WS-RESPONSE)
  4347*    END-EXEC
  4348     MOVE 'ERACCT3' TO DFHEIV1
  4349     MOVE 0
  4350       TO DFHEIV11
  4351*    MOVE '&,         G          &  N#00004299' TO DFHEIV0
  4352     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4353     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4354     MOVE X'204E233030303034323939' TO DFHEIV0(25:11)
  4355     CALL 'kxdfhei1' USING DFHEIV0,
  4356           DFHEIV1,
  4357           WS-AM3-KEY,
  4358           DFHEIV99,
  4359           DFHEIV11,
  4360           DFHEIV99
  4361     MOVE EIBRESP  TO WS-RESPONSE
  4362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4363     IF RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  77
* SOCK03.cbl
  4364        PERFORM UNTIL TOLD-TO-STOP
  4365
  4366* EXEC CICS READNEXT
  4367*             DATASET  ('ERACCT3')
  4368*             INTO     (ACCOUNT-MASTER)
  4369*             RIDFLD   (WS-AM3-KEY)
  4370*          END-EXEC
  4371     MOVE LENGTH OF
  4372      ACCOUNT-MASTER
  4373       TO DFHEIV12
  4374     MOVE 'ERACCT3' TO DFHEIV1
  4375     MOVE 0
  4376       TO DFHEIV11
  4377*    MOVE '&.IL                  )   #00004307' TO DFHEIV0
  4378     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4379     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4380     MOVE X'2020233030303034333037' TO DFHEIV0(25:11)
  4381     CALL 'kxdfhei1' USING DFHEIV0,
  4382           DFHEIV1,
  4383           ACCOUNT-MASTER,
  4384           DFHEIV12,
  4385           WS-AM3-KEY,
  4386           DFHEIV99,
  4387           DFHEIV11,
  4388           DFHEIV99,
  4389           DFHEIV99
  4390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4391           EVALUATE TRUE
  4392              WHEN (RESP-NORMAL)
  4393                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4394                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4395                 SET TOLD-TO-STOP TO TRUE
  4396              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4397                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4398                 CONTINUE
  4399              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4400                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4401                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4402                 MOVE ZEROS      TO WS-RESP
  4403                 PERFORM 0030-BUILD-BUFFER
  4404                                 THRU 0030-EXIT
  4405                 PERFORM 0020-SEND-BUFFER
  4406                                 THRU 0020-EXIT
  4407                 PERFORM 0025-CLOSE-SOCKET
  4408                                 THRU 0025-EXIT
  4409                 GO TO 0010-RETURN
  4410           END-EVALUATE
  4411        END-PERFORM
  4412
  4413* EXEC CICS ENDBR
  4414*          DATASET   ('ERACCT3')
  4415*       END-EXEC
  4416     MOVE 'ERACCT3' TO DFHEIV1
  4417     MOVE 0
  4418       TO DFHEIV11
  4419*    MOVE '&2                    $   #00004333' TO DFHEIV0
  4420     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4421     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  78
* SOCK03.cbl
  4422     MOVE X'2020233030303034333333' TO DFHEIV0(25:11)
  4423     CALL 'kxdfhei1' USING DFHEIV0,
  4424           DFHEIV1,
  4425           DFHEIV11,
  4426           DFHEIV99
  4427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4428     ELSE
  4429        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4430        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4431        MOVE ZEROS      TO WS-RESP
  4432        PERFORM 0030-BUILD-BUFFER
  4433                                 THRU 0030-EXIT
  4434        PERFORM 0020-SEND-BUFFER
  4435                                 THRU 0020-EXIT
  4436        PERFORM 0025-CLOSE-SOCKET
  4437                                 THRU 0025-EXIT
  4438        GO TO 0010-RETURN
  4439     END-IF
  4440     .
  4441 0060-EXIT.
  4442     EXIT.
  4443 0100-START-ELCERT.
  4444*    DISPLAY ' MADE 0100 START '
  4445     MOVE SPACES                 TO WS-SEND-BUF
  4446     INITIALIZE WS-STRING-DATA
  4447     MOVE LOW-VALUES             TO WS-CM-KEY
  4448                                    WS-CM-KEY-A1
  4449                                    WS-CM-KEY-A4
  4450     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4451                                    WS-CM-COMPANY-CD-A1
  4452                                    WS-CM-COMPANY-CD-A4
  4453     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4454     MOVE 'L'                    TO DC-OPTION-CODE
  4455     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4456     IF NO-CONVERSION-ERROR
  4457        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4458     ELSE
  4459        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4460        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4461        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4462        PERFORM 0020-SEND-BUFFER
  4463                                 THRU 0020-EXIT
  4464        PERFORM 0025-CLOSE-SOCKET
  4465                                 THRU 0025-EXIT
  4466        GO TO 0010-RETURN
  4467     END-IF
  4468     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4469        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4470        MOVE 'L'                 TO DC-OPTION-CODE
  4471        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4472        IF NO-CONVERSION-ERROR
  4473           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4474        ELSE
  4475           MOVE 'BAD EFF DT CONVERT '
  4476                                 TO WS-COMMENT
  4477           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4478           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4479           PERFORM 0020-SEND-BUFFER
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  79
* SOCK03.cbl
  4480                                 THRU 0020-EXIT
  4481           PERFORM 0025-CLOSE-SOCKET
  4482                                 THRU 0025-EXIT
  4483           GO TO 0010-RETURN
  4484        END-IF
  4485     END-IF
  4486     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4487        (F1 > +10)
  4488        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4489     END-PERFORM
  4490     IF F1 > +1
  4491        SUBTRACT +1 FROM F1
  4492     END-IF
  4493     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4494        (L1 > +15)
  4495        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4496     END-PERFORM
  4497     IF L1 > +1
  4498        SUBTRACT +1 FROM L1
  4499     END-IF
  4500     EVALUATE TRUE
  4501        WHEN WS-ELCERT-FULL
  4502           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4503           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4504           MOVE CLIENT-STATE        TO WS-CM-STATE
  4505           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4506           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4507           MOVE CLIENT-CERT-NO (1:10)
  4508                                    TO WS-CM-CERT-NO
  4509
  4510* EXEC CICS READ
  4511*             INTO    (CERTIFICATE-MASTER)
  4512*             DATASET ('ELCERT')
  4513*             RIDFLD  (WS-CM-KEY)
  4514*             RESP    (WS-RESPONSE)
  4515*          END-EXEC
  4516     MOVE LENGTH OF
  4517      CERTIFICATE-MASTER
  4518       TO DFHEIV11
  4519     MOVE 'ELCERT' TO DFHEIV1
  4520*    MOVE '&"IL       E          (  N#00004417' TO DFHEIV0
  4521     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4522     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4523     MOVE X'204E233030303034343137' TO DFHEIV0(25:11)
  4524     CALL 'kxdfhei1' USING DFHEIV0,
  4525           DFHEIV1,
  4526           CERTIFICATE-MASTER,
  4527           DFHEIV11,
  4528           WS-CM-KEY,
  4529           DFHEIV99,
  4530           DFHEIV99,
  4531           DFHEIV99
  4532     MOVE EIBRESP  TO WS-RESPONSE
  4533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4534        WHEN WS-ELCERT-ACT-NAME
  4535           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4536           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4537           MOVE CLIENT-STATE        TO WS-CM-STATE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  80
* SOCK03.cbl
  4538           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4539           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4540           MOVE ZEROS               TO WS-CM-CERT-NO
  4541
  4542* EXEC CICS STARTBR
  4543*             DATASET ('ELCERT')
  4544*             RIDFLD  (WS-CM-KEY)
  4545*             RESP    (WS-RESPONSE)
  4546*          END-EXEC
  4547     MOVE 'ELCERT' TO DFHEIV1
  4548     MOVE 0
  4549       TO DFHEIV11
  4550*    MOVE '&,         G          &  N#00004430' TO DFHEIV0
  4551     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4552     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4553     MOVE X'204E233030303034343330' TO DFHEIV0(25:11)
  4554     CALL 'kxdfhei1' USING DFHEIV0,
  4555           DFHEIV1,
  4556           WS-CM-KEY,
  4557           DFHEIV99,
  4558           DFHEIV11,
  4559           DFHEIV99
  4560     MOVE EIBRESP  TO WS-RESPONSE
  4561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4562        WHEN WS-ELCERT-NAME
  4563           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4564           MOVE SPACES           TO WS-CM-INITIALS
  4565           COMPUTE WS-LENGTH = L1 + +1
  4566
  4567* EXEC CICS STARTBR
  4568*             DATASET   ('ELCERT2')
  4569*             RIDFLD    (WS-CM-KEY-A1)
  4570*             GENERIC
  4571*             KEYLENGTH (WS-LENGTH)
  4572*             GTEQ
  4573*             RESP      (WS-RESPONSE)
  4574*          END-EXEC
  4575     MOVE 'ELCERT2' TO DFHEIV1
  4576     MOVE 0
  4577       TO DFHEIV11
  4578*    MOVE '&,   KG    G          &  N#00004439' TO DFHEIV0
  4579     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4580     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4581     MOVE X'204E233030303034343339' TO DFHEIV0(25:11)
  4582     CALL 'kxdfhei1' USING DFHEIV0,
  4583           DFHEIV1,
  4584           WS-CM-KEY-A1,
  4585           WS-LENGTH,
  4586           DFHEIV11,
  4587           DFHEIV99
  4588     MOVE EIBRESP  TO WS-RESPONSE
  4589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4590*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4591*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4592        WHEN WS-ELCERT-CERT-NO
  4593* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  4594           MOVE +11 TO WS-LENGTH
  4595           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  81
* SOCK03.cbl
  4596
  4597* EXEC CICS STARTBR
  4598*             DATASET   ('ELCERT5')
  4599*             RIDFLD    (WS-CM-KEY-A4)
  4600*             GENERIC
  4601*             KEYLENGTH (WS-LENGTH)
  4602*             GTEQ
  4603*             RESP      (WS-RESPONSE)
  4604*          END-EXEC
  4605     MOVE 'ELCERT5' TO DFHEIV1
  4606     MOVE 0
  4607       TO DFHEIV11
  4608*    MOVE '&,   KG    G          &  N#00004453' TO DFHEIV0
  4609     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4610     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4611     MOVE X'204E233030303034343533' TO DFHEIV0(25:11)
  4612     CALL 'kxdfhei1' USING DFHEIV0,
  4613           DFHEIV1,
  4614           WS-CM-KEY-A4,
  4615           WS-LENGTH,
  4616           DFHEIV11,
  4617           DFHEIV99
  4618     MOVE EIBRESP  TO WS-RESPONSE
  4619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4620     END-EVALUATE
  4621     .
  4622 0100-EXIT.
  4623     EXIT.
  4624 0150-READ-NEXT-ELCERT.
  4625*    DISPLAY ' MADE 0150 NEXT '
  4626     EVALUATE TRUE
  4627        WHEN WS-ELCERT-ACT-NAME
  4628*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  4629
  4630* EXEC CICS READNEXT
  4631*             DATASET   ('ELCERT')
  4632*             RIDFLD    (WS-CM-KEY)
  4633*             INTO      (CERTIFICATE-MASTER)
  4634*             RESP      (WS-RESPONSE)
  4635*          END-EXEC
  4636     MOVE LENGTH OF
  4637      CERTIFICATE-MASTER
  4638       TO DFHEIV12
  4639     MOVE 'ELCERT' TO DFHEIV1
  4640     MOVE 0
  4641       TO DFHEIV11
  4642*    MOVE '&.IL                  )  N#00004470' TO DFHEIV0
  4643     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4644     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4645     MOVE X'204E233030303034343730' TO DFHEIV0(25:11)
  4646     CALL 'kxdfhei1' USING DFHEIV0,
  4647           DFHEIV1,
  4648           CERTIFICATE-MASTER,
  4649           DFHEIV12,
  4650           WS-CM-KEY,
  4651           DFHEIV99,
  4652           DFHEIV11,
  4653           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  82
* SOCK03.cbl
  4654           DFHEIV99
  4655     MOVE EIBRESP  TO WS-RESPONSE
  4656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4657        WHEN WS-ELCERT-NAME
  4658*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  4659
  4660* EXEC CICS READNEXT
  4661*             DATASET   ('ELCERT2')
  4662*             RIDFLD    (WS-CM-KEY-A1)
  4663*             INTO      (CERTIFICATE-MASTER)
  4664*             RESP      (WS-RESPONSE)
  4665*          END-EXEC
  4666     MOVE LENGTH OF
  4667      CERTIFICATE-MASTER
  4668       TO DFHEIV12
  4669     MOVE 'ELCERT2' TO DFHEIV1
  4670     MOVE 0
  4671       TO DFHEIV11
  4672*    MOVE '&.IL                  )  N#00004478' TO DFHEIV0
  4673     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4674     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4675     MOVE X'204E233030303034343738' TO DFHEIV0(25:11)
  4676     CALL 'kxdfhei1' USING DFHEIV0,
  4677           DFHEIV1,
  4678           CERTIFICATE-MASTER,
  4679           DFHEIV12,
  4680           WS-CM-KEY-A1,
  4681           DFHEIV99,
  4682           DFHEIV11,
  4683           DFHEIV99,
  4684           DFHEIV99
  4685     MOVE EIBRESP  TO WS-RESPONSE
  4686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4687        WHEN WS-ELCERT-CERT-NO
  4688
  4689* EXEC CICS READNEXT
  4690*             DATASET   ('ELCERT5')
  4691*             RIDFLD    (WS-CM-KEY-A4)
  4692*             INTO      (CERTIFICATE-MASTER)
  4693*             RESP      (WS-RESPONSE)
  4694*          END-EXEC
  4695     MOVE LENGTH OF
  4696      CERTIFICATE-MASTER
  4697       TO DFHEIV12
  4698     MOVE 'ELCERT5' TO DFHEIV1
  4699     MOVE 0
  4700       TO DFHEIV11
  4701*    MOVE '&.IL                  )  N#00004485' TO DFHEIV0
  4702     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4703     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4704     MOVE X'204E233030303034343835' TO DFHEIV0(25:11)
  4705     CALL 'kxdfhei1' USING DFHEIV0,
  4706           DFHEIV1,
  4707           CERTIFICATE-MASTER,
  4708           DFHEIV12,
  4709           WS-CM-KEY-A4,
  4710           DFHEIV99,
  4711           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  83
* SOCK03.cbl
  4712           DFHEIV99,
  4713           DFHEIV99
  4714     MOVE EIBRESP  TO WS-RESPONSE
  4715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4716     END-EVALUATE
  4717     .
  4718 0150-EXIT.
  4719     EXIT.
  4720 0200-BEGIN-REFUND-PROCESS.
  4721*    DISPLAY ' MADE 0200 BEGIN '
  4722     MOVE SPACES                 TO WS-BUFF-SENT-SW
  4723                                    WS-ERACCT-SW
  4724     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  4725                                    WS-NCB-DIFF-ODD-DAYS
  4726     INITIALIZE WS-STRING-DATA
  4727     IF RESP-NORMAL OR RESP-DUPKEY
  4728        EVALUATE TRUE
  4729           WHEN WS-ELCERT-ACT-NAME
  4730              EVALUATE TRUE
  4731                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  4732                    OR (CM-CARRIER NOT = CLIENT-CAR)
  4733                    OR (CM-GROUPING NOT = CLIENT-GRP)
  4734                    OR (CM-STATE NOT = CLIENT-STATE)
  4735                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  4736                    SET ELCERT-FINISHED TO TRUE
  4737                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  4738                    CLIENT-LAST-NAME (1:L1))
  4739                    GO TO 0200-CONTINUE
  4740                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  4741                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4742                    GO TO 0200-CONTINUE
  4743                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  4744                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4745                     CLIENT-FIRST-NAME (1:F1)))
  4746                    GO TO 0200-CONTINUE
  4747                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  4748                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4749                    GO TO 0200-CONTINUE
  4750              END-EVALUATE
  4751           WHEN WS-ELCERT-CERT-NO
  4752              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4753                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  4754                 SET ELCERT-FINISHED TO TRUE
  4755              ELSE
  4756                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4757                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4758                              OR
  4759                    ((CLIENT-LAST-NAME NOT = SPACES)
  4760                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  4761                        CLIENT-LAST-NAME (1:L1)))
  4762                              OR
  4763                    ((CLIENT-FIRST-NAME NOT = SPACES)
  4764                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4765                        CLIENT-FIRST-NAME (1:F1)))
  4766                              OR
  4767                    ((CLIENT-ACCOUNT NOT = SPACES)
  4768                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4769                     GO TO 0200-CONTINUE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  84
* SOCK03.cbl
  4770                 END-IF
  4771              END-IF
  4772           WHEN WS-ELCERT-NAME
  4773              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4774                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  4775                    CLIENT-LAST-NAME (1:L1))
  4776                  SET ELCERT-FINISHED TO TRUE
  4777              ELSE
  4778                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4779                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4780                           OR
  4781                 ((CLIENT-FIRST-NAME NOT = SPACES)
  4782                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4783                     CLIENT-FIRST-NAME (1:F1)))
  4784                           OR
  4785                 ((CLIENT-ACCOUNT NOT = SPACES)
  4786                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4787                  GO TO 0200-CONTINUE
  4788                 END-IF
  4789              END-IF
  4790           WHEN OTHER
  4791              SET ELCERT-FINISHED   TO TRUE
  4792        END-EVALUATE
  4793     ELSE
  4794        SET ELCERT-FINISHED TO TRUE
  4795     END-IF
  4796*       IF WS-ELCERT-CERT-NO
  4797*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4798*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  4799*                          OR
  4800*                ((CLIENT-EFF-DT NOT = SPACES)
  4801*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4802*                          OR
  4803*                ((CLIENT-LAST-NAME NOT = SPACES)
  4804*                 AND (CM-INSURED-LAST-NAME NOT =
  4805*                    CLIENT-LAST-NAME))
  4806*                 SET ELCERT-FINISHED TO TRUE
  4807*          END-IF
  4808*          IF WS-ELCERT-NAME
  4809*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4810*                OR (CM-INSURED-LAST-NAME NOT =
  4811*                   CLIENT-LAST-NAME)
  4812*                            OR
  4813*                ((CLIENT-EFF-DT NOT = SPACES)
  4814*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4815*                 SET ELCERT-FINISHED TO TRUE
  4816*             END-IF
  4817*          ELSE
  4818*             SET ELCERT-FINISHED   TO TRUE
  4819*          END-IF
  4820     IF NOT WS-ELCERT-FULL
  4821        IF ELCERT-FINISHED
  4822           GO TO 0200-EXIT
  4823        END-IF
  4824     END-IF
  4825     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
  4826        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  4827        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  85
* SOCK03.cbl
  4828        PERFORM 0030-BUILD-BUFFER
  4829                                 THRU 0030-EXIT
  4830        PERFORM 0020-SEND-BUFFER
  4831                                 THRU 0020-EXIT
  4832        GO TO 0200-CONTINUE
  4833     END-IF
  4834     if (ws-epiq-request)
  4835        and (not EPIQ-CLASS)
  4836        go to 0200-continue
  4837     end-if
  4838
  4839     if ws-epiq-request
  4840        add +1 to ws-epiq-max
  4841        if ws-epiq-max > +100
  4842           go to 0200-continue
  4843        end-if
  4844     end-if
  4845     PERFORM 0300-GET-ELCNTL-RECORDS
  4846                                 THRU 0300-EXIT
  4847     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  4848     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  4849     MOVE +0                     TO DC-ELAPSED-MONTHS
  4850                                    DC-ELAPSED-DAYS
  4851     MOVE '1'                    TO DC-OPTION-CODE
  4852     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4853     IF NO-CONVERSION-ERROR
  4854        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  4855        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  4856     END-IF
  4857     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  4858     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  4859     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4860     IF NOT ALREADY-SENT
  4861        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
  4862     END-IF
  4863     .
  4864 0200-CONTINUE.
  4865     PERFORM 0150-READ-NEXT-ELCERT
  4866                                 THRU 0150-EXIT
  4867     .
  4868 0200-EXIT.
  4869     EXIT.
  4870 0300-GET-ELCNTL-RECORDS.
  4871     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  4872     IF NOT RESP-NORMAL
  4873        MOVE ' COMPANY RECORD NOT FOUND '
  4874                                 TO WS-COMMENT
  4875        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4876        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4877        PERFORM 0020-SEND-BUFFER
  4878                                 THRU 0020-EXIT
  4879        PERFORM 0025-CLOSE-SOCKET
  4880                                 THRU 0025-EXIT
  4881        GO TO 0010-RETURN
  4882     END-IF
  4883     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  4884        PERFORM 0320-GET-LIFE-RECORD
  4885                                 THRU 0320-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  86
* SOCK03.cbl
  4886        IF NOT RESP-NORMAL
  4887           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  4888                                 TO WS-COMMENT
  4889           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4890           PERFORM 0030-BUILD-BUFFER
  4891                                 THRU 0030-EXIT
  4892           PERFORM 0020-SEND-BUFFER
  4893                                 THRU 0020-EXIT
  4894           PERFORM 0025-CLOSE-SOCKET
  4895                                 THRU 0025-EXIT
  4896           GO TO 0010-RETURN
  4897        END-IF
  4898     END-IF
  4899     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  4900        PERFORM 0330-GET-AH-RECORD
  4901                                 THRU 0330-EXIT
  4902        IF NOT RESP-NORMAL
  4903           MOVE ' AH BENEFIT RECORD NOT FOUND '
  4904                                 TO WS-COMMENT
  4905           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4906           PERFORM 0030-BUILD-BUFFER
  4907                                 THRU 0030-EXIT
  4908           PERFORM 0020-SEND-BUFFER
  4909                                 THRU 0020-EXIT
  4910           PERFORM 0025-CLOSE-SOCKET
  4911                                 THRU 0025-EXIT
  4912           GO TO 0010-RETURN
  4913        END-IF
  4914     END-IF
  4915     PERFORM 0340-GET-STATE-RECORD
  4916                                 THRU 0340-EXIT
  4917     IF NOT RESP-NORMAL
  4918        MOVE ' STATE RECORD NOT FOUND '
  4919                                 TO WS-COMMENT
  4920        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4921        PERFORM 0030-BUILD-BUFFER
  4922                                 THRU 0030-EXIT
  4923        PERFORM 0020-SEND-BUFFER
  4924                                 THRU 0020-EXIT
  4925        PERFORM 0025-CLOSE-SOCKET
  4926                                 THRU 0025-EXIT
  4927        GO TO 0010-RETURN
  4928     END-IF
  4929     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  4930     IF NOT ERACCT-FOUND
  4931        MOVE ' ACCOUNT NOT FOUND '
  4932                                 TO WS-COMMENT
  4933        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4934        PERFORM 0030-BUILD-BUFFER
  4935                                 THRU 0030-EXIT
  4936        PERFORM 0020-SEND-BUFFER
  4937                                 THRU 0020-EXIT
  4938        PERFORM 0025-CLOSE-SOCKET
  4939                                 THRU 0025-EXIT
  4940        GO TO 0010-RETURN
  4941     ELSE
  4942        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  4943        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  87
* SOCK03.cbl
  4944        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
  4945        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  4946     END-IF
  4947     .
  4948 0300-EXIT.
  4949     EXIT.
  4950 0310-GET-COMPANY.
  4951     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  4952     MOVE '1'                    TO  WS-CF-RECORD-TYPE
  4953     MOVE SPACES                 TO  WS-CF-ACCESS
  4954     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  4955
  4956* EXEC CICS READ
  4957*       INTO    (CONTROL-FILE)
  4958*       DATASET ('ELCNTL')
  4959*       RIDFLD  (WS-CF-KEY)
  4960*       RESP    (WS-RESPONSE)
  4961*    END-EXEC
  4962     MOVE LENGTH OF
  4963      CONTROL-FILE
  4964       TO DFHEIV11
  4965     MOVE 'ELCNTL' TO DFHEIV1
  4966*    MOVE '&"IL       E          (  N#00004730' TO DFHEIV0
  4967     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4968     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4969     MOVE X'204E233030303034373330' TO DFHEIV0(25:11)
  4970     CALL 'kxdfhei1' USING DFHEIV0,
  4971           DFHEIV1,
  4972           CONTROL-FILE,
  4973           DFHEIV11,
  4974           WS-CF-KEY,
  4975           DFHEIV99,
  4976           DFHEIV99,
  4977           DFHEIV99
  4978     MOVE EIBRESP  TO WS-RESPONSE
  4979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4980     IF (RESP-NORMAL)
  4981        AND (CF-COMPANY-ID = WS-COMP-ID)
  4982        AND (CF-RECORD-TYPE = '1')
  4983        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  4984        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  4985        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
  4986        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  4987        IF CF-DEFAULT-APR NUMERIC
  4988           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  4989        ELSE
  4990           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  4991        END-IF
  4992        IF CF-VALID-REM-TRM-OPTION
  4993           MOVE CF-REM-TRM-CALC-OPTION
  4994                                 TO WS-CF-REM-TRM-CALC-OPTION
  4995        ELSE
  4996           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  4997        END-IF
  4998     END-IF
  4999     .
  5000 0310-EXIT.
  5001     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  88
* SOCK03.cbl
  5002 0320-GET-LIFE-RECORD.
  5003     MOVE '4'                    TO WS-CF-RECORD-TYPE
  5004     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5005                                    WS-LF-BEN-CODE
  5006     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5007
  5008* EXEC CICS READ
  5009*       INTO    (CONTROL-FILE)
  5010*       DATASET ('ELCNTL')
  5011*       RIDFLD  (WS-CF-KEY)
  5012*       GTEQ
  5013*       RESP    (WS-RESPONSE)
  5014*    END-EXEC
  5015     MOVE LENGTH OF
  5016      CONTROL-FILE
  5017       TO DFHEIV11
  5018     MOVE 'ELCNTL' TO DFHEIV1
  5019*    MOVE '&"IL       G          (  N#00004763' TO DFHEIV0
  5020     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5021     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5022     MOVE X'204E233030303034373633' TO DFHEIV0(25:11)
  5023     CALL 'kxdfhei1' USING DFHEIV0,
  5024           DFHEIV1,
  5025           CONTROL-FILE,
  5026           DFHEIV11,
  5027           WS-CF-KEY,
  5028           DFHEIV99,
  5029           DFHEIV99,
  5030           DFHEIV99
  5031     MOVE EIBRESP  TO WS-RESPONSE
  5032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5033     IF RESP-NORMAL
  5034        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5035        AND (CF-RECORD-TYPE = '4')
  5036        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5037           (S1 > +8)
  5038           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5039        END-PERFORM
  5040        IF S1 > +8
  5041           CONTINUE
  5042        ELSE
  5043           MOVE CF-BENEFIT-DESCRIP (S1)
  5044                                 TO WS-LF-BEN-CODE-DESC
  5045           MOVE CF-LF-COVERAGE-TYPE (S1)
  5046                                 TO WS-CF-LF-COVERAGE-TYPE
  5047           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5048              MOVE 'S'           TO WS-LF-COVERAGE-TYPE
  5049           ELSE
  5050              MOVE 'J'           TO WS-LF-COVERAGE-TYPE
  5051           END-IF
  5052           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5053               MOVE CF-CO-REM-TERM-CALC (S1)
  5054                                 TO WS-LF-CO-REM-TERM-CALC
  5055           END-IF
  5056           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  5057               MOVE CF-CO-EARNINGS-CALC (S1)
  5058                                 TO WS-LF-CO-EARNINGS-CALC
  5059                                    WS-LF-CO-REFUND-CALC
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  89
* SOCK03.cbl
  5060           END-IF
  5061           IF CF-SPECIAL-CALC-CD (S1) > ' '
  5062               MOVE CF-SPECIAL-CALC-CD (S1)
  5063                                 TO WS-LF-SPECIAL-CALC-CD
  5064           END-IF
  5065           IF CF-CO-REFUND-CALC (S1) > '0'
  5066               MOVE CF-CO-REFUND-CALC (S1)
  5067                                 TO WS-LF-CO-REFUND-CALC
  5068        END-IF
  5069     END-IF
  5070     .
  5071 0320-EXIT.
  5072     EXIT.
  5073 0330-GET-AH-RECORD.
  5074     MOVE '5'                    TO WS-CF-RECORD-TYPE
  5075     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5076     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5077
  5078* EXEC CICS READ
  5079*       INTO    (CONTROL-FILE)
  5080*       DATASET ('ELCNTL')
  5081*       RIDFLD  (WS-CF-KEY)
  5082*       GTEQ
  5083*       RESP    (WS-RESPONSE)
  5084*    END-EXEC
  5085     MOVE LENGTH OF
  5086      CONTROL-FILE
  5087       TO DFHEIV11
  5088     MOVE 'ELCNTL' TO DFHEIV1
  5089*    MOVE '&"IL       G          (  N#00004814' TO DFHEIV0
  5090     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5091     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5092     MOVE X'204E233030303034383134' TO DFHEIV0(25:11)
  5093     CALL 'kxdfhei1' USING DFHEIV0,
  5094           DFHEIV1,
  5095           CONTROL-FILE,
  5096           DFHEIV11,
  5097           WS-CF-KEY,
  5098           DFHEIV99,
  5099           DFHEIV99,
  5100           DFHEIV99
  5101     MOVE EIBRESP  TO WS-RESPONSE
  5102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5103     IF RESP-NORMAL
  5104        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5105        AND (CF-RECORD-TYPE = '5')
  5106        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5107           (S1 > +8)
  5108           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5109        END-PERFORM
  5110        IF S1 > +8
  5111           CONTINUE
  5112        ELSE
  5113           MOVE CF-BENEFIT-DESCRIP (S1)
  5114                                 TO WS-AH-BEN-CODE-DESC
  5115           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5116              MOVE 'S'           TO WS-AH-COVERAGE-TYPE
  5117           ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  90
* SOCK03.cbl
  5118              MOVE 'J'           TO WS-AH-COVERAGE-TYPE
  5119           END-IF
  5120           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5121              MOVE CF-CO-REM-TERM-CALC (S1)
  5122                                 TO WS-AH-CO-REM-TERM-CALC
  5123           END-IF
  5124           IF CF-CO-EARNINGS-CALC (S1) > ' '
  5125              MOVE CF-CO-EARNINGS-CALC (S1)
  5126                                 TO WS-AH-CO-EARNINGS-CALC
  5127                                    WS-AH-CO-REFUND-CALC
  5128           END-IF
  5129           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  5130              MOVE CF-SPECIAL-CALC-CD (S1)
  5131                                 TO WS-AH-SPECIAL-CALC-CD
  5132           END-IF
  5133           IF CF-CO-REFUND-CALC (S1) > '0'
  5134              MOVE CF-CO-REFUND-CALC (S1)
  5135                                 TO WS-AH-CO-REFUND-CALC
  5136           END-IF
  5137           IF CF-BENEFIT-CATEGORY (S1) > ' '
  5138              MOVE CF-BENEFIT-CATEGORY (S1)
  5139                                 TO WS-AH-BEN-CATEGORY
  5140           END-IF
  5141        END-IF
  5142     END-IF
  5143     .
  5144 0330-EXIT.
  5145     EXIT.
  5146 0340-GET-STATE-RECORD.
  5147     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  5148     MOVE '3'                    TO WS-CF-RECORD-TYPE
  5149     MOVE CM-STATE               TO WS-CF-ACCESS
  5150     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5151
  5152* EXEC CICS READ
  5153*       INTO    (CONTROL-FILE)
  5154*       DATASET ('ELCNTL')
  5155*       RIDFLD  (WS-CF-KEY)
  5156*       RESP    (WS-RESPONSE)
  5157*    END-EXEC
  5158     MOVE LENGTH OF
  5159      CONTROL-FILE
  5160       TO DFHEIV11
  5161     MOVE 'ELCNTL' TO DFHEIV1
  5162*    MOVE '&"IL       E          (  N#00004869' TO DFHEIV0
  5163     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5164     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5165     MOVE X'204E233030303034383639' TO DFHEIV0(25:11)
  5166     CALL 'kxdfhei1' USING DFHEIV0,
  5167           DFHEIV1,
  5168           CONTROL-FILE,
  5169           DFHEIV11,
  5170           WS-CF-KEY,
  5171           DFHEIV99,
  5172           DFHEIV99,
  5173           DFHEIV99
  5174     MOVE EIBRESP  TO WS-RESPONSE
  5175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  91
* SOCK03.cbl
  5176     IF (RESP-NORMAL)
  5177        AND (CF-COMPANY-ID = WS-COMP-ID)
  5178        AND (CF-RECORD-TYPE = '3')
  5179        AND (CF-STATE-CODE = CM-STATE)
  5180        MOVE CF-ST-FREE-LOOK-PERIOD
  5181                                 TO WS-FREE-LOOK
  5182        MOVE CF-STATE-ABBREVIATION
  5183                                 TO WS-STATE-ABBREVIATION
  5184        MOVE CF-ST-FST-PMT-DAYS-CHG
  5185                                 TO  WS-STATE-EXT-DAYS-CHG
  5186        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  5187           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  5188           IF CF-ST-RT-CALC NOT = SPACES
  5189              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  5190           END-IF
  5191           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  5192              IF CF-ST-RF-LR-CALC > '0'
  5193                 MOVE CF-ST-RF-LR-CALC
  5194                                 TO WS-LF-ST-REFUND-CALC
  5195              END-IF
  5196              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  5197                 IF CF-ST-RF-LN-CALC > '0'
  5198                    MOVE CF-ST-RF-LN-CALC
  5199                                 TO WS-LF-ST-REFUND-CALC
  5200                 END-IF
  5201              END-IF
  5202           ELSE
  5203              IF CF-ST-RF-LL-CALC > '0'
  5204                 MOVE CF-ST-RF-LL-CALC
  5205                                 TO WS-LF-ST-REFUND-CALC
  5206              END-IF
  5207           END-IF
  5208           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5209              (S1 > 50)
  5210              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5211                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  5212           END-PERFORM
  5213           IF S1 < +51
  5214              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5215                 MOVE CF-ST-REM-TERM-CALC (S1)
  5216                                 TO WS-LF-ST-REM-TERM-CALC
  5217              END-IF
  5218              IF CF-ST-REFUND-CALC (S1) > '0'
  5219                 MOVE CF-ST-REFUND-CALC (S1)
  5220                                 TO WS-LF-ST-REFUND-CALC
  5221              END-IF
  5222           END-IF
  5223        END-IF
  5224        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  5225           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  5226           IF CF-ST-RT-CALC NOT = SPACES
  5227              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  5228           END-IF
  5229           IF CF-ST-RF-AH-CALC > '0'
  5230              MOVE CF-ST-RF-AH-CALC
  5231                                 TO WS-AH-ST-REFUND-CALC
  5232           END-IF
  5233           IF WS-AH-SPECIAL-CALC-CD = 'C'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  92
* SOCK03.cbl
  5234              IF CF-ST-RF-CP-CALC > '0'
  5235                 MOVE CF-ST-RF-CP-CALC
  5236                                 TO WS-AH-ST-REFUND-CALC
  5237              END-IF
  5238           END-IF
  5239           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5240              (S1 > 50)
  5241              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5242                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
  5243           END-PERFORM
  5244           IF S1 < +51
  5245              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5246                 MOVE CF-ST-REM-TERM-CALC (S1)
  5247                                 TO WS-AH-ST-REM-TERM-CALC
  5248              END-IF
  5249              IF CF-ST-REFUND-CALC (S1) > '0'
  5250                 MOVE CF-ST-REFUND-CALC (S1)
  5251                                 TO WS-AH-ST-REFUND-CALC
  5252              END-IF
  5253           END-IF
  5254        END-IF
  5255     END-IF
  5256     .
  5257 0340-EXIT.
  5258     EXIT.
  5259 0350-GET-ERACCT.
  5260     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  5261                                    WS-AM-EARN-METHOD-R
  5262                                    WS-AM-EARN-METHOD-A
  5263                                    WS-LF-AM-REM-TERM-CALC
  5264                                    WS-AH-AM-REM-TERM-CALC
  5265     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  5266     MOVE CM-CARRIER             TO WS-AM-CARRIER
  5267     MOVE CM-GROUPING            TO WS-AM-GROUPING
  5268     MOVE CM-STATE               TO WS-AM-STATE
  5269     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  5270     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  5271     MOVE LOW-VALUES             TO WS-AM-FILLER
  5272     MOVE ' '                    TO WS-STOP-SW
  5273
  5274* EXEC CICS STARTBR
  5275*       DATASET  ('ERACCT')
  5276*       RIDFLD   (WS-AM-KEY)
  5277*       GTEQ
  5278*       RESP (WS-RESPONSE)
  5279*    END-EXEC
  5280     MOVE 'ERACCT' TO DFHEIV1
  5281     MOVE 0
  5282       TO DFHEIV11
  5283*    MOVE '&,         G          &  N#00004972' TO DFHEIV0
  5284     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5285     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5286     MOVE X'204E233030303034393732' TO DFHEIV0(25:11)
  5287     CALL 'kxdfhei1' USING DFHEIV0,
  5288           DFHEIV1,
  5289           WS-AM-KEY,
  5290           DFHEIV99,
  5291           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  93
* SOCK03.cbl
  5292           DFHEIV99
  5293     MOVE EIBRESP  TO WS-RESPONSE
  5294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5295     IF RESP-NORMAL
  5296        PERFORM UNTIL TOLD-TO-STOP
  5297
  5298* EXEC CICS READNEXT
  5299*             DATASET  ('ERACCT')
  5300*             INTO     (ACCOUNT-MASTER)
  5301*             RIDFLD   (WS-AM-KEY)
  5302*          END-EXEC
  5303     MOVE LENGTH OF
  5304      ACCOUNT-MASTER
  5305       TO DFHEIV12
  5306     MOVE 'ERACCT' TO DFHEIV1
  5307     MOVE 0
  5308       TO DFHEIV11
  5309*    MOVE '&.IL                  )   #00004980' TO DFHEIV0
  5310     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5311     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5312     MOVE X'2020233030303034393830' TO DFHEIV0(25:11)
  5313     CALL 'kxdfhei1' USING DFHEIV0,
  5314           DFHEIV1,
  5315           ACCOUNT-MASTER,
  5316           DFHEIV12,
  5317           WS-AM-KEY,
  5318           DFHEIV99,
  5319           DFHEIV11,
  5320           DFHEIV99,
  5321           DFHEIV99
  5322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5323           IF RESP-NORMAL
  5324              EVALUATE TRUE
  5325                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
  5326                    CM-CONTROL-PRIMARY (1:20)
  5327                    SET TOLD-TO-STOP TO TRUE
  5328                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5329                    CM-CONTROL-PRIMARY (1:20))
  5330                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5331                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5332                    SET ERACCT-FOUND      TO TRUE
  5333                    SET TOLD-TO-STOP TO TRUE
  5334              END-EVALUATE
  5335           ELSE
  5336              SET TOLD-TO-STOP TO TRUE
  5337           END-IF
  5338        END-PERFORM
  5339
  5340* EXEC CICS ENDBR
  5341*          DATASET   ('ERACCT')
  5342*       END-EXEC
  5343     MOVE 'ERACCT' TO DFHEIV1
  5344     MOVE 0
  5345       TO DFHEIV11
  5346*    MOVE '&2                    $   #00005001' TO DFHEIV0
  5347     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5348     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5349     MOVE X'2020233030303035303031' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  94
* SOCK03.cbl
  5350     CALL 'kxdfhei1' USING DFHEIV0,
  5351           DFHEIV1,
  5352           DFHEIV11,
  5353           DFHEIV99
  5354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5355     END-IF
  5356     .
  5357 0350-EXIT.
  5358     EXIT.
  5359 0400-PROCESS-LIFE.
  5360     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5361     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5362     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5363     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5364     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5365     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5366     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5367     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5368     MOVE CM-CARRIER             TO WS-CARRIER
  5369     MOVE CM-GROUPING            TO WS-GROUPING
  5370     MOVE CM-STATE               TO WS-STATE
  5371     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5372     MOVE CM-CERT-NO             TO WS-CERT-NO
  5373     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5374     MOVE ' '                    TO  DC-OPTION-CODE.
  5375     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5376     IF NO-CONVERSION-ERROR
  5377        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5378     ELSE
  5379        MOVE 99999999            TO WS-CERT-EFF-DATE
  5380     END-IF
  5381     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5382        GO TO 0400-EXIT
  5383     END-IF
  5384     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5385                                    WS-TOT-LF-PREM
  5386                                    WS-TOT-LF-COMM
  5387     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5388     MOVE ' '                    TO  DC-OPTION-CODE
  5389     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5390     IF NO-CONVERSION-ERROR
  5391        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
  5392     ELSE
  5393        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5394     END-IF
  5395     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5396     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5397     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5398     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5399     MOVE CM-STATE               TO CP-STATE
  5400     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5401     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5402     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5403     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5404     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5405     MOVE '2'                    TO CP-PROCESS-TYPE
  5406     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5407     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  95
* SOCK03.cbl
  5408     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5409     MOVE WS-CF-REM-TRM-CALC-OPTION
  5410                                 TO CP-REM-TRM-CALC-OPTION
  5411     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5412     IF WS-LF-CO-REM-TERM-CALC > '0'
  5413        MOVE WS-LF-CO-REM-TERM-CALC
  5414                                 TO CP-REM-TERM-METHOD
  5415     END-IF
  5416     IF WS-LF-ST-REM-TERM-CALC > '0'
  5417         MOVE WS-LF-ST-REM-TERM-CALC
  5418                                 TO  CP-REM-TERM-METHOD.
  5419     IF WS-LF-AM-REM-TERM-CALC > '0'
  5420         MOVE WS-LF-AM-REM-TERM-CALC
  5421                                 TO  CP-REM-TERM-METHOD.
  5422     IF (WS-COMP-ID = 'CID')
  5423        AND (CP-STATE-STD-ABBRV = 'WI')
  5424        MOVE '7'                 TO CP-REM-TERM-METHOD
  5425        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5426     END-IF
  5427     IF (WS-COMP-ID = 'CID')
  5428        AND (CP-STATE-STD-ABBRV = 'MO')
  5429        AND (CM-CERT-EFF-DT >= X'9B41')
  5430        AND (CM-CERT-EFF-DT <= X'A2FB')
  5431        MOVE '7'                 TO CP-REM-TERM-METHOD
  5432        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5433     END-IF
  5434     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5435                                    CP-LOAN-TERM
  5436                                    WS-LF-TERM
  5437     IF CP-TRUNCATED-LIFE
  5438         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5439     IF CP-TERM-IS-DAYS
  5440        IF CM-LF-TERM-IN-DAYS NUMERIC
  5441           MOVE CM-LF-TERM-IN-DAYS
  5442                                 TO CP-TERM-OR-EXT-DAYS
  5443        ELSE
  5444           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5445        END-IF
  5446     ELSE
  5447        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5448           MOVE CM-PMT-EXTENSION-DAYS
  5449                                 TO CP-TERM-OR-EXT-DAYS
  5450        ELSE
  5451           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5452        END-IF
  5453     END-IF
  5454     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5455     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5456        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5457        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5458     END-IF
  5459     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5460     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5461     MOVE ' '                    TO WS-CLM-STOP-SW
  5462     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5463     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5464
  5465* EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  96
* SOCK03.cbl
  5466*       DATASET     ('ELMSTR5')
  5467*       RIDFLD      (ELMSTR-KEY)
  5468*       RESP        (WS-RESPONSE)
  5469*    END-EXEC
  5470     MOVE 'ELMSTR5' TO DFHEIV1
  5471     MOVE 0
  5472       TO DFHEIV11
  5473*    MOVE '&,         G          &  N#00005113' TO DFHEIV0
  5474     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5475     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5476     MOVE X'204E233030303035313133' TO DFHEIV0(25:11)
  5477     CALL 'kxdfhei1' USING DFHEIV0,
  5478           DFHEIV1,
  5479           ELMSTR-KEY,
  5480           DFHEIV99,
  5481           DFHEIV11,
  5482           DFHEIV99
  5483     MOVE EIBRESP  TO WS-RESPONSE
  5484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5485     DISPLAY ' AFTER START ' WS-RESPONSE
  5486     IF RESP-NORMAL
  5487        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5488
  5489* EXEC CICS READNEXT
  5490*             DATASET   ('ELMSTR5')
  5491*             RIDFLD    (ELMSTR-KEY)
  5492*             INTO      (CLAIM-MASTER)
  5493*             RESP      (WS-RESPONSE)
  5494*          END-EXEC
  5495     MOVE LENGTH OF
  5496      CLAIM-MASTER
  5497       TO DFHEIV12
  5498     MOVE 'ELMSTR5' TO DFHEIV1
  5499     MOVE 0
  5500       TO DFHEIV11
  5501*    MOVE '&.IL                  )  N#00005121' TO DFHEIV0
  5502     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5503     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5504     MOVE X'204E233030303035313231' TO DFHEIV0(25:11)
  5505     CALL 'kxdfhei1' USING DFHEIV0,
  5506           DFHEIV1,
  5507           CLAIM-MASTER,
  5508           DFHEIV12,
  5509           ELMSTR-KEY,
  5510           DFHEIV99,
  5511           DFHEIV11,
  5512           DFHEIV99,
  5513           DFHEIV99
  5514     MOVE EIBRESP  TO WS-RESPONSE
  5515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5516        IF (RESP-NORMAL OR RESP-DUPKEY)
  5517           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5518           AND (CM-CERT-NO = CL-CERT-NO)
  5519           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5520              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5521              IF CL-CLAIM-TYPE = 'L'
  5522                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5523                    MOVE 'D'     TO WS-AH-STATUS
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  97
* SOCK03.cbl
  5524                 END-IF
  5525                 IF CLAIM-IS-OPEN
  5526                    MOVE ' OPEN LIFE CLAIM '
  5527                                 TO WS-COMMENT
  5528                    MOVE 'L'     TO WS-LF-STATUS
  5529                    GO TO 0400-EXIT
  5530                 ELSE
  5531                    MOVE ' DEATH CLAIM APPLIED '
  5532                                 TO WS-COMMENT
  5533                    MOVE 'D'     TO WS-LF-STATUS
  5534*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  5535*                      MOVE CL-PAID-THRU-DT
  5536*                                TO WS-LF-BIN-PAID-THRU-DT
  5537*                   END-IF
  5538                 END-IF
  5539              END-IF
  5540           END-IF
  5541        ELSE
  5542           SET I-SAY-TO-STOP TO TRUE
  5543        END-IF
  5544        END-PERFORM
  5545
  5546* EXEC CICS ENDBR
  5547*          DATASET   ('ELMSTR5')
  5548*       END-EXEC
  5549     MOVE 'ELMSTR5' TO DFHEIV1
  5550     MOVE 0
  5551       TO DFHEIV11
  5552*    MOVE '&2                    $   #00005156' TO DFHEIV0
  5553     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5554     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5555     MOVE X'2020233030303035313536' TO DFHEIV0(25:11)
  5556     CALL 'kxdfhei1' USING DFHEIV0,
  5557           DFHEIV1,
  5558           DFHEIV11,
  5559           DFHEIV99
  5560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5561     END-IF
  5562     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5563*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  5564        MOVE WS-LF-BIN-PAID-THRU-DT
  5565                                 TO DC-BIN-DATE-1
  5566        MOVE ' '                 TO DC-OPTION-CODE
  5567        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5568        IF NO-CONVERSION-ERROR
  5569           MOVE DC-GREG-DATE-CYMD
  5570                                 TO WS-CLM-PAID-THRU-DT
  5571        ELSE
  5572           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5573        END-IF
  5574*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  5575*          MOVE 'CAN DT =< CLM PD THRU DT'
  5576*                                TO WS-COMMENT
  5577*          MOVE 'P'              TO WS-LF-STATUS
  5578*          GO TO 0400-EXIT
  5579*       END-IF
  5580        GO TO 0400-EXIT
  5581     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  98
* SOCK03.cbl
  5582     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5583     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5584        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5585        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  5586        COMPUTE CP-REMAINING-TERM-1 =
  5587                CP-REMAINING-TERM-1 - +1
  5588        COMPUTE CP-REMAINING-TERM-2 =
  5589                CP-REMAINING-TERM-2 - +1
  5590     END-IF
  5591     IF CP-REMAINING-TERM-1 NEGATIVE
  5592        MOVE ZEROS               TO CP-REMAINING-TERM-1
  5593     END-IF
  5594     IF CP-REMAINING-TERM-2 NEGATIVE
  5595        MOVE ZEROS               TO CP-REMAINING-TERM-2
  5596     END-IF
  5597     IF CM-LIFE-COMM-PCT NOT NUMERIC
  5598        MOVE ZERO                TO CM-LIFE-COMM-PCT
  5599     END-IF
  5600     IF CM-LIFE-COMM-PCT > ZEROS
  5601        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  5602           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  5603     END-IF
  5604     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  5605     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  5606     IF CM-LF-CURRENT-STATUS = '8'
  5607        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5608           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  5609                                 TO WS-COMMENT
  5610           MOVE 'C'              TO WS-LF-STATUS
  5611*          PERFORM 0030-BUILD-BUFFER
  5612*                                THRU 0030-EXIT
  5613*          PERFORM 0020-SEND-BUFFER
  5614*                                THRU 0020-EXIT
  5615*          SET ALREADY-SENT      TO TRUE
  5616*          MOVE SPACES           TO WS-COMMENT
  5617           GO TO 0400-EXIT
  5618*          PERFORM 0025-CLOSE-SOCKET
  5619*                                THRU 0025-EXIT
  5620*          GO TO 0010-RETURN
  5621        END-IF
  5622     END-IF
  5623     IF CM-LF-CURRENT-STATUS = '7'
  5624        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5625           MOVE ' DEATH CLAIM APPLIED '
  5626                                 TO WS-COMMENT
  5627           MOVE 'D'              TO WS-LF-STATUS
  5628*          PERFORM 0030-BUILD-BUFFER
  5629*                                THRU 0030-EXIT
  5630*          IF NOT ALREADY-SENT
  5631*             PERFORM 0020-SEND-BUFFER
  5632*                                THRU 0020-EXIT
  5633*             SET ALREADY-SENT   TO TRUE
  5634*          END-IF
  5635           GO TO 0400-EXIT
  5636*          PERFORM 0025-CLOSE-SOCKET
  5637*                                THRU 0025-EXIT
  5638*          GO TO 0010-RETURN
  5639        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  99
* SOCK03.cbl
  5640     END-IF
  5641     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  5642        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  5643        MOVE 'LF COVERAGE EXPIRED '
  5644                                 TO WS-COMMENT
  5645        MOVE 'E'                 TO WS-LF-STATUS
  5646        GO TO 0400-EXIT
  5647     END-IF
  5648     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5649        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5650        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5651     ELSE
  5652        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  5653     END-IF
  5654     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  5655     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  5656*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  5657     if ws-comp-id = 'AHL'
  5658        move cm-lf-class-cd      to cp-class-code
  5659        if cp-class-code = spaces
  5660           move zeros            to cp-class-code
  5661        end-if
  5662     else
  5663        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5664     end-if
  5665     IF (ws-comp-id = 'DCC' or 'CAP')
  5666        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  5667        MOVE ' '                 TO WS-PDEF-RECORD-SW
  5668        PERFORM 0730-GET-DDF-FACTORS
  5669                                 THRU 0730-EXIT
  5670        IF PDEF-FOUND
  5671           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  5672              (P1 > +8)
  5673              OR (PD-PROD-CODE (P1) = 'L')
  5674           END-PERFORM
  5675           IF P1 < +9
  5676              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  5677           END-IF
  5678        END-IF
  5679     END-IF
  5680     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  5681*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
  5682     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  5683        CM-LF-ALT-BENEFIT-AMT
  5684*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  5685     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  5686                                    WS-LF-REM-BEN
  5687     move cm-lf-premium-amt      to ws-tot-lf-prem
  5688     if ws-lf-co-earnings-calc = 'B'
  5689        COMPUTE WS-TOT-LF-PREM = ws-tot-lf-prem
  5690           + CM-LF-ALT-PREMIUM-AMT
  5691     end-if
  5692     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  5693     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5694        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5695        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5696     ELSE
  5697        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 100
* SOCK03.cbl
  5698     END-IF
  5699     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  5700     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  5701     IF WS-LF-ST-REFUND-CALC > ZERO
  5702         MOVE WS-LF-ST-REFUND-CALC
  5703                                 TO  CP-EARNING-METHOD.
  5704     IF WS-LF-FO-REFUND-CALC > ZERO
  5705         MOVE WS-LF-FO-REFUND-CALC
  5706                                 TO  CP-EARNING-METHOD.
  5707     IF CP-RATING-METHOD = '4'
  5708        MOVE '4'                 TO CP-EARNING-METHOD
  5709     END-IF
  5710*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  5711     if ws-comp-id = 'AHL'
  5712        move cm-lf-class-cd      to cp-class-code
  5713        if cp-class-code = spaces
  5714           move zeros            to cp-class-code
  5715        end-if
  5716     else
  5717        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5718     end-if
  5719     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  5720     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  5721                                     CP-RATING-BENEFIT-AMT.
  5722     IF CP-STATE-STD-ABBRV = 'OR'
  5723         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5724                                         CM-LF-ALT-BENEFIT-AMT.
  5725****   N O T E   ****
  5726*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  5727*      THE OH HARD CODING IN ELCRFNDP
  5728     IF WS-COMP-ID = 'CID'
  5729        IF CP-STATE-STD-ABBRV = 'OH'
  5730           MOVE WS-LF-CO-EARNINGS-CALC
  5731                                 TO CP-EARNING-METHOD
  5732        END-IF
  5733     END-IF
  5734****   N O T E   ****
  5735     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  5736     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  5737     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  5738     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  5739     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  5740     IF CP-EARN-AS-NET-PAY
  5741        IF CP-LOAN-APR <= ZEROS
  5742           IF WS-CF-DEFAULT-APR > ZEROS
  5743              MOVE WS-CF-DEFAULT-APR
  5744                                 TO  CP-LOAN-APR
  5745           END-IF
  5746        END-IF
  5747     END-IF
  5748*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  5749*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  5750*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  5751*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  5752*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  5753*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  5754*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  5755*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 101
* SOCK03.cbl
  5756*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  5757*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  5758*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  5759*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  5760*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  5761*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  5762*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  5763*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  5764*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  5765*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  5766     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  5767     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  5768     DISPLAY ' MADE IT BACK FROM ELRFND '
  5769     IF (CP-ERROR-RATE-IS-ZERO)
  5770        OR (CP-ERROR-RATE-NOT-FOUND)
  5771        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5772        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  5773          DELIMITED BY SIZE INTO WS-COMMENT
  5774        END-STRING
  5775        MOVE 'X'                 TO WS-LF-STATUS
  5776        GO TO 0400-EXIT
  5777*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5778*       IF NOT ALREADY-SENT
  5779*          PERFORM 0020-SEND-BUFFER
  5780*                                THRU 0020-EXIT
  5781*          SET ALREADY-SENT      TO TRUE
  5782*       END-IF
  5783*       PERFORM 0025-CLOSE-SOCKET
  5784*                                THRU 0025-EXIT
  5785*       GO TO 0010-RETURN
  5786     END-IF
  5787     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  5788                                    WS-TOT-LF-RFND
  5789     IF (WS-LF-STATUS = SPACES)
  5790        OR (CP-CALC-REFUND > ZEROS)
  5791        MOVE 'A'                 TO WS-LF-STATUS
  5792     END-IF
  5793     EVALUATE TRUE
  5794        WHEN CP-R-AS-R78
  5795           MOVE 'RULE 78'          TO  WS-LF-METHOD
  5796        WHEN  CP-R-AS-PRORATA
  5797           MOVE 'PRO RATA'         TO  WS-LF-METHOD
  5798        WHEN CP-R-AS-CALIF
  5799           MOVE 'CALIF'            TO  WS-LF-METHOD
  5800        WHEN CP-R-AS-TEXAS
  5801           MOVE 'IRREG'            TO  WS-LF-METHOD
  5802        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  5803           MOVE 'UTAH'             TO  WS-LF-METHOD
  5804        WHEN CP-R-AS-FARM-PLAN
  5805           MOVE 'FARM PLAN'        TO  WS-LF-METHOD
  5806        WHEN CP-R-AS-NET-PAY
  5807           MOVE 'NET PAY'          TO  WS-LF-METHOD
  5808        WHEN CP-R-AS-ANTICIPATION
  5809           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  5810        WHEN CP-R-AS-MEAN
  5811           MOVE 'MEAN'             TO  WS-LF-METHOD
  5812        WHEN CP-R-AS-SUM-OF-DIGITS
  5813           MOVE 'SUM OF DIGIT'     TO  WS-LF-METHOD
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 102
* SOCK03.cbl
  5814     END-EVALUATE
  5815     IF WS-TOT-LF-RFND > ZEROS
  5816        COMPUTE WS-WORK-FACTOR ROUNDED =
  5817           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  5818        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  5819           WS-TOT-LF-COMM
  5820     END-IF
  5821     IF ERACCT-FOUND
  5822        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  5823           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  5824        END-IF
  5825        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5826           IF (AM-COMM-CHARGEBACK (1) = 99)
  5827                     OR
  5828              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5829                     OR
  5830              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5831              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5832              MOVE ZEROS         TO WS-LF-UEC
  5833           END-IF
  5834        END-IF
  5835     END-IF
  5836     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  5837        GO TO 0400-EXIT
  5838     END-IF
  5839     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  5840     MOVE '2'                    TO  CP-EARNING-METHOD
  5841                                     CP-RATING-METHOD.
  5842     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  5843                                     CP-REMAINING-BENEFIT
  5844                                     CP-RATING-BENEFIT-AMT.
  5845     IF CP-STATE-STD-ABBRV = 'OR'
  5846         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5847                                         CM-LF-ALT-BENEFIT-AMT.
  5848     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  5849     IF ws-comp-id = 'CID'
  5850        IF (CP-STATE-STD-ABBRV = 'MN')
  5851           AND (CM-CERT-EFF-DT > X'A4FF')
  5852           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  5853           MOVE '5'              TO CP-EARNING-METHOD
  5854           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  5855        END-IF
  5856     END-IF
  5857     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  5858     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  5859     IF (CP-ERROR-RATE-IS-ZERO)
  5860        OR (CP-ERROR-RATE-NOT-FOUND)
  5861        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5862        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  5863          DELIMITED BY SIZE INTO WS-COMMENT
  5864        END-STRING
  5865        MOVE 'X'              TO WS-LF-STATUS
  5866        GO TO 0400-EXIT
  5867*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5868*       IF NOT ALREADY-SENT
  5869*          PERFORM 0020-SEND-BUFFER
  5870*                                THRU 0020-EXIT
  5871*          SET ALREADY-SENT      TO TRUE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 103
* SOCK03.cbl
  5872*       END-IF
  5873*       PERFORM 0025-CLOSE-SOCKET
  5874*                                THRU 0025-EXIT
  5875*       GO TO 0010-RETURN
  5876     END-IF
  5877     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  5878     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  5879     IF WS-TOT-LF-RFND > ZEROS
  5880        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  5881           WS-TOT-LF-COMM
  5882     END-IF
  5883     IF ERACCT-FOUND
  5884        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5885           IF (AM-COMM-CHARGEBACK (1) = 99)
  5886                     OR
  5887              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5888                     OR
  5889              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5890              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5891              MOVE ZEROS         TO WS-LF-UEC
  5892           END-IF
  5893        END-IF
  5894     END-IF
  5895     .
  5896 0400-EXIT.
  5897     EXIT.
  5898 0500-PROCESS-AH.
  5899     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  5900        GO TO 0500-EXIT
  5901     END-IF
  5902     MOVE ZEROS                  TO WS-TOT-AH-RFND
  5903                                    WS-TOT-AH-PREM
  5904                                    WS-TOT-AH-COMM
  5905     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5906     MOVE ' '                    TO  DC-OPTION-CODE
  5907     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5908     IF NO-CONVERSION-ERROR
  5909        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  5910     ELSE
  5911        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  5912     END-IF
  5913     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
  5914     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  5915     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  5916     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  5917     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  5918     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  5919     MOVE CM-STATE               TO  CP-STATE.
  5920     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  5921     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  5922     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  5923     MOVE '2'                    TO  CP-PROCESS-TYPE.
  5924     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  5925     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  5926     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  5927     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  5928     MOVE WS-CF-CR-REM-TERM-CALC
  5929                                 TO  CP-REM-TERM-METHOD.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 104
* SOCK03.cbl
  5930     IF WS-AH-CO-REM-TERM-CALC > '0'
  5931         MOVE WS-AH-CO-REM-TERM-CALC
  5932                                 TO  CP-REM-TERM-METHOD.
  5933     IF WS-AH-ST-REM-TERM-CALC > '0'
  5934         MOVE WS-AH-ST-REM-TERM-CALC
  5935                                 TO  CP-REM-TERM-METHOD.
  5936     IF WS-AH-AM-REM-TERM-CALC > '0'
  5937         MOVE WS-AH-AM-REM-TERM-CALC
  5938                                 TO  CP-REM-TERM-METHOD.
  5939     IF (WS-COMP-ID = 'CID')
  5940        AND (CP-STATE-STD-ABBRV = 'WI')
  5941        MOVE '7'                 TO CP-REM-TERM-METHOD
  5942        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5943     END-IF
  5944     IF (WS-COMP-ID = 'CID')
  5945        AND (CP-STATE-STD-ABBRV = 'MO')
  5946        AND (CM-CERT-EFF-DT >= X'9B41')
  5947        AND (CM-CERT-EFF-DT <= X'A2FB')
  5948        MOVE '7'                 TO CP-REM-TERM-METHOD
  5949        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5950     END-IF
  5951     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  5952                                     CP-LOAN-TERM.
  5953     IF  NOT  CP-TERM-IS-DAYS
  5954         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  5955             MOVE CM-PMT-EXTENSION-DAYS
  5956                                 TO  CP-TERM-OR-EXT-DAYS
  5957         ELSE
  5958             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  5959     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5960     IF CM-AH-COMM-PCT > ZEROS
  5961        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  5962           CM-AH-PREMIUM-AMT
  5963     END-IF
  5964     IF (ws-comp-id = 'DCC' or 'CAP')
  5965        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  5966        compute ws-tot-ah-comm = cm-ah-premium-amt -
  5967           (cm-ah-clp + cm-addl-clp)
  5968     end-if
  5969     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  5970     IF WS-AH-STATUS = 'D'
  5971        GO TO 0500-EXIT
  5972     END-IF
  5973     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  5974     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  5975     MOVE ' '                    TO WS-CLM-STOP-SW
  5976     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5977     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5978
  5979* EXEC CICS STARTBR
  5980*       DATASET     ('ELMSTR5')
  5981*       RIDFLD      (ELMSTR-KEY)
  5982*       RESP        (WS-RESPONSE)
  5983*    END-EXEC
  5984     MOVE 'ELMSTR5' TO DFHEIV1
  5985     MOVE 0
  5986       TO DFHEIV11
  5987*    MOVE '&,         G          &  N#00005576' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 105
* SOCK03.cbl
  5988     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5989     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5990     MOVE X'204E233030303035353736' TO DFHEIV0(25:11)
  5991     CALL 'kxdfhei1' USING DFHEIV0,
  5992           DFHEIV1,
  5993           ELMSTR-KEY,
  5994           DFHEIV99,
  5995           DFHEIV11,
  5996           DFHEIV99
  5997     MOVE EIBRESP  TO WS-RESPONSE
  5998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5999     DISPLAY ' AFTER START ' WS-RESPONSE
  6000     IF RESP-NORMAL
  6001        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6002           DISPLAY ' AH READNEXT '
  6003
  6004* EXEC CICS READNEXT
  6005*             DATASET   ('ELMSTR5')
  6006*             RIDFLD    (ELMSTR-KEY)
  6007*             INTO      (CLAIM-MASTER)
  6008*             RESP      (WS-RESPONSE)
  6009*          END-EXEC
  6010     MOVE LENGTH OF
  6011      CLAIM-MASTER
  6012       TO DFHEIV12
  6013     MOVE 'ELMSTR5' TO DFHEIV1
  6014     MOVE 0
  6015       TO DFHEIV11
  6016*    MOVE '&.IL                  )  N#00005585' TO DFHEIV0
  6017     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6018     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6019     MOVE X'204E233030303035353835' TO DFHEIV0(25:11)
  6020     CALL 'kxdfhei1' USING DFHEIV0,
  6021           DFHEIV1,
  6022           CLAIM-MASTER,
  6023           DFHEIV12,
  6024           ELMSTR-KEY,
  6025           DFHEIV99,
  6026           DFHEIV11,
  6027           DFHEIV99,
  6028           DFHEIV99
  6029     MOVE EIBRESP  TO WS-RESPONSE
  6030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6031        IF (RESP-NORMAL OR RESP-DUPKEY)
  6032           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6033           AND (CM-CERT-NO = CL-CERT-NO)
  6034           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6035              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6036              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G' OR 'F')
  6037                 IF CLAIM-IS-OPEN
  6038                    DISPLAY ' FOUND OPEN AH CLAIM '
  6039                    MOVE ' OPEN HEALTH CLAIM '
  6040                                 TO WS-COMMENT
  6041                    MOVE 'H'     TO WS-AH-STATUS
  6042                 ELSE
  6043                    DISPLAY ' FOUND CLOSED AH CLAIM '
  6044                    MOVE ' CLOSED HEALTH CLAIM '
  6045                                 TO WS-COMMENT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 106
* SOCK03.cbl
  6046                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  6047                       MOVE CL-PAID-THRU-DT
  6048                                 TO WS-AH-BIN-PAID-THRU-DT
  6049                    END-IF
  6050                 END-IF
  6051              END-IF
  6052           END-IF
  6053        ELSE
  6054           SET I-SAY-TO-STOP TO TRUE
  6055        END-IF
  6056        END-PERFORM
  6057
  6058* EXEC CICS ENDBR
  6059*          DATASET   ('ELMSTR5')
  6060*       END-EXEC
  6061     MOVE 'ELMSTR5' TO DFHEIV1
  6062     MOVE 0
  6063       TO DFHEIV11
  6064*    MOVE '&2                    $   #00005617' TO DFHEIV0
  6065     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6066     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6067     MOVE X'2020233030303035363137' TO DFHEIV0(25:11)
  6068     CALL 'kxdfhei1' USING DFHEIV0,
  6069           DFHEIV1,
  6070           DFHEIV11,
  6071           DFHEIV99
  6072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6073     END-IF
  6074     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6075*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  6076        MOVE WS-AH-BIN-PAID-THRU-DT
  6077                                 TO DC-BIN-DATE-1
  6078        MOVE ' '                 TO DC-OPTION-CODE
  6079        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6080        IF NO-CONVERSION-ERROR
  6081           MOVE DC-GREG-DATE-CYMD
  6082                                 TO WS-CLM-PAID-THRU-DT
  6083        ELSE
  6084           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6085        END-IF
  6086        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  6087           MOVE 'CAN DT NOT > CLM CLOSE DT '
  6088                                 TO WS-COMMENT
  6089           MOVE 'P'              TO WS-AH-STATUS
  6090           GO TO 0500-EXIT
  6091        END-IF
  6092     END-IF
  6093     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6094     IF CM-AH-CURRENT-STATUS = '8'
  6095        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6096           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  6097                                 TO WS-COMMENT
  6098           MOVE 'C'              TO WS-AH-STATUS
  6099           GO TO 0500-EXIT
  6100        END-IF
  6101     END-IF
  6102     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  6103        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 107
* SOCK03.cbl
  6104           MOVE ' SETTLEMENT CLAIM APPLIED '
  6105                                 TO WS-COMMENT
  6106           MOVE 'S'              TO WS-AH-STATUS
  6107*          PERFORM 0030-BUILD-BUFFER
  6108*                                THRU 0030-EXIT
  6109*          IF NOT ALREADY-SENT
  6110*             PERFORM 0020-SEND-BUFFER
  6111*                                THRU 0020-EXIT
  6112*             SET ALREADY-SENT   TO TRUE
  6113*          END-IF
  6114           GO TO 0500-EXIT
  6115*          PERFORM 0025-CLOSE-SOCKET
  6116*                                THRU 0025-EXIT
  6117*          GO TO 0010-RETURN
  6118        END-IF
  6119     END-IF
  6120     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6121        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  6122        MOVE 'AH COVERAGE EXPIRED '
  6123                                 TO WS-COMMENT
  6124        MOVE 'E'                 TO WS-AH-STATUS
  6125        GO TO 0500-EXIT
  6126     END-IF
  6127     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  6128                                    WS-AH-PREM
  6129     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  6130     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  6131        * CP-REMAINING-TERM-1
  6132     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  6133                                     WS-AH-REM-TERM
  6134     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6135     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6136     IF WS-AH-ST-REFUND-CALC > ZERO
  6137         MOVE WS-AH-ST-REFUND-CALC
  6138                                 TO  CP-EARNING-METHOD.
  6139     IF WS-AH-FO-REFUND-CALC > ZERO
  6140         MOVE WS-AH-FO-REFUND-CALC
  6141                                 TO  CP-EARNING-METHOD.
  6142*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6143     if ws-comp-id = 'AHL'
  6144        move cm-ah-class-cd      to cp-class-code
  6145        if cp-class-code = spaces
  6146           move zeros            to cp-class-code
  6147        end-if
  6148     else
  6149        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6150     end-if
  6151     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6152     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6153                                     CP-RATING-BENEFIT-AMT.
  6154     IF CP-STATE-STD-ABBRV = 'OR'
  6155         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6156                                         CM-AH-ORIG-TERM.
  6157     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6158     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6159     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6160     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6161     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 108
* SOCK03.cbl
  6162     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6163     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6164     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6165     MOVE ' '                    TO  DC-OPTION-CODE.
  6166     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6167     IF CP-STATE-STD-ABBRV = 'OH'
  6168        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6169         IF (CP-ORIGINAL-TERM > 60)
  6170           AND (DC-GREG-DATE-1-YMD > '831101')
  6171           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6172             MOVE '6'            TO  CP-EARNING-METHOD
  6173         END-IF
  6174        END-IF
  6175        IF WS-COMP-ID = 'CID'
  6176           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6177                           LOW-VALUES)
  6178              IF CP-CRITICAL-PERIOD
  6179                 MOVE '2'       TO CP-EARNING-METHOD
  6180              ELSE
  6181                 MOVE '6'       TO CP-EARNING-METHOD
  6182              END-IF
  6183           ELSE
  6184              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  6185                 MOVE '2'       TO CP-EARNING-METHOD
  6186              ELSE
  6187                 IF ((CM-LF-ORIG-TERM > 60) AND
  6188                    (CM-RATE-CLASS NOT = 'L '))
  6189                               OR
  6190                    (WS-LF-CO-EARNINGS-CALC = '5')
  6191                    IF CP-CRITICAL-PERIOD
  6192                       MOVE '2'  TO CP-EARNING-METHOD
  6193                    ELSE
  6194                       MOVE '6'  TO CP-EARNING-METHOD
  6195                    END-IF
  6196                 ELSE
  6197                    MOVE '1'     TO CP-EARNING-METHOD
  6198                 END-IF
  6199              END-IF
  6200           END-IF
  6201        END-IF
  6202     END-IF
  6203     IF CP-STATE-STD-ABBRV = 'VA'
  6204       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6205         IF DC-GREG-DATE-1-YMD > '921231'
  6206            IF CP-ORIGINAL-TERM > 61
  6207                MOVE '6'            TO  CP-EARNING-METHOD
  6208            ELSE
  6209                MOVE '1'            TO  CP-EARNING-METHOD.
  6210     IF CP-EARN-AS-NET-PAY
  6211        IF CP-LOAN-APR <= ZEROS
  6212           IF WS-CF-DEFAULT-APR > ZEROS
  6213              MOVE WS-CF-DEFAULT-APR
  6214                                 TO  CP-LOAN-APR
  6215           END-IF
  6216        END-IF
  6217     END-IF
  6218     IF WS-COMP-ID = 'DCC' or 'CAP'
  6219        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 109
* SOCK03.cbl
  6220           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  6221           MOVE 'S'              TO CP-EARNING-METHOD
  6222        END-IF
  6223     END-IF
  6224     MOVE WS-CANCEL-REASON       TO CP-CANCEL-REASON
  6225     IF (WS-COMP-ID = 'DCC' or 'CAP')
  6226        AND (CP-EARNING-METHOD = 'D')
  6227        MOVE +0                  TO WS-DDF-ADMIN-FEES
  6228                                    WS-DDF-CSO-ADMIN-FEE
  6229                                    WS-DDF-1ST-YR-TOT-EXP
  6230                                    WS-DDF-COMM-AND-MFEE
  6231        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  6232           S1 > +10
  6233           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  6234              IF (AM-A-COM (S1) NUMERIC)
  6235                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  6236                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  6237              ELSE
  6238                 MOVE +0         TO WS-COMM-PCT C0
  6239                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  6240                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  6241              END-IF
  6242              IF AM-COM-TYP (S1) = 'L' OR 'N'
  6243                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  6244                    + WS-COMM-PCT
  6245              END-IF
  6246              IF AM-COM-TYP (S1) = 'N'
  6247                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  6248                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  6249              END-IF
  6250              IF AM-COM-TYP (S1) = 'J' OR 'L'
  6251                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  6252                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  6253              END-IF
  6254              IF AM-COM-TYP (S1) = 'I'
  6255                 COMPUTE WS-DDF-COMM-AND-MFEE
  6256                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  6257              END-IF
  6258           END-IF
  6259        END-PERFORM
  6260        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  6261        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  6262        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  6263           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  6264     END-IF
  6265     IF (WS-COMP-ID = 'DCC' or 'CAP')
  6266        AND (CP-EARNING-METHOD = 'D')
  6267        AND (ws-CANCEL-REASON NOT = 'R')
  6268        PERFORM 0730-GET-DDF-FACTORS
  6269                                 THRU 0730-EXIT
  6270        IF NOT PDEF-FOUND
  6271           MOVE ' DDF UE FACTORS  NOT FOUND '
  6272                                 TO WS-COMMENT
  6273           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  6274           PERFORM 0030-BUILD-BUFFER
  6275                                 THRU 0030-EXIT
  6276           PERFORM 0020-SEND-BUFFER
  6277                                 THRU 0020-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 110
* SOCK03.cbl
  6278           PERFORM 0025-CLOSE-SOCKET
  6279                                 THRU 0025-EXIT
  6280           GO TO 0010-RETURN
  6281        END-IF
  6282*       IF NOT PDEF-FOUND
  6283*          MOVE ER-9999          TO EMI-ERROR
  6284*          PERFORM 9700-ERROR-FORMAT
  6285*                                THRU 9799-EXIT
  6286*          GO TO 8200-SEND-DATAONLY
  6287*       END-IF
  6288        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  6289                                 TO CP-DDF-LO-FACT
  6290        MOVE PD-UEP-FACTOR (P1 P2)
  6291                                 TO CP-DDF-HI-FACT
  6292        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  6293        MOVE CM-AH-CLP           TO CP-DDF-CLP
  6294        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  6295        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  6296           + PD-1ST-YR-ADMIN-ALLOW
  6297        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  6298*       IF PI-CLP-YN = 'Y'
  6299*          MOVE 'C'              TO CP-DDF-SPEC-CALC
  6300*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  6301*                                   CP-DDF-CLP
  6302*          MOVE ZEROS            TO CP-1ST-YR-ALLOW
  6303*       END-IF
  6304        IF DD-IU-PRESENT
  6305           MOVE 'I'              TO CP-EARNING-METHOD
  6306        END-IF
  6307        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6308                                    CP-CLP-RATE-UP
  6309        IF (CP-CALC-GROSS-FEE)
  6310           AND (CP-IU-RATE-UP NOT = ZEROS)
  6311           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  6312              / CP-ORIGINAL-PREMIUM)
  6313           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  6314              / (1 - TEX-FACT-8)
  6315        END-IF
  6316     END-IF
  6317     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6318     IF (CP-ERROR-RATE-IS-ZERO)
  6319        OR (CP-ERROR-RATE-NOT-FOUND)
  6320        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6321        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  6322          DELIMITED BY SIZE INTO WS-COMMENT
  6323        END-STRING
  6324        IF WS-AH-STATUS NOT = 'H'
  6325           MOVE 'X'                 TO WS-AH-STATUS
  6326        END-IF
  6327        GO TO 0500-EXIT
  6328*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6329*       IF NOT ALREADY-SENT
  6330*          PERFORM 0020-SEND-BUFFER
  6331*                                THRU 0020-EXIT
  6332*          SET ALREADY-SENT      TO TRUE
  6333*       END-IF
  6334*       PERFORM 0025-CLOSE-SOCKET
  6335*                                THRU 0025-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 111
* SOCK03.cbl
  6336*       GO TO 0010-RETURN
  6337     END-IF
  6338     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  6339                                    WS-TOT-AH-RFND
  6340     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  6341     IF ((WS-AH-STATUS = SPACES)
  6342        OR (CP-CALC-REFUND > ZEROS))
  6343                  AND
  6344          (WS-AH-STATUS NOT = 'H')
  6345        MOVE 'A'                 TO WS-AH-STATUS
  6346     END-IF
  6347     IF WS-COMP-ID = 'DCC' or 'CAP'
  6348        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6349        AND (CP-EARNING-METHOD = 'D' OR 'I')
  6350        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6351        MOVE 'C'                 TO CP-DDF-SPEC-CALC
  6352        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
  6353        MOVE ZEROS               TO CP-1ST-YR-ALLOW
  6354        PERFORM 0720-LINK-REFUND THRU  0720-EXIT
  6355        MOVE CP-CALC-REFUND      TO ws-ah-rfnd-clp
  6356        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
  6357     END-IF
  6358     EVALUATE TRUE
  6359        WHEN CP-R-AS-R78
  6360           MOVE 'RULE 78'          TO  WS-AH-METHOD
  6361        WHEN CP-R-AS-PRORATA
  6362           MOVE 'PRO RATA'         TO  WS-AH-METHOD
  6363        WHEN CP-REFUND-TYPE-USED = '3'
  6364           MOVE 'CALIF'            TO  WS-AH-METHOD
  6365        WHEN CP-R-AS-TEXAS
  6366           MOVE 'IRREG'            TO  WS-AH-METHOD
  6367        WHEN CP-R-AS-FARM-PLAN
  6368           MOVE 'FARM PLAN'        TO  WS-AH-METHOD
  6369        WHEN CP-R-AS-NET-PAY
  6370           MOVE 'NET PAY'          TO  WS-AH-METHOD
  6371        WHEN CP-R-AS-ANTICIPATION
  6372           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  6373        WHEN CP-R-AS-MEAN
  6374           MOVE 'MEAN'             TO  WS-AH-METHOD
  6375        WHEN CP-R-AS-SUM-OF-DIGITS
  6376           MOVE 'SUM OF DIGIT'     TO  WS-AH-METHOD
  6377        WHEN CP-GAP-ACTUARIAL
  6378           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  6379     END-EVALUATE
  6380     IF WS-TOT-AH-RFND > ZEROS
  6381        IF (ws-comp-id = 'DCC' or 'CAP')
  6382           AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6383           compute ws-work-factor rounded =
  6384              ws-ah-rfnd-clp / cm-ah-clp
  6385        else
  6386           COMPUTE WS-WORK-FACTOR ROUNDED =
  6387              WS-TOT-AH-RFND / WS-TOT-AH-PREM
  6388        end-if
  6389        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  6390           WS-TOT-AH-COMM
  6391     END-IF
  6392     IF ERACCT-FOUND
  6393        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 112
* SOCK03.cbl
  6394           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6395        END-IF
  6396        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6397           IF (AM-COMM-CHARGEBACK (1) = 99)
  6398                     OR
  6399              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6400                     OR
  6401              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6402              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6403              MOVE ZEROS         TO WS-AH-UEC
  6404           END-IF
  6405        END-IF
  6406     END-IF
  6407     .
  6408 0500-EXIT.
  6409     EXIT.
  6410 0700-LINK-REM-TERM.
  6411
  6412* EXEC CICS LINK
  6413*        PROGRAM   ('ELRTRM')
  6414*        COMMAREA  (CALCULATION-PASS-AREA)
  6415*        LENGTH    (CP-COMM-LENGTH)
  6416*    END-EXEC.
  6417     MOVE 'ELRTRM' TO DFHEIV1
  6418*    MOVE '."C                   (   #00005958' TO DFHEIV0
  6419     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6421     MOVE X'2020233030303035393538' TO DFHEIV0(25:11)
  6422     CALL 'kxdfhei1' USING DFHEIV0,
  6423           DFHEIV1,
  6424           CALCULATION-PASS-AREA,
  6425           CP-COMM-LENGTH,
  6426           DFHEIV99,
  6427           DFHEIV99,
  6428           DFHEIV99,
  6429           DFHEIV99
  6430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6431
  6432 0700-EXIT.
  6433     EXIT.
  6434 0710-LINK-REM-AMOUNT.
  6435
  6436* EXEC CICS LINK
  6437*        PROGRAM   ('ELRAMT')
  6438*        COMMAREA  (CALCULATION-PASS-AREA)
  6439*        LENGTH    (CP-COMM-LENGTH)
  6440*    END-EXEC
  6441     MOVE 'ELRAMT' TO DFHEIV1
  6442*    MOVE '."C                   (   #00005966' TO DFHEIV0
  6443     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6444     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6445     MOVE X'2020233030303035393636' TO DFHEIV0(25:11)
  6446     CALL 'kxdfhei1' USING DFHEIV0,
  6447           DFHEIV1,
  6448           CALCULATION-PASS-AREA,
  6449           CP-COMM-LENGTH,
  6450           DFHEIV99,
  6451           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 113
* SOCK03.cbl
  6452           DFHEIV99,
  6453           DFHEIV99
  6454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6455     .
  6456 0710-EXIT.
  6457     EXIT.
  6458 0720-LINK-REFUND.
  6459
  6460* EXEC CICS LINK
  6461*        PROGRAM   ('ELRFND')
  6462*        COMMAREA  (CALCULATION-PASS-AREA)
  6463*        LENGTH    (CP-COMM-LENGTH)
  6464*    END-EXEC
  6465     MOVE 'ELRFND' TO DFHEIV1
  6466*    MOVE '."C                   (   #00005975' TO DFHEIV0
  6467     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6468     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6469     MOVE X'2020233030303035393735' TO DFHEIV0(25:11)
  6470     CALL 'kxdfhei1' USING DFHEIV0,
  6471           DFHEIV1,
  6472           CALCULATION-PASS-AREA,
  6473           CP-COMM-LENGTH,
  6474           DFHEIV99,
  6475           DFHEIV99,
  6476           DFHEIV99,
  6477           DFHEIV99
  6478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6479     .
  6480 0720-EXIT.
  6481     EXIT.
  6482 0730-GET-DDF-FACTORS.
  6483     MOVE ' '                    TO WS-PDEF-RECORD-SW
  6484     MOVE WS-COMP-CD             TO ERPDEF-KEY
  6485     MOVE CM-STATE               TO ERPDEF-STATE
  6486     if cm-clp-state not = cm-state and spaces and zeros
  6487        move cm-clp-state        to erpdef-state
  6488     end-if
  6489     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  6490     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  6491     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  6492     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  6493     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  6494
  6495* EXEC CICS STARTBR
  6496*        DATASET  ('ERPDEF')
  6497*        RIDFLD   (ERPDEF-KEY)
  6498*        GTEQ
  6499*        RESP     (WS-RESPONSE)
  6500*    END-EXEC
  6501     MOVE 'ERPDEF' TO DFHEIV1
  6502     MOVE 0
  6503       TO DFHEIV11
  6504*    MOVE '&,         G          &  N#00005995' TO DFHEIV0
  6505     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6506     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6507     MOVE X'204E233030303035393935' TO DFHEIV0(25:11)
  6508     CALL 'kxdfhei1' USING DFHEIV0,
  6509           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 114
* SOCK03.cbl
  6510           ERPDEF-KEY,
  6511           DFHEIV99,
  6512           DFHEIV11,
  6513           DFHEIV99
  6514     MOVE EIBRESP  TO WS-RESPONSE
  6515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6516     IF NOT RESP-NORMAL
  6517        GO TO 0730-EXIT
  6518     END-IF
  6519     .
  6520 0730-READNEXT.
  6521
  6522* EXEC CICS READNEXT
  6523*       DATASET  ('ERPDEF')
  6524*       INTO     (PRODUCT-MASTER)
  6525*       RIDFLD   (ERPDEF-KEY)
  6526*       RESP     (WS-RESPONSE)
  6527*    END-EXEC
  6528     MOVE LENGTH OF
  6529      PRODUCT-MASTER
  6530       TO DFHEIV12
  6531     MOVE 'ERPDEF' TO DFHEIV1
  6532     MOVE 0
  6533       TO DFHEIV11
  6534*    MOVE '&.IL                  )  N#00006006' TO DFHEIV0
  6535     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6536     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6537     MOVE X'204E233030303036303036' TO DFHEIV0(25:11)
  6538     CALL 'kxdfhei1' USING DFHEIV0,
  6539           DFHEIV1,
  6540           PRODUCT-MASTER,
  6541           DFHEIV12,
  6542           ERPDEF-KEY,
  6543           DFHEIV99,
  6544           DFHEIV11,
  6545           DFHEIV99,
  6546           DFHEIV99
  6547     MOVE EIBRESP  TO WS-RESPONSE
  6548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6549     IF NOT RESP-NORMAL
  6550        GO TO 0730-ENDBR
  6551     END-IF
  6552     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  6553        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  6554           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  6555        ELSE
  6556           GO TO 0730-READNEXT
  6557        END-IF
  6558     ELSE
  6559        GO TO 0730-ENDBR
  6560     END-IF
  6561     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  6562        (P1 > +8)
  6563        OR (PD-PROD-CODE (P1) = 'I')
  6564     END-PERFORM
  6565     IF P1 < +9
  6566        SET DD-IU-PRESENT        TO TRUE
  6567     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 115
* SOCK03.cbl
  6568     IF CM-LOAN-TERM = ZEROS
  6569        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  6570     END-IF
  6571     IF PD-TRUNCATED = 'Y'
  6572        MOVE CM-LOAN-TERM        TO WS-TERM
  6573     ELSE
  6574        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  6575     END-IF
  6576     EVALUATE TRUE
  6577        WHEN WS-TERM > +168
  6578           MOVE 15               TO P1
  6579        WHEN WS-TERM > +156
  6580           MOVE 14               TO P1
  6581        WHEN WS-TERM > +144
  6582           MOVE 13               TO P1
  6583        WHEN WS-TERM > +132
  6584           MOVE 12               TO P1
  6585        WHEN WS-TERM > +120
  6586           MOVE 11               TO P1
  6587        WHEN WS-TERM > +108
  6588           MOVE 10               TO P1
  6589        WHEN WS-TERM > +96
  6590           MOVE 9                TO P1
  6591        WHEN WS-TERM > +84
  6592           MOVE 8                TO P1
  6593        WHEN WS-TERM > +72
  6594           MOVE 7                TO P1
  6595        WHEN WS-TERM > +60
  6596           MOVE 6                TO P1
  6597        WHEN WS-TERM > +48
  6598           MOVE 5                TO P1
  6599        WHEN WS-TERM > +36
  6600           MOVE 4                TO P1
  6601        WHEN WS-TERM > +24
  6602           MOVE 3                TO P1
  6603        WHEN WS-TERM > +12
  6604           MOVE 2                TO P1
  6605        WHEN OTHER
  6606           MOVE 1                TO P1
  6607     END-EVALUATE
  6608     EVALUATE TRUE
  6609*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  6610*          AND (DD-IU-PRESENT)
  6611*          MOVE 2                TO P2
  6612*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  6613*          MOVE 1                TO P2
  6614        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  6615           MOVE 2                TO P2
  6616        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  6617           MOVE 3                TO P2
  6618        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  6619           MOVE 4                TO P2
  6620        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  6621           MOVE 5                TO P2
  6622        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  6623           MOVE 6                TO P2
  6624        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  6625           MOVE 7                TO P2
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 116
* SOCK03.cbl
  6626        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  6627           MOVE 8                TO P2
  6628        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  6629           MOVE 9                TO P2
  6630        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  6631           MOVE 10               TO P2
  6632        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  6633           MOVE 11               TO P2
  6634        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  6635           MOVE 12               TO P2
  6636        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  6637           MOVE 13               TO P2
  6638        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  6639           MOVE 14               TO P2
  6640        WHEN OTHER
  6641           MOVE 15               TO P2
  6642     END-EVALUATE
  6643     .
  6644 0730-ENDBR.
  6645
  6646* EXEC CICS ENDBR
  6647*       DATASET  ('ERPDEF')
  6648*    END-EXEC
  6649     MOVE 'ERPDEF' TO DFHEIV1
  6650     MOVE 0
  6651       TO DFHEIV11
  6652*    MOVE '&2                    $   #00006108' TO DFHEIV0
  6653     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6654     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6655     MOVE X'2020233030303036313038' TO DFHEIV0(25:11)
  6656     CALL 'kxdfhei1' USING DFHEIV0,
  6657           DFHEIV1,
  6658           DFHEIV11,
  6659           DFHEIV99
  6660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6661     .
  6662 0730-EXIT.
  6663     EXIT.
  6664 0740-GET-ERCTBL.
  6665     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  6666     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  6667     MOVE 'A'                    TO CTBL-BEN-TYPE
  6668     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  6669     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  6670     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  6671     IF RESP-NORMAL
  6672        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  6673     ELSE
  6674        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  6675        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  6676        MOVE 'A'                    TO CTBL-BEN-TYPE
  6677        MOVE 'AA'                   TO CTBL-BEN-CODE
  6678        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  6679        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  6680        IF RESP-NORMAL
  6681           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  6682        END-IF
  6683     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 117
* SOCK03.cbl
  6684     .
  6685 0740-EXIT.
  6686     EXIT.
  6687 0750-READ-ERCTBL.
  6688
  6689* EXEC CICS READ
  6690*         INTO    (COMM-TABLE-RECORD)
  6691*         DATASET ('ERCTBL')
  6692*         RIDFLD  (CTBL-KEY)
  6693*         RESP    (WS-RESPONSE)
  6694*    END-EXEC
  6695     MOVE LENGTH OF
  6696      COMM-TABLE-RECORD
  6697       TO DFHEIV11
  6698     MOVE 'ERCTBL' TO DFHEIV1
  6699*    MOVE '&"IL       E          (  N#00006138' TO DFHEIV0
  6700     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6701     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6702     MOVE X'204E233030303036313338' TO DFHEIV0(25:11)
  6703     CALL 'kxdfhei1' USING DFHEIV0,
  6704           DFHEIV1,
  6705           COMM-TABLE-RECORD,
  6706           DFHEIV11,
  6707           CTBL-KEY,
  6708           DFHEIV99,
  6709           DFHEIV99,
  6710           DFHEIV99
  6711     MOVE EIBRESP  TO WS-RESPONSE
  6712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6713     .
  6714 0750-EXIT.
  6715     EXIT.
  6716 0760-FIND-COMM.
  6717     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  6718        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  6719        OR (C1 > +3)
  6720     END-PERFORM
  6721     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  6722        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  6723        OR (C2 > +3)
  6724     END-PERFORM
  6725     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  6726        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  6727        OR (C3 > +3)
  6728     END-PERFORM
  6729     IF C1 > +3
  6730        MOVE +1                  TO C1
  6731     END-IF
  6732     IF C2 > +3
  6733        MOVE +1                  TO C2
  6734     END-IF
  6735     IF C3 > +3
  6736        MOVE +1                  TO C3
  6737     END-IF
  6738     IF C1 = +3
  6739        MOVE +18                 TO C0
  6740     ELSE
  6741        IF C1 = +2
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 118
* SOCK03.cbl
  6742           MOVE +9               TO C0
  6743        END-IF
  6744     END-IF
  6745     IF C2 = +3
  6746        ADD +6                   TO C0
  6747     ELSE
  6748        IF C2 = +2
  6749           ADD +3                TO C0
  6750        END-IF
  6751     END-IF
  6752     ADD C3                      TO C0
  6753     MOVE CT-RT (C0)             TO WS-COMM-PCT
  6754     .
  6755 0760-EXIT.
  6756     EXIT.
  6757 9700-DATE-LINK.
  6758
  6759* EXEC CICS LINK
  6760*         PROGRAM  ('ELDATCV')
  6761*         COMMAREA (DATE-CONVERSION-DATA)
  6762*         LENGTH   (DC-COMM-LENGTH)
  6763*    END-EXEC.
  6764     MOVE 'ELDATCV' TO DFHEIV1
  6765*    MOVE '."C                   (   #00006189' TO DFHEIV0
  6766     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6767     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6768     MOVE X'2020233030303036313839' TO DFHEIV0(25:11)
  6769     CALL 'kxdfhei1' USING DFHEIV0,
  6770           DFHEIV1,
  6771           DATE-CONVERSION-DATA,
  6772           DC-COMM-LENGTH,
  6773           DFHEIV99,
  6774           DFHEIV99,
  6775           DFHEIV99,
  6776           DFHEIV99
  6777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6778
  6779 9700-EXIT.
  6780      EXIT.
  6781
  6782 9999-DFHBACK SECTION.
  6783     MOVE '9%                    "   ' TO DFHEIV0
  6784     MOVE 'SOCK03' TO DFHEIV1
  6785     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6786     GOBACK.
  6787 9999-DFHEXIT.
  6788     IF DFHEIGDJ EQUAL 0001
  6789         NEXT SENTENCE.
  6790     MOVE '9%                    "   ' TO DFHEIV0
  6791     MOVE 'SOCK03' TO DFHEIV1
  6792     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6793     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       18424     Code:       28593
