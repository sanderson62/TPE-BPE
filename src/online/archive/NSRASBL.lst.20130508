* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page   1
* NSRASBL.cbl
* Options: int("NSRASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSRASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRASBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSRASLTR
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* ChangeS ARE MARKED BY THE Change EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  Change   Change REQUEST PGMR  DESCRIPTION OF Change
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page   2
* NSRASBL.cbl
    14* 060611    2011022800001  PEMA  NEW PROGRAM
    15* 122911    2011022800001  AJRA  ADD VA DISCLOSURE TO CERT PRINT
    16* 071212    2011022800001  AJRA  ADD UNDW ID
    17* 072312    2011022800001  AJRA    ADD NEW FIELDS
    18* 090612  IR2012090600001  AJRA  NAPERSOFT
    19* 091112  IR2012091100002  AJRA  FIX AKA
    20* 091312  IR2012091100004  AJRA  FIX JOINT NAME
    21* 092412  IR2012092350004  AJRA  FIX CANCEL AMT
    22* 100112  IR2012100100002  AJRA  FIX ADDRESS WITH 2 SPACES
    23* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    24* 101412    2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    25* 101812    2012101700002  AJRA  READ ENDT BY ARCHIVE NO
    26* 110612    2012101700002  AJRA  ADD NEW FIELDS
    27* 121112    2012101700002  AJRA  HANDLE .01 PREM AND 9999999 BEN
    28* 121712    2012101700002  AJRA  ADD DEFAULT AGE FLAG
    29******************************************************************
    30 ENVIRONMENT DIVISION.
    31 DATA DIVISION.
    32 working-storage section.
    33 01  DFH-START PIC X(04).
    34 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    35 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    36 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    37 77  S1                          PIC S999 COMP-3 VALUE +0.
    38 77  E1                          PIC S999 COMP-3 VALUE +0.
    39 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    40 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    41 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    42 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    43 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    44 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    45 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    46 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    47 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    48 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    49 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    50 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    51     88  FOUND-BENE                  VALUE 'Y'.
    52 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    53 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    54 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    55 77  WS-ERPNDB-SW                PIC X  VALUE ' '.
    56     88  END-OF-ERPNDB              VALUE 'Y'.
    57 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    58     88  ACCT-FOUND                 VALUE 'Y'.
    59 77  WS-ELCERT-SW                PIC X  VALUE ' '.
    60     88  CERT-FOUND                 VALUE 'Y'.
    61     88  CERT-NOT-FOUND             VALUE 'N'.
    62 77  WS-ERENDT-SW                PIC X  VALUE ' '.
    63     88  ENDT-FOUND                 VALUE 'Y'.
    64     88  ENDT-NOT-FOUND             VALUE 'N'.
    65 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    66     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
    67 77  WS-LF-ABBRV                 PIC X(10) VALUE SPACES.
    68 77  WS-LF-DESC                  PIC X(02) VALUE SPACES.
    69 77  WS-LF-EARN                  PIC X     VALUE ' '.
    70 77  WS-WAIT-PER                 PIC X(03) VALUE ZEROS.
    71 77  WS-RET-ELIM                 PIC X(01) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page   3
* NSRASBL.cbl
    72 77  WS-AH-DESC                  PIC X(35) VALUE SPACES.
    73 77  WS-BEN-DAYS                 PIC X(02) VALUE ZEROS.
    74 77  WS-CSR-ID                   PIC XXXX  VALUE SPACES.
    75 77  WS-LF-BENCD                 PIC XX    VALUE '00'.
    76 77  WS-AH-BENCD                 PIC XX    VALUE '00'.
    77 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    78 77  WS-COMPANY-CD               PIC X  VALUE LOW-VALUES.
    79 77  WS-WORK-PREM                PIC S9(9)V99 COMP-3 VALUE +0.
    80 77  WS-WORK-LF-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    81 77  WS-WORK-ALT-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    82 77  WS-WORK-CMB-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    83 77  WS-WORK-AH-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    84 77  WS-WORK-REF                 PIC S9(9)V99 COMP-3 VALUE +0.
    85 77  WS-WORK-LF-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    86 77  WS-WORK-AH-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    87 77  WS-ISSUE-CANCEL-SW          PIC X  VALUE SPACES.
    88     88  PROCESS-ISSUE               VALUE 'I'.
    89     88  PROCESS-CANCEL              VALUE 'C'.
    90 77  WS-SAVE-OUT-LETTER          PIC X(6)  VALUE SPACES.
    91 77  WS-WORK-COMM                PIC 9(7)V99 VALUE ZEROS.
    92 77  WS-DIFF                     PIC 999 VALUE ZEROS.
    93 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
    94 77  WS-CHGBK-LIFE-PCT           PIC S9V9(5) COMP-3 VALUE +0.
    95 77  WS-CHGBK-AH-PCT             PIC S9V9(5) COMP-3 VALUE +0.
    96 77  WS-CERT-EFF-DT              PIC XX  VALUE SPACES.
    97 77  LINK-ELVADS                 PIC X(8) VALUE 'ELVADS'.
    98 01  WS-CALC-FIELDS.
    99     12  WS-WRK-AMOUNT           PIC S9(7)V99 COMP-3 VALUE +0.
   100     12  WS-WRK-AMOUNT2          PIC S9(7)V99 COMP-3 VALUE +0.
   101     12  WS-CSO-LF-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   102     12  WS-CSO-ALT-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   103     12  WS-CSO-CMB-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   104     12  WS-CSO-AH-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   105     12  WS-CSO-PORTION          PIC S9(7)V99 COMP-3 VALUE +0.
   106     12  WS-ACCT-LF-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   107     12  WS-ACCT-ALT-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   108     12  WS-ACCT-CMB-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   109     12  WS-ACCT-AH-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   110     12  WS-ACCT-PORTION         PIC S9(7)V99 COMP-3 VALUE +0.
   111     12  WS-CSO-ORIG-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   112     12  WS-CSO-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   113     12  WS-CSO-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   114     12  WS-CSO-ORIG-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   115     12  WS-CSO-ORIG-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   116     12  WS-ACCT-ORIG-LF-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   117     12  WS-ACCT-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   118     12  WS-ACCT-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   119     12  WS-ACCT-ORIG-AH-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   120     12  WS-ACCT-ORIG-PORTION    PIC S9(7)V99 COMP-3 VALUE +0.
   121     12  WS-CSO-NEW-LF-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   122     12  WS-CSO-NEW-ALT-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   123     12  WS-CSO-NEW-CMB-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   124     12  WS-CSO-NEW-AH-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   125     12  WS-CSO-NEW-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   126     12  WS-ACCT-NEW-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   127     12  WS-ACCT-NEW-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   128     12  WS-ACCT-NEW-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   129     12  WS-ACCT-NEW-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page   4
* NSRASBL.cbl
   130     12  WS-ACCT-NEW-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   131     12  WS-CSO-LF-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   132     12  WS-CSO-ALT-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   133     12  WS-CSO-CMB-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   134     12  WS-CSO-AH-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   135     12  WS-CSO-PORTION-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   136     12  WS-ACCT-LF-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   137     12  WS-ACCT-ALT-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   138     12  WS-ACCT-CMB-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   139     12  WS-ACCT-AH-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   140     12  WS-ACCT-PORTION-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   141 01  WS-SAVE-ERACCT-REC          PIC X(2000).
   142 01  WS-XML-WORK                 PIC X(4200)  VALUE SPACES.
   143 01 response-code         pic s9(8) comp.
   144 01 display-response      pic 9(8).
   145 01 bl-index              pic 9(8) comp.
   146 01 max-last-name         pic x(18).
   147 01 first-initial         pic x.
   148 01 name-in-range-flag    pic 9.
   149 01 max-entries           pic s9(8) comp value 100.
   150 01 WS-PASSED-DT          PIC XX   VALUE LOW-VALUES.
   151 01 lower-case    pic x(26) value
   152            "abcdefghijklmnopqrstuvwxyz".
   153 01 upper-case    pic x(26) value
   154            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
   155
   156*                                COPY ELCVADS.
   157******************************************************************
   158*                                                                *
   159*                                                                *
   160*                            ELCVADS.                            *
   161*                                                                *
   162*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
   163*   ELVADS                  LENGTH = 350                         *
   164******************************************************************
   165******************************************************************
   166*                   C H A N G E   L O G
   167*
   168* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   169*-----------------------------------------------------------------
   170*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   171* EFFECTIVE    NUMBER
   172*-----------------------------------------------------------------
   173* 100111    2011022800001  AJRA  NAPERSOFT
   174******************************************************************
   175
   176 01  VIRGINIA-DISCLOSURE.
   177     12  VD-COMPANY-CD              PIC X.
   178     12  VD-CARRIER                 PIC X.
   179     12  VD-GROUPING.
   180         20  VD-GROUPING-PREFIX     PIC XXX.
   181         20  VD-GROUPING-PRIME      PIC XXX.
   182     12  VD-STATE                   PIC XX.
   183     12  VD-ACCOUNT.
   184         20  VD-ACCOUNT-PREFIX      PIC X(4).
   185         20  VD-ACCOUNT-PRIME       PIC X(6).
   186     12  VD-CERT-EFF-DT             PIC XX.
   187     12  VD-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page   5
* NSRASBL.cbl
   188         20  VD-CERT-PRIME          PIC X(10).
   189         20  VD-CERT-SFX            PIC X.
   190     12  VD-ENTRY-BATCH             PIC X(6).
   191     12  VD-CSR-ID                  PIC X(4).
   192     12  VD-NAME.
   193         20  VD-INSURED-LAST-NAME   PIC X(15).
   194         20  VD-INSURED-FIRST-NAME.
   195             24  VD-INSURED-1ST-INIT PIC X.
   196             24  FILLER             PIC X(9).
   197         20  VD-INSURED-MIDDLE-INIT PIC X.
   198     12  VD-JOINT-INSURED.
   199         20 VD-JOINT-LAST-NAME      PIC X(15).
   200         20 VD-JOINT-FIRST-NAME.
   201            24  VD-JOINT-FIRST-INIT PIC X.
   202            24  FILLER              PIC X(9).
   203         20 VD-JOINT-MIDDLE-INIT    PIC X.
   204     12  VD-INSURED-ADDRESS-1       PIC X(30).
   205     12  VD-INSURED-ADDRESS-2       PIC X(30).
   206     12  VD-INSURED-CITY-STATE.
   207         20  VD-INSURED-CITY        PIC X(28).
   208         20  VD-INSURED-STATE       PIC XX.
   209     12  VD-INSURED-ZIP-CODE.
   210         20  VD-INSURED-ZIP-PRIME.
   211             24  VD-INSURED-ZIP-1   PIC X.
   212                 88  VD-CANADIAN-POST-CODE
   213                                       VALUE 'A' THRU 'Z'.
   214             24  FILLER             PIC X(4).
   215         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
   216     12  VD-BENEFICIARY-NAME        PIC X(30).
   217     12  VD-ACCOUNT-NAME            PIC X(30).
   218     12  VD-LOAN-TERM               PIC S999   COMP-3.
   219     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   220     12  VD-1ST-PMT-DT              PIC XX.
   221     12  VD-LIFE-BENEFIT-CD         PIC XX.
   222         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
   223         88  VD-INVALID-LIFE           VALUE '  ' '00'
   224                                             '90' THRU '99'.
   225     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
   226                                    PIC XX.
   227     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   228     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   229     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
   230     12  VD-LF-TERM                 PIC S999   COMP-3.
   231     12  VD-AH-BENEFIT-CD           PIC XX.
   232         88  VD-VALID-AH               VALUE '01' THRU '89'.
   233         88  VD-INVALID-AH             VALUE '  ' '00'
   234                                             '90' THRU '99'.
   235     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   236     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   237     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
   238     12  VD-AH-TERM                 PIC S999   COMP-3.
   239     12  VD-LETTER-ID               PIC X(4).
   240     12  VD-PROC-ID                 PIC X(4).
   241     12  VD-COMP-ID                 PIC X(3).
   242     12  VD-CURRENT-DATE            PIC XX.
   243     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
   244     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
   245     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page   6
* NSRASBL.cbl
   246 01  WS-PASS-AREA.
   247     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   248     05  WS-PASS-VADS-REC    PIC X(350).
   249
   250*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   251*                         COPY ELCZREC.
   252******************************************************************
   253*                                                                *
   254*                                                                *
   255*                            ELCZREC.                            *
   256*                                                                *
   257*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   258*                                                                *
   259******************************************************************
   260*-----------------------------------------------------------------
   261*                   C H A N G E   L O G
   262*
   263* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   264*-----------------------------------------------------------------
   265*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   266* EFFECTIVE    NUMBER
   267*-----------------------------------------------------------------
   268* 122011    2011022800001  AJRA  NEW FILE
   269* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   270* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   271*-----------------------------------------------------------------
   272 01  W-Z-CONTROL-DATA.
   273     05  W-NUMBER-OF-COPIES      PIC  9.
   274     05  FILLER                  PIC  X.
   275     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   276     05  FILLER                  PIC  X.
   277     05  W-DAYS-TO-RESEND        PIC  999.
   278     05  FILLER                  PIC  X.
   279     05  W-FORM-TO-RESEND        PIC  X(4).
   280     05  FILLER                  PIC  X.
   281     05  W-PROMPT-LETTER         PIC  X.
   282     05  FILLER                  PIC  X.
   283     05  W-ENCLOSURE-CD          PIC  XXX.
   284     05  FILLER                  PIC  X.
   285     05  W-AUTO-CLOSE-IND        PIC  X.
   286     05  FILLER                  PIC  X.
   287     05  W-LETTER-TO-BENE        PIC  X.
   288     05  FILLER                  PIC  X.
   289     05  W-LETTER-TO-ACCT        PIC  X.
   290     05  FILLER                  PIC  X.
   291     05  W-LETTER-TYPE           PIC  X.
   292     05  FILLER                  PIC  X.
   293     05  W-PRINT-CERTIFICATE     PIC  X.
   294     05  FILLER                  PIC  X.
   295     05  W-REFUND-REQUIRED       PIC  X.
   296     05  FILLER                  PIC  X.
   297     05  W-ONBASE-CODE           PIC  XX.
   298     05  FILLER                  PIC  X.
   299     05  W-ACCT-SUMM             PIC  X.
   300     05  FILLER                  PIC  X.
   301     05  W-CSO-SUMM              PIC  X.
   302     05  FILLER                  PIC  X.
   303     05  W-REASONS-REQUIRED      PIC  X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page   7
* NSRASBL.cbl
   304     05  FILLER                  PIC  X(29).
   305 01  MISC.
   306     12  WS-RESPONSE             PIC S9(8)   COMP.
   307         88  RESP-NORMAL                  VALUE +00.
   308         88  RESP-NOTFND                  VALUE +13.
   309         88  RESP-DUPREC                  VALUE +14.
   310         88  RESP-DUPKEY                  VALUE +15.
   311         88  RESP-NOTOPEN                 VALUE +19.
   312         88  RESP-ENDFILE                 VALUE +20.
   313 01  srch-commarea.
   314*                                copy ELCADLTRSPI.
   315******************************************************************
   316*                   C H A N G E   L O G
   317*
   318* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   319*-----------------------------------------------------------------
   320*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   321* EFFECTIVE    NUMBER
   322*-----------------------------------------------------------------
   323* 060611    2011022800001  PEMA  NEW COPYBOOK
   324* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   325* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   326******************************************************************
   327****************************************
   328*  commarea for NaperSoft On Demand Admin services letters
   329*  (business logic input & output)
   330****************************************
   331     03  BL-INPUT.
   332         05  BL-DATA-SRCE        PIC X.
   333         05  BL-LETTER-ID        PIC XXXX.
   334         05  BL-CARRIER          PIC X.
   335         05  BL-GROUP            PIC X(6).
   336         05  BL-STATE            PIC XX.
   337         05  BL-ACCOUNT          PIC X(10).
   338         05  BL-EFF-DT           PIC X(10).
   339         05  BL-CERT-NO          PIC X(11).
   340         05  BL-BATCH-NO         PIC X(6).
   341         05  BL-BATCH-SEQ        PIC 9(8).
   342         05  BL-RESP-NO          PIC X(10).
   343         05  BL-NO-OF-COPIES     PIC 99.
   344         05  BL-PROC-ID          PIC XXXX.
   345         05  BL-COMP-ID          PIC XXX.
   346         05  BL-PRINT-NOW-SW     PIC X.
   347         05  BL-ENC-CD           PIC XXX.
   348         05  BL-RESEND-DT        PIC X(10).
   349         05  BL-FOLLOW-UP-DT     PIC X(10).
   350         05  BL-ARCHIVE-NO       PIC 9(8).
   351         05  BL-FUNC             PIC X(8).
   352         05  BL-COMMENTS         PIC X(100).
   353         05  FILLER REDEFINES BL-COMMENTS.
   354             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   355             10  BL-LETTER-TO-ACCT PIC X.
   356             10  BL-LETTER-TO-BENE PIC X.
   357             10  BL-WRITE-ERARCH   PIC X.
   358                 88  ERARCH-QWS      VALUE 'Q'.
   359                 88  ERARCH-BATCH    VALUE 'B'.
   360                 88  ERARCH-TEMP     VALUE 'T'.
   361             10  BL-PROCESS-TYPE PIC X(07).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page   8
* NSRASBL.cbl
   362             10  BL-CERT-FORM-ID PIC X(05).
   363             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   364             10  BL-SOURCE-SCREEN PIC X(8).
   365             10  FILLER          PIC X(25).
   366     03  BL-OUTPUT.
   367         05  BL-STATUS                   PIC X.
   368             88  BL-OK                      VALUE "P".
   369             88  BL-FAIL                  VALUE "F".
   370         05  BL-MESSAGE          PIC X(50).
   371     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   372     03  FILLER                  PIC X(31).
   373 01  filler                      pic x(500).
   374 01  WS-SAVE-CARRIER-INFO.
   375     05  WS-PREV-CARRIER         PIC X      VALUE SPACES.
   376     05  WS-CARR-NAME            PIC X(30)  VALUE SPACES.
   377     05  WS-CARR-ICO             PIC X(30)  VALUE SPACES.
   378     05  WS-CARR-ADDR1           PIC X(30)  VALUE SPACES.
   379     05  WS-CARR-ADDR2           PIC X(30)  VALUE SPACES.
   380     05  WS-CARR-CITYST          PIC X(30)  VALUE SPACES.
   381     05  WS-CARR-ZIP             PIC X(9)   VALUE SPACES.
   382     05  WS-CARR-PHONE           PIC X(11)  VALUE SPACES.
   383 01  WS-SAVE-STATE-INFO.
   384     05  WS-PREV-STATE           PIC XX     VALUE SPACES.
   385     05  WS-STATE-NAME           PIC X(25)  VALUE SPACES.
   386 01  WS-SAVE-LFBEN-INFO.
   387     05  WS-PREV-LFBEN           PIC XX     VALUE SPACES.
   388     05  WS-LFBEN-ALPH           PIC XXX    VALUE SPACES.
   389     05  WS-LFBEN-DESC           PIC X(10)  VALUE SPACES.
   390 01  WS-SAVE-AHBEN-INFO.
   391     05  WS-PREV-AHBEN           PIC XX     VALUE SPACES.
   392     05  WS-AHBEN-DESC           PIC X(10)  VALUE SPACES.
   393     05  WS-AHBEN-RET-ELIM       PIC X      VALUE SPACES.
   394     05  WS-AHBEN-DAYS           PIC XX     VALUE SPACES.
   395 01  WS-ERPNDB-KEY.
   396     05  WS-ERPNDB-COMPANY-CD    PIC X.
   397     05  WS-ERPNDB-BATCH-NO      PIC X(6).
   398     05  WS-ERPNDB-BATCH-SEQ     PIC S9(4) COMP  VALUE +0.
   399     05  WS-ERPNDB-CHG-SEQ       PIC S9(4) COMP  VALUE +0.
   400 01  WS-ELENCC-KEY.
   401     05  WS-ELENCC-COMPANY-CD    PIC X.
   402     05  WS-ELENCC-REC-TYPE      PIC X.
   403     05  WS-ELENCC-ENC-CODE      PIC X(5).
   404     05  F                       PIC X(9).
   405 01  WS-ELCERT-KEY.
   406     05  WS-ELCERT-COMPANY-CD    PIC X.
   407     05  WS-ELCERT-CARRIER       PIC X.
   408     05  WS-ELCERT-GROUP         PIC X(6).
   409     05  WS-ELCERT-STATE         PIC XX.
   410     05  WS-ELCERT-ACCOUNT       PIC X(10).
   411     05  WS-ELCERT-EFF-DT        PIC XX.
   412     05  WS-ELCERT-CERT-NO       PIC X(11).
   413 01  WS-ELCRTT-KEY.
   414     05  WS-ELCRTT-PRIMARY       PIC X(33).
   415     05  WS-ELCRTT-REC-TYPE      PIC X(1).
   416
   417 01  WS-ERENDT-KEY.
   418     05  WS-ERENDT-COMPANY-CD    PIC X.
   419     05  WS-ERENDT-CARRIER       PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page   9
* NSRASBL.cbl
   420     05  WS-ERENDT-GROUP         PIC X(6).
   421     05  WS-ERENDT-STATE         PIC XX.
   422     05  WS-ERENDT-ACCOUNT       PIC X(10).
   423     05  WS-ERENDT-EFF-DT        PIC XX.
   424     05  WS-ERENDT-CERT-NO       PIC X(11).
   425     05  WS-ERENDT-REC-TYPE      PIC X.
   426     05  WS-ERENDT-SEQ-NO        PIC 9(4) BINARY.
   427
   428 01  WS-ERENDT-KEY-BY-ARCH.
   429     05  WS-ERENDT-COMPANY-CD-A1 PIC X.
   430     05  WS-ERENDT-ARCHIVE       PIC 9(8) BINARY.
   431 01  WS-ERCOMP-KEY.
   432     05  WS-ERCOMP-COMPANY-CD    PIC X.
   433     05  WS-ERCOMP-CARRIER       PIC X.
   434     05  WS-ERCOMP-GROUP         PIC X(6).
   435     05  WS-ERCOMP-RESP-NO       PIC X(10).
   436     05  WS-ERCOMP-ACCOUNT       PIC X(10).
   437     05  WS-ERCOMP-REC-TYPE      PIC X.
   438 01  WS-ERMAIL-KEY.
   439     05  WS-ERMAIL-COMPANY-CD    PIC X.
   440     05  WS-ERMAIL-CARRIER       PIC X.
   441     05  WS-ERMAIL-GROUP         PIC X(6).
   442     05  WS-ERMAIL-STATE         PIC XX.
   443     05  WS-ERMAIL-ACCOUNT       PIC X(10).
   444     05  WS-ERMAIL-EFF-DT        PIC XX.
   445     05  WS-ERMAIL-CERT-NO       PIC X(11).
   446 01  WS-ERACCT-KEY.
   447     05  WS-ERACCT-COMPANY-CD    PIC X.
   448     05  WS-ERACCT-CARRIER       PIC X.
   449     05  WS-ERACCT-GROUP         PIC X(6).
   450     05  WS-ERACCT-STATE         PIC XX.
   451     05  WS-ERACCT-ACCOUNT       PIC X(10).
   452     05  WS-ERACCT-EXP-DT        PIC XX.
   453     05  FILLER                  PIC XXXX.
   454 01  WS-ELLETR-KEY.
   455     05  WS-ELLETR-COMPANY-CD    PIC X.
   456     05  WS-ELLETR-LETTER-ID     PIC X(12).
   457     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   458 01  WS-ELCNTL-KEY.
   459     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   460     05  WS-ELCNTL-REC-TYPE      PIC X.
   461     05  WS-ELCNTL-GENL.
   462         10  WS-ELCNTL-STATE     PIC XX  VALUE SPACES.
   463         10  WS-ELCNTL-BEN-CD.
   464             15  F               PIC X.
   465             15  WS-ELCNTL-CARR  PIC X.
   466     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   467*                                COPY ELCDATE.
   468******************************************************************
   469*                                                                *
   470*                                                                *
   471*                            ELCDATE.                            *
   472*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   473*                            VMOD=2.003
   474*                                                                *
   475*                                                                *
   476*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   477*                 LENGTH = 200                                   *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  10
* NSRASBL.cbl
   478******************************************************************
   479
   480 01  DATE-CONVERSION-DATA.
   481     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   482     12  DC-OPTION-CODE                PIC X.
   483         88  BIN-TO-GREG                VALUE ' '.
   484         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   485         88  EDIT-GREG-TO-BIN           VALUE '2'.
   486         88  YMD-GREG-TO-BIN            VALUE '3'.
   487         88  MDY-GREG-TO-BIN            VALUE '4'.
   488         88  JULIAN-TO-BIN              VALUE '5'.
   489         88  BIN-PLUS-ELAPSED           VALUE '6'.
   490         88  FIND-CENTURY               VALUE '7'.
   491         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   492         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   493         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   494         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   495         88  JULIAN-TO-BIN-3            VALUE 'C'.
   496         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   497         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   498         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   499         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   500         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   501         88  CHECK-LEAP-YEAR            VALUE 'H'.
   502         88  BIN-3-TO-GREG              VALUE 'I'.
   503         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   504         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   505         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   506         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   507         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   508         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   509         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   510         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   511         88  THREE-CHARACTER-BIN
   512                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   513         88  GREGORIAN-TO-BIN
   514                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   515         88  BIN-TO-GREGORIAN
   516                  VALUES ' ' '1' 'I' '8' 'G'.
   517         88  JULIAN-TO-BINARY
   518                  VALUES '5' 'C' 'E' 'F'.
   519     12  DC-ERROR-CODE                 PIC X.
   520         88  NO-CONVERSION-ERROR        VALUE ' '.
   521         88  DATE-CONVERSION-ERROR
   522                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   523         88  DATE-IS-ZERO               VALUE '1'.
   524         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   525         88  DATE-IS-INVALID            VALUE '3'.
   526         88  DATE1-GREATER-DATE2        VALUE '4'.
   527         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   528         88  DATE-INVALID-OPTION        VALUE '9'.
   529         88  INVALID-CENTURY            VALUE 'A'.
   530         88  ONLY-CENTURY               VALUE 'B'.
   531         88  ONLY-LEAP-YEAR             VALUE 'C'.
   532         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   533     12  DC-END-OF-MONTH               PIC X.
   534         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   535     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  11
* NSRASBL.cbl
   536         88  USE-NORMAL-PROCESS         VALUE ' '.
   537         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   538         88  ADJUST-UP-100-YRS          VALUE '2'.
   539     12  FILLER                        PIC X.
   540     12  DC-CONVERSION-DATES.
   541         16  DC-BIN-DATE-1             PIC XX.
   542         16  DC-BIN-DATE-2             PIC XX.
   543         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   544         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   545                       DC-GREG-DATE-1-EDIT.
   546             20  DC-EDIT1-MONTH        PIC 99.
   547             20  SLASH1-1              PIC X.
   548             20  DC-EDIT1-DAY          PIC 99.
   549             20  SLASH1-2              PIC X.
   550             20  DC-EDIT1-YEAR         PIC 99.
   551         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   552         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   553                     DC-GREG-DATE-2-EDIT.
   554             20  DC-EDIT2-MONTH        PIC 99.
   555             20  SLASH2-1              PIC X.
   556             20  DC-EDIT2-DAY          PIC 99.
   557             20  SLASH2-2              PIC X.
   558             20  DC-EDIT2-YEAR         PIC 99.
   559         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   560         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   561                     DC-GREG-DATE-1-YMD.
   562             20  DC-YMD-YEAR           PIC 99.
   563             20  DC-YMD-MONTH          PIC 99.
   564             20  DC-YMD-DAY            PIC 99.
   565         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   566         16  DC-GREG-DATE-1-MDY-R REDEFINES
   567                      DC-GREG-DATE-1-MDY.
   568             20  DC-MDY-MONTH          PIC 99.
   569             20  DC-MDY-DAY            PIC 99.
   570             20  DC-MDY-YEAR           PIC 99.
   571         16  DC-GREG-DATE-1-ALPHA.
   572             20  DC-ALPHA-MONTH        PIC X(10).
   573             20  DC-ALPHA-DAY          PIC 99.
   574             20  FILLER                PIC XX.
   575             20  DC-ALPHA-CENTURY.
   576                 24 DC-ALPHA-CEN-N     PIC 99.
   577             20  DC-ALPHA-YEAR         PIC 99.
   578         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   579         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   580         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   581         16  DC-JULIAN-DATE            PIC 9(05).
   582         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   583                                       PIC 9(05).
   584         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   585             20  DC-JULIAN-YEAR        PIC 99.
   586             20  DC-JULIAN-DAYS        PIC 999.
   587         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   588         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   589         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   590     12  DATE-CONVERSION-VARIBLES.
   591         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   592         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   593             20  FILLER                PIC 9(3).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  12
* NSRASBL.cbl
   594             20  HOLD-CEN-1-CCYY.
   595                 24  HOLD-CEN-1-CC     PIC 99.
   596                 24  HOLD-CEN-1-YY     PIC 99.
   597             20  HOLD-CEN-1-MO         PIC 99.
   598             20  HOLD-CEN-1-DA         PIC 99.
   599         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   600             20  HOLD-CEN-1-R-MO       PIC 99.
   601             20  HOLD-CEN-1-R-DA       PIC 99.
   602             20  HOLD-CEN-1-R-CCYY.
   603                 24  HOLD-CEN-1-R-CC   PIC 99.
   604                 24  HOLD-CEN-1-R-YY   PIC 99.
   605             20  FILLER                PIC 9(3).
   606         16  HOLD-CENTURY-1-X.
   607             20  FILLER                PIC X(3)  VALUE SPACES.
   608             20  HOLD-CEN-1-X-CCYY.
   609                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   610                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   611             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   612             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   613         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   614             20  HOLD-CEN-1-R-X-MO     PIC XX.
   615             20  HOLD-CEN-1-R-X-DA     PIC XX.
   616             20  HOLD-CEN-1-R-X-CCYY.
   617                 24  HOLD-CEN-1-R-X-CC PIC XX.
   618                 24  HOLD-CEN-1-R-X-YY PIC XX.
   619             20  FILLER                PIC XXX.
   620         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   621         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   622         16  DC-JULIAN-DATE-1          PIC 9(07).
   623         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   624             20  DC-JULIAN-1-CCYY.
   625                 24  DC-JULIAN-1-CC    PIC 99.
   626                 24  DC-JULIAN-1-YR    PIC 99.
   627             20  DC-JULIAN-DA-1        PIC 999.
   628         16  DC-JULIAN-DATE-2          PIC 9(07).
   629         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   630             20  DC-JULIAN-2-CCYY.
   631                 24  DC-JULIAN-2-CC    PIC 99.
   632                 24  DC-JULIAN-2-YR    PIC 99.
   633             20  DC-JULIAN-DA-2        PIC 999.
   634         16  DC-GREG-DATE-A-EDIT.
   635             20  DC-EDITA-MONTH        PIC 99.
   636             20  SLASHA-1              PIC X VALUE '/'.
   637             20  DC-EDITA-DAY          PIC 99.
   638             20  SLASHA-2              PIC X VALUE '/'.
   639             20  DC-EDITA-CCYY.
   640                 24  DC-EDITA-CENT     PIC 99.
   641                 24  DC-EDITA-YEAR     PIC 99.
   642         16  DC-GREG-DATE-B-EDIT.
   643             20  DC-EDITB-MONTH        PIC 99.
   644             20  SLASHB-1              PIC X VALUE '/'.
   645             20  DC-EDITB-DAY          PIC 99.
   646             20  SLASHB-2              PIC X VALUE '/'.
   647             20  DC-EDITB-CCYY.
   648                 24  DC-EDITB-CENT     PIC 99.
   649                 24  DC-EDITB-YEAR     PIC 99.
   650         16  DC-GREG-DATE-CYMD         PIC 9(08).
   651         16  DC-GREG-DATE-CYMD-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  13
* NSRASBL.cbl
   652                              DC-GREG-DATE-CYMD.
   653             20  DC-CYMD-CEN           PIC 99.
   654             20  DC-CYMD-YEAR          PIC 99.
   655             20  DC-CYMD-MONTH         PIC 99.
   656             20  DC-CYMD-DAY           PIC 99.
   657         16  DC-GREG-DATE-MDCY         PIC 9(08).
   658         16  DC-GREG-DATE-MDCY-R REDEFINES
   659                              DC-GREG-DATE-MDCY.
   660             20  DC-MDCY-MONTH         PIC 99.
   661             20  DC-MDCY-DAY           PIC 99.
   662             20  DC-MDCY-CEN           PIC 99.
   663             20  DC-MDCY-YEAR          PIC 99.
   664    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   665        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   666    12  DC-EL310-DATE                  PIC X(21).
   667    12  FILLER                         PIC X(28).
   668*                                COPY NSCASEXTR.
   669******************************************************************
   670*                                                                *
   671*                                                                *
   672*                            NSCASEXTR.                          *
   673*                            VMOD=2.001                          *
   674*                                                                *
   675*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   676*                                                                *
   677*   FILE TYPE = VSAM,KSDS                                        *
   678*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   679*                                                                *
   680*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   681*                                                                *
   682*   LOG = NO                                                     *
   683*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   684******************************************************************
   685*-----------------------------------------------------------------
   686*                   C H A N G E   L O G
   687*
   688* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   689*-----------------------------------------------------------------
   690*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   691* EFFECTIVE    NUMBER
   692*-----------------------------------------------------------------
   693* 072211    2011022800001  PEMA  NEW FILE
   694*-----------------------------------------------------------------
   695 01 NSAS-EXTRACT-RECORD.
   696    05  NSAS-CONTROL-PRIMARY.
   697        10  NSAS-COMPANY-CD      PIC X.
   698        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   699        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   700    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   701    05  FILLER                   PIC X(143).
   702*                                COPY ERCPNDB.
   703******************************************************************
   704*                                                                *
   705*                                                                *
   706*                            ERCPNDB.                            *
   707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   708*                            VMOD=2.025                          *
   709*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  14
* NSRASBL.cbl
   710*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   711*                                                                *
   712******************************************************************
   713*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   714*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   715******************************************************************
   716*                                                                *
   717*                                                                *
   718*   FILE TYPE = VSAM,KSDS                                        *
   719*   RECORD SIZE = 585  RECFORM = FIXED                           *
   720*                                                                *
   721*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   722*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   723*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   724*                                                 RKP=13,LEN=36  *
   725*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   726*                                      AND CHG-SEQ.)             *
   727*                                                RKP=49,LEN=11   *
   728*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   729*                                      AND CHG-SEQ.)             *
   730*                                                RKP=60,LEN=15   *
   731*                                                                *
   732*   LOG = NO                                                     *
   733*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   734******************************************************************
   735******************************************************************
   736*                   C H A N G E   L O G
   737*
   738* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   739*-----------------------------------------------------------------
   740*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   741* EFFECTIVE    NUMBER
   742*-----------------------------------------------------------------
   743* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   744* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   745* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   746* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   747* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   748* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   749* 032306                   PEMA  ADD BOW LOAN NUMBER
   750* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   751* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   752* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   753* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   754* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   755* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   756* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   757* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   758******************************************************************
   759
   760 01  PENDING-BUSINESS.
   761     12  PB-RECORD-ID                     PIC XX.
   762         88  VALID-PB-ID                        VALUE 'PB'.
   763
   764     12  PB-CONTROL-PRIMARY.
   765         16  PB-COMPANY-CD                PIC X.
   766         16  PB-ENTRY-BATCH               PIC X(6).
   767         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  15
* NSRASBL.cbl
   768         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   769
   770     12  PB-CONTROL-BY-ACCOUNT.
   771         16  PB-COMPANY-CD-A1             PIC X.
   772         16  PB-CARRIER                   PIC X.
   773         16  PB-GROUPING.
   774             20  PB-GROUPING-PREFIX       PIC XXX.
   775             20  PB-GROUPING-PRIME        PIC XXX.
   776         16  PB-STATE                     PIC XX.
   777         16  PB-ACCOUNT.
   778             20  PB-ACCOUNT-PREFIX        PIC X(4).
   779             20  PB-ACCOUNT-PRIME         PIC X(6).
   780         16  PB-CERT-EFF-DT               PIC XX.
   781         16  PB-CERT-NO.
   782             20  PB-CERT-PRIME            PIC X(10).
   783             20  PB-CERT-SFX              PIC X.
   784         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   785
   786         16  PB-RECORD-TYPE               PIC X.
   787             88  PB-MAILING-DATA                VALUE '0'.
   788             88  PB-ISSUE                       VALUE '1'.
   789             88  PB-CANCELLATION                VALUE '2'.
   790             88  PB-BATCH-TRAILER               VALUE '9'.
   791
   792     12  PB-CONTROL-BY-ORIG-BATCH.
   793         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   794         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   795         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   796         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   797
   798     12  PB-CONTROL-BY-CSR.
   799         16  PB-CSR-COMPANY-CD            PIC X.
   800         16  PB-CSR-ID                    PIC X(4).
   801         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   802         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   803         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   804******************************************************************
   805*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   806******************************************************************
   807
   808     12  PB-LAST-MAINT-DT                 PIC XX.
   809     12  PB-LAST-MAINT-BY                 PIC X(4).
   810     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   811
   812     12  PB-RECORD-BODY                   PIC X(375).
   813
   814     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   815         16  PB-CERT-ORIGIN               PIC X.
   816             88  CLASIC-CREATED-CERT         VALUE '1'.
   817         16  PB-I-NAME.
   818             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   819             20  PB-I-INSURED-FIRST-NAME.
   820                 24  PB-I-INSURED-1ST-INIT PIC X.
   821                 24  FILLER                PIC X(9).
   822             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   823         16  PB-I-AGE                     PIC S99   COMP-3.
   824         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   825         16  PB-I-BIRTHDAY                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  16
* NSRASBL.cbl
   826         16  PB-I-INSURED-SEX             PIC X.
   827             88  PB-SEX-MALE     VALUE 'M'.
   828             88  PB-SEX-FEMALE   VALUE 'F'.
   829
   830         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   831         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   832         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   833         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   834         16  PB-I-SKIP-CODE               PIC X.
   835             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   836             88  PB-SKIP-JULY              VALUE '1'.
   837             88  PB-SKIP-AUGUST            VALUE '2'.
   838             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   839             88  PB-SKIP-JULY-AUG          VALUE '4'.
   840             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   841             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   842             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   843             88  PB-SKIP-JUNE              VALUE '8'.
   844             88  PB-SKIP-JUNE-JULY         VALUE '9'.
   845             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
   846             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
   847         16  PB-I-TERM-TYPE               PIC X.
   848             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
   849             88  PB-PAID-WEEKLY            VALUE 'W'.
   850             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
   851             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
   852             88  PB-PAID-13-YEARLY         VALUE 'T'.
   853         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
   854         16  PB-I-POLICY-FORM-NO          PIC X(12).
   855         16  PB-I-DATA-ENTRY-SW           PIC X.
   856             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
   857             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
   858             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
   859             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
   860         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
   861         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
   862*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
   863         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
   864         16  FILLER                       PIC X.
   865
   866         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
   867             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
   868             88  PB-INVALID-LIFE             VALUE '  ' '00'
   869                                                   '90' THRU '99'.
   870         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
   871                                          PIC XX.
   872         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   873         16  PB-I-AMOUNT-FINANCED REDEFINES
   874                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
   875         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
   876         16  PB-I-UNPAID-CASH-PRICE REDEFINES
   877                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
   878         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   879         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
   880         16  PB-I-CLP-AMOUNT REDEFINES
   881                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
   882         16  PB-I-LF-CALC-FLAG            PIC X.
   883             88 PB-COMP-LF-PREM               VALUE '?'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  17
* NSRASBL.cbl
   884         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
   885         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
   886         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
   887         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
   888         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
   889         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
   890         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
   891         16  PB-I-LF-ABBR                 PIC XXX.
   892         16  PB-I-LF-INPUT-CD             PIC XX.
   893
   894         16  PB-I-AH-BENEFIT-CD           PIC XX.
   895             88  PB-VALID-AH                 VALUE '01' THRU '89'.
   896             88  PB-INVALID-AH               VALUE '  ' '00'
   897                                                   '90' THRU '99'.
   898         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   899         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   900         16  PB-I-AH-CALC-FLAG            PIC X.
   901             88 PB-COMP-AH-PREM                  VALUE '?'.
   902         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
   903         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
   904         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
   905         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
   906         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
   907         16  PB-I-AH-ABBR                 PIC XXX.
   908         16  PB-I-AH-INPUT-CD             PIC XXX.
   909
   910         16  PB-I-SPECIAL-REIN-CODE       PIC X.
   911         16  PB-I-REIN-TABLE              PIC XXX.
   912         16  PB-I-BUSINESS-TYPE           PIC 99.
   913         16  PB-I-INDV-GRP-CD             PIC X.
   914         16  PB-I-MORT-CODE.
   915             20  PB-I-TABLE               PIC X.
   916             20  PB-I-INTEREST            PIC XX.
   917             20  PB-I-MORT-TYP            PIC X.
   918         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
   919         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
   920         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
   921         16  PB-I-INDV-GRP-OVRD           PIC X.
   922         16  PB-I-RATE-CLASS-OVRD         PIC XX.
   923         16  PB-I-SIG-SW                  PIC X.
   924             88  PB-POLICY-SIGNED             VALUE 'Y'.
   925         16  PB-I-RATE-CLASS              PIC XX.
   926         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
   927         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
   928         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
   929         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
   930         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
   931         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
   932         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
   933         16  PB-I-BENEFIT-TYPE            PIC XXX.
   934         16  PB-I-OB-FLAG                 PIC X.
   935             88  PB-I-OB                      VALUE 'B'.
   936             88  PB-I-SUMMARY                 VALUE 'Z'.
   937         16  PB-I-ENTRY-STATUS            PIC X.
   938             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
   939                                              'M' '5' '9' '2'.
   940             88  PB-I-NORMAL-ENTRY            VALUE '1'.
   941             88  PB-I-POLICY-PENDING          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  18
* NSRASBL.cbl
   942             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
   943             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
   944             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
   945             88  PB-I-REIN-ONLY               VALUE '9'.
   946             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
   947             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
   948             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
   949             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
   950         16  PB-I-INT-CODE                PIC X.
   951             88  PB-ADD-ON-INTEREST           VALUE 'A'.
   952             88  PB-SIMPLE-INTEREST           VALUE 'S'.
   953         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   954         16  PB-I-SOC-SEC-NO              PIC X(11).
   955         16  PB-I-MEMBER-NO               PIC X(12).
   956         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
   957*        16  PB-I-LOAN-OFFICER            PIC XXX.
   958         16  PB-I-OLD-LOF                 PIC XXX.
   959         16  PB-I-LF-EXPIRE-DT            PIC XX.
   960         16  PB-I-AH-EXPIRE-DT            PIC XX.
   961         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
   962         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
   963         16  PB-I-LIFE-INDICATOR          PIC X.
   964             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
   965         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
   966         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
   967                                          PIC S9(5)V99    COMP-3.
   968         16  PB-I-MAIL-ADDRS-SW           PIC X.
   969             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
   970             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
   971         16  PB-I-1ST-PMT-DT              PIC XX.
   972         16  PB-I-JOINT-INSURED.
   973             20 PB-I-JOINT-LAST-NAME      PIC X(15).
   974             20 PB-I-JOINT-FIRST-NAME.
   975                24  PB-I-JOINT-FIRST-INIT PIC X.
   976                24  FILLER                PIC X(9).
   977             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
   978*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
   979         16  PB-I-BENEFICIARY-NAME.
   980             20  PB-I-BANK-NUMBER         PIC X(10).
   981             20  FILLER                   PIC X(15).
   982         16  PB-I-LAST-ADD-ON-DT          PIC XX.
   983         16  PB-I-REFERENCE               PIC X(12).
   984         16  FILLER REDEFINES PB-I-REFERENCE.
   985             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
   986             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
   987             20  PB-I-CLP-STATE           PIC XX.
   988         16  PB-I-UNDERWRITING-STATUS     PIC X.
   989             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
   990             88  PB-I-POLICY-DECLINED         VALUE 'D'.
   991             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
   992         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
   993         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
   994         16  PB-I-RESIDENT-STATE          PIC XX.
   995         16  PB-I-RATE-CODE               PIC X(4).
   996         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
   997         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   998         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   999         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  19
* NSRASBL.cbl
  1000         16  PB-I-BANK-NOCHRGB            PIC 99.
  1001         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  1002         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  1003
  1004     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  1005         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  1006             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  1007         16  PB-C-CANCEL-ORIGIN           PIC X.
  1008             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  1009         16  PB-C-LF-CANCEL-DT            PIC XX.
  1010         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1011         16  PB-C-LF-CALC-REQ             PIC X.
  1012             88 PB-COMP-LF-CANCEL            VALUE '?'.
  1013         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  1014         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  1015         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  1016             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  1017         16  PB-C-AH-CANCEL-DT            PIC XX.
  1018         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1019         16  PB-C-AH-CALC-REQ             PIC X.
  1020             88 PB-COMP-AH-CANCEL            VALUE '?'.
  1021         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  1022         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  1023         16  PB-C-LAST-NAME               PIC X(15).
  1024         16  PB-C-REFUND-SW               PIC X.
  1025             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  1026             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  1027         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  1028         16  PB-C-PAYEE-CODE              PIC X(6).
  1029         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  1030         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  1031         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  1032         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  1033         16  PB-C-REFERENCE               PIC X(12).
  1034         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1035         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1036         16  PB-C-POST-CARD-IND           PIC X.
  1037         16  PB-C-CANCEL-REASON           PIC X.
  1038         16  PB-C-REF-INTERFACE-SW        PIC X.
  1039         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  1040         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  1041         16  FILLER                       PIC X(01).
  1042*        16  FILLER                       PIC X(18).
  1043         16  PB-C-POLICY-FORM-NO          PIC X(12).
  1044*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  1045         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  1046         16  PB-CANCELED-CERT-DATA.
  1047             20  PB-CI-INSURED-NAME.
  1048                 24  PB-CI-LAST-NAME      PIC X(15).
  1049                 24  PB-CI-INITIALS       PIC XX.
  1050             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  1051             20  PB-CI-INSURED-SEX        PIC X.
  1052             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  1053             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  1054             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  1055             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1056             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1057             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  20
* NSRASBL.cbl
  1058             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  1059             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  1060             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1061             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1062             20  PB-CI-RATE-CLASS         PIC XX.
  1063             20  PB-CI-RATE-DEV-LF        PIC XXX.
  1064             20  PB-CI-RATE-DEV-AH        PIC XXX.
  1065             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1066             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  1067             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  1068             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  1069             20  PB-CI-LF-ABBR            PIC X(3).
  1070             20  PB-CI-AH-ABBR            PIC X(3).
  1071             20  PB-CI-OB-FLAG            PIC X.
  1072                 88  PB-CI-OB                VALUE 'B'.
  1073             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1074                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1075                                           'M' '4' '5' '9' '2'.
  1076                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  1077                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1078                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1079                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1080                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1081                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1082                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1083                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1084                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1085                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1086                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1087                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1088             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1089                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1090                                           'M' '4' '5' '9' '2'.
  1091                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1092                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1093                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1094                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1095                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1096                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1097                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1098                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1099                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1100                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1101                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1102                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  1103             20  PB-CI-PAY-FREQUENCY      PIC 99.
  1104             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1105             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1106             20  PB-CI-MEMBER-NO          PIC X(12).
  1107             20  PB-CI-INT-CODE           PIC X.
  1108                 88  PB-CI-ADD-ON                  VALUE 'A'.
  1109                 88  PB-CI-SIMPLE                  VALUE 'S'.
  1110             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1111             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1112             20  PB-CI-COMP-EXCP-SW       PIC X.
  1113                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1114                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  1115             20  PB-CI-ENTRY-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  21
* NSRASBL.cbl
  1116             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1117             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1118             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  1119             20  PB-CI-DEATH-DT           PIC XX.
  1120             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1121             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1122             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1123             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1124             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  1125             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  1126             20  PB-CI-ENTRY-DT              PIC XX.
  1127             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1128             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  1129             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1130             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1131             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1132             20  PB-CI-OLD-LOF               PIC XXX.
  1133*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  1134             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  1135             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1136             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1137             20  PB-CI-INDV-GRP-CD           PIC X.
  1138             20  PB-CI-BENEFICIARY-NAME.
  1139                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1140                 24  FILLER                  PIC X(15).
  1141             20  PB-CI-NOTE-SW               PIC X.
  1142             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1143             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1144             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1145             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1146             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1147             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1148             20  PB-CI-FIRST-NAME            PIC X(10).
  1149             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1150
  1151         16  FILLER                       PIC X(13).
  1152*032306  16  FILLER                       PIC X(27).
  1153*        16  FILLER                       PIC X(46).
  1154
  1155     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1156         16  FILLER                       PIC X(10).
  1157         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1158         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1159         16  PB-M-INSURED-MID-INIT        PIC X.
  1160         16  PB-M-INSURED-AGE             PIC 99.
  1161         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  1162         16  PB-M-INSURED-SEX             PIC X.
  1163         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1164         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1165         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  1166         16  PB-M-INSURED-CITY-STATE.
  1167             20  PB-M-INSURED-CITY        PIC X(28).
  1168             20  PB-M-INSURED-STATE       PIC XX.
  1169         16  PB-M-INSURED-ZIP-CODE.
  1170             20  PB-M-INSURED-ZIP-PRIME.
  1171                 24  PB-M-INSURED-ZIP-1   PIC X.
  1172                     88  PB-M-CANADIAN-POST-CODE
  1173                                             VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  22
* NSRASBL.cbl
  1174                 24  FILLER               PIC X(4).
  1175             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1176         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  1177                                        PB-M-INSURED-ZIP-CODE.
  1178             20  PM-M-INS-CAN-POST1       PIC XXX.
  1179             20  PM-M-INS-CAN-POST2       PIC XXX.
  1180             20  FILLER                   PIC XXX.
  1181         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1182         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  1183         16  PB-M-CRED-BENE-NAME          PIC X(30).
  1184         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  1185         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1186         16  PB-M-CRED-BENE-CITYST.
  1187             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1188             20  PB-M-CRED-BENE-STATE     PIC XX.
  1189         16  FILLER                       PIC X(92).
  1190
  1191     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  1192         16  FILLER                       PIC X(10).
  1193         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1194         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1195         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1196         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1197         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1198         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1199         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1200         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1201         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1202         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1203         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1204         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1205         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1206         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1207         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1208         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1209         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1210         16  PB-ACCOUNT-NAME              PIC X(30).
  1211         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1212         16  PB-REFERENCE                 PIC X(12).
  1213         16  PB-B-RECEIVED-DT             PIC XX.
  1214         16  FILLER                       PIC X(234).
  1215
  1216     12  PB-RECORD-STATUS.
  1217         16  PB-CREDIT-SELECT-DT          PIC XX.
  1218         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  1219         16  PB-BILLED-DT                 PIC XX.
  1220         16  PB-BILLING-STATUS            PIC X.
  1221             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1222             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1223             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  1224         16  PB-RECORD-BILL               PIC X.
  1225             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  1226             88  PB-RECORD-RETURNED           VALUE 'R'.
  1227             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1228             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1229             88  PB-OVERRIDE-AH               VALUE 'A'.
  1230             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  1231         16  PB-BATCH-ENTRY               PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  23
* NSRASBL.cbl
  1232             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1233             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1234             88  PB-REISSUED-CERT             VALUE 'E'.
  1235             88  PB-MONTHLY-CERT              VALUE 'M'.
  1236             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1237             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  1238             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  1239         16  PB-FORCE-CODE                PIC X.
  1240             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1241             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  1242             88  PB-CANCEL-FORCE              VALUE '8'.
  1243             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  1244             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1245             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1246             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1247             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1248             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1249             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  1250         16  PB-FATAL-FLAG                PIC X.
  1251             88  PB-FATAL-ERRORS              VALUE 'X'.
  1252         16  PB-FORCE-ER-CD               PIC X.
  1253             88  PB-FORCE-ERRORS              VALUE 'F'.
  1254             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1255         16  PB-WARN-ER-CD                PIC X.
  1256             88  PB-WARNING-ERRORS            VALUE 'W'.
  1257         16  FILLER                       PIC X.
  1258         16  PB-OUT-BAL-CD                PIC X.
  1259             88  PB-OUT-OF-BAL                VALUE 'O'.
  1260         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1261         16  PB-AH-OVERRIDE-L1            PIC X.
  1262         16  PB-INPUT-DT                  PIC XX.
  1263         16  PB-INPUT-BY                  PIC X(4).
  1264         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1265         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1266         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1267         16  PB-LF-EARNING-METHOD         PIC X.
  1268         16  PB-AH-EARNING-METHOD         PIC X.
  1269         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1270         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1271         16  PB-REIN-CD                   PIC XXX.
  1272         16  PB-LF-REFUND-TYPE            PIC X.
  1273         16  PB-AH-REFUND-TYPE            PIC X.
  1274         16  PB-ACCT-EFF-DT               PIC XX.
  1275         16  PB-ACCT-EXP-DT               PIC XX.
  1276         16  PB-COMPANY-ID                PIC X(3).
  1277         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1278         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1279         16  PB-SV-CARRIER                PIC X.
  1280         16  PB-SV-GROUPING               PIC X(6).
  1281         16  PB-SV-STATE                  PIC XX.
  1282         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1283         16  PB-GA-BILLING-INFO.
  1284             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1285                                          PIC XX.
  1286         16  PB-SV-REMIT-TO  REDEFINES
  1287             PB-GA-BILLING-INFO           PIC X(10).
  1288         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  1289         16  PB-I-LOAN-OFFICER            PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  24
* NSRASBL.cbl
  1290         16  PB-I-VIN                     PIC X(17).
  1291
  1292         16  FILLER                       PIC X(04).
  1293         16  IMNET-BYPASS-SW              PIC X.
  1294
  1295******************************************************************
  1296*                COMMON EDIT ERRORS                              *
  1297******************************************************************
  1298
  1299     12  PB-COMMON-ERRORS.
  1300         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  1301                                           PIC S9(4)     COMP.
  1302
  1303******************************************************************
  1304*                                COPY ERCENDT.
  1305******************************************************************
  1306*                                                                *
  1307*                                                                *
  1308*                            ERCENDT.                            *
  1309*                            VMOD=2.001                          *
  1310*                                                                *
  1311*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1312*                                                                *
  1313*   FILE TYPE = VSAM,KSDS                                        *
  1314*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1315*                                                                *
  1316*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1317*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1318*                                                                *
  1319*   LOG = NO                                                     *
  1320*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1321******************************************************************
  1322*-----------------------------------------------------------------
  1323*                   C H A N G E   L O G
  1324*
  1325* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1326*-----------------------------------------------------------------
  1327*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1328* EFFECTIVE    NUMBER
  1329*-----------------------------------------------------------------
  1330* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1331*                                WITH OPEN CLAIMS
  1332* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1333* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1334* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1335*-----------------------------------------------------------------
  1336 01  ENDORSEMENT-RECORD.
  1337     12  EN-RECORD-ID                PIC XX.
  1338         88  VALID-EN-ID                VALUE 'EN'.
  1339     12  EN-CONTROL-PRIMARY.
  1340         16  EN-COMPANY-CD           PIC X.
  1341         16  EN-CARRIER              PIC X.
  1342         16  EN-GROUPING             PIC X(6).
  1343         16  EN-STATE                PIC XX.
  1344         16  EN-ACCOUNT              PIC X(10).
  1345         16  EN-CERT-EFF-DT          PIC XX.
  1346         16  EN-CERT-NO.
  1347             20  EN-CERT-PRIME       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  25
* NSRASBL.cbl
  1348             20  EN-CERT-SFX         PIC X.
  1349         16  EN-REC-TYPE             PIC X.
  1350             88  EN-ISSUE               VALUE 'I'.
  1351             88  EN-CANCELLATION        VALUE 'C'.
  1352         16  EN-SEQ-NO               PIC 9(04) BINARY.
  1353     12  EN-CONTROL-BY-ARCH-NO.
  1354         16  EN-COMPANY-CD-A1              PIC X.
  1355         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  1356     12  EN-LAST-MAINT-DT            PIC XX.
  1357     12  EN-LAST-MAINT-BY            PIC X(4).
  1358     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1359     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  1360     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1361         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  1362         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  1363         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  1364         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  1365         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  1366         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  1367         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  1368         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  1369         16  EN-LF-ORIG-BENCD        PIC XX.
  1370         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  1371         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1372         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1373         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1374         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1375         16  EN-LF-ORIG-EXP-DT       PIC XX.
  1376*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1377         16  EN-ORIG-CRED-BENE       PIC X(25).
  1378         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1379         16  FILLER                  PIC X.
  1380         16  EN-AH-ORIG-BENCD        PIC XX.
  1381         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  1382         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1383         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1384         16  EN-AH-ORIG-EXP-DT       PIC XX.
  1385*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1386*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1387         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1388         16  F                       PIC X(09).
  1389         16  EN-AH-ORIG-CP           PIC 99.
  1390         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  1391         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  1392         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  1393         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  1394         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  1395         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  1396         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  1397         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  1398         16  EN-LF-NEW-BENCD         PIC XX.
  1399         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  1400         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1401         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1402         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1403         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1404         16  EN-LF-NEW-EXP-DT        PIC XX.
  1405         16  EN-NEW-CRED-BENE        PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  26
* NSRASBL.cbl
  1406         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1407         16  FILLER                  PIC X.
  1408         16  EN-AH-NEW-BENCD         PIC XX.
  1409         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  1410         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1411         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1412         16  EN-AH-NEW-EXP-DT        PIC XX.
  1413*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1414*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  1415*        16  F                       PIC X(12).
  1416         16  EN-AH-NEW-CP            PIC 99.
  1417         16  EN-SIG-SW               PIC X.
  1418         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1419         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  1420         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  1421         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  1422         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  1423         16  FILLER                  PIC X(33).
  1424     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1425         16  EN-LF-ORIG-REF-DT       PIC XX.
  1426         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1427         16  EN-AH-ORIG-REF-DT       PIC XX.
  1428         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1429         16  EN-LF-NEW-REF-DT        PIC XX.
  1430         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1431         16  EN-AH-NEW-REF-DT        PIC XX.
  1432         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1433         16  EN-FLAG-CERT            PIC X.
  1434         16  EN-INS-LAST-NAME        PIC X(15).
  1435         16  EN-INS-FIRST-NAME       PIC X(10).
  1436         16  EN-INS-MIDDLE-INIT      PIC X.
  1437         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1438         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1439         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1440         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1441         16  FILLER                  PIC X(262).
  1442     12  EN-MONEY-SW             PIC X.
  1443     12  EN-HEALTH-APP           PIC X.
  1444     12  EN-VOUCHER-SW           PIC X.
  1445     12  EN-PAYEE                PIC X(14).
  1446     12  EN-INPUT-DT             PIC XX.
  1447     12  EN-PROCESS-DT           PIC XX.
  1448     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1449     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1450     12  EN-REASON-CODES.
  1451         16  F OCCURS 12.
  1452             20  EN-REASON-CODE  PIC X(4).
  1453     12  EN-TEMPLATE-USED        PIC X(8).
  1454     12  EN-DOCU-TYPE            PIC X.
  1455         88  EN-VERI-DOCU          VALUE 'V'.
  1456         88  EN-GCE-DOCU           VALUE 'G'.
  1457         88  EN-CANC-DOCU          VALUE 'C'.
  1458     12  EN-COMMENTS1            PIC X(13).
  1459     12  EN-COMMENTS2            PIC X(70).
  1460     12  EN-COMM-CHGBK           PIC X.
  1461         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  1462         88  EN-CHG-ACCT           VALUE 'Y'.
  1463     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  27
* NSRASBL.cbl
  1464     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  1465     12  EN-BATCH-NUMBER         PIC X(6).
  1466     12  EN-ACCT-SUMM            PIC X.
  1467     12  EN-CSO-SUMM             PIC X.
  1468     12  FILLER                  PIC X(13).
  1469******************************************************************
  1470*                                COPY ERCMAIL.
  1471******************************************************************
  1472*                                                                *
  1473*                                                                *
  1474*                            ERCMAIL                             *
  1475*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1476*                            VMOD=2.003                          *
  1477*                                                                *
  1478*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1479*                                                                *
  1480*   FILE TYPE = VSAM,KSDS                                        *
  1481*   RECORD SIZE = 374   RECFORM = FIX                            *
  1482*                                                                *
  1483*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1484*   ALTERNATE PATH    = NOT USED                                 *
  1485*                                                                *
  1486*   LOG = YES                                                    *
  1487*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1488******************************************************************
  1489*                   C H A N G E   L O G
  1490*
  1491* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1492*-----------------------------------------------------------------
  1493*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1494* EFFECTIVE    NUMBER
  1495*-----------------------------------------------------------------
  1496* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1497* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1498* 111108                   PEMA  ADD CRED BENE ADDR2
  1499******************************************************************
  1500
  1501 01  MAILING-DATA.
  1502     12  MA-RECORD-ID                      PIC XX.
  1503         88  VALID-MA-ID                       VALUE 'MA'.
  1504
  1505     12  MA-CONTROL-PRIMARY.
  1506         16  MA-COMPANY-CD                 PIC X.
  1507         16  MA-CARRIER                    PIC X.
  1508         16  MA-GROUPING.
  1509             20  MA-GROUPING-PREFIX        PIC XXX.
  1510             20  MA-GROUPING-PRIME         PIC XXX.
  1511         16  MA-STATE                      PIC XX.
  1512         16  MA-ACCOUNT.
  1513             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1514             20  MA-ACCOUNT-PRIME          PIC X(6).
  1515         16  MA-CERT-EFF-DT                PIC XX.
  1516         16  MA-CERT-NO.
  1517             20  MA-CERT-PRIME             PIC X(10).
  1518             20  MA-CERT-SFX               PIC X.
  1519
  1520     12  FILLER                            PIC XX.
  1521
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  28
* NSRASBL.cbl
  1522     12  MA-ACCESS-CONTROL.
  1523         16  MA-SOURCE-SYSTEM              PIC XX.
  1524             88  MA-FROM-CREDIT                VALUE 'CR'.
  1525             88  MA-FROM-VSI                   VALUE 'VS'.
  1526             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1527             88  MA-FROM-OTHER                 VALUE 'OT'.
  1528         16  MA-RECORD-ADD-DT              PIC XX.
  1529         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1530         16  MA-LAST-MAINT-DT              PIC XX.
  1531         16  MA-LAST-MAINT-BY              PIC XXXX.
  1532         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1533
  1534     12  MA-PROFILE-INFO.
  1535         16  MA-QUALIFY-CODE-1             PIC XX.
  1536         16  MA-QUALIFY-CODE-2             PIC XX.
  1537         16  MA-QUALIFY-CODE-3             PIC XX.
  1538         16  MA-QUALIFY-CODE-4             PIC XX.
  1539         16  MA-QUALIFY-CODE-5             PIC XX.
  1540
  1541         16  MA-INSURED-LAST-NAME          PIC X(15).
  1542         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1543         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1544         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1545         16  MA-INSURED-BIRTH-DT           PIC XX.
  1546         16  MA-INSURED-SEX                PIC X.
  1547             88  MA-SEX-MALE                   VALUE 'M'.
  1548             88  MA-SEX-FEMALE                 VALUE 'F'.
  1549         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1550
  1551         16  MA-ADDRESS-CORRECTED          PIC X.
  1552         16  MA-JOINT-BIRTH-DT             PIC XX.
  1553*        16  FILLER                        PIC X(12).
  1554
  1555         16  MA-ADDRESS-LINE-1             PIC X(30).
  1556         16  MA-ADDRESS-LINE-2             PIC X(30).
  1557         16  MA-CITY-STATE.
  1558             20  MA-CITY                   PIC X(28).
  1559             20  MA-ADDR-STATE             PIC XX.
  1560         16  MA-ZIP.
  1561             20  MA-ZIP-CODE.
  1562                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1563                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1564                 24  FILLER                PIC X(4).
  1565             20  MA-ZIP-PLUS4              PIC X(4).
  1566         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1567             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1568             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1569             20  FILLER                    PIC X(3).
  1570
  1571         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1572
  1573         16  FILLER                        PIC XXX.
  1574*        16  FILLER                        PIC X(10).
  1575
  1576     12  MA-CRED-BENE-INFO.
  1577         16  MA-CRED-BENE-NAME                 PIC X(25).
  1578         16  MA-CRED-BENE-ADDR                 PIC X(30).
  1579         16  MA-CRED-BENE-ADDR2                PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  29
* NSRASBL.cbl
  1580         16  MA-CRED-BENE-CTYST.
  1581             20  MA-CRED-BENE-CITY             PIC X(28).
  1582             20  MA-CRED-BENE-STATE            PIC XX.
  1583         16  MA-CRED-BENE-ZIP.
  1584             20  MA-CB-ZIP-CODE.
  1585                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  1586                     88  MA-CB-CANADIAN-POST-CODE
  1587                                           VALUE 'A' THRU 'Z'.
  1588                 24  FILLER                    PIC X(4).
  1589             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1590         16  MA-CB-CANADIAN-POSTAL-CODE
  1591                            REDEFINES MA-CRED-BENE-ZIP.
  1592             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1593             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1594             20  FILLER                        PIC X(3).
  1595     12  MA-POST-CARD-MAIL-DATA.
  1596         16  MA-MAIL-DATA OCCURS 7.
  1597             20  MA-MAIL-TYPE              PIC X.
  1598                 88  MA-12MO-MAILING           VALUE '1'.
  1599                 88  MA-EXP-MAILING            VALUE '2'.
  1600             20  MA-MAIL-STATUS            PIC X.
  1601                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1602                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1603                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1604             20  MA-MAIL-DATE              PIC XX.
  1605     12  FILLER                            PIC XX.
  1606     12  FILLER                            PIC XX.
  1607*    12  FILLER                            PIC X(30).
  1608******************************************************************
  1609*                                COPY ERCCOMP.
  1610******************************************************************
  1611*                                                                *
  1612*                                                                *
  1613*                            ERCCOMP                             *
  1614*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1615*                            VMOD=2.019                          *
  1616*                                                                *
  1617*   ONLINE CREDIT SYSTEM                                         *
  1618*                                                                *
  1619*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1620*                                                                *
  1621*   FILE TYPE = VSAM,KSDS                                        *
  1622*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1623*                                                                *
  1624*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1625*       ALTERNATE PATH = NONE                                    *
  1626*                                                                *
  1627*   LOG = NO                                                     *
  1628*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1629*                                                                *
  1630******************************************************************
  1631*                   C H A N G E   L O G
  1632*
  1633* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1634*-----------------------------------------------------------------
  1635*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1636* EFFECTIVE    NUMBER
  1637*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  30
* NSRASBL.cbl
  1638* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1639* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1640* 092205    2005050300006  PEMA  ADD LEASE FEE
  1641* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1642* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1643* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1644* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1645* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1646* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1647******************************************************************
  1648
  1649 01  COMPENSATION-MASTER.
  1650     12  CO-RECORD-ID                          PIC XX.
  1651         88  VALID-CO-ID                          VALUE 'CO'.
  1652
  1653     12  CO-CONTROL-PRIMARY.
  1654         16  CO-COMPANY-CD                     PIC X.
  1655         16  CO-CONTROL.
  1656             20  CO-CTL-1.
  1657                 24  CO-CARR-GROUP.
  1658                     28  CO-CARRIER            PIC X.
  1659                     28  CO-GROUPING.
  1660                         32  CO-GROUP-PREFIX   PIC XXX.
  1661                         32  CO-GROUP-PRIME    PIC XXX.
  1662                 24  CO-RESP-NO.
  1663                     28  CO-RESP-PREFIX        PIC X(4).
  1664                     28  CO-RESP-PRIME         PIC X(6).
  1665             20  CO-CTL-2.
  1666                 24  CO-ACCOUNT.
  1667                     28  CO-ACCT-PREFIX        PIC X(4).
  1668                     28  CO-ACCT-PRIME         PIC X(6).
  1669         16  CO-TYPE                           PIC X.
  1670             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1671             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1672             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1673
  1674     12  CO-MAINT-INFORMATION.
  1675         16  CO-LAST-MAINT-DT                  PIC XX.
  1676         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1677         16  CO-LAST-MAINT-USER                PIC X(4).
  1678     12  FILLER                                PIC XX.
  1679     12  CO-STMT-TYPE                          PIC XXX.
  1680     12  CO-COMP-TYPE                          PIC X.
  1681         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1682     12  CO-STMT-OWNER                         PIC X(4).
  1683     12  CO-BALANCE-CONTROL                    PIC X.
  1684         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1685         88  CO-NO-BALANCE                        VALUE 'N'.
  1686
  1687     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1688         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1689         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1690         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1691
  1692     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1693         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1694         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1695
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  31
* NSRASBL.cbl
  1696     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1697     12  CO-GA-DIRECT-DEP                      PIC X.
  1698     12  CO-FUTURE-SPACE                       PIC X.
  1699         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1700
  1701     12  CO-ACCT-NAME                          PIC X(30).
  1702     12  CO-MAIL-NAME                          PIC X(30).
  1703     12  CO-ADDR-1                             PIC X(30).
  1704     12  CO-ADDR-2                             PIC X(30).
  1705     12  CO-ADDR-3.
  1706         16  CO-ADDR-CITY                      PIC X(27).
  1707         16  CO-ADDR-STATE                     PIC XX.
  1708     12  CO-CSO-1099                           PIC X.
  1709     12  CO-ZIP.
  1710         16  CO-ZIP-PRIME.
  1711             20  CO-ZIP-PRI-1ST                PIC X.
  1712                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1713             20  FILLER                        PIC X(4).
  1714         16  CO-ZIP-PLUS4                      PIC X(4).
  1715     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1716         16  CO-CAN-POSTAL-1                   PIC XXX.
  1717         16  CO-CAN-POSTAL-2                   PIC XXX.
  1718         16  FILLER                            PIC XXX.
  1719     12  CO-SOC-SEC                            PIC X(13).
  1720     12  CO-TELEPHONE.
  1721         16  CO-AREA-CODE                      PIC XXX.
  1722         16  CO-PREFIX                         PIC XXX.
  1723         16  CO-PHONE                          PIC X(4).
  1724
  1725     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1726
  1727     12  CO-AR-BAL-LEVEL                       PIC X.
  1728         88  CO-AR-REF-LVL                        VALUE '1'.
  1729         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1730         88  CO-AR-BILL-LVL                       VALUE '2'.
  1731         88  CO-AR-AGT-LVL                        VALUE '3'.
  1732         88  CO-AR-FR-LVL                         VALUE '4'.
  1733
  1734     12  CO-AR-NORMAL-PRINT                    PIC X.
  1735         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1736         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1737
  1738     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1739
  1740     12  CO-AR-REPORTING                       PIC X.
  1741         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1742         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1743
  1744     12  CO-AR-PULL-CHECK                      PIC X.
  1745         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1746         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1747
  1748     12  CO-AR-BALANCE-PRINT                   PIC X.
  1749         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1750
  1751     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1752         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1753         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  32
* NSRASBL.cbl
  1754         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1755
  1756     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1757
  1758     12  CO-USER-CODE                          PIC X.
  1759     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1760
  1761******************************************************************
  1762*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1763*    THE LAST MONTH END RUN.
  1764******************************************************************
  1765
  1766     12  CO-LAST-ACTIVITY-DATE.
  1767         16  CO-ACT-YEAR                       PIC 99.
  1768         16  CO-ACT-MONTH                      PIC 99.
  1769         16  CO-ACT-DAY                        PIC 99.
  1770
  1771     12  CO-LAST-STMT-DT.
  1772         16  CO-LAST-STMT-YEAR                 PIC 99.
  1773         16  CO-LAST-STMT-MONTH                PIC 99.
  1774         16  CO-LAST-STMT-DAY                  PIC 99.
  1775
  1776     12  CO-MO-END-TOTALS.
  1777         16  CO-MONTHLY-TOTALS.
  1778             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1779             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1780             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1781             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1782             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1783
  1784         16  CO-AGING-TOTALS.
  1785             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1786             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1787             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1788             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1789
  1790         16  CO-YTD-TOTALS.
  1791             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1792             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1793
  1794         16  CO-OVER-UNDER-TOTALS.
  1795             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1796             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1797
  1798     12  CO-MISCELLANEOUS-TOTALS.
  1799         16  CO-FICA-TOTALS.
  1800             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1801             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1802
  1803         16  CO-CLAIM-TOTALS.
  1804             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1805             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1806
  1807******************************************************************
  1808*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1809*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1810******************************************************************
  1811
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  33
* NSRASBL.cbl
  1812     12  CO-CURRENT-TOTALS.
  1813         16  CO-CURRENT-LAST-STMT-DT.
  1814             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1815             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1816             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1817
  1818         16  CO-CURRENT-MONTHLY-TOTALS.
  1819             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1820             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1821             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1822             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1823             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1824
  1825         16  CO-CURRENT-AGING-TOTALS.
  1826             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1827             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1828             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1829             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1830
  1831         16  CO-CURRENT-YTD-TOTALS.
  1832             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1833             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1834
  1835     12  CO-PAID-COMM-TOTALS.
  1836         16  CO-YTD-PAID-COMMS.
  1837             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1838             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1839
  1840     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1841         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1842         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1843
  1844     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1845         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1846         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1847         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1848         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1849         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1850         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1851         88  CO-FINAL-LETTER                  VALUE 'F'.
  1852         88  CO-RECONCILING                   VALUE 'R'.
  1853         88  CO-PHONE-CALL                    VALUE 'P'.
  1854         88  CO-LEGAL                         VALUE 'L'.
  1855         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1856         88  CO-WRITE-OFF                     VALUE 'W'.
  1857         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1858
  1859     12  CO-CSR-CODE                       PIC X(4).
  1860
  1861     12  CO-GA-STATUS-INFO.
  1862         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1863         16  CO-GA-TERMINATION-DT          PIC XX.
  1864         16  CO-GA-STATUS-CODE             PIC X.
  1865             88  CO-GA-ACTIVE                 VALUE 'A'.
  1866             88  CO-GA-INACTIVE               VALUE 'I'.
  1867             88  CO-GA-PENDING                VALUE 'P'.
  1868         16  CO-GA-COMMENTS.
  1869             20  CO-GA-COMMENT-1           PIC X(40).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  34
* NSRASBL.cbl
  1870             20  CO-GA-COMMENT-2           PIC X(40).
  1871             20  CO-GA-COMMENT-3           PIC X(40).
  1872             20  CO-GA-COMMENT-4           PIC X(40).
  1873
  1874     12  CO-RPTCD2                         PIC X(10).
  1875     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1876         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1877         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1878
  1879     12  CO-TYPE-AGENT                     PIC X(01).
  1880         88  CO-CORPORATION                   VALUE 'C'.
  1881         88  CO-PARTNERSHIP                   VALUE 'P'.
  1882         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1883         88  CO-TRUST                         VALUE 'T'.
  1884         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1885
  1886     12  CO-FAXNO.
  1887         16  CO-FAX-AREA-CODE                  PIC XXX.
  1888         16  CO-FAX-PREFIX                     PIC XXX.
  1889         16  CO-FAX-PHONE                      PIC X(4).
  1890
  1891     12  CO-BANK-INFORMATION.
  1892         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1893         16  CO-BANK-TRANSIT-NON REDEFINES
  1894             CO-BANK-TRANSIT-NO                PIC 9(8).
  1895
  1896         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1897     12  CO-MISC-DEDUCT-INFO REDEFINES
  1898                  CO-BANK-INFORMATION.
  1899         16  CO-MD-GL-ACCT                     PIC X(10).
  1900         16  CO-MD-DIV                         PIC XX.
  1901         16  CO-MD-CENTER                      PIC X(4).
  1902         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1903         16  CO-CREATE-AP-CHECK                PIC X.
  1904         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1905         16  FILLER                            PIC XXX.
  1906     12  CO-ACH-STATUS                         PIC X.
  1907         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1908         88  CO-ACH-PENDING                        VALUE 'P'.
  1909
  1910     12  CO-BILL-SW                            PIC X.
  1911     12  CO-CONTROL-NAME                       PIC X(30).
  1912     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1913     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1914     12  CO-CLP-STATE                          PIC XX.
  1915     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1916     12  CO-SPP-REFUND-EDIT                    PIC X.
  1917
  1918******************************************************************
  1919*                                COPY ELCCERT.
  1920******************************************************************
  1921*                                                                *
  1922*                            ELCCERT.                            *
  1923*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1924*                            VMOD=2.013                          *
  1925*                                                                *
  1926*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1927*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  35
* NSRASBL.cbl
  1928*   FILE TYPE = VSAM,KSDS                                        *
  1929*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1930*                                                                *
  1931*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1932*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1933*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1934*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1935*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1936*                                                                *
  1937*   LOG = YES                                                    *
  1938*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1939******************************************************************
  1940*                   C H A N G E   L O G
  1941*
  1942* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1943*-----------------------------------------------------------------
  1944*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1945* EFFECTIVE    NUMBER
  1946*-----------------------------------------------------------------
  1947* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1948* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1949* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1950* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1951* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1952* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1953* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1954* 032612  CR2011110200001  PEMA  AHL CHANGES
  1955******************************************************************
  1956
  1957 01  CERTIFICATE-MASTER.
  1958     12  CM-RECORD-ID                      PIC XX.
  1959         88  VALID-CM-ID                      VALUE 'CM'.
  1960
  1961     12  CM-CONTROL-PRIMARY.
  1962         16  CM-COMPANY-CD                 PIC X.
  1963         16  CM-CARRIER                    PIC X.
  1964         16  CM-GROUPING.
  1965             20  CM-GROUPING-PREFIX        PIC X(3).
  1966             20  CM-GROUPING-PRIME         PIC X(3).
  1967         16  CM-STATE                      PIC XX.
  1968         16  CM-ACCOUNT.
  1969             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1970             20  CM-ACCOUNT-PRIME          PIC X(6).
  1971         16  CM-CERT-EFF-DT                PIC XX.
  1972         16  CM-CERT-NO.
  1973             20  CM-CERT-PRIME             PIC X(10).
  1974             20  CM-CERT-SFX               PIC X.
  1975
  1976     12  CM-CONTROL-BY-NAME.
  1977         16  CM-COMPANY-CD-A1              PIC X.
  1978         16  CM-INSURED-LAST-NAME          PIC X(15).
  1979         16  CM-INSURED-INITIALS.
  1980             20  CM-INSURED-INITIAL1       PIC X.
  1981             20  CM-INSURED-INITIAL2       PIC X.
  1982
  1983     12  CM-CONTROL-BY-SSN.
  1984         16  CM-COMPANY-CD-A2              PIC X.
  1985         16  CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  36
* NSRASBL.cbl
  1986             20  CM-SSN-STATE              PIC XX.
  1987             20  CM-SSN-ACCOUNT            PIC X(6).
  1988             20  CM-SSN-LN3.
  1989                 25  CM-INSURED-INITIALS-A2.
  1990                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1991                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1992                 25 CM-PART-LAST-NAME-A2         PIC X.
  1993
  1994     12  CM-CONTROL-BY-CERT-NO.
  1995         16  CM-COMPANY-CD-A4              PIC X.
  1996         16  CM-CERT-NO-A4                 PIC X(11).
  1997
  1998     12  CM-CONTROL-BY-MEMB.
  1999         16  CM-COMPANY-CD-A5              PIC X.
  2000         16  CM-MEMBER-NO.
  2001             20  CM-MEMB-STATE             PIC XX.
  2002             20  CM-MEMB-ACCOUNT           PIC X(6).
  2003             20  CM-MEMB-LN4.
  2004                 25  CM-INSURED-INITIALS-A5.
  2005                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2006                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2007                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2008
  2009     12  CM-INSURED-PROFILE-DATA.
  2010         16  CM-INSURED-FIRST-NAME.
  2011             20  CM-INSURED-1ST-INIT       PIC X.
  2012             20  FILLER                    PIC X(9).
  2013         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2014         16  CM-INSURED-SEX                PIC X.
  2015             88  CM-SEX-MALE                  VALUE 'M'.
  2016             88  CM-SEX-FEMAL                 VALUE 'F'.
  2017         16  CM-INSURED-JOINT-AGE          PIC 99.
  2018         16  CM-JOINT-INSURED-NAME.
  2019             20  CM-JT-LAST-NAME           PIC X(15).
  2020             20  CM-JT-FIRST-NAME.
  2021                 24  CM-JT-1ST-INIT        PIC X.
  2022                 24  FILLER                PIC X(9).
  2023             20  CM-JT-INITIAL             PIC X.
  2024
  2025     12  CM-LIFE-DATA.
  2026         16  CM-LF-BENEFIT-CD              PIC XX.
  2027         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2028         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2029         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2030         16  CM-LF-DEV-CODE                PIC XXX.
  2031         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2032         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2033         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2034         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2035         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2036         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2037         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2038         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2039         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2040         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2041         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2042         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2043         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  37
* NSRASBL.cbl
  2044
  2045     12  CM-AH-DATA.
  2046         16  CM-AH-BENEFIT-CD              PIC XX.
  2047         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2048         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2049         16  CM-AH-DEV-CODE                PIC XXX.
  2050         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2051         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2052         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2053         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2054         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2055         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2056         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2057         16  CM-AH-PAID-THRU-DT            PIC XX.
  2058             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2059         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2060         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2061         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2062         16  FILLER                        PIC X.
  2063
  2064     12  CM-LOAN-INFORMATION.
  2065         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2066         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2067                                           PIC S9(5)V99  COMP-3.
  2068         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2069         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2070         16  CM-PAY-FREQUENCY              PIC S99.
  2071         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2072         16  CM-RATE-CLASS                 PIC XX.
  2073         16  CM-BENEFICIARY                PIC X(25).
  2074         16  CM-POLICY-FORM-NO             PIC X(12).
  2075         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2076         16  CM-LAST-ADD-ON-DT             PIC XX.
  2077         16  CM-DEDUCTIBLE-AMOUNTS.
  2078             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2079             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2080         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2081             20  CM-RESIDENT-STATE         PIC XX.
  2082             20  CM-RATE-CODE              PIC X(4).
  2083             20  FILLER                    PIC XX.
  2084         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2085             20  CM-LOAN-OFFICER           PIC X(5).
  2086             20  FILLER                    PIC XXX.
  2087         16  CM-CSR-CODE                   PIC XXX.
  2088         16  CM-UNDERWRITING-CODE          PIC X.
  2089             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2090         16  CM-POST-CARD-IND              PIC X.
  2091         16  CM-NH-INTERFACE-SW            PIC X.
  2092         16  CM-PREMIUM-TYPE               PIC X.
  2093             88  CM-SING-PRM                  VALUE '1'.
  2094             88  CM-O-B-COVERAGE              VALUE '2'.
  2095             88  CM-OPEN-END                  VALUE '3'.
  2096         16  CM-IND-GRP-TYPE               PIC X.
  2097             88  CM-INDIVIDUAL                VALUE 'I'.
  2098             88  CM-GROUP                     VALUE 'G'.
  2099         16  CM-SKIP-CODE                  PIC X.
  2100             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2101             88  SKIP-JULY                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  38
* NSRASBL.cbl
  2102             88  SKIP-AUGUST                  VALUE '2'.
  2103             88  SKIP-SEPTEMBER               VALUE '3'.
  2104             88  SKIP-JULY-AUG                VALUE '4'.
  2105             88  SKIP-AUG-SEPT                VALUE '5'.
  2106             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2107             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2108             88  SKIP-JUNE                    VALUE '8'.
  2109             88  SKIP-JUNE-JULY               VALUE '9'.
  2110             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2111             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2112         16  CM-PAYMENT-MODE               PIC X.
  2113             88  PAY-MONTHLY                  VALUE SPACE.
  2114             88  PAY-WEEKLY                   VALUE '1'.
  2115             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2116             88  PAY-BI-WEEKLY                VALUE '3'.
  2117             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2118         16  CM-LOAN-NUMBER                PIC X(8).
  2119         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2120         16  CM-OLD-LOF                    PIC XXX.
  2121*        16  CM-LOAN-OFFICER               PIC XXX.
  2122         16  CM-REIN-TABLE                 PIC XXX.
  2123         16  CM-SPECIAL-REIN-CODE          PIC X.
  2124         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2125         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2126         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2127
  2128     12  CM-STATUS-DATA.
  2129         16  CM-ENTRY-STATUS               PIC X.
  2130         16  CM-ENTRY-DT                   PIC XX.
  2131
  2132         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2133         16  CM-LF-CANCEL-DT               PIC XX.
  2134         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2135
  2136         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2137         16  CM-LF-DEATH-DT                PIC XX.
  2138         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2139
  2140         16  CM-LF-CURRENT-STATUS          PIC X.
  2141             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2142                                                'M' '4' '5' '9'.
  2143             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2144             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2145             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2146             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2147             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2148             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2149             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2150             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2151             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2152             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2153             88  CM-LF-DECLINED               VALUE 'D'.
  2154             88  CM-LF-VOIDED                 VALUE 'V'.
  2155
  2156         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2157         16  CM-AH-CANCEL-DT               PIC XX.
  2158         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2159
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  39
* NSRASBL.cbl
  2160         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2161         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2162         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2163
  2164         16  CM-AH-CURRENT-STATUS          PIC X.
  2165             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2166                                                'M' '4' '5' '9'.
  2167             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2168             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2169             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2170             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2171             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2172             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2173             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2174             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2175             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2176             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2177             88  CM-AH-DECLINED               VALUE 'D'.
  2178             88  CM-AH-VOIDED                 VALUE 'V'.
  2179
  2180         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2181             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2182             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2183             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2184         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2185
  2186         16  CM-ENTRY-BATCH                PIC X(6).
  2187         16  CM-LF-EXIT-BATCH              PIC X(6).
  2188         16  CM-AH-EXIT-BATCH              PIC X(6).
  2189         16  CM-LAST-MONTH-END             PIC XX.
  2190
  2191     12  CM-NOTE-SW                        PIC X.
  2192         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2193         88  CERT-NOTES-PRESENT               VALUE '1'.
  2194         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2195         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2196         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2197         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2198         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2199         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2200     12  CM-COMP-EXCP-SW                   PIC X.
  2201         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2202         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2203     12  CM-INSURED-ADDRESS-SW             PIC X.
  2204         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2205         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2206
  2207*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2208     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2209     12  FILLER                            PIC X.
  2210
  2211*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2212     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2213     12  FILLER                            PIC X.
  2214*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2215     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2216
  2217     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  40
* NSRASBL.cbl
  2218         88  CERT-ADDED-BATCH                 VALUE ' '.
  2219         88  CERT-ADDED-ONLINE                VALUE '1'.
  2220         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2221         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2222         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2223     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2224         88  CERT-AS-LOADED                   VALUE ' '.
  2225         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2226         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2227         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2228         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2229         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2230         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2231         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2232
  2233     12  CM-ACCOUNT-COMM-PCTS.
  2234         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2235         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2236
  2237     12  CM-USER-FIELD                     PIC X.
  2238     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2239     12  CM-CLP-STATE                      PIC XX.
  2240     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2241     12  CM-USER-RESERVED                  PIC XXX.
  2242     12  FILLER REDEFINES CM-USER-RESERVED.
  2243         16  CM-AH-CLASS-CD                PIC XX.
  2244         16  F                             PIC X.
  2245******************************************************************
  2246*                                COPY ELCCRTO.
  2247******************************************************************
  2248*                                                                *
  2249*                            ELCCRTO.                            *
  2250*                                                                *
  2251*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2252*                                                                *
  2253*   FILE TYPE = VSAM,KSDS                                        *
  2254*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2255*                                                                *
  2256*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2257*                                                                *
  2258*   LOG = YES                                                    *
  2259*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2260******************************************************************
  2261*                   C H A N G E   L O G
  2262*
  2263* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2264*-----------------------------------------------------------------
  2265*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2266* EFFECTIVE    NUMBER
  2267*-----------------------------------------------------------------
  2268* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2269* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2270* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2271* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2272******************************************************************
  2273 01  ORIGINAL-CERTIFICATE.
  2274     12  OC-RECORD-ID                      PIC XX.
  2275         88  VALID-OC-ID                      VALUE 'OC'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  41
* NSRASBL.cbl
  2276     12  OC-CONTROL-PRIMARY.
  2277         16  OC-COMPANY-CD                 PIC X.
  2278         16  OC-CARRIER                    PIC X.
  2279         16  OC-GROUPING                   PIC X(6).
  2280         16  OC-STATE                      PIC XX.
  2281         16  OC-ACCOUNT                    PIC X(10).
  2282         16  OC-CERT-EFF-DT                PIC XX.
  2283         16  OC-CERT-NO.
  2284             20  OC-CERT-PRIME             PIC X(10).
  2285             20  OC-CERT-SFX               PIC X.
  2286         16  OC-RECORD-TYPE                PIC X.
  2287         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2288     12  OC-LAST-MAINT-DT                  PIC XX.
  2289     12  OC-LAST-MAINT-BY                  PIC X(4).
  2290     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2291     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2292     12  FILLER                            PIC X(49).
  2293     12  OC-ORIG-REC.
  2294         16  OC-INS-LAST-NAME              PIC X(15).
  2295         16  OC-INS-FIRST-NAME             PIC X(10).
  2296         16  OC-INS-MIDDLE-INIT            PIC X.
  2297         16  OC-INS-AGE                    PIC S999     COMP-3.
  2298         16  OC-JNT-LAST-NAME              PIC X(15).
  2299         16  OC-JNT-FIRST-NAME             PIC X(10).
  2300         16  OC-JNT-MIDDLE-INIT            PIC X.
  2301         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2302         16  OC-LF-BENCD                   PIC XX.
  2303         16  OC-LF-TERM                    PIC S999      COMP-3.
  2304         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2305         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2306         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2307         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2308         16  OC-LF-EXP-DT                  PIC XX.
  2309         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2310         16  OC-LF-CANCEL-DT               PIC XX.
  2311         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2312         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2313         16  OC-AH-BENCD                   PIC XX.
  2314         16  OC-AH-TERM                    PIC S999      COMP-3.
  2315         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2316         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2317         16  OC-AH-EXP-DT                  PIC XX.
  2318         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2319         16  OC-AH-CP                      PIC 99.
  2320         16  OC-AH-CANCEL-DT               PIC XX.
  2321         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2322         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2323         16  OC-CRED-BENE-NAME             PIC X(25).
  2324         16  OC-1ST-PMT-DT                 PIC XX.
  2325         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  2326         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  2327         16  FILLER                        PIC X(213).
  2328
  2329     12  FILLER                            PIC X(50).
  2330******************************************************************
  2331*                                COPY ERCACCT.
  2332******************************************************************
  2333*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  42
* NSRASBL.cbl
  2334*                                                                *
  2335*                            ERCACCT                             *
  2336*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2337*                            VMOD=2.031                          *
  2338*                                                                *
  2339*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2340*                                                                *
  2341*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2342*   VSAM ACCOUNT MASTER FILES.                                   *
  2343*                                                                *
  2344*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2345*                                                                *
  2346*   FILE TYPE = VSAM,KSDS                                        *
  2347*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2348*                                                                *
  2349*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2350*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2351*                                                                *
  2352*   LOG = NO                                                     *
  2353*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2354*                                                                *
  2355*                                                                *
  2356******************************************************************
  2357*                   C H A N G E   L O G
  2358*
  2359* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2360*-----------------------------------------------------------------
  2361*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2362* EFFECTIVE    NUMBER
  2363*-----------------------------------------------------------------
  2364* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2365* 092705    2005050300006  PEMA  ADD SPP LEASES
  2366* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2367* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2368* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2369* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2370* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2371******************************************************************
  2372
  2373 01  ACCOUNT-MASTER.
  2374     12  AM-RECORD-ID                      PIC XX.
  2375         88  VALID-AM-ID                      VALUE 'AM'.
  2376
  2377     12  AM-CONTROL-PRIMARY.
  2378         16  AM-COMPANY-CD                 PIC X.
  2379         16  AM-MSTR-CNTRL.
  2380             20  AM-CONTROL-A.
  2381                 24  AM-CARRIER            PIC X.
  2382                 24  AM-GROUPING.
  2383                     28 AM-GROUPING-PREFIX PIC XXX.
  2384                     28 AM-GROUPING-PRIME  PIC XXX.
  2385                 24  AM-STATE              PIC XX.
  2386                 24  AM-ACCOUNT.
  2387                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2388                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2389             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2390                                           PIC X(19).
  2391             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  43
* NSRASBL.cbl
  2392                 24  AM-EXPIRATION-DT      PIC XX.
  2393                 24  FILLER                PIC X(4).
  2394             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2395                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2396
  2397     12  AM-CONTROL-BY-VAR-GRP.
  2398         16  AM-COMPANY-CD-A1              PIC X.
  2399         16  AM-VG-CARRIER                 PIC X.
  2400         16  AM-VG-GROUPING                PIC X(6).
  2401         16  AM-VG-STATE                   PIC XX.
  2402         16  AM-VG-ACCOUNT                 PIC X(10).
  2403         16  AM-VG-DATE.
  2404             20  AM-VG-EXPIRATION-DT       PIC XX.
  2405             20  FILLER                    PIC X(4).
  2406         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2407                                           PIC 9(11)      COMP-3.
  2408     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2409         16  FILLER                        PIC X(10).
  2410         16  AM-VG-KEY3.
  2411             20  AM-VG3-ACCOUNT            PIC X(10).
  2412             20  AM-VG3-EXP-DT             PIC XX.
  2413         16  FILLER                        PIC X(4).
  2414     12  AM-MAINT-INFORMATION.
  2415         16  AM-LAST-MAINT-DT              PIC XX.
  2416         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2417         16  AM-LAST-MAINT-USER            PIC X(4).
  2418         16  FILLER                        PIC XX.
  2419
  2420     12  AM-EFFECTIVE-DT                   PIC XX.
  2421     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2422
  2423     12  AM-PREV-DATES  COMP-3.
  2424         16  AM-PREV-EXP-DT                PIC 9(11).
  2425         16  AM-PREV-EFF-DT                PIC 9(11).
  2426
  2427     12  AM-REPORT-CODE-1                  PIC X(10).
  2428     12  AM-REPORT-CODE-2                  PIC X(10).
  2429
  2430     12  AM-CITY-CODE                      PIC X(4).
  2431     12  AM-COUNTY-PARISH                  PIC X(6).
  2432
  2433     12  AM-NAME                           PIC X(30).
  2434     12  AM-PERSON                         PIC X(30).
  2435     12  AM-ADDRS                          PIC X(30).
  2436     12  AM-CITY.
  2437         16  AM-ADDR-CITY                  PIC X(28).
  2438         16  AM-ADDR-STATE                 PIC XX.
  2439     12  AM-ZIP.
  2440         16  AM-ZIP-PRIME.
  2441             20  AM-ZIP-PRI-1ST            PIC X.
  2442                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2443             20  FILLER                    PIC X(4).
  2444         16  AM-ZIP-PLUS4                  PIC X(4).
  2445     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2446         16  AM-CAN-POSTAL-1               PIC XXX.
  2447         16  AM-CAN-POSTAL-2               PIC XXX.
  2448         16  FILLER                        PIC XXX.
  2449     12  AM-TEL-NO.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  44
* NSRASBL.cbl
  2450         16  AM-AREA-CODE                  PIC 999.
  2451         16  AM-TEL-PRE                    PIC 999.
  2452         16  AM-TEL-NBR                    PIC 9(4).
  2453     12  AM-TEL-LOC                        PIC X.
  2454         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2455         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2456
  2457     12  AM-COMM-STRUCTURE.
  2458         16  AM-DEFN-1.
  2459             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2460                 24  AM-AGT.
  2461                     28  AM-AGT-PREFIX     PIC X(4).
  2462                     28  AM-AGT-PRIME      PIC X(6).
  2463                 24  AM-COM-TYP            PIC X.
  2464                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2465                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2466                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2467                 24  AM-RECALC-LV-INDIC    PIC X.
  2468                 24  AM-RETRO-LV-INDIC     PIC X.
  2469                 24  AM-GL-CODES           PIC X.
  2470                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2471                 24  FILLER                PIC X(01).
  2472         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2473             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2474                 24  FILLER                PIC X(11).
  2475                 24  AM-L-COMA             PIC XXX.
  2476                 24  AM-J-COMA             PIC XXX.
  2477                 24  AM-A-COMA             PIC XXX.
  2478                 24  FILLER                PIC X(6).
  2479
  2480     12  AM-COMM-CHANGE-STATUS             PIC X.
  2481         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2482
  2483     12  AM-CSR-CODE                       PIC X(4).
  2484
  2485     12  AM-BILLING-STATUS                 PIC X.
  2486         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2487         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2488     12  AM-AUTO-REFUND-SW                 PIC X.
  2489         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2490         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2491     12  AM-GPCD                           PIC 99.
  2492     12  AM-IG                             PIC X.
  2493         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2494         88  AM-HAS-GROUP                     VALUE '2'.
  2495     12  AM-STATUS                         PIC X.
  2496         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2497         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2498         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2499         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2500         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2501         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2502     12  AM-REMIT-TO                       PIC 99.
  2503     12  AM-ID-NO                          PIC X(11).
  2504
  2505     12  AM-CAL-TABLE                      PIC XX.
  2506     12  AM-LF-DEVIATION                   PIC XXX.
  2507     12  AM-AH-DEVIATION                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  45
* NSRASBL.cbl
  2508     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2509     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2510     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2511     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2512     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2513     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2514
  2515     12  AM-USER-FIELDS.
  2516         16  AM-FLD-1                      PIC XX.
  2517         16  AM-FLD-2                      PIC XX.
  2518         16  AM-FLD-3                      PIC XX.
  2519         16  AM-FLD-4                      PIC XX.
  2520         16  AM-FLD-5                      PIC XX.
  2521
  2522     12  AM-1ST-PROD-DATE.
  2523         16  AM-1ST-PROD-YR                PIC XX.
  2524         16  AM-1ST-PROD-MO                PIC XX.
  2525         16  AM-1ST-PROD-DA                PIC XX.
  2526     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2527     12  AM-CERTS-PURGED-DATE.
  2528         16  AM-PUR-YR                     PIC XX.
  2529         16  AM-PUR-MO                     PIC XX.
  2530         16  AM-PUR-DA                     PIC XX.
  2531     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2532     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2533     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2534     12  AM-INACTIVE-DATE.
  2535         16  AM-INA-MO                     PIC 99.
  2536         16  AM-INA-DA                     PIC 99.
  2537         16  AM-INA-YR                     PIC 99.
  2538     12  AM-AR-HI-CERT-DATE                PIC XX.
  2539
  2540     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2541     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2542
  2543     12  AM-OB-PAYMENT-MODE                PIC X.
  2544         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2545         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2546         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2547         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2548
  2549     12  AM-AH-ONLY-INDICATOR              PIC X.
  2550         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2551         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2552
  2553     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2554
  2555     12  AM-OVER-SHORT.
  2556         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2557         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2558
  2559     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2560     12  AM-DCC-CLP-STATE                  PIC XX.
  2561
  2562     12  AM-RECALC-COMM                    PIC X.
  2563     12  AM-RECALC-REIN                    PIC X.
  2564
  2565     12  AM-REI-TABLE                      PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  46
* NSRASBL.cbl
  2566     12  AM-REI-ET-LF                      PIC X.
  2567     12  AM-REI-ET-AH                      PIC X.
  2568     12  AM-REI-PE-LF                      PIC X.
  2569     12  AM-REI-PE-AH                      PIC X.
  2570     12  AM-REI-PRT-ST                     PIC X.
  2571     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2572     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2573     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2574     12  AM-REI-GROUP-A                    PIC X(6).
  2575     12  AM-REI-MORT                       PIC X(4).
  2576     12  AM-REI-PRT-OW                     PIC X.
  2577     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2578     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2579     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2580     12  AM-REI-GROUP-B                    PIC X(6).
  2581
  2582     12  AM-TRUST-TYPE                     PIC X(2).
  2583
  2584     12  AM-EMPLOYER-STMT-USED             PIC X.
  2585     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2586
  2587     12  AM-STD-AH-TYPE                    PIC XX.
  2588     12  AM-EARN-METHODS.
  2589         16  AM-EARN-METHOD-R              PIC X.
  2590             88 AM-REF-RL-R78                 VALUE 'R'.
  2591             88 AM-REF-RL-PR                  VALUE 'P'.
  2592             88 AM-REF-RL-MEAN                VALUE 'M'.
  2593             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2594         16  AM-EARN-METHOD-L              PIC X.
  2595             88 AM-REF-LL-R78                 VALUE 'R'.
  2596             88 AM-REF-LL-PR                  VALUE 'P'.
  2597             88 AM-REF-LL-MEAN                VALUE 'M'.
  2598             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2599         16  AM-EARN-METHOD-A              PIC X.
  2600             88 AM-REF-AH-R78                 VALUE 'R'.
  2601             88 AM-REF-AH-PR                  VALUE 'P'.
  2602             88 AM-REF-AH-MEAN                VALUE 'M'.
  2603             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2604             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2605             88 AM-REF-AH-NET                 VALUE 'N'.
  2606
  2607     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2608     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2609     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2610
  2611     12  AM-RET-Y-N                        PIC X.
  2612     12  AM-RET-P-E                        PIC X.
  2613     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2614     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2615     12  AM-RET-GRP                        PIC X(6).
  2616     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2617         16  AM-POOL-PRIME                 PIC XXX.
  2618         16  AM-POOL-SUB                   PIC XXX.
  2619     12  AM-RETRO-EARNINGS.
  2620         16  AM-RET-EARN-R                 PIC X.
  2621         16  AM-RET-EARN-L                 PIC X.
  2622         16  AM-RET-EARN-A                 PIC X.
  2623     12  AM-RET-ST-TAX-USE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  47
* NSRASBL.cbl
  2624         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2625         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2626     12  AM-RETRO-BEG-EARNINGS.
  2627         16  AM-RET-BEG-EARN-R             PIC X.
  2628         16  AM-RET-BEG-EARN-L             PIC X.
  2629         16  AM-RET-BEG-EARN-A             PIC X.
  2630     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2631     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2632
  2633     12  AM-USER-SELECT-OPTIONS.
  2634         16  AM-USER-SELECT-1              PIC X(10).
  2635         16  AM-USER-SELECT-2              PIC X(10).
  2636         16  AM-USER-SELECT-3              PIC X(10).
  2637         16  AM-USER-SELECT-4              PIC X(10).
  2638         16  AM-USER-SELECT-5              PIC X(10).
  2639
  2640     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2641
  2642     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2643
  2644     12  AM-RPT045A-SWITCH                 PIC X.
  2645         88  RPT045A-OFF                   VALUE 'N'.
  2646
  2647     12  AM-INSURANCE-LIMITS.
  2648         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2649         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2650
  2651     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2652         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2653
  2654     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2655         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2656         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2657
  2658     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2659
  2660     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2661     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2662     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2663     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2664     12  AM-DCC-UEF-STATE                  PIC XX.
  2665     12  FILLER                            PIC XXX.
  2666     12  AM-REPORT-CODE-3                  PIC X(10).
  2667*    12  FILLER                            PIC X(22).
  2668
  2669     12  AM-RESERVE-DATE.
  2670         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2671         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2672         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2673
  2674     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2675     12  AM-NOTIFICATION-TYPES.
  2676         16  AM-NOTIF-OF-LETTERS           PIC X.
  2677         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2678         16  AM-NOTIF-OF-REPORTS           PIC X.
  2679         16  AM-NOTIF-OF-STATUS            PIC X.
  2680
  2681     12  AM-BENEFIT-TABLE-USAGE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  48
* NSRASBL.cbl
  2682         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2683         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2684         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2685         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2686
  2687     12  AM-BENEFIT-CONTROLS.
  2688         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2689             20  AM-BENEFIT-CODE           PIC XX.
  2690             20  AM-BENEFIT-TYPE           PIC X.
  2691             20  AM-BENEFIT-REVISION       PIC XXX.
  2692             20  AM-BENEFIT-REM-TERM       PIC X.
  2693             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2694             20  FILLER                    PIC XX.
  2695         16  FILLER                        PIC X(80).
  2696
  2697     12  AM-TRANSFER-DATA.
  2698         16  AM-TRANSFERRED-FROM.
  2699             20  AM-TRNFROM-CARRIER        PIC X.
  2700             20  AM-TRNFROM-GROUPING.
  2701                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2702                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2703             20  AM-TRNFROM-STATE          PIC XX.
  2704             20  AM-TRNFROM-ACCOUNT.
  2705                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2706                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2707             20  AM-TRNFROM-DTE            PIC XX.
  2708         16  AM-TRANSFERRED-TO.
  2709             20  AM-TRNTO-CARRIER          PIC X.
  2710             20  AM-TRNTO-GROUPING.
  2711                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2712                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2713             20  AM-TRNTO-STATE            PIC XX.
  2714             20  AM-TRNTO-ACCOUNT.
  2715                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2716                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2717             20  AM-TRNTO-DTE              PIC XX.
  2718         16  FILLER                        PIC X(10).
  2719
  2720     12  AM-SAVED-REMIT-TO                 PIC 99.
  2721
  2722     12  AM-COMM-STRUCTURE-SAVED.
  2723         16  AM-DEFN-1-SAVED.
  2724             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2725                 24  AM-AGT-SV             PIC X(10).
  2726                 24  AM-COM-TYP-SV         PIC X.
  2727                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2728                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2729                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2730                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2731                 24  FILLER                PIC X.
  2732                 24  AM-GL-CODES-SV        PIC X.
  2733                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2734                 24  FILLER                PIC X.
  2735         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2736             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2737                 24  FILLER                PIC X(11).
  2738                 24  AM-L-COMA-SV          PIC XXX.
  2739                 24  AM-J-COMA-SV          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  49
* NSRASBL.cbl
  2740                 24  AM-A-COMA-SV          PIC XXX.
  2741                 24  FILLER                PIC X(6).
  2742
  2743     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2744         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2745            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2746            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2747            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2748
  2749     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2750     12  FILLER                            PIC X(120).
  2751
  2752     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2753         16  AM-CONTROL-NAME               PIC X(30).
  2754         16  AM-EXECUTIVE-ONE.
  2755             20  AM-EXEC1-NAME             PIC X(15).
  2756             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2757                                                          COMP-3.
  2758             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2759                                                          COMP-3.
  2760         16  AM-EXECUTIVE-TWO.
  2761             20  AM-EXEC2-NAME             PIC X(15).
  2762             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2763                                                          COMP-3.
  2764             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2765                                                          COMP-3.
  2766
  2767     12  AM-RETRO-ADDITIONAL-DATA.
  2768         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2769         16  AM-RETRO-PREM-P-E             PIC X.
  2770         16  AM-RETRO-CLMS-P-I             PIC X.
  2771         16  AM-RETRO-RET-BRACKET-LF.
  2772             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2773                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2774                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2775             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2776                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2777                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2778             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2779                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2780                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2781         16  AM-RETRO-RET-BRACKET-AH.
  2782             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2783                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2784                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2785                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2786             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2787                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2788                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2789             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2790                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2791                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2792
  2793     12  AM-COMMENTS.
  2794         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2795
  2796     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2797         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  50
* NSRASBL.cbl
  2798         16  AM-FLI-BILLING-CODE           PIC X.
  2799         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2800         16  AM-FLI-UNITED-IDENT           PIC X.
  2801         16  AM-FLI-INTEREST-LOST-DATA.
  2802             20  AM-FLI-BANK-NO            PIC X(5).
  2803             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2804             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2805             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2806         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2807             20  AM-FLI-AGT                PIC X(9).
  2808             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2809             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2810         16  FILLER                        PIC X(102).
  2811
  2812     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2813         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2814             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2815             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2816             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2817             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2818             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2819         16  FILLER                          PIC X(10).
  2820******************************************************************
  2821*                                COPY ELCTEXT.
  2822******************************************************************
  2823*                                                                *
  2824*                                                                *
  2825*                            ELCTEXT.                            *
  2826*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2827*                            VMOD=2.008                          *
  2828*                                                                *
  2829*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2830*                                     FORM LETTERS,              *
  2831*                                     CERT FORM DISPLAY.
  2832*                                                                *
  2833*   FILE TYPE = VSAM,KSDS                                        *
  2834*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2835*                                                                *
  2836*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2837*       ALTERNATE INDEX = NONE                                   *
  2838*                                                                *
  2839*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2840*       ALTERNATE INDEX = NONE                                   *
  2841*                                                                *
  2842*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  2843*       ALTERNATE INDEX = NONE                                   *
  2844*                                                                *
  2845*   LOG = NO                                                     *
  2846*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2847******************************************************************
  2848 01  TEXT-FILES.
  2849     12  TEXT-FILE-ID                PIC XX.
  2850         88  FORMS-FILE-TEXT            VALUE 'TF'.
  2851         88  LETTER-FILE-TEXT           VALUE 'TL'.
  2852         88  HELP-FILE-TEXT             VALUE 'TH'.
  2853
  2854     12  TX-CONTROL-PRIMARY.
  2855         16  TX-COMPANY-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  51
* NSRASBL.cbl
  2856             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  2857         16  TX-ACCESS-CD-GENL       PIC X(12).
  2858
  2859         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2860             20  TX-LETTER-NO        PIC X(4).
  2861             20  FILLER              PIC X(8).
  2862
  2863         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2864             20  TX-FORM-NO          PIC X(12).
  2865
  2866         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2867             20  TX-HELP-TYPE        PIC X.
  2868                 88  HELP-FOR-GENERAL   VALUE ' '.
  2869                 88  HELP-BY-SCREEN     VALUE 'S'.
  2870                 88  HELP-BY-ERROR      VALUE 'E'.
  2871             20  TX-SCREEN-OR-ERROR  PIC X(4).
  2872                 88  GENERAL-INFO-HELP  VALUE '0000'.
  2873             20  TX-HELP-FOR-COMPANY  PIC XXX.
  2874                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  2875             20  FILLER              PIC X(4).
  2876
  2877         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  2878
  2879     12  TX-PROCESS-CONTROL          PIC XX.
  2880         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  2881
  2882     12  TX-TEXT-LINE                PIC X(70).
  2883
  2884     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  2885         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  2886         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  2887         88  TX-VALID-FORM-SQUEEZE-VALUE
  2888                                        VALUE 'Y' ' '.
  2889
  2890     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  2891         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  2892         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  2893         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  2894         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  2895         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  2896         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  2897         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  2898                                              'K' 'N' ' '
  2899                                              'Z'.
  2900
  2901     12  TX-ARCHIVE-SW               PIC X.
  2902         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  2903         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  2904         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  2905
  2906     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  2907     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  2908
  2909     12  TX-BSR-CODE                 PIC X.
  2910         88  TX-BSR-LETTER              VALUE 'B'.
  2911         88  TX-NON-BSR-LETTER          VALUE ' '.
  2912
  2913     12  FILLER                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  52
* NSRASBL.cbl
  2914*****************************************************************
  2915*                                COPY ELCCNTL.
  2916******************************************************************
  2917*                                                                *
  2918*                                                                *
  2919*                            ELCCNTL.                            *
  2920*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2921*                            VMOD=2.059                          *
  2922*                                                                *
  2923*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2924*                                                                *
  2925*   FILE TYPE = VSAM,KSDS                                        *
  2926*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2927*                                                                *
  2928*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2929*       ALTERNATE INDEX = NONE                                   *
  2930*                                                                *
  2931*   LOG = YES                                                    *
  2932*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2933******************************************************************
  2934*                   C H A N G E   L O G
  2935*
  2936* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2937*-----------------------------------------------------------------
  2938*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2939* EFFECTIVE    NUMBER
  2940*-----------------------------------------------------------------
  2941* 082503                   PEMA  ADD BENEFIT GROUP
  2942* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2943* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2944* 092705    2005050300006  PEMA  ADD SPP LEASES
  2945* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2946* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2947* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2948* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2949* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2950* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2951******************************************************************
  2952*
  2953 01  CONTROL-FILE.
  2954     12  CF-RECORD-ID                       PIC XX.
  2955         88  VALID-CF-ID                        VALUE 'CF'.
  2956
  2957     12  CF-CONTROL-PRIMARY.
  2958         16  CF-COMPANY-ID                  PIC XXX.
  2959         16  CF-RECORD-TYPE                 PIC X.
  2960             88  CF-COMPANY-MASTER              VALUE '1'.
  2961             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2962             88  CF-STATE-MASTER                VALUE '3'.
  2963             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2964             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2965             88  CF-CARRIER-MASTER              VALUE '6'.
  2966             88  CF-MORTALITY-MASTER            VALUE '7'.
  2967             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2968             88  CF-TERMINAL-MASTER             VALUE '9'.
  2969             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2970             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2971             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  53
* NSRASBL.cbl
  2972             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2973             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2974             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2975             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2976             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2977             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2978         16  CF-ACCESS-CD-GENL              PIC X(4).
  2979         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2980             20  CF-PROCESSOR               PIC X(4).
  2981         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2982             20  CF-STATE-CODE              PIC XX.
  2983             20  FILLER                     PIC XX.
  2984         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2985             20  FILLER                     PIC XX.
  2986             20  CF-HI-BEN-IN-REC           PIC XX.
  2987         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2988             20  FILLER                     PIC XXX.
  2989             20  CF-CARRIER-CNTL            PIC X.
  2990         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2991             20  FILLER                     PIC XX.
  2992             20  CF-HI-TYPE-IN-REC          PIC 99.
  2993         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2994             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2995                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2996             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2997             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2998         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2999             20  FILLER                     PIC X.
  3000             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3001         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3002             20  FILLER                     PIC XX.
  3003             20  CF-MORTGAGE-PLAN           PIC XX.
  3004         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3005
  3006     12  CF-LAST-MAINT-DT                   PIC XX.
  3007     12  CF-LAST-MAINT-BY                   PIC X(4).
  3008     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3009
  3010     12  CF-RECORD-BODY                     PIC X(728).
  3011
  3012
  3013****************************************************************
  3014*             COMPANY MASTER RECORD                            *
  3015****************************************************************
  3016
  3017     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3018         16  CF-COMPANY-ADDRESS.
  3019             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3020             20  CF-CL-IN-CARE-OF           PIC X(30).
  3021             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3022             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3023             20  CF-CL-CITY-STATE           PIC X(30).
  3024             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3025             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3026         16  CF-COMPANY-CD                  PIC X.
  3027         16  CF-COMPANY-PASSWORD            PIC X(8).
  3028         16  CF-SECURITY-OPTION             PIC X.
  3029             88  ALL-SECURITY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  54
* NSRASBL.cbl
  3030             88  COMPANY-VERIFY                 VALUE '2'.
  3031             88  PROCESSOR-VERIFY               VALUE '3'.
  3032             88  NO-SECURITY                    VALUE '4'.
  3033             88  ALL-BUT-TERM                   VALUE '5'.
  3034         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3035             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3036         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3037             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3038         16  CF-INFORCE-LOCATION            PIC X.
  3039             88  CERTS-ARE-ONLINE               VALUE '1'.
  3040             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3041             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3042         16  CF-LOWER-CASE-LETTERS          PIC X.
  3043         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3044             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3045             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3046             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3047             88  CF-ACCNT-CNTL                  VALUE '3'.
  3048             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3049
  3050         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3051         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3052
  3053         16  CF-LGX-CREDIT-USER             PIC X.
  3054             88  CO-IS-NOT-USER                 VALUE 'N'.
  3055             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3056
  3057         16 CF-CREDIT-CALC-CODES.
  3058             20  CF-CR-REM-TERM-CALC PIC X.
  3059               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3060               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3061               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3062               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3063               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3064               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3065               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3066             20  CF-CR-R78-METHOD           PIC X.
  3067               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3068               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3069
  3070         16  CF-CLAIM-CONTROL-COUNTS.
  3071             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3072                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3073
  3074             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3075                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3076
  3077             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3078                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3079
  3080             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3081                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3082
  3083         16  CF-CURRENT-MONTH-END           PIC XX.
  3084
  3085         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3086             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3087             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  55
* NSRASBL.cbl
  3088             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3089             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3090                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3091                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3092             20  CF-CO-PREM-REJECT-SW       PIC X.
  3093                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3094                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3095             20  CF-CO-REF-REJECT-SW        PIC X.
  3096                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3097                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3098
  3099         16  CF-CO-REPORTING-DT             PIC XX.
  3100         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3101         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3102           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3103           88  CF-CO-MONTH-END                  VALUE '1'.
  3104
  3105         16  CF-LGX-CLAIM-USER              PIC X.
  3106             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3107             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3108
  3109         16  CF-CREDIT-EDIT-CONTROLS.
  3110             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3111             20  CF-MIN-AGE                 PIC 99.
  3112             20  CF-DEFAULT-AGE             PIC 99.
  3113             20  CF-MIN-TERM                PIC S999      COMP-3.
  3114             20  CF-MAX-TERM                PIC S999      COMP-3.
  3115             20  CF-DEFAULT-SEX             PIC X.
  3116             20  CF-JOINT-AGE-INPUT         PIC X.
  3117                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3118             20  CF-BIRTH-DATE-INPUT        PIC X.
  3119                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3120             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3121                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3122                 88  CF-ZERO-CARRIER            VALUE '1'.
  3123                 88  CF-ZERO-GROUPING           VALUE '2'.
  3124                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3125             20  CF-EDIT-SW                 PIC X.
  3126                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3127             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3128             20  CF-CR-PR-METHOD            PIC X.
  3129               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3130               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3131             20  FILLER                     PIC X.
  3132
  3133         16  CF-CREDIT-MISC-CONTROLS.
  3134             20  CF-REIN-TABLE-SW           PIC X.
  3135                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3136             20  CF-COMP-TABLE-SW           PIC X.
  3137                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3138             20  CF-EXPERIENCE-RETENTION-AGE
  3139                                            PIC S9        COMP-3.
  3140             20  CF-CONVERSION-DT           PIC XX.
  3141             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3142             20  CF-RUN-FREQUENCY-SW        PIC X.
  3143                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3144                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3145
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  56
* NSRASBL.cbl
  3146             20  CF-CR-CHECK-NO-CONTROL.
  3147                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3148                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3149                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3150                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3151                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3152                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3153
  3154                 24  CF-CR-CHECK-COUNT       REDEFINES
  3155                     CF-CR-CHECK-COUNTER      PIC X(4).
  3156
  3157                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3158                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3159
  3160                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3161                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3162                 24  CF-MAIL-PROCESSING       PIC X.
  3163                     88  MAIL-PROCESSING          VALUE 'Y'.
  3164
  3165         16  CF-MISC-SYSTEM-CONTROL.
  3166             20  CF-SYSTEM-C                 PIC X.
  3167                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3168             20  CF-SYSTEM-D                 PIC X.
  3169                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3170             20  CF-SOC-SEC-NO-SW            PIC X.
  3171                 88  SOC-SEC-NO-USED             VALUE '1'.
  3172             20  CF-MEMBER-NO-SW             PIC X.
  3173                 88  MEMBER-NO-USED              VALUE '1'.
  3174             20  CF-TAX-ID-NUMBER            PIC X(11).
  3175             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3176             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3177                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3178                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3179                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3180                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3181             20  CF-SYSTEM-E                 PIC X.
  3182                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3183
  3184         16  CF-LGX-LIFE-USER               PIC X.
  3185             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3186             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3187
  3188         16  CF-CR-MONTH-END-DT             PIC XX.
  3189
  3190         16  CF-FILE-MAINT-DATES.
  3191             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3192                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3193             20  CF-LAST-BATCH       REDEFINES
  3194                 CF-LAST-BATCH-NO               PIC X(4).
  3195             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3196             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3197             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3198             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3199             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3200             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3201             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3202             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3203             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  57
* NSRASBL.cbl
  3204             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3205
  3206         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3207         16  FILLER                         PIC X.
  3208
  3209         16  CF-ALT-MORT-CODE               PIC X(4).
  3210         16  CF-MEMBER-CAPTION              PIC X(10).
  3211
  3212         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3213             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3214             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3215             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3216             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3217             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3218
  3219         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3220
  3221         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3222         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3223         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3224         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3225
  3226         16  CF-AH-OVERRIDE-L1              PIC X.
  3227         16  CF-AH-OVERRIDE-L2              PIC XX.
  3228         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3229         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3230
  3231         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3232         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3233
  3234         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3235         16  CF-AR-LAST-EL860-DT            PIC XX.
  3236         16  CF-MP-MONTH-END-DT             PIC XX.
  3237
  3238         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3239         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3240             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3241
  3242         16  CF-AR-MONTH-END-DT             PIC XX.
  3243
  3244         16  CF-CRDTCRD-USER                PIC X.
  3245             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3246             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3247
  3248         16  CF-CC-MONTH-END-DT             PIC XX.
  3249
  3250         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3251
  3252         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3253             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3254             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3255             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3256         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3257         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3258         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3259         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3260             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3261             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  58
* NSRASBL.cbl
  3262         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3263         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3264         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3265             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3266         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3267
  3268         16  CF-CL-ZIP-CODE.
  3269             20  CF-CL-ZIP-PRIME.
  3270                 24  CF-CL-ZIP-1ST          PIC X.
  3271                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3272                 24  FILLER                 PIC X(4).
  3273             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3274         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3275             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3276             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3277             20  FILLER                     PIC XXX.
  3278
  3279         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3280         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3281         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3282         16  CF-CO-OPTION-START-DATE        PIC XX.
  3283         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3284           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3285                                                      '3' '4'.
  3286           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3287           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3288           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3289           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3290           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3291           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3292
  3293         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3294
  3295         16  CF-PAYMENT-APPROVAL-LEVELS.
  3296             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3297             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3298             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3299             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3300             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3301             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3302
  3303         16  CF-END-USER-REPORTING-USER     PIC X.
  3304             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3305             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3306
  3307         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3308             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3309             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3310
  3311         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3312
  3313         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3314         16  FILLER                         PIC X.
  3315
  3316         16  CF-CREDIT-ARCHIVE-CNTL.
  3317             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3318             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3319             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  59
* NSRASBL.cbl
  3320
  3321         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3322
  3323         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3324             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3325             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3326
  3327         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3328             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3329             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3330
  3331         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3332
  3333         16  CF-CO-ACH-ID-CODE              PIC  X.
  3334             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3335             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3336             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3337         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3338         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3339         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3340         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3341         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3342         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3343         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3344         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3345         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3346                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3347         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3348                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3349
  3350         16  CF-CO-OVER-SHORT.
  3351             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3352             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3353
  3354*         16  FILLER                         PIC X(102).
  3355         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3356             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3357             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3358
  3359         16  CF-AH-APPROVAL-DAYS.
  3360             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3361             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3362             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3363             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3364
  3365         16  FILLER                         PIC X(82).
  3366****************************************************************
  3367*             PROCESSOR/USER RECORD                            *
  3368****************************************************************
  3369
  3370     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3371         16  CF-PROCESSOR-NAME              PIC X(30).
  3372         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3373         16  CF-PROCESSOR-TITLE             PIC X(26).
  3374         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3375                 88  MESSAGE-YES                VALUE 'Y'.
  3376                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3377
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  60
* NSRASBL.cbl
  3378*****************************************************
  3379****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3380****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3381****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3382****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3383*****************************************************
  3384
  3385         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3386             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3387             20  CF-APPLICATION-FORCE       PIC X.
  3388             20  CF-INDIVIDUAL-APP.
  3389                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3390                     28  CF-BROWSE-APP      PIC X.
  3391                     28  CF-UPDATE-APP      PIC X.
  3392
  3393         16  CF-CURRENT-TERM-ON             PIC X(4).
  3394         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3395             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3396             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3397             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3398             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3399             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3400             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3401             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3402         16  CF-PROCESSOR-CARRIER           PIC X.
  3403             88  NO-CARRIER-SECURITY            VALUE ' '.
  3404         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3405             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3406         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3407             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3408         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3409             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3410
  3411         16  CF-PROC-SYS-ACCESS-SW.
  3412             20  CF-PROC-CREDIT-CLAIMS-SW.
  3413                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3414                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3415                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3416                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3417             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3418                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3419                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3420             20  CF-PROC-LIFE-GNRLDGR-SW.
  3421                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3422                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3423                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3424                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3425             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3426                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3427                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3428         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3429             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3430             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3431         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3432
  3433         16  CF-APPROVAL-LEVEL                  PIC X.
  3434             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3435             88  APPROVAL-LEVEL-2                   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  61
* NSRASBL.cbl
  3436             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3437             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3438
  3439         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3440
  3441         16  CF-LANGUAGE-TYPE                   PIC X.
  3442             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3443             88  CF-LANG-IS-FR                      VALUE 'F'.
  3444
  3445         16  CF-CSR-IND                         PIC X.
  3446         16  FILLER                             PIC X(239).
  3447
  3448****************************************************************
  3449*             PROCESSOR/REMINDERS RECORD                       *
  3450****************************************************************
  3451
  3452     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3453         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3454             20  CF-START-REMIND-DT         PIC XX.
  3455             20  CF-END-REMIND-DT           PIC XX.
  3456             20  CF-REMINDER-TEXT           PIC X(50).
  3457         16  FILLER                         PIC X(296).
  3458
  3459
  3460****************************************************************
  3461*             STATE MASTER RECORD                              *
  3462****************************************************************
  3463
  3464     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3465         16  CF-STATE-ABBREVIATION          PIC XX.
  3466         16  CF-STATE-NAME                  PIC X(25).
  3467         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3468         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3469             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3470             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3471             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3472             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3473                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3474                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3475             20  CF-ST-PREM-REJECT-SW       PIC X.
  3476                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3477                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3478             20  CF-ST-REF-REJECT-SW        PIC X.
  3479                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3480                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3481         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3482         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3483         16  CF-ST-REFUND-RULES.
  3484             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3485             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3486             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3487         16  CF-ST-FST-PMT-EXTENSION.
  3488             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3489             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3490                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3491                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3492                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3493                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  62
* NSRASBL.cbl
  3494         16  CF-ST-STATE-CALL.
  3495             20  CF-ST-CALL-UNEARNED        PIC X.
  3496             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3497             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3498         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3499             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3500             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3501         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3502         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3503         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3504         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3505         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3506         16  FILLER                         PIC X.
  3507         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3508             20  CF-ST-BENEFIT-CD           PIC XX.
  3509             20  CF-ST-BENEFIT-KIND         PIC X.
  3510                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3511                 88  CF-ST-AH-KIND              VALUE 'A'.
  3512             20  CF-ST-REM-TERM-CALC        PIC X.
  3513                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3514                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3515                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3516                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3517                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3518                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3519                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3520                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3521
  3522             20  CF-ST-REFUND-CALC          PIC X.
  3523                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3524                 88  ST-REFD-BY-R78             VALUE '1'.
  3525                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3526                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3527                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3528                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3529                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3530                 88  ST-REFD-UTAH               VALUE '7'.
  3531                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3532                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3533                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3534
  3535             20  CF-ST-EARNING-CALC         PIC X.
  3536                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3537                 88  ST-EARN-BY-R78             VALUE '1'.
  3538                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3539                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3540                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3541                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3542                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3543                 88  ST-EARN-MEAN               VALUE '8'.
  3544                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3545
  3546             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3547                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3548                 88  ST-OVRD-BY-R78             VALUE '1'.
  3549                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3550                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3551                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  63
* NSRASBL.cbl
  3552                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3553                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3554                 88  ST-OVRD-MEAN               VALUE '8'.
  3555                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3556             20  FILLER                     PIC X.
  3557
  3558         16  CF-ST-COMMISSION-CAPS.
  3559             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3560             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3561             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3562             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3563         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3564                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3565
  3566         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3567
  3568         16  CF-ST-STATUTORY-INTEREST.
  3569             20  CF-ST-STAT-DATE-FROM       PIC X.
  3570                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3571                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3572             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3573             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3574             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3575             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3576             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3577
  3578         16  CF-ST-OVER-SHORT.
  3579             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3580             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3581
  3582         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3583
  3584         16  CF-ST-RT-CALC                  PIC X.
  3585
  3586         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3587         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3588         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3589         16  CF-ST-RF-LR-CALC               PIC X.
  3590         16  CF-ST-RF-LL-CALC               PIC X.
  3591         16  CF-ST-RF-LN-CALC               PIC X.
  3592         16  CF-ST-RF-AH-CALC               PIC X.
  3593         16  CF-ST-RF-CP-CALC               PIC X.
  3594*        16  FILLER                         PIC X(206).
  3595*CIDMOD         16  FILLER                         PIC X(192).
  3596         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3597             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3598         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3599         16  CF-ST-VFY-2ND-BENE             PIC X.
  3600         16  FILLER                         PIC X(186).
  3601
  3602****************************************************************
  3603*             BENEFIT MASTER RECORD                            *
  3604****************************************************************
  3605
  3606     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3607         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3608             20  CF-BENEFIT-CODE            PIC XX.
  3609             20  CF-BENEFIT-NUMERIC  REDEFINES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  64
* NSRASBL.cbl
  3610                 CF-BENEFIT-CODE            PIC XX.
  3611             20  CF-BENEFIT-ALPHA           PIC XXX.
  3612             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3613             20  CF-BENEFIT-COMMENT         PIC X(10).
  3614
  3615             20  CF-LF-COVERAGE-TYPE        PIC X.
  3616                 88  CF-REDUCING                VALUE 'R'.
  3617                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3618
  3619             20  CF-SPECIAL-CALC-CD         PIC X.
  3620                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3621                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3622                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3623                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3624                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3625                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3626                 88  CF-FARM-PLAN               VALUE 'F'.
  3627                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3628                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3629                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3630                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3631                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3632                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3633                 88  CF-PRUDENTIAL              VALUE 'P'.
  3634                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3635                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3636                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3637                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3638                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3639                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3640
  3641             20  CF-JOINT-INDICATOR         PIC X.
  3642                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3643
  3644*            20  FILLER                     PIC X(12).
  3645             20  FILLER                     PIC X(11).
  3646             20  CF-BENEFIT-CATEGORY        PIC X.
  3647             20  CF-LOAN-TYPE               PIC X(8).
  3648
  3649             20  CF-CO-REM-TERM-CALC        PIC X.
  3650                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3651                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3652                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3653                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3654                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3655
  3656             20  CF-CO-EARNINGS-CALC        PIC X.
  3657                 88  CO-EARN-BY-R78             VALUE '1'.
  3658                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3659                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3660                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3661                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3662                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3663                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3664                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3665
  3666             20  CF-CO-REFUND-CALC          PIC X.
  3667                 88  CO-REFUND-NOT-USED         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  65
* NSRASBL.cbl
  3668                 88  CO-REFD-BY-R78             VALUE '1'.
  3669                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3670                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3671                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3672                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3673                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3674                 88  CO-REFD-MEAN               VALUE '8'.
  3675                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3676                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3677                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3678
  3679             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3680                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3681                 88  CO-OVRD-BY-R78             VALUE '1'.
  3682                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3683                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3684                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3685                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3686                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3687                 88  CO-OVRD-MEAN               VALUE '8'.
  3688                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3689
  3690             20  CF-CO-BEN-I-G-CD           PIC X.
  3691                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3692                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3693                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3694
  3695         16  FILLER                         PIC X(304).
  3696
  3697
  3698****************************************************************
  3699*             CARRIER MASTER RECORD                            *
  3700****************************************************************
  3701
  3702     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3703         16  CF-ADDRESS-DATA.
  3704             20  CF-MAIL-TO-NAME            PIC X(30).
  3705             20  CF-IN-CARE-OF              PIC X(30).
  3706             20  CF-ADDRESS-LINE-1          PIC X(30).
  3707             20  CF-ADDRESS-LINE-2          PIC X(30).
  3708             20  CF-CITY-STATE              PIC X(30).
  3709             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3710             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3711
  3712         16  CF-CLAIM-NO-CONTROL.
  3713             20  CF-CLAIM-NO-METHOD         PIC X.
  3714                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3715                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3716                 88  CLAIM-NO-SEQ               VALUE '3'.
  3717                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3718             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3719                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3720                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3721                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3722
  3723         16  CF-CHECK-NO-CONTROL.
  3724             20  CF-CHECK-NO-METHOD         PIC X.
  3725                 88  CHECK-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  66
* NSRASBL.cbl
  3726                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3727                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3728                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3729             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3730                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3731
  3732         16  CF-DOMICILE-STATE              PIC XX.
  3733
  3734         16  CF-EXPENSE-CONTROLS.
  3735             20  CF-EXPENSE-METHOD          PIC X.
  3736                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3737                 88  DOLLARS-PER-PMT            VALUE '2'.
  3738                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3739                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3740             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3741             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3742
  3743         16  CF-CORRESPONDENCE-CONTROL.
  3744             20  CF-LETTER-RESEND-OPT       PIC X.
  3745                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3746                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3747             20  FILLER                     PIC X(4).
  3748
  3749         16  CF-RESERVE-CONTROLS.
  3750             20  CF-MANUAL-SW               PIC X.
  3751                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3752             20  CF-FUTURE-SW               PIC X.
  3753                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3754             20  CF-PTC-SW                  PIC X.
  3755                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3756             20  CF-IBNR-SW                 PIC X.
  3757                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3758             20  CF-PTC-LF-SW               PIC X.
  3759                 88  CF-LF-PTC-USED             VALUE '1'.
  3760             20  CF-CDT-ACCESS-METHOD       PIC X.
  3761                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3762                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3763                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3764             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3765
  3766         16  CF-CLAIM-CALC-METHOD           PIC X.
  3767             88  360-PLUS-MONTHS                VALUE '1'.
  3768             88  365-PLUS-MONTHS                VALUE '2'.
  3769             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3770             88  360-DAILY                      VALUE '4'.
  3771             88  365-DAILY                      VALUE '5'.
  3772
  3773         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3774         16  FILLER                         PIC X(11).
  3775
  3776         16  CF-LIMIT-AMOUNTS.
  3777             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3778             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3779             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3780             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3781             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3782             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3783             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  67
* NSRASBL.cbl
  3784             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3785             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3786             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3787
  3788         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3789         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3790         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3791
  3792         16  CF-ZIP-CODE.
  3793             20  CF-ZIP-PRIME.
  3794                 24  CF-ZIP-1ST             PIC X.
  3795                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3796                 24  FILLER                 PIC X(4).
  3797             20  CF-ZIP-PLUS4               PIC X(4).
  3798         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3799             20  CF-CAN-POSTAL-1            PIC XXX.
  3800             20  CF-CAN-POSTAL-2            PIC XXX.
  3801             20  FILLER                     PIC XXX.
  3802
  3803         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3804         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3805         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3806
  3807         16  CF-RATING-SWITCH               PIC X.
  3808             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3809             88  CF-NO-RATING                   VALUE 'N'.
  3810
  3811         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3812
  3813         16  CF-CARRIER-OVER-SHORT.
  3814             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3815             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3816
  3817         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3818         16  CF-SECPAY-SWITCH               PIC X.
  3819             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3820             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3821         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3822         16  FILLER                         PIC X(448).
  3823*        16  FILLER                         PIC X(452).
  3824
  3825
  3826****************************************************************
  3827*             MORTALITY MASTER RECORD                          *
  3828****************************************************************
  3829
  3830     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3831         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3832                                INDEXED BY CF-MORT-NDX.
  3833             20  CF-MORT-TABLE              PIC X(5).
  3834             20  CF-MORT-TABLE-TYPE         PIC X.
  3835                 88  CF-MORT-JOINT              VALUE 'J'.
  3836                 88  CF-MORT-SINGLE             VALUE 'S'.
  3837                 88  CF-MORT-COMBINED           VALUE 'C'.
  3838                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3839                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3840             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3841             20  CF-MORT-AGE-METHOD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  68
* NSRASBL.cbl
  3842                 88  CF-AGE-LAST                VALUE 'AL'.
  3843                 88  CF-AGE-NEAR                VALUE 'AN'.
  3844             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3845             20  CF-MORT-ADJUSTMENT-DIRECTION
  3846                                            PIC X.
  3847                 88  CF-MINUS                   VALUE '-'.
  3848                 88  CF-PLUS                    VALUE '+'.
  3849             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3850             20  CF-MORT-JOINT-CODE         PIC X.
  3851                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3852             20  CF-MORT-PC-Q               PIC X.
  3853                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3854             20  CF-MORT-TABLE-CODE         PIC X(4).
  3855             20  CF-MORT-COMMENTS           PIC X(15).
  3856             20  FILLER                     PIC X(14).
  3857
  3858         16  FILLER                         PIC X(251).
  3859
  3860
  3861****************************************************************
  3862*             BUSSINESS TYPE MASTER RECORD                     *
  3863****************************************************************
  3864
  3865     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3866* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3867* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3868* AND RECORD 05 IS TYPES 81-99
  3869         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3870             20  CF-BUSINESS-TITLE          PIC  X(19).
  3871             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3872                                            PIC S9V9(4) COMP-3.
  3873             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3874             20  FILLER                     PIC  X.
  3875         16  FILLER                         PIC  X(248).
  3876
  3877
  3878****************************************************************
  3879*             TERMINAL MASTER RECORD                           *
  3880****************************************************************
  3881
  3882     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3883
  3884         16  CF-COMPANY-TERMINALS.
  3885             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3886                                  PIC X(4).
  3887         16  FILLER               PIC X(248).
  3888
  3889
  3890****************************************************************
  3891*             LIFE EDIT MASTER RECORD                          *
  3892****************************************************************
  3893
  3894     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3895         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3896             20  CF-LIFE-CODE-IN            PIC XX.
  3897             20  CF-LIFE-CODE-OUT           PIC XX.
  3898         16  FILLER                         PIC X(248).
  3899
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  69
* NSRASBL.cbl
  3900
  3901****************************************************************
  3902*             AH EDIT MASTER RECORD                            *
  3903****************************************************************
  3904
  3905     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3906         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3907             20  CF-AH-CODE-IN              PIC XXX.
  3908             20  CF-AH-CODE-OUT             PIC XX.
  3909         16  FILLER                         PIC X(248).
  3910
  3911
  3912****************************************************************
  3913*             CREDIBILITY TABLES                               *
  3914****************************************************************
  3915
  3916     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3917         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3918                             INDEXED BY CF-CRDB-NDX.
  3919             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3920             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3921             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3922         16  FILLER                         PIC  X(332).
  3923
  3924
  3925****************************************************************
  3926*             REPORT CUSTOMIZATION RECORD                      *
  3927****************************************************************
  3928
  3929     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3930         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3931             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3932             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3933             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3934**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3935****       A T-TRANSFER.                                   ****
  3936             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3937
  3938         16  FILLER                         PIC XX.
  3939
  3940         16  CF-CARRIER-CNTL-OPT.
  3941             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3942                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3943                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3944             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3945                                            PIC X.
  3946         16  CF-GROUP-CNTL-OPT.
  3947             20  CF-GROUP-OPT-SEQ           PIC 9.
  3948                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3949                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3950             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3951                                            PIC X(6).
  3952         16  CF-STATE-CNTL-OPT.
  3953             20  CF-STATE-OPT-SEQ           PIC 9.
  3954                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3955                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3956             20  CF-STATE-SELECT OCCURS 3 TIMES
  3957                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  70
* NSRASBL.cbl
  3958         16  CF-ACCOUNT-CNTL-OPT.
  3959             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3960                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3961                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3962             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3963                                            PIC X(10).
  3964         16  CF-BUS-TYP-CNTL-OPT.
  3965             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3966                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3967                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3968             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3969                                            PIC XX.
  3970         16  CF-LF-TYP-CNTL-OPT.
  3971             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3972                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3973                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3974             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3975                                            PIC XX.
  3976         16  CF-AH-TYP-CNTL-OPT.
  3977             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3978                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3979                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3980             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3981                                            PIC XX.
  3982         16  CF-REPTCD1-CNTL-OPT.
  3983             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3984                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3985                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3986             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3987                                            PIC X(10).
  3988         16  CF-REPTCD2-CNTL-OPT.
  3989             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3990                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3991                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3992             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3993                                            PIC X(10).
  3994         16  CF-USER1-CNTL-OPT.
  3995             20  CF-USER1-OPT-SEQ           PIC 9.
  3996                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3997                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3998             20  CF-USER1-SELECT OCCURS 3 TIMES
  3999                                            PIC X(10).
  4000         16  CF-USER2-CNTL-OPT.
  4001             20  CF-USER2-OPT-SEQ           PIC 9.
  4002                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4003                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4004             20  CF-USER2-SELECT OCCURS 3 TIMES
  4005                                            PIC X(10).
  4006         16  CF-USER3-CNTL-OPT.
  4007             20  CF-USER3-OPT-SEQ           PIC 9.
  4008                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4009                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4010             20  CF-USER3-SELECT OCCURS 3 TIMES
  4011                                            PIC X(10).
  4012         16  CF-USER4-CNTL-OPT.
  4013             20  CF-USER4-OPT-SEQ           PIC 9.
  4014                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4015                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  71
* NSRASBL.cbl
  4016             20  CF-USER4-SELECT OCCURS 3 TIMES
  4017                                            PIC X(10).
  4018         16  CF-USER5-CNTL-OPT.
  4019             20  CF-USER5-OPT-SEQ           PIC 9.
  4020                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4021                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4022             20  CF-USER5-SELECT OCCURS 3 TIMES
  4023                                            PIC X(10).
  4024         16  CF-REINS-CNTL-OPT.
  4025             20  CF-REINS-OPT-SEQ           PIC 9.
  4026                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4027                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4028             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4029                 24  CF-REINS-PRIME         PIC XXX.
  4030                 24  CF-REINS-SUB           PIC XXX.
  4031
  4032         16  CF-AGENT-CNTL-OPT.
  4033             20  CF-AGENT-OPT-SEQ           PIC 9.
  4034                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4035                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4036             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4037                                            PIC X(10).
  4038
  4039         16  FILLER                         PIC X(43).
  4040
  4041         16  CF-LOSS-RATIO-SELECT.
  4042             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4043             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4044         16  CF-ENTRY-DATE-SELECT.
  4045             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4046             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4047         16  CF-EFFECTIVE-DATE-SELECT.
  4048             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4049             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4050
  4051         16  CF-EXCEPTION-LIST-IND          PIC X.
  4052             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4053
  4054         16  FILLER                         PIC X(318).
  4055
  4056****************************************************************
  4057*                  EXCEPTION REPORTING RECORD                  *
  4058****************************************************************
  4059
  4060     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4061         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4062             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4063
  4064         16  CF-COMBINED-LIFE-AH-OPT.
  4065             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4066             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4067             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4068             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4069
  4070         16  CF-LIFE-OPT.
  4071             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4072             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4073             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  72
* NSRASBL.cbl
  4074             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4075             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4076             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4077             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4078             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4079             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4080             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4081
  4082         16  CF-AH-OPT.
  4083             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4084             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4085             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4086             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4087             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4088             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4089             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4090             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4091             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4092             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4093
  4094         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4095             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4096             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4097             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4098
  4099         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4100
  4101         16  FILLER                         PIC X(673).
  4102
  4103
  4104****************************************************************
  4105*             MORTGAGE SYSTEM PLAN RECORD                      *
  4106****************************************************************
  4107
  4108     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4109         16  CF-PLAN-TYPE                   PIC X.
  4110             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4111             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4112             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4113         16  CF-PLAN-ABBREV                 PIC XXX.
  4114         16  CF-PLAN-DESCRIPT               PIC X(10).
  4115         16  CF-PLAN-NOTES                  PIC X(20).
  4116         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4117         16  CF-PLAN-UNDERWRITING.
  4118             20  CF-PLAN-TERM-DATA.
  4119                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4120                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4121             20  CF-PLAN-AGE-DATA.
  4122                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4123                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4124                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4125             20  CF-PLAN-BENEFIT-DATA.
  4126                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4127                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4128                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4129                                            PIC S9(7)V99  COMP-3.
  4130         16  CF-PLAN-POLICY-FORMS.
  4131             20  CF-POLICY-FORM             PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  73
* NSRASBL.cbl
  4132             20  CF-MASTER-APPLICATION      PIC X(12).
  4133             20  CF-MASTER-POLICY           PIC X(12).
  4134         16  CF-PLAN-RATING.
  4135             20  CF-RATE-CODE               PIC X(5).
  4136             20  CF-SEX-RATING              PIC X.
  4137                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4138                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4139             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4140             20  CF-SUB-STD-TYPE            PIC X.
  4141                 88  CF-PCT-OF-PREM            VALUE '1'.
  4142                 88  CF-PCT-OF-BENE            VALUE '2'.
  4143         16  CF-PLAN-PREM-TOLERANCES.
  4144             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4145             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4146         16  CF-PLAN-PYMT-TOLERANCES.
  4147             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4148             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4149         16  CF-PLAN-MISC-DATA.
  4150             20  FILLER                     PIC X.
  4151             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4152             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4153         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4154         16  CF-PLAN-IND-GRP                PIC X.
  4155             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4156                                                     '1'.
  4157             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4158                                                     '2'.
  4159         16  CF-MIB-SEARCH-SW               PIC X.
  4160             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4161             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4162             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4163             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4164         16  CF-ALPHA-SEARCH-SW             PIC X.
  4165             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4166             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4167             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4168             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4169             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4170             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4171             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4172             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4173             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4174             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4175                                                     'A' 'B' 'C'
  4176                                                     'X' 'Y' 'Z'.
  4177         16  CF-EFF-DT-RULE-SW              PIC X.
  4178             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4179             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4180             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4181             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4182             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4183         16  FILLER                         PIC X(4).
  4184         16  CF-HEALTH-QUESTIONS            PIC X.
  4185             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4186         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4187         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4188         16  CF-PLAN-SNGL-JNT               PIC X.
  4189             88  CF-COMBINED-PLAN              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  74
* NSRASBL.cbl
  4190             88  CF-JNT-PLAN                   VALUE 'J'.
  4191             88  CF-SNGL-PLAN                  VALUE 'S'.
  4192         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4193         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4194         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4195         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4196         16  CF-RERATE-CNTL                 PIC  X.
  4197             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4198             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4199             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4200             88  CF-AUTO-RECALC                 VALUE '4'.
  4201         16  CF-BENEFIT-TYPE                PIC  X.
  4202             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4203             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4204         16  CF-POLICY-FEE                  PIC S999V99
  4205                                                    COMP-3.
  4206         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4207         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4208         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4209         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4210         16  FILLER                         PIC  X(32).
  4211         16  CF-TERMINATION-FORM            PIC  X(04).
  4212         16  FILLER                         PIC  X(08).
  4213         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4214                                                       COMP-3.
  4215         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4216         16  CF-ISSUE-LETTER                PIC  X(4).
  4217         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4218         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4219             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4220             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4221         16  CF-MP-REFUND-CALC              PIC X.
  4222             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4223             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4224             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4225             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4226             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4227             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4228             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4229             88  CF-MP-REFD-MEAN                VALUE '8'.
  4230         16  CF-ALT-RATE-CODE               PIC  X(5).
  4231
  4232
  4233         16  FILLER                         PIC X(498).
  4234****************************************************************
  4235*             MORTGAGE COMPANY MASTER RECORD                   *
  4236****************************************************************
  4237
  4238     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4239         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4240         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4241             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4242             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4243             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4244             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4245             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4246
  4247         16  CF-MORTG-CONVERSION-DATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  75
* NSRASBL.cbl
  4248         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4249         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4250         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4251         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4252
  4253         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4254             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4255         16  CF-MP-RECON-USE-IND            PIC X(1).
  4256             88  CF-MP-USE-RECON             VALUE 'Y'.
  4257         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4258             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4259         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4260             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4261             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4262         16  FILLER                         PIC X(1).
  4263         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4264             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4265         16  CF-MORTG-MIB-VERSION           PIC X.
  4266             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4267             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4268             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4269         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4270             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4271                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4272             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4273                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4274             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4275                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4276             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4277                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4278             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4279                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4280             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4281                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4282         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4283         16  FILLER                         PIC X(7).
  4284         16  CF-MORTG-DESTINATION-SYMBOL.
  4285             20  CF-MORTG-MIB-COMM          PIC X(5).
  4286             20  CF-MORTG-MIB-TERM          PIC X(5).
  4287         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4288             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4289         16  FILLER                         PIC X(03).
  4290         16  CF-MP-CHECK-NO-CONTROL.
  4291             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4292                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4293                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4294                                                ' ' LOW-VALUES.
  4295                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4296                                               VALUE '3'.
  4297         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4298         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4299         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4300             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4301                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4302             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4303                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4304             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4305                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  76
* NSRASBL.cbl
  4306             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4307                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4308             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4309                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4310             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4311                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4312         16  CF-MORTG-BILLING-AREA.
  4313             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4314                                            PIC X.
  4315         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4316         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4317         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4318         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4319             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4320             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4321         16  FILLER                         PIC X.
  4322         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4323             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4324             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4325         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4326         16  FILLER                         PIC X(8).
  4327         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4328         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4329         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4330         16  CF-ACH-COMPANY-ID.
  4331             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4332                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4333                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4334                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4335             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4336         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4337             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4338         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4339             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4340             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4341         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4342         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4343         16  FILLER                         PIC X(536).
  4344
  4345****************************************************************
  4346*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4347****************************************************************
  4348
  4349     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4350         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4351             20  CF-FEMALE-HEIGHT.
  4352                 24  CF-FEMALE-FT           PIC 99.
  4353                 24  CF-FEMALE-IN           PIC 99.
  4354             20  CF-FEMALE-MIN-WT           PIC 999.
  4355             20  CF-FEMALE-MAX-WT           PIC 999.
  4356         16  FILLER                         PIC X(428).
  4357
  4358     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4359         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4360             20  CF-MALE-HEIGHT.
  4361                 24  CF-MALE-FT             PIC 99.
  4362                 24  CF-MALE-IN             PIC 99.
  4363             20  CF-MALE-MIN-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  77
* NSRASBL.cbl
  4364             20  CF-MALE-MAX-WT             PIC 999.
  4365         16  FILLER                         PIC X(428).
  4366******************************************************************
  4367*             AUTOMATIC ACTIVITY RECORD                          *
  4368******************************************************************
  4369     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4370         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4371             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4372             20  CF-SYS-LETTER-ID           PIC X(04).
  4373             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4374             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4375             20  CF-SYS-RESET-SW            PIC X(01).
  4376             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4377             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4378
  4379         16  FILLER                         PIC X(50).
  4380
  4381         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4382             20  CF-USER-ACTIVE-SW          PIC X(01).
  4383             20  CF-USER-LETTER-ID          PIC X(04).
  4384             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4385             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4386             20  CF-USER-RESET-SW           PIC X(01).
  4387             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4388             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4389             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4390
  4391         16  FILLER                         PIC X(246).
  4392*                                COPY NSCASVARS.
  4393******************************************************************
  4394*                   C H A N G E   L O G
  4395*
  4396* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4397*-----------------------------------------------------------------
  4398*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4399* EFFECTIVE    NUMBER
  4400*-----------------------------------------------------------------
  4401* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
  4402* 110612  CR2012101700002  AJRA  ADD NEW FIELDS
  4403******************************************************************
  4404 01 NAPER-OUTPUT-DATA.
  4405    05  F                       PIC X(07) VALUE "LETTER=".
  4406    05  OUT-LETTER              PIC X(06) VALUE SPACES.
  4407    05  F                       PIC X(08) VALUE "~PROCID=".
  4408    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
  4409    05  F                       PIC X(10) VALUE "~PROCNAME=".
  4410    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
  4411    05  F                       PIC X(11) VALUE "~PROCTITLE=".
  4412    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
  4413    05  F                       PIC X(09) VALUE "~CSRNAME=".
  4414    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
  4415    05  F                       PIC X(10) VALUE "~CSRTITLE=".
  4416    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
  4417    05  F                       PIC X(06) VALUE "~CARR=".
  4418    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
  4419    05  F                       PIC X(10) VALUE "~GROUPING=".
  4420    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
  4421    05  F                       PIC X(08) VALUE "~CERTST=".
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  78
* NSRASBL.cbl
  4422    05  OUT-STATE               PIC X(02) VALUE SPACES.
  4423    05  F                       PIC X(09) VALUE "~ACCOUNT=".
  4424    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
  4425    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
  4426    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
  4427    05  F                       PIC X(07) VALUE "~CRTNO=".
  4428    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
  4429    05  F                       PIC X(08) VALUE "~CRTSUF=".
  4430    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
  4431    05  F                       PIC X(08) VALUE "~ILNAME=".
  4432    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
  4433    05  F                       PIC X(08) VALUE "~IFNAME=".
  4434    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
  4435    05  F                       PIC X(08) VALUE "~IFINIT=".
  4436    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
  4437    05  F                       PIC X(08) VALUE "~IMINIT=".
  4438    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
  4439    05  F                       PIC X(09) VALUE "~IISSAGE=".
  4440    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
  4441    05  F                       PIC X(06) VALUE "~ISEX=".
  4442    05  OUT-ISEX                PIC X(01) VALUE SPACES.
  4443    05  F                       PIC X(10) VALUE "~INSADDR1=".
  4444    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
  4445    05  F                       PIC X(10) VALUE "~INSADDR2=".
  4446    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
  4447    05  F                       PIC X(09) VALUE "~INSCITY=".
  4448    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
  4449    05  F                       PIC X(10) VALUE "~INSSTATE=".
  4450    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
  4451    05  F                       PIC X(08) VALUE "~INSZIP=".
  4452    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
  4453    05  F                       PIC X(05) VALUE "~SSN=".
  4454    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
  4455    05  F                       PIC X(07) VALUE "~MEMNO=".
  4456    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
  4457    05  F                       PIC X(08) VALUE "~JLNAME=".
  4458    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
  4459    05  F                       PIC X(08) VALUE "~JFNAME=".
  4460    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
  4461    05  F                       PIC X(08) VALUE "~JMINIT=".
  4462    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
  4463    05  F                       PIC X(08) VALUE "~JNTAGE=".
  4464    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
  4465    05  F                       PIC X(10) VALUE "~ACCTNAME=".
  4466    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
  4467    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
  4468    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
  4469    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
  4470    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
  4471    05  F                       PIC X(10) VALUE "~ACCTCITY=".
  4472    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
  4473    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
  4474    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
  4475    05  F                       PIC X(09) VALUE "~ACCTZIP=".
  4476    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
  4477    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
  4478    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
  4479    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  79
* NSRASBL.cbl
  4480    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
  4481    05  F                       PIC X(09) VALUE "~BUSTYPE=".
  4482    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
  4483    05  F                       PIC X(10) VALUE "~BENENAME=".
  4484    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
  4485    05  F                       PIC X(11) VALUE "~BENEADDR1=".
  4486    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
  4487    05  F                       PIC X(11) VALUE "~BENEADDR2=".
  4488    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
  4489    05  F                       PIC X(10) VALUE "~BENECITY=".
  4490    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
  4491    05  F                       PIC X(11) VALUE "~BENESTATE=".
  4492    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
  4493    05  F                       PIC X(09) VALUE "~BENEZIP=".
  4494    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
  4495    05  F                       PIC X(10) VALUE "~CARRNAME=".
  4496    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
  4497    05  F                       PIC X(08) VALUE "~RESPNO=".
  4498    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
  4499    05  F                       PIC X(12) VALUE "~COACCTNAME=".
  4500    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
  4501    05  F                       PIC X(12) VALUE "~COMAILNAME=".
  4502    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
  4503    05  F                       PIC X(11) VALUE "~COMPADDR1=".
  4504    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
  4505    05  F                       PIC X(11) VALUE "~COMPADDR2=".
  4506    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
  4507    05  F                       PIC X(10) VALUE "~COMPCITY=".
  4508    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
  4509    05  F                       PIC X(11) VALUE "~COMPSTATE=".
  4510    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
  4511    05  F                       PIC X(09) VALUE "~COMPZIP=".
  4512    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
  4513    05  F                       PIC X(11) VALUE "~COMPPHONE=".
  4514    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
  4515    05  F                       PIC X(09) VALUE "~COMPFAX=".
  4516    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
  4517    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
  4518    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
  4519    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
  4520    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
  4521    05  F                       PIC X(08) VALUE "~RPTCD1=".
  4522    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
  4523    05  F                       PIC X(08) VALUE "~RPTCD2=".
  4524    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
  4525    05  F                       PIC X(09) VALUE "~ENTRYDT=".
  4526    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
  4527    05  F                       PIC X(07) VALUE "~BATCH=".
  4528    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
  4529    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
  4530    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
  4531    05  F                       PIC X(10) VALUE "~1STPMTDT=".
  4532    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
  4533    05  F                       PIC X(05) VALUE "~APR=".
  4534    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
  4535    05  F                       PIC X(08) VALUE "~LNTERM=".
  4536    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
  4537    05  F                       PIC X(11) VALUE "~RATECLASS=".
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  80
* NSRASBL.cbl
  4538    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
  4539    05  F                       PIC X(09) VALUE "~EXTDAYS=".
  4540    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
  4541    05  F                       PIC X(09) VALUE "~CSRCODE=".
  4542    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
  4543    05  F                       PIC X(07) VALUE "~UCODE=".
  4544    05  OUT-UCODE               PIC X(01) VALUE SPACES.
  4545    05  F                       PIC X(10) VALUE "~PREMTYPE=".
  4546    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
  4547    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
  4548    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
  4549    05  F                       PIC X(06) VALUE "~SKIP=".
  4550    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
  4551    05  F                       PIC X(06) VALUE "~MODE=".
  4552    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
  4553    05  F                       PIC X(09) VALUE "~LOANOFF=".
  4554    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
  4555    05  F                       PIC X(06) VALUE "~RTBL=".
  4556    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
  4557    05  F                       PIC X(10) VALUE "~SPECREIN=".
  4558    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
  4559    05  F                       PIC X(09) VALUE "~LFBENCD=".
  4560    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
  4561    05  F                       PIC X(08) VALUE "~LFTERM=".
  4562    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
  4563    05  F                       PIC X(07) VALUE "~LFDEV=".
  4564    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
  4565    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
  4566    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
  4567    05  F                       PIC X(07) VALUE "~LFBEN=".
  4568    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
  4569    05  F                       PIC X(08) VALUE "~LFPREM=".
  4570    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4571    05  F                       PIC X(08) VALUE "~LFABEN=".
  4572    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4573    05  F                       PIC X(09) VALUE "~LFAPREM=".
  4574    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
  4575    05  F                       PIC X(07) VALUE "~LFNSP=".
  4576    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4577    05  F                       PIC X(08) VALUE "~LFRBEN=".
  4578    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4579    05  F                       PIC X(07) VALUE "~LFCAN=".
  4580    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4581    05  F                       PIC X(07) VALUE "~LFDTH=".
  4582    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
  4583    05  F                       PIC X(08) VALUE "~LFRATE=".
  4584    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4585    05  F                       PIC X(09) VALUE "~LFARATE=".
  4586    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
  4587    05  F                       PIC X(09) VALUE "~LFEXPDT=".
  4588    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
  4589    05  F                       PIC X(08) VALUE "~LFSTAT=".
  4590    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
  4591    05  F                       PIC X(09) VALUE "~LFCANDT=".
  4592    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
  4593    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
  4594    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4595    05  F                       PIC X(07) VALUE "~DTHDT=".
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  81
* NSRASBL.cbl
  4596    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
  4597    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
  4598    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
  4599    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
  4600    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4601    05  F                       PIC X(08) VALUE "~LFCOMM=".
  4602    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4603    05  F                       PIC X(11) VALUE "~LFBENDESC=".
  4604    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
  4605    05  F                       PIC X(11) VALUE "~LFBENABRV=".
  4606    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
  4607    05  F                       PIC X(09) VALUE "~AHBENCD=".
  4608    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
  4609    05  F                       PIC X(08) VALUE "~AHTERM=".
  4610    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
  4611    05  F                       PIC X(11) VALUE "~AHCRITPER=".
  4612    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
  4613    05  F                       PIC X(09) VALUE "~AHDEVCD=".
  4614    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
  4615    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
  4616    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
  4617    05  F                       PIC X(07) VALUE "~AHBEN=".
  4618    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
  4619    05  F                       PIC X(08) VALUE "~AHPREM=".
  4620    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4621    05  F                       PIC X(07) VALUE "~AHNSP=".
  4622    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4623    05  F                       PIC X(07) VALUE "~AHCAN=".
  4624    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4625    05  F                       PIC X(10) VALUE "~AHITDPMT=".
  4626    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
  4627    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
  4628    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4629    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
  4630    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
  4631    05  F                       PIC X(08) VALUE "~AHRATE=".
  4632    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4633    05  F                       PIC X(09) VALUE "~AHEXPDT=".
  4634    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
  4635    05  F                       PIC X(08) VALUE "~AHSTAT=".
  4636    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
  4637    05  F                       PIC X(09) VALUE "~AHCANDT=".
  4638    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
  4639    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
  4640    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4641    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
  4642    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4643    05  F                       PIC X(08) VALUE "~AHCOMM=".
  4644    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4645    05  F                       PIC X(11) VALUE "~AHBENDESC=".
  4646    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
  4647    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
  4648    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
  4649    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
  4650    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
  4651    05  F                       PIC X(08) VALUE "~AHWAIT=".
  4652    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
  4653    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  82
* NSRASBL.cbl
  4654    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
  4655    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
  4656                                PIC X(2).
  4657    05  F                       PIC X(09) VALUE "~TOTPREM=".
  4658    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
  4659    05  F                       PIC X(08) VALUE "~TOTREF=".
  4660    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
  4661    05  F                       PIC X(08) VALUE "~SEXPDT=".
  4662    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
  4663    05  F                       PIC X(07) VALUE "~STERM=".
  4664    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
  4665    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
  4666    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
  4667    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
  4668    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
  4669    05  F                       PIC X(11) VALUE "~IORIGINIT=".
  4670    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
  4671    05  F                       PIC X(10) VALUE "~IORIGAGE=".
  4672    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
  4673    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
  4674    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
  4675    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
  4676    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
  4677    05  F                       PIC X(11) VALUE "~JORIGINIT=".
  4678    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
  4679    05  F                       PIC X(10) VALUE "~JORIGAGE=".
  4680    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
  4681    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
  4682    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
  4683    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
  4684    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
  4685    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
  4686    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
  4687    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
  4688                                PIC X(12).
  4689    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
  4690    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
  4691    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
  4692                                PIC X(12).
  4693    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
  4694    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
  4695    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
  4696    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
  4697    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
  4698    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4699    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
  4700    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
  4701    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
  4702                                PIC X(12).
  4703    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
  4704    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
  4705    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
  4706                                PIC X(10).
  4707    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
  4708    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
  4709    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
  4710    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
  4711    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  83
* NSRASBL.cbl
  4712    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
  4713    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
  4714    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
  4715    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
  4716    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
  4717    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
  4718    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
  4719    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
  4720                                PIC X(10).
  4721    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
  4722    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
  4723    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
  4724                                PIC X(10).
  4725    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
  4726    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
  4727    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
  4728    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
  4729    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
  4730    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4731    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
  4732    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
  4733    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
  4734    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
  4735    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
  4736    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
  4737    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
  4738    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
  4739    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
  4740    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
  4741    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
  4742    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
  4743    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
  4744                                PIC X(2).
  4745    05  F                       PIC X(09) VALUE "~OSEXPDT=".
  4746    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
  4747    05  F                       PIC X(08) VALUE "~OSTERM=".
  4748    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
  4749    05  F                       PIC X(11) VALUE "~INEWLNAME=".
  4750    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
  4751    05  F                       PIC X(11) VALUE "~INEWFNAME=".
  4752    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
  4753    05  F                       PIC X(10) VALUE "~INEWINIT=".
  4754    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
  4755    05  F                       PIC X(09) VALUE "~INEWAGE=".
  4756    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
  4757    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
  4758                                PIC X(09).
  4759    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
  4760    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
  4761    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
  4762    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
  4763    05  F                       PIC X(10) VALUE "~JNEWINIT=".
  4764    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
  4765    05  F                       PIC X(09) VALUE "~JNEWAGE=".
  4766    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
  4767    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
  4768                                PIC X(09).
  4769    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  84
* NSRASBL.cbl
  4770    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
  4771    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
  4772    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
  4773    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
  4774                                PIC X(09).
  4775    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
  4776    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
  4777    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
  4778                                PIC X(12).
  4779    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
  4780    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
  4781    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
  4782                                PIC X(10).
  4783    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
  4784    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
  4785    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
  4786    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
  4787    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
  4788                                PIC X(12).
  4789    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
  4790    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
  4791    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
  4792                                PIC X(10).
  4793    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
  4794    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
  4795    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
  4796    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
  4797    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
  4798    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
  4799    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
  4800    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
  4801    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
  4802                                PIC X(09).
  4803    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
  4804    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
  4805    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
  4806                                PIC X(09).
  4807    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
  4808    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
  4809    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
  4810                                PIC X(10).
  4811    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
  4812    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
  4813    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
  4814                                PIC X(10).
  4815    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
  4816    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
  4817    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
  4818    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
  4819    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
  4820    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
  4821    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
  4822    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
  4823    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
  4824    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
  4825    05  F                       PIC X(09) VALUE "~NEWWAIT=".
  4826    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
  4827    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  85
* NSRASBL.cbl
  4828    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
  4829    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
  4830                                PIC X(09).
  4831    05  F                       PIC X(09) VALUE "~NSEXPDT=".
  4832    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
  4833    05  F                       PIC X(08) VALUE "~NSTERM=".
  4834    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
  4835    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
  4836                                PIC X(09).
  4837    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
  4838    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
  4839    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
  4840    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
  4841    05  F                       PIC X(11) VALUE "~PAYABLETO=".
  4842    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
  4843    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
  4844    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
  4845    05  F                       PIC X(09) VALUE "~BALLOON=".
  4846    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
  4847    05  F                       PIC X(10) VALUE "~LEASEIND=".
  4848    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
  4849    05  F                       PIC X(09) VALUE "~RESCIND=".
  4850    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
  4851    05  F                       PIC X(07) VALUE "~RCD01=".
  4852    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
  4853    05  F                       PIC X(07) VALUE "~RCD02=".
  4854    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
  4855    05  F                       PIC X(07) VALUE "~RCD03=".
  4856    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
  4857    05  F                       PIC X(07) VALUE "~RCD04=".
  4858    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
  4859    05  F                       PIC X(07) VALUE "~RCD05=".
  4860    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
  4861    05  F                       PIC X(07) VALUE "~RCD06=".
  4862    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
  4863    05  F                       PIC X(07) VALUE "~RCD07=".
  4864    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
  4865    05  F                       PIC X(07) VALUE "~RCD08=".
  4866    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
  4867    05  F                       PIC X(07) VALUE "~RCD09=".
  4868    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
  4869    05  F                       PIC X(07) VALUE "~RCD10=".
  4870    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
  4871    05  F                       PIC X(07) VALUE "~RCD11=".
  4872    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
  4873    05  F                       PIC X(07) VALUE "~RCD12=".
  4874    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
  4875    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
  4876    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
  4877    05  F                       PIC X(08) VALUE "~ARCHNO=".
  4878    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
  4879    05  F                       PIC X(06) VALUE "~FORM=".
  4880    05  OUT-FORM                PIC X(03) VALUE SPACES.
  4881    05  F                       PIC X(09) VALUE "~ENCLINE=".
  4882    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
  4883    05  F                       PIC X(08) VALUE "~ATTACH=".
  4884    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
  4885    05  F                       PIC X(10) VALUE "~OUTSTACK=".
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  86
* NSRASBL.cbl
  4886    05  OUT-STACK               PIC X(10) VALUE SPACES.
  4887    05  F                       PIC X(11) VALUE "~STATENAME=".
  4888    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
  4889    05  F                       PIC X(08) VALUE "~PRTNOW=".
  4890    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
  4891    05  F                       PIC X(05) VALUE "~NCB=".
  4892    05  OUT-CHGBACK             PIC X     VALUE ' '.
  4893    05  F                       PIC X(8) VALUE "~CSOAMT=".
  4894    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
  4895    05  F                       PIC X(9) VALUE "~ACCTAMT=".
  4896    05  OUT-ACCT-PORTION        PIC 9(7).99 VALUE ZEROS.
  4897    05  F                       PIC X(09) VALUE "~LETRTYP=".
  4898    05  OUT-LETTER-TYPE         PIC X(01) VALUE SPACES.
  4899    05  F                       PIC X(10) VALUE "~PRNTCERT=".
  4900    05  OUT-PRINT-CERTIFICATE   PIC X(01) VALUE SPACES.
  4901    05  F                       PIC X(08) VALUE "~INSBDT=".
  4902    05  OUT-INS-BIRTHDATE       PIC X(21) VALUE SPACES.
  4903    05  F                       PIC X(08) VALUE "~JNTBDT=".
  4904    05  OUT-JNT-BIRTHDATE       PIC X(21) VALUE SPACES.
  4905    05  F                       PIC X(08) VALUE "~TOTINT=".
  4906    05  OUT-TOT-INTEREST        PIC 9(7).99 VALUE ZEROS.
  4907    05  F                       PIC X(8) VALUE "~TOPREM=".
  4908    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
  4909    05  F                       PIC X(7) VALUE "~TOREF=".
  4910    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
  4911    05  F                       PIC X(7) VALUE "~CANDT=".
  4912    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
  4913    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
  4914    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
  4915    05  F                       PIC X(08) VALUE "~CERTID=".
  4916    05  OUT-CERTIFICATE-ID      PIC X(5)  VALUE SPACES.
  4917    05  F                       PIC X(08) VALUE "~UNDWID=".
  4918    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
  4919    05  F                       PIC X(8) VALUE "~TNPREM=".
  4920    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
  4921    05  F                       PIC X(7) VALUE "~TNREF=".
  4922    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
  4923    05  F                       PIC X(8)  VALUE "~COVIND=".
  4924    05  OUT-COVERAGE-IND        PIC X(4)  VALUE SPACES.
  4925    05  F                       PIC X(9)  VALUE "~OCOVIND=".
  4926    05  OUT-ORIG-COVERAGE-IND   PIC X(4)  VALUE SPACES.
  4927    05  F                       PIC X(9)  VALUE "~NCOVIND=".
  4928    05  OUT-NEW-COVERAGE-IND    PIC X(4)  VALUE SPACES.
  4929    05  F                       PIC X(10) VALUE "~LFCMBPRM=".
  4930    05  OUT-LF-CMB-PREM         PIC 9(7).99 VALUE ZEROS.
  4931    05  F                       PIC X(11) VALUE "~LFOCMBPRM=".
  4932    05  OUT-ORIG-LF-CMB-PREM    PIC 9(7).99 VALUE ZEROS.
  4933    05  F                       PIC X(11) VALUE "~LFNCMBPRM=".
  4934    05  OUT-NEW-LF-CMB-PREM     PIC 9(7).99 VALUE ZEROS.
  4935    05  OUT-NEW-LF-CMB-PREM-A REDEFINES OUT-NEW-LF-CMB-PREM
  4936                                PIC X(10).
  4937    05  F                       PIC X(11) VALUE "~LFPREMCHG=".
  4938    05  OUT-LF-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  4939    05  F                       PIC X(11) VALUE "~LFAPRMCHG=".
  4940    05  OUT-LF-ALT-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  4941    05  F                       PIC X(11) VALUE "~LFCPRMCHG=".
  4942    05  OUT-LF-CMB-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  4943    05  F                       PIC X(11) VALUE "~AHPREMCHG=".
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  87
* NSRASBL.cbl
  4944    05  OUT-AH-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  4945    05  F                       PIC X(10) VALUE "~LFREFCHG=".
  4946    05  OUT-LF-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  4947    05  F                       PIC X(10) VALUE "~AHREFCHG=".
  4948    05  OUT-AH-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  4949    05  F                       PIC X(11) VALUE "~ACCTLFAMT=".
  4950    05  OUT-ACCT-LF-PORTION     PIC 9(7).99 VALUE ZEROS.
  4951    05  F                       PIC X(11) VALUE "~ACTALFAMT=".
  4952    05  OUT-ACCT-ALT-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4953    05  F                       PIC X(11) VALUE "~ACTCLFAMT=".
  4954    05  OUT-ACCT-CMB-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4955    05  F                       PIC X(11) VALUE "~ACCTAHAMT=".
  4956    05  OUT-ACCT-AH-PORTION     PIC 9(7).99 VALUE ZEROS.
  4957    05  F                       PIC X(10) VALUE "~CSOLFAMT=".
  4958    05  OUT-CSO-LF-PORTION      PIC 9(7).99 VALUE ZEROS.
  4959    05  F                       PIC X(11) VALUE "~CSOALFAMT=".
  4960    05  OUT-CSO-ALT-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  4961    05  F                       PIC X(11) VALUE "~CSOCLFAMT=".
  4962    05  OUT-CSO-CMB-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  4963    05  F                       PIC X(10) VALUE "~CSOAHAMT=".
  4964    05  OUT-CSO-AH-PORTION      PIC 9(7).99 VALUE ZEROS.
  4965    05  F                       PIC X(11) VALUE "~ACTOLFAMT=".
  4966    05  OUT-ACCT-ORIG-LF-PORT   PIC 9(7).99 VALUE ZEROS.
  4967    05  F                       PIC X(12) VALUE "~ACTOALFAMT=".
  4968    05  OUT-ACCT-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4969    05  F                       PIC X(12) VALUE "~ACTOCLFAMT=".
  4970    05  OUT-ACCT-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4971    05  F                       PIC X(11) VALUE "~ACTOAHAMT=".
  4972    05  OUT-ACCT-ORIG-AH-PORT   PIC 9(7).99 VALUE ZEROS.
  4973    05  F                       PIC X(10) VALUE "~ACCTOAMT=".
  4974    05  OUT-ACCT-ORIG-PORTION   PIC 9(7).99 VALUE ZEROS.
  4975    05  F                       PIC X(11) VALUE "~CSOOLFAMT=".
  4976    05  OUT-CSO-ORIG-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4977    05  F                       PIC X(12) VALUE "~CSOOALFAMT=".
  4978    05  OUT-CSO-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4979    05  F                       PIC X(12) VALUE "~CSOOCLFAMT=".
  4980    05  OUT-CSO-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4981    05  F                       PIC X(11) VALUE "~CSOOAHAMT=".
  4982    05  OUT-CSO-ORIG-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  4983    05  F                       PIC X(09) VALUE "~CSOOAMT=".
  4984    05  OUT-CSO-ORIG-PORTION    PIC 9(7).99 VALUE ZEROS.
  4985    05  F                       PIC X(11) VALUE "~ACTNLFAMT=".
  4986    05  OUT-ACCT-NEW-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4987    05  F                       PIC X(12) VALUE "~ACTNALFAMT=".
  4988    05  OUT-ACCT-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4989    05  F                       PIC X(12) VALUE "~ACTNCLFAMT=".
  4990    05  OUT-ACCT-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4991    05  F                       PIC X(11) VALUE "~ACTNAHAMT=".
  4992    05  OUT-ACCT-NEW-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  4993    05  F                       PIC X(10) VALUE "~ACCTNAMT=".
  4994    05  OUT-ACCT-NEW-PORTION    PIC 9(7).99 VALUE ZEROS.
  4995    05  F                       PIC X(11) VALUE "~CSONLFAMT=".
  4996    05  OUT-CSO-NEW-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  4997    05  F                       PIC X(12) VALUE "~CSONALFAMT=".
  4998    05  OUT-CSO-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4999    05  F                       PIC X(12) VALUE "~CSONCLFAMT=".
  5000    05  OUT-CSO-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5001    05  F                       PIC X(11) VALUE "~CSONAHAMT=".
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  88
* NSRASBL.cbl
  5002    05  OUT-CSO-NEW-AH-PORT     PIC 9(7).99 VALUE ZEROS.
  5003    05  F                       PIC X(09) VALUE "~CSONAMT=".
  5004    05  OUT-CSO-NEW-PORTION     PIC 9(7).99 VALUE ZEROS.
  5005    05  F                       PIC X(10) VALUE "~ACTLFCHG=".
  5006    05  OUT-ACCT-LF-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5007    05  F                       PIC X(11) VALUE "~ACTALFCHG=".
  5008    05  OUT-ACCT-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5009    05  F                       PIC X(11) VALUE "~ACTCLFCHG=".
  5010    05  OUT-ACCT-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5011    05  F                       PIC X(10) VALUE "~ACTAHCHG=".
  5012    05  OUT-ACCT-AH-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5013    05  F                       PIC X(09) VALUE "~ACCTCHG=".
  5014    05  OUT-ACCT-PORTION-CHG    PIC 9(7).99 VALUE ZEROS.
  5015    05  F                       PIC X(10) VALUE "~CSOLFCHG=".
  5016    05  OUT-CSO-LF-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5017    05  F                       PIC X(11) VALUE "~CSOALFCHG=".
  5018    05  OUT-CSO-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5019    05  F                       PIC X(11) VALUE "~CSOCLFCHG=".
  5020    05  OUT-CSO-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5021    05  F                       PIC X(10) VALUE "~CSOAHCHG=".
  5022    05  OUT-CSO-AH-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5023    05  F                       PIC X(08) VALUE "~CSOCHG=".
  5024    05  OUT-CSO-PORTION-CHG     PIC 9(7).99 VALUE ZEROS.
  5025    05  F                       PIC X(10) VALUE "~LFOCANDT=".
  5026    05  OUT-ORIG-LF-CAN-DT      PIC X(21) VALUE SPACES.
  5027    05  F                       PIC X(10) VALUE "~LFNCANDT=".
  5028    05  OUT-NEW-LF-CAN-DT       PIC X(21) VALUE SPACES.
  5029    05  F                       PIC X(10) VALUE "~AHOCANDT=".
  5030    05  OUT-ORIG-AH-CAN-DT      PIC X(21) VALUE SPACES.
  5031    05  F                       PIC X(10) VALUE "~AHNCANDT=".
  5032    05  OUT-NEW-AH-CAN-DT       PIC X(21) VALUE SPACES.
  5033    05  F                       PIC X(11) VALUE "~ORIGCANDT=".
  5034    05  OUT-ORIG-CAN-DT         PIC X(21) VALUE SPACES.
  5035    05  F                       PIC X(10) VALUE "~NEWCANDT=".
  5036    05  OUT-NEW-CAN-DT          PIC X(21) VALUE SPACES.
  5037    05  F                       PIC X(8)  VALUE "~SCREEN=".
  5038    05  OUT-SCREEN-ID           PIC X(8)  VALUE SPACES.
  5039    05  F                       PIC X(11) VALUE 'EndOfString'.
  5040    05  f                       pic x(12) value spaces.
  5041*                                COPY ERCARCH.
  5042******************************************************************
  5043*                                                                *
  5044*                            ERCARCH.                            *
  5045*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5046*                            VMOD=2.002                          *
  5047*                                                                *
  5048*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5049*                                                                *
  5050*   FILE TYPE = VSAM,KSDS                                        *
  5051*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5052*                                                                *
  5053*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5054*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5055*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5056*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5057*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5058*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5059*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  89
* NSRASBL.cbl
  5060*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5061******************************************************************
  5062*                   C H A N G E   L O G
  5063*
  5064* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5065*-----------------------------------------------------------------
  5066*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5067* EFFECTIVE    NUMBER
  5068*-----------------------------------------------------------------
  5069* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5070* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5071* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5072******************************************************************
  5073 01  LETTER-ARCHIVE.
  5074     12  LA-RECORD-ID                PIC  X(02).
  5075         88  LA-VALID-ID                VALUE 'LA'.
  5076
  5077     12  LA-CONTROL-PRIMARY.
  5078         16  LA-COMPANY-CD           PIC  X(01).
  5079         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5080
  5081     12  LA-CONTROL-BY-CERT-RESP.
  5082         16  LA-COMPANY-CD-A2        PIC  X(01).
  5083         16  LA-CERT-NO-A2.
  5084             20  LA-CERT-PRIME-A2    PIC  X(10).
  5085             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5086         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5087             20  LA-RESP-PERSON-A2   PIC  X(10).
  5088             20  LA-TYPE-A2          PIC  X(01).
  5089         16  LA-CARRIER-A2           PIC  X(01).
  5090         16  LA-GROUPING-A2          PIC  X(06).
  5091         16  LA-STATE-A2             PIC  X(02).
  5092         16  LA-ACCOUNT-A2           PIC  X(10).
  5093         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5094         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5095
  5096     12  LA-CONTROL-BY-FORM.
  5097         16  LA-COMPANY-CD-A3        PIC  X(01).
  5098         16  LA-FORM-A3              PIC  X(04).
  5099         16  LA-CARRIER-A3           PIC  X(01).
  5100         16  LA-GROUPING-A3          PIC  X(06).
  5101         16  LA-STATE-A3             PIC  X(02).
  5102         16  LA-ACCOUNT-A3           PIC  X(10).
  5103         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5104
  5105     12  LA-CONTROL-BY-PROCESSOR.
  5106         16  LA-COMPANY-CD-A4        PIC  X(01).
  5107         16  LA-PROCESSOR-CD         PIC  X(04).
  5108         16  LA-CARRIER-A4           PIC  X(01).
  5109         16  LA-GROUPING-A4          PIC  X(06).
  5110         16  LA-STATE-A4             PIC  X(02).
  5111         16  LA-ACCOUNT-A4           PIC  X(10).
  5112         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5113
  5114     12  LA-CONTROL-BY-KEY-FIELDS.
  5115         16  LA-COMPANY-CD-A5        PIC  X(01).
  5116         16  LA-CARRIER-A5           PIC  X(01).
  5117         16  LA-GROUPING-A5          PIC  X(06).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  90
* NSRASBL.cbl
  5118         16  LA-STATE-A5             PIC  X(02).
  5119         16  LA-ACCOUNT-A5           PIC  X(10).
  5120         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5121
  5122     12  LA-CONTROL-BY-GROUP-CODE.
  5123         16  LA-COMPANY-CD-A6        PIC  X(01).
  5124         16  LA-ENTRY-A6.
  5125             20  LA-FILLER           PIC  X(02).
  5126             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5127         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5128
  5129     12  FILLER                      PIC  X(09).
  5130
  5131     12  LA-HEADER-RECORD.
  5132         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5133         16  LA-CREATION-DATE        PIC  X(02).
  5134         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5135         16  LA-FINAL-ACT-DATE       REDEFINES
  5136               LA-FOLLOW-UP-DATE     PIC  X(02).
  5137         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5138         16  LA-NO-OF-COPIES         PIC S9(01).
  5139         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5140         16  LA-REPLY-DATE           PIC  X(02).
  5141         16  LA-RESEND-DATES.
  5142             20  LA-RESEND-DATE      PIC  X(02).
  5143             20  LA-SENT-DATE        PIC  X(02).
  5144             20  FILLER              PIC  X(08).
  5145         16  LA-SOURCE-INFORMATION.
  5146             20  LA-DATA-SOURCE      PIC  X(01).
  5147             20  LA-ADDR-SOURCE      PIC  X(01).
  5148         16  LA-STATUS               PIC  X(01).
  5149             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5150             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5151             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5152             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5153             88  LA-STATUS-PURGED         VALUE 'P'.
  5154             88  LA-STATUS-VOIDED         VALUE 'V'.
  5155         16  LA-LAST-RESENT-PRINT-DATE
  5156                                     PIC  X(02).
  5157         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5158             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5159                                          VALUE 'C'.
  5160             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5161                                          VALUE 'F'.
  5162             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5163                                          VALUE 'P'.
  5164         16  LA-PURGED-DATE          PIC  X(02).
  5165         16  LA-VOIDED-DATE          PIC  X(02).
  5166         16  LA-RESEND-LETR          PIC  X(4).
  5167         16  FILLER                  PIC  X(08).
  5168*        16  LA-RESEND-LETR-2        PIC  X(4).
  5169*        16  LA-RESEND-LETR-3        PIC  X(4).
  5170*        16  FILLER                  PIC  X(59).
  5171         16  LA-ARCHIVE-STATUS       PIC  X.
  5172             88  LA-TEMP                VALUE 'T'.
  5173             88  LA-QWS                 VALUE 'Q'.
  5174             88  LA-BATCH               VALUE 'B'.
  5175         16  LA-FINAL-ACT-IND        PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  91
* NSRASBL.cbl
  5176         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5177         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5178         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5179                                     PIC X(4).
  5180         16  FILLER                  PIC  X(42).
  5181*        16  FILLER                  PIC  X(71).
  5182         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5183         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5184         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5185                                     PIC  X(4).
  5186         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5187
  5188******************************************************************
  5189*                                COPY ELCCRTT.
  5190******************************************************************
  5191*                                                                *
  5192*                            ELCCRTT.                            *
  5193*                                                                *
  5194*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5195*                                                                *
  5196*   FILE TYPE = VSAM,KSDS                                        *
  5197*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5198*                                                                *
  5199*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5200*                                                                *
  5201*   LOG = YES                                                    *
  5202*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5203******************************************************************
  5204*                   C H A N G E   L O G
  5205*
  5206* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5207*-----------------------------------------------------------------
  5208*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5209* EFFECTIVE    NUMBER
  5210*-----------------------------------------------------------------
  5211* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5212* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5213* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5214* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5215******************************************************************
  5216
  5217 01  CERTIFICATE-TRAILERS.
  5218     12  CS-RECORD-ID                      PIC XX.
  5219         88  VALID-CS-ID                      VALUE 'CS'.
  5220
  5221     12  CS-CONTROL-PRIMARY.
  5222         16  CS-COMPANY-CD                 PIC X.
  5223         16  CS-CARRIER                    PIC X.
  5224         16  CS-GROUPING                   PIC X(6).
  5225         16  CS-STATE                      PIC XX.
  5226         16  CS-ACCOUNT                    PIC X(10).
  5227         16  CS-CERT-EFF-DT                PIC XX.
  5228         16  CS-CERT-NO.
  5229             20  CS-CERT-PRIME             PIC X(10).
  5230             20  CS-CERT-SFX               PIC X.
  5231         16  CS-TRAILER-TYPE               PIC X.
  5232             88  COMM-TRLR           VALUE 'A'.
  5233             88  FUTURE-TRLR         VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  92
* NSRASBL.cbl
  5234             88  CERT-DATA-TRLR      VALUE 'C'.
  5235
  5236     12  CS-DATA-AREA                      PIC X(516).
  5237
  5238     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5239         16  CS-BANK-COMMISSION-AREA.
  5240             20  CS-BANK-COMMS       OCCURS 10.
  5241                 24  CS-AGT                PIC X(10).
  5242                 24  CS-COM-TYP            PIC X.
  5243                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5244                 24  CS-RECALC-LV-INDIC    PIC X.
  5245                 24  FILLER                PIC X(10).
  5246         16  FILLER                        PIC X(256).
  5247
  5248     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5249         16  CS-VIN-NUMBER                 PIC X(17).
  5250         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5251         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5252         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5253         16  FILLER                        PIC X(496).
  5254******************************************************************
  5255 01  FILLER                      PIC X(500)  VALUE SPACES.
  5256*                                COPY ELCENCC.
  5257******************************************************************
  5258*                                                                *
  5259*                                                                *
  5260*                            ELCENCC                             *
  5261*                            VMOD=2.001                          *
  5262*                                                                *
  5263*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5264*                                                                *
  5265*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5266*   A NAPERSOFT DOCUMENT                                         *
  5267*                                                                *
  5268*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5269*                                                                *
  5270*   FILE TYPE = VSAM,KSDS                                        *
  5271*   RECORD SIZE = 400   RECFORM = FIX                            *
  5272*                                                                *
  5273*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5274*                                                                *
  5275*   LOG = NO                                                     *
  5276*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5277*                                                                *
  5278*                                                                *
  5279******************************************************************
  5280*                   C H A N G E   L O G
  5281*
  5282* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5283*-----------------------------------------------------------------
  5284*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5285* EFFECTIVE    NUMBER
  5286*-----------------------------------------------------------------
  5287* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5288******************************************************************
  5289 01  ENCLOSURE-CODES.
  5290     12  NC-RECORD-ID                      PIC XX.
  5291         88  VALID-NC-ID                      VALUE 'NC'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  93
* NSRASBL.cbl
  5292     12  NC-CONTROL-PRIMARY.
  5293         16  NC-COMPANY-CD                 PIC X.
  5294         16  NC-REC-TYPE                   PIC X.
  5295             88  NC-CLAIMS                   VALUE '1'.
  5296             88  NC-ADMIN                    VALUE '2'.
  5297         16  NC-ENC-CODE                   PIC X(5).
  5298         16  FILLER                        PIC X(09).
  5299     12  NC-MAINT-INFORMATION.
  5300         16  NC-LAST-MAINT-DT              PIC XX.
  5301         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5302         16  NC-LAST-MAINT-USER            PIC X(4).
  5303         16  FILLER                        PIC XX.
  5304     12  NC-OUTPUT-STACK                   PIC XXX.
  5305     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5306     12  NC-ATTACHMENTS                    PIC X(100).
  5307     12  NC-FUTURE                         PIC X(50).
  5308     12  FILLER                            PIC X(117).
  5309******************************************************************
  5310****************************************************************
  5311*
  5312* Copyright (c) 2007 by Clerity Solutions, Inc.
  5313* All rights reserved.
  5314*
  5315****************************************************************
  5316 01  DFHEIV.
  5317   02  DFHEIV0               PIC X(35).
  5318   02  DFHEIV1               PIC X(08).
  5319   02  DFHEIV2               PIC X(08).
  5320   02  DFHEIV3               PIC X(08).
  5321   02  DFHEIV4               PIC X(06).
  5322   02  DFHEIV5               PIC X(04).
  5323   02  DFHEIV6               PIC X(04).
  5324   02  DFHEIV7               PIC X(02).
  5325   02  DFHEIV8               PIC X(02).
  5326   02  DFHEIV9               PIC X(01).
  5327   02  DFHEIV10              PIC S9(7) COMP-3.
  5328   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5329   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5330   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5331   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5332   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5333   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5334   02  DFHEIV17              PIC X(04).
  5335   02  DFHEIV18              PIC X(04).
  5336   02  DFHEIV19              PIC X(04).
  5337   02  DFHEIV20              USAGE IS POINTER.
  5338   02  DFHEIV21              USAGE IS POINTER.
  5339   02  DFHEIV22              USAGE IS POINTER.
  5340   02  DFHEIV23              USAGE IS POINTER.
  5341   02  DFHEIV24              USAGE IS POINTER.
  5342   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5343   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5344   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5345   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5346   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5347   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5348   02  FILLER                PIC X(02).
  5349   02  DFHEIV99              PIC X(08) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  94
* NSRASBL.cbl
  5350   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5351   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5352   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5353   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5354 LINKAGE  SECTION.
  5355*****************************************************************
  5356*                                                               *
  5357* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5358* All rights reserved.                                          *
  5359*                                                               *
  5360*****************************************************************
  5361 01  dfheiblk.
  5362     02  eibtime          pic s9(7) comp-3.
  5363     02  eibdate          pic s9(7) comp-3.
  5364     02  eibtrnid         pic x(4).
  5365     02  eibtaskn         pic s9(7) comp-3.
  5366     02  eibtrmid         pic x(4).
  5367     02  dfheigdi         pic s9(4) comp.
  5368     02  eibcposn         pic s9(4) comp.
  5369     02  eibcalen         pic s9(4) comp.
  5370     02  eibaid           pic x(1).
  5371     02  eibfiller1       pic x(1).
  5372     02  eibfn            pic x(2).
  5373     02  eibfiller2       pic x(2).
  5374     02  eibrcode         pic x(6).
  5375     02  eibfiller3       pic x(2).
  5376     02  eibds            pic x(8).
  5377     02  eibreqid         pic x(8).
  5378     02  eibrsrce         pic x(8).
  5379     02  eibsync          pic x(1).
  5380     02  eibfree          pic x(1).
  5381     02  eibrecv          pic x(1).
  5382     02  eibsend          pic x(1).
  5383     02  eibatt           pic x(1).
  5384     02  eibeoc           pic x(1).
  5385     02  eibfmh           pic x(1).
  5386     02  eibcompl         pic x(1).
  5387     02  eibsig           pic x(1).
  5388     02  eibconf          pic x(1).
  5389     02  eiberr           pic x(1).
  5390     02  eibrldbk         pic x(1).
  5391     02  eiberrcd         pic x(4).
  5392     02  eibsynrb         pic x(1).
  5393     02  eibnodat         pic x(1).
  5394     02  eibfiller5       pic x(2).
  5395     02  eibresp          pic 9(09) comp.
  5396     02  eibresp2         pic 9(09) comp.
  5397     02  dfheigdj         pic s9(4) comp.
  5398     02  dfheigdk         pic s9(4) comp.
  5399 01 dfhcommarea                  PIC X(6500).
  5400 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  5401 0000-DFHEXIT SECTION.
  5402     MOVE '9#                    $   ' TO DFHEIV0.
  5403     MOVE 'NSRASBL' TO DFHEIV1.
  5404     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5405     display ' entering pgm nsrasbl '
  5406     display ' commarea ' dfhcommarea
  5407     MOVE EIBDATE                TO DC-JULIAN-YYDDD
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  95
* NSRASBL.cbl
  5408     MOVE '5'                    TO DC-OPTION-CODE
  5409     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5410     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  5411     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  5412     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  5413     move dfhcommarea            to srch-commarea
  5414*****************************************************
  5415* The full       key has been established and passed
  5416* to this program via NSRASLTR
  5417*****************************************************
  5418     PERFORM 1115-MATCH-COMPANY  THRU 1115-EXIT
  5419     display ' input data ' bl-carrier ' ' bl-group ' '
  5420        bl-account ' ' bl-eff-dt ' ' bl-cert-no
  5421     MOVE BL-LETTER-ID           TO OUT-LETTER
  5422     MOVE BL-PROC-ID             TO OUT-PROC-ID
  5423     MOVE BL-CARRIER             TO OUT-CARRIER
  5424     MOVE BL-GROUP               TO OUT-GROUPING
  5425     MOVE BL-ACCOUNT             TO OUT-ACCOUNT
  5426     MOVE BL-PRINT-NOW-SW        TO OUT-PRINT-NOW
  5427     MOVE BL-CERT-FORM-ID        TO OUT-CERTIFICATE-ID
  5428     MOVE BL-SOURCE-SCREEN       TO OUT-SCREEN-ID
  5429     STRING DC-EDITA-CCYY DC-EDITA-MONTH
  5430        DC-EDITA-DAY  DELIMITED BY SIZE
  5431        INTO OUT-CYCLE-DT
  5432     END-STRING
  5433     IF BL-EFF-DT = '99/99/99' OR '99/99/9999'
  5434        MOVE HIGH-VALUES         TO WS-PASSED-DT
  5435     ELSE
  5436        IF BL-EFF-DT = SPACES
  5437           display ' bad eff data ' bl-eff-dt ' ' bl-cert-no
  5438        ELSE
  5439           IF BL-EFF-DT (9:2) = SPACES
  5440              STRING BL-EFF-DT (7:2) BL-EFF-DT (1:2)
  5441                     BL-EFF-DT (4:2)
  5442                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5443              END-STRING
  5444           ELSE
  5445              STRING BL-EFF-DT (9:2) BL-EFF-DT (1:2)
  5446                     BL-EFF-DT (4:2)
  5447                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5448              END-STRING
  5449           END-IF
  5450           MOVE '3'              TO DC-OPTION-CODE
  5451           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5452           IF NO-CONVERSION-ERROR
  5453              MOVE DC-BIN-DATE-1 TO WS-PASSED-DT
  5454           ELSE
  5455              MOVE 'BAD EFF DATE CONVERT ' TO BL-MESSAGE
  5456              SET BL-FAIL TO TRUE
  5457              GO TO 0000-RETURN
  5458           END-IF
  5459        END-IF
  5460     END-IF
  5461     perform 0800-init-out-data  thru 0800-exit
  5462     SET BL-FAIL TO TRUE
  5463******************************************************************
  5464* DATA SOURCE MEANINGS  BL-DATA-SRCE
  5465*    1) FROM ACCT MAINT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  96
* NSRASBL.cbl
  5466*    2) FROM CERT UPDATE
  5467*    3) FROM COMP MAINT
  5468*    4) FROM REVIEW AND CORRECTIONS
  5469******************************************************************
  5470     EVALUATE BL-DATA-SRCE
  5471        WHEN '1'
  5472           PERFORM 0100-DATA-SRCE-1 THRU 0100-EXIT
  5473        WHEN '2'
  5474           PERFORM 0200-DATA-SRCE-2 THRU 0200-EXIT
  5475        WHEN '3'
  5476           PERFORM 0300-DATA-SRCE-3 THRU 0300-EXIT
  5477        WHEN '4'
  5478           PERFORM 0400-DATA-SRCE-4 THRU 0400-EXIT
  5479        WHEN OTHER
  5480           MOVE ' BAD DATA SOURCE CODE ' TO BL-MESSAGE
  5481     END-EVALUATE
  5482     IF BL-OK
  5483        display ' bl write erarch ' bl-write-erarch
  5484        PERFORM 1250-GET-ELLETR  THRU 1250-EXIT
  5485        PERFORM 1700-GET-ELENCC  THRU 1700-EXIT
  5486        IF BL-ARCHIVE-NO = ZEROS
  5487           PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  5488           MOVE WS-ARCHIVE-NO    TO BL-ARCHIVE-NO
  5489           display ' arch zeros, new arch ' bl-archive-no
  5490        END-IF
  5491        MOVE BL-ARCHIVE-NO       TO OUT-ARCH-NO
  5492        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  5493        display ' bl write erarch ' bl-write-erarch
  5494        IF BL-WRITE-ERARCH = 'T' OR 'B'
  5495           PERFORM 0700-WRITE-EXTR THRU 0700-EXIT
  5496           IF BL-FAIL
  5497              GO TO 0000-RETURN
  5498           END-IF
  5499        END-IF
  5500        MOVE W-LETTER-TO-ACCT    TO BL-LETTER-TO-ACCT
  5501        MOVE W-LETTER-TO-BENE    TO BL-LETTER-TO-BENE
  5502     END-IF
  5503     .
  5504 0000-RETURN.
  5505     move srch-commarea          to dfhcommarea
  5506
  5507* exec cics
  5508*       return
  5509*    end-exec
  5510*    MOVE '.(                    ''   #00005502' TO DFHEIV0
  5511     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5512     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5513     MOVE X'2020233030303035353032' TO DFHEIV0(25:11)
  5514     CALL 'kxdfhei1' USING DFHEIV0,
  5515           DFHEIV99,
  5516           DFHEIV99,
  5517           DFHEIV99,
  5518           DFHEIV99,
  5519           DFHEIV99,
  5520           DFHEIV99
  5521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5522     .
  5523 0100-DATA-SRCE-1.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  97
* NSRASBL.cbl
  5524     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5525     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5526     MOVE ' '                    TO WS-ERACCT-SW
  5527     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  5528     MOVE WS-COMPANY-CD          TO WS-ERACCT-COMPANY-CD
  5529     MOVE BL-CARRIER             TO WS-ERACCT-CARRIER
  5530     MOVE BL-GROUP               TO WS-ERACCT-GROUP
  5531     MOVE BL-STATE               TO WS-ERACCT-STATE
  5532     MOVE BL-ACCOUNT             TO WS-ERACCT-ACCOUNT
  5533     MOVE WS-PASSED-DT           TO WS-ERACCT-EXP-DT
  5534                                    WS-CERT-EFF-DT
  5535     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  5536     IF ACCT-FOUND
  5537        MOVE AM-CSR-CODE         TO WS-CSR-ID
  5538        PERFORM 1025-GET-CSR-INFO
  5539                                 THRU 1025-EXIT
  5540        PERFORM 1300-DETERMINE-COMM
  5541                                 THRU 1300-EXIT
  5542        SET BL-OK TO TRUE
  5543     ELSE
  5544        MOVE ' ACCOUNT MASTER NOT FOUND ' TO BL-MESSAGE
  5545        SET BL-FAIL TO TRUE
  5546     END-IF
  5547     .
  5548 0100-EXIT.
  5549     EXIT.
  5550 0200-DATA-SRCE-2.
  5551     display ' made it to data srce 2 '
  5552     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5553     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5554     MOVE ' '                    TO WS-ELCERT-SW
  5555     MOVE WS-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  5556     MOVE BL-CARRIER             TO WS-ELCERT-CARRIER
  5557     MOVE BL-GROUP               TO WS-ELCERT-GROUP
  5558     MOVE BL-STATE               TO WS-ELCERT-STATE
  5559     MOVE BL-ACCOUNT             TO WS-ELCERT-ACCOUNT
  5560     MOVE WS-PASSED-DT           TO WS-ELCERT-EFF-DT
  5561                                    WS-CERT-EFF-DT
  5562     MOVE BL-CERT-NO             TO WS-ELCERT-CERT-NO
  5563
  5564     MOVE ' '                 TO WS-ERACCT-SW
  5565     MOVE LOW-VALUES          TO WS-ERACCT-KEY
  5566     MOVE WS-ELCERT-KEY (1:22) TO WS-ERACCT-KEY (1:22)
  5567     PERFORM 1200-GET-ERACCT  THRU 1200-EXIT
  5568     IF ACCT-FOUND
  5569        MOVE AM-CSR-CODE      TO WS-CSR-ID
  5570        PERFORM 1025-GET-CSR-INFO THRU 1025-EXIT
  5571     END-IF
  5572     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  5573     IF CERT-FOUND
  5574        PERFORM 1130-MATCH-BENCDS THRU 1130-EXIT
  5575        MOVE WS-LF-ABBRV         TO OUT-LF-ABBRV
  5576        MOVE WS-LF-DESC          TO OUT-LF-DESC
  5577        IF WS-LF-EARN = 'B'
  5578           MOVE 'B'              TO OUT-BALLOON-IND
  5579        END-IF
  5580        MOVE WS-WAIT-PER         TO OUT-WAIT-PER
  5581        MOVE WS-RET-ELIM         TO OUT-RET-ELIM
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  98
* NSRASBL.cbl
  5582        MOVE WS-AH-DESC          TO OUT-AH-DESC
  5583        MOVE WS-BEN-DAYS         TO OUT-BEN-DAYS
  5584
  5585        IF BL-ENDT-ARCH-NO > ZERO
  5586           MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5587           MOVE BL-ENDT-ARCH-NO    TO WS-ERENDT-ARCHIVE
  5588           PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5589        ELSE
  5590           IF BL-ARCHIVE-NO > ZERO
  5591              MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5592              MOVE BL-ARCHIVE-NO      TO WS-ERENDT-ARCHIVE
  5593              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5594           END-IF
  5595        END-IF
  5596
  5597        IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  5598           AND (OUT-BALLOON-IND = 'B')
  5599           MOVE 'B'              TO OUT-FORM (3:1)
  5600        END-IF
  5601        SET BL-OK TO TRUE
  5602     ELSE
  5603        display ' cert not found ' ws-elcert-cert-no
  5604        MOVE ' CERTIFICATE NOT FOUND ' TO BL-MESSAGE
  5605        SET BL-FAIL TO TRUE
  5606     END-IF
  5607     .
  5608 0200-EXIT.
  5609     EXIT.
  5610 0300-DATA-SRCE-3.
  5611     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5612     MOVE WS-COMPANY-CD          TO WS-ERCOMP-COMPANY-CD
  5613     MOVE BL-CARRIER             TO WS-ERCOMP-CARRIER
  5614     MOVE BL-GROUP               TO WS-ERCOMP-GROUP
  5615     MOVE BL-RESP-NO             TO WS-ERCOMP-RESP-NO
  5616     MOVE BL-ACCOUNT             TO WS-ERCOMP-ACCOUNT
  5617     IF WS-ERCOMP-ACCOUNT = SPACES
  5618        MOVE LOW-VALUES          TO WS-ERCOMP-ACCOUNT
  5619        MOVE 'G'                 TO WS-ERCOMP-REC-TYPE
  5620     ELSE
  5621        MOVE 'A'                 TO WS-ERCOMP-REC-TYPE
  5622     END-IF
  5623     PERFORM 1225-GET-ERCOMP     THRU 1225-EXIT
  5624     IF RESP-NORMAL
  5625        MOVE CO-CSR-CODE         TO WS-CSR-ID
  5626        PERFORM 1025-GET-CSR-INFO
  5627                                 THRU 1025-EXIT
  5628        SET BL-OK TO TRUE
  5629     ELSE
  5630        MOVE ' COMPENSATION MASTER NOT FOUND ' TO BL-MESSAGE
  5631        SET BL-FAIL TO TRUE
  5632     END-IF
  5633     .
  5634 0300-EXIT.
  5635     EXIT.
  5636 0400-DATA-SRCE-4.
  5637     MOVE WS-COMPANY-CD          TO WS-ERPNDB-COMPANY-CD
  5638     MOVE BL-BATCH-NO            TO WS-ERPNDB-BATCH-NO
  5639     MOVE BL-BATCH-SEQ           TO WS-ERPNDB-BATCH-SEQ
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page  99
* NSRASBL.cbl
  5640     MOVE +0                     TO WS-ERPNDB-CHG-SEQ
  5641     MOVE ' '                    TO WS-ERPNDB-SW WS-ERACCT-SW
  5642                                    WS-ELCERT-SW WS-ERENDT-SW
  5643
  5644* EXEC CICS READ
  5645*         DATASET    ('ERPNDB')
  5646*         INTO       (PENDING-BUSINESS)
  5647*         RIDFLD     (WS-ERPNDB-KEY)
  5648*         RESP       (WS-RESPONSE)
  5649*    END-EXEC
  5650     MOVE LENGTH OF
  5651      PENDING-BUSINESS
  5652       TO DFHEIV11
  5653     MOVE 'ERPNDB' TO DFHEIV1
  5654*    MOVE '&"IL       E          (  N#00005626' TO DFHEIV0
  5655     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5656     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5657     MOVE X'204E233030303035363236' TO DFHEIV0(25:11)
  5658     CALL 'kxdfhei1' USING DFHEIV0,
  5659           DFHEIV1,
  5660           PENDING-BUSINESS,
  5661           DFHEIV11,
  5662           WS-ERPNDB-KEY,
  5663           DFHEIV99,
  5664           DFHEIV99,
  5665           DFHEIV99
  5666     MOVE EIBRESP  TO WS-RESPONSE
  5667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5668     IF RESP-NORMAL
  5669        IF PB-RECORD-TYPE = '1' OR '2'
  5670           MOVE PB-CARRIER       TO BL-CARRIER
  5671           MOVE PB-GROUPING      TO BL-GROUP
  5672           MOVE PB-STATE         TO BL-STATE
  5673           MOVE PB-ACCOUNT       TO BL-ACCOUNT
  5674           MOVE PB-CERT-NO       TO BL-CERT-NO
  5675           MOVE PB-CSR-ID        TO WS-CSR-ID
  5676           IF PB-ISSUE
  5677              SET PROCESS-ISSUE TO TRUE
  5678              MOVE PB-I-LF-BENEFIT-CD TO WS-LF-BENCD
  5679              MOVE PB-I-AH-BENEFIT-CD TO WS-AH-BENCD
  5680              MOVE PB-I-LF-PREM-CALC TO OUT-LF-CALC-PRM
  5681              MOVE PB-I-AH-PREM-CALC TO OUT-AH-CALC-PRM
  5682           ELSE
  5683              SET PROCESS-CANCEL TO TRUE
  5684              MOVE PB-CI-LF-BENEFIT-CD TO WS-LF-BENCD
  5685              MOVE PB-CI-AH-BENEFIT-CD TO WS-AH-BENCD
  5686              MOVE PB-C-LF-REF-CALC TO OUT-LF-CALC-REF
  5687              MOVE PB-C-AH-REF-CALC TO OUT-AH-CALC-REF
  5688           END-IF
  5689           PERFORM 1120-MATCH-CARRIER
  5690                                 THRU 1120-EXIT
  5691           PERFORM 1125-MATCH-STATE
  5692                                 THRU 1125-EXIT
  5693           PERFORM 1130-MATCH-BENCDS
  5694                                 THRU 1130-EXIT
  5695           MOVE WS-LF-ABBRV      TO OUT-LF-ABBRV
  5696           MOVE WS-LF-DESC       TO OUT-LF-DESC
  5697                                    OUT-ORIG-LF-DESC
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 100
* NSRASBL.cbl
  5698           IF WS-LF-EARN = 'B'
  5699              MOVE 'B'           TO OUT-BALLOON-IND
  5700           END-IF
  5701           MOVE WS-WAIT-PER      TO OUT-WAIT-PER
  5702                                    OUT-ORIG-WAIT-PER
  5703           MOVE WS-RET-ELIM      TO OUT-RET-ELIM
  5704                                    OUT-ORIG-RET-ELIM
  5705           MOVE WS-AH-DESC       TO OUT-AH-DESC
  5706                                    OUT-ORIG-AH-DESC
  5707           MOVE WS-BEN-DAYS      TO OUT-BEN-DAYS
  5708                                    OUT-ORIG-BEN-DAYS
  5709           PERFORM 1025-GET-CSR-INFO
  5710                                 THRU 1025-EXIT
  5711
  5712           MOVE LOW-VALUES       TO WS-ERACCT-KEY
  5713           MOVE PB-CONTROL-BY-ACCOUNT (1:22)
  5714                                 TO WS-ERACCT-KEY (1:22)
  5715           MOVE PB-CERT-EFF-DT   TO WS-CERT-EFF-DT
  5716           PERFORM 1200-GET-ERACCT THRU 1200-EXIT
  5717           IF ACCT-FOUND
  5718              MOVE AM-CSR-CODE      TO WS-CSR-ID
  5719              PERFORM 1025-GET-CSR-INFO
  5720                                    THRU 1025-EXIT
  5721              PERFORM 1300-DETERMINE-COMM
  5722                                    THRU 1300-EXIT
  5723           END-IF
  5724
  5725           MOVE PB-CONTROL-BY-ACCOUNT (1:33)
  5726                                 TO WS-ELCERT-KEY
  5727           PERFORM 1100-GET-ELCERT
  5728                                 THRU 1100-EXIT
  5729
  5730           IF BL-ENDT-ARCH-NO > ZERO
  5731              MOVE PB-COMPANY-CD   TO WS-ERENDT-COMPANY-CD-A1
  5732              MOVE BL-ENDT-ARCH-NO TO WS-ERENDT-ARCHIVE
  5733              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5734           ELSE
  5735              IF BL-ARCHIVE-NO > ZERO
  5736                 MOVE PB-COMPANY-CD TO WS-ERENDT-COMPANY-CD-A1
  5737                 MOVE BL-ARCHIVE-NO TO WS-ERENDT-ARCHIVE
  5738                 PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5739              END-IF
  5740           END-IF
  5741
  5742           SET BL-OK TO TRUE
  5743           IF (PB-STATE = 'KY' OR 'MD' OR 'WI')
  5744              AND (OUT-BALLOON-IND = 'B')
  5745              MOVE 'B'           TO OUT-FORM (3:1)
  5746           END-IF
  5747        END-IF
  5748     END-IF
  5749     .
  5750 0400-EXIT.
  5751     EXIT.
  5752 0500-SCRUB-DATA.
  5753*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  5754*   A DIFFERENT DELIMITER IN PROGRAM NSRASLTR BUT
  5755*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 101
* NSRASBL.cbl
  5756*   TO A HEX 26 TO GET BY THE DECODER
  5757     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  5758                                 TO M1
  5759     MOVE OUT-ACCT-NAME          TO WS-WORK-FIELD
  5760     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5761        (A1 > M1)
  5762        OR (WS-WORK-FIELD (A1:1) = '*')
  5763        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  5764        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  5765     END-PERFORM
  5766     IF A1 > M1
  5767        CONTINUE
  5768     ELSE
  5769        MOVE WS-WORK-FIELD (1:A1 - 1)
  5770                                 TO OUT-ACCT-NAME
  5771     END-IF
  5772     MOVE FUNCTION LENGTH(OUT-BENE-NAME)
  5773                                 TO M1
  5774     MOVE OUT-BENE-NAME          TO WS-WORK-FIELD
  5775     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5776        (A1 > M1)
  5777        OR (WS-WORK-FIELD (A1:1) = '*')
  5778        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  5779        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  5780     END-PERFORM
  5781     IF A1 > M1
  5782        CONTINUE
  5783     ELSE
  5784        MOVE WS-WORK-FIELD (1:A1 - 1)
  5785                                 TO OUT-BENE-NAME
  5786     END-IF
  5787     IF OUT-CERT-NO = LOW-VALUES OR SPACES
  5788         MOVE '0000000000 '  TO OUT-CERT-NO
  5789     END-IF
  5790     MOVE +1 TO M1
  5791     MOVE SPACES TO BL-RECORD-PASSED-DATA
  5792     MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  5793                                 TO NS-LEN
  5794     display ' naper output data length ' ns-len
  5795     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5796        (NAPER-OUTPUT-DATA (A1:11) = 'EndOfString')
  5797        OR (A1 > NS-LEN)
  5798        IF NAPER-OUTPUT-DATA (A1:3) = SPACES
  5799           CONTINUE
  5800        ELSE
  5801           IF NAPER-OUTPUT-DATA (A1:1) = '~'
  5802              MOVE '&'           TO BL-RECORD-PASSED-DATA (M1:1)
  5803              MOVE ' '           TO NAPER-OUTPUT-DATA (A1:1)
  5804              ADD +1 TO M1
  5805           ELSE
  5806              IF NAPER-OUTPUT-DATA (A1:1) = '&'
  5807                 MOVE '%26'      TO BL-RECORD-PASSED-DATA (M1:3)
  5808                 ADD +3 TO M1
  5809              ELSE
  5810                 MOVE NAPER-OUTPUT-DATA (A1:1)
  5811                                 TO BL-RECORD-PASSED-DATA (M1:1)
  5812                 ADD +1 TO M1
  5813              END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 102
* NSRASBL.cbl
  5814           END-IF
  5815        END-IF
  5816     END-PERFORM
  5817     .
  5818 0500-EXIT.
  5819     EXIT.
  5820 0600-GET-ERENDT.
  5821
  5822* EXEC CICS READ
  5823*         DATASET    ('ERENDT2')
  5824*         INTO       (ENDORSEMENT-RECORD)
  5825*         RIDFLD     (WS-ERENDT-KEY-BY-ARCH)
  5826*         RESP       (WS-RESPONSE)
  5827*    END-EXEC
  5828     MOVE LENGTH OF
  5829      ENDORSEMENT-RECORD
  5830       TO DFHEIV11
  5831     MOVE 'ERENDT2' TO DFHEIV1
  5832*    MOVE '&"IL       E          (  N#00005785' TO DFHEIV0
  5833     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5834     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5835     MOVE X'204E233030303035373835' TO DFHEIV0(25:11)
  5836     CALL 'kxdfhei1' USING DFHEIV0,
  5837           DFHEIV1,
  5838           ENDORSEMENT-RECORD,
  5839           DFHEIV11,
  5840           WS-ERENDT-KEY-BY-ARCH,
  5841           DFHEIV99,
  5842           DFHEIV99,
  5843           DFHEIV99
  5844     MOVE EIBRESP  TO WS-RESPONSE
  5845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5846     DISPLAY ' JUST READ ENDT ' WS-RESPONSE ' '
  5847         WS-ERENDT-ARCHIVE
  5848     IF (RESP-NORMAL)
  5849        SET ENDT-FOUND TO TRUE
  5850        PERFORM 0620-BUILD-ENDT  THRU 0620-EXIT
  5851        PERFORM 0650-PROCESS-NO-Change
  5852                                 THRU 0650-EXIT
  5853     END-IF
  5854     .
  5855 0600-EXIT.
  5856     EXIT.
  5857 0620-BUILD-ENDT.
  5858     MOVE SPACES                 TO OUT-ORIG-LF-CAN-DT
  5859                                    OUT-NEW-LF-CAN-DT
  5860                                    OUT-ORIG-AH-CAN-DT
  5861                                    OUT-NEW-AH-CAN-DT
  5862                                    OUT-ORIG-CAN-DT
  5863                                    OUT-NEW-CAN-DT
  5864     IF EN-REC-TYPE = 'C'
  5865        GO TO 0620-PROCESS-CANCEL
  5866     END-IF
  5867     MOVE EN-LF-ORIG-BENCD       TO WS-LF-BENCD
  5868     MOVE EN-AH-ORIG-BENCD       TO WS-AH-BENCD
  5869     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  5870     MOVE WS-LF-DESC             TO OUT-ORIG-LF-DESC
  5871     IF WS-LF-EARN = 'B'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 103
* NSRASBL.cbl
  5872        MOVE 'B'                 TO OUT-BALLOON-IND
  5873     END-IF
  5874     MOVE WS-AH-DESC             TO OUT-ORIG-AH-DESC
  5875     MOVE WS-RET-ELIM            TO OUT-ORIG-RET-ELIM
  5876     MOVE WS-BEN-DAYS            TO OUT-ORIG-BEN-DAYS
  5877     MOVE WS-WAIT-PER            TO OUT-ORIG-WAIT-PER
  5878     MOVE EN-INS-ORIG-LAST-NAME    TO OUT-ORIG-ILNAME
  5879     MOVE EN-INS-ORIG-FIRST-NAME   TO OUT-ORIG-IFNAME
  5880     MOVE EN-INS-ORIG-MIDDLE-INIT  TO OUT-ORIG-MINIT
  5881     IF EN-INS-ORIG-AGE-DEF-FLAG = 'Y'
  5882         MOVE ZERO                 TO OUT-ORIG-IAGE
  5883     ELSE
  5884         MOVE EN-INS-ORIG-AGE      TO OUT-ORIG-IAGE
  5885     END-IF
  5886     MOVE EN-JNT-ORIG-LAST-NAME    TO OUT-ORIG-JLNAME
  5887     MOVE EN-JNT-ORIG-FIRST-NAME   TO OUT-ORIG-JFNAME
  5888     MOVE EN-JNT-ORIG-MIDDLE-INIT  TO OUT-ORIG-JMINIT
  5889     IF EN-JNT-ORIG-AGE-DEF-FLAG = 'Y'
  5890         MOVE ZERO                 TO OUT-ORIG-JAGE
  5891     ELSE
  5892         MOVE EN-JNT-ORIG-AGE      TO OUT-ORIG-JAGE
  5893     END-IF
  5894     MOVE EN-LF-ORIG-BENCD         TO OUT-ORIG-LF-BENCD
  5895     MOVE EN-LF-ORIG-TERM          TO OUT-ORIG-LF-TERM
  5896     MOVE EN-LF-ORIG-BEN-AMT       TO OUT-ORIG-LF-BEN
  5897     MOVE EN-LF-ORIG-PRM-AMT       TO OUT-ORIG-LF-PRM
  5898     MOVE EN-LF-ORIG-ALT-BEN-AMT   TO OUT-ORIG-LF-ALT-BEN
  5899     MOVE EN-LF-ORIG-ALT-PRM-AMT   TO OUT-ORIG-LF-ALT-PRM
  5900     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  5901                             EN-LF-ORIG-ALT-PRM-AMT
  5902     MOVE WS-WRK-AMOUNT          TO OUT-ORIG-LF-CMB-PREM
  5903     IF EN-LF-ORIG-BENCD EQUAL '00' OR SPACES
  5904         MOVE SPACES             TO OUT-ORIG-LF-BEN-A
  5905                                    OUT-ORIG-LF-PRM-A
  5906                                    OUT-ORIG-LF-ALT-BEN-A
  5907                                    OUT-ORIG-LF-ALT-PRM-A
  5908                                    OUT-ORIG-COVERAGE-IND
  5909     ELSE
  5910         MOVE 'LIFE'             TO OUT-ORIG-COVERAGE-IND
  5911         IF EN-LF-ORIG-PRM-AMT = .01
  5912             MOVE SPACES         TO OUT-ORIG-LF-PRM-A
  5913         END-IF
  5914         IF EN-LF-ORIG-BEN-AMT = 999999999.99
  5915             MOVE SPACES         TO OUT-ORIG-LF-BEN-A
  5916         END-IF
  5917     END-IF
  5918     MOVE EN-LF-ORIG-EXP-DT      TO DC-BIN-DATE-1
  5919     MOVE ' '                    TO DC-OPTION-CODE
  5920     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5921     IF NO-CONVERSION-ERROR
  5922        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5923           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5924              INTO OUT-ORIG-LF-EXP-DT
  5925        END-STRING
  5926     END-IF
  5927     MOVE EN-AH-ORIG-BENCD       TO OUT-ORIG-AH-BENCD
  5928     MOVE EN-AH-ORIG-TERM        TO OUT-ORIG-AH-TERM
  5929     MOVE EN-AH-ORIG-BEN-AMT     TO OUT-ORIG-AH-BEN
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 104
* NSRASBL.cbl
  5930     MOVE EN-AH-ORIG-PRM-AMT     TO OUT-ORIG-AH-PRM
  5931     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  5932         MOVE SPACES             TO OUT-ORIG-AH-BEN-A
  5933                                    OUT-ORIG-AH-PRM-A
  5934     ELSE
  5935        IF OUT-ORIG-COVERAGE-IND = 'LIFE'
  5936            MOVE 'BOTH'          TO OUT-ORIG-COVERAGE-IND
  5937        ELSE
  5938            MOVE 'AH  '          TO OUT-ORIG-COVERAGE-IND
  5939        END-IF
  5940        IF EN-AH-ORIG-PRM-AMT = .01
  5941            MOVE SPACES          TO OUT-ORIG-AH-PRM-A
  5942        END-IF
  5943        IF EN-AH-ORIG-BEN-AMT = 999999999.99
  5944            MOVE SPACES          TO OUT-ORIG-AH-BEN-A
  5945        END-IF
  5946     END-IF
  5947     COMPUTE WS-WORK-PREM =
  5948        EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT
  5949           + EN-AH-ORIG-PRM-AMT
  5950     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-PREM
  5951     MOVE EN-AH-ORIG-EXP-DT      TO DC-BIN-DATE-1
  5952     MOVE ' '                    TO DC-OPTION-CODE
  5953     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5954     IF NO-CONVERSION-ERROR
  5955        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5956           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5957              INTO OUT-ORIG-AH-EXP-DT
  5958        END-STRING
  5959     END-IF
  5960     MOVE EN-AH-ORIG-CP          TO OUT-ORIG-CRIT-PER
  5961                                    OUT-ORIG-MAX-PMTS
  5962     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  5963         MOVE SPACES             TO OUT-ORIG-MAX-PMTS-A
  5964     END-IF
  5965     MOVE EN-INS-NEW-LAST-NAME    TO OUT-NEW-ILNAME
  5966     MOVE EN-INS-NEW-FIRST-NAME   TO OUT-NEW-IFNAME
  5967     MOVE EN-INS-NEW-MIDDLE-INIT  TO OUT-NEW-IMINIT
  5968     IF EN-INS-NEW-AGE-DEF-FLAG = 'Y'
  5969         MOVE ZERO                TO OUT-NEW-IAGE
  5970     ELSE
  5971         MOVE EN-INS-NEW-AGE      TO OUT-NEW-IAGE
  5972     END-IF
  5973     MOVE EN-JNT-NEW-LAST-NAME    TO OUT-NEW-JLNAME
  5974     MOVE EN-JNT-NEW-FIRST-NAME   TO OUT-NEW-JFNAME
  5975     MOVE EN-JNT-NEW-MIDDLE-INIT  TO OUT-NEW-JMINIT
  5976     IF EN-JNT-NEW-AGE-DEF-FLAG = 'Y'
  5977         MOVE ZERO                TO OUT-NEW-JAGE
  5978     ELSE
  5979         MOVE EN-JNT-NEW-AGE      TO OUT-NEW-JAGE
  5980     END-IF
  5981     MOVE EN-LF-NEW-BENCD        TO WS-LF-BENCD
  5982     MOVE EN-AH-NEW-BENCD        TO WS-AH-BENCD
  5983     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  5984     MOVE WS-LF-DESC             TO OUT-NEW-LF-DESC
  5985     IF WS-LF-EARN = 'B'
  5986        MOVE 'B'                 TO OUT-BALLOON-IND
  5987     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 105
* NSRASBL.cbl
  5988     MOVE WS-AH-DESC             TO OUT-NEW-AH-DESC
  5989     MOVE WS-RET-ELIM            TO OUT-NEW-RET-ELIM
  5990     MOVE WS-BEN-DAYS            TO OUT-NEW-BEN-DAYS
  5991     MOVE WS-WAIT-PER            TO OUT-NEW-WAIT-PER
  5992     MOVE EN-LF-NEW-BENCD         TO OUT-NEW-LF-BENCD
  5993     MOVE EN-LF-NEW-TERM          TO OUT-NEW-LF-TERM
  5994     MOVE EN-LF-NEW-BEN-AMT       TO OUT-NEW-LF-BEN
  5995     MOVE EN-LF-NEW-PRM-AMT       TO OUT-NEW-LF-PRM
  5996     MOVE EN-LF-NEW-ALT-BEN-AMT   TO OUT-NEW-LF-ALT-BEN
  5997     MOVE EN-LF-NEW-ALT-PRM-AMT   TO OUT-NEW-LF-ALT-PRM
  5998     COMPUTE WS-WRK-AMOUNT = EN-LF-NEW-PRM-AMT +
  5999                             EN-LF-NEW-ALT-PRM-AMT
  6000     MOVE WS-WRK-AMOUNT           TO OUT-NEW-LF-CMB-PREM
  6001     IF EN-LF-NEW-BENCD EQUAL '00' OR SPACES
  6002         MOVE SPACES             TO OUT-NEW-LF-BEN-A
  6003                                    OUT-NEW-LF-PRM-A
  6004                                    OUT-NEW-LF-ALT-BEN-A
  6005                                    OUT-NEW-LF-ALT-PRM-A
  6006                                    OUT-NEW-LF-CMB-PREM-A
  6007                                    OUT-NEW-COVERAGE-IND
  6008     ELSE
  6009         MOVE 'LIFE'             TO OUT-NEW-COVERAGE-IND
  6010     END-IF
  6011    MOVE EN-LF-NEW-EXP-DT        TO DC-BIN-DATE-1
  6012     MOVE ' '                     TO DC-OPTION-CODE
  6013     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6014     IF NO-CONVERSION-ERROR
  6015        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6016           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6017              INTO OUT-NEW-LF-EXP-DT
  6018        END-STRING
  6019     END-IF
  6020     MOVE EN-AH-NEW-BENCD         TO OUT-NEW-AH-BENCD
  6021     MOVE EN-AH-NEW-TERM          TO OUT-NEW-AH-TERM
  6022     MOVE EN-AH-NEW-BEN-AMT       TO OUT-NEW-AH-BEN
  6023     MOVE EN-AH-NEW-PRM-AMT       TO OUT-NEW-AH-PRM
  6024     COMPUTE WS-WORK-PREM =
  6025        EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT
  6026           + EN-AH-NEW-PRM-AMT
  6027     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-PREM
  6028     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6029         MOVE SPACES             TO OUT-NEW-AH-BEN-A
  6030                                    OUT-NEW-AH-PRM-A
  6031     ELSE
  6032        IF OUT-NEW-COVERAGE-IND = 'LIFE'
  6033            MOVE 'BOTH'          TO OUT-NEW-COVERAGE-IND
  6034        ELSE
  6035            MOVE 'AH  '          TO OUT-NEW-COVERAGE-IND
  6036        END-IF
  6037     END-IF
  6038     MOVE EN-AH-NEW-EXP-DT        TO DC-BIN-DATE-1
  6039     MOVE ' '                     TO DC-OPTION-CODE
  6040     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6041     IF NO-CONVERSION-ERROR
  6042        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6043           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6044              INTO OUT-NEW-AH-EXP-DT
  6045        END-STRING
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 106
* NSRASBL.cbl
  6046     END-IF
  6047     MOVE EN-AH-NEW-CP            TO OUT-NEW-CRIT-PER
  6048                                     OUT-NEW-MAX-PMTS
  6049     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6050         MOVE SPACES             TO OUT-NEW-MAX-PMTS-A
  6051     END-IF
  6052     IF EN-LF-ORIG-EXP-DT > EN-AH-ORIG-EXP-DT
  6053        MOVE OUT-ORIG-LF-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6054     ELSE
  6055        MOVE OUT-ORIG-AH-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6056     END-IF
  6057     IF EN-LF-NEW-EXP-DT > EN-AH-NEW-EXP-DT
  6058        MOVE OUT-NEW-LF-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6059     ELSE
  6060        MOVE OUT-NEW-AH-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6061     END-IF
  6062     IF EN-LF-ORIG-TERM > EN-AH-ORIG-TERM
  6063        MOVE EN-LF-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6064     ELSE
  6065        MOVE EN-AH-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6066     END-IF
  6067     IF EN-LF-NEW-TERM > EN-AH-NEW-TERM
  6068        MOVE EN-LF-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6069     ELSE
  6070        MOVE EN-AH-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6071     END-IF
  6072     COMPUTE WS-WORK-PREM =
  6073        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6074        EN-AH-NEW-PRM-AMT) -
  6075        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT +
  6076        EN-AH-ORIG-PRM-AMT)
  6077     MOVE WS-WORK-PREM           TO OUT-TOT-PRM-CHG
  6078     IF EN-CSO-PORTION NOT NUMERIC
  6079        MOVE ZEROS               TO EN-CSO-PORTION
  6080     END-IF
  6081     IF EN-ACCT-PORTION NOT NUMERIC
  6082        MOVE ZERO                TO EN-ACCT-PORTION
  6083     END-IF
  6084*    MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6085*    MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6086     IF WS-WORK-PREM > +0
  6087        MOVE 'CSO'               TO OUT-PAYEE
  6088     ELSE
  6089      IF WS-WORK-PREM = +0
  6090         MOVE 'ZERO'             TO OUT-PAYEE
  6091      ELSE
  6092         MOVE 'ACCT'             TO OUT-PAYEE
  6093      END-IF
  6094     END-IF
  6095     COMPUTE WS-ACCT-ORIG-LF-PORT =
  6096        EN-LF-ORIG-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6097     MOVE WS-ACCT-ORIG-LF-PORT TO OUT-ACCT-ORIG-LF-PORT
  6098     COMPUTE WS-ACCT-ORIG-ALT-LF-PORT =
  6099        EN-LF-ORIG-ALT-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6100     MOVE WS-ACCT-ORIG-ALT-LF-PORT TO OUT-ACCT-ORIG-ALT-LF-PORT
  6101     COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6102        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6103        * EN-LF-ORIG-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 107
* NSRASBL.cbl
  6104     MOVE WS-ACCT-ORIG-CMB-LF-PORT TO OUT-ACCT-ORIG-CMB-LF-PORT
  6105     COMPUTE WS-ACCT-ORIG-AH-PORT =
  6106        EN-AH-ORIG-PRM-AMT * EN-AH-ORIG-COMM-PCT
  6107     MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6108     COMPUTE WS-ACCT-ORIG-PORTION =
  6109        WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6110     MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6111
  6112     COMPUTE WS-CSO-ORIG-LF-PORT =
  6113       EN-LF-ORIG-PRM-AMT - WS-ACCT-ORIG-LF-PORT
  6114     MOVE WS-CSO-ORIG-LF-PORT TO OUT-CSO-ORIG-LF-PORT
  6115     COMPUTE WS-CSO-ORIG-ALT-LF-PORT =
  6116       EN-LF-ORIG-ALT-PRM-AMT - WS-ACCT-ORIG-ALT-LF-PORT
  6117     MOVE WS-CSO-ORIG-ALT-LF-PORT TO OUT-CSO-ORIG-ALT-LF-PORT
  6118     COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6119       (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6120        WS-ACCT-ORIG-CMB-LF-PORT
  6121     MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6122     COMPUTE WS-CSO-ORIG-AH-PORT =
  6123        EN-AH-ORIG-PRM-AMT - WS-ACCT-ORIG-AH-PORT
  6124     MOVE WS-CSO-ORIG-AH-PORT TO OUT-CSO-ORIG-AH-PORT
  6125     COMPUTE WS-CSO-ORIG-PORTION =
  6126        WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6127     MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6128     COMPUTE WS-ACCT-NEW-LF-PORT =
  6129        EN-LF-NEW-PRM-AMT * EN-LF-NEW-COMM-PCT
  6130     MOVE WS-ACCT-NEW-LF-PORT TO OUT-ACCT-NEW-LF-PORT
  6131     COMPUTE WS-ACCT-NEW-ALT-LF-PORT =
  6132        EN-LF-NEW-ALT-PRM-AMT * EN-LF-NEW-COMM-PCT
  6133     MOVE WS-ACCT-NEW-ALT-LF-PORT TO OUT-ACCT-NEW-ALT-LF-PORT
  6134     COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6135        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT)
  6136        * EN-LF-NEW-COMM-PCT
  6137     MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6138     COMPUTE WS-ACCT-NEW-AH-PORT =
  6139        EN-AH-NEW-PRM-AMT * EN-AH-NEW-COMM-PCT
  6140     MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6141     COMPUTE WS-ACCT-NEW-PORTION =
  6142        WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6143     MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6144
  6145     COMPUTE WS-CSO-NEW-LF-PORT =
  6146       EN-LF-NEW-PRM-AMT - WS-ACCT-NEW-LF-PORT
  6147     MOVE WS-CSO-NEW-LF-PORT TO OUT-CSO-NEW-LF-PORT
  6148     COMPUTE WS-CSO-NEW-ALT-LF-PORT =
  6149       EN-LF-NEW-ALT-PRM-AMT - WS-ACCT-NEW-ALT-LF-PORT
  6150     MOVE WS-CSO-NEW-ALT-LF-PORT TO OUT-CSO-NEW-ALT-LF-PORT
  6151     COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6152       (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6153        WS-ACCT-NEW-CMB-LF-PORT
  6154     MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6155     COMPUTE WS-CSO-NEW-AH-PORT =
  6156        EN-AH-NEW-PRM-AMT - WS-ACCT-NEW-AH-PORT
  6157     MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6158     COMPUTE WS-CSO-NEW-PORTION =
  6159        WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6160     MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6161
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 108
* NSRASBL.cbl
  6162     COMPUTE WS-ACCT-LF-PORT-CHG =
  6163        WS-ACCT-NEW-LF-PORT - WS-ACCT-ORIG-LF-PORT
  6164     MOVE WS-ACCT-LF-PORT-CHG TO OUT-ACCT-LF-PORT-CHG
  6165     COMPUTE WS-ACCT-ALT-LF-PORT-CHG =
  6166        WS-ACCT-NEW-ALT-LF-PORT - WS-ACCT-ORIG-ALT-LF-PORT
  6167     MOVE WS-ACCT-ALT-LF-PORT-CHG TO OUT-ACCT-ALT-LF-PORT-CHG
  6168     COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6169        WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6170     MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6171     COMPUTE WS-ACCT-AH-PORT-CHG =
  6172        WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6173     MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6174     COMPUTE WS-ACCT-PORTION-CHG =
  6175        WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6176     MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6177
  6178     COMPUTE WS-CSO-LF-PORT-CHG =
  6179        WS-CSO-NEW-LF-PORT - WS-CSO-ORIG-LF-PORT
  6180     MOVE WS-CSO-LF-PORT-CHG TO OUT-CSO-LF-PORT-CHG
  6181     COMPUTE WS-CSO-ALT-LF-PORT-CHG =
  6182        WS-CSO-NEW-ALT-LF-PORT - WS-CSO-ORIG-ALT-LF-PORT
  6183     MOVE WS-CSO-ALT-LF-PORT-CHG TO OUT-CSO-ALT-LF-PORT-CHG
  6184     COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6185        WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6186     MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6187     COMPUTE WS-CSO-AH-PORT-CHG =
  6188        WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6189     MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6190     COMPUTE WS-CSO-PORTION-CHG =
  6191        WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6192     MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6193
  6194     COMPUTE WS-WORK-PREM =
  6195         EN-LF-NEW-PRM-AMT - EN-LF-ORIG-PRM-AMT
  6196     MOVE WS-WORK-PREM           TO OUT-LF-PREM-CHG
  6197     COMPUTE WS-WORK-PREM =
  6198         EN-LF-NEW-ALT-PRM-AMT - EN-LF-ORIG-ALT-PRM-AMT
  6199     MOVE WS-WORK-PREM           TO OUT-LF-ALT-PREM-CHG
  6200     COMPUTE WS-WORK-PREM =
  6201        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6202        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6203     MOVE WS-WORK-PREM           TO OUT-LF-CMB-PREM-CHG
  6204     COMPUTE WS-WORK-PREM =
  6205        (EN-AH-NEW-PRM-AMT - EN-AH-ORIG-PRM-AMT)
  6206     MOVE WS-WORK-PREM           TO OUT-AH-PREM-CHG
  6207
  6208     move en-sig-sw              to out-sig-sw
  6209     MOVE EN-HEALTH-APP          TO OUT-HEALTH-APP
  6210     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6211     GO TO 0620-CONTINUE
  6212     .
  6213 0620-PROCESS-CANCEL.
  6214     IF EN-LF-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6215        MOVE EN-LF-ORIG-REF-DT   TO DC-BIN-DATE-1
  6216        MOVE ' '                 TO DC-OPTION-CODE
  6217        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6218        IF NO-CONVERSION-ERROR
  6219           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 109
* NSRASBL.cbl
  6220              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6221                 INTO OUT-ORIG-LF-CAN-DT
  6222           END-STRING
  6223        END-IF
  6224        MOVE OUT-ORIG-LF-CAN-DT  TO OUT-ORIG-CAN-DT
  6225     END-IF
  6226
  6227     IF EN-LF-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6228        MOVE EN-LF-NEW-REF-DT    TO DC-BIN-DATE-1
  6229        MOVE ' '                 TO DC-OPTION-CODE
  6230        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6231        IF NO-CONVERSION-ERROR
  6232           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6233              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6234                 INTO OUT-NEW-LF-CAN-DT
  6235           END-STRING
  6236        END-IF
  6237        MOVE OUT-NEW-LF-CAN-DT   TO OUT-NEW-CAN-DT
  6238     END-IF
  6239
  6240     IF EN-AH-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6241        MOVE EN-AH-ORIG-REF-DT      TO DC-BIN-DATE-1
  6242        MOVE ' '                    TO DC-OPTION-CODE
  6243        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6244        IF NO-CONVERSION-ERROR
  6245           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6246              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6247                 INTO OUT-ORIG-AH-CAN-DT
  6248           END-STRING
  6249        END-IF
  6250        IF EN-AH-ORIG-REF-DT > EN-LF-ORIG-REF-DT
  6251           MOVE OUT-ORIG-AH-CAN-DT  TO OUT-ORIG-CAN-DT
  6252        END-IF
  6253     END-IF
  6254
  6255     IF EN-AH-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6256        MOVE EN-AH-NEW-REF-DT       TO DC-BIN-DATE-1
  6257        MOVE ' '                    TO DC-OPTION-CODE
  6258        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6259        IF NO-CONVERSION-ERROR
  6260           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6261              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6262                 INTO OUT-NEW-AH-CAN-DT
  6263           END-STRING
  6264        END-IF
  6265        IF EN-AH-NEW-REF-DT > EN-LF-NEW-REF-DT
  6266           MOVE OUT-NEW-AH-CAN-DT  TO OUT-NEW-CAN-DT
  6267        END-IF
  6268     END-IF
  6269     MOVE EN-LF-ORIG-REF-AMT     TO OUT-ORIG-LF-REF
  6270     MOVE EN-AH-ORIG-REF-AMT     TO OUT-ORIG-AH-REF
  6271     MOVE EN-LF-NEW-REF-AMT      TO OUT-NEW-LF-REF
  6272     MOVE EN-AH-NEW-REF-AMT      TO OUT-NEW-AH-REF
  6273     COMPUTE WS-WORK-PREM =
  6274        EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6275     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-REF
  6276     COMPUTE WS-WORK-PREM =
  6277        EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 110
* NSRASBL.cbl
  6278     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-REF
  6279     COMPUTE WS-WORK-PREM =
  6280        (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6281        (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6282     MOVE WS-WORK-PREM           TO OUT-TOT-REF-CHG
  6283
  6284     COMPUTE WS-WORK-PREM =
  6285        (EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT)
  6286     MOVE WS-WORK-PREM           TO OUT-LF-REF-CHG
  6287     COMPUTE WS-WORK-PREM =
  6288        (EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT)
  6289     MOVE WS-WORK-PREM           TO OUT-AH-REF-CHG
  6290
  6291*     MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6292*     MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6293     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6294
  6295     IF EN-COMM-CHGBK = 'N'
  6296         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6297                                   OUT-CSO-ORIG-ALT-LF-PORT
  6298         MOVE EN-LF-ORIG-REF-AMT TO OUT-CSO-ORIG-CMB-LF-PORT
  6299         MOVE EN-AH-ORIG-REF-AMT TO OUT-CSO-ORIG-AH-PORT
  6300         COMPUTE WS-CSO-ORIG-PORTION =
  6301             EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6302         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6303         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6304                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6305                                   OUT-ACCT-ORIG-CMB-LF-PORT
  6306                                   OUT-ACCT-ORIG-AH-PORT
  6307                                   OUT-ACCT-ORIG-PORTION
  6308
  6309         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6310                                   OUT-CSO-NEW-ALT-LF-PORT
  6311         MOVE EN-LF-NEW-REF-AMT TO OUT-CSO-NEW-CMB-LF-PORT
  6312         MOVE EN-AH-NEW-REF-AMT TO OUT-CSO-NEW-AH-PORT
  6313         COMPUTE WS-CSO-NEW-PORTION =
  6314             EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6315         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6316         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6317                                   OUT-ACCT-NEW-ALT-LF-PORT
  6318                                   OUT-ACCT-NEW-CMB-LF-PORT
  6319                                   OUT-ACCT-NEW-AH-PORT
  6320                                   OUT-ACCT-NEW-PORTION
  6321
  6322         MOVE ZERO              TO OUT-CSO-LF-PORT-CHG
  6323                                   OUT-CSO-ALT-LF-PORT-CHG
  6324         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6325           EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT
  6326         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6327         COMPUTE WS-CSO-AH-PORT-CHG =
  6328           EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT
  6329         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6330         COMPUTE WS-CSO-PORTION-CHG =
  6331           (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6332           (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6333         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6334         MOVE ZERO              TO OUT-ACCT-LF-PORT-CHG
  6335                                   OUT-ACCT-ALT-LF-PORT-CHG
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 111
* NSRASBL.cbl
  6336                                   OUT-ACCT-CMB-LF-PORT-CHG
  6337                                   OUT-ACCT-AH-PORT-CHG
  6338                                   OUT-ACCT-PORTION-CHG
  6339     ELSE
  6340         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6341                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6342         COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6343           (EN-LF-ORIG-REF-AMT * EN-LF-ORIG-REF-COMM-PCT)
  6344         MOVE WS-ACCT-ORIG-CMB-LF-PORT TO
  6345                                  OUT-ACCT-ORIG-CMB-LF-PORT
  6346         COMPUTE WS-ACCT-ORIG-AH-PORT =
  6347           (EN-AH-ORIG-REF-AMT * EN-AH-ORIG-REF-COMM-PCT)
  6348         MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6349         COMPUTE WS-ACCT-ORIG-PORTION =
  6350            WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6351         MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6352
  6353         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6354                                   OUT-CSO-ORIG-ALT-LF-PORT
  6355         COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6356           (EN-LF-ORIG-REF-AMT - WS-ACCT-ORIG-CMB-LF-PORT)
  6357         MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6358         COMPUTE WS-CSO-ORIG-AH-PORT =
  6359           (EN-AH-ORIG-REF-AMT - WS-ACCT-ORIG-AH-PORT)
  6360         MOVE WS-CSO-AH-PORTION  TO OUT-CSO-ORIG-AH-PORT
  6361         COMPUTE WS-CSO-ORIG-PORTION =
  6362            WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6363         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6364
  6365         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6366                                   OUT-ACCT-NEW-ALT-LF-PORT
  6367         COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6368           (EN-LF-NEW-REF-AMT * EN-LF-NEW-REF-COMM-PCT)
  6369         MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6370         COMPUTE WS-ACCT-NEW-AH-PORT =
  6371           (EN-AH-NEW-REF-AMT * EN-AH-NEW-REF-COMM-PCT)
  6372         MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6373         COMPUTE WS-ACCT-NEW-PORTION =
  6374            WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6375         MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6376
  6377         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6378                                   OUT-CSO-NEW-ALT-LF-PORT
  6379         COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6380           (EN-LF-NEW-REF-AMT - WS-ACCT-NEW-CMB-LF-PORT)
  6381         MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6382         COMPUTE WS-CSO-NEW-AH-PORT =
  6383           (EN-AH-NEW-REF-AMT - WS-ACCT-NEW-AH-PORT)
  6384         MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6385         COMPUTE WS-CSO-NEW-PORTION =
  6386            WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6387         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6388
  6389         MOVE ZERO               TO OUT-ACCT-LF-PORT-CHG
  6390                                    OUT-ACCT-ALT-LF-PORT-CHG
  6391         COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6392            WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6393         MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 112
* NSRASBL.cbl
  6394         COMPUTE WS-ACCT-AH-PORT-CHG =
  6395            WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6396         MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6397         COMPUTE WS-ACCT-PORTION-CHG =
  6398            WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6399         MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6400
  6401         MOVE ZERO               TO OUT-CSO-LF-PORT-CHG
  6402                                    OUT-CSO-ALT-LF-PORT-CHG
  6403         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6404            WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6405         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6406         COMPUTE WS-CSO-AH-PORT-CHG =
  6407            WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6408         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6409         COMPUTE WS-CSO-PORTION-CHG =
  6410            WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6411         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6412
  6413     END-IF
  6414     .
  6415 0620-CONTINUE.
  6416     display ' about to bld reason codes ' en-reason-code (1)
  6417     move en-reason-code (1)     to out-rea-cd1
  6418     move en-reason-code (2)     to out-rea-cd2
  6419     move en-reason-code (3)     to out-rea-cd3
  6420     move en-reason-code (4)     to out-rea-cd4
  6421     move en-reason-code (5)     to out-rea-cd5
  6422     move en-reason-code (6)     to out-rea-cd6
  6423     move en-reason-code (7)     to out-rea-cd7
  6424     move en-reason-code (8)     to out-rea-cd8
  6425     move en-reason-code (9)     to out-rea-cd9
  6426     move en-reason-code (10)    to out-rea-cd10
  6427     move en-reason-code (11)    to out-rea-cd11
  6428     move en-reason-code (12)    to out-rea-cd12
  6429*    PERFORM 1300-DETERMINE-COMM
  6430*                                THRU 1300-EXIT
  6431     .
  6432 0620-EXIT.
  6433     EXIT.
  6434 0650-PROCESS-NO-Change.
  6435     IF EN-REC-TYPE = 'C'
  6436        GO TO 0650-PROCESS-CANCEL
  6437     END-IF
  6438     if ((OUT-NEW-ILNAME = OUT-ORIG-ILNAME)
  6439        AND (OUT-NEW-ILNAME NOT = SPACES))
  6440                      AND
  6441        ((OUT-NEW-IFNAME = OUT-ORIG-IFNAME)
  6442        AND (OUT-NEW-IFNAME NOT = SPACES))
  6443                      AND
  6444        ((OUT-NEW-IMINIT = OUT-ORIG-MINIT)
  6445        AND (OUT-NEW-IFNAME NOT = SPACES))
  6446        move 'No Change'         to out-new-Ifname
  6447        MOVE SPACES              TO OUT-NEW-IMINIT
  6448        move spaces              to out-new-Ilname
  6449     ELSE
  6450         IF OUT-NEW-ILNAME = SPACES
  6451           AND OUT-NEW-IFNAME = SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 113
* NSRASBL.cbl
  6452           AND OUT-NEW-IMINIT = SPACES
  6453           AND OUT-ORIG-ILNAME NOT = SPACES
  6454            MOVE 'None'          TO OUT-NEW-IFNAME
  6455            MOVE SPACES          TO OUT-NEW-IMINIT
  6456            MOVE SPACES          TO OUT-NEW-ILNAME
  6457         END-IF
  6458     END-IF
  6459     IF ((OUT-NEW-JLNAME = OUT-ORIG-JLNAME)
  6460        AND (OUT-NEW-JLNAME NOT = SPACES))
  6461                    AND
  6462        ((OUT-NEW-JFNAME = OUT-ORIG-JFNAME)
  6463        AND (OUT-NEW-JFNAME NOT = SPACES))
  6464                    AND
  6465        ((OUT-NEW-JMINIT = OUT-ORIG-JMINIT)
  6466        AND (OUT-NEW-JFNAME NOT = SPACES))
  6467        MOVE 'No Change'         TO OUT-NEW-JFNAME
  6468        MOVE SPACES              TO OUT-NEW-JMINIT
  6469        MOVE SPACES              TO OUT-NEW-JLNAME
  6470     ELSE
  6471         IF OUT-NEW-JLNAME = SPACES
  6472           AND OUT-NEW-JFNAME = SPACES
  6473           AND OUT-NEW-JMINIT = SPACES
  6474           AND OUT-ORIG-JLNAME NOT = SPACES
  6475            MOVE 'None'          TO OUT-NEW-JFNAME
  6476            MOVE SPACES          TO OUT-NEW-JMINIT
  6477            MOVE SPACES          TO OUT-NEW-JLNAME
  6478         END-IF
  6479     END-IF
  6480     IF (EN-LF-NEW-BEN-AMT = EN-LF-ORIG-BEN-AMT)
  6481        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6482        MOVE 'No Change'         TO OUT-NEW-LF-BEN-A
  6483     ELSE
  6484         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6485           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6486             MOVE ZEROS          TO OUT-NEW-LF-BEN
  6487         END-IF
  6488     END-IF
  6489     IF (EN-LF-NEW-PRM-AMT = EN-LF-ORIG-PRM-AMT)
  6490        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6491        MOVE 'No Change'         TO OUT-NEW-LF-PRM-A
  6492     ELSE
  6493         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6494           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6495             MOVE ZEROS          TO OUT-NEW-LF-PRM
  6496         END-IF
  6497     END-IF
  6498     IF (EN-LF-NEW-ALT-BEN-AMT = EN-LF-ORIG-ALT-BEN-AMT)
  6499        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6500        MOVE 'No Change'         TO OUT-NEW-LF-ALT-BEN-A
  6501     ELSE
  6502         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6503           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6504             MOVE ZEROS          TO OUT-NEW-LF-ALT-BEN
  6505         END-IF
  6506     END-IF
  6507     IF (EN-LF-NEW-ALT-PRM-AMT = EN-LF-ORIG-ALT-PRM-AMT)
  6508        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6509        MOVE 'No Change'         TO OUT-NEW-LF-ALT-PRM-A
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 114
* NSRASBL.cbl
  6510     ELSE
  6511         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6512           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6513             MOVE ZEROS          TO OUT-NEW-LF-ALT-PRM
  6514         END-IF
  6515     END-IF
  6516
  6517     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6518                              EN-LF-ORIG-ALT-PRM-AMT
  6519     COMPUTE WS-WRK-AMOUNT2 = EN-LF-NEW-PRM-AMT +
  6520                               EN-LF-NEW-ALT-PRM-AMT
  6521     IF (WS-WRK-AMOUNT2 = WS-WRK-AMOUNT)
  6522        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6523        MOVE 'No Change'         TO OUT-NEW-LF-CMB-PREM-A
  6524     ELSE
  6525         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6526           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6527            MOVE ZEROS          TO OUT-NEW-LF-CMB-PREM
  6528         END-IF
  6529     END-IF
  6530     IF OUT-NEW-SCHED-EXP-DT = OUT-ORIG-SCHED-EXP-DT
  6531        MOVE 'No Change'         TO OUT-NEW-SCHED-EXP-DT
  6532     END-IF
  6533     IF (OUT-NEW-LF-EXP-DT = OUT-ORIG-LF-EXP-DT)
  6534        AND (OUT-NEW-LF-EXP-DT NOT = SPACES)
  6535        MOVE 'No Change'         TO OUT-NEW-LF-EXP-DT
  6536     END-IF
  6537     IF (OUT-NEW-LF-DESC = OUT-ORIG-LF-DESC)
  6538        AND (OUT-NEW-LF-DESC NOT = SPACES)
  6539        MOVE 'No Change'         to OUT-NEW-LF-DESC
  6540     ELSE
  6541        IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6542          AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6543            MOVE 'None'          TO OUT-NEW-LF-DESC
  6544        END-IF
  6545     end-if
  6546     IF (OUT-NEW-AH-EXP-DT = OUT-ORIG-AH-EXP-DT)
  6547       AND (OUT-NEW-AH-EXP-DT NOT = SPACES)
  6548        MOVE 'No Change'          TO OUT-NEW-AH-EXP-DT
  6549     END-IF
  6550     IF (EN-AH-NEW-BEN-AMT = EN-AH-ORIG-BEN-AMT)
  6551        AND (EN-AH-ORIG-BEN-AMT NOT = ZEROS)
  6552        MOVE 'No Change'         TO OUT-NEW-AH-BEN-A
  6553     ELSE
  6554         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6555           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6556             MOVE ZEROS          TO OUT-NEW-AH-BEN
  6557         END-IF
  6558     END-IF
  6559     IF (EN-AH-NEW-PRM-AMT = EN-AH-ORIG-PRM-AMT)
  6560        AND (EN-AH-ORIG-PRM-AMT NOT = ZEROS)
  6561        MOVE 'No Change'         TO OUT-NEW-AH-PRM-A
  6562     ELSE
  6563         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6564           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6565             MOVE ZEROS          TO OUT-NEW-AH-PRM
  6566         END-IF
  6567     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 115
* NSRASBL.cbl
  6568     IF (OUT-NEW-AH-DESC = OUT-ORIG-AH-DESC)
  6569        AND (OUT-ORIG-AH-DESC NOT = SPACES)
  6570        MOVE 'No Change'         TO OUT-NEW-AH-DESC
  6571     ELSE
  6572         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6573           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6574             MOVE 'None'         TO OUT-NEW-AH-DESC
  6575         END-IF
  6576     END-IF
  6577     IF EN-INS-NEW-AGE = EN-INS-ORIG-AGE
  6578       AND EN-INS-NEW-AGE-DEF-FLAG = EN-INS-ORIG-AGE-DEF-FLAG
  6579        MOVE 'No Change'         TO OUT-NEW-IAGE-A
  6580     END-IF
  6581     IF (EN-JNT-NEW-AGE = EN-JNT-ORIG-AGE)
  6582        AND (EN-JNT-ORIG-AGE NOT = ZEROS)
  6583        AND EN-JNT-NEW-AGE-DEF-FLAG = EN-JNT-ORIG-AGE-DEF-FLAG
  6584        MOVE 'No Change'         TO OUT-NEW-JAGE-A
  6585     ELSE
  6586         IF (EN-JNT-ORIG-AGE NOT = ZEROS AND SPACES)
  6587           AND (EN-JNT-NEW-AGE = ZEROS OR SPACES)
  6588             MOVE 'None'         TO OUT-NEW-JAGE-A
  6589         END-IF
  6590     END-IF
  6591     IF (EN-LF-NEW-TERM = EN-LF-ORIG-TERM)
  6592        AND (EN-LF-ORIG-TERM NOT = ZEROS)
  6593        MOVE 'No Change'         TO OUT-NEW-LF-TERM-A
  6594     ELSE
  6595         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6596           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6597             MOVE ZEROS          TO OUT-NEW-LF-TERM
  6598         END-IF
  6599     END-IF
  6600     IF (EN-AH-NEW-TERM = EN-AH-ORIG-TERM)
  6601        AND (EN-AH-ORIG-TERM NOT = ZEROS)
  6602        MOVE 'No Change'         TO OUT-NEW-AH-TERM-A
  6603     ELSE
  6604         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6605           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6606             MOVE ZEROS          TO OUT-NEW-AH-TERM
  6607         END-IF
  6608     END-IF
  6609     IF (EN-AH-NEW-CP = EN-AH-ORIG-CP)
  6610        AND (EN-AH-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6611        MOVE 'No Change'         TO OUT-NEW-CRIT-PER-A
  6612                                    OUT-NEW-MAX-PMTS-A
  6613     ELSE
  6614         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6615           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6616             MOVE 'None'         TO OUT-NEW-CRIT-PER-A
  6617                                    OUT-NEW-MAX-PMTS-A
  6618         END-IF
  6619     END-IF
  6620     IF OUT-NEW-SCHED-TERM = OUT-ORIG-SCHED-TERM
  6621        MOVE 'No Change'         TO OUT-NEW-SCHED-TERM-A
  6622     END-IF
  6623     IF (OUT-NEW-WAIT-PER = OUT-ORIG-WAIT-PER)
  6624       AND (OUT-ORIG-WAIT-PER NOT = SPACES)
  6625         MOVE 'No Change'        TO OUT-NEW-WAIT-PER
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 116
* NSRASBL.cbl
  6626     ELSE
  6627         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6628           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6629             MOVE 'None'         TO OUT-NEW-WAIT-PER
  6630         END-IF
  6631     END-IF
  6632     .
  6633 0650-PROCESS-CANCEL.
  6634     .
  6635 0650-EXIT.
  6636     EXIT.
  6637 0700-WRITE-EXTR.
  6638     display ' made it to 0700 '
  6639     PERFORM 1000-BUILD-ERARCH   THRU 1000-EXIT
  6640     IF BL-FAIL
  6641        MOVE ' COULDNT BUILD ERARCH ' TO BL-MESSAGE
  6642        GO TO 0700-EXIT
  6643     END-IF
  6644     MOVE WS-COMPANY-CD          TO NSAS-COMPANY-CD
  6645     MOVE BL-ARCHIVE-NO          TO NSAS-ARCHIVE-NO
  6646     MOVE +0                     TO NSAS-SEQ-NO
  6647     PERFORM 0710-BUILD-NSASEXTR THRU 0710-EXIT
  6648     PERFORM 0720-WRITE-NSASEXTR THRU 0720-EXIT
  6649     IF BL-FAIL
  6650        MOVE ' COULDNT BUILD STD NSASEXTR ' TO BL-MESSAGE
  6651        GO TO 0700-EXIT
  6652     END-IF
  6653     IF W-LETTER-TO-ACCT NOT = SPACES
  6654        display ' acct ne spaces ' bl-archive-no
  6655        MOVE W-LETTER-TO-ACCT   TO NSAS-LETTER-VARIABLES (5:1)
  6656        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  6657        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  6658        MOVE +1                  TO NSAS-SEQ-NO
  6659        PERFORM 0720-WRITE-NSASEXTR
  6660                                 THRU 0720-EXIT
  6661        IF BL-FAIL
  6662           MOVE ' COULDNT BUILD ACCT NSASEXTR ' TO BL-MESSAGE
  6663           GO TO 0700-EXIT
  6664        END-IF
  6665     END-IF
  6666     IF W-LETTER-TO-BENE NOT = SPACES
  6667        display ' bene ne spaces ' bl-archive-no
  6668        MOVE W-LETTER-TO-BENE   TO NSAS-LETTER-VARIABLES (5:1)
  6669        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  6670        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  6671        MOVE +2                  TO NSAS-SEQ-NO
  6672        PERFORM 0720-WRITE-NSASEXTR
  6673                                 THRU 0720-EXIT
  6674        IF BL-FAIL
  6675           MOVE ' COULDNT BUILD BENE NSASEXTR ' TO BL-MESSAGE
  6676        END-IF
  6677     END-IF
  6678     IF W-PRINT-CERTIFICATE = 'Y' AND
  6679        BL-STATE = 'VA'
  6680           MOVE OUT-ACCT-NAME       TO VD-ACCOUNT-NAME
  6681           MOVE WS-COMPANY-CD       TO VD-COMPANY-CD
  6682           MOVE BL-CARRIER          TO VD-CARRIER
  6683           MOVE BL-GROUP            TO VD-GROUPING
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 117
* NSRASBL.cbl
  6684           MOVE BL-STATE            TO VD-STATE
  6685           MOVE BL-ACCOUNT          TO VD-ACCOUNT
  6686           MOVE WS-ELCERT-EFF-DT    TO VD-CERT-EFF-DT
  6687           MOVE BL-CERT-NO          TO VD-CERT-NO
  6688           MOVE OUT-ILNAME          TO VD-INSURED-LAST-NAME
  6689           MOVE OUT-IFNAME          TO VD-INSURED-FIRST-NAME
  6690           MOVE OUT-IMINIT          TO VD-INSURED-MIDDLE-INIT
  6691           MOVE OUT-JLNAME          TO VD-JOINT-LAST-NAME
  6692           MOVE OUT-JFNAME          TO VD-JOINT-FIRST-NAME
  6693           MOVE OUT-JMINIT          TO VD-JOINT-MIDDLE-INIT
  6694           MOVE OUT-BENE-NAME       TO VD-BENEFICIARY-NAME
  6695           MOVE OUT-ENTRY-BATCH     TO VD-ENTRY-BATCH
  6696           MOVE OUT-CSR-CODE        TO VD-CSR-ID
  6697           MOVE CM-LF-BENEFIT-CD    TO VD-LF-BENEFIT-CD
  6698           MOVE CM-LF-PREMIUM-AMT   TO VD-LF-PREMIUM-AMT
  6699           MOVE CM-LF-BENEFIT-AMT   TO VD-LF-BENEFIT-AMT
  6700           MOVE CM-LF-ORIG-TERM     TO VD-LF-TERM
  6701           MOVE CM-LF-PREMIUM-RATE  TO VD-LF-RATE
  6702           MOVE CM-AH-BENEFIT-CD    TO VD-AH-BENEFIT-CD
  6703           MOVE CM-AH-PREMIUM-AMT   TO VD-AH-PREMIUM-AMT
  6704           MOVE CM-AH-BENEFIT-AMT   TO VD-AH-BENEFIT-AMT
  6705           MOVE CM-AH-ORIG-TERM     TO VD-AH-TERM
  6706           MOVE CM-AH-PREMIUM-RATE  TO VD-AH-RATE
  6707           MOVE CM-LOAN-TERM        TO VD-LOAN-TERM
  6708           MOVE CM-LOAN-APR         TO VD-LOAN-APR
  6709           MOVE CM-LOAN-1ST-PMT-DT  TO VD-1ST-PMT-DT
  6710           MOVE OUT-INS-ADDR1       TO VD-INSURED-ADDRESS-1
  6711           MOVE OUT-INS-ADDR2       TO VD-INSURED-ADDRESS-2
  6712           MOVE OUT-INS-CITY        TO VD-INSURED-CITY
  6713           MOVE OUT-INS-STATE       TO VD-INSURED-STATE
  6714           MOVE OUT-INS-ZIP         TO VD-INSURED-ZIP-CODE
  6715           MOVE 'VADS'              TO VD-LETTER-ID
  6716           MOVE OUT-PROC-ID         TO VD-PROC-ID
  6717           MOVE BL-COMP-ID          TO VD-COMP-ID
  6718           MOVE EIBTIME             TO VD-CURRENT-TIME
  6719           MOVE SAVE-BIN-DATE       TO VD-CURRENT-DATE
  6720           MOVE BL-ARCHIVE-NO       TO VD-ARCHIVE-NO
  6721           MOVE VIRGINIA-DISCLOSURE TO WS-PASS-VADS-REC
  6722
  6723* EXEC CICS LINK
  6724*              PROGRAM    (LINK-ELVADS)
  6725*              COMMAREA   (WS-PASS-AREA)
  6726*              LENGTH     (WS-PASS-AREA-LENGTH)
  6727*          END-EXEC
  6728*    MOVE '."C                   (   #00006667' TO DFHEIV0
  6729     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6730     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6731     MOVE X'2020233030303036363637' TO DFHEIV0(25:11)
  6732     CALL 'kxdfhei1' USING DFHEIV0,
  6733           LINK-ELVADS,
  6734           WS-PASS-AREA,
  6735           WS-PASS-AREA-LENGTH,
  6736           DFHEIV99,
  6737           DFHEIV99,
  6738           DFHEIV99,
  6739           DFHEIV99
  6740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6741     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 118
* NSRASBL.cbl
  6742     .
  6743 0700-EXIT.
  6744     EXIT.
  6745  0710-BUILD-NSASEXTR.
  6746***  i added the extra space in front of the 1st ~
  6747***  only because there may be a letter to acct or bene
  6748     STRING
  6749         OUT-LETTER             ' ~'
  6750         OUT-PROC-ID            '~'
  6751         OUT-PROC-NAME          '~'
  6752         OUT-PROC-TITLE         '~'
  6753         OUT-CSR-NAME           '~'
  6754         OUT-CSR-TITLE          '~'
  6755         OUT-CARRIER            '~'
  6756         OUT-GROUPING           '~'
  6757         OUT-STATE              '~'
  6758         OUT-ACCOUNT            '~'
  6759         OUT-CERT-EFF-DT        '~'
  6760         OUT-CERT-NO            '~'
  6761         OUT-CERT-SFX           '~'
  6762         OUT-ILNAME             '~'
  6763         OUT-IFNAME             '~'
  6764         OUT-IFINIT             '~'
  6765         OUT-IMINIT             '~'
  6766         OUT-IAGE               '~'
  6767         OUT-ISEX               '~'
  6768         OUT-INS-ADDR1          '~'
  6769         OUT-INS-ADDR2          '~'
  6770         OUT-INS-CITY           '~'
  6771         OUT-INS-STATE          '~'
  6772         OUT-INS-ZIP            '~'
  6773         OUT-SOC-SEC-NO         '~'
  6774         OUT-MEMBER-NO          '~'
  6775         OUT-JLNAME             '~'
  6776         OUT-JFNAME             '~'
  6777         OUT-JMINIT             '~'
  6778         OUT-JAGE               '~'
  6779         OUT-ACCT-NAME          '~'
  6780         OUT-ACCT-ADDR1         '~'
  6781         OUT-ACCT-ADDR2         '~'
  6782         OUT-ACCT-CITY          '~'
  6783         OUT-ACCT-STATE         '~'
  6784         OUT-ACCT-ZIP           '~'
  6785         OUT-ACCT-PHONE         '~'
  6786         OUT-ACCT-CNTRL-NAME    '~'
  6787         OUT-ACCT-BUS-TYPE      '~'
  6788         OUT-BENE-NAME          '~'
  6789         OUT-BENE-ADDR1         '~'
  6790         OUT-BENE-ADDR2         '~'
  6791         OUT-BENE-CITY          '~'
  6792         OUT-BENE-STATE         '~'
  6793         OUT-BENE-ZIP           '~'
  6794         OUT-CARR-NAME          '~'
  6795         OUT-RESP-NO            '~'
  6796         OUT-COMP-NAME          '~'
  6797         OUT-COMP-MAIL-TO       '~'
  6798         OUT-COMP-ADDR1         '~'
  6799         OUT-COMP-ADDR2         '~'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 119
* NSRASBL.cbl
  6800         OUT-COMP-CITY          '~'
  6801         OUT-COMP-STATE         '~'
  6802         OUT-COMP-ZIP           '~'
  6803         OUT-COMP-PHONE         '~'
  6804         OUT-COMP-FAX           '~'
  6805         OUT-COMP-STATUS        '~'
  6806         OUT-BILL-SW            '~'
  6807         OUT-RPT-CD1            '~'
  6808         OUT-RPT-CD2            '~'
  6809         OUT-ENTRY-DT           '~'
  6810         OUT-ENTRY-BATCH        '~'
  6811         OUT-ENTRY-STATUS       '~'
  6812         OUT-1ST-PMT-DT         '~'
  6813         OUT-LOAN-APR           '~'
  6814         OUT-LOAN-TERM          '~'
  6815         OUT-RATE-CLASS         '~'
  6816         OUT-EXT-DAYS           '~'
  6817         OUT-CSR-CODE           '~'
  6818         OUT-UCODE              '~'
  6819         OUT-PREM-TYPE          '~'
  6820         OUT-IND-GRP            '~'
  6821         OUT-SKIP-CD            '~'
  6822         OUT-PMT-MODE           '~'
  6823         OUT-LOAN-OFF           '~'
  6824         OUT-REIN-TABLE         '~'
  6825         OUT-SPEC-REIN          '~'
  6826         OUT-LF-BENCD           '~'
  6827         OUT-LF-TERM            '~'
  6828         OUT-LF-DEV-CD          '~'
  6829         OUT-LF-DEV-PCT         '~'
  6830         OUT-LF-BEN             '~'
  6831         OUT-LF-PRM             '~'
  6832         OUT-LF-ALT-BEN         '~'
  6833         OUT-LF-ALT-PRM         '~'
  6834         OUT-LF-NSP             '~'
  6835         OUT-LF-REM-BEN         '~'
  6836         OUT-LF-REF             '~'
  6837         OUT-LF-DTH             '~'
  6838         OUT-LF-RATE            '~'
  6839         OUT-LF-ALT-RATE        '~'
  6840         OUT-LF-EXP-DT          '~'
  6841         OUT-LF-CUR-STATUS      '~'
  6842         OUT-LF-CAN-DT          '~'
  6843         OUT-LF-CAN-EXIT-DT     '~'
  6844         OUT-LF-DTH-DT          '~'
  6845         OUT-LF-DTH-EXIT-DT     '~'
  6846         OUT-LF-EXIT-BATCH      '~'
  6847         OUT-LF-COMM-PCT        '~'
  6848         OUT-LF-DESC            '~'
  6849         OUT-LF-ABBRV           '~'
  6850         OUT-AH-BENCD           '~'
  6851         OUT-AH-TERM            '~'
  6852         OUT-CRIT-PER           '~'
  6853         OUT-AH-DEV-CD          '~'
  6854         OUT-AH-DEV-PCT         '~'
  6855         OUT-AH-BEN             '~'
  6856         OUT-AH-PRM             '~'
  6857         OUT-AH-NSP             '~'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 120
* NSRASBL.cbl
  6858         OUT-AH-REF             '~'
  6859         OUT-AH-CLM             '~'
  6860         OUT-AH-TOT-BEN         '~'
  6861         OUT-AH-PDTHRU-DT       '~'
  6862         OUT-AH-RATE            '~'
  6863         OUT-AH-EXP-DT          '~'
  6864         OUT-AH-CUR-STATUS      '~'
  6865         OUT-AH-CAN-DT          '~'
  6866         OUT-AH-CAN-EXIT-DT     '~'
  6867         OUT-AH-EXIT-BATCH      '~'
  6868         OUT-AH-COMM-PCT        '~'
  6869         OUT-AH-DESC            '~'
  6870         OUT-RET-ELIM           '~'
  6871         OUT-BEN-DAYS           '~'
  6872         OUT-WAIT-PER           '~'
  6873         OUT-MAX-PMTS           '~'
  6874         OUT-TOT-PRM            '~'
  6875         OUT-TOT-REF            '~'
  6876         OUT-SCHED-EXP-DT       '~'
  6877         OUT-SCHED-TERM         '~'
  6878         OUT-ORIG-ILNAME        '~'
  6879         OUT-ORIG-IFNAME        '~'
  6880         OUT-ORIG-MINIT         '~'
  6881         OUT-ORIG-IAGE          '~'
  6882         OUT-ORIG-JLNAME        '~'
  6883         OUT-ORIG-JFNAME        '~'
  6884         OUT-ORIG-JMINIT        '~'
  6885         OUT-ORIG-JAGE          '~'
  6886         OUT-ORIG-LF-BENCD      '~'
  6887         OUT-ORIG-LF-TERM       '~'
  6888         OUT-ORIG-LF-BEN        '~'
  6889         OUT-ORIG-LF-PRM        '~'
  6890         OUT-LF-CALC-PRM        '~'
  6891         OUT-ORIG-LF-REF        '~'
  6892         OUT-LF-CALC-REF        '~'
  6893         OUT-ORIG-LF-ALT-BEN    '~'
  6894         OUT-ORIG-LF-ALT-PRM    '~'
  6895         OUT-ORIG-LF-EXP-DT     '~'
  6896         OUT-ORIG-LF-DESC       '~'
  6897         OUT-ORIG-AH-BENCD      '~'
  6898         OUT-ORIG-AH-TERM       '~'
  6899         OUT-ORIG-CRIT-PER      '~'
  6900         OUT-ORIG-AH-BEN        '~'
  6901         OUT-ORIG-AH-PRM        '~'
  6902         OUT-AH-CALC-PRM        '~'
  6903         OUT-ORIG-AH-REF        '~'
  6904         OUT-AH-CALC-REF        '~'
  6905         OUT-ORIG-AH-EXP-DT     '~'
  6906         OUT-ORIG-AH-DESC       '~'
  6907         OUT-ORIG-RET-ELIM      '~'
  6908         OUT-ORIG-BEN-DAYS      '~'
  6909         OUT-ORIG-WAIT-PER      '~'
  6910         OUT-ORIG-MAX-PMTS      '~'
  6911         OUT-ORIG-SCHED-EXP-DT  '~'
  6912         OUT-ORIG-SCHED-TERM    '~'
  6913         OUT-NEW-ILNAME         '~'
  6914         OUT-NEW-IFNAME         '~'
  6915         OUT-NEW-IMINIT         '~'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 121
* NSRASBL.cbl
  6916         OUT-NEW-IAGE           '~'
  6917         OUT-NEW-JLNAME         '~'
  6918         OUT-NEW-JFNAME         '~'
  6919         OUT-NEW-JMINIT         '~'
  6920         OUT-NEW-JAGE           '~'
  6921         OUT-NEW-LF-BENCD       '~'
  6922         OUT-NEW-LF-TERM        '~'
  6923         OUT-NEW-LF-BEN         '~'
  6924         OUT-NEW-LF-PRM         '~'
  6925         OUT-NEW-LF-REF         '~'
  6926         OUT-NEW-LF-ALT-BEN     '~'
  6927         OUT-NEW-LF-ALT-PRM     '~'
  6928         OUT-NEW-LF-EXP-DT      '~'
  6929         OUT-NEW-LF-DESC        '~'
  6930         OUT-NEW-AH-BENCD       '~'
  6931         OUT-NEW-AH-TERM        '~'
  6932         OUT-NEW-CRIT-PER       '~'
  6933         OUT-NEW-AH-BEN         '~'
  6934         OUT-NEW-AH-PRM         '~'
  6935         OUT-NEW-AH-REF         '~'
  6936         OUT-NEW-AH-EXP-DT      '~'
  6937         OUT-NEW-AH-DESC        '~'
  6938         OUT-NEW-RET-ELIM       '~'
  6939         OUT-NEW-BEN-DAYS       '~'
  6940         OUT-NEW-WAIT-PER       '~'
  6941         OUT-NEW-MAX-PMTS       '~'
  6942         OUT-NEW-SCHED-EXP-DT   '~'
  6943         OUT-NEW-SCHED-TERM     '~'
  6944         OUT-TOT-PRM-CHG        '~'
  6945         OUT-TOT-REF-CHG        '~'
  6946         OUT-PAYEE              '~'
  6947         OUT-SIG-SW             '~'
  6948         OUT-BALLOON-IND        '~'
  6949         OUT-LEASE-IND          '~'
  6950         OUT-RESCIND            '~'
  6951         OUT-REA-CD1            '~'
  6952         OUT-REA-CD2            '~'
  6953         OUT-REA-CD3            '~'
  6954         OUT-REA-CD4            '~'
  6955         OUT-REA-CD5            '~'
  6956         OUT-REA-CD6            '~'
  6957         OUT-REA-CD7            '~'
  6958         OUT-REA-CD8            '~'
  6959         OUT-REA-CD9            '~'
  6960         OUT-REA-CD10           '~'
  6961         OUT-REA-CD11           '~'
  6962         OUT-REA-CD12           '~'
  6963         OUT-CYCLE-DT           '~'
  6964         OUT-ARCH-NO            '~'
  6965         OUT-FORM               '~'
  6966         OUT-ENC-LINE           '~'
  6967         OUT-ATTACH             '~'
  6968         OUT-STACK              '~'
  6969         OUT-STATE-NAME         '~'
  6970         OUT-PRINT-NOW          '~'
  6971         OUT-CHGBACK            '~'
  6972         OUT-CSO-PORTION        '~'
  6973         OUT-ACCT-PORTION       '~'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 122
* NSRASBL.cbl
  6974         OUT-LETTER-TYPE        '~'
  6975         OUT-PRINT-CERTIFICATE  '~'
  6976         OUT-INS-BIRTHDATE      '~'
  6977         OUT-JNT-BIRTHDATE      '~'
  6978         OUT-TOT-INTEREST       '~'
  6979         OUT-ORIG-TOT-PREM      '~'
  6980         OUT-ORIG-TOT-REF       '~'
  6981         OUT-CANCEL-DT          '~'
  6982         OUT-HEALTH-APP         '~'
  6983         OUT-CERTIFICATE-ID     '~'
  6984         OUT-UNDW-ID            '~'
  6985         OUT-NEW-TOT-PREM       '~'
  6986         OUT-NEW-TOT-REF        '~'
  6987         OUT-COVERAGE-IND       '~'
  6988         OUT-ORIG-COVERAGE-IND  '~'
  6989         OUT-NEW-COVERAGE-IND   '~'
  6990         OUT-LF-CMB-PREM        '~'
  6991         OUT-ORIG-LF-CMB-PREM   '~'
  6992         OUT-NEW-LF-CMB-PREM    '~'
  6993         OUT-LF-PREM-CHG        '~'
  6994         OUT-LF-ALT-PREM-CHG    '~'
  6995         OUT-LF-CMB-PREM-CHG    '~'
  6996         OUT-AH-PREM-CHG        '~'
  6997         OUT-LF-REF-CHG         '~'
  6998         OUT-AH-REF-CHG         '~'
  6999         OUT-ACCT-LF-PORTION    '~'
  7000         OUT-ACCT-ALT-LF-PORT   '~'
  7001         OUT-ACCT-CMB-LF-PORT   '~'
  7002         OUT-ACCT-AH-PORTION    '~'
  7003         OUT-CSO-LF-PORTION     '~'
  7004         OUT-CSO-ALT-LF-PORT    '~'
  7005         OUT-CSO-CMB-LF-PORT    '~'
  7006         OUT-CSO-AH-PORTION     '~'
  7007         OUT-ACCT-ORIG-LF-PORT  '~'
  7008         OUT-ACCT-ORIG-ALT-LF-PORT '~'
  7009         OUT-ACCT-ORIG-CMB-LF-PORT '~'
  7010         OUT-ACCT-ORIG-AH-PORT  '~'
  7011         OUT-ACCT-ORIG-PORTION  '~'
  7012         OUT-CSO-ORIG-LF-PORT   '~'
  7013         OUT-CSO-ORIG-ALT-LF-PORT '~'
  7014         OUT-CSO-ORIG-CMB-LF-PORT '~'
  7015         OUT-CSO-ORIG-AH-PORT   '~'
  7016         OUT-CSO-ORIG-PORTION   '~'
  7017         OUT-ACCT-NEW-LF-PORT   '~'
  7018         OUT-ACCT-NEW-ALT-LF-PORT '~'
  7019         OUT-ACCT-NEW-CMB-LF-PORT '~'
  7020         OUT-ACCT-NEW-AH-PORT   '~'
  7021         OUT-ACCT-NEW-PORTION   '~'
  7022         OUT-CSO-NEW-LF-PORT    '~'
  7023         OUT-CSO-NEW-ALT-LF-PORT '~'
  7024         OUT-CSO-NEW-CMB-LF-PORT '~'
  7025         OUT-CSO-NEW-AH-PORT    '~'
  7026         OUT-CSO-NEW-PORTION    '~'
  7027         OUT-ACCT-LF-PORT-CHG   '~'
  7028         OUT-ACCT-ALT-LF-PORT-CHG '~'
  7029         OUT-ACCT-CMB-LF-PORT-CHG '~'
  7030         OUT-ACCT-AH-PORT-CHG   '~'
  7031         OUT-ACCT-PORTION-CHG   '~'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 123
* NSRASBL.cbl
  7032         OUT-CSO-LF-PORT-CHG    '~'
  7033         OUT-CSO-ALT-LF-PORT-CHG '~'
  7034         OUT-CSO-CMB-LF-PORT-CHG '~'
  7035         OUT-CSO-AH-PORT-CHG    '~'
  7036         OUT-CSO-PORTION-CHG    '~'
  7037         OUT-ORIG-LF-CAN-DT     '~'
  7038         OUT-NEW-LF-CAN-DT      '~'
  7039         OUT-ORIG-AH-CAN-DT     '~'
  7040         OUT-NEW-AH-CAN-DT      '~'
  7041         OUT-ORIG-CAN-DT        '~'
  7042         OUT-NEW-CAN-DT         '~'
  7043         OUT-SCREEN-ID          '~'
  7044            DELIMITED BY '   ' INTO NSAS-LETTER-VARIABLES
  7045     END-STRING
  7046     .
  7047 0710-exit.
  7048     EXIT.
  7049 0720-WRITE-NSASEXTR.
  7050
  7051* EXEC CICS WRITE
  7052*       DATASET    ('NSASEXTR')
  7053*       FROM       (NSAS-EXTRACT-RECORD)
  7054*       RIDFLD     (NSAS-CONTROL-PRIMARY)
  7055*       RESP       (WS-RESPONSE)
  7056*    END-EXEC
  7057     MOVE LENGTH OF
  7058      NSAS-EXTRACT-RECORD
  7059       TO DFHEIV11
  7060     MOVE 'NSASEXTR' TO DFHEIV1
  7061*    MOVE '&$ L                  ''  N#00006981' TO DFHEIV0
  7062     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7063     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7064     MOVE X'204E233030303036393831' TO DFHEIV0(25:11)
  7065     CALL 'kxdfhei1' USING DFHEIV0,
  7066           DFHEIV1,
  7067           NSAS-EXTRACT-RECORD,
  7068           DFHEIV11,
  7069           NSAS-CONTROL-PRIMARY,
  7070           DFHEIV99,
  7071           DFHEIV99
  7072     MOVE EIBRESP  TO WS-RESPONSE
  7073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7074     IF NOT RESP-NORMAL
  7075        display ' bad write nsasextr ' ws-response
  7076        SET BL-FAIL TO TRUE
  7077     END-IF
  7078     .
  7079 0720-EXIT.
  7080     EXIT.
  7081 0800-init-out-data.
  7082     MOVE ZEROS                  TO OUT-IAGE
  7083                                    OUT-JAGE
  7084                                    OUT-LOAN-APR
  7085                                    OUT-LOAN-TERM
  7086                                    OUT-EXT-DAYS
  7087                                    OUT-LF-TERM
  7088                                    OUT-AH-TERM
  7089                                    OUT-LF-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 124
* NSRASBL.cbl
  7090                                    OUT-AH-DEV-PCT
  7091                                    OUT-LF-BEN
  7092                                    OUT-AH-BEN
  7093                                    OUT-CRIT-PER
  7094                                    OUT-MAX-PMTS
  7095                                    OUT-SCHED-TERM
  7096                                    OUT-ORIG-IAGE
  7097                                    OUT-ORIG-JAGE
  7098                                    OUT-NEW-IAGE
  7099                                    OUT-NEW-JAGE
  7100                                    OUT-ORIG-LF-TERM
  7101                                    OUT-ORIG-AH-TERM
  7102                                    OUT-NEW-LF-TERM
  7103                                    OUT-NEW-AH-TERM
  7104                                    OUT-ORIG-CRIT-PER
  7105                                    OUT-ORIG-MAX-PMTS
  7106                                    OUT-ORIG-SCHED-TERM
  7107                                    OUT-NEW-SCHED-TERM
  7108                                    OUT-NEW-CRIT-PER
  7109                                    OUT-NEW-MAX-PMTS
  7110                                    OUT-CSO-PORTION
  7111                                    OUT-CSO-LF-PORTION
  7112                                    OUT-CSO-ALT-LF-PORT
  7113                                    OUT-CSO-CMB-LF-PORT
  7114                                    OUT-CSO-AH-PORTION
  7115                                    OUT-ACCT-PORTION
  7116                                    OUT-ACCT-LF-PORTION
  7117                                    OUT-ACCT-ALT-LF-PORT
  7118                                    OUT-ACCT-CMB-LF-PORT
  7119                                    OUT-ACCT-AH-PORTION
  7120                                    OUT-LF-PREM-CHG
  7121                                    OUT-LF-ALT-PREM-CHG
  7122                                    OUT-LF-CMB-PREM-CHG
  7123                                    OUT-AH-PREM-CHG
  7124                                    OUT-LF-REF-CHG
  7125                                    OUT-AH-REF-CHG
  7126     .
  7127 0800-exit.
  7128     exit.
  7129 1000-BUILD-ERARCH.
  7130* DATA SOURCE MEANINGS  BL-DATA-SRCE
  7131*    1) FROM ACCT MAINT
  7132*    2) FROM CERT UPDATE
  7133*    3) FROM COMP MAINT
  7134*    4) FROM REVIEW AND CORRECTIONS
  7135******************************************************************
  7136     MOVE 'LA'                   TO LETTER-ARCHIVE
  7137     MOVE BL-ARCHIVE-NO          TO LA-ARCHIVE-NO
  7138                                    LA-ARCHIVE-NO-A2
  7139                                    LA-ARCHIVE-NO-A3
  7140                                    LA-ARCHIVE-NO-A4
  7141                                    LA-ARCHIVE-NO-A5
  7142                                    LA-ARCHIVE-NO-A6
  7143     MOVE WS-COMPANY-CD          TO LA-COMPANY-CD
  7144                                    LA-COMPANY-CD-A2
  7145                                    LA-COMPANY-CD-A3
  7146                                    LA-COMPANY-CD-A4
  7147                                    LA-COMPANY-CD-A5
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 125
* NSRASBL.cbl
  7148                                    LA-COMPANY-CD-A6
  7149     MOVE BL-CARRIER             TO LA-CARRIER-A2
  7150                                    LA-CARRIER-A3
  7151                                    LA-CARRIER-A4
  7152                                    LA-CARRIER-A5
  7153     MOVE BL-GROUP               TO LA-GROUPING-A2
  7154                                    LA-GROUPING-A3
  7155                                    LA-GROUPING-A4
  7156                                    LA-GROUPING-A5
  7157     MOVE BL-ACCOUNT             TO LA-ACCOUNT-A2
  7158                                    LA-ACCOUNT-A3
  7159                                    LA-ACCOUNT-A4
  7160                                    LA-ACCOUNT-A5
  7161     MOVE BL-STATE               TO LA-STATE-A2
  7162                                    LA-STATE-A3
  7163                                    LA-STATE-A4
  7164                                    LA-STATE-A5
  7165     IF BL-DATA-SRCE = '2' OR '4'
  7166        MOVE WS-ELCERT-EFF-DT    TO LA-EFFECT-DATE-A2
  7167        MOVE BL-CERT-NO          TO LA-CERT-NO-A2
  7168     ELSE
  7169        MOVE LOW-VALUES          TO LA-EFFECT-DATE-A2
  7170     END-IF
  7171     IF BL-DATA-SRCE = '4'
  7172        MOVE BL-BATCH-NO         TO LA-ENTRY-A6
  7173     END-IF
  7174     MOVE BL-PROC-ID             TO LA-PROCESSOR-CD
  7175                                    LA-LAST-UPDATED-BY
  7176     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7177                                    LA-INITIAL-PRINT-DATE
  7178                                    LA-SENT-DATE
  7179                                    LA-REPLY-DATE
  7180                                    LA-RESEND-DATE
  7181                                    LA-FOLLOW-UP-DATE
  7182     MOVE 'A'                    TO LA-STATUS
  7183     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7184     MOVE W-FORM-TO-RESEND       TO LA-RESEND-LETR
  7185     IF W-DAYS-TO-RESEND NOT NUMERIC
  7186        MOVE ZEROS               TO W-DAYS-TO-RESEND
  7187     END-IF
  7188     IF W-DAYS-TO-RESEND > ZEROS
  7189        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7190        MOVE W-DAYS-TO-RESEND  TO DC-ELAPSED-DAYS
  7191        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7192        MOVE '6'                 TO DC-OPTION-CODE
  7193        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7194        IF NO-CONVERSION-ERROR
  7195           MOVE DC-BIN-DATE-2    TO LA-RESEND-DATE
  7196        END-IF
  7197     END-IF
  7198     IF W-DAYS-TO-FOLLOW-UP >= ZEROS
  7199        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7200        MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  7201        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7202        MOVE '6'                 TO DC-OPTION-CODE
  7203        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7204        IF NO-CONVERSION-ERROR
  7205           MOVE DC-BIN-DATE-2    TO LA-FOLLOW-UP-DATE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 126
* NSRASBL.cbl
  7206        END-IF
  7207     END-IF
  7208
  7209     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7210     MOVE BL-LETTER-ID           TO LA-FORM-A3
  7211     MOVE BL-DATA-SRCE           TO LA-DATA-SOURCE
  7212     MOVE BL-WRITE-ERARCH        TO LA-ARCHIVE-STATUS
  7213     IF BL-ENDT-ARCH-NO > ZEROS
  7214        MOVE BL-ENDT-ARCH-NO     TO LA-ENDT-ARCH-NO
  7215     ELSE
  7216        MOVE BL-ARCHIVE-NO       TO LA-ENDT-ARCH-NO
  7217     END-IF
  7218     MOVE SAVE-BIN-DATE          TO LA-CREATION-DATE
  7219                                    LA-LAST-MAINT-DATE
  7220     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7221                                    LA-NO-OF-TEXT-RECORDS
  7222     MOVE EIBTIME                TO LA-LAST-MAINT-TIME
  7223
  7224* EXEC CICS WRITE
  7225*         DATASET   ('ERARCH')
  7226*         FROM      (LETTER-ARCHIVE)
  7227*         RIDFLD    (LA-CONTROL-PRIMARY)
  7228*         RESP      (WS-RESPONSE)
  7229*    END-EXEC
  7230     MOVE LENGTH OF
  7231      LETTER-ARCHIVE
  7232       TO DFHEIV11
  7233     MOVE 'ERARCH' TO DFHEIV1
  7234*    MOVE '&$ L                  ''  N#00007136' TO DFHEIV0
  7235     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7236     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7237     MOVE X'204E233030303037313336' TO DFHEIV0(25:11)
  7238     CALL 'kxdfhei1' USING DFHEIV0,
  7239           DFHEIV1,
  7240           LETTER-ARCHIVE,
  7241           DFHEIV11,
  7242           LA-CONTROL-PRIMARY,
  7243           DFHEIV99,
  7244           DFHEIV99
  7245     MOVE EIBRESP  TO WS-RESPONSE
  7246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7247     IF NOT RESP-NORMAL
  7248        DISPLAY ' BAD WRITE ON ERARCH ' WS-RESPONSE ' '
  7249        la-archive-no
  7250        SET BL-FAIL TO TRUE
  7251     END-IF
  7252     .
  7253 1000-EXIT.
  7254     EXIT.
  7255 1025-GET-CSR-INFO.
  7256     MOVE WS-CSR-ID              TO OUT-CSR-CODE
  7257                                    OUT-CSR-TITLE
  7258                                    OUT-PROC-TITLE
  7259                                    OUT-UNDW-ID
  7260     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7261     MOVE '2'                    TO WS-ELCNTL-REC-TYPE
  7262     MOVE WS-CSR-ID              TO WS-ELCNTL-GENL
  7263     MOVE +0                     TO WS-ELCNTL-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 127
* NSRASBL.cbl
  7264
  7265* EXEC CICS READ
  7266*       INTO    (CONTROL-FILE)
  7267*       DATASET ('ELCNTL')
  7268*       RIDFLD  (WS-ELCNTL-KEY)
  7269*       RESP    (WS-RESPONSE)
  7270*    END-EXEC
  7271     MOVE LENGTH OF
  7272      CONTROL-FILE
  7273       TO DFHEIV11
  7274     MOVE 'ELCNTL' TO DFHEIV1
  7275*    MOVE '&"IL       E          (  N#00007159' TO DFHEIV0
  7276     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7277     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7278     MOVE X'204E233030303037313539' TO DFHEIV0(25:11)
  7279     CALL 'kxdfhei1' USING DFHEIV0,
  7280           DFHEIV1,
  7281           CONTROL-FILE,
  7282           DFHEIV11,
  7283           WS-ELCNTL-KEY,
  7284           DFHEIV99,
  7285           DFHEIV99,
  7286           DFHEIV99
  7287     MOVE EIBRESP  TO WS-RESPONSE
  7288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7289     IF RESP-NORMAL
  7290        MOVE CF-PROCESSOR-NAME   TO OUT-CSR-NAME
  7291                                    OUT-PROC-NAME
  7292*       MOVE CF-PROCESSOR-TITLE  TO OUT-CSR-TITLE
  7293*                                   OUT-PROC-TITLE
  7294     END-IF
  7295     IF BL-PROC-ID NOT = PB-CSR-ID
  7296        MOVE BL-COMP-ID          TO WS-ELCNTL-KEY
  7297        MOVE '2'                 TO WS-ELCNTL-REC-TYPE
  7298        MOVE BL-PROC-ID          TO WS-ELCNTL-GENL
  7299                                    OUT-PROC-TITLE
  7300        MOVE +0                  TO WS-ELCNTL-SEQ-NO
  7301
  7302* EXEC CICS READ
  7303*          INTO    (CONTROL-FILE)
  7304*          DATASET ('ELCNTL')
  7305*          RIDFLD  (WS-ELCNTL-KEY)
  7306*          RESP    (WS-RESPONSE)
  7307*       END-EXEC
  7308     MOVE LENGTH OF
  7309      CONTROL-FILE
  7310       TO DFHEIV11
  7311     MOVE 'ELCNTL' TO DFHEIV1
  7312*    MOVE '&"IL       E          (  N#00007177' TO DFHEIV0
  7313     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7315     MOVE X'204E233030303037313737' TO DFHEIV0(25:11)
  7316     CALL 'kxdfhei1' USING DFHEIV0,
  7317           DFHEIV1,
  7318           CONTROL-FILE,
  7319           DFHEIV11,
  7320           WS-ELCNTL-KEY,
  7321           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 128
* NSRASBL.cbl
  7322           DFHEIV99,
  7323           DFHEIV99
  7324     MOVE EIBRESP  TO WS-RESPONSE
  7325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7326        IF RESP-NORMAL
  7327           MOVE CF-PROCESSOR-NAME   TO OUT-PROC-NAME
  7328*          MOVE CF-PROCESSOR-TITLE  TO OUT-PROC-TITLE
  7329        END-IF
  7330     END-IF
  7331     .
  7332 1025-EXIT.
  7333     EXIT.
  7334 1050-GET-ERMAIL.
  7335     MOVE CM-CONTROL-PRIMARY     TO WS-ERMAIL-KEY
  7336
  7337* EXEC CICS READ
  7338*         DATASET    ('ERMAIL')
  7339*         INTO       (MAILING-DATA)
  7340*         RIDFLD     (WS-ERMAIL-KEY)
  7341*         RESP       (WS-RESPONSE)
  7342*    END-EXEC
  7343     MOVE LENGTH OF
  7344      MAILING-DATA
  7345       TO DFHEIV11
  7346     MOVE 'ERMAIL' TO DFHEIV1
  7347*    MOVE '&"IL       E          (  N#00007193' TO DFHEIV0
  7348     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7349     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7350     MOVE X'204E233030303037313933' TO DFHEIV0(25:11)
  7351     CALL 'kxdfhei1' USING DFHEIV0,
  7352           DFHEIV1,
  7353           MAILING-DATA,
  7354           DFHEIV11,
  7355           WS-ERMAIL-KEY,
  7356           DFHEIV99,
  7357           DFHEIV99,
  7358           DFHEIV99
  7359     MOVE EIBRESP  TO WS-RESPONSE
  7360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7361     IF RESP-NORMAL
  7362        MOVE MA-ADDRESS-LINE-1   TO OUT-INS-ADDR1
  7363        MOVE MA-ADDRESS-LINE-2   TO OUT-INS-ADDR2
  7364        MOVE MA-CITY             TO OUT-INS-CITY
  7365        MOVE MA-ADDR-STATE       TO OUT-INS-STATE
  7366        MOVE MA-ZIP              TO OUT-INS-ZIP
  7367        MOVE MA-CRED-BENE-NAME   TO OUT-BENE-NAME
  7368        MOVE MA-CRED-BENE-ADDR   TO OUT-BENE-ADDR1
  7369        MOVE MA-CRED-BENE-ADDR2  TO OUT-BENE-ADDR2
  7370        MOVE MA-CRED-BENE-CITY   TO OUT-BENE-CITY
  7371        MOVE MA-CRED-BENE-STATE  TO OUT-BENE-STATE
  7372        MOVE MA-CRED-BENE-ZIP    TO OUT-BENE-ZIP
  7373        IF MA-INSURED-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7374           MOVE MA-INSURED-BIRTH-DT
  7375                                 TO DC-BIN-DATE-1
  7376           MOVE ' '              TO DC-OPTION-CODE
  7377           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7378           IF NO-CONVERSION-ERROR
  7379              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 129
* NSRASBL.cbl
  7380                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7381                INTO OUT-INS-BIRTHDATE
  7382              END-STRING
  7383           END-IF
  7384        END-IF
  7385        IF MA-JOINT-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7386           MOVE MA-JOINT-BIRTH-DT
  7387                                 TO DC-BIN-DATE-1
  7388           MOVE ' '              TO DC-OPTION-CODE
  7389           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7390           IF NO-CONVERSION-ERROR
  7391              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7392                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7393                INTO OUT-JNT-BIRTHDATE
  7394              END-STRING
  7395           END-IF
  7396        END-IF
  7397     END-IF
  7398     .
  7399 1050-EXIT.
  7400     EXIT.
  7401 1100-GET-ELCERT.
  7402
  7403* EXEC CICS READ
  7404*         DATASET    ('ELCERT')
  7405*         INTO       (CERTIFICATE-MASTER)
  7406*         RIDFLD     (WS-ELCERT-KEY)
  7407*         RESP       (WS-RESPONSE)
  7408*    END-EXEC.
  7409     MOVE LENGTH OF
  7410      CERTIFICATE-MASTER
  7411       TO DFHEIV11
  7412     MOVE 'ELCERT' TO DFHEIV1
  7413*    MOVE '&"IL       E          (  N#00007240' TO DFHEIV0
  7414     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7415     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7416     MOVE X'204E233030303037323430' TO DFHEIV0(25:11)
  7417     CALL 'kxdfhei1' USING DFHEIV0,
  7418           DFHEIV1,
  7419           CERTIFICATE-MASTER,
  7420           DFHEIV11,
  7421           WS-ELCERT-KEY,
  7422           DFHEIV99,
  7423           DFHEIV99,
  7424           DFHEIV99
  7425     MOVE EIBRESP  TO WS-RESPONSE
  7426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7427
  7428     IF RESP-NORMAL
  7429        SET CERT-FOUND TO TRUE
  7430        PERFORM 1110-BUILD-CERT  THRU 1110-EXIT
  7431        PERFORM 1050-GET-ERMAIL  THRU 1050-EXIT
  7432     END-IF
  7433     .
  7434 1100-EXIT.
  7435     EXIT.
  7436 1110-BUILD-CERT.
  7437     PERFORM 1300-DETERMINE-COMM THRU 1300-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 130
* NSRASBL.cbl
  7438     MOVE SPACES                 TO OUT-COVERAGE-IND
  7439     MOVE SPACES                 TO OUT-ORIG-COVERAGE-IND
  7440     MOVE SPACES                 TO OUT-NEW-COVERAGE-IND
  7441     MOVE CM-CARRIER             TO OUT-CARRIER
  7442     MOVE CM-GROUPING            TO OUT-GROUPING
  7443     MOVE CM-STATE               TO OUT-STATE
  7444     MOVE CM-ACCOUNT             TO OUT-ACCOUNT
  7445     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  7446     MOVE ' '                    TO DC-OPTION-CODE
  7447     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7448     IF NO-CONVERSION-ERROR
  7449        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7450           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7451              INTO OUT-CERT-EFF-DT
  7452        END-STRING
  7453     END-IF
  7454     MOVE CM-CERT-NO             TO OUT-CERT-NO
  7455     MOVE CM-INSURED-LAST-NAME   TO OUT-ILNAME
  7456                                    OUT-ORIG-ILNAME
  7457     MOVE CM-INSURED-INITIAL1    TO OUT-IFINIT
  7458     MOVE CM-INSURED-INITIAL2    TO OUT-IMINIT
  7459                                    OUT-ORIG-MINIT
  7460     IF (CM-SSN-STATE = CM-STATE)
  7461        AND (CM-SSN-ACCOUNT = CM-ACCOUNT (5:6))
  7462        MOVE SPACES              TO OUT-SOC-SEC-NO
  7463     ELSE
  7464        MOVE CM-SOC-SEC-NO       TO OUT-SOC-SEC-NO
  7465     END-IF
  7466     IF (CM-MEMB-STATE = CM-STATE)
  7467        AND (CM-MEMB-ACCOUNT = CM-ACCOUNT (5:6))
  7468        MOVE SPACES              TO OUT-MEMBER-NO
  7469     ELSE
  7470        MOVE CM-MEMBER-NO        TO OUT-MEMBER-NO
  7471     END-IF
  7472     MOVE CM-INSURED-FIRST-NAME  TO OUT-IFNAME
  7473                                    OUT-ORIG-IFNAME
  7474     MOVE CM-INSURED-ISSUE-AGE   TO OUT-IAGE
  7475                                    OUT-ORIG-IAGE
  7476     MOVE CM-INSURED-SEX         TO OUT-ISEX
  7477     MOVE CM-INSURED-JOINT-AGE   TO OUT-JAGE
  7478                                    OUT-ORIG-JAGE
  7479     MOVE CM-JT-LAST-NAME        TO OUT-JLNAME
  7480                                    OUT-ORIG-JLNAME
  7481     MOVE CM-JT-FIRST-NAME       TO OUT-JFNAME
  7482                                    OUT-ORIG-JFNAME
  7483     MOVE CM-JT-INITIAL          TO OUT-JMINIT
  7484                                    OUT-ORIG-JMINIT
  7485     MOVE CM-LF-BENEFIT-CD       TO OUT-LF-BENCD
  7486                                    OUT-ORIG-LF-BENCD
  7487     MOVE CM-LF-ORIG-TERM        TO OUT-LF-TERM
  7488                                    OUT-ORIG-LF-TERM
  7489     MOVE CM-LF-DEV-CODE         TO OUT-LF-DEV-CD
  7490     IF CM-LF-DEV-PCT NOT NUMERIC
  7491        MOVE ZEROS               TO CM-LF-DEV-PCT
  7492     END-IF
  7493     MOVE CM-LF-DEV-PCT          TO OUT-LF-DEV-PCT
  7494     PERFORM 1160-READ-CERT-TRAILER THRU 1160-EXIT
  7495     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 131
* NSRASBL.cbl
  7496         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
  7497             MOVE ZERO           TO OUT-IAGE
  7498                                    OUT-ORIG-IAGE
  7499         END-IF
  7500         IF CS-JNT-AGE-DEFAULT-FLAG = 'Y'
  7501             MOVE ZERO           TO OUT-JAGE
  7502                                    OUT-ORIG-JAGE
  7503         END-IF
  7504     END-IF
  7505
  7506     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7507        IF (PB-C-LF-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7508          (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7509             MOVE SPACES          TO OUT-LF-BENCD
  7510                                     WS-LF-BENCD
  7511                                     OUT-LF-CAN-DT
  7512             MOVE ZEROS           TO OUT-LF-TERM
  7513                                     OUT-LF-BEN
  7514                                     OUT-LF-PRM
  7515                                     OUT-LF-ALT-BEN
  7516                                     OUT-LF-ALT-PRM
  7517                                     OUT-LF-COMM-PCT
  7518                                     OUT-LF-NSP
  7519                                     OUT-LF-REM-BEN
  7520                                     WS-WORK-LF-PREM
  7521                                     WS-WORK-ALT-LF-PREM
  7522                                     WS-WORK-CMB-LF-PREM
  7523                                     OUT-LF-REF
  7524                                     OUT-ORIG-LF-REF
  7525                                     WS-WORK-LF-REF
  7526             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7527             GO TO 1100-LF-CONT
  7528        END-IF
  7529     END-IF
  7530
  7531     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7532        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7533             MOVE SPACES          TO OUT-LF-BENCD
  7534                                     WS-LF-BENCD
  7535                                     OUT-LF-CAN-DT
  7536             MOVE ZEROS           TO OUT-LF-TERM
  7537                                     OUT-LF-BEN
  7538                                     OUT-LF-PRM
  7539                                     OUT-LF-ALT-BEN
  7540                                     OUT-LF-ALT-PRM
  7541                                     OUT-LF-COMM-PCT
  7542                                     OUT-LF-NSP
  7543                                     OUT-LF-REM-BEN
  7544                                     WS-WORK-LF-PREM
  7545                                     WS-WORK-ALT-LF-PREM
  7546                                     WS-WORK-CMB-LF-PREM
  7547                                     OUT-LF-REF
  7548                                     OUT-ORIG-LF-REF
  7549                                     WS-WORK-LF-REF
  7550             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7551             GO TO 1100-LF-CONT
  7552        END-IF
  7553     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 132
* NSRASBL.cbl
  7554     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  7555         MOVE 'LIFE'             TO OUT-COVERAGE-IND
  7556                                    OUT-ORIG-COVERAGE-IND
  7557     END-IF
  7558
  7559     MOVE CM-LF-BENEFIT-CD       TO WS-LF-BENCD
  7560     MOVE CM-LF-BENEFIT-AMT      TO OUT-LF-BEN
  7561                                    OUT-ORIG-LF-BEN
  7562     IF CM-LF-BENEFIT-AMT = 999999999.99
  7563        MOVE SPACES              TO OUT-ORIG-LF-BEN-A
  7564     END-IF
  7565     MOVE CM-LF-PREMIUM-AMT      TO OUT-LF-PRM
  7566                                    OUT-ORIG-LF-PRM
  7567                                    WS-WORK-LF-PREM
  7568     IF CM-LF-PREMIUM-AMT = .01
  7569         MOVE SPACES             TO OUT-ORIG-LF-PRM-A
  7570     END-IF
  7571     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
  7572        MOVE ZEROS               TO CM-LF-ALT-BENEFIT-AMT
  7573     END-IF
  7574     MOVE CM-LF-ALT-BENEFIT-AMT  TO OUT-LF-ALT-BEN
  7575                                    OUT-ORIG-LF-ALT-BEN
  7576     IF CM-LF-ALT-PREMIUM-AMT NOT NUMERIC
  7577        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-AMT
  7578     END-IF
  7579     MOVE CM-LF-ALT-PREMIUM-AMT  TO OUT-LF-ALT-PRM
  7580                                    OUT-ORIG-LF-ALT-PRM
  7581                                    WS-WORK-ALT-LF-PREM
  7582     COMPUTE WS-WRK-AMOUNT = CM-LF-PREMIUM-AMT +
  7583                             CM-LF-ALT-PREMIUM-AMT
  7584     MOVE WS-WRK-AMOUNT          TO OUT-LF-CMB-PREM
  7585                                 OUT-ORIG-LF-CMB-PREM
  7586                                 WS-WORK-CMB-LF-PREM
  7587     IF CM-LF-NSP-PREMIUM-AMT NOT NUMERIC
  7588        MOVE ZEROS               TO CM-LF-NSP-PREMIUM-AMT
  7589     END-IF
  7590     MOVE CM-LF-NSP-PREMIUM-AMT  TO OUT-LF-NSP
  7591     MOVE CM-LF-REMAINING-AMT    TO OUT-LF-REM-BEN
  7592     MOVE CM-LF-ITD-CANCEL-AMT   TO OUT-LF-REF
  7593                                    OUT-ORIG-LF-REF
  7594                                    WS-WORK-LF-REF
  7595     IF CM-LF-DEATH-CLAIM-APPLIED
  7596        AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  7597            MOVE PB-C-LF-CANCEL-AMT TO OUT-LF-REF
  7598                                    OUT-ORIG-LF-REF
  7599                                    WS-WORK-LF-REF
  7600     END-IF
  7601     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  7602     MOVE ' '                    TO DC-OPTION-CODE
  7603     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7604     IF NO-CONVERSION-ERROR
  7605        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7606           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7607              INTO OUT-LF-CAN-DT
  7608        END-STRING
  7609     END-IF
  7610
  7611     IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 133
* NSRASBL.cbl
  7612         MOVE ZEROS          TO WS-WORK-LF-PREM
  7613                                WS-WORK-ALT-LF-PREM
  7614                                WS-WORK-CMB-LF-PREM
  7615     END-IF
  7616
  7617      .
  7618 1100-LF-CONT.
  7619
  7620     MOVE CM-LF-ITD-DEATH-AMT    TO OUT-LF-DTH
  7621     IF CM-LF-PREMIUM-RATE NOT NUMERIC
  7622        MOVE ZEROS               TO CM-LF-PREMIUM-RATE
  7623     END-IF
  7624     MOVE CM-LF-PREMIUM-RATE     TO OUT-LF-RATE
  7625     IF CM-LF-ALT-PREMIUM-RATE NOT NUMERIC
  7626        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-RATE
  7627     END-IF
  7628     MOVE CM-LF-ALT-PREMIUM-RATE TO OUT-LF-ALT-RATE
  7629     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7630        IF (PB-C-AH-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7631          (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7632              MOVE SPACES              TO OUT-AH-BENCD
  7633                                          WS-AH-BENCD
  7634                                          OUT-AH-CAN-DT
  7635              MOVE ZEROS               TO OUT-AH-TERM
  7636                                          OUT-AH-BEN
  7637                                          OUT-AH-PRM
  7638                                          OUT-AH-NSP
  7639                                          OUT-AH-COMM-PCT
  7640                                          OUT-CRIT-PER
  7641                                          WS-WORK-AH-PREM
  7642                                          OUT-AH-REF
  7643                                          OUT-ORIG-AH-REF
  7644                                          WS-WORK-AH-REF
  7645              MOVE SPACES              TO OUT-MAX-PMTS-A
  7646                                          OUT-WAIT-PER
  7647                                          OUT-RET-ELIM
  7648                                          OUT-AH-DESC
  7649                                          OUT-BEN-DAYS
  7650              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  7651             GO TO 1100-AH-CONT
  7652        END-IF
  7653     END-IF
  7654
  7655     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7656        IF (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7657              MOVE SPACES              TO OUT-AH-BENCD
  7658                                          WS-AH-BENCD
  7659                                          OUT-AH-CAN-DT
  7660              MOVE ZEROS               TO OUT-AH-TERM
  7661                                          OUT-AH-BEN
  7662                                          OUT-AH-PRM
  7663                                          OUT-AH-NSP
  7664                                          OUT-AH-COMM-PCT
  7665                                          OUT-CRIT-PER
  7666                                          WS-WORK-AH-PREM
  7667                                          OUT-AH-REF
  7668                                          OUT-ORIG-AH-REF
  7669                                          WS-WORK-AH-REF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 134
* NSRASBL.cbl
  7670              MOVE SPACES              TO OUT-MAX-PMTS-A
  7671                                          OUT-WAIT-PER
  7672                                          OUT-RET-ELIM
  7673                                          OUT-AH-DESC
  7674                                          OUT-BEN-DAYS
  7675              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  7676             GO TO 1100-AH-CONT
  7677        END-IF
  7678     END-IF
  7679     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BENCD
  7680     MOVE CM-AH-BENEFIT-CD       TO OUT-AH-BENCD
  7681                                    OUT-ORIG-AH-BENCD
  7682     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  7683        COMPUTE OUT-AH-TOT-BEN = CM-AH-ORIG-TERM *
  7684           CM-AH-BENEFIT-AMT
  7685        IF OUT-COVERAGE-IND = 'LIFE'
  7686            MOVE 'BOTH'          TO OUT-COVERAGE-IND
  7687                                    OUT-ORIG-COVERAGE-IND
  7688        ELSE
  7689            MOVE 'AH  '          TO OUT-COVERAGE-IND
  7690                                    OUT-ORIG-COVERAGE-IND
  7691        END-IF
  7692     ELSE
  7693        MOVE ZEROS               TO OUT-AH-TOT-BEN
  7694     END-IF
  7695     MOVE CM-AH-ORIG-TERM        TO OUT-AH-TERM
  7696                                    OUT-ORIG-AH-TERM
  7697     MOVE CM-AH-CRITICAL-PERIOD  TO OUT-CRIT-PER
  7698                                    OUT-ORIG-CRIT-PER
  7699                                    OUT-MAX-PMTS
  7700                                    OUT-ORIG-MAX-PMTS
  7701     IF CM-AH-BENEFIT-CD EQUAL '00' OR SPACES
  7702         MOVE SPACES             TO OUT-MAX-PMTS-A
  7703     END-IF
  7704     MOVE CM-AH-DEV-CODE         TO OUT-AH-DEV-CD
  7705     IF CM-AH-DEV-PCT NOT NUMERIC
  7706        MOVE ZEROS               TO CM-AH-DEV-PCT
  7707     END-IF
  7708     MOVE CM-AH-DEV-PCT          TO OUT-AH-DEV-PCT
  7709     MOVE CM-AH-BENEFIT-AMT      TO OUT-AH-BEN
  7710                                    OUT-ORIG-AH-BEN
  7711     IF CM-AH-BENEFIT-AMT = 999999999.99
  7712        MOVE SPACES              TO OUT-ORIG-AH-BEN-A
  7713     END-IF
  7714     MOVE CM-AH-PREMIUM-AMT      TO OUT-AH-PRM
  7715                                    OUT-ORIG-AH-PRM
  7716                                    WS-WORK-AH-PREM
  7717     IF CM-AH-PREMIUM-AMT = .01
  7718         MOVE SPACES             TO OUT-ORIG-AH-PRM-A
  7719     END-IF
  7720     MOVE CM-AH-NSP-PREMIUM-AMT  TO OUT-AH-NSP
  7721     MOVE CM-AH-ITD-CANCEL-AMT   TO OUT-AH-REF
  7722                                    OUT-ORIG-AH-REF
  7723                                    WS-WORK-AH-REF
  7724     IF CM-AH-DEATH-CLAIM-APPLIED
  7725        AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  7726            MOVE PB-C-AH-CANCEL-AMT TO OUT-AH-REF
  7727                                    OUT-ORIG-AH-REF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 135
* NSRASBL.cbl
  7728                                    WS-WORK-AH-REF
  7729     END-IF
  7730     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  7731     MOVE ' '                    TO DC-OPTION-CODE
  7732     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7733     IF NO-CONVERSION-ERROR
  7734        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7735           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7736              INTO OUT-AH-CAN-DT
  7737        END-STRING
  7738     END-IF
  7739
  7740     IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7741         MOVE ZEROS          TO WS-WORK-AH-PREM
  7742     END-IF
  7743
  7744      .
  7745 1100-AH-CONT.
  7746
  7747     MOVE CM-AH-ITD-AH-PMT       TO OUT-AH-CLM
  7748     MOVE CM-AH-PAID-THRU-DT     TO DC-BIN-DATE-1
  7749     MOVE ' '                    TO DC-OPTION-CODE
  7750     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7751     IF NO-CONVERSION-ERROR
  7752        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7753           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7754              INTO OUT-AH-PDTHRU-DT
  7755        END-STRING
  7756     END-IF
  7757     IF CM-AH-PREMIUM-RATE NOT NUMERIC
  7758        MOVE ZEROS               TO CM-AH-PREMIUM-RATE
  7759     END-IF
  7760     MOVE CM-AH-PREMIUM-RATE     TO OUT-AH-RATE
  7761     IF CM-LOAN-APR NOT NUMERIC
  7762        MOVE ZEROS               TO CM-LOAN-APR
  7763     END-IF
  7764     MOVE CM-LOAN-APR            TO OUT-LOAN-APR
  7765     MOVE CM-LOAN-TERM           TO OUT-LOAN-TERM
  7766     MOVE CM-RATE-CLASS          TO OUT-RATE-CLASS
  7767     MOVE CM-PMT-EXTENSION-DAYS  TO OUT-EXT-DAYS
  7768     MOVE CM-UNDERWRITING-CODE   TO OUT-UCODE
  7769     MOVE CM-PREMIUM-TYPE        TO OUT-PREM-TYPE
  7770     MOVE CM-IND-GRP-TYPE        TO OUT-IND-GRP
  7771     MOVE CM-LOAN-OFFICER        TO OUT-LOAN-OFF
  7772     MOVE CM-REIN-TABLE          TO OUT-REIN-TABLE
  7773     MOVE CM-SPECIAL-REIN-CODE   TO OUT-SPEC-REIN
  7774     MOVE CM-LF-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  7775     MOVE ' '                    TO DC-OPTION-CODE
  7776     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7777     IF NO-CONVERSION-ERROR
  7778        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7779           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7780              INTO OUT-LF-EXP-DT
  7781        END-STRING
  7782     END-IF
  7783     MOVE OUT-LF-EXP-DT          TO OUT-ORIG-LF-EXP-DT
  7784     MOVE CM-AH-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  7785     MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 136
* NSRASBL.cbl
  7786     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7787     IF NO-CONVERSION-ERROR
  7788        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7789           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7790              INTO OUT-AH-EXP-DT
  7791        END-STRING
  7792     END-IF
  7793     MOVE OUT-AH-EXP-DT          TO OUT-ORIG-AH-EXP-DT
  7794     MOVE CM-LOAN-1ST-PMT-DT     TO DC-BIN-DATE-1
  7795     MOVE ' '                    TO DC-OPTION-CODE
  7796     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7797     IF NO-CONVERSION-ERROR
  7798        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7799           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7800              INTO OUT-1ST-PMT-DT
  7801        END-STRING
  7802     END-IF
  7803     MOVE CM-ENTRY-STATUS        TO OUT-ENTRY-STATUS
  7804     MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  7805     MOVE ' '                    TO DC-OPTION-CODE
  7806     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7807     IF NO-CONVERSION-ERROR
  7808        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7809           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7810              INTO OUT-ENTRY-DT
  7811        END-STRING
  7812     END-IF
  7813     MOVE CM-LF-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  7814     MOVE ' '                    TO DC-OPTION-CODE
  7815     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7816     IF NO-CONVERSION-ERROR
  7817        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7818           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7819              INTO OUT-LF-CAN-EXIT-DT
  7820        END-STRING
  7821     END-IF
  7822     MOVE CM-LF-DEATH-DT         TO DC-BIN-DATE-1
  7823     MOVE ' '                    TO DC-OPTION-CODE
  7824     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7825     IF NO-CONVERSION-ERROR
  7826        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7827           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7828              INTO OUT-LF-DTH-DT
  7829        END-STRING
  7830     END-IF
  7831     MOVE CM-LF-DEATH-EXIT-DT    TO DC-BIN-DATE-1
  7832     MOVE ' '                    TO DC-OPTION-CODE
  7833     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7834     IF NO-CONVERSION-ERROR
  7835        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7836           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7837              INTO OUT-LF-DTH-EXIT-DT
  7838        END-STRING
  7839     END-IF
  7840     MOVE CM-LF-CURRENT-STATUS   TO OUT-LF-CUR-STATUS
  7841     IF OUT-AH-CAN-DT NOT = SPACES
  7842        MOVE OUT-AH-CAN-DT       TO OUT-CANCEL-DT
  7843     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 137
* NSRASBL.cbl
  7844        MOVE OUT-LF-CAN-DT       TO OUT-CANCEL-DT
  7845     END-IF
  7846     MOVE CM-AH-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  7847     MOVE ' '                    TO DC-OPTION-CODE
  7848     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7849     IF NO-CONVERSION-ERROR
  7850        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7851           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7852              INTO OUT-AH-CAN-EXIT-DT
  7853        END-STRING
  7854     END-IF
  7855     MOVE CM-AH-CURRENT-STATUS   TO OUT-AH-CUR-STATUS
  7856     IF CM-ENTRY-BATCH = LOW-VALUES
  7857        MOVE SPACES              TO CM-ENTRY-BATCH
  7858     END-IF
  7859     MOVE CM-ENTRY-BATCH         TO OUT-ENTRY-BATCH
  7860     IF CM-LF-EXIT-BATCH = LOW-VALUES
  7861        MOVE SPACES              TO CM-LF-EXIT-BATCH
  7862     END-IF
  7863     MOVE CM-LF-EXIT-BATCH       TO OUT-LF-EXIT-BATCH
  7864     IF CM-AH-EXIT-BATCH = LOW-VALUES
  7865        MOVE SPACES              TO CM-AH-EXIT-BATCH
  7866     END-IF
  7867     MOVE CM-AH-EXIT-BATCH       TO OUT-AH-EXIT-BATCH
  7868     MOVE WS-CHGBK-LIFE-PCT      TO OUT-LF-COMM-PCT
  7869     MOVE WS-CHGBK-AH-PCT        TO OUT-AH-COMM-PCT
  7870     MOVE CM-CERT-SFX            TO OUT-CERT-SFX
  7871     MOVE CM-CONTROL-PRIMARY     TO MA-CONTROL-PRIMARY
  7872     COMPUTE WS-WORK-PREM =
  7873        (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT
  7874           + CM-AH-PREMIUM-AMT)
  7875     MOVE WS-WORK-PREM           TO OUT-TOT-PRM
  7876                                    OUT-ORIG-TOT-PREM
  7877     COMPUTE WS-WORK-REF =
  7878        (WS-WORK-LF-REF + WS-WORK-AH-REF)
  7879     MOVE WS-WORK-REF            TO OUT-TOT-REF
  7880                                    OUT-ORIG-TOT-REF
  7881     IF CM-LF-LOAN-EXPIRE-DT > CM-AH-LOAN-EXPIRE-DT
  7882        MOVE OUT-LF-EXP-DT       TO OUT-SCHED-EXP-DT
  7883     ELSE
  7884        MOVE OUT-AH-EXP-DT       TO OUT-SCHED-EXP-DT
  7885     END-IF
  7886     MOVE OUT-SCHED-EXP-DT       TO OUT-ORIG-SCHED-EXP-DT
  7887     IF CM-LF-ORIG-TERM > CM-AH-ORIG-TERM
  7888        MOVE CM-LF-ORIG-TERM     TO OUT-SCHED-TERM
  7889     ELSE
  7890        MOVE CM-AH-ORIG-TERM     TO OUT-SCHED-TERM
  7891     END-IF
  7892     MOVE OUT-SCHED-TERM         TO OUT-ORIG-SCHED-TERM
  7893     IF CM-NH-INT-ON-REFS NUMERIC
  7894        IF CM-NH-INT-ON-REFS NOT = ZEROS
  7895           MOVE CM-NH-INT-ON-REFS TO OUT-TOT-INTEREST
  7896        END-IF
  7897     END-IF
  7898
  7899     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7900        IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7901            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 138
* NSRASBL.cbl
  7902        END-IF
  7903        IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7904            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  7905        END-IF
  7906     END-IF
  7907*
  7908*     IF BL-DATA-SRCE = '2'
  7909*        IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7910*            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  7911*        END-IF
  7912*        IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7913*            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  7914*        END-IF
  7915*     END-IF
  7916
  7917     COMPUTE WS-ACCT-LF-PORTION =
  7918        WS-WORK-LF-PREM * WS-CHGBK-LIFE-PCT
  7919     MOVE WS-ACCT-LF-PORTION TO OUT-ACCT-LF-PORTION
  7920                                OUT-ACCT-ORIG-LF-PORT
  7921     COMPUTE WS-ACCT-ALT-LF-PORTION =
  7922        WS-WORK-ALT-LF-PREM * WS-CHGBK-LIFE-PCT
  7923     MOVE WS-ACCT-ALT-LF-PORTION TO OUT-ACCT-ALT-LF-PORT
  7924                                OUT-ACCT-ORIG-ALT-LF-PORT
  7925     COMPUTE WS-ACCT-CMB-LF-PORTION =
  7926        WS-WORK-CMB-LF-PREM * WS-CHGBK-LIFE-PCT
  7927     MOVE WS-ACCT-CMB-LF-PORTION TO OUT-ACCT-CMB-LF-PORT
  7928                                OUT-ACCT-ORIG-CMB-LF-PORT
  7929     COMPUTE WS-ACCT-AH-PORTION =
  7930        WS-WORK-AH-PREM * WS-CHGBK-AH-PCT
  7931     MOVE WS-ACCT-AH-PORTION TO OUT-ACCT-AH-PORTION
  7932                                OUT-ACCT-ORIG-AH-PORT
  7933     COMPUTE WS-ACCT-PORTION =
  7934        WS-ACCT-CMB-LF-PORTION + WS-ACCT-AH-PORTION
  7935     MOVE WS-ACCT-PORTION TO OUT-ACCT-PORTION
  7936                                OUT-ACCT-ORIG-PORTION
  7937
  7938     COMPUTE WS-CSO-LF-PORTION =
  7939       WS-WORK-LF-PREM - WS-ACCT-LF-PORTION
  7940     MOVE WS-CSO-LF-PORTION TO OUT-CSO-LF-PORTION
  7941                               OUT-CSO-ORIG-LF-PORT
  7942     COMPUTE WS-CSO-ALT-LF-PORTION =
  7943       WS-WORK-ALT-LF-PREM - WS-ACCT-ALT-LF-PORTION
  7944     MOVE WS-CSO-ALT-LF-PORTION TO OUT-CSO-ALT-LF-PORT
  7945                                   OUT-CSO-ORIG-ALT-LF-PORT
  7946     COMPUTE WS-CSO-CMB-LF-PORTION =
  7947       WS-WORK-CMB-LF-PREM - WS-ACCT-CMB-LF-PORTION
  7948     MOVE WS-CSO-CMB-LF-PORTION TO OUT-CSO-CMB-LF-PORT
  7949                                   OUT-CSO-ORIG-CMB-LF-PORT
  7950     COMPUTE WS-CSO-AH-PORTION =
  7951        WS-WORK-AH-PREM - WS-ACCT-AH-PORTION
  7952     MOVE WS-CSO-AH-PORTION TO OUT-CSO-AH-PORTION
  7953                               OUT-CSO-ORIG-AH-PORT
  7954     COMPUTE WS-CSO-PORTION =
  7955        WS-CSO-CMB-LF-PORTION + WS-CSO-AH-PORTION
  7956     MOVE WS-CSO-PORTION TO OUT-CSO-PORTION
  7957                            OUT-CSO-ORIG-PORTION
  7958     .
  7959 1110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 139
* NSRASBL.cbl
  7960     EXIT.
  7961 1115-MATCH-COMPANY.
  7962     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7963     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  7964     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7965
  7966* EXEC CICS READ
  7967*       INTO    (CONTROL-FILE)
  7968*       DATASET ('ELCNTL')
  7969*       RIDFLD  (WS-ELCNTL-KEY)
  7970*       RESP    (WS-RESPONSE)
  7971*    END-EXEC
  7972     MOVE LENGTH OF
  7973      CONTROL-FILE
  7974       TO DFHEIV11
  7975     MOVE 'ELCNTL' TO DFHEIV1
  7976*    MOVE '&"IL       E          (  N#00007783' TO DFHEIV0
  7977     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7978     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7979     MOVE X'204E233030303037373833' TO DFHEIV0(25:11)
  7980     CALL 'kxdfhei1' USING DFHEIV0,
  7981           DFHEIV1,
  7982           CONTROL-FILE,
  7983           DFHEIV11,
  7984           WS-ELCNTL-KEY,
  7985           DFHEIV99,
  7986           DFHEIV99,
  7987           DFHEIV99
  7988     MOVE EIBRESP  TO WS-RESPONSE
  7989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7990     IF RESP-NORMAL
  7991        MOVE CF-COMPANY-CD       TO WS-COMPANY-CD
  7992     END-IF
  7993     .
  7994 1115-EXIT.
  7995     EXIT.
  7996 1120-MATCH-CARRIER.
  7997     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7998     MOVE '6'                    TO WS-ELCNTL-REC-TYPE
  7999     MOVE BL-CARRIER             TO WS-ELCNTL-CARR
  8000     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8001
  8002* EXEC CICS READ
  8003*       INTO    (CONTROL-FILE)
  8004*       DATASET ('ELCNTL')
  8005*       RIDFLD  (WS-ELCNTL-KEY)
  8006*       RESP    (WS-RESPONSE)
  8007*    END-EXEC
  8008     MOVE LENGTH OF
  8009      CONTROL-FILE
  8010       TO DFHEIV11
  8011     MOVE 'ELCNTL' TO DFHEIV1
  8012*    MOVE '&"IL       E          (  N#00007800' TO DFHEIV0
  8013     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8014     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8015     MOVE X'204E233030303037383030' TO DFHEIV0(25:11)
  8016     CALL 'kxdfhei1' USING DFHEIV0,
  8017           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 140
* NSRASBL.cbl
  8018           CONTROL-FILE,
  8019           DFHEIV11,
  8020           WS-ELCNTL-KEY,
  8021           DFHEIV99,
  8022           DFHEIV99,
  8023           DFHEIV99
  8024     MOVE EIBRESP  TO WS-RESPONSE
  8025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8026     IF RESP-NORMAL
  8027        MOVE CF-MAIL-TO-NAME     TO OUT-CARR-NAME
  8028     ELSE
  8029        MOVE 'UNKNOWN'           TO OUT-CARR-NAME
  8030     END-IF
  8031     .
  8032 1120-EXIT.
  8033     EXIT.
  8034 1125-MATCH-STATE.
  8035     MOVE BL-STATE               TO OUT-STATE
  8036     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8037     MOVE '3'                    TO WS-ELCNTL-REC-TYPE
  8038     MOVE BL-STATE               TO WS-ELCNTL-STATE
  8039     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8040
  8041* EXEC CICS READ
  8042*       INTO    (CONTROL-FILE)
  8043*       DATASET ('ELCNTL')
  8044*       RIDFLD  (WS-ELCNTL-KEY)
  8045*       RESP    (WS-RESPONSE)
  8046*    END-EXEC
  8047     MOVE LENGTH OF
  8048      CONTROL-FILE
  8049       TO DFHEIV11
  8050     MOVE 'ELCNTL' TO DFHEIV1
  8051*    MOVE '&"IL       E          (  N#00007820' TO DFHEIV0
  8052     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8053     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8054     MOVE X'204E233030303037383230' TO DFHEIV0(25:11)
  8055     CALL 'kxdfhei1' USING DFHEIV0,
  8056           DFHEIV1,
  8057           CONTROL-FILE,
  8058           DFHEIV11,
  8059           WS-ELCNTL-KEY,
  8060           DFHEIV99,
  8061           DFHEIV99,
  8062           DFHEIV99
  8063     MOVE EIBRESP  TO WS-RESPONSE
  8064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8065     IF RESP-NORMAL
  8066        MOVE CF-STATE-NAME       TO OUT-STATE-NAME
  8067     ELSE
  8068        MOVE 'UNKNOWN'           TO OUT-STATE-NAME
  8069     END-IF
  8070     .
  8071 1125-EXIT.
  8072     EXIT.
  8073 1130-MATCH-BENCDS.
  8074     MOVE SPACES                 TO WS-LF-ABBRV
  8075                                    WS-LF-DESC
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 141
* NSRASBL.cbl
  8076                                    WS-LF-EARN
  8077                                    WS-WAIT-PER
  8078                                    WS-RET-ELIM
  8079                                    WS-AH-DESC
  8080                                    WS-BEN-DAYS
  8081     IF WS-LF-BENCD NOT = ZEROS AND SPACES
  8082        PERFORM 1140-MATCH-LFBEN THRU 1140-EXIT
  8083     END-IF
  8084     IF WS-AH-BENCD NOT = ZEROS AND SPACES
  8085        PERFORM 1150-MATCH-AHBEN THRU 1150-EXIT
  8086     END-IF
  8087     .
  8088 1130-EXIT.
  8089     EXIT.
  8090 1140-MATCH-LFBEN.
  8091     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8092     MOVE '4'                    TO WS-ELCNTL-REC-TYPE
  8093     MOVE WS-LF-BENCD            TO WS-ELCNTL-BEN-CD
  8094     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8095
  8096* EXEC CICS READ
  8097*       INTO    (CONTROL-FILE)
  8098*       DATASET ('ELCNTL')
  8099*       RIDFLD  (WS-ELCNTL-KEY)
  8100*       GTEQ
  8101*       RESP    (WS-RESPONSE)
  8102*    END-EXEC
  8103     MOVE LENGTH OF
  8104      CONTROL-FILE
  8105       TO DFHEIV11
  8106     MOVE 'ELCNTL' TO DFHEIV1
  8107*    MOVE '&"IL       G          (  N#00007856' TO DFHEIV0
  8108     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8109     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8110     MOVE X'204E233030303037383536' TO DFHEIV0(25:11)
  8111     CALL 'kxdfhei1' USING DFHEIV0,
  8112           DFHEIV1,
  8113           CONTROL-FILE,
  8114           DFHEIV11,
  8115           WS-ELCNTL-KEY,
  8116           DFHEIV99,
  8117           DFHEIV99,
  8118           DFHEIV99
  8119     MOVE EIBRESP  TO WS-RESPONSE
  8120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8121     IF RESP-NORMAL
  8122        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8123           (WS-LF-BENCD = CF-BENEFIT-CODE (S1))
  8124           OR (S1 > +8)
  8125        END-PERFORM
  8126        IF S1 < + 9
  8127           MOVE CF-BENEFIT-ALPHA (S1)
  8128                                 TO WS-LF-ABBRV
  8129           MOVE WS-LF-BENCD      TO WS-LF-DESC
  8130           MOVE CF-CO-EARNINGS-CALC (S1)
  8131                                 TO WS-LF-EARN
  8132        ELSE
  8133           MOVE 'XX'             TO WS-LF-DESC
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 142
* NSRASBL.cbl
  8134           MOVE 'XXX'            TO WS-LF-ABBRV
  8135        END-IF
  8136     ELSE
  8137        DISPLAY ' NO LF BEN CD ' WS-LF-BENCD
  8138     END-IF
  8139     .
  8140 1140-EXIT.
  8141     EXIT.
  8142 1150-MATCH-AHBEN.
  8143     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8144     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  8145     MOVE WS-AH-BENCD            TO WS-ELCNTL-BEN-CD
  8146     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8147
  8148* EXEC CICS READ
  8149*       INTO    (CONTROL-FILE)
  8150*       DATASET ('ELCNTL')
  8151*       RIDFLD  (WS-ELCNTL-KEY)
  8152*       GTEQ
  8153*       RESP    (WS-RESPONSE)
  8154*    END-EXEC
  8155     MOVE LENGTH OF
  8156      CONTROL-FILE
  8157       TO DFHEIV11
  8158     MOVE 'ELCNTL' TO DFHEIV1
  8159*    MOVE '&"IL       G          (  N#00007889' TO DFHEIV0
  8160     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8162     MOVE X'204E233030303037383839' TO DFHEIV0(25:11)
  8163     CALL 'kxdfhei1' USING DFHEIV0,
  8164           DFHEIV1,
  8165           CONTROL-FILE,
  8166           DFHEIV11,
  8167           WS-ELCNTL-KEY,
  8168           DFHEIV99,
  8169           DFHEIV99,
  8170           DFHEIV99
  8171     MOVE EIBRESP  TO WS-RESPONSE
  8172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8173     IF RESP-NORMAL
  8174        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8175           (WS-AH-BENCD = CF-BENEFIT-CODE (S1))
  8176           OR (S1 > +8)
  8177        END-PERFORM
  8178        IF S1 < + 9
  8179           MOVE CF-BENEFIT-ALPHA (S1)
  8180                                 TO WS-WAIT-PER
  8181           MOVE CF-BENEFIT-ALPHA (S1) (3:1)
  8182                                 TO WS-RET-ELIM
  8183           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  8184                                 TO WS-BEN-DAYS
  8185           IF CF-SPECIAL-CALC-CD (S1) = 'C'
  8186              IF CF-JOINT-INDICATOR (S1) = 'J'
  8187                 MOVE 'Joint Critical Period Disability'
  8188                                 TO WS-AH-DESC
  8189              ELSE
  8190                 MOVE 'Single Critical Period-Primary Only'
  8191                                 TO WS-AH-DESC
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 143
* NSRASBL.cbl
  8192              END-IF
  8193           ELSE
  8194              IF CF-JOINT-INDICATOR (S1) = 'J'
  8195                 MOVE 'Joint Disability'
  8196                                 TO WS-AH-DESC
  8197              ELSE
  8198                 MOVE 'Single Disability (Primary Only)'
  8199                                 TO WS-AH-DESC
  8200              END-IF
  8201           END-IF
  8202        ELSE
  8203           MOVE 'NOT FOUND'      TO WS-AH-DESC
  8204        END-IF
  8205     ELSE
  8206        DISPLAY ' NO AH BEN CD ' WS-AH-BENCD
  8207     END-IF
  8208     .
  8209 1150-EXIT.
  8210     EXIT.
  8211
  8212 1160-READ-CERT-TRAILER.
  8213
  8214     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
  8215     MOVE WS-ELCERT-KEY          TO  WS-ELCRTT-PRIMARY.
  8216     MOVE 'C'                    TO  WS-ELCRTT-REC-TYPE.
  8217
  8218
  8219* EXEC CICS HANDLE CONDITION
  8220*        NOTFND (1160-CERT-TRL-REC-NOTFND)
  8221*    END-EXEC.
  8222*    MOVE '"$I                   ! " #00007941' TO DFHEIV0
  8223     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8224     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8225     MOVE X'2220233030303037393431' TO DFHEIV0(25:11)
  8226     CALL 'kxdfhei1' USING DFHEIV0
  8227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8228
  8229
  8230
  8231* EXEC CICS READ
  8232*        DATASET  ('ELCRTT')
  8233*        RIDFLD   (WS-ELCRTT-KEY)
  8234*        INTO     (CERTIFICATE-TRAILERS)
  8235*    END-EXEC.
  8236     MOVE LENGTH OF
  8237      CERTIFICATE-TRAILERS
  8238       TO DFHEIV11
  8239     MOVE 'ELCRTT' TO DFHEIV1
  8240*    MOVE '&"IL       E          (   #00007945' TO DFHEIV0
  8241     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8243     MOVE X'2020233030303037393435' TO DFHEIV0(25:11)
  8244     CALL 'kxdfhei1' USING DFHEIV0,
  8245           DFHEIV1,
  8246           CERTIFICATE-TRAILERS,
  8247           DFHEIV11,
  8248           WS-ELCRTT-KEY,
  8249           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 144
* NSRASBL.cbl
  8250           DFHEIV99,
  8251           DFHEIV99
  8252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8253
  8254
  8255     GO TO 1160-EXIT.
  8256
  8257 1160-CERT-TRL-REC-NOTFND.
  8258     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
  8259
  8260 1160-EXIT.
  8261     EXIT.
  8262 1200-GET-ERACCT.
  8263     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  8264     MOVE ' UNKNOWN '            TO OUT-ACCT-NAME
  8265                                    OUT-ACCT-ADDR1
  8266                                    OUT-ACCT-ADDR2
  8267                                    OUT-ACCT-CITY
  8268     MOVE ZEROS                  TO WS-CHGBACK
  8269
  8270* EXEC CICS STARTBR
  8271*        DATASET   ('ERACCT')
  8272*        RIDFLD    (WS-ERACCT-KEY)
  8273*        GTEQ
  8274*        RESP      (WS-RESPONSE)
  8275*    END-EXEC
  8276     MOVE 'ERACCT' TO DFHEIV1
  8277     MOVE 0
  8278       TO DFHEIV11
  8279*    MOVE '&,         G          &  N#00007965' TO DFHEIV0
  8280     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8281     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8282     MOVE X'204E233030303037393635' TO DFHEIV0(25:11)
  8283     CALL 'kxdfhei1' USING DFHEIV0,
  8284           DFHEIV1,
  8285           WS-ERACCT-KEY,
  8286           DFHEIV99,
  8287           DFHEIV11,
  8288           DFHEIV99
  8289     MOVE EIBRESP  TO WS-RESPONSE
  8290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8291     IF RESP-NORMAL
  8292
  8293* EXEC CICS READNEXT
  8294*          INTO    (ACCOUNT-MASTER)
  8295*          DATASET ('ERACCT')
  8296*          RIDFLD  (WS-ERACCT-KEY)
  8297*          RESP    (WS-RESPONSE)
  8298*       END-EXEC
  8299     MOVE LENGTH OF
  8300      ACCOUNT-MASTER
  8301       TO DFHEIV12
  8302     MOVE 'ERACCT' TO DFHEIV1
  8303     MOVE 0
  8304       TO DFHEIV11
  8305*    MOVE '&.IL                  )  N#00007972' TO DFHEIV0
  8306     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8307     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 145
* NSRASBL.cbl
  8308     MOVE X'204E233030303037393732' TO DFHEIV0(25:11)
  8309     CALL 'kxdfhei1' USING DFHEIV0,
  8310           DFHEIV1,
  8311           ACCOUNT-MASTER,
  8312           DFHEIV12,
  8313           WS-ERACCT-KEY,
  8314           DFHEIV99,
  8315           DFHEIV11,
  8316           DFHEIV99,
  8317           DFHEIV99
  8318     MOVE EIBRESP  TO WS-RESPONSE
  8319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8320     END-IF
  8321     IF RESP-NORMAL
  8322        PERFORM UNTIL
  8323           NOT (RESP-NORMAL)
  8324           OR (WS-SAVE-ERACCT-KEY NOT =
  8325                        AM-CONTROL-PRIMARY (1:20))
  8326           IF BL-DATA-SRCE = '4' OR '2'
  8327              IF (WS-CERT-EFF-DT < AM-EXPIRATION-DT
  8328                 AND >= AM-EFFECTIVE-DT)
  8329                 PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8330                    (AM-COM-TYP (S1) = 'C' OR 'D')
  8331                    OR (S1 > +10)
  8332                 END-PERFORM
  8333                 IF S1 < +11
  8334                    MOVE AM-COMM-CHARGEBACK (S1)
  8335                                 TO WS-CHGBACK
  8336                 END-IF
  8337              END-IF
  8338           END-IF
  8339           MOVE ACCOUNT-MASTER   TO WS-SAVE-ERACCT-REC
  8340
  8341* EXEC CICS READNEXT
  8342*             INTO    (ACCOUNT-MASTER)
  8343*             DATASET ('ERACCT')
  8344*             RIDFLD  (WS-ERACCT-KEY)
  8345*             RESP    (WS-RESPONSE)
  8346*          END-EXEC
  8347     MOVE LENGTH OF
  8348      ACCOUNT-MASTER
  8349       TO DFHEIV12
  8350     MOVE 'ERACCT' TO DFHEIV1
  8351     MOVE 0
  8352       TO DFHEIV11
  8353*    MOVE '&.IL                  )  N#00007998' TO DFHEIV0
  8354     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8355     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8356     MOVE X'204E233030303037393938' TO DFHEIV0(25:11)
  8357     CALL 'kxdfhei1' USING DFHEIV0,
  8358           DFHEIV1,
  8359           ACCOUNT-MASTER,
  8360           DFHEIV12,
  8361           WS-ERACCT-KEY,
  8362           DFHEIV99,
  8363           DFHEIV11,
  8364           DFHEIV99,
  8365           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 146
* NSRASBL.cbl
  8366     MOVE EIBRESP  TO WS-RESPONSE
  8367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8368        END-PERFORM
  8369        MOVE WS-SAVE-ERACCT-REC  TO ACCOUNT-MASTER
  8370        IF WS-SAVE-ERACCT-KEY = AM-CONTROL-PRIMARY (1:20)
  8371           SET ACCT-FOUND TO TRUE
  8372           MOVE AM-NAME          TO OUT-ACCT-NAME
  8373           MOVE AM-ADDRS         TO OUT-ACCT-ADDR1
  8374           MOVE SPACES           TO OUT-ACCT-ADDR2
  8375           MOVE AM-ADDR-CITY     TO OUT-ACCT-CITY
  8376           MOVE AM-ADDR-STATE    TO OUT-ACCT-STATE
  8377           MOVE AM-ZIP-PRIME     TO OUT-ACCT-ZIP
  8378           MOVE AM-REPORT-CODE-1 TO OUT-RPT-CD1
  8379           MOVE AM-REPORT-CODE-2 TO OUT-RPT-CD2
  8380           IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  8381              STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  8382                 INTO OUT-ACCT-ZIP (6:5)
  8383              END-STRING
  8384           END-IF
  8385           MOVE AM-TEL-NO        TO OUT-ACCT-PHONE
  8386           MOVE AM-GPCD          TO OUT-ACCT-BUS-TYPE
  8387           MOVE AM-STATE         TO OUT-FORM
  8388           IF AM-ACCOUNT (10:1) = 'L'
  8389              MOVE 'L'           TO OUT-FORM (3:1)
  8390                                    OUT-LEASE-IND
  8391           END-IF
  8392           MOVE AM-CONTROL-PRIMARY (1:8)
  8393                                 TO WS-ERCOMP-KEY
  8394           IF AM-REMIT-TO NOT NUMERIC
  8395              MOVE 01            TO AM-REMIT-TO
  8396           END-IF
  8397           MOVE AM-AGT (AM-REMIT-TO) TO WS-ERCOMP-RESP-NO
  8398           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8399              (AM-COM-TYP (S1) = 'C' OR 'D')
  8400              OR (S1 > +10)
  8401           END-PERFORM
  8402           IF S1 < +11
  8403              MOVE AM-AGT (S1)   TO WS-ERCOMP-ACCOUNT
  8404           END-IF
  8405           MOVE 'A'              TO WS-ERCOMP-REC-TYPE
  8406           PERFORM 1225-GET-ERCOMP THRU 1225-EXIT
  8407        END-IF
  8408     END-IF
  8409
  8410* EXEC CICS ENDBR
  8411*        DATASET   ('ERACCT')
  8412*    END-EXEC
  8413     MOVE 'ERACCT' TO DFHEIV1
  8414     MOVE 0
  8415       TO DFHEIV11
  8416*    MOVE '&2                    $   #00008045' TO DFHEIV0
  8417     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8418     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8419     MOVE X'2020233030303038303435' TO DFHEIV0(25:11)
  8420     CALL 'kxdfhei1' USING DFHEIV0,
  8421           DFHEIV1,
  8422           DFHEIV11,
  8423           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 147
* NSRASBL.cbl
  8424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8425    .
  8426 1200-EXIT.
  8427     EXIT.
  8428 1225-GET-ERCOMP.
  8429
  8430* EXEC CICS READ
  8431*       INTO    (COMPENSATION-MASTER)
  8432*       DATASET ('ERCOMP')
  8433*       RIDFLD  (WS-ERCOMP-KEY)
  8434*       RESP    (WS-RESPONSE)
  8435*    END-EXEC
  8436     MOVE LENGTH OF
  8437      COMPENSATION-MASTER
  8438       TO DFHEIV11
  8439     MOVE 'ERCOMP' TO DFHEIV1
  8440*    MOVE '&"IL       E          (  N#00008052' TO DFHEIV0
  8441     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8442     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8443     MOVE X'204E233030303038303532' TO DFHEIV0(25:11)
  8444     CALL 'kxdfhei1' USING DFHEIV0,
  8445           DFHEIV1,
  8446           COMPENSATION-MASTER,
  8447           DFHEIV11,
  8448           WS-ERCOMP-KEY,
  8449           DFHEIV99,
  8450           DFHEIV99,
  8451           DFHEIV99
  8452     MOVE EIBRESP  TO WS-RESPONSE
  8453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8454     IF RESP-NORMAL
  8455        MOVE CO-RESP-NO          TO OUT-RESP-NO
  8456        MOVE CO-ACCT-NAME        TO OUT-COMP-NAME
  8457        MOVE CO-MAIL-NAME        TO OUT-COMP-MAIL-TO
  8458        MOVE CO-ADDR-1           TO OUT-COMP-ADDR1
  8459        MOVE CO-ADDR-2           TO OUT-COMP-ADDR2
  8460        MOVE CO-ADDR-CITY        TO OUT-COMP-CITY
  8461        MOVE CO-ADDR-STATE       TO OUT-COMP-STATE
  8462        MOVE CO-ZIP              TO OUT-COMP-ZIP
  8463        MOVE CO-TELEPHONE        TO OUT-COMP-PHONE
  8464        MOVE CO-FAXNO            TO OUT-COMP-FAX
  8465        MOVE CO-GA-STATUS-CODE   TO OUT-COMP-STATUS
  8466        MOVE CO-BILL-SW          TO OUT-BILL-SW
  8467     END-IF
  8468     .
  8469 1225-EXIT.
  8470     EXIT.
  8471 1250-GET-ELLETR.
  8472     display ' made it to 1250 '
  8473     move spaces                 to W-Z-CONTROL-DATA
  8474     MOVE WS-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  8475     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  8476     MOVE +0                     TO WS-ELLETR-SEQ-NO
  8477
  8478* EXEC CICS READ
  8479*         DATASET    ('ELLETR')
  8480*         INTO       (TEXT-FILES)
  8481*         RIDFLD     (WS-ELLETR-KEY)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 148
* NSRASBL.cbl
  8482*         RESP       (WS-RESPONSE)
  8483*         GTEQ
  8484*    END-EXEC
  8485     MOVE LENGTH OF
  8486      TEXT-FILES
  8487       TO DFHEIV11
  8488     MOVE 'ELLETR' TO DFHEIV1
  8489*    MOVE '&"IL       G          (  N#00008081' TO DFHEIV0
  8490     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8491     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8492     MOVE X'204E233030303038303831' TO DFHEIV0(25:11)
  8493     CALL 'kxdfhei1' USING DFHEIV0,
  8494           DFHEIV1,
  8495           TEXT-FILES,
  8496           DFHEIV11,
  8497           WS-ELLETR-KEY,
  8498           DFHEIV99,
  8499           DFHEIV99,
  8500           DFHEIV99
  8501     MOVE EIBRESP  TO WS-RESPONSE
  8502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8503     IF RESP-NORMAL
  8504        IF (LETTER-FILE-TEXT)
  8505           AND (BL-LETTER-ID = TX-LETTER-NO)
  8506           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  8507           display ' found good z record '
  8508           PERFORM 1280-PROCESS-Z-CONTROLS
  8509                                 THRU 1280-EXIT
  8510        END-IF
  8511     END-IF
  8512     .
  8513 1250-EXIT.
  8514     EXIT.
  8515 1280-PROCESS-Z-CONTROLS.
  8516     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  8517*    IF W-FORM-TO-RESEND > SPACES
  8518*       MOVE W-FORM-TO-RESEND    TO OUT-FORM
  8519*    ELSE
  8520*       MOVE SPACES              TO OUT-FORM
  8521*    END-IF
  8522     MOVE W-ENCLOSURE-CD         TO BL-ENC-CD
  8523     MOVE W-LETTER-TYPE          TO OUT-LETTER-TYPE
  8524     MOVE W-PRINT-CERTIFICATE    TO OUT-PRINT-CERTIFICATE
  8525     .
  8526 1280-EXIT.
  8527     EXIT.
  8528 1300-DETERMINE-COMM.
  8529******************************************************************
  8530* DATA SOURCE MEANINGS  BL-DATA-SRCE
  8531*    1) FROM ACCT MAINT
  8532*    2) FROM CERT UPDATE
  8533*    3) FROM COMP MAINT
  8534*    4) FROM REVIEW AND CORRECTIONS
  8535******************************************************************
  8536     MOVE 'Y'                    TO OUT-CHGBACK
  8537     MOVE ZEROS                  TO WS-DIFF
  8538                                    WS-CHGBK-LIFE-PCT
  8539                                    WS-CHGBK-AH-PCT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 149
* NSRASBL.cbl
  8540     IF BL-DATA-SRCE = '4'
  8541        IF PB-CANCELLATION
  8542           MOVE PB-CI-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8543           MOVE PB-CI-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8544           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
  8545           MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-2
  8546           IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  8547              MOVE PB-C-LF-CANCEL-DT
  8548                                 TO DC-BIN-DATE-2
  8549           END-IF
  8550           MOVE '1'              TO DC-OPTION-CODE
  8551           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8552           IF NO-CONVERSION-ERROR
  8553              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8554              IF DC-ODD-DAYS-OVER > +1
  8555                 ADD +1          TO WS-DIFF
  8556              END-IF
  8557              IF (WS-CHGBACK = 99)
  8558                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8559                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8560                                WS-CHGBK-AH-PCT
  8561                   MOVE 'N'  TO OUT-CHGBACK
  8562              END-IF
  8563           END-IF
  8564        ELSE
  8565           MOVE PB-I-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8566           MOVE PB-I-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8567        END-IF
  8568     ELSE
  8569        MOVE CM-LIFE-COMM-PCT TO WS-CHGBK-LIFE-PCT
  8570        MOVE CM-AH-COMM-PCT   TO WS-CHGBK-AH-PCT
  8571        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8572           OR (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8573           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  8574           MOVE CM-AH-CANCEL-DT  TO DC-BIN-DATE-2
  8575           IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  8576              MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  8577           END-IF
  8578           MOVE '1'              TO DC-OPTION-CODE
  8579           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8580           IF NO-CONVERSION-ERROR
  8581              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8582              IF DC-ODD-DAYS-OVER > +1
  8583                 ADD +1          TO WS-DIFF
  8584              END-IF
  8585              IF (WS-CHGBACK = 99)
  8586                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8587                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8588                                WS-CHGBK-AH-PCT
  8589                   MOVE 'N'  TO OUT-CHGBACK
  8590              END-IF
  8591           END-IF
  8592        END-IF
  8593     END-IF
  8594     .
  8595 1300-EXIT.
  8596     EXIT.
  8597 1500-GET-ARCH-NO.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 150
* NSRASBL.cbl
  8598     DISPLAY ' MADE IT TO 1500 '
  8599     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  8600     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  8601     MOVE SPACES                 TO WS-ELCNTL-GENL
  8602     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8603
  8604* EXEC CICS READ
  8605*       INTO    (CONTROL-FILE)
  8606*       DATASET ('ELCNTL')
  8607*       RIDFLD  (WS-ELCNTL-KEY)
  8608*       UPDATE
  8609*       RESP    (WS-RESPONSE)
  8610*    END-EXEC
  8611     MOVE LENGTH OF
  8612      CONTROL-FILE
  8613       TO DFHEIV11
  8614     MOVE 'ELCNTL' TO DFHEIV1
  8615*    MOVE '&"IL       EU         (  N#00008188' TO DFHEIV0
  8616     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8617     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8618     MOVE X'204E233030303038313838' TO DFHEIV0(25:11)
  8619     CALL 'kxdfhei1' USING DFHEIV0,
  8620           DFHEIV1,
  8621           CONTROL-FILE,
  8622           DFHEIV11,
  8623           WS-ELCNTL-KEY,
  8624           DFHEIV99,
  8625           DFHEIV99,
  8626           DFHEIV99
  8627     MOVE EIBRESP  TO WS-RESPONSE
  8628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8629     IF RESP-NORMAL
  8630        AND (CF-COMPANY-ID  = BL-COMP-ID)
  8631        AND (CF-RECORD-TYPE = '1')
  8632        ADD +1                   TO CF-CREDIT-LAST-ARCH-NUM
  8633        MOVE CF-CREDIT-LAST-ARCH-NUM
  8634                                 TO WS-ARCHIVE-NO
  8635
  8636* EXEC CICS REWRITE
  8637*          FROM    (CONTROL-FILE)
  8638*          DATASET ('ELCNTL')
  8639*       END-EXEC
  8640     MOVE LENGTH OF
  8641      CONTROL-FILE
  8642       TO DFHEIV11
  8643     MOVE 'ELCNTL' TO DFHEIV1
  8644*    MOVE '&& L                  %   #00008201' TO DFHEIV0
  8645     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8646     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8647     MOVE X'2020233030303038323031' TO DFHEIV0(25:11)
  8648     CALL 'kxdfhei1' USING DFHEIV0,
  8649           DFHEIV1,
  8650           CONTROL-FILE,
  8651           DFHEIV11,
  8652           DFHEIV99
  8653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8654     ELSE
  8655        MOVE +0                  TO WS-ARCHIVE-NO
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 151
* NSRASBL.cbl
  8656     END-IF
  8657    .
  8658 1500-EXIT.
  8659     EXIT.
  8660 1700-GET-ELENCC.
  8661     MOVE WS-COMPANY-CD          TO WS-ELENCC-KEY
  8662     MOVE '2'                    TO WS-ELENCC-REC-TYPE
  8663     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  8664     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  8665        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  8666        OR (E1 > +5)
  8667     END-PERFORM
  8668     IF E1 < +5
  8669        MOVE BL-STATE            TO WS-ELENCC-ENC-CODE (E1:2)
  8670     END-IF
  8671
  8672* EXEC CICS READ
  8673*        DATASET   ('ELENCC')
  8674*        INTO      (ENCLOSURE-CODES)
  8675*        RIDFLD    (WS-ELENCC-KEY)
  8676*        RESP      (WS-RESPONSE)
  8677*    END-EXEC
  8678     MOVE LENGTH OF
  8679      ENCLOSURE-CODES
  8680       TO DFHEIV11
  8681     MOVE 'ELENCC' TO DFHEIV1
  8682*    MOVE '&"IL       E          (  N#00008222' TO DFHEIV0
  8683     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8684     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8685     MOVE X'204E233030303038323232' TO DFHEIV0(25:11)
  8686     CALL 'kxdfhei1' USING DFHEIV0,
  8687           DFHEIV1,
  8688           ENCLOSURE-CODES,
  8689           DFHEIV11,
  8690           WS-ELENCC-KEY,
  8691           DFHEIV99,
  8692           DFHEIV99,
  8693           DFHEIV99
  8694     MOVE EIBRESP  TO WS-RESPONSE
  8695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8696     IF NOT RESP-NORMAL
  8697        display ' elencc resp not normal ' ws-response
  8698        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  8699
  8700* EXEC CICS READ
  8701*           DATASET   ('ELENCC')
  8702*           INTO      (ENCLOSURE-CODES)
  8703*           RIDFLD    (WS-ELENCC-KEY)
  8704*           RESP      (WS-RESPONSE)
  8705*       END-EXEC
  8706     MOVE LENGTH OF
  8707      ENCLOSURE-CODES
  8708       TO DFHEIV11
  8709     MOVE 'ELENCC' TO DFHEIV1
  8710*    MOVE '&"IL       E          (  N#00008231' TO DFHEIV0
  8711     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8712     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8713     MOVE X'204E233030303038323331' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 152
* NSRASBL.cbl
  8714     CALL 'kxdfhei1' USING DFHEIV0,
  8715           DFHEIV1,
  8716           ENCLOSURE-CODES,
  8717           DFHEIV11,
  8718           WS-ELENCC-KEY,
  8719           DFHEIV99,
  8720           DFHEIV99,
  8721           DFHEIV99
  8722     MOVE EIBRESP  TO WS-RESPONSE
  8723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8724     END-IF
  8725     IF RESP-NORMAL
  8726        display ' elencc resp normal ' ws-response
  8727        MOVE NC-OUTPUT-STACK     TO OUT-STACK
  8728        MOVE NC-ENCLOSURE-LINE   TO OUT-ENC-LINE
  8729        MOVE NC-ATTACHMENTS      TO OUT-ATTACH
  8730     END-IF
  8731     .
  8732 1700-EXIT.
  8733     EXIT.
  8734 9700-DATE-LINK.
  8735
  8736* EXEC CICS LINK
  8737*        PROGRAM   ('ELDATCV')
  8738*        COMMAREA  (DATE-CONVERSION-DATA)
  8739*        LENGTH    (DC-COMM-LENGTH)
  8740*    END-EXEC.
  8741     MOVE 'ELDATCV' TO DFHEIV1
  8742*    MOVE '."C                   (   #00008248' TO DFHEIV0
  8743     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8744     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8745     MOVE X'2020233030303038323438' TO DFHEIV0(25:11)
  8746     CALL 'kxdfhei1' USING DFHEIV0,
  8747           DFHEIV1,
  8748           DATE-CONVERSION-DATA,
  8749           DC-COMM-LENGTH,
  8750           DFHEIV99,
  8751           DFHEIV99,
  8752           DFHEIV99,
  8753           DFHEIV99
  8754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8755
  8756 9700-EXIT.
  8757      EXIT.
  8758
  8759 9999-DFHBACK SECTION.
  8760     MOVE '9%                    "   ' TO DFHEIV0
  8761     MOVE 'NSRASBL' TO DFHEIV1
  8762     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8763     GOBACK.
  8764 9999-DFHEXIT.
  8765     IF DFHEIGDJ EQUAL 0001
  8766         NEXT SENTENCE
  8767     ELSE IF DFHEIGDJ EQUAL 2
  8768         GO TO 1160-CERT-TRL-REC-NOTFND
  8769         DEPENDING ON DFHEIGDI.
  8770     MOVE '9%                    "   ' TO DFHEIV0
  8771     MOVE 'NSRASBL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:10 Page 153
* NSRASBL.cbl
  8772     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8773     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       35076     Code:       53883
