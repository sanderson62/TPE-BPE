* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page   1
* EL1284.cbl
* Options: int("EL1284.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1284.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1284.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1284.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL1284.
     4*
     5*AUTHOR.           LOGIC,INC.
     6*                  DALLAS,TEXAS.
     7
     8*DATE-COMPILED.
     9*SECURITY.   *****************************************************
    10*            *                                                   *
    11*            * THIS PROGRAM IS THE PROPERTY OF LOCIC, INC. *
    12*            *                                                   *
    13*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page   2
* EL1284.cbl
    14*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    15*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    16*            *                                                   *
    17*            *****************************************************
    18*
    19*REMARKS.     TRANSACTION - EXXG - CLAIM MEMO MAINTENANCE.
    20*
    21******************************************************************
    22*                   C H A N G E   L O G
    23*
    24* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    25*-----------------------------------------------------------------
    26*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    27* EFFECTIVE    NUMBER
    28*-----------------------------------------------------------------
    29* 010416   2015072900002   TANA  NEW CLAIM MEMO SCREEN
    30* 040416   2016021500002   TANA  CHANGE REWRITE FIELD VALID VALUES
    31* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    32******************************************************************
    33*
    34 ENVIRONMENT DIVISION.
    35
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page   3
* EL1284.cbl
    37 DATA DIVISION.
    38 WORKING-STORAGE SECTION.
    39 01  DFH-START PIC X(04).
    40 77  FILLER  PIC X(32)  VALUE '********************************'.
    41 77  FILLER  PIC X(32)  VALUE '*     EL1284 WORKING STORAGE   *'.
    42 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.005 ***********'.
    43
    44*    COPY ELCSCTM.
    45******************************************************************
    46*                                                                *
    47*                                                                *
    48*                            ELCSCTM                             *
    49*                            VMOD=2.001                          *
    50*                                                                *
    51*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    52*                                                                *
    53******************************************************************
    54 01  SECURITY-MESSAGE.
    55     12  FILLER                          PIC X(30)
    56            VALUE '** LOGIC SECURITY VIOLATION -'.
    57     12  SM-READ                         PIC X(6).
    58     12  FILLER                          PIC X(5)
    59            VALUE ' PGM='.
    60     12  SM-PGM                          PIC X(6).
    61     12  FILLER                          PIC X(5)
    62            VALUE ' OPR='.
    63     12  SM-PROCESSOR-ID                 PIC X(4).
    64     12  FILLER                          PIC X(6)
    65            VALUE ' TERM='.
    66     12  SM-TERMID                       PIC X(4).
    67     12  FILLER                          PIC XX   VALUE SPACE.
    68     12  SM-JUL-DATE                     PIC 9(5).
    69     12  FILLER                          PIC X    VALUE SPACE.
    70     12  SM-TIME                         PIC 99.99.
    71
    72*    COPY ELCSCRTY.
    73******************************************************************
    74*                                                                *
    75*                                                                *
    76*                            ELCSCRTY                            *
    77*                            VMOD=2.001                          *
    78*                                                                *
    79*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    80*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    81*        SAVED IN PI-SECURITY-ADDRESS.                           *
    82*                                                                *
    83******************************************************************
    84 01  SECURITY-CONTROL.
    85     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    86     12  FILLER                       PIC XX    VALUE 'SC'.
    87     12  SC-CREDIT-CODES.
    88         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    89             20  SC-CREDIT-DISPLAY    PIC X.
    90             20  SC-CREDIT-UPDATE     PIC X.
    91     12  SC-CLAIMS-CODES.
    92         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    93             20  SC-CLAIMS-DISPLAY    PIC X.
    94             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page   4
* EL1284.cbl
    95
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page   5
* EL1284.cbl
    97 01  STANDARD-AREAS.
    98     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
    99     12  MAP-NAME                PIC X(8)    VALUE 'EL1284A'.
   100     12  MAPSET-NAME             PIC X(8)    VALUE 'EL1284S '.
   101     12  SCRN-NUMBER             PIC X(4)    VALUE '128D'.
   102     12  TRANS-ID                PIC X(4)    VALUE 'EXXG'.
   103     12  THIS-PGM                PIC X(8)    VALUE 'EL1284'.
   104     12  PGM-NAME                PIC X(8).
   105     12  PGM-EL1276              PIC X(8)    VALUE 'EL1276'.
   106
   107     12  ELMEMO-FILE-ID          PIC X(8)    VALUE 'ELMEMO'.
   108     12  ELCERT-FILE-ID          PIC X(8)    VALUE 'ELCERT'.
   109     12  QID.
   110         16  QID-TERM            PIC X(4).
   111         16  FILLER              PIC X(4)    VALUE '128D'.
   112     12  QID-ITEM                PIC S9(4)   COMP VALUE +0.
   113     12  SC-ITEM                 PIC S9(4)   COMP VALUE +1.
   114     12  WS-LINE                 PIC 9(3)    VALUE 0.
   115     12  WS-BLANK-LINES          PIC S9(4)   COMP VALUE +0.
   116
   117 01  WORK-AREA.
   118     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   119     12  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   120
   121     12  ELMEMO-LENGTH           PIC S9(4)   COMP VALUE +132.
   122     12  ELMEMO-KEY-LENGTH       PIC S9(4)   COMP VALUE +23.
   123     12  ELMEMO-START-LENGTH     PIC S9(4)   COMP VALUE +21.
   124     12  ELMEMO-KEY.
   125         16  ELMEMO-PARTIAL-KEY.
   126             20 ELMEMO-COMPANY-CD    PIC X.
   127             20 ELMEMO-RECORD-TYPE   PIC X.
   128             20 ELMEMO-CARRIER       PIC X.
   129             20 ELMEMO-CLAIM-NO      PIC  X(7).
   130             20 ELMEMO-CERT-NO.
   131                25 ELMEMO-CERT-PRIME PIC X(10).
   132                25 ELMEMO-CERT-SFX   PIC X.
   133         16 ELMEMO-SEQ           PIC S9(4) COMP.
   134     12  SV-PRIOR-KEY.
   135         20 SV-COMPANY-CD            PIC X.
   136         20 SV-RECORD-TYPE           PIC X.
   137         20 SV-CARRIER               PIC X.
   138         20 SV-CLAIM-NO              PIC  X(7).
   139         20 SV-CERT-NO.
   140            25 SV-CERT-PRIME         PIC X(10).
   141            25 SV-CERT-SFX           PIC X(1).
   142     12  ELCERT-KEY.
   143         16  ELCERT-COMPANY-CD        PIC X.
   144         16  ELCERT-CARRIER           PIC X.
   145         16  ELCERT-GROUPING          PIC X(6).
   146         16  ELCERT-STATE             PIC XX.
   147         16  ELCERT-ACCOUNT           PIC X(10).
   148         16  ELCERT-EFF-DT            PIC XX.
   149         16  ELCERT-CERT-NO.
   150             20  ELCERT-CERT-PRIME    PIC X(10).
   151             20  ELCERT-CERT-SFX      PIC X.
   152
   153     12  TIME-IN                 PIC S9(7).
   154     12  TIME-SPLIT REDEFINES TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page   6
* EL1284.cbl
   155         16  FILLER              PIC X.
   156         16  TIME-OUT            PIC 99V99.
   157         16  FILLER              PIC X(2).
   158     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   159     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   160     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   161     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   162     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   163     12  MAX-LINES               PIC 999     VALUE 300.
   164     12  NUM-LINES-PER-SCREEN    PIC 99      VALUE 10.
   165     12  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 50.
   166     12  TS-GROUP-WORK           PIC 9(5)    VALUE 0  COMP-3.
   167     12  TS-LENGTH               PIC S9(4)   VALUE +3650 COMP.
   168     12  ROLL-COUNTER            PIC S999    VALUE +0 COMP-3.
   169     12  TEMP-CURR-LINE          PIC S9(3)   COMP-3.
   170     12  WS-SUB                  PIC S9(3)   COMP-3.
   171     12  WS-SUB1                 PIC S9(3)   COMP-3.
   172     12  WS-ERASE-EOF            PIC X       VALUE X'80'.
   173     12  DEEDIT-DATE-INPUT.
   174         16  FILLER              PIC XX.
   175         16  DEEDIT-DATE         PIC X(6).
   176     12  WS-CURSOR-SET           PIC X       VALUE 'N'.
   177         88 CURSOR-SET                       VALUE 'Y'.
   178     12  WS-SCREEN-LINE          PIC X       VALUE 'N'.
   179         88 SCREEN-LINE-FOUND                VALUE 'Y'.
   180
   181     12  ELMSTR-KEY.
   182         16  MSTR-COMP-CD    PIC X.
   183         16  MSTR-CARRIER    PIC X.
   184         16  MSTR-CLAIM-NO   PIC X(7).
   185         16  MSTR-CERT-NO.
   186             20  MSTR-CERT-NO-PRIME  PIC X(10).
   187             20  MSTR-CERT-NO-SUFX   PIC X.
   188 01  COMP-LENGTHS.
   189     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   190     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   191     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   192     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   193     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   194     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   195     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   196     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   197     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   198     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   199     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   200     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   201     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   202     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page   7
* EL1284.cbl
   204 01  ERROR-MESSAGES.
   205     12  ER-0000             PIC X(04)       VALUE '0000'.
   206     12  ER-0004             PIC X(04)       VALUE '0004'.
   207     12  ER-0006             PIC X(04)       VALUE '0006'.
   208     12  ER-0008             PIC X(04)       VALUE '0008'.
   209     12  ER-0023             PIC X(04)       VALUE '0023'.
   210     12  ER-0029             PIC X(04)       VALUE '0029'.
   211     12  ER-0030             PIC X(04)       VALUE '0030'.
   212     12  ER-0031             PIC X(04)       VALUE '0031'.
   213     12  ER-0032             PIC X(04)       VALUE '0032'.
   214     12  ER-0033             PIC X(04)       VALUE '0033'.
   215     12  ER-0041             PIC X(04)       VALUE '0041'.
   216     12  ER-0044             PIC X(04)       VALUE '0044'.
   217     12  ER-0045             PIC X(04)       VALUE '0045'.
   218     12  ER-0046             PIC X(04)       VALUE '0046'.
   219     12  ER-0047             PIC X(04)       VALUE '0047'.
   220     12  ER-0048             PIC X(04)       VALUE '0048'.
   221     12  ER-0049             PIC X(04)       VALUE '0049'.
   222     12  ER-0050             PIC X(04)       VALUE '0050'.
   223     12  ER-0051             PIC X(04)       VALUE '0051'.
   224     12  ER-0066             PIC X(04)       VALUE '0066'.
   225     12  ER-0067             PIC X(04)       VALUE '0067'.
   226     12  ER-0069             PIC X(04)       VALUE '0069'.
   227     12  ER-0070             PIC X(04)       VALUE '0070'.
   228     12  ER-0140             PIC X(04)       VALUE '0140'.
   229     12  ER-0314             PIC X(04)       VALUE '0314'.
   230     12  ER-2954             PIC X(04)       VALUE '2954'.
   231     12  ER-3846             PIC X(04)       VALUE '3846'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page   8
* EL1284.cbl
   233*                       COPY ELCLOGOF.
   234******************************************************************
   235*                                                                *
   236*                                                                *
   237*                            ELCLOGOF.                           *
   238*                            VMOD=2.001                          *
   239*                                                                *
   240*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   241*                                                                *
   242******************************************************************
   243 01  CLASIC-LOGOFF.
   244     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   245     12  LOGOFF-TEXT.
   246         16  FILLER          PIC X(5)    VALUE SPACES.
   247         16  LOGOFF-MSG.
   248             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   249             20  FILLER      PIC X       VALUE SPACES.
   250             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   251         16  FILLER          PIC X(80)
   252           VALUE '* YOU ARE NOW LOGGED OFF'.
   253         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   254         16  FILLER          PIC X       VALUE QUOTE.
   255         16  LOGOFF-SYS-MSG  PIC X(17)
   256           VALUE 'S CLAS-IC SYSTEM '.
   257     12  TEXT-MESSAGES.
   258         16  UNACCESS-MSG    PIC X(29)
   259             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   260         16  PGMIDERR-MSG    PIC X(17)
   261             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page   9
* EL1284.cbl
   263*                       COPY ELCAID.
   264******************************************************************
   265*                                                                *
   266*                            ELCAID.                             *
   267*                            VMOD=2.001                          *
   268*                                                                *
   269*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   270*                                                                *
   271*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   272*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   273******************************************************************
   274
   275 01  DFHAID.
   276   02  DFHNULL   PIC  X  VALUE  ' '.
   277   02  DFHENTER  PIC  X  VALUE  QUOTE.
   278   02  DFHCLEAR  PIC  X  VALUE  '_'.
   279   02  DFHPEN    PIC  X  VALUE  '='.
   280   02  DFHOPID   PIC  X  VALUE  'W'.
   281   02  DFHPA1    PIC  X  VALUE  '%'.
   282   02  DFHPA2    PIC  X  VALUE  '>'.
   283   02  DFHPA3    PIC  X  VALUE  ','.
   284   02  DFHPF1    PIC  X  VALUE  '1'.
   285   02  DFHPF2    PIC  X  VALUE  '2'.
   286   02  DFHPF3    PIC  X  VALUE  '3'.
   287   02  DFHPF4    PIC  X  VALUE  '4'.
   288   02  DFHPF5    PIC  X  VALUE  '5'.
   289   02  DFHPF6    PIC  X  VALUE  '6'.
   290   02  DFHPF7    PIC  X  VALUE  '7'.
   291   02  DFHPF8    PIC  X  VALUE  '8'.
   292   02  DFHPF9    PIC  X  VALUE  '9'.
   293   02  DFHPF10   PIC  X  VALUE  ':'.
   294   02  DFHPF11   PIC  X  VALUE  '#'.
   295   02  DFHPF12   PIC  X  VALUE  '@'.
   296   02  DFHPF13   PIC  X  VALUE  'A'.
   297   02  DFHPF14   PIC  X  VALUE  'B'.
   298   02  DFHPF15   PIC  X  VALUE  'C'.
   299   02  DFHPF16   PIC  X  VALUE  'D'.
   300   02  DFHPF17   PIC  X  VALUE  'E'.
   301   02  DFHPF18   PIC  X  VALUE  'F'.
   302   02  DFHPF19   PIC  X  VALUE  'G'.
   303   02  DFHPF20   PIC  X  VALUE  'H'.
   304   02  DFHPF21   PIC  X  VALUE  'I'.
   305*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   306   02  DFHPF22   PIC  X  VALUE  '['.
   307   02  DFHPF23   PIC  X  VALUE  '.'.
   308   02  DFHPF24   PIC  X  VALUE  '<'.
   309   02  DFHMSRE   PIC  X  VALUE  'X'.
   310   02  DFHSTRF   PIC  X  VALUE  'h'.
   311   02  DFHTRIG   PIC  X  VALUE  '"'.
   312 01  FILLER  REDEFINES DFHAID.
   313     12  FILLER                  PIC X(8).
   314     12  PF-VALUES OCCURS 24 TIMES       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  10
* EL1284.cbl
   316*                       COPY ELCEMIB.
   317******************************************************************
   318*                                                                *
   319*                                                                *
   320*                            ELCEMIB.                            *
   321*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   322*                            VMOD=2.005                          *
   323*                                                                *
   324*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   325*                                                                *
   326******************************************************************
   327 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   328     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   329     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   330     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   331     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   332     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   333     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   334     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   335     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   336     12  EMI-SWITCH1             PIC X        VALUE '1'.
   337         88  EMI-NO-ERRORS                    VALUE '1'.
   338         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   339         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   340     12  EMI-SWITCH2             PIC X        VALUE '1'.
   341         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   342     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   343         88  EMI-AREA1-EMPTY                  VALUE '1'.
   344         88  EMI-AREA1-FULL                   VALUE '2'.
   345     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   346         88  EMI-AREA2-EMPTY                  VALUE '1'.
   347         88  EMI-AREA2-FULL                   VALUE '2'.
   348     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   349         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   350         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   351         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   352         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   353         88  EMI-BYPASS-FATALS                VALUE 'X'.
   354     12  EMI-ERROR-LINES.
   355         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   356         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   357         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   358         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   359             20  EMI-ERR-CODES OCCURS 10 TIMES.
   360                 24  EMI-ERR-NUM         PIC X(4).
   361                 24  EMI-FILLER          PIC X.
   362                 24  EMI-SEV             PIC X.
   363                 24  FILLER              PIC X.
   364             20  FILLER                  PIC X(02).
   365     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   366         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   367             20  EMI-ERROR-NUMBER    PIC X(4).
   368             20  EMI-FILL            PIC X.
   369             20  EMI-SEVERITY        PIC X.
   370             20  FILLER              PIC X.
   371             20  EMI-ERROR-TEXT.
   372                 24  EMI-TEXT-VARIABLE   PIC X(10).
   373                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  11
* EL1284.cbl
   374     12  EMI-SEVERITY-SAVE           PIC X.
   375         88  EMI-NOTE                    VALUE 'N'.
   376         88  EMI-WARNING                 VALUE 'W'.
   377         88  EMI-FORCABLE                VALUE 'F'.
   378         88  EMI-FATAL                   VALUE 'X'.
   379     12  EMI-MESSAGE-FLAG            PIC X.
   380         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   381         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   382     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   383     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   384         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   385         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   386         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   387     12  emi-claim-no                pic x(7).
   388     12  emi-claim-type              pic x(6).
   389     12  FILLER                      PIC X(124)  VALUE SPACES.
   390     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   391     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   392     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   393     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  12
* EL1284.cbl
   395*                       COPY ELCINTF.
   396******************************************************************
   397*                                                                *
   398*                                                                *
   399*                            ELCINTF.                            *
   400*                            VMOD=2.017                          *
   401*                                                                *
   402*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   403*                                                                *
   404*       LENGTH = 1024                                            *
   405*                                                                *
   406******************************************************************
   407*                   C H A N G E   L O G
   408*
   409* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   410*-----------------------------------------------------------------
   411*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   412* EFFECTIVE    NUMBER
   413*-----------------------------------------------------------------
   414* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   415******************************************************************
   416 01  PROGRAM-INTERFACE-BLOCK.
   417     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   418     12  PI-CALLING-PROGRAM              PIC X(8).
   419     12  PI-SAVED-PROGRAM-1              PIC X(8).
   420     12  PI-SAVED-PROGRAM-2              PIC X(8).
   421     12  PI-SAVED-PROGRAM-3              PIC X(8).
   422     12  PI-SAVED-PROGRAM-4              PIC X(8).
   423     12  PI-SAVED-PROGRAM-5              PIC X(8).
   424     12  PI-SAVED-PROGRAM-6              PIC X(8).
   425     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   426     12  PI-COMPANY-ID                   PIC XXX.
   427     12  PI-COMPANY-CD                   PIC X.
   428
   429     12  PI-COMPANY-PASSWORD             PIC X(8).
   430
   431     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   432
   433     12  PI-CONTROL-IN-PROGRESS.
   434         16  PI-CARRIER                  PIC X.
   435         16  PI-GROUPING                 PIC X(6).
   436         16  PI-STATE                    PIC XX.
   437         16  PI-ACCOUNT                  PIC X(10).
   438         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   439                                         PIC X(10).
   440         16  PI-CLAIM-CERT-GRP.
   441             20  PI-CLAIM-NO             PIC X(7).
   442             20  PI-CERT-NO.
   443                 25  PI-CERT-PRIME       PIC X(10).
   444                 25  PI-CERT-SFX         PIC X.
   445             20  PI-CERT-EFF-DT          PIC XX.
   446         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   447             20  PI-PLAN-CODE            PIC X(2).
   448             20  PI-REVISION-NUMBER      PIC X(3).
   449             20  PI-PLAN-EFF-DT          PIC X(2).
   450             20  PI-PLAN-EXP-DT          PIC X(2).
   451             20  FILLER                  PIC X(11).
   452         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  13
* EL1284.cbl
   453             20  PI-OE-REFERENCE-1.
   454                 25  PI-OE-REF-1-PRIME   PIC X(18).
   455                 25  PI-OE-REF-1-SUFF    PIC XX.
   456
   457     12  PI-SESSION-IN-PROGRESS          PIC X.
   458         88  CLAIM-SESSION                   VALUE '1'.
   459         88  CREDIT-SESSION                  VALUE '2'.
   460         88  WARRANTY-SESSION                VALUE '3'.
   461         88  MORTGAGE-SESSION                VALUE '4'.
   462         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   463
   464
   465*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   466
   467     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   468     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   469
   470     12  PI-CREDIT-USER                  PIC X.
   471         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   472         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   473
   474     12  PI-CLAIM-USER                   PIC X.
   475         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   476         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   477
   478     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   479         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   480         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   481         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   482         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   483         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   484
   485     12  PI-PROCESSOR-ID                 PIC X(4).
   486
   487     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   488
   489     12  PI-MEMBER-CAPTION               PIC X(10).
   490
   491     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   492         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   493
   494     12  PI-LIFE-OVERRIDE-L1             PIC X.
   495     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   496     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   497     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   498
   499     12  PI-AH-OVERRIDE-L1               PIC X.
   500     12  PI-AH-OVERRIDE-L2               PIC XX.
   501     12  PI-AH-OVERRIDE-L6               PIC X(6).
   502     12  PI-AH-OVERRIDE-L12              PIC X(12).
   503
   504     12  PI-NEW-SYSTEM                   PIC X(2).
   505
   506     12  PI-PRIMARY-CERT-NO              PIC X(11).
   507     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   508         88  PI-USES-PAID-TO                 VALUE '1'.
   509     12  PI-CRDTCRD-SYSTEM.
   510         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  14
* EL1284.cbl
   511             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   512             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   513         16  PI-CC-MONTH-END-DT          PIC XX.
   514     12  PI-PROCESSOR-PRINTER            PIC X(4).
   515
   516     12  PI-OE-REFERENCE-2.
   517         16  PI-OE-REF-2-PRIME           PIC X(10).
   518         16  PI-OE-REF-2-SUFF            PIC X.
   519
   520     12  PI-REM-TRM-CALC-OPTION          PIC X.
   521
   522     12  PI-LANGUAGE-TYPE                PIC X.
   523             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   524             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   525             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   526
   527     12  PI-POLICY-LINKAGE-IND           PIC X.
   528         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   529         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   530                                                   LOW-VALUES.
   531
   532     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   533     12  PI-CLAIM-PW-SESSION             PIC X(1).
   534         88  PI-CLAIM-CREDIT                 VALUE '1'.
   535         88  PI-CLAIM-CONVEN                 VALUE '2'.
   536
   537     12  PI-PROCESSOR-CSR-IND            PIC X.
   538         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   539         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   540
   541     12  FILLER                          PIC X(3).
   542
   543     12  PI-SYSTEM-LEVEL                 PIC X(145).
   544
   545     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   546         PI-SYSTEM-LEVEL.
   547
   548         16  PI-ENTRY-CODES.
   549             20  PI-ENTRY-CD-1           PIC X.
   550             20  PI-ENTRY-CD-2           PIC X.
   551
   552         16  PI-RETURN-CODES.
   553             20  PI-RETURN-CD-1          PIC X.
   554             20  PI-RETURN-CD-2          PIC X.
   555
   556         16  PI-UPDATE-STATUS-SAVE.
   557             20  PI-UPDATE-BY            PIC X(4).
   558             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   559
   560         16  PI-LOWER-CASE-LETTERS       PIC X.
   561             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   562
   563*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   564*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   565*            88  CARRIER-CLM-CNTL            VALUE '2'.
   566
   567         16  PI-CERT-ACCESS-CONTROL      PIC X.
   568             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  15
* EL1284.cbl
   569             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   570             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   571             88  ACCNT-CNTL                  VALUE '3'.
   572             88  CARR-ACCNT-CNTL             VALUE '4'.
   573
   574         16  PI-PROCESSOR-CAP-LIST.
   575             20  PI-SYSTEM-CONTROLS.
   576                24 PI-SYSTEM-DISPLAY     PIC X.
   577                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   578                24 PI-SYSTEM-MODIFY      PIC X.
   579                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   580             20  FILLER                  PIC XX.
   581             20  PI-DISPLAY-CAP          PIC X.
   582                 88  DISPLAY-CAP             VALUE 'Y'.
   583             20  PI-MODIFY-CAP           PIC X.
   584                 88  MODIFY-CAP              VALUE 'Y'.
   585             20  PI-MSG-AT-LOGON-CAP     PIC X.
   586                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   587             20  PI-FORCE-CAP            PIC X.
   588                 88  FORCE-CAP               VALUE 'Y'.
   589
   590         16  PI-PROGRAM-CONTROLS.
   591             20  PI-PGM-PRINT-OPT        PIC X.
   592             20  PI-PGM-FORMAT-OPT       PIC X.
   593             20  PI-PGM-PROCESS-OPT      PIC X.
   594             20  PI-PGM-TOTALS-OPT       PIC X.
   595
   596         16  PI-HELP-INTERFACE.
   597             20  PI-LAST-ERROR-NO        PIC X(4).
   598             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   599
   600         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   601             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   602
   603         16  PI-CR-CONTROL-IN-PROGRESS.
   604             20  PI-CR-CARRIER           PIC X.
   605             20  PI-CR-GROUPING          PIC X(6).
   606             20  PI-CR-STATE             PIC XX.
   607             20  PI-CR-ACCOUNT           PIC X(10).
   608             20  PI-CR-FIN-RESP          PIC X(10).
   609             20  PI-CR-TYPE              PIC X.
   610
   611         16  PI-CR-BATCH-NUMBER          PIC X(6).
   612
   613         16  PI-CR-MONTH-END-DT          PIC XX.
   614
   615         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   616             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   617             88  PI-ZERO-CARRIER             VALUE '1'.
   618             88  PI-ZERO-GROUPING            VALUE '2'.
   619             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   620
   621         16  PI-CARRIER-SECURITY         PIC X.
   622             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   623
   624         16  PI-ACCOUNT-SECURITY         PIC X(10).
   625             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   626             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  16
* EL1284.cbl
   627
   628         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   629             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   630                                         INDEXED BY PI-ACCESS-NDX
   631                                         PIC X.
   632
   633         16  PI-GA-BILLING-CONTROL       PIC X.
   634             88  PI-GA-BILLING               VALUE '1'.
   635
   636         16  PI-MAIL-PROCESSING          PIC X.
   637             88  PI-MAIL-YES                 VALUE 'Y'.
   638
   639         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   640
   641         16  PI-AR-SYSTEM.
   642             20  PI-AR-PROCESSING-CNTL   PIC X.
   643                 88  PI-AR-PROCESSING        VALUE 'Y'.
   644             20  PI-AR-SUMMARY-CODE      PIC X(6).
   645             20  PI-AR-MONTH-END-DT      PIC XX.
   646
   647         16  PI-MP-SYSTEM.
   648             20  PI-MORTGAGE-USER            PIC X.
   649                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   650                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   651             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   652                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   653                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   654                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   655                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   656                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   657             20  PI-MP-MONTH-END-DT          PIC XX.
   658             20  PI-MP-REFERENCE-NO.
   659                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   660                 24  PI-MP-REFERENCE-SFX     PIC XX.
   661
   662         16  PI-LABEL-CONTROL            PIC X(01).
   663             88  PI-CREATE-LABELS                    VALUE 'Y'.
   664             88  PI-BYPASS-LABELS                    VALUE 'N'.
   665
   666         16  PI-BILL-GROUPING-CODE       PIC X(01).
   667             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   668
   669         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   670             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   671             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   672
   673         16  FILLER                      PIC X(14).
   674
   675     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   676******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  17
* EL1284.cbl
   678     12  PI-EL1284-AREA    REDEFINES PI-PROGRAM-WORK-AREA.
   679         16  FILLER              PIC X(318).
   680         16  PI-TOTAL-LINES      PIC S9(3).
   681         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
   682         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
   683         16  PI-UPDATE-SW        PIC X.
   684             88  PI-CHANGES-MADE             VALUE '1'.
   685         16  PI-LONG-HLTH-APP    PIC  X(01).
   686         16  PI-REWRITE          PIC  X(01).
   687         16  PI-CHKCOVG          PIC  X(01).
   688         16  PI-MR-RELEASE-DATE  PIC  X(08).
   689         16  PI-BILLING-NOTES-EXIST PIC X.
   690         16  PI-CERT-NOTES-EXIST    PIC X.
   691         16  PI-CLAIM-NOTES-EXIST   PIC X.
   692         16  PI-SET-NOTE-CHANGE  PIC X.
   693             88 PI-CHANGE-IN-NOTE-TYPE       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  18
* EL1284.cbl
   695*                          COPY ELCATTR.
   696******************************************************************
   697*                                                                *
   698*                            ELCATTR.                            *
   699*                            VMOD=2.001                          *
   700*                                                                *
   701*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   702*                                                                *
   703*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   704*                                                                *
   705*                   POS 1   P=PROTECTED                          *
   706*                           U=UNPROTECTED                        *
   707*                           S=ASKIP                              *
   708*                   POS 2   A=ALPHA/NUMERIC                      *
   709*                           N=NUMERIC                            *
   710*                   POS 3   N=NORMAL                             *
   711*                           B=BRIGHT                             *
   712*                           D=DARK                               *
   713*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   714*                           OF=MODIFIED DATA TAG OFF             *
   715*                                                                *
   716*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   717******************************************************************
   718 01  ATTRIBUTE-LIST.
   719     12  AL-PABOF            PIC X       VALUE 'Y'.
   720     12  AL-PABON            PIC X       VALUE 'Z'.
   721     12  AL-PADOF            PIC X       VALUE '%'.
   722     12  AL-PADON            PIC X       VALUE '_'.
   723     12  AL-PANOF            PIC X       VALUE '-'.
   724     12  AL-PANON            PIC X       VALUE '/'.
   725     12  AL-SABOF            PIC X       VALUE '8'.
   726     12  AL-SABON            PIC X       VALUE '9'.
   727     12  AL-SADOF            PIC X       VALUE '@'.
   728     12  AL-SADON            PIC X       VALUE QUOTE.
   729     12  AL-SANOF            PIC X       VALUE '0'.
   730     12  AL-SANON            PIC X       VALUE '1'.
   731     12  AL-UABOF            PIC X       VALUE 'H'.
   732     12  AL-UABON            PIC X       VALUE 'I'.
   733     12  AL-UADOF            PIC X       VALUE '<'.
   734     12  AL-UADON            PIC X       VALUE '('.
   735     12  AL-UANOF            PIC X       VALUE ' '.
   736     12  AL-UANON            PIC X       VALUE 'A'.
   737     12  AL-UNBOF            PIC X       VALUE 'Q'.
   738     12  AL-UNBON            PIC X       VALUE 'R'.
   739     12  AL-UNDOF            PIC X       VALUE '*'.
   740     12  AL-UNDON            PIC X       VALUE ')'.
   741     12  AL-UNNOF            PIC X       VALUE '&'.
   742     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  19
* EL1284.cbl
   744*                          COPY ELCDATE.
   745******************************************************************
   746*                                                                *
   747*                                                                *
   748*                            ELCDATE.                            *
   749*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   750*                            VMOD=2.003
   751*                                                                *
   752*                                                                *
   753*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   754*                 LENGTH = 200                                   *
   755******************************************************************
   756
   757 01  DATE-CONVERSION-DATA.
   758     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   759     12  DC-OPTION-CODE                PIC X.
   760         88  BIN-TO-GREG                VALUE ' '.
   761         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   762         88  EDIT-GREG-TO-BIN           VALUE '2'.
   763         88  YMD-GREG-TO-BIN            VALUE '3'.
   764         88  MDY-GREG-TO-BIN            VALUE '4'.
   765         88  JULIAN-TO-BIN              VALUE '5'.
   766         88  BIN-PLUS-ELAPSED           VALUE '6'.
   767         88  FIND-CENTURY               VALUE '7'.
   768         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   769         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   770         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   771         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   772         88  JULIAN-TO-BIN-3            VALUE 'C'.
   773         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   774         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   775         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   776         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   777         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   778         88  CHECK-LEAP-YEAR            VALUE 'H'.
   779         88  BIN-3-TO-GREG              VALUE 'I'.
   780         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   781         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   782         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   783         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   784         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   785         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   786         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   787         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   788         88  THREE-CHARACTER-BIN
   789                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   790         88  GREGORIAN-TO-BIN
   791                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   792         88  BIN-TO-GREGORIAN
   793                  VALUES ' ' '1' 'I' '8' 'G'.
   794         88  JULIAN-TO-BINARY
   795                  VALUES '5' 'C' 'E' 'F'.
   796     12  DC-ERROR-CODE                 PIC X.
   797         88  NO-CONVERSION-ERROR        VALUE ' '.
   798         88  DATE-CONVERSION-ERROR
   799                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   800         88  DATE-IS-ZERO               VALUE '1'.
   801         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  20
* EL1284.cbl
   802         88  DATE-IS-INVALID            VALUE '3'.
   803         88  DATE1-GREATER-DATE2        VALUE '4'.
   804         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   805         88  DATE-INVALID-OPTION        VALUE '9'.
   806         88  INVALID-CENTURY            VALUE 'A'.
   807         88  ONLY-CENTURY               VALUE 'B'.
   808         88  ONLY-LEAP-YEAR             VALUE 'C'.
   809         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   810     12  DC-END-OF-MONTH               PIC X.
   811         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   812     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   813         88  USE-NORMAL-PROCESS         VALUE ' '.
   814         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   815         88  ADJUST-UP-100-YRS          VALUE '2'.
   816     12  FILLER                        PIC X.
   817     12  DC-CONVERSION-DATES.
   818         16  DC-BIN-DATE-1             PIC XX.
   819         16  DC-BIN-DATE-2             PIC XX.
   820         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   821         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   822                       DC-GREG-DATE-1-EDIT.
   823             20  DC-EDIT1-MONTH        PIC 99.
   824             20  SLASH1-1              PIC X.
   825             20  DC-EDIT1-DAY          PIC 99.
   826             20  SLASH1-2              PIC X.
   827             20  DC-EDIT1-YEAR         PIC 99.
   828         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   829         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   830                     DC-GREG-DATE-2-EDIT.
   831             20  DC-EDIT2-MONTH        PIC 99.
   832             20  SLASH2-1              PIC X.
   833             20  DC-EDIT2-DAY          PIC 99.
   834             20  SLASH2-2              PIC X.
   835             20  DC-EDIT2-YEAR         PIC 99.
   836         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   837         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   838                     DC-GREG-DATE-1-YMD.
   839             20  DC-YMD-YEAR           PIC 99.
   840             20  DC-YMD-MONTH          PIC 99.
   841             20  DC-YMD-DAY            PIC 99.
   842         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   843         16  DC-GREG-DATE-1-MDY-R REDEFINES
   844                      DC-GREG-DATE-1-MDY.
   845             20  DC-MDY-MONTH          PIC 99.
   846             20  DC-MDY-DAY            PIC 99.
   847             20  DC-MDY-YEAR           PIC 99.
   848         16  DC-GREG-DATE-1-ALPHA.
   849             20  DC-ALPHA-MONTH        PIC X(10).
   850             20  DC-ALPHA-DAY          PIC 99.
   851             20  FILLER                PIC XX.
   852             20  DC-ALPHA-CENTURY.
   853                 24 DC-ALPHA-CEN-N     PIC 99.
   854             20  DC-ALPHA-YEAR         PIC 99.
   855         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   856         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   857         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   858         16  DC-JULIAN-DATE            PIC 9(05).
   859         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  21
* EL1284.cbl
   860                                       PIC 9(05).
   861         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   862             20  DC-JULIAN-YEAR        PIC 99.
   863             20  DC-JULIAN-DAYS        PIC 999.
   864         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   865         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   866         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   867     12  DATE-CONVERSION-VARIBLES.
   868         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   869         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   870             20  FILLER                PIC 9(3).
   871             20  HOLD-CEN-1-CCYY.
   872                 24  HOLD-CEN-1-CC     PIC 99.
   873                 24  HOLD-CEN-1-YY     PIC 99.
   874             20  HOLD-CEN-1-MO         PIC 99.
   875             20  HOLD-CEN-1-DA         PIC 99.
   876         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   877             20  HOLD-CEN-1-R-MO       PIC 99.
   878             20  HOLD-CEN-1-R-DA       PIC 99.
   879             20  HOLD-CEN-1-R-CCYY.
   880                 24  HOLD-CEN-1-R-CC   PIC 99.
   881                 24  HOLD-CEN-1-R-YY   PIC 99.
   882             20  FILLER                PIC 9(3).
   883         16  HOLD-CENTURY-1-X.
   884             20  FILLER                PIC X(3)  VALUE SPACES.
   885             20  HOLD-CEN-1-X-CCYY.
   886                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   887                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   888             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   889             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   890         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   891             20  HOLD-CEN-1-R-X-MO     PIC XX.
   892             20  HOLD-CEN-1-R-X-DA     PIC XX.
   893             20  HOLD-CEN-1-R-X-CCYY.
   894                 24  HOLD-CEN-1-R-X-CC PIC XX.
   895                 24  HOLD-CEN-1-R-X-YY PIC XX.
   896             20  FILLER                PIC XXX.
   897         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   898         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   899         16  DC-JULIAN-DATE-1          PIC 9(07).
   900         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   901             20  DC-JULIAN-1-CCYY.
   902                 24  DC-JULIAN-1-CC    PIC 99.
   903                 24  DC-JULIAN-1-YR    PIC 99.
   904             20  DC-JULIAN-DA-1        PIC 999.
   905         16  DC-JULIAN-DATE-2          PIC 9(07).
   906         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   907             20  DC-JULIAN-2-CCYY.
   908                 24  DC-JULIAN-2-CC    PIC 99.
   909                 24  DC-JULIAN-2-YR    PIC 99.
   910             20  DC-JULIAN-DA-2        PIC 999.
   911         16  DC-GREG-DATE-A-EDIT.
   912             20  DC-EDITA-MONTH        PIC 99.
   913             20  SLASHA-1              PIC X VALUE '/'.
   914             20  DC-EDITA-DAY          PIC 99.
   915             20  SLASHA-2              PIC X VALUE '/'.
   916             20  DC-EDITA-CCYY.
   917                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  22
* EL1284.cbl
   918                 24  DC-EDITA-YEAR     PIC 99.
   919         16  DC-GREG-DATE-B-EDIT.
   920             20  DC-EDITB-MONTH        PIC 99.
   921             20  SLASHB-1              PIC X VALUE '/'.
   922             20  DC-EDITB-DAY          PIC 99.
   923             20  SLASHB-2              PIC X VALUE '/'.
   924             20  DC-EDITB-CCYY.
   925                 24  DC-EDITB-CENT     PIC 99.
   926                 24  DC-EDITB-YEAR     PIC 99.
   927         16  DC-GREG-DATE-CYMD         PIC 9(08).
   928         16  DC-GREG-DATE-CYMD-R REDEFINES
   929                              DC-GREG-DATE-CYMD.
   930             20  DC-CYMD-CEN           PIC 99.
   931             20  DC-CYMD-YEAR          PIC 99.
   932             20  DC-CYMD-MONTH         PIC 99.
   933             20  DC-CYMD-DAY           PIC 99.
   934         16  DC-GREG-DATE-MDCY         PIC 9(08).
   935         16  DC-GREG-DATE-MDCY-R REDEFINES
   936                              DC-GREG-DATE-MDCY.
   937             20  DC-MDCY-MONTH         PIC 99.
   938             20  DC-MDCY-DAY           PIC 99.
   939             20  DC-MDCY-CEN           PIC 99.
   940             20  DC-MDCY-YEAR          PIC 99.
   941    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   942        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   943    12  DC-EL310-DATE                  PIC X(21).
   944    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  23
* EL1284.cbl
   946*                          COPY EL1284S.
   947 01  EL1284AI.
   948     05  FILLER            PIC  X(0012).
   949*    -------------------------------
   950     05  DATEL PIC S9(0004) COMP.
   951     05  DATEF PIC  X(0001).
   952     05  FILLER REDEFINES DATEF.
   953         10  DATEA PIC  X(0001).
   954     05  DATEI PIC  X(0008).
   955*    -------------------------------
   956     05  TIMEL PIC S9(0004) COMP.
   957     05  TIMEF PIC  X(0001).
   958     05  FILLER REDEFINES TIMEF.
   959         10  TIMEA PIC  X(0001).
   960     05  TIMEI PIC  X(0005).
   961*    -------------------------------
   962     05  CMPNYIDL PIC S9(0004) COMP.
   963     05  CMPNYIDF PIC  X(0001).
   964     05  FILLER REDEFINES CMPNYIDF.
   965         10  CMPNYIDA PIC  X(0001).
   966     05  CMPNYIDI PIC  X(0003).
   967*    -------------------------------
   968     05  USERIDL PIC S9(0004) COMP.
   969     05  USERIDF PIC  X(0001).
   970     05  FILLER REDEFINES USERIDF.
   971         10  USERIDA PIC  X(0001).
   972     05  USERIDI PIC  X(0004).
   973*    -------------------------------
   974     05  CLAIMNOL PIC S9(0004) COMP.
   975     05  CLAIMNOF PIC  X(0001).
   976     05  FILLER REDEFINES CLAIMNOF.
   977         10  CLAIMNOA PIC  X(0001).
   978     05  CLAIMNOI PIC  X(0007).
   979*    -------------------------------
   980     05  TYPEL PIC S9(0004) COMP.
   981     05  TYPEF PIC  X(0001).
   982     05  FILLER REDEFINES TYPEF.
   983         10  TYPEA PIC  X(0001).
   984     05  TYPEI PIC  X(0006).
   985*    -------------------------------
   986     05  CARRL PIC S9(0004) COMP.
   987     05  CARRF PIC  X(0001).
   988     05  FILLER REDEFINES CARRF.
   989         10  CARRA PIC  X(0001).
   990     05  CARRI PIC  X(0001).
   991*    -------------------------------
   992     05  CERTNOL PIC S9(0004) COMP.
   993     05  CERTNOF PIC  X(0001).
   994     05  FILLER REDEFINES CERTNOF.
   995         10  CERTNOA PIC  X(0001).
   996     05  CERTNOI PIC  X(0011).
   997*    -------------------------------
   998     05  FSTNMEL PIC S9(0004) COMP.
   999     05  FSTNMEF PIC  X(0001).
  1000     05  FILLER REDEFINES FSTNMEF.
  1001         10  FSTNMEA PIC  X(0001).
  1002     05  FSTNMEI PIC  X(0012).
  1003*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  24
* EL1284.cbl
  1004     05  LASTNMEL PIC S9(0004) COMP.
  1005     05  LASTNMEF PIC  X(0001).
  1006     05  FILLER REDEFINES LASTNMEF.
  1007         10  LASTNMEA PIC  X(0001).
  1008     05  LASTNMEI PIC  X(0015).
  1009*    -------------------------------
  1010     05  TOTL PIC S9(0004) COMP.
  1011     05  TOTF PIC  X(0001).
  1012     05  FILLER REDEFINES TOTF.
  1013         10  TOTA PIC  X(0001).
  1014     05  TOTI PIC  X(0003).
  1015*    -------------------------------
  1016     05  LNGHLAPL PIC S9(0004) COMP.
  1017     05  LNGHLAPF PIC  X(0001).
  1018     05  FILLER REDEFINES LNGHLAPF.
  1019         10  LNGHLAPA PIC  X(0001).
  1020     05  LNGHLAPI PIC  X(0001).
  1021*    -------------------------------
  1022     05  REWRITEL PIC S9(0004) COMP.
  1023     05  REWRITEF PIC  X(0001).
  1024     05  FILLER REDEFINES REWRITEF.
  1025         10  REWRITEA PIC  X(0001).
  1026     05  REWRITEI PIC  X(0001).
  1027*    -------------------------------
  1028     05  CHKCOVGL PIC S9(0004) COMP.
  1029     05  CHKCOVGF PIC  X(0001).
  1030     05  FILLER REDEFINES CHKCOVGF.
  1031         10  CHKCOVGA PIC  X(0001).
  1032     05  CHKCOVGI PIC  X(0001).
  1033*    -------------------------------
  1034     05  MRRELDTL PIC S9(0004) COMP.
  1035     05  MRRELDTF PIC  X(0001).
  1036     05  FILLER REDEFINES MRRELDTF.
  1037         10  MRRELDTA PIC  X(0001).
  1038     05  MRRELDTI PIC  X(0008).
  1039*    -------------------------------
  1040     05  LN1L PIC S9(0004) COMP.
  1041     05  LN1F PIC  X(0001).
  1042     05  FILLER REDEFINES LN1F.
  1043         10  LN1A PIC  X(0001).
  1044     05  LN1I PIC  X(0003).
  1045*    -------------------------------
  1046     05  FNLINE1L PIC S9(0004) COMP.
  1047     05  FNLINE1F PIC  X(0001).
  1048     05  FILLER REDEFINES FNLINE1F.
  1049         10  FNLINE1A PIC  X(0001).
  1050     05  FNLINE1I PIC  X(0063).
  1051*    -------------------------------
  1052     05  MTBY1L PIC S9(0004) COMP.
  1053     05  MTBY1F PIC  X(0001).
  1054     05  FILLER REDEFINES MTBY1F.
  1055         10  MTBY1A PIC  X(0001).
  1056     05  MTBY1I PIC  X(0004).
  1057*    -------------------------------
  1058     05  MTDT1L PIC S9(0004) COMP.
  1059     05  MTDT1F PIC  X(0001).
  1060     05  FILLER REDEFINES MTDT1F.
  1061         10  MTDT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  25
* EL1284.cbl
  1062     05  MTDT1I PIC  X(0006).
  1063*    -------------------------------
  1064     05  LN2L PIC S9(0004) COMP.
  1065     05  LN2F PIC  X(0001).
  1066     05  FILLER REDEFINES LN2F.
  1067         10  LN2A PIC  X(0001).
  1068     05  LN2I PIC  X(0003).
  1069*    -------------------------------
  1070     05  FNLINE2L PIC S9(0004) COMP.
  1071     05  FNLINE2F PIC  X(0001).
  1072     05  FILLER REDEFINES FNLINE2F.
  1073         10  FNLINE2A PIC  X(0001).
  1074     05  FNLINE2I PIC  X(0063).
  1075*    -------------------------------
  1076     05  MTBY2L PIC S9(0004) COMP.
  1077     05  MTBY2F PIC  X(0001).
  1078     05  FILLER REDEFINES MTBY2F.
  1079         10  MTBY2A PIC  X(0001).
  1080     05  MTBY2I PIC  X(0004).
  1081*    -------------------------------
  1082     05  MTDT2L PIC S9(0004) COMP.
  1083     05  MTDT2F PIC  X(0001).
  1084     05  FILLER REDEFINES MTDT2F.
  1085         10  MTDT2A PIC  X(0001).
  1086     05  MTDT2I PIC  X(0006).
  1087*    -------------------------------
  1088     05  LN3L PIC S9(0004) COMP.
  1089     05  LN3F PIC  X(0001).
  1090     05  FILLER REDEFINES LN3F.
  1091         10  LN3A PIC  X(0001).
  1092     05  LN3I PIC  X(0003).
  1093*    -------------------------------
  1094     05  FNLINE3L PIC S9(0004) COMP.
  1095     05  FNLINE3F PIC  X(0001).
  1096     05  FILLER REDEFINES FNLINE3F.
  1097         10  FNLINE3A PIC  X(0001).
  1098     05  FNLINE3I PIC  X(0063).
  1099*    -------------------------------
  1100     05  MTBY3L PIC S9(0004) COMP.
  1101     05  MTBY3F PIC  X(0001).
  1102     05  FILLER REDEFINES MTBY3F.
  1103         10  MTBY3A PIC  X(0001).
  1104     05  MTBY3I PIC  X(0004).
  1105*    -------------------------------
  1106     05  MTDT3L PIC S9(0004) COMP.
  1107     05  MTDT3F PIC  X(0001).
  1108     05  FILLER REDEFINES MTDT3F.
  1109         10  MTDT3A PIC  X(0001).
  1110     05  MTDT3I PIC  X(0006).
  1111*    -------------------------------
  1112     05  LN4L PIC S9(0004) COMP.
  1113     05  LN4F PIC  X(0001).
  1114     05  FILLER REDEFINES LN4F.
  1115         10  LN4A PIC  X(0001).
  1116     05  LN4I PIC  X(0003).
  1117*    -------------------------------
  1118     05  FNLINE4L PIC S9(0004) COMP.
  1119     05  FNLINE4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  26
* EL1284.cbl
  1120     05  FILLER REDEFINES FNLINE4F.
  1121         10  FNLINE4A PIC  X(0001).
  1122     05  FNLINE4I PIC  X(0063).
  1123*    -------------------------------
  1124     05  MTBY4L PIC S9(0004) COMP.
  1125     05  MTBY4F PIC  X(0001).
  1126     05  FILLER REDEFINES MTBY4F.
  1127         10  MTBY4A PIC  X(0001).
  1128     05  MTBY4I PIC  X(0004).
  1129*    -------------------------------
  1130     05  MTDT4L PIC S9(0004) COMP.
  1131     05  MTDT4F PIC  X(0001).
  1132     05  FILLER REDEFINES MTDT4F.
  1133         10  MTDT4A PIC  X(0001).
  1134     05  MTDT4I PIC  X(0006).
  1135*    -------------------------------
  1136     05  LN5L PIC S9(0004) COMP.
  1137     05  LN5F PIC  X(0001).
  1138     05  FILLER REDEFINES LN5F.
  1139         10  LN5A PIC  X(0001).
  1140     05  LN5I PIC  X(0003).
  1141*    -------------------------------
  1142     05  FNLINE5L PIC S9(0004) COMP.
  1143     05  FNLINE5F PIC  X(0001).
  1144     05  FILLER REDEFINES FNLINE5F.
  1145         10  FNLINE5A PIC  X(0001).
  1146     05  FNLINE5I PIC  X(0063).
  1147*    -------------------------------
  1148     05  MTBY5L PIC S9(0004) COMP.
  1149     05  MTBY5F PIC  X(0001).
  1150     05  FILLER REDEFINES MTBY5F.
  1151         10  MTBY5A PIC  X(0001).
  1152     05  MTBY5I PIC  X(0004).
  1153*    -------------------------------
  1154     05  MTDT5L PIC S9(0004) COMP.
  1155     05  MTDT5F PIC  X(0001).
  1156     05  FILLER REDEFINES MTDT5F.
  1157         10  MTDT5A PIC  X(0001).
  1158     05  MTDT5I PIC  X(0006).
  1159*    -------------------------------
  1160     05  LN6L PIC S9(0004) COMP.
  1161     05  LN6F PIC  X(0001).
  1162     05  FILLER REDEFINES LN6F.
  1163         10  LN6A PIC  X(0001).
  1164     05  LN6I PIC  X(0003).
  1165*    -------------------------------
  1166     05  FNLINE6L PIC S9(0004) COMP.
  1167     05  FNLINE6F PIC  X(0001).
  1168     05  FILLER REDEFINES FNLINE6F.
  1169         10  FNLINE6A PIC  X(0001).
  1170     05  FNLINE6I PIC  X(0063).
  1171*    -------------------------------
  1172     05  MTBY6L PIC S9(0004) COMP.
  1173     05  MTBY6F PIC  X(0001).
  1174     05  FILLER REDEFINES MTBY6F.
  1175         10  MTBY6A PIC  X(0001).
  1176     05  MTBY6I PIC  X(0004).
  1177*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  27
* EL1284.cbl
  1178     05  MTDT6L PIC S9(0004) COMP.
  1179     05  MTDT6F PIC  X(0001).
  1180     05  FILLER REDEFINES MTDT6F.
  1181         10  MTDT6A PIC  X(0001).
  1182     05  MTDT6I PIC  X(0006).
  1183*    -------------------------------
  1184     05  LN7L PIC S9(0004) COMP.
  1185     05  LN7F PIC  X(0001).
  1186     05  FILLER REDEFINES LN7F.
  1187         10  LN7A PIC  X(0001).
  1188     05  LN7I PIC  X(0003).
  1189*    -------------------------------
  1190     05  FNLINE7L PIC S9(0004) COMP.
  1191     05  FNLINE7F PIC  X(0001).
  1192     05  FILLER REDEFINES FNLINE7F.
  1193         10  FNLINE7A PIC  X(0001).
  1194     05  FNLINE7I PIC  X(0063).
  1195*    -------------------------------
  1196     05  MTBY7L PIC S9(0004) COMP.
  1197     05  MTBY7F PIC  X(0001).
  1198     05  FILLER REDEFINES MTBY7F.
  1199         10  MTBY7A PIC  X(0001).
  1200     05  MTBY7I PIC  X(0004).
  1201*    -------------------------------
  1202     05  MTDT7L PIC S9(0004) COMP.
  1203     05  MTDT7F PIC  X(0001).
  1204     05  FILLER REDEFINES MTDT7F.
  1205         10  MTDT7A PIC  X(0001).
  1206     05  MTDT7I PIC  X(0006).
  1207*    -------------------------------
  1208     05  LN8L PIC S9(0004) COMP.
  1209     05  LN8F PIC  X(0001).
  1210     05  FILLER REDEFINES LN8F.
  1211         10  LN8A PIC  X(0001).
  1212     05  LN8I PIC  X(0003).
  1213*    -------------------------------
  1214     05  FNLINE8L PIC S9(0004) COMP.
  1215     05  FNLINE8F PIC  X(0001).
  1216     05  FILLER REDEFINES FNLINE8F.
  1217         10  FNLINE8A PIC  X(0001).
  1218     05  FNLINE8I PIC  X(0063).
  1219*    -------------------------------
  1220     05  MTBY8L PIC S9(0004) COMP.
  1221     05  MTBY8F PIC  X(0001).
  1222     05  FILLER REDEFINES MTBY8F.
  1223         10  MTBY8A PIC  X(0001).
  1224     05  MTBY8I PIC  X(0004).
  1225*    -------------------------------
  1226     05  MTDT8L PIC S9(0004) COMP.
  1227     05  MTDT8F PIC  X(0001).
  1228     05  FILLER REDEFINES MTDT8F.
  1229         10  MTDT8A PIC  X(0001).
  1230     05  MTDT8I PIC  X(0006).
  1231*    -------------------------------
  1232     05  LN9L PIC S9(0004) COMP.
  1233     05  LN9F PIC  X(0001).
  1234     05  FILLER REDEFINES LN9F.
  1235         10  LN9A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  28
* EL1284.cbl
  1236     05  LN9I PIC  X(0003).
  1237*    -------------------------------
  1238     05  FNLINE9L PIC S9(0004) COMP.
  1239     05  FNLINE9F PIC  X(0001).
  1240     05  FILLER REDEFINES FNLINE9F.
  1241         10  FNLINE9A PIC  X(0001).
  1242     05  FNLINE9I PIC  X(0063).
  1243*    -------------------------------
  1244     05  MTBY9L PIC S9(0004) COMP.
  1245     05  MTBY9F PIC  X(0001).
  1246     05  FILLER REDEFINES MTBY9F.
  1247         10  MTBY9A PIC  X(0001).
  1248     05  MTBY9I PIC  X(0004).
  1249*    -------------------------------
  1250     05  MTDT9L PIC S9(0004) COMP.
  1251     05  MTDT9F PIC  X(0001).
  1252     05  FILLER REDEFINES MTDT9F.
  1253         10  MTDT9A PIC  X(0001).
  1254     05  MTDT9I PIC  X(0006).
  1255*    -------------------------------
  1256     05  LN10L PIC S9(0004) COMP.
  1257     05  LN10F PIC  X(0001).
  1258     05  FILLER REDEFINES LN10F.
  1259         10  LN10A PIC  X(0001).
  1260     05  LN10I PIC  X(0003).
  1261*    -------------------------------
  1262     05  FNLIN10L PIC S9(0004) COMP.
  1263     05  FNLIN10F PIC  X(0001).
  1264     05  FILLER REDEFINES FNLIN10F.
  1265         10  FNLIN10A PIC  X(0001).
  1266     05  FNLIN10I PIC  X(0063).
  1267*    -------------------------------
  1268     05  MTBY10L PIC S9(0004) COMP.
  1269     05  MTBY10F PIC  X(0001).
  1270     05  FILLER REDEFINES MTBY10F.
  1271         10  MTBY10A PIC  X(0001).
  1272     05  MTBY10I PIC  X(0004).
  1273*    -------------------------------
  1274     05  MTDT10L PIC S9(0004) COMP.
  1275     05  MTDT10F PIC  X(0001).
  1276     05  FILLER REDEFINES MTDT10F.
  1277         10  MTDT10A PIC  X(0001).
  1278     05  MTDT10I PIC  X(0006).
  1279*    -------------------------------
  1280     05  ERRMSGBL PIC S9(0004) COMP.
  1281     05  ERRMSGBF PIC  X(0001).
  1282     05  FILLER REDEFINES ERRMSGBF.
  1283         10  ERRMSGBA PIC  X(0001).
  1284     05  ERRMSGBI PIC  X(0072).
  1285*    -------------------------------
  1286     05  FUNCTL PIC S9(0004) COMP.
  1287     05  FUNCTF PIC  X(0001).
  1288     05  FILLER REDEFINES FUNCTF.
  1289         10  FUNCTA PIC  X(0001).
  1290     05  FUNCTI PIC  X(0001).
  1291*    -------------------------------
  1292     05  LINE1L PIC S9(0004) COMP.
  1293     05  LINE1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  29
* EL1284.cbl
  1294     05  FILLER REDEFINES LINE1F.
  1295         10  LINE1A PIC  X(0001).
  1296     05  LINE1I PIC  999.
  1297*    -------------------------------
  1298     05  LINE2L PIC S9(0004) COMP.
  1299     05  LINE2F PIC  X(0001).
  1300     05  FILLER REDEFINES LINE2F.
  1301         10  LINE2A PIC  X(0001).
  1302     05  LINE2I PIC  999.
  1303*    -------------------------------
  1304     05  PFENTERL PIC S9(0004) COMP.
  1305     05  PFENTERF PIC  X(0001).
  1306     05  FILLER REDEFINES PFENTERF.
  1307         10  PFENTERA PIC  X(0001).
  1308     05  PFENTERI PIC  99.
  1309*    -------------------------------
  1310     05  PF6NOTEL PIC S9(0004) COMP.
  1311     05  PF6NOTEF PIC  X(0001).
  1312     05  FILLER REDEFINES PF6NOTEF.
  1313         10  PF6NOTEA PIC  X(0001).
  1314     05  PF6NOTEI PIC  X(0017).
  1315 01  EL1284AO REDEFINES EL1284AI.
  1316     05  FILLER            PIC  X(0012).
  1317*    -------------------------------
  1318     05  FILLER            PIC  X(0003).
  1319     05  DATEO PIC  X(0008).
  1320*    -------------------------------
  1321     05  FILLER            PIC  X(0003).
  1322     05  TIMEO PIC  99.99.
  1323*    -------------------------------
  1324     05  FILLER            PIC  X(0003).
  1325     05  CMPNYIDO PIC  X(0003).
  1326*    -------------------------------
  1327     05  FILLER            PIC  X(0003).
  1328     05  USERIDO PIC  X(0004).
  1329*    -------------------------------
  1330     05  FILLER            PIC  X(0003).
  1331     05  CLAIMNOO PIC  X(0007).
  1332*    -------------------------------
  1333     05  FILLER            PIC  X(0003).
  1334     05  TYPEO PIC  X(0006).
  1335*    -------------------------------
  1336     05  FILLER            PIC  X(0003).
  1337     05  CARRO PIC  X(0001).
  1338*    -------------------------------
  1339     05  FILLER            PIC  X(0003).
  1340     05  CERTNOO PIC  X(0011).
  1341*    -------------------------------
  1342     05  FILLER            PIC  X(0003).
  1343     05  FSTNMEO PIC  X(0012).
  1344*    -------------------------------
  1345     05  FILLER            PIC  X(0003).
  1346     05  LASTNMEO PIC  X(0015).
  1347*    -------------------------------
  1348     05  FILLER            PIC  X(0003).
  1349     05  TOTO PIC  ZZ9.
  1350*    -------------------------------
  1351     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  30
* EL1284.cbl
  1352     05  LNGHLAPO PIC  X(0001).
  1353*    -------------------------------
  1354     05  FILLER            PIC  X(0003).
  1355     05  REWRITEO PIC  X(0001).
  1356*    -------------------------------
  1357     05  FILLER            PIC  X(0003).
  1358     05  CHKCOVGO PIC  X(0001).
  1359*    -------------------------------
  1360     05  FILLER            PIC  X(0003).
  1361     05  MRRELDTO PIC  X(0008).
  1362*    -------------------------------
  1363     05  FILLER            PIC  X(0003).
  1364     05  LN1O PIC  ZZ9.
  1365*    -------------------------------
  1366     05  FILLER            PIC  X(0003).
  1367     05  FNLINE1O PIC  X(0063).
  1368*    -------------------------------
  1369     05  FILLER            PIC  X(0003).
  1370     05  MTBY1O PIC  X(0004).
  1371*    -------------------------------
  1372     05  FILLER            PIC  X(0003).
  1373     05  MTDT1O PIC  X(0006).
  1374*    -------------------------------
  1375     05  FILLER            PIC  X(0003).
  1376     05  LN2O PIC  ZZ9.
  1377*    -------------------------------
  1378     05  FILLER            PIC  X(0003).
  1379     05  FNLINE2O PIC  X(0063).
  1380*    -------------------------------
  1381     05  FILLER            PIC  X(0003).
  1382     05  MTBY2O PIC  X(0004).
  1383*    -------------------------------
  1384     05  FILLER            PIC  X(0003).
  1385     05  MTDT2O PIC  X(0006).
  1386*    -------------------------------
  1387     05  FILLER            PIC  X(0003).
  1388     05  LN3O PIC  ZZ9.
  1389*    -------------------------------
  1390     05  FILLER            PIC  X(0003).
  1391     05  FNLINE3O PIC  X(0063).
  1392*    -------------------------------
  1393     05  FILLER            PIC  X(0003).
  1394     05  MTBY3O PIC  X(0004).
  1395*    -------------------------------
  1396     05  FILLER            PIC  X(0003).
  1397     05  MTDT3O PIC  X(0006).
  1398*    -------------------------------
  1399     05  FILLER            PIC  X(0003).
  1400     05  LN4O PIC  ZZ9.
  1401*    -------------------------------
  1402     05  FILLER            PIC  X(0003).
  1403     05  FNLINE4O PIC  X(0063).
  1404*    -------------------------------
  1405     05  FILLER            PIC  X(0003).
  1406     05  MTBY4O PIC  X(0004).
  1407*    -------------------------------
  1408     05  FILLER            PIC  X(0003).
  1409     05  MTDT4O PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  31
* EL1284.cbl
  1410*    -------------------------------
  1411     05  FILLER            PIC  X(0003).
  1412     05  LN5O PIC  ZZ9.
  1413*    -------------------------------
  1414     05  FILLER            PIC  X(0003).
  1415     05  FNLINE5O PIC  X(0063).
  1416*    -------------------------------
  1417     05  FILLER            PIC  X(0003).
  1418     05  MTBY5O PIC  X(0004).
  1419*    -------------------------------
  1420     05  FILLER            PIC  X(0003).
  1421     05  MTDT5O PIC  X(0006).
  1422*    -------------------------------
  1423     05  FILLER            PIC  X(0003).
  1424     05  LN6O PIC  ZZ9.
  1425*    -------------------------------
  1426     05  FILLER            PIC  X(0003).
  1427     05  FNLINE6O PIC  X(0063).
  1428*    -------------------------------
  1429     05  FILLER            PIC  X(0003).
  1430     05  MTBY6O PIC  X(0004).
  1431*    -------------------------------
  1432     05  FILLER            PIC  X(0003).
  1433     05  MTDT6O PIC  X(0006).
  1434*    -------------------------------
  1435     05  FILLER            PIC  X(0003).
  1436     05  LN7O PIC  ZZ9.
  1437*    -------------------------------
  1438     05  FILLER            PIC  X(0003).
  1439     05  FNLINE7O PIC  X(0063).
  1440*    -------------------------------
  1441     05  FILLER            PIC  X(0003).
  1442     05  MTBY7O PIC  X(0004).
  1443*    -------------------------------
  1444     05  FILLER            PIC  X(0003).
  1445     05  MTDT7O PIC  X(0006).
  1446*    -------------------------------
  1447     05  FILLER            PIC  X(0003).
  1448     05  LN8O PIC  ZZ9.
  1449*    -------------------------------
  1450     05  FILLER            PIC  X(0003).
  1451     05  FNLINE8O PIC  X(0063).
  1452*    -------------------------------
  1453     05  FILLER            PIC  X(0003).
  1454     05  MTBY8O PIC  X(0004).
  1455*    -------------------------------
  1456     05  FILLER            PIC  X(0003).
  1457     05  MTDT8O PIC  X(0006).
  1458*    -------------------------------
  1459     05  FILLER            PIC  X(0003).
  1460     05  LN9O PIC  ZZ9.
  1461*    -------------------------------
  1462     05  FILLER            PIC  X(0003).
  1463     05  FNLINE9O PIC  X(0063).
  1464*    -------------------------------
  1465     05  FILLER            PIC  X(0003).
  1466     05  MTBY9O PIC  X(0004).
  1467*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  32
* EL1284.cbl
  1468     05  FILLER            PIC  X(0003).
  1469     05  MTDT9O PIC  X(0006).
  1470*    -------------------------------
  1471     05  FILLER            PIC  X(0003).
  1472     05  LN10O PIC  ZZ9.
  1473*    -------------------------------
  1474     05  FILLER            PIC  X(0003).
  1475     05  FNLIN10O PIC  X(0063).
  1476*    -------------------------------
  1477     05  FILLER            PIC  X(0003).
  1478     05  MTBY10O PIC  X(0004).
  1479*    -------------------------------
  1480     05  FILLER            PIC  X(0003).
  1481     05  MTDT10O PIC  X(0006).
  1482*    -------------------------------
  1483     05  FILLER            PIC  X(0003).
  1484     05  ERRMSGBO PIC  X(0072).
  1485*    -------------------------------
  1486     05  FILLER            PIC  X(0003).
  1487     05  FUNCTO PIC  X(0001).
  1488*    -------------------------------
  1489     05  FILLER            PIC  X(0003).
  1490     05  LINE1O PIC  X(0003).
  1491*    -------------------------------
  1492     05  FILLER            PIC  X(0003).
  1493     05  LINE2O PIC  X(0003).
  1494*    -------------------------------
  1495     05  FILLER            PIC  X(0003).
  1496     05  PFENTERO PIC  X(0002).
  1497*    -------------------------------
  1498     05  FILLER            PIC  X(0003).
  1499     05  PF6NOTEO PIC  X(0017).
  1500*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  33
* EL1284.cbl
  1502*01  EL1284R REDEFINES EL1284AI.
  1503 66 GROUP2  RENAMES LN1L THRU MTDT10I.
  1504 01  EL1284R.
  1505*    12  FILLER                  PIC X(202).
  1506     12  SC-ALL-LINES.
  1507      14 SC-LINES OCCURS 10 TIMES INDEXED BY SC-INDX.
  1508         16  SC-LINL             PIC S9(4)   COMP.
  1509         16  SC-LINA             PIC X.
  1510         16  SC-LIN              PIC ZZ9.
  1511         16  SC-TEXTL            PIC S9(4)   COMP.
  1512         16  SC-TEXTA            PIC X.
  1513         16  SC-TEXT             PIC X(63).
  1514         16  SC-MTBYL            PIC S9(4)   COMP.
  1515         16  SC-MTBYA            PIC X.
  1516         16  SC-MTBY             PIC X(4).
  1517         16  SC-MTDTL            PIC S9(4)   COMP.
  1518         16  SC-MTDTA            PIC X.
  1519         16  SC-MTDT             PIC X(6).
  1520*    12  FILLER                  PIC X(116).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  34
* EL1284.cbl
  1522 01  RECORD-TABLE                PIC X(21900) VALUE SPACES.
  1523 01  REC-TABLE  REDEFINES RECORD-TABLE.
  1524     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX PIC X(3650).
  1525 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  1526     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  1527         16  REC-TEXT                    PIC X(63).
  1528         16  REC-LAST-MAINT-BY           PIC XXXX.
  1529         16  REC-LAST-MAINT-DT           PIC XX.
  1530         16  REC-LAST-MAINT-HHMMSS       PIC S9(7) COMP-3.
  1531
  1532 01  TS-WORK-AREA                        PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  35
* EL1284.cbl
  1534*        COPY ELCMSTR.
  1535******************************************************************
  1536*                                                                *
  1537*                            ELCMSTR.                            *
  1538*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1539*                            VMOD=2.012                          *
  1540*                                                                *
  1541*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1542*                                                                *
  1543*   FILE TYPE = VSAM,KSDS                                        *
  1544*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1545*                                                                *
  1546*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1547*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1548*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1549*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1550*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1551*                                                 RKP=75,LEN=21  *
  1552*                                                                *
  1553*   **** NOTE ****                                               *
  1554*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1555*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1556*                                                                *
  1557*   LOG = YES                                                    *
  1558*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1559******************************************************************
  1560*                   C H A N G E   L O G
  1561*
  1562* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1563*-----------------------------------------------------------------
  1564*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1565* EFFECTIVE    NUMBER
  1566*-----------------------------------------------------------------
  1567* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1568* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1569* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1570* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1571* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1572* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  1573* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  1574******************************************************************
  1575 01  CLAIM-MASTER.
  1576     12  CL-RECORD-ID                PIC XX.
  1577         88  VALID-CL-ID         VALUE 'CL'.
  1578
  1579     12  CL-CONTROL-PRIMARY.
  1580         16  CL-COMPANY-CD           PIC X.
  1581         16  CL-CARRIER              PIC X.
  1582         16  CL-CLAIM-NO             PIC X(7).
  1583         16  CL-CERT-NO.
  1584             20  CL-CERT-PRIME       PIC X(10).
  1585             20  CL-CERT-SFX         PIC X.
  1586
  1587     12  CL-CONTROL-BY-NAME.
  1588         16  CL-COMPANY-CD-A1        PIC X.
  1589         16  CL-INSURED-LAST-NAME    PIC X(15).
  1590         16  CL-INSURED-NAME.
  1591             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  36
* EL1284.cbl
  1592             20  CL-INSURED-MID-INIT PIC X.
  1593
  1594     12  CL-CONTROL-BY-SSN.
  1595         16  CL-COMPANY-CD-A2        PIC X.
  1596         16  CL-SOC-SEC-NO.
  1597             20  CL-SSN-STATE        PIC XX.
  1598             20  CL-SSN-ACCOUNT      PIC X(6).
  1599             20  CL-SSN-LN3          PIC X(3).
  1600
  1601     12  CL-CONTROL-BY-CERT-NO.
  1602         16  CL-COMPANY-CD-A4        PIC X.
  1603         16  CL-CERT-NO-A4.
  1604             20  CL-CERT-A4-PRIME    PIC X(10).
  1605             20  CL-CERT-A4-SFX      PIC X.
  1606
  1607     12  CL-CONTROL-BY-CCN.
  1608         16  CL-COMPANY-CD-A5        PIC X.
  1609         16  CL-CCN-A5.
  1610             20  CL-CCN.
  1611                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1612                 24  CL-CCN-PRIME-A5 PIC X(12).
  1613             20  CL-CCN-FILLER-A5    PIC X(4).
  1614
  1615     12  CL-INSURED-PROFILE-DATA.
  1616         16  CL-INSURED-BIRTH-DT     PIC XX.
  1617         16  CL-INSURED-SEX-CD       PIC X.
  1618             88  INSURED-IS-MALE        VALUE 'M'.
  1619             88  INSURED-IS-FEMALE      VALUE 'F'.
  1620             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1621         16  CL-INSURED-OCC-CD       PIC X(6).
  1622         16  FILLER                  PIC X(5).
  1623
  1624     12  CL-PROCESSING-INFO.
  1625         16  CL-PROCESSOR-ID         PIC X(4).
  1626         16  CL-CLAIM-STATUS         PIC X.
  1627             88  CLAIM-IS-OPEN          VALUE 'O'.
  1628             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1629         16  CL-CLAIM-TYPE           PIC X.
  1630*            88  AH-CLAIM               VALUE 'A'.
  1631*            88  LIFE-CLAIM             VALUE 'L'.
  1632*            88  PROPERTY-CLAIM         VALUE 'P'.
  1633*            88  IUI-CLAIM              VALUE 'I'.
  1634*            88  GAP-CLAIM              VALUE 'G'.
  1635*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  1636*            88  OTHER-CLAIM            VALUE 'O'.
  1637         16  CL-CLAIM-PREM-TYPE      PIC X.
  1638             88  SINGLE-PREMIUM         VALUE '1'.
  1639             88  O-B-COVERAGE           VALUE '2'.
  1640             88  OPEN-END-COVERAGE      VALUE '3'.
  1641         16  CL-INCURRED-DT          PIC XX.
  1642         16  CL-REPORTED-DT          PIC XX.
  1643         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1644         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1645         16  CL-LAST-PMT-DT          PIC XX.
  1646         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1647         16  CL-PAID-THRU-DT         PIC XX.
  1648         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1649         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  37
* EL1284.cbl
  1650         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1651         16  CL-PMT-CALC-METHOD      PIC X.
  1652             88  CL-360-DAY-YR          VALUE '1'.
  1653             88  CL-365-DAY-YR          VALUE '2'.
  1654             88  CL-FULL-MONTHS         VALUE '3'.
  1655         16  CL-CAUSE-CD             PIC X(6).
  1656
  1657         16  CL-PRIME-CERT-NO.
  1658             20  CL-PRIME-CERT-PRIME PIC X(10).
  1659             20  CL-PRIME-CERT-SFX   PIC X.
  1660
  1661         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1662             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1663             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1664
  1665         16  CL-MICROFILM-NO         PIC X(10).
  1666         16  FILLER REDEFINES CL-MICROFILM-NO.
  1667             20  CL-BENEFIT-PERIOD   PIC 99.
  1668             20  FILLER              PIC X(8).
  1669         16  CL-PROG-FORM-TYPE       PIC X.
  1670         16  CL-LAST-ADD-ON-DT       PIC XX.
  1671
  1672         16  CL-LAST-REOPEN-DT       PIC XX.
  1673         16  CL-LAST-CLOSE-DT        PIC XX.
  1674         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1675             88  FINAL-PAID             VALUE '1'.
  1676             88  CLAIM-DENIED           VALUE '2'.
  1677             88  AUTO-CLOSE             VALUE '3'.
  1678             88  MANUAL-CLOSE           VALUE '4'.
  1679             88  BENEFITS-CHANGED       VALUE 'C'.
  1680             88  SETUP-ERRORS           VALUE 'E'.
  1681         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1682         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1683         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1684             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1685         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1686         16  FILLER                  PIC X.
  1687
  1688     12  CL-CERTIFICATE-DATA.
  1689         16  CL-CERT-ORIGIN          PIC X.
  1690             88  CERT-WAS-ONLINE        VALUE '1'.
  1691             88  CERT-WAS-CREATED       VALUE '2'.
  1692             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1693         16  CL-CERT-KEY-DATA.
  1694             20  CL-CERT-CARRIER     PIC X.
  1695             20  CL-CERT-GROUPING    PIC X(6).
  1696             20  CL-CERT-STATE       PIC XX.
  1697             20  CL-CERT-ACCOUNT.
  1698                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1699                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1700             20  CL-CERT-EFF-DT      PIC XX.
  1701
  1702     12  CL-STATUS-CONTROLS.
  1703         16  CL-PRIORITY-CD          PIC X.
  1704             88  CONFIDENTIAL-DATA      VALUE '8'.
  1705             88  HIGHEST-PRIORITY       VALUE '9'.
  1706         16  CL-SUPV-ATTN-CD         PIC X.
  1707             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  38
* EL1284.cbl
  1708             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1709         16  CL-PURGED-DT            PIC XX.
  1710         16  CL-RESTORED-DT          PIC XX.
  1711         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1712         16  CL-NEXT-RESEND-DT       PIC XX.
  1713         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1714         16  CL-CRITICAL-PERIOD      PIC 99.
  1715*        16  FILLER                  PIC XX.
  1716         16  CL-LAST-MAINT-DT        PIC XX.
  1717         16  CL-LAST-MAINT-USER      PIC X(4).
  1718         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  1719         16  CL-LAST-MAINT-TYPE      PIC X.
  1720             88  CLAIM-SET-UP           VALUE ' '.
  1721             88  PAYMENT-MADE           VALUE '1'.
  1722             88  LETTER-SENT            VALUE '2'.
  1723             88  MASTER-WAS-ALTERED     VALUE '3'.
  1724             88  MASTER-WAS-RESTORED    VALUE '4'.
  1725             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1726             88  FILE-CONVERTED         VALUE '6'.
  1727             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1728             88  ERROR-CORRECTION       VALUE 'E'.
  1729         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1730         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1731         16  CL-BENEFICIARY          PIC X(10).
  1732         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1733         16  CL-DENIAL-TYPE          PIC X.
  1734             88  CL-TYPE-DENIAL          VALUE '1'.
  1735             88  CL-TYPE-RESCISSION      VALUE '2'.
  1736             88  CL-TYPE-REFORMATION     VALUE '3'.
  1737             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1738             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1739         16  CL-NO-OF-EXTENSIONS     PIC 99.
  1740         16  filler                  pic x(3).
  1741*        16  CL-CRIT-PER-RECURRENT   PIC X.
  1742*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  1743*        16  CL-RTW-DT               PIC XX.
  1744
  1745     12  CL-TRAILER-CONTROLS.
  1746         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1747             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1748             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1749             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1750         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1751         16  FILLER                  PIC XX.
  1752         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1753         16  CL-ADDRESS-TRAILER-CNT.
  1754             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1755                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1756             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1757                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1758             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1759                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1760             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1761                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1762             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1763                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1764             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1765                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  39
* EL1284.cbl
  1766             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1767                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1768
  1769     12  CL-CV-REFERENCE-NO.
  1770         16  CL-CV-REFNO-PRIME       PIC X(18).
  1771         16  CL-CV-REFNO-SFX         PIC XX.
  1772
  1773     12  CL-FILE-LOCATION            PIC X(4).
  1774
  1775     12  CL-PROCESS-ERRORS.
  1776         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1777             88  NO-FATAL-ERRORS        VALUE ZERO.
  1778         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1779             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1780
  1781     12  CL-PRODUCT-CD               PIC X.
  1782
  1783     12  CL-CURRENT-KEY-DATA.
  1784         16  CL-CURRENT-CARRIER      PIC X.
  1785         16  CL-CURRENT-GROUPING     PIC X(6).
  1786         16  CL-CURRENT-STATE        PIC XX.
  1787         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1788
  1789     12  CL-ASSOCIATES               PIC X.
  1790         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1791         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1792         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1793         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1794
  1795     12  CL-ACTIVITY-CODE            PIC 99.
  1796     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1797     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1798
  1799     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1800     12  CL-LAG-REPORT-CODE          PIC 9.
  1801     12  CL-LOAN-TYPE                PIC XX.
  1802     12  CL-LEGAL-STATE              PIC XX.
  1803
  1804     12  CL-YESNOSW                  PIC X.
  1805     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  1806         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  1807         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  1808         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  1809     12  cl-insured-type             pic x.
  1810         88  cl-claim-on-primary         value 'P'.
  1811         88  cl-claim-on-co-borrower     value 'C'.
  1812     12  cl-benefit-expiration-dt    PIC XX.
  1813****************************************************************
  1814*
  1815* Copyright (c) 2007-2013 Dell Inc.
  1816* All rights reserved.
  1817*
  1818****************************************************************
  1819 01  DFHEIV.
  1820   02  DFHEIV0               PIC X(35).
  1821   02  DFHEIV1               PIC X(08).
  1822   02  DFHEIV2               PIC X(08).
  1823   02  DFHEIV3               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  40
* EL1284.cbl
  1824   02  DFHEIV4               PIC X(06).
  1825   02  DFHEIV5               PIC X(04).
  1826   02  DFHEIV6               PIC X(04).
  1827   02  DFHEIV7               PIC X(02).
  1828   02  DFHEIV8               PIC X(02).
  1829   02  DFHEIV9               PIC X(01).
  1830   02  DFHEIV10              PIC S9(7) COMP-3.
  1831   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1832   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1833   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1834   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1835   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1836   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1837   02  DFHEIV17              PIC X(04).
  1838   02  DFHEIV18              PIC X(04).
  1839   02  DFHEIV19              PIC X(04).
  1840   02  DFHEIV20              USAGE IS POINTER.
  1841   02  DFHEIV21              USAGE IS POINTER.
  1842   02  DFHEIV22              USAGE IS POINTER.
  1843   02  DFHEIV23              USAGE IS POINTER.
  1844   02  DFHEIV24              USAGE IS POINTER.
  1845   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1846   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1847   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1848   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1849   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1850   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1851   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1852   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1853   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1854   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1855   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1856   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1857   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1858   02  FILLER                PIC X(02).
  1859   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1860   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1861   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1862   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1863   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1864   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1865   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1866 LINKAGE  SECTION.
  1867*****************************************************************
  1868*                                                               *
  1869* Copyright (c) 2007-2013 Dell Inc.                             *
  1870* All rights reserved.                                          *
  1871*                                                               *
  1872*****************************************************************
  1873 01  dfheiblk.
  1874     02  eibtime          pic s9(7) comp-3.
  1875     02  eibdate          pic s9(7) comp-3.
  1876     02  eibtrnid         pic x(4).
  1877     02  eibtaskn         pic s9(7) comp-3.
  1878     02  eibtrmid         pic x(4).
  1879     02  dfheigdi         pic s9(4) comp.
  1880     02  eibcposn         pic s9(4) comp.
  1881     02  eibcalen         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  41
* EL1284.cbl
  1882     02  eibaid           pic x(1).
  1883     02  eibfiller1       pic x(1).
  1884     02  eibfn            pic x(2).
  1885     02  eibfiller2       pic x(2).
  1886     02  eibrcode         pic x(6).
  1887     02  eibfiller3       pic x(2).
  1888     02  eibds            pic x(8).
  1889     02  eibreqid         pic x(8).
  1890     02  eibrsrce         pic x(8).
  1891     02  eibsync          pic x(1).
  1892     02  eibfree          pic x(1).
  1893     02  eibrecv          pic x(1).
  1894     02  eibsend          pic x(1).
  1895     02  eibatt           pic x(1).
  1896     02  eibeoc           pic x(1).
  1897     02  eibfmh           pic x(1).
  1898     02  eibcompl         pic x(1).
  1899     02  eibsig           pic x(1).
  1900     02  eibconf          pic x(1).
  1901     02  eiberr           pic x(1).
  1902     02  eibrldbk         pic x(1).
  1903     02  eiberrcd         pic x(4).
  1904     02  eibsynrb         pic x(1).
  1905     02  eibnodat         pic x(1).
  1906     02  eibfiller5       pic x(2).
  1907     02  eibresp          pic s9(8) comp.
  1908     02  eibresp2         pic s9(8) comp.
  1909     02  dfheigdj         pic s9(4) comp.
  1910     02  dfheigdk         pic s9(4) comp.
  1911 01  DFHCOMMAREA                 PIC X(1500).
  1912
  1913*        COPY ELCMEMO.
  1914******************************************************************
  1915*                                                                *
  1916*                                                                *
  1917*                           ELCMEMO.                             *
  1918*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE           *
  1919*                                                                *
  1920*                                                                *
  1921*   FILE DESCRIPTION = CLAIM MEMO NOTES                          *
  1922*                                                                *
  1923*   FILE TYPE = VSAM,KSDS                                        *
  1924*   RECORD SIZE = 132    RECFORM = FIXED                         *
  1925*                                                                *
  1926*   BASE CLUSTER NAME = ELMEMO             RKP=2,LEN=23          *
  1927*       ALTERNATE INDEX = NONE                                   *
  1928*                                                                *
  1929*   LOG = YES                                                    *
  1930*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1931******************************************************************
  1932 01  CLAIM-MEMO-FILE.
  1933     12  MM-RECORD-ID                  PIC  XX.
  1934         88  VALID-MM-ID                    VALUE 'MM'.
  1935     12  MM-CONTROL-PRIMARY.
  1936       16  MM-COMPANY-CD               PIC  X.
  1937       16  MM-RECORD-TYPE              PIC  X.
  1938           88  MM-HDR-REC                   VALUE '1'.
  1939           88  MM-DETAIL-REC                VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  42
* EL1284.cbl
  1940       16  MM-CARRIER                  PIC  X.
  1941       16  MM-CLAIM-NO                 PIC  X(7).
  1942       16  MM-CERT-NO.
  1943           20  MM-CERT-PRIME           PIC  X(10).
  1944           20  MM-CERT-SFX             PIC  X.
  1945       16  MM-PAYMENT-SEQ-NO           PIC  S9(4)  COMP.
  1946
  1947   12  MM-CLAIM-MEMO                   PIC  X(63).
  1948   12  MM-HEADER-INFO REDEFINES MM-CLAIM-MEMO.
  1949       16  MM-LONG-HEALTH-APP          PIC  X(01).
  1950       16  MM-REWRITE-IND              PIC  X(01).
  1951       16  MM-CHECKED-OTHER-COVG       PIC  X(01).
  1952       16  MM-MR-RELEASED-FROM-DATE    PIC  X(02).
  1953   12  FILLER                          PIC  X(34).
  1954
  1955   12  MM-LAST-MAINT-DT                PIC  XX.
  1956   12  MM-LAST-MAINT-BY                PIC  X(4).
  1957   12  MM-LAST-MAINT-HHMMSS            PIC  S9(6) COMP-3.
  1958
  1959*        COPY ELCCERT.
  1960******************************************************************
  1961*                                                                *
  1962*                            ELCCERT.                            *
  1963*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1964*                            VMOD=2.013                          *
  1965*                                                                *
  1966*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1967*                                                                *
  1968*   FILE TYPE = VSAM,KSDS                                        *
  1969*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1970*                                                                *
  1971*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1972*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1973*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1974*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1975*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1976*                                                                *
  1977*   LOG = YES                                                    *
  1978*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1979******************************************************************
  1980*                   C H A N G E   L O G
  1981*
  1982* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1983*-----------------------------------------------------------------
  1984*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1985* EFFECTIVE    NUMBER
  1986*-----------------------------------------------------------------
  1987* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1988* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1989* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1990* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1991* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1992* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1993* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1994* 032612  CR2011110200001  PEMA  AHL CHANGES
  1995* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1996* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1997* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  43
* EL1284.cbl
  1998******************************************************************
  1999
  2000 01  CERTIFICATE-MASTER.
  2001     12  CM-RECORD-ID                      PIC XX.
  2002         88  VALID-CM-ID                      VALUE 'CM'.
  2003
  2004     12  CM-CONTROL-PRIMARY.
  2005         16  CM-COMPANY-CD                 PIC X.
  2006         16  CM-CARRIER                    PIC X.
  2007         16  CM-GROUPING.
  2008             20  CM-GROUPING-PREFIX        PIC X(3).
  2009             20  CM-GROUPING-PRIME         PIC X(3).
  2010         16  CM-STATE                      PIC XX.
  2011         16  CM-ACCOUNT.
  2012             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2013             20  CM-ACCOUNT-PRIME          PIC X(6).
  2014         16  CM-CERT-EFF-DT                PIC XX.
  2015         16  CM-CERT-NO.
  2016             20  CM-CERT-PRIME             PIC X(10).
  2017             20  CM-CERT-SFX               PIC X.
  2018
  2019     12  CM-CONTROL-BY-NAME.
  2020         16  CM-COMPANY-CD-A1              PIC X.
  2021         16  CM-INSURED-LAST-NAME          PIC X(15).
  2022         16  CM-INSURED-INITIALS.
  2023             20  CM-INSURED-INITIAL1       PIC X.
  2024             20  CM-INSURED-INITIAL2       PIC X.
  2025
  2026     12  CM-CONTROL-BY-SSN.
  2027         16  CM-COMPANY-CD-A2              PIC X.
  2028         16  CM-SOC-SEC-NO.
  2029             20  CM-SSN-STATE              PIC XX.
  2030             20  CM-SSN-ACCOUNT            PIC X(6).
  2031             20  CM-SSN-LN3.
  2032                 25  CM-INSURED-INITIALS-A2.
  2033                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2034                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2035                 25 CM-PART-LAST-NAME-A2         PIC X.
  2036
  2037     12  CM-CONTROL-BY-CERT-NO.
  2038         16  CM-COMPANY-CD-A4              PIC X.
  2039         16  CM-CERT-NO-A4                 PIC X(11).
  2040
  2041     12  CM-CONTROL-BY-MEMB.
  2042         16  CM-COMPANY-CD-A5              PIC X.
  2043         16  CM-MEMBER-NO.
  2044             20  CM-MEMB-STATE             PIC XX.
  2045             20  CM-MEMB-ACCOUNT           PIC X(6).
  2046             20  CM-MEMB-LN4.
  2047                 25  CM-INSURED-INITIALS-A5.
  2048                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2049                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2050                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2051
  2052     12  CM-INSURED-PROFILE-DATA.
  2053         16  CM-INSURED-FIRST-NAME.
  2054             20  CM-INSURED-1ST-INIT       PIC X.
  2055             20  FILLER                    PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  44
* EL1284.cbl
  2056         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2057         16  CM-INSURED-SEX                PIC X.
  2058             88  CM-SEX-MALE                  VALUE 'M'.
  2059             88  CM-SEX-FEMAL                 VALUE 'F'.
  2060         16  CM-INSURED-JOINT-AGE          PIC 99.
  2061         16  CM-JOINT-INSURED-NAME.
  2062             20  CM-JT-LAST-NAME           PIC X(15).
  2063             20  CM-JT-FIRST-NAME.
  2064                 24  CM-JT-1ST-INIT        PIC X.
  2065                 24  FILLER                PIC X(9).
  2066             20  CM-JT-INITIAL             PIC X.
  2067
  2068     12  CM-LIFE-DATA.
  2069         16  CM-LF-BENEFIT-CD              PIC XX.
  2070         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2071         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2072         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2073         16  CM-LF-DEV-CODE                PIC XXX.
  2074         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2075         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2076         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2077         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2078         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2079         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2080         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2081         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2082         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2083         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2084         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2085         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2086         16  cm-temp-epiq                  pic xx.
  2087             88  EPIQ-CLASS                  value 'EQ'.
  2088*        16  FILLER                        PIC XX.
  2089
  2090     12  CM-AH-DATA.
  2091         16  CM-AH-BENEFIT-CD              PIC XX.
  2092         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2093         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2094         16  CM-AH-DEV-CODE                PIC XXX.
  2095         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2096         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2097         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2098         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2099         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2100         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2101         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2102         16  CM-AH-PAID-THRU-DT            PIC XX.
  2103             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2104         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2105         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2106         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2107         16  FILLER                        PIC X.
  2108
  2109     12  CM-LOAN-INFORMATION.
  2110         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2111         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2112                                           PIC S9(5)V99  COMP-3.
  2113         16  CM-BILLED                     PIC S9(7)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  45
* EL1284.cbl
  2114         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2115         16  CM-PAY-FREQUENCY              PIC S99.
  2116         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2117         16  CM-RATE-CLASS                 PIC XX.
  2118         16  CM-BENEFICIARY                PIC X(25).
  2119         16  CM-POLICY-FORM-NO             PIC X(12).
  2120         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2121         16  CM-LAST-ADD-ON-DT             PIC XX.
  2122         16  CM-DEDUCTIBLE-AMOUNTS.
  2123             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2124             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2125         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2126             20  CM-RESIDENT-STATE         PIC XX.
  2127             20  CM-RATE-CODE              PIC X(4).
  2128             20  FILLER                    PIC XX.
  2129         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2130             20  CM-LOAN-OFFICER           PIC X(5).
  2131             20  FILLER                    PIC XXX.
  2132         16  CM-CSR-CODE                   PIC XXX.
  2133         16  CM-UNDERWRITING-CODE          PIC X.
  2134             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2135         16  CM-POST-CARD-IND              PIC X.
  2136         16  CM-REF-INTERFACE-SW           PIC X.
  2137         16  CM-PREMIUM-TYPE               PIC X.
  2138             88  CM-SING-PRM                  VALUE '1'.
  2139             88  CM-O-B-COVERAGE              VALUE '2'.
  2140             88  CM-OPEN-END                  VALUE '3'.
  2141         16  CM-IND-GRP-TYPE               PIC X.
  2142             88  CM-INDIVIDUAL                VALUE 'I'.
  2143             88  CM-GROUP                     VALUE 'G'.
  2144         16  CM-SKIP-CODE                  PIC X.
  2145             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2146             88  SKIP-JULY                    VALUE '1'.
  2147             88  SKIP-AUGUST                  VALUE '2'.
  2148             88  SKIP-SEPTEMBER               VALUE '3'.
  2149             88  SKIP-JULY-AUG                VALUE '4'.
  2150             88  SKIP-AUG-SEPT                VALUE '5'.
  2151             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2152             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2153             88  SKIP-JUNE                    VALUE '8'.
  2154             88  SKIP-JUNE-JULY               VALUE '9'.
  2155             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2156             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2157         16  CM-PAYMENT-MODE               PIC X.
  2158             88  PAY-MONTHLY                  VALUE SPACE.
  2159             88  PAY-WEEKLY                   VALUE '1'.
  2160             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2161             88  PAY-BI-WEEKLY                VALUE '3'.
  2162             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2163         16  CM-LOAN-NUMBER                PIC X(8).
  2164         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2165         16  CM-OLD-LOF                    PIC XXX.
  2166*        16  CM-LOAN-OFFICER               PIC XXX.
  2167         16  CM-REIN-TABLE                 PIC XXX.
  2168         16  CM-SPECIAL-REIN-CODE          PIC X.
  2169         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2170         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2171         16  CM-LOAN-1ST-PMT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  46
* EL1284.cbl
  2172
  2173     12  CM-STATUS-DATA.
  2174         16  CM-ENTRY-STATUS               PIC X.
  2175         16  CM-ENTRY-DT                   PIC XX.
  2176
  2177         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2178         16  CM-LF-CANCEL-DT               PIC XX.
  2179         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2180
  2181         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2182         16  CM-LF-DEATH-DT                PIC XX.
  2183         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2184
  2185         16  CM-LF-CURRENT-STATUS          PIC X.
  2186             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2187                                                'M' '4' '5' '9'.
  2188             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2189             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2190             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2191             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2192             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2193             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2194             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2195             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2196             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2197             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2198             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2199             88  CM-LF-DECLINED               VALUE 'D'.
  2200             88  CM-LF-VOIDED                 VALUE 'V'.
  2201
  2202         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2203         16  CM-AH-CANCEL-DT               PIC XX.
  2204         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2205
  2206         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2207         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2208         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2209
  2210         16  CM-AH-CURRENT-STATUS          PIC X.
  2211             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2212                                                'M' '4' '5' '9'.
  2213             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2214             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2215             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2216             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2217             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2218             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2219             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2220             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2221             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2222             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2223             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2224             88  CM-AH-DECLINED               VALUE 'D'.
  2225             88  CM-AH-VOIDED                 VALUE 'V'.
  2226
  2227         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2228             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2229             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  47
* EL1284.cbl
  2230             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2231         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2232
  2233         16  CM-ENTRY-BATCH                PIC X(6).
  2234         16  CM-LF-EXIT-BATCH              PIC X(6).
  2235         16  CM-AH-EXIT-BATCH              PIC X(6).
  2236         16  CM-LAST-MONTH-END             PIC XX.
  2237
  2238     12  CM-NOTE-SW                        PIC X.
  2239         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2240         88  CERT-NOTES-PRESENT               VALUE '1'.
  2241         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2242         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2243         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2244         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2245         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2246         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2247     12  CM-COMP-EXCP-SW                   PIC X.
  2248         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2249         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2250     12  CM-INSURED-ADDRESS-SW             PIC X.
  2251         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2252         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2253
  2254*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2255     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2256     12  FILLER                            PIC X.
  2257
  2258*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2259     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2260     12  FILLER                            PIC X.
  2261*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2262     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2263
  2264     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2265         88  CERT-ADDED-BATCH                 VALUE ' '.
  2266         88  CERT-ADDED-ONLINE                VALUE '1'.
  2267         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2268         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2269         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2270     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2271         88  CERT-AS-LOADED                   VALUE ' '.
  2272         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2273         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2274         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2275         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2276         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2277         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2278         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2279
  2280     12  CM-ACCOUNT-COMM-PCTS.
  2281         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2282         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2283
  2284     12  CM-USER-FIELD                     PIC X.
  2285     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2286     12  CM-CLP-STATE                      PIC XX.
  2287     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  48
* EL1284.cbl
  2288     12  CM-USER-RESERVED                  PIC XXX.
  2289     12  FILLER REDEFINES CM-USER-RESERVED.
  2290         16  CM-AH-CLASS-CD                PIC XX.
  2291         16  F                             PIC X.
  2292******************************************************************
  2293 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MEMO-FILE
  2294                          CERTIFICATE-MASTER.
  2295 0000-DFHEXIT SECTION.
  2296     MOVE '9#                    $   ' TO DFHEIV0.
  2297     MOVE 'EL1284' TO DFHEIV1.
  2298     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2299
  2300     MOVE EIBTRMID               TO QID-TERM.
  2301     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2302     MOVE '5'                    TO DC-OPTION-CODE.
  2303     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2304     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  2305     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  2306
  2307     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK
  2308     IF EIBCALEN = ZEROS
  2309         GO TO 8800-UNAUTHORIZED-ACCESS
  2310     END-IF.
  2311
  2312*    IF PI-CALLING-PROGRAM NOT = THIS-PGM AND PGM-EL1276
  2313*        PERFORM 4900-SET-NOTES-FLAG THRU 4900-EXIT
  2314*        IF CLAIM-SESSION
  2315*            SET PI-CLAIM-NOTE TO TRUE
  2316*        ELSE
  2317*            SET PI-CERT-NOTE TO TRUE
  2318*        END-IF
  2319*    END-IF.
  2320
  2321*    IF PI-CALLING-PROGRAM = PGM-EL1276
  2322*        MOVE THIS-PGM           TO PI-CALLING-PROGRAM
  2323*        MOVE 'N'                TO PI-PF5-PRESSED
  2324*        MOVE 'N'                TO PI-PF6-PRESSED
  2325*    END-IF.
  2326
  2327     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2328        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2329           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2330           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2331           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2332           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2333           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2334           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2335           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2336           MOVE THIS-PGM TO PI-CALLING-PROGRAM
  2337        ELSE
  2338           MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  2339           MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  2340           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  2341           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  2342           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  2343           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  2344           MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  2345           MOVE SPACES               TO PI-SAVED-PROGRAM-6
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  49
* EL1284.cbl
  2346        END-IF
  2347     END-IF.
  2348
  2349 1000-START.
  2350     MOVE 'N' TO WS-CURSOR-SET
  2351
  2352     MOVE LOW-VALUES TO EL1284AI
  2353                        EL1284R
  2354     MOVE SPACES                 TO  ELMEMO-KEY
  2355                                     ELCERT-KEY.
  2356
  2357     MOVE PI-COMPANY-CD          TO  ELMEMO-COMPANY-CD
  2358                                     ELCERT-COMPANY-CD.
  2359     MOVE PI-CARRIER             TO  ELMEMO-CARRIER
  2360                                     ELCERT-CARRIER.
  2361     MOVE PI-CLAIM-NO            TO  ELMEMO-CLAIM-NO
  2362     MOVE PI-CERT-PRIME          TO  ELMEMO-CERT-PRIME
  2363                                     ELCERT-CERT-PRIME.
  2364     MOVE PI-CERT-SFX            TO  ELMEMO-CERT-SFX
  2365                                     ELCERT-CERT-SFX.
  2366     MOVE ZEROS                  TO  ELMEMO-RECORD-TYPE
  2367     MOVE ZEROS                  TO  ELMEMO-SEQ.
  2368     MOVE ELMEMO-PARTIAL-KEY     TO  SV-PRIOR-KEY.
  2369
  2370     IF EIBTRNID NOT = TRANS-ID
  2371        INITIALIZE PI-EL1284-AREA
  2372        MOVE '0'                 TO  PI-UPDATE-SW
  2373        IF PI-PROCESSOR-ID NOT = 'LGXX'
  2374
  2375* EXEC CICS READQ TS
  2376*                    QUEUE (PI-SECURITY-TEMP-STORE-ID)
  2377*                    INTO (SECURITY-CONTROL)
  2378*                    LENGTH (SC-COMM-LENGTH)
  2379*                    ITEM  (SC-ITEM)
  2380*           END-EXEC
  2381*    MOVE '*$II   L              ''   #00002370' TO DFHEIV0
  2382     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  2383     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2384     MOVE X'2020233030303032333730' TO DFHEIV0(25:11)
  2385     CALL 'kxdfhei1' USING DFHEIV0,
  2386           PI-SECURITY-TEMP-STORE-ID,
  2387           SECURITY-CONTROL,
  2388           SC-COMM-LENGTH,
  2389           SC-ITEM,
  2390           DFHEIV99,
  2391           DFHEIV99
  2392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2393          MOVE SC-CREDIT-DISPLAY (32) TO PI-DISPLAY-CAP
  2394          MOVE SC-CREDIT-UPDATE (32)  TO PI-MODIFY-CAP
  2395        END-IF
  2396     END-IF.
  2397
  2398     IF NOT DISPLAY-CAP
  2399         MOVE 'READ'             TO  SM-READ
  2400         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2401         MOVE ER-0070            TO  EMI-ERROR
  2402         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2403         GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  50
* EL1284.cbl
  2404     END-IF.
  2405
  2406
  2407* EXEC CICS HANDLE AID
  2408*         CLEAR(9400-CLEAR)
  2409*    END-EXEC.
  2410*    MOVE '"&=                  V! " #00002389' TO DFHEIV0
  2411     MOVE X'22263D202020202020202020' TO DFHEIV0(1:12)
  2412     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  2413     MOVE X'2220233030303032333839' TO DFHEIV0(25:11)
  2414     CALL 'kxdfhei1' USING DFHEIV0
  2415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2416
  2417
  2418
  2419* EXEC CICS HANDLE CONDITION
  2420*         ERROR(9990-ABEND)
  2421*         PGMIDERR(9600-PGMID-ERROR)
  2422*    END-EXEC.
  2423*    MOVE '"$.L                  ! # #00002393' TO DFHEIV0
  2424     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  2425     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2426     MOVE X'2320233030303032333933' TO DFHEIV0(25:11)
  2427     CALL 'kxdfhei1' USING DFHEIV0
  2428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2429
  2430
  2431     IF EIBTRNID NOT = TRANS-ID
  2432         GO TO 7000-BUILD-TABLE
  2433     END-IF.
  2434
  2435     IF PI-CHANGE-IN-NOTE-TYPE
  2436         GO TO 7000-BUILD-TABLE
  2437     END-IF.
  2438
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  51
* EL1284.cbl
  2440 2000-RECEIVE.
  2441     IF EIBAID = DFHPA1 OR
  2442        EIBAID = DFHPA2 OR
  2443        EIBAID = DFHPA3
  2444           MOVE ER-0008 TO EMI-ERROR
  2445           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2446           GO TO 8200-SEND-DATAONLY
  2447     END-IF.
  2448
  2449
  2450* EXEC CICS RECEIVE
  2451*         MAP(MAP-NAME)
  2452*         MAPSET(MAPSET-NAME)
  2453*         INTO(EL1284AI)
  2454*    END-EXEC.
  2455     MOVE LENGTH OF
  2456      EL1284AI
  2457       TO DFHEIV11
  2458*    MOVE '8"T I  L              ''   #00002416' TO DFHEIV0
  2459     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2460     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2461     MOVE X'2020233030303032343136' TO DFHEIV0(25:11)
  2462     CALL 'kxdfhei1' USING DFHEIV0,
  2463           MAP-NAME,
  2464           EL1284AI,
  2465           DFHEIV11,
  2466           MAPSET-NAME,
  2467           DFHEIV99,
  2468           DFHEIV99
  2469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2470
  2471     MOVE GROUP2 TO EL1284R.
  2472
  2473     IF PFENTERL = ZEROS
  2474        GO TO 2001-CHECK-PFKEYS
  2475     END-IF.
  2476
  2477     IF EIBAID NOT = DFHENTER
  2478        MOVE ER-0004             TO EMI-ERROR
  2479        GO TO 2002-INPUT-ERROR
  2480     END-IF.
  2481
  2482     IF PFENTERI NUMERIC AND
  2483        (PFENTERI > 00 AND  < 25)
  2484        MOVE PF-VALUES (PFENTERI) TO EIBAID
  2485     ELSE
  2486        MOVE ER-0029 TO EMI-ERROR
  2487        GO TO 2002-INPUT-ERROR
  2488     END-IF.
  2489
  2490 2001-CHECK-PFKEYS.
  2491     IF EIBAID = DFHPF23
  2492        GO TO 9000-RETURN-CICS
  2493     END-IF.
  2494
  2495     IF EIBAID = DFHPF24
  2496        GO TO 9200-RETURN-MAIN-MENU
  2497     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  52
* EL1284.cbl
  2498
  2499     IF EIBAID = DFHPF12
  2500        GO TO 9500-PF12
  2501     END-IF.
  2502
  2503     IF FUNCTL NOT = ZEROS AND EIBAID NOT = DFHENTER
  2504        IF FUNCTI = 'A' OR = SPACES
  2505           NEXT SENTENCE
  2506        ELSE
  2507           MOVE ER-0050          TO EMI-ERROR
  2508           MOVE -1 TO FUNCTL
  2509           MOVE AL-UABON TO FUNCTA PFENTERA
  2510           GO TO 2002-INPUT-ERROR
  2511        END-IF
  2512     END-IF.
  2513
  2514     IF EIBAID = DFHPF1
  2515        MOVE NUM-LINES-PER-SCREEN TO ROLL-COUNTER
  2516        GO TO 7400-PAGE-ROUTINE
  2517     END-IF.
  2518
  2519     IF EIBAID = DFHPF2
  2520        SUBTRACT NUM-LINES-PER-SCREEN FROM ROLL-COUNTER
  2521        GO TO 7400-PAGE-ROUTINE
  2522     END-IF.
  2523
  2524     IF EIBAID = DFHPF3
  2525        MOVE 5                   TO ROLL-COUNTER
  2526        GO TO 7400-PAGE-ROUTINE
  2527     END-IF.
  2528
  2529     IF EIBAID = DFHPF4
  2530        MOVE -5                  TO ROLL-COUNTER
  2531        GO TO 7400-PAGE-ROUTINE
  2532     END-IF.
  2533
  2534     IF EIBAID = DFHENTER
  2535        GO TO 2003-EDIT-DATA
  2536     END-IF.
  2537
  2538     MOVE ER-0029                TO EMI-ERROR.
  2539
  2540 2002-INPUT-ERROR.
  2541     MOVE -1                     TO PFENTERL
  2542     MOVE AL-UNBON               TO PFENTERA
  2543     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2544     GO TO 8200-SEND-DATAONLY.
  2545
  2546 2003-EDIT-DATA.
  2547
  2548     IF FUNCTI = 'L'
  2549         NEXT SENTENCE
  2550     ELSE
  2551         IF NOT MODIFY-CAP
  2552             MOVE 'UPDATE'       TO  SM-READ
  2553             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2554             MOVE ER-0070        TO  EMI-ERROR
  2555             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  53
* EL1284.cbl
  2556             GO TO 8100-SEND-INITIAL-MAP
  2557         END-IF
  2558     END-IF.
  2559     IF FUNCTI NOT = 'Q'
  2560        PERFORM 2010-EDIT-CHECK
  2561     END-IF.
  2562
  2563     IF FUNCTL = ZEROS OR FUNCTI = SPACES
  2564        GO TO 4000-CHANGE-ROUTINE
  2565     END-IF.
  2566
  2567     IF (FUNCTI = 'S' OR = 'D' OR = 'Q' OR
  2568                = 'I' OR = 'A' OR = 'L')
  2569         NEXT SENTENCE
  2570     ELSE
  2571         MOVE ER-0023            TO EMI-ERROR
  2572         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2573         MOVE AL-UABON           TO FUNCTA
  2574         MOVE -1                 TO FUNCTL
  2575         GO TO 8200-SEND-DATAONLY
  2576     END-IF.
  2577
  2578     IF FUNCTI = 'D'  OR = 'I' OR = 'L'
  2579        PERFORM 2500-LINE-CHECK THRU 2599-EXIT
  2580     ELSE
  2581        IF LINE1L NOT = ZEROS OR
  2582           LINE2L NOT = ZEROS
  2583           MOVE ER-0030          TO EMI-ERROR
  2584           MOVE -1               TO LINE1L
  2585           MOVE AL-UNBON         TO LINE1A LINE2A
  2586           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2587           GO TO 8200-SEND-DATAONLY
  2588        END-IF
  2589     END-IF.
  2590
  2591     IF FUNCTI = 'A'
  2592        GO TO 5000-ADD-NEW-LINES
  2593     END-IF.
  2594     IF FUNCTI = 'Q'
  2595        GO TO 9410-RETURN
  2596     END-IF.
  2597     IF FUNCTI = 'S'
  2598        GO TO 4500-SAVE-DATA
  2599     END-IF.
  2600     IF PI-TOTAL-LINES = 0
  2601        MOVE ER-0048             TO EMI-ERROR
  2602        MOVE -1                  TO FUNCTL
  2603        MOVE AL-UNBON            TO FUNCTA
  2604        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2605        GO TO 8200-SEND-DATAONLY
  2606     END-IF.
  2607     IF FUNCTI = 'L'
  2608        GO TO 5500-LOOKUP
  2609     END-IF.
  2610     IF FUNCTI = 'D'
  2611        GO TO 3000-DELETE-LINES
  2612     END-IF.
  2613
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  54
* EL1284.cbl
  2614     GO TO 3500-INSERT-LINES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  55
* EL1284.cbl
  2616 2010-EDIT-CHECK.
  2617*
  2618     IF LNGHLAPL > 0
  2619        MOVE LNGHLAPI TO  PI-LONG-HLTH-APP
  2620        MOVE '1'      TO PI-UPDATE-SW
  2621     ELSE
  2622        IF LNGHLAPA = WS-ERASE-EOF
  2623           MOVE SPACES TO PI-LONG-HLTH-APP
  2624           MOVE '1'    TO PI-UPDATE-SW
  2625        END-IF
  2626        MOVE PI-LONG-HLTH-APP TO LNGHLAPI
  2627     END-IF.
  2628*
  2629     IF LNGHLAPI > SPACE
  2630        IF LNGHLAPI = 'N' OR 'Y'
  2631           CONTINUE
  2632        ELSE
  2633           MOVE -1                     TO LNGHLAPL
  2634           MOVE AL-UABON               TO LNGHLAPA
  2635           MOVE ER-0046                TO EMI-ERROR
  2636           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2637           GO TO 8200-SEND-DATAONLY
  2638        END-IF
  2639     END-IF.
  2640*
  2641     IF REWRITEL > 0
  2642        MOVE REWRITEI TO PI-REWRITE
  2643        MOVE '1'      TO PI-UPDATE-SW
  2644     ELSE
  2645        IF REWRITEA = WS-ERASE-EOF
  2646           MOVE SPACES TO PI-REWRITE
  2647           MOVE '1'    TO PI-UPDATE-SW
  2648        END-IF
  2649        MOVE PI-REWRITE TO REWRITEI
  2650     END-IF
  2651*
  2652     IF REWRITEI > SPACE
  2653        IF REWRITEI = 'N' OR 'Y' OR 'D'
  2654           CONTINUE
  2655        ELSE
  2656           MOVE -1                     TO REWRITEL
  2657           MOVE AL-UABON               TO REWRITEA
  2658           MOVE ER-3846                TO EMI-ERROR
  2659           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2660           GO TO 8200-SEND-DATAONLY
  2661        END-IF
  2662     END-IF.
  2663*
  2664     IF CHKCOVGL > 0
  2665        MOVE CHKCOVGI TO PI-CHKCOVG
  2666        MOVE '1'      TO PI-UPDATE-SW
  2667     ELSE
  2668        IF CHKCOVGA = WS-ERASE-EOF
  2669           MOVE SPACES TO PI-CHKCOVG
  2670           MOVE '1'    TO PI-UPDATE-SW
  2671        END-IF
  2672        MOVE PI-CHKCOVG TO CHKCOVGI
  2673     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  56
* EL1284.cbl
  2674*
  2675     IF CHKCOVGI > SPACE
  2676        IF CHKCOVGI = 'N' OR 'Y'
  2677           CONTINUE
  2678        ELSE
  2679           MOVE -1                     TO CHKCOVGL
  2680           MOVE AL-UABON               TO CHKCOVGA
  2681           MOVE ER-0046                TO EMI-ERROR
  2682           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2683           GO TO 8200-SEND-DATAONLY
  2684        END-IF
  2685     END-IF.
  2686*
  2687     IF MRRELDTL > 0
  2688        MOVE MRRELDTI TO PI-MR-RELEASE-DATE
  2689        MOVE '1'      TO PI-UPDATE-SW
  2690     ELSE
  2691        IF MRRELDTA = WS-ERASE-EOF
  2692           MOVE SPACES TO PI-MR-RELEASE-DATE
  2693           MOVE '1'    TO PI-UPDATE-SW
  2694        END-IF
  2695        MOVE PI-MR-RELEASE-DATE TO MRRELDTI
  2696     END-IF.
  2697*
  2698 2500-LINE-CHECK.
  2699     IF LINE1L = ZEROS AND
  2700        LINE2L = ZEROS
  2701        MOVE ER-0069             TO EMI-ERROR
  2702        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2703        MOVE -1                  TO LINE1L
  2704        GO TO 8200-SEND-DATAONLY
  2705     END-IF.
  2706
  2707     IF LINE1L NOT = ZEROS
  2708        IF LINE1I = ZERO AND FUNCTI EQUAL 'L'
  2709            MOVE 1               TO LINE1I
  2710        END-IF
  2711        IF LINE1I = ZERO AND FUNCTI EQUAL 'D'
  2712           MOVE ER-0049          TO EMI-ERROR
  2713           MOVE AL-UNBON         TO LINE1A
  2714           MOVE -1               TO LINE1L
  2715           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2716           GO TO 8200-SEND-DATAONLY
  2717        END-IF
  2718        IF LINE1I NOT NUMERIC OR
  2719           LINE1I > PI-TOTAL-LINES
  2720           MOVE ER-0031          TO EMI-ERROR
  2721           MOVE AL-UNBON         TO LINE1A
  2722           MOVE -1               TO LINE1L
  2723           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2724           GO TO 8200-SEND-DATAONLY
  2725        ELSE
  2726           IF LINE2L = ZEROS
  2727              MOVE 1             TO LINE2I
  2728              IF FUNCTI = 'I'
  2729                  GO TO 2510-MAX-CHECK
  2730              ELSE
  2731                  NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  57
* EL1284.cbl
  2732              END-IF
  2733           ELSE
  2734              IF FUNCTI = 'I'
  2735                 GO TO 2510-MAX-CHECK
  2736              ELSE
  2737                 IF LINE2I NOT NUMERIC
  2738                    MOVE AL-UNBON TO LINE2A
  2739                    MOVE ER-0032  TO EMI-ERROR
  2740                    MOVE -1       TO LINE2L
  2741                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2742                    GO TO 8200-SEND-DATAONLY
  2743                 ELSE
  2744                    NEXT SENTENCE
  2745                 END-IF
  2746              END-IF
  2747           END-IF
  2748        END-IF
  2749     ELSE
  2750        IF LINE2L = ZEROS
  2751           NEXT SENTENCE
  2752        ELSE
  2753           MOVE -1               TO LINE2L
  2754           MOVE ER-0041          TO EMI-ERROR
  2755           MOVE AL-UNBON         TO LINE2A
  2756           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2757           GO TO 8200-SEND-DATAONLY
  2758        END-IF
  2759     END-IF.
  2760     GO TO 2599-EXIT.
  2761 2510-MAX-CHECK.
  2762     IF LINE2I NOT NUMERIC
  2763        MOVE -1                  TO LINE2L
  2764        MOVE ER-0032             TO EMI-ERROR
  2765        MOVE AL-UNBON            TO LINE2A
  2766        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2767        GO TO 8200-SEND-DATAONLY
  2768     ELSE
  2769        COMPUTE ROLL-COUNTER = LINE2I + PI-TOTAL-LINES
  2770        IF ROLL-COUNTER GREATER THAN MAX-LINES
  2771           MOVE -1               TO LINE2L
  2772           MOVE ER-0044          TO EMI-ERROR
  2773           MOVE AL-UNBON         TO LINE2A
  2774           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2775           GO TO 8200-SEND-DATAONLY
  2776        END-IF
  2777     END-IF.
  2778 2599-EXIT.
  2779      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  58
* EL1284.cbl
  2781 3000-DELETE-LINES.
  2782     IF LINE2L = ZEROS AND LINE2I = 1
  2783        MOVE LINE1I              TO LINE2I
  2784     END-IF.
  2785
  2786     IF LINE2I > PI-TOTAL-LINES OR < LINE1I
  2787        MOVE ER-0049             TO EMI-ERROR
  2788        MOVE AL-UNBON            TO LINE2A
  2789        MOVE -1                  TO LINE2L
  2790        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2791        GO TO 8200-SEND-DATAONLY
  2792     END-IF.
  2793
  2794     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2795     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2796             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2797             SC-INDX > NUM-LINES-PER-SCREEN
  2798     SET TB-INDX TO LINE1I.
  2799
  2800     IF NOT EMI-NO-ERRORS
  2801        GO TO 8200-SEND-DATAONLY
  2802     END-IF.
  2803
  2804     SET TB-INDX TO LINE1I
  2805     COMPUTE ROLL-COUNTER = LINE2I - LINE1I + 1.
  2806
  2807     IF LINE2I NOT = PI-TOTAL-LINES
  2808        SET TB-INDX1 TO LINE2I
  2809        SET TB-INDX1 UP BY 1
  2810        PERFORM 3100-DELETE-TABLE-ENTRIES
  2811                UNTIL TB-INDX1 > PI-TOTAL-LINES
  2812     END-IF.
  2813
  2814     PERFORM 3150-BLANK-TABLE-ENTRIES
  2815             ROLL-COUNTER TIMES.
  2816     SUBTRACT ROLL-COUNTER FROM PI-TOTAL-LINES.
  2817
  2818     IF PI-CURRENT-LINE > PI-TOTAL-LINES
  2819        MOVE PI-TOTAL-LINES      TO PI-CURRENT-LINE
  2820        SUBTRACT 1 FROM PI-CURRENT-LINE
  2821     END-IF.
  2822
  2823     SET TB-INDX  TO PI-CURRENT-LINE
  2824     MOVE LOW-VALUES             TO EL1284AI
  2825                                    EL1284R
  2826
  2827     PERFORM 7800-MOVE-SAVE-TO-MAP.
  2828     IF PI-CURRENT-LINE > ZERO
  2829         PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  2830             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2831             SC-INDX > NUM-LINES-PER-SCREEN
  2832         PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT
  2833     END-IF.
  2834
  2835     MOVE '1'                    TO PI-UPDATE-SW.
  2836     IF PI-TOTAL-LINES = ZEROS
  2837        MOVE ZEROS               TO PI-CURRENT-LINE
  2838     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  59
* EL1284.cbl
  2839     MOVE -1 TO FUNCTL
  2840     SET CURSOR-SET TO TRUE
  2841     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  60
* EL1284.cbl
  2843
  2844 3100-DELETE-TABLE-ENTRIES.
  2845     MOVE REC-ENT (TB-INDX1)     TO REC-ENT (TB-INDX)
  2846     SET TB-INDX TB-INDX1 UP BY 1.
  2847
  2848 3150-BLANK-TABLE-ENTRIES.
  2849     MOVE SPACES               TO REC-ENT (TB-INDX).
  2850     MOVE SAVE-BIN-DATE        TO REC-LAST-MAINT-DT (TB-INDX).
  2851     MOVE EIBTIME              TO REC-LAST-MAINT-HHMMSS (TB-INDX).
  2852     MOVE PI-PROCESSOR-ID      TO REC-LAST-MAINT-BY (TB-INDX).
  2853     SET TB-INDX UP BY 1.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  61
* EL1284.cbl
  2855 3500-INSERT-LINES.
  2856
  2857     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2858     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2859             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2860             SC-INDX > NUM-LINES-PER-SCREEN.
  2861
  2862     IF NOT EMI-NO-ERRORS
  2863        GO TO 8200-SEND-DATAONLY
  2864     END-IF.
  2865
  2866     SET TB-INDX TO PI-TOTAL-LINES.
  2867     ADD LINE2I TO PI-TOTAL-LINES.
  2868     SET TB-INDX1 TO PI-TOTAL-LINES.
  2869     PERFORM 3600-INSERT-TABLE-ENTRIES
  2870             UNTIL TB-INDX = LINE1I.
  2871     SET TB-INDX UP BY 1.
  2872
  2873     IF LINE1I EQUAL ZERO
  2874         SET PI-CURRENT-LINE TO 1
  2875     ELSE
  2876         SET PI-CURRENT-LINE TO LINE1I
  2877     END-IF.
  2878
  2879     COMPUTE ROLL-COUNTER = PI-CURRENT-LINE +
  2880                            NUM-LINES-PER-SCREEN.
  2881     IF TB-INDX NOT LESS THAN ROLL-COUNTER OR
  2882                    LESS THAN PI-CURRENT-LINE
  2883        SET SC-INDX TO 1
  2884        SET SC-INDX DOWN BY 1
  2885     ELSE
  2886        SET ROLL-COUNTER TO TB-INDX
  2887        COMPUTE ROLL-COUNTER = ROLL-COUNTER - PI-CURRENT-LINE
  2888                  + 1
  2889        SET SC-INDX TO ROLL-COUNTER
  2890     END-IF.
  2891
  2892     PERFORM 3150-BLANK-TABLE-ENTRIES LINE2I TIMES.
  2893     SET TB-INDX TO PI-CURRENT-LINE.
  2894     MOVE LOW-VALUES             TO EL1284AI
  2895                                    EL1284R
  2896
  2897     IF SC-INDX NOT = ZERO
  2898        MOVE -1 TO SC-TEXTL (SC-INDX)
  2899        SET CURSOR-SET TO TRUE
  2900     END-IF.
  2901
  2902     PERFORM 7800-MOVE-SAVE-TO-MAP.
  2903     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  2904            VARYING SC-INDX FROM 1 BY 1 UNTIL
  2905            SC-INDX > NUM-LINES-PER-SCREEN.
  2906     PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT.
  2907     MOVE '1'                    TO PI-UPDATE-SW.
  2908     MOVE -1 TO FUNCTL
  2909     SET CURSOR-SET TO TRUE
  2910     GO TO 8100-SEND-INITIAL-MAP.
  2911
  2912 3600-INSERT-TABLE-ENTRIES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  62
* EL1284.cbl
  2913     MOVE REC-ENT (TB-INDX)      TO REC-ENT (TB-INDX1).
  2914     SET TB-INDX TB-INDX1 DOWN BY 1.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  63
* EL1284.cbl
  2916
  2917 4000-CHANGE-ROUTINE.
  2918     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2919     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2920             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2921             SC-INDX > NUM-LINES-PER-SCREEN.
  2922
  2923     IF NOT EMI-NO-ERRORS
  2924        GO TO 8200-SEND-DATAONLY
  2925     END-IF.
  2926
  2927     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  2928     MOVE SPACES                 TO ERRMSGBO.
  2929     GO TO 8200-SEND-DATAONLY.
  2930
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  64
* EL1284.cbl
  2932 4500-SAVE-DATA.
  2933     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2934     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2935             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2936             SC-INDX > NUM-LINES-PER-SCREEN.
  2937     IF NOT EMI-NO-ERRORS
  2938        GO TO 8200-SEND-DATAONLY
  2939     END-IF.
  2940
  2941
  2942* EXEC CICS HANDLE CONDITION
  2943*         NOTFND(4610-ENDBR)
  2944*         NOTOPEN(6000-NOT-OPEN)
  2945*         ENDFILE(4610-ENDBR)
  2946*    END-EXEC.
  2947*    MOVE '"$IJ''                 ! $ #00002891' TO DFHEIV0
  2948     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  2949     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2950     MOVE X'2420233030303032383931' TO DFHEIV0(25:11)
  2951     CALL 'kxdfhei1' USING DFHEIV0
  2952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2953
  2954
  2955 4610-LOOP.
  2956
  2957* EXEC CICS READ
  2958*        DATASET (ELMEMO-FILE-ID)
  2959*        RIDFLD  (ELMEMO-KEY)
  2960*        SET     (ADDRESS OF CLAIM-MEMO-FILE)
  2961*        GTEQ
  2962*    END-EXEC.
  2963*    MOVE '&"S        G          (   #00002898' TO DFHEIV0
  2964     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  2965     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2966     MOVE X'2020233030303032383938' TO DFHEIV0(25:11)
  2967     CALL 'kxdfhei1' USING DFHEIV0,
  2968           ELMEMO-FILE-ID,
  2969           DFHEIV20,
  2970           DFHEIV99,
  2971           ELMEMO-KEY,
  2972           DFHEIV99,
  2973           DFHEIV99,
  2974           DFHEIV99
  2975     SET ADDRESS OF CLAIM-MEMO-FILE TO
  2976         DFHEIV20
  2977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2978
  2979
  2980     MOVE MM-CONTROL-PRIMARY     TO ELMEMO-KEY.
  2981
  2982     IF ELMEMO-PARTIAL-KEY NOT = SV-PRIOR-KEY
  2983         MOVE SV-PRIOR-KEY       TO ELMEMO-PARTIAL-KEY
  2984         GO TO 4610-ENDBR
  2985     END-IF.
  2986
  2987
  2988* EXEC CICS DELETE
  2989*        DATASET (ELMEMO-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  65
* EL1284.cbl
  2990*        RIDFLD  (ELMEMO-KEY)
  2991*    END-EXEC.
  2992*    MOVE '&(  R                 &   #00002912' TO DFHEIV0
  2993     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  2994     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2995     MOVE X'2020233030303032393132' TO DFHEIV0(25:11)
  2996     CALL 'kxdfhei1' USING DFHEIV0,
  2997           ELMEMO-FILE-ID,
  2998           ELMEMO-KEY,
  2999           DFHEIV99,
  3000           DFHEIV99,
  3001           DFHEIV99
  3002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3003
  3004
  3005     GO TO 4610-LOOP.
  3006 4610-ENDBR.
  3007
  3008* EXEC CICS GETMAIN
  3009*         LENGTH(ELMEMO-LENGTH)
  3010*         SET(ADDRESS OF CLAIM-MEMO-FILE)
  3011*         INITIMG(GETMAIN-SPACE)
  3012*    END-EXEC.
  3013*    MOVE ',"IL                  $   #00002919' TO DFHEIV0
  3014     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3015     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3016     MOVE X'2020233030303032393139' TO DFHEIV0(25:11)
  3017     CALL 'kxdfhei1' USING DFHEIV0,
  3018           DFHEIV20,
  3019           ELMEMO-LENGTH,
  3020           GETMAIN-SPACE
  3021     SET ADDRESS OF CLAIM-MEMO-FILE TO
  3022         DFHEIV20
  3023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3024
  3025     PERFORM 4650-WRITE-HEADER THRU 4650-EXIT.
  3026
  3027     MOVE 1                      TO  ELMEMO-SEQ.
  3028     MOVE ZERO                   TO  WS-BLANK-LINES.
  3029
  3030     PERFORM 4700-WRITE-FILE THRU 4799-EXIT
  3031             VARYING TB-INDX FROM 1 BY 1 UNTIL
  3032             TB-INDX > PI-TOTAL-LINES.
  3033
  3034     SUBTRACT WS-BLANK-LINES FROM PI-TOTAL-LINES.
  3035
  3036     GO TO 9410-RETURN.
  3037 4650-WRITE-HEADER.
  3038
  3039     MOVE SPACES                 TO  CLAIM-MEMO-FILE.
  3040     MOVE ZERO                   TO  ELMEMO-SEQ.
  3041     MOVE ELMEMO-KEY             TO  MM-CONTROL-PRIMARY.
  3042     MOVE  'MM'                  TO  MM-RECORD-ID.
  3043     MOVE REC-TEXT (TB-INDX)     TO  MM-CLAIM-MEMO
  3044     MOVE LNGHLAPI               TO MM-LONG-HEALTH-APP
  3045     MOVE REWRITEI               TO MM-REWRITE-IND
  3046     MOVE CHKCOVGI               TO MM-CHECKED-OTHER-COVG
  3047     IF MRRELDTI > SPACES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  66
* EL1284.cbl
  3048        MOVE MRRELDTI               TO DEEDIT-DATE-INPUT
  3049
  3050* EXEC CICS BIF DEEDIT
  3051*           FIELD    (DEEDIT-DATE-INPUT)
  3052*           LENGTH   (DATE-LENGTH)
  3053*       END-EXEC
  3054*    MOVE '@"L                   #   #00002948' TO DFHEIV0
  3055     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3056     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3057     MOVE X'2020233030303032393438' TO DFHEIV0(25:11)
  3058     CALL 'kxdfhei1' USING DFHEIV0,
  3059           DEEDIT-DATE-INPUT,
  3060           DATE-LENGTH
  3061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3062        MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  3063        MOVE '4'            TO DC-OPTION-CODE
  3064        PERFORM PERFORM 9700-LINK-DATE-CONVERT
  3065        IF NOT DATE-CONVERSION-ERROR
  3066            MOVE DC-BIN-DATE-1      TO MM-MR-RELEASED-FROM-DATE
  3067*           MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  3068*           MOVE AL-UANON           TO INCA
  3069*           MOVE DC-GREG-DATE-1-EDIT TO INCO
  3070        ELSE
  3071            MOVE -1         TO MRRELDTL
  3072            MOVE ER-0314    TO EMI-ERROR
  3073            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3074            GO TO 8200-SEND-DATAONLY
  3075        END-IF
  3076     END-IF.
  3077*        MOVE AL-UABON   TO INCA
  3078*        MOVE -1         TO INCL
  3079*        MOVE 'X'        TO ERROR-SWITCH.
  3080
  3081* EXEC CICS WRITE
  3082*         DATASET(ELMEMO-FILE-ID)
  3083*         FROM(CLAIM-MEMO-FILE)
  3084*         RIDFLD(ELMEMO-KEY)
  3085*    END-EXEC.
  3086     MOVE LENGTH OF
  3087      CLAIM-MEMO-FILE
  3088       TO DFHEIV11
  3089*    MOVE '&$ L                  ''   #00002970' TO DFHEIV0
  3090     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3091     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3092     MOVE X'2020233030303032393730' TO DFHEIV0(25:11)
  3093     CALL 'kxdfhei1' USING DFHEIV0,
  3094           ELMEMO-FILE-ID,
  3095           CLAIM-MEMO-FILE,
  3096           DFHEIV11,
  3097           ELMEMO-KEY,
  3098           DFHEIV99,
  3099           DFHEIV99
  3100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3101
  3102 4650-EXIT.
  3103      EXIT.
  3104
  3105 4700-WRITE-FILE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  67
* EL1284.cbl
  3106*    IF REC-TEXT (TB-INDX)  EQUAL SPACES
  3107*        ADD +1                  TO  WS-BLANK-LINES
  3108*        GO TO 4799-EXIT
  3109*    END-IF.
  3110
  3111     MOVE SPACES                 TO  CLAIM-MEMO-FILE.
  3112     ADD 1                       TO  ELMEMO-SEQ.
  3113     MOVE ELMEMO-KEY             TO  MM-CONTROL-PRIMARY.
  3114     MOVE  'MM'                  TO  MM-RECORD-ID.
  3115     MOVE REC-TEXT (TB-INDX)     TO  MM-CLAIM-MEMO
  3116     MOVE REC-LAST-MAINT-BY (TB-INDX)
  3117                                 TO  MM-LAST-MAINT-BY
  3118     MOVE REC-LAST-MAINT-HHMMSS (TB-INDX)
  3119                                 TO  MM-LAST-MAINT-HHMMSS.
  3120     MOVE REC-LAST-MAINT-DT (TB-INDX)
  3121                                 TO  MM-LAST-MAINT-DT.
  3122
  3123
  3124* EXEC CICS WRITE
  3125*         DATASET(ELMEMO-FILE-ID)
  3126*         FROM(CLAIM-MEMO-FILE)
  3127*         RIDFLD(ELMEMO-KEY)
  3128*    END-EXEC.
  3129     MOVE LENGTH OF
  3130      CLAIM-MEMO-FILE
  3131       TO DFHEIV11
  3132*    MOVE '&$ L                  ''   #00002996' TO DFHEIV0
  3133     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3134     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3135     MOVE X'2020233030303032393936' TO DFHEIV0(25:11)
  3136     CALL 'kxdfhei1' USING DFHEIV0,
  3137           ELMEMO-FILE-ID,
  3138           CLAIM-MEMO-FILE,
  3139           DFHEIV11,
  3140           ELMEMO-KEY,
  3141           DFHEIV99,
  3142           DFHEIV99
  3143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3144
  3145 4799-EXIT.
  3146      EXIT.
  3147
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  68
* EL1284.cbl
  3149
  3150 4900-SET-NOTES-FLAG.
  3151
  3152
  3153* EXEC CICS HANDLE CONDITION
  3154*        NOTFND   (4900-EXIT)
  3155*    END-EXEC.
  3156*    MOVE '"$I                   ! % #00003008' TO DFHEIV0
  3157     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3158     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3159     MOVE X'2520233030303033303038' TO DFHEIV0(25:11)
  3160     CALL 'kxdfhei1' USING DFHEIV0
  3161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3162
  3163
  3164     MOVE SPACES                 TO  ELCERT-KEY.
  3165     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  3166     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  3167     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  3168     MOVE PI-STATE               TO  ELCERT-STATE.
  3169     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  3170     MOVE PI-CERT-EFF-DT         TO  ELCERT-EFF-DT.
  3171     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  3172     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  3173
  3174
  3175* EXEC CICS READ
  3176*    EQUAL
  3177*    DATASET   (ELCERT-FILE-ID)
  3178*    SET       (ADDRESS OF CERTIFICATE-MASTER)
  3179*    RIDFLD    (ELCERT-KEY)
  3180*    END-EXEC.
  3181*    MOVE '&"S        E          (   #00003022' TO DFHEIV0
  3182     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3183     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3184     MOVE X'2020233030303033303232' TO DFHEIV0(25:11)
  3185     CALL 'kxdfhei1' USING DFHEIV0,
  3186           ELCERT-FILE-ID,
  3187           DFHEIV20,
  3188           DFHEIV99,
  3189           ELCERT-KEY,
  3190           DFHEIV99,
  3191           DFHEIV99,
  3192           DFHEIV99
  3193     SET ADDRESS OF CERTIFICATE-MASTER TO
  3194         DFHEIV20
  3195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3196
  3197
  3198*    MOVE 'N'                    TO PI-BILLING-NOTES-EXIST
  3199*                                   PI-CERT-NOTES-EXIST
  3200*                                   PI-CLAIM-NOTES-EXIST.
  3201*    IF CM-NOTE-SW EQUAL '2' OR '3' OR '6' OR '7'
  3202*         MOVE 'Y'               TO PI-BILLING-NOTES-EXIST
  3203*    END-IF.
  3204*    IF CM-NOTE-SW EQUAL '1' OR '3' OR '5' OR '7'
  3205*         MOVE 'Y'               TO PI-CERT-NOTES-EXIST
  3206*    END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  69
* EL1284.cbl
  3207*    IF CM-NOTE-SW EQUAL '4' OR '5' OR '6' OR '7'
  3208*         MOVE 'Y'               TO PI-CLAIM-NOTES-EXIST
  3209*    END-IF.
  3210
  3211
  3212 4900-EXIT.
  3213      EXIT.
  3214
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  70
* EL1284.cbl
  3216 5000-ADD-NEW-LINES.
  3217     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3218     MOVE 'N'                    TO WS-SCREEN-LINE.
  3219     MOVE 1                      TO WS-SUB.
  3220     MOVE ZERO                   TO WS-SUB1.
  3221     PERFORM VARYING SC-INDX FROM NUM-LINES-PER-SCREEN BY -1
  3222             UNTIL SCREEN-LINE-FOUND OR SC-INDX < 1
  3223         IF SC-TEXT (SC-INDX) >  SPACES
  3224             SET WS-SUB          TO SC-INDX
  3225             MOVE 'Y'            TO WS-SCREEN-LINE
  3226         END-IF
  3227     END-PERFORM.
  3228     IF PI-TOTAL-LINES = 0
  3229         MOVE 1                  TO WS-SUB1
  3230     ELSE
  3231         MOVE 2                  TO WS-SUB1
  3232     END-IF.
  3233     PERFORM VARYING SC-INDX FROM WS-SUB1 BY 1
  3234             UNTIL SC-INDX GREATER THAN WS-SUB
  3235         IF SC-TEXTL (SC-INDX) EQUAL ZEROS
  3236             MOVE 1      TO SC-TEXTL (SC-INDX)
  3237             MOVE SPACES TO SC-TEXT (SC-INDX)
  3238             MOVE LOW-VALUES TO SC-MTBY (SC-INDX)
  3239                                SC-MTDT (SC-INDX)
  3240         END-IF
  3241     END-PERFORM.
  3242     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3243             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3244             SC-INDX > NUM-LINES-PER-SCREEN.
  3245
  3246     IF NOT EMI-NO-ERRORS
  3247        GO TO 8200-SEND-DATAONLY
  3248     END-IF.
  3249
  3250     MOVE PI-TOTAL-LINES         TO  PI-CURRENT-LINE.
  3251     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3252     MOVE LOW-VALUES             TO  EL1284AI
  3253                                     EL1284R
  3254     PERFORM 7800-MOVE-SAVE-TO-MAP.
  3255     SET TB-INDX TO PI-CURRENT-LINE.
  3256     MOVE 'A'                    TO FUNCTI.
  3257     MOVE -1                     TO  SC-TEXTL (2).
  3258     SET CURSOR-SET TO TRUE
  3259     MOVE AL-UANON               TO  FUNCTA.
  3260     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3261             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3262             SC-INDX > NUM-LINES-PER-SCREEN.
  3263     MOVE '1'                    TO PI-UPDATE-SW.
  3264     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  71
* EL1284.cbl
  3266 5500-LOOKUP.
  3267     PERFORM 7500-READ-TS THRU 7599-EXIT.
  3268     SET TB-INDX TO PI-CURRENT-LINE.
  3269     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3270             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3271             SC-INDX > NUM-LINES-PER-SCREEN.
  3272
  3273     IF NOT EMI-NO-ERRORS
  3274        GO TO 8200-SEND-DATAONLY
  3275     END-IF.
  3276
  3277     MOVE LINE1I                 TO  PI-CURRENT-LINE.
  3278     SET TB-INDX                 TO PI-CURRENT-LINE.
  3279     MOVE LOW-VALUES             TO  EL1284AI
  3280                                     EL1284R
  3281     PERFORM 7800-MOVE-SAVE-TO-MAP.
  3282     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3283             VARYING SC-INDX FROM 1 BY 1
  3284             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3285     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3286     MOVE -1 TO FUNCTL
  3287     SET CURSOR-SET TO TRUE
  3288     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  72
* EL1284.cbl
  3290 6000-NOT-OPEN.
  3291     MOVE ER-2954                TO  EMI-ERROR.
  3292     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3293
  3294     IF EIBAID = DFHCLEAR
  3295         GO TO 9410-RETURN
  3296     ELSE
  3297         GO TO 8100-SEND-INITIAL-MAP
  3298     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  73
* EL1284.cbl
  3300 7000-BUILD-TABLE.
  3301
  3302     SET TB-INDX TO 1.
  3303     MOVE ZEROS                  TO  PI-TOTAL-LINES
  3304                                     PI-CURRENT-LINE
  3305                                     PI-TEMP-STOR-ITEMS
  3306                                     PI-UPDATE-SW.
  3307     MOVE LOW-VALUES             TO  EL1284AI
  3308                                     EL1284R
  3309
  3310****IF TEMP STORAGE EXISTS, DELETE IT.
  3311     IF PI-CHANGE-IN-NOTE-TYPE
  3312         MOVE 'N' TO PI-SET-NOTE-CHANGE
  3313     ELSE
  3314         PERFORM 7500-READ-TS THRU 7599-EXIT
  3315     END-IF.
  3316
  3317     IF PI-TEMP-STOR-ITEMS NOT = ZERO
  3318        PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT
  3319     END-IF.
  3320
  3321
  3322* EXEC CICS HANDLE CONDITION
  3323*         NOTFND(7010-ENDBR)
  3324*         NOTOPEN(6000-NOT-OPEN)
  3325*         ENDFILE(7010-ENDBR)
  3326*    END-EXEC.
  3327*    MOVE '"$IJ''                 ! & #00003152' TO DFHEIV0
  3328     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  3329     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3330     MOVE X'2620233030303033313532' TO DFHEIV0(25:11)
  3331     CALL 'kxdfhei1' USING DFHEIV0
  3332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3333
  3334
  3335
  3336* EXEC CICS STARTBR
  3337*         DATASET(ELMEMO-FILE-ID)
  3338*         RIDFLD(ELMEMO-KEY)
  3339*         KEYLENGTH(ELMEMO-START-LENGTH)
  3340*         GENERIC
  3341*         GTEQ
  3342*    END-EXEC.
  3343     MOVE 0
  3344       TO DFHEIV11
  3345*    MOVE '&,   KG    G          &   #00003158' TO DFHEIV0
  3346     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3347     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3348     MOVE X'2020233030303033313538' TO DFHEIV0(25:11)
  3349     CALL 'kxdfhei1' USING DFHEIV0,
  3350           ELMEMO-FILE-ID,
  3351           ELMEMO-KEY,
  3352           ELMEMO-START-LENGTH,
  3353           DFHEIV11,
  3354           DFHEIV99
  3355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3356
  3357
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  74
* EL1284.cbl
  3358 7001-LOOP.
  3359
  3360* EXEC CICS READNEXT
  3361*         SET(ADDRESS OF CLAIM-MEMO-FILE)
  3362*         DATASET(ELMEMO-FILE-ID)
  3363*         RIDFLD(ELMEMO-KEY)
  3364*    END-EXEC.
  3365     MOVE 0
  3366       TO DFHEIV11
  3367*    MOVE '&.S                   )   #00003167' TO DFHEIV0
  3368     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3369     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3370     MOVE X'2020233030303033313637' TO DFHEIV0(25:11)
  3371     CALL 'kxdfhei1' USING DFHEIV0,
  3372           ELMEMO-FILE-ID,
  3373           DFHEIV20,
  3374           DFHEIV99,
  3375           ELMEMO-KEY,
  3376           DFHEIV99,
  3377           DFHEIV11,
  3378           DFHEIV99,
  3379           DFHEIV99
  3380     SET ADDRESS OF CLAIM-MEMO-FILE TO
  3381         DFHEIV20
  3382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3383
  3384
  3385     IF MM-COMPANY-CD NOT = SV-COMPANY-CD
  3386         GO TO 7010-ENDBR
  3387     END-IF.
  3388
  3389     IF (MM-CARRIER = SV-CARRIER)
  3390        AND (MM-CERT-NO = SV-CERT-NO)
  3391        AND (MM-CLAIM-NO = SV-CLAIM-NO)
  3392        AND (MM-RECORD-TYPE = SV-RECORD-TYPE)
  3393        IF MM-PAYMENT-SEQ-NO = ZERO
  3394           MOVE MM-LONG-HEALTH-APP TO LNGHLAPO
  3395                                      PI-LONG-HLTH-APP
  3396           MOVE MM-REWRITE-IND TO REWRITEO
  3397                                  PI-REWRITE
  3398           MOVE MM-CHECKED-OTHER-COVG TO CHKCOVGO
  3399                                         PI-CHKCOVG
  3400           MOVE MM-MR-RELEASED-FROM-DATE TO DC-BIN-DATE-1
  3401           MOVE ' '                    TO DC-OPTION-CODE
  3402           PERFORM 9700-LINK-DATE-CONVERT
  3403           IF DC-EDIT1-MONTH > ZERO
  3404              MOVE DC-GREG-DATE-1-EDIT    TO MRRELDTO
  3405                                             PI-MR-RELEASE-DATE
  3406           END-IF
  3407        ELSE
  3408           MOVE MM-CLAIM-MEMO TO REC-TEXT (TB-INDX)
  3409           MOVE MM-LAST-MAINT-BY TO REC-LAST-MAINT-BY (TB-INDX)
  3410           MOVE MM-LAST-MAINT-DT TO REC-LAST-MAINT-DT (TB-INDX)
  3411           MOVE MM-LAST-MAINT-HHMMSS TO
  3412                          REC-LAST-MAINT-HHMMSS (TB-INDX)
  3413           SET TB-INDX UP BY 1
  3414        END-IF
  3415        GO TO 7001-LOOP
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  75
* EL1284.cbl
  3416     END-IF.
  3417 7010-ENDBR.
  3418     IF TB-INDX = 1
  3419         MOVE ER-0006            TO EMI-ERROR
  3420         MOVE 'A'                TO FUNCTI
  3421         MOVE -1                 TO SC-TEXTL (1)
  3422         MOVE AL-UANON           TO FUNCTA
  3423         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3424         MOVE ZEROS              TO PI-TOTAL-LINES
  3425         GO TO 8100-SEND-INITIAL-MAP
  3426     END-IF.
  3427
  3428
  3429* EXEC CICS ENDBR
  3430*         DATASET(ELMEMO-FILE-ID)
  3431*    END-EXEC.
  3432     MOVE 0
  3433       TO DFHEIV11
  3434*    MOVE '&2                    $   #00003216' TO DFHEIV0
  3435     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3436     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3437     MOVE X'2020233030303033323136' TO DFHEIV0(25:11)
  3438     CALL 'kxdfhei1' USING DFHEIV0,
  3439           ELMEMO-FILE-ID,
  3440           DFHEIV11,
  3441           DFHEIV99
  3442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3443
  3444
  3445     SET TB-INDX DOWN BY 1.
  3446     SET PI-TOTAL-LINES TO TB-INDX.
  3447     MOVE 1                      TO PI-CURRENT-LINE.
  3448
  3449 7050-FORMAT-LINES.
  3450     SET TB-INDX TO PI-CURRENT-LINE.
  3451     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3452             VARYING SC-INDX FROM 1
  3453             BY 1 UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3454     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3455     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  76
* EL1284.cbl
  3457 7100-FORMAT-SCREEN.
  3458     IF TB-INDX > PI-TOTAL-LINES
  3459        IF FUNCTI NOT = 'A'
  3460           MOVE AL-PANON         TO SC-TEXTA (SC-INDX)
  3461        END-IF
  3462     END-IF.
  3463
  3464     IF TB-INDX > PI-TOTAL-LINES
  3465         GO TO 7100-EXIT
  3466     END-IF.
  3467
  3468     SET WS-LINE TO TB-INDX.
  3469     MOVE WS-LINE TO SC-LIN (SC-INDX).
  3470     MOVE REC-TEXT (TB-INDX)     TO SC-TEXT (SC-INDX).
  3471     MOVE REC-LAST-MAINT-BY (TB-INDX) TO SC-MTBY (SC-INDX).
  3472     MOVE REC-LAST-MAINT-DT (TB-INDX) TO DC-BIN-DATE-1.
  3473     MOVE ' '                    TO DC-OPTION-CODE.
  3474     PERFORM 9700-LINK-DATE-CONVERT.
  3475     MOVE DC-GREG-DATE-1-MDY     TO SC-MTDT (SC-INDX).
  3476     SET ROLL-COUNTER TO TB-INDX.
  3477
  3478     IF NOT MODIFY-CAP
  3479         MOVE AL-PANOF           TO SC-TEXTA (SC-INDX)
  3480         SET TB-INDX UP BY 1
  3481         GO TO 7100-EXIT
  3482     END-IF.
  3483
  3484     SET TB-INDX UP BY 1.
  3485
  3486 7100-EXIT.
  3487      EXIT.
  3488
  3489 7200-PUT-TEMP-STOR.
  3490     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  3491     SET TS-INDX TO 1.
  3492     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
  3493     PERFORM 7300-WRITE-TS THRU 7399-EXIT
  3494             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
  3495             UNTIL TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
  3496 7249-EXIT.
  3497      EXIT.
  3498 7250-DELETE-TEMP-STOR.
  3499
  3500* EXEC CICS HANDLE CONDITION
  3501*         QIDERR(7299-EXIT)
  3502*    END-EXEC.
  3503*    MOVE '"$N                   ! '' #00003274' TO DFHEIV0
  3504     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3505     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3506     MOVE X'2720233030303033323734' TO DFHEIV0(25:11)
  3507     CALL 'kxdfhei1' USING DFHEIV0
  3508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3509
  3510
  3511* EXEC CICS DELETEQ TS
  3512*         QUEUE(QID)
  3513*    END-EXEC.
  3514*    MOVE '*&                    #   #00003277' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  77
* EL1284.cbl
  3515     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3516     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3517     MOVE X'2020233030303033323737' TO DFHEIV0(25:11)
  3518     CALL 'kxdfhei1' USING DFHEIV0,
  3519           QID,
  3520           DFHEIV99
  3521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3522
  3523 7299-EXIT.
  3524     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  78
* EL1284.cbl
  3526 7300-WRITE-TS.
  3527     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA.
  3528     SET TS-INDX UP BY 1.
  3529     ADD 1 TO PI-TEMP-STOR-ITEMS.
  3530
  3531* EXEC CICS WRITEQ TS
  3532*         FROM(TS-WORK-AREA)
  3533*         QUEUE(QID)
  3534*         LENGTH(TS-LENGTH)
  3535*         ITEM(PI-TEMP-STOR-ITEMS)
  3536*    END-EXEC.
  3537*    MOVE '*" I   L              ''   #00003287' TO DFHEIV0
  3538     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
  3539     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3540     MOVE X'2020233030303033323837' TO DFHEIV0(25:11)
  3541     CALL 'kxdfhei1' USING DFHEIV0,
  3542           QID,
  3543           TS-WORK-AREA,
  3544           TS-LENGTH,
  3545           PI-TEMP-STOR-ITEMS,
  3546           DFHEIV99,
  3547           DFHEIV99
  3548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3549
  3550 7399-EXIT.
  3551     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  79
* EL1284.cbl
  3553 7400-PAGE-ROUTINE.
  3554
  3555     IF PFENTERL NOT = ZEROS
  3556        MOVE -1                  TO PFENTERL
  3557        ELSE
  3558        MOVE -1                  TO FUNCTL
  3559     END-IF.
  3560
  3561     IF PI-TOTAL-LINES = 0
  3562        MOVE ER-0047             TO EMI-ERROR
  3563        MOVE -1                  TO FUNCTL
  3564        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3565        GO TO 8200-SEND-DATAONLY
  3566     END-IF.
  3567
  3568     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER.
  3569
  3570     IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  3571        MOVE ER-0067             TO EMI-ERROR
  3572        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3573        MOVE 1 TO TEMP-CURR-LINE
  3574     END-IF.
  3575
  3576     IF TEMP-CURR-LINE GREATER THAN PI-TOTAL-LINES
  3577        MOVE ER-0066             TO EMI-ERROR
  3578        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3579        COMPUTE TEMP-CURR-LINE = PI-TOTAL-LINES + 1
  3580                               - NUM-LINES-PER-SCREEN
  3581        IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  3582           MOVE 1                TO TEMP-CURR-LINE
  3583        END-IF
  3584     END-IF.
  3585
  3586     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3587     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3588             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3589             SC-INDX > NUM-LINES-PER-SCREEN.
  3590
  3591     IF EMI-ERROR = ER-0066 OR = ER-0067 OR = ZEROS
  3592        NEXT SENTENCE
  3593     ELSE
  3594        GO TO 8200-SEND-DATAONLY
  3595     END-IF.
  3596
  3597     MOVE TEMP-CURR-LINE         TO PI-CURRENT-LINE.
  3598     SET TB-INDX TO PI-CURRENT-LINE.
  3599     MOVE LOW-VALUES             TO EL1284AI
  3600                                    EL1284R
  3601     PERFORM 7800-MOVE-SAVE-TO-MAP.
  3602     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3603             VARYING SC-INDX FROM 1 BY 1
  3604             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3605     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3606     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  80
* EL1284.cbl
  3608
  3609 7450-SET-INDX.
  3610     IF PI-CURRENT-LINE = 0 AND PI-TOTAL-LINES = 0
  3611        SET TB-INDX TO 1
  3612     ELSE
  3613        PERFORM 7500-READ-TS THRU 7599-EXIT
  3614        IF PI-CURRENT-LINE = 0
  3615           SET TB-INDX TO 1
  3616        ELSE
  3617           SET TB-INDX TO PI-CURRENT-LINE
  3618        END-IF
  3619     END-IF.
  3620 7450-EXIT.
  3621      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  81
* EL1284.cbl
  3623 7500-READ-TS.
  3624
  3625* EXEC CICS HANDLE CONDITION
  3626*         QIDERR(7590-TS-QIDERR)
  3627*         ITEMERR(7585-QID-ITEMERR)
  3628*    END-EXEC.
  3629*    MOVE '"$N<                  ! ( #00003367' TO DFHEIV0
  3630     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  3631     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3632     MOVE X'2820233030303033333637' TO DFHEIV0(25:11)
  3633     CALL 'kxdfhei1' USING DFHEIV0
  3634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3635
  3636     SET TS-INDX TO 1.
  3637     MOVE 1                      TO QID-ITEM.
  3638 7501-LOOP.
  3639
  3640* EXEC CICS READQ TS
  3641*         INTO(TS-WORK-AREA)
  3642*         QUEUE(QID)
  3643*         LENGTH(TS-LENGTH)
  3644*         ITEM(QID-ITEM)
  3645*    END-EXEC.
  3646*    MOVE '*$II   L              ''   #00003374' TO DFHEIV0
  3647     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3648     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3649     MOVE X'2020233030303033333734' TO DFHEIV0(25:11)
  3650     CALL 'kxdfhei1' USING DFHEIV0,
  3651           QID,
  3652           TS-WORK-AREA,
  3653           TS-LENGTH,
  3654           QID-ITEM,
  3655           DFHEIV99,
  3656           DFHEIV99
  3657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3658
  3659     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
  3660     SET TS-INDX UP BY 1.
  3661     ADD 1 TO QID-ITEM.
  3662     GO TO 7501-LOOP.
  3663
  3664 7585-QID-ITEMERR.
  3665     IF EIBTRNID NOT = TRANS-ID
  3666        SUBTRACT 1 FROM QID-ITEM
  3667        MOVE QID-ITEM            TO PI-TEMP-STOR-ITEMS
  3668     END-IF.
  3669     GO TO 7599-EXIT.
  3670
  3671 7590-TS-QIDERR.
  3672     IF EIBTRNID = TRANS-ID
  3673        AND EIBAID = DFHCLEAR
  3674           GO TO 9410-RETURN
  3675     END-IF.
  3676     IF EIBTRNID = TRANS-ID
  3677        MOVE ER-0033             TO EMI-ERROR
  3678        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3679        GO TO 8100-SEND-INITIAL-MAP
  3680     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  82
* EL1284.cbl
  3681
  3682 7599-EXIT.
  3683      EXIT.
  3684
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  83
* EL1284.cbl
  3686 7600-UPDATE-TABLE-FROM-SCREEN.
  3687
  3688     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  3689         IF TB-INDX NOT > PI-TOTAL-LINES
  3690             PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  3691             SET TB-INDX UP BY 1
  3692         ELSE
  3693             IF PI-TOTAL-LINES = MAX-LINES
  3694                 MOVE ER-0051    TO EMI-ERROR
  3695                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3696                 GO TO 8200-SEND-DATAONLY
  3697             ELSE
  3698                 PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  3699                 SET TB-INDX UP BY 1
  3700                 ADD 1 TO PI-TOTAL-LINES
  3701             END-IF
  3702         END-IF
  3703     ELSE
  3704        IF TB-INDX NOT > PI-TOTAL-LINES
  3705           SET TB-INDX UP BY 1
  3706        END-IF
  3707     END-IF.
  3708
  3709 7699-EXIT.
  3710      EXIT.
  3711
  3712 7700-MOVE-DATA.
  3713     MOVE '1'                    TO PI-UPDATE-SW.
  3714
  3715     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  3716        MOVE SC-TEXT (SC-INDX)  TO REC-TEXT (TB-INDX)
  3717        MOVE PI-PROCESSOR-ID    TO REC-LAST-MAINT-BY (TB-INDX)
  3718        MOVE EIBTIME            TO REC-LAST-MAINT-HHMMSS (TB-INDX)
  3719        MOVE SAVE-BIN-DATE      TO REC-LAST-MAINT-DT (TB-INDX)
  3720     END-IF.
  3721
  3722 7700-EXIT.
  3723      EXIT.
  3724 7800-MOVE-SAVE-TO-MAP.
  3725     MOVE PI-LONG-HLTH-APP TO LNGHLAPI
  3726     MOVE PI-REWRITE TO REWRITEI
  3727     MOVE PI-CHKCOVG TO CHKCOVGI
  3728     MOVE PI-MR-RELEASE-DATE TO MRRELDTI.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  84
* EL1284.cbl
  3730 8100-SEND-INITIAL-MAP.
  3731     MOVE SAVE-DATE              TO DATEO.
  3732     MOVE EIBTIME                TO TIME-IN.
  3733     MOVE TIME-OUT               TO TIMEO.
  3734     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3735     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3736     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGBO.
  3737     MOVE PI-CARRIER             TO CARRO
  3738*    MOVE PI-GROUPING            TO FGROUPO.
  3739*    MOVE PI-STATE               TO FSTO.
  3740*    MOVE PI-ACCOUNT             TO FACOUNTO.
  3741     MOVE PI-CERT-NO             TO CERTNOO
  3742     MOVE PI-CLAIM-NO            TO CLAIMNOO
  3743*    MOVE PI-CERT-SFX            TO FCRTSFXO.
  3744*
  3745     PERFORM 8150-READ-CLAIM.
  3746*
  3747     MOVE  ' '                   TO DC-OPTION-CODE.
  3748     MOVE PI-CERT-EFF-DT         TO DC-BIN-DATE-1.
  3749     PERFORM 9700-LINK-DATE-CONVERT.
  3750*    MOVE DC-GREG-DATE-1-EDIT    TO FEFFDTO.
  3751     MOVE PI-TOTAL-LINES         TO TOTO.
  3752*    IF PI-CLAIM-NOTE
  3753*        MOVE SCR-CLAIM-NOTE-TYPE TO FTYPEO
  3754*        MOVE SCR-PF6-CERT        TO PF6NOTEO
  3755*        MOVE SCR-CERT-YN         TO FTYPEYNO
  3756*        IF PI-CERT-NOTES-EXIST = 'Y'
  3757*            MOVE 'YES'           TO FCERTYNO
  3758*        ELSE
  3759*            MOVE 'NO '           TO FCERTYNO
  3760*        END-IF
  3761*    ELSE
  3762*        MOVE SCR-CERT-NOTE-TYPE TO FTYPEO
  3763*        MOVE SCR-PF6-CLAIM      TO PF6NOTEO
  3764*        MOVE SCR-CLAIM-YN       TO FTYPEYNO
  3765*        IF PI-CLAIM-NOTES-EXIST = 'Y'
  3766*            MOVE 'YES'           TO FCERTYNO
  3767*        ELSE
  3768*            MOVE 'NO '           TO FCERTYNO
  3769*        END-IF
  3770*    END-IF.
  3771*    IF PI-BILLING-NOTES-EXIST = 'Y'
  3772*        MOVE 'YES'           TO FBILLYNO
  3773*    ELSE
  3774*        MOVE 'NO '           TO FBILLYNO
  3775*    END-IF
  3776
  3777     MOVE EL1284R TO GROUP2.
  3778     IF NOT CURSOR-SET
  3779        MOVE -1                     TO LNGHLAPL
  3780     END-IF
  3781
  3782
  3783* EXEC CICS SEND
  3784*         MAP(MAP-NAME)
  3785*         MAPSET(MAPSET-NAME)
  3786*         FROM(EL1284AO)
  3787*         ERASE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  85
* EL1284.cbl
  3788*         CURSOR
  3789*    END-EXEC.
  3790     MOVE LENGTH OF
  3791      EL1284AO
  3792       TO DFHEIV12
  3793     MOVE -1
  3794       TO DFHEIV11
  3795*    MOVE '8$     CT  E    H L F ,   #00003503' TO DFHEIV0
  3796     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3797     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3798     MOVE X'2020233030303033353033' TO DFHEIV0(25:11)
  3799     CALL 'kxdfhei1' USING DFHEIV0,
  3800           MAP-NAME,
  3801           EL1284AO,
  3802           DFHEIV12,
  3803           MAPSET-NAME,
  3804           DFHEIV99,
  3805           DFHEIV99,
  3806           DFHEIV99,
  3807           DFHEIV11,
  3808           DFHEIV99,
  3809           DFHEIV99,
  3810           DFHEIV99
  3811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3812
  3813
  3814     GO TO 9100-RETURN-TRAN.
  3815
  3816 8150-READ-CLAIM.
  3817
  3818* EXEC CICS HANDLE CONDITION
  3819*        NOTFND   (8150-NOT-FOUND)
  3820*    END-EXEC.
  3821*    MOVE '"$I                   ! ) #00003514' TO DFHEIV0
  3822     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3823     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3824     MOVE X'2920233030303033353134' TO DFHEIV0(25:11)
  3825     CALL 'kxdfhei1' USING DFHEIV0
  3826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3827
  3828     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  3829     MOVE PI-CARRIER             TO MSTR-CARRIER.
  3830     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  3831     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  3832
  3833
  3834* EXEC CICS READ
  3835*        UPDATE
  3836*        DATASET   ('ELMSTR')
  3837*        RIDFLD    (ELMSTR-KEY)
  3838*        INTO      (CLAIM-MASTER)
  3839*    END-EXEC.
  3840     MOVE LENGTH OF
  3841      CLAIM-MASTER
  3842       TO DFHEIV11
  3843     MOVE 'ELMSTR' TO DFHEIV1
  3844*    MOVE '&"IL       EU         (   #00003522' TO DFHEIV0
  3845     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  86
* EL1284.cbl
  3846     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3847     MOVE X'2020233030303033353232' TO DFHEIV0(25:11)
  3848     CALL 'kxdfhei1' USING DFHEIV0,
  3849           DFHEIV1,
  3850           CLAIM-MASTER,
  3851           DFHEIV11,
  3852           ELMSTR-KEY,
  3853           DFHEIV99,
  3854           DFHEIV99,
  3855           DFHEIV99
  3856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3857
  3858     EVALUATE TRUE
  3859        WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
  3860           MOVE PI-AH-OVERRIDE-L6
  3861                                 TO TYPEO
  3862        WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  3863           MOVE PI-LIFE-OVERRIDE-L6
  3864                                 TO TYPEO
  3865        WHEN CL-CLAIM-TYPE = 'I'
  3866           MOVE '  IU  '         TO TYPEO
  3867        WHEN CL-CLAIM-TYPE = 'G'
  3868           MOVE ' GAP  '         TO TYPEO
  3869        WHEN CL-CLAIM-TYPE = 'F'
  3870           MOVE ' FAM  '         TO TYPEO
  3871        WHEN CL-CLAIM-TYPE = 'O'
  3872           MOVE ' OTH  '         TO TYPEO
  3873     END-EVALUATE.
  3874     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
  3875     MOVE CL-INSURED-LAST-NAME   TO LASTNMEO.
  3876 8150-NOT-FOUND.
  3877     MOVE SPACES    TO TYPEO.
  3878*
  3879 8200-SEND-DATAONLY.
  3880     MOVE EIBTIME                TO TIME-IN.
  3881     MOVE TIME-OUT               TO TIMEO.
  3882     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3883     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3884     MOVE PI-TOTAL-LINES         TO TOTO.
  3885     MOVE EL1284R TO GROUP2.
  3886
  3887     IF NOT EMI-NO-ERRORS
  3888        MOVE EMI-MESSAGE-AREA (1) TO ERRMSGBO
  3889     ELSE
  3890        MOVE -1                  TO FUNCTL
  3891     END-IF.
  3892
  3893
  3894* EXEC CICS SEND
  3895*         MAP(MAP-NAME)
  3896*         MAPSET(MAPSET-NAME)
  3897*         FROM(EL1284AO)
  3898*         DATAONLY
  3899*         CURSOR
  3900*    END-EXEC.
  3901     MOVE LENGTH OF
  3902      EL1284AO
  3903       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  87
* EL1284.cbl
  3904     MOVE -1
  3905       TO DFHEIV11
  3906*    MOVE '8$D    CT       H L F ,   #00003563' TO DFHEIV0
  3907     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3908     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3909     MOVE X'2020233030303033353633' TO DFHEIV0(25:11)
  3910     CALL 'kxdfhei1' USING DFHEIV0,
  3911           MAP-NAME,
  3912           EL1284AO,
  3913           DFHEIV12,
  3914           MAPSET-NAME,
  3915           DFHEIV99,
  3916           DFHEIV99,
  3917           DFHEIV99,
  3918           DFHEIV11,
  3919           DFHEIV99,
  3920           DFHEIV99,
  3921           DFHEIV99
  3922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3923
  3924
  3925     GO TO 9100-RETURN-TRAN.
  3926
  3927 8300-SEND-TEXT.
  3928
  3929* EXEC CICS SEND TEXT
  3930*         FROM(LOGOFF-TEXT)
  3931*         ERASE
  3932*         FREEKB
  3933*         LENGTH(LOGOFF-LENGTH)
  3934*    END-EXEC.
  3935*    MOVE '8&      T  E F  H   F -   #00003574' TO DFHEIV0
  3936     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3937     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3938     MOVE X'2020233030303033353734' TO DFHEIV0(25:11)
  3939     CALL 'kxdfhei1' USING DFHEIV0,
  3940           LOGOFF-TEXT,
  3941           LOGOFF-LENGTH,
  3942           DFHEIV99,
  3943           DFHEIV99,
  3944           DFHEIV99,
  3945           DFHEIV99,
  3946           DFHEIV99,
  3947           DFHEIV99,
  3948           DFHEIV99,
  3949           DFHEIV99,
  3950           DFHEIV99,
  3951           DFHEIV99
  3952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3953
  3954
  3955     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  3956
  3957
  3958* EXEC CICS RETURN
  3959*    END-EXEC.
  3960*    MOVE '.(                    ''   #00003583' TO DFHEIV0
  3961     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  88
* EL1284.cbl
  3962     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3963     MOVE X'2020233030303033353833' TO DFHEIV0(25:11)
  3964     CALL 'kxdfhei1' USING DFHEIV0,
  3965           DFHEIV99,
  3966           DFHEIV99,
  3967           DFHEIV99,
  3968           DFHEIV99,
  3969           DFHEIV99,
  3970           DFHEIV99
  3971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3972
  3973
  3974 8800-UNAUTHORIZED-ACCESS.
  3975     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3976     GO TO 8300-SEND-TEXT.
  3977
  3978 9000-RETURN-CICS.
  3979     IF PI-CHANGES-MADE
  3980        MOVE ER-0045             TO EMI-ERROR
  3981        MOVE -1                  TO FUNCTL
  3982        MOVE SPACES              TO PFENTERO
  3983        MOVE AL-UNNOF            TO PFENTERA
  3984        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3985        GO TO 8200-SEND-DATAONLY
  3986     END-IF.
  3987
  3988     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3989     MOVE XCTL-005               TO PGM-NAME.
  3990     GO TO 9300-XCTL.
  3991
  3992 9100-RETURN-TRAN.
  3993     MOVE SCRN-NUMBER            TO PI-CURRENT-SCREEN-NO.
  3994     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  3995
  3996* EXEC CICS RETURN
  3997*         TRANSID(TRANS-ID)
  3998*         COMMAREA(PROGRAM-INTERFACE-BLOCK)
  3999*         LENGTH(PI-COMM-LENGTH)
  4000*    END-EXEC.
  4001*    MOVE '.(CT                  ''   #00003607' TO DFHEIV0
  4002     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  4003     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4004     MOVE X'2020233030303033363037' TO DFHEIV0(25:11)
  4005     CALL 'kxdfhei1' USING DFHEIV0,
  4006           TRANS-ID,
  4007           PROGRAM-INTERFACE-BLOCK,
  4008           PI-COMM-LENGTH,
  4009           DFHEIV99,
  4010           DFHEIV99,
  4011           DFHEIV99
  4012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4013
  4014
  4015
  4016 9200-RETURN-MAIN-MENU.
  4017     IF PI-CHANGES-MADE
  4018        MOVE -1                  TO FUNCTL
  4019        MOVE SPACES              TO PFENTERO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  89
* EL1284.cbl
  4020        MOVE AL-UNNOF            TO PFENTERA
  4021        MOVE ER-0045             TO EMI-ERROR
  4022        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4023        GO TO 8200-SEND-DATAONLY
  4024     END-IF.
  4025
  4026     MOVE XCTL-126               TO PGM-NAME.
  4027
  4028 9300-XCTL.
  4029     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  4030
  4031* EXEC CICS XCTL
  4032*         PROGRAM  (PGM-NAME)
  4033*         COMMAREA (PROGRAM-INTERFACE-BLOCK)
  4034*         LENGTH   (PI-COMM-LENGTH)
  4035*    END-EXEC.
  4036*    MOVE '.$C                   %   #00003628' TO DFHEIV0
  4037     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4038     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4039     MOVE X'2020233030303033363238' TO DFHEIV0(25:11)
  4040     CALL 'kxdfhei1' USING DFHEIV0,
  4041           PGM-NAME,
  4042           PROGRAM-INTERFACE-BLOCK,
  4043           PI-COMM-LENGTH,
  4044           DFHEIV99
  4045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4046
  4047
  4048 9400-CLEAR.
  4049
  4050     IF PI-CHANGES-MADE
  4051         MOVE ER-0045            TO EMI-ERROR
  4052         MOVE -1                 TO FUNCTL
  4053         SET CURSOR-SET TO TRUE
  4054         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4055         PERFORM 7800-MOVE-SAVE-TO-MAP
  4056         IF PI-CURRENT-LINE GREATER THAN ZERO
  4057             PERFORM 7500-READ-TS THRU 7599-EXIT
  4058             SET TB-INDX TO PI-CURRENT-LINE
  4059             PERFORM 7100-FORMAT-SCREEN  THRU  7100-EXIT
  4060                 VARYING SC-INDX FROM 1 BY 1 UNTIL
  4061                 SC-INDX GREATER NUM-LINES-PER-SCREEN
  4062         END-IF
  4063         GO TO 8100-SEND-INITIAL-MAP
  4064     END-IF.
  4065
  4066 9410-RETURN.
  4067*    IF PF5-PRESSED
  4068*        MOVE PGM-EL1276           TO PGM-NAME
  4069*    ELSE
  4070*        IF PF6-PRESSED
  4071*            IF PI-CLAIM-NOTE
  4072*                SET PI-CERT-NOTE  TO TRUE
  4073*            ELSE
  4074*                SET PI-CLAIM-NOTE TO TRUE
  4075*            END-IF
  4076*            SET PI-CHANGE-IN-NOTE-TYPE TO TRUE
  4077*            MOVE 'N'              TO PI-PF6-PRESSED
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  90
* EL1284.cbl
  4078*            GO TO 1000-START
  4079*        ELSE
  4080             MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME
  4081*        END-IF
  4082*    END-IF.
  4083     GO TO 9300-XCTL.
  4084
  4085 9500-PF12.
  4086     IF PI-CHANGES-MADE
  4087        MOVE -1                  TO FUNCTL
  4088        MOVE SPACES              TO PFENTERO
  4089        MOVE AL-UNNOF            TO PFENTERA
  4090        MOVE ER-0045             TO EMI-ERROR
  4091        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4092        GO TO 8200-SEND-DATAONLY
  4093     END-IF.
  4094
  4095     MOVE 'EL010'                TO PGM-NAME.
  4096     GO TO 9300-XCTL.
  4097
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  91
* EL1284.cbl
  4099
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  92
* EL1284.cbl
  4101 9600-PGMID-ERROR.
  4102
  4103* EXEC CICS HANDLE CONDITION
  4104*         PGMIDERR(8300-SEND-TEXT)
  4105*    END-EXEC.
  4106*    MOVE '"$L                   ! * #00003688' TO DFHEIV0
  4107     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4108     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4109     MOVE X'2A20233030303033363838' TO DFHEIV0(25:11)
  4110     CALL 'kxdfhei1' USING DFHEIV0
  4111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4112
  4113
  4114     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  4115     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  4116     MOVE XCTL-005               TO  PGM-NAME.
  4117     MOVE PGM-NAME               TO  LOGOFF-PGM.
  4118     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  4119
  4120     GO TO 9300-XCTL.
  4121
  4122 9700-LINK-DATE-CONVERT.
  4123
  4124     MOVE LINK-ELDATCV           TO  PGM-NAME.
  4125
  4126* EXEC CICS LINK
  4127*        PROGRAM    (PGM-NAME)
  4128*        COMMAREA   (DATE-CONVERSION-DATA)
  4129*        LENGTH     (DC-COMM-LENGTH)
  4130*    END-EXEC.
  4131*    MOVE '."C                   (   #00003703' TO DFHEIV0
  4132     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4133     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4134     MOVE X'2020233030303033373033' TO DFHEIV0(25:11)
  4135     CALL 'kxdfhei1' USING DFHEIV0,
  4136           PGM-NAME,
  4137           DATE-CONVERSION-DATA,
  4138           DC-COMM-LENGTH,
  4139           DFHEIV99,
  4140           DFHEIV99,
  4141           DFHEIV99,
  4142           DFHEIV99
  4143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4144
  4145
  4146 9700-EXIT.
  4147     EXIT.
  4148
  4149 9900-ERROR-FORMAT.
  4150     IF NOT EMI-ERRORS-COMPLETE
  4151        MOVE LINK-001            TO  PGM-NAME
  4152
  4153* EXEC CICS LINK
  4154*            PROGRAM(PGM-NAME)
  4155*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  4156*            LENGTH(EMI-COMM-LENGTH)
  4157*       END-EXEC
  4158*    MOVE '."C                   (   #00003715' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  93
* EL1284.cbl
  4159     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4160     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4161     MOVE X'2020233030303033373135' TO DFHEIV0(25:11)
  4162     CALL 'kxdfhei1' USING DFHEIV0,
  4163           PGM-NAME,
  4164           ERROR-MESSAGE-INTERFACE-BLOCK,
  4165           EMI-COMM-LENGTH,
  4166           DFHEIV99,
  4167           DFHEIV99,
  4168           DFHEIV99,
  4169           DFHEIV99
  4170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4171     END-IF.
  4172 9900-EXIT.
  4173     EXIT.
  4174
  4175 9990-ABEND.
  4176     MOVE LINK-004               TO  PGM-NAME.
  4177     MOVE DFHEIBLK               TO  EMI-LINE1.
  4178
  4179
  4180* EXEC CICS LINK
  4181*        PROGRAM   (PGM-NAME)
  4182*        COMMAREA  (EMI-LINE1)
  4183*        LENGTH    (72)
  4184*    END-EXEC.
  4185     MOVE 72
  4186       TO DFHEIV11
  4187*    MOVE '."C                   (   #00003728' TO DFHEIV0
  4188     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4189     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4190     MOVE X'2020233030303033373238' TO DFHEIV0(25:11)
  4191     CALL 'kxdfhei1' USING DFHEIV0,
  4192           PGM-NAME,
  4193           EMI-LINE1,
  4194           DFHEIV11,
  4195           DFHEIV99,
  4196           DFHEIV99,
  4197           DFHEIV99,
  4198           DFHEIV99
  4199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4200
  4201
  4202     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSGBO.
  4203     MOVE -1                     TO  FUNCTL.
  4204
  4205     GO TO 8100-SEND-INITIAL-MAP.
  4206
  4207
  4208* GOBACK.
  4209     MOVE '9%                    "   ' TO DFHEIV0
  4210     MOVE 'EL1284' TO DFHEIV1
  4211     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4212     GOBACK.
  4213
  4214 9995-SECURITY-VIOLATION.
  4215*                                COPY ELCSCTP.
  4216******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  94
* EL1284.cbl
  4217*                                                                *
  4218*                            ELCSCTP                             *
  4219*                            VMOD=2.001                          *
  4220*                                                                *
  4221*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  4222******************************************************************
  4223
  4224
  4225     MOVE EIBDATE          TO SM-JUL-DATE.
  4226     MOVE EIBTRMID         TO SM-TERMID.
  4227     MOVE THIS-PGM         TO SM-PGM.
  4228     MOVE EIBTIME          TO TIME-IN.
  4229     MOVE TIME-OUT         TO SM-TIME.
  4230     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  4231
  4232
  4233* EXEC CICS LINK
  4234*         PROGRAM  ('EL003')
  4235*         COMMAREA (SECURITY-MESSAGE)
  4236*         LENGTH   (80)
  4237*    END-EXEC.
  4238     MOVE 'EL003' TO DFHEIV1
  4239     MOVE 80
  4240       TO DFHEIV11
  4241*    MOVE '."C                   (   #00003759' TO DFHEIV0
  4242     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4244     MOVE X'2020233030303033373539' TO DFHEIV0(25:11)
  4245     CALL 'kxdfhei1' USING DFHEIV0,
  4246           DFHEIV1,
  4247           SECURITY-MESSAGE,
  4248           DFHEIV11,
  4249           DFHEIV99,
  4250           DFHEIV99,
  4251           DFHEIV99,
  4252           DFHEIV99
  4253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4254
  4255
  4256******************************************************************
  4257
  4258
  4259 9995-EXIT.
  4260     EXIT.
  4261
  4262 9999-DFHBACK SECTION.
  4263     MOVE '9%                    "   ' TO DFHEIV0
  4264     MOVE 'EL1284' TO DFHEIV1
  4265     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4266     GOBACK.
  4267 9999-DFHEXIT.
  4268     IF DFHEIGDJ EQUAL 0001
  4269         NEXT SENTENCE
  4270     ELSE IF DFHEIGDJ EQUAL 2
  4271         GO TO 9400-CLEAR
  4272         DEPENDING ON DFHEIGDI
  4273     ELSE IF DFHEIGDJ EQUAL 3
  4274         GO TO 9990-ABEND,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:07 Page  95
* EL1284.cbl
  4275               9600-PGMID-ERROR
  4276         DEPENDING ON DFHEIGDI
  4277     ELSE IF DFHEIGDJ EQUAL 4
  4278         GO TO 4610-ENDBR,
  4279               6000-NOT-OPEN,
  4280               4610-ENDBR
  4281         DEPENDING ON DFHEIGDI
  4282     ELSE IF DFHEIGDJ EQUAL 5
  4283         GO TO 4900-EXIT
  4284         DEPENDING ON DFHEIGDI
  4285     ELSE IF DFHEIGDJ EQUAL 6
  4286         GO TO 7010-ENDBR,
  4287               6000-NOT-OPEN,
  4288               7010-ENDBR
  4289         DEPENDING ON DFHEIGDI
  4290     ELSE IF DFHEIGDJ EQUAL 7
  4291         GO TO 7299-EXIT
  4292         DEPENDING ON DFHEIGDI
  4293     ELSE IF DFHEIGDJ EQUAL 8
  4294         GO TO 7590-TS-QIDERR,
  4295               7585-QID-ITEMERR
  4296         DEPENDING ON DFHEIGDI
  4297     ELSE IF DFHEIGDJ EQUAL 9
  4298         GO TO 8150-NOT-FOUND
  4299         DEPENDING ON DFHEIGDI
  4300     ELSE IF DFHEIGDJ EQUAL 10
  4301         GO TO 8300-SEND-TEXT
  4302         DEPENDING ON DFHEIGDI.
  4303     MOVE '9%                    "   ' TO DFHEIV0
  4304     MOVE 'EL1284' TO DFHEIV1
  4305     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4306     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       32168     Code:       12626
