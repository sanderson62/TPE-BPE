* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36* 042413    2013042300001  AJRA  FIX SPECIAL MSG WHEN MULTIPLE CER
    37* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    38* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    39* 040814    2014030500002  AJRA  ADD ICD CODES
    40* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    41* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    42* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 101917  CR2017083000003  TANA  ADD CONTRACT CONTESTABLE MSG
    45* 121417  IR2017121200001  PEMA  Correct assignment of ben period
    46* 011118  CR2016052500002  TANA  Add Message for pre-existing
    47* 052918  CR2018031500002  TANA  Add Message for filing time limit
    48******************************************************************
    49
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page   3
* EL130.cbl
    51 ENVIRONMENT DIVISION.
    52 DATA DIVISION.
    53 WORKING-STORAGE SECTION.
    54 01  DFH-START PIC X(04).
    55 77  FILLER  PIC X(32)  VALUE '********************************'.
    56 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    57 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    58 77  A1                          PIC S999 COMP-3 VALUE +0.
    59 77  E1                          PIC S999 COMP-3 VALUE +0.
    60 77  s1                          pic s999 comp-3 value +0.
    61 77  s2                          pic s999 comp-3 value +0.
    62 77  P1                          PIC S999 COMP-3 VALUE +0.
    63 77  P2                          PIC S999 COMP-3 VALUE +0.
    64 77  WS-CRIT-PER-RECURRENT       PIC 99    VALUE zeros.
    65 77  WS-MAX-BENEFITS             PIC 99    VALUE ZEROS.
    66 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    67 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    68 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    69 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    70 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    71 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    72     88  ERPDEF-FOUND                 VALUE 'Y'.
    73 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    74 77  WS-BENEFITS-PREV-PAID       PIC S9(4)V999 VALUE +0  COMP-3.
    75 77  ws-dcc-product-code         pic xxx value spaces.
    76 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    77 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    78 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    79 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    80 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    81 77  ws-zero-bens-avail          pic x value ' '.
    82 77  WS-PRE-EXISTING-PER         PIC 99    VALUE ZEROS.
    83*    COPY ELCSCTM.
    84******************************************************************
    85*                                                                *
    86*                                                                *
    87*                            ELCSCTM                             *
    88*                            VMOD=2.001                          *
    89*                                                                *
    90*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    91*                                                                *
    92******************************************************************
    93 01  SECURITY-MESSAGE.
    94     12  FILLER                          PIC X(30)
    95            VALUE '** LOGIC SECURITY VIOLATION -'.
    96     12  SM-READ                         PIC X(6).
    97     12  FILLER                          PIC X(5)
    98            VALUE ' PGM='.
    99     12  SM-PGM                          PIC X(6).
   100     12  FILLER                          PIC X(5)
   101            VALUE ' OPR='.
   102     12  SM-PROCESSOR-ID                 PIC X(4).
   103     12  FILLER                          PIC X(6)
   104            VALUE ' TERM='.
   105     12  SM-TERMID                       PIC X(4).
   106     12  FILLER                          PIC XX   VALUE SPACE.
   107     12  SM-JUL-DATE                     PIC 9(5).
   108     12  FILLER                          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page   4
* EL130.cbl
   109     12  SM-TIME                         PIC 99.99.
   110
   111
   112*    COPY ELCSCRTY.
   113******************************************************************
   114*                                                                *
   115*                                                                *
   116*                            ELCSCRTY                            *
   117*                            VMOD=2.001                          *
   118*                                                                *
   119*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   120*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   121*        SAVED IN PI-SECURITY-ADDRESS.                           *
   122*                                                                *
   123******************************************************************
   124 01  SECURITY-CONTROL.
   125     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   126     12  FILLER                       PIC XX    VALUE 'SC'.
   127     12  SC-CREDIT-CODES.
   128         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   129             20  SC-CREDIT-DISPLAY    PIC X.
   130             20  SC-CREDIT-UPDATE     PIC X.
   131     12  SC-CLAIMS-CODES.
   132         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   133             20  SC-CLAIMS-DISPLAY    PIC X.
   134             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page   5
* EL130.cbl
   136 01  WS-DATE-AREA.
   137     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   138     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   139     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   140
   141 01  ws-dcc-error-line.
   142     05  filler occurs 15.
   143         10  ws-error-no        pic x(4).
   144 01  WS-CRI-SSN-WORK-AREA.
   145     05  WS-CRI-SOC-SEC-NO.
   146         10  WS-SS-REPT-CD       PIC X(5).
   147         10  WS-SS-LAST-NAME     PIC X(5).
   148         10  WS-SS-INITIAL       PIC X.
   149
   150     05  WS-CRI-REPORT-CODE.
   151         10  FILLER              PIC X(5).
   152         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   153
   154     05  WS-CRI-LAST-NAME.
   155         10  WS-CRI-NAME-MOVE    PIC X(5).
   156         10  FILLER              PIC X(10).
   157
   158 01  STANDARD-AREAS.
   159     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   160     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   161     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   162     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   163     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   164     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   165     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   166     12  PGM-NAME            PIC X(8).
   167     12  TIME-IN             PIC S9(7).
   168     12  TIME-OUT-R  REDEFINES TIME-IN.
   169         16  FILLER          PIC X.
   170         16  TIME-OUT        PIC 99V99.
   171         16  FILLER          PIC X(2).
   172     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   173     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   174     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   175     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   176     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   177     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   178     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   179     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   180     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   181     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   182     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   183     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   184     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   185     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   186     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   187     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   188     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   189     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   190     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   191     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   192     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   193     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page   6
* EL130.cbl
   194     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   195     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   196     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
   197     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   198     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   199     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   200     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   201     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   202     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   203     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   204     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   205     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   206     12  FILE-ID             PIC X(8).
   207     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   208     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   209     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   210     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   211     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   212     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   213     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   214     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   215     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   216
   217 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   218     12  M                   PIC S9(7)V99           VALUE ZEROS.
   219     12  L                   PIC S9(7)V99           VALUE ZEROS.
   220     12  N                   PIC S9(3)              VALUE ZEROS.
   221     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   222     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   223     12  I                   PIC S99V9(5)           VALUE ZEROS.
   224     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   225     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   226     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   227     12  R                   PIC S9(3)              VALUE ZEROS.
   228     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   229     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   230     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   231     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   232     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   233     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   234     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   235     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   236     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   237
   238 01  TERM-CALC-WORK-AREA.
   239     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   240     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   241     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   242     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   243     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   244     12  V-EXPONENTS.
   245        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   246     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   247
   248 01  MISC-WORK-AREAS.
   249     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   250     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   251     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page   7
* EL130.cbl
   252     12  QID.
   253         16  QID-TERM        PIC X(4).
   254         16  FILLER          PIC X(4)    VALUE '130A'.
   255     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   256     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   257     12  WS-GROUP-NO.
   258         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   259         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   260
   261     12  WS-RESPONSE         PIC S9(8)   COMP.
   262         88  WS-RESP-NORMAL              VALUE +00.
   263         88  WS-RESP-ERROR               VALUE +01.
   264         88  WS-RESP-NOTFND              VALUE +13.
   265         88  WS-RESP-DUPKEY              VALUE +15.
   266         88  WS-RESP-NOTOPEN             VALUE +19.
   267         88  WS-RESP-ENDFILE             VALUE +20.
   268
   269***************************************************************
   270*                                                             *
   271*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   272*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   273*    CHANGES WITH IN MAP EL130A.                              *
   274*                                                             *
   275***************************************************************
   276
   277     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   278     12  WS-SAVE-CLAIM-MASTER.
   279         16  FILLER                    PIC XX.
   280         16  WS-SAVE-CLAIM-KEY.
   281             20  WS-SAVE-COMPANY-CD    PIC X.
   282             20  WS-SAVE-CARRIER       PIC X.
   283             20  WS-SAVE-CLAIM-NO      PIC X(7).
   284             20  WS-SAVE-CERT-NO       PIC X(11).
   285         16  FILLER                    PIC X(328).
   286     12  SAVE-CURRENT-DATE         PIC XX.
   287     12  SAVE-CONTROL              PIC X(39).
   288     12  SAVE-ERACCT-KEY           PIC X(26).
   289     12  SAVE-COUNTER              PIC S9(8)   COMP.
   290     12  SAVE-METHOD               PIC X.
   291     12  SAVE-COMPANY-ID           PIC XXX.
   292     12  SAVE-COMPANY-CD           PIC X.
   293     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   294     12  SAVE-CREDIT-USER          PIC X.
   295     12  SAVE-CLAIM-USER           PIC X.
   296     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   297     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   298     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   299     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   300     12  SAVE-AH-OVERRIDE-L1       PIC X.
   301     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   302     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   303     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   304     12  FILLER                    PIC X.
   305*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   306     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   307     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   308     12  SAVE-EL127-TO-EL130-CNTRL.
   309         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page   8
* EL130.cbl
   310         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   311         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   312             20  SAVE-EL127-CARRIER  PIC X.
   313             20  SAVE-EL127-GROUPING PIC X(6).
   314             20  SAVE-EL127-STATE    PIC X(2).
   315             20  SAVE-EL127-ACCOUNT  PIC X(10).
   316             20  SAVE-EL127-CERT-NO  PIC X(11).
   317             20  SAVE-EL127-EFF-DT   PIC XX.
   318     12  SAVE-EL659-TO-EL130-CNTRL.
   319         16  SAVE-EL659-CARRIER    PIC X.
   320         16  SAVE-EL659-GROUPING   PIC X(6).
   321         16  SAVE-EL659-STATE      PIC XX.
   322         16  SAVE-EL659-ACCOUNT    PIC X(10).
   323     12  DIVIDE-QUOT               PIC 999.
   324     12  DIVIDE-REM                PIC 999.
   325     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   326     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   327     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   328     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   329     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   330     12  WS-RESERVE-CONTROLS       PIC X(9).
   331     12  WS-EXPENSE-CONTROLS       PIC X(7).
   332     12  WS-REIN-TABLE.
   333         16  WS-REIN-1             PIC X            VALUE SPACE.
   334         16  WS-REIN-2             PIC X            VALUE SPACE.
   335         16  WS-REIN-3             PIC X            VALUE SPACE.
   336     12  WS-BENE-CALC-METHOD       PIC X.
   337     12  ws-lf-joint-indicator     pic x.
   338     12  ws-ah-joint-indicator     pic x.
   339     12  WS-EARNINGS-CALC          PIC X.
   340     12  WS-LF-EARNINGS-CALC       PIC X.
   341         88 TEX-REG                VALUE '4'.
   342         88 NET-PAY                VALUE '5'.
   343     12  WS-AH-EARNINGS-CALC       PIC X.
   344     12  WS-SPECIAL-CALC-CD        PIC X(01).
   345     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   346     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   347     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   348     12  WS-ICD-CODE-1             PIC X(8).
   349     12  WS-ICD-CODE-2             PIC X(8).
   350     12  WS-CLAIM-NUMBER.
   351         16  WS-CN-PREFIX.
   352             20  WS-CN-PRF-A PIC X.
   353             20  WS-CN-PRF-B PIC X.
   354         16  WS-CN-NUMBER    PIC 9(5).
   355     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   356     12  WS-CLAIM-SEQU.
   357         16  FILLER          PIC X    VALUE '('.
   358         16  WS-CURRENT-SEQU PIC Z9.
   359         16  FILLER          PIC X(4) VALUE ' OF '.
   360         16  WS-OF-SEQU      PIC Z9.
   361         16  FILLER          PIC X    VALUE ')'.
   362     12  DATE-WORK.
   363       14  FILLER                PIC XX.
   364       14  DATE-MM               PIC XX.
   365       14  DATE-DD               PIC XX.
   366       14  DATE-YY               PIC XX.
   367     12  CURR-DATE REDEFINES DATE-WORK.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page   9
* EL130.cbl
   368         16  CURR-MM.
   369           18  CURR-M1           PIC 9.
   370           18  CURR-M2           PIC 9.
   371         16  FILLER              PIC X(5).
   372         16  CURR-YEAR           PIC 9.
   373     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   374     12  SUB                     PIC 99.
   375     12  MY-DATE.
   376         16  MY-MM               PIC XX.
   377         16  FILLER              PIC X VALUE '/'.
   378         16  MY-YY               PIC XX.
   379
   380     12  WS-EDIT-BEN-CODE        PIC XX.
   381         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   382                                          '90' THRU '99'.
   383
   384     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   385     12  WS-BEN-HOLD             PIC XX.
   386     12  WS-BEN-ALPHA-HOLD.
   387         15  WS-BEN-ALPHA-2      PIC XX.
   388         15  WS-BEN-ALPHA-1      PIC X.
   389     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   390     12  WS-REC-TYPE             PIC X.
   391     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   392     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   393     12  ARCH-NUMBER             PIC S9(8)   COMP.
   394     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   395         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   396         88  REIN-REC-FOUND                  VALUE 'Y'.
   397
   398     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   399     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   400
   401
   402 01  CSO-WORK-FIELDS.
   403     12  WS-BLANK            PIC X       VALUE ' '.
   404
   405     12  WS-MA-CONTROL-PRIMARY.
   406         16  WS-MA-COMPANY-CD        PIC  X.
   407         16  WS-MA-CARRIER           PIC  X.
   408         16  WS-MA-GROUPING          PIC  X(6).
   409         16  WS-MA-STATE             PIC  XX.
   410         16  WS-MA-ACCOUNT           PIC  X(10).
   411         16  WS-MA-CERT-EFF-DT       PIC  XX.
   412         16  WS-MA-CERT-NO.
   413             20  WS-MA-CERT-PRIME    PIC  X(10).
   414             20  WS-MA-CERT-SFX      PIC  X.
   415
   416     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   417     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   418     12  WS-SOC-SEC-NUMBER.
   419         16  WS-SOC-SEC-NO       PIC 9(9).
   420         16  WS-SOC-SEC-BLANK    PIC X(2).
   421     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   422         16  WS-SSN-1-3          PIC 9(3).
   423         16  WS-SSN-DASH1        PIC X(1).
   424         16  WS-SSN-4-5          PIC 9(2).
   425         16  WS-SSN-DASH2        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  10
* EL130.cbl
   426         16  WS-SSN-6-9          PIC 9(4).
   427
   428     12  WS-DIAG-VIN-MSG.
   429         16  FILLER          PIC X(11)
   430             VALUE 'VIN NUMBER '.
   431         16  WS-DIAG-VIN     PIC X(17).
   432
   433     12  WS-VERIFY-NOTE      PIC X(34)
   434         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   435
   436     12  WS-CAUSAL-NOTE      PIC X(40)
   437         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   438
   439     12  WS-VFY-SSN-NOTE     PIC X(25)
   440         VALUE 'SSN VERIFICATION REQUIRED'.
   441
   442 01  MAP-DATE-AREAS.
   443     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   444     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   445     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   446     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   447     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   448     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   449     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   450     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   451     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   452     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   453     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   454     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   455     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   456     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   457     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   458     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   459     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   460     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   461     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   462         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   463     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   464     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   465     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   466     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   467
   468 01  ACCESS-KEYS.
   469     12  ELACTQ-KEY.
   470         16  ELACTQ-COMPANY-CD       PIC X.
   471         16  ELACTQ-CARRIER          PIC X.
   472         16  ELACTQ-CLAIM-NO         PIC X(7).
   473         16  ELACTQ-CERT-NO          PIC X(11).
   474     12  ELMSTR-KEY.
   475         16  MSTR-COMP-CD            PIC X.
   476         16  MSTR-CARRIER            PIC X.
   477         16  MSTR-CLAIM-NO           PIC X(7).
   478         16  MSTR-CERT-NO.
   479             20  MSTR-CERT-NO-PRIME  PIC X(10).
   480             20  MSTR-CERT-NO-SUFX   PIC X.
   481     12  SAVE-ELMSTR-KEY.
   482         16  SAVE-COMP-CD            PIC X.
   483         16  SAVE-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  11
* EL130.cbl
   484         16  SAVE-CLAIM-NO           PIC X(7).
   485         16  SAVE-CERT-NO.
   486             20  SAVE-CERT-NO-PRIME  PIC X(10).
   487             20  SAVE-CERT-NO-SUFX   PIC X.
   488     12  ELMSTR5-KEY.
   489         16  MSTR5-COMP-CD           PIC X.
   490         16  MSTR5-CERT-NO.
   491             20  MSTR5-CERT-NO-PRIME PIC X(10).
   492             20  MSTR5-CERT-NO-SUFX  PIC X.
   493     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   494         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   495         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   496         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   497     12  ELCNTL-KEY.
   498         16  CNTL-COMP-ID    PIC X(3).
   499         16  CNTL-REC-TYPE   PIC X.
   500         16  CNTL-ACCESS.
   501             20  FILLER      PIC XX.
   502             20  CNTL-BENEFIT.
   503                 24  FILLER  PIC X.
   504                 24  CNTL-CARRIER PIC X.
   505         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   506     12  ELCERT-KEY.
   507         16  CERT-COMP-CD    PIC X.
   508         16  CERT-CARRIER    PIC X.
   509         16  CERT-GROUPING   PIC X(6).
   510         16  CERT-STATE      PIC X(2).
   511         16  CERT-ACCOUNT.
   512             20  CERT-ACCOUNT-PREFIX PIC X(4).
   513             20  CERT-ACCOUNT-PRIME  PIC X(6).
   514         16  CERT-EFF-DT     PIC XX.
   515         16  CERT-CERT-NO.
   516             20  CERT-CERT-NO-PRIME  PIC X(10).
   517             20  CERT-CERT-NO-SUFX   PIC X.
   518     12  ELCERT-KEY-5.
   519         16  CERT-COMP-CD-5      PIC X.
   520         16  CERT-CERT-5.
   521             20  CERT-CERT-5-PRIME   PIC X(10).
   522             20  CERT-CERT-5-SUFX    PIC X.
   523     12  ERACCT-KEY.
   524         16  ACCT-COMP-CD    PIC X.
   525         16  ACCT-CARRIER    PIC X.
   526         16  ACCT-GROUPING   PIC X(6).
   527         16  ACCT-STATE      PIC X(2).
   528         16  ACCT-ACCOUNT    PIC X(10).
   529         16  ACCT-EXP-DT     PIC XX.
   530     12  ELTRLR-KEY.
   531         16  TRLR-COMP-CD    PIC X.
   532         16  TRLR-CARRIER    PIC X.
   533         16  TRLR-CLAIM-NO   PIC X(7).
   534         16  TRLR-CERT-NO.
   535             20  TRLR-CERT-NO-PRIME  PIC X(10).
   536             20  TRLR-CERT-NO-SUFX   PIC X.
   537         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   538         16  TRLR-TYPE       PIC X.
   539     12  ELBENE-KEY.
   540         16  BENE-COMP-CD    PIC X.
   541         16  BENE-RCD-TYPE   PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  12
* EL130.cbl
   542         16  BENE-CODE       PIC X(10).
   543     12  ERREIN-KEY.
   544         16  REIN-COMP-CD        PIC X(01).
   545         16  REIN-TYPE           PIC X(01).
   546         16  REIN-TABLE-CO.
   547             20  REIN-CODE-1     PIC X(01).
   548             20  REIN-CODE-2     PIC X(01).
   549             20  REIN-CODE-3     PIC X(01).
   550         16  FILLER              PIC X(03).
   551     12  ELCRTT-KEY.
   552         16  CTRLR-COMP-CD       PIC X.
   553         16  CTRLR-CARRIER       PIC X.
   554         16  CTRLR-GROUPING      PIC X(6).
   555         16  CTRLR-STATE         PIC X(2).
   556         16  CTRLR-ACCOUNT       PIC X(10).
   557         16  CTRLR-EFF-DT        PIC XX.
   558         16  CTRLR-CERT-NO       PIC X(11).
   559         16  CTRLR-REC-TYPE      PIC X.
   560 01  ws-acct-found-sw            pic x value ' '.
   561     88  acct-found                value 'Y'.
   562 01  ERPDEF-KEY-SAVE             PIC X(18).
   563 01  ERPDEF-KEY.
   564     12  ERPDEF-COMPANY-CD       PIC X.
   565     12  ERPDEF-STATE            PIC XX.
   566     12  ERPDEF-PROD-CD          PIC XXX.
   567     12  F                       PIC X(7).
   568     12  ERPDEF-BEN-TYPE         PIC X.
   569     12  ERPDEF-BEN-CODE         PIC XX.
   570     12  ERPDEF-EXP-DT           PIC XX.
   571 01  ERROR-MESSAGES.
   572     12  ER-0000                 PIC X(4)  VALUE '0000'.
   573     12  ER-0004                 PIC X(4)  VALUE '0004'.
   574     12  ER-0019                 PIC X(4)  VALUE '0019'.
   575     12  ER-0023                 PIC X(4)  VALUE '0023'.
   576     12  ER-0029                 PIC X(4)  VALUE '0029'.
   577     12  ER-0033                 PIC X(4)  VALUE '0033'.
   578     12  ER-0068                 PIC X(4)  VALUE '0068'.
   579     12  ER-0070                 PIC X(4)  VALUE '0070'.
   580     12  ER-0194                 PIC X(4)  VALUE '0194'.
   581     12  ER-0202                 PIC X(4)  VALUE '0202'.
   582     12  ER-0203                 PIC X(4)  VALUE '0203'.
   583     12  ER-0204                 PIC X(4)  VALUE '0204'.
   584     12  ER-0205                 PIC X(4)  VALUE '0205'.
   585     12  ER-0206                 PIC X(4)  VALUE '0206'.
   586     12  ER-0207                 PIC X(4)  VALUE '0207'.
   587     12  ER-0213                 PIC X(4)  VALUE '0213'.
   588     12  ER-0214                 PIC X(4)  VALUE '0214'.
   589     12  ER-0217                 PIC X(4)  VALUE '0217'.
   590     12  ER-0219                 PIC X(4)  VALUE '0219'.
   591     12  ER-0220                 PIC X(4)  VALUE '0220'.
   592     12  ER-0221                 PIC X(4)  VALUE '0221'.
   593     12  ER-0222                 PIC X(4)  VALUE '0222'.
   594     12  ER-0223                 PIC X(4)  VALUE '0223'.
   595     12  ER-0224                 PIC X(4)  VALUE '0224'.
   596     12  ER-0225                 PIC X(4)  VALUE '0225'.
   597     12  ER-0226                 PIC X(4)  VALUE '0226'.
   598     12  ER-0227                 PIC X(4)  VALUE '0227'.
   599     12  ER-0229                 PIC X(4)  VALUE '0229'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  13
* EL130.cbl
   600     12  ER-0230                 PIC X(4)  VALUE '0230'.
   601     12  ER-0231                 PIC X(4)  VALUE '0231'.
   602     12  ER-0232                 PIC X(4)  VALUE '0232'.
   603     12  ER-0233                 PIC X(4)  VALUE '0233'.
   604     12  ER-0234                 PIC X(4)  VALUE '0234'.
   605     12  ER-0235                 PIC X(4)  VALUE '0235'.
   606     12  ER-0236                 PIC X(4)  VALUE '0236'.
   607     12  ER-0237                 PIC X(4)  VALUE '0237'.
   608     12  ER-0238                 PIC X(4)  VALUE '0238'.
   609     12  ER-0239                 PIC X(4)  VALUE '0239'.
   610     12  ER-0240                 PIC X(4)  VALUE '0240'.
   611     12  ER-0241                 PIC X(4)  VALUE '0241'.
   612     12  ER-0243                 PIC X(4)  VALUE '0243'.
   613     12  ER-0244                 PIC X(4)  VALUE '0244'.
   614     12  ER-0245                 PIC X(4)  VALUE '0245'.
   615     12  ER-0246                 PIC X(4)  VALUE '0246'.
   616     12  ER-0247                 PIC X(4)  VALUE '0247'.
   617     12  ER-0248                 PIC X(4)  VALUE '0248'.
   618     12  ER-0250                 PIC X(4)  VALUE '0250'.
   619     12  ER-0251                 PIC X(4)  VALUE '0251'.
   620     12  ER-0252                 PIC X(4)  VALUE '0252'.
   621     12  ER-0253                 PIC X(4)  VALUE '0253'.
   622     12  ER-0254                 PIC X(4)  VALUE '0254'.
   623     12  ER-0257                 PIC X(4)  VALUE '0257'.
   624     12  ER-0258                 PIC X(4)  VALUE '0258'.
   625     12  ER-0260                 PIC X(4)  VALUE '0260'.
   626     12  ER-0261                 PIC X(4)  VALUE '0261'.
   627     12  ER-0263                 PIC X(4)  VALUE '0263'.
   628     12  ER-0264                 PIC X(4)  VALUE '0264'.
   629     12  ER-0265                 PIC X(4)  VALUE '0265'.
   630     12  ER-0266                 PIC X(4)  VALUE '0266'.
   631     12  ER-0267                 PIC X(4)  VALUE '0267'.
   632     12  ER-0334                 PIC X(4)  VALUE '0334'.
   633     12  ER-0337                 PIC X(4)  VALUE '0337'.
   634     12  ER-0412                 PIC X(4)  VALUE '0412'.
   635     12  ER-0413                 PIC X(4)  VALUE '0413'.
   636     12  ER-0428                 PIC X(4)  VALUE '0428'.
   637     12  ER-0429                 PIC X(4)  VALUE '0429'.
   638     12  ER-0430                 PIC X(4)  VALUE '0430'.
   639     12  ER-0433                 PIC X(4)  VALUE '0433'.
   640     12  ER-0434                 PIC X(4)  VALUE '0434'.
   641     12  ER-0458                 PIC X(4)  VALUE '0458'.
   642     12  ER-0489                 PIC X(4)  VALUE '0489'.
   643     12  ER-0509                 PIC X(4)  VALUE '0509'.
   644     12  ER-0510                 PIC X(4)  VALUE '0510'.
   645     12  ER-0511                 PIC X(4)  VALUE '0511'.
   646     12  ER-0512                 PIC X(4)  VALUE '0512'.
   647     12  ER-0516                 PIC X(4)  VALUE '0516'.
   648     12  ER-0517                 PIC X(4)  VALUE '0517'.
   649     12  ER-0518                 PIC X(4)  VALUE '0518'.
   650     12  ER-0519                 PIC X(4)  VALUE '0519'.
   651     12  ER-0520                 PIC X(4)  VALUE '0520'.
   652     12  ER-0521                 PIC X(4)  VALUE '0521'.
   653     12  ER-0522                 PIC X(4)  VALUE '0522'.
   654     12  ER-0523                 PIC X(4)  VALUE '0523'.
   655     12  ER-0544                 PIC X(4)  VALUE '0544'.
   656     12  ER-0546                 PIC X(4)  VALUE '0546'.
   657     12  ER-0558                 PIC X(4)  VALUE '0558'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  14
* EL130.cbl
   658     12  ER-0560                 PIC X(4)  VALUE '0560'.
   659     12  ER-0562                 PIC X(4)  VALUE '0562'.
   660     12  ER-0565                 PIC X(4)  VALUE '0565'.
   661     12  ER-0569                 PIC X(4)  VALUE '0569'.
   662     12  ER-0693                 PIC X(4)  VALUE '0693'.
   663     12  ER-0715                 PIC X(4)  VALUE '0715'.
   664     12  ER-0840                 PIC X(4)  VALUE '0840'.
   665     12  ER-0841                 PIC X(4)  VALUE '0841'.
   666     12  ER-0842                 PIC X(4)  VALUE '0842'.
   667     12  ER-0843                 PIC X(4)  VALUE '0843'.
   668     12  ER-0878                 PIC X(4)  VALUE '0878'.
   669     12  ER-0887                 PIC X(4)  VALUE '0887'.
   670     12  ER-0992                 PIC X(4)  VALUE '0992'.
   671     12  ER-1651                 PIC X(4)  VALUE '1651'.
   672     12  ER-1652                 PIC X(4)  VALUE '1652'.
   673     12  ER-1653                 PIC X(4)  VALUE '1653'.
   674     12  ER-1654                 PIC X(4)  VALUE '1654'.
   675     12  ER-1655                 PIC X(4)  VALUE '1655'.
   676     12  er-1659                 pic x(4)  value '1659'.
   677     12  er-1660                 pic x(4)  value '1660'.
   678     12  er-1661                 pic x(4)  value '1661'.
   679     12  er-1671                 pic x(4)  value '1671'.
   680     12  er-1672                 pic x(4)  value '1672'.
   681     12  er-1673                 pic x(4)  value '1673'.
   682     12  er-1675                 pic x(4)  value '1675'.
   683     12  er-1676                 pic x(4)  value '1676'.
   684     12  ER-1677                 PIC X(4)  VALUE '1677'.
   685     12  ER-1679                 PIC X(4)  VALUE '1679'.
   686     12  ER-2280                 PIC X(4)  VALUE '2280'.
   687     12  ER-2370                 PIC X(4)  VALUE '2370'.
   688     12  ER-2371                 PIC X(4)  VALUE '2371'.
   689     12  ER-2378                 PIC X(4)  VALUE '2378'.
   690     12  ER-2380                 PIC X(4)  VALUE '2380'.
   691     12  ER-2566                 PIC X(4)  VALUE '2566'.
   692     12  ER-2848                 PIC X(4)  VALUE '2848'.
   693     12  ER-3548                 PIC X(4)  VALUE '3548'.
   694     12  ER-7008                 PIC X(4)  VALUE '7008'.
   695     12  ER-7319                 PIC X(4)  VALUE '7319'.
   696     12  ER-7321                 PIC X(4)  VALUE '7321'.
   697     12  ER-7352                 PIC X(4)  VALUE '7352'.
   698     12  ER-7353                 PIC X(4)  VALUE '7353'.
   699     12  ER-7572                 PIC X(4)  VALUE '7572'.
   700     12  ER-7575                 PIC X(4)  VALUE '7575'.
   701     12  ER-7577                 PIC X(4)  VALUE '7577'.
   702     12  ER-7582                 PIC X(4)  VALUE '7582'.
   703     12  ER-7634                 PIC X(4)  VALUE '7634'.
   704     12  ER-7635                 PIC X(4)  VALUE '7635'.
   705     12  ER-7636                 PIC X(4)  VALUE '7636'.
   706     12  ER-7637                 PIC X(4)  VALUE '7637'.
   707     12  ER-7638                 PIC X(4)  VALUE '7638'.
   708     12  ER-7639                 PIC X(4)  VALUE '7639'.
   709     12  ER-7640                 PIC X(4)  VALUE '7640'.
   710     12  ER-7641                 PIC X(4)  VALUE '7641'.
   711     12  ER-7642                 PIC X(4)  VALUE '7642'.
   712     12  ER-7643                 PIC X(4)  VALUE '7643'.
   713     12  ER-7646                 PIC X(4)  VALUE '7646'.
   714     12  ER-7647                 PIC X(4)  VALUE '7647'.
   715     12  ER-7648                 PIC X(4)  VALUE '7648'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  15
* EL130.cbl
   716     12  ER-7649                 PIC X(4)  VALUE '7649'.
   717     12  ER-7651                 PIC X(4)  VALUE '7651'.
   718     12  ER-7670                 PIC X(4)  VALUE '7670'.
   719     12  ER-7671                 PIC X(4)  VALUE '7671'.
   720     12  ER-7686                 PIC X(4)  VALUE '7686'.
   721     12  ER-7688                 PIC X(4)  VALUE '7688'.
   722     12  ER-7689                 PIC X(4)  VALUE '7689'.
   723     12  ER-7691                 PIC X(4)  VALUE '7691'.
   724*    COPY ERCPDEF.
   725******************************************************************
   726*                                                                *
   727*                                                                *
   728*                            ERCPDEF.                            *
   729*                                                                *
   730*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   731*                                                                *
   732*    FILE TYPE = VSAM,KSDS                                       *
   733*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   734*                                                                *
   735*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   736*                                                                *
   737*    LOG = YES                                                   *
   738*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   739******************************************************************
   740*                   C H A N G E   L O G
   741*
   742* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   743*-----------------------------------------------------------------
   744*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   745* EFFECTIVE    NUMBER
   746*-----------------------------------------------------------------
   747* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   748* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   749* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   750******************************************************************
   751 01  PRODUCT-MASTER.
   752    12  PD-RECORD-ID                 PIC X(02).
   753        88  VALID-PD-ID                  VALUE 'PD'.
   754    12  PD-CONTROL-PRIMARY.
   755        16  PD-COMPANY-CD            PIC X.
   756        16  PD-STATE                 PIC XX.
   757        16  PD-PRODUCT-CD            PIC XXX.
   758        16  PD-FILLER                PIC X(7).
   759        16  PD-BEN-TYPE              PIC X.
   760        16  PD-BEN-CODE              PIC XX.
   761        16  PD-PROD-EXP-DT           PIC XX.
   762    12  FILLER                       PIC X(50).
   763    12  PD-PRODUCT-DATA OCCURS 8.
   764        16  PD-PROD-CODE             PIC X.
   765            88  PD-PROD-LIFE           VALUE 'L'.
   766            88  PD-PROD-PROP           VALUE 'P'.
   767            88  PD-PROD-AH             VALUE 'A'.
   768            88  PD-PROD-IU             VALUE 'I'.
   769            88  PD-PROD-GAP            VALUE 'G'.
   770            88  PD-PROD-FAML           VALUE 'F'.
   771        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   772        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   773        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  16
* EL130.cbl
   774        16  PD-MAX-TERM              PIC S999        COMP-3.
   775        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   776        16  FILLER                   PIC X.
   777        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   778        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   779        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   780        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   781        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   782        16  PD-REC-CRIT-PERIOD       PIC 99.
   783        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   784            20  PD-RECURRING-YN      PIC X.
   785            20  FILLER               PIC X.
   786        16  PD-RTW-MOS               PIC 99.
   787        16  PD-MAX-EXTENSION         PIC 99.
   788        16  pd-ben-pct               pic sv999 comp-3.
   789*       16  FILLER                   PIC XX.
   790    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   791    12  PD-TERM-LIMITS OCCURS 15.
   792        16  PD-LOW-TERM              PIC S999        COMP-3.
   793        16  PD-HI-TERM               PIC S999        COMP-3.
   794*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   795    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   796        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   797        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   798    12  PD-EARN-FACTORS.
   799        16  FILLER OCCURS 15.
   800            20  FILLER OCCURS 15.
   801                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   802    12  PD-PRODUCT-DESC              PIC X(80).
   803    12  PD-TRUNCATED                 PIC X.
   804    12  FILLER                       PIC X(59).
   805    12  PD-MAINT-INFORMATION.
   806        16  PD-LAST-MAINT-DT         PIC X(02).
   807        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   808        16  PD-LAST-MAINT-BY         PIC X(04).
   809*    COPY ELCLNKLT.
   810******************************************************************
   811*                                                                *
   812*                                                                *
   813*                           ELCLNKLT                             *
   814*                            VMOD=2.003                          *
   815*                                                                *
   816*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   817*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   818*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   819*                                                                *
   820*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   821*   COMPLETING THE REQUIRED FIELDS.                              *
   822*                                                                *
   823*   THE CALLING PROGRAM SHOULD CHECK:                            *
   824*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   825*                              9999 INDICATES AN UNKNOWN ABEND   *
   826*                                   WAS DETECTED.                *
   827*                              ALL OTHER VALUES ARE NORMAL ERROR *
   828*                              CODES FOUND IN THE ERROR FILE.    *
   829******************************************************************
   830 01  W-1523-LINKDATA.
   831     12  W-1523-COMMON-PI-DATA.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  17
* EL130.cbl
   832         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   833         16  FILLER              PIC  X(67).
   834         16  W-1523-COMPANY-CD   PIC  X(01).
   835         16  FILLER              PIC  X(10).
   836         16  W-1523-CONTROL-IN-PROGRESS.
   837             20  W-1523-CARRIER  PIC  X(01).
   838             20  W-1523-GROUPING PIC  X(06).
   839             20  W-1523-STATE    PIC  X(02).
   840             20  W-1523-ACCOUNT  PIC  X(10).
   841             20  W-1523-CLAIM-CERT-GRP.
   842                 24  W-1523-CLAIM-NO
   843                                 PIC  X(07).
   844                 24  W-1523-CERT-NO.
   845                     28  W-1523-CERT-PRIME
   846                                 PIC  X(10).
   847                     28  W-1523-CERT-SFX
   848                                 PIC  X(01).
   849                 24  W-1523-CERT-EFF-DT
   850                                 PIC  X(02).
   851         16  FILLER              PIC X(265).
   852
   853     12  W-1523-WORK-AREA.
   854         16  W-1523-FORM-NUMBER  PIC  X(04).
   855         16  W-1523-NUMBER-COPIES
   856                                 PIC  9(01).
   857         16  W-1523-ADDR-TYPE    PIC  X(02).
   858         16  W-1523-FOLLOW-UP-DATE
   859                                 PIC  X(02).
   860         16  W-1523-RESEND-DATE  PIC  X(02).
   861         16  W-1523-ERROR-CODE   PIC  9(04).
   862             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   863             88  W-1523-FATAL-ERROR
   864                                    VALUES  0006 0013 0042
   865                                            0154 0168 0169
   866                                            0176 9999 0172
   867                                            0179 0186 0281
   868                                            0332 2055 3697
   869                                            3698 3699 3770
   870                                            3771 3772 7675
   871                                            9106 9808 9883
   872                                            9887.
   873             88  W-1523-STOP-ERRORS
   874                                    VALUES  0013 0042 0154
   875                                            0168 0169 0172
   876                                            0281 0332 2055
   877                                            3698 3699 7675
   878                                            9106 9808 9883
   879                                            9999.
   880         16  W-1523-REASON       PIC  X(70).
   881         16  W-1523-ARCHIVE-NUMBER
   882                                 PIC  9(08).
   883     12  W-1523-POINTER-AREA.
   884         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   885         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   886         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   887         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   888         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  18
* EL130.cbl
   890*    COPY ELCINTF.
   891******************************************************************
   892*                                                                *
   893*                                                                *
   894*                            ELCINTF.                            *
   895*                            VMOD=2.017                          *
   896*                                                                *
   897*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   898*                                                                *
   899*       LENGTH = 1024                                            *
   900*                                                                *
   901******************************************************************
   902*                   C H A N G E   L O G
   903*
   904* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   905*-----------------------------------------------------------------
   906*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   907* EFFECTIVE    NUMBER
   908*-----------------------------------------------------------------
   909* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   910******************************************************************
   911 01  PROGRAM-INTERFACE-BLOCK.
   912     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   913     12  PI-CALLING-PROGRAM              PIC X(8).
   914     12  PI-SAVED-PROGRAM-1              PIC X(8).
   915     12  PI-SAVED-PROGRAM-2              PIC X(8).
   916     12  PI-SAVED-PROGRAM-3              PIC X(8).
   917     12  PI-SAVED-PROGRAM-4              PIC X(8).
   918     12  PI-SAVED-PROGRAM-5              PIC X(8).
   919     12  PI-SAVED-PROGRAM-6              PIC X(8).
   920     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   921     12  PI-COMPANY-ID                   PIC XXX.
   922     12  PI-COMPANY-CD                   PIC X.
   923
   924     12  PI-COMPANY-PASSWORD             PIC X(8).
   925
   926     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   927
   928     12  PI-CONTROL-IN-PROGRESS.
   929         16  PI-CARRIER                  PIC X.
   930         16  PI-GROUPING                 PIC X(6).
   931         16  PI-STATE                    PIC XX.
   932         16  PI-ACCOUNT                  PIC X(10).
   933         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   934                                         PIC X(10).
   935         16  PI-CLAIM-CERT-GRP.
   936             20  PI-CLAIM-NO             PIC X(7).
   937             20  PI-CERT-NO.
   938                 25  PI-CERT-PRIME       PIC X(10).
   939                 25  PI-CERT-SFX         PIC X.
   940             20  PI-CERT-EFF-DT          PIC XX.
   941         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   942             20  PI-PLAN-CODE            PIC X(2).
   943             20  PI-REVISION-NUMBER      PIC X(3).
   944             20  PI-PLAN-EFF-DT          PIC X(2).
   945             20  PI-PLAN-EXP-DT          PIC X(2).
   946             20  FILLER                  PIC X(11).
   947         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  19
* EL130.cbl
   948             20  PI-OE-REFERENCE-1.
   949                 25  PI-OE-REF-1-PRIME   PIC X(18).
   950                 25  PI-OE-REF-1-SUFF    PIC XX.
   951
   952     12  PI-SESSION-IN-PROGRESS          PIC X.
   953         88  CLAIM-SESSION                   VALUE '1'.
   954         88  CREDIT-SESSION                  VALUE '2'.
   955         88  WARRANTY-SESSION                VALUE '3'.
   956         88  MORTGAGE-SESSION                VALUE '4'.
   957         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   958
   959
   960*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   961
   962     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   963     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   964
   965     12  PI-CREDIT-USER                  PIC X.
   966         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   967         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   968
   969     12  PI-CLAIM-USER                   PIC X.
   970         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   971         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   972
   973     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   974         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   975         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   976         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   977         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   978         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   979
   980     12  PI-PROCESSOR-ID                 PIC X(4).
   981
   982     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   983
   984     12  PI-MEMBER-CAPTION               PIC X(10).
   985
   986     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   987         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   988
   989     12  PI-LIFE-OVERRIDE-L1             PIC X.
   990     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   991     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   992     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   993
   994     12  PI-AH-OVERRIDE-L1               PIC X.
   995     12  PI-AH-OVERRIDE-L2               PIC XX.
   996     12  PI-AH-OVERRIDE-L6               PIC X(6).
   997     12  PI-AH-OVERRIDE-L12              PIC X(12).
   998
   999     12  PI-NEW-SYSTEM                   PIC X(2).
  1000
  1001     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1002     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1003         88  PI-USES-PAID-TO                 VALUE '1'.
  1004     12  PI-CRDTCRD-SYSTEM.
  1005         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  20
* EL130.cbl
  1006             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1007             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1008         16  PI-CC-MONTH-END-DT          PIC XX.
  1009     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1010
  1011     12  PI-OE-REFERENCE-2.
  1012         16  PI-OE-REF-2-PRIME           PIC X(10).
  1013         16  PI-OE-REF-2-SUFF            PIC X.
  1014
  1015     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1016
  1017     12  PI-LANGUAGE-TYPE                PIC X.
  1018             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1019             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1020             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1021
  1022     12  PI-POLICY-LINKAGE-IND           PIC X.
  1023         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1024         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1025                                                   LOW-VALUES.
  1026
  1027     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1028     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1029         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1030         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1031
  1032     12  PI-PROCESSOR-CSR-IND            PIC X.
  1033         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1034         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1035
  1036     12  FILLER                          PIC X(3).
  1037
  1038     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1039
  1040     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1041         PI-SYSTEM-LEVEL.
  1042
  1043         16  PI-ENTRY-CODES.
  1044             20  PI-ENTRY-CD-1           PIC X.
  1045             20  PI-ENTRY-CD-2           PIC X.
  1046
  1047         16  PI-RETURN-CODES.
  1048             20  PI-RETURN-CD-1          PIC X.
  1049             20  PI-RETURN-CD-2          PIC X.
  1050
  1051         16  PI-UPDATE-STATUS-SAVE.
  1052             20  PI-UPDATE-BY            PIC X(4).
  1053             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1054
  1055         16  PI-LOWER-CASE-LETTERS       PIC X.
  1056             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1057
  1058*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1059*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1060*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1061
  1062         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1063             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  21
* EL130.cbl
  1064             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1065             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1066             88  ACCNT-CNTL                  VALUE '3'.
  1067             88  CARR-ACCNT-CNTL             VALUE '4'.
  1068
  1069         16  PI-PROCESSOR-CAP-LIST.
  1070             20  PI-SYSTEM-CONTROLS.
  1071                24 PI-SYSTEM-DISPLAY     PIC X.
  1072                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1073                24 PI-SYSTEM-MODIFY      PIC X.
  1074                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1075             20  FILLER                  PIC XX.
  1076             20  PI-DISPLAY-CAP          PIC X.
  1077                 88  DISPLAY-CAP             VALUE 'Y'.
  1078             20  PI-MODIFY-CAP           PIC X.
  1079                 88  MODIFY-CAP              VALUE 'Y'.
  1080             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1081                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1082             20  PI-FORCE-CAP            PIC X.
  1083                 88  FORCE-CAP               VALUE 'Y'.
  1084
  1085         16  PI-PROGRAM-CONTROLS.
  1086             20  PI-PGM-PRINT-OPT        PIC X.
  1087             20  PI-PGM-FORMAT-OPT       PIC X.
  1088             20  PI-PGM-PROCESS-OPT      PIC X.
  1089             20  PI-PGM-TOTALS-OPT       PIC X.
  1090
  1091         16  PI-HELP-INTERFACE.
  1092             20  PI-LAST-ERROR-NO        PIC X(4).
  1093             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1094
  1095         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1096             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1097
  1098         16  PI-CR-CONTROL-IN-PROGRESS.
  1099             20  PI-CR-CARRIER           PIC X.
  1100             20  PI-CR-GROUPING          PIC X(6).
  1101             20  PI-CR-STATE             PIC XX.
  1102             20  PI-CR-ACCOUNT           PIC X(10).
  1103             20  PI-CR-FIN-RESP          PIC X(10).
  1104             20  PI-CR-TYPE              PIC X.
  1105
  1106         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1107
  1108         16  PI-CR-MONTH-END-DT          PIC XX.
  1109
  1110         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1111             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1112             88  PI-ZERO-CARRIER             VALUE '1'.
  1113             88  PI-ZERO-GROUPING            VALUE '2'.
  1114             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1115
  1116         16  PI-CARRIER-SECURITY         PIC X.
  1117             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1118
  1119         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1120             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1121             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  22
* EL130.cbl
  1122
  1123         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1124             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1125                                         INDEXED BY PI-ACCESS-NDX
  1126                                         PIC X.
  1127
  1128         16  PI-GA-BILLING-CONTROL       PIC X.
  1129             88  PI-GA-BILLING               VALUE '1'.
  1130
  1131         16  PI-MAIL-PROCESSING          PIC X.
  1132             88  PI-MAIL-YES                 VALUE 'Y'.
  1133
  1134         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1135
  1136         16  PI-AR-SYSTEM.
  1137             20  PI-AR-PROCESSING-CNTL   PIC X.
  1138                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1139             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1140             20  PI-AR-MONTH-END-DT      PIC XX.
  1141
  1142         16  PI-MP-SYSTEM.
  1143             20  PI-MORTGAGE-USER            PIC X.
  1144                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1145                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1146             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1147                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1148                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1149                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1150                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1151                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1152             20  PI-MP-MONTH-END-DT          PIC XX.
  1153             20  PI-MP-REFERENCE-NO.
  1154                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1155                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1156
  1157         16  PI-LABEL-CONTROL            PIC X(01).
  1158             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1159             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1160
  1161         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1162             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1163
  1164         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1165             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1166             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1167
  1168         16  FILLER                      PIC X(14).
  1169
  1170     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1171******************************************************************
  1172     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1173         16  PI-MSTR-DT               PIC XX.
  1174         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1175         16  PI-TRLR-DT               PIC XX.
  1176         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1177         16  PI-LAST-CLAIM            PIC X(7).
  1178         16  PI-LAST-CARR             PIC X.
  1179         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  23
* EL130.cbl
  1180             20  PI-LAST-CERT-PRIME   PIC X(10).
  1181             20  PI-LAST-CERT-SUFX    PIC X.
  1182         16  PI-LAST-CLAIM-TYPE       PIC X.
  1183         16  PI-CURSOR                PIC S9(4)   COMP.
  1184         16  PI-SAVE-CERT.
  1185             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1186             20  PI-SAVE-CERT-SUFX    PIC X.
  1187         16  PI-SAVE-EFFDT            PIC X(2).
  1188         16  PI-SAVE-ACCOUNT          PIC X(10).
  1189         16  PI-INCURR-SW             PIC X.
  1190         16  PI-PRT-OPT               PIC X.
  1191         16  PI-ALT-PRT               PIC X(4).
  1192         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1193             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1194         16  FILLER                   PIC X(272).
  1195         16  PI-EL127-TO-EL130-CNTRL.
  1196             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1197             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1198             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1199                 24  PI-EL127-CARRIER        PIC X.
  1200                 24  PI-EL127-GROUPING       PIC X(6).
  1201                 24  PI-EL127-STATE          PIC X(2).
  1202                 24  PI-EL127-ACCOUNT        PIC X(10).
  1203                 24  PI-EL127-CERT-NO.
  1204                     28  PI-EL127-CERT-PRIME PIC X(10).
  1205                     28  PI-EL127-CERT-SUFX  PIC X.
  1206                 24  PI-EL127-EFF-DT         PIC XX.
  1207*        16  FILLER                          PIC X(50).
  1208         16  FILLER                          PIC X(31).
  1209         16  PI-EL659-TO-EL130-CNTRL.
  1210             20  PI-EL659-CARRIER            PIC X.
  1211             20  PI-EL659-GROUPING           PIC X(6).
  1212             20  PI-EL659-STATE              PIC XX.
  1213             20  PI-EL659-ACCOUNT            PIC X(10).
  1214
  1215         16  FILLER                          PIC X(19).
  1216
  1217         16  PI-SAVE-INCUR-DT                PIC X(02).
  1218         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1219*         16  FILLER                          PIC X(65).
  1220         16  PI-ST-VFY-2ND-BENE              PIC X.
  1221         16  PI-ST-CAUSAL-STATE              PIC X.
  1222         16  pi-dcc-max-benefits             pic s999 comp-3.
  1223         16  pi-dcc-max-amt                  pic s9(9)v99 comp-3.
  1224         16  pi-emi-sub                      pic 99.
  1225         16  FILLER                          PIC X(53).
  1226
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  24
* EL130.cbl
  1228*    COPY EL130S.
  1229 01  EL130AI.
  1230     05  FILLER            PIC  X(0012).
  1231*    -------------------------------
  1232     05  RUNDTEL PIC S9(0004) COMP.
  1233     05  RUNDTEF PIC  X(0001).
  1234     05  FILLER REDEFINES RUNDTEF.
  1235         10  RUNDTEA PIC  X(0001).
  1236     05  RUNDTEI PIC  X(0008).
  1237*    -------------------------------
  1238     05  RUNTIMEL PIC S9(0004) COMP.
  1239     05  RUNTIMEF PIC  X(0001).
  1240     05  FILLER REDEFINES RUNTIMEF.
  1241         10  RUNTIMEA PIC  X(0001).
  1242     05  RUNTIMEI PIC  X(0005).
  1243*    -------------------------------
  1244     05  COMPL PIC S9(0004) COMP.
  1245     05  COMPF PIC  X(0001).
  1246     05  FILLER REDEFINES COMPF.
  1247         10  COMPA PIC  X(0001).
  1248     05  COMPI PIC  X(0003).
  1249*    -------------------------------
  1250     05  SEQUL PIC S9(0004) COMP.
  1251     05  SEQUF PIC  X(0001).
  1252     05  FILLER REDEFINES SEQUF.
  1253         10  SEQUA PIC  X(0001).
  1254     05  SEQUI PIC  X(0010).
  1255*    -------------------------------
  1256     05  MAINTL PIC S9(0004) COMP.
  1257     05  MAINTF PIC  X(0001).
  1258     05  FILLER REDEFINES MAINTF.
  1259         10  MAINTA PIC  X(0001).
  1260     05  MAINTI PIC  X(0001).
  1261*    -------------------------------
  1262     05  CLMNOL PIC S9(0004) COMP.
  1263     05  CLMNOF PIC  X(0001).
  1264     05  FILLER REDEFINES CLMNOF.
  1265         10  CLMNOA PIC  X(0001).
  1266     05  CLMNOI PIC  X(0007).
  1267*    -------------------------------
  1268     05  CLMCARRL PIC S9(0004) COMP.
  1269     05  CLMCARRF PIC  X(0001).
  1270     05  FILLER REDEFINES CLMCARRF.
  1271         10  CLMCARRA PIC  X(0001).
  1272     05  CLMCARRI PIC  X(0001).
  1273*    -------------------------------
  1274     05  CLMTYPEL PIC S9(0004) COMP.
  1275     05  CLMTYPEF PIC  X(0001).
  1276     05  FILLER REDEFINES CLMTYPEF.
  1277         10  CLMTYPEA PIC  X(0001).
  1278     05  CLMTYPEI PIC  X(0001).
  1279*    -------------------------------
  1280     05  CERTNOL PIC S9(0004) COMP.
  1281     05  CERTNOF PIC  X(0001).
  1282     05  FILLER REDEFINES CERTNOF.
  1283         10  CERTNOA PIC  X(0001).
  1284     05  CERTNOI PIC  X(0010).
  1285*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  25
* EL130.cbl
  1286     05  SUFXL PIC S9(0004) COMP.
  1287     05  SUFXF PIC  X(0001).
  1288     05  FILLER REDEFINES SUFXF.
  1289         10  SUFXA PIC  X(0001).
  1290     05  SUFXI PIC  X(0001).
  1291*    -------------------------------
  1292     05  PCERTNOL PIC S9(0004) COMP.
  1293     05  PCERTNOF PIC  X(0001).
  1294     05  FILLER REDEFINES PCERTNOF.
  1295         10  PCERTNOA PIC  X(0001).
  1296     05  PCERTNOI PIC  X(0010).
  1297*    -------------------------------
  1298     05  PSUFXL PIC S9(0004) COMP.
  1299     05  PSUFXF PIC  X(0001).
  1300     05  FILLER REDEFINES PSUFXF.
  1301         10  PSUFXA PIC  X(0001).
  1302     05  PSUFXI PIC  X(0001).
  1303*    -------------------------------
  1304     05  INCURL PIC S9(0004) COMP.
  1305     05  INCURF PIC  X(0001).
  1306     05  FILLER REDEFINES INCURF.
  1307         10  INCURA PIC  X(0001).
  1308     05  INCURI PIC  X(0008).
  1309*    -------------------------------
  1310     05  REPORTL PIC S9(0004) COMP.
  1311     05  REPORTF PIC  X(0001).
  1312     05  FILLER REDEFINES REPORTF.
  1313         10  REPORTA PIC  X(0001).
  1314     05  REPORTI PIC  X(0008).
  1315*    -------------------------------
  1316     05  ICD1L PIC S9(0004) COMP.
  1317     05  ICD1F PIC  X(0001).
  1318     05  FILLER REDEFINES ICD1F.
  1319         10  ICD1A PIC  X(0001).
  1320     05  ICD1I PIC  X(0008).
  1321*    -------------------------------
  1322     05  ICD2L PIC S9(0004) COMP.
  1323     05  ICD2F PIC  X(0001).
  1324     05  FILLER REDEFINES ICD2F.
  1325         10  ICD2A PIC  X(0001).
  1326     05  ICD2I PIC  X(0008).
  1327*    -------------------------------
  1328     05  DIAGL PIC S9(0004) COMP.
  1329     05  DIAGF PIC  X(0001).
  1330     05  FILLER REDEFINES DIAGF.
  1331         10  DIAGA PIC  X(0001).
  1332     05  DIAGI PIC  X(0060).
  1333*    -------------------------------
  1334     05  BENECDL PIC S9(0004) COMP.
  1335     05  BENECDF PIC  X(0001).
  1336     05  FILLER REDEFINES BENECDF.
  1337         10  BENECDA PIC  X(0001).
  1338     05  BENECDI PIC  X(0010).
  1339*    -------------------------------
  1340     05  BIRTHDTL PIC S9(0004) COMP.
  1341     05  BIRTHDTF PIC  X(0001).
  1342     05  FILLER REDEFINES BIRTHDTF.
  1343         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  26
* EL130.cbl
  1344     05  BIRTHDTI PIC  X(0008).
  1345*    -------------------------------
  1346     05  SSNL PIC S9(0004) COMP.
  1347     05  SSNF PIC  X(0001).
  1348     05  FILLER REDEFINES SSNF.
  1349         10  SSNA PIC  X(0001).
  1350     05  SSNI PIC  X(0011).
  1351*    -------------------------------
  1352     05  SEXL PIC S9(0004) COMP.
  1353     05  SEXF PIC  X(0001).
  1354     05  FILLER REDEFINES SEXF.
  1355         10  SEXA PIC  X(0001).
  1356     05  SEXI PIC  X(0001).
  1357*    -------------------------------
  1358     05  INSTYPEL PIC S9(0004) COMP.
  1359     05  INSTYPEF PIC  X(0001).
  1360     05  FILLER REDEFINES INSTYPEF.
  1361         10  INSTYPEA PIC  X(0001).
  1362     05  INSTYPEI PIC  X(0001).
  1363*    -------------------------------
  1364     05  LSTNMEL PIC S9(0004) COMP.
  1365     05  LSTNMEF PIC  X(0001).
  1366     05  FILLER REDEFINES LSTNMEF.
  1367         10  LSTNMEA PIC  X(0001).
  1368     05  LSTNMEI PIC  X(0015).
  1369*    -------------------------------
  1370     05  FSTNMEL PIC S9(0004) COMP.
  1371     05  FSTNMEF PIC  X(0001).
  1372     05  FILLER REDEFINES FSTNMEF.
  1373         10  FSTNMEA PIC  X(0001).
  1374     05  FSTNMEI PIC  X(0012).
  1375*    -------------------------------
  1376     05  INITL PIC S9(0004) COMP.
  1377     05  INITF PIC  X(0001).
  1378     05  FILLER REDEFINES INITF.
  1379         10  INITA PIC  X(0001).
  1380     05  INITI PIC  X(0001).
  1381*    -------------------------------
  1382     05  LOANNOL PIC S9(0004) COMP.
  1383     05  LOANNOF PIC  X(0001).
  1384     05  FILLER REDEFINES LOANNOF.
  1385         10  LOANNOA PIC  X(0001).
  1386     05  LOANNOI PIC  X(0008).
  1387*    -------------------------------
  1388     05  CRTLNMEL PIC S9(0004) COMP.
  1389     05  CRTLNMEF PIC  X(0001).
  1390     05  FILLER REDEFINES CRTLNMEF.
  1391         10  CRTLNMEA PIC  X(0001).
  1392     05  CRTLNMEI PIC  X(0015).
  1393*    -------------------------------
  1394     05  CRTFNMEL PIC S9(0004) COMP.
  1395     05  CRTFNMEF PIC  X(0001).
  1396     05  FILLER REDEFINES CRTFNMEF.
  1397         10  CRTFNMEA PIC  X(0001).
  1398     05  CRTFNMEI PIC  X(0012).
  1399*    -------------------------------
  1400     05  CRTINITL PIC S9(0004) COMP.
  1401     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  27
* EL130.cbl
  1402     05  FILLER REDEFINES CRTINITF.
  1403         10  CRTINITA PIC  X(0001).
  1404     05  CRTINITI PIC  X(0001).
  1405*    -------------------------------
  1406     05  LOANBALL PIC S9(0004) COMP.
  1407     05  LOANBALF PIC  X(0001).
  1408     05  FILLER REDEFINES LOANBALF.
  1409         10  LOANBALA PIC  X(0001).
  1410     05  LOANBALI PIC  9(7)V99.
  1411*    -------------------------------
  1412     05  MANRSVL PIC S9(0004) COMP.
  1413     05  MANRSVF PIC  X(0001).
  1414     05  FILLER REDEFINES MANRSVF.
  1415         10  MANRSVA PIC  X(0001).
  1416     05  MANRSVI PIC  9(7)V99.
  1417*    -------------------------------
  1418     05  SUPVL PIC S9(0004) COMP.
  1419     05  SUPVF PIC  X(0001).
  1420     05  FILLER REDEFINES SUPVF.
  1421         10  SUPVA PIC  X(0001).
  1422     05  SUPVI PIC  X(0001).
  1423*    -------------------------------
  1424     05  PRICDL PIC S9(0004) COMP.
  1425     05  PRICDF PIC  X(0001).
  1426     05  FILLER REDEFINES PRICDF.
  1427         10  PRICDA PIC  X(0001).
  1428     05  PRICDI PIC  X(0001).
  1429*    -------------------------------
  1430     05  PRODL PIC S9(0004) COMP.
  1431     05  PRODF PIC  X(0001).
  1432     05  FILLER REDEFINES PRODF.
  1433         10  PRODA PIC  X(0001).
  1434     05  PRODI PIC  X(0008).
  1435*    -------------------------------
  1436     05  PRODCDL PIC S9(0004) COMP.
  1437     05  PRODCDF PIC  X(0001).
  1438     05  FILLER REDEFINES PRODCDF.
  1439         10  PRODCDA PIC  X(0001).
  1440     05  PRODCDI PIC  X(0001).
  1441*    -------------------------------
  1442     05  FILETOL PIC S9(0004) COMP.
  1443     05  FILETOF PIC  X(0001).
  1444     05  FILLER REDEFINES FILETOF.
  1445         10  FILETOA PIC  X(0001).
  1446     05  FILETOI PIC  X(0004).
  1447*    -------------------------------
  1448     05  PROCCDL PIC S9(0004) COMP.
  1449     05  PROCCDF PIC  X(0001).
  1450     05  FILLER REDEFINES PROCCDF.
  1451         10  PROCCDA PIC  X(0001).
  1452     05  PROCCDI PIC  X(0004).
  1453*    -------------------------------
  1454     05  RELCLML PIC S9(0004) COMP.
  1455     05  RELCLMF PIC  X(0001).
  1456     05  FILLER REDEFINES RELCLMF.
  1457         10  RELCLMA PIC  X(0001).
  1458     05  RELCLMI PIC  X(0007).
  1459*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  28
* EL130.cbl
  1460     05  PRTOPTL PIC S9(0004) COMP.
  1461     05  PRTOPTF PIC  X(0001).
  1462     05  FILLER REDEFINES PRTOPTF.
  1463         10  PRTOPTA PIC  X(0001).
  1464     05  PRTOPTI PIC  X(0001).
  1465*    -------------------------------
  1466     05  ALTPRTL PIC S9(0004) COMP.
  1467     05  ALTPRTF PIC  X(0001).
  1468     05  FILLER REDEFINES ALTPRTF.
  1469         10  ALTPRTA PIC  X(0001).
  1470     05  ALTPRTI PIC  X(0004).
  1471*    -------------------------------
  1472     05  CERTMTL PIC S9(0004) COMP.
  1473     05  CERTMTF PIC  X(0001).
  1474     05  FILLER REDEFINES CERTMTF.
  1475         10  CERTMTA PIC  X(0001).
  1476     05  CERTMTI PIC  X(0001).
  1477*    -------------------------------
  1478     05  CRTCARRL PIC S9(0004) COMP.
  1479     05  CRTCARRF PIC  X(0001).
  1480     05  FILLER REDEFINES CRTCARRF.
  1481         10  CRTCARRA PIC  X(0001).
  1482     05  CRTCARRI PIC  X(0001).
  1483*    -------------------------------
  1484     05  GROUPL PIC S9(0004) COMP.
  1485     05  GROUPF PIC  X(0001).
  1486     05  FILLER REDEFINES GROUPF.
  1487         10  GROUPA PIC  X(0001).
  1488     05  GROUPI PIC  X(0006).
  1489*    -------------------------------
  1490     05  STATEL PIC S9(0004) COMP.
  1491     05  STATEF PIC  X(0001).
  1492     05  FILLER REDEFINES STATEF.
  1493         10  STATEA PIC  X(0001).
  1494     05  STATEI PIC  X(0002).
  1495*    -------------------------------
  1496     05  ACCOUNTL PIC S9(0004) COMP.
  1497     05  ACCOUNTF PIC  X(0001).
  1498     05  FILLER REDEFINES ACCOUNTF.
  1499         10  ACCOUNTA PIC  X(0001).
  1500     05  ACCOUNTI PIC  X(0010).
  1501*    -------------------------------
  1502     05  EFFDTL PIC S9(0004) COMP.
  1503     05  EFFDTF PIC  X(0001).
  1504     05  FILLER REDEFINES EFFDTF.
  1505         10  EFFDTA PIC  X(0001).
  1506     05  EFFDTI PIC  X(0008).
  1507*    -------------------------------
  1508     05  CRTSSNL PIC S9(0004) COMP.
  1509     05  CRTSSNF PIC  X(0001).
  1510     05  FILLER REDEFINES CRTSSNF.
  1511         10  CRTSSNA PIC  X(0001).
  1512     05  CRTSSNI PIC  X(0011).
  1513*    -------------------------------
  1514     05  MEMCAPL PIC S9(0004) COMP.
  1515     05  MEMCAPF PIC  X(0001).
  1516     05  FILLER REDEFINES MEMCAPF.
  1517         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  29
* EL130.cbl
  1518     05  MEMCAPI PIC  X(0010).
  1519*    -------------------------------
  1520     05  MEMBERL PIC S9(0004) COMP.
  1521     05  MEMBERF PIC  X(0001).
  1522     05  FILLER REDEFINES MEMBERF.
  1523         10  MEMBERA PIC  X(0001).
  1524     05  MEMBERI PIC  X(0012).
  1525*    -------------------------------
  1526     05  REINCDL PIC S9(0004) COMP.
  1527     05  REINCDF PIC  X(0001).
  1528     05  FILLER REDEFINES REINCDF.
  1529         10  REINCDA PIC  X(0001).
  1530     05  REINCDI PIC  X(0001).
  1531*    -------------------------------
  1532     05  ISSAGEL PIC S9(0004) COMP.
  1533     05  ISSAGEF PIC  X(0001).
  1534     05  FILLER REDEFINES ISSAGEF.
  1535         10  ISSAGEA PIC  X(0001).
  1536     05  ISSAGEI PIC  X(0002).
  1537*    -------------------------------
  1538     05  APRL PIC S9(0004) COMP.
  1539     05  APRF PIC  X(0001).
  1540     05  FILLER REDEFINES APRF.
  1541         10  APRA PIC  X(0001).
  1542     05  APRI PIC  9(4)V9(4).
  1543*    -------------------------------
  1544     05  PMTFREQL PIC S9(0004) COMP.
  1545     05  PMTFREQF PIC  X(0001).
  1546     05  FILLER REDEFINES PMTFREQF.
  1547         10  PMTFREQA PIC  X(0001).
  1548     05  PMTFREQI PIC  99.
  1549*    -------------------------------
  1550     05  INDGRPL PIC S9(0004) COMP.
  1551     05  INDGRPF PIC  X(0001).
  1552     05  FILLER REDEFINES INDGRPF.
  1553         10  INDGRPA PIC  X(0001).
  1554     05  INDGRPI PIC  X(0001).
  1555*    -------------------------------
  1556     05  PREMTYPL PIC S9(0004) COMP.
  1557     05  PREMTYPF PIC  X(0001).
  1558     05  FILLER REDEFINES PREMTYPF.
  1559         10  PREMTYPA PIC  X(0001).
  1560     05  PREMTYPI PIC  X(0001).
  1561*    -------------------------------
  1562     05  ADDONDTL PIC S9(0004) COMP.
  1563     05  ADDONDTF PIC  X(0001).
  1564     05  FILLER REDEFINES ADDONDTF.
  1565         10  ADDONDTA PIC  X(0001).
  1566     05  ADDONDTI PIC  X(0008).
  1567*    -------------------------------
  1568     05  JNTLNMEL PIC S9(0004) COMP.
  1569     05  JNTLNMEF PIC  X(0001).
  1570     05  FILLER REDEFINES JNTLNMEF.
  1571         10  JNTLNMEA PIC  X(0001).
  1572     05  JNTLNMEI PIC  X(0015).
  1573*    -------------------------------
  1574     05  JNTFNMEL PIC S9(0004) COMP.
  1575     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  30
* EL130.cbl
  1576     05  FILLER REDEFINES JNTFNMEF.
  1577         10  JNTFNMEA PIC  X(0001).
  1578     05  JNTFNMEI PIC  X(0002).
  1579*    -------------------------------
  1580     05  JNTINITL PIC S9(0004) COMP.
  1581     05  JNTINITF PIC  X(0001).
  1582     05  FILLER REDEFINES JNTINITF.
  1583         10  JNTINITA PIC  X(0001).
  1584     05  JNTINITI PIC  X(0001).
  1585*    -------------------------------
  1586     05  JNTAGEL PIC S9(0004) COMP.
  1587     05  JNTAGEF PIC  X(0001).
  1588     05  FILLER REDEFINES JNTAGEF.
  1589         10  JNTAGEA PIC  X(0001).
  1590     05  JNTAGEI PIC  X(0002).
  1591*    -------------------------------
  1592     05  LCVDSCRL PIC S9(0004) COMP.
  1593     05  LCVDSCRF PIC  X(0001).
  1594     05  FILLER REDEFINES LCVDSCRF.
  1595         10  LCVDSCRA PIC  X(0001).
  1596     05  LCVDSCRI PIC  X(0006).
  1597*    -------------------------------
  1598     05  LCVKINDL PIC S9(0004) COMP.
  1599     05  LCVKINDF PIC  X(0001).
  1600     05  FILLER REDEFINES LCVKINDF.
  1601         10  LCVKINDA PIC  X(0001).
  1602     05  LCVKINDI PIC  X(0003).
  1603*    -------------------------------
  1604     05  LCVCDL PIC S9(0004) COMP.
  1605     05  LCVCDF PIC  X(0001).
  1606     05  FILLER REDEFINES LCVCDF.
  1607         10  LCVCDA PIC  X(0001).
  1608     05  LCVCDI PIC  X(0002).
  1609*    -------------------------------
  1610     05  LCVOTRML PIC S9(0004) COMP.
  1611     05  LCVOTRMF PIC  X(0001).
  1612     05  FILLER REDEFINES LCVOTRMF.
  1613         10  LCVOTRMA PIC  X(0001).
  1614     05  LCVOTRMI PIC  999.
  1615*    -------------------------------
  1616     05  LCVRTRML PIC S9(0004) COMP.
  1617     05  LCVRTRMF PIC  X(0001).
  1618     05  FILLER REDEFINES LCVRTRMF.
  1619         10  LCVRTRMA PIC  X(0001).
  1620     05  LCVRTRMI PIC  X(0003).
  1621*    -------------------------------
  1622     05  LCVRATEL PIC S9(0004) COMP.
  1623     05  LCVRATEF PIC  X(0001).
  1624     05  FILLER REDEFINES LCVRATEF.
  1625         10  LCVRATEA PIC  X(0001).
  1626     05  LCVRATEI PIC  9999V99.
  1627*    -------------------------------
  1628     05  LCVBENEL PIC S9(0004) COMP.
  1629     05  LCVBENEF PIC  X(0001).
  1630     05  FILLER REDEFINES LCVBENEF.
  1631         10  LCVBENEA PIC  X(0001).
  1632     05  LCVBENEI PIC  9(9)V99.
  1633*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  31
* EL130.cbl
  1634     05  LCVFORML PIC S9(0004) COMP.
  1635     05  LCVFORMF PIC  X(0001).
  1636     05  FILLER REDEFINES LCVFORMF.
  1637         10  LCVFORMA PIC  X(0001).
  1638     05  LCVFORMI PIC  X(0012).
  1639*    -------------------------------
  1640     05  LCVCNDTL PIC S9(0004) COMP.
  1641     05  LCVCNDTF PIC  X(0001).
  1642     05  FILLER REDEFINES LCVCNDTF.
  1643         10  LCVCNDTA PIC  X(0001).
  1644     05  LCVCNDTI PIC  X(0008).
  1645*    -------------------------------
  1646     05  LCVEXITL PIC S9(0004) COMP.
  1647     05  LCVEXITF PIC  X(0001).
  1648     05  FILLER REDEFINES LCVEXITF.
  1649         10  LCVEXITA PIC  X(0001).
  1650     05  LCVEXITI PIC  X(0008).
  1651*    -------------------------------
  1652     05  LCVSTATL PIC S9(0004) COMP.
  1653     05  LCVSTATF PIC  X(0001).
  1654     05  FILLER REDEFINES LCVSTATF.
  1655         10  LCVSTATA PIC  X(0001).
  1656     05  LCVSTATI PIC  X(0006).
  1657*    -------------------------------
  1658     05  ACVDSCRL PIC S9(0004) COMP.
  1659     05  ACVDSCRF PIC  X(0001).
  1660     05  FILLER REDEFINES ACVDSCRF.
  1661         10  ACVDSCRA PIC  X(0001).
  1662     05  ACVDSCRI PIC  X(0006).
  1663*    -------------------------------
  1664     05  ACVKINDL PIC S9(0004) COMP.
  1665     05  ACVKINDF PIC  X(0001).
  1666     05  FILLER REDEFINES ACVKINDF.
  1667         10  ACVKINDA PIC  X(0001).
  1668     05  ACVKINDI PIC  X(0003).
  1669*    -------------------------------
  1670     05  ACVCDL PIC S9(0004) COMP.
  1671     05  ACVCDF PIC  X(0001).
  1672     05  FILLER REDEFINES ACVCDF.
  1673         10  ACVCDA PIC  X(0001).
  1674     05  ACVCDI PIC  X(0002).
  1675*    -------------------------------
  1676     05  ACVOTRML PIC S9(0004) COMP.
  1677     05  ACVOTRMF PIC  X(0001).
  1678     05  FILLER REDEFINES ACVOTRMF.
  1679         10  ACVOTRMA PIC  X(0001).
  1680     05  ACVOTRMI PIC  999.
  1681*    -------------------------------
  1682     05  ACVRTRML PIC S9(0004) COMP.
  1683     05  ACVRTRMF PIC  X(0001).
  1684     05  FILLER REDEFINES ACVRTRMF.
  1685         10  ACVRTRMA PIC  X(0001).
  1686     05  ACVRTRMI PIC  X(0003).
  1687*    -------------------------------
  1688     05  ACVRATEL PIC S9(0004) COMP.
  1689     05  ACVRATEF PIC  X(0001).
  1690     05  FILLER REDEFINES ACVRATEF.
  1691         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  32
* EL130.cbl
  1692     05  ACVRATEI PIC  9999V99.
  1693*    -------------------------------
  1694     05  ACVBENEL PIC S9(0004) COMP.
  1695     05  ACVBENEF PIC  X(0001).
  1696     05  FILLER REDEFINES ACVBENEF.
  1697         10  ACVBENEA PIC  X(0001).
  1698     05  ACVBENEI PIC  9(9)V99.
  1699*    -------------------------------
  1700     05  ACVFORML PIC S9(0004) COMP.
  1701     05  ACVFORMF PIC  X(0001).
  1702     05  FILLER REDEFINES ACVFORMF.
  1703         10  ACVFORMA PIC  X(0001).
  1704     05  ACVFORMI PIC  X(0012).
  1705*    -------------------------------
  1706     05  ACVCNDTL PIC S9(0004) COMP.
  1707     05  ACVCNDTF PIC  X(0001).
  1708     05  FILLER REDEFINES ACVCNDTF.
  1709         10  ACVCNDTA PIC  X(0001).
  1710     05  ACVCNDTI PIC  X(0008).
  1711*    -------------------------------
  1712     05  ACVEXITL PIC S9(0004) COMP.
  1713     05  ACVEXITF PIC  X(0001).
  1714     05  FILLER REDEFINES ACVEXITF.
  1715         10  ACVEXITA PIC  X(0001).
  1716     05  ACVEXITI PIC  X(0008).
  1717*    -------------------------------
  1718     05  ACVSTATL PIC S9(0004) COMP.
  1719     05  ACVSTATF PIC  X(0001).
  1720     05  FILLER REDEFINES ACVSTATF.
  1721         10  ACVSTATA PIC  X(0001).
  1722     05  ACVSTATI PIC  X(0006).
  1723*    -------------------------------
  1724     05  ERRMSG1L PIC S9(0004) COMP.
  1725     05  ERRMSG1F PIC  X(0001).
  1726     05  FILLER REDEFINES ERRMSG1F.
  1727         10  ERRMSG1A PIC  X(0001).
  1728     05  ERRMSG1I PIC  X(0072).
  1729*    -------------------------------
  1730     05  ERRMSG2L PIC S9(0004) COMP.
  1731     05  ERRMSG2F PIC  X(0001).
  1732     05  FILLER REDEFINES ERRMSG2F.
  1733         10  ERRMSG2A PIC  X(0001).
  1734     05  ERRMSG2I PIC  X(0072).
  1735*    -------------------------------
  1736     05  BCERT1L PIC S9(0004) COMP.
  1737     05  BCERT1F PIC  X(0001).
  1738     05  FILLER REDEFINES BCERT1F.
  1739         10  BCERT1A PIC  X(0001).
  1740     05  BCERT1I PIC  X(0010).
  1741*    -------------------------------
  1742     05  BSUFX1L PIC S9(0004) COMP.
  1743     05  BSUFX1F PIC  X(0001).
  1744     05  FILLER REDEFINES BSUFX1F.
  1745         10  BSUFX1A PIC  X(0001).
  1746     05  BSUFX1I PIC  X(0001).
  1747*    -------------------------------
  1748     05  BCERT2L PIC S9(0004) COMP.
  1749     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  33
* EL130.cbl
  1750     05  FILLER REDEFINES BCERT2F.
  1751         10  BCERT2A PIC  X(0001).
  1752     05  BCERT2I PIC  X(0010).
  1753*    -------------------------------
  1754     05  BSUFX2L PIC S9(0004) COMP.
  1755     05  BSUFX2F PIC  X(0001).
  1756     05  FILLER REDEFINES BSUFX2F.
  1757         10  BSUFX2A PIC  X(0001).
  1758     05  BSUFX2I PIC  X(0001).
  1759*    -------------------------------
  1760     05  BCERT3L PIC S9(0004) COMP.
  1761     05  BCERT3F PIC  X(0001).
  1762     05  FILLER REDEFINES BCERT3F.
  1763         10  BCERT3A PIC  X(0001).
  1764     05  BCERT3I PIC  X(0010).
  1765*    -------------------------------
  1766     05  BSUFX3L PIC S9(0004) COMP.
  1767     05  BSUFX3F PIC  X(0001).
  1768     05  FILLER REDEFINES BSUFX3F.
  1769         10  BSUFX3A PIC  X(0001).
  1770     05  BSUFX3I PIC  X(0001).
  1771*    -------------------------------
  1772     05  BCERT4L PIC S9(0004) COMP.
  1773     05  BCERT4F PIC  X(0001).
  1774     05  FILLER REDEFINES BCERT4F.
  1775         10  BCERT4A PIC  X(0001).
  1776     05  BCERT4I PIC  X(0010).
  1777*    -------------------------------
  1778     05  BSUFX4L PIC S9(0004) COMP.
  1779     05  BSUFX4F PIC  X(0001).
  1780     05  FILLER REDEFINES BSUFX4F.
  1781         10  BSUFX4A PIC  X(0001).
  1782     05  BSUFX4I PIC  X(0001).
  1783*    -------------------------------
  1784     05  BCERT5L PIC S9(0004) COMP.
  1785     05  BCERT5F PIC  X(0001).
  1786     05  FILLER REDEFINES BCERT5F.
  1787         10  BCERT5A PIC  X(0001).
  1788     05  BCERT5I PIC  X(0010).
  1789*    -------------------------------
  1790     05  BSUFX5L PIC S9(0004) COMP.
  1791     05  BSUFX5F PIC  X(0001).
  1792     05  FILLER REDEFINES BSUFX5F.
  1793         10  BSUFX5A PIC  X(0001).
  1794     05  BSUFX5I PIC  X(0001).
  1795*    -------------------------------
  1796     05  ENTERPFL PIC S9(0004) COMP.
  1797     05  ENTERPFF PIC  X(0001).
  1798     05  FILLER REDEFINES ENTERPFF.
  1799         10  ENTERPFA PIC  X(0001).
  1800     05  ENTERPFI PIC  99.
  1801*    -------------------------------
  1802     05  PF5L PIC S9(0004) COMP.
  1803     05  PF5F PIC  X(0001).
  1804     05  FILLER REDEFINES PF5F.
  1805         10  PF5A PIC  X(0001).
  1806     05  PF5I PIC  X(0013).
  1807 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  34
* EL130.cbl
  1808     05  FILLER            PIC  X(0012).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  RUNDTEO PIC  X(0008).
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  RUNTIMEO PIC  99.99.
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  COMPO PIC  X(0003).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  SEQUO PIC  X(0010).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  MAINTO PIC  X(0001).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  CLMNOO PIC  X(0007).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  CLMCARRO PIC  X(0001).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  CLMTYPEO PIC  X(0001).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  CERTNOO PIC  X(0010).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  SUFXO PIC  X(0001).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  PCERTNOO PIC  X(0010).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  PSUFXO PIC  X(0001).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  INCURO PIC  X(0008).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  REPORTO PIC  X(0008).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  ICD1O PIC  X(0008).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  ICD2O PIC  X(0008).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  DIAGO PIC  X(0060).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  BENECDO PIC  X(0010).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  35
* EL130.cbl
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  SSNO PIC  X(0011).
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  SEXO PIC  X(0001).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  INSTYPEO PIC  X(0001).
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  LSTNMEO PIC  X(0015).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  FSTNMEO PIC  X(0012).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  INITO PIC  X(0001).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  LOANNOO PIC  X(0008).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  CRTLNMEO PIC  X(0015).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  CRTFNMEO PIC  X(0012).
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  CRTINITO PIC  X(0001).
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  LOANBALO PIC  ZZZZZ9.99.
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  MANRSVO PIC  Z(5)9.99.
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  SUPVO PIC  X(0001).
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  PRICDO PIC  X(0001).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  PRODO PIC  X(0008).
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  PRODCDO PIC  X(0001).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  FILETOO PIC  X(0004).
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  PROCCDO PIC  X(0004).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  RELCLMO PIC  X(0007).
  1923*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  36
* EL130.cbl
  1924     05  FILLER            PIC  X(0003).
  1925     05  PRTOPTO PIC  X(0001).
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
  1928     05  ALTPRTO PIC  X(0004).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  CERTMTO PIC  X(0001).
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  CRTCARRO PIC  X(0001).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  GROUPO PIC  X(0006).
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  STATEO PIC  X(0002).
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
  1943     05  ACCOUNTO PIC  X(0010).
  1944*    -------------------------------
  1945     05  FILLER            PIC  X(0003).
  1946     05  EFFDTO PIC  X(0008).
  1947*    -------------------------------
  1948     05  FILLER            PIC  X(0003).
  1949     05  CRTSSNO PIC  X(0011).
  1950*    -------------------------------
  1951     05  FILLER            PIC  X(0003).
  1952     05  MEMCAPO PIC  X(0010).
  1953*    -------------------------------
  1954     05  FILLER            PIC  X(0003).
  1955     05  MEMBERO PIC  X(0012).
  1956*    -------------------------------
  1957     05  FILLER            PIC  X(0003).
  1958     05  REINCDO PIC  X(0001).
  1959*    -------------------------------
  1960     05  FILLER            PIC  X(0003).
  1961     05  ISSAGEO PIC  X(0002).
  1962*    -------------------------------
  1963     05  FILLER            PIC  X(0003).
  1964     05  APRO PIC  9(3).9(4).
  1965*    -------------------------------
  1966     05  FILLER            PIC  X(0003).
  1967     05  PMTFREQO PIC  99.
  1968*    -------------------------------
  1969     05  FILLER            PIC  X(0003).
  1970     05  INDGRPO PIC  X(0001).
  1971*    -------------------------------
  1972     05  FILLER            PIC  X(0003).
  1973     05  PREMTYPO PIC  X(0001).
  1974*    -------------------------------
  1975     05  FILLER            PIC  X(0003).
  1976     05  ADDONDTO PIC  X(0008).
  1977*    -------------------------------
  1978     05  FILLER            PIC  X(0003).
  1979     05  JNTLNMEO PIC  X(0015).
  1980*    -------------------------------
  1981     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  37
* EL130.cbl
  1982     05  JNTFNMEO PIC  X(0002).
  1983*    -------------------------------
  1984     05  FILLER            PIC  X(0003).
  1985     05  JNTINITO PIC  X(0001).
  1986*    -------------------------------
  1987     05  FILLER            PIC  X(0003).
  1988     05  JNTAGEO PIC  X(0002).
  1989*    -------------------------------
  1990     05  FILLER            PIC  X(0003).
  1991     05  LCVDSCRO PIC  X(0006).
  1992*    -------------------------------
  1993     05  FILLER            PIC  X(0003).
  1994     05  LCVKINDO PIC  X(0003).
  1995*    -------------------------------
  1996     05  FILLER            PIC  X(0003).
  1997     05  LCVCDO PIC  X(0002).
  1998*    -------------------------------
  1999     05  FILLER            PIC  X(0003).
  2000     05  LCVOTRMO PIC  999.
  2001*    -------------------------------
  2002     05  FILLER            PIC  X(0003).
  2003     05  LCVRTRMO PIC  ZZZ.
  2004*    -------------------------------
  2005     05  FILLER            PIC  X(0003).
  2006     05  LCVRATEO PIC  ZZZ.ZZ.
  2007*    -------------------------------
  2008     05  FILLER            PIC  X(0003).
  2009     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2010*    -------------------------------
  2011     05  FILLER            PIC  X(0003).
  2012     05  LCVFORMO PIC  X(0012).
  2013*    -------------------------------
  2014     05  FILLER            PIC  X(0003).
  2015     05  LCVCNDTO PIC  X(0008).
  2016*    -------------------------------
  2017     05  FILLER            PIC  X(0003).
  2018     05  LCVEXITO PIC  X(0008).
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  LCVSTATO PIC  X(0006).
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  ACVDSCRO PIC  X(0006).
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  ACVKINDO PIC  X(0003).
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  ACVCDO PIC  X(0002).
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  ACVOTRMO PIC  999.
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  ACVRTRMO PIC  ZZZ.
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  38
* EL130.cbl
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  ACVFORMO PIC  X(0012).
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  ACVCNDTO PIC  X(0008).
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  ACVEXITO PIC  X(0008).
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  ACVSTATO PIC  X(0006).
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  ERRMSG1O PIC  X(0072).
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  ERRMSG2O PIC  X(0072).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
  2063     05  BCERT1O PIC  X(0010).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  BSUFX1O PIC  X(0001).
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
  2069     05  BCERT2O PIC  X(0010).
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  BSUFX2O PIC  X(0001).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  BCERT3O PIC  X(0010).
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  BSUFX3O PIC  X(0001).
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  BCERT4O PIC  X(0010).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  BSUFX4O PIC  X(0001).
  2085*    -------------------------------
  2086     05  FILLER            PIC  X(0003).
  2087     05  BCERT5O PIC  X(0010).
  2088*    -------------------------------
  2089     05  FILLER            PIC  X(0003).
  2090     05  BSUFX5O PIC  X(0001).
  2091*    -------------------------------
  2092     05  FILLER            PIC  X(0003).
  2093     05  ENTERPFO PIC  X(0002).
  2094*    -------------------------------
  2095     05  FILLER            PIC  X(0003).
  2096     05  PF5O PIC  X(0013).
  2097*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  39
* EL130.cbl
  2099*    COPY ELCDATE.
  2100******************************************************************
  2101*                                                                *
  2102*                                                                *
  2103*                            ELCDATE.                            *
  2104*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2105*                            VMOD=2.003
  2106*                                                                *
  2107*                                                                *
  2108*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2109*                 LENGTH = 200                                   *
  2110******************************************************************
  2111
  2112 01  DATE-CONVERSION-DATA.
  2113     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2114     12  DC-OPTION-CODE                PIC X.
  2115         88  BIN-TO-GREG                VALUE ' '.
  2116         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2117         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2118         88  YMD-GREG-TO-BIN            VALUE '3'.
  2119         88  MDY-GREG-TO-BIN            VALUE '4'.
  2120         88  JULIAN-TO-BIN              VALUE '5'.
  2121         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2122         88  FIND-CENTURY               VALUE '7'.
  2123         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2124         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2125         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2126         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2127         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2128         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2129         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2130         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2131         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2132         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2133         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2134         88  BIN-3-TO-GREG              VALUE 'I'.
  2135         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2136         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2137         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2138         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2139         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2140         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2141         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2142         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2143         88  THREE-CHARACTER-BIN
  2144                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2145         88  GREGORIAN-TO-BIN
  2146                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2147         88  BIN-TO-GREGORIAN
  2148                  VALUES ' ' '1' 'I' '8' 'G'.
  2149         88  JULIAN-TO-BINARY
  2150                  VALUES '5' 'C' 'E' 'F'.
  2151     12  DC-ERROR-CODE                 PIC X.
  2152         88  NO-CONVERSION-ERROR        VALUE ' '.
  2153         88  DATE-CONVERSION-ERROR
  2154                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2155         88  DATE-IS-ZERO               VALUE '1'.
  2156         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  40
* EL130.cbl
  2157         88  DATE-IS-INVALID            VALUE '3'.
  2158         88  DATE1-GREATER-DATE2        VALUE '4'.
  2159         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2160         88  DATE-INVALID-OPTION        VALUE '9'.
  2161         88  INVALID-CENTURY            VALUE 'A'.
  2162         88  ONLY-CENTURY               VALUE 'B'.
  2163         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2164         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2165     12  DC-END-OF-MONTH               PIC X.
  2166         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2167     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2168         88  USE-NORMAL-PROCESS         VALUE ' '.
  2169         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2170         88  ADJUST-UP-100-YRS          VALUE '2'.
  2171     12  FILLER                        PIC X.
  2172     12  DC-CONVERSION-DATES.
  2173         16  DC-BIN-DATE-1             PIC XX.
  2174         16  DC-BIN-DATE-2             PIC XX.
  2175         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2176         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2177                       DC-GREG-DATE-1-EDIT.
  2178             20  DC-EDIT1-MONTH        PIC 99.
  2179             20  SLASH1-1              PIC X.
  2180             20  DC-EDIT1-DAY          PIC 99.
  2181             20  SLASH1-2              PIC X.
  2182             20  DC-EDIT1-YEAR         PIC 99.
  2183         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2184         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2185                     DC-GREG-DATE-2-EDIT.
  2186             20  DC-EDIT2-MONTH        PIC 99.
  2187             20  SLASH2-1              PIC X.
  2188             20  DC-EDIT2-DAY          PIC 99.
  2189             20  SLASH2-2              PIC X.
  2190             20  DC-EDIT2-YEAR         PIC 99.
  2191         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2192         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2193                     DC-GREG-DATE-1-YMD.
  2194             20  DC-YMD-YEAR           PIC 99.
  2195             20  DC-YMD-MONTH          PIC 99.
  2196             20  DC-YMD-DAY            PIC 99.
  2197         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2198         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2199                      DC-GREG-DATE-1-MDY.
  2200             20  DC-MDY-MONTH          PIC 99.
  2201             20  DC-MDY-DAY            PIC 99.
  2202             20  DC-MDY-YEAR           PIC 99.
  2203         16  DC-GREG-DATE-1-ALPHA.
  2204             20  DC-ALPHA-MONTH        PIC X(10).
  2205             20  DC-ALPHA-DAY          PIC 99.
  2206             20  FILLER                PIC XX.
  2207             20  DC-ALPHA-CENTURY.
  2208                 24 DC-ALPHA-CEN-N     PIC 99.
  2209             20  DC-ALPHA-YEAR         PIC 99.
  2210         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2211         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2212         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2213         16  DC-JULIAN-DATE            PIC 9(05).
  2214         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  41
* EL130.cbl
  2215                                       PIC 9(05).
  2216         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2217             20  DC-JULIAN-YEAR        PIC 99.
  2218             20  DC-JULIAN-DAYS        PIC 999.
  2219         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2220         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2221         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2222     12  DATE-CONVERSION-VARIBLES.
  2223         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2224         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2225             20  FILLER                PIC 9(3).
  2226             20  HOLD-CEN-1-CCYY.
  2227                 24  HOLD-CEN-1-CC     PIC 99.
  2228                 24  HOLD-CEN-1-YY     PIC 99.
  2229             20  HOLD-CEN-1-MO         PIC 99.
  2230             20  HOLD-CEN-1-DA         PIC 99.
  2231         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2232             20  HOLD-CEN-1-R-MO       PIC 99.
  2233             20  HOLD-CEN-1-R-DA       PIC 99.
  2234             20  HOLD-CEN-1-R-CCYY.
  2235                 24  HOLD-CEN-1-R-CC   PIC 99.
  2236                 24  HOLD-CEN-1-R-YY   PIC 99.
  2237             20  FILLER                PIC 9(3).
  2238         16  HOLD-CENTURY-1-X.
  2239             20  FILLER                PIC X(3)  VALUE SPACES.
  2240             20  HOLD-CEN-1-X-CCYY.
  2241                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2242                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2243             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2244             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2245         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2246             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2247             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2248             20  HOLD-CEN-1-R-X-CCYY.
  2249                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2250                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2251             20  FILLER                PIC XXX.
  2252         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2253         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2254         16  DC-JULIAN-DATE-1          PIC 9(07).
  2255         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2256             20  DC-JULIAN-1-CCYY.
  2257                 24  DC-JULIAN-1-CC    PIC 99.
  2258                 24  DC-JULIAN-1-YR    PIC 99.
  2259             20  DC-JULIAN-DA-1        PIC 999.
  2260         16  DC-JULIAN-DATE-2          PIC 9(07).
  2261         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2262             20  DC-JULIAN-2-CCYY.
  2263                 24  DC-JULIAN-2-CC    PIC 99.
  2264                 24  DC-JULIAN-2-YR    PIC 99.
  2265             20  DC-JULIAN-DA-2        PIC 999.
  2266         16  DC-GREG-DATE-A-EDIT.
  2267             20  DC-EDITA-MONTH        PIC 99.
  2268             20  SLASHA-1              PIC X VALUE '/'.
  2269             20  DC-EDITA-DAY          PIC 99.
  2270             20  SLASHA-2              PIC X VALUE '/'.
  2271             20  DC-EDITA-CCYY.
  2272                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  42
* EL130.cbl
  2273                 24  DC-EDITA-YEAR     PIC 99.
  2274         16  DC-GREG-DATE-B-EDIT.
  2275             20  DC-EDITB-MONTH        PIC 99.
  2276             20  SLASHB-1              PIC X VALUE '/'.
  2277             20  DC-EDITB-DAY          PIC 99.
  2278             20  SLASHB-2              PIC X VALUE '/'.
  2279             20  DC-EDITB-CCYY.
  2280                 24  DC-EDITB-CENT     PIC 99.
  2281                 24  DC-EDITB-YEAR     PIC 99.
  2282         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2283         16  DC-GREG-DATE-CYMD-R REDEFINES
  2284                              DC-GREG-DATE-CYMD.
  2285             20  DC-CYMD-CEN           PIC 99.
  2286             20  DC-CYMD-YEAR          PIC 99.
  2287             20  DC-CYMD-MONTH         PIC 99.
  2288             20  DC-CYMD-DAY           PIC 99.
  2289         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2290         16  DC-GREG-DATE-MDCY-R REDEFINES
  2291                              DC-GREG-DATE-MDCY.
  2292             20  DC-MDCY-MONTH         PIC 99.
  2293             20  DC-MDCY-DAY           PIC 99.
  2294             20  DC-MDCY-CEN           PIC 99.
  2295             20  DC-MDCY-YEAR          PIC 99.
  2296    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2297        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2298    12  DC-EL310-DATE                  PIC X(21).
  2299    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  43
* EL130.cbl
  2301*    COPY ELCCALC.
  2302******************************************************************
  2303*                                                                *
  2304*                           ELCCALC.                            *
  2305*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2306*                            VMOD=2.025                          *
  2307*                                                                *
  2308*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2309*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2310*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2311*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2312*                                                                *
  2313*  PASSED TO ELRTRM                                              *
  2314*  -----------------                                             *
  2315*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2316*  ORIGINAL TERM                                                 *
  2317*  BEGINNING DATE                                                *
  2318*  ENDING DATE                                                   *
  2319*  COMPANY I.D.                                                  *
  2320*  ACCOUNT MASTER USER FIELD                                     *
  2321*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2322*  FREE LOOK DAYS                                                *
  2323*                                                                *
  2324*  RETURNED FROM ELRTRM                                          *
  2325*  ---------------------                                         *
  2326*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2327*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2328*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2329*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2330*----------------------------------------------------------------*
  2331*  PASSED TO ELRAMT                                              *
  2332*  ----------------                                              *
  2333*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2334*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2335*  ORIGINAL AMOUNT                                               *
  2336*  ALTERNATE BENEFIT (BALLON)                                    *
  2337*  A.P.R. - NET PAY ONLY                                         *
  2338*  METHOD
  2339*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2340*  COMPANY I.D.                                                  *
  2341*  BENEFIT TYPE                                                  *
  2342*                                                                *
  2343*  RETURNED FROM ELRAMT                                          *
  2344*  --------------------                                          *
  2345*  REMAINING AMOUNT 1 - CURRENT                                  *
  2346*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2347*  REMAINING AMOUNT FACTOR
  2348*----------------------------------------------------------------*
  2349*  PASSED TO ELRESV                                              *
  2350*  -----------------                                             *
  2351*  CERTIFICATE EFFECTIVE DATE                                    *
  2352*  VALUATION DATE                                                *
  2353*  PAID THRU DATE                                                *
  2354*  BENEFIT                                                       *
  2355*  INCURRED DATE                                                 *
  2356*  REPORTED DATE                                                 *
  2357*  ISSUE AGE                                                     *
  2358*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  44
* EL130.cbl
  2359*  CDT PERCENT                                                   *
  2360*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2361* *CLAIM TYPE (LIFE, A/H)                                        *
  2362* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2363* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2364*                                                                *
  2365*  RETURNED FROM ELRESV                                          *
  2366*  --------------------                                          *
  2367*  CDT TABLE USED                                                *
  2368*  CDT FACTOR USED                                               *
  2369*  PAY TO CURRENT RESERVE                                        *
  2370*  I.B.N.R. - A/H ONLY                                           *
  2371*  FUTURE (ACCRUED) AH ONLY                                      *
  2372*----------------------------------------------------------------*
  2373*  PASSED TO ELRATE                                              *
  2374*  ----------------                                              *
  2375*  CERT ISSUE DATE                                               *
  2376*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2377*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2378*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2379*  STATE CODE (CLIENT DEFINED)                                   *
  2380*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2381*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2382*  DEVIATION CODE                                                *
  2383*  ISSUE AGE                                                     *
  2384*  ORIGINAL BENEFIT AMOUNT                                       *
  2385*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2386*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2387*  BENEFIT KIND (LIFE OR A/H)                                    *
  2388*  A.P.R.                                                        *
  2389*  METHOD
  2390*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2391*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2392*  COMPANY I.D. (3 CHARACTER)                                    *
  2393*  BENEFIT CODE                                                  *
  2394*  BENEFIT OVERRIDE CODE                                         *
  2395*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2396*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2397*  JOINT INDICATOR (CSL ONLY)                                    *
  2398*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2399*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2400*                                                                *
  2401*  RETURNED FROM ELRATE                                          *
  2402*  --------------------                                          *
  2403*  CALCULATED PREMIUM                                            *
  2404*  PREMIUM RATE                                                  *
  2405*  MORTALITY CODE                                                *
  2406*  MAX ATTAINED AGE                                              *
  2407*  MAX AGE                                                       *
  2408*  MAX TERM                                                      *
  2409*  MAX MONTHLY BENEFIT                                           *
  2410*  MAX TOTAL BENIFIT                                             *
  2411*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2412*----------------------------------------------------------------*
  2413*  PASSED TO ELRFND                                              *
  2414*  ----------------                                              *
  2415*  CERT ISSUE DATE                                               *
  2416*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  45
* EL130.cbl
  2417*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2418*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2419*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2420*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2421*  STATE CODE (CLIENT DEFINED)                                   *
  2422*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2423*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2424*  DEVIATION CODE                                                *
  2425*  ISSUE AGE                                                     *
  2426*  ORIGINAL BENEFIT AMOUNT                                       *
  2427*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2428*  PROCESS TYPE (CANCEL)                                         *
  2429*  BENEFIT KIND (LIFE OR A/H)                                    *
  2430*  A.P.R.                                                        *
  2431*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2432*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2433*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2434*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2435*  COMPANY I.D. (3 CHARACTER)                                    *
  2436*  BENEFIT CODE                                                  *
  2437*  BENEFIT OVERRIDE CODE                                         *
  2438*                                                                *
  2439*  RETURNED FROM ELRFND                                          *
  2440*  --------------------                                          *
  2441*  CALCULATED REFUND                                             *
  2442*----------------------------------------------------------------*
  2443*  PASSED TO ELEARN                                              *
  2444*  ----------------                                              *
  2445*  CERT ISSUE DATE                                               *
  2446*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2447*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2448*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2449*  STATE CODE (CLIENT DEFINED)                                   *
  2450*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2451*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2452*  DEVIATION CODE                                                *
  2453*  ISSUE AGE                                                     *
  2454*  ORIGINAL BENEFIT AMOUNT                                       *
  2455*  BENEFIT KIND (LIFE OR A/H)                                    *
  2456*  A.P.R.                                                        *
  2457*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2458*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2459*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2460*  COMPANY I.D. (3 CHARACTER)                                    *
  2461*  BENEFIT CODE                                                  *
  2462*  BENEFIT OVERRIDE CODE                                         *
  2463*                                                                *
  2464*  RETURNED FROM ELEARN                                          *
  2465*  --------------------                                          *
  2466*  INDICATED  EARNINGS                                           *
  2467*----------------------------------------------------------------*
  2468*                 LENGTH = 450                                   *
  2469*                                                                *
  2470******************************************************************
  2471******************************************************************
  2472*                   C H A N G E   L O G
  2473*
  2474* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  46
* EL130.cbl
  2475*-----------------------------------------------------------------
  2476*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2477* EFFECTIVE    NUMBER
  2478*-----------------------------------------------------------------
  2479* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2480* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2481* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2482* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2483* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2484* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2485* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2486* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2487* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2488* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2489* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2490******************************************************************
  2491
  2492 01  CALCULATION-PASS-AREA.
  2493     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2494                                     COMP.
  2495
  2496     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2497       88  NO-CP-ERROR                             VALUE ZERO.
  2498       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2499                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2500       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2501       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2502       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2503       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2504       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2505       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2506       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2507       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2508       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2509       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2510       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2511       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2512       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2513       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2514       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2515       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2516       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2517
  2518     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2519       88  NO-CP-ERROR-2                           VALUE ZERO.
  2520***********************  INPUT AREAS ****************************
  2521
  2522     12  CP-CALCULATION-AREA.
  2523         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2524         16  CP-CERT-EFF-DT        PIC XX.
  2525         16  CP-VALUATION-DT       PIC XX.
  2526         16  CP-PAID-THRU-DT       PIC XX.
  2527         16  CP-BENEFIT-TYPE       PIC X.
  2528           88  CP-AH                               VALUE 'A' 'D'
  2529                                                   'I' 'U'.
  2530           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2531           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2532         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  47
* EL130.cbl
  2533         16  CP-REPORTED-DT        PIC XX.
  2534         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2535         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2536         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2537                                     COMP-3.
  2538         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2539                                     COMP-3.
  2540         16  CP-CDT-METHOD         PIC X.
  2541           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2542           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2543           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2544         16  CP-CLAIM-TYPE         PIC X.
  2545           88  CP-AH-CLAIM                         VALUE 'A'.
  2546           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2547         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2548                                     COMP-3.
  2549         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2550                                     COMP-3.
  2551         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2552                                     COMP-3.
  2553         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2554                                     COMP-3.
  2555         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2556                                     COMP-3.
  2557         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2558                                     COMP-3.
  2559         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2560                                     COMP-3.
  2561         16  CP-REM-TERM-METHOD    PIC X.
  2562           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2563           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2564           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2565           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2566           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2567           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2568           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2569         16  CP-EARNING-METHOD     PIC X.
  2570           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2571           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2572           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2573           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2574           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2575           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2576           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2577           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2578           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2579           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2580           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2581           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2582           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2583           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2584         16  CP-PROCESS-TYPE       PIC X.
  2585           88  CP-CLAIM                            VALUE '1'.
  2586           88  CP-CANCEL                           VALUE '2'.
  2587           88  CP-ISSUE                            VALUE '3'.
  2588         16  CP-SPECIAL-CALC-CD    PIC X.
  2589           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2590           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  48
* EL130.cbl
  2591           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2592           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2593           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2594           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2595           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2596           88  CP-FARM-PLAN                    VALUE 'F'.
  2597           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2598           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2599           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2600           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2601           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2602           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2603           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2604           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2605           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2606           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2607                                                     'W' 'X'.
  2608           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2609           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2610           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2611           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2612           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2613           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2614           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2615           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2616           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2617           88  CP-CSL-METH-1                   VALUE '5'.
  2618           88  CP-CSL-METH-2                   VALUE '6'.
  2619           88  CP-CSL-METH-3                   VALUE '7'.
  2620           88  CP-CSL-METH-4                   VALUE '8'.
  2621
  2622         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2623                                     COMP-3.
  2624         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2625         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2626         16  CP-STATE              PIC XX          VALUE SPACE.
  2627         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2628         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2629           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2630               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2631         16  CP-R78-OPTION         PIC X.
  2632           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2633           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2634
  2635         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2636         16  CP-IBNR-RESERVE-SW    PIC X.
  2637         16  CP-CLAIM-STATUS       PIC X.
  2638         16  CP-RATE-FILE          PIC X.
  2639         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2640                                     COMP-3.
  2641
  2642         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2643         16  CP-AH-OVERRIDE-CODE   PIC X.
  2644
  2645         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2646                                     COMP-3.
  2647         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2648                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  49
* EL130.cbl
  2649         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2650                                     COMP-3.
  2651         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2652                                     COMP-3.
  2653         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2654                                     COMP-3.
  2655         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2656                                  PIC S9(7)V99 COMP-3.
  2657
  2658         16  CP-PAID-FROM-DATE     PIC X(02).
  2659         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2660         16  CP-EXT-DAYS-CALC      PIC X.
  2661           88  CP-EXT-NO-CHG                   VALUE ' '.
  2662           88  CP-EXT-CHG-LF                   VALUE '1'.
  2663           88  CP-EXT-CHG-AH                   VALUE '2'.
  2664           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2665         16  CP-DOMICILE-STATE     PIC XX.
  2666         16  CP-CARRIER            PIC X.
  2667         16  CP-REIN-FLAG          PIC X.
  2668         16  CP-REM-TRM-CALC-OPTION PIC X.
  2669           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2670                      '2' '3' '4' '5'.
  2671           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2672           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2673           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2674           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2675           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2676           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2677           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2678           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2679         16  CP-SIG-SWITCH         PIC X.
  2680         16  CP-RATING-METHOD      PIC X.
  2681           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2682           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2683           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2684           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2685           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2686           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2687           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2688           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2689           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2690         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2691                                     COMP-3.
  2692         16  CP-BEN-CATEGORY       PIC X.
  2693         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2694         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2695                                   PIC S99V9(5) COMP-3.
  2696         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2697         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2698                                   PIC S99V9(5) COMP-3.
  2699         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2700         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2701         16  CP-EXPIRE-DT          PIC XX.
  2702         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2703         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2704         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2705         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2706         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  50
* EL130.cbl
  2707             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2708             88  CP-CALC-CLP              VALUE 'C'.
  2709         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2710         16  CP-CANCEL-REASON      PIC X.
  2711         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2712         16  CP-PMT-MODE           PIC X.
  2713         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2714         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2715         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2716         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2717         16  FILLER                PIC X.
  2718
  2719***************    OUTPUT FROM ELRESV   ************************
  2720
  2721         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2722
  2723         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2724                                     COMP-3.
  2725         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2726                                     COMP-3.
  2727         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2728                                     COMP-3.
  2729         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2730                                     COMP-3.
  2731         16  FILLER                PIC X(09).
  2732***************    OUTPUT FROM ELRTRM   *************************
  2733
  2734         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2735                                     COMP-3.
  2736         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2737                                     COMP-3.
  2738         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2739                                     COMP-3.
  2740         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2741                                     COMP-3.
  2742         16  FILLER                PIC X(12).
  2743
  2744***************    OUTPUT FROM ELRAMT   *************************
  2745
  2746         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2747                                     COMP-3.
  2748         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2749                                     COMP-3.
  2750         16  FILLER                PIC X(12).
  2751
  2752***************    OUTPUT FROM ELRATE   *************************
  2753
  2754         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2755                                     COMP-3.
  2756         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2757                                     COMP-3.
  2758         16  CP-MORTALITY-CODE     PIC X(4).
  2759         16  CP-RATE-EDIT-FLAG     PIC X.
  2760             88  CP-RATES-NEED-APR                  VALUE '1'.
  2761         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2762                                     COMP-3.
  2763         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2764         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  51
* EL130.cbl
  2765         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2766                                   PIC S9(7)V99 COMP-3.
  2767         16  FILLER                PIC X(07).
  2768
  2769***************    OUTPUT FROM ELRFND   *************************
  2770
  2771         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2772                                     COMP-3.
  2773         16  CP-REFUND-TYPE-USED   PIC X.
  2774           88  CP-R-AS-R78                         VALUE '1'.
  2775           88  CP-R-AS-PRORATA                     VALUE '2'.
  2776           88  CP-R-AS-CALIF                       VALUE '3'.
  2777           88  CP-R-AS-TEXAS                       VALUE '4'.
  2778           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2779           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2780           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2781           88  CP-R-AS-MEAN                        VALUE '8'.
  2782           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2783           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2784           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2785           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2786           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2787           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2788         16  FILLER                PIC X(12).
  2789
  2790***************    OUTPUT FROM ELEARN   *************************
  2791
  2792         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2793                                     COMP-3.
  2794         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2795                                     COMP-3.
  2796         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2797                                     COMP-3.
  2798         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2799                                     COMP-3.
  2800         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2801                                     COMP-3.
  2802         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2803                                     COMP-3.
  2804         16  CP-EARNING-TYPE-USED  PIC X.
  2805           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2806           88  CP-E-AS-R78                         VALUE '1'.
  2807           88  CP-E-AS-PRORATA                     VALUE '2'.
  2808           88  CP-E-AS-TEXAS                       VALUE '4'.
  2809           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2810           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2811           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2812           88  CP-E-AS-MEAN                        VALUE '8'.
  2813           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2814         16  FILLER                PIC X(12).
  2815
  2816***************    OUTPUT FROM ELPMNT   *************************
  2817
  2818         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2819                                     COMP-3.
  2820         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2821                                     COMP-3.
  2822         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  52
* EL130.cbl
  2823
  2824***************   MISC WORK AREAS    *****************************
  2825         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2826                                     COMP-3.
  2827         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2828                                     COMP-3.
  2829         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2830                                     COMP-3.
  2831         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2832                                     COMP-3.
  2833         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2834                                     COMP-3.
  2835         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2836                                     COMP-3.
  2837         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2838             88  OPEN-RATE-FILE                   VALUE 'O'.
  2839             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2840             88  IO-ERROR                         VALUE 'E'.
  2841
  2842         16  CP-FIRST-PAY-DATE     PIC XX.
  2843
  2844         16  CP-JOINT-INDICATOR    PIC X.
  2845
  2846         16  CP-RESERVE-REMAINING-TERM
  2847                                   PIC S9(4)V9    VALUE ZERO
  2848                                     COMP-3.
  2849
  2850         16  CP-INSURED-BIRTH-DT   PIC XX.
  2851
  2852         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2853                                     COMP-3.
  2854
  2855         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2856                                     COMP-3.
  2857
  2858         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2859                                     COMP-3.
  2860
  2861         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2862                                     COMP-3.
  2863
  2864         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2865                                     COMP-3.
  2866
  2867         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2868                                     COMP-3.
  2869
  2870         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2871                                     COMP-3.
  2872
  2873         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2874             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2875
  2876         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2877                                     COMP-3.
  2878         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2879                                     COMP-3.
  2880         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  53
* EL130.cbl
  2881         16  cp-extra-periods      pic 9 value zeros.
  2882         16  cp-net-only-state     pic x value spaces.
  2883         16  FILLER                PIC X(13).
  2884******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  54
* EL130.cbl
  2886*    COPY ELCLOGOF.
  2887******************************************************************
  2888*                                                                *
  2889*                                                                *
  2890*                            ELCLOGOF.                           *
  2891*                            VMOD=2.001                          *
  2892*                                                                *
  2893*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2894*                                                                *
  2895******************************************************************
  2896 01  CLASIC-LOGOFF.
  2897     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2898     12  LOGOFF-TEXT.
  2899         16  FILLER          PIC X(5)    VALUE SPACES.
  2900         16  LOGOFF-MSG.
  2901             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2902             20  FILLER      PIC X       VALUE SPACES.
  2903             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2904         16  FILLER          PIC X(80)
  2905           VALUE '* YOU ARE NOW LOGGED OFF'.
  2906         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2907         16  FILLER          PIC X       VALUE QUOTE.
  2908         16  LOGOFF-SYS-MSG  PIC X(17)
  2909           VALUE 'S CLAS-IC SYSTEM '.
  2910     12  TEXT-MESSAGES.
  2911         16  UNACCESS-MSG    PIC X(29)
  2912             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2913         16  PGMIDERR-MSG    PIC X(17)
  2914             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  55
* EL130.cbl
  2916*    COPY ELCATTR.
  2917******************************************************************
  2918*                                                                *
  2919*                            ELCATTR.                            *
  2920*                            VMOD=2.001                          *
  2921*                                                                *
  2922*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2923*                                                                *
  2924*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2925*                                                                *
  2926*                   POS 1   P=PROTECTED                          *
  2927*                           U=UNPROTECTED                        *
  2928*                           S=ASKIP                              *
  2929*                   POS 2   A=ALPHA/NUMERIC                      *
  2930*                           N=NUMERIC                            *
  2931*                   POS 3   N=NORMAL                             *
  2932*                           B=BRIGHT                             *
  2933*                           D=DARK                               *
  2934*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2935*                           OF=MODIFIED DATA TAG OFF             *
  2936*                                                                *
  2937*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2938******************************************************************
  2939 01  ATTRIBUTE-LIST.
  2940     12  AL-PABOF            PIC X       VALUE 'Y'.
  2941     12  AL-PABON            PIC X       VALUE 'Z'.
  2942     12  AL-PADOF            PIC X       VALUE '%'.
  2943     12  AL-PADON            PIC X       VALUE '_'.
  2944     12  AL-PANOF            PIC X       VALUE '-'.
  2945     12  AL-PANON            PIC X       VALUE '/'.
  2946     12  AL-SABOF            PIC X       VALUE '8'.
  2947     12  AL-SABON            PIC X       VALUE '9'.
  2948     12  AL-SADOF            PIC X       VALUE '@'.
  2949     12  AL-SADON            PIC X       VALUE QUOTE.
  2950     12  AL-SANOF            PIC X       VALUE '0'.
  2951     12  AL-SANON            PIC X       VALUE '1'.
  2952     12  AL-UABOF            PIC X       VALUE 'H'.
  2953     12  AL-UABON            PIC X       VALUE 'I'.
  2954     12  AL-UADOF            PIC X       VALUE '<'.
  2955     12  AL-UADON            PIC X       VALUE '('.
  2956     12  AL-UANOF            PIC X       VALUE ' '.
  2957     12  AL-UANON            PIC X       VALUE 'A'.
  2958     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2959     12  AL-UNBON            PIC X       VALUE 'R'.
  2960     12  AL-UNDOF            PIC X       VALUE '*'.
  2961     12  AL-UNDON            PIC X       VALUE ')'.
  2962     12  AL-UNNOF            PIC X       VALUE '&'.
  2963     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  56
* EL130.cbl
  2965*    COPY ELCEMIB.
  2966******************************************************************
  2967*                                                                *
  2968*                                                                *
  2969*                            ELCEMIB.                            *
  2970*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2971*                            VMOD=2.005                          *
  2972*                                                                *
  2973*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2974*                                                                *
  2975******************************************************************
  2976 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2977     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2978     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2979     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2980     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2981     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2982     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2983     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2984     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2985     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2986         88  EMI-NO-ERRORS                    VALUE '1'.
  2987         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2988         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2989     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2990         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2991     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2992         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2993         88  EMI-AREA1-FULL                   VALUE '2'.
  2994     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2995         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2996         88  EMI-AREA2-FULL                   VALUE '2'.
  2997     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2998         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2999         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3000         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3001         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3002         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3003     12  EMI-ERROR-LINES.
  3004         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3005         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3006         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3007         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3008             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3009                 24  EMI-ERR-NUM         PIC X(4).
  3010                 24  EMI-FILLER          PIC X.
  3011                 24  EMI-SEV             PIC X.
  3012                 24  FILLER              PIC X.
  3013             20  FILLER                  PIC X(02).
  3014     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3015         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3016             20  EMI-ERROR-NUMBER    PIC X(4).
  3017             20  EMI-FILL            PIC X.
  3018             20  EMI-SEVERITY        PIC X.
  3019             20  FILLER              PIC X.
  3020             20  EMI-ERROR-TEXT.
  3021                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3022                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  57
* EL130.cbl
  3023     12  EMI-SEVERITY-SAVE           PIC X.
  3024         88  EMI-NOTE                    VALUE 'N'.
  3025         88  EMI-WARNING                 VALUE 'W'.
  3026         88  EMI-FORCABLE                VALUE 'F'.
  3027         88  EMI-FATAL                   VALUE 'X'.
  3028     12  EMI-MESSAGE-FLAG            PIC X.
  3029         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3030         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3031     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3032     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3033         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3034         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3035         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3036     12  emi-claim-no                pic x(7).
  3037     12  emi-claim-type              pic x(6).
  3038     12  FILLER                      PIC X(124)  VALUE SPACES.
  3039     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3040     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3041     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3042     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  58
* EL130.cbl
  3044*    COPY ELCJPFX.
  3045******************************************************************
  3046*                                                                *
  3047*                                                                *
  3048*                            ELCJPFX.                            *
  3049*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3050*                            VMOD=2.002                          *
  3051*                                                                *
  3052*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3053*                                                                *
  3054*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3055*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3056*        ELCNTL - CONTROL FILE                                   *
  3057*        ELMSTR - CLAIM MASTERS                                  *
  3058*        ELTRLR - ACTIVITY TRAILERS                              *
  3059*        ELCHKQ - CHECK QUE                                      *
  3060******************************************************************
  3061 01  JOURNAL-RECORD.
  3062     12  jp-date                     pic s9(5) comp-3.
  3063     12  jp-time                     pic s9(7) comp-3.
  3064     12  JP-USER-ID                  PIC X(4).
  3065     12  JP-FILE-ID                  PIC X(8).
  3066     12  JP-PROGRAM-ID               PIC X(8).
  3067     12  JP-RECORD-TYPE              PIC X.
  3068         88 JP-ADD              VALUE 'A'.
  3069         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3070         88 JP-AFTER-CHANGE     VALUE 'C'.
  3071         88 JP-DELETE           VALUE 'D'.
  3072         88 JP-GENERIC-DELETE   VALUE 'G'.
  3073         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3074         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3075     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3076     12  JP-RECORD-AREA
  3077
  3078
  3079         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  59
* EL130.cbl
  3081*    COPY ELCAID.
  3082******************************************************************
  3083*                                                                *
  3084*                            ELCAID.                             *
  3085*                            VMOD=2.001                          *
  3086*                                                                *
  3087*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3088*                                                                *
  3089*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3090*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3091******************************************************************
  3092
  3093 01  DFHAID.
  3094   02  DFHNULL   PIC  X  VALUE  ' '.
  3095   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3096   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3097   02  DFHPEN    PIC  X  VALUE  '='.
  3098   02  DFHOPID   PIC  X  VALUE  'W'.
  3099   02  DFHPA1    PIC  X  VALUE  '%'.
  3100   02  DFHPA2    PIC  X  VALUE  '>'.
  3101   02  DFHPA3    PIC  X  VALUE  ','.
  3102   02  DFHPF1    PIC  X  VALUE  '1'.
  3103   02  DFHPF2    PIC  X  VALUE  '2'.
  3104   02  DFHPF3    PIC  X  VALUE  '3'.
  3105   02  DFHPF4    PIC  X  VALUE  '4'.
  3106   02  DFHPF5    PIC  X  VALUE  '5'.
  3107   02  DFHPF6    PIC  X  VALUE  '6'.
  3108   02  DFHPF7    PIC  X  VALUE  '7'.
  3109   02  DFHPF8    PIC  X  VALUE  '8'.
  3110   02  DFHPF9    PIC  X  VALUE  '9'.
  3111   02  DFHPF10   PIC  X  VALUE  ':'.
  3112   02  DFHPF11   PIC  X  VALUE  '#'.
  3113   02  DFHPF12   PIC  X  VALUE  '@'.
  3114   02  DFHPF13   PIC  X  VALUE  'A'.
  3115   02  DFHPF14   PIC  X  VALUE  'B'.
  3116   02  DFHPF15   PIC  X  VALUE  'C'.
  3117   02  DFHPF16   PIC  X  VALUE  'D'.
  3118   02  DFHPF17   PIC  X  VALUE  'E'.
  3119   02  DFHPF18   PIC  X  VALUE  'F'.
  3120   02  DFHPF19   PIC  X  VALUE  'G'.
  3121   02  DFHPF20   PIC  X  VALUE  'H'.
  3122   02  DFHPF21   PIC  X  VALUE  'I'.
  3123*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3124   02  DFHPF22   PIC  X  VALUE  '['.
  3125   02  DFHPF23   PIC  X  VALUE  '.'.
  3126   02  DFHPF24   PIC  X  VALUE  '<'.
  3127   02  DFHMSRE   PIC  X  VALUE  'X'.
  3128   02  DFHSTRF   PIC  X  VALUE  'h'.
  3129   02  DFHTRIG   PIC  X  VALUE  '"'.
  3130
  3131 01  FILLER    REDEFINES DFHAID.
  3132     12  FILLER              PIC X(8).
  3133     12  PF-VALUES           PIC X       OCCURS 12.
  3134
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  60
* EL130.cbl
  3136****************************************************************
  3137*
  3138* Copyright (c) 2007-2013 Dell Inc.
  3139* All rights reserved.
  3140*
  3141****************************************************************
  3142 01  DFHEIV.
  3143   02  DFHEIV0               PIC X(35).
  3144   02  DFHEIV1               PIC X(08).
  3145   02  DFHEIV2               PIC X(08).
  3146   02  DFHEIV3               PIC X(08).
  3147   02  DFHEIV4               PIC X(06).
  3148   02  DFHEIV5               PIC X(04).
  3149   02  DFHEIV6               PIC X(04).
  3150   02  DFHEIV7               PIC X(02).
  3151   02  DFHEIV8               PIC X(02).
  3152   02  DFHEIV9               PIC X(01).
  3153   02  DFHEIV10              PIC S9(7) COMP-3.
  3154   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3155   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3156   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3157   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3158   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3159   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3160   02  DFHEIV17              PIC X(04).
  3161   02  DFHEIV18              PIC X(04).
  3162   02  DFHEIV19              PIC X(04).
  3163   02  DFHEIV20              USAGE IS POINTER.
  3164   02  DFHEIV21              USAGE IS POINTER.
  3165   02  DFHEIV22              USAGE IS POINTER.
  3166   02  DFHEIV23              USAGE IS POINTER.
  3167   02  DFHEIV24              USAGE IS POINTER.
  3168   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3169   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3170   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3171   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3172   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3173   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3174   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3175   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3176   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3177   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3178   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3179   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3180   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3181   02  FILLER                PIC X(02).
  3182   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3183   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3184   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3185   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3186   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3187   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3188   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3189 LINKAGE  SECTION.
  3190*****************************************************************
  3191*                                                               *
  3192* Copyright (c) 2007-2013 Dell Inc.                             *
  3193* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  61
* EL130.cbl
  3194*                                                               *
  3195*****************************************************************
  3196 01  dfheiblk.
  3197     02  eibtime          pic s9(7) comp-3.
  3198     02  eibdate          pic s9(7) comp-3.
  3199     02  eibtrnid         pic x(4).
  3200     02  eibtaskn         pic s9(7) comp-3.
  3201     02  eibtrmid         pic x(4).
  3202     02  dfheigdi         pic s9(4) comp.
  3203     02  eibcposn         pic s9(4) comp.
  3204     02  eibcalen         pic s9(4) comp.
  3205     02  eibaid           pic x(1).
  3206     02  eibfiller1       pic x(1).
  3207     02  eibfn            pic x(2).
  3208     02  eibfiller2       pic x(2).
  3209     02  eibrcode         pic x(6).
  3210     02  eibfiller3       pic x(2).
  3211     02  eibds            pic x(8).
  3212     02  eibreqid         pic x(8).
  3213     02  eibrsrce         pic x(8).
  3214     02  eibsync          pic x(1).
  3215     02  eibfree          pic x(1).
  3216     02  eibrecv          pic x(1).
  3217     02  eibsend          pic x(1).
  3218     02  eibatt           pic x(1).
  3219     02  eibeoc           pic x(1).
  3220     02  eibfmh           pic x(1).
  3221     02  eibcompl         pic x(1).
  3222     02  eibsig           pic x(1).
  3223     02  eibconf          pic x(1).
  3224     02  eiberr           pic x(1).
  3225     02  eibrldbk         pic x(1).
  3226     02  eiberrcd         pic x(4).
  3227     02  eibsynrb         pic x(1).
  3228     02  eibnodat         pic x(1).
  3229     02  eibfiller5       pic x(2).
  3230     02  eibresp          pic s9(8) comp.
  3231     02  eibresp2         pic s9(8) comp.
  3232     02  dfheigdj         pic s9(4) comp.
  3233     02  dfheigdk         pic s9(4) comp.
  3234
  3235 01  DFHCOMMAREA             PIC X(1024).
  3236
  3237*01 PARMLIST .
  3238*    02  FILLER              PIC S9(8)   COMP.
  3239*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3240*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3241*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3242*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3243*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3244*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3245*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3246*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3247*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  62
* EL130.cbl
  3249*    COPY ELCMSTR.
  3250******************************************************************
  3251*                                                                *
  3252*                            ELCMSTR.                            *
  3253*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3254*                            VMOD=2.012                          *
  3255*                                                                *
  3256*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3257*                                                                *
  3258*   FILE TYPE = VSAM,KSDS                                        *
  3259*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3260*                                                                *
  3261*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3262*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3263*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3264*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3265*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3266*                                                 RKP=75,LEN=21  *
  3267*                                                                *
  3268*   **** NOTE ****                                               *
  3269*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3270*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3271*                                                                *
  3272*   LOG = YES                                                    *
  3273*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3274******************************************************************
  3275*                   C H A N G E   L O G
  3276*
  3277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3278*-----------------------------------------------------------------
  3279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3280* EFFECTIVE    NUMBER
  3281*-----------------------------------------------------------------
  3282* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3283* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3284* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3285* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3286* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3287* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3288******************************************************************
  3289 01  CLAIM-MASTER.
  3290     12  CL-RECORD-ID                PIC XX.
  3291         88  VALID-CL-ID         VALUE 'CL'.
  3292
  3293     12  CL-CONTROL-PRIMARY.
  3294         16  CL-COMPANY-CD           PIC X.
  3295         16  CL-CARRIER              PIC X.
  3296         16  CL-CLAIM-NO             PIC X(7).
  3297         16  CL-CERT-NO.
  3298             20  CL-CERT-PRIME       PIC X(10).
  3299             20  CL-CERT-SFX         PIC X.
  3300
  3301     12  CL-CONTROL-BY-NAME.
  3302         16  CL-COMPANY-CD-A1        PIC X.
  3303         16  CL-INSURED-LAST-NAME    PIC X(15).
  3304         16  CL-INSURED-NAME.
  3305             20  CL-INSURED-1ST-NAME PIC X(12).
  3306             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  63
* EL130.cbl
  3307
  3308     12  CL-CONTROL-BY-SSN.
  3309         16  CL-COMPANY-CD-A2        PIC X.
  3310         16  CL-SOC-SEC-NO.
  3311             20  CL-SSN-STATE        PIC XX.
  3312             20  CL-SSN-ACCOUNT      PIC X(6).
  3313             20  CL-SSN-LN3          PIC X(3).
  3314
  3315     12  CL-CONTROL-BY-CERT-NO.
  3316         16  CL-COMPANY-CD-A4        PIC X.
  3317         16  CL-CERT-NO-A4.
  3318             20  CL-CERT-A4-PRIME    PIC X(10).
  3319             20  CL-CERT-A4-SFX      PIC X.
  3320
  3321     12  CL-CONTROL-BY-CCN.
  3322         16  CL-COMPANY-CD-A5        PIC X.
  3323         16  CL-CCN-A5.
  3324             20  CL-CCN.
  3325                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3326                 24  CL-CCN-PRIME-A5 PIC X(12).
  3327             20  CL-CCN-FILLER-A5    PIC X(4).
  3328
  3329     12  CL-INSURED-PROFILE-DATA.
  3330         16  CL-INSURED-BIRTH-DT     PIC XX.
  3331         16  CL-INSURED-SEX-CD       PIC X.
  3332             88  INSURED-IS-MALE        VALUE 'M'.
  3333             88  INSURED-IS-FEMALE      VALUE 'F'.
  3334             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3335         16  CL-INSURED-OCC-CD       PIC X(6).
  3336         16  FILLER                  PIC X(5).
  3337
  3338     12  CL-PROCESSING-INFO.
  3339         16  CL-PROCESSOR-ID         PIC X(4).
  3340         16  CL-CLAIM-STATUS         PIC X.
  3341             88  CLAIM-IS-OPEN          VALUE 'O'.
  3342             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3343         16  CL-CLAIM-TYPE           PIC X.
  3344*            88  AH-CLAIM               VALUE 'A'.
  3345*            88  LIFE-CLAIM             VALUE 'L'.
  3346*            88  PROPERTY-CLAIM         VALUE 'P'.
  3347*            88  IUI-CLAIM              VALUE 'I'.
  3348*            88  GAP-CLAIM              VALUE 'G'.
  3349*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3350         16  CL-CLAIM-PREM-TYPE      PIC X.
  3351             88  SINGLE-PREMIUM         VALUE '1'.
  3352             88  O-B-COVERAGE           VALUE '2'.
  3353             88  OPEN-END-COVERAGE      VALUE '3'.
  3354         16  CL-INCURRED-DT          PIC XX.
  3355         16  CL-REPORTED-DT          PIC XX.
  3356         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3357         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3358         16  CL-LAST-PMT-DT          PIC XX.
  3359         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3360         16  CL-PAID-THRU-DT         PIC XX.
  3361         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3362         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3363         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3364         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  64
* EL130.cbl
  3365             88  CL-360-DAY-YR          VALUE '1'.
  3366             88  CL-365-DAY-YR          VALUE '2'.
  3367             88  CL-FULL-MONTHS         VALUE '3'.
  3368         16  CL-CAUSE-CD             PIC X(6).
  3369
  3370         16  CL-PRIME-CERT-NO.
  3371             20  CL-PRIME-CERT-PRIME PIC X(10).
  3372             20  CL-PRIME-CERT-SFX   PIC X.
  3373
  3374         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3375             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3376             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3377
  3378         16  CL-MICROFILM-NO         PIC X(10).
  3379         16  FILLER REDEFINES CL-MICROFILM-NO.
  3380             20  CL-BENEFIT-PERIOD   PIC 99.
  3381             20  FILLER              PIC X(8).
  3382         16  CL-PROG-FORM-TYPE       PIC X.
  3383         16  CL-LAST-ADD-ON-DT       PIC XX.
  3384
  3385         16  CL-LAST-REOPEN-DT       PIC XX.
  3386         16  CL-LAST-CLOSE-DT        PIC XX.
  3387         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3388             88  FINAL-PAID             VALUE '1'.
  3389             88  CLAIM-DENIED           VALUE '2'.
  3390             88  AUTO-CLOSE             VALUE '3'.
  3391             88  MANUAL-CLOSE           VALUE '4'.
  3392             88  BENEFITS-CHANGED       VALUE 'C'.
  3393             88  SETUP-ERRORS           VALUE 'E'.
  3394         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3395         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3396         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3397             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3398         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3399         16  FILLER                  PIC X.
  3400
  3401     12  CL-CERTIFICATE-DATA.
  3402         16  CL-CERT-ORIGIN          PIC X.
  3403             88  CERT-WAS-ONLINE        VALUE '1'.
  3404             88  CERT-WAS-CREATED       VALUE '2'.
  3405             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3406         16  CL-CERT-KEY-DATA.
  3407             20  CL-CERT-CARRIER     PIC X.
  3408             20  CL-CERT-GROUPING    PIC X(6).
  3409             20  CL-CERT-STATE       PIC XX.
  3410             20  CL-CERT-ACCOUNT.
  3411                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3412                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3413             20  CL-CERT-EFF-DT      PIC XX.
  3414
  3415     12  CL-STATUS-CONTROLS.
  3416         16  CL-PRIORITY-CD          PIC X.
  3417             88  CONFIDENTIAL-DATA      VALUE '8'.
  3418             88  HIGHEST-PRIORITY       VALUE '9'.
  3419         16  CL-SUPV-ATTN-CD         PIC X.
  3420             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3421             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3422         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  65
* EL130.cbl
  3423         16  CL-RESTORED-DT          PIC XX.
  3424         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3425         16  CL-NEXT-RESEND-DT       PIC XX.
  3426         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3427         16  CL-CRITICAL-PERIOD      PIC 99.
  3428*        16  FILLER                  PIC XX.
  3429         16  CL-LAST-MAINT-DT        PIC XX.
  3430         16  CL-LAST-MAINT-USER      PIC X(4).
  3431         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3432         16  CL-LAST-MAINT-TYPE      PIC X.
  3433             88  CLAIM-SET-UP           VALUE ' '.
  3434             88  PAYMENT-MADE           VALUE '1'.
  3435             88  LETTER-SENT            VALUE '2'.
  3436             88  MASTER-WAS-ALTERED     VALUE '3'.
  3437             88  MASTER-WAS-RESTORED    VALUE '4'.
  3438             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3439             88  FILE-CONVERTED         VALUE '6'.
  3440             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3441             88  ERROR-CORRECTION       VALUE 'E'.
  3442         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3443         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3444         16  CL-BENEFICIARY          PIC X(10).
  3445         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3446         16  CL-DENIAL-TYPE          PIC X.
  3447             88  CL-TYPE-DENIAL          VALUE '1'.
  3448             88  CL-TYPE-RESCISSION      VALUE '2'.
  3449             88  CL-TYPE-REFORMATION     VALUE '3'.
  3450             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3451             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3452         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3453         16  filler                  pic x(3).
  3454*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3455*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3456*        16  CL-RTW-DT               PIC XX.
  3457
  3458     12  CL-TRAILER-CONTROLS.
  3459         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3460             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3461             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3462             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3463         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3464         16  FILLER                  PIC XX.
  3465         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3466         16  CL-ADDRESS-TRAILER-CNT.
  3467             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3468                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3469             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3470                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3471             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3472                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3473             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3474                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3475             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3476                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3477             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3478                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3479             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3480                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  66
* EL130.cbl
  3481
  3482     12  CL-CV-REFERENCE-NO.
  3483         16  CL-CV-REFNO-PRIME       PIC X(18).
  3484         16  CL-CV-REFNO-SFX         PIC XX.
  3485
  3486     12  CL-FILE-LOCATION            PIC X(4).
  3487
  3488     12  CL-PROCESS-ERRORS.
  3489         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3490             88  NO-FATAL-ERRORS        VALUE ZERO.
  3491         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3492             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3493
  3494     12  CL-PRODUCT-CD               PIC X.
  3495
  3496     12  CL-CURRENT-KEY-DATA.
  3497         16  CL-CURRENT-CARRIER      PIC X.
  3498         16  CL-CURRENT-GROUPING     PIC X(6).
  3499         16  CL-CURRENT-STATE        PIC XX.
  3500         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3501
  3502     12  CL-ASSOCIATES               PIC X.
  3503         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3504         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3505         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3506         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3507
  3508     12  CL-ACTIVITY-CODE            PIC 99.
  3509     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3510     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3511
  3512     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3513     12  CL-LAG-REPORT-CODE          PIC 9.
  3514     12  CL-LOAN-TYPE                PIC XX.
  3515     12  CL-LEGAL-STATE              PIC XX.
  3516
  3517     12  CL-YESNOSW                  PIC X.
  3518     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3519         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3520         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3521         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3522     12  cl-insured-type             pic x.
  3523         88  cl-claim-on-primary         value 'P'.
  3524         88  cl-claim-on-co-borrower     value 'C'.
  3525     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  67
* EL130.cbl
  3527*    COPY ELCCNTL.
  3528******************************************************************
  3529*                                                                *
  3530*                                                                *
  3531*                            ELCCNTL.                            *
  3532*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3533*                            VMOD=2.059                          *
  3534*                                                                *
  3535*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3536*                                                                *
  3537*   FILE TYPE = VSAM,KSDS                                        *
  3538*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3539*                                                                *
  3540*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3541*       ALTERNATE INDEX = NONE                                   *
  3542*                                                                *
  3543*   LOG = YES                                                    *
  3544*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3545******************************************************************
  3546*                   C H A N G E   L O G
  3547*
  3548* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3549*-----------------------------------------------------------------
  3550*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3551* EFFECTIVE    NUMBER
  3552*-----------------------------------------------------------------
  3553* 082503                   PEMA  ADD BENEFIT GROUP
  3554* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3555* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3556* 092705    2005050300006  PEMA  ADD SPP LEASES
  3557* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3558* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3559* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3560* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3561* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3562* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3563* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3564* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3565* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3566* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3567* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  3568******************************************************************
  3569*
  3570 01  CONTROL-FILE.
  3571     12  CF-RECORD-ID                       PIC XX.
  3572         88  VALID-CF-ID                        VALUE 'CF'.
  3573
  3574     12  CF-CONTROL-PRIMARY.
  3575         16  CF-COMPANY-ID                  PIC XXX.
  3576         16  CF-RECORD-TYPE                 PIC X.
  3577             88  CF-COMPANY-MASTER              VALUE '1'.
  3578             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3579             88  CF-STATE-MASTER                VALUE '3'.
  3580             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3581             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3582             88  CF-CARRIER-MASTER              VALUE '6'.
  3583             88  CF-MORTALITY-MASTER            VALUE '7'.
  3584             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  68
* EL130.cbl
  3585             88  CF-TERMINAL-MASTER             VALUE '9'.
  3586             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3587             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3588             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3589             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3590             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3591             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3592             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3593             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3594             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3595         16  CF-ACCESS-CD-GENL              PIC X(4).
  3596         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3597             20  CF-PROCESSOR               PIC X(4).
  3598         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3599             20  CF-STATE-CODE              PIC XX.
  3600             20  FILLER                     PIC XX.
  3601         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3602             20  FILLER                     PIC XX.
  3603             20  CF-HI-BEN-IN-REC           PIC XX.
  3604         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3605             20  FILLER                     PIC XXX.
  3606             20  CF-CARRIER-CNTL            PIC X.
  3607         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3608             20  FILLER                     PIC XX.
  3609             20  CF-HI-TYPE-IN-REC          PIC 99.
  3610         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3611             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3612                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3613             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3614             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3615         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3616             20  FILLER                     PIC X.
  3617             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3618         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3619             20  FILLER                     PIC XX.
  3620             20  CF-MORTGAGE-PLAN           PIC XX.
  3621         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3622
  3623     12  CF-LAST-MAINT-DT                   PIC XX.
  3624     12  CF-LAST-MAINT-BY                   PIC X(4).
  3625     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3626
  3627     12  CF-RECORD-BODY                     PIC X(728).
  3628
  3629
  3630****************************************************************
  3631*             COMPANY MASTER RECORD                            *
  3632****************************************************************
  3633
  3634     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3635         16  CF-COMPANY-ADDRESS.
  3636             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3637             20  CF-CL-IN-CARE-OF           PIC X(30).
  3638             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3639             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3640             20  CF-CL-CITY-STATE           PIC X(30).
  3641             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3642             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  69
* EL130.cbl
  3643         16  CF-COMPANY-CD                  PIC X.
  3644         16  CF-COMPANY-PASSWORD            PIC X(8).
  3645         16  CF-SECURITY-OPTION             PIC X.
  3646             88  ALL-SECURITY                   VALUE '1'.
  3647             88  COMPANY-VERIFY                 VALUE '2'.
  3648             88  PROCESSOR-VERIFY               VALUE '3'.
  3649             88  NO-SECURITY                    VALUE '4'.
  3650             88  ALL-BUT-TERM                   VALUE '5'.
  3651         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3652             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3653         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3654             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3655         16  CF-INFORCE-LOCATION            PIC X.
  3656             88  CERTS-ARE-ONLINE               VALUE '1'.
  3657             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3658             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3659         16  CF-LOWER-CASE-LETTERS          PIC X.
  3660         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3661             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3662             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3663             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3664             88  CF-ACCNT-CNTL                  VALUE '3'.
  3665             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3666
  3667         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3668         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3669
  3670         16  CF-LGX-CREDIT-USER             PIC X.
  3671             88  CO-IS-NOT-USER                 VALUE 'N'.
  3672             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3673
  3674         16 CF-CREDIT-CALC-CODES.
  3675             20  CF-CR-REM-TERM-CALC PIC X.
  3676               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3677               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3678               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3679               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3680               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3681               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3682               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3683             20  CF-CR-R78-METHOD           PIC X.
  3684               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3685               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3686
  3687         16  CF-CLAIM-CONTROL-COUNTS.
  3688             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3689                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3690
  3691             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3692                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3693
  3694             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3695                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3696
  3697             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3698                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3699
  3700         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  70
* EL130.cbl
  3701
  3702         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3703             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3704             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3705             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3706             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3707                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3708                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3709             20  CF-CO-PREM-REJECT-SW       PIC X.
  3710                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3711                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3712             20  CF-CO-REF-REJECT-SW        PIC X.
  3713                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3714                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3715
  3716         16  CF-CO-REPORTING-DT             PIC XX.
  3717         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3718         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3719           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3720           88  CF-CO-MONTH-END                  VALUE '1'.
  3721
  3722         16  CF-LGX-CLAIM-USER              PIC X.
  3723             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3724             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3725
  3726         16  CF-CREDIT-EDIT-CONTROLS.
  3727             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3728             20  CF-MIN-AGE                 PIC 99.
  3729             20  CF-DEFAULT-AGE             PIC 99.
  3730             20  CF-MIN-TERM                PIC S999      COMP-3.
  3731             20  CF-MAX-TERM                PIC S999      COMP-3.
  3732             20  CF-DEFAULT-SEX             PIC X.
  3733             20  CF-JOINT-AGE-INPUT         PIC X.
  3734                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3735             20  CF-BIRTH-DATE-INPUT        PIC X.
  3736                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3737             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3738                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3739                 88  CF-ZERO-CARRIER            VALUE '1'.
  3740                 88  CF-ZERO-GROUPING           VALUE '2'.
  3741                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3742             20  CF-EDIT-SW                 PIC X.
  3743                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3744             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3745             20  CF-CR-PR-METHOD            PIC X.
  3746               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3747               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3748             20  FILLER                     PIC X.
  3749
  3750         16  CF-CREDIT-MISC-CONTROLS.
  3751             20  CF-REIN-TABLE-SW           PIC X.
  3752                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3753             20  CF-COMP-TABLE-SW           PIC X.
  3754                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3755             20  CF-EXPERIENCE-RETENTION-AGE
  3756                                            PIC S9        COMP-3.
  3757             20  CF-CONVERSION-DT           PIC XX.
  3758             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  71
* EL130.cbl
  3759             20  CF-RUN-FREQUENCY-SW        PIC X.
  3760                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3761                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3762
  3763             20  CF-CR-CHECK-NO-CONTROL.
  3764                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3765                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3766                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3767                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3768                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3769                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3770
  3771                 24  CF-CR-CHECK-COUNT       REDEFINES
  3772                     CF-CR-CHECK-COUNTER      PIC X(4).
  3773
  3774                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3775                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3776
  3777                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3778                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3779                 24  CF-MAIL-PROCESSING       PIC X.
  3780                     88  MAIL-PROCESSING          VALUE 'Y'.
  3781
  3782         16  CF-MISC-SYSTEM-CONTROL.
  3783             20  CF-SYSTEM-C                 PIC X.
  3784                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3785             20  CF-SYSTEM-D                 PIC X.
  3786                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3787             20  CF-SOC-SEC-NO-SW            PIC X.
  3788                 88  SOC-SEC-NO-USED             VALUE '1'.
  3789             20  CF-MEMBER-NO-SW             PIC X.
  3790                 88  MEMBER-NO-USED              VALUE '1'.
  3791             20  CF-TAX-ID-NUMBER            PIC X(11).
  3792             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3793             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3794                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3795                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3796                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3797                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3798             20  CF-SYSTEM-E                 PIC X.
  3799                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3800
  3801         16  CF-LGX-LIFE-USER               PIC X.
  3802             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3803             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3804
  3805         16  CF-CR-MONTH-END-DT             PIC XX.
  3806
  3807         16  CF-FILE-MAINT-DATES.
  3808             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3809                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3810             20  CF-LAST-BATCH       REDEFINES
  3811                 CF-LAST-BATCH-NO               PIC X(4).
  3812             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3813             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3814             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3815             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3816             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  72
* EL130.cbl
  3817             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3818             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3819             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3820             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3821             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3822
  3823         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3824         16  FILLER                         PIC X.
  3825
  3826         16  CF-ALT-MORT-CODE               PIC X(4).
  3827         16  CF-MEMBER-CAPTION              PIC X(10).
  3828
  3829         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3830             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3831             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3832             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3833             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3834             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3835
  3836         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3837
  3838         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3839         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3840         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3841         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3842
  3843         16  CF-AH-OVERRIDE-L1              PIC X.
  3844         16  CF-AH-OVERRIDE-L2              PIC XX.
  3845         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3846         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3847
  3848         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3849         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3850
  3851         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3852         16  CF-AR-LAST-EL860-DT            PIC XX.
  3853         16  CF-MP-MONTH-END-DT             PIC XX.
  3854
  3855         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3856         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3857             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3858
  3859         16  CF-AR-MONTH-END-DT             PIC XX.
  3860
  3861         16  CF-CRDTCRD-USER                PIC X.
  3862             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3863             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3864
  3865         16  CF-CC-MONTH-END-DT             PIC XX.
  3866
  3867         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3868
  3869         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3870             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3871             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3872             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3873         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3874         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  73
* EL130.cbl
  3875         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3876         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3877             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3878             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3879         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3880         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3881         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3882             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3883         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3884
  3885         16  CF-CL-ZIP-CODE.
  3886             20  CF-CL-ZIP-PRIME.
  3887                 24  CF-CL-ZIP-1ST          PIC X.
  3888                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3889                 24  FILLER                 PIC X(4).
  3890             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3891         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3892             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3893             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3894             20  FILLER                     PIC XXX.
  3895
  3896         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3897         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3898         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3899         16  CF-CO-OPTION-START-DATE        PIC XX.
  3900         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3901           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3902                                                      '3' '4'.
  3903           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3904           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3905           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3906           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3907           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3908           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3909
  3910         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3911
  3912         16  CF-PAYMENT-APPROVAL-LEVELS.
  3913             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3914             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3915             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3916             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3917             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3918             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3919
  3920         16  CF-END-USER-REPORTING-USER     PIC X.
  3921             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3922             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3923
  3924         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3925             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3926             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3927
  3928         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3929
  3930         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3931         16  FILLER                         PIC X.
  3932
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  74
* EL130.cbl
  3933         16  CF-CREDIT-ARCHIVE-CNTL.
  3934             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3935             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3936             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3937
  3938         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3939
  3940         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3941             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3942             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3943
  3944         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3945             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3946             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3947
  3948         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3949
  3950         16  CF-CO-ACH-ID-CODE              PIC  X.
  3951             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3952             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3953             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3954         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3955         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3956         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3957         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3958         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3959         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3960         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3961         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3962         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3963                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3964         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3965                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3966
  3967         16  CF-CO-OVER-SHORT.
  3968             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3969             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3970
  3971*         16  FILLER                         PIC X(102).
  3972         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3973             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3974             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3975
  3976         16  CF-AH-APPROVAL-DAYS.
  3977             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3978             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3979             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3980             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3981
  3982         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3983
  3984         16  CF-APPROV-LEV-5.
  3985             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3986             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3987             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3988
  3989         16  FILLER                         PIC X(68).
  3990****************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  75
* EL130.cbl
  3991*             PROCESSOR/USER RECORD                            *
  3992****************************************************************
  3993
  3994     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3995         16  CF-PROCESSOR-NAME              PIC X(30).
  3996         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3997         16  CF-PROCESSOR-TITLE             PIC X(26).
  3998         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3999                 88  MESSAGE-YES                VALUE 'Y'.
  4000                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4001
  4002*****************************************************
  4003****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4004****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4005****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4006****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4007*****************************************************
  4008
  4009         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4010             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4011             20  CF-APPLICATION-FORCE       PIC X.
  4012             20  CF-INDIVIDUAL-APP.
  4013                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4014                     28  CF-BROWSE-APP      PIC X.
  4015                     28  CF-UPDATE-APP      PIC X.
  4016
  4017         16  CF-CURRENT-TERM-ON             PIC X(4).
  4018         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4019             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4020             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4021             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4022             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4023             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4024             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4025             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4026         16  CF-PROCESSOR-CARRIER           PIC X.
  4027             88  NO-CARRIER-SECURITY            VALUE ' '.
  4028         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4029             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4030         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4031             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4032         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4033             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4034
  4035         16  CF-PROC-SYS-ACCESS-SW.
  4036             20  CF-PROC-CREDIT-CLAIMS-SW.
  4037                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4038                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4039                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4040                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4041             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4042                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4043                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4044             20  CF-PROC-LIFE-GNRLDGR-SW.
  4045                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4046                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4047                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4048                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  76
* EL130.cbl
  4049             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4050                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4051                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4052         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4053             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4054             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4055         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4056
  4057         16  CF-APPROVAL-LEVEL                  PIC X.
  4058             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4059             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4060             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4061             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4062             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4063
  4064         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4065
  4066         16  CF-LANGUAGE-TYPE                   PIC X.
  4067             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4068             88  CF-LANG-IS-FR                      VALUE 'F'.
  4069
  4070         16  CF-CSR-IND                         PIC X.
  4071         16  FILLER                             PIC X(239).
  4072
  4073****************************************************************
  4074*             PROCESSOR/REMINDERS RECORD                       *
  4075****************************************************************
  4076
  4077     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4078         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4079             20  CF-START-REMIND-DT         PIC XX.
  4080             20  CF-END-REMIND-DT           PIC XX.
  4081             20  CF-REMINDER-TEXT           PIC X(50).
  4082         16  FILLER                         PIC X(296).
  4083
  4084
  4085****************************************************************
  4086*             STATE MASTER RECORD                              *
  4087****************************************************************
  4088
  4089     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4090         16  CF-STATE-ABBREVIATION          PIC XX.
  4091         16  CF-STATE-NAME                  PIC X(25).
  4092         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4093         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4094             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4095             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4096             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4097             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4098                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4099                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4100             20  CF-ST-PREM-REJECT-SW       PIC X.
  4101                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4102                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4103             20  CF-ST-REF-REJECT-SW        PIC X.
  4104                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4105                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4106         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  77
* EL130.cbl
  4107         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4108         16  CF-ST-REFUND-RULES.
  4109             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4110             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4111             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4112         16  CF-ST-FST-PMT-EXTENSION.
  4113             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4114             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4115                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4116                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4117                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4118                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4119         16  CF-ST-STATE-CALL.
  4120             20  CF-ST-CALL-UNEARNED        PIC X.
  4121             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4122             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4123         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4124             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4125             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4126         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4127         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4128         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4129         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4130         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4131         16  FILLER                         PIC X.
  4132         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4133             20  CF-ST-BENEFIT-CD           PIC XX.
  4134             20  CF-ST-BENEFIT-KIND         PIC X.
  4135                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4136                 88  CF-ST-AH-KIND              VALUE 'A'.
  4137             20  CF-ST-REM-TERM-CALC        PIC X.
  4138                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4139                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4140                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4141                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4142                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4143                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4144                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4145                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4146
  4147             20  CF-ST-REFUND-CALC          PIC X.
  4148                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4149                 88  ST-REFD-BY-R78             VALUE '1'.
  4150                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4151                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4152                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4153                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4154                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4155                 88  ST-REFD-UTAH               VALUE '7'.
  4156                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4157                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4158                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4159
  4160             20  CF-ST-EARNING-CALC         PIC X.
  4161                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4162                 88  ST-EARN-BY-R78             VALUE '1'.
  4163                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4164                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  78
* EL130.cbl
  4165                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4166                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4167                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4168                 88  ST-EARN-MEAN               VALUE '8'.
  4169                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4170
  4171             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4172                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4173                 88  ST-OVRD-BY-R78             VALUE '1'.
  4174                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4175                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4176                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4177                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4178                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4179                 88  ST-OVRD-MEAN               VALUE '8'.
  4180                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4181             20  cf-st-extra-periods        pic 9.
  4182*            20  FILLER                     PIC X.
  4183
  4184         16  CF-ST-COMMISSION-CAPS.
  4185             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4186             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4187             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4188             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4189         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4190                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4191                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4192                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4193
  4194         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4195
  4196         16  CF-ST-STATUTORY-INTEREST.
  4197             20  CF-ST-STAT-DATE-FROM       PIC X.
  4198                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4199                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4200             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4201             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4202             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4203             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4204             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4205
  4206         16  CF-ST-OVER-SHORT.
  4207             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4208             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4209
  4210         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4211
  4212         16  CF-ST-RT-CALC                  PIC X.
  4213
  4214         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4215         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4216         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4217         16  CF-ST-RF-LR-CALC               PIC X.
  4218         16  CF-ST-RF-LL-CALC               PIC X.
  4219         16  CF-ST-RF-LN-CALC               PIC X.
  4220         16  CF-ST-RF-AH-CALC               PIC X.
  4221         16  CF-ST-RF-CP-CALC               PIC X.
  4222*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  79
* EL130.cbl
  4223*CIDMOD         16  FILLER                         PIC X(192).
  4224         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4225             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4226         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4227         16  CF-ST-VFY-2ND-BENE             PIC X.
  4228         16  CF-ST-CAUSAL-STATE             PIC X.
  4229         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4230         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4231         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4232             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4233         16  CF-ST-NET-ONLY-STATE           PIC X.
  4234             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4235         16  cf-commission-cap-required     pic x.
  4236         16  CF-ST-GA-COMMISSION-CAPS.
  4237             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4238             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4239             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4240             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4241         16  CF-ST-TOT-COMMISSION-CAPS.
  4242             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4243             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4244             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4245             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4246         16  FILLER                         PIC X(156).
  4247
  4248****************************************************************
  4249*             BENEFIT MASTER RECORD                            *
  4250****************************************************************
  4251
  4252     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4253         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4254             20  CF-BENEFIT-CODE            PIC XX.
  4255             20  CF-BENEFIT-NUMERIC  REDEFINES
  4256                 CF-BENEFIT-CODE            PIC XX.
  4257             20  CF-BENEFIT-ALPHA           PIC XXX.
  4258             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4259             20  CF-BENEFIT-COMMENT         PIC X(10).
  4260
  4261             20  CF-LF-COVERAGE-TYPE        PIC X.
  4262                 88  CF-REDUCING                VALUE 'R'.
  4263                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4264
  4265             20  CF-SPECIAL-CALC-CD         PIC X.
  4266                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4267                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4268                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4269                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4270                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4271                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4272                 88  CF-FARM-PLAN               VALUE 'F'.
  4273                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4274                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4275                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4276                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4277                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4278                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4279                 88  CF-PRUDENTIAL              VALUE 'P'.
  4280                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  80
* EL130.cbl
  4281                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4282                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4283                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4284                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4285                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4286
  4287             20  CF-JOINT-INDICATOR         PIC X.
  4288                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4289
  4290*            20  FILLER                     PIC X(12).
  4291             20  cf-maximum-benefits        pic s999 comp-3.
  4292             20  FILLER                     PIC X(09).
  4293             20  CF-BENEFIT-CATEGORY        PIC X.
  4294             20  CF-LOAN-TYPE               PIC X(8).
  4295
  4296             20  CF-CO-REM-TERM-CALC        PIC X.
  4297                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4298                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4299                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4300                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4301                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4302
  4303             20  CF-CO-EARNINGS-CALC        PIC X.
  4304                 88  CO-EARN-BY-R78             VALUE '1'.
  4305                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4306                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4307                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4308                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4309                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4310                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4311                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4312
  4313             20  CF-CO-REFUND-CALC          PIC X.
  4314                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4315                 88  CO-REFD-BY-R78             VALUE '1'.
  4316                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4317                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4318                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4319                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4320                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4321                 88  CO-REFD-MEAN               VALUE '8'.
  4322                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4323                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4324                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4325
  4326             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4327                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4328                 88  CO-OVRD-BY-R78             VALUE '1'.
  4329                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4330                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4331                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4332                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4333                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4334                 88  CO-OVRD-MEAN               VALUE '8'.
  4335                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4336
  4337             20  CF-CO-BEN-I-G-CD           PIC X.
  4338                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  81
* EL130.cbl
  4339                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4340                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4341
  4342         16  FILLER                         PIC X(304).
  4343
  4344
  4345****************************************************************
  4346*             CARRIER MASTER RECORD                            *
  4347****************************************************************
  4348
  4349     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4350         16  CF-ADDRESS-DATA.
  4351             20  CF-MAIL-TO-NAME            PIC X(30).
  4352             20  CF-IN-CARE-OF              PIC X(30).
  4353             20  CF-ADDRESS-LINE-1          PIC X(30).
  4354             20  CF-ADDRESS-LINE-2          PIC X(30).
  4355             20  CF-CITY-STATE              PIC X(30).
  4356             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4357             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4358
  4359         16  CF-CLAIM-NO-CONTROL.
  4360             20  CF-CLAIM-NO-METHOD         PIC X.
  4361                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4362                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4363                 88  CLAIM-NO-SEQ               VALUE '3'.
  4364                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4365             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4366                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4367                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4368                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4369
  4370         16  CF-CHECK-NO-CONTROL.
  4371             20  CF-CHECK-NO-METHOD         PIC X.
  4372                 88  CHECK-NO-MANUAL            VALUE '1'.
  4373                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4374                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4375                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4376             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4377                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4378
  4379         16  CF-DOMICILE-STATE              PIC XX.
  4380
  4381         16  CF-EXPENSE-CONTROLS.
  4382             20  CF-EXPENSE-METHOD          PIC X.
  4383                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4384                 88  DOLLARS-PER-PMT            VALUE '2'.
  4385                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4386                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4387             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4388             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4389
  4390         16  CF-CORRESPONDENCE-CONTROL.
  4391             20  CF-LETTER-RESEND-OPT       PIC X.
  4392                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4393                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4394             20  FILLER                     PIC X(4).
  4395
  4396         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  82
* EL130.cbl
  4397             20  CF-MANUAL-SW               PIC X.
  4398                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4399             20  CF-FUTURE-SW               PIC X.
  4400                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4401             20  CF-PTC-SW                  PIC X.
  4402                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4403             20  CF-IBNR-SW                 PIC X.
  4404                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4405             20  CF-PTC-LF-SW               PIC X.
  4406                 88  CF-LF-PTC-USED             VALUE '1'.
  4407             20  CF-CDT-ACCESS-METHOD       PIC X.
  4408                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4409                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4410                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4411             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4412
  4413         16  CF-CLAIM-CALC-METHOD           PIC X.
  4414             88  360-PLUS-MONTHS                VALUE '1'.
  4415             88  365-PLUS-MONTHS                VALUE '2'.
  4416             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4417             88  360-DAILY                      VALUE '4'.
  4418             88  365-DAILY                      VALUE '5'.
  4419
  4420         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4421         16  FILLER                         PIC X(11).
  4422
  4423         16  CF-LIMIT-AMOUNTS.
  4424             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4425             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4426             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4427             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4428             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4429             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4430             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4431             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4432             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4433             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4434
  4435         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4436         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4437         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4438
  4439         16  CF-ZIP-CODE.
  4440             20  CF-ZIP-PRIME.
  4441                 24  CF-ZIP-1ST             PIC X.
  4442                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4443                 24  FILLER                 PIC X(4).
  4444             20  CF-ZIP-PLUS4               PIC X(4).
  4445         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4446             20  CF-CAN-POSTAL-1            PIC XXX.
  4447             20  CF-CAN-POSTAL-2            PIC XXX.
  4448             20  FILLER                     PIC XXX.
  4449
  4450         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4451         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4452         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4453
  4454         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  83
* EL130.cbl
  4455             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4456             88  CF-NO-RATING                   VALUE 'N'.
  4457
  4458         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4459
  4460         16  CF-CARRIER-OVER-SHORT.
  4461             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4462             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4463
  4464         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4465         16  CF-SECPAY-SWITCH               PIC X.
  4466             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4467             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4468         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4469         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4470         16  FILLER                         PIC X(444).
  4471*        16  FILLER                         PIC X(452).
  4472
  4473
  4474****************************************************************
  4475*             MORTALITY MASTER RECORD                          *
  4476****************************************************************
  4477
  4478     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4479         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4480                                INDEXED BY CF-MORT-NDX.
  4481             20  CF-MORT-TABLE              PIC X(5).
  4482             20  CF-MORT-TABLE-TYPE         PIC X.
  4483                 88  CF-MORT-JOINT              VALUE 'J'.
  4484                 88  CF-MORT-SINGLE             VALUE 'S'.
  4485                 88  CF-MORT-COMBINED           VALUE 'C'.
  4486                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4487                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4488             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4489             20  CF-MORT-AGE-METHOD         PIC XX.
  4490                 88  CF-AGE-LAST                VALUE 'AL'.
  4491                 88  CF-AGE-NEAR                VALUE 'AN'.
  4492             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4493             20  CF-MORT-ADJUSTMENT-DIRECTION
  4494                                            PIC X.
  4495                 88  CF-MINUS                   VALUE '-'.
  4496                 88  CF-PLUS                    VALUE '+'.
  4497             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4498             20  CF-MORT-JOINT-CODE         PIC X.
  4499                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4500             20  CF-MORT-PC-Q               PIC X.
  4501                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4502             20  CF-MORT-TABLE-CODE         PIC X(4).
  4503             20  CF-MORT-COMMENTS           PIC X(15).
  4504             20  FILLER                     PIC X(14).
  4505
  4506         16  FILLER                         PIC X(251).
  4507
  4508
  4509****************************************************************
  4510*             BUSSINESS TYPE MASTER RECORD                     *
  4511****************************************************************
  4512
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  84
* EL130.cbl
  4513     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4514* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4515* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4516* AND RECORD 05 IS TYPES 81-99
  4517         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4518             20  CF-BUSINESS-TITLE          PIC  X(19).
  4519             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4520                                            PIC S9V9(4) COMP-3.
  4521             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4522             20  FILLER                     PIC  X.
  4523         16  FILLER                         PIC  X(248).
  4524
  4525
  4526****************************************************************
  4527*             TERMINAL MASTER RECORD                           *
  4528****************************************************************
  4529
  4530     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4531
  4532         16  CF-COMPANY-TERMINALS.
  4533             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4534                                  PIC X(4).
  4535         16  FILLER               PIC X(248).
  4536
  4537
  4538****************************************************************
  4539*             LIFE EDIT MASTER RECORD                          *
  4540****************************************************************
  4541
  4542     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4543         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4544             20  CF-LIFE-CODE-IN            PIC XX.
  4545             20  CF-LIFE-CODE-OUT           PIC XX.
  4546         16  FILLER                         PIC X(248).
  4547
  4548
  4549****************************************************************
  4550*             AH EDIT MASTER RECORD                            *
  4551****************************************************************
  4552
  4553     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4554         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4555             20  CF-AH-CODE-IN              PIC XXX.
  4556             20  CF-AH-CODE-OUT             PIC XX.
  4557         16  FILLER                         PIC X(248).
  4558
  4559
  4560****************************************************************
  4561*             CREDIBILITY TABLES                               *
  4562****************************************************************
  4563
  4564     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4565         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4566                             INDEXED BY CF-CRDB-NDX.
  4567             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4568             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4569             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4570         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  85
* EL130.cbl
  4571
  4572
  4573****************************************************************
  4574*             REPORT CUSTOMIZATION RECORD                      *
  4575****************************************************************
  4576
  4577     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4578         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4579             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4580             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4581             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4582**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4583****       A T-TRANSFER.                                   ****
  4584             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4585
  4586         16  FILLER                         PIC XX.
  4587
  4588         16  CF-CARRIER-CNTL-OPT.
  4589             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4590                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4591                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4592             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4593                                            PIC X.
  4594         16  CF-GROUP-CNTL-OPT.
  4595             20  CF-GROUP-OPT-SEQ           PIC 9.
  4596                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4597                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4598             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4599                                            PIC X(6).
  4600         16  CF-STATE-CNTL-OPT.
  4601             20  CF-STATE-OPT-SEQ           PIC 9.
  4602                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4603                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4604             20  CF-STATE-SELECT OCCURS 3 TIMES
  4605                                            PIC XX.
  4606         16  CF-ACCOUNT-CNTL-OPT.
  4607             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4608                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4609                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4610             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4611                                            PIC X(10).
  4612         16  CF-BUS-TYP-CNTL-OPT.
  4613             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4614                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4615                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4616             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4617                                            PIC XX.
  4618         16  CF-LF-TYP-CNTL-OPT.
  4619             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4620                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4621                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4622             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4623                                            PIC XX.
  4624         16  CF-AH-TYP-CNTL-OPT.
  4625             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4626                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4627                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4628             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  86
* EL130.cbl
  4629                                            PIC XX.
  4630         16  CF-REPTCD1-CNTL-OPT.
  4631             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4632                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4633                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4634             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4635                                            PIC X(10).
  4636         16  CF-REPTCD2-CNTL-OPT.
  4637             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4638                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4639                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4640             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4641                                            PIC X(10).
  4642         16  CF-USER1-CNTL-OPT.
  4643             20  CF-USER1-OPT-SEQ           PIC 9.
  4644                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4645                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4646             20  CF-USER1-SELECT OCCURS 3 TIMES
  4647                                            PIC X(10).
  4648         16  CF-USER2-CNTL-OPT.
  4649             20  CF-USER2-OPT-SEQ           PIC 9.
  4650                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4651                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4652             20  CF-USER2-SELECT OCCURS 3 TIMES
  4653                                            PIC X(10).
  4654         16  CF-USER3-CNTL-OPT.
  4655             20  CF-USER3-OPT-SEQ           PIC 9.
  4656                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4657                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4658             20  CF-USER3-SELECT OCCURS 3 TIMES
  4659                                            PIC X(10).
  4660         16  CF-USER4-CNTL-OPT.
  4661             20  CF-USER4-OPT-SEQ           PIC 9.
  4662                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4663                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4664             20  CF-USER4-SELECT OCCURS 3 TIMES
  4665                                            PIC X(10).
  4666         16  CF-USER5-CNTL-OPT.
  4667             20  CF-USER5-OPT-SEQ           PIC 9.
  4668                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4669                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4670             20  CF-USER5-SELECT OCCURS 3 TIMES
  4671                                            PIC X(10).
  4672         16  CF-REINS-CNTL-OPT.
  4673             20  CF-REINS-OPT-SEQ           PIC 9.
  4674                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4675                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4676             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4677                 24  CF-REINS-PRIME         PIC XXX.
  4678                 24  CF-REINS-SUB           PIC XXX.
  4679
  4680         16  CF-AGENT-CNTL-OPT.
  4681             20  CF-AGENT-OPT-SEQ           PIC 9.
  4682                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4683                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4684             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4685                                            PIC X(10).
  4686
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  87
* EL130.cbl
  4687         16  FILLER                         PIC X(43).
  4688
  4689         16  CF-LOSS-RATIO-SELECT.
  4690             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4691             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4692         16  CF-ENTRY-DATE-SELECT.
  4693             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4694             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4695         16  CF-EFFECTIVE-DATE-SELECT.
  4696             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4697             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4698
  4699         16  CF-EXCEPTION-LIST-IND          PIC X.
  4700             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4701
  4702         16  FILLER                         PIC X(318).
  4703
  4704****************************************************************
  4705*                  EXCEPTION REPORTING RECORD                  *
  4706****************************************************************
  4707
  4708     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4709         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4710             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4711
  4712         16  CF-COMBINED-LIFE-AH-OPT.
  4713             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4714             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4715             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4716             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4717
  4718         16  CF-LIFE-OPT.
  4719             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4720             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4721             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4722             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4723             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4724             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4725             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4726             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4727             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4728             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4729
  4730         16  CF-AH-OPT.
  4731             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4732             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4733             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4734             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4735             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4736             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4737             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4738             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4739             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4740             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4741
  4742         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4743             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4744             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  88
* EL130.cbl
  4745             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4746
  4747         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4748
  4749         16  FILLER                         PIC X(673).
  4750
  4751
  4752****************************************************************
  4753*             MORTGAGE SYSTEM PLAN RECORD                      *
  4754****************************************************************
  4755
  4756     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4757         16  CF-PLAN-TYPE                   PIC X.
  4758             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4759             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4760             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4761         16  CF-PLAN-ABBREV                 PIC XXX.
  4762         16  CF-PLAN-DESCRIPT               PIC X(10).
  4763         16  CF-PLAN-NOTES                  PIC X(20).
  4764         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4765         16  CF-PLAN-UNDERWRITING.
  4766             20  CF-PLAN-TERM-DATA.
  4767                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4768                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4769             20  CF-PLAN-AGE-DATA.
  4770                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4771                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4772                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4773             20  CF-PLAN-BENEFIT-DATA.
  4774                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4775                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4776                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4777                                            PIC S9(7)V99  COMP-3.
  4778         16  CF-PLAN-POLICY-FORMS.
  4779             20  CF-POLICY-FORM             PIC X(12).
  4780             20  CF-MASTER-APPLICATION      PIC X(12).
  4781             20  CF-MASTER-POLICY           PIC X(12).
  4782         16  CF-PLAN-RATING.
  4783             20  CF-RATE-CODE               PIC X(5).
  4784             20  CF-SEX-RATING              PIC X.
  4785                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4786                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4787             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4788             20  CF-SUB-STD-TYPE            PIC X.
  4789                 88  CF-PCT-OF-PREM            VALUE '1'.
  4790                 88  CF-PCT-OF-BENE            VALUE '2'.
  4791         16  CF-PLAN-PREM-TOLERANCES.
  4792             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4793             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4794         16  CF-PLAN-PYMT-TOLERANCES.
  4795             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4796             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4797         16  CF-PLAN-MISC-DATA.
  4798             20  FILLER                     PIC X.
  4799             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4800             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4801         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4802         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  89
* EL130.cbl
  4803             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4804                                                     '1'.
  4805             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4806                                                     '2'.
  4807         16  CF-MIB-SEARCH-SW               PIC X.
  4808             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4809             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4810             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4811             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4812         16  CF-ALPHA-SEARCH-SW             PIC X.
  4813             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4814             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4815             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4816             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4817             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4818             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4819             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4820             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4821             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4822             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4823                                                     'A' 'B' 'C'
  4824                                                     'X' 'Y' 'Z'.
  4825         16  CF-EFF-DT-RULE-SW              PIC X.
  4826             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4827             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4828             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4829             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4830             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4831         16  FILLER                         PIC X(4).
  4832         16  CF-HEALTH-QUESTIONS            PIC X.
  4833             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4834         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4835         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4836         16  CF-PLAN-SNGL-JNT               PIC X.
  4837             88  CF-COMBINED-PLAN              VALUE 'C'.
  4838             88  CF-JNT-PLAN                   VALUE 'J'.
  4839             88  CF-SNGL-PLAN                  VALUE 'S'.
  4840         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4841         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4842         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4843         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4844         16  CF-RERATE-CNTL                 PIC  X.
  4845             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4846             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4847             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4848             88  CF-AUTO-RECALC                 VALUE '4'.
  4849         16  CF-BENEFIT-TYPE                PIC  X.
  4850             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4851             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4852         16  CF-POLICY-FEE                  PIC S999V99
  4853                                                    COMP-3.
  4854         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4855         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4856         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4857         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4858         16  FILLER                         PIC  X(32).
  4859         16  CF-TERMINATION-FORM            PIC  X(04).
  4860         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  90
* EL130.cbl
  4861         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4862                                                       COMP-3.
  4863         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4864         16  CF-ISSUE-LETTER                PIC  X(4).
  4865         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4866         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4867             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4868             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4869         16  CF-MP-REFUND-CALC              PIC X.
  4870             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4871             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4872             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4873             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4874             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4875             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4876             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4877             88  CF-MP-REFD-MEAN                VALUE '8'.
  4878         16  CF-ALT-RATE-CODE               PIC  X(5).
  4879
  4880
  4881         16  FILLER                         PIC X(498).
  4882****************************************************************
  4883*             MORTGAGE COMPANY MASTER RECORD                   *
  4884****************************************************************
  4885
  4886     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4887         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4888         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4889             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4890             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4891             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4892             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4893             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4894
  4895         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4896         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4897         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4898         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4899         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4900
  4901         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4902             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4903         16  CF-MP-RECON-USE-IND            PIC X(1).
  4904             88  CF-MP-USE-RECON             VALUE 'Y'.
  4905         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4906             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4907         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4908             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4909             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4910         16  FILLER                         PIC X(1).
  4911         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4912             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4913         16  CF-MORTG-MIB-VERSION           PIC X.
  4914             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4915             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4916             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4917         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4918             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  91
* EL130.cbl
  4919                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4920             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4921                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4922             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4923                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4924             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4925                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4926             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4927                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4928             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4929                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4930         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4931         16  FILLER                         PIC X(7).
  4932         16  CF-MORTG-DESTINATION-SYMBOL.
  4933             20  CF-MORTG-MIB-COMM          PIC X(5).
  4934             20  CF-MORTG-MIB-TERM          PIC X(5).
  4935         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4936             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4937         16  FILLER                         PIC X(03).
  4938         16  CF-MP-CHECK-NO-CONTROL.
  4939             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4940                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4941                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4942                                                ' ' LOW-VALUES.
  4943                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4944                                               VALUE '3'.
  4945         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4946         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4947         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4948             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4949                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4950             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4951                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4952             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4953                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4954             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4955                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4956             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4957                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4958             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4959                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4960         16  CF-MORTG-BILLING-AREA.
  4961             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4962                                            PIC X.
  4963         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4964         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4965         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4966         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4967             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4968             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4969         16  FILLER                         PIC X.
  4970         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4971             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4972             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4973         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4974         16  FILLER                         PIC X(8).
  4975         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4976         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  92
* EL130.cbl
  4977         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4978         16  CF-ACH-COMPANY-ID.
  4979             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4980                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4981                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4982                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4983             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4984         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4985             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4986         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4987             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4988             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4989         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4990         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4991         16  FILLER                         PIC X(536).
  4992
  4993****************************************************************
  4994*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4995****************************************************************
  4996
  4997     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4998         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4999             20  CF-FEMALE-HEIGHT.
  5000                 24  CF-FEMALE-FT           PIC 99.
  5001                 24  CF-FEMALE-IN           PIC 99.
  5002             20  CF-FEMALE-MIN-WT           PIC 999.
  5003             20  CF-FEMALE-MAX-WT           PIC 999.
  5004         16  FILLER                         PIC X(428).
  5005
  5006     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5007         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5008             20  CF-MALE-HEIGHT.
  5009                 24  CF-MALE-FT             PIC 99.
  5010                 24  CF-MALE-IN             PIC 99.
  5011             20  CF-MALE-MIN-WT             PIC 999.
  5012             20  CF-MALE-MAX-WT             PIC 999.
  5013         16  FILLER                         PIC X(428).
  5014******************************************************************
  5015*             AUTOMATIC ACTIVITY RECORD                          *
  5016******************************************************************
  5017     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5018         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5019             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5020             20  CF-SYS-LETTER-ID           PIC X(04).
  5021             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5022             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5023             20  CF-SYS-RESET-SW            PIC X(01).
  5024             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5025             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5026
  5027         16  FILLER                         PIC X(50).
  5028
  5029         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5030             20  CF-USER-ACTIVE-SW          PIC X(01).
  5031             20  CF-USER-LETTER-ID          PIC X(04).
  5032             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5033             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5034             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  93
* EL130.cbl
  5035             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5036             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5037             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5038
  5039         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  94
* EL130.cbl
  5041*    COPY ELCCERT.
  5042******************************************************************
  5043*                                                                *
  5044*                            ELCCERT.                            *
  5045*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5046*                            VMOD=2.013                          *
  5047*                                                                *
  5048*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5049*                                                                *
  5050*   FILE TYPE = VSAM,KSDS                                        *
  5051*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5052*                                                                *
  5053*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5054*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5055*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5056*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5057*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5058*                                                                *
  5059*   LOG = YES                                                    *
  5060*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5061******************************************************************
  5062*                   C H A N G E   L O G
  5063*
  5064* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5065*-----------------------------------------------------------------
  5066*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5067* EFFECTIVE    NUMBER
  5068*-----------------------------------------------------------------
  5069* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5070* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5071* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5072* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5073* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5074* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5075* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5076* 032612  CR2011110200001  PEMA  AHL CHANGES
  5077* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5078* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5079* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  5080******************************************************************
  5081
  5082 01  CERTIFICATE-MASTER.
  5083     12  CM-RECORD-ID                      PIC XX.
  5084         88  VALID-CM-ID                      VALUE 'CM'.
  5085
  5086     12  CM-CONTROL-PRIMARY.
  5087         16  CM-COMPANY-CD                 PIC X.
  5088         16  CM-CARRIER                    PIC X.
  5089         16  CM-GROUPING.
  5090             20  CM-GROUPING-PREFIX        PIC X(3).
  5091             20  CM-GROUPING-PRIME         PIC X(3).
  5092         16  CM-STATE                      PIC XX.
  5093         16  CM-ACCOUNT.
  5094             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5095             20  CM-ACCOUNT-PRIME          PIC X(6).
  5096         16  CM-CERT-EFF-DT                PIC XX.
  5097         16  CM-CERT-NO.
  5098             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  95
* EL130.cbl
  5099             20  CM-CERT-SFX               PIC X.
  5100
  5101     12  CM-CONTROL-BY-NAME.
  5102         16  CM-COMPANY-CD-A1              PIC X.
  5103         16  CM-INSURED-LAST-NAME          PIC X(15).
  5104         16  CM-INSURED-INITIALS.
  5105             20  CM-INSURED-INITIAL1       PIC X.
  5106             20  CM-INSURED-INITIAL2       PIC X.
  5107
  5108     12  CM-CONTROL-BY-SSN.
  5109         16  CM-COMPANY-CD-A2              PIC X.
  5110         16  CM-SOC-SEC-NO.
  5111             20  CM-SSN-STATE              PIC XX.
  5112             20  CM-SSN-ACCOUNT            PIC X(6).
  5113             20  CM-SSN-LN3.
  5114                 25  CM-INSURED-INITIALS-A2.
  5115                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5116                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5117                 25 CM-PART-LAST-NAME-A2         PIC X.
  5118
  5119     12  CM-CONTROL-BY-CERT-NO.
  5120         16  CM-COMPANY-CD-A4              PIC X.
  5121         16  CM-CERT-NO-A4                 PIC X(11).
  5122
  5123     12  CM-CONTROL-BY-MEMB.
  5124         16  CM-COMPANY-CD-A5              PIC X.
  5125         16  CM-MEMBER-NO.
  5126             20  CM-MEMB-STATE             PIC XX.
  5127             20  CM-MEMB-ACCOUNT           PIC X(6).
  5128             20  CM-MEMB-LN4.
  5129                 25  CM-INSURED-INITIALS-A5.
  5130                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5131                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5132                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5133
  5134     12  CM-INSURED-PROFILE-DATA.
  5135         16  CM-INSURED-FIRST-NAME.
  5136             20  CM-INSURED-1ST-INIT       PIC X.
  5137             20  FILLER                    PIC X(9).
  5138         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5139         16  CM-INSURED-SEX                PIC X.
  5140             88  CM-SEX-MALE                  VALUE 'M'.
  5141             88  CM-SEX-FEMAL                 VALUE 'F'.
  5142         16  CM-INSURED-JOINT-AGE          PIC 99.
  5143         16  CM-JOINT-INSURED-NAME.
  5144             20  CM-JT-LAST-NAME           PIC X(15).
  5145             20  CM-JT-FIRST-NAME.
  5146                 24  CM-JT-1ST-INIT        PIC X.
  5147                 24  FILLER                PIC X(9).
  5148             20  CM-JT-INITIAL             PIC X.
  5149
  5150     12  CM-LIFE-DATA.
  5151         16  CM-LF-BENEFIT-CD              PIC XX.
  5152         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5153         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5154         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5155         16  CM-LF-DEV-CODE                PIC XXX.
  5156         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  96
* EL130.cbl
  5157         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5158         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5159         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5160         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5161         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5162         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5163         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5164         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5165         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5166         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5167         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5168         16  cm-temp-epiq                  pic xx.
  5169             88  EPIQ-CLASS                  value 'EQ'.
  5170*        16  FILLER                        PIC XX.
  5171
  5172     12  CM-AH-DATA.
  5173         16  CM-AH-BENEFIT-CD              PIC XX.
  5174         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5175         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5176         16  CM-AH-DEV-CODE                PIC XXX.
  5177         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5178         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5179         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5180         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5181         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5182         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5183         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5184         16  CM-AH-PAID-THRU-DT            PIC XX.
  5185             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5186         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5187         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5188         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5189         16  FILLER                        PIC X.
  5190
  5191     12  CM-LOAN-INFORMATION.
  5192         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5193         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5194                                           PIC S9(5)V99  COMP-3.
  5195         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5196         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5197         16  CM-PAY-FREQUENCY              PIC S99.
  5198         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5199         16  CM-RATE-CLASS                 PIC XX.
  5200         16  CM-BENEFICIARY                PIC X(25).
  5201         16  CM-POLICY-FORM-NO             PIC X(12).
  5202         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5203         16  CM-LAST-ADD-ON-DT             PIC XX.
  5204         16  CM-DEDUCTIBLE-AMOUNTS.
  5205             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5206             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5207         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5208             20  CM-RESIDENT-STATE         PIC XX.
  5209             20  CM-RATE-CODE              PIC X(4).
  5210             20  FILLER                    PIC XX.
  5211         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5212             20  CM-LOAN-OFFICER           PIC X(5).
  5213             20  FILLER                    PIC XXX.
  5214         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  97
* EL130.cbl
  5215         16  CM-UNDERWRITING-CODE          PIC X.
  5216             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5217         16  CM-POST-CARD-IND              PIC X.
  5218         16  CM-REF-INTERFACE-SW           PIC X.
  5219         16  CM-PREMIUM-TYPE               PIC X.
  5220             88  CM-SING-PRM                  VALUE '1'.
  5221             88  CM-O-B-COVERAGE              VALUE '2'.
  5222             88  CM-OPEN-END                  VALUE '3'.
  5223         16  CM-IND-GRP-TYPE               PIC X.
  5224             88  CM-INDIVIDUAL                VALUE 'I'.
  5225             88  CM-GROUP                     VALUE 'G'.
  5226         16  CM-SKIP-CODE                  PIC X.
  5227             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5228             88  SKIP-JULY                    VALUE '1'.
  5229             88  SKIP-AUGUST                  VALUE '2'.
  5230             88  SKIP-SEPTEMBER               VALUE '3'.
  5231             88  SKIP-JULY-AUG                VALUE '4'.
  5232             88  SKIP-AUG-SEPT                VALUE '5'.
  5233             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5234             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5235             88  SKIP-JUNE                    VALUE '8'.
  5236             88  SKIP-JUNE-JULY               VALUE '9'.
  5237             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5238             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5239         16  CM-PAYMENT-MODE               PIC X.
  5240             88  PAY-MONTHLY                  VALUE SPACE.
  5241             88  PAY-WEEKLY                   VALUE '1'.
  5242             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5243             88  PAY-BI-WEEKLY                VALUE '3'.
  5244             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5245         16  CM-LOAN-NUMBER                PIC X(8).
  5246         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5247         16  CM-OLD-LOF                    PIC XXX.
  5248*        16  CM-LOAN-OFFICER               PIC XXX.
  5249         16  CM-REIN-TABLE                 PIC XXX.
  5250         16  CM-SPECIAL-REIN-CODE          PIC X.
  5251         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5252         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5253         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5254
  5255     12  CM-STATUS-DATA.
  5256         16  CM-ENTRY-STATUS               PIC X.
  5257         16  CM-ENTRY-DT                   PIC XX.
  5258
  5259         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5260         16  CM-LF-CANCEL-DT               PIC XX.
  5261         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5262
  5263         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5264         16  CM-LF-DEATH-DT                PIC XX.
  5265         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5266
  5267         16  CM-LF-CURRENT-STATUS          PIC X.
  5268             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5269                                                'M' '4' '5' '9'.
  5270             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5271             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5272             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  98
* EL130.cbl
  5273             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5274             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5275             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5276             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5277             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5278             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5279             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5280             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5281             88  CM-LF-DECLINED               VALUE 'D'.
  5282             88  CM-LF-VOIDED                 VALUE 'V'.
  5283
  5284         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5285         16  CM-AH-CANCEL-DT               PIC XX.
  5286         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5287
  5288         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5289         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5290         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5291
  5292         16  CM-AH-CURRENT-STATUS          PIC X.
  5293             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5294                                                'M' '4' '5' '9'.
  5295             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5296             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5297             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5298             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5299             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5300             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5301             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5302             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5303             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5304             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5305             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5306             88  CM-AH-DECLINED               VALUE 'D'.
  5307             88  CM-AH-VOIDED                 VALUE 'V'.
  5308
  5309         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5310             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5311             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5312             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5313         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5314
  5315         16  CM-ENTRY-BATCH                PIC X(6).
  5316         16  CM-LF-EXIT-BATCH              PIC X(6).
  5317         16  CM-AH-EXIT-BATCH              PIC X(6).
  5318         16  CM-LAST-MONTH-END             PIC XX.
  5319
  5320     12  CM-NOTE-SW                        PIC X.
  5321         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5322         88  CERT-NOTES-PRESENT               VALUE '1'.
  5323         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5324         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5325         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5326         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5327         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5328         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5329     12  CM-COMP-EXCP-SW                   PIC X.
  5330         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page  99
* EL130.cbl
  5331         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5332     12  CM-INSURED-ADDRESS-SW             PIC X.
  5333         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5334         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5335
  5336*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5337     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5338     12  FILLER                            PIC X.
  5339
  5340*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5341     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5342     12  FILLER                            PIC X.
  5343*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5344     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  5345
  5346     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5347         88  CERT-ADDED-BATCH                 VALUE ' '.
  5348         88  CERT-ADDED-ONLINE                VALUE '1'.
  5349         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5350         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5351         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5352     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5353         88  CERT-AS-LOADED                   VALUE ' '.
  5354         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5355         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5356         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5357         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5358         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5359         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5360         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5361
  5362     12  CM-ACCOUNT-COMM-PCTS.
  5363         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5364         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5365
  5366     12  CM-USER-FIELD                     PIC X.
  5367     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5368     12  CM-CLP-STATE                      PIC XX.
  5369     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5370     12  CM-USER-RESERVED                  PIC XXX.
  5371     12  FILLER REDEFINES CM-USER-RESERVED.
  5372         16  CM-AH-CLASS-CD                PIC XX.
  5373         16  F                             PIC X.
  5374******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 100
* EL130.cbl
  5376*    COPY ERCACCT.
  5377******************************************************************
  5378*                                                                *
  5379*                                                                *
  5380*                            ERCACCT                             *
  5381*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5382*                            VMOD=2.031                          *
  5383*                                                                *
  5384*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5385*                                                                *
  5386*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5387*   VSAM ACCOUNT MASTER FILES.                                   *
  5388*                                                                *
  5389*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5390*                                                                *
  5391*   FILE TYPE = VSAM,KSDS                                        *
  5392*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5393*                                                                *
  5394*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5395*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5396*                                                                *
  5397*   LOG = NO                                                     *
  5398*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5399*                                                                *
  5400*                                                                *
  5401******************************************************************
  5402*                   C H A N G E   L O G
  5403*
  5404* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5405*-----------------------------------------------------------------
  5406*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5407* EFFECTIVE    NUMBER
  5408*-----------------------------------------------------------------
  5409* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5410* 092705    2005050300006  PEMA  ADD SPP LEASES
  5411* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5412* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5413* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5414* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5415* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5416* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  5417******************************************************************
  5418
  5419 01  ACCOUNT-MASTER.
  5420     12  AM-RECORD-ID                      PIC XX.
  5421         88  VALID-AM-ID                      VALUE 'AM'.
  5422
  5423     12  AM-CONTROL-PRIMARY.
  5424         16  AM-COMPANY-CD                 PIC X.
  5425         16  AM-MSTR-CNTRL.
  5426             20  AM-CONTROL-A.
  5427                 24  AM-CARRIER            PIC X.
  5428                 24  AM-GROUPING.
  5429                     28 AM-GROUPING-PREFIX PIC XXX.
  5430                     28 AM-GROUPING-PRIME  PIC XXX.
  5431                 24  AM-STATE              PIC XX.
  5432                 24  AM-ACCOUNT.
  5433                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 101
* EL130.cbl
  5434                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5435             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5436                                           PIC X(19).
  5437             20  AM-CNTRL-B.
  5438                 24  AM-EXPIRATION-DT      PIC XX.
  5439                 24  FILLER                PIC X(4).
  5440             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5441                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5442
  5443     12  AM-CONTROL-BY-VAR-GRP.
  5444         16  AM-COMPANY-CD-A1              PIC X.
  5445         16  AM-VG-CARRIER                 PIC X.
  5446         16  AM-VG-GROUPING                PIC X(6).
  5447         16  AM-VG-STATE                   PIC XX.
  5448         16  AM-VG-ACCOUNT                 PIC X(10).
  5449         16  AM-VG-DATE.
  5450             20  AM-VG-EXPIRATION-DT       PIC XX.
  5451             20  FILLER                    PIC X(4).
  5452         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5453                                           PIC 9(11)      COMP-3.
  5454     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5455         16  FILLER                        PIC X(10).
  5456         16  AM-VG-KEY3.
  5457             20  AM-VG3-ACCOUNT            PIC X(10).
  5458             20  AM-VG3-EXP-DT             PIC XX.
  5459         16  FILLER                        PIC X(4).
  5460     12  AM-MAINT-INFORMATION.
  5461         16  AM-LAST-MAINT-DT              PIC XX.
  5462         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5463         16  AM-LAST-MAINT-USER            PIC X(4).
  5464         16  FILLER                        PIC XX.
  5465
  5466     12  AM-EFFECTIVE-DT                   PIC XX.
  5467     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5468
  5469     12  AM-PREV-DATES  COMP-3.
  5470         16  AM-PREV-EXP-DT                PIC 9(11).
  5471         16  AM-PREV-EFF-DT                PIC 9(11).
  5472
  5473     12  AM-REPORT-CODE-1                  PIC X(10).
  5474     12  AM-REPORT-CODE-2                  PIC X(10).
  5475
  5476     12  AM-CITY-CODE                      PIC X(4).
  5477     12  AM-COUNTY-PARISH                  PIC X(6).
  5478
  5479     12  AM-NAME                           PIC X(30).
  5480     12  AM-PERSON                         PIC X(30).
  5481     12  AM-ADDRS                          PIC X(30).
  5482     12  AM-CITY.
  5483         16  AM-ADDR-CITY                  PIC X(28).
  5484         16  AM-ADDR-STATE                 PIC XX.
  5485     12  AM-ZIP.
  5486         16  AM-ZIP-PRIME.
  5487             20  AM-ZIP-PRI-1ST            PIC X.
  5488                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5489             20  FILLER                    PIC X(4).
  5490         16  AM-ZIP-PLUS4                  PIC X(4).
  5491     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 102
* EL130.cbl
  5492         16  AM-CAN-POSTAL-1               PIC XXX.
  5493         16  AM-CAN-POSTAL-2               PIC XXX.
  5494         16  FILLER                        PIC XXX.
  5495     12  AM-TEL-NO.
  5496         16  AM-AREA-CODE                  PIC 999.
  5497         16  AM-TEL-PRE                    PIC 999.
  5498         16  AM-TEL-NBR                    PIC 9(4).
  5499     12  AM-TEL-LOC                        PIC X.
  5500         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5501         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5502
  5503     12  AM-COMM-STRUCTURE.
  5504         16  AM-DEFN-1.
  5505             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5506                 24  AM-AGT.
  5507                     28  AM-AGT-PREFIX     PIC X(4).
  5508                     28  AM-AGT-PRIME      PIC X(6).
  5509                 24  AM-COM-TYP            PIC X.
  5510                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5511                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5512                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5513                 24  AM-RECALC-LV-INDIC    PIC X.
  5514                 24  AM-RETRO-LV-INDIC     PIC X.
  5515                 24  AM-GL-CODES           PIC X.
  5516                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5517                 24  FILLER                PIC X(01).
  5518         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5519             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5520                 24  FILLER                PIC X(11).
  5521                 24  AM-L-COMA             PIC XXX.
  5522                 24  AM-J-COMA             PIC XXX.
  5523                 24  AM-A-COMA             PIC XXX.
  5524                 24  FILLER                PIC X(6).
  5525
  5526     12  AM-COMM-CHANGE-STATUS             PIC X.
  5527         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5528
  5529     12  AM-CSR-CODE                       PIC X(4).
  5530
  5531     12  AM-BILLING-STATUS                 PIC X.
  5532         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5533         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5534     12  AM-AUTO-REFUND-SW                 PIC X.
  5535         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5536         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5537     12  AM-GPCD                           PIC 99.
  5538     12  AM-IG                             PIC X.
  5539         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5540         88  AM-HAS-GROUP                     VALUE '2'.
  5541     12  AM-STATUS                         PIC X.
  5542         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5543         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5544         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5545         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5546         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5547         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5548         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  5549         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 103
* EL130.cbl
  5550         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  5551         88  AM-ACCOUNT-PENDING               VALUE '9'.
  5552     12  AM-REMIT-TO                       PIC 99.
  5553     12  AM-ID-NO                          PIC X(11).
  5554
  5555     12  AM-CAL-TABLE                      PIC XX.
  5556     12  AM-LF-DEVIATION                   PIC XXX.
  5557     12  AM-AH-DEVIATION                   PIC XXX.
  5558     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5559     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5560     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5561     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5562     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5563     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5564
  5565     12  AM-USER-FIELDS.
  5566         16  AM-FLD-1                      PIC XX.
  5567         16  AM-FLD-2                      PIC XX.
  5568         16  AM-FLD-3                      PIC XX.
  5569         16  AM-FLD-4                      PIC XX.
  5570         16  AM-FLD-5                      PIC XX.
  5571
  5572     12  AM-1ST-PROD-DATE.
  5573         16  AM-1ST-PROD-YR                PIC XX.
  5574         16  AM-1ST-PROD-MO                PIC XX.
  5575         16  AM-1ST-PROD-DA                PIC XX.
  5576     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5577     12  AM-CERTS-PURGED-DATE.
  5578         16  AM-PUR-YR                     PIC XX.
  5579         16  AM-PUR-MO                     PIC XX.
  5580         16  AM-PUR-DA                     PIC XX.
  5581     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5582     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5583     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5584     12  AM-INACTIVE-DATE.
  5585         16  AM-INA-MO                     PIC 99.
  5586         16  AM-INA-DA                     PIC 99.
  5587         16  AM-INA-YR                     PIC 99.
  5588     12  AM-AR-HI-CERT-DATE                PIC XX.
  5589
  5590     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5591     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5592
  5593     12  AM-OB-PAYMENT-MODE                PIC X.
  5594         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5595         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5596         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5597         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5598
  5599     12  AM-AH-ONLY-INDICATOR              PIC X.
  5600         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5601         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5602
  5603     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5604
  5605     12  AM-OVER-SHORT.
  5606         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5607         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 104
* EL130.cbl
  5608
  5609     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5610     12  AM-DCC-CLP-STATE                  PIC XX.
  5611
  5612     12  AM-RECALC-COMM                    PIC X.
  5613     12  AM-RECALC-REIN                    PIC X.
  5614
  5615     12  AM-REI-TABLE                      PIC XXX.
  5616     12  AM-REI-ET-LF                      PIC X.
  5617     12  AM-REI-ET-AH                      PIC X.
  5618     12  AM-REI-PE-LF                      PIC X.
  5619     12  AM-REI-PE-AH                      PIC X.
  5620     12  AM-REI-PRT-ST                     PIC X.
  5621     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5622     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5623     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5624     12  AM-REI-GROUP-A                    PIC X(6).
  5625     12  AM-REI-MORT                       PIC X(4).
  5626     12  AM-REI-PRT-OW                     PIC X.
  5627     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5628     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5629     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5630     12  AM-REI-GROUP-B                    PIC X(6).
  5631
  5632     12  AM-TRUST-TYPE                     PIC X(2).
  5633
  5634     12  AM-EMPLOYER-STMT-USED             PIC X.
  5635     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5636
  5637     12  AM-STD-AH-TYPE                    PIC XX.
  5638     12  AM-EARN-METHODS.
  5639         16  AM-EARN-METHOD-R              PIC X.
  5640             88 AM-REF-RL-R78                 VALUE 'R'.
  5641             88 AM-REF-RL-PR                  VALUE 'P'.
  5642             88 AM-REF-RL-MEAN                VALUE 'M'.
  5643             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5644         16  AM-EARN-METHOD-L              PIC X.
  5645             88 AM-REF-LL-R78                 VALUE 'R'.
  5646             88 AM-REF-LL-PR                  VALUE 'P'.
  5647             88 AM-REF-LL-MEAN                VALUE 'M'.
  5648             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5649         16  AM-EARN-METHOD-A              PIC X.
  5650             88 AM-REF-AH-R78                 VALUE 'R'.
  5651             88 AM-REF-AH-PR                  VALUE 'P'.
  5652             88 AM-REF-AH-MEAN                VALUE 'M'.
  5653             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5654             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5655             88 AM-REF-AH-NET                 VALUE 'N'.
  5656
  5657     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5658     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5659     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5660
  5661     12  AM-RET-Y-N                        PIC X.
  5662     12  AM-RET-P-E                        PIC X.
  5663     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5664     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5665     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 105
* EL130.cbl
  5666     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5667         16  AM-POOL-PRIME                 PIC XXX.
  5668         16  AM-POOL-SUB                   PIC XXX.
  5669     12  AM-RETRO-EARNINGS.
  5670         16  AM-RET-EARN-R                 PIC X.
  5671         16  AM-RET-EARN-L                 PIC X.
  5672         16  AM-RET-EARN-A                 PIC X.
  5673     12  AM-RET-ST-TAX-USE                 PIC X.
  5674         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5675         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5676     12  AM-RETRO-BEG-EARNINGS.
  5677         16  AM-RET-BEG-EARN-R             PIC X.
  5678         16  AM-RET-BEG-EARN-L             PIC X.
  5679         16  AM-RET-BEG-EARN-A             PIC X.
  5680     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5681     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5682
  5683     12  AM-USER-SELECT-OPTIONS.
  5684         16  AM-USER-SELECT-1              PIC X(10).
  5685         16  AM-USER-SELECT-2              PIC X(10).
  5686         16  AM-USER-SELECT-3              PIC X(10).
  5687         16  AM-USER-SELECT-4              PIC X(10).
  5688         16  AM-USER-SELECT-5              PIC X(10).
  5689
  5690     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5691
  5692     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5693
  5694     12  AM-RPT045A-SWITCH                 PIC X.
  5695         88  RPT045A-OFF                   VALUE 'N'.
  5696
  5697     12  AM-INSURANCE-LIMITS.
  5698         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5699         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5700
  5701     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5702         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5703
  5704     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5705         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5706         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5707
  5708     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5709
  5710     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5711     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5712     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5713     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5714     12  AM-DCC-UEF-STATE                  PIC XX.
  5715     12  FILLER                            PIC XXX.
  5716     12  AM-REPORT-CODE-3                  PIC X(10).
  5717*    12  FILLER                            PIC X(22).
  5718
  5719     12  AM-RESERVE-DATE.
  5720         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5721         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5722         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5723
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 106
* EL130.cbl
  5724     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5725     12  AM-NOTIFICATION-TYPES.
  5726         16  AM-NOTIF-OF-LETTERS           PIC X.
  5727         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5728         16  AM-NOTIF-OF-REPORTS           PIC X.
  5729         16  AM-NOTIF-OF-STATUS            PIC X.
  5730
  5731     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5732         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5733         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5734         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5735         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5736
  5737     12  AM-BENEFIT-CONTROLS.
  5738         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5739             20  AM-BENEFIT-CODE           PIC XX.
  5740             20  AM-BENEFIT-TYPE           PIC X.
  5741             20  AM-BENEFIT-REVISION       PIC XXX.
  5742             20  AM-BENEFIT-REM-TERM       PIC X.
  5743             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5744             20  FILLER                    PIC XX.
  5745         16  FILLER                        PIC X(80).
  5746
  5747     12  AM-TRANSFER-DATA.
  5748         16  AM-TRANSFERRED-FROM.
  5749             20  AM-TRNFROM-CARRIER        PIC X.
  5750             20  AM-TRNFROM-GROUPING.
  5751                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5752                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5753             20  AM-TRNFROM-STATE          PIC XX.
  5754             20  AM-TRNFROM-ACCOUNT.
  5755                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5756                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5757             20  AM-TRNFROM-DTE            PIC XX.
  5758         16  AM-TRANSFERRED-TO.
  5759             20  AM-TRNTO-CARRIER          PIC X.
  5760             20  AM-TRNTO-GROUPING.
  5761                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5762                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5763             20  AM-TRNTO-STATE            PIC XX.
  5764             20  AM-TRNTO-ACCOUNT.
  5765                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5766                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5767             20  AM-TRNTO-DTE              PIC XX.
  5768         16  FILLER                        PIC X(10).
  5769
  5770     12  AM-SAVED-REMIT-TO                 PIC 99.
  5771
  5772     12  AM-COMM-STRUCTURE-SAVED.
  5773         16  AM-DEFN-1-SAVED.
  5774             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5775                 24  AM-AGT-SV             PIC X(10).
  5776                 24  AM-COM-TYP-SV         PIC X.
  5777                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5778                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5779                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5780                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5781                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 107
* EL130.cbl
  5782                 24  AM-GL-CODES-SV        PIC X.
  5783                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5784                 24  FILLER                PIC X.
  5785         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5786             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5787                 24  FILLER                PIC X(11).
  5788                 24  AM-L-COMA-SV          PIC XXX.
  5789                 24  AM-J-COMA-SV          PIC XXX.
  5790                 24  AM-A-COMA-SV          PIC XXX.
  5791                 24  FILLER                PIC X(6).
  5792
  5793     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5794         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5795            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5796            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5797            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5798
  5799     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5800     12  FILLER                            PIC X(120).
  5801
  5802     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5803         16  AM-CONTROL-NAME               PIC X(30).
  5804         16  AM-EXECUTIVE-ONE.
  5805             20  AM-EXEC1-NAME             PIC X(15).
  5806             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5807                                                          COMP-3.
  5808             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5809                                                          COMP-3.
  5810         16  AM-EXECUTIVE-TWO.
  5811             20  AM-EXEC2-NAME             PIC X(15).
  5812             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5813                                                          COMP-3.
  5814             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5815                                                          COMP-3.
  5816
  5817     12  AM-RETRO-ADDITIONAL-DATA.
  5818         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5819         16  AM-RETRO-PREM-P-E             PIC X.
  5820         16  AM-RETRO-CLMS-P-I             PIC X.
  5821         16  AM-RETRO-RET-BRACKET-LF.
  5822             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5823                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5824                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5825             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5826                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5827                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5828             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5829                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5830                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5831         16  AM-RETRO-RET-BRACKET-AH.
  5832             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5833                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5834                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5835                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5836             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5837                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5838                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5839             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 108
* EL130.cbl
  5840                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5841                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5842
  5843     12  AM-COMMENTS.
  5844         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5845
  5846     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5847         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5848         16  AM-FLI-BILLING-CODE           PIC X.
  5849         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5850         16  AM-FLI-UNITED-IDENT           PIC X.
  5851         16  AM-FLI-INTEREST-LOST-DATA.
  5852             20  AM-FLI-BANK-NO            PIC X(5).
  5853             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5854             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5855             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5856         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5857             20  AM-FLI-AGT                PIC X(9).
  5858             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5859             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5860         16  FILLER                        PIC X(102).
  5861
  5862     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5863         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5864             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5865             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5866             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5867             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5868             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5869         16  FILLER                          PIC X(10).
  5870******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 109
* EL130.cbl
  5872*    COPY ELCTRLR.
  5873******************************************************************
  5874*                                                                *
  5875*                            ELCTRLR.                            *
  5876*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5877*                            VMOD=2.014                          *
  5878*                                                                *
  5879*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5880*                                                                *
  5881*   FILE TYPE = VSAM,KSDS                                        *
  5882*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5883*                                                                *
  5884*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5885*       ALTERNATE INDEX = NONE                                   *
  5886*                                                                *
  5887*   LOG = YES                                                    *
  5888*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5889******************************************************************
  5890*                   C H A N G E   L O G
  5891*
  5892* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5893*-----------------------------------------------------------------
  5894*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5895* EFFECTIVE    NUMBER
  5896*-----------------------------------------------------------------
  5897* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5898* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5899* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5900* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5901* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5902* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5903* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5904* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5905* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5906* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5907* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5908* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5909* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5910* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5911* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5912* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5913* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5914* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5915* 040814    2014030500002  AJRA  ADD ICD CODES
  5916* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5917* 013017  CR2016053100001  PEMA  ACH PROCESSING
  5918* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  5919******************************************************************
  5920 01  ACTIVITY-TRAILERS.
  5921     12  AT-RECORD-ID                    PIC XX.
  5922         88  VALID-AT-ID                       VALUE 'AT'.
  5923
  5924     12  AT-CONTROL-PRIMARY.
  5925         16  AT-COMPANY-CD               PIC X.
  5926         16  AT-CARRIER                  PIC X.
  5927         16  AT-CLAIM-NO                 PIC X(7).
  5928         16  AT-CERT-NO.
  5929             20  AT-CERT-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 110
* EL130.cbl
  5930             20  AT-CERT-SFX             PIC X.
  5931         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5932             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5933             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5934             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5935             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5936             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5937             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5938             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5939             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5940             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5941             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5942             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5943             88  AT-BENEFICIARY-TRL           VALUE +91.
  5944             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5945             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5946             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5947             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5948
  5949     12  AT-TRAILER-TYPE                 PIC X.
  5950         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5951         88  PAYMENT-TR                       VALUE '2'.
  5952         88  AUTO-PAY-TR                      VALUE '3'.
  5953         88  CORRESPONDENCE-TR                VALUE '4'.
  5954         88  ADDRESS-TR                       VALUE '5'.
  5955         88  GENERAL-INFO-TR                  VALUE '6'.
  5956         88  AUTO-PROMPT-TR                   VALUE '7'.
  5957         88  DENIAL-TR                        VALUE '8'.
  5958         88  INCURRED-CHG-TR                  VALUE '9'.
  5959         88  FORM-CONTROL-TR                  VALUE 'A'.
  5960
  5961     12  AT-RECORDED-DT                  PIC XX.
  5962     12  AT-RECORDED-BY                  PIC X(4).
  5963     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5964
  5965     12  AT-TRAILER-BODY                 PIC X(165).
  5966
  5967     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5968         16  AT-RESERVE-CONTROLS.
  5969             20  AT-MANUAL-SW            PIC X.
  5970                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5971             20  AT-FUTURE-SW            PIC X.
  5972                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5973             20  AT-PTC-SW               PIC X.
  5974                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5975             20  AT-IBNR-SW              PIC X.
  5976                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5977             20  AT-PTC-LF-SW            PIC X.
  5978                 88  AT-LF-PTC-USED          VALUE '1'.
  5979             20  AT-CDT-ACCESS-METHOD    PIC X.
  5980                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5981                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5982                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5983             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5984         16  AT-LAST-COMPUTED-DT         PIC XX.
  5985         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5986         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5987         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 111
* EL130.cbl
  5988         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5989         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5990         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5991         16  AT-EXPENSE-CONTROLS.
  5992             20  AT-EXPENSE-METHOD       PIC X.
  5993                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5994                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5995                 88  PERCENT-OF-PMT           VALUE '3'.
  5996                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5997             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5998             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5999         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6000         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6001
  6002         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6003         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6004
  6005*        16  FILLER                      PIC X(53).
  6006         16  FILLER                      PIC X(47).
  6007
  6008         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6009         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6010
  6011         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6012             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6013             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6014*                    C = CLOSED
  6015*                    O = OPEN
  6016             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6017*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6018
  6019     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6020         16  AT-PAYMENT-TYPE             PIC X.
  6021             88  PARTIAL-PAYMENT                VALUE '1'.
  6022             88  FINAL-PAYMENT                  VALUE '2'.
  6023             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6024             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6025             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6026             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6027             88  VOIDED-PAYMENT                 VALUE '9'.
  6028             88  TRANSFER                       VALUE 'T'.
  6029             88  LIFE-INTEREST                  VALUE 'I'.
  6030
  6031         16  AT-CLAIM-TYPE               PIC X.
  6032             88  PAID-FOR-AH                    VALUE 'A'.
  6033             88  PAID-FOR-LIFE                  VALUE 'L'.
  6034             88  PAID-FOR-IUI                   VALUE 'I'.
  6035             88  PAID-FOR-GAP                   VALUE 'G'.
  6036             88  PAID-FOR-FAM                   VALUE 'F'.
  6037         16  AT-CLAIM-PREM-TYPE          PIC X.
  6038             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6039             88  AT-O-B-COVERAGE                VALUE '2'.
  6040             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6041         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6042         16  AT-CHECK-NO                 PIC X(7).
  6043         16  AT-PAID-FROM-DT             PIC XX.
  6044         16  AT-PAID-THRU-DT             PIC XX.
  6045         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 112
* EL130.cbl
  6046         16  AT-ACH-PAYMENT              PIC X.
  6047*        16  FILLER                      PIC X.
  6048         16  AT-PAYEES-NAME              PIC X(30).
  6049         16  AT-PAYMENT-ORIGIN           PIC X.
  6050             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6051             88  ONLINE-AUTO-PMT                VALUE '2'.
  6052             88  OFFLINE-PMT                    VALUE '3'.
  6053         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6054         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6055         16  AT-VOID-DATA.
  6056             20  AT-VOID-DT              PIC XX.
  6057*00144       20  AT-VOID-REASON          PIC X(30).
  6058             20  AT-VOID-REASON          PIC X(26).
  6059         16  AT-PMT-APPROVED-BY          PIC X(04).
  6060         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6061         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6062         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6063                                         PIC S99V9(5)  COMP-3.
  6064         16  AT-CREDIT-INTERFACE.
  6065             20  AT-PMT-SELECT-DT        PIC XX.
  6066                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6067             20  AT-PMT-ACCEPT-DT        PIC XX.
  6068                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6069             20  AT-VOID-SELECT-DT       PIC XX.
  6070                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6071             20  AT-VOID-ACCEPT-DT       PIC XX.
  6072                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6073
  6074         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6075                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6076                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6077         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6078
  6079         16  AT-FORCE-CONTROL            PIC X.
  6080             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6081         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6082         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6083         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6084         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6085         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6086         16  AT-BENEFIT-TYPE             PIC X.
  6087
  6088         16  AT-EXPENSE-TYPE             PIC X.
  6089         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6090
  6091         16  AT-PAYEE-TYPE-CD.
  6092             20  AT-PAYEE-TYPE           PIC X.
  6093                 88  INSURED-PAID           VALUE 'I'.
  6094                 88  BENEFICIARY-PAID       VALUE 'B'.
  6095                 88  ACCOUNT-PAID           VALUE 'A'.
  6096                 88  OTHER-1-PAID           VALUE 'O'.
  6097                 88  OTHER-2-PAID           VALUE 'Q'.
  6098                 88  DOCTOR-PAID            VALUE 'P'.
  6099                 88  EMPLOYER-PAID          VALUE 'E'.
  6100             20  AT-PAYEE-SEQ            PIC X.
  6101
  6102         16  AT-CASH-PAYMENT             PIC X.
  6103         16  AT-GROUPED-PAYMENT          PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 113
* EL130.cbl
  6104         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6105         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6106         16  AT-APPROVED-LEVEL           PIC X.
  6107         16  AT-VOID-TYPE                PIC X.
  6108             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6109             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6110         16  AT-AIG-UNEMP-IND            PIC X.
  6111             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6112         16  AT-ASSOCIATES               PIC X.
  6113             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6114             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6115
  6116         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6117         16  AT-CV-PMT-CODE              PIC X.
  6118             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6119             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6120             88  FULL-ADD-PAYMENT           VALUE '3'.
  6121             88  HALF-ADD-PAYMENT           VALUE '4'.
  6122             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6123             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6124             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6125             88  ADDL-PAYMENT               VALUE '8'.
  6126
  6127         16  AT-EOB-CODE1                PIC XXX.
  6128         16  AT-EOB-CODE2                PIC XXX.
  6129         16  AT-EOB-CODE3                PIC XXX.
  6130         16  FILLER REDEFINES AT-EOB-CODE3.
  6131             20  AT-PRINT-CLM-FORM       PIC X.
  6132             20  AT-PRINT-SURVEY         PIC X.
  6133             20  AT-SPECIAL-RELEASE      PIC X.
  6134         16  AT-EOB-CODE4                PIC XXX.
  6135         16  FILLER REDEFINES AT-EOB-CODE4.
  6136             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6137             20  FILLER                  PIC X.
  6138         16  AT-EOB-CODE5                PIC XXX.
  6139         16  FILLER REDEFINES AT-EOB-CODE5.
  6140             20  AT-PMT-PROOF-DT         PIC XX.
  6141             20  FILLER                  PIC X.
  6142
  6143         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6144             88  AT-PRINT-EOB            VALUE 'Y'.
  6145
  6146         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6147         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6148
  6149     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6150         16  AT-SCHEDULE-START-DT        PIC XX.
  6151         16  AT-SCHEDULE-END-DT          PIC XX.
  6152         16  AT-TERMINATED-DT            PIC XX.
  6153         16  AT-LAST-PMT-TYPE            PIC X.
  6154             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6155             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6156         16  AT-FIRST-PMT-DATA.
  6157             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6158             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6159             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6160         16  AT-REGULAR-PMT-DATA.
  6161             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 114
* EL130.cbl
  6162             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6163             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6164         16  AT-AUTO-PAYEE-CD.
  6165             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6166                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6167                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6168                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6169                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6170                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6171             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6172         16  AT-AUTO-PAY-DAY             PIC 99.
  6173         16  AT-AUTO-CASH                PIC X.
  6174             88  AT-CASH                      VALUE 'Y'.
  6175             88  AT-NON-CASH                  VALUE 'N'.
  6176*        16  FILLER                      PIC X(129).
  6177         16  AT-AUTO-END-LETTER          PIC X(4).
  6178         16  FILLER                      PIC X(125).
  6179
  6180         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6181         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6182
  6183     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6184         16  AT-LETTER-SENT-DT           PIC XX.
  6185         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6186         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6187         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6188         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6189         16  AT-LETTER-ORIGIN            PIC X.
  6190             88  ONLINE-CREATION              VALUE '1' '3'.
  6191             88  OFFLINE-CREATION             VALUE '2' '4'.
  6192             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6193             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6194         16  AT-STD-LETTER-FORM          PIC X(4).
  6195         16  AT-REASON-TEXT              PIC X(70).
  6196         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6197         16  AT-ADDRESEE-TYPE            PIC X.
  6198              88  INSURED-ADDRESEE            VALUE 'I'.
  6199              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6200              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6201              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6202              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6203              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6204              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6205         16  AT-ADDRESSEE-NAME           PIC X(30).
  6206         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6207         16  AT-RESEND-PRINT-DATE        PIC XX.
  6208         16  AT-CORR-SOL-UNSOL           PIC X.
  6209         16  AT-LETTER-PURGED-DT         PIC XX.
  6210*
  6211*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6212*
  6213         16  AT-CSO-REDEFINITION.
  6214             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6215             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6216             20  AT-LETTER-TO-BENE       PIC X(1).
  6217             20  AT-STOP-LETTER-DT       PIC X(2).
  6218             20  AT-AUTH-RCVD            PIC X(1).
  6219             20  FILLER                  PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 115
* EL130.cbl
  6220*             20  FILLER                  PIC X(27).
  6221             20  AT-CSO-LETTER-STATUS    PIC X.
  6222                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6223                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6224                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6225             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6226             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6227*
  6228*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6229*
  6230*        16  FILLER                      PIC X(26).
  6231*
  6232*        16  AT-DMD-BSR-CODE             PIC X.
  6233*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6234*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6235*
  6236*        16  AT-DMD-LETTER-STATUS        PIC X.
  6237*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6238*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6239*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6240*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6241*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6242
  6243         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6244         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6245
  6246     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6247         16  AT-ADDRESS-TYPE             PIC X.
  6248             88  INSURED-ADDRESS               VALUE 'I'.
  6249             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6250             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6251             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6252             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6253             88  OTHER-ADDRESS-1               VALUE 'O'.
  6254             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6255         16  AT-MAIL-TO-NAME             PIC X(30).
  6256         16  AT-ADDRESS-LINE-1           PIC X(30).
  6257         16  AT-ADDRESS-LINE-2           PIC X(30).
  6258         16  AT-CITY-STATE.
  6259             20  AT-CITY                 PIC X(28).
  6260             20  AT-STATE                PIC XX.
  6261         16  AT-ZIP.
  6262             20  AT-ZIP-CODE.
  6263                 24  AT-ZIP-1ST          PIC X.
  6264                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6265                 24  FILLER              PIC X(4).
  6266             20  AT-ZIP-PLUS4            PIC X(4).
  6267         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6268             20  AT-CAN-POSTAL-1         PIC XXX.
  6269             20  AT-CAN-POSTAL-2         PIC XXX.
  6270             20  FILLER                  PIC XXX.
  6271         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6272*         16  FILLER                      PIC X(23).
  6273         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6274         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6275         16  FILLER                      PIC X(13).
  6276         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6277         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 116
* EL130.cbl
  6278
  6279     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6280         16  AT-INFO-LINE-1              PIC X(60).
  6281         16  FILLER REDEFINES AT-INFO-LINE-1.
  6282             20  AT-NOTE-ERROR-NO OCCURS 15
  6283                                         PIC X(4).
  6284         16  AT-INFO-LINE-2              PIC X(60).
  6285         16  FILLER REDEFINES AT-INFO-LINE-2.
  6286             20  AT-ICD-CODE-1           PIC X(8).
  6287             20  AT-ICD-CODE-2           PIC X(8).
  6288             20  FILLER                  PIC X(44).
  6289         16  AT-INFO-TRAILER-TYPE        PIC X.
  6290             88  AT-ERRORS-NOTE          VALUE 'E'.
  6291             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6292             88  AT-CALL-NOTE            VALUE 'C'.
  6293             88  AT-MAINT-NOTE           VALUE 'M'.
  6294             88  AT-CERT-CHANGE          VALUE 'X'.
  6295             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6296             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6297             88  AT-CERT-CANCELLED       VALUE 'T'.
  6298         16  AT-CALL-TYPE                PIC X.
  6299             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6300             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6301         16  AT-NOTE-CONTINUATION        PIC X.
  6302             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6303         16  AT-EOB-CODES-EXIST          PIC X.
  6304             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6305         16  FILLER                      PIC X(35).
  6306         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6307         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6308
  6309     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6310         16  AT-PROMPT-LINE-1            PIC X(60).
  6311         16  AT-PROMPT-LINE-2            PIC X(60).
  6312         16  AT-PROMPT-START-DT          PIC XX.
  6313         16  AT-PROMPT-END-DT            PIC XX.
  6314         16  FILLER                      PIC X(35).
  6315         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6316         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6317
  6318     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6319         16  AT-DENIAL-INFO-1            PIC X(60).
  6320         16  AT-DENIAL-INFO-2            PIC X(60).
  6321         16  AT-DENIAL-DT                PIC XX.
  6322         16  AT-RETRACTION-DT            PIC XX.
  6323         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6324*         16  FILLER                      PIC X(31).
  6325         16  AT-DENIAL-PROOF-DT          PIC XX.
  6326         16  FILLER                      PIC X(29).
  6327         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6328         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6329
  6330     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6331         16  AT-OLD-INCURRED-DT          PIC XX.
  6332         16  AT-OLD-REPORTED-DT          PIC XX.
  6333         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6334         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6335         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 117
* EL130.cbl
  6336         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6337         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6338         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6339         16  FILLER                      PIC X(26).
  6340         16  AT-OLD-DIAG-CODE            PIC X(6).
  6341         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6342         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6343         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6344         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6345         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6346         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6347         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6348         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6349         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6350         16  FILLER                      PIC X(9).
  6351         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6352
  6353     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6354         16  AT-FORM-SEND-ON-DT          PIC XX.
  6355         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6356         16  AT-FORM-RE-SEND-DT          PIC XX.
  6357         16  AT-FORM-ANSWERED-DT         PIC XX.
  6358         16  AT-FORM-PRINTED-DT          PIC XX.
  6359         16  AT-FORM-REPRINT-DT          PIC XX.
  6360         16  AT-FORM-TYPE                PIC X.
  6361             88  INITIAL-FORM                  VALUE '1'.
  6362             88  PROGRESS-FORM                 VALUE '2'.
  6363         16  AT-INSTRUCT-LN-1            PIC X(28).
  6364         16  AT-INSTRUCT-LN-2            PIC X(28).
  6365         16  AT-INSTRUCT-LN-3            PIC X(28).
  6366         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6367         16  AT-FORM-ADDRESS             PIC X.
  6368             88  FORM-TO-INSURED              VALUE 'I'.
  6369             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6370             88  FORM-TO-OTHER-1              VALUE 'O'.
  6371             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6372         16  AT-RELATED-1.
  6373             20 AT-REL-CARR-1            PIC X.
  6374             20 AT-REL-CLAIM-1           PIC X(7).
  6375             20 AT-REL-CERT-1            PIC X(11).
  6376         16  AT-RELATED-2.
  6377             20 AT-REL-CARR-2            PIC X.
  6378             20 AT-REL-CLAIM-2           PIC X(7).
  6379             20 AT-REL-CERT-2            PIC X(11).
  6380         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6381         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6382         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6383         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6384         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6385         16  AT-STOP-FORM-DT             PIC X(2).
  6386
  6387         16  FILLER                      PIC X(09).
  6388         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6389         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6390******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 118
* EL130.cbl
  6392*    COPY ELCBENE.
  6393******************************************************************
  6394*                                                                *
  6395*                            ELCBENE.                            *
  6396*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6397*                            VMOD=2.006                          *
  6398*                                                                *
  6399*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6400*                                                                *
  6401*   FILE TYPE = VSAM,KSDS                                        *
  6402*   RECORD SIZE = 500   RECFORM = FIX                            *
  6403*                                                                *
  6404*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6405*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6406*                                                                *
  6407*   LOG = YES                                                    *
  6408*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6409*                                                                *
  6410*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6411******************************************************************
  6412*                   C H A N G E   L O G
  6413*
  6414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6415*-----------------------------------------------------------------
  6416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6417* EFFECTIVE    NUMBER
  6418*-----------------------------------------------------------------
  6419* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6420* 082317  CR2017082100003  PEMA  Add sub type
  6421******************************************************************
  6422
  6423 01  BENEFICIARY-MASTER.
  6424     12  BE-RECORD-ID                PIC XX.
  6425         88  VALID-BE-ID                VALUE 'BE'.
  6426
  6427     12  BE-CONTROL-PRIMARY.
  6428         16  BE-COMPANY-CD           PIC X.
  6429         16  BE-RECORD-TYPE          PIC X.
  6430             88  BENEFICIARY-RECORD  VALUE 'B'.
  6431             88  ADJUSTOR-RECORD     VALUE 'A'.
  6432         16  BE-BENEFICIARY          PIC X(10).
  6433     12  BE-CONTROL-BY-NAME.
  6434         16  BE-COMPANY-CD-A1        PIC X.
  6435         16  BE-RECORD-TYPE-A1       PIC X.
  6436         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6437         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6438
  6439     12  BE-LAST-MAINT-DT            PIC XX.
  6440     12  BE-LAST-MAINT-BY            PIC X(4).
  6441     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6442
  6443     12  BE-ADDRESS-DATA.
  6444         16  BE-MAIL-TO-NAME         PIC X(30).
  6445         16  BE-ADDRESS-LINE-1       PIC X(30).
  6446         16  BE-ADDRESS-LINE-2       PIC X(30).
  6447         16  BE-ADDRESS-LINE-3       PIC X(30).
  6448         16  BE-CITY-STATE.
  6449             20  BE-CITY             PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 119
* EL130.cbl
  6450             20  BE-STATE            PIC XX.
  6451         16  BE-ZIP-CODE.
  6452             20  BE-ZIP-PRIME.
  6453                 24  BE-ZIP-1ST      PIC X.
  6454                     88  BE-CANADIAN-POST-CODE
  6455                                         VALUE 'A' THRU 'Z'.
  6456                 24  FILLER          PIC X(4).
  6457             20  BE-ZIP-PLUS4        PIC X(4).
  6458         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6459             20  BE-CAN-POSTAL-1     PIC XXX.
  6460             20  BE-CAN-POSTAL-2     PIC XXX.
  6461             20  FILLER              PIC XXX.
  6462         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6463         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6464
  6465******************************************************************
  6466*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6467*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6468******************************************************************
  6469     12  BE-CARRIER                  PIC X.
  6470
  6471     12  BE-ADDRESS-DATA2.
  6472         16  BE-MAIL-TO-NAME2        PIC X(30).
  6473         16  BE-ADDRESS-LINE-12      PIC X(30).
  6474         16  BE-ADDRESS-LINE-22      PIC X(30).
  6475         16  BE-ADDRESS-LINE-32      PIC X(30).
  6476         16  BE-CITY-STATE2.
  6477             20  BE-CITY2            PIC X(28).
  6478             20  BE-STATE2           PIC XX.
  6479         16  BE-ZIP-CODE2.
  6480             20  BE-ZIP-PRIME2.
  6481                 24  BE-ZIP-1ST2     PIC X.
  6482                     88  BE-CANADIAN-POST-CODE2
  6483                                         VALUE 'A' THRU 'Z'.
  6484                 24  FILLER          PIC X(4).
  6485             20  BE-ZIP-PLUS42       PIC X(4).
  6486         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6487             20  BE-CAN-POSTAL-12    PIC XXX.
  6488             20  BE-CAN-POSTAL-22    PIC XXX.
  6489             20  FILLER              PIC XXX.
  6490         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6491         16  BE-ACH-DATA.
  6492             20  BE-ACH-YES-OR-NO    PIC X.
  6493                 88  BE-ON-ACH       VALUE 'Y'.
  6494                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  6495             20  BE-ACH-ABA-ROUTING-NUMBER
  6496                                     PIC X(15).
  6497             20  BE-ACH-BANK-ACCOUNT-NUMBER
  6498                                     PIC X(20).
  6499             20  BE-ACH-SUB-TYPE     PIC XX.
  6500             20  FILLER              PIC X(23).
  6501         16  BE-BILLING-STMT-DATA.
  6502*            20  BE-BSR              PIC X.
  6503*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  6504*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6505*            20  BE-BSR-FROM         PIC X(30).
  6506*            20  BE-BSR-DEPT         PIC X(30).
  6507             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 120
* EL130.cbl
  6508             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6509             20  BE-OUTPUT-TYPE      PIC X.
  6510                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6511                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6512
  6513     12  FILLER                      PIC X(28).
  6514******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 121
* EL130.cbl
  6516*    COPY ELCDAR.
  6517******************************************************************
  6518*                                                                *
  6519*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6520*   FILE TYPE = VSAM,KSDS                                        *
  6521*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6522*   BASE CLUSTER = DLYACTV                                       *
  6523*   LOG = YES                                                    *
  6524*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6525*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6526*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6527*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6528*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6529*               BY PROGRAM "LGINFCE".                            *
  6530*                                                                *
  6531******************************************************************
  6532 01  DAILY-ACTIVITY-RECORD.
  6533     05  DA-KEY.
  6534         10  DA-COMP-CD          PIC X.
  6535         10  DA-CARRIER          PIC X.
  6536         10  DA-CLAIM-NO         PIC X(7).
  6537         10  DA-CERT-NO.
  6538             15  DA-CERT-PRIME   PIC X(10).
  6539             15  DA-CERT-SFX     PIC X.
  6540     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6541     05  DA-RECORD-TYPE          PIC X.
  6542     05  FILLER                  PIC X(2).
  6543******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 122
* EL130.cbl
  6545*    COPY ELCACTQ.
  6546******************************************************************
  6547*                                                                *
  6548*                            ELCACTQ.                            *
  6549*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6550*                            VMOD=2.004                          *
  6551*                                                                *
  6552*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6553*                                                                *
  6554*   FILE TYPE = VSAM,KSDS                                        *
  6555*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6556*                                                                *
  6557*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6558*       ALTERNATE INDEX = NONE                                   *
  6559*                                                                *
  6560*   LOG = YES                                                    *
  6561*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6562*                                                                *
  6563*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6564******************************************************************
  6565
  6566 01  ACTIVITY-QUE.
  6567     12  AQ-RECORD-ID                PIC XX.
  6568         88  VALID-AQ-ID                VALUE 'AQ'.
  6569
  6570     12  AQ-CONTROL-PRIMARY.
  6571         16  AQ-COMPANY-CD           PIC X.
  6572         16  AQ-CARRIER              PIC X.
  6573         16  AQ-CLAIM-NO             PIC X(7).
  6574         16  AQ-CERT-NO.
  6575             20  AQ-CERT-PRIME       PIC X(10).
  6576             20  AQ-CERT-SFX         PIC X.
  6577
  6578     12  AQ-PENDING-ACTIVITY-FLAGS.
  6579         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6580         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6581             88  PENDING-PAYMENTS       VALUE '1'.
  6582         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6583             88  PENDING-FULL-PRINT     VALUE '1'.
  6584             88  PENDING-PART-PRINT     VALUE '2'.
  6585         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6586             88  PENDING-LETTERS        VALUE '1'.
  6587         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6588             88  PENDING-RESTORE        VALUE 'C'.
  6589             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6590
  6591     12  FILLER                      PIC X(20).
  6592
  6593     12  AQ-RESEND-DATE              PIC XX.
  6594     12  AQ-FOLLOWUP-DATE            PIC XX.
  6595     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6596     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6597     12  AQ-AUTO-LETTER              PIC X(4).
  6598     12  FILLER                      PIC XX.
  6599     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6600*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 123
* EL130.cbl
  6602*    COPY ELCARCH.
  6603******************************************************************
  6604*                                                                *
  6605*                            ELCARCH.                            *
  6606*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6607*                            VMOD=2.007                          *
  6608*                                                                *
  6609*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6610*                                                                *
  6611*   FILE TYPE = VSAM,KSDS                                        *
  6612*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6613*                                                                *
  6614*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6615*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6616*                                                                *
  6617*   LOG = NO                                                     *
  6618*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6619*                                                                *
  6620*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6621******************************************************************
  6622 01  LETTER-ARCHIVE.
  6623     12  LA-RECORD-ID                PIC XX.
  6624         88  VALID-LA-ID                VALUE 'LA'.
  6625
  6626     12  LA-CONTROL-PRIMARY.
  6627         16  LA-COMPANY-CD           PIC X.
  6628         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6629         16  LA-RECORD-TYPE          PIC X.
  6630             88  LA-HEADER-DATA         VALUE '1'.
  6631             88  LA-ADDRESS-DATA        VALUE '2'.
  6632             88  LA-TEXT-DATA           VALUE '3'.
  6633             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6634         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6635
  6636     12  LA-CONTROL-BY-TYPE.
  6637         16  LA-COMPANY-CD-A1        PIC X.
  6638         16  LA-RECORD-TYPE-A1       PIC X.
  6639         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6640         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6641
  6642     12  LA-TEXT-RECORD.
  6643         16  LA-SKIP-CONTROL         PIC XX.
  6644             88  NO-LINES-SKIPPED       VALUE SPACES.
  6645             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6646         16  LA-TEXT-LINE            PIC X(70).
  6647
  6648     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6649         16  FILLER                  PIC XX.
  6650         16  LA-ADDRESS-LINE         PIC X(30).
  6651         16  FILLER                  PIC X(40).
  6652
  6653     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6654         16  FILLER                  PIC XX.
  6655         16  LA-CARRIER              PIC X.
  6656         16  LA-CLAIM-NO             PIC X(7).
  6657         16  LA-CERT-NO.
  6658             20  LA-CERT-PRIME       PIC X(10).
  6659             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 124
* EL130.cbl
  6660         16  LA-NO-OF-COPIES         PIC S9.
  6661         16  LA-RESEND-DATE          PIC XX.
  6662         16  LA-PROCESSOR-CD         PIC X(4).
  6663         16  LA-CREATION-DT          PIC XX.
  6664         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6665         16  LA-RESEND-PRINT-DATE    PIC XX.
  6666         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6667         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6668*
  6669* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6670*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6671*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6672*   I        20  LA-DMD-RES-ST           PIC XX.
  6673*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6674*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6675*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6676*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6677*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6678*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6679*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6680*   I        20  LA-DMD-UND-CODE         PIC XX.
  6681*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6682*   V    16  FILLER                  PIC X(15).
  6683* -----
  6684*
  6685* REINSERTED  CSO  MODS
  6686*
  6687         16  FILLER.
  6688             20  FILLER                  PIC X(29).
  6689             20  LA-CSO-LETTER-STATUS    PIC X.
  6690                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6691                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6692                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6693             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6694             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6695*
  6696
  6697     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6698         16  FILLER                  PIC XX.
  6699         16  LA4-CARRIER             PIC X.
  6700         16  LA4-CLAIM-NO            PIC X(7).
  6701         16  LA4-CERT-NO.
  6702             20  LA4-CERT-PRIME      PIC X(10).
  6703             20  LA4-CERT-SFX        PIC X.
  6704         16  LA4-NO-OF-COPIES        PIC S9.
  6705         16  LA4-RESEND-DATE         PIC XX.
  6706         16  LA4-PROCESSOR-CD        PIC X(4).
  6707         16  LA4-CREATION-DT         PIC XX.
  6708         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6709         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6710         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6711         16  LA4-FORM-TYPE           PIC X.
  6712             88  LA4-INITIAL-FORM    VALUE '1'.
  6713             88  LA4-PROGRESS-FORM   VALUE '2'.
  6714         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6715         16  LA4-STATE               PIC X(02).
  6716         16  FILLER                  PIC X(31).
  6717******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 125
* EL130.cbl
  6719*    COPY ERCREIN.
  6720******************************************************************
  6721*                                                                *
  6722*                            ERCREIN                             *
  6723*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6724*                            VMOD=2.010                          *
  6725*                                                                *
  6726*   ONLINE CREDIT SYSTEM                                         *
  6727*                                                                *
  6728*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6729*                                                                *
  6730*   FILE TYPE = VSAM,KSDS                                        *
  6731*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6732*                                                                *
  6733*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6734*       ALTERNATE PATH = NONE                                    *
  6735*                                                                *
  6736*   LOG = NO                                                     *
  6737*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6738*                                                                *
  6739******************************************************************
  6740*                   C H A N G E   L O G
  6741*
  6742* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6743*-----------------------------------------------------------------
  6744*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6745* EFFECTIVE    NUMBER
  6746*-----------------------------------------------------------------
  6747* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6748* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6749******************************************************************
  6750 01  REINSURANCE-RECORD.
  6751     12  RE-RECORD-ID                      PIC XX.
  6752         88  VALID-RE-ID                      VALUE 'RE'.
  6753
  6754     12  RE-CONTROL-PRIMARY.
  6755         16  RE-COMPANY-CD                 PIC X.
  6756         16  RE-KEY.
  6757             20  RE-CODE                   PIC X.
  6758                 88  RE-TABLE-RECORD          VALUE 'A'.
  6759                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6760             20  RE-TABLE                  PIC XXX.
  6761             20  FILLER                    PIC XXX.
  6762         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6763             20  FILLER                    PIC X.
  6764             20  RE-COMPANY.
  6765                 24  RE-COMP-PRIME         PIC XXX.
  6766                 24  RE-COMP-SUB           PIC XXX.
  6767
  6768     12  RE-MAINT-INFORMATION.
  6769         16  RE-LAST-MAINT-DT              PIC XX.
  6770         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6771         16  RE-LAST-MAINT-USER            PIC X(4).
  6772         16  FILLER                        PIC X(10).
  6773
  6774     12  RE-TABLE-DATA.
  6775         16  RE-100-COMP                   PIC 99.
  6776
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 126
* EL130.cbl
  6777         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6778             20  RE-REI-COMP-NO.
  6779                 24  RE-REI-COMP           PIC XXX.
  6780                 24  RE-REI-COMP-SUB       PIC XXX.
  6781             20  RE-LF-QC                  PIC X.
  6782             20  RE-AH-QC                  PIC X.
  6783             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6784             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6785             20  RE-LFAGE-LO               PIC 99.
  6786             20  RE-LFAGE-HI               PIC 99.
  6787             20  RE-AHAGE-LO               PIC 99.
  6788             20  RE-AHAGE-HI               PIC 99.
  6789             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6790             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6791             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6792             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6793             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6794             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6795             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6796             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6797             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6798             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6799             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6800             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6801             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6802             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6803             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6804             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6805             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6806             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6807             20  RE-LF-BEN-CODE            PIC X.
  6808             20  RE-AH-BEN-CODE            PIC X.
  6809             20  RE-INTERACTIVE            PIC X.
  6810             20  RE-REMAINING              PIC X.
  6811             20  RE-LF-RUNOFF-SW           PIC X.
  6812             20  RE-AH-RUNOFF-SW           PIC X.
  6813             20  FILLER                    PIC X(19).
  6814
  6815         16  RE-COMP-INFO-END              PIC X(6).
  6816         16  RE-NSP-ST-CD-LF               PIC XX.
  6817         16  RE-NSP-ST-CD-AH               PIC XX.
  6818         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6819             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6820
  6821         16  FILLER                        PIC X(27).
  6822
  6823     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6824         16  RE-NAME                       PIC X(30).
  6825         16  RE-LF-PE                      PIC X.
  6826         16  RE-AH-PE                      PIC X.
  6827         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6828         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6829         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6830         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6831         16  RE-PRT-ST                     PIC X.
  6832         16  RE-PRT-OW                     PIC X.
  6833         16  RE-MORT-CODE                  PIC X(4).
  6834         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 127
* EL130.cbl
  6835         16  RE-ZERO-LF-FEE                PIC X.
  6836         16  RE-ZERO-AH-FEE                PIC X.
  6837         16  RE-CEDE-NAME                  PIC X(30).
  6838         16  RE-LF-COMM                    PIC X.
  6839         16  RE-AH-COMM                    PIC X.
  6840         16  RE-LF-TAX                     PIC X.
  6841         16  RE-AH-TAX                     PIC X.
  6842         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6843         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6844         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6845
  6846         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6847             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6848
  6849         16  RE-LF-CEDING-FEE-BRACKETS.
  6850             20  RE-LF-FEE-METHOD          PIC X.
  6851                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6852                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6853                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6854                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6855             20  RE-LF-FEE-BASIS           PIC X.
  6856                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6857                 88  RE-LF-NET-CEDED               VALUE '2'.
  6858                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6859                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6860                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6861                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6862                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6863                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6864             20  FILLER                    PIC XXX.
  6865             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6866                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6867                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6868
  6869         16  RE-AH-CEDING-FEE-BRACKETS.
  6870             20  RE-AH-FEE-METHOD          PIC X.
  6871                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6872                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6873                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6874                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6875             20  RE-AH-FEE-BASIS           PIC X.
  6876                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6877                 88  RE-AH-NET-CEDED               VALUE '2'.
  6878                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6879                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6880                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6881                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6882                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6883                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6884             20  FILLER                    PIC XXX.
  6885             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6886                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6887                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6888
  6889         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6890
  6891         16  RE-OLD-CEDING-STMT            PIC X.
  6892
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 128
* EL130.cbl
  6893         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6894         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6895         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6896         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6897         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6898         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6899         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6900         16  RE-MORT-SW                    PIC X.
  6901         16  RE-CEDING-TYPE-FLAG           PIC X.
  6902             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6903             88  RE-CEDED                          VALUE 'C'.
  6904             88  RE-ASSUMED                        VALUE 'A'.
  6905             88  RE-PHANTOM                        VALUE 'P'.
  6906
  6907         16  RE-CEDING-STMT-OPT-A          PIC X.
  6908             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6909         16  RE-CEDING-STMT-OPT-B          PIC X.
  6910             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6911         16  RE-CEDING-STMT-OPT-C          PIC X.
  6912             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6913         16  RE-CEDING-STMT-OPT-D          PIC X.
  6914             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6915         16  RE-CEDING-STMT-OPT-E          PIC X.
  6916             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6917
  6918         16  RE-PRT-CRSV                   PIC X.
  6919
  6920         16  RE-GL-CENTER                  PIC X(4).
  6921
  6922         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6923
  6924         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6925
  6926         16  RE-EARN-STOP-CODE             PIC X.
  6927             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6928             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6929
  6930         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6931             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6932
  6933         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6934         16  FILLER                        PIC X(2281).
  6935
  6936         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6937
  6938******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 129
* EL130.cbl
  6940*    COPY ERCMAIL.
  6941******************************************************************
  6942*                                                                *
  6943*                                                                *
  6944*                            ERCMAIL                             *
  6945*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6946*                            VMOD=2.003                          *
  6947*                                                                *
  6948*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6949*                                                                *
  6950*   FILE TYPE = VSAM,KSDS                                        *
  6951*   RECORD SIZE = 374   RECFORM = FIX                            *
  6952*                                                                *
  6953*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6954*   ALTERNATE PATH    = NOT USED                                 *
  6955*                                                                *
  6956*   LOG = YES                                                    *
  6957*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6958******************************************************************
  6959*                   C H A N G E   L O G
  6960*
  6961* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6962*-----------------------------------------------------------------
  6963*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6964* EFFECTIVE    NUMBER
  6965*-----------------------------------------------------------------
  6966* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6967* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6968* 111108                   PEMA  ADD CRED BENE ADDR2
  6969******************************************************************
  6970
  6971 01  MAILING-DATA.
  6972     12  MA-RECORD-ID                      PIC XX.
  6973         88  VALID-MA-ID                       VALUE 'MA'.
  6974
  6975     12  MA-CONTROL-PRIMARY.
  6976         16  MA-COMPANY-CD                 PIC X.
  6977         16  MA-CARRIER                    PIC X.
  6978         16  MA-GROUPING.
  6979             20  MA-GROUPING-PREFIX        PIC XXX.
  6980             20  MA-GROUPING-PRIME         PIC XXX.
  6981         16  MA-STATE                      PIC XX.
  6982         16  MA-ACCOUNT.
  6983             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6984             20  MA-ACCOUNT-PRIME          PIC X(6).
  6985         16  MA-CERT-EFF-DT                PIC XX.
  6986         16  MA-CERT-NO.
  6987             20  MA-CERT-PRIME             PIC X(10).
  6988             20  MA-CERT-SFX               PIC X.
  6989
  6990     12  FILLER                            PIC XX.
  6991
  6992     12  MA-ACCESS-CONTROL.
  6993         16  MA-SOURCE-SYSTEM              PIC XX.
  6994             88  MA-FROM-CREDIT                VALUE 'CR'.
  6995             88  MA-FROM-VSI                   VALUE 'VS'.
  6996             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6997             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 130
* EL130.cbl
  6998         16  MA-RECORD-ADD-DT              PIC XX.
  6999         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7000         16  MA-LAST-MAINT-DT              PIC XX.
  7001         16  MA-LAST-MAINT-BY              PIC XXXX.
  7002         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7003
  7004     12  MA-PROFILE-INFO.
  7005         16  MA-QUALIFY-CODE-1             PIC XX.
  7006         16  MA-QUALIFY-CODE-2             PIC XX.
  7007         16  MA-QUALIFY-CODE-3             PIC XX.
  7008         16  MA-QUALIFY-CODE-4             PIC XX.
  7009         16  MA-QUALIFY-CODE-5             PIC XX.
  7010
  7011         16  MA-INSURED-LAST-NAME          PIC X(15).
  7012         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7013         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7014         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7015         16  MA-INSURED-BIRTH-DT           PIC XX.
  7016         16  MA-INSURED-SEX                PIC X.
  7017             88  MA-SEX-MALE                   VALUE 'M'.
  7018             88  MA-SEX-FEMALE                 VALUE 'F'.
  7019         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7020
  7021         16  MA-ADDRESS-CORRECTED          PIC X.
  7022         16  MA-JOINT-BIRTH-DT             PIC XX.
  7023*        16  FILLER                        PIC X(12).
  7024
  7025         16  MA-ADDRESS-LINE-1             PIC X(30).
  7026         16  MA-ADDRESS-LINE-2             PIC X(30).
  7027         16  MA-CITY-STATE.
  7028             20  MA-CITY                   PIC X(28).
  7029             20  MA-ADDR-STATE             PIC XX.
  7030         16  MA-ZIP.
  7031             20  MA-ZIP-CODE.
  7032                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7033                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7034                 24  FILLER                PIC X(4).
  7035             20  MA-ZIP-PLUS4              PIC X(4).
  7036         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7037             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7038             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7039             20  FILLER                    PIC X(3).
  7040
  7041         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7042
  7043         16  FILLER                        PIC XXX.
  7044*        16  FILLER                        PIC X(10).
  7045
  7046     12  MA-CRED-BENE-INFO.
  7047         16  MA-CRED-BENE-NAME                 PIC X(25).
  7048         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7049         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7050         16  MA-CRED-BENE-CTYST.
  7051             20  MA-CRED-BENE-CITY             PIC X(28).
  7052             20  MA-CRED-BENE-STATE            PIC XX.
  7053         16  MA-CRED-BENE-ZIP.
  7054             20  MA-CB-ZIP-CODE.
  7055                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 131
* EL130.cbl
  7056                     88  MA-CB-CANADIAN-POST-CODE
  7057                                           VALUE 'A' THRU 'Z'.
  7058                 24  FILLER                    PIC X(4).
  7059             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7060         16  MA-CB-CANADIAN-POSTAL-CODE
  7061                            REDEFINES MA-CRED-BENE-ZIP.
  7062             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7063             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7064             20  FILLER                        PIC X(3).
  7065     12  MA-POST-CARD-MAIL-DATA.
  7066         16  MA-MAIL-DATA OCCURS 7.
  7067             20  MA-MAIL-TYPE              PIC X.
  7068                 88  MA-12MO-MAILING           VALUE '1'.
  7069                 88  MA-EXP-MAILING            VALUE '2'.
  7070             20  MA-MAIL-STATUS            PIC X.
  7071                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7072                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7073                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7074             20  MA-MAIL-DATE              PIC XX.
  7075     12  FILLER                            PIC XX.
  7076     12  FILLER                            PIC XX.
  7077*    12  FILLER                            PIC X(30).
  7078******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 132
* EL130.cbl
  7080*    COPY ELCCRTT.
  7081******************************************************************
  7082*                                                                *
  7083*                            ELCCRTT.                            *
  7084*                                                                *
  7085*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7086*                                                                *
  7087*   FILE TYPE = VSAM,KSDS                                        *
  7088*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7089*                                                                *
  7090*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7091*                                                                *
  7092*   LOG = YES                                                    *
  7093*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7094******************************************************************
  7095*                   C H A N G E   L O G
  7096*
  7097* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7098*-----------------------------------------------------------------
  7099*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7100* EFFECTIVE    NUMBER
  7101*-----------------------------------------------------------------
  7102* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7103* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7104* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7105* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7106* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7107* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7108* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7109* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7110* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7111******************************************************************
  7112
  7113 01  CERTIFICATE-TRAILERS.
  7114     12  CS-RECORD-ID                      PIC XX.
  7115         88  VALID-CS-ID                      VALUE 'CS'.
  7116
  7117     12  CS-CONTROL-PRIMARY.
  7118         16  CS-COMPANY-CD                 PIC X.
  7119         16  CS-CARRIER                    PIC X.
  7120         16  CS-GROUPING                   PIC X(6).
  7121         16  CS-STATE                      PIC XX.
  7122         16  CS-ACCOUNT                    PIC X(10).
  7123         16  CS-CERT-EFF-DT                PIC XX.
  7124         16  CS-CERT-NO.
  7125             20  CS-CERT-PRIME             PIC X(10).
  7126             20  CS-CERT-SFX               PIC X.
  7127         16  CS-TRAILER-TYPE               PIC X.
  7128             88  COMM-TRLR           VALUE 'A'.
  7129             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7130             88  CERT-DATA-TRLR      VALUE 'C'.
  7131
  7132     12  CS-DATA-AREA                      PIC X(516).
  7133
  7134     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7135         16  CS-BANK-COMMISSION-AREA.
  7136             20  CS-BANK-COMMS       OCCURS 10.
  7137                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 133
* EL130.cbl
  7138                 24  CS-COM-TYP            PIC X.
  7139                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7140                 24  CS-RECALC-LV-INDIC    PIC X.
  7141                 24  FILLER                PIC X(10).
  7142         16  FILLER                        PIC X(256).
  7143
  7144     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7145****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7146         16  CS-MB-CLAIM-DATA OCCURS 24.
  7147             20  CS-CLAIM-NO               PIC X(7).
  7148             20  CS-CLAIM-TYPE             PIC X.
  7149                 88  CS-AH-CLM               VALUE 'A'.
  7150                 88  CS-IU-CLM               VALUE 'I'.
  7151                 88  CS-GP-CLM               VALUE 'G'.
  7152                 88  CS-LF-CLM               VALUE 'L'.
  7153                 88  CS-PR-CLM               VALUE 'P'.
  7154                 88  CS-FL-CLM               VALUE 'F'.
  7155             20  CS-INSURED-TYPE           PIC X.
  7156                 88  CS-PRIM-INSURED          VALUE 'P'.
  7157                 88  CS-CO-BORROWER           VALUE 'C'.
  7158             20  CS-BENEFIT-PERIOD         PIC 99.
  7159             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7160             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7161             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7162         16  FILLER                        PIC X(12).
  7163     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7164         16  CS-VIN-NUMBER                 PIC X(17).
  7165         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7166         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7167         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7168         16  cs-agent-name.
  7169             20  cs-agent-fname            pic x(20).
  7170             20  cs-agent-mi               pic x.
  7171             20  cs-agent-lname            pic x(25).
  7172         16  cs-license-no                 pic x(15).
  7173         16  cs-npn-number                 pic x(10).
  7174         16  cs-agent-edit-status          pic x.
  7175             88  cs-ae-refer-to-manager      value 'M'.
  7176             88  cs-ae-cover-sheet           value 'C'.
  7177             88  cs-ae-sig-form              value 'S'.
  7178             88  cs-ae-verified              value 'V'.
  7179             88  cs-unidentified-signature   value 'U'.
  7180             88  cs-cert-returned            value 'R'.
  7181             88  cs-accept-no-commission     value 'N'.
  7182         16  cs-year                       pic 9999.
  7183         16  cs-make                       pic x(20).
  7184         16  cs-model                      pic x(20).
  7185         16  cs-future                     pic x(20).
  7186         16  cs-vehicle-odometer           pic s9(7) comp-3.
  7187         16  FILLER                        PIC X(356). *> was 420
  7188*        16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 134
* EL130.cbl
  7190
  7191 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7192                          CONTROL-FILE CERTIFICATE-MASTER
  7193                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  7194                          BENEFICIARY-MASTER
  7195                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  7196                          LETTER-ARCHIVE REINSURANCE-RECORD
  7197                          MAILING-DATA CERTIFICATE-TRAILERS.
  7198 0000-DFHEXIT SECTION.
  7199     MOVE '9#                    $   ' TO DFHEIV0.
  7200     MOVE 'EL130' TO DFHEIV1.
  7201     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7202     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7203     MOVE '5'                    TO DC-OPTION-CODE.
  7204     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7205     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7206     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7207
  7208     IF EIBCALEN = ZERO
  7209         GO TO 8800-UNAUTHORIZED-ACCESS
  7210     END-IF.
  7211
  7212     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7213     MOVE EIBTRMID               TO QID-TERM.
  7214     MOVE +2                     TO EMI-NUMBER-OF-LINES
  7215     move spaces                 to emi-error-lines
  7216     MOVE '2'                    TO EMI-SWITCH2.
  7217     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7218     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7219
  7220
  7221* EXEC CICS HANDLE CONDITION
  7222*        QIDERR     (0100-TEST-ENTRY)
  7223*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  7224*        PGMIDERR   (9600-PGMID-ERROR)
  7225*        TERMIDERR  (8820-TERM-ERROR)
  7226*        TRANSIDERR (8830-TRAN-ERROR)
  7227*        ERROR      (9990-ABEND)
  7228*    END-EXEC.
  7229*    MOVE '"$N?L[\.              ! " #00007216' TO DFHEIV0
  7230     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  7231     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7232     MOVE X'2220233030303037323136' TO DFHEIV0(25:11)
  7233     CALL 'kxdfhei1' USING DFHEIV0
  7234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7235
  7236
  7237     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  7238        PI-CALLING-PROGRAM   = XCTL-6592
  7239         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  7240     ELSE
  7241         MOVE SPACES             TO RETURNED-FROM
  7242     END-IF.
  7243
  7244     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7245         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7246             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7247             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 135
* EL130.cbl
  7248             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7249             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7250             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7251             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7252             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7253             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7254         ELSE
  7255             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7256             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7257             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7258             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7259             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7260             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7261             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7262             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7263         END-IF
  7264     END-IF.
  7265
  7266     IF EIBTRNID = TRANS-ID
  7267         IF EIBAID = DFHCLEAR
  7268             GO TO 9400-CLEAR
  7269         ELSE
  7270             GO TO 0200-RECEIVE
  7271         END-IF
  7272     END-IF.
  7273
  7274     IF RETURNED-FROM NOT = SPACES
  7275         GO TO 0600-RECOVER-TEMP-STORAGE
  7276     END-IF.
  7277
  7278     MOVE LOW-VALUES TO EL130AO.
  7279     move zeros to pi-dcc-max-amt
  7280                   pi-dcc-max-benefits
  7281
  7282
  7283
  7284* EXEC CICS DELETEQ TS
  7285*         QUEUE   (QID)
  7286*    END-EXEC.
  7287*    MOVE '*&                    #   #00007271' TO DFHEIV0
  7288     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7289     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7290     MOVE X'2020233030303037323731' TO DFHEIV0(25:11)
  7291     CALL 'kxdfhei1' USING DFHEIV0,
  7292           QID,
  7293           DFHEIV99
  7294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7295
  7296
  7297 0100-TEST-ENTRY.
  7298     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7299         GO TO 0650-FROM-EL127
  7300     ELSE
  7301         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7302                                    PI-CERT-PROCESSED
  7303                                    PI-LETTER-ERROR-CODE
  7304     END-IF.
  7305
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 136
* EL130.cbl
  7306     IF PI-RETURN-TO-PROGRAM = XCTL-132
  7307         GO TO 0640-FROM-EL132
  7308     END-IF.
  7309
  7310     GO TO 8100-SEND-INITIAL-MAP.
  7311
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 137
* EL130.cbl
  7313 0200-RECEIVE.
  7314     MOVE LOW-VALUES             TO EL130AI.
  7315
  7316     IF PI-PROCESSOR-ID = 'LGXX'
  7317*        NEXT SENTENCE
  7318         CONTINUE
  7319     ELSE
  7320
  7321* EXEC CICS READQ TS
  7322*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7323*            INTO    (SECURITY-CONTROL)
  7324*            LENGTH  (SC-COMM-LENGTH)
  7325*            ITEM    (SC-ITEM)
  7326*        END-EXEC
  7327*    MOVE '*$II   L              ''   #00007298' TO DFHEIV0
  7328     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7329     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7330     MOVE X'2020233030303037323938' TO DFHEIV0(25:11)
  7331     CALL 'kxdfhei1' USING DFHEIV0,
  7332           PI-SECURITY-TEMP-STORE-ID,
  7333           SECURITY-CONTROL,
  7334           SC-COMM-LENGTH,
  7335           SC-ITEM,
  7336           DFHEIV99,
  7337           DFHEIV99
  7338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7339         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7340         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7341         IF NOT DISPLAY-CAP
  7342             MOVE 'READ'              TO  SM-READ
  7343             PERFORM 9995-SECURITY-VIOLATION
  7344             MOVE ER-0070             TO  EMI-ERROR
  7345             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7346             GO TO 8100-SEND-INITIAL-MAP
  7347         END-IF
  7348     END-IF.
  7349
  7350     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7351         MOVE ER-7008 TO EMI-ERROR
  7352         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7353         MOVE -1 TO MAINTL
  7354         GO TO 8200-SEND-DATAONLY
  7355     END-IF.
  7356
  7357
  7358
  7359* EXEC CICS RECEIVE
  7360*         MAP     (MAP-NAME)
  7361*         MAPSET  (MAPSET-NAME)
  7362*         INTO    (EL130AI)
  7363*    END-EXEC.
  7364     MOVE LENGTH OF
  7365      EL130AI
  7366       TO DFHEIV11
  7367*    MOVE '8"T I  L              ''   #00007323' TO DFHEIV0
  7368     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7369     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7370     MOVE X'2020233030303037333233' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 138
* EL130.cbl
  7371     CALL 'kxdfhei1' USING DFHEIV0,
  7372           MAP-NAME,
  7373           EL130AI,
  7374           DFHEIV11,
  7375           MAPSET-NAME,
  7376           DFHEIV99,
  7377           DFHEIV99
  7378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7379
  7380
  7381     IF NOT PI-NO-CARRIER-SECURITY
  7382        MOVE +1                  TO CLMCARRL
  7383        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7384     END-IF.
  7385
  7386     IF ENTERPFL = ZERO
  7387         GO TO 0300-CHECK-PFKEYS
  7388     END-IF.
  7389
  7390     IF EIBAID NOT = DFHENTER
  7391         MOVE ER-0004            TO EMI-ERROR
  7392         GO TO 0320-INPUT-ERROR
  7393     END-IF.
  7394
  7395     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7396         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7397     ELSE
  7398         MOVE ER-0029            TO EMI-ERROR
  7399         GO TO 0320-INPUT-ERROR
  7400     END-IF.
  7401
  7402 0300-CHECK-PFKEYS.
  7403     IF EIBAID = DFHPF23
  7404         GO TO 8810-PF23
  7405     END-IF.
  7406
  7407     IF EIBAID = DFHPF24
  7408         GO TO 9200-RETURN-MAIN-MENU
  7409     END-IF.
  7410
  7411     IF EIBAID = DFHPF12
  7412         GO TO 9500-PF12
  7413     END-IF.
  7414
  7415     IF EIBAID = DFHPF3
  7416         MOVE SPACES              TO MAINTI
  7417         MOVE ZEROS               TO MAINTL
  7418         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7419         MOVE XCTL-127            TO PGM-NAME
  7420         GO TO 9300-XCTL
  7421     END-IF.
  7422
  7423     IF EIBAID = DFHPF4
  7424         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7425         MOVE XCTL-132            TO PGM-NAME
  7426         GO TO 9300-XCTL
  7427     END-IF.
  7428
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 139
* EL130.cbl
  7429     IF EIBAID = DFHPF13
  7430         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7431             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7432             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7433             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7434             MOVE PI-STATE            TO  PI-CR-STATE
  7435             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7436             MOVE XCTL-650            TO  PGM-NAME
  7437             GO TO 9300-XCTL
  7438         ELSE
  7439             MOVE -1                  TO  ENTERPFL
  7440             MOVE ER-2566             TO  EMI-ERROR
  7441             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7442             GO TO 8100-SEND-INITIAL-MAP
  7443         END-IF
  7444     END-IF.
  7445
  7446     IF EIBAID = DFHPF5
  7447         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7448             ADD +1 TO PI-CERT-PROCESSED
  7449             GO TO 0650-FROM-EL127
  7450         ELSE
  7451             MOVE ER-7686         TO EMI-ERROR
  7452             GO TO 0320-INPUT-ERROR
  7453         END-IF
  7454     END-IF.
  7455
  7456     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7457         GO TO 0800-TEST-PREVIOUS-CONTROL
  7458     END-IF.
  7459
  7460     IF PI-HAS-CLAS-IC-CRDTCRD
  7461         IF EIBAID = DFHPF10
  7462             MOVE XCTL-725          TO PGM-NAME
  7463             GO TO 9300-XCTL
  7464         END-IF
  7465     END-IF.
  7466
  7467     IF EIBAID = DFHPF14
  7468         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7469         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7470         MOVE XCTL-659            TO PGM-NAME
  7471         GO TO 9300-XCTL
  7472     END-IF.
  7473
  7474     IF EIBAID = DFHPF15
  7475         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7476         MOVE XCTL-114            TO PGM-NAME
  7477         GO TO 9300-XCTL
  7478     END-IF.
  7479
  7480*    IF EIBAID = DFHPF11
  7481*       GO TO 0600-RECOVER-TEMP-STORAGE
  7482*    END-IF
  7483     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7484         GO TO 0330-EDIT-DATA
  7485     END-IF.
  7486
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 140
* EL130.cbl
  7487     MOVE ER-0029                TO EMI-ERROR.
  7488
  7489 0320-INPUT-ERROR.
  7490     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7491
  7492     MOVE AL-UNBON               TO ENTERPFA.
  7493
  7494     IF ENTERPFL = ZERO
  7495         MOVE -1                 TO MAINTL
  7496     ELSE
  7497         MOVE -1                 TO ENTERPFL
  7498     END-IF.
  7499
  7500     GO TO 8200-SEND-DATAONLY.
  7501
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 141
* EL130.cbl
  7503 0330-EDIT-DATA.
  7504
  7505     IF MAINTI = 'S'
  7506         IF PRTOPTL GREATER THAN 0
  7507             IF PRTOPTI NOT = 'N' AND 'L'
  7508                 MOVE AL-UABON   TO  PRTOPTA
  7509                 MOVE -1         TO  PRTOPTL
  7510                 MOVE ER-0334    TO  EMI-ERROR
  7511                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7512                 GO TO 8200-SEND-DATAONLY
  7513             ELSE
  7514                 IF PRTOPTI = 'L'
  7515                     GO TO 0400-CREATE-ELACTQ
  7516                 ELSE
  7517                     GO TO 0480-PRINT-NOW
  7518                 END-IF
  7519             END-IF
  7520         ELSE
  7521             GO TO 1000-SHOW-CLAIM
  7522         END-IF
  7523     END-IF.
  7524
  7525     IF NOT MODIFY-CAP
  7526         MOVE 'UPDATE'       TO  SM-READ
  7527         PERFORM 9995-SECURITY-VIOLATION
  7528         MOVE ER-0070        TO  EMI-ERROR
  7529         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7530         GO TO 8100-SEND-INITIAL-MAP
  7531     END-IF.
  7532
  7533     IF MAINTI = 'D'
  7534         GO TO 2000-DELETE-CLAIM
  7535     END-IF.
  7536
  7537     IF MAINTI = 'A'
  7538         GO TO 3000-ADD-CLAIM
  7539     END-IF.
  7540
  7541     IF MAINTI = 'I'
  7542         GO TO 5000-INCURRED-CHANGE
  7543     END-IF.
  7544
  7545     MOVE ER-0023                TO EMI-ERROR.
  7546     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7547     MOVE -1                     TO MAINTL.
  7548     MOVE AL-UABON               TO MAINTA.
  7549
  7550     GO TO 8200-SEND-DATAONLY.
  7551
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 142
* EL130.cbl
  7553 0400-CREATE-ELACTQ.
  7554     IF CLMNOI   = PI-LAST-CLAIM      AND
  7555        CLMCARRI = PI-LAST-CARR       AND
  7556        CERTNOI  = PI-LAST-CERT-PRIME AND
  7557        SUFXI    = PI-LAST-CERT-SUFX
  7558         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7559         MOVE PI-LAST-CARR       TO PI-CARRIER
  7560         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7561     ELSE
  7562         MOVE ER-0207            TO EMI-ERROR
  7563         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7564         MOVE -1                 TO MAINTL
  7565         GO TO 8200-SEND-DATAONLY
  7566     END-IF.
  7567
  7568     IF (NOT PI-NO-CARRIER-SECURITY OR
  7569         NOT PI-NO-ACCOUNT-SECURITY)
  7570         MOVE AL-UABON      TO  PRTOPTA
  7571         MOVE -1            TO  PRTOPTL
  7572         MOVE ER-2378       TO  EMI-ERROR
  7573         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7574         GO TO 8200-SEND-DATAONLY
  7575     END-IF.
  7576
  7577     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7578     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7579     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7580     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7581
  7582
  7583
  7584* EXEC CICS HANDLE CONDITION
  7585*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7586*    END-EXEC.
  7587*    MOVE '"$I                   ! # #00007531' TO DFHEIV0
  7588     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7589     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7590     MOVE X'2320233030303037353331' TO DFHEIV0(25:11)
  7591     CALL 'kxdfhei1' USING DFHEIV0
  7592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7593
  7594
  7595
  7596
  7597* EXEC CICS READ
  7598*         UPDATE
  7599*         DATASET    (ELACTQ-DSID)
  7600*         SET        (ADDRESS OF ACTIVITY-QUE)
  7601*         RIDFLD     (ELACTQ-KEY)
  7602*    END-EXEC.
  7603*    MOVE '&"S        EU         (   #00007536' TO DFHEIV0
  7604     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7605     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7606     MOVE X'2020233030303037353336' TO DFHEIV0(25:11)
  7607     CALL 'kxdfhei1' USING DFHEIV0,
  7608           ELACTQ-DSID,
  7609           DFHEIV20,
  7610           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 143
* EL130.cbl
  7611           ELACTQ-KEY,
  7612           DFHEIV99,
  7613           DFHEIV99,
  7614           DFHEIV99
  7615     SET ADDRESS OF ACTIVITY-QUE TO
  7616         DFHEIV20
  7617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7618
  7619
  7620     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7621     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7622
  7623
  7624
  7625* EXEC CICS REWRITE
  7626*         DATASET     (ELACTQ-DSID)
  7627*         FROM        (ACTIVITY-QUE)
  7628*    END-EXEC.
  7629     MOVE LENGTH OF
  7630      ACTIVITY-QUE
  7631       TO DFHEIV11
  7632*    MOVE '&& L                  %   #00007547' TO DFHEIV0
  7633     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7634     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7635     MOVE X'2020233030303037353437' TO DFHEIV0(25:11)
  7636     CALL 'kxdfhei1' USING DFHEIV0,
  7637           ELACTQ-DSID,
  7638           ACTIVITY-QUE,
  7639           DFHEIV11,
  7640           DFHEIV99
  7641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7642
  7643
  7644     GO TO 0470-STATUS-FINISH.
  7645
  7646 0450-ADD-ELACTQ-RECORD.
  7647
  7648
  7649* EXEC CICS GETMAIN
  7650*        SET     (ADDRESS OF ACTIVITY-QUE)
  7651*        LENGTH  (ELACTQ-LENGTH)
  7652*        INITIMG (GETMAIN-SPACE)
  7653*    END-EXEC.
  7654*    MOVE ',"IL                  $   #00007556' TO DFHEIV0
  7655     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7656     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7657     MOVE X'2020233030303037353536' TO DFHEIV0(25:11)
  7658     CALL 'kxdfhei1' USING DFHEIV0,
  7659           DFHEIV20,
  7660           ELACTQ-LENGTH,
  7661           GETMAIN-SPACE
  7662     SET ADDRESS OF ACTIVITY-QUE TO
  7663         DFHEIV20
  7664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7665
  7666
  7667     MOVE 'AQ'              TO AQ-RECORD-ID.
  7668     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 144
* EL130.cbl
  7669     MOVE +0                TO AQ-PAYMENT-COUNTER
  7670                               AQ-PMT-UNAPPROVED-COUNT.
  7671     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7672                               AQ-FOLLOWUP-DATE.
  7673     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7674     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7675
  7676
  7677
  7678* EXEC CICS WRITE
  7679*         DATASET     (ELACTQ-DSID)
  7680*         FROM        (ACTIVITY-QUE)
  7681*         RIDFLD      (ELACTQ-KEY)
  7682*    END-EXEC.
  7683     MOVE LENGTH OF
  7684      ACTIVITY-QUE
  7685       TO DFHEIV11
  7686*    MOVE '&$ L                  ''   #00007572' TO DFHEIV0
  7687     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7688     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7689     MOVE X'2020233030303037353732' TO DFHEIV0(25:11)
  7690     CALL 'kxdfhei1' USING DFHEIV0,
  7691           ELACTQ-DSID,
  7692           ACTIVITY-QUE,
  7693           DFHEIV11,
  7694           ELACTQ-KEY,
  7695           DFHEIV99,
  7696           DFHEIV99
  7697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7698
  7699
  7700 0470-STATUS-FINISH.
  7701     MOVE AL-UANOF               TO  PRTOPTA
  7702                                     ALTPRTA.
  7703
  7704     MOVE SPACES                 TO  PRTOPTO
  7705                                     ALTPRTO.
  7706
  7707     MOVE ER-0000                TO EMI-ERROR.
  7708     MOVE -1                     TO MAINTL.
  7709     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7710     GO TO 8100-SEND-INITIAL-MAP.
  7711
  7712 0480-PRINT-NOW.
  7713
  7714
  7715* EXEC CICS HANDLE CONDITION
  7716*        TERMIDERR   (8820-TERM-ERROR)
  7717*        TRANSIDERR  (8830-TRAN-ERROR)
  7718*    END-EXEC.
  7719*    MOVE '"$[\                  ! $ #00007592' TO DFHEIV0
  7720     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7721     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7722     MOVE X'2420233030303037353932' TO DFHEIV0(25:11)
  7723     CALL 'kxdfhei1' USING DFHEIV0
  7724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7725
  7726
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 145
* EL130.cbl
  7727     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7728     MOVE '1'                    TO  CNTL-REC-TYPE.
  7729     MOVE SPACES                 TO  CNTL-ACCESS.
  7730     MOVE +0                     TO  CNTL-SEQ-NO.
  7731     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7732
  7733     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7734
  7735     IF CF-FORMS-PRINTER-ID = SPACES
  7736         IF ALTPRTL NOT GREATER THAN 0
  7737             MOVE ER-0337        TO  EMI-ERROR
  7738             MOVE -1             TO  ALTPRTL
  7739             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7740             GO TO 8200-SEND-DATAONLY
  7741         END-IF
  7742     END-IF.
  7743
  7744     IF ALTPRTL GREATER THAN 0
  7745         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7746     END-IF.
  7747
  7748     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7749     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7750     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7751
  7752
  7753
  7754* EXEC CICS START
  7755*        TRANSID   (START-TRANS-ID)
  7756*        TERMID    (CF-FORMS-PRINTER-ID)
  7757*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7758*        LENGTH    (PI-COMM-LENGTH)
  7759*    END-EXEC.
  7760*    MOVE '0( LFT                1   #00007623' TO DFHEIV0
  7761     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7762     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7763     MOVE X'2020233030303037363233' TO DFHEIV0(25:11)
  7764     CALL 'kxdfhei1' USING DFHEIV0,
  7765           DFHEIV99,
  7766           START-TRANS-ID,
  7767           DFHEIV99,
  7768           PROGRAM-INTERFACE-BLOCK,
  7769           PI-COMM-LENGTH,
  7770           CF-FORMS-PRINTER-ID,
  7771           DFHEIV99,
  7772           DFHEIV99,
  7773           DFHEIV99,
  7774           DFHEIV99,
  7775           DFHEIV99,
  7776           DFHEIV99,
  7777           DFHEIV99,
  7778           DFHEIV99,
  7779           DFHEIV99,
  7780           DFHEIV99
  7781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7782
  7783
  7784     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 146
* EL130.cbl
  7785                                     ALTPRTA.
  7786
  7787     MOVE SPACES                 TO  PRTOPTO
  7788                                     ALTPRTO.
  7789
  7790     MOVE ER-0000                TO  EMI-ERROR.
  7791     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7792     MOVE -1                     TO  MAINTL.
  7793     GO TO 8100-SEND-INITIAL-MAP.
  7794
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 147
* EL130.cbl
  7796 0500-CREATE-TEMP-STORAGE.
  7797     MOVE EIBCPOSN               TO PI-CURSOR.
  7798
  7799    move emi-line1               to errmsg1o
  7800    move emi-line2               to errmsg2o
  7801    move emi-sub                 to pi-emi-sub
  7802
  7803
  7804* EXEC CICS WRITEQ TS
  7805*        QUEUE   (QID)
  7806*        FROM    (EL130AI)
  7807*        LENGTH  (QID-MAP-LENGTH)
  7808*    END-EXEC.
  7809*    MOVE '*"     L              ''   #00007649' TO DFHEIV0
  7810     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7811     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7812     MOVE X'2020233030303037363439' TO DFHEIV0(25:11)
  7813     CALL 'kxdfhei1' USING DFHEIV0,
  7814           QID,
  7815           EL130AI,
  7816           QID-MAP-LENGTH,
  7817           DFHEIV99,
  7818           DFHEIV99,
  7819           DFHEIV99
  7820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7821
  7822
  7823
  7824
  7825* EXEC CICS WRITEQ TS
  7826*        QUEUE    (QID)
  7827*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7828*        LENGTH   (PI-COMM-LENGTH)
  7829*    END-EXEC.
  7830*    MOVE '*"     L              ''   #00007656' TO DFHEIV0
  7831     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7832     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7833     MOVE X'2020233030303037363536' TO DFHEIV0(25:11)
  7834     CALL 'kxdfhei1' USING DFHEIV0,
  7835           QID,
  7836           PROGRAM-INTERFACE-BLOCK,
  7837           PI-COMM-LENGTH,
  7838           DFHEIV99,
  7839           DFHEIV99,
  7840           DFHEIV99
  7841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7842
  7843
  7844 0599-EXIT.
  7845      EXIT.
  7846
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 148
* EL130.cbl
  7848 0600-RECOVER-TEMP-STORAGE.
  7849     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7850     MOVE PI-EL127-TO-EL130-CNTRL
  7851                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7852     MOVE PI-EL659-TO-EL130-CNTRL
  7853                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7854     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7855     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7856     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7857     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7858     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7859     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7860     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7861     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7862     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7863     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7864     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7865     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7866     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7867     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7868     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7869     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7870                                 TO SAVE-BENEFICIARY
  7871
  7872
  7873
  7874* EXEC CICS HANDLE CONDITION
  7875*        NOTFND  (0660-NOT-FOUND)
  7876*        QIDERR  (0670-QIDERR)
  7877*    END-EXEC.
  7878*    MOVE '"$IN                  ! % #00007691' TO DFHEIV0
  7879     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7881     MOVE X'2520233030303037363931' TO DFHEIV0(25:11)
  7882     CALL 'kxdfhei1' USING DFHEIV0
  7883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7884
  7885
  7886
  7887
  7888* EXEC CICS READQ TS
  7889*        QUEUE    (QID)
  7890*        INTO     (EL130AI)
  7891*        LENGTH   (QID-MAP-LENGTH)
  7892*    END-EXEC.
  7893*    MOVE '*$I    L              ''   #00007697' TO DFHEIV0
  7894     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7895     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7896     MOVE X'2020233030303037363937' TO DFHEIV0(25:11)
  7897     CALL 'kxdfhei1' USING DFHEIV0,
  7898           QID,
  7899           EL130AI,
  7900           QID-MAP-LENGTH,
  7901           DFHEIV99,
  7902           DFHEIV99,
  7903           DFHEIV99
  7904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7905
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 149
* EL130.cbl
  7906
  7907     IF RETURNED-FROM = XCTL-131
  7908        IF CLAIM-DELETED-BY-EL131
  7909            MOVE LOW-VALUES      TO CERTNOI
  7910                                    SUFXI
  7911            MOVE ZEROS           TO CERTNOL
  7912                                    SUFXL
  7913         END-IF
  7914     END-IF.
  7915
  7916     IF RETURNED-FROM = XCTL-131
  7917         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7918         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7919                                    PI-CERT-PROCESSED
  7920     ELSE
  7921
  7922
  7923* EXEC CICS READQ TS
  7924*             QUEUE   (QID)
  7925*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7926*             LENGTH  (PI-COMM-LENGTH)
  7927*        END-EXEC
  7928*    MOVE '*$I    L              ''   #00007718' TO DFHEIV0
  7929     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7930     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7931     MOVE X'2020233030303037373138' TO DFHEIV0(25:11)
  7932     CALL 'kxdfhei1' USING DFHEIV0,
  7933           QID,
  7934           PROGRAM-INTERFACE-BLOCK,
  7935           PI-COMM-LENGTH,
  7936           DFHEIV99,
  7937           DFHEIV99,
  7938           DFHEIV99
  7939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7940     END-IF.
  7941
  7942
  7943* EXEC CICS DELETEQ TS
  7944*        QUEUE   (QID)
  7945*    END-EXEC.
  7946*    MOVE '*&                    #   #00007725' TO DFHEIV0
  7947     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7948     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7949     MOVE X'2020233030303037373235' TO DFHEIV0(25:11)
  7950     CALL 'kxdfhei1' USING DFHEIV0,
  7951           QID,
  7952           DFHEIV99
  7953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7954
  7955
  7956     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7957
  7958     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7959         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7960         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7961         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7962         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7963         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 150
* EL130.cbl
  7964         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7965         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7966         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7967         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7968         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7969         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7970         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7971         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7972         MOVE SAVE-CERT-ACCESS-CONTROL
  7973                                    TO PI-CERT-ACCESS-CONTROL
  7974         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7975                                    TO PI-CARRIER-CONTROL-LEVEL
  7976     END-IF.
  7977
  7978*    IF EIBAID = DFHPF11
  7979*       move errmsg1i            to emi-line1
  7980*       move errmsg2i            to emi-line2
  7981*       move pi-emi-sub          to emi-sub
  7982*       go to 8200-SEND-DATAONLY
  7983*    end-if
  7984     IF RETURNED-FROM = XCTL-127
  7985         MOVE SAVE-EL127-TO-EL130-CNTRL
  7986                                 TO PI-EL127-TO-EL130-CNTRL
  7987     END-IF.
  7988
  7989     IF RETURNED-FROM = XCTL-6592
  7990        MOVE SAVE-EL659-TO-EL130-CNTRL
  7991                                 TO PI-EL659-TO-EL130-CNTRL
  7992     END-IF.
  7993
  7994     IF RETURNED-FROM = XCTL-114
  7995        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7996           MOVE SAVE-BENEFICIARY TO BENECDI
  7997           MOVE +10              TO BENECDL
  7998           MOVE -1               TO BIRTHDTL
  7999        END-IF
  8000     END-IF.
  8001     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  8002
  8003     IF MAINTL NOT = ZERO
  8004         MOVE AL-UANON           TO MAINTA
  8005     END-IF.
  8006
  8007     IF ENTERPFL NOT = ZERO
  8008         MOVE AL-UNNON           TO ENTERPFA
  8009     END-IF.
  8010
  8011     IF RETURNED-FROM = XCTL-127
  8012         GO TO 0650-FROM-EL127
  8013     END-IF.
  8014
  8015     IF RETURNED-FROM = XCTL-132
  8016         GO TO 0640-FROM-EL132
  8017     END-IF.
  8018
  8019     IF RETURNED-FROM = XCTL-650
  8020         MOVE AL-SABON           TO PF5A
  8021         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 151
* EL130.cbl
  8022     END-IF.
  8023
  8024     IF RETURNED-FROM = XCTL-6592
  8025         GO TO 0630-FROM-EL6592
  8026     END-IF.
  8027
  8028     IF MAINTI = 'S' OR 'I'
  8029        GO TO 1000-SHOW-CLAIM
  8030     END-IF.
  8031
  8032     GO TO 8100-SEND-INITIAL-MAP.
  8033
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 152
* EL130.cbl
  8035 0630-FROM-EL6592.
  8036     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  8037     MOVE PI-EL659-GROUPING      TO GROUPO.
  8038     MOVE PI-EL659-STATE         TO STATEO.
  8039     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  8040
  8041     MOVE AL-UANON               TO CRTCARRA
  8042                                    GROUPA
  8043                                    STATEA
  8044                                    ACCOUNTA.
  8045     GO TO 8100-SEND-INITIAL-MAP.
  8046
  8047 0640-FROM-EL132.
  8048     IF PI-CLAIM-NO = SPACES
  8049         GO TO 0645-NO-CLAIM-SELECTED
  8050     END-IF.
  8051
  8052     MOVE LOW-VALUES             TO EL130AI.
  8053     MOVE 'MSTR'                 TO FILE-SWITCH.
  8054     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8055     MOVE PI-CARRIER             TO MSTR-CARRIER.
  8056     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  8057                                    CLMNOO.
  8058     MOVE AL-UANON               TO CLMNOA.
  8059     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  8060
  8061
  8062
  8063* EXEC CICS HANDLE CONDITION
  8064*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8065*    END-EXEC.
  8066*    MOVE '"$I                   ! & #00007835' TO DFHEIV0
  8067     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8068     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8069     MOVE X'2620233030303037383335' TO DFHEIV0(25:11)
  8070     CALL 'kxdfhei1' USING DFHEIV0
  8071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8072
  8073
  8074     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8075     MOVE 'X'                    TO CLAIM-SWITCH.
  8076     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8077     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8078     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8079     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8080     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8081     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8082
  8083     MOVE ER-0213                TO EMI-ERROR.
  8084     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8085     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  8086     GO TO 8100-SEND-INITIAL-MAP.
  8087
  8088 0645-NO-CLAIM-SELECTED.
  8089
  8090     IF MAINTI = 'S' OR 'I'
  8091        GO TO 1000-SHOW-CLAIM
  8092     END-IF.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 153
* EL130.cbl
  8093
  8094     GO TO 8100-SEND-INITIAL-MAP.
  8095
  8096 0650-FROM-EL127.
  8097
  8098     IF PI-CERT-SELECT-CNT GREATER THAN +6
  8099         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  8100                                    PI-CERT-PROCESSED
  8101     END-IF.
  8102
  8103     IF PI-RETURN-TO-PROGRAM = XCTL-727
  8104         MOVE +1                 TO PI-CERT-SELECT-CNT
  8105                                    PI-CERT-PROCESSED
  8106         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  8107         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  8108         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  8109         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  8110         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  8111         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  8112     END-IF.
  8113
  8114     IF PI-CERT-SELECT-CNT = ZERO
  8115         IF CERTNOI NOT = SPACES AND LOW-VALUES
  8116             MOVE CERTNOI        TO PI-CERT-NO
  8117             MOVE SUFXI          TO PI-CERT-SFX
  8118             GO TO 3000-READ-CERT
  8119         ELSE
  8120             GO TO 8100-SEND-INITIAL-MAP
  8121         END-IF
  8122     END-IF.
  8123
  8124     MOVE AL-SABON               TO PF5A.
  8125
  8126     IF PI-CERT-PROCESSED = 1
  8127         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  8128     END-IF.
  8129
  8130     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  8131     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  8132
  8133     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  8134     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  8135                                 TO CERT-CARRIER
  8136                                    PI-CARRIER.
  8137     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  8138                                 TO CERT-GROUPING
  8139                                    PI-GROUPING.
  8140     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  8141                                 TO CERT-STATE
  8142                                    PI-STATE.
  8143     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  8144                                 TO CERT-ACCOUNT
  8145                                    PI-ACCOUNT.
  8146     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  8147                                 TO CERT-EFF-DT
  8148                                    PI-CERT-EFF-DT.
  8149     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  8150                                 TO CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 154
* EL130.cbl
  8151                                    PI-CERT-NO.
  8152
  8153     MOVE 'CERT'                 TO FILE-SWITCH.
  8154     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8155
  8156     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  8157     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  8158     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  8159
  8160     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8161         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  8162         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  8163         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8164         IF INCURRED-DATE-MATCH
  8165             MOVE ER-7352        TO EMI-ERROR
  8166             MOVE -1             TO CERTNOL
  8167             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8168         ELSE
  8169             IF NO-CLAIMS-FOR-CERT
  8170                 MOVE ER-7353    TO EMI-ERROR
  8171                 MOVE -1         TO CERTNOL
  8172                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8173             ELSE
  8174                 MOVE ER-0558    TO EMI-ERROR
  8175                 MOVE -1         TO CERTNOL
  8176                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8177             END-IF
  8178         END-IF
  8179     END-IF.
  8180
  8181     MOVE SPACES                 TO PI-PRT-OPT
  8182                                    PI-ALT-PRT.
  8183
  8184     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8185
  8186     if (ws-lf-joint-indicator not = 'J')
  8187        and (ws-ah-joint-indicator not = 'J')
  8188        move 'P'                 to INSTYPEO
  8189        MOVE AL-UANON            TO INSTYPEA
  8190     end-if
  8191     IF LSTNMEL NOT GREATER ZERO
  8192        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  8193         MOVE CRTLNMEI           TO  LSTNMEO
  8194         MOVE CRTFNMEI           TO  FSTNMEO
  8195         MOVE CRTINITI           TO  INITO
  8196         MOVE AL-UANON           TO  LSTNMEA
  8197                                     FSTNMEA
  8198                                     INITA
  8199     END-IF.
  8200
  8201     IF SSNL GREATER ZERO
  8202         GO TO 0655-SKIP-SOCIAL-SECURITY
  8203     END-IF.
  8204
  8205     IF CRTSSNI = SPACES OR LOW-VALUES
  8206         GO TO 0655-SKIP-SOCIAL-SECURITY
  8207     END-IF.
  8208
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 155
* EL130.cbl
  8209     IF CM-SSN-STATE   = CM-STATE AND
  8210        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  8211            GO TO 0655-SKIP-SOCIAL-SECURITY
  8212     END-IF.
  8213
  8214     MOVE CRTSSNI                TO SSNO
  8215     MOVE AL-UANON               TO SSNA.
  8216
  8217 0655-SKIP-SOCIAL-SECURITY.
  8218
  8219     IF CLMCARRL NOT = ZERO  AND
  8220        CLMCARRI NOT = CRTCARRI
  8221        MOVE ER-0562             TO EMI-ERROR
  8222        MOVE AL-UABON            TO CLMCARRA
  8223        MOVE -1                  TO CLMCARRL
  8224        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8225     END-IF.
  8226
  8227     IF CLMCARRL = ZERO
  8228        MOVE AL-UANON            TO CLMCARRA
  8229        MOVE CRTCARRI            TO CLMCARRI
  8230     END-IF.
  8231
  8232     MOVE 'A'                    TO MAINTO.
  8233     MOVE AL-UANON               TO MAINTA.
  8234
  8235     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  8236        GO TO 8100-SEND-INITIAL-MAP
  8237     ELSE
  8238        GO TO 8150-SEND-MAP-CURSOR
  8239     END-IF.
  8240
  8241 0660-NOT-FOUND.
  8242     MOVE ER-0214                TO EMI-ERROR.
  8243     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8244     GO TO 8100-SEND-INITIAL-MAP.
  8245
  8246 0670-QIDERR.
  8247     MOVE ER-0033                TO EMI-ERROR.
  8248     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8249     GO TO 8100-SEND-INITIAL-MAP.
  8250
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 156
* EL130.cbl
  8252 0680-PLUG-SELECTED-CERTS.
  8253
  8254     MOVE AL-SANON               TO BCERT1A
  8255                                    BSUFX1A
  8256                                    BCERT2A
  8257                                    BSUFX2A
  8258                                    BCERT3A
  8259                                    BSUFX3A
  8260                                    BCERT4A
  8261                                    BSUFX4A
  8262                                    BCERT5A
  8263                                    BSUFX5A.
  8264
  8265     IF PCERTNOO = SPACES OR LOW-VALUES
  8266         MOVE PI-EL127-CERT-PRIME (1)
  8267                                 TO PCERTNOO
  8268         MOVE PI-EL127-CERT-SUFX  (1)
  8269                                 TO PSUFXO
  8270     END-IF.
  8271
  8272     MOVE PI-EL127-CERT-PRIME (1)
  8273                                 TO BCERT1O.
  8274     MOVE PI-EL127-CERT-SUFX  (1)
  8275                                 TO BSUFX1O.
  8276
  8277     IF PI-CERT-SELECT-CNT GREATER THAN 1
  8278         MOVE PI-EL127-CERT-PRIME (2)
  8279                                 TO BCERT2O
  8280         MOVE PI-EL127-CERT-SUFX  (2)
  8281                                 TO BSUFX2O
  8282     ELSE
  8283         MOVE LOW-VALUES         TO BCERT2O
  8284                                    BSUFX2O
  8285     END-IF.
  8286
  8287     IF PI-CERT-SELECT-CNT GREATER THAN 2
  8288         MOVE PI-EL127-CERT-PRIME (3)
  8289                                 TO BCERT3O
  8290         MOVE PI-EL127-CERT-SUFX  (3)
  8291                                 TO BSUFX3O
  8292     ELSE
  8293         MOVE LOW-VALUES         TO BCERT3O
  8294                                    BSUFX3O
  8295     END-IF.
  8296
  8297     IF PI-CERT-SELECT-CNT GREATER THAN 3
  8298         MOVE PI-EL127-CERT-PRIME (4)
  8299                                 TO BCERT4O
  8300         MOVE PI-EL127-CERT-SUFX  (4)
  8301                                 TO BSUFX4O
  8302     ELSE
  8303         MOVE LOW-VALUES         TO BCERT4O
  8304                                    BSUFX4O
  8305     END-IF.
  8306
  8307     IF PI-CERT-SELECT-CNT GREATER THAN 4
  8308         MOVE PI-EL127-CERT-PRIME (5)
  8309                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 157
* EL130.cbl
  8310         MOVE PI-EL127-CERT-SUFX  (5)
  8311                                 TO BSUFX5O
  8312     ELSE
  8313         MOVE LOW-VALUES         TO BCERT5O
  8314                                    BSUFX5O
  8315     END-IF.
  8316
  8317 0680-EXIT.
  8318     EXIT.
  8319
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 158
* EL130.cbl
  8321 0690-HIGHLIGHT-CERTS.
  8322
  8323     MOVE AL-UANON               TO PCERTNOA
  8324                                    PSUFXA.
  8325
  8326     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8327        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8328            MOVE AL-SABON        TO BCERT1A
  8329                                    BSUFX1A
  8330     ELSE
  8331         MOVE AL-SANON           TO BCERT1A
  8332                                    BSUFX1A
  8333     END-IF.
  8334
  8335     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8336        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8337            MOVE AL-SABON        TO BCERT2A
  8338                                    BSUFX2A
  8339     ELSE
  8340         MOVE AL-SANON           TO BCERT2A
  8341                                    BSUFX2A
  8342     END-IF.
  8343
  8344     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8345        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8346            MOVE AL-SABON        TO BCERT3A
  8347                                    BSUFX3A
  8348     ELSE
  8349         MOVE AL-SANON           TO BCERT3A
  8350                                    BSUFX3A
  8351     END-IF.
  8352
  8353     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8354        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8355            MOVE AL-SABON        TO BCERT4A
  8356                                    BSUFX4A
  8357     ELSE
  8358         MOVE AL-SANON           TO BCERT4A
  8359                                    BSUFX4A
  8360     END-IF.
  8361
  8362     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8363        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8364            MOVE AL-SABON        TO BCERT5A
  8365                                    BSUFX5A
  8366     ELSE
  8367         MOVE AL-SANON           TO BCERT5A
  8368                                    BSUFX5A
  8369     END-IF.
  8370
  8371 0690-EXIT.
  8372     EXIT.
  8373
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 159
* EL130.cbl
  8375 0800-TEST-PREVIOUS-CONTROL.
  8376     IF CLMNOI   = PI-LAST-CLAIM       AND
  8377        CLMCARRI = PI-LAST-CARR        AND
  8378        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8379        SUFXI    = PI-LAST-CERT-SUFX
  8380*        NEXT SENTENCE
  8381         CONTINUE
  8382     ELSE
  8383         MOVE ER-0207            TO EMI-ERROR
  8384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8385         MOVE -1                 TO MAINTL
  8386         GO TO 8200-SEND-DATAONLY
  8387     END-IF.
  8388
  8389     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8390
  8391     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8392     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8393     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8394
  8395     IF EIBAID = DFHPF7
  8396         MOVE XCTL-157           TO PGM-NAME
  8397     END-IF.
  8398
  8399     IF EIBAID = DFHPF8
  8400         MOVE XCTL-141           TO PGM-NAME
  8401     END-IF.
  8402
  8403     IF EIBAID = DFHPF9
  8404        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8405                                    PI-SAVED-PROGRAM-2
  8406                                    PI-SAVED-PROGRAM-3
  8407                                    PI-SAVED-PROGRAM-4
  8408                                    PI-SAVED-PROGRAM-5
  8409                                    PI-SAVED-PROGRAM-6
  8410        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8411        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8412        MOVE XCTL-150            TO PGM-NAME
  8413     END-IF.
  8414
  8415     GO TO 9300-XCTL.
  8416
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 160
* EL130.cbl
  8418 1000-SHOW-CLAIM.
  8419
  8420     IF CLMNOL = ZERO
  8421         MOVE -1                 TO CLMNOL
  8422         MOVE AL-UABON           TO CLMNOA
  8423         MOVE ER-0202            TO EMI-ERROR
  8424         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8425     ELSE
  8426         MOVE AL-UANON           TO CLMNOA
  8427     END-IF.
  8428
  8429     IF PI-NO-CARRIER-SECURITY
  8430        IF CLMCARRL = ZERO
  8431             MOVE -1             TO CLMCARRL
  8432             MOVE AL-UABON       TO CLMCARRA
  8433             MOVE ER-0194        TO EMI-ERROR
  8434             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8435         ELSE
  8436             MOVE AL-UANON       TO CLMCARRA
  8437         END-IF
  8438     END-IF.
  8439
  8440     IF SUFXL = ZERO
  8441         MOVE SPACES             TO SUFXI
  8442         MOVE AL-UANON           TO SUFXA
  8443     ELSE
  8444         MOVE AL-UANON           TO SUFXA
  8445     END-IF.
  8446
  8447     IF NOT EMI-NO-ERRORS
  8448         GO TO 1050-SEND-CHECK
  8449     END-IF.
  8450
  8451
  8452
  8453* EXEC CICS HANDLE CONDITION
  8454*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8455*    END-EXEC.
  8456*    MOVE '"$I                   ! '' #00008217' TO DFHEIV0
  8457     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8458     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8459     MOVE X'2720233030303038323137' TO DFHEIV0(25:11)
  8460     CALL 'kxdfhei1' USING DFHEIV0
  8461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8462
  8463
  8464     MOVE 'MSTR'                 TO FILE-SWITCH
  8465     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8466
  8467     MOVE CLMCARRI               TO MSTR-CARRIER.
  8468     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8469
  8470     IF CERTNOL = ZERO     OR
  8471        CERTNOI = SPACES   OR
  8472        CERTNOI = LOW-VALUES
  8473         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8474         MOVE AL-SANON        TO CERTNOA
  8475                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 161
* EL130.cbl
  8476     ELSE
  8477         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8478     END-IF.
  8479
  8480     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8481     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8482
  8483
  8484
  8485* EXEC CICS HANDLE CONDITION
  8486*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8487*    END-EXEC.
  8488*    MOVE '"$I                   ! ( #00008241' TO DFHEIV0
  8489     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8490     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8491     MOVE X'2820233030303038323431' TO DFHEIV0(25:11)
  8492     CALL 'kxdfhei1' USING DFHEIV0
  8493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8494
  8495
  8496     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8497
  8498     IF NOT PI-NO-ACCOUNT-SECURITY
  8499         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8500           MOVE ER-2371          TO EMI-ERROR
  8501           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8502           MOVE -1               TO MAINTL
  8503           GO TO 8200-SEND-DATAONLY
  8504         END-IF
  8505     END-IF.
  8506
  8507
  8508
  8509* EXEC CICS HANDLE CONDITION
  8510*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8511*    END-EXEC.
  8512*    MOVE '"$I                   ! ) #00008257' TO DFHEIV0
  8513     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8514     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8515     MOVE X'2920233030303038323537' TO DFHEIV0(25:11)
  8516     CALL 'kxdfhei1' USING DFHEIV0
  8517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8518
  8519
  8520     MOVE 'Y'                    TO CLAIM-SWITCH.
  8521     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8522     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8523     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8524     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8525     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8526
  8527 1000-SHOW-END-OF-PERFORM.
  8528
  8529     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8530     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8531     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8532     MOVE CL-CERT-STATE          TO CERT-STATE.
  8533     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 162
* EL130.cbl
  8534     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8535     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8536
  8537     MOVE 'CERT'                 TO FILE-SWITCH.
  8538
  8539     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8540
  8541     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8542     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8543     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8544     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8545     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8546     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8547     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8548     MOVE CLMCARRI               TO PI-LAST-CARR.
  8549
  8550     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8551
  8552     IF MAINTI = 'I'
  8553         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8554                 BIRTHDTA  LSTNMEA   RELCLMA
  8555                 LOANNOA   LOANBALA  BENECDA
  8556         MOVE AL-SANON TO  SSNA
  8557         MOVE SPACES   TO  INCURI    REPORTI
  8558         MOVE 'Y'      TO PI-INCURR-SW
  8559         MOVE ER-0522  TO EMI-ERROR
  8560         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8561     ELSE
  8562         MOVE ' '      TO PI-INCURR-SW
  8563     END-IF.
  8564
  8565     MOVE -1                     TO MAINTL.
  8566     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8567     MOVE CERT-GROUPING          TO PI-GROUPING.
  8568     MOVE CERT-STATE             TO PI-STATE.
  8569     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8570     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8571     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8572     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8573
  8574     IF RETURNED-FROM NOT = SPACES
  8575         GO TO 8100-SEND-INITIAL-MAP
  8576     ELSE
  8577         GO TO 8200-SEND-DATAONLY
  8578     END-IF.
  8579
  8580 1025-SHOW-RECORD-NOT-FOUND.
  8581
  8582     IF FILE-SWITCH = 'MSTR'
  8583         MOVE ER-0204            TO EMI-ERROR
  8584     ELSE
  8585         IF FILE-SWITCH = 'TRLR'
  8586             MOVE ER-0205        TO EMI-ERROR
  8587         ELSE
  8588             MOVE ER-0206        TO EMI-ERROR
  8589         END-IF
  8590     END-IF.
  8591
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 163
* EL130.cbl
  8592     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8593
  8594 1050-SEND-CHECK.
  8595
  8596     IF RETURNED-FROM NOT = SPACES
  8597         GO TO 8100-SEND-INITIAL-MAP
  8598     ELSE
  8599         MOVE -1                 TO MAINTL
  8600         GO TO 8200-SEND-DATAONLY
  8601     END-IF.
  8602
  8603 2000-DELETE-CLAIM.
  8604     IF NOT MODIFY-CAP
  8605         MOVE ER-0070            TO EMI-ERROR
  8606         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8607         MOVE -1                 TO MAINTL
  8608         GO TO 8200-SEND-DATAONLY
  8609     END-IF.
  8610
  8611     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8612        CLMCARRI NOT = PI-LAST-CARR        OR
  8613        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8614        SUFXI    NOT = PI-LAST-CERT-SUFX
  8615         MOVE ER-0207            TO EMI-ERROR
  8616         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8617         MOVE -1                 TO MAINTL
  8618         GO TO 8200-SEND-DATAONLY
  8619     END-IF.
  8620
  8621
  8622
  8623* EXEC CICS HANDLE CONDITION
  8624*        NOTFND   (2050-DELETE-NOT-FOUND)
  8625*    END-EXEC.
  8626*    MOVE '"$I                   ! * #00008363' TO DFHEIV0
  8627     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8628     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8629     MOVE X'2A20233030303038333633' TO DFHEIV0(25:11)
  8630     CALL 'kxdfhei1' USING DFHEIV0
  8631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8632
  8633
  8634     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8635
  8636     MOVE CLMCARRI               TO MSTR-CARRIER.
  8637     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8638     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8639     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8640
  8641     MOVE 'MSTR'                 TO FILE-SWITCH.
  8642     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8643
  8644     MOVE 'Y'                    TO CLAIM-SWITCH.
  8645
  8646     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8647        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8648         MOVE ER-0068        TO EMI-ERROR
  8649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 164
* EL130.cbl
  8650         MOVE -1             TO MAINTL
  8651         GO TO 8200-SEND-DATAONLY
  8652     END-IF.
  8653
  8654     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8655         MOVE ER-0569            TO EMI-ERROR
  8656         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8657         MOVE -1                 TO MAINTL
  8658         GO TO 8200-SEND-DATAONLY
  8659     END-IF.
  8660
  8661     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8662         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8663     END-IF.
  8664
  8665     IF CL-PURGED-DT NOT = LOW-VALUES
  8666         MOVE ER-7691            TO EMI-ERROR
  8667         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8668         MOVE -1                 TO MAINTL
  8669         GO TO 8200-SEND-DATAONLY
  8670     END-IF.
  8671
  8672     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8673     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8674     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8675     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8676     MOVE +0                     TO TRLR-SEQ-NO.
  8677     MOVE '1'                    TO TRLR-TYPE.
  8678
  8679     MOVE 'TRLR'                 TO FILE-SWITCH.
  8680
  8681
  8682
  8683* EXEC CICS READ
  8684*        UPDATE
  8685*        DATASET  (ELTRLR-DSID)
  8686*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8687*        RIDFLD   (ELTRLR-KEY)
  8688*    END-EXEC.
  8689*    MOVE '&"S        EU         (   #00008415' TO DFHEIV0
  8690     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8691     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8692     MOVE X'2020233030303038343135' TO DFHEIV0(25:11)
  8693     CALL 'kxdfhei1' USING DFHEIV0,
  8694           ELTRLR-DSID,
  8695           DFHEIV20,
  8696           DFHEIV99,
  8697           ELTRLR-KEY,
  8698           DFHEIV99,
  8699           DFHEIV99,
  8700           DFHEIV99
  8701     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8702         DFHEIV20
  8703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8704
  8705
  8706     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8707        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 165
* EL130.cbl
  8708         MOVE ER-0068        TO EMI-ERROR
  8709         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8710         MOVE -1             TO MAINTL
  8711         GO TO 8200-SEND-DATAONLY
  8712     END-IF.
  8713
  8714
  8715
  8716* EXEC CICS DELETE
  8717*        DATASET   (ELTRLR-DSID)
  8718*    END-EXEC.
  8719*    MOVE '&(                    &   #00008431' TO DFHEIV0
  8720     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8721     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8722     MOVE X'2020233030303038343331' TO DFHEIV0(25:11)
  8723     CALL 'kxdfhei1' USING DFHEIV0,
  8724           ELTRLR-DSID,
  8725           DFHEIV99,
  8726           DFHEIV99,
  8727           DFHEIV99,
  8728           DFHEIV99
  8729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8730
  8731
  8732     MOVE +90                    TO TRLR-SEQ-NO.
  8733     MOVE '6'                    TO TRLR-TYPE.
  8734
  8735
  8736
  8737* EXEC CICS READ
  8738*        UPDATE
  8739*        DATASET  (ELTRLR-DSID)
  8740*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8741*        RIDFLD   (ELTRLR-KEY)
  8742*    END-EXEC.
  8743*    MOVE '&"S        EU         (   #00008439' TO DFHEIV0
  8744     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8745     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8746     MOVE X'2020233030303038343339' TO DFHEIV0(25:11)
  8747     CALL 'kxdfhei1' USING DFHEIV0,
  8748           ELTRLR-DSID,
  8749           DFHEIV20,
  8750           DFHEIV99,
  8751           ELTRLR-KEY,
  8752           DFHEIV99,
  8753           DFHEIV99,
  8754           DFHEIV99
  8755     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8756         DFHEIV20
  8757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8758
  8759
  8760
  8761
  8762* EXEC CICS DELETE
  8763*        DATASET   (ELTRLR-DSID)
  8764*    END-EXEC.
  8765*    MOVE '&(                    &   #00008447' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 166
* EL130.cbl
  8766     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8767     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8768     MOVE X'2020233030303038343437' TO DFHEIV0(25:11)
  8769     CALL 'kxdfhei1' USING DFHEIV0,
  8770           ELTRLR-DSID,
  8771           DFHEIV99,
  8772           DFHEIV99,
  8773           DFHEIV99,
  8774           DFHEIV99
  8775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8776
  8777
  8778     MOVE +91                    TO TRLR-SEQ-NO.
  8779     MOVE '6'                    TO TRLR-TYPE.
  8780
  8781
  8782
  8783* EXEC CICS READ
  8784*        UPDATE
  8785*        DATASET  (ELTRLR-DSID)
  8786*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8787*        RIDFLD   (ELTRLR-KEY)
  8788*        RESP     (WS-RESPONSE)
  8789*    END-EXEC
  8790*    MOVE '&"S        EU         (  N#00008455' TO DFHEIV0
  8791     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8792     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8793     MOVE X'204E233030303038343535' TO DFHEIV0(25:11)
  8794     CALL 'kxdfhei1' USING DFHEIV0,
  8795           ELTRLR-DSID,
  8796           DFHEIV20,
  8797           DFHEIV99,
  8798           ELTRLR-KEY,
  8799           DFHEIV99,
  8800           DFHEIV99,
  8801           DFHEIV99
  8802     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8803         DFHEIV20
  8804     MOVE EIBRESP  TO WS-RESPONSE
  8805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8806
  8807     IF WS-RESP-NORMAL
  8808
  8809* EXEC CICS DELETE
  8810*          DATASET   (ELTRLR-DSID)
  8811*       END-EXEC
  8812*    MOVE '&(                    &   #00008464' TO DFHEIV0
  8813     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8814     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8815     MOVE X'2020233030303038343634' TO DFHEIV0(25:11)
  8816     CALL 'kxdfhei1' USING DFHEIV0,
  8817           ELTRLR-DSID,
  8818           DFHEIV99,
  8819           DFHEIV99,
  8820           DFHEIV99,
  8821           DFHEIV99
  8822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8823     END-IF.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 167
* EL130.cbl
  8824
  8825     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8826     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8827     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8828     MOVE CL-CERT-STATE          TO CERT-STATE.
  8829     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8830     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8831     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8832
  8833     MOVE 'CERT'                 TO FILE-SWITCH.
  8834
  8835     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8836
  8837     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8838
  8839     IF WS-NUM-HOLD NOT = +0
  8840         GO TO 2005-REWRITE-CERT
  8841     END-IF.
  8842
  8843     IF NOT CERT-WAS-CREATED
  8844         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8845         GO TO 2005-REWRITE-CERT
  8846     END-IF.
  8847
  8848
  8849
  8850* EXEC CICS DELETE
  8851*        DATASET   (ELCERT-DSID)
  8852*    END-EXEC.
  8853*    MOVE '&(                    &   #00008493' TO DFHEIV0
  8854     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8855     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8856     MOVE X'2020233030303038343933' TO DFHEIV0(25:11)
  8857     CALL 'kxdfhei1' USING DFHEIV0,
  8858           ELCERT-DSID,
  8859           DFHEIV99,
  8860           DFHEIV99,
  8861           DFHEIV99,
  8862           DFHEIV99
  8863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8864
  8865
  8866     GO TO 2010-DELETE-CL.
  8867
  8868 2005-REWRITE-CERT.
  8869
  8870     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8871
  8872
  8873
  8874* EXEC CICS HANDLE CONDITION
  8875*         DUPKEY   (2010-DELETE-CL)
  8876*    END-EXEC.
  8877*    MOVE '"$$                   ! + #00008504' TO DFHEIV0
  8878     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8879     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8880     MOVE X'2B20233030303038353034' TO DFHEIV0(25:11)
  8881     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 168
* EL130.cbl
  8882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8883
  8884
  8885
  8886
  8887* EXEC CICS REWRITE
  8888*        DATASET  (ELCERT-DSID)
  8889*        FROM     (CERTIFICATE-MASTER)
  8890*    END-EXEC.
  8891     MOVE LENGTH OF
  8892      CERTIFICATE-MASTER
  8893       TO DFHEIV11
  8894*    MOVE '&& L                  %   #00008509' TO DFHEIV0
  8895     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8896     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8897     MOVE X'2020233030303038353039' TO DFHEIV0(25:11)
  8898     CALL 'kxdfhei1' USING DFHEIV0,
  8899           ELCERT-DSID,
  8900           CERTIFICATE-MASTER,
  8901           DFHEIV11,
  8902           DFHEIV99
  8903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8904
  8905
  8906 2010-DELETE-CL.
  8907
  8908
  8909
  8910* EXEC CICS DELETE
  8911*        DATASET  (ELMSTR-DSID)
  8912*    END-EXEC.
  8913*    MOVE '&(                    &   #00008517' TO DFHEIV0
  8914     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8915     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8916     MOVE X'2020233030303038353137' TO DFHEIV0(25:11)
  8917     CALL 'kxdfhei1' USING DFHEIV0,
  8918           ELMSTR-DSID,
  8919           DFHEIV99,
  8920           DFHEIV99,
  8921           DFHEIV99,
  8922           DFHEIV99
  8923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8924
  8925
  8926     MOVE -1                     TO ONE-OR-MIN1.
  8927     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8928
  8929     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8930         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8931                                    WS-SAVE-CLAIM-KEY
  8932         MOVE +1                 TO ONE-OR-MIN1
  8933         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8934     END-IF.
  8935
  8936     MOVE ER-0000                TO EMI-ERROR.
  8937     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8938     MOVE LOW-VALUES             TO EL130AO.
  8939     MOVE -1                     TO MAINTL.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 169
* EL130.cbl
  8940     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8941     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
  8942                                    PI-CERT-PROCESSED
  8943                                    PI-LETTER-ERROR-CODE.
  8944     GO TO 8100-SEND-INITIAL-MAP.
  8945
  8946 2050-DELETE-NOT-FOUND.
  8947     IF FILE-SWITCH = 'MSTR'
  8948         MOVE -1                 TO CLMNOL
  8949         MOVE ER-0204            TO EMI-ERROR
  8950     ELSE
  8951         IF FILE-SWITCH = 'TRLR'
  8952             MOVE -1             TO MAINTL
  8953             MOVE ER-0205        TO EMI-ERROR
  8954         ELSE
  8955             MOVE -1             TO CERTNOL
  8956             MOVE ER-0206        TO EMI-ERROR
  8957         END-IF
  8958     END-IF.
  8959
  8960     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8961     GO TO 8200-SEND-DATAONLY.
  8962
  8963 3000-ADD-CLAIM.
  8964     IF NOT MODIFY-CAP
  8965         MOVE ER-0070            TO EMI-ERROR
  8966         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8967         MOVE -1                 TO MAINTL
  8968         GO TO 8200-SEND-DATAONLY
  8969     END-IF.
  8970
  8971     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8972
  8973     IF CERTMTI = 'S'
  8974         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8975            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8976            WS-EFFDT = PI-SAVE-EFFDT       AND
  8977            ACCOUNTI = PI-SAVE-ACCOUNT
  8978             IF EMI-ERROR = 0
  8979                 GO TO 3010-TEST-FOR-ERRORS
  8980             ELSE
  8981                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8982                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8983                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8984                 MOVE PI-STATE         TO  CERT-STATE
  8985                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8986                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8987                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8988
  8989
  8990* EXEC CICS HANDLE CONDITION
  8991*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8992*                END-EXEC
  8993*    MOVE '"$I                   ! , #00008584' TO DFHEIV0
  8994     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8995     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8996     MOVE X'2C20233030303038353834' TO DFHEIV0(25:11)
  8997     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 170
* EL130.cbl
  8998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8999                 PERFORM 7940-READ-CERT THRU 7940-EXIT
  9000                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  9001                 GO TO 3010-TEST-FOR-ERRORS
  9002             END-IF
  9003         END-IF
  9004     END-IF.
  9005
  9006     IF CERTMTI = 'A'
  9007         IF NOT PI-NO-CARRIER-SECURITY OR
  9008             NOT PI-NO-ACCOUNT-SECURITY
  9009             MOVE ER-2370          TO EMI-ERROR
  9010             MOVE -1               TO MAINTL
  9011             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9012             GO TO 8200-SEND-DATAONLY
  9013         ELSE
  9014             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  9015             GO TO 3010-TEST-FOR-ERRORS
  9016         END-IF
  9017     END-IF.
  9018
  9019     IF CERTNOL = ZEROS
  9020        GO TO 3010-TEST-FOR-ERRORS
  9021     END-IF.
  9022
  9023 3000-READ-CERT.
  9024
  9025     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  9026                                    MSTR5-COMP-CD.
  9027     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  9028                                    MSTR5-CERT-NO-PRIME.
  9029     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  9030                                    MSTR5-CERT-NO-SUFX.
  9031
  9032
  9033
  9034* EXEC CICS HANDLE CONDITION
  9035*         DUPKEY   (3008-DUP-ERROR)
  9036*         NOTFND   (3009-NOT-FOUND)
  9037*    END-EXEC
  9038*    MOVE '"$$I                  ! - #00008621' TO DFHEIV0
  9039     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  9040     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9041     MOVE X'2D20233030303038363231' TO DFHEIV0(25:11)
  9042     CALL 'kxdfhei1' USING DFHEIV0
  9043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9044
  9045     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  9046
  9047     IF NOT PI-NO-ACCOUNT-SECURITY
  9048         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  9049             MOVE ER-2371          TO EMI-ERROR
  9050             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9051             MOVE -1               TO MAINTL
  9052             GO TO 8200-SEND-DATAONLY
  9053         END-IF
  9054     END-IF.
  9055
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 171
* EL130.cbl
  9056     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  9057     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
  9058     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  9059     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  9060     MOVE CM-CARRIER             TO PI-CARRIER.
  9061     MOVE CM-GROUPING            TO PI-GROUPING.
  9062     MOVE CM-STATE               TO PI-STATE.
  9063     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  9064     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  9065     MOVE CM-CERT-NO             TO PI-CERT-NO.
  9066     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  9067
  9068     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  9069         IF LSTNMEO = SPACES OR LOW-VALUES
  9070             MOVE CRTLNMEI       TO  LSTNMEO
  9071             MOVE AL-UANON       TO  LSTNMEA
  9072         END-IF
  9073     END-IF.
  9074
  9075     MOVE 'S'                    TO CERTMTO.
  9076*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  9077     MOVE AL-SANON               TO CERTNOA.
  9078     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  9079                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  9080     IF EMI-NO-ERRORS
  9081         MOVE -1                  TO MAINTL
  9082     END-IF.
  9083
  9084     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9085         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9086         IF INCURRED-DATE-MATCH
  9087             MOVE ER-7352         TO EMI-ERROR
  9088             MOVE -1              TO CERTNOL
  9089             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9090         ELSE
  9091             IF NO-CLAIMS-FOR-CERT
  9092                 MOVE ER-7353     TO EMI-ERROR
  9093                 MOVE -1          TO CERTNOL
  9094                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9095             ELSE
  9096                 MOVE ER-0558     TO EMI-ERROR
  9097                 MOVE -1          TO CERTNOL
  9098                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9099                 GO TO 3010-TEST-FOR-ERRORS
  9100             END-IF
  9101         END-IF
  9102     END-IF.
  9103
  9104 3007-SEND-SCREEN.
  9105     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9106         GO TO 8150-SEND-MAP-CURSOR
  9107     ELSE
  9108         GO TO 8200-SEND-DATAONLY
  9109     END-IF.
  9110
  9111 3008-DUP-ERROR.
  9112     MOVE ER-0560                TO EMI-ERROR.
  9113     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 172
* EL130.cbl
  9114     MOVE -1                     TO CERTNOL.
  9115     GO TO 3007-SEND-SCREEN.
  9116
  9117 3009-NOT-FOUND.
  9118     MOVE ER-0214                TO EMI-ERROR.
  9119     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9120     MOVE -1                     TO CERTNOL.
  9121     GO TO 3007-SEND-SCREEN.
  9122
  9123 3010-TEST-FOR-ERRORS.
  9124
  9125     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  9126     perform 6500-get-acct    thru 6500-exit
  9127     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  9128*     perform 6500-get-acct    thru 6500-exit
  9129
  9130     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
  9131     move +0                     to e1
  9132     move spaces                 to ws-dcc-error-line
  9133     move ' '                    to ws-zero-bens-avail
  9134
  9135     if ws-dcc-product-code not = spaces
  9136        PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
  9137        IF ERPDEF-FOUND
  9138           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  9139           MOVE WS-INCUR         TO DC-BIN-DATE-2
  9140           MOVE '1'              TO DC-OPTION-CODE
  9141           MOVE +0               TO DC-ELAPSED-MONTHS
  9142                                    DC-ELAPSED-DAYS
  9143           PERFORM 9700-LINK-DATE-CONVERT
  9144                                 THRU 9700-EXIT
  9145           IF NO-CONVERSION-ERROR
  9146              MOVE DC-ELAPSED-MONTHS
  9147                                 TO WS-MONTHS-BETWEEN
  9148              IF DC-ELAPSED-DAYS > 1
  9149                 ADD 1 TO WS-MONTHS-BETWEEN
  9150              END-IF
  9151           ELSE
  9152              MOVE ZEROS         TO WS-MONTHS-BETWEEN
  9153           END-IF
  9154
  9155           evaluate true
  9156              when (ws-excl-period not = zeros)
  9157                 and (ws-months-between <= ws-excl-period)
  9158                 MOVE -1         TO MAINTL
  9159                 add +1          to e1
  9160                 move 'Y'        to ws-zero-bens-avail
  9161                 MOVE ER-1651    TO EMI-ERROR
  9162                                    ws-error-no (e1)
  9163                 PERFORM 9900-ERROR-FORMAT
  9164                                 THRU 9900-EXIT
  9165              when (ws-cov-ends not = zeros)
  9166                 and (ws-months-between > ws-cov-ends)
  9167                 MOVE -1         TO MAINTL
  9168                 add +1          to e1
  9169                 move 'Y'        to ws-zero-bens-avail
  9170                 MOVE ER-1653    TO EMI-ERROR
  9171                                    ws-error-no (e1)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 173
* EL130.cbl
  9172                 evaluate true
  9173                    when clmtypei = 'L'
  9174                       move '  LF  ' to emi-claim-type
  9175                    when clmtypei = 'I'
  9176                       move '  IU  ' to emi-claim-type
  9177                    when clmtypei = 'F'
  9178                       move '  FL  ' to emi-claim-type
  9179                    when other
  9180                       move '  AH  ' to emi-claim-type
  9181                 end-evaluate
  9182                 PERFORM 9900-ERROR-FORMAT
  9183                                 THRU 9900-EXIT
  9184              when (ws-acc-period not = zeros)
  9185                 and (ws-months-between <= ws-acc-period)
  9186                 MOVE -1         TO MAINTL
  9187                 add +1          to e1
  9188                 MOVE ER-1652    TO EMI-ERROR
  9189                                    ws-error-no (e1)
  9190                 PERFORM 9900-ERROR-FORMAT
  9191                                 THRU 9900-EXIT
  9192                 add +1          to e1
  9193                 move er-1655    to emi-error
  9194                                    ws-error-no (e1)
  9195                 PERFORM 9900-ERROR-FORMAT
  9196                                 THRU 9900-EXIT
  9197              when clmtypei = 'I'
  9198                 add +1          to e1
  9199                 move er-1661    to emi-error
  9200                                    ws-error-no (e1)
  9201                 PERFORM 9900-ERROR-FORMAT
  9202                                 THRU 9900-EXIT
  9203           end-evaluate
  9204           IF (WS-PRE-EXISTING-PER NOT = ZEROS)
  9205              AND (WS-MONTHS-BETWEEN <= WS-PRE-EXISTING-PER)
  9206              MOVE -1         TO MAINTL
  9207              ADD +1          TO E1
  9208              MOVE ER-1677    TO EMI-ERROR
  9209                                 WS-ERROR-NO (E1)
  9210              PERFORM 9900-ERROR-FORMAT
  9211                              THRU 9900-EXIT
  9212           END-IF
  9213        END-IF
  9214*       perform 3996-read-cert-claim-trailer
  9215*                                thru 3996-exit
  9216     END-IF
  9217     perform 3996-read-cert-claim-trailer
  9218                                 thru 3996-exit
  9219     IF CERTMTI NOT = 'A'
  9220         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9221             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  9222             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  9223             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  9224             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9225             IF INCURRED-DATE-MATCH
  9226                 MOVE ER-7352         TO EMI-ERROR
  9227                 MOVE -1              TO CERTNOL
  9228                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9229             ELSE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 174
* EL130.cbl
  9230                 IF NO-CLAIMS-FOR-CERT
  9231                     MOVE ER-7353     TO EMI-ERROR
  9232                     MOVE -1          TO CERTNOL
  9233                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9234                 ELSE
  9235                     MOVE ER-0558     TO EMI-ERROR
  9236                     MOVE -1          TO CERTNOL
  9237                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9238                 END-IF
  9239             END-IF
  9240         END-IF
  9241     END-IF.
  9242
  9243     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  9244         MOVE ER-0433             TO EMI-ERROR
  9245         MOVE -1                  TO MAINTL
  9246         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9247         GO TO 8200-SEND-DATAONLY
  9248     END-IF.
  9249
  9250     IF (EMI-NO-ERRORS)
  9251        OR (ZEROS = EMI-FATAL-CTR AND EMI-FORCABLE-CTR)
  9252         GO TO 3015-TRY-TO-BUILD
  9253     END-IF.
  9254
  9255     IF EIBAID = DFHPF6
  9256         IF EMI-FATAL-CTR NOT EQUAL ZERO
  9257             MOVE ER-0434         TO EMI-ERROR
  9258             MOVE -1              TO MAINTL
  9259             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9260             GO TO 8200-SEND-DATAONLY
  9261         ELSE
  9262             MOVE +1              TO INCURL
  9263             GO TO 3015-TRY-TO-BUILD
  9264         END-IF
  9265     END-IF.
  9266
  9267     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9268         GO TO 8150-SEND-MAP-CURSOR
  9269     ELSE
  9270         GO TO 8200-SEND-DATAONLY
  9271     END-IF.
  9272
  9273 3015-TRY-TO-BUILD.
  9274     IF CLMNOL EQUAL ZERO
  9275         GO TO 3030-BUILD-CONT
  9276     END-IF.
  9277
  9278
  9279
  9280* EXEC CICS HANDLE CONDITION
  9281*        NOTFND   (3030-BUILD-CONT)
  9282*    END-EXEC.
  9283*    MOVE '"$I                   ! . #00008860' TO DFHEIV0
  9284     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9285     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9286     MOVE X'2E20233030303038383630' TO DFHEIV0(25:11)
  9287     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 175
* EL130.cbl
  9288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9289
  9290
  9291     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9292
  9293     MOVE CLMCARRI               TO MSTR-CARRIER.
  9294     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  9295     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9296     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9297
  9298     MOVE 'MSTR'                 TO FILE-SWITCH.
  9299
  9300     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9301
  9302     MOVE ER-0221                TO EMI-ERROR.
  9303
  9304     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9305     MOVE -1                     TO MAINTL.
  9306     GO TO 8200-SEND-DATAONLY.
  9307
  9308 3030-BUILD-CONT.
  9309     IF (CERTMTI NOT = 'A')
  9310        and (pi-company-id not = 'DCC' and 'VPP')
  9311         GO TO 3060-BUILD-CONT
  9312     END-IF.
  9313
  9314
  9315
  9316* EXEC CICS HANDLE CONDITION
  9317*        NOTFND   (3033-ACCT-NOT-FOUND)
  9318*        ENDFILE  (3033-ACCT-NOT-FOUND)
  9319*    END-EXEC.
  9320*    MOVE '"$I''                  ! / #00008888' TO DFHEIV0
  9321     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9322     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9323     MOVE X'2F20233030303038383838' TO DFHEIV0(25:11)
  9324     CALL 'kxdfhei1' USING DFHEIV0
  9325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9326
  9327
  9328     MOVE SPACES                 TO ERACCT-KEY.
  9329
  9330     IF CARR-GROUP-ST-ACCNT-CNTL
  9331         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  9332         MOVE CRTCARRI           TO ACCT-CARRIER
  9333         MOVE GROUPI             TO ACCT-GROUPING
  9334         MOVE STATEI             TO ACCT-STATE
  9335         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  9336         GO TO 3031-MOVE-ACCT-KEY
  9337     END-IF.
  9338
  9339     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9340     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  9341
  9342     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  9343         MOVE STATEI             TO ACCT-STATE
  9344     END-IF.
  9345
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 176
* EL130.cbl
  9346     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  9347         MOVE CRTCARRI           TO ACCT-CARRIER
  9348     END-IF.
  9349
  9350 3031-MOVE-ACCT-KEY.
  9351     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  9352
  9353
  9354
  9355* EXEC CICS STARTBR
  9356*        DATASET     (ERACCT2-DSID)
  9357*        RIDFLD      (SAVE-ERACCT-KEY)
  9358*        GENERIC
  9359*        KEYLENGTH   (20)
  9360*    END-EXEC.
  9361     MOVE 20
  9362       TO DFHEIV11
  9363     MOVE 0
  9364       TO DFHEIV12
  9365*    MOVE '&,   KG    G          &   #00008919' TO DFHEIV0
  9366     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  9367     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9368     MOVE X'2020233030303038393139' TO DFHEIV0(25:11)
  9369     CALL 'kxdfhei1' USING DFHEIV0,
  9370           ERACCT2-DSID,
  9371           SAVE-ERACCT-KEY,
  9372           DFHEIV11,
  9373           DFHEIV12,
  9374           DFHEIV99
  9375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9376
  9377
  9378
  9379
  9380* EXEC CICS HANDLE CONDITION
  9381*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  9382*    END-EXEC.
  9383*    MOVE '"$''                   ! 0 #00008927' TO DFHEIV0
  9384     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  9385     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9386     MOVE X'3020233030303038393237' TO DFHEIV0(25:11)
  9387     CALL 'kxdfhei1' USING DFHEIV0
  9388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9389
  9390
  9391 3031-READ-ACCT-LOOP.
  9392
  9393
  9394* EXEC CICS READNEXT
  9395*        DATASET   (ERACCT2-DSID)
  9396*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9397*        RIDFLD    (SAVE-ERACCT-KEY)
  9398*    END-EXEC.
  9399     MOVE 0
  9400       TO DFHEIV11
  9401*    MOVE '&.S                   )   #00008933' TO DFHEIV0
  9402     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9403     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 177
* EL130.cbl
  9404     MOVE X'2020233030303038393333' TO DFHEIV0(25:11)
  9405     CALL 'kxdfhei1' USING DFHEIV0,
  9406           ERACCT2-DSID,
  9407           DFHEIV20,
  9408           DFHEIV99,
  9409           SAVE-ERACCT-KEY,
  9410           DFHEIV99,
  9411           DFHEIV11,
  9412           DFHEIV99,
  9413           DFHEIV99
  9414     SET ADDRESS OF ACCOUNT-MASTER TO
  9415         DFHEIV20
  9416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9417
  9418
  9419     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  9420        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  9421        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  9422        ACCT-STATE    NOT = AM-VG-STATE       OR
  9423        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  9424         GO TO 3033-ACCT-NOT-FOUND
  9425     END-IF.
  9426
  9427     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  9428        WS-EFFDT LESS AM-EXPIRATION-DT
  9429         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  9430         MOVE AM-CARRIER       TO CERT-CARRIER
  9431         MOVE AM-GROUPING      TO CERT-GROUPING
  9432         MOVE AM-STATE         TO CERT-STATE
  9433         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  9434         MOVE WS-EFFDT         TO CERT-EFF-DT
  9435         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  9436         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  9437         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  9438         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  9439     END-IF.
  9440
  9441     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  9442         GO TO 3031-READ-ACCT-LOOP
  9443     END-IF.
  9444
  9445 3032-NOT-IN-DT-RANGE.
  9446     MOVE ER-0226                TO EMI-ERROR.
  9447     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9448     MOVE -1                     TO EFFDTL.
  9449     GO TO 8200-SEND-DATAONLY.
  9450
  9451 3033-ACCT-NOT-FOUND.
  9452     MOVE ER-0226 TO EMI-ERROR.
  9453     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9454     MOVE -1                     TO ACCOUNTL.
  9455     GO TO 8200-SEND-DATAONLY.
  9456
  9457 3034-CHECK-EMPLOYER-STATEMENT.
  9458
  9459     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9460*        NEXT SENTENCE
  9461         CONTINUE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 178
* EL130.cbl
  9462     ELSE
  9463         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9464     END-IF.
  9465
  9466     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9467     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9468     MOVE '1'                    TO  DC-OPTION-CODE.
  9469     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9470                                     DC-ELAPSED-DAYS.
  9471     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9472
  9473     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9474         DC-ELAPSED-DAYS LESS THAN +31)
  9475                      OR
  9476        (AM-EMPLOYER-STMT-USED = '2' AND
  9477         DC-ELAPSED-DAYS LESS THAN +61)
  9478                      OR
  9479        (AM-EMPLOYER-STMT-USED = '3' AND
  9480         DC-ELAPSED-DAYS LESS THAN +91)
  9481            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9482     END-IF.
  9483
  9484 3034-CHECK-ACCOUNT-LIMITS.
  9485
  9486     IF CERTMTI NOT = 'A'
  9487         GO TO 3060-BUILD-CONT
  9488     END-IF.
  9489
  9490     IF AM-STATUS NOT = '0'
  9491         MOVE ER-0225                TO EMI-ERROR
  9492         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9493         MOVE -1                     TO ACCOUNTL
  9494     END-IF.
  9495
  9496     IF EIBAID = DFHPF6
  9497         IF EMI-FATAL-CTR NOT = ZERO
  9498             MOVE ER-0434         TO EMI-ERROR
  9499             MOVE -1              TO MAINTL
  9500             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9501             GO TO 8200-SEND-DATAONLY
  9502         END-IF
  9503     END-IF.
  9504
  9505*    IF PI-COMPANY-ID NOT = 'CRI'
  9506*        GO TO 3035-END-BROWSE
  9507*    END-IF.
  9508
  9509 3035-END-BROWSE.
  9510
  9511
  9512* EXEC CICS ENDBR
  9513*        DATASET    (ERACCT2-DSID)
  9514*    END-EXEC.
  9515     MOVE 0
  9516       TO DFHEIV11
  9517*    MOVE '&2                    $   #00009031' TO DFHEIV0
  9518     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9519     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 179
* EL130.cbl
  9520     MOVE X'2020233030303039303331' TO DFHEIV0(25:11)
  9521     CALL 'kxdfhei1' USING DFHEIV0,
  9522           ERACCT2-DSID,
  9523           DFHEIV11,
  9524           DFHEIV99
  9525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9526
  9527
  9528 3040-CHECK-CERT-ALREADY-ON.
  9529
  9530
  9531* EXEC CICS HANDLE CONDITION
  9532*        NOTFND   (3070-BUILD-CONT)
  9533*    END-EXEC.
  9534*    MOVE '"$I                   ! 1 #00009037' TO DFHEIV0
  9535     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9537     MOVE X'3120233030303039303337' TO DFHEIV0(25:11)
  9538     CALL 'kxdfhei1' USING DFHEIV0
  9539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9540
  9541
  9542     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9543
  9544     MOVE ER-0229                TO EMI-ERROR.
  9545     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9546     MOVE -1                     TO MAINTL.
  9547     GO TO 8200-SEND-DATAONLY.
  9548
  9549 3060-BUILD-CONT.
  9550     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9551     MOVE CRTCARRI               TO CERT-CARRIER.
  9552     MOVE GROUPI                 TO CERT-GROUPING.
  9553     MOVE STATEI                 TO CERT-STATE.
  9554     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9555     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9556     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
  9557     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9558
  9559
  9560
  9561* EXEC CICS HANDLE CONDITION
  9562*        NOTFND  (3065-CERT-NOT-FOUND)
  9563*    END-EXEC.
  9564*    MOVE '"$I                   ! 2 #00009059' TO DFHEIV0
  9565     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9566     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9567     MOVE X'3220233030303039303539' TO DFHEIV0(25:11)
  9568     CALL 'kxdfhei1' USING DFHEIV0
  9569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9570
  9571
  9572     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9573
  9574     GO TO 3070-BUILD-CONT.
  9575
  9576 3065-CERT-NOT-FOUND.
  9577     MOVE ER-0244                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 180
* EL130.cbl
  9578     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9579     MOVE -1                     TO CERTNOL.
  9580     GO TO 8200-SEND-DATAONLY.
  9581
  9582 3070-BUILD-CONT.
  9583     IF CLMNOL NOT = ZERO
  9584         GO TO 3200-BUILD-ZERO-TRAILER
  9585     END-IF.
  9586
  9587     MOVE SPACES                 TO ELCNTL-KEY.
  9588
  9589     IF CONTROL-IS-ACTUAL-CARRIER
  9590         MOVE PI-CARRIER         TO CNTL-CARRIER
  9591     ELSE
  9592         MOVE PI-CARRIER-CONTROL-LEVEL
  9593                                 TO CNTL-CARRIER
  9594     END-IF.
  9595
  9596     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9597     MOVE '6'                    TO CNTL-REC-TYPE.
  9598     MOVE +0                     TO CNTL-SEQ-NO.
  9599
  9600
  9601
  9602* EXEC CICS HANDLE CONDITION
  9603*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9604*    END-EXEC.
  9605*    MOVE '"$I                   ! 3 #00009092' TO DFHEIV0
  9606     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9607     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9608     MOVE X'3320233030303039303932' TO DFHEIV0(25:11)
  9609     CALL 'kxdfhei1' USING DFHEIV0
  9610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9611
  9612
  9613
  9614
  9615* EXEC CICS READ
  9616*        UPDATE
  9617*        DATASET   (ELCNTL-DSID)
  9618*        SET       (ADDRESS OF CONTROL-FILE)
  9619*        RIDFLD    (ELCNTL-KEY)
  9620*    END-EXEC.
  9621*    MOVE '&"S        EU         (   #00009097' TO DFHEIV0
  9622     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9623     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9624     MOVE X'2020233030303039303937' TO DFHEIV0(25:11)
  9625     CALL 'kxdfhei1' USING DFHEIV0,
  9626           ELCNTL-DSID,
  9627           DFHEIV20,
  9628           DFHEIV99,
  9629           ELCNTL-KEY,
  9630           DFHEIV99,
  9631           DFHEIV99,
  9632           DFHEIV99
  9633     SET ADDRESS OF CONTROL-FILE TO
  9634         DFHEIV20
  9635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 181
* EL130.cbl
  9636
  9637
  9638     IF CLAIM-NO-MANUAL
  9639         GO TO 3120-CLAIM-MUST-BE-INPUT
  9640     END-IF.
  9641
  9642     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9643     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9644
  9645     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' OR 'VPP'
  9646         CONTINUE
  9647     ELSE
  9648         GO TO 3080-ASSIGN-LOOP
  9649     END-IF.
  9650
  9651
  9652
  9653* EXEC CICS UNLOCK
  9654*        DATASET   (ELCNTL-DSID)
  9655*    END-EXEC.
  9656*    MOVE '&*                    #   #00009118' TO DFHEIV0
  9657     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9658     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9659     MOVE X'2020233030303039313138' TO DFHEIV0(25:11)
  9660     CALL 'kxdfhei1' USING DFHEIV0,
  9661           ELCNTL-DSID,
  9662           DFHEIV99
  9663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9664
  9665
  9666     MOVE '1'                    TO CNTL-REC-TYPE.
  9667     MOVE SPACES                 TO CNTL-ACCESS.
  9668
  9669     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9670
  9671
  9672
  9673* EXEC CICS HANDLE CONDITION
  9674*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9675*    END-EXEC.
  9676*    MOVE '"$I                   ! 4 #00009128' TO DFHEIV0
  9677     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9679     MOVE X'3420233030303039313238' TO DFHEIV0(25:11)
  9680     CALL 'kxdfhei1' USING DFHEIV0
  9681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9682
  9683
  9684     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9685
  9686     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9687
  9688 3080-ASSIGN-LOOP.
  9689     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9690        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9691         MOVE +0                 TO SAVE-COUNTER
  9692     END-IF.
  9693
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 182
* EL130.cbl
  9694     ADD +1 TO SAVE-COUNTER.
  9695
  9696     IF SAVE-METHOD  = '3'
  9697         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9698         GO TO 3090-SET-COMP
  9699     END-IF.
  9700
  9701     IF SAVE-METHOD  = '4'
  9702         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9703         MOVE CLMCARRI           TO WS-CN-PRF-A
  9704         GO TO 3090-SET-COMP
  9705     END-IF.
  9706
  9707     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9708     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9709     MOVE SAVE-DATE              TO CURR-DATE.
  9710
  9711     IF CURR-MM LESS '10'
  9712         MOVE CURR-M2             TO WS-CN-PRF-B
  9713     END-IF.
  9714
  9715     IF CURR-MM = '10'
  9716        MOVE 'A'                 TO WS-CN-PRF-B
  9717     END-IF.
  9718     IF CURR-MM = '11'
  9719        MOVE 'B'                 TO WS-CN-PRF-B
  9720     END-IF.
  9721     IF CURR-MM = '12'
  9722        MOVE 'C'                 TO WS-CN-PRF-B
  9723     END-IF.
  9724
  9725     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9726
  9727 3090-SET-COMP.
  9728
  9729     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9730     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9731                                    CLMNOO.
  9732     MOVE AL-UANON               TO CLMNOA.
  9733     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9734     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9735     MOVE CLMCARRI               TO MSTR-CARRIER.
  9736
  9737
  9738
  9739* EXEC CICS HANDLE CONDITION
  9740*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9741*    END-EXEC.
  9742*    MOVE '"$I                   ! 5 #00009186' TO DFHEIV0
  9743     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9744     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9745     MOVE X'3520233030303039313836' TO DFHEIV0(25:11)
  9746     CALL 'kxdfhei1' USING DFHEIV0
  9747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9748
  9749
  9750     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9751
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 183
* EL130.cbl
  9752     GO TO 3080-ASSIGN-LOOP.
  9753
  9754 3100-CARRIER-NOT-FOUND.
  9755     MOVE ER-0252                TO EMI-ERROR.
  9756     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9757     MOVE -1                     TO CLMCARRL.
  9758     GO TO 8200-SEND-DATAONLY.
  9759
  9760 3110-COMPANY-NOT-FOUND.
  9761     MOVE ER-0254                TO EMI-ERROR.
  9762     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9763     MOVE -1                     TO MAINTL.
  9764     GO TO 8200-SEND-DATAONLY.
  9765
  9766 3120-CLAIM-MUST-BE-INPUT.
  9767     MOVE ER-0264                TO EMI-ERROR.
  9768     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9769     MOVE -1                     TO CLMNOL.
  9770     GO TO 8200-SEND-DATAONLY.
  9771
  9772 3200-BUILD-ZERO-TRAILER.
  9773
  9774
  9775* EXEC CICS HANDLE CONDITION
  9776*        NOTFND
  9777*    END-EXEC.
  9778*    MOVE '"$                   ! 6 #00009214' TO DFHEIV0
  9779     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9780     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9781     MOVE X'3620233030303039323134' TO DFHEIV0(25:11)
  9782     CALL 'kxdfhei1' USING DFHEIV0
  9783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9784
  9785
  9786
  9787
  9788* EXEC CICS GETMAIN
  9789*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9790*        LENGTH  (ELTRLR-LENGTH)
  9791*    END-EXEC.
  9792*    MOVE '," L                  $   #00009219' TO DFHEIV0
  9793     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9794     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9795     MOVE X'2020233030303039323139' TO DFHEIV0(25:11)
  9796     CALL 'kxdfhei1' USING DFHEIV0,
  9797           DFHEIV20,
  9798           ELTRLR-LENGTH,
  9799           DFHEIV99
  9800     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9801         DFHEIV20
  9802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9803
  9804
  9805     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9806     MOVE 'AT'                   TO AT-RECORD-ID.
  9807
  9808     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9809     MOVE CLMCARRI               TO AT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 184
* EL130.cbl
  9810     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9811     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9812     MOVE +0                     TO AT-SEQUENCE-NO.
  9813     MOVE '1'                    TO AT-TRAILER-TYPE.
  9814
  9815     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9816     MOVE '5'                    TO DC-OPTION-CODE.
  9817     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9818     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9819                                    AT-RESERVES-LAST-MAINT-DT.
  9820
  9821     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9822                                    AT-RESERVES-LAST-UPDATED-BY.
  9823
  9824     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9825
  9826     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9827
  9828     MOVE +0                     TO AT-FUTURE-RESERVE
  9829                                    AT-IBNR-RESERVE
  9830                                    AT-PAY-CURRENT-RESERVE
  9831                                    AT-INITIAL-MANUAL-RESERVE
  9832                                    AT-CURRENT-MANUAL-RESERVE
  9833                                    AT-ITD-LIFE-REFUNDS
  9834                                    AT-ITD-AH-REFUNDS
  9835                                    AT-ITD-ADDITIONAL-RESERVE.
  9836
  9837     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9838
  9839     IF MANRSVL NOT = ZERO
  9840         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9841                                    AT-CURRENT-MANUAL-RESERVE
  9842     END-IF.
  9843
  9844     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9845
  9846     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9847                                    AT-ITD-CHARGEABLE-EXPENSE.
  9848
  9849     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9850     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9851     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9852
  9853
  9854
  9855* EXEC CICS WRITE
  9856*        DATASET   (ELTRLR-DSID)
  9857*        FROM      (ACTIVITY-TRAILERS)
  9858*        RIDFLD    (AT-CONTROL-PRIMARY)
  9859*    END-EXEC.
  9860     MOVE LENGTH OF
  9861      ACTIVITY-TRAILERS
  9862       TO DFHEIV11
  9863*    MOVE '&$ L                  ''   #00009273' TO DFHEIV0
  9864     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9865     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9866     MOVE X'2020233030303039323733' TO DFHEIV0(25:11)
  9867     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 185
* EL130.cbl
  9868           ELTRLR-DSID,
  9869           ACTIVITY-TRAILERS,
  9870           DFHEIV11,
  9871           AT-CONTROL-PRIMARY,
  9872           DFHEIV99,
  9873           DFHEIV99
  9874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9875
  9876
  9877     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9878
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 186
* EL130.cbl
  9880
  9881 3250-BUILD-I1-ADDRESS-TRAILER.
  9882
  9883     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9884     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9885     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9886     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9887     MOVE GROUPI                 TO WS-MA-GROUPING.
  9888     MOVE STATEI                 TO WS-MA-STATE.
  9889     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9890     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9891     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9892     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9893
  9894
  9895* EXEC CICS HANDLE CONDITION
  9896*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9897*    END-EXEC.
  9898*    MOVE '"$I                   ! 7 #00009296' TO DFHEIV0
  9899     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9900     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9901     MOVE X'3720233030303039323936' TO DFHEIV0(25:11)
  9902     CALL 'kxdfhei1' USING DFHEIV0
  9903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9904
  9905
  9906
  9907* EXEC CICS READ
  9908*        EQUAL
  9909*        DATASET   (ERMAIL-DSID)
  9910*        SET       (ADDRESS OF MAILING-DATA)
  9911*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9912*    END-EXEC.
  9913*    MOVE '&"S        E          (   #00009300' TO DFHEIV0
  9914     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9915     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9916     MOVE X'2020233030303039333030' TO DFHEIV0(25:11)
  9917     CALL 'kxdfhei1' USING DFHEIV0,
  9918           ERMAIL-DSID,
  9919           DFHEIV20,
  9920           DFHEIV99,
  9921           WS-MA-CONTROL-PRIMARY,
  9922           DFHEIV99,
  9923           DFHEIV99,
  9924           DFHEIV99
  9925     SET ADDRESS OF MAILING-DATA TO
  9926         DFHEIV20
  9927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9928
  9929
  9930     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9931         GO TO 3290-NO-INSURED-ADDRESS
  9932     END-IF.
  9933
  9934     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9935     MOVE 'AT'                   TO AT-RECORD-ID.
  9936
  9937     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 187
* EL130.cbl
  9938     MOVE CLMCARRI               TO AT-CARRIER.
  9939     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9940     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9941     MOVE +1                     TO AT-SEQUENCE-NO.
  9942     MOVE '5'                    TO AT-TRAILER-TYPE.
  9943
  9944     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9945     IF MA-INSURED-MIDDLE-INIT > SPACES
  9946        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9947               ' ' DELIMITED BY SIZE
  9948               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9949               ' ' DELIMITED BY SIZE
  9950               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9951        INTO AT-MAIL-TO-NAME
  9952     ELSE
  9953        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9954               ' ' DELIMITED BY SIZE
  9955               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9956        INTO AT-MAIL-TO-NAME
  9957     END-IF.
  9958     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9959     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9960*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9961     MOVE MA-CITY                TO AT-CITY
  9962     MOVE MA-ADDR-STATE          TO AT-STATE
  9963     MOVE MA-ZIP                 TO AT-ZIP
  9964     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9965
  9966     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9967                                    AT-ADDRESS-LAST-MAINT-DT.
  9968
  9969     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9970                                    AT-ADDRESS-LAST-UPDATED-BY.
  9971
  9972     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9973
  9974
  9975* EXEC CICS WRITE
  9976*        DATASET   (ELTRLR-DSID)
  9977*        FROM      (ACTIVITY-TRAILERS)
  9978*        RIDFLD    (AT-CONTROL-PRIMARY)
  9979*    END-EXEC.
  9980     MOVE LENGTH OF
  9981      ACTIVITY-TRAILERS
  9982       TO DFHEIV11
  9983*    MOVE '&$ L                  ''   #00009351' TO DFHEIV0
  9984     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9985     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9986     MOVE X'2020233030303039333531' TO DFHEIV0(25:11)
  9987     CALL 'kxdfhei1' USING DFHEIV0,
  9988           ELTRLR-DSID,
  9989           ACTIVITY-TRAILERS,
  9990           DFHEIV11,
  9991           AT-CONTROL-PRIMARY,
  9992           DFHEIV99,
  9993           DFHEIV99
  9994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9995
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 188
* EL130.cbl
  9996
  9997     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9998     GO TO 3300-BUILD-NINETY-TRAILER.
  9999
 10000 3290-NO-INSURED-ADDRESS.
 10001      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
 10002
 10003 3300-BUILD-NINETY-TRAILER.
 10004
 10005     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 10006     MOVE 'AT'                   TO AT-RECORD-ID.
 10007
 10008     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 10009     MOVE CLMCARRI               TO AT-CARRIER.
 10010
 10011     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 10012     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 10013     MOVE +90                    TO AT-SEQUENCE-NO.
 10014     MOVE '6'                    TO AT-TRAILER-TYPE.
 10015
 10016     IF DIAGL NOT = ZERO
 10017         MOVE DIAGI              TO AT-INFO-LINE-1
 10018     END-IF.
 10019
 10020     IF ICD1L NOT = ZERO
 10021         MOVE ICD1I              TO AT-ICD-CODE-1
 10022     END-IF.
 10023
 10024     IF ICD2L NOT = ZERO
 10025         MOVE ICD2I              TO AT-ICD-CODE-2
 10026     END-IF.
 10027
 10028     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10029                                    AT-GEN-INFO-LAST-MAINT-DT.
 10030
 10031     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10032                                    AT-GEN-INFO-LAST-UPDATED-BY.
 10033     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10034
 10035
 10036
 10037* EXEC CICS WRITE
 10038*        DATASET   (ELTRLR-DSID)
 10039*        FROM      (ACTIVITY-TRAILERS)
 10040*        RIDFLD    (AT-CONTROL-PRIMARY)
 10041*    END-EXEC.
 10042     MOVE LENGTH OF
 10043      ACTIVITY-TRAILERS
 10044       TO DFHEIV11
 10045*    MOVE '&$ L                  ''   #00009396' TO DFHEIV0
 10046     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10047     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10048     MOVE X'2020233030303039333936' TO DFHEIV0(25:11)
 10049     CALL 'kxdfhei1' USING DFHEIV0,
 10050           ELTRLR-DSID,
 10051           ACTIVITY-TRAILERS,
 10052           DFHEIV11,
 10053           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 189
* EL130.cbl
 10054           DFHEIV99,
 10055           DFHEIV99
 10056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10057
 10058
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 190
* EL130.cbl
 10060 3400-CHECK-CERT-MAINT.
 10061
 10062     IF CERTMTI = 'A'
 10063         GO TO 3600-BUILD-NEW-CERT
 10064     END-IF.
 10065
 10066     IF NO-CLAIM-ATTACHED
 10067         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
 10068     END-IF.
 10069
 10070     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
 10071
 10072     IF CM-LF-CURRENT-STATUS = '2' OR
 10073        CM-AH-CURRENT-STATUS = '2'
 10074         GO TO 3400-REWRITE-CERT
 10075     END-IF.
 10076
 10077     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10078
 10079 3400-REWRITE-CERT.
 10080
 10081
 10082
 10083* EXEC CICS HANDLE CONDITION
 10084*        DUPKEY (3410-DUP-KEY)
 10085*    END-EXEC.
 10086*    MOVE '"$$                   ! 8 #00009425' TO DFHEIV0
 10087     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10088     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10089     MOVE X'3820233030303039343235' TO DFHEIV0(25:11)
 10090     CALL 'kxdfhei1' USING DFHEIV0
 10091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10092
 10093
 10094
 10095
 10096* EXEC CICS REWRITE
 10097*        DATASET   (ELCERT-DSID)
 10098*        FROM      (CERTIFICATE-MASTER)
 10099*    END-EXEC.
 10100     MOVE LENGTH OF
 10101      CERTIFICATE-MASTER
 10102       TO DFHEIV11
 10103*    MOVE '&& L                  %   #00009430' TO DFHEIV0
 10104     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10105     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10106     MOVE X'2020233030303039343330' TO DFHEIV0(25:11)
 10107     CALL 'kxdfhei1' USING DFHEIV0,
 10108           ELCERT-DSID,
 10109           CERTIFICATE-MASTER,
 10110           DFHEIV11,
 10111           DFHEIV99
 10112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10113
 10114
 10115 3410-DUP-KEY.
 10116     GO TO 3800-BUILD-NEW-CLAIM.
 10117
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 191
* EL130.cbl
 10118 3600-BUILD-NEW-CERT.
 10119
 10120
 10121* EXEC CICS GETMAIN
 10122*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 10123*        LENGTH   (ELCERT-LENGTH)
 10124*    END-EXEC.
 10125*    MOVE '," L                  $   #00009440' TO DFHEIV0
 10126     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10127     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10128     MOVE X'2020233030303039343430' TO DFHEIV0(25:11)
 10129     CALL 'kxdfhei1' USING DFHEIV0,
 10130           DFHEIV20,
 10131           ELCERT-LENGTH,
 10132           DFHEIV99
 10133     SET ADDRESS OF CERTIFICATE-MASTER TO
 10134         DFHEIV20
 10135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10136
 10137
 10138     MOVE SPACES                 TO CERTIFICATE-MASTER.
 10139
 10140     MOVE 'CM'                   TO CM-RECORD-ID.
 10141
 10142     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
 10143                                    CM-COMPANY-CD-A1
 10144                                    CM-COMPANY-CD-A2
 10145                                    CM-COMPANY-CD-A4
 10146                                    CM-COMPANY-CD-A5.
 10147
 10148     MOVE CERT-CARRIER           TO CM-CARRIER.
 10149     MOVE CERT-GROUPING          TO CM-GROUPING.
 10150     MOVE CERT-STATE             TO CM-STATE.
 10151     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
 10152     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
 10153     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
 10154
 10155     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
 10156                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
 10157                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
 10158                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
 10159                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
 10160                       CM-LIVES              CM-LOAN-TERM
 10161                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
 10162                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
 10163                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
 10164                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
 10165                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
 10166                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
 10167                       CM-LF-ALT-PREMIUM-RATE
 10168                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
 10169                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
 10170                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
 10171                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
 10172                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
 10173
 10174     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
 10175                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 192
* EL130.cbl
 10176                                    CM-AH-SETTLEMENT-DT
 10177                                    CM-AH-CANCEL-EXIT-DT
 10178                                    CM-AH-SETTLEMENT-EXIT-DT
 10179                                    CM-LF-LOAN-EXPIRE-DT
 10180                                    CM-LF-CANCEL-DT
 10181                                    CM-LF-DEATH-DT
 10182                                    CM-LF-CANCEL-EXIT-DT
 10183                                    CM-LF-DEATH-EXIT-DT
 10184                                    CM-LAST-ADD-ON-DT
 10185                                    CM-ENTRY-DT.
 10186
 10187     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
 10188     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
 10189     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10190
 10191     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
 10192                                    CM-PART-LAST-NAME-A2
 10193                                    CM-PART-LAST-NAME-A5.
 10194
 10195     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
 10196                                    CM-INSURED-INITIAL1-A2
 10197                                    CM-INSURED-INITIAL1-A5
 10198                                    CM-INSURED-FIRST-NAME.
 10199
 10200     IF CRTINITL GREATER ZERO
 10201         MOVE CRTINITI           TO CM-INSURED-INITIAL2
 10202                                    CM-INSURED-INITIAL2-A2
 10203                                    CM-INSURED-INITIAL2-A5
 10204     ELSE
 10205         MOVE SPACES             TO CM-INSURED-INITIAL2
 10206                                    CM-INSURED-INITIAL2-A2
 10207                                    CM-INSURED-INITIAL2-A5
 10208     END-IF.
 10209
 10210     IF CM-INSURED-INITIALS = SPACES
 10211         MOVE '**'               TO CM-INSURED-INITIALS
 10212     END-IF.
 10213
 10214     IF MEMBERL GREATER ZERO
 10215         MOVE MEMBERI              TO CM-MEMBER-NO
 10216     ELSE
 10217         MOVE CERT-STATE           TO CM-MEMB-STATE
 10218         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
 10219         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
 10220         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
 10221     END-IF.
 10222
 10223     IF JNTLNMEL GREATER ZERO
 10224         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
 10225     END-IF.
 10226
 10227     IF JNTFNMEL GREATER ZERO
 10228         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
 10229     END-IF.
 10230
 10231     IF JNTINITL GREATER ZERO
 10232         MOVE JNTINITI           TO CM-JT-INITIAL
 10233     END-IF.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 193
* EL130.cbl
 10234
 10235     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10236
 10237
 10238
 10239* EXEC CICS HANDLE CONDITION
 10240*        DUPKEY   (3690-CERT-WRITTEN)
 10241*    END-EXEC.
 10242*    MOVE '"$$                   ! 9 #00009545' TO DFHEIV0
 10243     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10244     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10245     MOVE X'3920233030303039353435' TO DFHEIV0(25:11)
 10246     CALL 'kxdfhei1' USING DFHEIV0
 10247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10248
 10249
 10250
 10251
 10252* EXEC CICS WRITE
 10253*        DATASET   (ELCERT-DSID)
 10254*        FROM      (CERTIFICATE-MASTER)
 10255*        RIDFLD    (CM-CONTROL-PRIMARY)
 10256*    END-EXEC.
 10257     MOVE LENGTH OF
 10258      CERTIFICATE-MASTER
 10259       TO DFHEIV11
 10260*    MOVE '&$ L                  ''   #00009550' TO DFHEIV0
 10261     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10262     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10263     MOVE X'2020233030303039353530' TO DFHEIV0(25:11)
 10264     CALL 'kxdfhei1' USING DFHEIV0,
 10265           ELCERT-DSID,
 10266           CERTIFICATE-MASTER,
 10267           DFHEIV11,
 10268           CM-CONTROL-PRIMARY,
 10269           DFHEIV99,
 10270           DFHEIV99
 10271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10272
 10273
 10274 3690-CERT-WRITTEN.
 10275
 10276     GO TO 3800-BUILD-NEW-CLAIM.
 10277
 10278 3690-EXIT.
 10279      EXIT.
 10280
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 194
* EL130.cbl
 10282 3700-BUILD-CERT.
 10283
 10284     IF CERTMTI NOT = 'A'
 10285         GO TO 3700-FINISH-CERT-BUILD
 10286     END-IF.
 10287
 10288     IF CERTMTI = 'A'
 10289         IF LCVCDL = ZEROS
 10290             MOVE ZEROS          TO CM-LF-BENEFIT-CD
 10291                                    CM-LF-ORIG-TERM
 10292                                    CM-LF-BENEFIT-AMT
 10293                                    CM-LF-PREMIUM-RATE
 10294             GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10295         END-IF
 10296     END-IF.
 10297
 10298     IF LCVCDL GREATER ZERO
 10299         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
 10300     END-IF.
 10301
 10302     IF LCVOTRML GREATER ZERO
 10303         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
 10304     END-IF.
 10305
 10306     IF LCVBENEL GREATER ZERO
 10307         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
 10308     END-IF.
 10309
 10310     IF LCVRATEL GREATER ZERO
 10311         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
 10312     END-IF.
 10313
 10314     IF WS-EXPIRE NOT = LOW-VALUES
 10315         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
 10316     END-IF.
 10317
 10318     IF LCVFORML GREATER ZERO
 10319         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
 10320     END-IF.
 10321
 10322     IF LCVCNDTL = ZERO
 10323        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10324     END-IF.
 10325
 10326     IF WS-LCVCNDT NOT = LOW-VALUES
 10327        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10328        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
 10329        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10330     END-IF.
 10331
 10332     IF CM-LF-CURRENT-STATUS = '7'
 10333        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
 10334        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10335        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10336                                    CM-LF-DEATH-DT
 10337        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10338     END-IF.
 10339
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 195
* EL130.cbl
 10340     IF CM-LF-CURRENT-STATUS = '8'
 10341        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10342        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
 10343     END-IF.
 10344
 10345 3700-BUILD-AH-COVERAGE-SIDE.
 10346
 10347     IF CERTMTI = 'A'
 10348         IF ACVCDL = ZEROS
 10349             MOVE ZEROS          TO CM-AH-BENEFIT-CD
 10350                                    CM-AH-ORIG-TERM
 10351                                    CM-AH-BENEFIT-AMT
 10352                                    CM-AH-PREMIUM-RATE
 10353             GO TO 3700-COVERAGE-BUILT
 10354         END-IF
 10355     END-IF.
 10356
 10357     IF ACVCDL GREATER ZERO
 10358         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
 10359     END-IF.
 10360
 10361     IF ACVOTRML GREATER ZERO
 10362         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
 10363     END-IF.
 10364
 10365     IF ACVBENEL GREATER ZERO
 10366         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
 10367     END-IF.
 10368
 10369     IF ACVRATEL GREATER ZERO
 10370         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
 10371     END-IF.
 10372
 10373     IF WS-EXPIRE NOT = LOW-VALUES
 10374         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
 10375     END-IF.
 10376
 10377     IF ACVFORML GREATER ZERO
 10378         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
 10379     END-IF.
 10380
 10381     IF ACVCNDTL = ZERO
 10382        GO TO 3700-COVERAGE-BUILT
 10383     END-IF.
 10384
 10385     IF WS-ACVCNDT NOT = LOW-VALUES
 10386        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10387        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
 10388        GO TO 3700-COVERAGE-BUILT
 10389     END-IF.
 10390
 10391     IF CM-AH-CURRENT-STATUS = '6'
 10392        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
 10393        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10394        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10395        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
 10396        GO TO 3700-COVERAGE-BUILT
 10397     END-IF.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 196
* EL130.cbl
 10398
 10399     IF CM-AH-CURRENT-STATUS = '8'
 10400        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10401        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
 10402     END-IF.
 10403
 10404 3700-COVERAGE-BUILT.
 10405     IF ISSAGEL GREATER ZERO
 10406         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
 10407     END-IF.
 10408
 10409     IF JNTAGEL GREATER ZERO
 10410         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
 10411     END-IF.
 10412
 10413     IF SEXL GREATER ZERO
 10414         MOVE SEXI               TO CM-INSURED-SEX
 10415     END-IF.
 10416
 10417     IF APRL GREATER ZERO
 10418         MOVE WS-APR             TO CM-LOAN-APR
 10419     END-IF.
 10420
 10421     IF PMTFREQL GREATER ZERO
 10422         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
 10423     END-IF.
 10424
 10425     IF INDGRPL GREATER ZERO
 10426         MOVE INDGRPI            TO CM-IND-GRP-TYPE
 10427     END-IF.
 10428
 10429     IF CERTMTI = 'A'
 10430         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10431     END-IF.
 10432
 10433     IF REINCDL GREATER ZERO
 10434         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10435                                    WS-REIN-1
 10436                                    WS-REIN-2
 10437                                    WS-REIN-3
 10438         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10439     END-IF.
 10440
 10441     IF WS-ADD-ON-DT NOT = LOW-VALUES
 10442         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
 10443     END-IF.
 10444
 10445     IF CRTSSNL GREATER ZERO
 10446         MOVE CRTSSNI            TO CM-SOC-SEC-NO
 10447     ELSE
 10448         IF SSNL GREATER ZERO
 10449             MOVE SSNI           TO CM-SOC-SEC-NO
 10450         END-IF
 10451     END-IF.
 10452
 10453     IF CRTSSNL = ZERO AND
 10454        SSNL    = ZERO
 10455         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 197
* EL130.cbl
 10456         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
 10457         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
 10458         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 10459     END-IF.
 10460
 10461     IF CM-LF-CURRENT-STATUS = SPACES
 10462         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10463     END-IF.
 10464
 10465     IF CM-AH-CURRENT-STATUS = SPACES
 10466         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10467     END-IF.
 10468
 10469     IF CERTMTI = 'A'
 10470         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10471     END-IF.
 10472
 10473 3700-FINISH-CERT-BUILD.
 10474
 10475     IF LOANNOL GREATER ZERO
 10476         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10477     END-IF.
 10478
 10479     IF LOANBALL GREATER ZERO
 10480         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10481     END-IF.
 10482
 10483     IF PREMTYPL GREATER ZERO
 10484         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10485     END-IF.
 10486
 10487 3700-EXIT.
 10488      EXIT.
 10489
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 198
* EL130.cbl
 10491 3800-BUILD-NEW-CLAIM.
 10492
 10493*************************************************************
 10494*****           START OF ACTIVITY FILE PROCESSING          **
 10495*************************************************************
 10496     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10497         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10498                 6700-EXIT
 10499     END-IF.
 10500*************************************************************
 10501*****            END OF ACTIVITY FILE PROCESSING           **
 10502*************************************************************
 10503
 10504
 10505
 10506
 10507* EXEC CICS GETMAIN
 10508*        SET     (ADDRESS OF CLAIM-MASTER)
 10509*        LENGTH  (ELMSTR-LENGTH)
 10510*    END-EXEC.
 10511*    MOVE '," L                  $   #00009788' TO DFHEIV0
 10512     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10513     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10514     MOVE X'2020233030303039373838' TO DFHEIV0(25:11)
 10515     CALL 'kxdfhei1' USING DFHEIV0,
 10516           DFHEIV20,
 10517           ELMSTR-LENGTH,
 10518           DFHEIV99
 10519     SET ADDRESS OF CLAIM-MASTER TO
 10520         DFHEIV20
 10521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10522
 10523
 10524     MOVE SPACES TO CLAIM-MASTER.
 10525
 10526     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10527         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10528         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10529         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10530         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10531         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10532         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10533         CL-ACTIVITY-MAINT-DT   cl-benefit-expiration-dt
 10534
 10535     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10536             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10537             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10538             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10539             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10540             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10541             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10542             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10543             CL-FORCEABLE-ERROR-CNT.
 10544
 10545     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10546
 10547     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10548                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 199
* EL130.cbl
 10549                                    CL-LAG-REPORT-CODE
 10550                                    CL-CRITICAL-PERIOD
 10551*                                   CL-CRIT-PER-RTW-MOS
 10552     move 01                     to cl-benefit-period
 10553
 10554     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10555     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10556
 10557     IF BENECDL NOT = ZEROS
 10558        MOVE BENECDI             TO CL-BENEFICIARY
 10559     END-IF.
 10560
 10561     MOVE 'CL'                   TO CL-RECORD-ID.
 10562     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10563
 10564     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10565                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10566                             CL-COMPANY-CD-A5.
 10567
 10568     MOVE CLMCARRI               TO CL-CARRIER.
 10569
 10570     IF CLMNOL = ZERO
 10571         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10572     ELSE
 10573         MOVE CLMNOI             TO CL-CLAIM-NO
 10574     END-IF.
 10575
 10576     MOVE CERTNOI                TO CL-CERT-PRIME
 10577                                    CL-CERT-A4-PRIME.
 10578
 10579     MOVE SUFXI                  TO CL-CERT-SFX
 10580                                    CL-CERT-A4-SFX.
 10581
 10582     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10583
 10584     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10585
 10586     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10587
 10588     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10589
 10590     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10591     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10592
 10593     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10594
 10595     IF CERTMTI = 'A'
 10596         MOVE '2'                TO CL-CERT-ORIGIN
 10597     ELSE
 10598         MOVE '1'                TO CL-CERT-ORIGIN
 10599     END-IF.
 10600
 10601     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10602     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10603     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10604     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10605     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10606
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 200
* EL130.cbl
 10607 3820-REWRITE-CONTROL-FILE.
 10608
 10609     IF CLMNOL GREATER ZERO
 10610         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10611     END-IF.
 10612
 10613     IF CF-RECORD-TYPE = '6'
 10614         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10615     ELSE
 10616         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10617     END-IF.
 10618
 10619
 10620
 10621* EXEC CICS REWRITE
 10622*        DATASET   (ELCNTL-DSID)
 10623*        FROM      (CONTROL-FILE)
 10624*    END-EXEC.
 10625     MOVE LENGTH OF
 10626      CONTROL-FILE
 10627       TO DFHEIV11
 10628*    MOVE '&& L                  %   #00009889' TO DFHEIV0
 10629     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10630     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10631     MOVE X'2020233030303039383839' TO DFHEIV0(25:11)
 10632     CALL 'kxdfhei1' USING DFHEIV0,
 10633           ELCNTL-DSID,
 10634           CONTROL-FILE,
 10635           DFHEIV11,
 10636           DFHEIV99
 10637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10638
 10639
 10640 3830-SEQUENCE-CLAIM-RECORDS.
 10641
 10642     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10643     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10644     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10645
 10646     IF WS-ASSOC-CERT-TOTAL = ZERO
 10647         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10648                                    CL-ASSOC-CERT-TOTAL
 10649         GO TO 3840-WRITE-CLAIM-MASTER
 10650     END-IF.
 10651
 10652     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10653         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10654     ELSE
 10655         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10656     END-IF.
 10657
 10658     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10659     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10660     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10661
 10662 3840-WRITE-CLAIM-MASTER.
 10663
 10664     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 201
* EL130.cbl
 10665     IF WS-REC-FOUND-SW = 'Y'
 10666         MOVE 01                 TO  CL-ACTIVITY-CODE
 10667         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
 10668         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10669     END-IF.
 10670
 10671
 10672
 10673* EXEC CICS HANDLE CONDITION
 10674*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10675*    END-EXEC.
 10676*    MOVE '"$$                   ! : #00009926' TO DFHEIV0
 10677     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10679     MOVE X'3A20233030303039393236' TO DFHEIV0(25:11)
 10680     CALL 'kxdfhei1' USING DFHEIV0
 10681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10682
 10683
 10684** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10685     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10686
 10687
 10688*       CL-CERT-NO
 10689*    IF CL-COMPANY-CD = X'04'
 10690*    ELSE
 10691*       IF CL-COMPANY-CD = X'05'
 10692*       ELSE
 10693*       END-IF
 10694*    END-IF
 10695
 10696* EXEC CICS WRITE
 10697*        DATASET   (ELMSTR-DSID)
 10698*        FROM      (CLAIM-MASTER)
 10699*        RIDFLD    (CL-CONTROL-PRIMARY)
 10700*    END-EXEC.
 10701     MOVE LENGTH OF
 10702      CLAIM-MASTER
 10703       TO DFHEIV11
 10704*    MOVE '&$ L                  ''   #00009946' TO DFHEIV0
 10705     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10706     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10707     MOVE X'2020233030303039393436' TO DFHEIV0(25:11)
 10708     CALL 'kxdfhei1' USING DFHEIV0,
 10709           ELMSTR-DSID,
 10710           CLAIM-MASTER,
 10711           DFHEIV11,
 10712           CL-CONTROL-PRIMARY,
 10713           DFHEIV99,
 10714           DFHEIV99
 10715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10716
 10717
 10718 3850-CLAIM-MSTR-WRITTEN.
 10719
 10720     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10721         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10722     END-IF.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 202
* EL130.cbl
 10723
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 203
* EL130.cbl
 10725 3990-ADD-DONE.
 10726*    MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10727*                                  EMI-SUB      EMI-SWITCH-AREA-2.
 10728*    MOVE SPACES                TO EMI-ACTION-SWITCH
 10729*                                  EMI-ERROR-LINES.
 10730
 10731     IF CLMNOL = ZERO
 10732         move spaces             to emi-claim-no
 10733         MOVE ER-0265            TO EMI-ERROR
 10734         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10735         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (EMI-SUB)
 10736                                    PI-LAST-CLAIM
 10737     ELSE
 10738         MOVE CLMNOI             TO PI-LAST-CLAIM
 10739                                    MSTR-CLAIM-NO
 10740         MOVE ER-0000            TO EMI-ERROR
 10741         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10742     END-IF.
 10743
 10744     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10745       AND (PI-ST-VFY-2ND-BENE = 'L' OR 'B')
 10746         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10747         MOVE ER-7575            TO EMI-ERROR
 10748         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10749     END-IF.
 10750
 10751     IF CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 10752       AND (PI-ST-VFY-2ND-BENE = 'A' OR 'B')
 10753         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10754         MOVE ER-7582            TO EMI-ERROR
 10755         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10756     END-IF.
 10757
 10758     IF PI-STATE = 'VA' OR 'PA' OR 'GA'
 10759        PERFORM 3991-CHECK-2-YEAR-CONTESTABLE THRU 3991-EXIT
 10760     END-IF.
 10761     IF WS-NO-INSURED-ADDRESS = 'Y'
 10762         MOVE ER-3548            TO EMI-ERROR
 10763         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10764     END-IF.
 10765
 10766     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10767       (PI-ST-CAUSAL-STATE = 'L' AND
 10768              CLMTYPEI = PI-LIFE-OVERRIDE-L1)   OR
 10769       (PI-ST-CAUSAL-STATE = 'A' AND
 10770              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10771         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10772         MOVE ER-7577            TO EMI-ERROR
 10773         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10774     END-IF.
 10775     if pi-company-id = 'DCC' OR 'VPP'
 10776        PERFORM 3994C-BUILD-NINETY-FIVE-TRAILER
 10777                                 THRU 3994C-EXIT
 10778     end-if
 10779     IF CLMTYPEI = PI-AH-OVERRIDE-L1
 10780       AND PI-COMPANY-ID = 'CID'
 10781        SET ELAPSED-BETWEEN-BIN TO TRUE
 10782        MOVE ZERO               TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 204
* EL130.cbl
 10783                                   DC-ELAPSED-DAYS
 10784
 10785        MOVE CL-INCURRED-DT  TO DC-BIN-DATE-1
 10786        MOVE WS-TODAY-DT TO DC-BIN-DATE-2
 10787        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10788        IF DC-ODD-DAYS-OVER > ZERO
 10789           ADD 1 TO DC-ELAPSED-MONTHS
 10790        END-IF
 10791
 10792        IF PI-STATE = 'HI'
 10793          AND DC-ELAPSED-MONTHS <= 18
 10794           CONTINUE
 10795        ELSE
 10796           IF DC-ELAPSED-MONTHS > 15
 10797              MOVE ER-7572            TO EMI-ERROR
 10798              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10799              PERFORM 3992-BUILD-TRAILER THRU 3992-EXIT
 10800           END-IF
 10801        END-IF
 10802
 10803     END-IF.
 10804     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10805     MOVE CLMCARRI                   TO  PI-CARRIER.
 10806     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10807     MOVE SUFXI                      TO  PI-CERT-SFX.
 10808
 10809     IF WS-LETTER-SW = 'Y'
 10810         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
 10811         IF W-1523-ERROR-CODE NOT = ZEROS
 10812             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10813             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10814         END-IF
 10815     END-IF.
 10816
 10817     perform 3998-update-cert-claim-trailer
 10818                                 thru 3998-exit
 10819     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10820     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10821     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10822     MOVE CLMCARRI               TO PI-LAST-CARR.
 10823
 10824     IF PRTOPTL GREATER THAN 0
 10825         MOVE PRTOPTI            TO PI-PRT-OPT
 10826     END-IF.
 10827     IF ALTPRTL GREATER THAN 0
 10828         MOVE ALTPRTI            TO PI-ALT-PRT
 10829     END-IF.
 10830
 10831     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10832         MOVE LOW-VALUES         TO EL130AI
 10833         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10834         MOVE AL-SANON           TO CERTNOA
 10835         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10836         MOVE AL-SANON           TO SUFXA
 10837         MOVE PI-LAST-CARR       TO CLMCARRO
 10838         MOVE AL-UANON           TO CLMCARRA
 10839         MOVE PI-LAST-CLAIM      TO CLMNOO
 10840         MOVE AL-UANON           TO CLMNOA
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 205
* EL130.cbl
 10841         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10842         MOVE AL-UANON           TO CLMTYPEA
 10843     ELSE
 10844         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10845         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10846     END-IF.
 10847
 10848     IF PI-PRT-OPT = 'N' OR 'L'
 10849         MOVE PI-PRT-OPT         TO PRTOPTO
 10850         MOVE 1                  TO PRTOPTL
 10851     END-IF.
 10852
 10853     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10854         MOVE PI-ALT-PRT         TO ALTPRTO
 10855         MOVE 4                  TO ALTPRTL
 10856     END-IF.
 10857
 10858     IF PRTOPTL GREATER THAN 0
 10859         IF PRTOPTI = 'L'
 10860             GO TO 0400-CREATE-ELACTQ
 10861         ELSE
 10862             GO TO 0480-PRINT-NOW
 10863         END-IF
 10864     END-IF.
 10865     move 'S'                    to mainti
 10866     PERFORM 0500-CREATE-TEMP-STORAGE
 10867                                 THRU 0599-EXIT
 10868     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10869         GO TO 8100-SEND-INITIAL-MAP
 10870     ELSE
 10871         MOVE LOW-VALUES         TO MAINTO
 10872         MOVE -1                 TO MAINTL
 10873         GO TO 8200-SEND-DATAONLY
 10874     END-IF.
 10875
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 206
* EL130.cbl
 10877 3991-CHECK-2-YEAR-CONTESTABLE.
 10878     SET ELAPSED-BETWEEN-BIN TO TRUE
 10879     MOVE ZERO               TO DC-ELAPSED-MONTHS
 10880                                DC-ELAPSED-DAYS
 10881
 10882     MOVE PI-SAVE-EFFDT  TO DC-BIN-DATE-1.
 10883     MOVE CL-INCURRED-DT TO DC-BIN-DATE-2.
 10884     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10885     IF DC-ODD-DAYS-OVER > ZERO
 10886        ADD 1 TO DC-ELAPSED-MONTHS
 10887     END-IF
 10888
 10889     IF DC-ELAPSED-MONTHS <= 24
 10890        MOVE CL-REPORTED-DT TO DC-BIN-DATE-2
 10891        MOVE ZERO           TO DC-ELAPSED-MONTHS
 10892                               DC-ELAPSED-DAYS
 10893        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10894        IF DC-ODD-DAYS-OVER > ZERO
 10895           ADD 1 TO DC-ELAPSED-MONTHS
 10896        END-IF
 10897        IF DC-ELAPSED-MONTHS > 24
 10898           MOVE ER-1679            TO EMI-ERROR
 10899           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10900           PERFORM 3992-BUILD-TRAILER THRU 3992-EXIT
 10901        END-IF
 10902     END-IF.
 10903
 10904 3991-EXIT.
 10905     EXIT.
 10906 3992-BUILD-TRAILER.
 10907
 10908     MOVE SPACES             TO AT-GENERAL-INFO-TR
 10909     INITIALIZE AT-GENERAL-INFO-TR
 10910     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 10911     MOVE 'AT'               TO AT-RECORD-ID
 10912     MOVE +96                TO AT-SEQUENCE-NO
 10913     MOVE '6'                TO AT-TRAILER-TYPE
 10914     MOVE WS-TODAY-DT        TO AT-RECORDED-DT
 10915                                AT-GEN-INFO-LAST-MAINT-DT
 10916     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 10917                                AT-GEN-INFO-LAST-UPDATED-BY
 10918     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 10919
 10920     MOVE EMI-LINE2 TO AT-INFO-LINE-1
 10921     MOVE SPACES             TO AT-INFO-LINE-2.
 10922
 10923 3992-WRITE.
 10924
 10925
 10926* EXEC CICS HANDLE CONDITION
 10927*        DUPREC    (3992-DUPREC)
 10928*    END-EXEC.
 10929*    MOVE '"$%                   ! ; #00010159' TO DFHEIV0
 10930     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10931     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10932     MOVE X'3B20233030303130313539' TO DFHEIV0(25:11)
 10933     CALL 'kxdfhei1' USING DFHEIV0
 10934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 207
* EL130.cbl
 10935
 10936
 10937
 10938* EXEC CICS WRITE
 10939*         DATASET     ('ELTRLR')
 10940*         FROM        (ACTIVITY-TRAILERS)
 10941*         RIDFLD      (AT-CONTROL-PRIMARY)
 10942*     END-EXEC.
 10943     MOVE LENGTH OF
 10944      ACTIVITY-TRAILERS
 10945       TO DFHEIV11
 10946     MOVE 'ELTRLR' TO DFHEIV1
 10947*    MOVE '&$ L                  ''   #00010163' TO DFHEIV0
 10948     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10949     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10950     MOVE X'2020233030303130313633' TO DFHEIV0(25:11)
 10951     CALL 'kxdfhei1' USING DFHEIV0,
 10952           DFHEIV1,
 10953           ACTIVITY-TRAILERS,
 10954           DFHEIV11,
 10955           AT-CONTROL-PRIMARY,
 10956           DFHEIV99,
 10957           DFHEIV99
 10958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10959
 10960
 10961     GO TO 3992-EXIT.
 10962
 10963 3992-DUPREC.
 10964     SUBTRACT +1 FROM AT-SEQUENCE-NO.
 10965     GO TO 3992-WRITE.
 10966
 10967 3992-EXIT.
 10968     EXIT.
 10969 3993-MODIFY-SCREEN-ATTRB.
 10970
 10971     IF CERTMTL GREATER ZERO
 10972         MOVE AL-UANON           TO CERTMTA
 10973     END-IF.
 10974
 10975     IF EFFDTL GREATER ZERO
 10976         MOVE AL-UANON           TO EFFDTA
 10977     END-IF.
 10978
 10979     IF ACCOUNTL GREATER ZERO
 10980         MOVE AL-UANON           TO ACCOUNTA
 10981     END-IF.
 10982
 10983     IF STATEL GREATER ZERO
 10984         MOVE AL-UANON           TO STATEA
 10985     END-IF.
 10986
 10987     IF CRTCARRL GREATER ZERO
 10988         MOVE AL-UANON           TO CRTCARRA
 10989     END-IF.
 10990
 10991     IF GROUPL GREATER ZERO
 10992         MOVE AL-UANON           TO GROUPA
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 208
* EL130.cbl
 10993     END-IF.
 10994
 10995     IF CRTLNMEL GREATER ZERO
 10996         MOVE AL-UANON           TO CRTLNMEA
 10997     END-IF.
 10998
 10999     IF CRTFNMEL GREATER ZERO
 11000         MOVE AL-UANON           TO CRTFNMEA
 11001     END-IF.
 11002
 11003     IF CRTINITL GREATER ZERO
 11004         MOVE AL-UANON           TO CRTINITA
 11005     END-IF.
 11006
 11007     IF ISSAGEL GREATER ZERO
 11008         MOVE AL-UNNON           TO ISSAGEA
 11009     END-IF.
 11010
 11011     IF JNTLNMEL GREATER ZERO
 11012         MOVE AL-UANON           TO JNTLNMEA
 11013     END-IF.
 11014
 11015     IF JNTFNMEL GREATER ZERO
 11016         MOVE AL-UANON           TO JNTFNMEA
 11017     END-IF.
 11018
 11019     IF JNTINITL GREATER ZERO
 11020         MOVE AL-UANON           TO JNTINITA
 11021     END-IF.
 11022
 11023     IF JNTAGEL GREATER ZERO
 11024         MOVE AL-UNNON           TO JNTAGEA
 11025     END-IF.
 11026
 11027     IF CRTSSNL GREATER ZERO
 11028         MOVE AL-UANON           TO CRTSSNA
 11029     END-IF.
 11030
 11031     IF ACVDSCRL GREATER ZERO
 11032         MOVE AL-SANON           TO ACVDSCRA
 11033     END-IF.
 11034
 11035     IF ACVKINDL GREATER ZERO
 11036         MOVE AL-SANON           TO ACVKINDA
 11037     END-IF.
 11038
 11039     IF ACVCDL GREATER ZERO
 11040         MOVE AL-UANON           TO ACVCDA
 11041     END-IF.
 11042
 11043     IF ACVOTRML GREATER ZERO
 11044         MOVE AL-UNNON           TO ACVOTRMA
 11045     END-IF.
 11046
 11047     IF ACVRTRML GREATER ZERO
 11048         MOVE AL-UNNON           TO ACVRTRMA
 11049     END-IF.
 11050
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 209
* EL130.cbl
 11051     IF ACVRATEL GREATER ZERO
 11052         MOVE AL-UNNON           TO ACVRATEA
 11053     END-IF.
 11054
 11055     IF ACVBENEL GREATER ZERO
 11056         MOVE AL-UNNON           TO ACVBENEA
 11057     END-IF.
 11058
 11059     IF ACVFORML GREATER ZERO
 11060         MOVE AL-UANON           TO ACVFORMA
 11061     END-IF.
 11062
 11063     IF ACVCNDTL GREATER ZERO
 11064         MOVE AL-UANON           TO ACVCNDTA
 11065     END-IF.
 11066
 11067     IF ACVEXITL GREATER ZERO
 11068         MOVE AL-UANON           TO ACVEXITA
 11069     END-IF.
 11070
 11071     IF ACVSTATL GREATER ZERO
 11072         MOVE AL-UANON           TO ACVSTATA
 11073     END-IF.
 11074
 11075     IF LCVDSCRL GREATER ZERO
 11076         MOVE AL-SANON           TO LCVDSCRA
 11077     END-IF.
 11078
 11079     IF LCVKINDL GREATER ZERO
 11080         MOVE AL-SANON           TO LCVKINDA
 11081     END-IF.
 11082
 11083     IF LCVCDL GREATER ZERO
 11084         MOVE AL-UANON           TO LCVCDA
 11085     END-IF.
 11086
 11087     IF LCVOTRML GREATER ZERO
 11088         MOVE AL-UNNON           TO LCVOTRMA
 11089     END-IF.
 11090
 11091     IF LCVRTRML GREATER ZERO
 11092         MOVE AL-UNNON           TO LCVRTRMA
 11093     END-IF.
 11094
 11095     IF LCVRATEL GREATER ZERO
 11096         MOVE AL-UNNON           TO LCVRATEA
 11097     END-IF.
 11098
 11099     IF LCVBENEL GREATER ZERO
 11100         MOVE AL-UNNON           TO LCVBENEA
 11101     END-IF.
 11102
 11103     IF LCVFORML GREATER ZERO
 11104         MOVE AL-UANON           TO LCVFORMA
 11105     END-IF.
 11106
 11107     IF LCVCNDTL GREATER ZERO
 11108         MOVE AL-UANON           TO LCVCNDTA
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 210
* EL130.cbl
 11109     END-IF.
 11110
 11111     IF LCVEXITL GREATER ZERO
 11112         MOVE AL-UANON           TO LCVEXITA
 11113     END-IF.
 11114
 11115     IF LCVSTATL GREATER ZERO
 11116         MOVE AL-UANON           TO LCVSTATA
 11117     END-IF.
 11118
 11119     IF MEMCAPL GREATER ZERO
 11120         MOVE AL-UANON           TO MEMCAPA
 11121     END-IF.
 11122
 11123     IF APRL GREATER ZERO
 11124         MOVE AL-UNNON           TO APRA
 11125     END-IF.
 11126
 11127     IF PMTFREQL GREATER ZERO
 11128         MOVE AL-UNNON           TO PMTFREQA
 11129     END-IF.
 11130
 11131     IF INDGRPL GREATER ZERO
 11132         MOVE AL-UANON           TO INDGRPA
 11133     END-IF.
 11134
 11135     IF PREMTYPL GREATER ZERO
 11136         MOVE AL-UANON           TO PREMTYPA
 11137     END-IF.
 11138
 11139     IF REINCDL GREATER ZERO
 11140         MOVE AL-UANON           TO REINCDA
 11141     END-IF.
 11142
 11143     IF ADDONDTL GREATER ZERO
 11144         MOVE AL-UANON           TO ADDONDTA
 11145     END-IF.
 11146
 11147     IF MEMBERL GREATER ZERO
 11148         MOVE AL-UANON           TO MEMBERA
 11149     END-IF.
 11150
 11151     IF BCERT1L GREATER ZERO
 11152         MOVE AL-SANON           TO BCERT1A
 11153                                    BSUFX1A
 11154     END-IF.
 11155
 11156     IF BCERT2L GREATER ZERO
 11157         MOVE AL-SANON           TO BCERT2A
 11158                                    BSUFX2A
 11159     END-IF.
 11160
 11161     IF BCERT3L GREATER ZERO
 11162         MOVE AL-SANON           TO BCERT3A
 11163                                    BSUFX3A
 11164     END-IF.
 11165
 11166     IF BCERT4L GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 211
* EL130.cbl
 11167         MOVE AL-SANON           TO BCERT4A
 11168                                    BSUFX4A
 11169     END-IF.
 11170
 11171     IF BCERT5L GREATER ZERO
 11172         MOVE AL-SANON           TO BCERT5A
 11173                                    BSUFX5A
 11174     END-IF.
 11175
 11176 3993-MODIFY-CLAIM-ATTRB.
 11177
 11178     IF PCERTNOL GREATER ZERO
 11179         MOVE AL-UANON           TO PCERTNOA
 11180     END-IF.
 11181
 11182     IF PSUFXL GREATER ZERO
 11183         MOVE AL-UANON           TO PSUFXA
 11184     END-IF.
 11185
 11186     IF LSTNMEL GREATER ZERO
 11187         MOVE AL-UANON           TO LSTNMEA
 11188     END-IF.
 11189
 11190     IF FSTNMEL GREATER ZERO
 11191         MOVE AL-UANON           TO FSTNMEA
 11192     END-IF.
 11193
 11194     IF INITL GREATER ZERO
 11195         MOVE AL-UANON           TO INITA
 11196     END-IF.
 11197
 11198     IF SEXL GREATER ZERO
 11199         MOVE AL-UANON           TO SEXA
 11200     END-IF.
 11201
 11202     IF BIRTHDTL GREATER ZERO
 11203         MOVE AL-UANON           TO BIRTHDTA
 11204     END-IF.
 11205
 11206     IF SSNL GREATER ZERO
 11207         MOVE AL-UANON           TO SSNA
 11208     END-IF.
 11209
 11210     IF INCURL GREATER ZERO
 11211         MOVE AL-UANON           TO INCURA
 11212     END-IF.
 11213
 11214     IF REPORTL GREATER ZERO
 11215         MOVE AL-UANON           TO REPORTA
 11216     END-IF.
 11217
 11218*    IF ESTENDL GREATER ZERO
 11219*        MOVE AL-UANON           TO ESTENDA
 11220*    END-IF.
 11221
 11222     IF DIAGL GREATER ZERO
 11223         MOVE AL-UANON           TO DIAGA
 11224     END-IF.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 212
* EL130.cbl
 11225*
 11226     IF ICD1L GREATER ZERO
 11227         MOVE AL-UANON           TO ICD1A
 11228     END-IF.
 11229
 11230     IF ICD2L GREATER ZERO
 11231         MOVE AL-UANON           TO ICD2A
 11232     END-IF.
 11233
 11234*    IF CAUSEL GREATER ZERO
 11235*        MOVE AL-UANON           TO CAUSEA
 11236*    END-IF.
 11237
 11238     IF MANRSVL GREATER ZERO
 11239         MOVE AL-UNNON           TO MANRSVA
 11240     END-IF.
 11241
 11242     IF RELCLML GREATER ZERO
 11243         MOVE AL-UANON           TO RELCLMA
 11244     END-IF.
 11245
 11246     IF LOANNOL GREATER ZERO
 11247         MOVE AL-UANON           TO LOANNOA
 11248     END-IF.
 11249
 11250     IF LOANBALL GREATER ZERO
 11251         MOVE AL-UNNON           TO LOANBALA
 11252     END-IF.
 11253
 11254     IF PROCCDL GREATER ZERO
 11255         MOVE AL-UANON           TO PROCCDA
 11256     END-IF.
 11257
 11258     IF BENECDL GREATER THAN ZERO
 11259         MOVE AL-UANON           TO  BENECDA
 11260     END-IF.
 11261
 11262     IF PRICDL GREATER ZERO
 11263         MOVE AL-UANON           TO PRICDA
 11264     END-IF.
 11265
 11266     IF SUPVL GREATER ZERO
 11267         MOVE AL-UANON           TO SUPVA
 11268     END-IF.
 11269
 11270     IF FILETOL GREATER ZERO
 11271         MOVE AL-UANON           TO FILETOA
 11272     END-IF.
 11273
 11274
 11275 3993-MODIFY-CLAIM-KEY-ATTRB.
 11276
 11277     IF CLMNOL GREATER ZERO
 11278         MOVE AL-UANON           TO CLMNOA
 11279     END-IF.
 11280
 11281     IF CLMCARRL GREATER ZERO
 11282         MOVE AL-UANON           TO CLMCARRA
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 213
* EL130.cbl
 11283     END-IF.
 11284
 11285     IF CLMTYPEL GREATER ZERO
 11286         MOVE AL-UANON           TO CLMTYPEA
 11287     END-IF.
 11288
 11289     IF CERTNOL GREATER ZERO
 11290         MOVE AL-SANON           TO CERTNOA
 11291     END-IF.
 11292
 11293     IF SUFXL GREATER ZERO
 11294         MOVE AL-SANON           TO SUFXA
 11295     END-IF.
 11296
 11297 3993-EXIT.
 11298     EXIT.
 11299
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 214
* EL130.cbl
 11301 3994-BUILD-NINETY-THREE-TRAILER.
 11302
 11303     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11304     MOVE 'AT'                   TO AT-RECORD-ID.
 11305
 11306     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11307     MOVE CLMCARRI               TO AT-CARRIER.
 11308
 11309     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11310     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11311     MOVE +93                    TO AT-SEQUENCE-NO.
 11312     MOVE '6'                    TO AT-TRAILER-TYPE.
 11313     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11314
 11315     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 11316         MOVE WS-VERIFY-NOTE     TO AT-INFO-LINE-1
 11317     ELSE
 11318         MOVE WS-VFY-SSN-NOTE    TO AT-INFO-LINE-1
 11319     END-IF
 11320
 11321     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11322                                    AT-GEN-INFO-LAST-MAINT-DT.
 11323
 11324     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11325                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11326     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11327
 11328
 11329
 11330* EXEC CICS WRITE
 11331*        DATASET   (ELTRLR-DSID)
 11332*        FROM      (ACTIVITY-TRAILERS)
 11333*        RIDFLD    (AT-CONTROL-PRIMARY)
 11334*    END-EXEC.
 11335     MOVE LENGTH OF
 11336      ACTIVITY-TRAILERS
 11337       TO DFHEIV11
 11338*    MOVE '&$ L                  ''   #00010537' TO DFHEIV0
 11339     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11340     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11341     MOVE X'2020233030303130353337' TO DFHEIV0(25:11)
 11342     CALL 'kxdfhei1' USING DFHEIV0,
 11343           ELTRLR-DSID,
 11344           ACTIVITY-TRAILERS,
 11345           DFHEIV11,
 11346           AT-CONTROL-PRIMARY,
 11347           DFHEIV99,
 11348           DFHEIV99
 11349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11350
 11351
 11352 3994-EXIT.
 11353     EXIT.
 11354
 11355 3994B-BUILD-NINETY-FOUR-TRAILER.
 11356
 11357     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11358     MOVE 'AT'                   TO AT-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 215
* EL130.cbl
 11359
 11360     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11361     MOVE CLMCARRI               TO AT-CARRIER.
 11362
 11363     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11364     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11365     MOVE +94                    TO AT-SEQUENCE-NO.
 11366     MOVE '6'                    TO AT-TRAILER-TYPE.
 11367     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11368
 11369     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 11370
 11371     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11372                                    AT-GEN-INFO-LAST-MAINT-DT.
 11373
 11374     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11375                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11376     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11377
 11378
 11379
 11380* EXEC CICS WRITE
 11381*        DATASET   (ELTRLR-DSID)
 11382*        FROM      (ACTIVITY-TRAILERS)
 11383*        RIDFLD    (AT-CONTROL-PRIMARY)
 11384*    END-EXEC.
 11385     MOVE LENGTH OF
 11386      ACTIVITY-TRAILERS
 11387       TO DFHEIV11
 11388*    MOVE '&$ L                  ''   #00010570' TO DFHEIV0
 11389     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11390     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11391     MOVE X'2020233030303130353730' TO DFHEIV0(25:11)
 11392     CALL 'kxdfhei1' USING DFHEIV0,
 11393           ELTRLR-DSID,
 11394           ACTIVITY-TRAILERS,
 11395           DFHEIV11,
 11396           AT-CONTROL-PRIMARY,
 11397           DFHEIV99,
 11398           DFHEIV99
 11399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11400
 11401
 11402 3994B-EXIT.
 11403     EXIT.
 11404 3994C-BUILD-NINETY-FIVE-TRAILER.
 11405
 11406     MOVE SPACES                 TO ACTIVITY-TRAILERS
 11407     MOVE 'AT'                   TO AT-RECORD-ID
 11408
 11409     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD
 11410     MOVE CLMCARRI               TO AT-CARRIER
 11411
 11412     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO
 11413     MOVE CERT-CERT-NO           TO AT-CERT-NO
 11414     MOVE +95                    TO AT-SEQUENCE-NO
 11415     MOVE '6'                    TO AT-TRAILER-TYPE
 11416     MOVE 'E'                    TO AT-INFO-TRAILER-TYPE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 216
* EL130.cbl
 11417
 11418     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11419                                    AT-GEN-INFO-LAST-MAINT-DT
 11420
 11421     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11422                                    AT-GEN-INFO-LAST-UPDATED-BY
 11423     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 11424
 11425     perform varying e1 from +1 by +1 until
 11426        ws-error-no (e1) = spaces
 11427        move ws-error-no (e1)    to at-note-error-no (e1)
 11428     end-perform
 11429
 11430     if at-info-line-1 not = spaces
 11431
 11432* EXEC CICS WRITE
 11433*          DATASET  (ELTRLR-DSID)
 11434*          FROM     (ACTIVITY-TRAILERS)
 11435*          RIDFLD   (AT-CONTROL-PRIMARY)
 11436*       END-EXEC
 11437     MOVE LENGTH OF
 11438      ACTIVITY-TRAILERS
 11439       TO DFHEIV11
 11440*    MOVE '&$ L                  ''   #00010605' TO DFHEIV0
 11441     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11442     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11443     MOVE X'2020233030303130363035' TO DFHEIV0(25:11)
 11444     CALL 'kxdfhei1' USING DFHEIV0,
 11445           ELTRLR-DSID,
 11446           ACTIVITY-TRAILERS,
 11447           DFHEIV11,
 11448           AT-CONTROL-PRIMARY,
 11449           DFHEIV99,
 11450           DFHEIV99
 11451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11452     end-if
 11453
 11454     .
 11455 3994C-EXIT.
 11456     EXIT.
 11457 3995-BUILD-CLAIM-RECORD.
 11458     IF PROCCDL GREATER ZERO
 11459         MOVE PROCCDI            TO CL-PROCESSOR-ID
 11460     ELSE
 11461         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 11462     END-IF.
 11463
 11464     IF FSTNMEL GREATER ZERO
 11465         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 11466     END-IF.
 11467
 11468     IF INITL GREATER ZERO
 11469         MOVE INITI              TO CL-INSURED-MID-INIT
 11470     END-IF.
 11471
 11472     IF BIRTHDTL GREATER ZERO
 11473         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 11474     END-IF.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 217
* EL130.cbl
 11475
 11476     IF SEXL GREATER ZERO
 11477         MOVE SEXI               TO CL-INSURED-SEX-CD
 11478     END-IF.
 11479
 11480     MOVE 'O'                    TO CL-CLAIM-STATUS.
 11481
 11482*    IF CLMTYPEL GREATER ZERO
 11483     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 11484*    END-IF.
 11485
 11486     IF PREMTYPL GREATER ZERO
 11487         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 11488     END-IF.
 11489
 11490     IF INCURL GREATER ZERO
 11491         MOVE WS-INCUR           TO CL-INCURRED-DT
 11492     END-IF.
 11493
 11494     IF (PI-COMPANY-ID = 'DCC' OR 'VPP')
 11495        AND (ERPDEF-FOUND)
 11496        MOVE WS-MAX-BENEFITS     TO CL-CRITICAL-PERIOD
 11497*       MOVE WS-CRIT-PER-RECURRENT
 11498*                                TO CL-CRIT-PER-RECURRENT
 11499*       MOVE WS-CRIT-PER-RTW-MOS TO CL-CRIT-PER-RTW-MOS
 11500        if ws-crit-per-recurrent > 01
 11501           move zeros            to cl-benefit-period
 11502        end-if
 11503     ELSE
 11504        IF CL-CLAIM-TYPE = 'L' OR 'P'
 11505           MOVE CM-LF-CRITICAL-PERIOD
 11506                                 TO CL-CRITICAL-PERIOD
 11507        ELSE
 11508           MOVE CM-AH-CRITICAL-PERIOD
 11509                                 TO CL-CRITICAL-PERIOD
 11510        END-IF
 11511     END-IF
 11512
 11513     IF CL-CRITICAL-PERIOD NOT = ZEROS
 11514        COMPUTE DC-ELAPSED-MONTHS =
 11515           CL-CRITICAL-PERIOD - WS-BENEFITS-PREV-PAID
 11516        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
 11517        MOVE ZEROS               TO DC-ELAPSED-DAYS
 11518        MOVE '6'                 TO DC-OPTION-CODE
 11519        PERFORM 9700-LINK-DATE-CONVERT
 11520                                 THRU 9700-EXIT
 11521        MOVE DC-BIN-DATE-2       TO CL-BENEFIT-EXPIRATION-DT
 11522     END-IF
 11523
 11524     if instypel > zero
 11525        move instypei            to cl-insured-type
 11526     end-if
 11527     IF REPORTL GREATER ZERO
 11528         MOVE WS-REPORT          TO CL-REPORTED-DT
 11529     END-IF.
 11530
 11531     IF EIBAID = DFHPF6
 11532         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 218
* EL130.cbl
 11533             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 11534                 IF EMI-FORCABLE-CTR = +1
 11535                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 11536                 END-IF
 11537         END-IF
 11538     END-IF.
 11539
 11540*    IF ESTENDL GREATER ZERO
 11541*       MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 11542*    END-IF.
 11543
 11544     IF ADDONDTL GREATER ZERO
 11545         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 11546     END-IF.
 11547
 11548*    IF CAUSEL GREATER ZERO
 11549*        MOVE CAUSEI             TO CL-CAUSE-CD
 11550*    END-IF.
 11551
 11552     IF SSNL GREATER ZERO
 11553         MOVE SSNI               TO CL-SOC-SEC-NO
 11554     ELSE
 11555         MOVE CERT-STATE         TO CL-SSN-STATE
 11556         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 11557         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 11558     END-IF.
 11559
 11560     IF PRICDL GREATER ZERO
 11561         MOVE PRICDI             TO CL-PRIORITY-CD
 11562     END-IF.
 11563
 11564     IF SUPVL GREATER ZERO
 11565         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 11566     END-IF.
 11567
 11568     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 11569     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 11570     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 11571
 11572     IF RELCLML GREATER ZERO
 11573         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 11574     END-IF.
 11575
 11576     IF FILETOL GREATER ZERO
 11577         MOVE FILETOI            TO CL-FILE-LOCATION
 11578     END-IF.
 11579
 11580 3995-EXIT.
 11581      EXIT.
 11582 3996-read-cert-claim-trailer.
 11583
 11584     move cm-ah-benefit-amt      to ws-monthly-benefit
 11585     if (pi-dcc-max-amt < ws-monthly-benefit)
 11586        and (pi-dcc-max-amt not = zeros)
 11587        move pi-dcc-max-amt      to ws-monthly-benefit
 11588     end-if
 11589
 11590     MOVE CM-COMPANY-CD          TO CTRLR-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 219
* EL130.cbl
 11591     MOVE CM-CARRIER             TO CTRLR-CARRIER
 11592     MOVE CM-GROUPING            TO CTRLR-GROUPING
 11593     MOVE CM-STATE               TO CTRLR-STATE
 11594     MOVE CM-ACCOUNT             TO CTRLR-ACCOUNT
 11595     MOVE CM-CERT-EFF-DT         TO CTRLR-EFF-DT
 11596     MOVE CM-CERT-NO             TO CTRLR-CERT-NO
 11597     MOVE 'B'                    TO CTRLR-REC-TYPE
 11598
 11599* EXEC CICS READ
 11600*       DATASET  (ELCRTT-DSID)
 11601*       set     (address of CERTIFICATE-TRAILERS)
 11602*       RIDFLD   (ELCRTT-KEY)
 11603*       RESP     (WS-RESPONSE)
 11604*    END-EXEC
 11605*    MOVE '&"S        E          (  N#00010756' TO DFHEIV0
 11606     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11607     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11608     MOVE X'204E233030303130373536' TO DFHEIV0(25:11)
 11609     CALL 'kxdfhei1' USING DFHEIV0,
 11610           ELCRTT-DSID,
 11611           DFHEIV20,
 11612           DFHEIV99,
 11613           ELCRTT-KEY,
 11614           DFHEIV99,
 11615           DFHEIV99,
 11616           DFHEIV99
 11617     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11618         DFHEIV20
 11619     MOVE EIBRESP  TO WS-RESPONSE
 11620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11621***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11622***                                                            ***
 11623***  This may need some work here. I think I should accumulate ***
 11624***  all the claims with the same claim type?????????          ***
 11625***                                                            ***
 11626***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11627     IF WS-RESP-NORMAL
 11628        move zeros to ws-tot-days-paid ws-tot-amt-paid
 11629        perform varying s1 from +1 by +1 until
 11630           (s1 > +24)
 11631           or (cs-claim-no (s1) = spaces)
 11632           if cs-claim-type (s1) = clmtypei
 11633              move er-1659       to ws-error-no (e1)
 11634              compute ws-tot-days-paid =
 11635                 ws-tot-days-paid + cs-days-paid (s1)
 11636              compute ws-tot-amt-paid =
 11637                 ws-tot-amt-paid + cs-total-paid (s1)
 11638           end-if
 11639        end-perform
 11640*        compute ws-pd-bens rounded = ws-tot-days-paid / 30
 11641*        if (ws-pd-bens >= pi-dcc-max-benefits)
 11642*           and (pi-dcc-max-benefits not = zeros)
 11643*           add +1                to e1
 11644*           MOVE ER-1660          TO EMI-ERROR
 11645*                                    ws-error-no (e1)
 11646*           PERFORM 9900-ERROR-FORMAT
 11647*                                 THRU 9900-EXIT
 11648*        end-if
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 220
* EL130.cbl
 11649     end-if
 11650**       if instypei = 'P'
 11651**          move +1 to s1
 11652**       else
 11653**          MOVE +2 to s1
 11654**       end-if
 11655*
 11656*        move +1 to s1
 11657*        evaluate clmtypei
 11658*           when 'A'
 11659*              move +1 to s2
 11660*           when 'I'
 11661*              move +2 to s2
 11662*           when 'G'
 11663*              move +3 to s2
 11664*           when 'L'
 11665*              move +4 to s2
 11666*           when 'P'
 11667*              move +5 to s2
 11668*        end-evaluate
 11669*        if cs-claim-type (s1 s2) = clmtypei
 11670*           if cs-no-of-claims (s1 s2) > zeros
 11671*              move er-1659       to ws-error-no (e1)
 11672*           end-if
 11673*           compute WS-BENEFITS-PREV-PAID =
 11674*              cs-total-paid (s1 s2) / ws-monthly-benefit
 11675*           if (WS-BENEFITS-PREV-PAID >= pi-dcc-max-benefits)
 11676*              and (pi-dcc-max-benefits not = zeros)
 11677*              add +1             to e1
 11678*              MOVE ER-1660       TO EMI-ERROR
 11679*                                    ws-error-no (e1)
 11680*              PERFORM 9900-ERROR-FORMAT
 11681*                                 THRU 9900-EXIT
 11682*           end-if
 11683*        end-if
 11684*     end-if
 11685
 11686     .
 11687 3996-exit.
 11688     exit.
 11689
 11690 3997-GET-ERPDEF.
 11691
 11692     if cm-clp-state = spaces or low-values or zeros
 11693        move cm-state            to cm-clp-state
 11694     end-if
 11695     MOVE SPACES                 TO WS-ERPDEF-SW
 11696     MOVE ZEROS                  TO WS-MAX-BENEFITS
 11697                                    WS-CRIT-PER-RTW-MOS
 11698                                    WS-CRIT-PER-RECURRENT
 11699
 11700     MOVE PI-COMPANY-CD       TO ERPDEF-KEY
 11701     MOVE CM-clp-state        TO ERPDEF-STATE
 11702     MOVE ws-dcc-product-code TO ERPDEF-PROD-CD
 11703***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11704***                                                            ***
 11705***  If they set up a claim where there is no coverage on the  ***
 11706***  addendum with the intention of denying.  We need to do    ***
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 221
* EL130.cbl
 11707***  some funky stuff here.                                    ***
 11708***                                                            ***
 11709***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11710
 11711     evaluate true
 11712        when (clmtypei = 'L' or 'P')
 11713           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 11714              and 'CU')
 11715           move 'L'              to erpdef-ben-type
 11716           move cm-lf-benefit-cd to erpdef-ben-code
 11717        when (clmtypei not = 'L' and 'P')
 11718           and (cm-ah-benefit-cd not = '00' and '  ')
 11719           move 'A'              to erpdef-ben-type
 11720           move cm-ah-benefit-cd to erpdef-ben-code
 11721        when (clmtypei not = 'L' and 'P')
 11722           and (cm-ah-benefit-cd = '00' or '  ')
 11723           move 'L'              to erpdef-ben-type
 11724           move cm-lf-benefit-cd to erpdef-ben-code
 11725        when (clmtypei = 'L' or 'P')
 11726           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 11727           move 'A'              to erpdef-ben-type
 11728           move cm-ah-benefit-cd to erpdef-ben-code
 11729        when other
 11730           move 'A'              to erpdef-ben-type
 11731           move cm-ah-benefit-cd to erpdef-ben-code
 11732     end-evaluate
 11733*    MOVE 'A'                 TO ERPDEF-BEN-TYPE
 11734*    MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 11735     MOVE CM-CERT-EFF-DT      TO ERPDEF-EXP-DT
 11736     MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 11737
 11738
 11739* EXEC CICS STARTBR
 11740*        DATASET  ('ERPDEF')
 11741*        RIDFLD   (ERPDEF-KEY)
 11742*        GTEQ
 11743*        RESP     (WS-RESPONSE)
 11744*    END-EXEC
 11745     MOVE 'ERPDEF' TO DFHEIV1
 11746     MOVE 0
 11747       TO DFHEIV11
 11748*    MOVE '&,         G          &  N#00010879' TO DFHEIV0
 11749     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11750     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11751     MOVE X'204E233030303130383739' TO DFHEIV0(25:11)
 11752     CALL 'kxdfhei1' USING DFHEIV0,
 11753           DFHEIV1,
 11754           ERPDEF-KEY,
 11755           DFHEIV99,
 11756           DFHEIV11,
 11757           DFHEIV99
 11758     MOVE EIBRESP  TO WS-RESPONSE
 11759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11760
 11761     IF WS-RESP-NORMAL
 11762
 11763* EXEC CICS READNEXT
 11764*          DATASET  ('ERPDEF')
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 222
* EL130.cbl
 11765*          INTO     (PRODUCT-MASTER)
 11766*          RIDFLD   (ERPDEF-KEY)
 11767*          RESP     (WS-RESPONSE)
 11768*       END-EXEC
 11769     MOVE LENGTH OF
 11770      PRODUCT-MASTER
 11771       TO DFHEIV12
 11772     MOVE 'ERPDEF' TO DFHEIV1
 11773     MOVE 0
 11774       TO DFHEIV11
 11775*    MOVE '&.IL                  )  N#00010887' TO DFHEIV0
 11776     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11777     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11778     MOVE X'204E233030303130383837' TO DFHEIV0(25:11)
 11779     CALL 'kxdfhei1' USING DFHEIV0,
 11780           DFHEIV1,
 11781           PRODUCT-MASTER,
 11782           DFHEIV12,
 11783           ERPDEF-KEY,
 11784           DFHEIV99,
 11785           DFHEIV11,
 11786           DFHEIV99,
 11787           DFHEIV99
 11788     MOVE EIBRESP  TO WS-RESPONSE
 11789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11790
 11791        IF WS-RESP-NORMAL
 11792           IF (ERPDEF-KEY-SAVE (1:16) =
 11793              PD-CONTROL-PRIMARY (1:16))
 11794              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 11795
 11796              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 11797                 (A1 > +8)
 11798                 OR (PD-PROD-CODE (A1) = CLMTYPEI)
 11799              END-PERFORM
 11800              IF A1 < +9
 11801                 SET ERPDEF-FOUND TO TRUE
 11802                 move pd-max-amt (a1)
 11803                              to pi-dcc-max-amt
 11804                 MOVE PD-CRIT-PERIOD (A1)
 11805                              TO WS-MAX-BENEFITS
 11806                                 pi-dcc-max-benefits
 11807                 if pd-rec-crit-period (a1) not numeric
 11808                    move 01      to pd-rec-crit-period (a1)
 11809                 end-if
 11810                 MOVE PD-REC-CRIT-PERIOD (A1)
 11811                              TO WS-CRIT-PER-RECURRENT
 11812                 IF PD-RTW-MOS (A1) NUMERIC
 11813                    MOVE PD-RTW-MOS (A1)
 11814                              TO WS-CRIT-PER-RTW-MOS
 11815                 ELSE
 11816                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 11817                 END-IF
 11818                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 11819                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 11820                                 TO WS-EXCL-PERIOD
 11821                 END-IF
 11822                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 223
* EL130.cbl
 11823                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 11824                                 TO WS-COV-ENDS
 11825                 END-IF
 11826                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 11827                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 11828                                 TO WS-ACC-PERIOD
 11829                 END-IF
 11830                 IF PD-PRE-EXIST-EXCL-TYPE (A1) NUMERIC
 11831                    MOVE PD-PRE-EXIST-EXCL-TYPE (A1)
 11832                                 TO WS-PRE-EXISTING-PER
 11833                 END-IF
 11834              else
 11835                 MOVE -1         TO MAINTL
 11836                 move er-1673    to emi-error
 11837                 PERFORM 9900-ERROR-FORMAT
 11838                                 THRU 9900-EXIT
 11839              END-IF
 11840           else
 11841              MOVE -1            TO MAINTL
 11842              move er-1671       to emi-error
 11843              PERFORM 9900-ERROR-FORMAT
 11844                                 THRU 9900-EXIT
 11845           END-IF
 11846        END-IF
 11847     END-IF
 11848
 11849     .
 11850 3997-EXIT.
 11851     EXIT.
 11852
 11853 3998-update-cert-claim-trailer.
 11854
 11855
 11856* EXEC CICS GETMAIN
 11857*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 11858*       LENGTH   (ELCRTT-LENGTH)
 11859*       INITIMG  (GETMAIN-SPACE)
 11860*    END-EXEC
 11861*    MOVE ',"IL                  $   #00010958' TO DFHEIV0
 11862     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11863     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11864     MOVE X'2020233030303130393538' TO DFHEIV0(25:11)
 11865     CALL 'kxdfhei1' USING DFHEIV0,
 11866           DFHEIV20,
 11867           ELCRTT-LENGTH,
 11868           GETMAIN-SPACE
 11869     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11870         DFHEIV20
 11871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11872
 11873     MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 11874     MOVE CM-CARRIER       TO CTRLR-CARRIER
 11875     MOVE CM-GROUPING      TO CTRLR-GROUPING
 11876     MOVE CM-STATE         TO CTRLR-STATE
 11877     MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 11878     MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 11879     MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 11880     MOVE 'B'              TO CTRLR-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 224
* EL130.cbl
 11881
 11882* EXEC CICS READ
 11883*       UPDATE
 11884*       DATASET  (ELCRTT-DSID)
 11885*       into     (CERTIFICATE-TRAILERS)
 11886*       RIDFLD   (ELCRTT-KEY)
 11887*       RESP     (WS-RESPONSE)
 11888*    END-EXEC
 11889     MOVE LENGTH OF
 11890      CERTIFICATE-TRAILERS
 11891       TO DFHEIV11
 11892*    MOVE '&"IL       EU         (  N#00010972' TO DFHEIV0
 11893     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11894     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11895     MOVE X'204E233030303130393732' TO DFHEIV0(25:11)
 11896     CALL 'kxdfhei1' USING DFHEIV0,
 11897           ELCRTT-DSID,
 11898           CERTIFICATE-TRAILERS,
 11899           DFHEIV11,
 11900           ELCRTT-KEY,
 11901           DFHEIV99,
 11902           DFHEIV99,
 11903           DFHEIV99
 11904     MOVE EIBRESP  TO WS-RESPONSE
 11905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11906     IF WS-RESP-NORMAL
 11907        perform varying s1 from +1 by +1 until
 11908           (s1 > +24)
 11909           or (cs-claim-no (s1) = spaces)
 11910        end-perform
 11911        if s1 < +25
 11912           perform 3999-upd-crt-trlr thru 3999-exit
 11913
 11914* EXEC CICS REWRITE
 11915*             DATASET  (ELCRTT-DSID)
 11916*             from     (CERTIFICATE-TRAILERS)
 11917*             RESP     (WS-RESPONSE)
 11918*          END-EXEC
 11919     MOVE LENGTH OF
 11920      CERTIFICATE-TRAILERS
 11921       TO DFHEIV11
 11922*    MOVE '&& L                  %  N#00010986' TO DFHEIV0
 11923     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11924     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11925     MOVE X'204E233030303130393836' TO DFHEIV0(25:11)
 11926     CALL 'kxdfhei1' USING DFHEIV0,
 11927           ELCRTT-DSID,
 11928           CERTIFICATE-TRAILERS,
 11929           DFHEIV11,
 11930           DFHEIV99
 11931     MOVE EIBRESP  TO WS-RESPONSE
 11932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11933        end-if
 11934     else
 11935        if ws-resp-notfnd
 11936           move 'CS'             to certificate-trailers
 11937           move cm-control-primary to cs-control-primary
 11938           move 'B'              to cs-trailer-type
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 225
* EL130.cbl
 11939           perform varying s1 from +1 by +1 until s1 > +24
 11940              move zeros         to cs-days-paid (s1)
 11941                                    cs-total-paid (s1)
 11942                                    cs-benefit-period (s1)
 11943                                    cs-remaining-bens (s1)
 11944           end-perform
 11945           move +1               to s1
 11946           perform 3999-upd-crt-trlr
 11947                                 thru 3999-exit
 11948
 11949* EXEC CICS WRITE
 11950*             DATASET  (ELCRTT-DSID)
 11951*             from     (CERTIFICATE-TRAILERS)
 11952*             RIDFLD   (cs-control-primary)
 11953*             RESP     (WS-RESPONSE)
 11954*          END-EXEC
 11955     MOVE LENGTH OF
 11956      CERTIFICATE-TRAILERS
 11957       TO DFHEIV11
 11958*    MOVE '&$ L                  ''  N#00011006' TO DFHEIV0
 11959     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11960     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11961     MOVE X'204E233030303131303036' TO DFHEIV0(25:11)
 11962     CALL 'kxdfhei1' USING DFHEIV0,
 11963           ELCRTT-DSID,
 11964           CERTIFICATE-TRAILERS,
 11965           DFHEIV11,
 11966           cs-control-primary,
 11967           DFHEIV99,
 11968           DFHEIV99
 11969     MOVE EIBRESP  TO WS-RESPONSE
 11970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11971        end-if
 11972     END-IF
 11973
 11974     .
 11975 3998-exit.
 11976     exit.
 11977
 11978 3999-upd-crt-trlr.
 11979     move clmnoi                 to cs-claim-no       (s1)
 11980     move clmtypei               to cs-claim-type     (s1)
 11981     move instypei               to cs-insured-type   (s1)
 11982     if ws-crit-per-recurrent > 01
 11983        move zeros               to cs-benefit-period(s1)
 11984     else
 11985        move 01                  to cs-benefit-period(s1)
 11986     end-if
 11987*    move cl-benefit-period      to cs-benefit-period (s1)
 11988*    move cl-critical-period     to cs-remaining-bens (s1)
 11989     move zeros                  to cs-remaining-bens (s1)
 11990     .
 11991 3999-exit.
 11992     exit.
 11993 4000-CALCULATE-CERT-TERM.
 11994
 11995     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 11996
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 226
* EL130.cbl
 11997     MOVE N                      TO WS-TERM.
 11998
 11999     IF WS-TERM GREATER 120
 12000         MOVE 120                TO WS-TERM
 12001     END-IF.
 12002
 12003 4000-CALC-TERM-EXIT.
 12004      EXIT.
 12005
 12006 4100-CALC-GROSS-TERM.
 12007     MOVE HOLD-LOAN-BAL           TO L.
 12008     MOVE WS-ACVBENE              TO M.
 12009     COMPUTE N = L / M.
 12010     IF N LESS 1
 12011         MOVE 1  TO N
 12012     END-IF.
 12013
 12014     IF LCVCDL GREATER ZERO
 12015         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 12016     ELSE
 12017         MOVE ZEROS               TO WS-LF-RATE
 12018     END-IF.
 12019
 12020     IF ACVCDL GREATER ZERO
 12021         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 12022     ELSE
 12023         MOVE ZEROS               TO WS-AH-RATE
 12024     END-IF.
 12025
 12026     COMPUTE I = WS-APR / +1200.
 12027
 12028 4105-LOOP.
 12029     IF N GREATER 240
 12030         GO TO 4200-EXIT
 12031     END-IF.
 12032
 12033     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 12034
 12035     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 12036         ADD 1 TO N
 12037         GO TO 4105-LOOP
 12038     END-IF.
 12039
 12040 4200-EXIT.
 12041      EXIT.
 12042
 12043 4210-CALC-LEFT-RIGHTONE.
 12044      MOVE L         TO LEFT-TOT-1.
 12045      SUBTRACT 1 FROM N.
 12046      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 12047      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 12048      ADD 1 TO N.
 12049
 12050 4211-CALC-TERM1.
 12051      MOVE N         TO TERM1.
 12052      MULTIPLY M BY TERM1.
 12053
 12054 4212-LOOP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 227
* EL130.cbl
 12055      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 12056      ADD 1 TO A-N.
 12057      MULTIPLY A-N BY TERM1.
 12058      SUBTRACT 1 FROM A-N.
 12059      ADD TERM1 TO LEFT-TOT-1.
 12060
 12061 4213-CALC-TERM2.
 12062      MOVE M         TO TERM2.
 12063      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 12064      MULTIPLY IA-N BY TERM2.
 12065      SUBTRACT TERM2 FROM LEFT-TOT-1.
 12066
 12067 4215-CALC-RIGHTONE.
 12068      MOVE M         TO RIGHT-TOT-1.
 12069      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 12070      MULTIPLY A-N BY RIGHT-TOT-1.
 12071
 12072 4220-EXIT.
 12073      EXIT.
 12074
 12075 4300-CALC-A-N.
 12076     IF N LESS 1
 12077         MOVE 0     TO A-N
 12078         GO TO 4300-EXIT
 12079     END-IF.
 12080
 12081     IF I = 0
 12082         MOVE .00001 TO I
 12083     END-IF.
 12084
 12085     ADD 1 TO I.
 12086     DIVIDE I INTO 1 GIVING V.
 12087     SUBTRACT 1 FROM I.
 12088     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 12089     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 12090     DIVIDE I INTO TERM3 GIVING A-N.
 12091
 12092 4300-EXIT.
 12093      EXIT.
 12094
 12095 4350-CALC-IA-N.
 12096     IF N LESS 1
 12097         MOVE 0      TO IA-N
 12098         GO TO 4400-EXIT
 12099     END-IF.
 12100
 12101     ADD 1 TO N.
 12102     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 12103     SUBTRACT 1 FROM N.
 12104     MULTIPLY N BY V-EX-N GIVING TERM3.
 12105     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 12106     SUBTRACT V FROM 1 GIVING TERM4.
 12107     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 12108
 12109 4400-EXIT.
 12110      EXIT.
 12111
 12112 4450-CALC-V-EX-N.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 228
* EL130.cbl
 12113     IF N LESS 1
 12114         MOVE 1    TO V-EX-N
 12115         GO TO 4490-EXIT
 12116     END-IF.
 12117
 12118     MOVE N        TO NV-STORE.
 12119
 12120     IF V-EX-ONETIME = 1  OR
 12121        V NOT = V-EXPONENT (1)
 12122          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 12123     END-IF.
 12124
 12125 4460-LOOP.
 12126     IF N GREATER 248
 12127         MOVE 248 TO N
 12128     END-IF.
 12129
 12130     IF N = 1
 12131         MOVE V               TO V-EX-N
 12132     ELSE
 12133         MOVE V-EXPONENT (N)  TO V-EX-N
 12134     END-IF.
 12135
 12136     GO TO 4490-EXIT.
 12137
 12138 4470-BUILD-V-EX-TABLE.
 12139     MOVE 2      TO N.
 12140     MOVE V      TO V-EXPONENT (1)
 12141                    V-EX-N.
 12142
 12143 4471-LOOP.
 12144     MULTIPLY V BY V-EX-N.
 12145     MOVE V-EX-N   TO V-EXPONENT (N).
 12146
 12147     ADD 1 TO N.
 12148     IF N LESS 248
 12149         GO TO 4471-LOOP
 12150     END-IF.
 12151
 12152     MOVE NV-STORE     TO N.
 12153     MOVE ZERO         TO V-EX-ONETIME.
 12154
 12155 4480-EXIT.
 12156      EXIT.
 12157
 12158 4490-EXIT.
 12159      EXIT.
 12160
 12161 4500-CALC-NET-TERM.
 12162     MOVE HOLD-LOAN-BAL           TO L.
 12163     MOVE WS-ACVBENE              TO M.
 12164     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 12165
 12166     IF WS-REMAIN GREATER ZERO
 12167         ADD 1 TO N
 12168     END-IF.
 12169
 12170     IF N = 0
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 229
* EL130.cbl
 12171         MOVE 1 TO N
 12172     END-IF.
 12173
 12174 4700-EXIT.
 12175      EXIT.
 12176
 12177 4999-CALC-TERM-EXIT.
 12178     EXIT.
 12179
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 230
* EL130.cbl
 12181 5000-INCURRED-CHANGE.
 12182     IF NOT MODIFY-CAP
 12183         MOVE ER-0070            TO EMI-ERROR
 12184         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12185         MOVE -1                 TO MAINTL
 12186         GO TO 8200-SEND-DATAONLY
 12187     END-IF.
 12188
 12189     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 12190        CLMCARRI     NOT = PI-LAST-CARR        OR
 12191        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 12192        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 12193        PI-INCURR-SW NOT = 'Y'
 12194          GO TO 1000-SHOW-CLAIM
 12195     END-IF.
 12196
 12197     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 12198     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 12199     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 12200
 12201     IF EMI-NO-ERRORS
 12202         GO TO 5000-TRY-TO-BUILD
 12203     END-IF.
 12204
 12205     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 12206        MOVE ER-0433             TO EMI-ERROR
 12207        MOVE -1                  TO MAINTL
 12208        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12209        GO TO 8200-SEND-DATAONLY
 12210     END-IF.
 12211
 12212     IF EIBAID = DFHPF6
 12213         IF EMI-FATAL-CTR NOT EQUAL ZERO
 12214            MOVE ER-0434         TO EMI-ERROR
 12215            MOVE -1              TO MAINTL
 12216            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12217            GO TO 8200-SEND-DATAONLY
 12218         ELSE
 12219            MOVE +1              TO INCURL
 12220            GO TO 5000-TRY-TO-BUILD
 12221         END-IF
 12222     END-IF.
 12223
 12224     GO TO 8200-SEND-DATAONLY.
 12225
 12226 5000-TRY-TO-BUILD.
 12227
 12228     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 12229
 12230     MOVE CLMCARRI               TO MSTR-CARRIER.
 12231
 12232     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 12233     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 12234     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 12235
 12236     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 12237
 12238     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 231
* EL130.cbl
 12239         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 12240     END-IF.
 12241
 12242     IF CL-PURGED-DT NOT = LOW-VALUES
 12243
 12244
 12245* EXEC CICS UNLOCK
 12246*            DATASET   (ELMSTR-DSID)
 12247*        END-EXEC
 12248*    MOVE '&*                    #   #00011285' TO DFHEIV0
 12249     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12250     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12251     MOVE X'2020233030303131323835' TO DFHEIV0(25:11)
 12252     CALL 'kxdfhei1' USING DFHEIV0,
 12253           ELMSTR-DSID,
 12254           DFHEIV99
 12255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12256         MOVE ER-7691            TO EMI-ERROR
 12257         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12258         MOVE -1                 TO MAINTL
 12259         GO TO 8200-SEND-DATAONLY
 12260     END-IF.
 12261
 12262     IF CL-AUTO-PAY-SEQ NOT = ZERO
 12263
 12264
 12265* EXEC CICS UNLOCK
 12266*            DATASET   (ELMSTR-DSID)
 12267*       END-EXEC
 12268*    MOVE '&*                    #   #00011296' TO DFHEIV0
 12269     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12270     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12271     MOVE X'2020233030303131323936' TO DFHEIV0(25:11)
 12272     CALL 'kxdfhei1' USING DFHEIV0,
 12273           ELMSTR-DSID,
 12274           DFHEIV99
 12275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12276         MOVE ER-0523             TO EMI-ERROR
 12277         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12278         MOVE -1                  TO MAINTL
 12279         GO TO 8200-SEND-DATAONLY
 12280     END-IF.
 12281
 12282     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 12283
 12284     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 12285     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 12286     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 12287     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 12288     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 12289
 12290     IF MANRSVL GREATER ZERO
 12291        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 12292                                    AT-CURRENT-MANUAL-RESERVE
 12293     END-IF.
 12294     MOVE 1                      TO SUB.
 12295
 12296 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 232
* EL130.cbl
 12297     IF SUB = 1
 12298        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 12299        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 12300        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 12301     ELSE
 12302        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 12303        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 12304                                    AT-OPEN-CLOSE-REASON (SUB)
 12305     END-IF.
 12306
 12307     IF SUB NOT = 6
 12308        ADD 1                    TO SUB
 12309        GO TO 5010-LOOP
 12310     END-IF.
 12311
 12312 5020-UPDATE.
 12313
 12314     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12315
 12316     IF DIAGL = ZERO
 12317       AND ICD1L = ZERO
 12318       AND ICD2L = ZERO
 12319         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 12320         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 12321         MOVE AT-ICD-CODE-1      TO WS-ICD-CODE-1
 12322         MOVE AT-ICD-CODE-2      TO WS-ICD-CODE-2
 12323         GO TO 5025-BYPASS-UPDATE
 12324     END-IF.
 12325
 12326     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 12327
 12328     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 12329     IF DIAGL NOT = ZERO
 12330         MOVE DIAGI              TO AT-INFO-LINE-1
 12331     END-IF.
 12332
 12333     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
 12334     IF ICD1L NOT = ZERO
 12335         MOVE ICD1I              TO AT-ICD-CODE-1
 12336     END-IF.
 12337
 12338     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
 12339     IF ICD2L NOT = ZERO
 12340         MOVE ICD2I              TO AT-ICD-CODE-2
 12341     END-IF.
 12342
 12343     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12344
 12345 5025-BYPASS-UPDATE.
 12346
 12347
 12348
 12349* EXEC CICS GETMAIN
 12350*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12351*        LENGTH   (ELTRLR-LENGTH)
 12352*    END-EXEC.
 12353*    MOVE '," L                  $   #00011371' TO DFHEIV0
 12354     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 233
* EL130.cbl
 12355     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12356     MOVE X'2020233030303131333731' TO DFHEIV0(25:11)
 12357     CALL 'kxdfhei1' USING DFHEIV0,
 12358           DFHEIV20,
 12359           ELTRLR-LENGTH,
 12360           DFHEIV99
 12361     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12362         DFHEIV20
 12363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12364
 12365
 12366     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 12367     MOVE 'AT'                   TO AT-RECORD-ID.
 12368
 12369     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 12370     MOVE MSTR-CARRIER           TO AT-CARRIER.
 12371     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 12372     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 12373     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 12374     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 12375     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12376     MOVE '9'                    TO AT-TRAILER-TYPE.
 12377     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 12378     MOVE '5'                    TO DC-OPTION-CODE.
 12379     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12380     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 12381
 12382     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 12383     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12384
 12385     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 12386     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 12387     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 12388     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 12389     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 12390     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 12391     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 12392     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 12393     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 12394     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 12395     MOVE WS-ICD-CODE-1          TO AT-OLD-ICD-CODE-1.
 12396     MOVE WS-ICD-CODE-2          TO AT-OLD-ICD-CODE-2.
 12397
 12398     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 12399     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 12400     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 12401     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 12402     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 12403
 12404
 12405
 12406* EXEC CICS WRITE
 12407*        DATASET   (ELTRLR-DSID)
 12408*        FROM      (ACTIVITY-TRAILERS)
 12409*        RIDFLD    (AT-CONTROL-PRIMARY)
 12410*    END-EXEC.
 12411     MOVE LENGTH OF
 12412      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 234
* EL130.cbl
 12413       TO DFHEIV11
 12414*    MOVE '&$ L                  ''   #00011415' TO DFHEIV0
 12415     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12416     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12417     MOVE X'2020233030303131343135' TO DFHEIV0(25:11)
 12418     CALL 'kxdfhei1' USING DFHEIV0,
 12419           ELTRLR-DSID,
 12420           ACTIVITY-TRAILERS,
 12421           DFHEIV11,
 12422           AT-CONTROL-PRIMARY,
 12423           DFHEIV99,
 12424           DFHEIV99
 12425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12426
 12427
 12428     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12429     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12430     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 12431     MOVE CL-CERT-STATE          TO CERT-STATE.
 12432     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12433     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 12434     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 12435
 12436
 12437
 12438* EXEC CICS HANDLE CONDITION
 12439*        NOTFND   (5050-CERT-NOT-FOUND)
 12440*    END-EXEC.
 12441*    MOVE '"$I                   ! < #00011430' TO DFHEIV0
 12442     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12443     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12444     MOVE X'3C20233030303131343330' TO DFHEIV0(25:11)
 12445     CALL 'kxdfhei1' USING DFHEIV0
 12446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12447
 12448
 12449     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 12450
 12451     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 12452
 12453
 12454
 12455* EXEC CICS HANDLE CONDITION
 12456*         DUPKEY   (5030-CERT-WRITTEN)
 12457*    END-EXEC.
 12458*    MOVE '"$$                   ! = #00011439' TO DFHEIV0
 12459     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12460     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12461     MOVE X'3D20233030303131343339' TO DFHEIV0(25:11)
 12462     CALL 'kxdfhei1' USING DFHEIV0
 12463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12464
 12465
 12466
 12467
 12468* EXEC CICS REWRITE
 12469*        DATASET  (ELCERT-DSID)
 12470*        FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 235
* EL130.cbl
 12471*    END-EXEC.
 12472     MOVE LENGTH OF
 12473      CERTIFICATE-MASTER
 12474       TO DFHEIV11
 12475*    MOVE '&& L                  %   #00011444' TO DFHEIV0
 12476     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12477     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12478     MOVE X'2020233030303131343434' TO DFHEIV0(25:11)
 12479     CALL 'kxdfhei1' USING DFHEIV0,
 12480           ELCERT-DSID,
 12481           CERTIFICATE-MASTER,
 12482           DFHEIV11,
 12483           DFHEIV99
 12484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12485
 12486
 12487 5030-CERT-WRITTEN.
 12488
 12489     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 12490                                    CL-INCURRED-DT
 12491                                    CL-REPORTED-DT
 12492                                    CL-EST-END-OF-DISAB-DT
 12493                                    CL-PAID-THRU-DT.
 12494
 12495     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 12496                                    CL-NO-OF-PMTS-MADE
 12497                                    CL-NO-OF-DAYS-PAID.
 12498
 12499     IF CLAIM-IS-CLOSED
 12500        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 12501        MOVE 'O'                 TO CL-CLAIM-STATUS
 12502     END-IF.
 12503
 12504     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 12505     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 12506     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 12507
 12508
 12509
 12510* EXEC CICS HANDLE CONDITION
 12511*         DUPKEY   (5035-CLAIM-WRITTEN)
 12512*    END-EXEC.
 12513*    MOVE '"$$                   ! > #00011471' TO DFHEIV0
 12514     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12515     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12516     MOVE X'3E20233030303131343731' TO DFHEIV0(25:11)
 12517     CALL 'kxdfhei1' USING DFHEIV0
 12518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12519
 12520
 12521
 12522
 12523* EXEC CICS REWRITE
 12524*        DATASET   (ELMSTR-DSID)
 12525*        FROM      (CLAIM-MASTER)
 12526*    END-EXEC.
 12527     MOVE LENGTH OF
 12528      CLAIM-MASTER
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 236
* EL130.cbl
 12529       TO DFHEIV11
 12530*    MOVE '&& L                  %   #00011476' TO DFHEIV0
 12531     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12532     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12533     MOVE X'2020233030303131343736' TO DFHEIV0(25:11)
 12534     CALL 'kxdfhei1' USING DFHEIV0,
 12535           ELMSTR-DSID,
 12536           CLAIM-MASTER,
 12537           DFHEIV11,
 12538           DFHEIV99
 12539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12540
 12541
 12542 5035-CLAIM-WRITTEN.
 12543
 12544     MOVE ER-0000                TO EMI-ERROR.
 12545     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12546
 12547     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 12548     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 12549     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 12550     MOVE CLMCARRI               TO PI-LAST-CARR.
 12551
 12552     IF PRTOPTL GREATER ZERO
 12553         MOVE PRTOPTI            TO PI-PRT-OPT
 12554     END-IF.
 12555
 12556     IF ALTPRTL GREATER ZERO
 12557         MOVE ALTPRTI            TO PI-ALT-PRT
 12558     END-IF.
 12559
 12560     MOVE LOW-VALUES             TO EL130AI.
 12561
 12562     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 12563     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 12564     MOVE PI-LAST-CARR           TO CLMCARRO.
 12565     MOVE PI-LAST-CLAIM          TO CLMNOO.
 12566
 12567     IF PI-PRT-OPT = 'N' OR 'L'
 12568         MOVE PI-PRT-OPT         TO PRTOPTO
 12569         MOVE 1                  TO PRTOPTL
 12570     END-IF.
 12571
 12572     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 12573         MOVE PI-ALT-PRT         TO ALTPRTO
 12574         MOVE 4                  TO ALTPRTL
 12575     END-IF.
 12576
 12577     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 12578     MOVE AL-SANON               TO CERTNOA SUFXA.
 12579
 12580     MOVE SPACES                 TO PI-INCURR-SW.
 12581
 12582     IF PRTOPTL GREATER ZERO
 12583         IF PRTOPTI = 'L'
 12584             GO TO 0400-CREATE-ELACTQ
 12585         ELSE
 12586             GO TO 0480-PRINT-NOW
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 237
* EL130.cbl
 12587         END-IF
 12588     END-IF.
 12589
 12590     GO TO 8100-SEND-INITIAL-MAP.
 12591
 12592 5050-CERT-NOT-FOUND.
 12593
 12594     MOVE ER-0244                TO EMI-ERROR.
 12595     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12596     MOVE -1                     TO CERTNOL.
 12597     GO TO 8200-SEND-DATAONLY.
 12598
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 238
* EL130.cbl
 12600 5500-BUILD-FORM-TRAILER.
 12601*************************************************************
 12602*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12603*************************************************************
 12604
 12605     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 12606
 12607     IF  WS-BEN-ALPHA-2 = '30'
 12608         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 12609         MOVE '6'                TO DC-OPTION-CODE
 12610         IF CL-CARRIER = 'C'
 12611             MOVE +14            TO DC-ELAPSED-DAYS
 12612             MOVE +0             TO DC-ELAPSED-MONTHS
 12613             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12614             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 12615         ELSE
 12616             MOVE +21            TO DC-ELAPSED-DAYS
 12617             MOVE +0             TO DC-ELAPSED-MONTHS
 12618             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12619             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 12620         END-IF
 12621     END-IF.
 12622
 12623
 12624
 12625* EXEC CICS GETMAIN
 12626*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12627*         LENGTH   (ELTRLR-LENGTH)
 12628*         INITIMG  (GETMAIN-SPACE)
 12629*    END-EXEC.
 12630*    MOVE ',"IL                  $   #00011563' TO DFHEIV0
 12631     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12632     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12633     MOVE X'2020233030303131353633' TO DFHEIV0(25:11)
 12634     CALL 'kxdfhei1' USING DFHEIV0,
 12635           DFHEIV20,
 12636           ELTRLR-LENGTH,
 12637           GETMAIN-SPACE
 12638     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12639         DFHEIV20
 12640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12641
 12642
 12643     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 12644     MOVE 'AT'                   TO AT-RECORD-ID.
 12645
 12646     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 12647     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12648     MOVE 'A'                    TO AT-TRAILER-TYPE.
 12649     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 12650                                    AT-FORM-LAST-MAINT-DT.
 12651     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 12652                                    AT-FORM-LAST-UPDATED-BY.
 12653     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12654     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 12655     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 12656                                    AT-FORM-RE-SEND-DT
 12657                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 239
* EL130.cbl
 12658                                    AT-EMP-FORM-ANSWERED-DT
 12659                                    AT-PHY-FORM-ANSWERED-DT
 12660                                    AT-EMP-FORM-SEND-ON-DT
 12661                                    AT-FORM-PRINTED-DT
 12662                                    AT-FORM-REPRINT-DT.
 12663     MOVE '1'                    TO AT-FORM-TYPE.
 12664
 12665     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 12666                                    AT-INSTRUCT-LN-2
 12667                                    AT-INSTRUCT-LN-3.
 12668
 12669     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 12670     MOVE 'I'                    TO AT-FORM-ADDRESS.
 12671
 12672     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 12673
 12674     IF AM-EMPLOYER-STMT-USED = 'Y'
 12675        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 12676     END-IF.
 12677
 12678
 12679
 12680* EXEC CICS WRITE
 12681*         DATASET  (ELTRLR-DSID)
 12682*         FROM     (ACTIVITY-TRAILERS)
 12683*         RIDFLD   (AT-CONTROL-PRIMARY)
 12684*    END-EXEC.
 12685     MOVE LENGTH OF
 12686      ACTIVITY-TRAILERS
 12687       TO DFHEIV11
 12688*    MOVE '&$ L                  ''   #00011605' TO DFHEIV0
 12689     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12690     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12691     MOVE X'2020233030303131363035' TO DFHEIV0(25:11)
 12692     CALL 'kxdfhei1' USING DFHEIV0,
 12693           ELTRLR-DSID,
 12694           ACTIVITY-TRAILERS,
 12695           DFHEIV11,
 12696           AT-CONTROL-PRIMARY,
 12697           DFHEIV99,
 12698           DFHEIV99
 12699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12700
 12701
 12702 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 240
* EL130.cbl
 12704*************************************************************
 12705*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12706*************************************************************
 12707
 12708 5700-BUILD-ARCHIVE-HEADER.
 12709
 12710     MOVE '1'                    TO CNTL-REC-TYPE.
 12711     MOVE ZEROS                  TO CNTL-SEQ-NO.
 12712     MOVE SPACES                 TO CNTL-ACCESS.
 12713
 12714
 12715
 12716* EXEC CICS READ
 12717*         DATASET  (ELCNTL-DSID)
 12718*         SET      (ADDRESS OF CONTROL-FILE)
 12719*         RIDFLD   (ELCNTL-KEY)
 12720*         UPDATE
 12721*    END-EXEC.
 12722*    MOVE '&"S        EU         (   #00011624' TO DFHEIV0
 12723     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12724     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12725     MOVE X'2020233030303131363234' TO DFHEIV0(25:11)
 12726     CALL 'kxdfhei1' USING DFHEIV0,
 12727           ELCNTL-DSID,
 12728           DFHEIV20,
 12729           DFHEIV99,
 12730           ELCNTL-KEY,
 12731           DFHEIV99,
 12732           DFHEIV99,
 12733           DFHEIV99
 12734     SET ADDRESS OF CONTROL-FILE TO
 12735         DFHEIV20
 12736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12737
 12738
 12739     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 12740
 12741     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 12742
 12743
 12744
 12745* EXEC CICS REWRITE
 12746*         FROM     (CONTROL-FILE)
 12747*         DATASET  (ELCNTL-DSID)
 12748*    END-EXEC.
 12749     MOVE LENGTH OF
 12750      CONTROL-FILE
 12751       TO DFHEIV11
 12752*    MOVE '&& L                  %   #00011636' TO DFHEIV0
 12753     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12754     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12755     MOVE X'2020233030303131363336' TO DFHEIV0(25:11)
 12756     CALL 'kxdfhei1' USING DFHEIV0,
 12757           ELCNTL-DSID,
 12758           CONTROL-FILE,
 12759           DFHEIV11,
 12760           DFHEIV99
 12761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 241
* EL130.cbl
 12762
 12763
 12764
 12765
 12766* EXEC CICS HANDLE CONDITION
 12767*         NOTOPEN  (9990-ABEND)
 12768*         DUPKEY   (5799-EXIT)
 12769*    END-EXEC.
 12770*    MOVE '"$J$                  ! ? #00011642' TO DFHEIV0
 12771     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 12772     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12773     MOVE X'3F20233030303131363432' TO DFHEIV0(25:11)
 12774     CALL 'kxdfhei1' USING DFHEIV0
 12775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12776
 12777
 12778
 12779
 12780* EXEC CICS GETMAIN
 12781*         SET     (ADDRESS OF LETTER-ARCHIVE)
 12782*         LENGTH  (ELARCH-LENGTH)
 12783*    END-EXEC.
 12784*    MOVE '," L                  $   #00011648' TO DFHEIV0
 12785     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12786     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12787     MOVE X'2020233030303131363438' TO DFHEIV0(25:11)
 12788     CALL 'kxdfhei1' USING DFHEIV0,
 12789           DFHEIV20,
 12790           ELARCH-LENGTH,
 12791           DFHEIV99
 12792     SET ADDRESS OF LETTER-ARCHIVE TO
 12793         DFHEIV20
 12794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12795
 12796
 12797     MOVE SPACES                 TO LETTER-ARCHIVE.
 12798     MOVE 'LA'                   TO LA-RECORD-ID.
 12799     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 12800                                    LA-ARCHIVE-NO-A1.
 12801     MOVE '4'                    TO LA-RECORD-TYPE
 12802                                    LA-RECORD-TYPE-A1.
 12803     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 12804                                    LA-LINE-SEQ-NO-A1.
 12805     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 12806                                    LA-COMPANY-CD-A1.
 12807     MOVE CL-CARRIER             TO LA4-CARRIER.
 12808     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 12809     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 12810     MOVE CL-CERT-STATE          TO LA4-STATE.
 12811     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 12812     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 12813     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 12814     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 12815                                    LA4-RESEND-PRINT-DATE
 12816                                    LA4-FORM-REM-PRINT-DT
 12817                                    LA4-RESEND-DATE.
 12818     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 12819     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 242
* EL130.cbl
 12820
 12821
 12822
 12823* EXEC CICS WRITE
 12824*         DATASET  (ELARCH-DSID)
 12825*         FROM     (LETTER-ARCHIVE)
 12826*         RIDFLD   (LA-CONTROL-PRIMARY)
 12827*    END-EXEC.
 12828     MOVE LENGTH OF
 12829      LETTER-ARCHIVE
 12830       TO DFHEIV11
 12831*    MOVE '&$ L                  ''   #00011678' TO DFHEIV0
 12832     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12833     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12834     MOVE X'2020233030303131363738' TO DFHEIV0(25:11)
 12835     CALL 'kxdfhei1' USING DFHEIV0,
 12836           ELARCH-DSID,
 12837           LETTER-ARCHIVE,
 12838           DFHEIV11,
 12839           LA-CONTROL-PRIMARY,
 12840           DFHEIV99,
 12841           DFHEIV99
 12842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12843
 12844
 12845 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 243
* EL130.cbl
 12847 6000-EDIT-CLAIM-DATA.
 12848
 12849     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 12850     MOVE '2'                    TO DC-OPTION-CODE.
 12851     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12852     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 12853
 12854     IF MAINTL NOT = ZERO
 12855         MOVE AL-UANON           TO MAINTA
 12856     END-IF
 12857
 12858     IF CLMNOL GREATER ZERO
 12859         IF CLMNOI = SPACES OR LOW-VALUES
 12860             MOVE -1             TO CLMNOL
 12861             MOVE AL-UABON       TO CLMNOA
 12862             MOVE ER-7688        TO EMI-ERROR
 12863             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12864         ELSE
 12865             MOVE AL-UANON       TO CLMNOA
 12866         END-IF
 12867     END-IF.
 12868
 12869     IF CERTNOL = ZERO
 12870         MOVE -1                 TO CERTNOL
 12871         MOVE AL-SABON           TO CERTNOA
 12872         MOVE ER-0203            TO EMI-ERROR
 12873         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12874     ELSE
 12875         MOVE AL-SANON           TO CERTNOA
 12876     END-IF.
 12877
 12878     IF SUFXL = ZERO
 12879         MOVE SPACES             TO SUFXI
 12880         MOVE AL-SANON           TO SUFXA
 12881     ELSE
 12882         MOVE AL-SANON           TO SUFXA
 12883     END-IF.
 12884
 12885     IF CLMCARRL = ZERO
 12886         MOVE -1                 TO CLMCARRL
 12887         MOVE ER-0194            TO EMI-ERROR
 12888         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12889     ELSE
 12890         MOVE CLMCARRI           TO PI-CARRIER
 12891         IF PI-NO-CARRIER-SECURITY
 12892             MOVE AL-UANON       TO CLMCARRA
 12893         END-IF
 12894     END-IF.
 12895
 12896     IF CLMTYPEL > ZERO
 12897        IF ((PI-COMPANY-ID = 'DCC' OR 'VPP')
 12898           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12899              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G' AND 'F'))
 12900                        OR
 12901           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 12902           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12903              AND PI-AH-OVERRIDE-L1))
 12904              MOVE -1             TO CLMTYPEL
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 244
* EL130.cbl
 12905              MOVE AL-UABON       TO CLMTYPEA
 12906              MOVE ER-7634        TO EMI-ERROR
 12907              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12908        ELSE
 12909           MOVE AL-UANON       TO CLMTYPEA
 12910        END-IF
 12911     ELSE
 12912        IF MAINTI = 'A'
 12913           MOVE -1             TO CLMTYPEL
 12914           MOVE AL-UABON       TO CLMTYPEA
 12915           MOVE ER-0546        TO EMI-ERROR
 12916           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12917        END-IF
 12918     END-IF
 12919     if instypel > ZERO
 12920        if instypei = 'P' OR 'C'
 12921           move al-uanon         to instypea
 12922        else
 12923           MOVE -1               TO INSTYPEL
 12924           MOVE AL-UABON         TO INSTYPEA
 12925           MOVE ER-1654          TO EMI-ERROR
 12926           PERFORM 9900-ERROR-FORMAT
 12927                                 THRU 9900-EXIT
 12928        END-IF
 12929     ELSE
 12930        IF MAINTI = 'A'
 12931           MOVE -1               TO INSTYPEL
 12932           MOVE AL-UABON         TO INSTYPEA
 12933           MOVE ER-1654          TO EMI-ERROR
 12934           PERFORM 9900-ERROR-FORMAT
 12935                                 THRU 9900-EXIT
 12936        END-IF
 12937     END-IF
 12938     if (instypel <> zeros)
 12939        and (emi-error not = er-1654)
 12940        and (instypei = 'C')
 12941        and (crtfnmei = fstnmei)
 12942        move er-1675             to emi-error
 12943        MOVE -1                  TO INSTYPEL
 12944        MOVE AL-UABON            TO INSTYPEA
 12945        PERFORM 9900-ERROR-FORMAT
 12946                                 THRU 9900-EXIT
 12947    end-if
 12948     if (instypel <> zeros)
 12949        and (emi-error not = er-1654)
 12950        and (instypei = 'P')
 12951        and (crtfnmei <> fstnmei)
 12952        move er-1676             to emi-error
 12953        MOVE -1                  TO INSTYPEL
 12954        MOVE AL-UABON            TO INSTYPEA
 12955        PERFORM 9900-ERROR-FORMAT
 12956                                 THRU 9900-EXIT
 12957    end-if
 12958     IF PCERTNOL = ZERO
 12959        MOVE CERTNOI             TO PCERTNOI
 12960        MOVE CERTNOL             TO PCERTNOL
 12961        MOVE AL-UANON            TO PCERTNOA
 12962     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 245
* EL130.cbl
 12963        MOVE AL-UANON            TO PCERTNOA
 12964     END-IF.
 12965
 12966     IF PSUFXL = ZERO
 12967        MOVE SUFXI               TO PSUFXI
 12968        MOVE SUFXL               TO PSUFXL
 12969        MOVE AL-UANON            TO PSUFXA
 12970     ELSE
 12971        MOVE AL-UANON            TO PSUFXA
 12972     END-IF.
 12973
 12974     IF MAINTI = 'I'
 12975         GO TO 6020-EDIT
 12976     END-IF.
 12977
 12978     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 12979         MOVE -1                 TO LSTNMEL
 12980         MOVE ER-0236            TO EMI-ERROR
 12981         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12982     ELSE
 12983         MOVE AL-UANON           TO LSTNMEA
 12984     END-IF.
 12985     if fstnmel not = zeros
 12986        move al-uanon            to fstnmea
 12987     end-if
 12988     IF SEXL > ZEROS
 12989        IF SEXI = 'M' OR 'F'
 12990           move al-uanon         to sexa
 12991           CONTINUE
 12992        ELSE
 12993           MOVE -1               TO SEXL
 12994           MOVE AL-UABON         TO SEXA
 12995           MOVE ER-0219          TO EMI-ERROR
 12996           PERFORM 9900-ERROR-FORMAT
 12997                                 THRU 9900-EXIT
 12998        END-IF
 12999     ELSE
 13000        IF MAINTI = 'A'
 13001           MOVE -1               TO SEXL
 13002           MOVE AL-UABON         TO SEXA
 13003           MOVE ER-0219          TO EMI-ERROR
 13004           PERFORM 9900-ERROR-FORMAT
 13005                                 THRU 9900-EXIT
 13006        END-IF
 13007     END-IF
 13008     IF SSNL GREATER THAN ZERO
 13009         MOVE SSNI TO WS-SOC-SEC-NUMBER
 13010         IF WS-SOC-SEC-NO NUMERIC AND
 13011           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 13012             NEXT SENTENCE
 13013         ELSE
 13014            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 13015               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 13016               WS-SSN-DASH2 = '-'
 13017                 NEXT SENTENCE
 13018            ELSE
 13019                 MOVE ER-0887        TO  EMI-ERROR
 13020                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 246
* EL130.cbl
 13021                 MOVE AL-UABON       TO  SSNA
 13022                 MOVE -1             TO  SSNL
 13023            END-IF
 13024        END-IF
 13025     END-IF.
 13026
 13027     IF BIRTHDTL = ZERO
 13028         GO TO 6020-EDIT
 13029     END-IF.
 13030
 13031     IF BIRTHDTL GREATER ZERO
 13032         MOVE BIRTHDTI           TO DATE-WORK
 13033         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13034         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13035         MOVE '4'                TO DC-OPTION-CODE
 13036         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13037         IF DATE-CONVERSION-ERROR
 13038             MOVE AL-UABON       TO BIRTHDTA
 13039             MOVE -1             TO BIRTHDTL
 13040             MOVE ER-0220        TO EMI-ERROR
 13041             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13042             GO TO 6020-EDIT
 13043         END-IF
 13044     END-IF.
 13045
 13046******************************************************************
 13047**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 13048**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 13049**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 13050******************************************************************
 13051
 13052     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 13053         MOVE BIRTHDTI           TO  DATE-WORK
 13054         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13055         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 13056         MOVE '4'                TO  DC-OPTION-CODE
 13057         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 13058         MOVE +0                 TO  DC-ELAPSED-MONTHS
 13059                                     DC-ELAPSED-DAYS
 13060         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13061         IF DATE-CONVERSION-ERROR
 13062             MOVE AL-UABON       TO  BIRTHDTA
 13063             MOVE -1             TO  BIRTHDTL
 13064             MOVE ER-0220        TO  EMI-ERROR
 13065             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13066             GO TO 6020-EDIT
 13067         END-IF
 13068     END-IF.
 13069
 13070     MOVE AL-UANON               TO  BIRTHDTA.
 13071     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 13072     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 13073     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 13074
 13075 6020-EDIT.
 13076     IF INCURL GREATER ZERO
 13077         MOVE INCURI             TO DATE-WORK
 13078         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 247
* EL130.cbl
 13079         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13080         MOVE '4'                TO DC-OPTION-CODE
 13081         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13082         IF DATE-CONVERSION-ERROR
 13083             MOVE AL-UABON       TO INCURA
 13084             MOVE -1             TO INCURL
 13085             MOVE ER-0222        TO EMI-ERROR
 13086             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13087         ELSE
 13088             MOVE AL-UANON       TO INCURA
 13089             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 13090             MOVE DC-BIN-DATE-1  TO WS-INCUR
 13091                                    PI-SAVE-INCUR-DT
 13092             IF WS-INCUR GREATER THAN WS-TODAY-DT
 13093                 MOVE ER-0511     TO EMI-ERROR
 13094                 MOVE -1          TO INCURL
 13095                 MOVE AL-UABON    TO INCURA
 13096                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13097             ELSE
 13098*                NEXT SENTENCE
 13099                 CONTINUE
 13100             END-IF
 13101         END-IF
 13102     ELSE
 13103         MOVE ER-0516         TO EMI-ERROR
 13104         MOVE AL-UABON        TO INCURA
 13105         MOVE -1              TO INCURL
 13106         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13107     END-IF.
 13108
 13109     IF REPORTL GREATER ZERO
 13110         MOVE REPORTI            TO DATE-WORK
 13111         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13112         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13113         MOVE '4'                TO DC-OPTION-CODE
 13114         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13115         IF DATE-CONVERSION-ERROR
 13116             MOVE AL-UABON       TO REPORTA
 13117             MOVE -1             TO REPORTL
 13118             MOVE ER-0223        TO EMI-ERROR
 13119             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13120         ELSE
 13121             MOVE AL-UANON       TO REPORTA
 13122             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 13123             MOVE DC-BIN-DATE-1  TO WS-REPORT
 13124             IF WS-REPORT GREATER THAN WS-TODAY-DT
 13125                 MOVE ER-0512     TO EMI-ERROR
 13126                 MOVE -1          TO REPORTL
 13127                 MOVE AL-UABON    TO REPORTA
 13128                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13129             ELSE
 13130*                NEXT SENTENCE
 13131                 CONTINUE
 13132             END-IF
 13133         END-IF
 13134     ELSE
 13135         MOVE ER-0517         TO EMI-ERROR
 13136         MOVE -1              TO REPORTL
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 248
* EL130.cbl
 13137         MOVE AL-UABON        TO REPORTA
 13138         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13139     END-IF.
 13140
 13141     IF WS-REPORT NOT = LOW-VALUES
 13142         IF WS-INCUR GREATER THAN WS-REPORT
 13143             MOVE AL-UABON       TO REPORTA
 13144             MOVE -1             TO REPORTL
 13145             MOVE ER-0509        TO EMI-ERROR
 13146             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13147         END-IF
 13148     END-IF.
 13149
 13150     IF ICD1L GREATER THAN ZERO
 13151         IF (ICD1I GREATER THAN SPACES) AND
 13152            (ICD1I(4:1) NOT = '.')
 13153             IF ICD1I(4:1) = ' '
 13154                 MOVE '.' TO ICD1I(4:1)
 13155             ELSE
 13156                 IF ICD1I(8:1) = ' '
 13157                     MOVE ICD1I(7:1) TO ICD1I(8:1)
 13158                     MOVE ICD1I(6:1) TO ICD1I(7:1)
 13159                     MOVE ICD1I(5:1) TO ICD1I(6:1)
 13160                     MOVE ICD1I(4:1) TO ICD1I(5:1)
 13161                     MOVE '.'        TO ICD1I(4:1)
 13162                 END-IF
 13163             END-IF
 13164         END-IF
 13165         IF (ICD1I GREATER THAN SPACES) AND
 13166            (ICD1I(1:1) NOT > ' ' OR
 13167             ICD1I(2:1) NOT > ' ' OR
 13168             ICD1I(3:1) NOT > ' ' OR
 13169             ICD1I(4:1) NOT = '.')
 13170              MOVE ER-0992        TO  EMI-ERROR
 13171              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13172              MOVE AL-UABON       TO ICD1A
 13173              MOVE -1             TO ICD1L
 13174         END-IF
 13175     END-IF.
 13176
 13177     IF ICD2L GREATER THAN ZERO
 13178         IF (ICD2I GREATER THAN SPACES) AND
 13179            (ICD2I(4:1) NOT = '.')
 13180             IF ICD2I(4:1) = ' '
 13181                 MOVE '.' TO ICD2I(4:1)
 13182             ELSE
 13183                 IF ICD2I(8:1) = ' '
 13184                     MOVE ICD2I(7:1) TO ICD2I(8:1)
 13185                     MOVE ICD2I(6:1) TO ICD2I(7:1)
 13186                     MOVE ICD2I(5:1) TO ICD2I(6:1)
 13187                     MOVE ICD2I(4:1) TO ICD2I(5:1)
 13188                     MOVE '.'        TO ICD2I(4:1)
 13189                 END-IF
 13190             END-IF
 13191         END-IF
 13192         IF (ICD2I GREATER THAN SPACES) AND
 13193            (ICD2I(1:1) NOT > ' ' OR
 13194             ICD2I(2:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 249
* EL130.cbl
 13195             ICD2I(3:1) NOT > ' ' OR
 13196             ICD2I(4:1) NOT = '.')
 13197              MOVE ER-0992        TO  EMI-ERROR
 13198              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13199              MOVE AL-UABON       TO ICD2A
 13200              MOVE -1             TO ICD2L
 13201         END-IF
 13202     END-IF
 13203
 13204*    IF ESTENDL GREATER ZERO
 13205*        MOVE ESTENDI            TO DATE-WORK
 13206*        PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13207*        MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13208*        MOVE '4'                TO DC-OPTION-CODE
 13209*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13210*        IF DATE-CONVERSION-ERROR
 13211*            MOVE AL-UABON       TO ESTENDA
 13212*            MOVE -1             TO ESTENDL
 13213*            MOVE ER-0224        TO EMI-ERROR
 13214*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13215*        ELSE
 13216*            MOVE AL-UANON       TO ESTENDA
 13217*            MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 13218*            MOVE DC-BIN-DATE-1  TO WS-ESTEND
 13219*            IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13220*               MOVE AL-UABON    TO ESTENDA
 13221*               MOVE -1          TO ESTENDL
 13222*               MOVE ER-0544     TO EMI-ERROR
 13223*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13224*            END-IF
 13225*        END-IF
 13226*    END-IF.
 13227*
 13228*    IF WS-ESTEND NOT = LOW-VALUES
 13229*        IF WS-INCUR GREATER THAN WS-ESTEND
 13230*            MOVE AL-UABON       TO ESTENDA
 13231*            MOVE -1             TO ESTENDL
 13232*            MOVE ER-0510        TO EMI-ERROR
 13233*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13234*        END-IF
 13235*    END-IF.
 13236
 13237     IF PRTOPTL GREATER ZERO
 13238         IF PRTOPTI NOT = 'N' AND 'L'
 13239             MOVE AL-UABON       TO PRTOPTA
 13240             MOVE -1             TO PRTOPTL
 13241             MOVE ER-0334        TO EMI-ERROR
 13242             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13243         END-IF
 13244     END-IF.
 13245
 13246     IF MANRSVL GREATER ZERO
 13247
 13248* EXEC CICS BIF DEEDIT
 13249*            FIELD   (MANRSVI)
 13250*            LENGTH  (9)
 13251*        END-EXEC
 13252     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 250
* EL130.cbl
 13253       TO DFHEIV11
 13254*    MOVE '@"L                   #   #00012086' TO DFHEIV0
 13255     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13256     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13257     MOVE X'2020233030303132303836' TO DFHEIV0(25:11)
 13258     CALL 'kxdfhei1' USING DFHEIV0,
 13259           MANRSVI,
 13260           DFHEIV11
 13261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13262         IF MANRSVI NOT NUMERIC
 13263             MOVE AL-UNBON       TO MANRSVA
 13264             MOVE -1             TO MANRSVL
 13265             MOVE ER-0489        TO EMI-ERROR
 13266             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13267         ELSE
 13268             MOVE AL-UNNON       TO MANRSVA
 13269             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 13270         END-IF
 13271     END-IF.
 13272
 13273     MOVE SPACES                 TO ELCNTL-KEY.
 13274
 13275     IF CONTROL-IS-ACTUAL-CARRIER
 13276         MOVE PI-CARRIER         TO CNTL-CARRIER
 13277     ELSE
 13278         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 13279     END-IF.
 13280
 13281     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13282     MOVE '6'                    TO CNTL-REC-TYPE.
 13283     MOVE +0                     TO CNTL-SEQ-NO.
 13284
 13285
 13286
 13287* EXEC CICS HANDLE CONDITION
 13288*        NOTFND   (3100-CARRIER-NOT-FOUND)
 13289*    END-EXEC.
 13290*    MOVE '"$I                   ! @ #00012114' TO DFHEIV0
 13291     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13292     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13293     MOVE X'4020233030303132313134' TO DFHEIV0(25:11)
 13294     CALL 'kxdfhei1' USING DFHEIV0
 13295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13296
 13297
 13298     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13299
 13300     IF NOT CF-MANUAL-RESERVES-USED AND
 13301           WS-MANRSV GREATER ZERO
 13302         MOVE ER-0518             TO EMI-ERROR
 13303         MOVE -1                  TO MANRSVL
 13304         MOVE AL-UNBON            TO MANRSVA
 13305         MOVE ZEROS               TO WS-MANRSV
 13306         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13307     END-IF.
 13308
 13309     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 13310     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 251
* EL130.cbl
 13311
 13312     IF SUPVL GREATER ZERO
 13313         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 13314             MOVE -1             TO SUPVL
 13315             MOVE AL-UABON       TO SUPVA
 13316             MOVE ER-0230        TO EMI-ERROR
 13317             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13318         ELSE
 13319             MOVE AL-UANON       TO SUPVA
 13320         END-IF
 13321     END-IF.
 13322
 13323     IF PROCCDL = ZERO
 13324        GO TO 6050-CONTINUE-EDITS
 13325     END-IF.
 13326
 13327     MOVE SPACES                 TO ELCNTL-KEY.
 13328     MOVE PROCCDI                TO CNTL-ACCESS.
 13329
 13330     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13331     MOVE '2'                    TO CNTL-REC-TYPE.
 13332     MOVE +0                     TO CNTL-SEQ-NO.
 13333
 13334
 13335
 13336* EXEC CICS HANDLE CONDITION
 13337*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 13338*    END-EXEC.
 13339*    MOVE '"$I                   ! A #00012155' TO DFHEIV0
 13340     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13341     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13342     MOVE X'4120233030303132313535' TO DFHEIV0(25:11)
 13343     CALL 'kxdfhei1' USING DFHEIV0
 13344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13345
 13346
 13347     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13348
 13349     GO TO 6050-CONTINUE-EDITS.
 13350
 13351 6040-NO-PROCESSOR-RECORD.
 13352     MOVE ER-0019                TO EMI-ERROR.
 13353     MOVE -1                     TO PROCCDL.
 13354     MOVE AL-UABON               TO PROCCDA.
 13355     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13356
 13357 6050-CONTINUE-EDITS.
 13358     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 13359           GO TO 6070-CONTINUE-EDITS
 13360     END-IF.
 13361
 13362     MOVE BENECDI                TO BENE-CODE.
 13363     MOVE 'B'                    TO BENE-RCD-TYPE.
 13364     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 13365
 13366
 13367
 13368* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 252
* EL130.cbl
 13369*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 13370*    END-EXEC.
 13371*    MOVE '"$I                   ! B #00012179' TO DFHEIV0
 13372     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13373     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13374     MOVE X'4220233030303132313739' TO DFHEIV0(25:11)
 13375     CALL 'kxdfhei1' USING DFHEIV0
 13376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13377
 13378
 13379
 13380* EXEC CICS READ
 13381*         DATASET   (ELBENE-DSID)
 13382*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 13383*         RIDFLD    (ELBENE-KEY)
 13384*    END-EXEC.
 13385*    MOVE '&"S        E          (   #00012183' TO DFHEIV0
 13386     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13387     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13388     MOVE X'2020233030303132313833' TO DFHEIV0(25:11)
 13389     CALL 'kxdfhei1' USING DFHEIV0,
 13390           ELBENE-DSID,
 13391           DFHEIV20,
 13392           DFHEIV99,
 13393           ELBENE-KEY,
 13394           DFHEIV99,
 13395           DFHEIV99,
 13396           DFHEIV99
 13397     SET ADDRESS OF BENEFICIARY-MASTER TO
 13398         DFHEIV20
 13399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13400
 13401
 13402     GO TO 6070-CONTINUE-EDITS.
 13403
 13404 6060-NO-BENEFICIARY-RECORD.
 13405     MOVE ER-0565                TO EMI-ERROR.
 13406     MOVE -1                     TO BENECDL.
 13407     MOVE AL-UABON               TO BENECDA.
 13408     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13409
 13410
 13411 6070-CONTINUE-EDITS.
 13412     IF CERTMTL GREATER ZERO
 13413         IF CERTMTI NOT = 'A' AND 'S'
 13414             MOVE -1             TO CERTMTL
 13415             MOVE AL-UABON       TO CERTMTA
 13416             MOVE ER-0267        TO EMI-ERROR
 13417             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13418         ELSE
 13419             MOVE AL-UANON       TO CERTMTA
 13420         END-IF
 13421     ELSE
 13422         GO TO 6000-EXIT
 13423     END-IF.
 13424
 13425     IF EFFDTL GREATER ZERO
 13426         MOVE EFFDTI             TO DATE-WORK
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 253
* EL130.cbl
 13427         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13428         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13429         MOVE '4'                TO DC-OPTION-CODE
 13430         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13431         IF DATE-CONVERSION-ERROR
 13432             MOVE AL-UABON       TO EFFDTA
 13433             MOVE -1             TO EFFDTL
 13434             MOVE ER-0231        TO EMI-ERROR
 13435             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13436         ELSE
 13437             MOVE AL-UANON       TO EFFDTA
 13438             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 13439             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 13440         END-IF
 13441     ELSE
 13442         MOVE ER-0231            TO EMI-ERROR
 13443         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13444         MOVE -1                 TO EFFDTL
 13445         MOVE AL-UABON           TO EFFDTA
 13446     END-IF.
 13447
 13448     IF ACCOUNTL = ZERO
 13449         MOVE ER-0232            TO EMI-ERROR
 13450         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13451         MOVE AL-UABON           TO ACCOUNTA
 13452         MOVE -1                 TO ACCOUNTL
 13453     ELSE
 13454         MOVE AL-UANON           TO ACCOUNTA
 13455     END-IF.
 13456
 13457     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 13458        (STATEL = ZERO)
 13459         MOVE ER-0233        TO EMI-ERROR
 13460         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13461         MOVE AL-UABON       TO STATEA
 13462         MOVE -1             TO STATEL
 13463     ELSE
 13464         MOVE AL-UANON       TO STATEA
 13465     END-IF.
 13466
 13467     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 13468        (CRTCARRL = ZERO)
 13469         MOVE ER-0234        TO EMI-ERROR
 13470         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13471         MOVE AL-UABON       TO CRTCARRA
 13472         MOVE -1             TO CRTCARRL
 13473     ELSE
 13474         MOVE AL-UANON       TO CRTCARRA
 13475     END-IF.
 13476
 13477     IF PI-CERT-ACCESS-CONTROL = '1' AND
 13478        GROUPL = ZERO
 13479         MOVE ER-0235            TO EMI-ERROR
 13480         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13481         MOVE AL-UABON           TO GROUPA
 13482         MOVE -1                 TO GROUPL
 13483     ELSE
 13484         MOVE AL-UANON           TO GROUPA
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 254
* EL130.cbl
 13485     END-IF.
 13486
 13487     IF CRTLNMEL = ZERO
 13488         IF LSTNMEI = SPACES OR LOW-VALUES
 13489             MOVE ER-0236            TO  EMI-ERROR
 13490             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13491             MOVE AL-UABON           TO  CRTLNMEA
 13492             MOVE -1                 TO  CRTLNMEL
 13493         ELSE
 13494             MOVE LSTNMEI            TO  CRTLNMEI
 13495             MOVE AL-UANON           TO  CRTLNMEA
 13496         END-IF
 13497     ELSE
 13498         MOVE AL-UANON               TO  CRTLNMEA
 13499     END-IF.
 13500
 13501     IF CRTFNMEL = ZERO
 13502         IF FSTNMEI = SPACES OR LOW-VALUES
 13503*            NEXT SENTENCE
 13504             CONTINUE
 13505         ELSE
 13506             MOVE FSTNMEI            TO  CRTFNMEI
 13507             MOVE AL-UANON           TO  CRTFNMEA
 13508         END-IF
 13509     END-IF.
 13510
 13511     IF CRTINITL = ZERO
 13512         IF INITI = SPACES OR LOW-VALUES
 13513*            NEXT SENTENCE
 13514             CONTINUE
 13515         ELSE
 13516             MOVE INITI              TO  CRTINITI
 13517             MOVE AL-UANON           TO  CRTINITA
 13518         END-IF
 13519     END-IF.
 13520
 13521 6000-EXIT.
 13522     EXIT.
 13523
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 255
* EL130.cbl
 13525 6200-EDIT-CERT-DATA.
 13526     IF ISSAGEL GREATER ZERO
 13527         IF ISSAGEI NOT NUMERIC
 13528             MOVE ER-0237        TO EMI-ERROR
 13529             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13530             MOVE -1             TO ISSAGEL
 13531             MOVE AL-UNBON       TO ISSAGEA
 13532         ELSE
 13533             MOVE AL-UNNON       TO ISSAGEA
 13534         END-IF
 13535     END-IF.
 13536
 13537     IF JNTAGEL GREATER ZERO
 13538         IF JNTAGEI NOT NUMERIC
 13539             MOVE ER-0238        TO EMI-ERROR
 13540             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13541             MOVE -1             TO JNTAGEL
 13542             MOVE AL-UNBON       TO JNTAGEA
 13543         ELSE
 13544             MOVE AL-UNNON       TO JNTAGEA
 13545         END-IF
 13546     END-IF.
 13547
 13548     IF LCVCDL GREATER ZERO
 13549         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 13550         IF INVALID-BENEFIT-CODE
 13551             MOVE ER-7635        TO EMI-ERROR
 13552             MOVE -1             TO LCVCDL
 13553             MOVE AL-UABON       TO LCVCDA
 13554             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13555         ELSE
 13556             MOVE LCVCDI         TO WS-BEN-HOLD
 13557             MOVE '4'            TO WS-REC-TYPE
 13558             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13559             IF WS-BEN-ALPHA-HOLD = SPACES
 13560                MOVE ER-7635     TO EMI-ERROR
 13561                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13562                MOVE -1          TO LCVCDL
 13563                MOVE AL-UABON    TO LCVCDA
 13564             ELSE
 13565                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 13566                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 13567                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 13568                MOVE AL-UANON           TO LCVCDA
 13569             END-IF
 13570         END-IF
 13571     END-IF.
 13572
 13573     IF ACVCDL GREATER ZERO
 13574         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 13575         IF INVALID-BENEFIT-CODE
 13576             MOVE ER-7635        TO EMI-ERROR
 13577             MOVE -1             TO ACVCDL
 13578             MOVE AL-UABON       TO ACVCDA
 13579             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13580         ELSE
 13581             MOVE ACVCDI         TO WS-BEN-HOLD
 13582             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 256
* EL130.cbl
 13583             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13584             IF WS-BEN-ALPHA-HOLD = SPACES
 13585                MOVE ER-7635     TO EMI-ERROR
 13586                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13587                MOVE -1          TO ACVCDL
 13588                MOVE AL-UABON    TO ACVCDA
 13589             ELSE
 13590                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 13591                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 13592                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 13593                MOVE AL-UANON           TO ACVCDA
 13594             END-IF
 13595         END-IF
 13596     END-IF.
 13597
 13598     IF LCVOTRML GREATER ZERO
 13599         IF LCVOTRMI NOT NUMERIC
 13600             MOVE ER-7636        TO EMI-ERROR
 13601             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13602             MOVE -1             TO LCVOTRML
 13603             MOVE AL-UNBON       TO LCVOTRMA
 13604         ELSE
 13605             MOVE AL-UNNON       TO LCVOTRMA
 13606         END-IF
 13607     END-IF.
 13608
 13609     IF ACVOTRML GREATER ZERO
 13610         IF ACVOTRMI NOT NUMERIC
 13611             MOVE ER-7636        TO EMI-ERROR
 13612             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13613             MOVE -1             TO ACVOTRML
 13614             MOVE AL-UNBON       TO ACVOTRMA
 13615         ELSE
 13616             MOVE AL-UNNON       TO ACVOTRMA
 13617         END-IF
 13618     END-IF.
 13619
 13620     IF LCVRATEL GREATER ZERO
 13621
 13622* EXEC CICS BIF DEEDIT
 13623*            FIELD    (LCVRATEI)
 13624*            LENGTH   (06)
 13625*        END-EXEC
 13626     MOVE 06
 13627       TO DFHEIV11
 13628*    MOVE '@"L                   #   #00012408' TO DFHEIV0
 13629     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13630     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13631     MOVE X'2020233030303132343038' TO DFHEIV0(25:11)
 13632     CALL 'kxdfhei1' USING DFHEIV0,
 13633           LCVRATEI,
 13634           DFHEIV11
 13635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13636         IF LCVRATEI NOT NUMERIC
 13637             MOVE AL-UNBON       TO LCVRATEA
 13638             MOVE -1             TO LCVRATEL
 13639             MOVE ER-2280        TO EMI-ERROR
 13640             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 257
* EL130.cbl
 13641         ELSE
 13642             MOVE AL-UNNON       TO LCVRATEA
 13643             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 13644         END-IF
 13645     END-IF.
 13646
 13647     IF ACVRATEL GREATER ZERO
 13648
 13649* EXEC CICS BIF DEEDIT
 13650*            FIELD    (ACVRATEI)
 13651*            LENGTH   (06)
 13652*        END-EXEC
 13653     MOVE 06
 13654       TO DFHEIV11
 13655*    MOVE '@"L                   #   #00012424' TO DFHEIV0
 13656     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13657     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13658     MOVE X'2020233030303132343234' TO DFHEIV0(25:11)
 13659     CALL 'kxdfhei1' USING DFHEIV0,
 13660           ACVRATEI,
 13661           DFHEIV11
 13662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13663         IF ACVRATEI NOT NUMERIC
 13664             MOVE AL-UNBON       TO ACVRATEA
 13665             MOVE -1             TO ACVRATEL
 13666             MOVE ER-2280        TO EMI-ERROR
 13667             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13668         ELSE
 13669             MOVE AL-UNNON       TO ACVRATEA
 13670             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 13671         END-IF
 13672     END-IF.
 13673
 13674     IF LCVBENEL GREATER ZERO
 13675
 13676* EXEC CICS BIF DEEDIT
 13677*            FIELD    (LCVBENEI)
 13678*            LENGTH   (11)
 13679*        END-EXEC
 13680     MOVE 11
 13681       TO DFHEIV11
 13682*    MOVE '@"L                   #   #00012440' TO DFHEIV0
 13683     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13684     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13685     MOVE X'2020233030303132343430' TO DFHEIV0(25:11)
 13686     CALL 'kxdfhei1' USING DFHEIV0,
 13687           LCVBENEI,
 13688           DFHEIV11
 13689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13690         IF LCVBENEI NOT NUMERIC
 13691             MOVE AL-UNBON       TO LCVBENEA
 13692             MOVE -1             TO LCVBENEL
 13693             MOVE ER-7637        TO EMI-ERROR
 13694             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13695         ELSE
 13696             MOVE AL-UNNON       TO LCVBENEA
 13697             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 13698         END-IF
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 258
* EL130.cbl
 13699     END-IF.
 13700
 13701     IF ACVBENEL GREATER ZERO
 13702
 13703* EXEC CICS BIF DEEDIT
 13704*            FIELD    (ACVBENEI)
 13705*            LENGTH   (11)
 13706*        END-EXEC
 13707     MOVE 11
 13708       TO DFHEIV11
 13709*    MOVE '@"L                   #   #00012456' TO DFHEIV0
 13710     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13711     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13712     MOVE X'2020233030303132343536' TO DFHEIV0(25:11)
 13713     CALL 'kxdfhei1' USING DFHEIV0,
 13714           ACVBENEI,
 13715           DFHEIV11
 13716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13717         IF ACVBENEI NOT NUMERIC
 13718             MOVE AL-UNBON       TO ACVBENEA
 13719             MOVE -1             TO ACVBENEL
 13720             MOVE ER-7637        TO EMI-ERROR
 13721             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13722         ELSE
 13723             MOVE AL-UNNON       TO ACVBENEA
 13724             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 13725         END-IF
 13726     END-IF.
 13727
 13728     IF LCVCNDTL GREATER ZERO
 13729         IF LCVCNDTI NOT = SPACES
 13730             MOVE LCVCNDTI        TO DATE-WORK
 13731             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13732             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13733             MOVE '4'             TO DC-OPTION-CODE
 13734             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13735             IF DATE-CONVERSION-ERROR
 13736                 MOVE AL-UABON    TO LCVCNDTA
 13737                 MOVE -1          TO LCVCNDTL
 13738                 MOVE ER-7638     TO EMI-ERROR
 13739                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13740             ELSE
 13741                 MOVE AL-UANON    TO LCVCNDTA
 13742                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 13743                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 13744             END-IF
 13745         END-IF
 13746     END-IF.
 13747
 13748     IF ACVCNDTL GREATER ZERO
 13749         IF ACVCNDTI NOT = SPACES
 13750             MOVE ACVCNDTI        TO DATE-WORK
 13751             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13752             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13753             MOVE '4'             TO DC-OPTION-CODE
 13754             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13755             IF DATE-CONVERSION-ERROR
 13756                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 259
* EL130.cbl
 13757                 MOVE -1          TO ACVCNDTL
 13758                 MOVE ER-7638     TO EMI-ERROR
 13759                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13760             ELSE
 13761                 MOVE AL-UANON    TO ACVCNDTA
 13762                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 13763                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 13764             END-IF
 13765         END-IF
 13766     END-IF.
 13767
 13768     IF ADDONDTL GREATER ZERO
 13769         MOVE ADDONDTI        TO DATE-WORK
 13770         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13771         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13772         MOVE '4'             TO DC-OPTION-CODE
 13773         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13774         IF DATE-CONVERSION-ERROR
 13775             MOVE AL-UABON    TO ADDONDTA
 13776             MOVE -1          TO ADDONDTL
 13777             MOVE ER-7651     TO EMI-ERROR
 13778             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13779         ELSE
 13780             MOVE AL-UANON    TO ADDONDTA
 13781             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 13782             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 13783         END-IF
 13784     END-IF.
 13785
 13786     IF APRL GREATER ZERO
 13787
 13788* EXEC CICS BIF DEEDIT
 13789*            FIELD    (APRI)
 13790*            LENGTH   (8)
 13791*        END-EXEC
 13792     MOVE 8
 13793       TO DFHEIV11
 13794*    MOVE '@"L                   #   #00012530' TO DFHEIV0
 13795     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13796     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13797     MOVE X'2020233030303132353330' TO DFHEIV0(25:11)
 13798     CALL 'kxdfhei1' USING DFHEIV0,
 13799           APRI,
 13800           DFHEIV11
 13801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13802         IF APRI NOT NUMERIC
 13803             MOVE AL-UNBON       TO APRA
 13804             MOVE -1             TO APRL
 13805             MOVE ER-0248        TO EMI-ERROR
 13806             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13807         ELSE
 13808             MOVE AL-UNNON       TO APRA
 13809             MOVE APRI           TO WS-APR APRO
 13810         END-IF
 13811     END-IF.
 13812
 13813     IF PMTFREQL GREATER ZERO
 13814
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 260
* EL130.cbl
 13815* EXEC CICS BIF DEEDIT
 13816*            FIELD   (PMTFREQI)
 13817*            LENGTH  (2)
 13818*        END-EXEC
 13819     MOVE 2
 13820       TO DFHEIV11
 13821*    MOVE '@"L                   #   #00012546' TO DFHEIV0
 13822     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13823     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13824     MOVE X'2020233030303132353436' TO DFHEIV0(25:11)
 13825     CALL 'kxdfhei1' USING DFHEIV0,
 13826           PMTFREQI,
 13827           DFHEIV11
 13828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13829         IF PMTFREQI NOT NUMERIC
 13830             MOVE -1             TO PMTFREQL
 13831             MOVE AL-UNBON       TO PMTFREQA
 13832             MOVE ER-0258        TO EMI-ERROR
 13833             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13834         ELSE
 13835             MOVE AL-UNNON       TO PMTFREQA
 13836             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 13837         END-IF
 13838     END-IF.
 13839
 13840     IF INDGRPL GREATER ZERO
 13841         IF INDGRPI = 'I' OR 'G'
 13842             MOVE AL-UANON       TO INDGRPA
 13843         ELSE
 13844             MOVE -1 TO INDGRPL
 13845             MOVE AL-UABON       TO INDGRPA
 13846             MOVE ER-0260        TO EMI-ERROR
 13847             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13848         END-IF
 13849     END-IF.
 13850
 13851     IF LOANBALL GREATER ZERO
 13852         MOVE LOANBALI           TO DEEDIT-FIELD
 13853
 13854* EXEC CICS BIF DEEDIT
 13855*            FIELD   (DEEDIT-FIELD)
 13856*            LENGTH  (12)
 13857*        END-EXEC
 13858     MOVE 12
 13859       TO DFHEIV11
 13860*    MOVE '@"L                   #   #00012574' TO DFHEIV0
 13861     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13862     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13863     MOVE X'2020233030303132353734' TO DFHEIV0(25:11)
 13864     CALL 'kxdfhei1' USING DFHEIV0,
 13865           DEEDIT-FIELD,
 13866           DFHEIV11
 13867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13868         IF DEEDIT-FIELD NOT NUMERIC
 13869             MOVE AL-UNBON       TO LOANBALA
 13870             MOVE -1             TO LOANBALL
 13871             MOVE ER-0247        TO EMI-ERROR
 13872             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 261
* EL130.cbl
 13873         ELSE
 13874             MOVE AL-UNNON       TO LOANBALA
 13875             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 13876         END-IF
 13877     END-IF.
 13878
 13879     IF PREMTYPL GREATER ZERO
 13880         IF (PREMTYPI = '1' OR '2' OR '3')
 13881             MOVE AL-UANON       TO PREMTYPA
 13882         ELSE
 13883             MOVE -1             TO PREMTYPL
 13884             MOVE AL-UABON       TO PREMTYPA
 13885             MOVE ER-0227        TO EMI-ERROR
 13886             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13887         END-IF
 13888     END-IF.
 13889
 13890     IF REINCDL GREATER ZERO
 13891         MOVE LOW-VALUES         TO  ERREIN-KEY
 13892         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 13893         MOVE REINCDI            TO  REIN-CODE-1
 13894                                     REIN-CODE-2
 13895                                     REIN-CODE-3
 13896         MOVE 'A'                TO  REIN-TYPE
 13897         PERFORM 7992-READ-REIN THRU 7992-EXIT
 13898         IF REIN-REC-NOT-FOUND
 13899             MOVE ER-0266        TO  EMI-ERROR
 13900             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13901             MOVE -1             TO  REINCDL
 13902             MOVE AL-UABON       TO  REINCDA
 13903         ELSE
 13904             MOVE AL-UANON       TO  REINCDA
 13905         END-IF
 13906     END-IF.
 13907
 13908     IF CERTMTI NOT = 'A'
 13909        GO TO 6200-EXIT
 13910     END-IF.
 13911
 13912     IF PREMTYPI = '1'
 13913         IF LCVCDL GREATER ZERO
 13914             IF WS-LF-SPECIAL-CALC-CD = 'O'
 13915                 MOVE ER-0841        TO  EMI-ERROR
 13916                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13917                 MOVE -1             TO  PREMTYPL
 13918                 MOVE AL-UABON       TO  PREMTYPA
 13919             END-IF
 13920         END-IF
 13921     END-IF.
 13922
 13923     IF PREMTYPI = '1'
 13924         IF ACVCDL GREATER ZERO
 13925             IF WS-AH-SPECIAL-CALC-CD = 'O'
 13926                 MOVE ER-0841        TO  EMI-ERROR
 13927                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13928                 MOVE -1             TO  PREMTYPL
 13929                 MOVE AL-UABON       TO  PREMTYPA
 13930             END-IF
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 262
* EL130.cbl
 13931         END-IF
 13932     END-IF.
 13933
 13934     IF PREMTYPI = '2'
 13935         IF LCVCDL GREATER ZERO
 13936             IF (PI-COMPANY-ID = 'HAN') AND
 13937                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 13938                        OR
 13939                 WS-LF-SPECIAL-CALC-CD = 'O'
 13940*                NEXT SENTENCE
 13941                 CONTINUE
 13942             ELSE
 13943                 MOVE ER-0840        TO  EMI-ERROR
 13944                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13945                 MOVE -1             TO  PREMTYPL
 13946                 MOVE AL-UABON       TO  PREMTYPA
 13947             END-IF
 13948         END-IF
 13949     END-IF.
 13950
 13951     IF PREMTYPI = '2'
 13952         IF ACVCDL GREATER ZERO
 13953             IF (PI-COMPANY-ID = 'HAN')  AND
 13954                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 13955                        OR
 13956                 WS-AH-SPECIAL-CALC-CD = 'O'
 13957*                NEXT SENTENCE
 13958                 CONTINUE
 13959             ELSE
 13960                 MOVE ER-0840        TO  EMI-ERROR
 13961                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13962                 MOVE -1             TO  PREMTYPL
 13963                 MOVE AL-UABON       TO  PREMTYPA
 13964             END-IF
 13965         END-IF
 13966     END-IF.
 13967
 13968     IF LCVCDL = ZEROS
 13969        GO TO 6200-EXIT
 13970     END-IF.
 13971
 13972     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 13973         IF PMTFREQI NOT = ZEROS
 13974             MOVE ER-0428        TO EMI-ERROR
 13975             MOVE -1             TO PMTFREQL
 13976             MOVE AL-UNBON       TO PMTFREQA
 13977             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13978             GO TO 6200-CHECK-APR
 13979         END-IF
 13980     END-IF.
 13981
 13982     IF PMTFREQL = ZEROS AND TEX-REG
 13983         MOVE ER-0429            TO EMI-ERROR
 13984         MOVE -1                 TO PMTFREQL
 13985         MOVE AL-UNBON           TO PMTFREQA
 13986         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13987         GO TO 6200-CHECK-APR
 13988     END-IF.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 263
* EL130.cbl
 13989
 13990     IF LCVOTRMI NOT NUMERIC
 13991         GO TO 6200-CHECK-APR
 13992     END-IF.
 13993
 13994     IF WS-PMTFREQ NOT = ZERO
 13995         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 13996         GIVING DIVIDE-QUOT
 13997         REMAINDER DIVIDE-REM
 13998         IF DIVIDE-REM GREATER ZERO
 13999             MOVE ER-0430            TO EMI-ERROR
 14000             MOVE -1                 TO PMTFREQL
 14001             MOVE AL-UNBON           TO PMTFREQA
 14002             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14003         END-IF
 14004     END-IF.
 14005
 14006 6200-CHECK-APR.
 14007     IF NET-PAY AND APRL = ZEROS
 14008        MOVE ER-0257             TO EMI-ERROR
 14009        MOVE -1                  TO APRL
 14010        MOVE AL-UABON            TO APRA
 14011        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14012     END-IF.
 14013
 14014 6200-EXIT.
 14015     EXIT.
 14016
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 264
* EL130.cbl
 14018 6300-REQUIRED-CERT-EDIT.
 14019
 14020     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14021        GO TO 6300-REQUIRED-AH-EDIT
 14022     END-IF
 14023
 14024     IF LCVCDL = ZERO
 14025        MOVE ER-7639             TO EMI-ERROR
 14026        MOVE -1                  TO LCVCDL
 14027        MOVE AL-UABON            TO LCVCDA
 14028        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14029     END-IF.
 14030
 14031     IF LCVOTRML = ZERO
 14032        MOVE ER-7670             TO EMI-ERROR
 14033        MOVE -1                  TO LCVOTRML
 14034        MOVE AL-UNBON            TO LCVOTRMA
 14035        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14036     END-IF.
 14037
 14038     IF LCVBENEL = ZERO
 14039        MOVE ER-7671             TO EMI-ERROR
 14040        MOVE -1                  TO LCVBENEL
 14041        MOVE AL-UNBON            TO LCVBENEA
 14042        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14043     END-IF.
 14044
 14045     GO TO 6399-EXIT.
 14046
 14047 6300-REQUIRED-AH-EDIT.
 14048
 14049     IF ACVCDL = ZERO
 14050        MOVE ER-7639             TO EMI-ERROR
 14051        MOVE -1                  TO ACVCDL
 14052        MOVE AL-UABON            TO ACVCDA
 14053        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14054     END-IF.
 14055
 14056     IF ACVOTRML = ZERO
 14057         MOVE ER-7670             TO EMI-ERROR
 14058         MOVE -1                  TO ACVOTRML
 14059         MOVE AL-UNBON            TO ACVOTRMA
 14060         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14061     END-IF.
 14062
 14063     IF ACVBENEL = ZERO
 14064        MOVE ER-7671             TO EMI-ERROR
 14065        MOVE -1                  TO ACVBENEL
 14066        MOVE AL-UNBON            TO ACVBENEA
 14067        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14068     END-IF.
 14069
 14070 6399-EXIT.
 14071      EXIT.
 14072
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 265
* EL130.cbl
 14074 6400-TEST-CLAIM-REASONABILITY.
 14075
 14076     IF WS-INCUR = LOW-VALUES
 14077        GO TO 6499-EXIT
 14078     END-IF.
 14079
 14080     IF WS-EFFDT NOT = LOW-VALUES
 14081         IF WS-INCUR LESS WS-EFFDT
 14082             MOVE ER-0458          TO EMI-ERROR
 14083             MOVE -1               TO INCURL
 14084             MOVE AL-UABON         TO INCURA
 14085             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14086         END-IF
 14087     END-IF.
 14088
 14089     IF CERTMTI = 'A'
 14090        GO TO 6460-TEST-NEW-CERT
 14091     END-IF.
 14092
 14093     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 14094     MOVE CRTCARRI               TO CERT-CARRIER.
 14095     MOVE GROUPI                 TO CERT-GROUPING.
 14096     MOVE STATEI                 TO CERT-STATE.
 14097     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 14098     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 14099     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 14100
 14101
 14102
 14103* EXEC CICS HANDLE CONDITION
 14104*         DUPKEY   (6499-EXIT)
 14105*         NOTFND   (6499-EXIT)
 14106*    END-EXEC.
 14107*    MOVE '"$$I                  ! C #00012812' TO DFHEIV0
 14108     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 14109     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14110     MOVE X'4320233030303132383132' TO DFHEIV0(25:11)
 14111     CALL 'kxdfhei1' USING DFHEIV0
 14112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14113
 14114
 14115     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 14116
 14117     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 14118        'I' OR 'G' OR 'F')
 14119        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 14120     ELSE
 14121        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 14122     END-IF.
 14123
 14124     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14125     MOVE '6'                    TO DC-OPTION-CODE.
 14126     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14127
 14128     IF (WS-INCUR GREATER THAN DC-BIN-DATE-2)
 14129        and (dc-elapsed-months > zeros)
 14130        MOVE ER-0519             TO EMI-ERROR
 14131        MOVE -1                  TO INCURL
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 266
* EL130.cbl
 14132        MOVE AL-UABON            TO INCURA
 14133        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14134     END-IF.
 14135
 14136     IF CLMCARRI NOT = CRTCARRI
 14137        MOVE ER-0562             TO EMI-ERROR
 14138        MOVE AL-UABON            TO CLMCARRA
 14139        MOVE -1                  TO CLMCARRL
 14140        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14141     END-IF.
 14142
 14143     if (pi-company-id = 'DCC' OR 'VPP')
 14144        and (ws-dcc-product-code <> spaces)
 14145        continue
 14146     else
 14147      IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F') AND
 14148        CM-AH-BENEFIT-CD = '00')
 14149                  OR
 14150        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 14151        CM-LF-BENEFIT-CD = '00')
 14152         MOVE ER-0521         TO EMI-ERROR
 14153         MOVE AL-UABON        TO CLMTYPEA
 14154         MOVE -1              TO CLMTYPEL
 14155         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14156      END-IF
 14157     end-if
 14158*    IF CLMTYPEI = 'I' AND
 14159*       CM-AH-CRITICAL-PERIOD = +0
 14160*        MOVE ER-0521         TO EMI-ERROR
 14161*        MOVE AL-UABON        TO CLMTYPEA
 14162*        MOVE -1              TO CLMTYPEL
 14163*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14164*    END-IF
 14165
 14166*    IF PI-COMPANY-ID = 'CRI'
 14167*        IF MAINTI = 'A'
 14168*            IF CERT-PEND-ISSUE-ERROR  OR
 14169*               CERT-PEND-ISSUE-RETURNED
 14170*                MOVE -1                 TO CERTNOL
 14171*                MOVE AL-UABON           TO CERTNOA
 14172*                MOVE ER-7640            TO EMI-ERROR
 14173*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14174*            END-IF
 14175*        END-IF
 14176*    END-IF.
 14177
 14178     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 14179         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 14180         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 14181             GO TO 6450-DATE-ERROR
 14182         END-IF
 14183     END-IF.
 14184
 14185     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 14186         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 14187         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 14188             GO TO 6450-DATE-ERROR
 14189         END-IF
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 267
* EL130.cbl
 14190     END-IF.
 14191
 14192     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14193         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 14194             GO TO 6450-DATE-ERROR
 14195         END-IF
 14196     END-IF.
 14197
 14198     GO TO 6499-EXIT.
 14199
 14200 6450-DATE-ERROR.
 14201     MOVE ER-0520                TO EMI-ERROR.
 14202     MOVE -1                     TO INCURL.
 14203     MOVE AL-UABON               TO INCURA.
 14204     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14205
 14206*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 14207*       (EMI-SEVERITY-SAVE = 'X')
 14208*        ADD 1                TO EMI-FORCABLE-CTR
 14209*        SUBTRACT 1 FROM EMI-FATAL-CTR
 14210*    END-IF.
 14211
 14212     GO TO 6499-EXIT.
 14213
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 268
* EL130.cbl
 14215 6460-TEST-NEW-CERT.
 14216
 14217     IF NOT EMI-NO-ERRORS
 14218        GO TO 6499-EXIT
 14219     END-IF.
 14220
 14221     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 14222
 14223     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14224          OR 'F') AND
 14225         ACVOTRML GREATER ZERO)
 14226        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 14227     END-IF.
 14228
 14229     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 14230         LCVOTRML GREATER ZERO
 14231        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 14232     END-IF.
 14233
 14234     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 14235
 14236*    IF PI-COMPANY-ID = 'HAN'
 14237*        IF ADDONDTL GREATER ZERO
 14238*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 14239*            IF CLMTYPEI = 'A'
 14240*                IF ACVOTRMI NOT = ZEROS
 14241*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 14242*                ELSE
 14243*                    NEXT SENTENCE
 14244*                    CONTINUE
 14245*                END-IF
 14246*            ELSE
 14247*                IF LCVOTRMI NOT = ZEROS
 14248*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 14249*                END-IF
 14250*            END-IF
 14251*        END-IF
 14252*    END-IF.
 14253
 14254     MOVE '6'                    TO DC-OPTION-CODE.
 14255     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14256
 14257     IF NO-CONVERSION-ERROR
 14258         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 14259     END-IF.
 14260
 14261     IF WS-INCUR GREATER THAN WS-EXPIRE
 14262        MOVE ER-0519             TO EMI-ERROR
 14263        MOVE -1                  TO INCURL
 14264        MOVE AL-UABON            TO INCURA
 14265        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14266     END-IF.
 14267
 14268     IF CLMCARRI NOT = CRTCARRI
 14269        MOVE ER-0562             TO EMI-ERROR
 14270        MOVE AL-UABON            TO CLMCARRA
 14271        MOVE -1                  TO CLMCARRL
 14272        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 269
* EL130.cbl
 14273     END-IF.
 14274
 14275     if (pi-company-id = 'DCC' OR 'VPP')
 14276        and (ws-dcc-product-code <> spaces)
 14277        continue
 14278     else
 14279        IF (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F')
 14280           and (ACVCDL = ZEROS)
 14281           MOVE ER-0521          TO EMI-ERROR
 14282           MOVE AL-UABON         TO CLMTYPEA
 14283           MOVE -1               TO CLMTYPEL
 14284           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14285        END-IF
 14286     end-if
 14287
 14288     if (pi-company-id = 'DCC' OR 'VPP')
 14289        and (ws-dcc-product-code <> spaces)
 14290        continue
 14291     else
 14292        IF (CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 14293           and (LCVCDL = ZEROS)
 14294           MOVE ER-0521          TO EMI-ERROR
 14295           MOVE AL-UABON         TO CLMTYPEA
 14296           MOVE -1               TO CLMTYPEL
 14297           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14298        END-IF
 14299     end-if
 14300
 14301     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14302         IF LCVCNDTL GREATER ZERO
 14303             IF WS-INCUR GREATER THAN WS-LCVCNDT
 14304                 GO TO 6450-DATE-ERROR
 14305             END-IF
 14306         END-IF
 14307     END-IF.
 14308
 14309     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14310         IF ACVCNDTL GREATER ZERO
 14311             IF WS-INCUR GREATER THAN WS-ACVCNDT
 14312                 GO TO 6450-DATE-ERROR
 14313             END-IF
 14314         END-IF
 14315     END-IF.
 14316
 14317 6499-EXIT.
 14318     EXIT.
 14319 6500-get-acct.
 14320
 14321     MOVE SPACES                 TO ERACCT-KEY
 14322                                    ws-dcc-product-code
 14323                                    ws-acct-found-sw
 14324
 14325     IF CARR-GROUP-ST-ACCNT-CNTL
 14326        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 14327        MOVE CRTCARRI            TO ACCT-CARRIER
 14328        MOVE GROUPI              TO ACCT-GROUPING
 14329        MOVE STATEI              TO ACCT-STATE
 14330        MOVE ACCOUNTI            TO ACCT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 270
* EL130.cbl
 14331        GO TO 6500-startbr
 14332     END-IF
 14333
 14334     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 14335     MOVE ACCOUNTI               TO ACCT-ACCOUNT
 14336
 14337     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
 14338        MOVE STATEI             TO ACCT-STATE
 14339     END-IF
 14340
 14341     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
 14342        MOVE CRTCARRI           TO ACCT-CARRIER
 14343     END-IF
 14344
 14345     .
 14346 6500-startbr.
 14347
 14348     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY
 14349
 14350
 14351* EXEC CICS STARTBR
 14352*       DATASET     (ERACCT2-DSID)
 14353*       RIDFLD      (SAVE-ERACCT-KEY)
 14354*       GENERIC
 14355*       KEYLENGTH   (20)
 14356*       resp        (ws-response)
 14357*    END-EXEC
 14358     MOVE 20
 14359       TO DFHEIV11
 14360     MOVE 0
 14361       TO DFHEIV12
 14362*    MOVE '&,   KG    G          &  N#00013052' TO DFHEIV0
 14363     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 14364     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14365     MOVE X'204E233030303133303532' TO DFHEIV0(25:11)
 14366     CALL 'kxdfhei1' USING DFHEIV0,
 14367           ERACCT2-DSID,
 14368           SAVE-ERACCT-KEY,
 14369           DFHEIV11,
 14370           DFHEIV12,
 14371           DFHEIV99
 14372     MOVE EIBRESP  TO ws-response
 14373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14374
 14375     if not ws-resp-normal
 14376        go to 6500-exit
 14377     end-if
 14378
 14379     .
 14380 6500-readnext.
 14381
 14382
 14383* EXEC CICS READNEXT
 14384*       DATASET   (ERACCT2-DSID)
 14385*       SET       (ADDRESS OF ACCOUNT-MASTER)
 14386*       RIDFLD    (SAVE-ERACCT-KEY)
 14387*    END-EXEC
 14388     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 271
* EL130.cbl
 14389       TO DFHEIV11
 14390*    MOVE '&.S                   )   #00013067' TO DFHEIV0
 14391     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14392     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14393     MOVE X'2020233030303133303637' TO DFHEIV0(25:11)
 14394     CALL 'kxdfhei1' USING DFHEIV0,
 14395           ERACCT2-DSID,
 14396           DFHEIV20,
 14397           DFHEIV99,
 14398           SAVE-ERACCT-KEY,
 14399           DFHEIV99,
 14400           DFHEIV11,
 14401           DFHEIV99,
 14402           DFHEIV99
 14403     SET ADDRESS OF ACCOUNT-MASTER TO
 14404         DFHEIV20
 14405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14406
 14407     IF (ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1)
 14408        or (ACCT-CARRIER  NOT = AM-VG-CARRIER )
 14409        or (ACCT-GROUPING NOT = AM-VG-GROUPING)
 14410        or (ACCT-STATE    NOT = AM-VG-STATE   )
 14411        or (ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT )
 14412        go to 6500-endbr
 14413     END-IF
 14414
 14415     IF (WS-EFFDT >= AM-EFFECTIVE-DT)
 14416        and (WS-EFFDT < AM-EXPIRATION-DT)
 14417        set acct-found to true
 14418        MOVE AM-dcc-product-code to ws-dcc-product-code
 14419        GO TO 6500-endbr
 14420     END-IF
 14421
 14422     IF WS-EFFDT >= AM-EXPIRATION-DT
 14423         GO TO 6500-readnext
 14424     END-IF
 14425
 14426     .
 14427 6500-endbr.
 14428
 14429
 14430* EXEC CICS ENDBR
 14431*        DATASET    (ERACCT2-DSID)
 14432*    END-EXEC
 14433     MOVE 0
 14434       TO DFHEIV11
 14435*    MOVE '&2                    $   #00013095' TO DFHEIV0
 14436     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14437     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14438     MOVE X'2020233030303133303935' TO DFHEIV0(25:11)
 14439     CALL 'kxdfhei1' USING DFHEIV0,
 14440           ERACCT2-DSID,
 14441           DFHEIV11,
 14442           DFHEIV99
 14443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14444
 14445     .
 14446 6500-exit.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 272
* EL130.cbl
 14447     exit.
 14448 6600-CHECK-AUTO-ACTIVITY.
 14449
 14450
 14451* EXEC CICS HANDLE CONDITION
 14452*        NOTFND   (6600-NOT-FOUND)
 14453*    END-EXEC.
 14454*    MOVE '"$I                   ! D #00013104' TO DFHEIV0
 14455     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14456     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14457     MOVE X'4420233030303133313034' TO DFHEIV0(25:11)
 14458     CALL 'kxdfhei1' USING DFHEIV0
 14459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14460
 14461
 14462     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 14463     MOVE 'T'                        TO  CNTL-REC-TYPE.
 14464     MOVE SPACES                     TO  CNTL-ACCESS.
 14465     MOVE +0                         TO  CNTL-SEQ-NO.
 14466
 14467     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14468
 14469     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 14470         MOVE 'N'                    TO  WS-REC-FOUND-SW
 14471                                         WS-LETTER-SW
 14472         GO TO 6600-EXIT
 14473     END-IF.
 14474
 14475     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 14476         MOVE 'N'                     TO  WS-LETTER-SW
 14477     ELSE
 14478         MOVE 'Y'                     TO  WS-LETTER-SW
 14479     END-IF.
 14480
 14481     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 14482     GO TO 6600-EXIT.
 14483
 14484 6600-START-AUTO-LETTER-WRITER.
 14485
 14486     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 14487     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 14488
 14489     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 14490
 14491     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 14492         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14493         MOVE '6'                     TO  DC-OPTION-CODE
 14494         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 14495         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14496         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14497         IF NO-CONVERSION-ERROR
 14498             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 14499         ELSE
 14500             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 14501         END-IF
 14502     END-IF.
 14503
 14504     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 273
* EL130.cbl
 14505         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14506         MOVE '6'                     TO  DC-OPTION-CODE
 14507         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 14508         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14509         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14510         IF NO-CONVERSION-ERROR
 14511             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 14512         ELSE
 14513             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 14514         END-IF
 14515     END-IF.
 14516
 14517
 14518
 14519* EXEC CICS LINK
 14520*        PROGRAM    (LINK-1523)
 14521*        COMMAREA   (W-1523-LINKDATA)
 14522*        LENGTH     (W-1523-COMM-LENGTH)
 14523*    END-EXEC.
 14524*    MOVE '."C                   (   #00013164' TO DFHEIV0
 14525     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14526     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14527     MOVE X'2020233030303133313634' TO DFHEIV0(25:11)
 14528     CALL 'kxdfhei1' USING DFHEIV0,
 14529           LINK-1523,
 14530           W-1523-LINKDATA,
 14531           W-1523-COMM-LENGTH,
 14532           DFHEIV99,
 14533           DFHEIV99,
 14534           DFHEIV99,
 14535           DFHEIV99
 14536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14537
 14538
 14539     GO TO 6600-EXIT.
 14540
 14541 6600-NOT-FOUND.
 14542     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 14543
 14544 6600-EXIT.
 14545     EXIT.
 14546
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 274
* EL130.cbl
 14547/
 14548*************************************************************
 14549*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 14550*************************************************************
 14551
 14552 6700-OUTPUT-ACTIVITY-RECORD.
 14553
 14554
 14555
 14556* EXEC CICS GETMAIN
 14557*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 14558*        LENGTH (DLYACTV-LENGTH)
 14559*        INITIMG (WS-BLANK)
 14560*    END-EXEC.
 14561*    MOVE ',"IL                  $   #00013186' TO DFHEIV0
 14562     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14563     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14564     MOVE X'2020233030303133313836' TO DFHEIV0(25:11)
 14565     CALL 'kxdfhei1' USING DFHEIV0,
 14566           DFHEIV20,
 14567           DLYACTV-LENGTH,
 14568           WS-BLANK
 14569     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 14570         DFHEIV20
 14571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14572
 14573
 14574     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 14575     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 14576     MOVE CLMCARRI               TO DA-CARRIER.
 14577     IF CLMNOL EQUAL ZERO
 14578         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 14579     ELSE
 14580         MOVE CLMNOI             TO DA-CLAIM-NO
 14581     END-IF.
 14582     MOVE CERTNOI                TO DA-CERT-PRIME.
 14583     MOVE SUFXI                  TO DA-CERT-SFX.
 14584     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 14585     MOVE 'A'                    TO DA-RECORD-TYPE.
 14586
 14587
 14588* EXEC CICS HANDLE CONDITION
 14589*        NOTOPEN (6700-NOTOPEN-ERROR)
 14590*        DUPREC (6700-EXIT)
 14591*    END-EXEC.
 14592*    MOVE '"$J%                  ! E #00013205' TO DFHEIV0
 14593     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 14594     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14595     MOVE X'4520233030303133323035' TO DFHEIV0(25:11)
 14596     CALL 'kxdfhei1' USING DFHEIV0
 14597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14598
 14599
 14600
 14601* EXEC CICS WRITE
 14602*        DATASET (DLYACTV-DSID)
 14603*        RIDFLD (DA-KEY)
 14604*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 275
* EL130.cbl
 14605*        LENGTH (DLYACTV-LENGTH)
 14606*    END-EXEC.
 14607*    MOVE '&$ L                  ''   #00013210' TO DFHEIV0
 14608     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14609     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14610     MOVE X'2020233030303133323130' TO DFHEIV0(25:11)
 14611     CALL 'kxdfhei1' USING DFHEIV0,
 14612           DLYACTV-DSID,
 14613           DAILY-ACTIVITY-RECORD,
 14614           DLYACTV-LENGTH,
 14615           DA-KEY,
 14616           DFHEIV99,
 14617           DFHEIV99
 14618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14619
 14620     GO TO 6700-EXIT.
 14621
 14622 6700-NOTOPEN-ERROR.
 14623     MOVE '2955'                 TO EMI-ERROR.
 14624     MOVE -1                     TO MAINTL.
 14625     MOVE AL-UANON               TO MAINTA.
 14626     PERFORM 9900-ERROR-FORMAT THRU
 14627             9900-EXIT.
 14628     GO TO 8200-SEND-DATAONLY.
 14629
 14630 6700-EXIT.
 14631     EXIT.
 14632
 14633*************************************************************
 14634*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 14635*************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 276
* EL130.cbl
 14636/
 14637 6990-DEEDIT-DATE.
 14638
 14639
 14640* EXEC CICS BIF DEEDIT
 14641*        FIELD   (DATE-WORK)
 14642*        LENGTH  (8)
 14643*    END-EXEC.
 14644     MOVE 8
 14645       TO DFHEIV11
 14646*    MOVE '@"L                   #   #00013235' TO DFHEIV0
 14647     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14648     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14649     MOVE X'2020233030303133323335' TO DFHEIV0(25:11)
 14650     CALL 'kxdfhei1' USING DFHEIV0,
 14651           DATE-WORK,
 14652           DFHEIV11
 14653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14654
 14655 6990-EXIT.
 14656     EXIT.
 14657
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 277
* EL130.cbl
 14659 7000-BUILD-OUTPUT-MAP.
 14660
 14661     IF CLAIM-SWITCH = 'N'
 14662         GO TO 7050-BUILD-MAP-CERT-DATA
 14663     END-IF.
 14664
 14665     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 14666         MOVE SPACES                 TO SEQUO
 14667         MOVE AL-SABOF               TO SEQUA
 14668     ELSE
 14669         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 14670         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 14671         MOVE WS-CLAIM-SEQU          TO SEQUO
 14672         MOVE AL-SABON               TO SEQUA
 14673     END-IF.
 14674
 14675     MOVE CL-CARRIER             TO CLMCARRO.
 14676     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 14677     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14678     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14679     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14680     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14681     MOVE CL-INSURED-MID-INIT    TO INITO.
 14682     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14683     move cl-insured-type        to instypeo
 14684*    MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 14685
 14686     MOVE AL-UANON               TO CLMCARRA
 14687                                    CLMTYPEA
 14688                                    PCERTNOA
 14689                                    PSUFXA
 14690                                    LSTNMEA
 14691                                    FSTNMEA
 14692                                    INITA
 14693                                    SEXA
 14694
 14695     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 14696
 14697     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 14698         MOVE ' '                 TO DC-OPTION-CODE
 14699         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14700         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14701         IF NOT DATE-CONVERSION-ERROR
 14702             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 14703             MOVE AL-UANON            TO BIRTHDTA
 14704         END-IF
 14705     END-IF.
 14706
 14707     MOVE CL-SOC-SEC-NO          TO SSNO.
 14708     MOVE AL-UANON               TO SSNA.
 14709
 14710     IF CL-INCURRED-DT NOT = LOW-VALUES
 14711         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14712         MOVE ' '                TO DC-OPTION-CODE
 14713         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14714         IF NOT DATE-CONVERSION-ERROR
 14715             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 14716             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 278
* EL130.cbl
 14717         END-IF
 14718     END-IF.
 14719
 14720     IF CL-REPORTED-DT NOT = LOW-VALUES
 14721         MOVE ' '                TO DC-OPTION-CODE
 14722         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14723         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14724         IF NOT DATE-CONVERSION-ERROR
 14725             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 14726             MOVE AL-UANON            TO REPORTA
 14727         END-IF
 14728     END-IF.
 14729
 14730*    IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 14731*        MOVE ' '                 TO DC-OPTION-CODE
 14732*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14733*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14734*        IF NOT DATE-CONVERSION-ERROR
 14735*            MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 14736*            MOVE AL-UANON            TO ESTENDA
 14737*        END-IF
 14738*    END-IF.
 14739
 14740     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 14741     MOVE WS-ICD-CODE-1          TO ICD1O.
 14742     MOVE WS-ICD-CODE-2          TO ICD2O.
 14743*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14744     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 14745     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 14746     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 14747     MOVE CL-PRIORITY-CD         TO PRICDO.
 14748     MOVE AL-UANON               TO DIAGA
 14749                                    ICD1A
 14750                                    ICD2A
 14751*                                   CAUSEA
 14752                                    RELCLMA
 14753                                    PROCCDA
 14754                                    PRICDA.
 14755     MOVE AL-UNNON               TO MANRSVA.
 14756
 14757*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 14758*        MOVE CL-PRODUCT-CD          TO PRODCDO
 14759*        MOVE AL-UANON               TO PRODCDA
 14760*    END-IF.
 14761
 14762     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14763     MOVE CL-FILE-LOCATION       TO FILETOO.
 14764     MOVE CL-BENEFICIARY         TO BENECDO.
 14765     MOVE AL-UANON               TO SUPVA
 14766                                    FILETOA
 14767                                    BENECDA.
 14768
 14769     IF CLAIM-SWITCH = 'X'
 14770         GO TO 7099-EXIT
 14771     END-IF.
 14772
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 279
* EL130.cbl
 14774 7050-BUILD-MAP-CERT-DATA.
 14775     MOVE CM-CERT-PRIME          TO CERTNOO.
 14776     MOVE CM-CERT-SFX            TO SUFXO.
 14777     MOVE AL-SANON               TO CERTNOA
 14778                                    SUFXA.
 14779
 14780     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 14781         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14782         MOVE ' '                TO DC-OPTION-CODE
 14783         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14784         IF NOT DATE-CONVERSION-ERROR
 14785             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 14786         END-IF
 14787     END-IF.
 14788
 14789     MOVE CM-ACCOUNT             TO ACCOUNTO.
 14790     MOVE CM-STATE               TO STATEO.
 14791     MOVE CM-CARRIER             TO CRTCARRO.
 14792     MOVE CM-GROUPING            TO GROUPO.
 14793     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14794     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14795     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14796     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14797     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14798     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14799     MOVE CM-JT-INITIAL          TO JNTINITO.
 14800     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14801     MOVE AL-UANON               TO ACCOUNTA
 14802                                    STATEA
 14803                                    CRTCARRA
 14804                                    GROUPA
 14805                                    CRTLNMEA
 14806                                    CRTFNMEA
 14807                                    CRTINITA
 14808                                    JNTLNMEA
 14809                                    JNTFNMEA
 14810                                    JNTINITA.
 14811     MOVE AL-UNNON               TO ISSAGEA
 14812                                    JNTAGEA.
 14813
 14814     IF CM-SSN-STATE   = CM-STATE AND
 14815        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 14816*        NEXT SENTENCE
 14817         CONTINUE
 14818     ELSE
 14819         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 14820     END-IF.
 14821
 14822     MOVE AL-UANON               TO CRTSSNA.
 14823
 14824     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 14825     MOVE '2'                    TO DC-OPTION-CODE.
 14826     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14827     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 14828
 14829*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14830     MOVE SPACES                 TO ELCNTL-KEY.
 14831     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 280
* EL130.cbl
 14832     MOVE '3'                    TO CNTL-REC-TYPE.
 14833     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14834     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14835
 14836
 14837
 14838* EXEC CICS READ
 14839*        DATASET  (ELCNTL-DSID)
 14840*        SET      (ADDRESS OF CONTROL-FILE)
 14841*        RIDFLD   (ELCNTL-KEY)
 14842*        RESP     (WS-RESPONSE)
 14843*    END-EXEC.
 14844*    MOVE '&"S        E          (  N#00013421' TO DFHEIV0
 14845     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14846     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14847     MOVE X'204E233030303133343231' TO DFHEIV0(25:11)
 14848     CALL 'kxdfhei1' USING DFHEIV0,
 14849           ELCNTL-DSID,
 14850           DFHEIV20,
 14851           DFHEIV99,
 14852           ELCNTL-KEY,
 14853           DFHEIV99,
 14854           DFHEIV99,
 14855           DFHEIV99
 14856     SET ADDRESS OF CONTROL-FILE TO
 14857         DFHEIV20
 14858     MOVE EIBRESP  TO WS-RESPONSE
 14859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14860
 14861
 14862     IF WS-RESP-NOTFND
 14863          MOVE ER-2848           TO EMI-ERROR
 14864          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14865          GO TO 8100-SEND-INITIAL-MAP
 14866     END-IF.
 14867
 14868     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 14869     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 14870     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 281
* EL130.cbl
 14872     IF CM-LF-BENEFIT-CD = '00'
 14873         MOVE ZEROS              TO LCVOTRMO
 14874                                    LCVRTRMO
 14875                                    LCVRATEO
 14876                                    LCVBENEO
 14877         MOVE SPACES             TO LCVDSCRO
 14878                                    LCVCDO
 14879                                    LCVKINDO
 14880                                    LCVFORMO
 14881                                    LCVCNDTO
 14882                                    LCVEXITO
 14883                                    LCVSTATO
 14884         IF CLMTYPEL GREATER THAN ZERO AND
 14885            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14886                MOVE ER-0521     TO EMI-ERROR
 14887                MOVE AL-UABON    TO CLMTYPEA
 14888                MOVE -1          TO CLMTYPEL
 14889                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14890                GO TO 7060-FILL-AH-COVERAGE
 14891         ELSE
 14892             GO TO 7060-FILL-AH-COVERAGE
 14893         END-IF
 14894     END-IF.
 14895
 14896     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14897     MOVE AL-UANON               TO LCVDSCRA.
 14898     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 14899     MOVE '4'                    TO WS-REC-TYPE.
 14900     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14901     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 14902     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 14903     MOVE AL-UANON               TO LCVCDA.
 14904     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 14905                                    CP-ORIGINAL-TERM.
 14906     MOVE AL-UNNON               TO LCVOTRMA.
 14907     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14908     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14909     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14910     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14911     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14912     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14913
 14914     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14915     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14916
 14917     IF CM-LF-PREMIUM-RATE NUMERIC
 14918         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14919     ELSE
 14920         MOVE ZEROS              TO LCVRATEO
 14921     END-IF.
 14922
 14923     MOVE AL-UNNON               TO LCVRATEA.
 14924
 14925     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14926         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 14927     END-IF.
 14928
 14929     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 282
* EL130.cbl
 14930
 14931     MOVE AL-UNNON               TO LCVBENEA.
 14932
 14933     IF CM-POLICY-FORM-NO NOT = SPACES
 14934         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 14935     ELSE
 14936         MOVE WS-FORM-HOLD       TO LCVFORMO
 14937     END-IF.
 14938
 14939     MOVE SPACES                 TO WS-FORM-HOLD.
 14940     MOVE 'L'                    TO WS-REC-TYPE.
 14941     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 14942
 14943     IF WS-FORM-HOLD NOT = SPACES
 14944         MOVE WS-FORM-HOLD       TO LCVFORMO
 14945         MOVE AL-UANON           TO LCVFORMA
 14946     END-IF.
 14947
 14948     IF CM-LF-CURRENT-STATUS = '8'
 14949         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14950             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14951             MOVE ' '             TO DC-OPTION-CODE
 14952             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14953             IF NOT DATE-CONVERSION-ERROR
 14954                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14955                 MOVE AL-UANON            TO LCVCNDTA
 14956             END-IF
 14957         END-IF
 14958     END-IF.
 14959
 14960     IF CM-LF-CURRENT-STATUS = '7'
 14961         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14962             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 14963             MOVE ' '            TO DC-OPTION-CODE
 14964             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14965             IF NOT DATE-CONVERSION-ERROR
 14966                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14967                 MOVE AL-UANON   TO LCVCNDTA
 14968             END-IF
 14969         END-IF
 14970     END-IF.
 14971
 14972     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14973         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 14974             MOVE ' '            TO DC-OPTION-CODE
 14975             MOVE CM-LF-DEATH-EXIT-DT
 14976                                 TO DC-BIN-DATE-1
 14977             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14978             IF NOT DATE-CONVERSION-ERROR
 14979                 MOVE DC-GREG-DATE-1-EDIT
 14980                                 TO LCVEXITO
 14981             END-IF
 14982         END-IF
 14983     END-IF.
 14984
 14985     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14986         IF CP-REMAINING-TERM-3 = ZEROS
 14987             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 283
* EL130.cbl
 14988         ELSE
 14989             MOVE 'ACTIVE'       TO LCVSTATO
 14990         END-IF
 14991     END-IF.
 14992
 14993     IF CM-LF-CURRENT-STATUS = '2'
 14994        MOVE 'PEND  '            TO LCVSTATO
 14995     END-IF.
 14996     IF CM-LF-CURRENT-STATUS = '3'
 14997        MOVE 'RESTORE'           TO LCVSTATO
 14998     END-IF.
 14999     IF CM-LF-CURRENT-STATUS = '5'
 15000        MOVE 'REISSUE'           TO LCVSTATO
 15001     END-IF.
 15002     IF CM-LF-CURRENT-STATUS = '6'
 15003        MOVE 'LMP DIS'           TO LCVSTATO
 15004     END-IF.
 15005     IF CM-LF-CURRENT-STATUS = '7'
 15006        MOVE 'DEATH  '           TO LCVSTATO
 15007     END-IF.
 15008     IF CM-LF-CURRENT-STATUS = '8'
 15009        MOVE 'CANCEL '           TO LCVSTATO
 15010     END-IF.
 15011     IF CM-LF-CURRENT-STATUS = '9'
 15012        MOVE 'RE-ONLY'           TO LCVSTATO
 15013     END-IF.
 15014     IF CM-LF-CURRENT-STATUS = 'V'
 15015        MOVE 'VOID   '           TO LCVSTATO
 15016     END-IF.
 15017     IF CM-LF-CURRENT-STATUS = 'D'
 15018        MOVE 'DECLINE'           TO LCVSTATO
 15019     END-IF.
 15020
 15021     IF PI-COMPANY-ID = 'CID'
 15022         IF CM-LF-BENEFIT-CD >= '2O' AND
 15023            CM-LF-BENEFIT-CD <= '2V'
 15024             MOVE ER-0878       TO EMI-ERROR
 15025             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15026         END-IF
 15027     END-IF.
 15028
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 284
* EL130.cbl
 15030 7060-FILL-AH-COVERAGE.
 15031
 15032     IF CM-AH-BENEFIT-CD = '00'
 15033         MOVE ZEROS              TO ACVOTRMO
 15034                                    ACVRTRMO
 15035                                    ACVRATEO
 15036                                    ACVBENEO
 15037         MOVE SPACES             TO ACVDSCRO
 15038                                    ACVCDO
 15039                                    ACVKINDO
 15040                                    ACVFORMO
 15041                                    ACVCNDTO
 15042                                    ACVEXITO
 15043                                    ACVSTATO
 15044         IF (CLMTYPEL GREATER THAN ZERO AND
 15045             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 15046             MOVE ER-0521     TO EMI-ERROR
 15047             MOVE AL-UABON    TO CLMTYPEA
 15048             MOVE -1          TO CLMTYPEL
 15049             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15050             GO TO 7070-BUILD-MAP-FINISH
 15051         ELSE
 15052             GO TO 7070-BUILD-MAP-FINISH
 15053         END-IF
 15054     END-IF.
 15055
 15056     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15057     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 15058     MOVE AL-UANON               TO ACVDSCRA
 15059                                    ACVCDA.
 15060     MOVE '5'                    TO WS-REC-TYPE.
 15061     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 15062     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 15063
 15064     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 15065                                    CP-ORIGINAL-TERM.
 15066     MOVE AL-UNNON               TO ACVOTRMA.
 15067
 15068     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15069     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15070     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 15071     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15072     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15073     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15074
 15075     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 15076     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15077
 15078     IF CM-AH-PREMIUM-RATE NUMERIC
 15079         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15080     ELSE
 15081         MOVE ZEROS              TO ACVRATEO
 15082     END-IF.
 15083
 15084     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 15085     MOVE AL-UNNON               TO ACVRATEA
 15086                                    ACVBENEA.
 15087
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 285
* EL130.cbl
 15088     IF CM-POLICY-FORM-NO NOT = SPACES
 15089         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 15090     ELSE
 15091         MOVE WS-FORM-HOLD       TO ACVFORMO
 15092         MOVE SPACES TO WS-FORM-HOLD
 15093         MOVE 'A'                TO WS-REC-TYPE
 15094         PERFORM 7400-READ-STATE THRU 7499-EXIT
 15095         IF WS-FORM-HOLD NOT = SPACES
 15096             MOVE WS-FORM-HOLD   TO ACVFORMO
 15097         END-IF
 15098     END-IF.
 15099
 15100     MOVE AL-UANON               TO ACVFORMA.
 15101
 15102     IF CM-AH-CURRENT-STATUS = '8'
 15103         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 15104             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15105             MOVE ' '             TO DC-OPTION-CODE
 15106             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15107             IF NOT DATE-CONVERSION-ERROR
 15108                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 15109                MOVE AL-UANON    TO ACVCNDTA
 15110             END-IF
 15111         END-IF
 15112     END-IF.
 15113
 15114     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15115         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15116             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 15117             MOVE ' '             TO DC-OPTION-CODE
 15118             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15119             IF NOT DATE-CONVERSION-ERROR
 15120                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 15121                MOVE AL-UANON            TO ACVCNDTA
 15122             END-IF
 15123         END-IF
 15124     END-IF.
 15125
 15126     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15127         MOVE ' '                TO DC-OPTION-CODE
 15128         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15129         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15130         IF NOT DATE-CONVERSION-ERROR
 15131             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 15132         END-IF
 15133     END-IF.
 15134
 15135     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15136         IF CP-REMAINING-TERM-3 = ZEROS
 15137             MOVE 'EXPIRED'      TO ACVSTATO
 15138         ELSE
 15139             MOVE 'ACTIVE'       TO ACVSTATO
 15140         END-IF
 15141     END-IF.
 15142
 15143     IF CM-AH-CURRENT-STATUS = '2'
 15144         MOVE 'PEND  '           TO ACVSTATO
 15145     END-IF.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 286
* EL130.cbl
 15146     IF CM-AH-CURRENT-STATUS = '3'
 15147         MOVE 'RESTORE'          TO ACVSTATO
 15148     END-IF.
 15149     IF CM-AH-CURRENT-STATUS = '5'
 15150         MOVE 'REISSUE'          TO ACVSTATO
 15151     END-IF.
 15152     IF CM-AH-CURRENT-STATUS = '6'
 15153         MOVE 'LMP DIS'          TO ACVSTATO
 15154     END-IF.
 15155     IF CM-AH-CURRENT-STATUS = '7'
 15156         MOVE 'DEATH  '          TO ACVSTATO
 15157     END-IF.
 15158     IF CM-AH-CURRENT-STATUS = '8'
 15159         MOVE 'CANCEL '          TO ACVSTATO
 15160     END-IF.
 15161     IF CM-AH-CURRENT-STATUS = '9'
 15162         MOVE 'RE-ONLY'          TO ACVSTATO
 15163     END-IF.
 15164     IF CM-AH-CURRENT-STATUS = 'V'
 15165         MOVE 'VOID   '          TO ACVSTATO
 15166     END-IF.
 15167     IF CM-AH-CURRENT-STATUS = 'D'
 15168         MOVE 'DECLINE'          TO ACVSTATO
 15169     END-IF.
 15170
 15171     IF PI-COMPANY-ID = 'DCC' OR 'VPP'
 15172        IF CM-ACCOUNT (9:2) = 'BI'
 15173           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 15174           MOVE CM-CARRIER       TO CTRLR-CARRIER
 15175           MOVE CM-GROUPING      TO CTRLR-GROUPING
 15176           MOVE CM-STATE         TO CTRLR-STATE
 15177           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 15178           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 15179           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 15180           MOVE 'C'              TO CTRLR-REC-TYPE
 15181
 15182* EXEC CICS READ
 15183*            DATASET  (ELCRTT-DSID)
 15184*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 15185*            RIDFLD   (ELCRTT-KEY)
 15186*            RESP     (WS-RESPONSE)
 15187*          END-EXEC
 15188*    MOVE '&"S        E          (  N#00013747' TO DFHEIV0
 15189     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15190     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15191     MOVE X'204E233030303133373437' TO DFHEIV0(25:11)
 15192     CALL 'kxdfhei1' USING DFHEIV0,
 15193           ELCRTT-DSID,
 15194           DFHEIV20,
 15195           DFHEIV99,
 15196           ELCRTT-KEY,
 15197           DFHEIV99,
 15198           DFHEIV99,
 15199           DFHEIV99
 15200     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 15201         DFHEIV20
 15202     MOVE EIBRESP  TO WS-RESPONSE
 15203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 287
* EL130.cbl
 15204           IF WS-RESP-NORMAL
 15205               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 15206               MOVE WS-DIAG-VIN-MSG TO DIAGO
 15207               MOVE AL-UANON        TO DIAGA
 15208           END-IF
 15209        END-IF
 15210     END-IF.
 15211
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 288
* EL130.cbl
 15213 7070-BUILD-MAP-FINISH.
 15214     MOVE CM-LOAN-APR            TO APRO.
 15215     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15216     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15217     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 15218     MOVE AL-UNNON               TO APRA
 15219                                    PMTFREQA.
 15220     MOVE AL-UANON               TO INDGRPA
 15221                                    PREMTYPA.
 15222
 15223     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 15224         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 15225         MOVE AL-UANON               TO REINCDA
 15226     END-IF.
 15227
 15228     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 15229*        NEXT SENTENCE
 15230         CONTINUE
 15231     ELSE
 15232         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15233         MOVE ' '                TO DC-OPTION-CODE
 15234         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15235         IF NOT DATE-CONVERSION-ERROR
 15236             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 15237             MOVE AL-UANON            TO ADDONDTA
 15238         END-IF
 15239     END-IF.
 15240
 15241     IF CLAIM-SWITCH = 'N'
 15242         IF SEXL = ZEROS
 15243             MOVE CM-INSURED-SEX TO SEXO
 15244*            MOVE AL-UANON       TO SEXA
 15245         END-IF
 15246     END-IF.
 15247
 15248     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 15249         MOVE CM-MEMBER-NO       TO MEMBERO
 15250         MOVE AL-UANON           TO MEMBERA
 15251     END-IF.
 15252
 15253     IF MAINTI = 'A'
 15254         IF (LOANNOL = ZEROS OR
 15255             EIBAID = DFHPF5)
 15256             MOVE CM-LOAN-NUMBER TO LOANNOO
 15257             MOVE AL-UANON       TO LOANNOA
 15258         ELSE
 15259*            NEXT SENTENCE
 15260             CONTINUE
 15261         END-IF
 15262     ELSE
 15263         MOVE CM-LOAN-NUMBER     TO LOANNOO
 15264         MOVE AL-UANON           TO LOANNOA
 15265     END-IF.
 15266
 15267     IF MAINTI = 'A'
 15268         IF (LOANBALL = ZEROS OR
 15269             EIBAID = DFHPF5)
 15270             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 289
* EL130.cbl
 15271             MOVE AL-UNNON       TO LOANBALA
 15272         ELSE
 15273*            NEXT SENTENCE
 15274             CONTINUE
 15275         END-IF
 15276     ELSE
 15277         MOVE CM-LOAN-BALANCE    TO LOANBALO
 15278         MOVE AL-UNNON           TO LOANBALA
 15279     END-IF.
 15280
 15281     IF CM-PREMIUM-TYPE NOT = '3'
 15282         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15283             PERFORM 7200-PROTECT-CERT-FIELDS
 15284         ELSE
 15285             PERFORM 7300-RESET-KEY-ATTRBS
 15286         END-IF
 15287     ELSE
 15288         PERFORM 7300-RESET-KEY-ATTRBS
 15289     END-IF.
 15290
 15291*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15292*        NEXT SENTENCE
 15293*        CONTINUE
 15294*    ELSE
 15295         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15296*    END-IF.
 15297
 15298 7099-EXIT.
 15299     EXIT.
 15300
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 290
* EL130.cbl
 15302 7100-READ-BENEFIT.
 15303
 15304
 15305* EXEC CICS HANDLE CONDITION
 15306*         NOTFND   (7120-NOT-FOUND)
 15307*    END-EXEC.
 15308*    MOVE '"$I                   ! F #00013853' TO DFHEIV0
 15309     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15310     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15311     MOVE X'4620233030303133383533' TO DFHEIV0(25:11)
 15312     CALL 'kxdfhei1' USING DFHEIV0
 15313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15314
 15315
 15316     MOVE SPACES                 TO ELCNTL-KEY.
 15317     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 15318     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 15319     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15320     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15321
 15322 7105-READ-FILE.
 15323     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 15324
 15325     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 15326        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 15327          GO TO 7120-NOT-FOUND
 15328     END-IF.
 15329
 15330     MOVE 1                      TO SUB.
 15331 7110-LOOP.
 15332     IF SUB = 9
 15333         GO TO 7120-NOT-FOUND
 15334     END-IF.
 15335
 15336     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 15337         ADD 1                   TO SUB
 15338         GO TO 7110-LOOP
 15339     END-IF.
 15340
 15341     if ws-rec-type = '4'
 15342        move cf-joint-indicator (sub)
 15343                                 to ws-lf-joint-indicator
 15344     else
 15345        move cf-joint-indicator (sub)
 15346                                 to ws-ah-joint-indicator
 15347     end-if
 15348     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 15349     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 15350     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 15351
 15352     GO TO 7199-EXIT.
 15353
 15354 7120-NOT-FOUND.
 15355     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 15356                                    WS-FORM-HOLD.
 15357
 15358 7199-EXIT.
 15359      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 291
* EL130.cbl
 15360
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 292
* EL130.cbl
 15362 7200-PROTECT-CERT-FIELDS.
 15363     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15364                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15365                                LCVFORMA ACVFORMA JNTLNMEA
 15366                                JNTFNMEA JNTINITA.
 15367
 15368     IF CM-LF-CURRENT-STATUS = '2' OR
 15369        CM-AH-CURRENT-STATUS = '2'
 15370         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 15371     END-IF.
 15372
 15373     MOVE AL-SANOF TO
 15374            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 15375            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 15376            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 15377            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 15378            LCVRATEA   ACVRATEA.
 15379
 15380     MOVE 'S'                    TO CERTMTI.
 15381
 15382 7300-RESET-KEY-ATTRBS.
 15383     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15384                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15385                                LCVFORMA ACVFORMA JNTLNMEA
 15386                                JNTFNMEA JNTINITA.
 15387
 15388     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15389         MOVE AL-SANOF           TO REINCDA
 15390     END-IF.
 15391
 15392     MOVE 'S'                    TO CERTMTI.
 15393
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 293
* EL130.cbl
 15395 7400-READ-STATE.
 15396
 15397
 15398* EXEC CICS HANDLE CONDITION
 15399*         NOTFND   (7499-EXIT)
 15400*    END-EXEC.
 15401*    MOVE '"$I                   ! G #00013938' TO DFHEIV0
 15402     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15403     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15404     MOVE X'4720233030303133393338' TO DFHEIV0(25:11)
 15405     CALL 'kxdfhei1' USING DFHEIV0
 15406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15407
 15408
 15409     MOVE SPACES                 TO ELCNTL-KEY.
 15410     MOVE CM-STATE               TO CNTL-ACCESS.
 15411     MOVE '3'                    TO CNTL-REC-TYPE.
 15412     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15413     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15414
 15415     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 15416
 15417     MOVE 1                      TO SUB.
 15418
 15419 7410-LOOP.
 15420     IF SUB = 21
 15421        GO TO 7499-EXIT
 15422     END-IF.
 15423
 15424*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 15425*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 15426*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 15427*        GO TO 7499-EXIT.
 15428
 15429     ADD 1                       TO SUB.
 15430     GO TO 7410-LOOP.
 15431
 15432 7499-EXIT.
 15433      EXIT.
 15434
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 294
* EL130.cbl
 15436 7500-BROWSE-FOR-DUPLICATE.
 15437
 15438     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 15439
 15440
 15441
 15442* EXEC CICS HANDLE CONDITION
 15443*        NOTFND   (7500-EXIT)
 15444*        DUPKEY   (7500-DUPLICATE-KEY)
 15445*        ENDFILE  (7500-EXIT)
 15446*    END-EXEC.
 15447*    MOVE '"$I$''                 ! H #00013974' TO DFHEIV0
 15448     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 15449     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15450     MOVE X'4820233030303133393734' TO DFHEIV0(25:11)
 15451     CALL 'kxdfhei1' USING DFHEIV0
 15452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15453
 15454
 15455
 15456
 15457* EXEC CICS STARTBR
 15458*        DATASET    (ELMSTR5-DSID)
 15459*        RIDFLD     (ELMSTR5-KEY)
 15460*    END-EXEC.
 15461     MOVE 0
 15462       TO DFHEIV11
 15463*    MOVE '&,         G          &   #00013981' TO DFHEIV0
 15464     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15465     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15466     MOVE X'2020233030303133393831' TO DFHEIV0(25:11)
 15467     CALL 'kxdfhei1' USING DFHEIV0,
 15468           ELMSTR5-DSID,
 15469           ELMSTR5-KEY,
 15470           DFHEIV99,
 15471           DFHEIV11,
 15472           DFHEIV99
 15473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15474
 15475
 15476
 15477
 15478* EXEC CICS HANDLE CONDITION
 15479*        ENDFILE  (7500-END-BROWSE)
 15480*    END-EXEC.
 15481*    MOVE '"$''                   ! I #00013987' TO DFHEIV0
 15482     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15484     MOVE X'4920233030303133393837' TO DFHEIV0(25:11)
 15485     CALL 'kxdfhei1' USING DFHEIV0
 15486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15487
 15488
 15489 7500-READ-CLAIM-LOOP.
 15490
 15491
 15492
 15493* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 295
* EL130.cbl
 15494*        DATASET   (ELMSTR5-DSID)
 15495*        SET       (ADDRESS OF CLAIM-MASTER)
 15496*        RIDFLD    (ELMSTR5-KEY)
 15497*    END-EXEC.
 15498     MOVE 0
 15499       TO DFHEIV11
 15500*    MOVE '&.S                   )   #00013994' TO DFHEIV0
 15501     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15502     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15503     MOVE X'2020233030303133393934' TO DFHEIV0(25:11)
 15504     CALL 'kxdfhei1' USING DFHEIV0,
 15505           ELMSTR5-DSID,
 15506           DFHEIV20,
 15507           DFHEIV99,
 15508           ELMSTR5-KEY,
 15509           DFHEIV99,
 15510           DFHEIV11,
 15511           DFHEIV99,
 15512           DFHEIV99
 15513     SET ADDRESS OF CLAIM-MASTER TO
 15514         DFHEIV20
 15515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15516
 15517
 15518 7500-DUPLICATE-KEY.
 15519
 15520     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 15521        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 15522        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 15523        CL-CERT-STATE     NOT = CM-STATE       OR
 15524        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 15525        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 15526        CL-CERT-NO        NOT = CM-CERT-NO
 15527           GO TO 7500-CHECK-MATCH-COUNT
 15528     END-IF.
 15529
 15530     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 15531
 15532     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 15533        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 15534        GO TO 7500-END-BROWSE
 15535     ELSE
 15536        GO TO 7500-READ-CLAIM-LOOP
 15537     END-IF.
 15538
 15539 7500-CHECK-MATCH-COUNT.
 15540
 15541     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 15542        CL-CERT-NO    = CM-CERT-NO
 15543          GO TO 7500-READ-CLAIM-LOOP
 15544     END-IF.
 15545
 15546 7500-END-BROWSE.
 15547
 15548
 15549
 15550* EXEC CICS ENDBR
 15551*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 296
* EL130.cbl
 15552*    END-EXEC.
 15553     MOVE 0
 15554       TO DFHEIV11
 15555*    MOVE '&2                    $   #00014031' TO DFHEIV0
 15556     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15557     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15558     MOVE X'2020233030303134303331' TO DFHEIV0(25:11)
 15559     CALL 'kxdfhei1' USING DFHEIV0,
 15560           ELMSTR5-DSID,
 15561           DFHEIV11,
 15562           DFHEIV99
 15563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15564
 15565
 15566 7500-EXIT.
 15567     EXIT.
 15568
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 297
* EL130.cbl
 15570 7550-FALL-THRU-PARA.
 15571
 15572
 15573
 15574* EXEC CICS DUMP
 15575*         DUMPCODE ('E130')
 15576*         TASK
 15577*    END-EXEC.
 15578     MOVE 'E130' TO DFHEIV5
 15579*    MOVE '<"   T                $   #00014042' TO DFHEIV0
 15580     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 15581     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15582     MOVE X'2020233030303134303432' TO DFHEIV0(25:11)
 15583     CALL 'kxdfhei1' USING DFHEIV0,
 15584           DFHEIV5,
 15585           DFHEIV99,
 15586           DFHEIV99
 15587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15588
 15589
 15590
 15591
 15592* EXEC CICS RETURN
 15593*    END-EXEC.
 15594*    MOVE '.(                    ''   #00014048' TO DFHEIV0
 15595     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15596     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15597     MOVE X'2020233030303134303438' TO DFHEIV0(25:11)
 15598     CALL 'kxdfhei1' USING DFHEIV0,
 15599           DFHEIV99,
 15600           DFHEIV99,
 15601           DFHEIV99,
 15602           DFHEIV99,
 15603           DFHEIV99,
 15604           DFHEIV99
 15605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15606
 15607
 15608 7600-BROWSE-CLAIM.
 15609
 15610
 15611
 15612* EXEC CICS READ
 15613*        DATASET(ELMSTR-DSID)
 15614*        SET    (ADDRESS OF CLAIM-MASTER)
 15615*        RIDFLD (ELMSTR-KEY)
 15616*        GENERIC
 15617*        EQUAL
 15618*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15619*    END-EXEC.
 15620*    MOVE '&"S  KG    E          (   #00014054' TO DFHEIV0
 15621     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15622     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15623     MOVE X'2020233030303134303534' TO DFHEIV0(25:11)
 15624     CALL 'kxdfhei1' USING DFHEIV0,
 15625           ELMSTR-DSID,
 15626           DFHEIV20,
 15627           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 298
* EL130.cbl
 15628           ELMSTR-KEY,
 15629           ELMSTR-GENERIC-LENGTH,
 15630           DFHEIV99,
 15631           DFHEIV99
 15632     SET ADDRESS OF CLAIM-MASTER TO
 15633         DFHEIV20
 15634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15635
 15636
 15637     MOVE CL-CERT-PRIME          TO CERTNOI.
 15638     MOVE CL-CERT-SFX            TO SUFXI.
 15639
 15640 7610-BROWSE-CLAIM-LOOP.
 15641
 15642     MOVE LOW-VALUES             TO BCERT1O
 15643                                    BSUFX1O
 15644                                    BCERT2O
 15645                                    BSUFX2O
 15646                                    BCERT3O
 15647                                    BSUFX3O
 15648                                    BCERT4O
 15649                                    BSUFX4O
 15650                                    BCERT5O
 15651                                    BSUFX5O.
 15652
 15653     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 15654
 15655
 15656
 15657* EXEC CICS HANDLE CONDITION
 15658*        ENDFILE  (7630-END-BROWSE)
 15659*    END-EXEC.
 15660*    MOVE '"$''                   ! J #00014082' TO DFHEIV0
 15661     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15663     MOVE X'4A20233030303134303832' TO DFHEIV0(25:11)
 15664     CALL 'kxdfhei1' USING DFHEIV0
 15665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15666
 15667
 15668
 15669
 15670* EXEC CICS STARTBR
 15671*        DATASET    (ELMSTR-DSID)
 15672*        RIDFLD     (ELMSTR-KEY)
 15673*    END-EXEC.
 15674     MOVE 0
 15675       TO DFHEIV11
 15676*    MOVE '&,         G          &   #00014087' TO DFHEIV0
 15677     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15678     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15679     MOVE X'2020233030303134303837' TO DFHEIV0(25:11)
 15680     CALL 'kxdfhei1' USING DFHEIV0,
 15681           ELMSTR-DSID,
 15682           ELMSTR-KEY,
 15683           DFHEIV99,
 15684           DFHEIV11,
 15685           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 299
* EL130.cbl
 15686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15687
 15688
 15689     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15690
 15691 7620-READ-CLAIM-LOOP.
 15692
 15693
 15694
 15695* EXEC CICS READNEXT
 15696*        DATASET   (ELMSTR-DSID)
 15697*        SET       (ADDRESS OF CLAIM-MASTER)
 15698*        RIDFLD    (ELMSTR-KEY)
 15699*    END-EXEC.
 15700     MOVE 0
 15701       TO DFHEIV11
 15702*    MOVE '&.S                   )   #00014097' TO DFHEIV0
 15703     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15704     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15705     MOVE X'2020233030303134303937' TO DFHEIV0(25:11)
 15706     CALL 'kxdfhei1' USING DFHEIV0,
 15707           ELMSTR-DSID,
 15708           DFHEIV20,
 15709           DFHEIV99,
 15710           ELMSTR-KEY,
 15711           DFHEIV99,
 15712           DFHEIV11,
 15713           DFHEIV99,
 15714           DFHEIV99
 15715     SET ADDRESS OF CLAIM-MASTER TO
 15716         DFHEIV20
 15717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15718
 15719
 15720     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 15721        CL-CARRIER     NOT = CLMCARRI       OR
 15722        CL-CLAIM-NO    NOT = CLMNOI
 15723          GO TO 7630-END-BROWSE
 15724     END-IF.
 15725
 15726     IF WS-ASSOCIATED-CERTS = 1
 15727         MOVE CL-CERT-PRIME      TO BCERT1O
 15728         MOVE CL-CERT-SFX        TO BSUFX1O
 15729     END-IF.
 15730
 15731     IF WS-ASSOCIATED-CERTS = 2
 15732         MOVE CL-CERT-PRIME      TO BCERT2O
 15733         MOVE CL-CERT-SFX        TO BSUFX2O
 15734     END-IF.
 15735
 15736     IF WS-ASSOCIATED-CERTS = 3
 15737         MOVE CL-CERT-PRIME      TO BCERT3O
 15738         MOVE CL-CERT-SFX        TO BSUFX3O
 15739     END-IF.
 15740
 15741     IF WS-ASSOCIATED-CERTS = 4
 15742         MOVE CL-CERT-PRIME      TO BCERT4O
 15743         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 300
* EL130.cbl
 15744     END-IF.
 15745
 15746     IF WS-ASSOCIATED-CERTS = 5
 15747         MOVE CL-CERT-PRIME      TO BCERT5O
 15748         MOVE CL-CERT-SFX        TO BSUFX5O
 15749     ELSE
 15750         ADD +1                  TO WS-ASSOCIATED-CERTS
 15751         GO TO 7620-READ-CLAIM-LOOP
 15752     END-IF.
 15753
 15754 7630-END-BROWSE.
 15755
 15756
 15757
 15758* EXEC CICS ENDBR
 15759*        DATASET   (ELMSTR-DSID)
 15760*    END-EXEC.
 15761     MOVE 0
 15762       TO DFHEIV11
 15763*    MOVE '&2                    $   #00014140' TO DFHEIV0
 15764     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15765     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15766     MOVE X'2020233030303134313430' TO DFHEIV0(25:11)
 15767     CALL 'kxdfhei1' USING DFHEIV0,
 15768           ELMSTR-DSID,
 15769           DFHEIV11,
 15770           DFHEIV99
 15771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15772
 15773
 15774 7640-HIGHLIGHT-CERT-DISPLAYED.
 15775
 15776     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 15777     MOVE AL-SANON               TO BCERT1A
 15778                                    BSUFX1A
 15779                                    BCERT2A
 15780                                    BSUFX2A
 15781                                    BCERT3A
 15782                                    BSUFX3A
 15783                                    BCERT4A
 15784                                    BSUFX4A
 15785                                    BCERT5A
 15786                                    BSUFX5A.
 15787
 15788     IF BCERT1O = CERTNOI AND
 15789        BSUFX1O = SUFXI
 15790            MOVE AL-SABON        TO BCERT1A
 15791                                    BSUFX1A
 15792     END-IF.
 15793
 15794     IF BCERT2O = CERTNOI AND
 15795        BSUFX2O = SUFXI
 15796            MOVE AL-SABON        TO BCERT2A
 15797                                    BSUFX2A
 15798     END-IF.
 15799
 15800     IF BCERT3O = CERTNOI AND
 15801        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 301
* EL130.cbl
 15802            MOVE AL-SABON        TO BCERT3A
 15803                                    BSUFX3A
 15804     END-IF.
 15805
 15806     IF BCERT4O = CERTNOI AND
 15807        BSUFX4O = SUFXI
 15808            MOVE AL-SABON        TO BCERT4A
 15809                                    BSUFX4A
 15810     END-IF.
 15811
 15812     IF BCERT5O = CERTNOI AND
 15813        BSUFX5O = SUFXI
 15814            MOVE AL-SABON        TO BCERT5A
 15815                                    BSUFX5A
 15816     END-IF.
 15817
 15818 7699-EXIT.
 15819     EXIT.
 15820
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 302
* EL130.cbl
 15822 7700-CHECK-SEQUENCE.
 15823
 15824
 15825
 15826* EXEC CICS HANDLE CONDITION
 15827*        ENDFILE  (7799-EXIT)
 15828*        NOTFND   (7799-EXIT)
 15829*    END-EXEC.
 15830*    MOVE '"$''I                  ! K #00014195' TO DFHEIV0
 15831     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15832     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15833     MOVE X'4B20233030303134313935' TO DFHEIV0(25:11)
 15834     CALL 'kxdfhei1' USING DFHEIV0
 15835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15836
 15837
 15838
 15839
 15840* EXEC CICS READ
 15841*        DATASET(ELMSTR-DSID)
 15842*        SET    (ADDRESS OF CLAIM-MASTER)
 15843*        RIDFLD (ELMSTR-KEY)
 15844*        GENERIC
 15845*        EQUAL
 15846*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15847*    END-EXEC.
 15848*    MOVE '&"S  KG    E          (   #00014201' TO DFHEIV0
 15849     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15850     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15851     MOVE X'2020233030303134323031' TO DFHEIV0(25:11)
 15852     CALL 'kxdfhei1' USING DFHEIV0,
 15853           ELMSTR-DSID,
 15854           DFHEIV20,
 15855           DFHEIV99,
 15856           ELMSTR-KEY,
 15857           ELMSTR-GENERIC-LENGTH,
 15858           DFHEIV99,
 15859           DFHEIV99
 15860     SET ADDRESS OF CLAIM-MASTER TO
 15861         DFHEIV20
 15862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15863
 15864
 15865     COMPUTE WS-ASSOC-CERT-TOTAL =
 15866             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15867
 15868     GO TO 7799-EXIT.
 15869
 15870 7710-RESEQUENCE-CLAIMS.
 15871
 15872
 15873
 15874* EXEC CICS HANDLE CONDITION
 15875*        ENDFILE  (7790-END-BROWSE)
 15876*    END-EXEC.
 15877*    MOVE '"$''                   ! L #00014218' TO DFHEIV0
 15878     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15879     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 303
* EL130.cbl
 15880     MOVE X'4C20233030303134323138' TO DFHEIV0(25:11)
 15881     CALL 'kxdfhei1' USING DFHEIV0
 15882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15883
 15884
 15885
 15886
 15887* EXEC CICS STARTBR
 15888*        DATASET    (ELMSTR-DSID)
 15889*        RIDFLD     (ELMSTR-KEY)
 15890*    END-EXEC.
 15891     MOVE 0
 15892       TO DFHEIV11
 15893*    MOVE '&,         G          &   #00014223' TO DFHEIV0
 15894     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15895     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15896     MOVE X'2020233030303134323233' TO DFHEIV0(25:11)
 15897     CALL 'kxdfhei1' USING DFHEIV0,
 15898           ELMSTR-DSID,
 15899           ELMSTR-KEY,
 15900           DFHEIV99,
 15901           DFHEIV11,
 15902           DFHEIV99
 15903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15904
 15905
 15906     ADD +1 TO WS-ASSOC-CERT-SEQU
 15907               WS-READNEXT-SWITCH.
 15908
 15909 7720-READ-CLAIM-LOOP.
 15910
 15911
 15912
 15913* EXEC CICS READNEXT
 15914*        DATASET   (ELMSTR-DSID)
 15915*        SET       (ADDRESS OF CLAIM-MASTER)
 15916*        RIDFLD    (ELMSTR-KEY)
 15917*    END-EXEC.
 15918     MOVE 0
 15919       TO DFHEIV11
 15920*    MOVE '&.S                   )   #00014234' TO DFHEIV0
 15921     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15922     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15923     MOVE X'2020233030303134323334' TO DFHEIV0(25:11)
 15924     CALL 'kxdfhei1' USING DFHEIV0,
 15925           ELMSTR-DSID,
 15926           DFHEIV20,
 15927           DFHEIV99,
 15928           ELMSTR-KEY,
 15929           DFHEIV99,
 15930           DFHEIV11,
 15931           DFHEIV99,
 15932           DFHEIV99
 15933     SET ADDRESS OF CLAIM-MASTER TO
 15934         DFHEIV20
 15935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15936
 15937
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 304
* EL130.cbl
 15938     IF WS-READNEXT-SWITCH = 1
 15939         ADD 1 TO WS-READNEXT-SWITCH
 15940         GO TO 7720-READ-CLAIM-LOOP
 15941     END-IF.
 15942
 15943 7730-END-BROWSE.
 15944
 15945
 15946
 15947* EXEC CICS ENDBR
 15948*        DATASET   (ELMSTR-DSID)
 15949*    END-EXEC.
 15950     MOVE 0
 15951       TO DFHEIV11
 15952*    MOVE '&2                    $   #00014248' TO DFHEIV0
 15953     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15954     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15955     MOVE X'2020233030303134323438' TO DFHEIV0(25:11)
 15956     CALL 'kxdfhei1' USING DFHEIV0,
 15957           ELMSTR-DSID,
 15958           DFHEIV11,
 15959           DFHEIV99
 15960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15961
 15962
 15963 7740-READ-CLAIM-UPDATE.
 15964
 15965     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 15966        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 15967        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 15968          GO TO 7799-EXIT
 15969     ELSE
 15970          MOVE ZERO              TO WS-READNEXT-SWITCH
 15971     END-IF.
 15972
 15973
 15974
 15975* EXEC CICS READ
 15976*        DATASET(ELMSTR-DSID)
 15977*        SET    (ADDRESS OF CLAIM-MASTER)
 15978*        RIDFLD (ELMSTR-KEY)
 15979*        UPDATE
 15980*    END-EXEC.
 15981*    MOVE '&"S        EU         (   #00014263' TO DFHEIV0
 15982     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15983     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15984     MOVE X'2020233030303134323633' TO DFHEIV0(25:11)
 15985     CALL 'kxdfhei1' USING DFHEIV0,
 15986           ELMSTR-DSID,
 15987           DFHEIV20,
 15988           DFHEIV99,
 15989           ELMSTR-KEY,
 15990           DFHEIV99,
 15991           DFHEIV99,
 15992           DFHEIV99
 15993     SET ADDRESS OF CLAIM-MASTER TO
 15994         DFHEIV20
 15995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 305
* EL130.cbl
 15996
 15997
 15998     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15999     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 16000
 16001
 16002
 16003* EXEC CICS REWRITE
 16004*         DATASET     (ELMSTR-DSID)
 16005*         FROM        (CLAIM-MASTER)
 16006*    END-EXEC.
 16007     MOVE LENGTH OF
 16008      CLAIM-MASTER
 16009       TO DFHEIV11
 16010*    MOVE '&& L                  %   #00014274' TO DFHEIV0
 16011     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16012     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16013     MOVE X'2020233030303134323734' TO DFHEIV0(25:11)
 16014     CALL 'kxdfhei1' USING DFHEIV0,
 16015           ELMSTR-DSID,
 16016           CLAIM-MASTER,
 16017           DFHEIV11,
 16018           DFHEIV99
 16019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16020
 16021
 16022     GO TO 7710-RESEQUENCE-CLAIMS.
 16023
 16024 7790-END-BROWSE.
 16025
 16026
 16027
 16028* EXEC CICS ENDBR
 16029*        DATASET   (ELMSTR-DSID)
 16030*    END-EXEC.
 16031     MOVE 0
 16032       TO DFHEIV11
 16033*    MOVE '&2                    $   #00014284' TO DFHEIV0
 16034     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16035     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16036     MOVE X'2020233030303134323834' TO DFHEIV0(25:11)
 16037     CALL 'kxdfhei1' USING DFHEIV0,
 16038           ELMSTR-DSID,
 16039           DFHEIV11,
 16040           DFHEIV99
 16041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16042
 16043
 16044 7799-EXIT.
 16045     EXIT.
 16046
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 306
* EL130.cbl
 16048************************************************
 16049*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 16050************************************************
 16051
 16052 7900-READ-ACTV-UPDATE.
 16053     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16054     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16055     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16056     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16057     MOVE +0                     TO TRLR-SEQ-NO.
 16058     MOVE '1'                    TO TRLR-TYPE.
 16059     GO TO 7900-READ-TRAILER-UPDATE.
 16060
 16061 7900-READ-NINETY-UPDATE.
 16062     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16063     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16064     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16065     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16066     MOVE +90                    TO TRLR-SEQ-NO.
 16067     MOVE '6'                    TO TRLR-TYPE.
 16068
 16069 7900-READ-TRAILER-UPDATE.
 16070
 16071
 16072* EXEC CICS READ  UPDATE
 16073*        DATASET    (ELTRLR-DSID)
 16074*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 16075*        RIDFLD     (ELTRLR-KEY)
 16076*    END-EXEC.
 16077*    MOVE '&"S        EU         (   #00014315' TO DFHEIV0
 16078     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16079     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16080     MOVE X'2020233030303134333135' TO DFHEIV0(25:11)
 16081     CALL 'kxdfhei1' USING DFHEIV0,
 16082           ELTRLR-DSID,
 16083           DFHEIV20,
 16084           DFHEIV99,
 16085           ELTRLR-KEY,
 16086           DFHEIV99,
 16087           DFHEIV99,
 16088           DFHEIV99
 16089     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16090         DFHEIV20
 16091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16092
 16093
 16094 7900-EXIT.
 16095      EXIT.
 16096
 16097 7910-READ-ACTV.
 16098     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16099     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16100     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16101     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16102     MOVE +0                     TO TRLR-SEQ-NO.
 16103     MOVE '1'                    TO TRLR-TYPE.
 16104     GO TO 7910-READ-TRAILER.
 16105
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 307
* EL130.cbl
 16106 7910-READ-NINETY.
 16107     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16108     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16109     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16110     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16111     MOVE +90                    TO TRLR-SEQ-NO.
 16112     MOVE '6'                    TO TRLR-TYPE.
 16113
 16114 7910-READ-TRAILER.
 16115     MOVE 'TRLR'                 TO FILE-SWITCH.
 16116
 16117
 16118
 16119* EXEC CICS READ
 16120*        DATASET   (ELTRLR-DSID)
 16121*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16122*        RIDFLD    (ELTRLR-KEY)
 16123*    END-EXEC.
 16124*    MOVE '&"S        E          (   #00014345' TO DFHEIV0
 16125     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16126     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16127     MOVE X'2020233030303134333435' TO DFHEIV0(25:11)
 16128     CALL 'kxdfhei1' USING DFHEIV0,
 16129           ELTRLR-DSID,
 16130           DFHEIV20,
 16131           DFHEIV99,
 16132           ELTRLR-KEY,
 16133           DFHEIV99,
 16134           DFHEIV99,
 16135           DFHEIV99
 16136     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16137         DFHEIV20
 16138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16139
 16140
 16141 7910-EXIT.
 16142      EXIT.
 16143
 16144 7915-REWRITE-TRAILER.
 16145
 16146
 16147* EXEC CICS REWRITE
 16148*        DATASET   (ELTRLR-DSID)
 16149*        FROM      (ACTIVITY-TRAILERS)
 16150*    END-EXEC.
 16151     MOVE LENGTH OF
 16152      ACTIVITY-TRAILERS
 16153       TO DFHEIV11
 16154*    MOVE '&& L                  %   #00014356' TO DFHEIV0
 16155     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16156     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16157     MOVE X'2020233030303134333536' TO DFHEIV0(25:11)
 16158     CALL 'kxdfhei1' USING DFHEIV0,
 16159           ELTRLR-DSID,
 16160           ACTIVITY-TRAILERS,
 16161           DFHEIV11,
 16162           DFHEIV99
 16163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 308
* EL130.cbl
 16164
 16165
 16166 7915-EXIT.
 16167      EXIT.
 16168
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 309
* EL130.cbl
 16170********************************************
 16171*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 16172********************************************
 16173
 16174 7920-READ-CLAIM-UPDATE.
 16175
 16176
 16177
 16178* EXEC CICS READ
 16179*        UPDATE
 16180*        DATASET   (ELMSTR-DSID)
 16181*        SET       (ADDRESS OF CLAIM-MASTER)
 16182*        RIDFLD    (ELMSTR-KEY)
 16183*    END-EXEC.
 16184*    MOVE '&"S        EU         (   #00014372' TO DFHEIV0
 16185     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16186     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16187     MOVE X'2020233030303134333732' TO DFHEIV0(25:11)
 16188     CALL 'kxdfhei1' USING DFHEIV0,
 16189           ELMSTR-DSID,
 16190           DFHEIV20,
 16191           DFHEIV99,
 16192           ELMSTR-KEY,
 16193           DFHEIV99,
 16194           DFHEIV99,
 16195           DFHEIV99
 16196     SET ADDRESS OF CLAIM-MASTER TO
 16197         DFHEIV20
 16198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16199
 16200
 16201 7920-EXIT.
 16202      EXIT.
 16203
 16204 7950-READ-CLAIM.
 16205
 16206
 16207* EXEC CICS READ
 16208*        DATASET   (ELMSTR-DSID)
 16209*        SET       (ADDRESS OF CLAIM-MASTER)
 16210*        RIDFLD    (ELMSTR-KEY)
 16211*    END-EXEC.
 16212*    MOVE '&"S        E          (   #00014384' TO DFHEIV0
 16213     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16214     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16215     MOVE X'2020233030303134333834' TO DFHEIV0(25:11)
 16216     CALL 'kxdfhei1' USING DFHEIV0,
 16217           ELMSTR-DSID,
 16218           DFHEIV20,
 16219           DFHEIV99,
 16220           ELMSTR-KEY,
 16221           DFHEIV99,
 16222           DFHEIV99,
 16223           DFHEIV99
 16224     SET ADDRESS OF CLAIM-MASTER TO
 16225         DFHEIV20
 16226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16227
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 310
* EL130.cbl
 16228
 16229 7950-EXIT.
 16230      EXIT.
 16231
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 311
* EL130.cbl
 16233***************************************
 16234*  I/O REQUESTS AGAINST CONTROL FILE  *
 16235***************************************
 16236
 16237 7960-READ-CNTL-UPDATE.
 16238
 16239
 16240* EXEC CICS READ
 16241*        UPDATE
 16242*        DATASET  (ELCNTL-DSID)
 16243*        SET      (ADDRESS OF CONTROL-FILE)
 16244*        RIDFLD   (ELCNTL-KEY)
 16245*    END-EXEC.
 16246*    MOVE '&"S        EU         (   #00014400' TO DFHEIV0
 16247     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16248     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16249     MOVE X'2020233030303134343030' TO DFHEIV0(25:11)
 16250     CALL 'kxdfhei1' USING DFHEIV0,
 16251           ELCNTL-DSID,
 16252           DFHEIV20,
 16253           DFHEIV99,
 16254           ELCNTL-KEY,
 16255           DFHEIV99,
 16256           DFHEIV99,
 16257           DFHEIV99
 16258     SET ADDRESS OF CONTROL-FILE TO
 16259         DFHEIV20
 16260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16261
 16262
 16263 7960-EXIT.
 16264      EXIT.
 16265
 16266 7970-READ-CNTL.
 16267
 16268
 16269* EXEC CICS READ
 16270*        DATASET  (ELCNTL-DSID)
 16271*        SET      (ADDRESS OF CONTROL-FILE)
 16272*        RIDFLD   (ELCNTL-KEY)
 16273*    END-EXEC.
 16274*    MOVE '&"S        E          (   #00014412' TO DFHEIV0
 16275     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16276     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16277     MOVE X'2020233030303134343132' TO DFHEIV0(25:11)
 16278     CALL 'kxdfhei1' USING DFHEIV0,
 16279           ELCNTL-DSID,
 16280           DFHEIV20,
 16281           DFHEIV99,
 16282           ELCNTL-KEY,
 16283           DFHEIV99,
 16284           DFHEIV99,
 16285           DFHEIV99
 16286     SET ADDRESS OF CONTROL-FILE TO
 16287         DFHEIV20
 16288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16289
 16290
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 312
* EL130.cbl
 16291 7970-EXIT.
 16292      EXIT.
 16293
 16294 7975-READ-CNTL-GTEQ.
 16295
 16296
 16297* EXEC CICS READ
 16298*         DATASET   (ELCNTL-DSID)
 16299*         SET       (ADDRESS OF CONTROL-FILE)
 16300*         RIDFLD    (ELCNTL-KEY)
 16301*         GTEQ
 16302*     END-EXEC.
 16303*    MOVE '&"S        G          (   #00014423' TO DFHEIV0
 16304     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16305     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16306     MOVE X'2020233030303134343233' TO DFHEIV0(25:11)
 16307     CALL 'kxdfhei1' USING DFHEIV0,
 16308           ELCNTL-DSID,
 16309           DFHEIV20,
 16310           DFHEIV99,
 16311           ELCNTL-KEY,
 16312           DFHEIV99,
 16313           DFHEIV99,
 16314           DFHEIV99
 16315     SET ADDRESS OF CONTROL-FILE TO
 16316         DFHEIV20
 16317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16318
 16319
 16320 7975-EXIT.
 16321      EXIT.
 16322
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 313
* EL130.cbl
 16324**************************************************
 16325*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 16326**************************************************
 16327
 16328 7980-READ-CERT5.
 16329
 16330
 16331* EXEC CICS READ
 16332*         DATASET  (ELCERT5-DSID)
 16333*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 16334*         RIDFLD   (ELCERT-KEY-5)
 16335*     END-EXEC.
 16336*    MOVE '&"S        E          (   #00014440' TO DFHEIV0
 16337     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16338     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16339     MOVE X'2020233030303134343430' TO DFHEIV0(25:11)
 16340     CALL 'kxdfhei1' USING DFHEIV0,
 16341           ELCERT5-DSID,
 16342           DFHEIV20,
 16343           DFHEIV99,
 16344           ELCERT-KEY-5,
 16345           DFHEIV99,
 16346           DFHEIV99,
 16347           DFHEIV99
 16348     SET ADDRESS OF CERTIFICATE-MASTER TO
 16349         DFHEIV20
 16350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16351
 16352
 16353 7980-EXIT.
 16354      EXIT.
 16355
 16356 7930-READ-CERT-UPDATE.
 16357
 16358
 16359* EXEC CICS READ
 16360*        DATASET  (ELCERT-DSID)
 16361*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16362*        RIDFLD   (ELCERT-KEY)
 16363*        UPDATE
 16364*    END-EXEC.
 16365*    MOVE '&"S        EU         (   #00014451' TO DFHEIV0
 16366     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16367     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16368     MOVE X'2020233030303134343531' TO DFHEIV0(25:11)
 16369     CALL 'kxdfhei1' USING DFHEIV0,
 16370           ELCERT-DSID,
 16371           DFHEIV20,
 16372           DFHEIV99,
 16373           ELCERT-KEY,
 16374           DFHEIV99,
 16375           DFHEIV99,
 16376           DFHEIV99
 16377     SET ADDRESS OF CERTIFICATE-MASTER TO
 16378         DFHEIV20
 16379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16380
 16381
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 314
* EL130.cbl
 16382 7930-EXIT.
 16383      EXIT.
 16384
 16385 7940-READ-CERT.
 16386
 16387
 16388* EXEC CICS READ
 16389*        DATASET  (ELCERT-DSID)
 16390*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16391*        RIDFLD   (ELCERT-KEY)
 16392*    END-EXEC.
 16393*    MOVE '&"S        E          (   #00014463' TO DFHEIV0
 16394     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16395     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16396     MOVE X'2020233030303134343633' TO DFHEIV0(25:11)
 16397     CALL 'kxdfhei1' USING DFHEIV0,
 16398           ELCERT-DSID,
 16399           DFHEIV20,
 16400           DFHEIV99,
 16401           ELCERT-KEY,
 16402           DFHEIV99,
 16403           DFHEIV99,
 16404           DFHEIV99
 16405     SET ADDRESS OF CERTIFICATE-MASTER TO
 16406         DFHEIV20
 16407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16408
 16409
 16410 7940-EXIT.
 16411      EXIT.
 16412
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 315
* EL130.cbl
 16414**************************************************
 16415*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 16416**************************************************
 16417
 16418 7991-READ-BENE.
 16419
 16420
 16421* EXEC CICS READ
 16422*         DATASET   (ELBENE-DSID)
 16423*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 16424*         RIDFLD    (ELBENE-KEY)
 16425*     END-EXEC.
 16426*    MOVE '&"S        E          (   #00014479' TO DFHEIV0
 16427     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16428     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16429     MOVE X'2020233030303134343739' TO DFHEIV0(25:11)
 16430     CALL 'kxdfhei1' USING DFHEIV0,
 16431           ELBENE-DSID,
 16432           DFHEIV20,
 16433           DFHEIV99,
 16434           ELBENE-KEY,
 16435           DFHEIV99,
 16436           DFHEIV99,
 16437           DFHEIV99
 16438     SET ADDRESS OF BENEFICIARY-MASTER TO
 16439         DFHEIV20
 16440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16441
 16442
 16443 7991-EXIT.
 16444      EXIT.
 16445
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 316
* EL130.cbl
 16447**************************************************
 16448*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 16449**************************************************
 16450
 16451 7992-READ-REIN.
 16452
 16453
 16454
 16455* EXEC CICS HANDLE CONDITION
 16456*        NOTFND   (7992-NOT-FOUND)
 16457*    END-EXEC.
 16458*    MOVE '"$I                   ! M #00014496' TO DFHEIV0
 16459     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16460     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16461     MOVE X'4D20233030303134343936' TO DFHEIV0(25:11)
 16462     CALL 'kxdfhei1' USING DFHEIV0
 16463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16464
 16465
 16466
 16467
 16468* EXEC CICS READ
 16469*        DATASET   (ERREIN-DSID)
 16470*        SET       (ADDRESS OF REINSURANCE-RECORD)
 16471*        RIDFLD    (ERREIN-KEY)
 16472*    END-EXEC.
 16473*    MOVE '&"S        E          (   #00014501' TO DFHEIV0
 16474     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16475     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16476     MOVE X'2020233030303134353031' TO DFHEIV0(25:11)
 16477     CALL 'kxdfhei1' USING DFHEIV0,
 16478           ERREIN-DSID,
 16479           DFHEIV20,
 16480           DFHEIV99,
 16481           ERREIN-KEY,
 16482           DFHEIV99,
 16483           DFHEIV99,
 16484           DFHEIV99
 16485     SET ADDRESS OF REINSURANCE-RECORD TO
 16486         DFHEIV20
 16487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16488
 16489
 16490     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 16491
 16492     GO TO 7992-EXIT.
 16493
 16494 7992-NOT-FOUND.
 16495     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 16496
 16497 7992-EXIT.
 16498     EXIT.
 16499
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 317
* EL130.cbl
 16501 8000-LOAD-ERROR-MESSAGES.
 16502     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 16503
 16504     IF EMI-NO-ERRORS
 16505         GO TO 8000-EXIT
 16506     END-IF.
 16507
 16508     perform varying e1 from +1 by +1 until e1 > +3
 16509        if emi-error-number (e1) = '1651' or '1652' or '1653'
 16510                                or '1655' or '1660'
 16511           move 'W'              to emi-severity (e1)
 16512        end-if
 16513     end-perform
 16514     IF EMI-NUMBER-OF-LINES = 1
 16515         MOVE EMI-LINE1          TO ERRMSG1O
 16516         GO TO 8000-EXIT
 16517     END-IF.
 16518
 16519     IF EMI-NUMBER-OF-LINES = 2
 16520          MOVE EMI-LINE1         TO ERRMSG1O
 16521          MOVE EMI-LINE2         TO ERRMSG2O
 16522          GO TO 8000-EXIT
 16523     END-IF.
 16524
 16525     MOVE EMI-LINE1              TO ERRMSG1O.
 16526
 16527 8000-EXIT.
 16528     EXIT.
 16529
 16530 8100-SEND-INITIAL-MAP.
 16531     MOVE SAVE-DATE              TO RUNDTEO.
 16532     MOVE EIBTIME                TO TIME-IN.
 16533     MOVE TIME-OUT               TO RUNTIMEO.
 16534     IF EIBAID = DFHPF11
 16535        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16537     end-if
 16538     IF RETURNED-FROM = XCTL-114
 16539        CONTINUE
 16540     ELSE
 16541        MOVE -1                  TO MAINTL
 16542     END-IF.
 16543
 16544*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16545         MOVE SPACES             TO PRODO.
 16546         MOVE AL-SANOF           TO PRODCDA.
 16547*    END-IF.
 16548
 16549     MOVE PI-COMPANY-ID          TO COMPO.
 16550     MOVE AL-PABOF               TO COMPA.
 16551     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16552     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16553     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16554
 16555     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16556
 16557     IF NOT PI-NO-CARRIER-SECURITY
 16558        MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 318
* EL130.cbl
 16559        MOVE AL-SABOF            TO CLMCARRA
 16560     END-IF.
 16561
 16562     IF PI-PROCESSOR-ID = 'PEMA'
 16563        MOVE AL-UANON            TO CERTNOA
 16564                                    SUFXA
 16565     END-IF.
 16566*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16567*        NEXT SENTENCE
 16568*        CONTINUE
 16569*    ELSE
 16570         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16571*    END-IF.
 16572
 16573
 16574
 16575* EXEC CICS SEND
 16576*        MAP     (MAP-NAME)
 16577*        MAPSET  (MAPSET-NAME)
 16578*        FROM    (EL130AO)
 16579*        ERASE
 16580*        CURSOR
 16581*    END-EXEC.
 16582     MOVE LENGTH OF
 16583      EL130AO
 16584       TO DFHEIV12
 16585     MOVE -1
 16586       TO DFHEIV11
 16587*    MOVE '8$     CT  E    H L F ,   #00014591' TO DFHEIV0
 16588     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16589     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16590     MOVE X'2020233030303134353931' TO DFHEIV0(25:11)
 16591     CALL 'kxdfhei1' USING DFHEIV0,
 16592           MAP-NAME,
 16593           EL130AO,
 16594           DFHEIV12,
 16595           MAPSET-NAME,
 16596           DFHEIV99,
 16597           DFHEIV99,
 16598           DFHEIV99,
 16599           DFHEIV11,
 16600           DFHEIV99,
 16601           DFHEIV99,
 16602           DFHEIV99
 16603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16604
 16605
 16606     GO TO 9100-RETURN-TRAN.
 16607
 16608 8150-SEND-MAP-CURSOR.
 16609     MOVE SAVE-DATE              TO RUNDTEO.
 16610     MOVE EIBTIME                TO TIME-IN.
 16611     MOVE TIME-OUT               TO RUNTIMEO.
 16612     IF EIBAID = DFHPF11
 16613        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16614        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16615     end-if
 16616     MOVE PI-COMPANY-ID          TO COMPO.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 319
* EL130.cbl
 16617     MOVE AL-PABOF               TO COMPA
 16618     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16619     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16620     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16621
 16622*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16623         MOVE SPACES             TO PRODO.
 16624         MOVE AL-SANOF           TO PRODCDA.
 16625*    END-IF.
 16626
 16627     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16628
 16629     IF NOT PI-NO-CARRIER-SECURITY
 16630         MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16631         MOVE AL-SABOF            TO CLMCARRA
 16632     END-IF.
 16633
 16634     IF PI-PROCESSOR-ID = 'PEMA'
 16635        MOVE AL-UANON            TO CERTNOA
 16636                                    SUFXA
 16637     END-IF.
 16638*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16639*        NEXT SENTENCE
 16640*        CONTINUE
 16641*    ELSE
 16642         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16643*    END-IF.
 16644
 16645
 16646
 16647* EXEC CICS SEND
 16648*        MAP      (MAP-NAME)
 16649*        MAPSET   (MAPSET-NAME)
 16650*        FROM     (EL130AO)
 16651*        CURSOR   (PI-CURSOR)
 16652*        ERASE
 16653*    END-EXEC.
 16654     MOVE LENGTH OF
 16655      EL130AO
 16656       TO DFHEIV11
 16657*    MOVE '8$     CT  E    H L F ,   #00014639' TO DFHEIV0
 16658     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16659     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16660     MOVE X'2020233030303134363339' TO DFHEIV0(25:11)
 16661     CALL 'kxdfhei1' USING DFHEIV0,
 16662           MAP-NAME,
 16663           EL130AO,
 16664           DFHEIV11,
 16665           MAPSET-NAME,
 16666           DFHEIV99,
 16667           DFHEIV99,
 16668           DFHEIV99,
 16669           PI-CURSOR,
 16670           DFHEIV99,
 16671           DFHEIV99,
 16672           DFHEIV99
 16673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16674
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 320
* EL130.cbl
 16675
 16676     GO TO 9100-RETURN-TRAN.
 16677
 16678 8200-SEND-DATAONLY.
 16679     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16680
 16681     IF EIBAID = DFHPF11
 16682        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16683        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16684        go to 8100-send-initial-map
 16685     end-if
 16686*    IF EIBAID = DFHPF11
 16687*       MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16688*       move pi-last-claim       to emi-claim-no
 16689*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16690*       go to 8100-send-initial-map
 16691*    END-IF.
 16692     .
 16693 8200-BYPASS-ERROR.
 16694     MOVE SAVE-DATE              TO RUNDTEO.
 16695     MOVE EIBTIME                TO TIME-IN.
 16696     MOVE TIME-OUT               TO RUNTIMEO.
 16697     MOVE PI-COMPANY-ID          TO COMPO.
 16698     MOVE AL-PABOF               TO COMPA
 16699     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16700
 16701*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16702         MOVE SPACES             TO PRODO.
 16703         MOVE AL-SANOF           TO PRODCDA.
 16704*    END-IF.
 16705
 16706     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16707     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16708
 16709     IF PI-PROCESSOR-ID = 'PEMA'
 16710        MOVE AL-UANON            TO CERTNOA
 16711                                    SUFXA
 16712     END-IF.
 16713     IF NOT PI-NO-CARRIER-SECURITY
 16714        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16715        MOVE AL-SABOF            TO CLMCARRA
 16716     END-IF.
 16717
 16718*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16719*        NEXT SENTENCE
 16720*        CONTINUE
 16721*    ELSE
 16722         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16723*    END-IF.
 16724
 16725*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 16726         MOVE AL-SANOF           TO PRODCDA.
 16727*    END-IF.
 16728
 16729
 16730
 16731* EXEC CICS SEND
 16732*        MAP      (MAP-NAME)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 321
* EL130.cbl
 16733*        MAPSET   (MAPSET-NAME)
 16734*        FROM     (EL130AO)
 16735*        DATAONLY
 16736*        CURSOR
 16737*    END-EXEC.
 16738     MOVE LENGTH OF
 16739      EL130AO
 16740       TO DFHEIV12
 16741     MOVE -1
 16742       TO DFHEIV11
 16743*    MOVE '8$D    CT       H L F ,   #00014701' TO DFHEIV0
 16744     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16745     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16746     MOVE X'2020233030303134373031' TO DFHEIV0(25:11)
 16747     CALL 'kxdfhei1' USING DFHEIV0,
 16748           MAP-NAME,
 16749           EL130AO,
 16750           DFHEIV12,
 16751           MAPSET-NAME,
 16752           DFHEIV99,
 16753           DFHEIV99,
 16754           DFHEIV99,
 16755           DFHEIV11,
 16756           DFHEIV99,
 16757           DFHEIV99,
 16758           DFHEIV99
 16759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16760
 16761
 16762     GO TO 9100-RETURN-TRAN.
 16763
 16764 8300-SEND-TEXT.
 16765
 16766
 16767* EXEC CICS SEND TEXT
 16768*        FROM     (LOGOFF-TEXT)
 16769*        LENGTH   (LOGOFF-LENGTH)
 16770*        ERASE
 16771*        FREEKB
 16772*    END-EXEC.
 16773*    MOVE '8&      T  E F  H   F -   #00014713' TO DFHEIV0
 16774     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16775     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16776     MOVE X'2020233030303134373133' TO DFHEIV0(25:11)
 16777     CALL 'kxdfhei1' USING DFHEIV0,
 16778           LOGOFF-TEXT,
 16779           LOGOFF-LENGTH,
 16780           DFHEIV99,
 16781           DFHEIV99,
 16782           DFHEIV99,
 16783           DFHEIV99,
 16784           DFHEIV99,
 16785           DFHEIV99,
 16786           DFHEIV99,
 16787           DFHEIV99,
 16788           DFHEIV99,
 16789           DFHEIV99
 16790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 322
* EL130.cbl
 16791
 16792
 16793
 16794
 16795* EXEC CICS RETURN
 16796*    END-EXEC.
 16797*    MOVE '.(                    ''   #00014721' TO DFHEIV0
 16798     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16799     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16800     MOVE X'2020233030303134373231' TO DFHEIV0(25:11)
 16801     CALL 'kxdfhei1' USING DFHEIV0,
 16802           DFHEIV99,
 16803           DFHEIV99,
 16804           DFHEIV99,
 16805           DFHEIV99,
 16806           DFHEIV99,
 16807           DFHEIV99
 16808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16809
 16810
 16811 8800-UNAUTHORIZED-ACCESS.
 16812     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16813     GO TO 8300-SEND-TEXT.
 16814
 16815 8810-PF23.
 16816     MOVE EIBAID TO PI-ENTRY-CD-1.
 16817     MOVE XCTL-005               TO PGM-NAME.
 16818     GO TO 9300-XCTL.
 16819
 16820 8820-TERM-ERROR.
 16821     MOVE ER-0412                TO EMI-ERROR.
 16822     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16823     MOVE -1                     TO MAINTL.
 16824     GO TO 8200-SEND-DATAONLY.
 16825
 16826 8830-TRAN-ERROR.
 16827     MOVE ER-0413                TO EMI-ERROR.
 16828     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16829     MOVE -1                     TO MAINTL.
 16830     GO TO 8200-SEND-DATAONLY.
 16831
 16832 9000-RETURN-CICS.
 16833
 16834
 16835* EXEC CICS RETURN
 16836*    END-EXEC.
 16837*    MOVE '.(                    ''   #00014747' TO DFHEIV0
 16838     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16839     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16840     MOVE X'2020233030303134373437' TO DFHEIV0(25:11)
 16841     CALL 'kxdfhei1' USING DFHEIV0,
 16842           DFHEIV99,
 16843           DFHEIV99,
 16844           DFHEIV99,
 16845           DFHEIV99,
 16846           DFHEIV99,
 16847           DFHEIV99
 16848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 323
* EL130.cbl
 16849
 16850
 16851 9100-RETURN-TRAN.
 16852     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16853     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 16854
 16855
 16856
 16857* EXEC CICS RETURN
 16858*        TRANSID   (TRANS-ID)
 16859*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16860*        LENGTH    (PI-COMM-LENGTH)
 16861*    END-EXEC.
 16862*    MOVE '.(CT                  ''   #00014755' TO DFHEIV0
 16863     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16864     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16865     MOVE X'2020233030303134373535' TO DFHEIV0(25:11)
 16866     CALL 'kxdfhei1' USING DFHEIV0,
 16867           TRANS-ID,
 16868           PROGRAM-INTERFACE-BLOCK,
 16869           PI-COMM-LENGTH,
 16870           DFHEIV99,
 16871           DFHEIV99,
 16872           DFHEIV99
 16873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16874
 16875
 16876 9200-RETURN-MAIN-MENU.
 16877     MOVE XCTL-126               TO PGM-NAME.
 16878     GO TO 9300-XCTL.
 16879
 16880 9300-XCTL.
 16881
 16882
 16883* EXEC CICS XCTL
 16884*        PROGRAM   (PGM-NAME)
 16885*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16886*        LENGTH    (PI-COMM-LENGTH)
 16887*    END-EXEC.
 16888*    MOVE '.$C                   %   #00014767' TO DFHEIV0
 16889     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16890     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16891     MOVE X'2020233030303134373637' TO DFHEIV0(25:11)
 16892     CALL 'kxdfhei1' USING DFHEIV0,
 16893           PGM-NAME,
 16894           PROGRAM-INTERFACE-BLOCK,
 16895           PI-COMM-LENGTH,
 16896           DFHEIV99
 16897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16898
 16899
 16900 9400-CLEAR.
 16901     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 16902     GO TO 9300-XCTL.
 16903
 16904 9500-PF12.
 16905     MOVE XCTL-010               TO PGM-NAME.
 16906     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 324
* EL130.cbl
 16907
 16908 9600-PGMID-ERROR.
 16909
 16910
 16911* EXEC CICS HANDLE CONDITION
 16912*        PGMIDERR  (8300-SEND-TEXT)
 16913*    END-EXEC.
 16914*    MOVE '"$L                   ! N #00014783' TO DFHEIV0
 16915     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16916     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16917     MOVE X'4E20233030303134373833' TO DFHEIV0(25:11)
 16918     CALL 'kxdfhei1' USING DFHEIV0
 16919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16920
 16921
 16922     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 16923     MOVE ' '                    TO PI-ENTRY-CD-1.
 16924     MOVE XCTL-005               TO PGM-NAME.
 16925     MOVE PGM-NAME               TO LOGOFF-PGM.
 16926     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16927     GO TO 9300-XCTL.
 16928
 16929 9700-LINK-DATE-CONVERT.
 16930     MOVE LINK-ELDATCV           TO PGM-NAME.
 16931
 16932
 16933* EXEC CICS LINK
 16934*        PROGRAM    (PGM-NAME)
 16935*        COMMAREA   (DATE-CONVERSION-DATA)
 16936*        LENGTH     (DC-COMM-LENGTH)
 16937*    END-EXEC.
 16938*    MOVE '."C                   (   #00014797' TO DFHEIV0
 16939     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16940     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16941     MOVE X'2020233030303134373937' TO DFHEIV0(25:11)
 16942     CALL 'kxdfhei1' USING DFHEIV0,
 16943           PGM-NAME,
 16944           DATE-CONVERSION-DATA,
 16945           DC-COMM-LENGTH,
 16946           DFHEIV99,
 16947           DFHEIV99,
 16948           DFHEIV99,
 16949           DFHEIV99
 16950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16951
 16952
 16953 9700-EXIT.
 16954     EXIT.
 16955
 16956 9800-LINK-REM-TERM.
 16957     MOVE LINK-ELRTRM            TO PGM-NAME.
 16958
 16959
 16960* EXEC CICS LINK
 16961*        PROGRAM    (PGM-NAME)
 16962*        COMMAREA   (CALCULATION-PASS-AREA)
 16963*        LENGTH     (CP-COMM-LENGTH)
 16964*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 325
* EL130.cbl
 16965*    MOVE '."C                   (   #00014809' TO DFHEIV0
 16966     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16967     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16968     MOVE X'2020233030303134383039' TO DFHEIV0(25:11)
 16969     CALL 'kxdfhei1' USING DFHEIV0,
 16970           PGM-NAME,
 16971           CALCULATION-PASS-AREA,
 16972           CP-COMM-LENGTH,
 16973           DFHEIV99,
 16974           DFHEIV99,
 16975           DFHEIV99,
 16976           DFHEIV99
 16977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16978
 16979
 16980 9800-EXIT.
 16981     EXIT.
 16982
 16983 9900-ERROR-FORMAT.
 16984*    if emi-error = 1651 or 1652 or 1653 or 1655
 16985*       display ' 9900 error ' emi-error
 16986*       display emi-message-area (1)
 16987*       display emi-message-area (2)
 16988*       display emi-message-area (3)
 16989*    end-if
 16990     IF NOT EMI-ERRORS-COMPLETE
 16991         MOVE LINK-001           TO PGM-NAME
 16992
 16993* EXEC CICS LINK
 16994*            PROGRAM   (PGM-NAME)
 16995*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 16996*            LENGTH    (EMI-COMM-LENGTH)
 16997*        END-EXEC
 16998*    MOVE '."C                   (   #00014827' TO DFHEIV0
 16999     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17000     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17001     MOVE X'2020233030303134383237' TO DFHEIV0(25:11)
 17002     CALL 'kxdfhei1' USING DFHEIV0,
 17003           PGM-NAME,
 17004           ERROR-MESSAGE-INTERFACE-BLOCK,
 17005           EMI-COMM-LENGTH,
 17006           DFHEIV99,
 17007           DFHEIV99,
 17008           DFHEIV99,
 17009           DFHEIV99
 17010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17011         if emi-error = 1651 or 1652 or 1653 or 1655 or 1660
 17012            subtract 1 from emi-fatal-ctr
 17013         end-if
 17014     END-IF.
 17015
 17016     .
 17017 9900-EXIT.
 17018     EXIT.
 17019
 17020 9990-ABEND.
 17021     MOVE -1                     TO MAINTL.
 17022     MOVE LINK-004               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 326
* EL130.cbl
 17023     MOVE DFHEIBLK               TO EMI-LINE1.
 17024
 17025
 17026* EXEC CICS LINK
 17027*        PROGRAM   (PGM-NAME)
 17028*        COMMAREA  (EMI-LINE1)
 17029*        LENGTH    (72)
 17030*    END-EXEC.
 17031     MOVE 72
 17032       TO DFHEIV11
 17033*    MOVE '."C                   (   #00014846' TO DFHEIV0
 17034     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17035     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17036     MOVE X'2020233030303134383436' TO DFHEIV0(25:11)
 17037     CALL 'kxdfhei1' USING DFHEIV0,
 17038           PGM-NAME,
 17039           EMI-LINE1,
 17040           DFHEIV11,
 17041           DFHEIV99,
 17042           DFHEIV99,
 17043           DFHEIV99,
 17044           DFHEIV99
 17045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17046
 17047
 17048     MOVE EMI-LINE1              TO ERRMSG2O.
 17049
 17050     GO TO 8200-BYPASS-ERROR.
 17051
 17052
 17053
 17054* GOBACK.
 17055     MOVE '9%                    "   ' TO DFHEIV0
 17056     MOVE 'EL130' TO DFHEIV1
 17057     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17058     GOBACK.
 17059
 17060 9995-SECURITY-VIOLATION.
 17061*             COPY ELCSCTP.
 17062******************************************************************
 17063*                                                                *
 17064*                            ELCSCTP                             *
 17065*                            VMOD=2.001                          *
 17066*                                                                *
 17067*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17068******************************************************************
 17069
 17070
 17071     MOVE EIBDATE          TO SM-JUL-DATE.
 17072     MOVE EIBTRMID         TO SM-TERMID.
 17073     MOVE THIS-PGM         TO SM-PGM.
 17074     MOVE EIBTIME          TO TIME-IN.
 17075     MOVE TIME-OUT         TO SM-TIME.
 17076     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17077
 17078
 17079* EXEC CICS LINK
 17080*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 327
* EL130.cbl
 17081*         COMMAREA (SECURITY-MESSAGE)
 17082*         LENGTH   (80)
 17083*    END-EXEC.
 17084     MOVE 'EL003' TO DFHEIV1
 17085     MOVE 80
 17086       TO DFHEIV11
 17087*    MOVE '."C                   (   #00014877' TO DFHEIV0
 17088     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17089     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17090     MOVE X'2020233030303134383737' TO DFHEIV0(25:11)
 17091     CALL 'kxdfhei1' USING DFHEIV0,
 17092           DFHEIV1,
 17093           SECURITY-MESSAGE,
 17094           DFHEIV11,
 17095           DFHEIV99,
 17096           DFHEIV99,
 17097           DFHEIV99,
 17098           DFHEIV99
 17099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17100
 17101
 17102******************************************************************
 17103
 17104
 17105 9995-EXIT.
 17106     EXIT.
 17107
 17108
 17109 9999-DFHBACK SECTION.
 17110     MOVE '9%                    "   ' TO DFHEIV0
 17111     MOVE 'EL130' TO DFHEIV1
 17112     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17113     GOBACK.
 17114 9999-DFHEXIT.
 17115     IF DFHEIGDJ EQUAL 0001
 17116         NEXT SENTENCE
 17117     ELSE IF DFHEIGDJ EQUAL 2
 17118         GO TO 0100-TEST-ENTRY,
 17119               8100-SEND-INITIAL-MAP,
 17120               9600-PGMID-ERROR,
 17121               8820-TERM-ERROR,
 17122               8830-TRAN-ERROR,
 17123               9990-ABEND
 17124         DEPENDING ON DFHEIGDI
 17125     ELSE IF DFHEIGDJ EQUAL 3
 17126         GO TO 0450-ADD-ELACTQ-RECORD
 17127         DEPENDING ON DFHEIGDI
 17128     ELSE IF DFHEIGDJ EQUAL 4
 17129         GO TO 8820-TERM-ERROR,
 17130               8830-TRAN-ERROR
 17131         DEPENDING ON DFHEIGDI
 17132     ELSE IF DFHEIGDJ EQUAL 5
 17133         GO TO 0660-NOT-FOUND,
 17134               0670-QIDERR
 17135         DEPENDING ON DFHEIGDI
 17136     ELSE IF DFHEIGDJ EQUAL 6
 17137         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17138         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 328
* EL130.cbl
 17139     ELSE IF DFHEIGDJ EQUAL 7
 17140         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17141         DEPENDING ON DFHEIGDI
 17142     ELSE IF DFHEIGDJ EQUAL 8
 17143         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17144         DEPENDING ON DFHEIGDI
 17145     ELSE IF DFHEIGDJ EQUAL 9
 17146         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17147         DEPENDING ON DFHEIGDI
 17148     ELSE IF DFHEIGDJ EQUAL 10
 17149         GO TO 2050-DELETE-NOT-FOUND
 17150         DEPENDING ON DFHEIGDI
 17151     ELSE IF DFHEIGDJ EQUAL 11
 17152         GO TO 2010-DELETE-CL
 17153         DEPENDING ON DFHEIGDI
 17154     ELSE IF DFHEIGDJ EQUAL 12
 17155         GO TO 3010-TEST-FOR-ERRORS
 17156         DEPENDING ON DFHEIGDI
 17157     ELSE IF DFHEIGDJ EQUAL 13
 17158         GO TO 3008-DUP-ERROR,
 17159               3009-NOT-FOUND
 17160         DEPENDING ON DFHEIGDI
 17161     ELSE IF DFHEIGDJ EQUAL 14
 17162         GO TO 3030-BUILD-CONT
 17163         DEPENDING ON DFHEIGDI
 17164     ELSE IF DFHEIGDJ EQUAL 15
 17165         GO TO 3033-ACCT-NOT-FOUND,
 17166               3033-ACCT-NOT-FOUND
 17167         DEPENDING ON DFHEIGDI
 17168     ELSE IF DFHEIGDJ EQUAL 16
 17169         GO TO 3032-NOT-IN-DT-RANGE
 17170         DEPENDING ON DFHEIGDI
 17171     ELSE IF DFHEIGDJ EQUAL 17
 17172         GO TO 3070-BUILD-CONT
 17173         DEPENDING ON DFHEIGDI
 17174     ELSE IF DFHEIGDJ EQUAL 18
 17175         GO TO 3065-CERT-NOT-FOUND
 17176         DEPENDING ON DFHEIGDI
 17177     ELSE IF DFHEIGDJ EQUAL 19
 17178         GO TO 3100-CARRIER-NOT-FOUND
 17179         DEPENDING ON DFHEIGDI
 17180     ELSE IF DFHEIGDJ EQUAL 20
 17181         GO TO 3110-COMPANY-NOT-FOUND
 17182         DEPENDING ON DFHEIGDI
 17183     ELSE IF DFHEIGDJ EQUAL 21
 17184         GO TO 3200-BUILD-ZERO-TRAILER
 17185         DEPENDING ON DFHEIGDI
 17186     ELSE IF DFHEIGDJ EQUAL 22
 17187         GO TO 9999-DFHBACK
 17188         DEPENDING ON DFHEIGDI
 17189     ELSE IF DFHEIGDJ EQUAL 23
 17190         GO TO 3290-NO-INSURED-ADDRESS
 17191         DEPENDING ON DFHEIGDI
 17192     ELSE IF DFHEIGDJ EQUAL 24
 17193         GO TO 3410-DUP-KEY
 17194         DEPENDING ON DFHEIGDI
 17195     ELSE IF DFHEIGDJ EQUAL 25
 17196         GO TO 3690-CERT-WRITTEN
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 329
* EL130.cbl
 17197         DEPENDING ON DFHEIGDI
 17198     ELSE IF DFHEIGDJ EQUAL 26
 17199         GO TO 3850-CLAIM-MSTR-WRITTEN
 17200         DEPENDING ON DFHEIGDI
 17201     ELSE IF DFHEIGDJ EQUAL 27
 17202         GO TO 3992-DUPREC
 17203         DEPENDING ON DFHEIGDI
 17204     ELSE IF DFHEIGDJ EQUAL 28
 17205         GO TO 5050-CERT-NOT-FOUND
 17206         DEPENDING ON DFHEIGDI
 17207     ELSE IF DFHEIGDJ EQUAL 29
 17208         GO TO 5030-CERT-WRITTEN
 17209         DEPENDING ON DFHEIGDI
 17210     ELSE IF DFHEIGDJ EQUAL 30
 17211         GO TO 5035-CLAIM-WRITTEN
 17212         DEPENDING ON DFHEIGDI
 17213     ELSE IF DFHEIGDJ EQUAL 31
 17214         GO TO 9990-ABEND,
 17215               5799-EXIT
 17216         DEPENDING ON DFHEIGDI
 17217     ELSE IF DFHEIGDJ EQUAL 32
 17218         GO TO 3100-CARRIER-NOT-FOUND
 17219         DEPENDING ON DFHEIGDI
 17220     ELSE IF DFHEIGDJ EQUAL 33
 17221         GO TO 6040-NO-PROCESSOR-RECORD
 17222         DEPENDING ON DFHEIGDI
 17223     ELSE IF DFHEIGDJ EQUAL 34
 17224         GO TO 6060-NO-BENEFICIARY-RECORD
 17225         DEPENDING ON DFHEIGDI
 17226     ELSE IF DFHEIGDJ EQUAL 35
 17227         GO TO 6499-EXIT,
 17228               6499-EXIT
 17229         DEPENDING ON DFHEIGDI
 17230     ELSE IF DFHEIGDJ EQUAL 36
 17231         GO TO 6600-NOT-FOUND
 17232         DEPENDING ON DFHEIGDI
 17233     ELSE IF DFHEIGDJ EQUAL 37
 17234         GO TO 6700-NOTOPEN-ERROR,
 17235               6700-EXIT
 17236         DEPENDING ON DFHEIGDI
 17237     ELSE IF DFHEIGDJ EQUAL 38
 17238         GO TO 7120-NOT-FOUND
 17239         DEPENDING ON DFHEIGDI
 17240     ELSE IF DFHEIGDJ EQUAL 39
 17241         GO TO 7499-EXIT
 17242         DEPENDING ON DFHEIGDI
 17243     ELSE IF DFHEIGDJ EQUAL 40
 17244         GO TO 7500-EXIT,
 17245               7500-DUPLICATE-KEY,
 17246               7500-EXIT
 17247         DEPENDING ON DFHEIGDI
 17248     ELSE IF DFHEIGDJ EQUAL 41
 17249         GO TO 7500-END-BROWSE
 17250         DEPENDING ON DFHEIGDI
 17251     ELSE IF DFHEIGDJ EQUAL 42
 17252         GO TO 7630-END-BROWSE
 17253         DEPENDING ON DFHEIGDI
 17254     ELSE IF DFHEIGDJ EQUAL 43
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:06 Page 330
* EL130.cbl
 17255         GO TO 7799-EXIT,
 17256               7799-EXIT
 17257         DEPENDING ON DFHEIGDI
 17258     ELSE IF DFHEIGDJ EQUAL 44
 17259         GO TO 7790-END-BROWSE
 17260         DEPENDING ON DFHEIGDI
 17261     ELSE IF DFHEIGDJ EQUAL 45
 17262         GO TO 7992-NOT-FOUND
 17263         DEPENDING ON DFHEIGDI
 17264     ELSE IF DFHEIGDJ EQUAL 46
 17265         GO TO 8300-SEND-TEXT
 17266         DEPENDING ON DFHEIGDI.
 17267     MOVE '9%                    "   ' TO DFHEIV0
 17268     MOVE 'EL130' TO DFHEIV1
 17269     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17270     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12832     Code:       54989
