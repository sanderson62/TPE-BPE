* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL633.cbl
* Options: int("EL633.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL633.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL633.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL633.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL633.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/28/94 10:04:35.
     7*                            VMOD=2.021
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL633.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXB7 - COMPENSATION PAYMENTS/ADJUSTMENTS.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL633AI FILLER
    38* 010803                   PEMA  ADD 1825013200 FOR DCC
    39* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
    40* 022504                   PEMA ADD GL CODE FOR DCC
    41* 093004                   PEMA ADD NEW GL CODE FOR DCC
    42* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
    43* 061605    2005051300001  PEMA ADD GL NUM EDIT FOR DCC
    44* 122105    2005033100001  PEMA ADD GL NUM EDIT FOR CSI
    45* 032806                   PEMA ADD MORE GL NUMBERS FOR CSI
    46* 071806    2006012600002  PEMA CHANGE DCC GL NUMBERS
    47* 080206    2006012600002  PEMA ADD GL NUMBER FOR CID & DCC
    48* 092506                   PEMA ADD NEW GL CODE FOR DCC
    49* 031909    2009030300001  AJRA ADD NEW GL CODE FOR CID
    50* 040109    2008050500001  AJRA ADD GL NUMBERS FOR CCC
    51* 031710  CR2009100700001  PEMA CORRECT MATH ON TYPE 'U'
    52* 120711  CR2011120100004  PEMA ADD GL NUMBER FOR CCC
    53* 031912  CR2011120900003  AJRA AHL COMPANY CODE
    54******************************************************************
    55
    56 ENVIRONMENT DIVISION.
    57 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL633.cbl
    59 WORKING-STORAGE SECTION.
    60 01  DFH-START PIC X(04).
    61 77  FILLER  PIC X(32)  VALUE '********************************'.
    62 77  FILLER  PIC X(32)  VALUE '*    EL633 WORKING STORAGE     *'.
    63 77  FILLER  PIC X(32)  VALUE '************ V/M 2.021 *********'.
    64
    65*77  FILLER  PIC X(32)  VALUE '/////// SAVE COFA MASTER /////'.
    66*77  SV-COFA PIC X(42)  VALUE SPACES.
    67*77  K-SPACE PIC X(11)  VALUE SPACES.
    68
    69 01  DATE-WORK-AREAS.
    70     05  WS-GREG-STORE.
    71         10  WS-GS-MM  PIC XX.
    72         10  FILLER    PIC X.
    73         10  WS-GS-DD  PIC XX.
    74         10  FILLER    PIC X.
    75         10  WS-GS-YY  PIC XX.
    76     05  WS-SDTE-STORE.
    77         10  WS-SS-MM  PIC XX.
    78         10  WS-SS-DD  PIC XX.
    79         10  WS-SS-YY  PIC XX.
    80*                            COPY ELCSCTM.
    81******************************************************************
    82*                                                                *
    83*                                                                *
    84*                            ELCSCTM                             *
    85*                            VMOD=2.001                          *
    86*                                                                *
    87*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    88*                                                                *
    89******************************************************************
    90 01  SECURITY-MESSAGE.
    91     12  FILLER                          PIC X(30)
    92            VALUE '** LOGIC SECURITY VIOLATION -'.
    93     12  SM-READ                         PIC X(6).
    94     12  FILLER                          PIC X(5)
    95            VALUE ' PGM='.
    96     12  SM-PGM                          PIC X(6).
    97     12  FILLER                          PIC X(5)
    98            VALUE ' OPR='.
    99     12  SM-PROCESSOR-ID                 PIC X(4).
   100     12  FILLER                          PIC X(6)
   101            VALUE ' TERM='.
   102     12  SM-TERMID                       PIC X(4).
   103     12  FILLER                          PIC XX   VALUE SPACE.
   104     12  SM-JUL-DATE                     PIC 9(5).
   105     12  FILLER                          PIC X    VALUE SPACE.
   106     12  SM-TIME                         PIC 99.99.
   107
   108*                            COPY ELCSCRTY.
   109******************************************************************
   110*                                                                *
   111*                                                                *
   112*                            ELCSCRTY                            *
   113*                            VMOD=2.001                          *
   114*                                                                *
   115*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   116*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL633.cbl
   117*        SAVED IN PI-SECURITY-ADDRESS.                           *
   118*                                                                *
   119******************************************************************
   120 01  SECURITY-CONTROL.
   121     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   122     12  FILLER                       PIC XX    VALUE 'SC'.
   123     12  SC-CREDIT-CODES.
   124         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   125             20  SC-CREDIT-DISPLAY    PIC X.
   126             20  SC-CREDIT-UPDATE     PIC X.
   127     12  SC-CLAIMS-CODES.
   128         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   129             20  SC-CLAIMS-DISPLAY    PIC X.
   130             20  SC-CLAIMS-UPDATE     PIC X.
   131
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL633.cbl
   133
   134 01  STANDARD-AREAS.
   135     12  SC-ITEM             PIC  S9(4) COMP VALUE +1.
   136     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
   137     12  MAP-NAME            PIC  X(8)       VALUE 'EL633A'.
   138     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL633S'.
   139     12  SCREEN-NUMBER       PIC  X(4)       VALUE '633A'.
   140     12  TRANS-ID            PIC  X(4)       VALUE 'EXB7'.
   141     12  EL6331-TRANS-ID     PIC  X(4)       VALUE 'EXB8'.
   142     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
   143     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
   144     12  EL652-TRANS-ID      PIC  X(4)       VALUE 'EXD4'.
   145     12  THIS-PGM            PIC  X(8)       VALUE 'EL633'.
   146     12  PGM-NAME            PIC  X(8).
   147     12  TIME-IN             PIC S9(7).
   148     12  TIME-OUT-R  REDEFINES  TIME-IN.
   149         16  FILLER          PIC  X.
   150         16  TIME-OUT        PIC  99V99.
   151         16  FILLER          PIC  X(2).
   152     12  EL640               PIC  X(8)       VALUE 'EL640'.
   153     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
   154     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
   155     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
   156     12  XCTL-6331           PIC  X(8)       VALUE 'EL6331'.
   157     12  XCTL-640            PIC  X(8)       VALUE 'EL640'.
   158     12  XCTL-642            PIC  X(8)       VALUE 'EL642'.
   159     12  XCTL-652            PIC  X(8)       VALUE 'EL652'.
   160     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   161     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   162     12  RETURNED-FROM       PIC  X(8)       VALUE SPACES.
   163     12  LINK-CLDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   164     12  PYAJ-FILE-ID        PIC  X(8)       VALUE 'ERPYAJ'.
   165     12  CHKQ-FILE-ID        PIC  X(8)       VALUE 'ERCHKQ'.
   166     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   167     12  WS-CURRENT-DT       PIC  X(8)       VALUE SPACES.
   168     12  WS-CURRENT-BIN-DT   PIC  X(2)       VALUE SPACES.
   169     12  PYAJ-READ-SW        PIC  X          VALUE 'Y'.
   170         88  PYAJ-1ST-READ                   VALUE 'Y'.
   171     12  FIRST-ADD-SW        PIC  X          VALUE 'Y'.
   172         88  FIRST-ADD                       VALUE 'Y'.
   173     12  ZERO-NDX            PIC  9          VALUE ZERO.
   174     12  WORK-SEQ-NO         PIC S9(8)       COMP-3 VALUE ZEROS.
   175     12  WORK-SEQ-TIME       PIC  9(6).
   176     12  WORK-SEQ-HHMMSS  REDEFINES  WORK-SEQ-TIME.
   177         16  WORK-SEQ-HHMMS  PIC  9(5).
   178         16  FILLER          PIC  9.
   179     12  WORK-DATE-JULIAN.
   180         16  WORK-JULIAN-YR  PIC  99         VALUE ZEROS.
   181         16  WORK-JULIAN-DD  PIC  999        VALUE ZEROS.
   182     12  JULIAN-YY-DD        PIC  9(4)       COMP-3 VALUE ZEROS.
   183     12  CHECK-REC-TYPE      PIC  X          VALUE SPACE.
   184         88  VALID-REC-TYPE                  VALUE  'R' 'D' 'C'
   185                                                    'S' 'T' 'U'
   186                                                    'X' 'Y' 'Z'
   187                                                    'F'.
   188     12  CHECK-CANC-TYPE     PIC  X          VALUE SPACE.
   189         88  VALID-CANC-TYPE                 VALUE 'N' 'Y' ' '.
   190     12  FORCE-SHOW-SW       PIC  X          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL633.cbl
   191         88  FORCE-SHOW                      VALUE  'Y'.
   192
   193     12  WS-EOM-DTS OCCURS 13  TIMES
   194                              INDEXED BY PINDEX.
   195         16  WS-EOM-DT               PIC XX.
   196*    12  COFA-FILE-ID        PIC  X(8)       VALUE 'COFAXXX '.
   197
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL633.cbl
   199     12  WS-ERROR-CODES.
   200         16  ER-0000         PIC  X(4)       VALUE '0000'.
   201         16  ER-0008         PIC  X(4)       VALUE '0008'.
   202         16  ER-0023         PIC  X(4)       VALUE '0023'.
   203         16  ER-0029         PIC  X(4)       VALUE '0029'.
   204         16  ER-0070         PIC  X(4)       VALUE '0070'.
   205         16  ER-0587         PIC  X(4)       VALUE '0587'.
   206         16  ER-2056         PIC  X(4)       VALUE '2056'.
   207         16  ER-2230         PIC  X(4)       VALUE '2230'.
   208         16  ER-2231         PIC  X(4)       VALUE '2231'.
   209         16  ER-2232         PIC  X(4)       VALUE '2232'.
   210         16  ER-2233         PIC  X(4)       VALUE '2233'.
   211         16  ER-2234         PIC  X(4)       VALUE '2234'.
   212         16  ER-2235         PIC  X(4)       VALUE '2235'.
   213         16  ER-2236         PIC  X(4)       VALUE '2236'.
   214         16  ER-2237         PIC  X(4)       VALUE '2237'.
   215         16  ER-2238         PIC  X(4)       VALUE '2238'.
   216         16  ER-2239         PIC  X(4)       VALUE '2239'.
   217         16  ER-2244         PIC  X(4)       VALUE '2244'.
   218         16  ER-2245         PIC  X(4)       VALUE '2245'.
   219         16  ER-2246         PIC  X(4)       VALUE '2246'.
   220         16  ER-2370         PIC  X(4)       VALUE '2370'.
   221         16  ER-2432         PIC  X(4)       VALUE '2432'.
   222         16  ER-2449         PIC  X(4)       VALUE '2449'.
   223         16  ER-2587         PIC  X(4)       VALUE '2587'.
   224         16  ER-2588         PIC  X(4)       VALUE '2588'.
   225         16  ER-2595         PIC  X(4)       VALUE '2595'.
   226         16  ER-2596         PIC  X(4)       VALUE '2596'.
   227         16  ER-2763         PIC  X(4)       VALUE '2763'.
   228         16  ER-2929         PIC  X(4)       VALUE '2929'.
   229         16  ER-2957         PIC  X(4)       VALUE '2957'.
   230         16  ER-2958         PIC  X(4)       VALUE '2958'.
   231*        16  ER-2959         PIC  X(4)       VALUE '2958'.
   232         16  ER-2960         PIC  X(4)       VALUE '2960'.
   233         16  ER-3020         PIC  X(4)       VALUE '3020'.
   234
   235*************************************************************
   236*                      TABLE OF STATE NAMES
   237*************************************************************
   238
   239 01  CHECK-STATE-CODE            PIC XX      VALUE SPACE.
   240     88  VALID-STATE-CODE    VALUE 'AK' 'AL' 'AR' 'AZ' 'CA'
   241                                   'CD' 'CO' 'CT' 'DC' 'DE'
   242                                   'FL' 'GA' 'GM' 'HI' 'IA'
   243                                   'ID' 'IL' 'IN' 'KS' 'KY'
   244                                   'LA' 'MA' 'MD' 'ME' 'MI'
   245                                   'MN' 'MO' 'MS' 'MT' 'MX'
   246                                   'NC' 'ND' 'NE' 'NH' 'NJ'
   247                                   'NM' 'NV' 'NY' 'OF' 'OH'
   248                                   'OK' 'OR' 'PA' 'PI' 'PR'
   249                                   'RI' 'SC' 'SD' 'TN' 'TX'
   250                                   'UT' 'VA' 'VI' 'VT' 'WA'
   251                                   'WI' 'WV' 'WY'.
   252
   253 01  CHECK-GL-ACCT         PIC X(10)  VALUE SPACE.
   254     88  VALID-GL-ACCOUNT  VALUE '1108121010'
   255                                 '1108125100'
   256                                 '1721211400'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL633.cbl
   257                                 '1825011200'
   258                                 '1825011300'
   259                                 '1825099050'
   260                                 '8505700033'
   261                                 '8506400030'
   262                                 '8507200020'
   263                                 '8507200010'.
   264     88  VALID-DCC-GL-ACCOUNT  VALUE '2725040300'
   265                                     '2725040320'
   266                                     '2725040330'
   267                                     '2725040310'
   268                                     '8506400030'
   269                                     '8507200010'
   270                                     '1108121250'.
   271     88  VALID-CSI-GL-ACCOUNT  VALUE '2725040100'
   272                                     '2725040110'
   273                                     '2725040120'
   274                                     '2725040130'
   275                                     '2725020400'.
   276
   277     88  VALID-CCC-GL-ACCOUNT  VALUE '1825013100'
   278                                     '1825013200'
   279                                     '1825013300'
   280                                     '1825013400'
   281                                     '8506400030'
   282                                     '8507200010'
   283                                     '8507200020'
   284                                     '1108121010'.
   285
   286*01  WS-ACCT-BREAK.
   287*    05  WS-ACCT-1               PIC X.
   288*    05  FILLER                  PIC X(6).
   289*
   290 01  WORK-AREA.
   291     12  WS-SAVE-ERPYAJ      PIC X(200)      VALUE SPACES.
   292     12  QID.
   293         16  QID-TERM        PIC X(04).
   294         16  FILLER          PIC X(04)       VALUE '633A'.
   295     12  DEEDIT-FIELD        PIC X(11).
   296     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD PIC S9(11).
   297     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD PIC S9(9)V99.
   298     12  DATE-TEST-AREA      PIC  9(6).
   299     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   300         16  DATE-TEST-MM    PIC  99.
   301         16  DATE-TEST-DD    PIC  99.
   302         16  DATE-TEST-YY    PIC  99.
   303     12  DIVIDE-RESULT       PIC  99.
   304     12  DIVIDE-REMAINDER    PIC  9.
   305     12  PREV-BIN-MAINT-DT   PIC  XX           VALUE SPACES.
   306     12  PREV-MAINT-DT       PIC  X(8)         VALUE SPACES.
   307     12  PREV-BIN-BL-DT      PIC  XX           VALUE SPACES.
   308     12  PREV-BL-DT          PIC  X(8)         VALUE SPACES.
   309     12  TOTAL-ACCT-AMT      PIC S9(7)V99      VALUE ZEROS.
   310     12  TOTAL-ACCT-NET      PIC S9(7)V99      VALUE ZEROS.
   311     12  WS-SAVE-INDEX-VALUE PIC S9(4) COMP    VALUE ZEROS.
   312     12  WS-SAVE-NDX-VALUE   PIC S9(4) COMP    VALUE ZEROS.
   313
   314 01  ACCESS-KEYS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL633.cbl
   315     12  ERPYAJ-KEY.
   316         16  PYAJ-COMP-CD            PIC  X      VALUE SPACE.
   317         16  PYAJ-CARRIER            PIC  X      VALUE SPACES.
   318         16  PYAJ-GROUPING           PIC  X(6)   VALUE SPACES.
   319         16  PYAJ-FIN-RESP           PIC  X(10)  VALUE SPACES.
   320         16  PYAJ-ACCOUNT            PIC  X(10)  VALUE SPACES.
   321         16  PYAJ-FILE-SEQ-NO        PIC S9(8)   VALUE +0  COMP.
   322         16  PYAJ-RECORD-TYPE        PIC  X      VALUE SPACES.
   323
   324     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   325     12  ERPYAJ-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   326
   327     12  ERCHKQ-KEY.
   328         16  CHKQ-COMPANY-CD         PIC  X      VALUE SPACE.
   329         16  CHKQ-CONTROL-NUMBER     PIC S9(8)   VALUE +0  COMP.
   330         16  CHKQ-SEQUENCE-NUMBER    PIC S9(4)   VALUE +0  COMP.
   331     12  ERCOMP-KEY.
   332         16  COMP-COMP-CD            PIC  X      VALUE SPACE.
   333         16  COMP-CARRIER            PIC  X      VALUE SPACES.
   334         16  COMP-GROUPING           PIC  X(6)   VALUE SPACES.
   335         16  COMP-FIN-RESP           PIC  X(10)  VALUE SPACES.
   336         16  COMP-ACCOUNT            PIC  X(10)  VALUE SPACES.
   337         16  COMP-RECORD-TYPE        PIC  X      VALUE SPACES.
   338*    12  COFA-KEY-X.
   339*        16  COFA-COMPANY-X          PIC  X(4)   VALUE SPACES.
   340*        16  COFA-ACCOUNT.
   341*            20  COFA-FILLER         PIC  X(11)  VALUE SPACES.
   342*            20  COFA-MSA-ACCT       PIC  X(07)  VALUE SPACES.
   343*
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL633.cbl
   345*                                    COPY ELCDATE.
   346******************************************************************
   347*                                                                *
   348*                                                                *
   349*                            ELCDATE.                            *
   350*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   351*                            VMOD=2.003
   352*                                                                *
   353*                                                                *
   354*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   355*                 LENGTH = 200                                   *
   356******************************************************************
   357
   358 01  DATE-CONVERSION-DATA.
   359     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   360     12  DC-OPTION-CODE                PIC X.
   361         88  BIN-TO-GREG                VALUE ' '.
   362         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   363         88  EDIT-GREG-TO-BIN           VALUE '2'.
   364         88  YMD-GREG-TO-BIN            VALUE '3'.
   365         88  MDY-GREG-TO-BIN            VALUE '4'.
   366         88  JULIAN-TO-BIN              VALUE '5'.
   367         88  BIN-PLUS-ELAPSED           VALUE '6'.
   368         88  FIND-CENTURY               VALUE '7'.
   369         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   370         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   371         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   372         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   373         88  JULIAN-TO-BIN-3            VALUE 'C'.
   374         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   375         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   376         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   377         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   378         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   379         88  CHECK-LEAP-YEAR            VALUE 'H'.
   380         88  BIN-3-TO-GREG              VALUE 'I'.
   381         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   382         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   383         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   384         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   385         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   386         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   387         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   388         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   389         88  THREE-CHARACTER-BIN
   390                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   391         88  GREGORIAN-TO-BIN
   392                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   393         88  BIN-TO-GREGORIAN
   394                  VALUES ' ' '1' 'I' '8' 'G'.
   395         88  JULIAN-TO-BINARY
   396                  VALUES '5' 'C' 'E' 'F'.
   397     12  DC-ERROR-CODE                 PIC X.
   398         88  NO-CONVERSION-ERROR        VALUE ' '.
   399         88  DATE-CONVERSION-ERROR
   400                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   401         88  DATE-IS-ZERO               VALUE '1'.
   402         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL633.cbl
   403         88  DATE-IS-INVALID            VALUE '3'.
   404         88  DATE1-GREATER-DATE2        VALUE '4'.
   405         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   406         88  DATE-INVALID-OPTION        VALUE '9'.
   407         88  INVALID-CENTURY            VALUE 'A'.
   408         88  ONLY-CENTURY               VALUE 'B'.
   409         88  ONLY-LEAP-YEAR             VALUE 'C'.
   410         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   411     12  DC-END-OF-MONTH               PIC X.
   412         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   413     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   414         88  USE-NORMAL-PROCESS         VALUE ' '.
   415         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   416         88  ADJUST-UP-100-YRS          VALUE '2'.
   417     12  FILLER                        PIC X.
   418     12  DC-CONVERSION-DATES.
   419         16  DC-BIN-DATE-1             PIC XX.
   420         16  DC-BIN-DATE-2             PIC XX.
   421         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   422         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   423                       DC-GREG-DATE-1-EDIT.
   424             20  DC-EDIT1-MONTH        PIC 99.
   425             20  SLASH1-1              PIC X.
   426             20  DC-EDIT1-DAY          PIC 99.
   427             20  SLASH1-2              PIC X.
   428             20  DC-EDIT1-YEAR         PIC 99.
   429         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   430         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   431                     DC-GREG-DATE-2-EDIT.
   432             20  DC-EDIT2-MONTH        PIC 99.
   433             20  SLASH2-1              PIC X.
   434             20  DC-EDIT2-DAY          PIC 99.
   435             20  SLASH2-2              PIC X.
   436             20  DC-EDIT2-YEAR         PIC 99.
   437         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   438         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   439                     DC-GREG-DATE-1-YMD.
   440             20  DC-YMD-YEAR           PIC 99.
   441             20  DC-YMD-MONTH          PIC 99.
   442             20  DC-YMD-DAY            PIC 99.
   443         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   444         16  DC-GREG-DATE-1-MDY-R REDEFINES
   445                      DC-GREG-DATE-1-MDY.
   446             20  DC-MDY-MONTH          PIC 99.
   447             20  DC-MDY-DAY            PIC 99.
   448             20  DC-MDY-YEAR           PIC 99.
   449         16  DC-GREG-DATE-1-ALPHA.
   450             20  DC-ALPHA-MONTH        PIC X(10).
   451             20  DC-ALPHA-DAY          PIC 99.
   452             20  FILLER                PIC XX.
   453             20  DC-ALPHA-CENTURY.
   454                 24 DC-ALPHA-CEN-N     PIC 99.
   455             20  DC-ALPHA-YEAR         PIC 99.
   456         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   457         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   458         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   459         16  DC-JULIAN-DATE            PIC 9(05).
   460         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL633.cbl
   461                                       PIC 9(05).
   462         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   463             20  DC-JULIAN-YEAR        PIC 99.
   464             20  DC-JULIAN-DAYS        PIC 999.
   465         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   466         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   467         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   468     12  DATE-CONVERSION-VARIBLES.
   469         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   470         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   471             20  FILLER                PIC 9(3).
   472             20  HOLD-CEN-1-CCYY.
   473                 24  HOLD-CEN-1-CC     PIC 99.
   474                 24  HOLD-CEN-1-YY     PIC 99.
   475             20  HOLD-CEN-1-MO         PIC 99.
   476             20  HOLD-CEN-1-DA         PIC 99.
   477         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   478             20  HOLD-CEN-1-R-MO       PIC 99.
   479             20  HOLD-CEN-1-R-DA       PIC 99.
   480             20  HOLD-CEN-1-R-CCYY.
   481                 24  HOLD-CEN-1-R-CC   PIC 99.
   482                 24  HOLD-CEN-1-R-YY   PIC 99.
   483             20  FILLER                PIC 9(3).
   484         16  HOLD-CENTURY-1-X.
   485             20  FILLER                PIC X(3)  VALUE SPACES.
   486             20  HOLD-CEN-1-X-CCYY.
   487                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   488                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   489             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   490             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   491         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   492             20  HOLD-CEN-1-R-X-MO     PIC XX.
   493             20  HOLD-CEN-1-R-X-DA     PIC XX.
   494             20  HOLD-CEN-1-R-X-CCYY.
   495                 24  HOLD-CEN-1-R-X-CC PIC XX.
   496                 24  HOLD-CEN-1-R-X-YY PIC XX.
   497             20  FILLER                PIC XXX.
   498         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   499         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   500         16  DC-JULIAN-DATE-1          PIC 9(07).
   501         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   502             20  DC-JULIAN-1-CCYY.
   503                 24  DC-JULIAN-1-CC    PIC 99.
   504                 24  DC-JULIAN-1-YR    PIC 99.
   505             20  DC-JULIAN-DA-1        PIC 999.
   506         16  DC-JULIAN-DATE-2          PIC 9(07).
   507         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   508             20  DC-JULIAN-2-CCYY.
   509                 24  DC-JULIAN-2-CC    PIC 99.
   510                 24  DC-JULIAN-2-YR    PIC 99.
   511             20  DC-JULIAN-DA-2        PIC 999.
   512         16  DC-GREG-DATE-A-EDIT.
   513             20  DC-EDITA-MONTH        PIC 99.
   514             20  SLASHA-1              PIC X VALUE '/'.
   515             20  DC-EDITA-DAY          PIC 99.
   516             20  SLASHA-2              PIC X VALUE '/'.
   517             20  DC-EDITA-CCYY.
   518                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL633.cbl
   519                 24  DC-EDITA-YEAR     PIC 99.
   520         16  DC-GREG-DATE-B-EDIT.
   521             20  DC-EDITB-MONTH        PIC 99.
   522             20  SLASHB-1              PIC X VALUE '/'.
   523             20  DC-EDITB-DAY          PIC 99.
   524             20  SLASHB-2              PIC X VALUE '/'.
   525             20  DC-EDITB-CCYY.
   526                 24  DC-EDITB-CENT     PIC 99.
   527                 24  DC-EDITB-YEAR     PIC 99.
   528         16  DC-GREG-DATE-CYMD         PIC 9(08).
   529         16  DC-GREG-DATE-CYMD-R REDEFINES
   530                              DC-GREG-DATE-CYMD.
   531             20  DC-CYMD-CEN           PIC 99.
   532             20  DC-CYMD-YEAR          PIC 99.
   533             20  DC-CYMD-MONTH         PIC 99.
   534             20  DC-CYMD-DAY           PIC 99.
   535         16  DC-GREG-DATE-MDCY         PIC 9(08).
   536         16  DC-GREG-DATE-MDCY-R REDEFINES
   537                              DC-GREG-DATE-MDCY.
   538             20  DC-MDCY-MONTH         PIC 99.
   539             20  DC-MDCY-DAY           PIC 99.
   540             20  DC-MDCY-CEN           PIC 99.
   541             20  DC-MDCY-YEAR          PIC 99.
   542    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   543        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   544    12  DC-EL310-DATE                  PIC X(21).
   545    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL633.cbl
   547*                                    COPY ELCLOGOF.
   548******************************************************************
   549*                                                                *
   550*                                                                *
   551*                            ELCLOGOF.                           *
   552*                            VMOD=2.001                          *
   553*                                                                *
   554*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   555*                                                                *
   556******************************************************************
   557 01  CLASIC-LOGOFF.
   558     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   559     12  LOGOFF-TEXT.
   560         16  FILLER          PIC X(5)    VALUE SPACES.
   561         16  LOGOFF-MSG.
   562             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   563             20  FILLER      PIC X       VALUE SPACES.
   564             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   565         16  FILLER          PIC X(80)
   566           VALUE '* YOU ARE NOW LOGGED OFF'.
   567         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   568         16  FILLER          PIC X       VALUE QUOTE.
   569         16  LOGOFF-SYS-MSG  PIC X(17)
   570           VALUE 'S CLAS-IC SYSTEM '.
   571     12  TEXT-MESSAGES.
   572         16  UNACCESS-MSG    PIC X(29)
   573             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   574         16  PGMIDERR-MSG    PIC X(17)
   575             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL633.cbl
   577*                                    COPY ELCATTR.
   578******************************************************************
   579*                                                                *
   580*                            ELCATTR.                            *
   581*                            VMOD=2.001                          *
   582*                                                                *
   583*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   584*                                                                *
   585*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   586*                                                                *
   587*                   POS 1   P=PROTECTED                          *
   588*                           U=UNPROTECTED                        *
   589*                           S=ASKIP                              *
   590*                   POS 2   A=ALPHA/NUMERIC                      *
   591*                           N=NUMERIC                            *
   592*                   POS 3   N=NORMAL                             *
   593*                           B=BRIGHT                             *
   594*                           D=DARK                               *
   595*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   596*                           OF=MODIFIED DATA TAG OFF             *
   597*                                                                *
   598*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   599******************************************************************
   600 01  ATTRIBUTE-LIST.
   601     12  AL-PABOF            PIC X       VALUE 'Y'.
   602     12  AL-PABON            PIC X       VALUE 'Z'.
   603     12  AL-PADOF            PIC X       VALUE '%'.
   604     12  AL-PADON            PIC X       VALUE '_'.
   605     12  AL-PANOF            PIC X       VALUE '-'.
   606     12  AL-PANON            PIC X       VALUE '/'.
   607     12  AL-SABOF            PIC X       VALUE '8'.
   608     12  AL-SABON            PIC X       VALUE '9'.
   609     12  AL-SADOF            PIC X       VALUE '@'.
   610     12  AL-SADON            PIC X       VALUE QUOTE.
   611     12  AL-SANOF            PIC X       VALUE '0'.
   612     12  AL-SANON            PIC X       VALUE '1'.
   613     12  AL-UABOF            PIC X       VALUE 'H'.
   614     12  AL-UABON            PIC X       VALUE 'I'.
   615     12  AL-UADOF            PIC X       VALUE '<'.
   616     12  AL-UADON            PIC X       VALUE '('.
   617     12  AL-UANOF            PIC X       VALUE ' '.
   618     12  AL-UANON            PIC X       VALUE 'A'.
   619     12  AL-UNBOF            PIC X       VALUE 'Q'.
   620     12  AL-UNBON            PIC X       VALUE 'R'.
   621     12  AL-UNDOF            PIC X       VALUE '*'.
   622     12  AL-UNDON            PIC X       VALUE ')'.
   623     12  AL-UNNOF            PIC X       VALUE '&'.
   624     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL633.cbl
   626*                                    COPY ELCEMIB.
   627******************************************************************
   628*                                                                *
   629*                                                                *
   630*                            ELCEMIB.                            *
   631*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   632*                            VMOD=2.005                          *
   633*                                                                *
   634*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   635*                                                                *
   636******************************************************************
   637 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   638     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   639     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   640     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   641     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   642     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   643     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   644     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   645     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   646     12  EMI-SWITCH1             PIC X        VALUE '1'.
   647         88  EMI-NO-ERRORS                    VALUE '1'.
   648         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   649         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   650     12  EMI-SWITCH2             PIC X        VALUE '1'.
   651         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   652     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   653         88  EMI-AREA1-EMPTY                  VALUE '1'.
   654         88  EMI-AREA1-FULL                   VALUE '2'.
   655     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   656         88  EMI-AREA2-EMPTY                  VALUE '1'.
   657         88  EMI-AREA2-FULL                   VALUE '2'.
   658     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   659         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   660         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   661         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   662         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   663         88  EMI-BYPASS-FATALS                VALUE 'X'.
   664     12  EMI-ERROR-LINES.
   665         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   666         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   667         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   668         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   669             20  EMI-ERR-CODES OCCURS 10 TIMES.
   670                 24  EMI-ERR-NUM         PIC X(4).
   671                 24  EMI-FILLER          PIC X.
   672                 24  EMI-SEV             PIC X.
   673                 24  FILLER              PIC X.
   674             20  FILLER                  PIC X(02).
   675     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   676         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   677             20  EMI-ERROR-NUMBER    PIC X(4).
   678             20  EMI-FILL            PIC X.
   679             20  EMI-SEVERITY        PIC X.
   680             20  FILLER              PIC X.
   681             20  EMI-ERROR-TEXT.
   682                 24  EMI-TEXT-VARIABLE   PIC X(10).
   683                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL633.cbl
   684     12  EMI-SEVERITY-SAVE           PIC X.
   685         88  EMI-NOTE                    VALUE 'N'.
   686         88  EMI-WARNING                 VALUE 'W'.
   687         88  EMI-FORCABLE                VALUE 'F'.
   688         88  EMI-FATAL                   VALUE 'X'.
   689     12  EMI-MESSAGE-FLAG            PIC X.
   690         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   691         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   692     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   693     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   694         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   695         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   696         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   697     12  FILLER                      PIC X(137)  VALUE SPACES.
   698     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   699     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   700     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   701     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL633.cbl
   703*                                    COPY ELCINTF.
   704******************************************************************
   705*                                                                *
   706*                                                                *
   707*                            ELCINTF.                            *
   708*                            VMOD=2.017                          *
   709*                                                                *
   710*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   711*                                                                *
   712*       LENGTH = 1024                                            *
   713*                                                                *
   714******************************************************************
   715 01  PROGRAM-INTERFACE-BLOCK.
   716     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   717     12  PI-CALLING-PROGRAM              PIC X(8).
   718     12  PI-SAVED-PROGRAM-1              PIC X(8).
   719     12  PI-SAVED-PROGRAM-2              PIC X(8).
   720     12  PI-SAVED-PROGRAM-3              PIC X(8).
   721     12  PI-SAVED-PROGRAM-4              PIC X(8).
   722     12  PI-SAVED-PROGRAM-5              PIC X(8).
   723     12  PI-SAVED-PROGRAM-6              PIC X(8).
   724     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   725     12  PI-COMPANY-ID                   PIC XXX.
   726     12  PI-COMPANY-CD                   PIC X.
   727
   728     12  PI-COMPANY-PASSWORD             PIC X(8).
   729
   730     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   731
   732     12  PI-CONTROL-IN-PROGRESS.
   733         16  PI-CARRIER                  PIC X.
   734         16  PI-GROUPING                 PIC X(6).
   735         16  PI-STATE                    PIC XX.
   736         16  PI-ACCOUNT                  PIC X(10).
   737         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   738                                         PIC X(10).
   739         16  PI-CLAIM-CERT-GRP.
   740             20  PI-CLAIM-NO             PIC X(7).
   741             20  PI-CERT-NO.
   742                 25  PI-CERT-PRIME       PIC X(10).
   743                 25  PI-CERT-SFX         PIC X.
   744             20  PI-CERT-EFF-DT          PIC XX.
   745         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   746             20  PI-PLAN-CODE            PIC X(2).
   747             20  PI-REVISION-NUMBER      PIC X(3).
   748             20  PI-PLAN-EFF-DT          PIC X(2).
   749             20  PI-PLAN-EXP-DT          PIC X(2).
   750             20  FILLER                  PIC X(11).
   751         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   752             20  PI-OE-REFERENCE-1.
   753                 25  PI-OE-REF-1-PRIME   PIC X(18).
   754                 25  PI-OE-REF-1-SUFF    PIC XX.
   755
   756     12  PI-SESSION-IN-PROGRESS          PIC X.
   757         88  CLAIM-SESSION                   VALUE '1'.
   758         88  CREDIT-SESSION                  VALUE '2'.
   759         88  WARRANTY-SESSION                VALUE '3'.
   760         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL633.cbl
   761         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   762
   763
   764*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   765
   766     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   767     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   768
   769     12  PI-CREDIT-USER                  PIC X.
   770         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   771         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   772
   773     12  PI-CLAIM-USER                   PIC X.
   774         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   775         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   776
   777     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   778         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   779         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   780         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   781         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   782         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   783
   784     12  PI-PROCESSOR-ID                 PIC X(4).
   785
   786     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   787
   788     12  PI-MEMBER-CAPTION               PIC X(10).
   789
   790     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   791         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   792
   793     12  PI-LIFE-OVERRIDE-L1             PIC X.
   794     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   795     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   796     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   797
   798     12  PI-AH-OVERRIDE-L1               PIC X.
   799     12  PI-AH-OVERRIDE-L2               PIC XX.
   800     12  PI-AH-OVERRIDE-L6               PIC X(6).
   801     12  PI-AH-OVERRIDE-L12              PIC X(12).
   802
   803     12  PI-NEW-SYSTEM                   PIC X(2).
   804
   805     12  PI-PRIMARY-CERT-NO              PIC X(11).
   806     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   807         88  PI-USES-PAID-TO                 VALUE '1'.
   808     12  PI-CRDTCRD-SYSTEM.
   809         16  PI-CRDTCRD-USER             PIC X.
   810             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   811             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   812         16  PI-CC-MONTH-END-DT          PIC XX.
   813     12  PI-PROCESSOR-PRINTER            PIC X(4).
   814
   815     12  PI-OE-REFERENCE-2.
   816         16  PI-OE-REF-2-PRIME           PIC X(10).
   817         16  PI-OE-REF-2-SUFF            PIC X.
   818
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL633.cbl
   819     12  PI-REM-TRM-CALC-OPTION          PIC X.
   820
   821     12  PI-LANGUAGE-TYPE                PIC X.
   822             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   823             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   824             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   825
   826     12  PI-POLICY-LINKAGE-IND           PIC X.
   827         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   828         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   829                                                   LOW-VALUES.
   830
   831     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   832     12  PI-CLAIM-PW-SESSION             PIC X(1).
   833         88  PI-CLAIM-CREDIT                 VALUE '1'.
   834         88  PI-CLAIM-CONVEN                 VALUE '2'.
   835     12  FILLER                          PIC X(4).
   836
   837     12  PI-SYSTEM-LEVEL                 PIC X(145).
   838
   839     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   840         PI-SYSTEM-LEVEL.
   841
   842         16  PI-ENTRY-CODES.
   843             20  PI-ENTRY-CD-1           PIC X.
   844             20  PI-ENTRY-CD-2           PIC X.
   845
   846         16  PI-RETURN-CODES.
   847             20  PI-RETURN-CD-1          PIC X.
   848             20  PI-RETURN-CD-2          PIC X.
   849
   850         16  PI-UPDATE-STATUS-SAVE.
   851             20  PI-UPDATE-BY            PIC X(4).
   852             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   853
   854         16  PI-LOWER-CASE-LETTERS       PIC X.
   855             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   856
   857*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   858*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   859*            88  CARRIER-CLM-CNTL            VALUE '2'.
   860
   861         16  PI-CERT-ACCESS-CONTROL      PIC X.
   862             88  ST-ACCNT-CNTL               VALUE ' '.
   863             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   864             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   865             88  ACCNT-CNTL                  VALUE '3'.
   866             88  CARR-ACCNT-CNTL             VALUE '4'.
   867
   868         16  PI-PROCESSOR-CAP-LIST.
   869             20  PI-SYSTEM-CONTROLS.
   870                24 PI-SYSTEM-DISPLAY     PIC X.
   871                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   872                24 PI-SYSTEM-MODIFY      PIC X.
   873                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   874             20  FILLER                  PIC XX.
   875             20  PI-DISPLAY-CAP          PIC X.
   876                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL633.cbl
   877             20  PI-MODIFY-CAP           PIC X.
   878                 88  MODIFY-CAP              VALUE 'Y'.
   879             20  PI-MSG-AT-LOGON-CAP     PIC X.
   880                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   881             20  PI-FORCE-CAP            PIC X.
   882                 88  FORCE-CAP               VALUE 'Y'.
   883
   884         16  PI-PROGRAM-CONTROLS.
   885             20  PI-PGM-PRINT-OPT        PIC X.
   886             20  PI-PGM-FORMAT-OPT       PIC X.
   887             20  PI-PGM-PROCESS-OPT      PIC X.
   888             20  PI-PGM-TOTALS-OPT       PIC X.
   889
   890         16  PI-HELP-INTERFACE.
   891             20  PI-LAST-ERROR-NO        PIC X(4).
   892             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   893
   894         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   895             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   896
   897         16  PI-CR-CONTROL-IN-PROGRESS.
   898             20  PI-CR-CARRIER           PIC X.
   899             20  PI-CR-GROUPING          PIC X(6).
   900             20  PI-CR-STATE             PIC XX.
   901             20  PI-CR-ACCOUNT           PIC X(10).
   902             20  PI-CR-FIN-RESP          PIC X(10).
   903             20  PI-CR-TYPE              PIC X.
   904
   905         16  PI-CR-BATCH-NUMBER          PIC X(6).
   906
   907         16  PI-CR-MONTH-END-DT          PIC XX.
   908
   909         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   910             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   911             88  PI-ZERO-CARRIER             VALUE '1'.
   912             88  PI-ZERO-GROUPING            VALUE '2'.
   913             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   914
   915         16  PI-CARRIER-SECURITY         PIC X.
   916             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   917
   918         16  PI-ACCOUNT-SECURITY         PIC X(10).
   919             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   920             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   921
   922         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   923             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   924                                         INDEXED BY PI-ACCESS-NDX
   925                                         PIC X.
   926
   927         16  PI-GA-BILLING-CONTROL       PIC X.
   928             88  PI-GA-BILLING               VALUE '1'.
   929
   930         16  PI-MAIL-PROCESSING          PIC X.
   931             88  PI-MAIL-YES                 VALUE 'Y'.
   932
   933         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   934
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL633.cbl
   935         16  PI-AR-SYSTEM.
   936             20  PI-AR-PROCESSING-CNTL   PIC X.
   937                 88  PI-AR-PROCESSING        VALUE 'Y'.
   938             20  PI-AR-SUMMARY-CODE      PIC X(6).
   939             20  PI-AR-MONTH-END-DT      PIC XX.
   940
   941         16  PI-MP-SYSTEM.
   942             20  PI-MORTGAGE-USER            PIC X.
   943                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   944                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   945             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   946                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   947                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   948                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   949                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   950                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   951             20  PI-MP-MONTH-END-DT          PIC XX.
   952             20  PI-MP-REFERENCE-NO.
   953                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   954                 24  PI-MP-REFERENCE-SFX     PIC XX.
   955
   956         16  PI-LABEL-CONTROL            PIC X(01).
   957             88  PI-CREATE-LABELS                    VALUE 'Y'.
   958             88  PI-BYPASS-LABELS                    VALUE 'N'.
   959
   960         16  PI-BILL-GROUPING-CODE       PIC X(01).
   961             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   962
   963         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   964             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   965             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   966
   967         16  FILLER                      PIC X(14).
   968
   969     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   970******************************************************************
   971     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
   972         16  PI-PYAJ-FILE-SW             PIC  X.
   973             88  END-OF-ACCT                 VALUE 'A'.
   974             88  END-OF-ACCT-FULL-PAGE       VALUE 'B'.
   975             88  END-OF-FILE                 VALUE 'X'.
   976             88  TOP-OF-FILE                 VALUE 'T'.
   977             88  PAGE-FULL                   VALUE 'F'.
   978             88  NO-RECORDS                  VALUE 'Y'.
   979             88  NOT-OPEN                    VALUE 'Z'.
   980         16  PI-PREV-FUNCTION            PIC  X.
   981         16  PI-SAV-FUNCTION             PIC  X.
   982         16  PI-PREV-PFKEY               PIC  X.
   983         16  PI-SEQ-NOS.
   984             20  FILLER  OCCURS 13 TIMES
   985                             INDEXED BY NDX.
   986                 24  PI-REC-TYPE         PIC  X.
   987                 24  PI-FILE-SEQ-NO      PIC  S9(8)       COMP.
   988         16  PI-SAV-ENDING-PYAJ-KEY.
   989             20  PI-SAV-COMP-CD          PIC  X.
   990             20  PI-SAV-COMP-CONTROL.
   991                 24  PI-SAV-CARRIER      PIC  X.
   992                 24  PI-SAV-GROUPING     PIC  X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL633.cbl
   993                 24  PI-SAV-FIN-RESP     PIC  X(10).
   994                 24  PI-SAV-ACCOUNT      PIC  X(10).
   995                 24  PI-SAV-FILE-SEQ-NO  PIC  S9(8)          COMP.
   996                 24  PI-SAV-RECORD-TYPE  PIC  X.
   997         16  PI-START-PYAJ-KEY           PIC  X(33).
   998         16  PI-SAV-ACCT-AMT             PIC  S9(7)V99.
   999         16  PI-SAV-ACCT-NET             PIC  S9(7)V99.
  1000         16  PI-SAV-PREV-AMT             PIC  S9(7)V99.
  1001         16  PI-SAV-PREV-NET             PIC  S9(7)V99.
  1002         16  PI-TOTAL-DISPLAYED-SW       PIC  X.
  1003             88  PI-TOTAL-DISPLAYED               VALUE 'Y'.
  1004         16  PI-FULL-INDX                PIC  S9(4)      COMP.
  1005         16  PI-FRST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1006         16  PI-FRST-RECORD-TYPE         PIC  X.
  1007         16  PI-PREV-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1008         16  PI-PREV-RECORD-TYPE         PIC  X.
  1009         16  PI-LAST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1010         16  PI-LAST-RECORD-TYPE         PIC  X.
  1011         16  PI-PAGE-SW                  PIC  X.
  1012             88  FIRST-PAGE                          VALUE 'Y'.
  1013         16  FILLER                      PIC  X(450).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL633.cbl
  1015*                            COPY ELCJPFX.
  1016******************************************************************
  1017*                                                                *
  1018*                                                                *
  1019*                            ELCJPFX.                            *
  1020*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1021*                            VMOD=2.002                          *
  1022*                                                                *
  1023*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1024*                                                                *
  1025*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1026*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1027*        ELCNTL - CONTROL FILE                                   *
  1028*        ELMSTR - CLAIM MASTERS                                  *
  1029*        ELTRLR - ACTIVITY TRAILERS                              *
  1030*        ELCHKQ - CHECK QUE                                      *
  1031******************************************************************
  1032 01  JOURNAL-RECORD.
  1033     12  JP-USER-ID                  PIC X(4).
  1034     12  JP-FILE-ID                  PIC X(8).
  1035     12  JP-PROGRAM-ID               PIC X(8).
  1036     12  JP-RECORD-TYPE              PIC X.
  1037         88 JP-ADD              VALUE 'A'.
  1038         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1039         88 JP-AFTER-CHANGE     VALUE 'C'.
  1040         88 JP-DELETE           VALUE 'D'.
  1041         88 JP-GENERIC-DELETE   VALUE 'G'.
  1042         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1043         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1044     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1045     12  JP-RECORD-AREA
  1046
  1047
  1048                             PIC  X(223).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL633.cbl
  1050*                            COPY ELCAID.
  1051******************************************************************
  1052*                                                                *
  1053*                            ELCAID.                             *
  1054*                            VMOD=2.001                          *
  1055*                                                                *
  1056*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1057*                                                                *
  1058*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1059*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1060******************************************************************
  1061
  1062 01  DFHAID.
  1063   02  DFHNULL   PIC  X  VALUE  ' '.
  1064   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1065   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1066   02  DFHPEN    PIC  X  VALUE  '='.
  1067   02  DFHOPID   PIC  X  VALUE  'W'.
  1068   02  DFHPA1    PIC  X  VALUE  '%'.
  1069   02  DFHPA2    PIC  X  VALUE  '>'.
  1070   02  DFHPA3    PIC  X  VALUE  ','.
  1071   02  DFHPF1    PIC  X  VALUE  '1'.
  1072   02  DFHPF2    PIC  X  VALUE  '2'.
  1073   02  DFHPF3    PIC  X  VALUE  '3'.
  1074   02  DFHPF4    PIC  X  VALUE  '4'.
  1075   02  DFHPF5    PIC  X  VALUE  '5'.
  1076   02  DFHPF6    PIC  X  VALUE  '6'.
  1077   02  DFHPF7    PIC  X  VALUE  '7'.
  1078   02  DFHPF8    PIC  X  VALUE  '8'.
  1079   02  DFHPF9    PIC  X  VALUE  '9'.
  1080   02  DFHPF10   PIC  X  VALUE  ':'.
  1081   02  DFHPF11   PIC  X  VALUE  '#'.
  1082   02  DFHPF12   PIC  X  VALUE  '@'.
  1083   02  DFHPF13   PIC  X  VALUE  'A'.
  1084   02  DFHPF14   PIC  X  VALUE  'B'.
  1085   02  DFHPF15   PIC  X  VALUE  'C'.
  1086   02  DFHPF16   PIC  X  VALUE  'D'.
  1087   02  DFHPF17   PIC  X  VALUE  'E'.
  1088   02  DFHPF18   PIC  X  VALUE  'F'.
  1089   02  DFHPF19   PIC  X  VALUE  'G'.
  1090   02  DFHPF20   PIC  X  VALUE  'H'.
  1091   02  DFHPF21   PIC  X  VALUE  'I'.
  1092*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1093   02  DFHPF22   PIC  X  VALUE  '['.
  1094   02  DFHPF23   PIC  X  VALUE  '.'.
  1095   02  DFHPF24   PIC  X  VALUE  '<'.
  1096   02  DFHMSRE   PIC  X  VALUE  'X'.
  1097   02  DFHSTRF   PIC  X  VALUE  'h'.
  1098   02  DFHTRIG   PIC  X  VALUE  '"'.
  1099
  1100 01  FILLER  REDEFINES  DFHAID.
  1101     12  FILLER              PIC  X(8).
  1102     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL633.cbl
  1104*                            COPY EL633S.
  1105 01  EL633AI.
  1106     05  FILLER            PIC  X(0012).
  1107*    -------------------------------
  1108     05  DATEL PIC S9(0004) COMP.
  1109     05  DATEF PIC  X(0001).
  1110     05  FILLER REDEFINES DATEF.
  1111         10  DATEA PIC  X(0001).
  1112     05  DATEI PIC  X(0008).
  1113*    -------------------------------
  1114     05  TIMEL PIC S9(0004) COMP.
  1115     05  TIMEF PIC  X(0001).
  1116     05  FILLER REDEFINES TIMEF.
  1117         10  TIMEA PIC  X(0001).
  1118     05  TIMEI PIC  X(0005).
  1119*    -------------------------------
  1120     05  CMPNYIDL PIC S9(0004) COMP.
  1121     05  CMPNYIDF PIC  X(0001).
  1122     05  FILLER REDEFINES CMPNYIDF.
  1123         10  CMPNYIDA PIC  X(0001).
  1124     05  CMPNYIDI PIC  X(0003).
  1125*    -------------------------------
  1126     05  USERIDL PIC S9(0004) COMP.
  1127     05  USERIDF PIC  X(0001).
  1128     05  FILLER REDEFINES USERIDF.
  1129         10  USERIDA PIC  X(0001).
  1130     05  USERIDI PIC  X(0004).
  1131*    -------------------------------
  1132     05  MAINTL PIC S9(0004) COMP.
  1133     05  MAINTF PIC  X(0001).
  1134     05  FILLER REDEFINES MAINTF.
  1135         10  MAINTA PIC  X(0001).
  1136     05  MAINTI PIC  X(0001).
  1137*    -------------------------------
  1138     05  CARRIERL PIC S9(0004) COMP.
  1139     05  CARRIERF PIC  X(0001).
  1140     05  FILLER REDEFINES CARRIERF.
  1141         10  CARRIERA PIC  X(0001).
  1142     05  CARRIERI PIC  X(0001).
  1143*    -------------------------------
  1144     05  GROUPL PIC S9(0004) COMP.
  1145     05  GROUPF PIC  X(0001).
  1146     05  FILLER REDEFINES GROUPF.
  1147         10  GROUPA PIC  X(0001).
  1148     05  GROUPI PIC  X(0006).
  1149*    -------------------------------
  1150     05  FINRESPL PIC S9(0004) COMP.
  1151     05  FINRESPF PIC  X(0001).
  1152     05  FILLER REDEFINES FINRESPF.
  1153         10  FINRESPA PIC  X(0001).
  1154     05  FINRESPI PIC  X(0010).
  1155*    -------------------------------
  1156     05  ACCTL PIC S9(0004) COMP.
  1157     05  ACCTF PIC  X(0001).
  1158     05  FILLER REDEFINES ACCTF.
  1159         10  ACCTA PIC  X(0001).
  1160     05  ACCTI PIC  X(0010).
  1161*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL633.cbl
  1162     05  MSAAC1L PIC S9(0004) COMP.
  1163     05  MSAAC1F PIC  X(0001).
  1164     05  FILLER REDEFINES MSAAC1F.
  1165         10  MSAAC1A PIC  X(0001).
  1166     05  MSAAC1I PIC  X(0010).
  1167*    -------------------------------
  1168     05  MSAST1L PIC S9(0004) COMP.
  1169     05  MSAST1F PIC  X(0001).
  1170     05  FILLER REDEFINES MSAST1F.
  1171         10  MSAST1A PIC  X(0001).
  1172     05  MSAST1I PIC  X(0002).
  1173*    -------------------------------
  1174     05  MSACN1L PIC S9(0004) COMP.
  1175     05  MSACN1F PIC  X(0001).
  1176     05  FILLER REDEFINES MSACN1F.
  1177         10  MSACN1A PIC  X(0001).
  1178     05  MSACN1I PIC  X(0001).
  1179*    -------------------------------
  1180     05  MSACM1L PIC S9(0004) COMP.
  1181     05  MSACM1F PIC  X(0001).
  1182     05  FILLER REDEFINES MSACM1F.
  1183         10  MSACM1A PIC  X(0001).
  1184     05  MSACM1I PIC  X(0010).
  1185*    -------------------------------
  1186     05  TYPE1L PIC S9(0004) COMP.
  1187     05  TYPE1F PIC  X(0001).
  1188     05  FILLER REDEFINES TYPE1F.
  1189         10  TYPE1A PIC  X(0001).
  1190     05  TYPE1I PIC  X(0001).
  1191*    -------------------------------
  1192     05  AMT1L PIC S9(0004) COMP.
  1193     05  AMT1F PIC  X(0001).
  1194     05  FILLER REDEFINES AMT1F.
  1195         10  AMT1A PIC  X(0001).
  1196     05  AMT1I PIC  X(0011).
  1197*    -------------------------------
  1198     05  VOID1L PIC S9(0004) COMP.
  1199     05  VOID1F PIC  X(0001).
  1200     05  FILLER REDEFINES VOID1F.
  1201         10  VOID1A PIC  X(0001).
  1202     05  VOID1I PIC  X(0001).
  1203*    -------------------------------
  1204     05  MDT1L PIC S9(0004) COMP.
  1205     05  MDT1F PIC  X(0001).
  1206     05  FILLER REDEFINES MDT1F.
  1207         10  MDT1A PIC  X(0001).
  1208     05  MDT1I PIC  X(0006).
  1209*    -------------------------------
  1210     05  BDT1L PIC S9(0004) COMP.
  1211     05  BDT1F PIC  X(0001).
  1212     05  FILLER REDEFINES BDT1F.
  1213         10  BDT1A PIC  X(0001).
  1214     05  BDT1I PIC  X(0006).
  1215*    -------------------------------
  1216     05  SDT1L PIC S9(0004) COMP.
  1217     05  SDT1F PIC  X(0001).
  1218     05  FILLER REDEFINES SDT1F.
  1219         10  SDT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL633.cbl
  1220     05  SDT1I PIC  X(0006).
  1221*    -------------------------------
  1222     05  MSAAC2L PIC S9(0004) COMP.
  1223     05  MSAAC2F PIC  X(0001).
  1224     05  FILLER REDEFINES MSAAC2F.
  1225         10  MSAAC2A PIC  X(0001).
  1226     05  MSAAC2I PIC  X(0010).
  1227*    -------------------------------
  1228     05  MSAST2L PIC S9(0004) COMP.
  1229     05  MSAST2F PIC  X(0001).
  1230     05  FILLER REDEFINES MSAST2F.
  1231         10  MSAST2A PIC  X(0001).
  1232     05  MSAST2I PIC  X(0002).
  1233*    -------------------------------
  1234     05  MSACN2L PIC S9(0004) COMP.
  1235     05  MSACN2F PIC  X(0001).
  1236     05  FILLER REDEFINES MSACN2F.
  1237         10  MSACN2A PIC  X(0001).
  1238     05  MSACN2I PIC  X(0001).
  1239*    -------------------------------
  1240     05  MSACM2L PIC S9(0004) COMP.
  1241     05  MSACM2F PIC  X(0001).
  1242     05  FILLER REDEFINES MSACM2F.
  1243         10  MSACM2A PIC  X(0001).
  1244     05  MSACM2I PIC  X(0010).
  1245*    -------------------------------
  1246     05  TYPE2L PIC S9(0004) COMP.
  1247     05  TYPE2F PIC  X(0001).
  1248     05  FILLER REDEFINES TYPE2F.
  1249         10  TYPE2A PIC  X(0001).
  1250     05  TYPE2I PIC  X(0001).
  1251*    -------------------------------
  1252     05  AMT2L PIC S9(0004) COMP.
  1253     05  AMT2F PIC  X(0001).
  1254     05  FILLER REDEFINES AMT2F.
  1255         10  AMT2A PIC  X(0001).
  1256     05  AMT2I PIC  X(0011).
  1257*    -------------------------------
  1258     05  VOID2L PIC S9(0004) COMP.
  1259     05  VOID2F PIC  X(0001).
  1260     05  FILLER REDEFINES VOID2F.
  1261         10  VOID2A PIC  X(0001).
  1262     05  VOID2I PIC  X(0001).
  1263*    -------------------------------
  1264     05  MDT2L PIC S9(0004) COMP.
  1265     05  MDT2F PIC  X(0001).
  1266     05  FILLER REDEFINES MDT2F.
  1267         10  MDT2A PIC  X(0001).
  1268     05  MDT2I PIC  X(0006).
  1269*    -------------------------------
  1270     05  BDT2L PIC S9(0004) COMP.
  1271     05  BDT2F PIC  X(0001).
  1272     05  FILLER REDEFINES BDT2F.
  1273         10  BDT2A PIC  X(0001).
  1274     05  BDT2I PIC  X(0006).
  1275*    -------------------------------
  1276     05  SDT2L PIC S9(0004) COMP.
  1277     05  SDT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL633.cbl
  1278     05  FILLER REDEFINES SDT2F.
  1279         10  SDT2A PIC  X(0001).
  1280     05  SDT2I PIC  X(0006).
  1281*    -------------------------------
  1282     05  MSAAC3L PIC S9(0004) COMP.
  1283     05  MSAAC3F PIC  X(0001).
  1284     05  FILLER REDEFINES MSAAC3F.
  1285         10  MSAAC3A PIC  X(0001).
  1286     05  MSAAC3I PIC  X(0010).
  1287*    -------------------------------
  1288     05  MSAST3L PIC S9(0004) COMP.
  1289     05  MSAST3F PIC  X(0001).
  1290     05  FILLER REDEFINES MSAST3F.
  1291         10  MSAST3A PIC  X(0001).
  1292     05  MSAST3I PIC  X(0002).
  1293*    -------------------------------
  1294     05  MSACN3L PIC S9(0004) COMP.
  1295     05  MSACN3F PIC  X(0001).
  1296     05  FILLER REDEFINES MSACN3F.
  1297         10  MSACN3A PIC  X(0001).
  1298     05  MSACN3I PIC  X(0001).
  1299*    -------------------------------
  1300     05  MSACM3L PIC S9(0004) COMP.
  1301     05  MSACM3F PIC  X(0001).
  1302     05  FILLER REDEFINES MSACM3F.
  1303         10  MSACM3A PIC  X(0001).
  1304     05  MSACM3I PIC  X(0010).
  1305*    -------------------------------
  1306     05  TYPE3L PIC S9(0004) COMP.
  1307     05  TYPE3F PIC  X(0001).
  1308     05  FILLER REDEFINES TYPE3F.
  1309         10  TYPE3A PIC  X(0001).
  1310     05  TYPE3I PIC  X(0001).
  1311*    -------------------------------
  1312     05  AMT3L PIC S9(0004) COMP.
  1313     05  AMT3F PIC  X(0001).
  1314     05  FILLER REDEFINES AMT3F.
  1315         10  AMT3A PIC  X(0001).
  1316     05  AMT3I PIC  X(0011).
  1317*    -------------------------------
  1318     05  VOID3L PIC S9(0004) COMP.
  1319     05  VOID3F PIC  X(0001).
  1320     05  FILLER REDEFINES VOID3F.
  1321         10  VOID3A PIC  X(0001).
  1322     05  VOID3I PIC  X(0001).
  1323*    -------------------------------
  1324     05  MDT3L PIC S9(0004) COMP.
  1325     05  MDT3F PIC  X(0001).
  1326     05  FILLER REDEFINES MDT3F.
  1327         10  MDT3A PIC  X(0001).
  1328     05  MDT3I PIC  X(0006).
  1329*    -------------------------------
  1330     05  BDT3L PIC S9(0004) COMP.
  1331     05  BDT3F PIC  X(0001).
  1332     05  FILLER REDEFINES BDT3F.
  1333         10  BDT3A PIC  X(0001).
  1334     05  BDT3I PIC  X(0006).
  1335*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL633.cbl
  1336     05  SDT3L PIC S9(0004) COMP.
  1337     05  SDT3F PIC  X(0001).
  1338     05  FILLER REDEFINES SDT3F.
  1339         10  SDT3A PIC  X(0001).
  1340     05  SDT3I PIC  X(0006).
  1341*    -------------------------------
  1342     05  MSAAC4L PIC S9(0004) COMP.
  1343     05  MSAAC4F PIC  X(0001).
  1344     05  FILLER REDEFINES MSAAC4F.
  1345         10  MSAAC4A PIC  X(0001).
  1346     05  MSAAC4I PIC  X(0010).
  1347*    -------------------------------
  1348     05  MSAST4L PIC S9(0004) COMP.
  1349     05  MSAST4F PIC  X(0001).
  1350     05  FILLER REDEFINES MSAST4F.
  1351         10  MSAST4A PIC  X(0001).
  1352     05  MSAST4I PIC  X(0002).
  1353*    -------------------------------
  1354     05  MSACN4L PIC S9(0004) COMP.
  1355     05  MSACN4F PIC  X(0001).
  1356     05  FILLER REDEFINES MSACN4F.
  1357         10  MSACN4A PIC  X(0001).
  1358     05  MSACN4I PIC  X(0001).
  1359*    -------------------------------
  1360     05  MSACM4L PIC S9(0004) COMP.
  1361     05  MSACM4F PIC  X(0001).
  1362     05  FILLER REDEFINES MSACM4F.
  1363         10  MSACM4A PIC  X(0001).
  1364     05  MSACM4I PIC  X(0010).
  1365*    -------------------------------
  1366     05  TYPE4L PIC S9(0004) COMP.
  1367     05  TYPE4F PIC  X(0001).
  1368     05  FILLER REDEFINES TYPE4F.
  1369         10  TYPE4A PIC  X(0001).
  1370     05  TYPE4I PIC  X(0001).
  1371*    -------------------------------
  1372     05  AMT4L PIC S9(0004) COMP.
  1373     05  AMT4F PIC  X(0001).
  1374     05  FILLER REDEFINES AMT4F.
  1375         10  AMT4A PIC  X(0001).
  1376     05  AMT4I PIC  X(0011).
  1377*    -------------------------------
  1378     05  VOID4L PIC S9(0004) COMP.
  1379     05  VOID4F PIC  X(0001).
  1380     05  FILLER REDEFINES VOID4F.
  1381         10  VOID4A PIC  X(0001).
  1382     05  VOID4I PIC  X(0001).
  1383*    -------------------------------
  1384     05  MDT4L PIC S9(0004) COMP.
  1385     05  MDT4F PIC  X(0001).
  1386     05  FILLER REDEFINES MDT4F.
  1387         10  MDT4A PIC  X(0001).
  1388     05  MDT4I PIC  X(0006).
  1389*    -------------------------------
  1390     05  BDT4L PIC S9(0004) COMP.
  1391     05  BDT4F PIC  X(0001).
  1392     05  FILLER REDEFINES BDT4F.
  1393         10  BDT4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL633.cbl
  1394     05  BDT4I PIC  X(0006).
  1395*    -------------------------------
  1396     05  SDT4L PIC S9(0004) COMP.
  1397     05  SDT4F PIC  X(0001).
  1398     05  FILLER REDEFINES SDT4F.
  1399         10  SDT4A PIC  X(0001).
  1400     05  SDT4I PIC  X(0006).
  1401*    -------------------------------
  1402     05  MSAAC5L PIC S9(0004) COMP.
  1403     05  MSAAC5F PIC  X(0001).
  1404     05  FILLER REDEFINES MSAAC5F.
  1405         10  MSAAC5A PIC  X(0001).
  1406     05  MSAAC5I PIC  X(0010).
  1407*    -------------------------------
  1408     05  MSAST5L PIC S9(0004) COMP.
  1409     05  MSAST5F PIC  X(0001).
  1410     05  FILLER REDEFINES MSAST5F.
  1411         10  MSAST5A PIC  X(0001).
  1412     05  MSAST5I PIC  X(0002).
  1413*    -------------------------------
  1414     05  MSACN5L PIC S9(0004) COMP.
  1415     05  MSACN5F PIC  X(0001).
  1416     05  FILLER REDEFINES MSACN5F.
  1417         10  MSACN5A PIC  X(0001).
  1418     05  MSACN5I PIC  X(0001).
  1419*    -------------------------------
  1420     05  MSACM5L PIC S9(0004) COMP.
  1421     05  MSACM5F PIC  X(0001).
  1422     05  FILLER REDEFINES MSACM5F.
  1423         10  MSACM5A PIC  X(0001).
  1424     05  MSACM5I PIC  X(0010).
  1425*    -------------------------------
  1426     05  TYPE5L PIC S9(0004) COMP.
  1427     05  TYPE5F PIC  X(0001).
  1428     05  FILLER REDEFINES TYPE5F.
  1429         10  TYPE5A PIC  X(0001).
  1430     05  TYPE5I PIC  X(0001).
  1431*    -------------------------------
  1432     05  AMT5L PIC S9(0004) COMP.
  1433     05  AMT5F PIC  X(0001).
  1434     05  FILLER REDEFINES AMT5F.
  1435         10  AMT5A PIC  X(0001).
  1436     05  AMT5I PIC  X(0011).
  1437*    -------------------------------
  1438     05  VOID5L PIC S9(0004) COMP.
  1439     05  VOID5F PIC  X(0001).
  1440     05  FILLER REDEFINES VOID5F.
  1441         10  VOID5A PIC  X(0001).
  1442     05  VOID5I PIC  X(0001).
  1443*    -------------------------------
  1444     05  MDT5L PIC S9(0004) COMP.
  1445     05  MDT5F PIC  X(0001).
  1446     05  FILLER REDEFINES MDT5F.
  1447         10  MDT5A PIC  X(0001).
  1448     05  MDT5I PIC  X(0006).
  1449*    -------------------------------
  1450     05  BDT5L PIC S9(0004) COMP.
  1451     05  BDT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL633.cbl
  1452     05  FILLER REDEFINES BDT5F.
  1453         10  BDT5A PIC  X(0001).
  1454     05  BDT5I PIC  X(0006).
  1455*    -------------------------------
  1456     05  SDT5L PIC S9(0004) COMP.
  1457     05  SDT5F PIC  X(0001).
  1458     05  FILLER REDEFINES SDT5F.
  1459         10  SDT5A PIC  X(0001).
  1460     05  SDT5I PIC  X(0006).
  1461*    -------------------------------
  1462     05  MSAAC6L PIC S9(0004) COMP.
  1463     05  MSAAC6F PIC  X(0001).
  1464     05  FILLER REDEFINES MSAAC6F.
  1465         10  MSAAC6A PIC  X(0001).
  1466     05  MSAAC6I PIC  X(0010).
  1467*    -------------------------------
  1468     05  MSAST6L PIC S9(0004) COMP.
  1469     05  MSAST6F PIC  X(0001).
  1470     05  FILLER REDEFINES MSAST6F.
  1471         10  MSAST6A PIC  X(0001).
  1472     05  MSAST6I PIC  X(0002).
  1473*    -------------------------------
  1474     05  MSACN6L PIC S9(0004) COMP.
  1475     05  MSACN6F PIC  X(0001).
  1476     05  FILLER REDEFINES MSACN6F.
  1477         10  MSACN6A PIC  X(0001).
  1478     05  MSACN6I PIC  X(0001).
  1479*    -------------------------------
  1480     05  MSACM6L PIC S9(0004) COMP.
  1481     05  MSACM6F PIC  X(0001).
  1482     05  FILLER REDEFINES MSACM6F.
  1483         10  MSACM6A PIC  X(0001).
  1484     05  MSACM6I PIC  X(0010).
  1485*    -------------------------------
  1486     05  TYPE6L PIC S9(0004) COMP.
  1487     05  TYPE6F PIC  X(0001).
  1488     05  FILLER REDEFINES TYPE6F.
  1489         10  TYPE6A PIC  X(0001).
  1490     05  TYPE6I PIC  X(0001).
  1491*    -------------------------------
  1492     05  AMT6L PIC S9(0004) COMP.
  1493     05  AMT6F PIC  X(0001).
  1494     05  FILLER REDEFINES AMT6F.
  1495         10  AMT6A PIC  X(0001).
  1496     05  AMT6I PIC  X(0011).
  1497*    -------------------------------
  1498     05  VOID6L PIC S9(0004) COMP.
  1499     05  VOID6F PIC  X(0001).
  1500     05  FILLER REDEFINES VOID6F.
  1501         10  VOID6A PIC  X(0001).
  1502     05  VOID6I PIC  X(0001).
  1503*    -------------------------------
  1504     05  MDT6L PIC S9(0004) COMP.
  1505     05  MDT6F PIC  X(0001).
  1506     05  FILLER REDEFINES MDT6F.
  1507         10  MDT6A PIC  X(0001).
  1508     05  MDT6I PIC  X(0006).
  1509*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL633.cbl
  1510     05  BDT6L PIC S9(0004) COMP.
  1511     05  BDT6F PIC  X(0001).
  1512     05  FILLER REDEFINES BDT6F.
  1513         10  BDT6A PIC  X(0001).
  1514     05  BDT6I PIC  X(0006).
  1515*    -------------------------------
  1516     05  SDT6L PIC S9(0004) COMP.
  1517     05  SDT6F PIC  X(0001).
  1518     05  FILLER REDEFINES SDT6F.
  1519         10  SDT6A PIC  X(0001).
  1520     05  SDT6I PIC  X(0006).
  1521*    -------------------------------
  1522     05  MSAAC7L PIC S9(0004) COMP.
  1523     05  MSAAC7F PIC  X(0001).
  1524     05  FILLER REDEFINES MSAAC7F.
  1525         10  MSAAC7A PIC  X(0001).
  1526     05  MSAAC7I PIC  X(0010).
  1527*    -------------------------------
  1528     05  MSAST7L PIC S9(0004) COMP.
  1529     05  MSAST7F PIC  X(0001).
  1530     05  FILLER REDEFINES MSAST7F.
  1531         10  MSAST7A PIC  X(0001).
  1532     05  MSAST7I PIC  X(0002).
  1533*    -------------------------------
  1534     05  MSACN7L PIC S9(0004) COMP.
  1535     05  MSACN7F PIC  X(0001).
  1536     05  FILLER REDEFINES MSACN7F.
  1537         10  MSACN7A PIC  X(0001).
  1538     05  MSACN7I PIC  X(0001).
  1539*    -------------------------------
  1540     05  MSACM7L PIC S9(0004) COMP.
  1541     05  MSACM7F PIC  X(0001).
  1542     05  FILLER REDEFINES MSACM7F.
  1543         10  MSACM7A PIC  X(0001).
  1544     05  MSACM7I PIC  X(0010).
  1545*    -------------------------------
  1546     05  TYPE7L PIC S9(0004) COMP.
  1547     05  TYPE7F PIC  X(0001).
  1548     05  FILLER REDEFINES TYPE7F.
  1549         10  TYPE7A PIC  X(0001).
  1550     05  TYPE7I PIC  X(0001).
  1551*    -------------------------------
  1552     05  AMT7L PIC S9(0004) COMP.
  1553     05  AMT7F PIC  X(0001).
  1554     05  FILLER REDEFINES AMT7F.
  1555         10  AMT7A PIC  X(0001).
  1556     05  AMT7I PIC  X(0011).
  1557*    -------------------------------
  1558     05  VOID7L PIC S9(0004) COMP.
  1559     05  VOID7F PIC  X(0001).
  1560     05  FILLER REDEFINES VOID7F.
  1561         10  VOID7A PIC  X(0001).
  1562     05  VOID7I PIC  X(0001).
  1563*    -------------------------------
  1564     05  MDT7L PIC S9(0004) COMP.
  1565     05  MDT7F PIC  X(0001).
  1566     05  FILLER REDEFINES MDT7F.
  1567         10  MDT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL633.cbl
  1568     05  MDT7I PIC  X(0006).
  1569*    -------------------------------
  1570     05  BDT7L PIC S9(0004) COMP.
  1571     05  BDT7F PIC  X(0001).
  1572     05  FILLER REDEFINES BDT7F.
  1573         10  BDT7A PIC  X(0001).
  1574     05  BDT7I PIC  X(0006).
  1575*    -------------------------------
  1576     05  SDT7L PIC S9(0004) COMP.
  1577     05  SDT7F PIC  X(0001).
  1578     05  FILLER REDEFINES SDT7F.
  1579         10  SDT7A PIC  X(0001).
  1580     05  SDT7I PIC  X(0006).
  1581*    -------------------------------
  1582     05  MSAAC8L PIC S9(0004) COMP.
  1583     05  MSAAC8F PIC  X(0001).
  1584     05  FILLER REDEFINES MSAAC8F.
  1585         10  MSAAC8A PIC  X(0001).
  1586     05  MSAAC8I PIC  X(0010).
  1587*    -------------------------------
  1588     05  MSAST8L PIC S9(0004) COMP.
  1589     05  MSAST8F PIC  X(0001).
  1590     05  FILLER REDEFINES MSAST8F.
  1591         10  MSAST8A PIC  X(0001).
  1592     05  MSAST8I PIC  X(0002).
  1593*    -------------------------------
  1594     05  MSACN8L PIC S9(0004) COMP.
  1595     05  MSACN8F PIC  X(0001).
  1596     05  FILLER REDEFINES MSACN8F.
  1597         10  MSACN8A PIC  X(0001).
  1598     05  MSACN8I PIC  X(0001).
  1599*    -------------------------------
  1600     05  MSACM8L PIC S9(0004) COMP.
  1601     05  MSACM8F PIC  X(0001).
  1602     05  FILLER REDEFINES MSACM8F.
  1603         10  MSACM8A PIC  X(0001).
  1604     05  MSACM8I PIC  X(0010).
  1605*    -------------------------------
  1606     05  TYPE8L PIC S9(0004) COMP.
  1607     05  TYPE8F PIC  X(0001).
  1608     05  FILLER REDEFINES TYPE8F.
  1609         10  TYPE8A PIC  X(0001).
  1610     05  TYPE8I PIC  X(0001).
  1611*    -------------------------------
  1612     05  AMT8L PIC S9(0004) COMP.
  1613     05  AMT8F PIC  X(0001).
  1614     05  FILLER REDEFINES AMT8F.
  1615         10  AMT8A PIC  X(0001).
  1616     05  AMT8I PIC  X(0011).
  1617*    -------------------------------
  1618     05  VOID8L PIC S9(0004) COMP.
  1619     05  VOID8F PIC  X(0001).
  1620     05  FILLER REDEFINES VOID8F.
  1621         10  VOID8A PIC  X(0001).
  1622     05  VOID8I PIC  X(0001).
  1623*    -------------------------------
  1624     05  MDT8L PIC S9(0004) COMP.
  1625     05  MDT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL633.cbl
  1626     05  FILLER REDEFINES MDT8F.
  1627         10  MDT8A PIC  X(0001).
  1628     05  MDT8I PIC  X(0006).
  1629*    -------------------------------
  1630     05  BDT8L PIC S9(0004) COMP.
  1631     05  BDT8F PIC  X(0001).
  1632     05  FILLER REDEFINES BDT8F.
  1633         10  BDT8A PIC  X(0001).
  1634     05  BDT8I PIC  X(0006).
  1635*    -------------------------------
  1636     05  SDT8L PIC S9(0004) COMP.
  1637     05  SDT8F PIC  X(0001).
  1638     05  FILLER REDEFINES SDT8F.
  1639         10  SDT8A PIC  X(0001).
  1640     05  SDT8I PIC  X(0006).
  1641*    -------------------------------
  1642     05  MSAAC9L PIC S9(0004) COMP.
  1643     05  MSAAC9F PIC  X(0001).
  1644     05  FILLER REDEFINES MSAAC9F.
  1645         10  MSAAC9A PIC  X(0001).
  1646     05  MSAAC9I PIC  X(0010).
  1647*    -------------------------------
  1648     05  MSAST9L PIC S9(0004) COMP.
  1649     05  MSAST9F PIC  X(0001).
  1650     05  FILLER REDEFINES MSAST9F.
  1651         10  MSAST9A PIC  X(0001).
  1652     05  MSAST9I PIC  X(0002).
  1653*    -------------------------------
  1654     05  MSACN9L PIC S9(0004) COMP.
  1655     05  MSACN9F PIC  X(0001).
  1656     05  FILLER REDEFINES MSACN9F.
  1657         10  MSACN9A PIC  X(0001).
  1658     05  MSACN9I PIC  X(0001).
  1659*    -------------------------------
  1660     05  MSACM9L PIC S9(0004) COMP.
  1661     05  MSACM9F PIC  X(0001).
  1662     05  FILLER REDEFINES MSACM9F.
  1663         10  MSACM9A PIC  X(0001).
  1664     05  MSACM9I PIC  X(0010).
  1665*    -------------------------------
  1666     05  TYPE9L PIC S9(0004) COMP.
  1667     05  TYPE9F PIC  X(0001).
  1668     05  FILLER REDEFINES TYPE9F.
  1669         10  TYPE9A PIC  X(0001).
  1670     05  TYPE9I PIC  X(0001).
  1671*    -------------------------------
  1672     05  AMT9L PIC S9(0004) COMP.
  1673     05  AMT9F PIC  X(0001).
  1674     05  FILLER REDEFINES AMT9F.
  1675         10  AMT9A PIC  X(0001).
  1676     05  AMT9I PIC  X(0011).
  1677*    -------------------------------
  1678     05  VOID9L PIC S9(0004) COMP.
  1679     05  VOID9F PIC  X(0001).
  1680     05  FILLER REDEFINES VOID9F.
  1681         10  VOID9A PIC  X(0001).
  1682     05  VOID9I PIC  X(0001).
  1683*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL633.cbl
  1684     05  MDT9L PIC S9(0004) COMP.
  1685     05  MDT9F PIC  X(0001).
  1686     05  FILLER REDEFINES MDT9F.
  1687         10  MDT9A PIC  X(0001).
  1688     05  MDT9I PIC  X(0006).
  1689*    -------------------------------
  1690     05  BDT9L PIC S9(0004) COMP.
  1691     05  BDT9F PIC  X(0001).
  1692     05  FILLER REDEFINES BDT9F.
  1693         10  BDT9A PIC  X(0001).
  1694     05  BDT9I PIC  X(0006).
  1695*    -------------------------------
  1696     05  SDT9L PIC S9(0004) COMP.
  1697     05  SDT9F PIC  X(0001).
  1698     05  FILLER REDEFINES SDT9F.
  1699         10  SDT9A PIC  X(0001).
  1700     05  SDT9I PIC  X(0006).
  1701*    -------------------------------
  1702     05  MSAAC10L PIC S9(0004) COMP.
  1703     05  MSAAC10F PIC  X(0001).
  1704     05  FILLER REDEFINES MSAAC10F.
  1705         10  MSAAC10A PIC  X(0001).
  1706     05  MSAAC10I PIC  X(0010).
  1707*    -------------------------------
  1708     05  MSAST10L PIC S9(0004) COMP.
  1709     05  MSAST10F PIC  X(0001).
  1710     05  FILLER REDEFINES MSAST10F.
  1711         10  MSAST10A PIC  X(0001).
  1712     05  MSAST10I PIC  X(0002).
  1713*    -------------------------------
  1714     05  MSACN10L PIC S9(0004) COMP.
  1715     05  MSACN10F PIC  X(0001).
  1716     05  FILLER REDEFINES MSACN10F.
  1717         10  MSACN10A PIC  X(0001).
  1718     05  MSACN10I PIC  X(0001).
  1719*    -------------------------------
  1720     05  MSACM10L PIC S9(0004) COMP.
  1721     05  MSACM10F PIC  X(0001).
  1722     05  FILLER REDEFINES MSACM10F.
  1723         10  MSACM10A PIC  X(0001).
  1724     05  MSACM10I PIC  X(0010).
  1725*    -------------------------------
  1726     05  TYPE10L PIC S9(0004) COMP.
  1727     05  TYPE10F PIC  X(0001).
  1728     05  FILLER REDEFINES TYPE10F.
  1729         10  TYPE10A PIC  X(0001).
  1730     05  TYPE10I PIC  X(0001).
  1731*    -------------------------------
  1732     05  AMT10L PIC S9(0004) COMP.
  1733     05  AMT10F PIC  X(0001).
  1734     05  FILLER REDEFINES AMT10F.
  1735         10  AMT10A PIC  X(0001).
  1736     05  AMT10I PIC  X(0011).
  1737*    -------------------------------
  1738     05  VOID10L PIC S9(0004) COMP.
  1739     05  VOID10F PIC  X(0001).
  1740     05  FILLER REDEFINES VOID10F.
  1741         10  VOID10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL633.cbl
  1742     05  VOID10I PIC  X(0001).
  1743*    -------------------------------
  1744     05  MDT10L PIC S9(0004) COMP.
  1745     05  MDT10F PIC  X(0001).
  1746     05  FILLER REDEFINES MDT10F.
  1747         10  MDT10A PIC  X(0001).
  1748     05  MDT10I PIC  X(0006).
  1749*    -------------------------------
  1750     05  BDT10L PIC S9(0004) COMP.
  1751     05  BDT10F PIC  X(0001).
  1752     05  FILLER REDEFINES BDT10F.
  1753         10  BDT10A PIC  X(0001).
  1754     05  BDT10I PIC  X(0006).
  1755*    -------------------------------
  1756     05  SDT10L PIC S9(0004) COMP.
  1757     05  SDT10F PIC  X(0001).
  1758     05  FILLER REDEFINES SDT10F.
  1759         10  SDT10A PIC  X(0001).
  1760     05  SDT10I PIC  X(0006).
  1761*    -------------------------------
  1762     05  MSAAC11L PIC S9(0004) COMP.
  1763     05  MSAAC11F PIC  X(0001).
  1764     05  FILLER REDEFINES MSAAC11F.
  1765         10  MSAAC11A PIC  X(0001).
  1766     05  MSAAC11I PIC  X(0010).
  1767*    -------------------------------
  1768     05  MSAST11L PIC S9(0004) COMP.
  1769     05  MSAST11F PIC  X(0001).
  1770     05  FILLER REDEFINES MSAST11F.
  1771         10  MSAST11A PIC  X(0001).
  1772     05  MSAST11I PIC  X(0002).
  1773*    -------------------------------
  1774     05  MSACN11L PIC S9(0004) COMP.
  1775     05  MSACN11F PIC  X(0001).
  1776     05  FILLER REDEFINES MSACN11F.
  1777         10  MSACN11A PIC  X(0001).
  1778     05  MSACN11I PIC  X(0001).
  1779*    -------------------------------
  1780     05  MSACM11L PIC S9(0004) COMP.
  1781     05  MSACM11F PIC  X(0001).
  1782     05  FILLER REDEFINES MSACM11F.
  1783         10  MSACM11A PIC  X(0001).
  1784     05  MSACM11I PIC  X(0010).
  1785*    -------------------------------
  1786     05  TYPE11L PIC S9(0004) COMP.
  1787     05  TYPE11F PIC  X(0001).
  1788     05  FILLER REDEFINES TYPE11F.
  1789         10  TYPE11A PIC  X(0001).
  1790     05  TYPE11I PIC  X(0001).
  1791*    -------------------------------
  1792     05  AMT11L PIC S9(0004) COMP.
  1793     05  AMT11F PIC  X(0001).
  1794     05  FILLER REDEFINES AMT11F.
  1795         10  AMT11A PIC  X(0001).
  1796     05  AMT11I PIC  X(0011).
  1797*    -------------------------------
  1798     05  VOID11L PIC S9(0004) COMP.
  1799     05  VOID11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL633.cbl
  1800     05  FILLER REDEFINES VOID11F.
  1801         10  VOID11A PIC  X(0001).
  1802     05  VOID11I PIC  X(0001).
  1803*    -------------------------------
  1804     05  MDT11L PIC S9(0004) COMP.
  1805     05  MDT11F PIC  X(0001).
  1806     05  FILLER REDEFINES MDT11F.
  1807         10  MDT11A PIC  X(0001).
  1808     05  MDT11I PIC  X(0006).
  1809*    -------------------------------
  1810     05  BDT11L PIC S9(0004) COMP.
  1811     05  BDT11F PIC  X(0001).
  1812     05  FILLER REDEFINES BDT11F.
  1813         10  BDT11A PIC  X(0001).
  1814     05  BDT11I PIC  X(0006).
  1815*    -------------------------------
  1816     05  SDT11L PIC S9(0004) COMP.
  1817     05  SDT11F PIC  X(0001).
  1818     05  FILLER REDEFINES SDT11F.
  1819         10  SDT11A PIC  X(0001).
  1820     05  SDT11I PIC  X(0006).
  1821*    -------------------------------
  1822     05  MSAAC12L PIC S9(0004) COMP.
  1823     05  MSAAC12F PIC  X(0001).
  1824     05  FILLER REDEFINES MSAAC12F.
  1825         10  MSAAC12A PIC  X(0001).
  1826     05  MSAAC12I PIC  X(0010).
  1827*    -------------------------------
  1828     05  MSAST12L PIC S9(0004) COMP.
  1829     05  MSAST12F PIC  X(0001).
  1830     05  FILLER REDEFINES MSAST12F.
  1831         10  MSAST12A PIC  X(0001).
  1832     05  MSAST12I PIC  X(0002).
  1833*    -------------------------------
  1834     05  MSACN12L PIC S9(0004) COMP.
  1835     05  MSACN12F PIC  X(0001).
  1836     05  FILLER REDEFINES MSACN12F.
  1837         10  MSACN12A PIC  X(0001).
  1838     05  MSACN12I PIC  X(0001).
  1839*    -------------------------------
  1840     05  MSACM12L PIC S9(0004) COMP.
  1841     05  MSACM12F PIC  X(0001).
  1842     05  FILLER REDEFINES MSACM12F.
  1843         10  MSACM12A PIC  X(0001).
  1844     05  MSACM12I PIC  X(0010).
  1845*    -------------------------------
  1846     05  TYPE12L PIC S9(0004) COMP.
  1847     05  TYPE12F PIC  X(0001).
  1848     05  FILLER REDEFINES TYPE12F.
  1849         10  TYPE12A PIC  X(0001).
  1850     05  TYPE12I PIC  X(0001).
  1851*    -------------------------------
  1852     05  AMT12L PIC S9(0004) COMP.
  1853     05  AMT12F PIC  X(0001).
  1854     05  FILLER REDEFINES AMT12F.
  1855         10  AMT12A PIC  X(0001).
  1856     05  AMT12I PIC  X(0011).
  1857*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL633.cbl
  1858     05  VOID12L PIC S9(0004) COMP.
  1859     05  VOID12F PIC  X(0001).
  1860     05  FILLER REDEFINES VOID12F.
  1861         10  VOID12A PIC  X(0001).
  1862     05  VOID12I PIC  X(0001).
  1863*    -------------------------------
  1864     05  MDT12L PIC S9(0004) COMP.
  1865     05  MDT12F PIC  X(0001).
  1866     05  FILLER REDEFINES MDT12F.
  1867         10  MDT12A PIC  X(0001).
  1868     05  MDT12I PIC  X(0006).
  1869*    -------------------------------
  1870     05  BDT12L PIC S9(0004) COMP.
  1871     05  BDT12F PIC  X(0001).
  1872     05  FILLER REDEFINES BDT12F.
  1873         10  BDT12A PIC  X(0001).
  1874     05  BDT12I PIC  X(0006).
  1875*    -------------------------------
  1876     05  SDT12L PIC S9(0004) COMP.
  1877     05  SDT12F PIC  X(0001).
  1878     05  FILLER REDEFINES SDT12F.
  1879         10  SDT12A PIC  X(0001).
  1880     05  SDT12I PIC  X(0006).
  1881*    -------------------------------
  1882     05  MSAAC13L PIC S9(0004) COMP.
  1883     05  MSAAC13F PIC  X(0001).
  1884     05  FILLER REDEFINES MSAAC13F.
  1885         10  MSAAC13A PIC  X(0001).
  1886     05  MSAAC13I PIC  X(0010).
  1887*    -------------------------------
  1888     05  MSAST13L PIC S9(0004) COMP.
  1889     05  MSAST13F PIC  X(0001).
  1890     05  FILLER REDEFINES MSAST13F.
  1891         10  MSAST13A PIC  X(0001).
  1892     05  MSAST13I PIC  X(0002).
  1893*    -------------------------------
  1894     05  MSACN13L PIC S9(0004) COMP.
  1895     05  MSACN13F PIC  X(0001).
  1896     05  FILLER REDEFINES MSACN13F.
  1897         10  MSACN13A PIC  X(0001).
  1898     05  MSACN13I PIC  X(0001).
  1899*    -------------------------------
  1900     05  MSACM13L PIC S9(0004) COMP.
  1901     05  MSACM13F PIC  X(0001).
  1902     05  FILLER REDEFINES MSACM13F.
  1903         10  MSACM13A PIC  X(0001).
  1904     05  MSACM13I PIC  X(0010).
  1905*    -------------------------------
  1906     05  TYPE13L PIC S9(0004) COMP.
  1907     05  TYPE13F PIC  X(0001).
  1908     05  FILLER REDEFINES TYPE13F.
  1909         10  TYPE13A PIC  X(0001).
  1910     05  TYPE13I PIC  X(0001).
  1911*    -------------------------------
  1912     05  AMT13L PIC S9(0004) COMP.
  1913     05  AMT13F PIC  X(0001).
  1914     05  FILLER REDEFINES AMT13F.
  1915         10  AMT13A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL633.cbl
  1916     05  AMT13I PIC  X(0011).
  1917*    -------------------------------
  1918     05  VOID13L PIC S9(0004) COMP.
  1919     05  VOID13F PIC  X(0001).
  1920     05  FILLER REDEFINES VOID13F.
  1921         10  VOID13A PIC  X(0001).
  1922     05  VOID13I PIC  X(0001).
  1923*    -------------------------------
  1924     05  MDT13L PIC S9(0004) COMP.
  1925     05  MDT13F PIC  X(0001).
  1926     05  FILLER REDEFINES MDT13F.
  1927         10  MDT13A PIC  X(0001).
  1928     05  MDT13I PIC  X(0006).
  1929*    -------------------------------
  1930     05  BDT13L PIC S9(0004) COMP.
  1931     05  BDT13F PIC  X(0001).
  1932     05  FILLER REDEFINES BDT13F.
  1933         10  BDT13A PIC  X(0001).
  1934     05  BDT13I PIC  X(0006).
  1935*    -------------------------------
  1936     05  SDT13L PIC S9(0004) COMP.
  1937     05  SDT13F PIC  X(0001).
  1938     05  FILLER REDEFINES SDT13F.
  1939         10  SDT13A PIC  X(0001).
  1940     05  SDT13I PIC  X(0006).
  1941*    -------------------------------
  1942     05  ERRMSG1L PIC S9(0004) COMP.
  1943     05  ERRMSG1F PIC  X(0001).
  1944     05  FILLER REDEFINES ERRMSG1F.
  1945         10  ERRMSG1A PIC  X(0001).
  1946     05  ERRMSG1I PIC  X(0079).
  1947*    -------------------------------
  1948     05  ERRMSG2L PIC S9(0004) COMP.
  1949     05  ERRMSG2F PIC  X(0001).
  1950     05  FILLER REDEFINES ERRMSG2F.
  1951         10  ERRMSG2A PIC  X(0001).
  1952     05  ERRMSG2I PIC  X(0079).
  1953*    -------------------------------
  1954     05  PFENTERL PIC S9(0004) COMP.
  1955     05  PFENTERF PIC  X(0001).
  1956     05  FILLER REDEFINES PFENTERF.
  1957         10  PFENTERA PIC  X(0001).
  1958     05  PFENTERI PIC  9(2).
  1959 01  EL633AO REDEFINES EL633AI.
  1960     05  FILLER            PIC  X(0012).
  1961*    -------------------------------
  1962     05  FILLER            PIC  X(0003).
  1963     05  DATEO PIC  X(0008).
  1964*    -------------------------------
  1965     05  FILLER            PIC  X(0003).
  1966     05  TIMEO PIC  99.99.
  1967*    -------------------------------
  1968     05  FILLER            PIC  X(0003).
  1969     05  CMPNYIDO PIC  X(0003).
  1970*    -------------------------------
  1971     05  FILLER            PIC  X(0003).
  1972     05  USERIDO PIC  X(0004).
  1973*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL633.cbl
  1974     05  FILLER            PIC  X(0003).
  1975     05  MAINTO PIC  X(0001).
  1976*    -------------------------------
  1977     05  FILLER            PIC  X(0003).
  1978     05  CARRIERO PIC  X(0001).
  1979*    -------------------------------
  1980     05  FILLER            PIC  X(0003).
  1981     05  GROUPO PIC  X(0006).
  1982*    -------------------------------
  1983     05  FILLER            PIC  X(0003).
  1984     05  FINRESPO PIC  X(0010).
  1985*    -------------------------------
  1986     05  FILLER            PIC  X(0003).
  1987     05  ACCTO PIC  X(0010).
  1988*    -------------------------------
  1989     05  FILLER            PIC  X(0003).
  1990     05  MSAAC1O PIC  X(0010).
  1991*    -------------------------------
  1992     05  FILLER            PIC  X(0003).
  1993     05  MSAST1O PIC  X(0002).
  1994*    -------------------------------
  1995     05  FILLER            PIC  X(0003).
  1996     05  MSACN1O PIC  X(0001).
  1997*    -------------------------------
  1998     05  FILLER            PIC  X(0003).
  1999     05  MSACM1O PIC  X(0010).
  2000*    -------------------------------
  2001     05  FILLER            PIC  X(0003).
  2002     05  TYPE1O PIC  X(0001).
  2003*    -------------------------------
  2004     05  FILLER            PIC  X(0003).
  2005     05  AMT1O PIC  X(0011).
  2006*    -------------------------------
  2007     05  FILLER            PIC  X(0003).
  2008     05  VOID1O PIC  X(0001).
  2009*    -------------------------------
  2010     05  FILLER            PIC  X(0003).
  2011     05  MDT1O PIC  X(0006).
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  BDT1O PIC  X(0006).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  SDT1O PIC  X(0006).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  MSAAC2O PIC  X(0010).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  MSAST2O PIC  X(0002).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  MSACN2O PIC  X(0001).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  MSACM2O PIC  X(0010).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL633.cbl
  2032     05  TYPE2O PIC  X(0001).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  AMT2O PIC  X(0011).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  VOID2O PIC  X(0001).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  MDT2O PIC  X(0006).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  BDT2O PIC  X(0006).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  SDT2O PIC  X(0006).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  MSAAC3O PIC  X(0010).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  MSAST3O PIC  X(0002).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  MSACN3O PIC  X(0001).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  MSACM3O PIC  X(0010).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  TYPE3O PIC  X(0001).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  AMT3O PIC  X(0011).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  VOID3O PIC  X(0001).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  MDT3O PIC  X(0006).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  BDT3O PIC  X(0006).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  SDT3O PIC  X(0006).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  MSAAC4O PIC  X(0010).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  MSAST4O PIC  X(0002).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  MSACN4O PIC  X(0001).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  MSACM4O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL633.cbl
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  TYPE4O PIC  X(0001).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  AMT4O PIC  X(0011).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  VOID4O PIC  X(0001).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  MDT4O PIC  X(0006).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  BDT4O PIC  X(0006).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  SDT4O PIC  X(0006).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  MSAAC5O PIC  X(0010).
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  MSAST5O PIC  X(0002).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  MSACN5O PIC  X(0001).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  MSACM5O PIC  X(0010).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  TYPE5O PIC  X(0001).
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  AMT5O PIC  X(0011).
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  VOID5O PIC  X(0001).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  MDT5O PIC  X(0006).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  BDT5O PIC  X(0006).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  SDT5O PIC  X(0006).
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  MSAAC6O PIC  X(0010).
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  MSAST6O PIC  X(0002).
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  MSACN6O PIC  X(0001).
  2147*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL633.cbl
  2148     05  FILLER            PIC  X(0003).
  2149     05  MSACM6O PIC  X(0010).
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  TYPE6O PIC  X(0001).
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  AMT6O PIC  X(0011).
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  VOID6O PIC  X(0001).
  2159*    -------------------------------
  2160     05  FILLER            PIC  X(0003).
  2161     05  MDT6O PIC  X(0006).
  2162*    -------------------------------
  2163     05  FILLER            PIC  X(0003).
  2164     05  BDT6O PIC  X(0006).
  2165*    -------------------------------
  2166     05  FILLER            PIC  X(0003).
  2167     05  SDT6O PIC  X(0006).
  2168*    -------------------------------
  2169     05  FILLER            PIC  X(0003).
  2170     05  MSAAC7O PIC  X(0010).
  2171*    -------------------------------
  2172     05  FILLER            PIC  X(0003).
  2173     05  MSAST7O PIC  X(0002).
  2174*    -------------------------------
  2175     05  FILLER            PIC  X(0003).
  2176     05  MSACN7O PIC  X(0001).
  2177*    -------------------------------
  2178     05  FILLER            PIC  X(0003).
  2179     05  MSACM7O PIC  X(0010).
  2180*    -------------------------------
  2181     05  FILLER            PIC  X(0003).
  2182     05  TYPE7O PIC  X(0001).
  2183*    -------------------------------
  2184     05  FILLER            PIC  X(0003).
  2185     05  AMT7O PIC  X(0011).
  2186*    -------------------------------
  2187     05  FILLER            PIC  X(0003).
  2188     05  VOID7O PIC  X(0001).
  2189*    -------------------------------
  2190     05  FILLER            PIC  X(0003).
  2191     05  MDT7O PIC  X(0006).
  2192*    -------------------------------
  2193     05  FILLER            PIC  X(0003).
  2194     05  BDT7O PIC  X(0006).
  2195*    -------------------------------
  2196     05  FILLER            PIC  X(0003).
  2197     05  SDT7O PIC  X(0006).
  2198*    -------------------------------
  2199     05  FILLER            PIC  X(0003).
  2200     05  MSAAC8O PIC  X(0010).
  2201*    -------------------------------
  2202     05  FILLER            PIC  X(0003).
  2203     05  MSAST8O PIC  X(0002).
  2204*    -------------------------------
  2205     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL633.cbl
  2206     05  MSACN8O PIC  X(0001).
  2207*    -------------------------------
  2208     05  FILLER            PIC  X(0003).
  2209     05  MSACM8O PIC  X(0010).
  2210*    -------------------------------
  2211     05  FILLER            PIC  X(0003).
  2212     05  TYPE8O PIC  X(0001).
  2213*    -------------------------------
  2214     05  FILLER            PIC  X(0003).
  2215     05  AMT8O PIC  X(0011).
  2216*    -------------------------------
  2217     05  FILLER            PIC  X(0003).
  2218     05  VOID8O PIC  X(0001).
  2219*    -------------------------------
  2220     05  FILLER            PIC  X(0003).
  2221     05  MDT8O PIC  X(0006).
  2222*    -------------------------------
  2223     05  FILLER            PIC  X(0003).
  2224     05  BDT8O PIC  X(0006).
  2225*    -------------------------------
  2226     05  FILLER            PIC  X(0003).
  2227     05  SDT8O PIC  X(0006).
  2228*    -------------------------------
  2229     05  FILLER            PIC  X(0003).
  2230     05  MSAAC9O PIC  X(0010).
  2231*    -------------------------------
  2232     05  FILLER            PIC  X(0003).
  2233     05  MSAST9O PIC  X(0002).
  2234*    -------------------------------
  2235     05  FILLER            PIC  X(0003).
  2236     05  MSACN9O PIC  X(0001).
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
  2239     05  MSACM9O PIC  X(0010).
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
  2242     05  TYPE9O PIC  X(0001).
  2243*    -------------------------------
  2244     05  FILLER            PIC  X(0003).
  2245     05  AMT9O PIC  X(0011).
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  VOID9O PIC  X(0001).
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  MDT9O PIC  X(0006).
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  BDT9O PIC  X(0006).
  2255*    -------------------------------
  2256     05  FILLER            PIC  X(0003).
  2257     05  SDT9O PIC  X(0006).
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  MSAAC10O PIC  X(0010).
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  MSAST10O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL633.cbl
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  MSACN10O PIC  X(0001).
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  MSACM10O PIC  X(0010).
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  TYPE10O PIC  X(0001).
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  AMT10O PIC  X(0011).
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  VOID10O PIC  X(0001).
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  MDT10O PIC  X(0006).
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  BDT10O PIC  X(0006).
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  SDT10O PIC  X(0006).
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  MSAAC11O PIC  X(0010).
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  MSAST11O PIC  X(0002).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  MSACN11O PIC  X(0001).
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  MSACM11O PIC  X(0010).
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  TYPE11O PIC  X(0001).
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  AMT11O PIC  X(0011).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  VOID11O PIC  X(0001).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  MDT11O PIC  X(0006).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  BDT11O PIC  X(0006).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  SDT11O PIC  X(0006).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  MSAAC12O PIC  X(0010).
  2321*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL633.cbl
  2322     05  FILLER            PIC  X(0003).
  2323     05  MSAST12O PIC  X(0002).
  2324*    -------------------------------
  2325     05  FILLER            PIC  X(0003).
  2326     05  MSACN12O PIC  X(0001).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  MSACM12O PIC  X(0010).
  2330*    -------------------------------
  2331     05  FILLER            PIC  X(0003).
  2332     05  TYPE12O PIC  X(0001).
  2333*    -------------------------------
  2334     05  FILLER            PIC  X(0003).
  2335     05  AMT12O PIC  X(0011).
  2336*    -------------------------------
  2337     05  FILLER            PIC  X(0003).
  2338     05  VOID12O PIC  X(0001).
  2339*    -------------------------------
  2340     05  FILLER            PIC  X(0003).
  2341     05  MDT12O PIC  X(0006).
  2342*    -------------------------------
  2343     05  FILLER            PIC  X(0003).
  2344     05  BDT12O PIC  X(0006).
  2345*    -------------------------------
  2346     05  FILLER            PIC  X(0003).
  2347     05  SDT12O PIC  X(0006).
  2348*    -------------------------------
  2349     05  FILLER            PIC  X(0003).
  2350     05  MSAAC13O PIC  X(0010).
  2351*    -------------------------------
  2352     05  FILLER            PIC  X(0003).
  2353     05  MSAST13O PIC  X(0002).
  2354*    -------------------------------
  2355     05  FILLER            PIC  X(0003).
  2356     05  MSACN13O PIC  X(0001).
  2357*    -------------------------------
  2358     05  FILLER            PIC  X(0003).
  2359     05  MSACM13O PIC  X(0010).
  2360*    -------------------------------
  2361     05  FILLER            PIC  X(0003).
  2362     05  TYPE13O PIC  X(0001).
  2363*    -------------------------------
  2364     05  FILLER            PIC  X(0003).
  2365     05  AMT13O PIC  X(0011).
  2366*    -------------------------------
  2367     05  FILLER            PIC  X(0003).
  2368     05  VOID13O PIC  X(0001).
  2369*    -------------------------------
  2370     05  FILLER            PIC  X(0003).
  2371     05  MDT13O PIC  X(0006).
  2372*    -------------------------------
  2373     05  FILLER            PIC  X(0003).
  2374     05  BDT13O PIC  X(0006).
  2375*    -------------------------------
  2376     05  FILLER            PIC  X(0003).
  2377     05  SDT13O PIC  X(0006).
  2378*    -------------------------------
  2379     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL633.cbl
  2380     05  ERRMSG1O PIC  X(0079).
  2381*    -------------------------------
  2382     05  FILLER            PIC  X(0003).
  2383     05  ERRMSG2O PIC  X(0079).
  2384*    -------------------------------
  2385     05  FILLER            PIC  X(0003).
  2386     05  PFENTERO PIC  X(0002).
  2387*    -------------------------------
  2388
  2389 01  MAP-EL633A  REDEFINES  EL633AI.
  2390     12  FILLER                  PIC  X(87).
  2391     12  DATA-AREA       OCCURS 13 TIMES
  2392                             INDEXED BY PINDX.
  2393         16  GL-ACCT-LEN         PIC S9(4)              COMP.
  2394         16  GL-ACCT-ATTRB       PIC  X.
  2395         16  GL-ACCT             PIC  X(10).
  2396         16  WSL-COMM  REDEFINES GL-ACCT.
  2397             20  WSL-COMM-DTE.
  2398                 24  WSL-MO      PIC  X(2).
  2399                 24  WSL-DA      PIC  X(2).
  2400                 24  WSL-YR      PIC  X(2).
  2401             20  WSL-COMM-REST   PIC  X(4).
  2402         16  GL-STATE-LEN        PIC S9(4)              COMP.
  2403         16  GL-STATE-ATTRB      PIC  X.
  2404         16  GL-STATE            PIC  X(02).
  2405         16  GL-CANC-LEN         PIC S9(4)              COMP.
  2406         16  GL-CANC-ATTRB       PIC  X.
  2407         16  GL-CANC             PIC  X.
  2408         16  GL-COMM-LEN         PIC S9(4)              COMP.
  2409         16  GL-COMM-ATTRB       PIC  X.
  2410         16  GL-COMM             PIC  X(10).
  2411         16  RTYPE-LEN           PIC S9(4)              COMP.
  2412         16  RTYPE-ATTRB         PIC  X.
  2413         16  RTYPE               PIC  X.
  2414         16  AMT-LEN             PIC S9(4)              COMP.
  2415         16  AMT-ATTRB           PIC  X.
  2416         16  AMT                 PIC S9(9)V9(2).
  2417         16  AMTO  REDEFINES
  2418             AMT                 PIC Z(7).9(2)-.
  2419         16  VOID-SW-LEN         PIC S9(4)              COMP.
  2420         16  VOID-SW-ATTRB       PIC  X.
  2421         16  VOID-SW             PIC  X.
  2422         16  MDTE-LEN            PIC S9(4)              COMP.
  2423         16  MDTE-ATTRB          PIC  X.
  2424         16  MDTE                PIC  X(6).
  2425         16  BDTE-LEN            PIC S9(4)              COMP.
  2426         16  BDTE-ATTRB          PIC  X.
  2427         16  BDTE                PIC  X(6).
  2428         16  SDTE-LEN            PIC S9(4)              COMP.
  2429         16  SDTE-ATTRB          PIC  X.
  2430         16  SDTE                PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL633.cbl
  2432****************************************************************
  2433*
  2434* Copyright (c) 2007 by Clerity Solutions, Inc.
  2435* All rights reserved.
  2436*
  2437****************************************************************
  2438 01  DFHEIV.
  2439   02  DFHEIV0               PIC X(35).
  2440   02  DFHEIV1               PIC X(08).
  2441   02  DFHEIV2               PIC X(08).
  2442   02  DFHEIV3               PIC X(08).
  2443   02  DFHEIV4               PIC X(06).
  2444   02  DFHEIV5               PIC X(04).
  2445   02  DFHEIV6               PIC X(04).
  2446   02  DFHEIV7               PIC X(02).
  2447   02  DFHEIV8               PIC X(02).
  2448   02  DFHEIV9               PIC X(01).
  2449   02  DFHEIV10              PIC S9(7) COMP-3.
  2450   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2451   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2452   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2453   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2454   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2455   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2456   02  DFHEIV17              PIC X(04).
  2457   02  DFHEIV18              PIC X(04).
  2458   02  DFHEIV19              PIC X(04).
  2459   02  DFHEIV20              USAGE IS POINTER.
  2460   02  DFHEIV21              USAGE IS POINTER.
  2461   02  DFHEIV22              USAGE IS POINTER.
  2462   02  DFHEIV23              USAGE IS POINTER.
  2463   02  DFHEIV24              USAGE IS POINTER.
  2464   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2465   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2466   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2467   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2468   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2469   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2470   02  FILLER                PIC X(02).
  2471   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2472   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2473   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2474   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2475   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2476 LINKAGE  SECTION.
  2477*****************************************************************
  2478*                                                               *
  2479* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2480* All rights reserved.                                          *
  2481*                                                               *
  2482*****************************************************************
  2483 01  dfheiblk.
  2484     02  eibtime          pic s9(7) comp-3.
  2485     02  eibdate          pic s9(7) comp-3.
  2486     02  eibtrnid         pic x(4).
  2487     02  eibtaskn         pic s9(7) comp-3.
  2488     02  eibtrmid         pic x(4).
  2489     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL633.cbl
  2490     02  eibcposn         pic s9(4) comp.
  2491     02  eibcalen         pic s9(4) comp.
  2492     02  eibaid           pic x(1).
  2493     02  eibfiller1       pic x(1).
  2494     02  eibfn            pic x(2).
  2495     02  eibfiller2       pic x(2).
  2496     02  eibrcode         pic x(6).
  2497     02  eibfiller3       pic x(2).
  2498     02  eibds            pic x(8).
  2499     02  eibreqid         pic x(8).
  2500     02  eibrsrce         pic x(8).
  2501     02  eibsync          pic x(1).
  2502     02  eibfree          pic x(1).
  2503     02  eibrecv          pic x(1).
  2504     02  eibsend          pic x(1).
  2505     02  eibatt           pic x(1).
  2506     02  eibeoc           pic x(1).
  2507     02  eibfmh           pic x(1).
  2508     02  eibcompl         pic x(1).
  2509     02  eibsig           pic x(1).
  2510     02  eibconf          pic x(1).
  2511     02  eiberr           pic x(1).
  2512     02  eibrldbk         pic x(1).
  2513     02  eiberrcd         pic x(4).
  2514     02  eibsynrb         pic x(1).
  2515     02  eibnodat         pic x(1).
  2516     02  eibfiller5       pic x(2).
  2517     02  eibresp          pic 9(09) comp.
  2518     02  eibresp2         pic 9(09) comp.
  2519     02  dfheigdj         pic s9(4) comp.
  2520     02  dfheigdk         pic s9(4) comp.
  2521 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL633.cbl
  2522/
  2523*                            COPY ERCCHKQ.
  2524******************************************************************
  2525*                                                                *
  2526*                                                                *
  2527*                            ERCCHKQ                             *
  2528*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2529*                            VMOD=2.005                          *
  2530*                                                                *
  2531*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  2532*                                                                *
  2533*   FILE TYPE = VSAM,KSDS                                        *
  2534*   RECORD SIZE = 100  RECFORM = FIXED                           *
  2535*                                                                *
  2536*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  2537*       ALTERNATE PATH  = NONE                                   *
  2538*                                                                *
  2539*   LOG = YES                                                    *
  2540*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2541******************************************************************
  2542 01  CHECK-QUE.
  2543     12  CQ-RECORD-ID                PIC XX.
  2544         88  VALID-CQ-ID                     VALUE 'CQ'.
  2545
  2546     12  CQ-CONTROL-PRIMARY.
  2547         16  CQ-COMPANY-CD           PIC X.
  2548         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  2549         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  2550
  2551     12  CQ-ENTRY-TYPE               PIC X.
  2552             88  CHECK-ON-QUE           VALUE 'Q'.
  2553             88  ALIGNMENT-CHECK        VALUE 'A'.
  2554             88  MANUAL-CHECK           VALUE 'M'.
  2555             88  SPOILED-CHECK          VALUE 'S'.
  2556             88  VOIDED-CHECK           VALUE 'V'.
  2557             88  PAYMENT-ABORTED        VALUE 'X'.
  2558
  2559     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  2560
  2561     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  2562         CQ-CREDIT-MASTER-CNTL.
  2563         16  CQ-PYAJ-CARRIER         PIC X.
  2564         16  CQ-PYAJ-GROUPING        PIC X(6).
  2565         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  2566         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  2567         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  2568         16  CQ-PYAJ-REC-TYPE        PIC X.
  2569         16  FILLER                  PIC X(18).
  2570
  2571     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  2572         CQ-CREDIT-MASTER-CNTL.
  2573         16  CQ-CHEK-CARRIER         PIC X.
  2574         16  CQ-CHEK-GROUPING        PIC X(6).
  2575         16  CQ-CHEK-STATE           PIC XX.
  2576         16  CQ-CHEK-ACCOUNT         PIC X(10).
  2577         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  2578         16  CQ-CHEK-CERT-NO.
  2579             20  CQ-CHEK-CERT-PRIME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL633.cbl
  2580             20  CQ-CHEK-CERT-SFX    PIC X.
  2581         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  2582         16  CQ-CHEK-FIN-RESP        PIC X(10).
  2583         16  FILLER                  PIC X(06).
  2584
  2585     12  CQ-CHECK-NUMBER             PIC X(7).
  2586     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  2587     12  CQ-PAYMENT-TYPE             PIC X.
  2588             88  CQ-BILLING-CREDIT         VALUE '1'.
  2589             88  CQ-REFUND-PMT             VALUE '2'.
  2590             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  2591     12  CQ-VOID-INDICATOR           PIC X.
  2592             88  CHECK-IS-VOID             VALUE 'V'.
  2593     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  2594     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  2595     12  CQ-CHECK-BY-USER            PIC X(4).
  2596     12  CQ-PRE-NUMBERING-SW         PIC X.
  2597       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  2598       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  2599
  2600     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  2601     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  2602     12  CQ-ACCOUNT-AGENT            PIC X(10).
  2603     12  CQ-CHECK-VOIDED-DT          PIC XX.
  2604
  2605     12  CQ-LETTERS-IND              PIC X.
  2606         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  2607
  2608******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL633.cbl
  2609/
  2610*                            COPY ERCPYAJ.
  2611******************************************************************
  2612*                                                                *
  2613*                            ERCPYAJ                             *
  2614*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2615*                            VMOD=2.015                          *
  2616*                                                                *
  2617*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  2618*                                                                *
  2619*                                                                *
  2620*   FILE TYPE = VSAM,KSDS                                        *
  2621*   RECORD SIZE = 200  RECFORM = FIXED                           *
  2622*                                                                *
  2623*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  2624*       ALTERNATE PATHS = NONE                                   *
  2625*                                                                *
  2626*   LOG = YES                                                    *
  2627*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2628******************************************************************
  2629******************************************************************
  2630*                   C H A N G E   L O G
  2631*
  2632* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2633*-----------------------------------------------------------------
  2634*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2635* EFFECTIVE    NUMBER
  2636*-----------------------------------------------------------------
  2637* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  2638* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  2639******************************************************************
  2640
  2641 01  PENDING-PAY-ADJ.
  2642     12  PY-RECORD-ID                     PIC XX.
  2643         88  VALID-PY-ID                        VALUE 'PY'.
  2644
  2645     12  PY-CONTROL-PRIMARY.
  2646         16  PY-COMPANY-CD                PIC X.
  2647         16  PY-CARRIER                   PIC X.
  2648         16  PY-GROUPING                  PIC X(6).
  2649         16  PY-FIN-RESP                  PIC X(10).
  2650         16  PY-ACCOUNT                   PIC X(10).
  2651         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  2652                                          PIC X(10).
  2653         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  2654         16  PY-RECORD-TYPE               PIC X.
  2655             88  PY-REMIT-RECEIVED            VALUE 'R'.
  2656             88  PY-DEPOSIT                   VALUE 'D'.
  2657             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  2658             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  2659             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  2660             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  2661             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  2662             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  2663             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  2664             88  PY-FICA-ENTRY                VALUE 'F'.
  2665             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  2666             88  PY-POLICY-FEE                VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL633.cbl
  2667             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  2668
  2669     12  PY-PYMT-TYPE                     PIC X.
  2670             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  2671             88  PY-REINS-PYMT                VALUE 'R'.
  2672             88  PY-EXP-PYMT                  VALUE 'E'.
  2673
  2674     12  PY-BIL-INV                       PIC X(6).
  2675     12  PY-REF-NO                        PIC X(12).
  2676
  2677     12  PY-LAST-MAINT-DT                 PIC XX.
  2678     12  PY-LAST-MAINT-BY                 PIC X(4).
  2679     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2680
  2681     12  PY-PYADJ-RECORD.
  2682         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  2683         16  PY-ENTRY-COMMENT             PIC X(30).
  2684         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  2685             20  PY-GL-ACCOUNT            PIC X(10).
  2686             20  PY-GL-STATE              PIC X(02).
  2687             20  PY-GL-CANC-SW            PIC X(01).
  2688                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  2689                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  2690             20  PY-GL-COMMENT            PIC X(10).
  2691             20  FILLER      REDEFINES PY-GL-COMMENT.
  2692                 24  PY-GL-CHECK-NO       PIC 9(06).
  2693                 24  FILLER               PIC X(04).
  2694             20  FILLER                   PIC X(07).
  2695         16  PY-SAVE-ACCOUNT              PIC X(10).
  2696         16  PY-SAVE-TYPE                 PIC X(01).
  2697
  2698         16  PY-LETTERS.
  2699             20  PY-LETTER OCCURS 3 TIMES
  2700                           INDEXED BY PY-LET-NDX
  2701                                          PIC X(04).
  2702
  2703         16  PY-ERCOMP-TYPE               PIC X.
  2704             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2705             88  PY-GA-TYPE                   VALUE 'G'.
  2706             88  PY-BANK-TYPE                 VALUE 'B'.
  2707         16  FILLER                       PIC X(05).
  2708
  2709     12  PY-RECORD-STATUS.
  2710         16  PY-CREDIT-SELECT-DT          PIC XX.
  2711         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2712         16  PY-BILLED-DATE               PIC XX.
  2713         16  PY-REPORTED-DT               PIC XX.
  2714         16  PY-PMT-APPLIED               PIC X.
  2715             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2716             88  PY-GA-PMT                    VALUE 'G'.
  2717             88  PY-OVWRITE-PMT               VALUE 'O'.
  2718             88  PY-NON-AR-PMT                VALUE 'N'.
  2719         16  FILLER                       PIC X(5).
  2720         16  PY-INPUT-DT                  PIC XX.
  2721         16  PY-CHECK-NUMBER              PIC X(6).
  2722         16  PY-VOID-SW                   PIC X.
  2723             88  PY-CHECK-VOIDED              VALUE 'V'.
  2724         16  PY-CHECK-ORIGIN-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL633.cbl
  2725             88  PY-BILLING-CHECK             VALUE 'B'.
  2726             88  PY-REFUND-CHECK              VALUE 'R'.
  2727             88  PY-GA-CHECK                  VALUE 'G'.
  2728             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2729             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2730         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2731         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2732         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2733         16  PY-BILL-FLAG                 PIC X.
  2734             88  PY-BILLED                    VALUE 'B'.
  2735         16  PY-AR-FLAG                   PIC X.
  2736             88  PY-AR-CYCLE                  VALUE 'C'.
  2737             88  PY-AR-MONTH-END              VALUE 'M'.
  2738         16  PY-AR-DATE                   PIC XX.
  2739
  2740     12  PY-GL-CODES.
  2741         16  PY-GL-DB                     PIC X(14).
  2742         16  PY-GL-CR                     PIC X(14).
  2743         16  PY-GL-FLAG                   PIC X.
  2744         16  PY-GL-DATE                   PIC XX.
  2745
  2746     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2747     12  FILLER                           PIC X(3).
  2748******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL633.cbl
  2749/
  2750*                            COPY ERCCOMP.
  2751******************************************************************
  2752*                                                                *
  2753*                                                                *
  2754*                            ERCCOMP                             *
  2755*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2756*                            VMOD=2.019                          *
  2757*                                                                *
  2758*   ONLINE CREDIT SYSTEM                                         *
  2759*                                                                *
  2760*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2761*                                                                *
  2762*   FILE TYPE = VSAM,KSDS                                        *
  2763*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2764*                                                                *
  2765*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2766*       ALTERNATE PATH = NONE                                    *
  2767*                                                                *
  2768*   LOG = NO                                                     *
  2769*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2770*                                                                *
  2771******************************************************************
  2772*                   C H A N G E   L O G
  2773*
  2774* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2775*-----------------------------------------------------------------
  2776*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2777* EFFECTIVE    NUMBER
  2778*-----------------------------------------------------------------
  2779* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2780* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2781* 092205    2005050300006  PEMA  ADD LEASE FEE
  2782* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2783* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2784* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2785* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2786* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2787******************************************************************
  2788
  2789 01  COMPENSATION-MASTER.
  2790     12  CO-RECORD-ID                          PIC XX.
  2791         88  VALID-CO-ID                          VALUE 'CO'.
  2792
  2793     12  CO-CONTROL-PRIMARY.
  2794         16  CO-COMPANY-CD                     PIC X.
  2795         16  CO-CONTROL.
  2796             20  CO-CTL-1.
  2797                 24  CO-CARR-GROUP.
  2798                     28  CO-CARRIER            PIC X.
  2799                     28  CO-GROUPING.
  2800                         32  CO-GROUP-PREFIX   PIC XXX.
  2801                         32  CO-GROUP-PRIME    PIC XXX.
  2802                 24  CO-RESP-NO.
  2803                     28  CO-RESP-PREFIX        PIC X(4).
  2804                     28  CO-RESP-PRIME         PIC X(6).
  2805             20  CO-CTL-2.
  2806                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL633.cbl
  2807                     28  CO-ACCT-PREFIX        PIC X(4).
  2808                     28  CO-ACCT-PRIME         PIC X(6).
  2809         16  CO-TYPE                           PIC X.
  2810             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2811             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2812             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2813
  2814     12  CO-MAINT-INFORMATION.
  2815         16  CO-LAST-MAINT-DT                  PIC XX.
  2816         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2817         16  CO-LAST-MAINT-USER                PIC X(4).
  2818     12  FILLER                                PIC XX.
  2819     12  CO-STMT-TYPE                          PIC XXX.
  2820     12  CO-COMP-TYPE                          PIC X.
  2821         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2822     12  CO-STMT-OWNER                         PIC X(4).
  2823     12  CO-BALANCE-CONTROL                    PIC X.
  2824         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2825         88  CO-NO-BALANCE                        VALUE 'N'.
  2826
  2827     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2828         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2829         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2830         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2831
  2832     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2833         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2834         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2835
  2836     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2837     12  CO-GA-DIRECT-DEP                      PIC X.
  2838     12  CO-FUTURE-SPACE                       PIC X.
  2839         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2840
  2841     12  CO-ACCT-NAME                          PIC X(30).
  2842     12  CO-MAIL-NAME                          PIC X(30).
  2843     12  CO-ADDR-1                             PIC X(30).
  2844     12  CO-ADDR-2                             PIC X(30).
  2845     12  CO-ADDR-3.
  2846         16  CO-ADDR-CITY                      PIC X(27).
  2847         16  CO-ADDR-STATE                     PIC XX.
  2848     12  CO-CSO-1099                           PIC X.
  2849     12  CO-ZIP.
  2850         16  CO-ZIP-PRIME.
  2851             20  CO-ZIP-PRI-1ST                PIC X.
  2852                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2853             20  FILLER                        PIC X(4).
  2854         16  CO-ZIP-PLUS4                      PIC X(4).
  2855     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2856         16  CO-CAN-POSTAL-1                   PIC XXX.
  2857         16  CO-CAN-POSTAL-2                   PIC XXX.
  2858         16  FILLER                            PIC XXX.
  2859     12  CO-SOC-SEC                            PIC X(13).
  2860     12  CO-TELEPHONE.
  2861         16  CO-AREA-CODE                      PIC XXX.
  2862         16  CO-PREFIX                         PIC XXX.
  2863         16  CO-PHONE                          PIC X(4).
  2864
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL633.cbl
  2865     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2866
  2867     12  CO-AR-BAL-LEVEL                       PIC X.
  2868         88  CO-AR-REF-LVL                        VALUE '1'.
  2869         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2870         88  CO-AR-BILL-LVL                       VALUE '2'.
  2871         88  CO-AR-AGT-LVL                        VALUE '3'.
  2872         88  CO-AR-FR-LVL                         VALUE '4'.
  2873
  2874     12  CO-AR-NORMAL-PRINT                    PIC X.
  2875         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2876         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2877
  2878     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2879
  2880     12  CO-AR-REPORTING                       PIC X.
  2881         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2882         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2883
  2884     12  CO-AR-PULL-CHECK                      PIC X.
  2885         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2886         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2887
  2888     12  CO-AR-BALANCE-PRINT                   PIC X.
  2889         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2890
  2891     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2892         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2893         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2894         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2895
  2896     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2897
  2898     12  CO-USER-CODE                          PIC X.
  2899     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2900
  2901******************************************************************
  2902*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2903*    THE LAST MONTH END RUN.
  2904******************************************************************
  2905
  2906     12  CO-LAST-ACTIVITY-DATE.
  2907         16  CO-ACT-YEAR                       PIC 99.
  2908         16  CO-ACT-MONTH                      PIC 99.
  2909         16  CO-ACT-DAY                        PIC 99.
  2910
  2911     12  CO-LAST-STMT-DT.
  2912         16  CO-LAST-STMT-YEAR                 PIC 99.
  2913         16  CO-LAST-STMT-MONTH                PIC 99.
  2914         16  CO-LAST-STMT-DAY                  PIC 99.
  2915
  2916     12  CO-MO-END-TOTALS.
  2917         16  CO-MONTHLY-TOTALS.
  2918             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2919             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2920             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2921             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2922             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL633.cbl
  2923
  2924         16  CO-AGING-TOTALS.
  2925             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2926             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2927             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2928             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2929
  2930         16  CO-YTD-TOTALS.
  2931             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2932             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2933
  2934         16  CO-OVER-UNDER-TOTALS.
  2935             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2936             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2937
  2938     12  CO-MISCELLANEOUS-TOTALS.
  2939         16  CO-FICA-TOTALS.
  2940             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2941             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2942
  2943         16  CO-CLAIM-TOTALS.
  2944             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2945             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2946
  2947******************************************************************
  2948*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2949*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2950******************************************************************
  2951
  2952     12  CO-CURRENT-TOTALS.
  2953         16  CO-CURRENT-LAST-STMT-DT.
  2954             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2955             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2956             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2957
  2958         16  CO-CURRENT-MONTHLY-TOTALS.
  2959             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2960             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2961             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2962             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2963             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2964
  2965         16  CO-CURRENT-AGING-TOTALS.
  2966             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2967             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2968             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2969             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2970
  2971         16  CO-CURRENT-YTD-TOTALS.
  2972             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2973             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2974
  2975     12  CO-PAID-COMM-TOTALS.
  2976         16  CO-YTD-PAID-COMMS.
  2977             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2978             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2979
  2980     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL633.cbl
  2981         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2982         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2983
  2984     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2985         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2986         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2987         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2988         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2989         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2990         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2991         88  CO-FINAL-LETTER                  VALUE 'F'.
  2992         88  CO-RECONCILING                   VALUE 'R'.
  2993         88  CO-PHONE-CALL                    VALUE 'P'.
  2994         88  CO-LEGAL                         VALUE 'L'.
  2995         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2996         88  CO-WRITE-OFF                     VALUE 'W'.
  2997         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2998
  2999     12  CO-CSR-CODE                       PIC X(4).
  3000
  3001     12  CO-GA-STATUS-INFO.
  3002         16  CO-GA-EFFECTIVE-DT            PIC XX.
  3003         16  CO-GA-TERMINATION-DT          PIC XX.
  3004         16  CO-GA-STATUS-CODE             PIC X.
  3005             88  CO-GA-ACTIVE                 VALUE 'A'.
  3006             88  CO-GA-INACTIVE               VALUE 'I'.
  3007             88  CO-GA-PENDING                VALUE 'P'.
  3008         16  CO-GA-COMMENTS.
  3009             20  CO-GA-COMMENT-1           PIC X(40).
  3010             20  CO-GA-COMMENT-2           PIC X(40).
  3011             20  CO-GA-COMMENT-3           PIC X(40).
  3012             20  CO-GA-COMMENT-4           PIC X(40).
  3013
  3014     12  CO-RPTCD2                         PIC X(10).
  3015
  3016     12  CO-TYPE-AGENT                     PIC X(01).
  3017         88  CO-CORPORATION                   VALUE 'C'.
  3018         88  CO-PARTNERSHIP                   VALUE 'P'.
  3019         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  3020         88  CO-TRUST                         VALUE 'T'.
  3021         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  3022
  3023     12  CO-FAXNO.
  3024         16  CO-FAX-AREA-CODE                  PIC XXX.
  3025         16  CO-FAX-PREFIX                     PIC XXX.
  3026         16  CO-FAX-PHONE                      PIC X(4).
  3027
  3028     12  CO-BANK-INFORMATION.
  3029         16  CO-BANK-TRANSIT-NO                PIC X(8).
  3030         16  CO-BANK-TRANSIT-NON REDEFINES
  3031             CO-BANK-TRANSIT-NO                PIC 9(8).
  3032
  3033         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  3034     12  CO-MISC-DEDUCT-INFO REDEFINES
  3035                  CO-BANK-INFORMATION.
  3036         16  CO-MD-GL-ACCT                     PIC X(10).
  3037         16  CO-MD-DIV                         PIC XX.
  3038         16  CO-MD-CENTER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL633.cbl
  3039         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  3040         16  CO-CREATE-AP-CHECK                PIC X.
  3041         16  CO-DELIVER-CK-TO-MEL              PIC X.
  3042         16  FILLER                            PIC XXX.
  3043     12  CO-ACH-STATUS                         PIC X.
  3044         88  CO-ACH-ACTIVE                         VALUE 'A'.
  3045         88  CO-ACH-PENDING                        VALUE 'P'.
  3046
  3047     12  CO-BILL-SW                            PIC X.
  3048     12  CO-CONTROL-NAME                       PIC X(30).
  3049     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  3050     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  3051     12  CO-CLP-STATE                          PIC XX.
  3052     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  3053     12  CO-SPP-REFUND-EDIT                    PIC X.
  3054
  3055******************************************************************
  3056*
  3057*                            COPY AIRL0009.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL633.cbl
  3058/
  3059 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  3060                          PENDING-PAY-ADJ COMPENSATION-MASTER.
  3061 0000-DFHEXIT SECTION.
  3062     MOVE '9#                    $   ' TO DFHEIV0.
  3063     MOVE 'EL633' TO DFHEIV1.
  3064     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3065
  3066     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3067     MOVE EIBTRMID               TO  QID-TERM.
  3068     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  3069
  3070     IF EIBCALEN = ZERO
  3071         GO TO 8800-UNAUTHORIZED-ACCESS.
  3072
  3073     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3074         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  3075
  3076     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3077     MOVE '5'                    TO  DC-OPTION-CODE.
  3078
  3079     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3080
  3081     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT.
  3082     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT.
  3083
  3084     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3085         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3086             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  3087             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  3088             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  3089             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  3090             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  3091             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  3092             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  3093             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  3094         ELSE
  3095             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  3096             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  3097             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  3098             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  3099             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  3100             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  3101             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  3102             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  3103
  3104     MOVE LOW-VALUES             TO  EL633AI.
  3105
  3106     MOVE DC-JULIAN-YYDDD        TO  WORK-DATE-JULIAN.
  3107     COMPUTE WORK-SEQ-NO = WORK-JULIAN-DD * 100000.
  3108     MOVE EIBTIME                TO  WORK-SEQ-TIME.
  3109     ADD WORK-SEQ-HHMMS TO WORK-SEQ-NO.
  3110
  3111     MOVE ZEROS                  TO  TOTAL-ACCT-AMT
  3112                                     TOTAL-ACCT-NET.
  3113
  3114     IF RETURNED-FROM = XCTL-6331 OR
  3115                        XCTL-640  OR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL633.cbl
  3116                        XCTL-642  OR
  3117                        XCTL-652
  3118         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT.
  3119
  3120     IF EIBTRNID NOT = TRANS-ID
  3121         MOVE 'T'                TO  PI-PYAJ-FILE-SW
  3122         MOVE 'Y'                TO  PI-PAGE-SW
  3123         MOVE ZEROS              TO  PI-SEQ-NOS
  3124         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3125                                     PI-SAV-ACCT-NET
  3126                                     PI-SAV-PREV-AMT
  3127                                     PI-SAV-PREV-NET
  3128         IF (EIBTRNID NOT = EL640-TRANS-ID  AND
  3129             EIBTRNID NOT = EL642-TRANS-ID  AND
  3130             EIBTRNID NOT = EL652-TRANS-ID) OR
  3131             PI-CR-FIN-RESP = SPACES
  3132             GO TO 8100-SEND-INITIAL-MAP
  3133         ELSE
  3134             IF EIBTRNID = (EL6331-TRANS-ID  OR
  3135                            EL640-TRANS-ID   OR
  3136                            EL642-TRANS-ID)  AND
  3137                PI-CR-CONTROL-IN-PROGRESS  = SPACES
  3138                GO TO 8100-SEND-INITIAL-MAP
  3139             ELSE
  3140                 MOVE DFHENTER   TO  EIBAID
  3141                 MOVE 'S'        TO  MAINTI
  3142                 MOVE PI-CR-CARRIER
  3143                                 TO  CARRIERI
  3144                 MOVE PI-CR-GROUPING
  3145                                 TO  GROUPI
  3146                 MOVE PI-CR-FIN-RESP
  3147                                 TO  FINRESPI
  3148                 MOVE PI-CR-ACCOUNT
  3149                                 TO  ACCTI
  3150                 MOVE 1          TO  CARRIERL  MAINTA
  3151                 MOVE 3          TO  GROUPL
  3152                 MOVE 6          TO  FINRESPL  ACCTL
  3153                 GO TO 0400-VALIDATE-KEY-DATA.
  3154
  3155
  3156* EXEC CICS HANDLE CONDITION
  3157*        PGMIDERR  (9600-PGMID-ERROR)
  3158*        ERROR     (9990-ABEND)
  3159*    END-EXEC.
  3160*    MOVE '"$L.                  ! " #00003151' TO DFHEIV0
  3161     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3162     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3163     MOVE X'2220233030303033313531' TO DFHEIV0(25:11)
  3164     CALL 'kxdfhei1' USING DFHEIV0
  3165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3166
  3167
  3168     IF EIBAID = DFHCLEAR
  3169         GO TO 9400-CLEAR.
  3170
  3171     IF PI-PROCESSOR-ID = 'LGXX'
  3172         GO TO 0200-RECEIVE.
  3173
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL633.cbl
  3174
  3175* EXEC CICS READQ TS
  3176*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  3177*        INTO   (SECURITY-CONTROL)
  3178*        LENGTH (SC-COMM-LENGTH)
  3179*        ITEM   (SC-ITEM)
  3180*    END-EXEC.
  3181*    MOVE '*$II   L              ''   #00003162' TO DFHEIV0
  3182     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3183     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3184     MOVE X'2020233030303033313632' TO DFHEIV0(25:11)
  3185     CALL 'kxdfhei1' USING DFHEIV0,
  3186           PI-SECURITY-TEMP-STORE-ID,
  3187           SECURITY-CONTROL,
  3188           SC-COMM-LENGTH,
  3189           SC-ITEM,
  3190           DFHEIV99,
  3191           DFHEIV99
  3192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3193
  3194
  3195     MOVE SC-CREDIT-DISPLAY (15)  TO PI-DISPLAY-CAP.
  3196     MOVE SC-CREDIT-UPDATE  (15)  TO PI-MODIFY-CAP.
  3197
  3198     IF NOT DISPLAY-CAP
  3199         MOVE 'READ'          TO SM-READ
  3200         PERFORM 9995-SECURITY-VIOLATION
  3201         MOVE ER-0070         TO  EMI-ERROR
  3202         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3203         GO TO 8100-SEND-INITIAL-MAP.
  3204
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL633.cbl
  3206 0200-RECEIVE.
  3207
  3208     IF EIBAID = DFHPA1  OR  DFHPA2  OR  DFHPA3
  3209         MOVE ER-0008            TO  EMI-ERROR
  3210         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3211         MOVE -1                 TO  MAINTL
  3212         GO TO 8200-SEND-DATAONLY.
  3213
  3214
  3215* EXEC CICS RECEIVE
  3216*        MAP     (MAP-NAME)
  3217*        MAPSET  (MAPSET-NAME)
  3218*        INTO    (EL633AI)
  3219*    END-EXEC.
  3220     MOVE LENGTH OF
  3221      EL633AI
  3222       TO DFHEIV11
  3223*    MOVE '8"T I  L              ''   #00003188' TO DFHEIV0
  3224     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3225     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3226     MOVE X'2020233030303033313838' TO DFHEIV0(25:11)
  3227     CALL 'kxdfhei1' USING DFHEIV0,
  3228           MAP-NAME,
  3229           EL633AI,
  3230           DFHEIV11,
  3231           MAPSET-NAME,
  3232           DFHEIV99,
  3233           DFHEIV99
  3234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3235
  3236
  3237     IF MAINTI = 'S' AND
  3238        EIBAID = DFHENTER
  3239         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3240                                     PI-SAV-ACCT-NET
  3241                                     PI-SAV-PREV-AMT
  3242                                     PI-SAV-PREV-NET
  3243                                     PI-FRST-FILE-SEQ-NO
  3244         MOVE SPACES             TO  PI-FRST-RECORD-TYPE.
  3245
  3246     IF PFENTERL = ZERO
  3247         GO TO 0300-CHECK-PFKEYS.
  3248
  3249     IF (PFENTERI  IS NUMERIC)
  3250       AND (PFENTERI GREATER 0 AND LESS 25)
  3251         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  3252     ELSE
  3253         MOVE ER-0029               TO  EMI-ERROR
  3254         GO TO 0320-INPUT-ERROR.
  3255
  3256 0300-CHECK-PFKEYS.
  3257     IF EIBAID = DFHPF23
  3258         GO TO 8810-PF23.
  3259
  3260     IF EIBAID = DFHPF24
  3261         GO TO 9200-RETURN-MAIN-MENU.
  3262
  3263     IF EIBAID = DFHPF12
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL633.cbl
  3264         GO TO 9500-PF12.
  3265
  3266     IF EIBAID = DFHPF3
  3267         IF PI-CR-CONTROL-IN-PROGRESS NOT =      SPACES
  3268             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3269             MOVE XCTL-652       TO  PGM-NAME
  3270             IF ERCOMP-KEY  NOT =      SPACES
  3271                 MOVE COMP-CARRIER   TO  PI-CR-CARRIER
  3272                 MOVE COMP-GROUPING  TO  PI-CR-GROUPING
  3273                 MOVE COMP-FIN-RESP  TO  PI-CR-FIN-RESP
  3274                 MOVE COMP-ACCOUNT   TO  PI-CR-ACCOUNT
  3275             END-IF
  3276
  3277             IF PI-CR-ACCOUNT = LOW-VALUES
  3278                 MOVE 'G'        TO  PI-CR-TYPE
  3279                 GO TO 9300-XCTL
  3280             ELSE
  3281                 MOVE 'A'        TO  PI-CR-TYPE
  3282                 GO TO 9300-XCTL
  3283         ELSE
  3284            MOVE ER-3020         TO  EMI-ERROR
  3285            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3286            GO TO 8100-SEND-INITIAL-MAP.
  3287
  3288     IF EIBAID = DFHPF4
  3289         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3290         MOVE XCTL-6331          TO  PGM-NAME
  3291         GO TO 9300-XCTL.
  3292
  3293     IF EIBAID = DFHPF5
  3294         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3295         MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3296         MOVE XCTL-640           TO  PGM-NAME
  3297         IF PI-CR-ACCOUNT = LOW-VALUES
  3298             MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3299             IF ACCTI = LOW-VALUES
  3300                MOVE 'G'         TO  PI-CR-TYPE
  3301             END-IF
  3302             GO TO 9300-XCTL
  3303         ELSE
  3304             MOVE 'A'        TO  PI-CR-TYPE
  3305             GO TO 9300-XCTL.
  3306
  3307     IF EIBAID = DFHPF6
  3308        IF PI-GA-BILLING
  3309            PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3310            MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3311            MOVE XCTL-642        TO  PGM-NAME
  3312            IF PI-CR-ACCOUNT = LOW-VALUES
  3313                 MOVE 'G'        TO  PI-CR-TYPE
  3314                 GO TO 9300-XCTL
  3315             ELSE
  3316                 MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3317                 GO TO 9300-XCTL
  3318        ELSE
  3319            MOVE ER-2929         TO  EMI-ERROR
  3320            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3321            MOVE AL-UNBON        TO  PFENTERA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL633.cbl
  3322            IF PFENTERL = ZERO
  3323                MOVE -1          TO  MAINTL
  3324                GO TO 8200-SEND-DATAONLY
  3325            ELSE
  3326                MOVE -1          TO  PFENTERL
  3327                GO TO 8200-SEND-DATAONLY.
  3328
  3329     IF EIBAID = DFHENTER  OR  DFHPF1  OR  DFHPF2
  3330         GO TO 0400-VALIDATE-KEY-DATA.
  3331
  3332 0320-INPUT-ERROR.
  3333     MOVE ER-0029                TO  EMI-ERROR.
  3334
  3335     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3336
  3337     MOVE AL-UNBON               TO  PFENTERA.
  3338
  3339     IF PFENTERL = ZERO
  3340         MOVE -1                 TO  MAINTL
  3341     ELSE
  3342         MOVE -1                 TO  PFENTERL.
  3343
  3344     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL633.cbl
  3346 0400-VALIDATE-KEY-DATA.
  3347     IF MODIFY-CAP  OR (EIBAID = DFHPF1 OR DFHPF2)
  3348         NEXT SENTENCE
  3349       ELSE
  3350        IF MAINTI NOT = 'S'
  3351         MOVE 'UPDATE'       TO SM-READ
  3352         PERFORM 9995-SECURITY-VIOLATION
  3353         MOVE ER-0070        TO EMI-ERROR
  3354         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3355         GO TO 8100-SEND-INITIAL-MAP.
  3356
  3357     MOVE PI-COMPANY-CD          TO  PI-SAV-COMP-CD.
  3358
  3359     IF EIBAID = DFHPF1
  3360         GO TO 4000-BROWSE-FRWD.
  3361
  3362     IF EIBAID   = DFHPF1   AND
  3363        CARRIERL = ZEROS    AND
  3364        GROUPL   = ZEROS    AND
  3365        FINRESPL = ZEROS    AND
  3366        ACCTL    = ZEROS
  3367         GO TO 4000-BROWSE-FRWD.
  3368
  3369     IF PI-PROCESSOR-ID = 'LGXX'
  3370         IF MAINTI = 'C'
  3371             MOVE AL-UANON       TO MAINTA
  3372             MOVE MAINTI         TO PI-SAV-FUNCTION
  3373             GO TO CSO-BRANCH
  3374         END-IF
  3375     END-IF.
  3376
  3377     IF MAINTI = 'C' OR  'S'
  3378         MOVE AL-UANON           TO  MAINTA
  3379         MOVE MAINTI             TO  PI-SAV-FUNCTION
  3380     ELSE
  3381         MOVE -1                 TO  MAINTL
  3382         MOVE ER-0023            TO  EMI-ERROR
  3383         MOVE AL-UABON           TO  MAINTA
  3384         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3385
  3386 CSO-BRANCH.
  3387
  3388     IF MAINTI = 'C'
  3389       AND PI-PREV-FUNCTION NOT = 'S' AND 'C'
  3390         MOVE -1                 TO  MAINTL
  3391         MOVE ER-2056            TO  EMI-ERROR
  3392         MOVE AL-UABON           TO  MAINTA
  3393         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3394
  3395     IF CARRIERL = ZEROS  AND
  3396        GROUPL   = ZEROS  AND
  3397        FINRESPL = ZEROS  AND
  3398        ACCTL    = ZEROS
  3399         MOVE -1                 TO  CARRIERL
  3400         MOVE ER-2231            TO  EMI-ERROR
  3401         MOVE AL-UABON           TO  CARRIERA
  3402                                     GROUPA
  3403                                     FINRESPA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL633.cbl
  3404                                     ACCTA
  3405         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3406         GO TO 8200-SEND-DATAONLY.
  3407
  3408     IF CARRIERL NOT = ZEROS
  3409         MOVE AL-UANON           TO  CARRIERA
  3410         MOVE CARRIERI           TO  COMP-CARRIER
  3411                                     PI-SAV-CARRIER
  3412                                     PI-CR-CARRIER
  3413         IF CARRIERI NOT = ZEROS
  3414           AND (PI-ZERO-CARRIER  OR  PI-ZERO-CAR-GROUP)
  3415             MOVE ER-2587        TO  EMI-ERROR
  3416             MOVE -1             TO  CARRIERL
  3417             MOVE AL-UABON       TO  CARRIERA
  3418             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3419         ELSE
  3420             NEXT SENTENCE
  3421     ELSE
  3422         MOVE LOW-VALUES          TO  COMP-CARRIER
  3423                                      PI-SAV-CARRIER.
  3424
  3425     IF CARRIERL NOT = ZEROS
  3426         IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  3427             IF PI-CARRIER-SECURITY = CARRIERI
  3428                 NEXT SENTENCE
  3429             ELSE
  3430                 MOVE -1         TO  CARRIERL
  3431                 MOVE ER-2370    TO  EMI-ERROR
  3432                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3433
  3434     IF GROUPL NOT = ZEROS
  3435         MOVE AL-UANON           TO  GROUPA
  3436         MOVE GROUPI             TO  COMP-GROUPING
  3437                                     PI-SAV-GROUPING
  3438                                     PI-CR-GROUPING
  3439         IF GROUPI NOT = ZEROS
  3440           AND (PI-ZERO-GROUPING  OR  PI-ZERO-CAR-GROUP)
  3441             MOVE ER-2588        TO  EMI-ERROR
  3442             MOVE -1             TO  GROUPL
  3443             MOVE AL-UABON       TO  GROUPA
  3444             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3445         ELSE
  3446             NEXT SENTENCE
  3447     ELSE
  3448         MOVE LOW-VALUES         TO  COMP-GROUPING
  3449                                     PI-SAV-GROUPING.
  3450
  3451     IF FINRESPL NOT = ZEROS
  3452         MOVE AL-UANON           TO  FINRESPA
  3453         MOVE FINRESPI           TO  COMP-FIN-RESP
  3454                                     PI-SAV-FIN-RESP
  3455                                     PI-CR-FIN-RESP
  3456     ELSE
  3457         MOVE LOW-VALUES         TO  COMP-FIN-RESP
  3458                                     PI-SAV-FIN-RESP.
  3459
  3460     IF ACCTL NOT = ZEROS
  3461         MOVE AL-UANON           TO  ACCTA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL633.cbl
  3462         MOVE ACCTI              TO  COMP-ACCOUNT
  3463                                     PI-SAV-ACCOUNT
  3464                                     PI-CR-ACCOUNT
  3465     ELSE
  3466         MOVE LOW-VALUES         TO  COMP-ACCOUNT
  3467                                     PI-SAV-ACCOUNT
  3468                                     PI-CR-ACCOUNT.
  3469
  3470     IF EMI-ERROR = ZEROS
  3471         NEXT SENTENCE
  3472     ELSE
  3473         IF EIBTRNID = EL640-TRANS-ID OR
  3474            EIBTRNID = EL642-TRANS-ID OR
  3475            EIBTRNID = EL6331-TRANS-ID
  3476             GO TO 8100-SEND-INITIAL-MAP
  3477         ELSE
  3478             GO TO 8200-SEND-DATAONLY.
  3479
  3480     MOVE MAINTI                 TO  PI-PREV-FUNCTION.
  3481
  3482     IF MAINTI = 'S'
  3483         IF EIBAID = DFHPF1              OR  DFHENTER
  3484             GO TO 4000-BROWSE-FRWD
  3485         ELSE
  3486             GO TO 4100-BROWSE-BKWD.
  3487
  3488     MOVE SPACES                 TO  COMP-RECORD-TYPE.
  3489     MOVE PI-COMPANY-CD          TO  COMP-COMP-CD.
  3490
  3491
  3492* EXEC CICS HANDLE CONDITION
  3493*        NOTFND   (0410-NO-COMP-MSTR)
  3494*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3495*        END-EXEC.
  3496*    MOVE '"$IJ                  ! # #00003448' TO DFHEIV0
  3497     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3498     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3499     MOVE X'2320233030303033343438' TO DFHEIV0(25:11)
  3500     CALL 'kxdfhei1' USING DFHEIV0
  3501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3502
  3503
  3504
  3505* EXEC CICS READ
  3506*        DATASET  (COMP-FILE-ID)
  3507*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3508*        RIDFLD   (ERCOMP-KEY)
  3509*        GTEQ
  3510*        END-EXEC.
  3511*    MOVE '&"S        G          (   #00003453' TO DFHEIV0
  3512     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3513     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3514     MOVE X'2020233030303033343533' TO DFHEIV0(25:11)
  3515     CALL 'kxdfhei1' USING DFHEIV0,
  3516           COMP-FILE-ID,
  3517           DFHEIV20,
  3518           DFHEIV99,
  3519           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL633.cbl
  3520           DFHEIV99,
  3521           DFHEIV99,
  3522           DFHEIV99
  3523     SET ADDRESS OF COMPENSATION-MASTER TO
  3524         DFHEIV20
  3525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3526
  3527
  3528     IF PI-COMPANY-CD = CO-COMPANY-CD  AND
  3529        COMP-CARRIER  = CO-CARRIER     AND
  3530        COMP-GROUPING = CO-GROUPING    AND
  3531        COMP-FIN-RESP = CO-RESP-NO    AND
  3532        COMP-ACCOUNT  = CO-ACCOUNT
  3533         NEXT SENTENCE
  3534     ELSE
  3535         GO TO 0410-NO-COMP-MSTR.
  3536
  3537     IF PI-COMPANY-ID = 'NCL'
  3538         IF CO-GA-INACTIVE
  3539             GO TO 0420-INACTIVE-COMP.
  3540
  3541     IF MAINTI = 'C'
  3542         GO TO 1000-EDIT-DATA.
  3543
  3544     IF EIBAID = DFHPF1
  3545       OR DFHENTER
  3546         GO TO 4000-BROWSE-FRWD.
  3547
  3548     IF EIBAID = DFHPF2
  3549         GO TO 4100-BROWSE-BKWD.
  3550
  3551 0410-NO-COMP-MSTR.
  3552     MOVE ER-2230                TO  EMI-ERROR.
  3553     MOVE -1                     TO  CARRIERL.
  3554     MOVE AL-UABON               TO  CARRIERA
  3555                                     GROUPA
  3556                                     FINRESPA
  3557                                     ACCTA.
  3558
  3559     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3560
  3561     GO TO 8200-SEND-DATAONLY.
  3562
  3563 0420-INACTIVE-COMP.
  3564     MOVE ER-2763                TO  EMI-ERROR.
  3565     MOVE -1                     TO  CARRIERL.
  3566     MOVE AL-UABON               TO  CARRIERA
  3567                                     GROUPA
  3568                                     FINRESPA
  3569                                     ACCTA.
  3570
  3571     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3572
  3573     GO TO 8200-SEND-DATAONLY.
  3574
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL633.cbl
  3576 0500-CREATE-TEMP-STORAGE.
  3577
  3578     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  3579
  3580
  3581* EXEC CICS WRITEQ TS
  3582*        QUEUE  (QID)
  3583*        FROM   (PROGRAM-INTERFACE-BLOCK)
  3584*        LENGTH (PI-COMM-LENGTH)
  3585*    END-EXEC.
  3586*    MOVE '*"                    ''   #00003512' TO DFHEIV0
  3587     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  3588     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3589     MOVE X'2020233030303033353132' TO DFHEIV0(25:11)
  3590     CALL 'kxdfhei1' USING DFHEIV0,
  3591           QID,
  3592           PROGRAM-INTERFACE-BLOCK,
  3593           PI-COMM-LENGTH,
  3594           DFHEIV99,
  3595           DFHEIV99,
  3596           DFHEIV99
  3597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3598
  3599
  3600 0590-EXIT.
  3601      EXIT.
  3602
  3603 0600-RECOVER-TEMP-STORAGE.
  3604
  3605* EXEC CICS READQ TS
  3606*        QUEUE  (QID)
  3607*        INTO   (PROGRAM-INTERFACE-BLOCK)
  3608*        LENGTH (PI-COMM-LENGTH)
  3609*    END-EXEC.
  3610*    MOVE '*$I    L              ''   #00003522' TO DFHEIV0
  3611     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3612     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3613     MOVE X'2020233030303033353232' TO DFHEIV0(25:11)
  3614     CALL 'kxdfhei1' USING DFHEIV0,
  3615           QID,
  3616           PROGRAM-INTERFACE-BLOCK,
  3617           PI-COMM-LENGTH,
  3618           DFHEIV99,
  3619           DFHEIV99,
  3620           DFHEIV99
  3621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3622
  3623
  3624     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  3625
  3626 0690-EXIT.
  3627      EXIT.
  3628
  3629 0800-DELETE-TS.
  3630
  3631* EXEC CICS HANDLE CONDITION
  3632*        QIDERR (0890-EXIT)
  3633*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL633.cbl
  3634*    MOVE '"$N                   ! $ #00003534' TO DFHEIV0
  3635     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3636     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3637     MOVE X'2420233030303033353334' TO DFHEIV0(25:11)
  3638     CALL 'kxdfhei1' USING DFHEIV0
  3639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3640
  3641
  3642
  3643* EXEC CICS DELETEQ TS
  3644*        QUEUE  (QID)
  3645*    END-EXEC.
  3646*    MOVE '*&                    #   #00003538' TO DFHEIV0
  3647     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3648     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3649     MOVE X'2020233030303033353338' TO DFHEIV0(25:11)
  3650     CALL 'kxdfhei1' USING DFHEIV0,
  3651           QID,
  3652           DFHEIV99
  3653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3654
  3655
  3656
  3657* EXEC CICS SYNCPOINT
  3658*    END-EXEC.
  3659*    MOVE '6"                    !   #00003542' TO DFHEIV0
  3660     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  3661     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3662     MOVE X'2020233030303033353432' TO DFHEIV0(25:11)
  3663     CALL 'kxdfhei1' USING DFHEIV0
  3664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3665
  3666
  3667 0890-EXIT.
  3668      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL633.cbl
  3670
  3671 1000-EDIT-DATA.
  3672     SET PINDX                   TO  1.
  3673
  3674     .
  3675 1010-EDIT-LOOP.
  3676     SET NDX                     TO  PINDX.
  3677     IF GL-ACCT-LEN (PINDX)   = ZEROS  AND
  3678        GL-STATE-LEN (PINDX) = ZEROS   AND
  3679        GL-CANC-LEN (PINDX)   = ZEROS  AND
  3680        GL-COMM-LEN (PINDX)   = ZEROS  AND
  3681        RTYPE-LEN (PINDX)     = ZEROS  AND
  3682        AMT-LEN (PINDX)       = ZEROS  AND
  3683        VOID-SW-LEN (PINDX)   = ZEROS  AND
  3684        SDTE-LEN (PINDX)      = ZEROS
  3685         GO TO 1020-INCREMENT-PINDX.
  3686
  3687     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3688         MOVE AL-UANON           TO  GL-ACCT-ATTRB (PINDX)
  3689         IF PI-COMPANY-ID NOT = 'WSL'
  3690             NEXT SENTENCE
  3691         ELSE
  3692             MOVE WSL-COMM-DTE (PINDX)  TO  DC-GREG-DATE-1-MDY
  3693             MOVE '4'                   TO  DC-OPTION-CODE
  3694             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  3695             IF NO-CONVERSION-ERROR
  3696                 NEXT SENTENCE
  3697             ELSE
  3698                 MOVE ER-2595    TO  EMI-ERROR
  3699                 MOVE -1         TO  GL-ACCT-LEN (PINDX)
  3700                 MOVE AL-UABON   TO  GL-ACCT-ATTRB (PINDX)
  3701                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3702     ELSE
  3703         IF PI-COMPANY-ID = 'WSL'
  3704           AND PI-FILE-SEQ-NO (NDX) = ZEROS
  3705             MOVE ER-2596        TO  EMI-ERROR
  3706             MOVE -1             TO  GL-ACCT-LEN (PINDX)
  3707             MOVE AL-UABON       TO  GL-ACCT-ATTRB (PINDX)
  3708             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3709
  3710
  3711     IF GL-ACCT-LEN (PINDX) NOT = ZEROES
  3712*        MOVE K-SPACE            TO COFA-FILLER
  3713*        MOVE '0001'             TO COFA-COMPANY-X
  3714*        MOVE MSA-ACCT (PINDX)   TO COFA-MSA-ACCT
  3715         MOVE AL-UANON           TO GL-ACCT-ATTRB (PINDX)
  3716     ELSE
  3717         IF PI-FILE-SEQ-NO (NDX) = ZEROES
  3718             MOVE -1             TO GL-ACCT-LEN (PINDX)
  3719             MOVE ER-2957        TO EMI-ERROR
  3720             MOVE AL-UABON       TO GL-ACCT-ATTRB (PINDX)
  3721             PERFORM 9900-ERROR-FORMAT THRU
  3722                     9900-EXIT
  3723             GO TO 1040-CONTINUE-EDIT
  3724         ELSE
  3725             GO TO 1040-CONTINUE-EDIT
  3726         END-IF
  3727     END-IF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL633.cbl
  3728
  3729     IF (PI-COMPANY-ID = 'DCC')
  3730        AND (RTYPE (PINDX) = 'P')
  3731        GO TO 1040-CONTINUE-EDIT
  3732     END-IF
  3733     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3734        MOVE GL-ACCT (PINDX)     TO CHECK-GL-ACCT
  3735     ELSE
  3736        MOVE SPACES              TO CHECK-GL-ACCT
  3737     END-IF
  3738
  3739     EVALUATE TRUE
  3740        WHEN (PI-COMPANY-ID = 'DCC')
  3741           AND (CO-CARRIER = '1' OR '2')
  3742           AND (VALID-DCC-GL-ACCOUNT)
  3743           GO TO 1040-CONTINUE-EDIT
  3744        WHEN (PI-COMPANY-ID = 'DCC')
  3745           AND (CO-CARRIER = '3' OR '4')
  3746           AND VALID-CSI-GL-ACCOUNT
  3747           GO TO 1040-CONTINUE-EDIT
  3748        WHEN (PI-COMPANY-ID = 'DCC')
  3749           AND (CO-CARRIER = '5' OR '6')
  3750           AND (VALID-CCC-GL-ACCOUNT)
  3751           GO TO 1040-CONTINUE-EDIT
  3752        WHEN (PI-COMPANY-ID = 'CID' OR 'AHL')
  3753           AND (VALID-GL-ACCOUNT)
  3754           GO TO 1040-CONTINUE-EDIT
  3755     END-EVALUATE
  3756*    EXEC CICS HANDLE CONDITION
  3757*         NOTFND (1040-NO-COFA-MSTR)
  3758*         NOTOPEN (7100-COFA-FILE-NOTOPEN)
  3759*    END-EXEC.
  3760*
  3761*    EXEC CICS READ
  3762*         DATASET (COFA-FILE-ID)
  3763*         SET     (ADDRESS OF CHART-OF-ACCOUNTS)
  3764*         RIDFLD  (COFA-KEY-X)
  3765*    END-EXEC.
  3766*
  3767*    MOVE CHART-OF-ACCOUNTS      TO SV-COFA.
  3768*    GO TO 1040-CONTINUE-EDIT.
  3769*
  3770*1040-NO-COFA-MSTR.
  3771
  3772     MOVE ER-2960                TO EMI-ERROR.
  3773     MOVE -1                     TO GL-ACCT-LEN (PINDX).
  3774     MOVE AL-UABON               TO GL-ACCT-ATTRB (PINDX).
  3775     PERFORM 9900-ERROR-FORMAT THRU
  3776             9900-EXIT.
  3777
  3778 1040-CONTINUE-EDIT.
  3779
  3780*    MOVE MSA-ACCT (PINDX)       TO WS-ACCT-BREAK.
  3781     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  3782         MOVE GL-STATE (PINDX)   TO CHECK-STATE-CODE
  3783         IF NOT VALID-STATE-CODE
  3784             MOVE -1             TO GL-STATE-LEN (PINDX)
  3785             MOVE ER-2957        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL633.cbl
  3786             MOVE AL-UABON       TO GL-STATE-ATTRB (PINDX)
  3787             PERFORM 9900-ERROR-FORMAT THRU
  3788                     9900-EXIT
  3789         ELSE
  3790             MOVE AL-UANON       TO GL-STATE-ATTRB (PINDX)
  3791         END-IF
  3792     END-IF.
  3793
  3794 1040-CSO-SKIP.
  3795
  3796     IF GL-CANC (PINDX) = LOW-VALUES
  3797         MOVE SPACES             TO GL-CANC (PINDX)
  3798     END-IF.
  3799
  3800     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  3801         MOVE GL-CANC (PINDX)    TO CHECK-CANC-TYPE
  3802         IF NOT VALID-CANC-TYPE
  3803             MOVE -1             TO GL-CANC-LEN (PINDX)
  3804             MOVE ER-2958        TO EMI-ERROR
  3805             MOVE AL-UABON       TO GL-CANC-ATTRB (PINDX)
  3806             PERFORM 9900-ERROR-FORMAT THRU
  3807                     9900-EXIT
  3808         ELSE
  3809             MOVE AL-UANON       TO GL-CANC-ATTRB (PINDX)
  3810         END-IF
  3811     END-IF.
  3812
  3813     IF RTYPE-LEN (PINDX) NOT = ZEROS
  3814        MOVE RTYPE (PINDX)       TO  CHECK-REC-TYPE
  3815        IF (PI-COMPANY-ID = 'DCC')
  3816           AND (RTYPE (PINDX) = 'P')
  3817           SET VALID-REC-TYPE   TO TRUE
  3818        END-IF
  3819         IF NOT VALID-REC-TYPE
  3820             MOVE -1             TO  RTYPE-LEN (PINDX)
  3821             MOVE ER-2234        TO  EMI-ERROR
  3822             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3823             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3824         ELSE
  3825             MOVE AL-UANON       TO  RTYPE-ATTRB (PINDX)
  3826     ELSE
  3827         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3828             MOVE -1             TO  RTYPE-LEN (PINDX)
  3829             MOVE ER-2235        TO  EMI-ERROR
  3830             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3831             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3832
  3833     IF AMT-LEN (PINDX) NOT = ZEROS
  3834
  3835* EXEC CICS BIF DEEDIT
  3836*           FIELD (AMT (PINDX))
  3837*           LENGTH (11)
  3838*       END-EXEC
  3839     MOVE 11
  3840       TO DFHEIV11
  3841*    MOVE '@"L                   #   #00003712' TO DFHEIV0
  3842     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3843     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL633.cbl
  3844     MOVE X'2020233030303033373132' TO DFHEIV0(25:11)
  3845     CALL 'kxdfhei1' USING DFHEIV0,
  3846           AMT(PINDX),
  3847           DFHEIV11
  3848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3849         IF AMT (PINDX) = ZEROS
  3850             IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3851                 NEXT SENTENCE
  3852             ELSE
  3853                 MOVE ER-2245    TO  EMI-ERROR
  3854                 MOVE -1         TO  AMT-LEN(PINDX)
  3855                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3856                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3857         ELSE
  3858             IF AMT (PINDX) NUMERIC
  3859                 MOVE AMT (PINDX) TO  AMTO (PINDX)
  3860             ELSE
  3861                 MOVE ER-2245    TO  EMI-ERROR
  3862                 MOVE -1         TO  AMT-LEN(PINDX)
  3863                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3864                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3865     ELSE
  3866         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3867             MOVE -1             TO  AMT-LEN (PINDX)
  3868             MOVE ER-2236        TO  EMI-ERROR
  3869             MOVE AL-UNBON       TO  AMT-ATTRB (PINDX)
  3870             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3871
  3872     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  3873         IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3874           AND (PI-REC-TYPE (NDX) = 'C')
  3875             IF VOID-SW (PINDX) = 'V'
  3876                 MOVE AL-UANON   TO  VOID-SW-ATTRB (PINDX)
  3877             ELSE
  3878                 MOVE ER-2246    TO  EMI-ERROR
  3879                 MOVE -1         TO  VOID-SW-LEN (PINDX)
  3880                 MOVE AL-UABON   TO  VOID-SW-ATTRB (PINDX)
  3881                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3882         ELSE
  3883             MOVE ER-2449        TO  EMI-ERROR
  3884             MOVE -1             TO  VOID-SW-LEN (PINDX)
  3885             MOVE AL-UABON       TO  VOID-SW-ATTRB (PINDX)
  3886             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3887
  3888     IF SDTE-LEN (PINDX) = ZEROS
  3889        GO TO 1020-INCREMENT-PINDX.
  3890
  3891     MOVE AL-UNNON               TO  SDTE-ATTRB (PINDX).
  3892
  3893     MOVE SDTE (PINDX)           TO DEEDIT-FIELD.
  3894     PERFORM 8600-DEEDIT.
  3895
  3896     IF DEEDIT-FIELD-V0 NOT NUMERIC
  3897        GO TO 1015-DAY-ERROR.
  3898
  3899     MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY.
  3900     MOVE '4'                    TO  DC-OPTION-CODE.
  3901     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL633.cbl
  3902
  3903     IF NO-CONVERSION-ERROR
  3904        SET PINDEX               TO  PINDX
  3905        MOVE DC-BIN-DATE-1       TO  WS-EOM-DT (PINDEX)
  3906     ELSE
  3907        GO TO 1015-DAY-ERROR.
  3908
  3909     MOVE DEEDIT-FIELD-V0        TO DATE-TEST-AREA.
  3910
  3911     IF DATE-TEST-MM = 4 OR  6  OR  9  OR  11
  3912         IF DATE-TEST-DD  NOT = 30
  3913             GO TO 1015-DAY-ERROR
  3914         ELSE
  3915             GO TO 1020-INCREMENT-PINDX.
  3916
  3917     IF DATE-TEST-MM = 1 OR  3  OR  5  OR  7  OR
  3918                             8  OR  10  OR  12
  3919         IF DATE-TEST-DD  NOT = 31
  3920             GO TO 1015-DAY-ERROR
  3921         ELSE
  3922             GO TO 1020-INCREMENT-PINDX.
  3923
  3924     DIVIDE DATE-TEST-YY  BY  4  GIVING  DIVIDE-RESULT
  3925         REMAINDER  DIVIDE-REMAINDER.
  3926
  3927     IF (DATE-TEST-YY = ZERO)
  3928       OR (DIVIDE-REMAINDER NOT = ZERO)
  3929         IF DATE-TEST-DD  NOT = 28
  3930             GO TO 1015-DAY-ERROR
  3931         ELSE
  3932             GO TO 1020-INCREMENT-PINDX
  3933     ELSE
  3934         IF DATE-TEST-DD = 29
  3935             GO TO 1020-INCREMENT-PINDX.
  3936
  3937 1015-DAY-ERROR.
  3938     MOVE -1                     TO  SDTE-LEN (PINDX).
  3939     MOVE AL-UNBON               TO  SDTE-ATTRB (PINDX).
  3940     MOVE ER-0587                TO  EMI-ERROR.
  3941
  3942     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3943
  3944 1020-INCREMENT-PINDX.
  3945     SET PINDX  UP  BY  1.
  3946
  3947     IF PINDX  IS NOT GREATER THAN  13
  3948         GO TO 1010-EDIT-LOOP.
  3949
  3950     IF EMI-ERROR = ZEROS
  3951         NEXT SENTENCE
  3952     ELSE
  3953         MOVE 'S'                TO  PI-PREV-FUNCTION
  3954         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL633.cbl
  3956 2000-UPDATE-THE-FILE.
  3957     SET PINDX                   TO  ZERO-NDX.
  3958*    SET NDX                     TO  ZERO-NDX.
  3959*    SET NDX  UP  BY  1.
  3960
  3961     IF PI-PYAJ-FILE-SW = 'B'
  3962         MOVE WORK-SEQ-NO        TO  PI-FRST-FILE-SEQ-NO
  3963         MOVE RTYPE (PINDX)      TO  PI-FRST-RECORD-TYPE
  3964     ELSE
  3965         MOVE PI-LAST-FILE-SEQ-NO
  3966                                 TO  PI-SAV-FILE-SEQ-NO
  3967         MOVE PI-LAST-RECORD-TYPE
  3968                                 TO  PI-SAV-RECORD-TYPE.
  3969
  3970 2100-UPDATE-LOOP.
  3971     SET PINDX  UP  BY  1.
  3972     SET NDX                     TO  PINDX.
  3973
  3974     IF PINDX  IS GREATER THAN  13
  3975         GO TO 2200-UPDATE-COMPLETE.
  3976
  3977     IF GL-ACCT-LEN (PINDX)   = ZEROS AND
  3978        GL-STATE-LEN (PINDX) = ZEROS AND
  3979        GL-CANC-LEN (PINDX)   = ZEROS AND
  3980        GL-COMM-LEN (PINDX)   = ZEROS AND
  3981        RTYPE-LEN (PINDX)   = ZEROS  AND
  3982        AMT-LEN (PINDX)     = ZEROS  AND
  3983        VOID-SW-LEN (PINDX) = ZEROS  AND
  3984        SDTE-LEN (PINDX)    = ZEROS
  3985         GO TO 2100-UPDATE-LOOP.
  3986
  3987
  3988* EXEC CICS BIF DEEDIT
  3989*         FIELD (AMT (PINDX))
  3990*         LENGTH (11)
  3991*    END-EXEC.
  3992     MOVE 11
  3993       TO DFHEIV11
  3994*    MOVE '@"L                   #   #00003854' TO DFHEIV0
  3995     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3996     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3997     MOVE X'2020233030303033383534' TO DFHEIV0(25:11)
  3998     CALL 'kxdfhei1' USING DFHEIV0,
  3999           AMT(PINDX),
  4000           DFHEIV11
  4001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4002
  4003
  4004     IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  4005         NEXT SENTENCE
  4006     ELSE
  4007         GO TO 2110-ADD-RECORD.
  4008
  4009
  4010* EXEC CICS HANDLE CONDITION
  4011*        NOTFND  (2110-ADD-RECORD)
  4012*    END-EXEC.
  4013*    MOVE '"$I                   ! % #00003864' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL633.cbl
  4014     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4015     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4016     MOVE X'2520233030303033383634' TO DFHEIV0(25:11)
  4017     CALL 'kxdfhei1' USING DFHEIV0
  4018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4019
  4020
  4021     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4022     MOVE PI-FILE-SEQ-NO (NDX)    TO  PYAJ-FILE-SEQ-NO.
  4023     MOVE PI-REC-TYPE (NDX)       TO  PYAJ-RECORD-TYPE.
  4024
  4025
  4026* EXEC CICS READ
  4027*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4028*        DATASET  (PYAJ-FILE-ID)
  4029*        RIDFLD   (ERPYAJ-KEY)
  4030*        UPDATE
  4031*    END-EXEC.
  4032*    MOVE '&"S        EU         (   #00003872' TO DFHEIV0
  4033     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4034     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4035     MOVE X'2020233030303033383732' TO DFHEIV0(25:11)
  4036     CALL 'kxdfhei1' USING DFHEIV0,
  4037           PYAJ-FILE-ID,
  4038           DFHEIV20,
  4039           DFHEIV99,
  4040           ERPYAJ-KEY,
  4041           DFHEIV99,
  4042           DFHEIV99,
  4043           DFHEIV99
  4044     SET ADDRESS OF PENDING-PAY-ADJ TO
  4045         DFHEIV20
  4046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4047
  4048
  4049
  4050     IF RTYPE-LEN (PINDX)  GREATER THAN +0
  4051        IF RTYPE (PINDX) NOT = PY-RECORD-TYPE
  4052            MOVE PENDING-PAY-ADJ TO WS-SAVE-ERPYAJ
  4053            PERFORM 2190-CHANGE-RECORD-TYPE THRU 2190-EXIT
  4054            MOVE RTYPE (PINDX)     TO  PI-FRST-RECORD-TYPE.
  4055
  4056     IF AMT-LEN (PINDX) NOT = ZEROS
  4057         IF AMT (PINDX) = ZEROS
  4058             IF PY-CHECK-WRITTEN-DT = LOW-VALUES
  4059                 GO TO 2120-DELETE-RECORD
  4060             ELSE
  4061                 MOVE ER-2244       TO  EMI-ERROR
  4062                 MOVE -1            TO  AMT-LEN (PINDX)
  4063                 MOVE AL-UNBON      TO  AMT-ATTRB (PINDX)
  4064                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4065                 MOVE PY-ENTRY-AMT  TO  AMTO (PINDX)
  4066
  4067* EXEC CICS UNLOCK
  4068*                    DATASET  (PYAJ-FILE-ID)
  4069*                END-EXEC
  4070*    MOVE '&*                    #   #00003896' TO DFHEIV0
  4071     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL633.cbl
  4072     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4073     MOVE X'2020233030303033383936' TO DFHEIV0(25:11)
  4074     CALL 'kxdfhei1' USING DFHEIV0,
  4075           PYAJ-FILE-ID,
  4076           DFHEIV99
  4077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4078                 GO TO 8200-SEND-DATAONLY.
  4079
  4080     MOVE 'B'                    TO  JP-RECORD-TYPE.
  4081     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4082     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4083
  4084     PERFORM 8400-LOG-JOURNAL-RECORD.
  4085
  4086     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4087     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4088     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT.
  4089
  4090     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  4091         MOVE GL-ACCT (PINDX)    TO  PY-GL-ACCOUNT.
  4092     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  4093         MOVE GL-STATE (PINDX)   TO  PY-GL-STATE.
  4094     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  4095         MOVE GL-CANC (PINDX)    TO  PY-GL-CANC-SW.
  4096     IF GL-COMM-LEN (PINDX) NOT = ZEROS
  4097         MOVE GL-COMM (PINDX)    TO  PY-GL-COMMENT.
  4098     IF AMT-LEN (PINDX) NOT = ZEROS
  4099         MOVE AMT (PINDX)        TO  PY-ENTRY-AMT.
  4100
  4101     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  4102         MOVE VOID-SW (PINDX)    TO  PY-VOID-SW.
  4103
  4104     IF SDTE-LEN (PINDX) NOT = ZEROS
  4105        SET PINDEX               TO  PINDX
  4106        MOVE WS-EOM-DT (PINDEX)  TO  PY-CREDIT-SELECT-DT.
  4107
  4108     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4109     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4110     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4111
  4112
  4113* EXEC CICS REWRITE
  4114*        DATASET  (PYAJ-FILE-ID)
  4115*        FROM     (PENDING-PAY-ADJ)
  4116*    END-EXEC.
  4117     MOVE LENGTH OF
  4118      PENDING-PAY-ADJ
  4119       TO DFHEIV11
  4120*    MOVE '&& L                  %   #00003933' TO DFHEIV0
  4121     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4122     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4123     MOVE X'2020233030303033393333' TO DFHEIV0(25:11)
  4124     CALL 'kxdfhei1' USING DFHEIV0,
  4125           PYAJ-FILE-ID,
  4126           PENDING-PAY-ADJ,
  4127           DFHEIV11,
  4128           DFHEIV99
  4129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL633.cbl
  4130
  4131
  4132     PERFORM 8400-LOG-JOURNAL-RECORD.
  4133
  4134     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL633.cbl
  4136 2110-ADD-RECORD.
  4137
  4138* EXEC CICS GETMAIN
  4139*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4140*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4141*        INITIMG  (GETMAIN-SPACE)
  4142*    END-EXEC.
  4143*    MOVE ',"IL                  $   #00003943' TO DFHEIV0
  4144     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4145     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4146     MOVE X'2020233030303033393433' TO DFHEIV0(25:11)
  4147     CALL 'kxdfhei1' USING DFHEIV0,
  4148           DFHEIV20,
  4149           ERPYAJ-RECORD-LENGTH,
  4150           GETMAIN-SPACE
  4151     SET ADDRESS OF PENDING-PAY-ADJ TO
  4152         DFHEIV20
  4153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4154
  4155
  4156     MOVE 'PY'                   TO  PY-RECORD-ID.
  4157     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  4158     MOVE PI-SAV-CARRIER         TO  PY-CARRIER.
  4159     MOVE PI-SAV-GROUPING        TO  PY-GROUPING.
  4160     MOVE PI-SAV-FIN-RESP        TO  PY-FIN-RESP.
  4161     MOVE PI-SAV-ACCOUNT         TO  PY-ACCOUNT.
  4162
  4163     ADD +1                      TO  WORK-SEQ-NO.
  4164     MOVE WORK-SEQ-NO            TO  PY-FILE-SEQ-NO.
  4165
  4166     MOVE GL-ACCT (PINDX)        TO  PY-GL-ACCOUNT.
  4167     MOVE GL-STATE (PINDX)       TO  PY-GL-STATE.
  4168     MOVE GL-CANC (PINDX)        TO  PY-GL-CANC-SW.
  4169     MOVE GL-COMM (PINDX)        TO  PY-GL-COMMENT.
  4170
  4171     MOVE RTYPE (PINDX)          TO  PY-RECORD-TYPE.
  4172     MOVE AMT (PINDX)            TO  PY-ENTRY-AMT.
  4173     IF CO-TYPE = 'B' OR 'A' OR 'G'
  4174        MOVE CO-TYPE             TO  PY-ERCOMP-TYPE
  4175     END-IF
  4176     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4177     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4178     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT
  4179                                     PY-INPUT-DT.
  4180     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  4181                                     PY-CHECK-QUE-SEQUENCE.
  4182     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  4183                                     PY-BILLED-DATE
  4184                                     PY-AR-DATE
  4185                                     PY-REPORTED-DT
  4186                                     PY-CHECK-WRITTEN-DT.
  4187     IF SDTE-LEN (PINDX) = ZEROS
  4188         MOVE PI-CR-MONTH-END-DT TO  PY-CREDIT-SELECT-DT
  4189         GO TO 2115-WRITE-REC
  4190     END-IF.
  4191
  4192     IF SDTE (PINDX) IS NUMERIC
  4193         MOVE SDTE (PINDX)   TO  DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL633.cbl
  4194         MOVE '4'            TO  DC-OPTION-CODE
  4195         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4196         IF DATE-CONVERSION-ERROR
  4197             MOVE PI-CR-MONTH-END-DT
  4198                             TO  PY-CREDIT-SELECT-DT
  4199         ELSE
  4200             MOVE DC-BIN-DATE-1
  4201                             TO  PY-CREDIT-SELECT-DT
  4202         END-IF
  4203     ELSE
  4204         MOVE PI-CR-MONTH-END-DT
  4205                             TO  PY-CREDIT-SELECT-DT
  4206     END-IF
  4207
  4208     IF PI-SAV-FILE-SEQ-NO NOT GREATER THAN ZEROS
  4209         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4210         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4211
  4212     IF FIRST-ADD AND END-OF-ACCT-FULL-PAGE
  4213         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4214         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4215
  4216     MOVE 'N'                    TO  FIRST-ADD-SW.
  4217
  4218     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4219     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4220     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4221 2115-WRITE-REC.
  4222
  4223* EXEC CICS WRITE
  4224*        DATASET  (PYAJ-FILE-ID)
  4225*        FROM     (PENDING-PAY-ADJ)
  4226*        RIDFLD   (PY-CONTROL-PRIMARY)
  4227*    END-EXEC.
  4228     MOVE LENGTH OF
  4229      PENDING-PAY-ADJ
  4230       TO DFHEIV11
  4231*    MOVE '&$ L                  ''   #00004015' TO DFHEIV0
  4232     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4233     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4234     MOVE X'2020233030303034303135' TO DFHEIV0(25:11)
  4235     CALL 'kxdfhei1' USING DFHEIV0,
  4236           PYAJ-FILE-ID,
  4237           PENDING-PAY-ADJ,
  4238           DFHEIV11,
  4239           PY-CONTROL-PRIMARY,
  4240           DFHEIV99,
  4241           DFHEIV99
  4242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4243
  4244
  4245     PERFORM 8400-LOG-JOURNAL-RECORD.
  4246
  4247     GO TO 2100-UPDATE-LOOP.
  4248
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL633.cbl
  4250 2120-DELETE-RECORD.
  4251     IF PY-RECORD-TYPE NOT = 'C'
  4252         GO TO 2120-DELETE-CONT.
  4253
  4254     IF PY-CHECK-QUE-CONTROL = ZEROS
  4255       AND PY-CHECK-QUE-SEQUENCE = ZEROS
  4256         GO TO 2120-DELETE-CONT.
  4257
  4258
  4259* EXEC CICS HANDLE CONDITION
  4260*        NOTFND  (2120-DELETE-CONT)
  4261*    END-EXEC.
  4262*    MOVE '"$I                   ! & #00004034' TO DFHEIV0
  4263     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4265     MOVE X'2620233030303034303334' TO DFHEIV0(25:11)
  4266     CALL 'kxdfhei1' USING DFHEIV0
  4267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4268
  4269
  4270     MOVE PY-COMPANY-CD          TO  CHKQ-COMPANY-CD.
  4271     MOVE PY-CHECK-QUE-CONTROL   TO  CHKQ-CONTROL-NUMBER.
  4272     MOVE PY-CHECK-QUE-SEQUENCE  TO  CHKQ-SEQUENCE-NUMBER.
  4273
  4274
  4275* EXEC CICS READ
  4276*        SET      (ADDRESS OF CHECK-QUE)
  4277*        DATASET  (CHKQ-FILE-ID)
  4278*        RIDFLD   (ERCHKQ-KEY)
  4279*        UPDATE
  4280*    END-EXEC.
  4281*    MOVE '&"S        EU         (   #00004042' TO DFHEIV0
  4282     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4283     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4284     MOVE X'2020233030303034303432' TO DFHEIV0(25:11)
  4285     CALL 'kxdfhei1' USING DFHEIV0,
  4286           CHKQ-FILE-ID,
  4287           DFHEIV20,
  4288           DFHEIV99,
  4289           ERCHKQ-KEY,
  4290           DFHEIV99,
  4291           DFHEIV99,
  4292           DFHEIV99
  4293     SET ADDRESS OF CHECK-QUE TO
  4294         DFHEIV20
  4295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4296
  4297
  4298*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4299*    MOVE CHKQ-FILE-ID           TO  JP-FILE-ID.
  4300*    MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4301*
  4302*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4303
  4304
  4305* EXEC CICS DELETE
  4306*        DATASET  (CHKQ-FILE-ID)
  4307*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL633.cbl
  4308*    MOVE '&(                    &   #00004055' TO DFHEIV0
  4309     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4310     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4311     MOVE X'2020233030303034303535' TO DFHEIV0(25:11)
  4312     CALL 'kxdfhei1' USING DFHEIV0,
  4313           CHKQ-FILE-ID,
  4314           DFHEIV99,
  4315           DFHEIV99,
  4316           DFHEIV99,
  4317           DFHEIV99
  4318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4319
  4320
  4321 2120-DELETE-CONT.
  4322*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4323*    MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4324*    MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4325*
  4326*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4327
  4328     IF PI-SAV-ENDING-PYAJ-KEY = ERPYAJ-KEY
  4329         MOVE ZEROS              TO  PI-FRST-FILE-SEQ-NO
  4330         MOVE SPACE              TO  PI-FRST-RECORD-TYPE
  4331         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4332                                     PI-SAV-ACCT-NET
  4333                                     PI-SAV-PREV-AMT
  4334                                     PI-SAV-PREV-NET.
  4335
  4336
  4337* EXEC CICS DELETE
  4338*        DATASET(PYAJ-FILE-ID)
  4339*    END-EXEC.
  4340*    MOVE '&(                    &   #00004074' TO DFHEIV0
  4341     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4342     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4343     MOVE X'2020233030303034303734' TO DFHEIV0(25:11)
  4344     CALL 'kxdfhei1' USING DFHEIV0,
  4345           PYAJ-FILE-ID,
  4346           DFHEIV99,
  4347           DFHEIV99,
  4348           DFHEIV99,
  4349           DFHEIV99
  4350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4351
  4352
  4353     GO TO 2100-UPDATE-LOOP.
  4354
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL633.cbl
  4356
  4357 2190-CHANGE-RECORD-TYPE.
  4358
  4359*    MOVE 'D'                   TO  JP-RECORD-TYPE.
  4360*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4361*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4362*
  4363*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4364
  4365
  4366* EXEC CICS DELETE
  4367*        DATASET(PYAJ-FILE-ID)
  4368*    END-EXEC.
  4369*    MOVE '&(                    &   #00004090' TO DFHEIV0
  4370     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4371     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4372     MOVE X'2020233030303034303930' TO DFHEIV0(25:11)
  4373     CALL 'kxdfhei1' USING DFHEIV0,
  4374           PYAJ-FILE-ID,
  4375           DFHEIV99,
  4376           DFHEIV99,
  4377           DFHEIV99,
  4378           DFHEIV99
  4379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4380
  4381
  4382
  4383* EXEC CICS GETMAIN
  4384*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4385*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4386*        INITIMG  (GETMAIN-SPACE)
  4387*    END-EXEC.
  4388*    MOVE ',"IL                  $   #00004094' TO DFHEIV0
  4389     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4390     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4391     MOVE X'2020233030303034303934' TO DFHEIV0(25:11)
  4392     CALL 'kxdfhei1' USING DFHEIV0,
  4393           DFHEIV20,
  4394           ERPYAJ-RECORD-LENGTH,
  4395           GETMAIN-SPACE
  4396     SET ADDRESS OF PENDING-PAY-ADJ TO
  4397         DFHEIV20
  4398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4399
  4400
  4401*    MOVE JP-RECORD-AREA        TO  PENDING-PAY-ADJ.
  4402*    MOVE ERPYAJ-KEY            TO  PY-CONTROL-PRIMARY.
  4403
  4404     MOVE WS-SAVE-ERPYAJ        TO  PENDING-PAY-ADJ
  4405     MOVE RTYPE (PINDX)         TO  PY-RECORD-TYPE
  4406                                    PYAJ-RECORD-TYPE.
  4407
  4408
  4409* EXEC CICS HANDLE CONDITION
  4410*        DUPREC (2190-DUP-RECORD)
  4411*    END-EXEC.
  4412*    MOVE '"$%                   ! '' #00004107' TO DFHEIV0
  4413     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL633.cbl
  4414     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4415     MOVE X'2720233030303034313037' TO DFHEIV0(25:11)
  4416     CALL 'kxdfhei1' USING DFHEIV0
  4417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4418
  4419
  4420*    MOVE 'A'                   TO  JP-RECORD-TYPE.
  4421*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4422*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4423
  4424 2190-RETRY-WRITE.
  4425
  4426
  4427* EXEC CICS WRITE
  4428*        DATASET  (PYAJ-FILE-ID)
  4429*        FROM     (PENDING-PAY-ADJ)
  4430*        RIDFLD   (PY-CONTROL-PRIMARY)
  4431*    END-EXEC.
  4432     MOVE LENGTH OF
  4433      PENDING-PAY-ADJ
  4434       TO DFHEIV11
  4435*    MOVE '&$ L                  ''   #00004117' TO DFHEIV0
  4436     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4437     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4438     MOVE X'2020233030303034313137' TO DFHEIV0(25:11)
  4439     CALL 'kxdfhei1' USING DFHEIV0,
  4440           PYAJ-FILE-ID,
  4441           PENDING-PAY-ADJ,
  4442           DFHEIV11,
  4443           PY-CONTROL-PRIMARY,
  4444           DFHEIV99,
  4445           DFHEIV99
  4446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4447
  4448
  4449*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4450
  4451
  4452* EXEC CICS READ
  4453*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4454*        DATASET  (PYAJ-FILE-ID)
  4455*        RIDFLD   (ERPYAJ-KEY)
  4456*        UPDATE
  4457*    END-EXEC.
  4458*    MOVE '&"S        EU         (   #00004125' TO DFHEIV0
  4459     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4460     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4461     MOVE X'2020233030303034313235' TO DFHEIV0(25:11)
  4462     CALL 'kxdfhei1' USING DFHEIV0,
  4463           PYAJ-FILE-ID,
  4464           DFHEIV20,
  4465           DFHEIV99,
  4466           ERPYAJ-KEY,
  4467           DFHEIV99,
  4468           DFHEIV99,
  4469           DFHEIV99
  4470     SET ADDRESS OF PENDING-PAY-ADJ TO
  4471         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL633.cbl
  4472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4473
  4474
  4475     GO TO 2190-EXIT.
  4476
  4477 2190-DUP-RECORD.
  4478
  4479     COMPUTE PY-FILE-SEQ-NO = PY-FILE-SEQ-NO + 1.
  4480
  4481     GO TO 2190-RETRY-WRITE.
  4482
  4483 2190-EXIT.
  4484     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL633.cbl
  4486
  4487 2200-UPDATE-COMPLETE.
  4488     IF EIBAID = DFHPF1
  4489         GO TO 4000-BROWSE-FRWD.
  4490
  4491     IF EIBAID = DFHPF2
  4492         GO TO 4100-BROWSE-BKWD.
  4493
  4494     MOVE LOW-VALUES             TO  EL633AI.
  4495
  4496     MOVE ER-0000                TO  EMI-ERROR.
  4497     MOVE -1                     TO  MAINTL.
  4498
  4499     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4500
  4501     MOVE PI-FRST-FILE-SEQ-NO    TO  PI-SAV-FILE-SEQ-NO.
  4502     MOVE PI-FRST-RECORD-TYPE    TO  PI-SAV-RECORD-TYPE.
  4503
  4504*    GO TO 4000-BROWSE-FRWD.
  4505
  4506*    GO TO 8100-SEND-INITIAL-MAP.
  4507
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL633.cbl
  4509 4000-BROWSE-FRWD.
  4510     MOVE '1'                     TO  PI-PREV-PFKEY.
  4511     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4512
  4513     IF EIBAID = DFHPF1
  4514         IF PAGE-FULL
  4515             MOVE PI-FILE-SEQ-NO (PI-FULL-INDX)
  4516                                      TO  PYAJ-FILE-SEQ-NO
  4517             MOVE HIGH-VALUES         TO  PYAJ-RECORD-TYPE
  4518             MOVE 'N'                 TO  PYAJ-READ-SW
  4519             MOVE PI-SAV-ACCT-AMT     TO  TOTAL-ACCT-AMT
  4520             MOVE PI-SAV-ACCT-NET     TO  TOTAL-ACCT-NET
  4521             MOVE PI-SAV-ACCT-AMT     TO  PI-SAV-PREV-AMT
  4522             MOVE PI-SAV-ACCT-NET     TO  PI-SAV-PREV-NET
  4523         ELSE
  4524             MOVE ZEROS               TO  PI-SAV-ACCT-AMT
  4525                                          PI-SAV-ACCT-NET
  4526                                          PI-SAV-PREV-AMT
  4527                                          PI-SAV-PREV-NET
  4528             MOVE 'Y'                 TO  PI-PAGE-SW
  4529             IF NOT END-OF-FILE
  4530                 MOVE 99999999        TO  PYAJ-FILE-SEQ-NO
  4531                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4532             END-IF
  4533             IF TOP-OF-FILE
  4534                 MOVE SPACES          TO  PI-PYAJ-FILE-SW
  4535                 MOVE ZEROS           TO  PYAJ-FILE-SEQ-NO
  4536                 MOVE SPACES          TO  PYAJ-RECORD-TYPE
  4537             ELSE
  4538                 MOVE -1              TO  PYAJ-FILE-SEQ-NO
  4539                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4540     ELSE
  4541         MOVE PI-SAV-PREV-AMT         TO  TOTAL-ACCT-AMT
  4542         MOVE PI-SAV-PREV-NET         TO  TOTAL-ACCT-NET
  4543         IF MAINTI = 'S'
  4544             MOVE ZEROS               TO  PYAJ-FILE-SEQ-NO
  4545             MOVE SPACES              TO  PYAJ-RECORD-TYPE.
  4546
  4547
  4548     MOVE SPACE                  TO  PI-PYAJ-FILE-SW.
  4549
  4550     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4551         MOVE PI-CARRIER-SECURITY  TO  PYAJ-CARRIER.
  4552
  4553 4000-BROWSE-FRWD-FOR-PREV.
  4554*    IF END-OF-FILE
  4555*        IF EIBAID = DFHPF1
  4556*           IF PI-TOTAL-DISPLAYED
  4557*              NEXT SENTENCE
  4558*           ELSE
  4559*              MOVE -1                 TO  MAINTL
  4560*              MOVE ER-2237            TO  EMI-ERROR
  4561*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4562*              MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4563*              SET PINDX               TO  +2
  4564*              MOVE 'TOTAL'            TO  COMM (PINDX)
  4565*              MOVE PI-SAV-ACCT-AMT    TO  AMTO (PINDX)
  4566*              SET PINDEX UP BY 1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL633.cbl
  4567*              MOVE 'NET TOTAL'        TO  COMM (PINDX)
  4568*              MOVE PI-SAV-ACCT-NET    TO  AMTO (PINDX)
  4569*              MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4570*                                          PI-SAV-ACCT-NET
  4571*              GO TO 8100-SEND-INITIAL-MAP.
  4572*
  4573*     IF END-OF-FILE
  4574*        IF EIBAID = DFHPF1
  4575*           MOVE -1             TO  MAINTL
  4576*           MOVE ER-2237        TO  EMI-ERROR
  4577*           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4578*           GO TO 8200-SEND-DATAONLY.
  4579*
  4580     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4581
  4582     IF NO-RECORDS
  4583        MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4584        MOVE LOW-VALUES         TO  EL633AO
  4585        MOVE ER-2239            TO  EMI-ERROR
  4586        MOVE -1                 TO  MAINTL
  4587        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4588        GO TO 8100-SEND-INITIAL-MAP.
  4589
  4590     IF NOT-OPEN
  4591         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4592
  4593     MOVE LOW-VALUES             TO  EL633AO.
  4594     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4595
  4596     PERFORM 6000-READ-AND-FORMAT-SCREEN  THRU  6200-EXIT
  4597          VARYING  PINDX  FROM  1  BY  1
  4598             UNTIL  END-OF-ACCT
  4599                 OR  END-OF-FILE
  4600                     OR  PAGE-FULL
  4601                         OR  NO-RECORDS.
  4602
  4603     IF NO-RECORDS
  4604         MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4605         MOVE LOW-VALUES         TO  EL633AO
  4606         MOVE ER-2239            TO  EMI-ERROR
  4607         MOVE -1                 TO  MAINTL
  4608         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4609         GO TO 8100-SEND-INITIAL-MAP.
  4610
  4611     IF END-OF-FILE
  4612         IF EIBAID = DFHPF2
  4613             MOVE ER-2238        TO  EMI-ERROR
  4614             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4615             MOVE 'T'            TO  PI-PYAJ-FILE-SW
  4616         ELSE
  4617             MOVE ER-2237        TO  EMI-ERROR
  4618             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4619
  4620     MOVE 'S'                    TO  PI-PREV-FUNCTION
  4621                                     PI-SAV-FUNCTION.
  4622
  4623     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL633.cbl
  4625 4100-BROWSE-BKWD.
  4626     MOVE SPACE                   TO  PI-PYAJ-FILE-SW
  4627                                      PI-TOTAL-DISPLAYED-SW.
  4628     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4629     MOVE ZEROS                   TO  PYAJ-FILE-SEQ-NO.
  4630     MOVE ZEROS                   TO  PYAJ-RECORD-TYPE.
  4631     MOVE ZEROS                   TO  PI-SAV-ACCT-AMT
  4632                                      PI-SAV-ACCT-NET
  4633                                      PI-SAV-PREV-AMT
  4634                                      PI-SAV-PREV-NET.
  4635
  4636     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4637
  4638     IF NO-RECORDS
  4639         MOVE SPACES             TO  PI-PYAJ-FILE-SW
  4640         MOVE LOW-VALUES         TO  EL633AO
  4641         MOVE ER-2239            TO  EMI-ERROR
  4642         MOVE -1                 TO  MAINTL
  4643         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4644         GO TO 8100-SEND-INITIAL-MAP.
  4645
  4646     IF NOT-OPEN
  4647         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4648
  4649
  4650* EXEC CICS READNEXT
  4651*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4652*        DATASET  (PYAJ-FILE-ID)
  4653*        RIDFLD   (ERPYAJ-KEY)
  4654*    END-EXEC.
  4655     MOVE 0
  4656       TO DFHEIV11
  4657*    MOVE '&.S                   )   #00004306' TO DFHEIV0
  4658     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4659     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4660     MOVE X'2020233030303034333036' TO DFHEIV0(25:11)
  4661     CALL 'kxdfhei1' USING DFHEIV0,
  4662           PYAJ-FILE-ID,
  4663           DFHEIV20,
  4664           DFHEIV99,
  4665           ERPYAJ-KEY,
  4666           DFHEIV99,
  4667           DFHEIV11,
  4668           DFHEIV99,
  4669           DFHEIV99
  4670     SET ADDRESS OF PENDING-PAY-ADJ TO
  4671         DFHEIV20
  4672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4673
  4674
  4675     IF FIRST-PAGE OR
  4676        PI-PREV-PFKEY = '2'
  4677         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT
  4678         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT.
  4679
  4680     PERFORM 5200-END-BROWSE  THRU  5200-EXIT.
  4681
  4682     MOVE ZEROS                  TO  PYAJ-FILE-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL633.cbl
  4683     MOVE SPACES                 TO  PYAJ-RECORD-TYPE.
  4684     MOVE '2'                     TO  PI-PREV-PFKEY.
  4685
  4686     GO TO 4000-BROWSE-FRWD-FOR-PREV.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL633.cbl
  4688 5000-START-BROWSE.
  4689
  4690* EXEC CICS HANDLE CONDITION
  4691*        NOTOPEN  (5010-NOT-OPEN)
  4692*        NOTFND   (5020-NO-RECORDS)
  4693*        ENDFILE  (5020-NO-RECORDS)
  4694*    END-EXEC.
  4695*    MOVE '"$JI''                 ! ( #00004326' TO DFHEIV0
  4696     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4697     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4698     MOVE X'2820233030303034333236' TO DFHEIV0(25:11)
  4699     CALL 'kxdfhei1' USING DFHEIV0
  4700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4701
  4702
  4703
  4704* EXEC CICS STARTBR
  4705*        DATASET  (PYAJ-FILE-ID)
  4706*        RIDFLD   (ERPYAJ-KEY)
  4707*    END-EXEC.
  4708     MOVE 0
  4709       TO DFHEIV11
  4710*    MOVE '&,         G          &   #00004332' TO DFHEIV0
  4711     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4712     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4713     MOVE X'2020233030303034333332' TO DFHEIV0(25:11)
  4714     CALL 'kxdfhei1' USING DFHEIV0,
  4715           PYAJ-FILE-ID,
  4716           ERPYAJ-KEY,
  4717           DFHEIV99,
  4718           DFHEIV11,
  4719           DFHEIV99
  4720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4721
  4722
  4723     GO TO 5030-EXIT.
  4724
  4725 5010-NOT-OPEN.
  4726     MOVE 'Z'                    TO  PI-PYAJ-FILE-SW.
  4727
  4728     GO TO 5030-EXIT.
  4729
  4730 5020-NO-RECORDS.
  4731     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4732     MOVE 'Y'                    TO  PI-PYAJ-FILE-SW.
  4733
  4734 5030-EXIT.
  4735     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL633.cbl
  4737 5100-READ-PREVIOUS.
  4738
  4739* EXEC CICS HANDLE CONDITION
  4740*        ENDFILE  (5110-END-OF-FILE)
  4741*        NOTFND   (5110-END-OF-FILE)
  4742*    END-EXEC.
  4743*    MOVE '"$''I                  ! ) #00004352' TO DFHEIV0
  4744     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4745     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4746     MOVE X'2920233030303034333532' TO DFHEIV0(25:11)
  4747     CALL 'kxdfhei1' USING DFHEIV0
  4748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4749
  4750
  4751
  4752* EXEC CICS READPREV
  4753*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4754*        DATASET  (PYAJ-FILE-ID)
  4755*        RIDFLD   (ERPYAJ-KEY)
  4756*    END-EXEC.
  4757     MOVE 0
  4758       TO DFHEIV11
  4759*    MOVE '&0S                   )   #00004357' TO DFHEIV0
  4760     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4761     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4762     MOVE X'2020233030303034333537' TO DFHEIV0(25:11)
  4763     CALL 'kxdfhei1' USING DFHEIV0,
  4764           PYAJ-FILE-ID,
  4765           DFHEIV20,
  4766           DFHEIV99,
  4767           ERPYAJ-KEY,
  4768           DFHEIV99,
  4769           DFHEIV11,
  4770           DFHEIV99,
  4771           DFHEIV99
  4772     SET ADDRESS OF PENDING-PAY-ADJ TO
  4773         DFHEIV20
  4774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4775
  4776
  4777     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4778         IF PI-CARRIER-SECURITY = PY-CARRIER
  4779             NEXT SENTENCE
  4780         ELSE
  4781             GO TO 5110-END-OF-FILE.
  4782
  4783     GO TO 5120-EXIT.
  4784
  4785 5110-END-OF-FILE.
  4786     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  4787     MOVE ER-2238                TO  EMI-ERROR.
  4788     MOVE -1                     TO  PFENTERL.
  4789
  4790     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4791
  4792     GO TO 8200-SEND-DATAONLY.
  4793
  4794 5120-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL633.cbl
  4795     EXIT.
  4796
  4797 5200-END-BROWSE.
  4798
  4799* EXEC CICS ENDBR
  4800*        DATASET  (PYAJ-FILE-ID)
  4801*    END-EXEC.
  4802     MOVE 0
  4803       TO DFHEIV11
  4804*    MOVE '&2                    $   #00004384' TO DFHEIV0
  4805     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4806     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4807     MOVE X'2020233030303034333834' TO DFHEIV0(25:11)
  4808     CALL 'kxdfhei1' USING DFHEIV0,
  4809           PYAJ-FILE-ID,
  4810           DFHEIV11,
  4811           DFHEIV99
  4812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4813
  4814
  4815 5200-EXIT.
  4816     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL633.cbl
  4818 6000-READ-AND-FORMAT-SCREEN.
  4819
  4820* EXEC CICS HANDLE CONDITION
  4821*        ENDFILE  (6100-END-OF-FILE)
  4822*        NOTFND   (6100-END-OF-FILE)
  4823*    END-EXEC.
  4824*    MOVE '"$''I                  ! * #00004392' TO DFHEIV0
  4825     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4827     MOVE X'2A20233030303034333932' TO DFHEIV0(25:11)
  4828     CALL 'kxdfhei1' USING DFHEIV0
  4829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4830
  4831
  4832*    MOVE SPACES                 TO  PI-TOTAL-DISPLAYED-SW.
  4833*    INITIALIZE  PI-SEQ-NOS.
  4834
  4835 6010-READ-NEXT.
  4836
  4837
  4838* EXEC CICS READNEXT
  4839*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4840*        DATASET  (PYAJ-FILE-ID)
  4841*        RIDFLD   (ERPYAJ-KEY)
  4842*    END-EXEC.
  4843     MOVE 0
  4844       TO DFHEIV11
  4845*    MOVE '&.S                   )   #00004402' TO DFHEIV0
  4846     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4847     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4848     MOVE X'2020233030303034343032' TO DFHEIV0(25:11)
  4849     CALL 'kxdfhei1' USING DFHEIV0,
  4850           PYAJ-FILE-ID,
  4851           DFHEIV20,
  4852           DFHEIV99,
  4853           ERPYAJ-KEY,
  4854           DFHEIV99,
  4855           DFHEIV11,
  4856           DFHEIV99,
  4857           DFHEIV99
  4858     SET ADDRESS OF PENDING-PAY-ADJ TO
  4859         DFHEIV20
  4860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4861
  4862
  4863     IF PI-COMPANY-CD NOT = PY-COMPANY-CD
  4864       AND PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4865         GO TO 6100-END-OF-FILE.
  4866
  4867     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4868         IF PY-CARRIER NOT = PI-CARRIER-SECURITY
  4869             IF PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4870                 GO TO 6100-END-OF-FILE.
  4871
  4872     IF PYAJ-1ST-READ
  4873       AND EIBAID NOT = DFHENTER
  4874       AND NOT PAGE-FULL
  4875         MOVE PY-CONTROL-PRIMARY TO  PI-SAV-ENDING-PYAJ-KEY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL633.cbl
  4876         MOVE PY-CARRIER         TO  PI-CR-CARRIER
  4877         MOVE PY-GROUPING        TO  PI-CR-GROUPING
  4878         MOVE PY-FIN-RESP        TO  PI-CR-FIN-RESP
  4879         MOVE PY-ACCOUNT         TO  PI-CR-ACCOUNT.
  4880
  4881     IF PYAJ-1ST-READ
  4882         MOVE PI-SAV-ENDING-PYAJ-KEY
  4883                                 TO  PI-START-PYAJ-KEY.
  4884
  4885     IF PI-COMPANY-CD   = PY-COMPANY-CD  AND
  4886        PI-SAV-CARRIER  = PY-CARRIER     AND
  4887        PI-SAV-GROUPING = PY-GROUPING    AND
  4888        PI-SAV-FIN-RESP = PY-FIN-RESP    AND
  4889        PI-SAV-ACCOUNT  = PY-ACCOUNT
  4890         NEXT SENTENCE
  4891     ELSE
  4892         IF PYAJ-1ST-READ
  4893             MOVE 'Y'            TO  PI-PYAJ-FILE-SW
  4894             MOVE SPACE          TO  PYAJ-READ-SW
  4895             GO TO 6200-EXIT
  4896         ELSE
  4897             MOVE 'A'            TO  PI-PYAJ-FILE-SW
  4898             IF PINDX  IS LESS THAN  12
  4899                 SET PINDX  UP  BY  1
  4900                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4901                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4902                 SET PINDX  UP  BY  1
  4903                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4904                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4905                     GO TO 6200-EXIT
  4906             ELSE
  4907                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4908                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4909                 SET PINDX  UP  BY  1
  4910                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4911                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4912                 GO TO 6200-EXIT.
  4913
  4914*    MOVE ' '                    TO  PI-PYAJ-FILE-SW.
  4915
  4916     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  4917         GO TO 6000-READ-AND-FORMAT-SCREEN.
  4918
  4919*    SET PINDX  UP  BY +1.
  4920
  4921     SET WS-SAVE-INDEX-VALUE  TO  PINDX.
  4922
  4923     IF PINDX  IS GREATER THAN  13
  4924         MOVE 'F'                TO  PI-PYAJ-FILE-SW
  4925         MOVE +13                TO  PI-FULL-INDX
  4926         MOVE PI-FRST-FILE-SEQ-NO
  4927                                 TO  PI-LAST-FILE-SEQ-NO
  4928         MOVE PI-FRST-RECORD-TYPE
  4929                                 TO  PI-LAST-RECORD-TYPE
  4930         MOVE TOTAL-ACCT-AMT     TO  PI-SAV-ACCT-AMT
  4931         MOVE TOTAL-ACCT-NET     TO  PI-SAV-ACCT-NET
  4932         GO TO 6200-EXIT.
  4933
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL633.cbl
  4934     MOVE PY-FILE-SEQ-NO         TO  PI-PREV-FILE-SEQ-NO.
  4935     MOVE PY-RECORD-TYPE         TO  PI-PREV-RECORD-TYPE.
  4936
  4937     IF PYAJ-1ST-READ
  4938         MOVE SPACE              TO  PYAJ-READ-SW.
  4939
  4940     IF PINDX = 1
  4941         MOVE PI-PREV-FILE-SEQ-NO
  4942                                 TO  PI-FRST-FILE-SEQ-NO
  4943         MOVE PI-PREV-RECORD-TYPE
  4944                                 TO  PI-FRST-RECORD-TYPE
  4945         MOVE PI-PREV-FILE-SEQ-NO
  4946                                 TO  PI-LAST-FILE-SEQ-NO
  4947         MOVE PI-PREV-RECORD-TYPE
  4948                                 TO  PI-LAST-RECORD-TYPE.
  4949
  4950     SET NDX                     TO  PINDX.
  4951     SET WS-SAVE-NDX-VALUE       TO  NDX.
  4952
  4953     MOVE PY-FILE-SEQ-NO         TO  PI-FILE-SEQ-NO (NDX).
  4954
  4955     MOVE PY-GL-ACCOUNT          TO  GL-ACCT (PINDX).
  4956     MOVE PY-GL-STATE            TO  GL-STATE (PINDX).
  4957     MOVE PY-GL-CANC-SW          TO  GL-CANC (PINDX).
  4958     MOVE PY-GL-COMMENT          TO  GL-COMM (PINDX).
  4959     MOVE PY-ENTRY-AMT           TO  AMTO (PINDX).
  4960
  4961     ADD PY-ENTRY-AMT            TO  TOTAL-ACCT-AMT.
  4962
  4963     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'S' OR 'Z'
  4964         ADD PY-ENTRY-AMT        TO  TOTAL-ACCT-NET
  4965     ELSE
  4966         SUBTRACT PY-ENTRY-AMT  FROM  TOTAL-ACCT-NET.
  4967
  4968     MOVE PY-RECORD-TYPE         TO  RTYPE (PINDX)
  4969                                     PI-REC-TYPE (NDX).
  4970
  4971     IF PY-VOID-SW NOT = SPACE
  4972         MOVE PY-VOID-SW         TO  VOID-SW (PINDX).
  4973
  4974     IF PY-LAST-MAINT-DT = PREV-BIN-MAINT-DT
  4975         MOVE PREV-MAINT-DT      TO  MDTE (PINDX)
  4976     ELSE
  4977         MOVE PY-LAST-MAINT-DT   TO  DC-BIN-DATE-1
  4978                                     PREV-BIN-MAINT-DT
  4979         MOVE SPACE              TO  DC-OPTION-CODE
  4980         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4981* DAN    MOVE DC-GREG-DATE-1-EDIT
  4982         MOVE DC-GREG-DATE-1-MDY
  4983                                 TO  MDTE (PINDX)
  4984                                     PREV-MAINT-DT.
  4985
  4986*    IF PY-GL-COMMENT NOT = (LOW-VALUES OR SPACES OR ZEROS)
  4987     IF PY-GL-COMMENT NOT = (LOW-VALUES AND SPACES AND ZEROS)
  4988         INSPECT PY-GL-COMMENT CONVERTING LOW-VALUES TO SPACES
  4989         MOVE PY-GL-COMMENT      TO  GL-COMM (PINDX)
  4990*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
  4991*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL633.cbl
  4992     END-IF.
  4993
  4994     IF PY-BILLED-DATE NOT = LOW-VALUES
  4995         MOVE AL-SANOF           TO  GL-ACCT-ATTRB (PINDX)
  4996                                     AMT-ATTRB (PINDX)
  4997                                     VOID-SW-ATTRB (PINDX)
  4998         IF PY-BILLED-DATE = PREV-BIN-BL-DT
  4999             MOVE PREV-BL-DT     TO  BDTE (PINDX)
  5000         ELSE
  5001             MOVE PY-BILLED-DATE TO  DC-BIN-DATE-1
  5002                                     PREV-BIN-BL-DT
  5003             MOVE SPACE          TO  DC-OPTION-CODE
  5004             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5005* DAN        MOVE DC-GREG-DATE-1-EDIT
  5006             MOVE DC-GREG-DATE-1-MDY
  5007                                 TO  BDTE (PINDX)
  5008                                     PREV-BL-DT.
  5009
  5010     IF (PY-CHECK-ORIGIN-SW = LOW-VALUES OR SPACES OR 'G')
  5011         NEXT SENTENCE
  5012     ELSE
  5013         MOVE AL-SANOF           TO  RTYPE-ATTRB   (PINDX)
  5014                                     AMT-ATTRB     (PINDX).
  5015
  5016     IF PY-CREDIT-SELECT-DT NOT = LOW-VALUES
  5017         MOVE PY-CREDIT-SELECT-DT
  5018                                 TO  DC-BIN-DATE-1
  5019         MOVE SPACE              TO  DC-OPTION-CODE
  5020         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5021
  5022         MOVE DC-GREG-DATE-1-EDIT  TO  WS-GREG-STORE
  5023         MOVE WS-GS-MM             TO  WS-SS-MM
  5024         MOVE WS-GS-DD             TO  WS-SS-DD
  5025         MOVE WS-GS-YY             TO  WS-SS-YY
  5026         MOVE WS-SDTE-STORE        TO  SDTE (PINDX).
  5027     IF (PY-INPUT-DT NOT = WS-CURRENT-BIN-DT)
  5028        AND (PI-PROCESSOR-ID NOT = 'PEMA')
  5029         MOVE AL-SANOF           TO RTYPE-ATTRB    (PINDX)
  5030                                    AMT-ATTRB      (PINDX)
  5031                                    GL-ACCT-ATTRB  (PINDX)
  5032                                    GL-COMM-ATTRB  (PINDX)
  5033                                    VOID-SW-ATTRB  (PINDX)
  5034                                    GL-STATE-ATTRB (PINDX)
  5035                                    GL-CANC-ATTRB  (PINDX)
  5036                                    SDTE-ATTRB     (PINDX)
  5037
  5038     END-IF
  5039
  5040*    GO TO 6010-READ-NEXT.
  5041     GO TO 6200-EXIT.
  5042
  5043 6100-END-OF-FILE.
  5044     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  5045
  5046     IF PINDX  IS LESS THAN  12
  5047         SET PINDX  UP  BY  1
  5048         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5049         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL633.cbl
  5050         SET PINDX  UP  BY  1
  5051         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5052         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX)
  5053         MOVE 'Y'                TO  PI-TOTAL-DISPLAYED-SW
  5054     ELSE
  5055         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5056         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
  5057         SET PINDX  UP  BY  1
  5058         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5059         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX).
  5060
  5061 6200-EXIT.
  5062     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL633.cbl
  5064 7000-PYAJ-FILE-NOTOPEN.
  5065     MOVE -1                     TO  MAINTL.
  5066     MOVE ER-2232                TO  EMI-ERROR.
  5067
  5068     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5069
  5070     GO TO 8200-SEND-DATAONLY.
  5071
  5072 7100-COMP-FILE-NOTOPEN.
  5073     MOVE -1                     TO  MAINTL.
  5074     MOVE ER-2233                TO  EMI-ERROR.
  5075
  5076     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5077
  5078     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL633.cbl
  5080*
  5081*7100-COFA-FILE-NOTOPEN.
  5082*    MOVE -1                     TO PFENTERL.
  5083*    MOVE ER-2959                TO EMI-ERROR.
  5084*    PERFORM 9900-ERROR-FORMAT THRU
  5085*            9900-EXIT.
  5086*    GO TO 8200-SEND-DATAONLY.
  5087*
  5088 8100-SEND-INITIAL-MAP.
  5089     MOVE WS-CURRENT-DT          TO  DATEO.
  5090     MOVE EIBTIME                TO  TIME-IN.
  5091     MOVE TIME-OUT               TO  TIMEO.
  5092     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5093     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5094     MOVE -1                     TO  MAINTL.
  5095     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5096     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5097
  5098     IF EIBTRNID = TRANS-ID
  5099       OR EL640-TRANS-ID
  5100       OR EL642-TRANS-ID
  5101       OR EL652-TRANS-ID
  5102       OR EL6331-TRANS-ID
  5103         IF PI-SAV-ENDING-PYAJ-KEY NOT =  SPACES
  5104             MOVE PI-SAV-FUNCTION  TO  MAINTI
  5105             MOVE PI-SAV-CARRIER   TO  CARRIERO
  5106             MOVE PI-SAV-GROUPING  TO  GROUPO
  5107             MOVE PI-SAV-FIN-RESP  TO  FINRESPO
  5108             MOVE PI-SAV-ACCOUNT   TO  ACCTO
  5109             MOVE AL-UANON         TO  MAINTA
  5110                                       CARRIERA
  5111                                       GROUPA
  5112                                       FINRESPA
  5113                                       ACCTA
  5114         ELSE
  5115             NEXT SENTENCE.
  5116
  5117
  5118* EXEC CICS SEND
  5119*        MAP     (MAP-NAME)
  5120*        MAPSET  (MAPSET-NAME)
  5121*        FROM    (EL633AO)
  5122*        ERASE
  5123*        CURSOR
  5124*        END-EXEC.
  5125     MOVE LENGTH OF
  5126      EL633AO
  5127       TO DFHEIV12
  5128     MOVE -1
  5129       TO DFHEIV11
  5130*    MOVE '8$     CT  E    H L F ,   #00004662' TO DFHEIV0
  5131     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5132     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5133     MOVE X'2020233030303034363632' TO DFHEIV0(25:11)
  5134     CALL 'kxdfhei1' USING DFHEIV0,
  5135           MAP-NAME,
  5136           EL633AO,
  5137           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL633.cbl
  5138           MAPSET-NAME,
  5139           DFHEIV99,
  5140           DFHEIV99,
  5141           DFHEIV99,
  5142           DFHEIV11,
  5143           DFHEIV99,
  5144           DFHEIV99,
  5145           DFHEIV99
  5146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5147
  5148
  5149     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL633.cbl
  5151 8200-SEND-DATAONLY.
  5152     MOVE WS-CURRENT-DT          TO  DATEO.
  5153     MOVE EIBTIME                TO  TIME-IN.
  5154     MOVE TIME-OUT               TO  TIMEO.
  5155     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5156     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5157     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5158     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5159
  5160
  5161* EXEC CICS SEND
  5162*        MAP     (MAP-NAME)
  5163*        MAPSET  (MAPSET-NAME)
  5164*        FROM    (EL633AO)
  5165*        DATAONLY
  5166*        CURSOR
  5167*    END-EXEC.
  5168     MOVE LENGTH OF
  5169      EL633AO
  5170       TO DFHEIV12
  5171     MOVE -1
  5172       TO DFHEIV11
  5173*    MOVE '8$D    CT       H L F ,   #00004681' TO DFHEIV0
  5174     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5175     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5176     MOVE X'2020233030303034363831' TO DFHEIV0(25:11)
  5177     CALL 'kxdfhei1' USING DFHEIV0,
  5178           MAP-NAME,
  5179           EL633AO,
  5180           DFHEIV12,
  5181           MAPSET-NAME,
  5182           DFHEIV99,
  5183           DFHEIV99,
  5184           DFHEIV99,
  5185           DFHEIV11,
  5186           DFHEIV99,
  5187           DFHEIV99,
  5188           DFHEIV99
  5189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5190
  5191
  5192     GO TO 9100-RETURN-TRAN.
  5193
  5194 8300-SEND-TEXT.
  5195
  5196* EXEC CICS SEND TEXT
  5197*        FROM    (LOGOFF-TEXT)
  5198*        LENGTH  (LOGOFF-LENGTH)
  5199*        ERASE
  5200*        FREEKB
  5201*    END-EXEC.
  5202*    MOVE '8&      T  E F  H   F -   #00004692' TO DFHEIV0
  5203     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5204     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5205     MOVE X'2020233030303034363932' TO DFHEIV0(25:11)
  5206     CALL 'kxdfhei1' USING DFHEIV0,
  5207           LOGOFF-TEXT,
  5208           LOGOFF-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL633.cbl
  5209           DFHEIV99,
  5210           DFHEIV99,
  5211           DFHEIV99,
  5212           DFHEIV99,
  5213           DFHEIV99,
  5214           DFHEIV99,
  5215           DFHEIV99,
  5216           DFHEIV99,
  5217           DFHEIV99,
  5218           DFHEIV99
  5219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5220
  5221
  5222
  5223* EXEC CICS RETURN
  5224*    END-EXEC.
  5225*    MOVE '.(                    &   #00004699' TO DFHEIV0
  5226     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5227     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5228     MOVE X'2020233030303034363939' TO DFHEIV0(25:11)
  5229     CALL 'kxdfhei1' USING DFHEIV0,
  5230           DFHEIV99,
  5231           DFHEIV99,
  5232           DFHEIV99,
  5233           DFHEIV99,
  5234           DFHEIV99
  5235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5236
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL633.cbl
  5238 8400-LOG-JOURNAL-RECORD.
  5239*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5240*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  5241
  5242*    EXEC CICS JOURNAL
  5243*        JFILEID  (PI-JOURNAL-FILE-ID)
  5244*        JTYPEID  ('EL')
  5245*        FROM     (JOURNAL-RECORD)
  5246*        LENGTH   (223)
  5247*        END-EXEC.
  5248
  5249 8500-DATE-CONVERT.
  5250
  5251* EXEC CICS LINK
  5252*        PROGRAM   (LINK-CLDATCV)
  5253*        COMMAREA  (DATE-CONVERSION-DATA)
  5254*        LENGTH    (DC-COMM-LENGTH)
  5255*    END-EXEC.
  5256*    MOVE '."C                   ''   #00004714' TO DFHEIV0
  5257     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5258     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5259     MOVE X'2020233030303034373134' TO DFHEIV0(25:11)
  5260     CALL 'kxdfhei1' USING DFHEIV0,
  5261           LINK-CLDATCV,
  5262           DATE-CONVERSION-DATA,
  5263           DC-COMM-LENGTH,
  5264           DFHEIV99,
  5265           DFHEIV99,
  5266           DFHEIV99
  5267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5268
  5269
  5270 8500-EXIT.
  5271     EXIT.
  5272
  5273 8600-DEEDIT.
  5274
  5275* EXEC CICS BIF DEEDIT
  5276*        FIELD   (DEEDIT-FIELD)
  5277*        LENGTH  (11)
  5278*    END-EXEC.
  5279     MOVE 11
  5280       TO DFHEIV11
  5281*    MOVE '@"L                   #   #00004724' TO DFHEIV0
  5282     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5283     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5284     MOVE X'2020233030303034373234' TO DFHEIV0(25:11)
  5285     CALL 'kxdfhei1' USING DFHEIV0,
  5286           DEEDIT-FIELD,
  5287           DFHEIV11
  5288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5289
  5290
  5291 8600-EXIT.
  5292     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL633.cbl
  5294 8800-UNAUTHORIZED-ACCESS.
  5295     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  5296
  5297     GO TO 8300-SEND-TEXT.
  5298
  5299 8810-PF23.
  5300     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5301     MOVE XCTL-005               TO  PGM-NAME.
  5302
  5303     GO TO 9300-XCTL.
  5304
  5305 9100-RETURN-TRAN.
  5306     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  5307     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5308
  5309
  5310* EXEC CICS RETURN
  5311*        TRANSID   (TRANS-ID)
  5312*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5313*        LENGTH    (PI-COMM-LENGTH)
  5314*    END-EXEC.
  5315*    MOVE '.(CT                  &   #00004747' TO DFHEIV0
  5316     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5317     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5318     MOVE X'2020233030303034373437' TO DFHEIV0(25:11)
  5319     CALL 'kxdfhei1' USING DFHEIV0,
  5320           TRANS-ID,
  5321           PROGRAM-INTERFACE-BLOCK,
  5322           PI-COMM-LENGTH,
  5323           DFHEIV99,
  5324           DFHEIV99
  5325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5326
  5327
  5328 9200-RETURN-MAIN-MENU.
  5329     MOVE XCTL-626               TO  PGM-NAME.
  5330
  5331     GO TO 9300-XCTL.
  5332
  5333 9300-XCTL.
  5334
  5335* EXEC CICS XCTL
  5336*        PROGRAM   (PGM-NAME)
  5337*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5338*        LENGTH    (PI-COMM-LENGTH)
  5339*    END-EXEC.
  5340*    MOVE '.$C                   $   #00004759' TO DFHEIV0
  5341     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5342     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5343     MOVE X'2020233030303034373539' TO DFHEIV0(25:11)
  5344     CALL 'kxdfhei1' USING DFHEIV0,
  5345           PGM-NAME,
  5346           PROGRAM-INTERFACE-BLOCK,
  5347           PI-COMM-LENGTH
  5348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5349
  5350
  5351 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL633.cbl
  5352     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  5353
  5354     IF PI-RETURN-TO-PROGRAM = 'EL626'
  5355     MOVE SPACES                 TO  PI-CR-CONTROL-IN-PROGRESS
  5356                                     PI-SAV-COMP-CONTROL.
  5357
  5358     GO TO 9300-XCTL.
  5359
  5360 9500-PF12.
  5361     MOVE XCTL-010               TO  PGM-NAME.
  5362
  5363     GO TO 9300-XCTL.
  5364
  5365 9600-PGMID-ERROR.
  5366
  5367* EXEC CICS HANDLE CONDITION
  5368*        PGMIDERR  (8300-SEND-TEXT)
  5369*    END-EXEC.
  5370*    MOVE '"$L                   ! + #00004780' TO DFHEIV0
  5371     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5372     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5373     MOVE X'2B20233030303034373830' TO DFHEIV0(25:11)
  5374     CALL 'kxdfhei1' USING DFHEIV0
  5375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5376
  5377
  5378     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  5379     MOVE ' '                    TO  PI-ENTRY-CD-1.
  5380     MOVE XCTL-005               TO  PGM-NAME.
  5381     MOVE PGM-NAME               TO  LOGOFF-PGM.
  5382     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5383
  5384     GO TO 9300-XCTL.
  5385
  5386 9900-ERROR-FORMAT.
  5387     IF NOT EMI-ERRORS-COMPLETE
  5388         MOVE LINK-001           TO  PGM-NAME
  5389
  5390* EXEC CICS LINK
  5391*            PROGRAM   (PGM-NAME)
  5392*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  5393*            LENGTH    (EMI-COMM-LENGTH)
  5394*        END-EXEC.
  5395*    MOVE '."C                   ''   #00004795' TO DFHEIV0
  5396     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5397     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5398     MOVE X'2020233030303034373935' TO DFHEIV0(25:11)
  5399     CALL 'kxdfhei1' USING DFHEIV0,
  5400           PGM-NAME,
  5401           ERROR-MESSAGE-INTERFACE-BLOCK,
  5402           EMI-COMM-LENGTH,
  5403           DFHEIV99,
  5404           DFHEIV99,
  5405           DFHEIV99
  5406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5407
  5408
  5409 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL633.cbl
  5410     EXIT.
  5411
  5412 9990-ABEND.
  5413     MOVE LINK-004               TO  PGM-NAME.
  5414     MOVE DFHEIBLK               TO  EMI-LINE1.
  5415
  5416
  5417* EXEC CICS LINK
  5418*        PROGRAM   (PGM-NAME)
  5419*        COMMAREA  (EMI-LINE1)
  5420*        LENGTH    (72)
  5421*    END-EXEC.
  5422     MOVE 72
  5423       TO DFHEIV11
  5424*    MOVE '."C                   ''   #00004808' TO DFHEIV0
  5425     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5426     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5427     MOVE X'2020233030303034383038' TO DFHEIV0(25:11)
  5428     CALL 'kxdfhei1' USING DFHEIV0,
  5429           PGM-NAME,
  5430           EMI-LINE1,
  5431           DFHEIV11,
  5432           DFHEIV99,
  5433           DFHEIV99,
  5434           DFHEIV99
  5435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5436
  5437
  5438     MOVE -1                     TO  PFENTERL.
  5439
  5440     GO TO 8200-SEND-DATAONLY.
  5441
  5442 9995-SECURITY-VIOLATION.
  5443*                            COPY ELCSCTP.
  5444******************************************************************
  5445*                                                                *
  5446*                            ELCSCTP                             *
  5447*                            VMOD=2.001                          *
  5448*                                                                *
  5449*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5450******************************************************************
  5451
  5452
  5453     MOVE EIBDATE          TO SM-JUL-DATE.
  5454     MOVE EIBTRMID         TO SM-TERMID.
  5455     MOVE THIS-PGM         TO SM-PGM.
  5456     MOVE EIBTIME          TO TIME-IN.
  5457     MOVE TIME-OUT         TO SM-TIME.
  5458     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5459
  5460
  5461* EXEC CICS LINK
  5462*         PROGRAM  ('EL003')
  5463*         COMMAREA (SECURITY-MESSAGE)
  5464*         LENGTH   (80)
  5465*    END-EXEC.
  5466     MOVE 'EL003' TO DFHEIV1
  5467     MOVE 80
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL633.cbl
  5468       TO DFHEIV11
  5469*    MOVE '."C                   ''   #00004836' TO DFHEIV0
  5470     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5471     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5472     MOVE X'2020233030303034383336' TO DFHEIV0(25:11)
  5473     CALL 'kxdfhei1' USING DFHEIV0,
  5474           DFHEIV1,
  5475           SECURITY-MESSAGE,
  5476           DFHEIV11,
  5477           DFHEIV99,
  5478           DFHEIV99,
  5479           DFHEIV99
  5480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5481
  5482
  5483******************************************************************
  5484
  5485
  5486 9995-EXIT.
  5487     EXIT.
  5488
  5489
  5490 9999-DFHBACK SECTION.
  5491     MOVE '9%                    "   ' TO DFHEIV0
  5492     MOVE 'EL633' TO DFHEIV1
  5493     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5494     GOBACK.
  5495 9999-DFHEXIT.
  5496     IF DFHEIGDJ EQUAL 0001
  5497         NEXT SENTENCE
  5498     ELSE IF DFHEIGDJ EQUAL 2
  5499         GO TO 9600-PGMID-ERROR,
  5500               9990-ABEND
  5501         DEPENDING ON DFHEIGDI
  5502     ELSE IF DFHEIGDJ EQUAL 3
  5503         GO TO 0410-NO-COMP-MSTR,
  5504               7100-COMP-FILE-NOTOPEN
  5505         DEPENDING ON DFHEIGDI
  5506     ELSE IF DFHEIGDJ EQUAL 4
  5507         GO TO 0890-EXIT
  5508         DEPENDING ON DFHEIGDI
  5509     ELSE IF DFHEIGDJ EQUAL 5
  5510         GO TO 2110-ADD-RECORD
  5511         DEPENDING ON DFHEIGDI
  5512     ELSE IF DFHEIGDJ EQUAL 6
  5513         GO TO 2120-DELETE-CONT
  5514         DEPENDING ON DFHEIGDI
  5515     ELSE IF DFHEIGDJ EQUAL 7
  5516         GO TO 2190-DUP-RECORD
  5517         DEPENDING ON DFHEIGDI
  5518     ELSE IF DFHEIGDJ EQUAL 8
  5519         GO TO 5010-NOT-OPEN,
  5520               5020-NO-RECORDS,
  5521               5020-NO-RECORDS
  5522         DEPENDING ON DFHEIGDI
  5523     ELSE IF DFHEIGDJ EQUAL 9
  5524         GO TO 5110-END-OF-FILE,
  5525               5110-END-OF-FILE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL633.cbl
  5526         DEPENDING ON DFHEIGDI
  5527     ELSE IF DFHEIGDJ EQUAL 10
  5528         GO TO 6100-END-OF-FILE,
  5529               6100-END-OF-FILE
  5530         DEPENDING ON DFHEIGDI
  5531     ELSE IF DFHEIGDJ EQUAL 11
  5532         GO TO 8300-SEND-TEXT
  5533         DEPENDING ON DFHEIGDI.
  5534     MOVE '9%                    "   ' TO DFHEIV0
  5535     MOVE 'EL633' TO DFHEIV1
  5536     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5537     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5632     Code:       16683
