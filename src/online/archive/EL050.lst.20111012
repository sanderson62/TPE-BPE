* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page   1
* EL050.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL050.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page   2
* EL050.cbl
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39******************************************************************
    40 ENVIRONMENT DIVISION.
    41
    42 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page   3
* EL050.cbl
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46
    47 77  FILLER   PIC X(32) VALUE '********************************'.
    48 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    49 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    50
    51 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    52 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    53                                   USAGE POINTER.
    54 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    55 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    56 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    57                                   USAGE IS POINTER.
    58 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    59 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    60                                   USAGE IS POINTER.
    61 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    62 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    63                                   USAGE IS POINTER.
    64
    65 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    67                                   USAGE IS POINTER.
    68
    69*    COPY ELC50WS.
    70*****************************************************************
    71*                                                               *
    72*                            ELC50WS.                           *
    73*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    74*                            VMOD=2.061.                        *
    75*                                                               *
    76*   THIS IS THE WORKING STORAGE FOR EL050                       *
    77*                                   EL517                       *
    78*****************************************************************
    79******************************************************************
    80*                   C H A N G E   L O G
    81*
    82* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    83*-----------------------------------------------------------------
    84*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    85* EFFECTIVE    NUMBER
    86*-----------------------------------------------------------------
    87* 123102                   PEMA  ADD DCC PROCESSING
    88* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    89* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    90* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    91* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    92* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    93* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
    94* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
    95* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
    96* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
    97* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    98* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
    99* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   100* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   101* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page   4
* EL050.cbl
   102* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   103* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   104* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   105* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   106* 030309  CR2009021700001  PEMA  ADD ER-2883
   107* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   108* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   109* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   110* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   111* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   112* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   113* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   114* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   115* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   116*-----------------------------------------------------------------
   117
   118 01  WORK-AREAS.
   119
   120*****************************************************************
   121*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   122*****************************************************************
   123
   124     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   125     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   126     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   127     12  WS-NAME-EDIT-WORK-AREA.
   128         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   129         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   130             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   131         16  WS-WORK-NAME.
   132             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   133             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   134             20  FILLER           PIC X(10)     VALUE SPACES.
   135         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   136             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   137
   138*****************************************************************
   139*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   140*****************************************************************
   141
   142     12  WS-ERRESC-KEY.
   143         16 WS-ERRESC-SEARCH-KEY.
   144             20  WS-ERRESC-COMPANY-CD PIC  X.
   145             20  WS-ERRESC-CARRIER    PIC  X.
   146             20  WS-ERRESC-GROUP      PIC X(6).
   147             20  WS-ERRESC-STATE      PIC XX.
   148             20  WS-ERRESC-ACCOUNT    PIC X(10).
   149         16 WS-ERRESC-RESIDUAL-KEY.
   150             20  WS-ERRESC-AGENT      PIC X(10).
   151             20  WS-ERRESC-RES-STATE  PIC XX.
   152             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   153*                                          YYYYMMDD
   154     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   155     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   156
   157*RESIDENT STATE TAX MASTER(ERRESS)
   158*
   159     12  WS-ERRESS-KEY.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page   5
* EL050.cbl
   160         16  WS-ERRESS-COMPANY-CD      PIC  X.
   161         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   162         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   163         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   164*                                          YYYYMMDD
   165
   166     12  WS-CONTRACT-DATE              PIC 9(8).
   167*                                          YYYYMMDD
   168     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   169     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   170         16 WS-YEAR-YY                 PIC   9999.
   171         16 FILLER                     PIC 9(4).
   172*                                          YYYYMMDD
   173     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   174     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   175     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   176     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   177
   178     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   179         88  DPRB-1ST-TIME                      VALUE ' '.
   180
   181*****************************************************************
   182*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   183*****************************************************************
   184
   185     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   186     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   187     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   188     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   189     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   190     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   191     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   192     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   193     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   194     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   195         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   196         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   197     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   198         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   199         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   200     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   201
   202     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   203     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   204
   205     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   206     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   207     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   208     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   209     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   210     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   211     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   212     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   213     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   214     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   215     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   216     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   217     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page   6
* EL050.cbl
   218     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   219     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   220     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   221     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   222     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   223     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   224     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   225     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   228     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   229     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   230     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   231     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   232     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   233     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   236     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   237     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   238     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   239     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   240     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   241     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   242     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   243     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   244     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   245     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   246     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   247     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   248     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   249     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   250     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   251     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   252     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   253     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   254     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   255     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   256     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   257     12  WS-2671-SW               PIC X         VALUE SPACE.
   258     12  WS-2672-SW               PIC X         VALUE SPACE.
   259     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   260         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   261     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   262         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   263     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   264
   265     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   266         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   267         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   268         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   269         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   270
   271     12  WS-CREDIT-EDIT-CONTROLS.
   272         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   273         16  WS-MIN-AGE           PIC 99                VALUE  0.
   274         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   275         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page   7
* EL050.cbl
   276         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   277         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   278
   279     12  WS-SAVE-ALLOWABLE-BENEFIT.
   280         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   281         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   282         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   283         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   284         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   285         16  FILLER                      PIC XX.
   286
   287     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   288     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   289     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   290     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   291     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   292     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   293     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   294     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   295     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   296     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   297
   298     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   299     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   300     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   301     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   302     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   303     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   304     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   305     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   306         88  WS-REDUCING              VALUE 'R'.
   307         88  WS-LEVEL                 VALUE 'L' 'P'.
   308     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   309
   310     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   311     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   312     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   313     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   314     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   315     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   316     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   317     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   318
   319     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   320     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   321     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   322     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   323     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   324     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   325     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   326     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   327     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   328     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   329     12  WS-ACCT-SIG-SW.
   330         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   331         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   332     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   333     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page   8
* EL050.cbl
   334     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   335     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   336     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   337     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   338     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   339     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   340     12  WS-INITIALS.
   341         16  WS-INIT-1            PIC X         VALUE SPACES.
   342         16  WS-INIT-2            PIC X         VALUE SPACES.
   343
   344     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   345     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   346     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   347     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   348     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   349*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   350     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   351     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   352     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   353     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   354     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   355     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   356     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   357     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   358     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   359     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   360     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   361     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   362     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   363     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   364     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   365     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   366     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   367     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   368     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   369     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   370     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   371     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   372******** FLA
   373     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   374     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   375     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   376     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   377     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   378********
   379     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   380     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   381     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   382     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   383     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   384     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   385     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   386     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   387     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   388     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   389
   390     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   391         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page   9
* EL050.cbl
   392                                         '0' THRU '9'.
   393
   394     12  NUMBER-OF-MONTHS.
   395         16  SK-MO OCCURS 12 TIMES PIC X.
   396
   397     12  WS-WORK-DATE.
   398         16  WS-YEAR            PIC 99    VALUE 00.
   399         16  WS-MONTH           PIC 99    VALUE 00.
   400         16  WS-DAY             PIC 99    VALUE 00.
   401
   402     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   403     12  WS-WORK-CRIT-DEV       REDEFINES
   404         WS-WORK-LF-CRIT-PER    PIC X(03).
   405
   406     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   407     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   408
   409     12  WS-WORK-DATE-FROM.
   410         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   411         16  FILLER             PIC X  VALUE SPACE.
   412         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   413         16  FILLER             PIC X         VALUE SPACE.
   414         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   415
   416     12  WS-WORK-DATE-THRU.
   417         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   418         16  FILLER             PIC X         VALUE SPACE.
   419         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   420         16  FILLER             PIC X         VALUE SPACE.
   421         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   422
   423     12  WS-LF-INPUT-CD.
   424         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   425         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   426
   427     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   428     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   429         16  WS-AH-INPUT-CD-1   PIC X.
   430         16  WS-AH-INPUT-CD-2-3 PIC XX.
   431
   432     12  WS-SWITCHES.
   433         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   434         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   435             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   436         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   437             88  BANK-ACCT-FOUND          VALUE 'Y'.
   438         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   439             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   440         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   441             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   442         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   443             88  COMP-MASTER-FOUND        VALUE 'Y'.
   444         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   445             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   446         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   447             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   448         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   449             88  STAT-MASTER-FOUND        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  10
* EL050.cbl
   450         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   451             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   452         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   453             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   454         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   455             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   456         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   457             88  FORM-MASTER-FOUND        VALUE 'Y'.
   458         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   459             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   460         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   461             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   462         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   463             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   464         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   465             88  NO-BENEFIT-FOUND         VALUE 'N'.
   466         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   467             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   468         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   469             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   470         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   471             88  AH-BENEFIT-FOUND         VALUE ' '.
   472             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   473         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   474             88  LF-BENEFIT-FOUND         VALUE ' '.
   475             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   476         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   477             88  NO-STATE-RECORD          VALUE '1'.
   478         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   479             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   480         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   481             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   482         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   483             88  CERT-WAS-FOUND           VALUE ' '.
   484             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   485         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   486             88  BROWSE-STARTED           VALUE 'Y'.
   487         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   488             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   489         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   490             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   491         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   492             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   493         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   494             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   495         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   496             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   497         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   498             88  APP-CERT-USED            VALUE 'Y' 'A'.
   499         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   500             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   501             88  FIRST-TIME-THROUGH       VALUE '1'.
   502             88  CTBL-NOT-FOUND           VALUE '2'.
   503
   504         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   505             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   506
   507         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  11
* EL050.cbl
   508             88  DLO-ERROR-FOUND          VALUE 'Y'.
   509
   510********FLA
   511     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   512     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   513********
   514     12  RC-SW-1                  PIC X           VALUE '0'.
   515     12  RC-SW-2                  PIC X           VALUE '0'.
   516     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   517     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   518     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   519     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   520     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   521     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   522     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   523     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   524     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   525     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   526     12  LIT-SPACES               PIC X           VALUE SPACES.
   527     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   528     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   529     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   530     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   531     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   532     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   533     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   534         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   535         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   536     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   537         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   538
   539 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   540     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   541     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   542 01  WS-CRI-SSN-WORK-AREA.
   543     05  WS-CRI-SOC-SEC-NO.
   544         10  WS-SS-REPT-CD       PIC X(5).
   545         10  WS-SS-LAST-NAME     PIC X(5).
   546         10  WS-SS-INITIAL       PIC X.
   547
   548     05  WS-CRI-REPORT-CODE.
   549         10  FILLER              PIC X(5).
   550         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   551
   552     05  WS-CRI-LAST-NAME.
   553         10  WS-CRI-NAME-MOVE    PIC X(5).
   554         10  FILLER              PIC X(10).
   555
   556 01  WS-NUM-TABLE                PIC X(26)  VALUE
   557     '12345678012345070923456789'.
   558 01  FILLER REDEFINES WS-NUM-TABLE.
   559     05  WS-NUM OCCURS 26        PIC 9.
   560 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   561 01  V1                          PIC S999 COMP-3.
   562 01  V2                          PIC S999 COMP-3.
   563 01  V3                          PIC S999 COMP-3.
   564 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   565 01  FILLER REDEFINES WS-WORK-VIN.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  12
* EL050.cbl
   566     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   567 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   568 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   569 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   570 01  WS-HEX-WORK.
   571     05  FILLER                  PIC X  VALUE LOW-VALUES.
   572     05  WS-HEX-BYTE             PIC X.
   573 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   574 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   575 01  WS-WORK-HIN-ROW-B.
   576     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   577
   578 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   579 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   580     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   581 01  WS-ROW-D-TABLE.
   582     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   583
   584 01  WS-HIN-TABLE-B.
   585     05  F                       PIC XX VALUE 'A2'.
   586     05  F                       PIC XX VALUE 'B3'.
   587     05  F                       PIC XX VALUE 'C4'.
   588     05  F                       PIC XX VALUE 'D5'.
   589     05  F                       PIC XX VALUE 'E6'.
   590     05  F                       PIC XX VALUE 'F7'.
   591     05  F                       PIC XX VALUE 'G8'.
   592     05  F                       PIC XX VALUE 'H9'.
   593     05  F                       PIC XX VALUE 'I1'.
   594     05  F                       PIC XX VALUE 'J2'.
   595     05  F                       PIC XX VALUE 'K3'.
   596     05  F                       PIC XX VALUE 'L4'.
   597     05  F                       PIC XX VALUE 'M5'.
   598     05  F                       PIC XX VALUE 'N6'.
   599     05  F                       PIC XX VALUE 'O0'.
   600     05  F                       PIC XX VALUE 'P7'.
   601     05  F                       PIC XX VALUE 'Q0'.
   602     05  F                       PIC XX VALUE 'R8'.
   603     05  F                       PIC XX VALUE 'S9'.
   604     05  F                       PIC XX VALUE 'T2'.
   605     05  F                       PIC XX VALUE 'U3'.
   606     05  F                       PIC XX VALUE 'V4'.
   607     05  F                       PIC XX VALUE 'W5'.
   608     05  F                       PIC XX VALUE 'X6'.
   609     05  F                       PIC XX VALUE 'Y7'.
   610     05  F                       PIC XX VALUE 'Z8'.
   611 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   612     05  WS-VAL-IN               PIC X.
   613     05  WS-VAL-OUT              PIC 9.
   614 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   615 01  WS-COMPARE-BINARY-DATES.
   616     05  WS-971231                PIC XX VALUE X'92FF'.
   617     05  WS-931231                PIC XX VALUE X'8CFF'.
   618     05  WS-791231                PIC XX VALUE X'77FF'.
   619     05  WS-771001                PIC XX VALUE X'74A1'.
   620     05  WS-820301                PIC XX VALUE X'7B41'.
   621     05  WS-831031                PIC XX VALUE X'7DBF'.
   622     05  WS-831231                PIC XX VALUE X'7DFF'.
   623     05  WS-810831                PIC XX VALUE X'7A7F'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  13
* EL050.cbl
   624     05  WS-830901                PIC XX VALUE X'7D81'.
   625
   626 01  FILE-ACCESS-IDS.
   627     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   628     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   629     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   630     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   631     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   632     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   633     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   634     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   635     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   636     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   637     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   638     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   639     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   640     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   641     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   642     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   643     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   644 01  DD-IU-SW                    PIC X   VALUE ' '.
   645     88  DD-IU-PRESENT                 VALUE 'Y'.
   646
   647 01  ACCESS-KEYS.
   648     12  ELMSTR-KEY.
   649         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   650         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   651     12  W-CLAIM-KEY.
   652         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   653         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   654
   655     12  ELCNTL-KEY.
   656         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   657         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   658         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   659         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   660
   661     12  ELCERT-KEY.
   662         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   663         16  CERT-CARRIER         PIC X       VALUE SPACE.
   664         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   665         16  CERT-STATE           PIC XX      VALUE SPACES.
   666         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   667         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   668         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   669
   670     12  ELCERT2-KEY.
   671         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   672         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   673
   674     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   675
   676     12  ELCERT-SAVE.
   677         16  FILLER                      PIC XX    VALUE SPACES.
   678
   679         16  WCS-CONTROL-PRIMARY.
   680             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   681             20  WCS-CARRIER             PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  14
* EL050.cbl
   682             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   683             20  WCS-STATE               PIC XX    VALUE SPACES.
   684             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   685             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   686             20  WCS-CERT-NO.
   687                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   688                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   689
   690         16  CS-CONTROL-BY-NAME.
   691             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   692             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   693             20  CS-INSURED-INITIALS.
   694                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   695                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   696
   697         16  CS-CONTROL-BY-SSN.
   698             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   699             20  CS-SOC-SEC-NO.
   700                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   701                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   702                 24  CS-SSN-LN3.
   703                     28 CS-INSURED-INITIALS-A2   PIC XX
   704                                     VALUE SPACES.
   705                     28 CS-PART-LAST-NAME-A2     PIC X
   706                                     VALUE SPACE.
   707
   708         16  CS-CONTROL-BY-CERT-NO.
   709             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   710             20  CS-CERT-NO-A4           PIC X(11)
   711                                     VALUE SPACES.
   712
   713         16  CS-CONTROL-BY-MEMB.
   714             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   715             20  CS-MEMBER-NO.
   716                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   717                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   718                 24  CS-MEMB-LN4.
   719                     28 CS-INSURED-INITIALS-A5   PIC XX
   720                                      VALUE SPACES.
   721                     28 CS-PART-LAST-NAME-A5     PIC XX
   722                                      VALUE SPACES.
   723
   724         16  FILLER              PIC X(360) VALUE SPACES.
   725
   726     12  ERACCT-KEY.
   727         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   728         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   729         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   730         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   731         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   732         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   733
   734     12  ERCOMP-KEY.
   735         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   736         16  COMP-CARRIER         PIC X     VALUE SPACES.
   737         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   738         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   739         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  15
* EL050.cbl
   740         16  COMP-TYPE            PIC X     VALUE SPACES.
   741
   742     12  ERLOFC-KEY.
   743         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   744         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   745         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   746         16  LOFC-STATE           PIC XX    VALUE SPACES.
   747         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   748         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   749
   750     12  WS-ELCRTT-KEY.
   751         16  WS-ELCRTT-PRIMARY       PIC X(33).
   752         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   753
   754     12  ERBXRF-KEY.
   755         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   756         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   757         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   758         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   759
   760     12  ERAGTC-KEY.
   761         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   762         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   763         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   764         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   765         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   766         16  AGTC-TYPE            PIC X     VALUE SPACES.
   767
   768     12  ERPLAN-KEY.
   769         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   770         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   771         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   772         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   773         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   774         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   775         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   776         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   777
   778     12  ERFORM-KEY.
   779         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   780         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   781         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   782         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   783
   784     12  ERREIN-KEY.
   785         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   786         16  REIN-TYPE            PIC X     VALUE SPACES.
   787         16  REIN-TABLE-CO.
   788             20  REIN-CODE-1      PIC X     VALUE SPACE.
   789             20  REIN-CODE-2      PIC X     VALUE SPACE.
   790             20  REIN-CODE-3      PIC X     VALUE SPACE.
   791         16  FILLER               PIC X(3)  VALUE SPACES.
   792
   793     12  ERCTBL-KEY.
   794         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   795         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   796         16  CTBL-CNTRL-2.
   797             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  16
* EL050.cbl
   798             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   799
   800     12  WS-ACCESS.
   801         16  FILLER               PIC XX    VALUE SPACES.
   802         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   803
   804     12  WS-CARR-ACCESS.
   805         16  FILLER               PIC X(3)  VALUE SPACES.
   806         16  WS-CARR              PIC X     VALUE SPACE.
   807*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   808*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   809     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   810         88  WS-DMD-LF-RATING   VALUE 'Y'.
   811         88  WS-DMD-AH-RATING   VALUE 'Y'.
   812         88  WS-DMD-NO-RATING   VALUE 'N'.
   813
   814     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   815         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   816                                         'NJ' 'NL'
   817                                         'SJ' 'SL'.
   818     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   819         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   820                                         'NI' 'NJ' 'NL' 'NU'
   821                                         'SI' 'SJ' 'SL' 'SU'
   822                                         'MX' 'MY' 'MZ'.
   823 01  ERPDEF-KEY-SAVE             PIC X(18).
   824 01  ERPDEF-KEY.
   825     12  ERPDEF-COMPANY-CD       PIC X.
   826     12  ERPDEF-STATE            PIC XX.
   827     12  ERPDEF-PROD-CD          PIC XXX.
   828     12  F                       PIC X(7).
   829     12  ERPDEF-BEN-TYPE         PIC X.
   830     12  ERPDEF-BEN-CODE         PIC XX.
   831     12  ERPDEF-EXP-DT           PIC XX.
   832
   833 01  ELSTAT-KEY-SAVE             PIC X(20).
   834 01  ELSTAT-KEY.
   835     12  ELSTAT-COMPANY-ID       PIC XXX.
   836     12  ELSTAT-CARRIER          PIC X.
   837     12  ELSTAT-GROUP            PIC X(6).
   838     12  ELSTAT-STATE            PIC XX.
   839     12  ELSTAT-EXP-DT           PIC 9(8).
   840 01  WS-ERROR-VALUES.
   841     12  ER-1570                     PIC S9(4)   VALUE +1570.
   842     12  ER-1571                     PIC S9(4)   VALUE +1571.
   843     12  ER-1575                     PIC S9(4)   VALUE +1575.
   844     12  ER-1891                     PIC S9(4)   VALUE +1891.
   845     12  ER-1892                     PIC S9(4)   VALUE +1892.
   846     12  ER-1893                     PIC S9(4)   VALUE +1893.
   847     12  ER-1894                     PIC S9(4)   VALUE +1894.
   848     12  ER-1895                     PIC S9(4)   VALUE +1895.
   849     12  ER-1896                     PIC S9(4)   VALUE +1896.
   850     12  ER-1897                     PIC S9(4)   VALUE +1897.
   851     12  ER-1898                     PIC S9(4)   VALUE +1898.
   852     12  ER-1899                     PIC S9(4)   VALUE +1899.
   853     12  ER-1900                     PIC S9(4)   VALUE +1900.
   854     12  ER-1901                     PIC S9(4)   VALUE +1901.
   855     12  ER-1902                     PIC S9(4)   VALUE +1902.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  17
* EL050.cbl
   856     12  ER-1903                     PIC S9(4)   VALUE +1903.
   857     12  ER-1904                     PIC S9(4)   VALUE +1904.
   858     12  ER-1905                     PIC S9(4)   VALUE +1905.
   859     12  ER-1906                     PIC S9(4)   VALUE +1906.
   860     12  ER-1907                     PIC S9(4)   VALUE +1907.
   861     12  ER-1909                     PIC S9(4)   VALUE +1909.
   862     12  ER-1910                     PIC S9(4)   VALUE +1910.
   863     12  ER-1911                     PIC S9(4)   VALUE +1911.
   864     12  ER-1912                     PIC S9(4)   VALUE +1912.
   865     12  ER-1913                     PIC S9(4)   VALUE +1913.
   866     12  ER-1914                     PIC S9(4)   VALUE +1914.
   867     12  ER-1915                     PIC S9(4)   VALUE +1915.
   868     12  ER-1916                     PIC S9(4)   VALUE +1916.
   869     12  ER-1917                     PIC S9(4)   VALUE +1917.
   870     12  ER-1918                     PIC S9(4)   VALUE +1918.
   871     12  ER-1919                     PIC S9(4)   VALUE +1919.
   872     12  ER-1920                     PIC S9(4)   VALUE +1920.
   873     12  ER-1921                     PIC S9(4)   VALUE +1921.
   874     12  ER-1922                     PIC S9(4)   VALUE +1922.
   875     12  ER-1923                     PIC S9(4)   VALUE +1923.
   876     12  ER-1924                     PIC S9(4)   VALUE +1924.
   877     12  ER-1925                     PIC S9(4)   VALUE +1925.
   878     12  ER-1926                     PIC S9(4)   VALUE +1926.
   879     12  ER-1927                     PIC S9(4)   VALUE +1927.
   880     12  ER-2393                     PIC S9(4)   VALUE +2393.
   881     12  ER-2600                     PIC S9(4)   VALUE +2600.
   882     12  ER-2601                     PIC S9(4)   VALUE +2601.
   883     12  ER-2602                     PIC S9(4)   VALUE +2602.
   884     12  ER-2603                     PIC S9(4)   VALUE +2603.
   885     12  ER-2604                     PIC S9(4)   VALUE +2604.
   886     12  ER-2605                     PIC S9(4)   VALUE +2605.
   887     12  ER-2606                     PIC S9(4)   VALUE +2606.
   888     12  ER-2607                     PIC S9(4)   VALUE +2607.
   889     12  ER-2608                     PIC S9(4)   VALUE +2608.
   890     12  ER-2609                     PIC S9(4)   VALUE +2609.
   891     12  ER-2610                     PIC S9(4)   VALUE +2610.
   892     12  ER-2611                     PIC S9(4)   VALUE +2611.
   893     12  ER-2612                     PIC S9(4)   VALUE +2612.
   894     12  ER-2613                     PIC S9(4)   VALUE +2613.
   895     12  ER-2614                     PIC S9(4)   VALUE +2614.
   896     12  ER-2615                     PIC S9(4)   VALUE +2615.
   897     12  ER-2616                     PIC S9(4)   VALUE +2616.
   898     12  ER-2617                     PIC S9(4)   VALUE +2617.
   899     12  ER-2618                     PIC S9(4)   VALUE +2618.
   900     12  ER-2619                     PIC S9(4)   VALUE +2619.
   901     12  ER-2620                     PIC S9(4)   VALUE +2620.
   902     12  ER-2621                     PIC S9(4)   VALUE +2621.
   903     12  ER-2622                     PIC S9(4)   VALUE +2622.
   904     12  ER-2623                     PIC S9(4)   VALUE +2623.
   905     12  ER-2624                     PIC S9(4)   VALUE +2624.
   906     12  ER-2625                     PIC S9(4)   VALUE +2625.
   907     12  ER-2626                     PIC S9(4)   VALUE +2626.
   908     12  ER-2627                     PIC S9(4)   VALUE +2627.
   909     12  ER-2628                     PIC S9(4)   VALUE +2628.
   910     12  ER-2629                     PIC S9(4)   VALUE +2629.
   911     12  ER-2630                     PIC S9(4)   VALUE +2630.
   912     12  ER-2631                     PIC S9(4)   VALUE +2631.
   913     12  ER-2632                     PIC S9(4)   VALUE +2632.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  18
* EL050.cbl
   914     12  ER-2633                     PIC S9(4)   VALUE +2633.
   915     12  ER-2634                     PIC S9(4)   VALUE +2634.
   916     12  ER-2635                     PIC S9(4)   VALUE +2635.
   917     12  ER-2636                     PIC S9(4)   VALUE +2636.
   918     12  ER-2637                     PIC S9(4)   VALUE +2637.
   919     12  ER-2638                     PIC S9(4)   VALUE +2638.
   920     12  ER-2639                     PIC S9(4)   VALUE +2639.
   921     12  ER-2640                     PIC S9(4)   VALUE +2640.
   922     12  ER-2641                     PIC S9(4)   VALUE +2641.
   923     12  ER-2642                     PIC S9(4)   VALUE +2642.
   924     12  ER-2643                     PIC S9(4)   VALUE +2643.
   925     12  ER-2644                     PIC S9(4)   VALUE +2644.
   926     12  ER-2645                     PIC S9(4)   VALUE +2645.
   927     12  ER-2646                     PIC S9(4)   VALUE +2646.
   928     12  ER-2647                     PIC S9(4)   VALUE +2647.
   929     12  ER-2648                     PIC S9(4)   VALUE +2648.
   930     12  ER-2649                     PIC S9(4)   VALUE +2649.
   931     12  ER-2650                     PIC S9(4)   VALUE +2650.
   932     12  ER-2651                     PIC S9(4)   VALUE +2651.
   933     12  ER-2652                     PIC S9(4)   VALUE +2652.
   934     12  ER-2653                     PIC S9(4)   VALUE +2653.
   935     12  ER-2654                     PIC S9(4)   VALUE +2654.
   936     12  ER-2655                     PIC S9(4)   VALUE +2655.
   937     12  ER-2656                     PIC S9(4)   VALUE +2656.
   938     12  ER-2657                     PIC S9(4)   VALUE +2657.
   939     12  ER-2658                     PIC S9(4)   VALUE +2658.
   940     12  ER-2659                     PIC S9(4)   VALUE +2659.
   941     12  ER-2660                     PIC S9(4)   VALUE +2660.
   942     12  ER-2661                     PIC S9(4)   VALUE +2661.
   943     12  ER-2662                     PIC S9(4)   VALUE +2662.
   944     12  ER-2663                     PIC S9(4)   VALUE +2663.
   945     12  ER-2664                     PIC S9(4)   VALUE +2664.
   946     12  ER-2665                     PIC S9(4)   VALUE +2665.
   947     12  ER-2666                     PIC S9(4)   VALUE +2666.
   948     12  ER-2667                     PIC S9(4)   VALUE +2667.
   949     12  ER-2668                     PIC S9(4)   VALUE +2668.
   950     12  ER-2669                     PIC S9(4)   VALUE +2669.
   951     12  ER-2670                     PIC S9(4)   VALUE +2670.
   952     12  ER-2671                     PIC S9(4)   VALUE +2671.
   953     12  ER-2672                     PIC S9(4)   VALUE +2672.
   954     12  ER-2673                     PIC S9(4)   VALUE +2673.
   955     12  ER-2674                     PIC S9(4)   VALUE +2674.
   956     12  ER-2675                     PIC S9(4)   VALUE +2675.
   957     12  ER-2676                     PIC S9(4)   VALUE +2676.
   958     12  ER-2677                     PIC S9(4)   VALUE +2677.
   959     12  ER-2678                     PIC S9(4)   VALUE +2678.
   960     12  ER-2679                     PIC S9(4)   VALUE +2679.
   961     12  ER-2680                     PIC S9(4)   VALUE +2680.
   962     12  ER-2681                     PIC S9(4)   VALUE +2681.
   963     12  ER-2682                     PIC S9(4)   VALUE +2682.
   964     12  ER-2683                     PIC S9(4)   VALUE +2683.
   965     12  ER-2684                     PIC S9(4)   VALUE +2684.
   966     12  ER-2685                     PIC S9(4)   VALUE +2685.
   967     12  ER-2686                     PIC S9(4)   VALUE +2686.
   968     12  ER-2687                     PIC S9(4)   VALUE +2687.
   969     12  ER-2688                     PIC S9(4)   VALUE +2688.
   970     12  ER-2689                     PIC S9(4)   VALUE +2689.
   971     12  ER-2690                     PIC S9(4)   VALUE +2690.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  19
* EL050.cbl
   972     12  ER-2691                     PIC S9(4)   VALUE +2691.
   973     12  ER-2692                     PIC S9(4)   VALUE +2692.
   974     12  ER-2693                     PIC S9(4)   VALUE +2693.
   975     12  ER-2694                     PIC S9(4)   VALUE +2694.
   976     12  ER-2695                     PIC S9(4)   VALUE +2695.
   977     12  ER-2696                     PIC S9(4)   VALUE +2696.
   978     12  ER-2697                     PIC S9(4)   VALUE +2697.
   979     12  ER-2698                     PIC S9(4)   VALUE +2698.
   980     12  ER-2699                     PIC S9(4)   VALUE +2699.
   981     12  ER-2700                     PIC S9(4)   VALUE +2700.
   982     12  ER-2701                     PIC S9(4)   VALUE +2701.
   983     12  ER-2702                     PIC S9(4)   VALUE +2702.
   984     12  ER-2703                     PIC S9(4)   VALUE +2703.
   985     12  ER-2704                     PIC S9(4)   VALUE +2704.
   986     12  ER-2707                     PIC S9(4)   VALUE +2707.
   987     12  ER-2720                     PIC S9(4)   VALUE +2720.
   988     12  ER-2709                     PIC S9(4)   VALUE +2709.
   989     12  ER-2717                     PIC S9(4)   VALUE +2717.
   990     12  ER-2718                     PIC S9(4)   VALUE +2718.
   991     12  ER-2719                     PIC S9(4)   VALUE +2719.
   992     12  ER-2721                     PIC S9(4)   VALUE +2721.
   993     12  ER-2722                     PIC S9(4)   VALUE +2722.
   994     12  ER-2723                     PIC S9(4)   VALUE +2723.
   995     12  ER-2724                     PIC S9(4)   VALUE +2724.
   996     12  ER-2725                     PIC S9(4)   VALUE +2725.
   997     12  ER-2726                     PIC S9(4)   VALUE +2726.
   998     12  ER-2727                     PIC S9(4)   VALUE +2727.
   999     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1000     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1001     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1002     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1003     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1004     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1005     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1006     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1007     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1008     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1009     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1010     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1011     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1012     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1013     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1014     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1015     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1016     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1017     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1018     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1019     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1020     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1021     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1022     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1023     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1024     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1025     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1026     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1027     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1028     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1029     12  ER-2758                     PIC S9(4)   VALUE +2758.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  20
* EL050.cbl
  1030     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1031     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1032     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1033     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1034     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1035     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1036     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1037     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1038     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1039     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1040     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1041     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1042     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1043     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1044     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1045     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1046     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1047     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1048     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1049     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1050     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1051     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1052     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1053     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1054     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1055     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1056     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1057     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1058     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1059     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1060     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1061     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1062     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1063     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1064     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1065     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1066     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1067     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1068     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1069     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1070     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1071     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1072     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1073     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1074     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1075     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1076     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1077     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1078     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1079     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1080     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1081     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1082     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1083     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1084     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1085     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1086     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1087     12  ER-3054                     PIC S9(4)   VALUE +3054.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  21
* EL050.cbl
  1088     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1089     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1090     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1091     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1092     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1093     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1094     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1095     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1096     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1097     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1098     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1099     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1100     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1101     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1102     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1103     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1104     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1105     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1106     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1107     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1108     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1109     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1110     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1111     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1112     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1113     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1114     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1115     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1116     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1117     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1118     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1119     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1120     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1121     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1122     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1123     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1124     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1125     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1126     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1127     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1128     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1129     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1130     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1131     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1132     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1133     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1134     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1135     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1136     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1137     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1138     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1139     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1140     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1141     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1142     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1143     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1144     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1145     12  ER-8091                     PIC S9(4)   VALUE +8091.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  22
* EL050.cbl
  1146     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1147     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1148     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1149     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1150     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1151     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1152     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1153     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1154     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1155     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1156     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1157     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1158     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1159     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1160     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1161     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1162     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1163     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1164     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1165     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1166     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1167     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1168     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1169     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1170     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1171     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1172     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1173     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1174     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1175     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1176     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1177     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1178     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1179     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1180******************************************************************
  1181***************   END OF ELC50WS     ****************************
  1182******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  23
* EL050.cbl
  1185 01  WORKING-STORAGE-WORK-AREAS.
  1186     12  WS-RESPONSE             PIC S9(8)  COMP.
  1187         88  WS-RESP-NORMAL           VALUE +00.
  1188         88  WS-RESP-ERROR            VALUE +01.
  1189         88  WS-RESP-NOTFND           VALUE +13.
  1190         88  WS-RESP-DUPREC           VALUE +14.
  1191         88  WS-RESP-ENDFILE          VALUE +20.
  1192     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1193     12  WORK-AREAS.
  1194         16  WK-CONV-GREG.
  1195             24  WCG-CENT             PIC XX.
  1196             24  WCG-REST             PIC X(4).
  1197         16  WORK-GREGORIAN-DATE.
  1198             24  WK-GREG-CENT         PIC XX.
  1199             24  WK-GREG-DATE-YYMMDD.
  1200                 28  WK-GREG-YYMM     PIC X(4).
  1201                 28  WK-GREG-DD       PIC XX.
  1202
  1203         16  WORK-SELECT-DATE.
  1204             24  WK-SELECT-CENT            PIC XX.
  1205             24  WK-SELECT-DATE-YYMMDD.
  1206                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1207                 28  FILLER                PIC XX.
  1208
  1209         16  WK-FORM-NO.
  1210             24  WK-FORM-BANK-ID       PIC X(5).
  1211             24  WK-FORM-UNDRWRTR      PIC X(1).
  1212             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1213
  1214         16  WK-MEMBER-NO.
  1215             24  WK-MEMBER-1-6        PIC X(6).
  1216             24  WK-MEMBER-7-12       PIC X(6).
  1217
  1218         16  WK-FULL-CERT-NO.
  1219             24  WK-CERT-POS-1-2      PIC X(2).
  1220             24  WK-CERT-POS-3        PIC X(1).
  1221             24  WK-CERT-POS-4        PIC X(1).
  1222             24  WK-CERT-POS-5-6      PIC X(2).
  1223             24  WK-CERT-POS-7        PIC X(1).
  1224             24  WK-CERT-POS-8-11     PIC X(4).
  1225
  1226         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1227             88  VALID-RATE-CODE        VALUE 'Y'.
  1228             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1229
  1230         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1231         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1232         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1233         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1234         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1235         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1236         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1237         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1238         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1239         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1240
  1241* DLO001
  1242 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  24
* EL050.cbl
  1243     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1244     12  DMPF-RETURN-CODE          PIC XX.
  1245         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1246         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1247         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1248         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1249         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1250         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1251
  1252* DLO002
  1253 01  WS-DLO-INTERNAL-POLICY-FORM.
  1254     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1255     12  DIPF-RETURN-CODE          PIC XX.
  1256         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1257         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1258         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1259         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1260         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1261         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1262
  1263* DLO003
  1264 01  WS-DLO-VALID-BANK-ID.
  1265     12  DVBI-BANK-ID              PIC X(5).
  1266     12  DVBI-BANK-ID-TYPE         PIC X.
  1267         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1268         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1269         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1270         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1271         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1272     12  DVBI-RETURN-CODE          PIC XX.
  1273         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1274         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1275         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1276         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1277         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1278         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1279         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1280         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1281         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1282
  1283* DLO007
  1284 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1285     12  DCUA-RES-STATE            PIC XX.
  1286     12  DCUA-BEN-TYPE             PIC XX.
  1287     12  DCUA-SYS-IDENT            PIC X.
  1288         88  DCUA-CLAIM                        VALUE 'C'.
  1289         88  DCUA-PREMIUM                      VALUE 'P'.
  1290     12  DCUA-COVERAGE-RULE        PIC X.
  1291     12  DCUA-CLIENT-ID            PIC X(10).
  1292     12  DCUA-EFF-DATE             PIC X(8).
  1293     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1294     12  DCUA-RETURN-CODE          PIC XX.
  1295         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1296     12  DCUA-CERT-NUMBER          PIC X(11).
  1297     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1298     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1299
  1300* DLO011
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  25
* EL050.cbl
  1301 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1302     12  DPRB-RATE-CODE            PIC X(4).
  1303     12  DPRB-COVERAGE-CATEG       PIC X.
  1304     12  DPRB-RETURN-CODE          PIC XX.
  1305         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1306         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1307         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1308         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1309         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1310         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1311         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1312         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1313         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1314     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1315     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1316     12  DPRB-BEN-TYPE             PIC XX.
  1317
  1318* DLO017
  1319 01  WS-DLO-VALID-RATE-CODE.
  1320     12  DVRC-RATE-CODE            PIC X(4).
  1321     12  DVRC-RETURN-CODE          PIC XX.
  1322         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1323         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1324         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1325         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1326         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1327         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1328
  1329* DLO019
  1330 01  WS-DLO-ORIG-COV-CAT.
  1331     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1332     12  DOCC-RETURN-CODE          PIC XX.
  1333     12  DOCC-ORIG-COV-CAT         PIC X.
  1334     12  DOCC-UNDERWITER           PIC XX.
  1335     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1336     12  DOCC-FILLER               PIC X(6).
  1337
  1338* DLO021
  1339 01  WS-DLO-VALID-LOAN-OFFICER.
  1340     12  DVLO-LOAN-OFFICER.
  1341         16  DVLO-BILL-TYPE        PIC X.
  1342         16  DVLO-BILL-SOURCE      PIC X.
  1343         16  DVLO-BATCH-TYPE       PIC X.
  1344     12  DVLO-RETURN-CODE          PIC XX.
  1345         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1346         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1347         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1348         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1349         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1350         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1351
  1352* DLO022
  1353 01  WS-DLO-VALID-STATE-CODE.
  1354     12  DVSC-STATE-CODE           PIC XX.
  1355     12  DVSC-RETURN-CODE          PIC XX.
  1356         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1357
  1358* DLO023
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  26
* EL050.cbl
  1359 01  WS-DLO-VALID-CODE-VALUES.
  1360     12  DVCV-SYSTEM-ID            PIC XX.
  1361         88  DVCV-CLAIMS                       VALUE 'CL'.
  1362         88  DVCV-CREDIT                       VALUE 'CR'.
  1363     12  DVCV-RECORD-TYPE          PIC XX.
  1364         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1365         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1366         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1367         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1368         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1369         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1370         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1371         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1372     12  DVCV-RECORD-KEY           PIC X(6).
  1373     12  DVCV-RETURN-CODE          PIC XX.
  1374         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1375         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1376         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1377         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1378         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1379         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1380         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1381     12  DVCV-CODE-DESC            PIC X(60).
  1382     12  DVCV-GEN-DESC-1           PIC X(20).
  1383     12  DVCV-GEN-DESC-2           PIC X(20).
  1384     12  DVCV-GEN-DESC-3           PIC X(20).
  1385
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  27
* EL050.cbl
  1387*    COPY ERCBXRF.
  1388******************************************************************
  1389*                                                                *
  1390*                                                                *
  1391*                            ERCBXRF                             *
  1392*                                                                *
  1393*   ONLINE CREDIT SYSTEM                                         *
  1394*                                                                *
  1395*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1396*                                                                *
  1397*   FILE TYPE = VSAM,KSDS                                        *
  1398*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1399*                                                                *
  1400*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1401*       ALTERNATE PATH = NONE                                    *
  1402*                                                                *
  1403*   LOG = NO                                                     *
  1404*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1405*                                                                *
  1406******************************************************************
  1407
  1408 01  BANK-CROSS-REFERENCE.
  1409     12  BK-RECORD-ID                PIC XX.
  1410         88  VALID-BK-ID             VALUE 'BK'.
  1411
  1412     12  BK-CONTROL-PRIMARY.
  1413         16  BK-COMPANY-CD           PIC X.
  1414         16  BK-CARRIER              PIC X.
  1415         16  BK-GROUPING             PIC X(6).
  1416         16  BK-BANK-NO              PIC X(10).
  1417
  1418     12  BK-MAINT-INFORMATION.
  1419         16  BK-LAST-MAINT-DT        PIC XX.
  1420         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1421         16  BK-LAST-MAINT-USER      PIC X(4).
  1422         16  FILLER                  PIC X(9).
  1423
  1424     12  FILLER                      PIC X(37).
  1425
  1426     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1427
  1428     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1429                            DEPENDING ON BK-BANK-POINTER-CNT.
  1430         16  BK-AM-ACCOUNT           PIC X(10).
  1431         16  BK-AM-EXP-DT            PIC XX.
  1432         16  BK-AM-EFF-DT            PIC XX.
  1433         16  BK-AM-STATE             PIC XX.
  1434         16  FILLER                  PIC X(20).
  1435
  1436******************************************************************
  1437
  1438*    COPY ERCCOMP.
  1439******************************************************************
  1440*                                                                *
  1441*                                                                *
  1442*                            ERCCOMP                             *
  1443*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1444*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  28
* EL050.cbl
  1445*                                                                *
  1446*   ONLINE CREDIT SYSTEM                                         *
  1447*                                                                *
  1448*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1449*                                                                *
  1450*   FILE TYPE = VSAM,KSDS                                        *
  1451*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1452*                                                                *
  1453*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1454*       ALTERNATE PATH = NONE                                    *
  1455*                                                                *
  1456*   LOG = NO                                                     *
  1457*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1458*                                                                *
  1459******************************************************************
  1460*                   C H A N G E   L O G
  1461*
  1462* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1463*-----------------------------------------------------------------
  1464*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1465* EFFECTIVE    NUMBER
  1466*-----------------------------------------------------------------
  1467* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1468* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1469* 092205    2005050300006  PEMA  ADD LEASE FEE
  1470* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1471* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1472* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1473* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1474* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1475******************************************************************
  1476
  1477 01  COMPENSATION-MASTER.
  1478     12  CO-RECORD-ID                          PIC XX.
  1479         88  VALID-CO-ID                          VALUE 'CO'.
  1480
  1481     12  CO-CONTROL-PRIMARY.
  1482         16  CO-COMPANY-CD                     PIC X.
  1483         16  CO-CONTROL.
  1484             20  CO-CTL-1.
  1485                 24  CO-CARR-GROUP.
  1486                     28  CO-CARRIER            PIC X.
  1487                     28  CO-GROUPING.
  1488                         32  CO-GROUP-PREFIX   PIC XXX.
  1489                         32  CO-GROUP-PRIME    PIC XXX.
  1490                 24  CO-RESP-NO.
  1491                     28  CO-RESP-PREFIX        PIC X(4).
  1492                     28  CO-RESP-PRIME         PIC X(6).
  1493             20  CO-CTL-2.
  1494                 24  CO-ACCOUNT.
  1495                     28  CO-ACCT-PREFIX        PIC X(4).
  1496                     28  CO-ACCT-PRIME         PIC X(6).
  1497         16  CO-TYPE                           PIC X.
  1498             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1499             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1500             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1501
  1502     12  CO-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  29
* EL050.cbl
  1503         16  CO-LAST-MAINT-DT                  PIC XX.
  1504         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1505         16  CO-LAST-MAINT-USER                PIC X(4).
  1506     12  FILLER                                PIC XX.
  1507     12  CO-STMT-TYPE                          PIC XXX.
  1508     12  CO-COMP-TYPE                          PIC X.
  1509         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1510     12  CO-STMT-OWNER                         PIC X(4).
  1511     12  CO-BALANCE-CONTROL                    PIC X.
  1512         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1513         88  CO-NO-BALANCE                        VALUE 'N'.
  1514
  1515     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1516         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1517         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1518         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1519
  1520     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1521         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1522         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1523
  1524     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1525     12  CO-GA-DIRECT-DEP                      PIC X.
  1526     12  CO-FUTURE-SPACE                       PIC X.
  1527         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1528
  1529     12  CO-ACCT-NAME                          PIC X(30).
  1530     12  CO-MAIL-NAME                          PIC X(30).
  1531     12  CO-ADDR-1                             PIC X(30).
  1532     12  CO-ADDR-2                             PIC X(30).
  1533     12  CO-ADDR-3.
  1534         16  CO-ADDR-CITY                      PIC X(27).
  1535         16  CO-ADDR-STATE                     PIC XX.
  1536     12  CO-CSO-1099                           PIC X.
  1537     12  CO-ZIP.
  1538         16  CO-ZIP-PRIME.
  1539             20  CO-ZIP-PRI-1ST                PIC X.
  1540                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1541             20  FILLER                        PIC X(4).
  1542         16  CO-ZIP-PLUS4                      PIC X(4).
  1543     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1544         16  CO-CAN-POSTAL-1                   PIC XXX.
  1545         16  CO-CAN-POSTAL-2                   PIC XXX.
  1546         16  FILLER                            PIC XXX.
  1547     12  CO-SOC-SEC                            PIC X(13).
  1548     12  CO-TELEPHONE.
  1549         16  CO-AREA-CODE                      PIC XXX.
  1550         16  CO-PREFIX                         PIC XXX.
  1551         16  CO-PHONE                          PIC X(4).
  1552
  1553     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1554
  1555     12  CO-AR-BAL-LEVEL                       PIC X.
  1556         88  CO-AR-REF-LVL                        VALUE '1'.
  1557         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1558         88  CO-AR-BILL-LVL                       VALUE '2'.
  1559         88  CO-AR-AGT-LVL                        VALUE '3'.
  1560         88  CO-AR-FR-LVL                         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  30
* EL050.cbl
  1561
  1562     12  CO-AR-NORMAL-PRINT                    PIC X.
  1563         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1564         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1565
  1566     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1567
  1568     12  CO-AR-REPORTING                       PIC X.
  1569         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1570         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1571
  1572     12  CO-AR-PULL-CHECK                      PIC X.
  1573         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1574         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1575
  1576     12  CO-AR-BALANCE-PRINT                   PIC X.
  1577         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1578
  1579     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1580         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1581         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1582         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1583
  1584     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1585
  1586     12  CO-USER-CODE                          PIC X.
  1587     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1588
  1589******************************************************************
  1590*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1591*    THE LAST MONTH END RUN.
  1592******************************************************************
  1593
  1594     12  CO-LAST-ACTIVITY-DATE.
  1595         16  CO-ACT-YEAR                       PIC 99.
  1596         16  CO-ACT-MONTH                      PIC 99.
  1597         16  CO-ACT-DAY                        PIC 99.
  1598
  1599     12  CO-LAST-STMT-DT.
  1600         16  CO-LAST-STMT-YEAR                 PIC 99.
  1601         16  CO-LAST-STMT-MONTH                PIC 99.
  1602         16  CO-LAST-STMT-DAY                  PIC 99.
  1603
  1604     12  CO-MO-END-TOTALS.
  1605         16  CO-MONTHLY-TOTALS.
  1606             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1607             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1608             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1609             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1610             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1611
  1612         16  CO-AGING-TOTALS.
  1613             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1614             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1615             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1616             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1617
  1618         16  CO-YTD-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  31
* EL050.cbl
  1619             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1620             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1621
  1622         16  CO-OVER-UNDER-TOTALS.
  1623             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1624             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1625
  1626     12  CO-MISCELLANEOUS-TOTALS.
  1627         16  CO-FICA-TOTALS.
  1628             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1629             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1630
  1631         16  CO-CLAIM-TOTALS.
  1632             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1633             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1634
  1635******************************************************************
  1636*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1637*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1638******************************************************************
  1639
  1640     12  CO-CURRENT-TOTALS.
  1641         16  CO-CURRENT-LAST-STMT-DT.
  1642             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1643             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1644             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1645
  1646         16  CO-CURRENT-MONTHLY-TOTALS.
  1647             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1648             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1649             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1650             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1651             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1652
  1653         16  CO-CURRENT-AGING-TOTALS.
  1654             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1655             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1656             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1657             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1658
  1659         16  CO-CURRENT-YTD-TOTALS.
  1660             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1661             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1662
  1663     12  CO-PAID-COMM-TOTALS.
  1664         16  CO-YTD-PAID-COMMS.
  1665             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1666             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1667
  1668     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1669         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1670         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1671
  1672     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1673         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1674         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1675         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1676         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  32
* EL050.cbl
  1677         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1678         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1679         88  CO-FINAL-LETTER                  VALUE 'F'.
  1680         88  CO-RECONCILING                   VALUE 'R'.
  1681         88  CO-PHONE-CALL                    VALUE 'P'.
  1682         88  CO-LEGAL                         VALUE 'L'.
  1683         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1684         88  CO-WRITE-OFF                     VALUE 'W'.
  1685         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1686
  1687     12  CO-CSR-CODE                       PIC X(4).
  1688
  1689     12  CO-GA-STATUS-INFO.
  1690         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1691         16  CO-GA-TERMINATION-DT          PIC XX.
  1692         16  CO-GA-STATUS-CODE             PIC X.
  1693             88  CO-GA-ACTIVE                 VALUE 'A'.
  1694             88  CO-GA-INACTIVE               VALUE 'I'.
  1695             88  CO-GA-PENDING                VALUE 'P'.
  1696         16  CO-GA-COMMENTS.
  1697             20  CO-GA-COMMENT-1           PIC X(40).
  1698             20  CO-GA-COMMENT-2           PIC X(40).
  1699             20  CO-GA-COMMENT-3           PIC X(40).
  1700             20  CO-GA-COMMENT-4           PIC X(40).
  1701
  1702     12  CO-RPTCD2                         PIC X(10).
  1703
  1704     12  CO-TYPE-AGENT                     PIC X(01).
  1705         88  CO-CORPORATION                   VALUE 'C'.
  1706         88  CO-PARTNERSHIP                   VALUE 'P'.
  1707         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1708         88  CO-TRUST                         VALUE 'T'.
  1709         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1710
  1711     12  CO-FAXNO.
  1712         16  CO-FAX-AREA-CODE                  PIC XXX.
  1713         16  CO-FAX-PREFIX                     PIC XXX.
  1714         16  CO-FAX-PHONE                      PIC X(4).
  1715
  1716     12  CO-BANK-INFORMATION.
  1717         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1718         16  CO-BANK-TRANSIT-NON REDEFINES
  1719             CO-BANK-TRANSIT-NO                PIC 9(8).
  1720
  1721         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1722     12  CO-MISC-DEDUCT-INFO REDEFINES
  1723                  CO-BANK-INFORMATION.
  1724         16  CO-MD-GL-ACCT                     PIC X(10).
  1725         16  CO-MD-DIV                         PIC XX.
  1726         16  CO-MD-CENTER                      PIC X(4).
  1727         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1728         16  CO-CREATE-AP-CHECK                PIC X.
  1729         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1730         16  FILLER                            PIC XXX.
  1731     12  CO-ACH-STATUS                         PIC X.
  1732         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1733         88  CO-ACH-PENDING                        VALUE 'P'.
  1734
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  33
* EL050.cbl
  1735     12  CO-BILL-SW                            PIC X.
  1736     12  CO-CONTROL-NAME                       PIC X(30).
  1737     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1738     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1739     12  CO-CLP-STATE                          PIC XX.
  1740     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1741     12  CO-SPP-REFUND-EDIT                    PIC X.
  1742
  1743******************************************************************
  1744
  1745*    COPY ERCAGTC.
  1746******************************************************************
  1747*                                                                *
  1748*                                                                *
  1749*                            ERCAGTC                             *
  1750*                            VMOD=2.001                          *
  1751*                                                                *
  1752*   ONLINE CREDIT SYSTEM                                         *
  1753*                                                                *
  1754*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1755*                                                                *
  1756*   FILE TYPE = VSAM,KSDS                                        *
  1757*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1758*                                                                *
  1759*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1760*       ALTERNATE PATH = NONE                                    *
  1761*                                                                *
  1762*   LOG = NO                                                     *
  1763*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1764*                                                                *
  1765******************************************************************
  1766*                   C H A N G E   L O G
  1767*
  1768* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1769*-----------------------------------------------------------------
  1770*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1771* EFFECTIVE    NUMBER
  1772*-----------------------------------------------------------------
  1773* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1774* 111004                         NEW FILE AND COPYBOOK
  1775* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1776******************************************************************
  1777 01  AGENT-COMMISSIONS.
  1778     12  AG-RECORD-ID                          PIC XX.
  1779         88  VALID-CO-ID                          VALUE 'AG'.
  1780     12  AG-CONTROL-PRIMARY.
  1781         16  AG-COMPANY-CD                     PIC X.
  1782         16  AG-CONTROL.
  1783             20  AG-CTL-1.
  1784                 24  AG-CARR-GROUP.
  1785                     28  AG-CARRIER            PIC X.
  1786                     28  AG-GROUPING           PIC X(6).
  1787                 24  AG-BANK                   PIC X(10).
  1788             20  AG-CTL-2.
  1789                 24  AG-EXP-DT                 PIC XX.
  1790         16  AG-TYPE                           PIC X.
  1791             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1792             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  34
* EL050.cbl
  1793     12  AG-MAINT-INFORMATION.
  1794         16  AG-LAST-MAINT-DT                  PIC XX.
  1795         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1796         16  AG-LAST-MAINT-USER                PIC X(4).
  1797         16  FILLER                            PIC X(10).
  1798     12  AG-EFF-DT                             PIC XX.
  1799     12  AG-COMM-STRUCTURE.
  1800         16  AG-AGT-COMMS OCCURS 10.
  1801             20  AG-AGT                PIC X(10).
  1802             20  AG-COM-TYP            PIC X.
  1803             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1804             20  AG-RECALC-LV-INDIC    PIC X.
  1805             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1806             20  AG-LRCALC-LV-INDIC    PIC X.
  1807             20  FILLER                PIC X(05).
  1808     12  FILLER                  PIC X(145).
  1809******************************************************************
  1810*    COPY ERCRESS.
  1811******************************************************************
  1812*                                                                *
  1813*                            ERCRESS                             *
  1814*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1815*                            VMOD=2.002                          *
  1816*                                                                *
  1817*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1818*                                                                *
  1819*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1820*   VSAM RESIDENT STATE TAX MASTER                              *
  1821*                                                                *
  1822*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1823*                                                                *
  1824*   FILE TYPE = VSAM,KSDS                                        *
  1825*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1826*                                                                *
  1827*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1828*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1829*                                                                *
  1830*   LOG = NO                                                     *
  1831*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1832*                                                                *
  1833*                                                                *
  1834******************************************************************
  1835
  1836 01  RESIDENT-STATE-TAX-MASTER.
  1837
  1838     10  ERRESS-PRIMARY-KEY.
  1839         15  RES-COMPANY-CD        PIC X.
  1840         15  RES-RESIDENT-STATE    PIC XX.
  1841         15  RES-COVERAGE-CATEGORY PIC X.
  1842         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1843*                                      YYYYMMDD
  1844*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1845
  1846     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
  1847
  1848         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1849         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1850         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  35
* EL050.cbl
  1851         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1852
  1853     10 RES-RECALC-SW              PIC   X.
  1854         88 RECALC                VALUE 'Y'.
  1855         88 NO-RECALC             VALUE 'N'.
  1856     10  RES-MAINT-BY              PIC X(4).
  1857     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1858     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1859*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  36
* EL050.cbl
  1861*    COPY ERCRESC.
  1862******************************************************************
  1863*                                                                *
  1864*                            ERCRESC                             *
  1865*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1866*                            VMOD=2.003                          *
  1867*                                                                *
  1868*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1869*                                                                *
  1870*   FILE TYPE = VSAM,KSDS                                        *
  1871*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1872*                                                                *
  1873*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1874*       ALTERNATE PATH1 = NONE                                   *
  1875*                                                                *
  1876*   LOG = NO                                                     *
  1877*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1878*                                                                *
  1879******************************************************************
  1880
  1881 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1882
  1883     10  ERRESC-RECORD-KEY.
  1884         15  RESC-COMPANY-CD           PIC   X.
  1885         15  RESC-CARRIER              PIC   X.
  1886         15  RESC-GROUP                PIC   X(6).
  1887         15  RESC-STATE                PIC   XX.
  1888         15  RESC-ACCOUNT              PIC   X(10).
  1889         15  RESC-AGENT                PIC   X(10).
  1890         15  RESC-RESIDENT-STATE       PIC   XX.
  1891         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1892*                                           YYYYMMDD
  1893     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1894
  1895     10  RESC-COMM-RECORD-DATA.
  1896         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1897             20 RESC-COVERAGE-CAT      PIC    X.
  1898             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1899             20 RESC-COMMISSION-TAB REDEFINES
  1900                RESC-COMMISSION-PER    PIC  XXX.
  1901
  1902     10  RESC-MAINT-BY                 PIC X(4).
  1903     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1904     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1905*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  37
* EL050.cbl
  1907*    COPY ERCPLAN.
  1908******************************************************************
  1909*                                                                *
  1910*                                                                *
  1911*                            ERCPLAN                             *
  1912*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1913*                            VMOD=2.003                          *
  1914*                                                                *
  1915*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1916*                                                                *
  1917*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1918*   PLAN MASTER                                                  *
  1919*                                                                *
  1920*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1921*                                                                *
  1922*   FILE TYPE = VSAM,KSDS                                        *
  1923*   RECORD SIZE = 420   RECFORM = FIX                            *
  1924*                                                                *
  1925*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1926*       ALTERNATE PATH1 = N/A                                    *
  1927*                                                                *
  1928*   LOG = NO                                                     *
  1929*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1930*                                                                *
  1931*                                                                *
  1932******************************************************************
  1933
  1934 01  PLAN-MASTER.
  1935     12  PL-RECORD-ID                      PIC XX.
  1936         88  VALID-PL-ID                      VALUE 'PL'.
  1937
  1938     12  PL-CONTROL-PRIMARY.
  1939         16  PL-COMPANY-CD                 PIC X.
  1940         16  PL-MSTR-CNTRL.
  1941             20  PL-CONTROL-A.
  1942                 24  PL-CARRIER            PIC X.
  1943                 24  PL-GROUPING           PIC X(6).
  1944                 24  PL-STATE              PIC XX.
  1945                 24  PL-ACCOUNT            PIC X(10).
  1946             20  PL-BENEFIT-TYPE           PIC X.
  1947             20  PL-BENEFIT-CODE           PIC XX.
  1948             20  PL-REVISION-NO            PIC X(3).
  1949
  1950     12  PL-CONTROL-BY-VAR-GRP.
  1951         16  PL-COMPANY-CD-A1              PIC X.
  1952         16  PL-VG-CARRIER                 PIC X.
  1953         16  PL-VG-GROUPING                PIC X(6).
  1954         16  PL-VG-STATE                   PIC XX.
  1955         16  PL-VG-ACCOUNT                 PIC X(10).
  1956         16  PL-BENEFIT-TYPE-A1            PIC X.
  1957         16  PL-BENEFIT-CODE-A1            PIC XX.
  1958         16  PL-REVISION-NO-A1             PIC 999.
  1959
  1960     12  PL-MAINT-INFORMATION.
  1961         16  PL-LAST-MAINT-DT              PIC XX.
  1962         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1963         16  PL-LAST-MAINT-USER            PIC X(4).
  1964         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  38
* EL050.cbl
  1965
  1966     12  PL-LIABILITY-LIMITS.
  1967         16  PL-ATT-AGE                    PIC S99        COMP-3.
  1968         16  PL-L-LIMITS        OCCURS 8 TIMES.
  1969             20  PL-LM-AGE                 PIC S99        COMP-3.
  1970             20  PL-LM-DUR                 PIC S999       COMP-3.
  1971             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  1972             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  1973
  1974     12  FILLER                            PIC X(30).
  1975
  1976     12  PL-GL-ACCOUNT-NOS.
  1977         16  PL-PREMIUM-GL                 PIC X(8).
  1978         16  PL-COMM-GL                    PIC X(8).
  1979         16  PL-CLAIM-GL                   PIC X(8).
  1980     12  FILLER                            PIC X(24).
  1981     12  PL-TOLERANCES.
  1982         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  1983         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  1984         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  1985         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  1986         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  1987         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  1988     12  PL-OVER-SHORT.
  1989         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  1990         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  1991     12  FILLER                            PIC X(24).
  1992     12  PLAN-MISC.
  1993         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  1994         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  1995         16  PL-IG                         PIC X.
  1996         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  1997         16  PL-POLICY-FORM                PIC X(12).
  1998         16  PL-EDIT-FOR-FORM              PIC X(01).
  1999         16  PL-DEV-CODE                   PIC XXX.
  2000         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2001         16  PL-CALC-METHOD                PIC X.
  2002         16  PL-BENEFIT-GROUP              PIC X(05).
  2003         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2004
  2005         16  FILLER                        PIC X(99).
  2006******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  39
* EL050.cbl
  2008*    COPY ELCCERT.
  2009******************************************************************
  2010*                                                                *
  2011*                            ELCCERT.                            *
  2012*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2013*                            VMOD=2.013                          *
  2014*                                                                *
  2015*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2016*                                                                *
  2017*   FILE TYPE = VSAM,KSDS                                        *
  2018*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2019*                                                                *
  2020*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2021*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2022*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2023*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2024*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2025*                                                                *
  2026*   LOG = YES                                                    *
  2027*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2028******************************************************************
  2029*                   C H A N G E   L O G
  2030*
  2031* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2032*-----------------------------------------------------------------
  2033*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2034* EFFECTIVE    NUMBER
  2035*-----------------------------------------------------------------
  2036* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2037* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2038* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2039* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2040* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2041* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2042* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2043******************************************************************
  2044
  2045 01  CERTIFICATE-MASTER.
  2046     12  CM-RECORD-ID                      PIC XX.
  2047         88  VALID-CM-ID                      VALUE 'CM'.
  2048
  2049     12  CM-CONTROL-PRIMARY.
  2050         16  CM-COMPANY-CD                 PIC X.
  2051         16  CM-CARRIER                    PIC X.
  2052         16  CM-GROUPING.
  2053             20  CM-GROUPING-PREFIX        PIC X(3).
  2054             20  CM-GROUPING-PRIME         PIC X(3).
  2055         16  CM-STATE                      PIC XX.
  2056         16  CM-ACCOUNT.
  2057             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2058             20  CM-ACCOUNT-PRIME          PIC X(6).
  2059         16  CM-CERT-EFF-DT                PIC XX.
  2060         16  CM-CERT-NO.
  2061             20  CM-CERT-PRIME             PIC X(10).
  2062             20  CM-CERT-SFX               PIC X.
  2063
  2064     12  CM-CONTROL-BY-NAME.
  2065         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  40
* EL050.cbl
  2066         16  CM-INSURED-LAST-NAME          PIC X(15).
  2067         16  CM-INSURED-INITIALS.
  2068             20  CM-INSURED-INITIAL1       PIC X.
  2069             20  CM-INSURED-INITIAL2       PIC X.
  2070
  2071     12  CM-CONTROL-BY-SSN.
  2072         16  CM-COMPANY-CD-A2              PIC X.
  2073         16  CM-SOC-SEC-NO.
  2074             20  CM-SSN-STATE              PIC XX.
  2075             20  CM-SSN-ACCOUNT            PIC X(6).
  2076             20  CM-SSN-LN3.
  2077                 25  CM-INSURED-INITIALS-A2.
  2078                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2079                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2080                 25 CM-PART-LAST-NAME-A2         PIC X.
  2081
  2082     12  CM-CONTROL-BY-CERT-NO.
  2083         16  CM-COMPANY-CD-A4              PIC X.
  2084         16  CM-CERT-NO-A4                 PIC X(11).
  2085
  2086     12  CM-CONTROL-BY-MEMB.
  2087         16  CM-COMPANY-CD-A5              PIC X.
  2088         16  CM-MEMBER-NO.
  2089             20  CM-MEMB-STATE             PIC XX.
  2090             20  CM-MEMB-ACCOUNT           PIC X(6).
  2091             20  CM-MEMB-LN4.
  2092                 25  CM-INSURED-INITIALS-A5.
  2093                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2094                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2095                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2096
  2097     12  CM-INSURED-PROFILE-DATA.
  2098         16  CM-INSURED-FIRST-NAME.
  2099             20  CM-INSURED-1ST-INIT       PIC X.
  2100             20  FILLER                    PIC X(9).
  2101         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2102         16  CM-INSURED-SEX                PIC X.
  2103             88  CM-SEX-MALE                  VALUE 'M'.
  2104             88  CM-SEX-FEMAL                 VALUE 'F'.
  2105         16  CM-INSURED-JOINT-AGE          PIC 99.
  2106         16  CM-JOINT-INSURED-NAME.
  2107             20  CM-JT-LAST-NAME           PIC X(15).
  2108             20  CM-JT-FIRST-NAME.
  2109                 24  CM-JT-1ST-INIT        PIC X.
  2110                 24  FILLER                PIC X(9).
  2111             20  CM-JT-INITIAL             PIC X.
  2112
  2113     12  CM-LIFE-DATA.
  2114         16  CM-LF-BENEFIT-CD              PIC XX.
  2115         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2116         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2117         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2118         16  CM-LF-DEV-CODE                PIC XXX.
  2119         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2120         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2121         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2122         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2123         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  41
* EL050.cbl
  2124         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2125         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2126         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2127         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2128         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2129         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2130         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2131         16  FILLER                        PIC XX.
  2132
  2133     12  CM-AH-DATA.
  2134         16  CM-AH-BENEFIT-CD              PIC XX.
  2135         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2136         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2137         16  CM-AH-DEV-CODE                PIC XXX.
  2138         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2139         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2140         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2141         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2142         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2143         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2144         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2145         16  CM-AH-PAID-THRU-DT            PIC XX.
  2146             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2147         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2148         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2149         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2150         16  FILLER                        PIC X.
  2151
  2152     12  CM-LOAN-INFORMATION.
  2153         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2154         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2155                                           PIC S9(5)V99  COMP-3.
  2156         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2157         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2158         16  CM-PAY-FREQUENCY              PIC S99.
  2159         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2160         16  CM-RATE-CLASS                 PIC XX.
  2161         16  CM-BENEFICIARY                PIC X(25).
  2162         16  CM-POLICY-FORM-NO             PIC X(12).
  2163         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2164         16  CM-LAST-ADD-ON-DT             PIC XX.
  2165         16  CM-DEDUCTIBLE-AMOUNTS.
  2166             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2167             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2168         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2169             20  CM-RESIDENT-STATE         PIC XX.
  2170             20  CM-RATE-CODE              PIC X(4).
  2171             20  FILLER                    PIC XX.
  2172         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2173             20  CM-LOAN-OFFICER           PIC X(5).
  2174             20  FILLER                    PIC XXX.
  2175         16  CM-CSR-CODE                   PIC XXX.
  2176         16  CM-UNDERWRITING-CODE          PIC X.
  2177             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2178         16  CM-POST-CARD-IND              PIC X.
  2179         16  CM-NH-INTERFACE-SW            PIC X.
  2180         16  CM-PREMIUM-TYPE               PIC X.
  2181             88  CM-SING-PRM                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  42
* EL050.cbl
  2182             88  CM-O-B-COVERAGE              VALUE '2'.
  2183             88  CM-OPEN-END                  VALUE '3'.
  2184         16  CM-IND-GRP-TYPE               PIC X.
  2185             88  CM-INDIVIDUAL                VALUE 'I'.
  2186             88  CM-GROUP                     VALUE 'G'.
  2187         16  CM-SKIP-CODE                  PIC X.
  2188             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2189             88  SKIP-JULY                    VALUE '1'.
  2190             88  SKIP-AUGUST                  VALUE '2'.
  2191             88  SKIP-SEPTEMBER               VALUE '3'.
  2192             88  SKIP-JULY-AUG                VALUE '4'.
  2193             88  SKIP-AUG-SEPT                VALUE '5'.
  2194             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2195             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2196             88  SKIP-JUNE                    VALUE '8'.
  2197             88  SKIP-JUNE-JULY               VALUE '9'.
  2198             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2199             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2200         16  CM-PAYMENT-MODE               PIC X.
  2201             88  PAY-MONTHLY                  VALUE SPACE.
  2202             88  PAY-WEEKLY                   VALUE '1'.
  2203             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2204             88  PAY-BI-WEEKLY                VALUE '3'.
  2205             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2206         16  CM-LOAN-NUMBER                PIC X(8).
  2207         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2208         16  CM-OLD-LOF                    PIC XXX.
  2209*        16  CM-LOAN-OFFICER               PIC XXX.
  2210         16  CM-REIN-TABLE                 PIC XXX.
  2211         16  CM-SPECIAL-REIN-CODE          PIC X.
  2212         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2213         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2214         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2215
  2216     12  CM-STATUS-DATA.
  2217         16  CM-ENTRY-STATUS               PIC X.
  2218         16  CM-ENTRY-DT                   PIC XX.
  2219
  2220         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2221         16  CM-LF-CANCEL-DT               PIC XX.
  2222         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2223
  2224         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2225         16  CM-LF-DEATH-DT                PIC XX.
  2226         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2227
  2228         16  CM-LF-CURRENT-STATUS          PIC X.
  2229             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2230                                                'M' '4' '5' '9'.
  2231             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2232             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2233             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2234             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2235             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2236             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2237             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2238             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2239             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  43
* EL050.cbl
  2240             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2241             88  CM-LF-DECLINED               VALUE 'D'.
  2242             88  CM-LF-VOIDED                 VALUE 'V'.
  2243
  2244         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2245         16  CM-AH-CANCEL-DT               PIC XX.
  2246         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2247
  2248         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2249         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2250         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2251
  2252         16  CM-AH-CURRENT-STATUS          PIC X.
  2253             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2254                                                'M' '4' '5' '9'.
  2255             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2256             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2257             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2258             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2259             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2260             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2261             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2262             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2263             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2264             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2265             88  CM-AH-DECLINED               VALUE 'D'.
  2266             88  CM-AH-VOIDED                 VALUE 'V'.
  2267
  2268         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2269             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2270             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2271             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2272         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2273
  2274         16  CM-ENTRY-BATCH                PIC X(6).
  2275         16  CM-LF-EXIT-BATCH              PIC X(6).
  2276         16  CM-AH-EXIT-BATCH              PIC X(6).
  2277         16  CM-LAST-MONTH-END             PIC XX.
  2278
  2279     12  CM-NOTE-SW                        PIC X.
  2280         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2281         88  CERT-NOTES-PRESENT               VALUE '1'.
  2282         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2283         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2284         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2285         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2286         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2287         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2288     12  CM-COMP-EXCP-SW                   PIC X.
  2289         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2290         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2291     12  CM-INSURED-ADDRESS-SW             PIC X.
  2292         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2293         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2294
  2295*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2296     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2297     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  44
* EL050.cbl
  2298
  2299*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2300     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2301     12  FILLER                            PIC X.
  2302*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2303     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2304
  2305     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2306         88  CERT-ADDED-BATCH                 VALUE ' '.
  2307         88  CERT-ADDED-ONLINE                VALUE '1'.
  2308         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2309         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2310         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2311     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2312         88  CERT-AS-LOADED                   VALUE ' '.
  2313         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2314         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2315         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2316         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2317         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2318         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2319         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2320
  2321     12  CM-ACCOUNT-COMM-PCTS.
  2322         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2323         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2324
  2325     12  CM-USER-FIELD                     PIC X.
  2326     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2327     12  CM-CLP-STATE                      PIC XX.
  2328     12  CM-USER-RESERVED                  PIC XXX.
  2329******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  45
* EL050.cbl
  2331*    COPY ERCMAIL.
  2332******************************************************************
  2333*                                                                *
  2334*                                                                *
  2335*                            ERCMAIL                             *
  2336*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2337*                            VMOD=2.003                          *
  2338*                                                                *
  2339*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2340*                                                                *
  2341*   FILE TYPE = VSAM,KSDS                                        *
  2342*   RECORD SIZE = 374   RECFORM = FIX                            *
  2343*                                                                *
  2344*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2345*   ALTERNATE PATH    = NOT USED                                 *
  2346*                                                                *
  2347*   LOG = YES                                                    *
  2348*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2349******************************************************************
  2350*                   C H A N G E   L O G
  2351*
  2352* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2353*-----------------------------------------------------------------
  2354*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2355* EFFECTIVE    NUMBER
  2356*-----------------------------------------------------------------
  2357* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2358* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2359* 111108                   PEMA  ADD CRED BENE ADDR2
  2360******************************************************************
  2361
  2362 01  MAILING-DATA.
  2363     12  MA-RECORD-ID                      PIC XX.
  2364         88  VALID-MA-ID                       VALUE 'MA'.
  2365
  2366     12  MA-CONTROL-PRIMARY.
  2367         16  MA-COMPANY-CD                 PIC X.
  2368         16  MA-CARRIER                    PIC X.
  2369         16  MA-GROUPING.
  2370             20  MA-GROUPING-PREFIX        PIC XXX.
  2371             20  MA-GROUPING-PRIME         PIC XXX.
  2372         16  MA-STATE                      PIC XX.
  2373         16  MA-ACCOUNT.
  2374             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2375             20  MA-ACCOUNT-PRIME          PIC X(6).
  2376         16  MA-CERT-EFF-DT                PIC XX.
  2377         16  MA-CERT-NO.
  2378             20  MA-CERT-PRIME             PIC X(10).
  2379             20  MA-CERT-SFX               PIC X.
  2380
  2381     12  FILLER                            PIC XX.
  2382
  2383     12  MA-ACCESS-CONTROL.
  2384         16  MA-SOURCE-SYSTEM              PIC XX.
  2385             88  MA-FROM-CREDIT                VALUE 'CR'.
  2386             88  MA-FROM-VSI                   VALUE 'VS'.
  2387             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2388             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  46
* EL050.cbl
  2389         16  MA-RECORD-ADD-DT              PIC XX.
  2390         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2391         16  MA-LAST-MAINT-DT              PIC XX.
  2392         16  MA-LAST-MAINT-BY              PIC XXXX.
  2393         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2394
  2395     12  MA-PROFILE-INFO.
  2396         16  MA-QUALIFY-CODE-1             PIC XX.
  2397         16  MA-QUALIFY-CODE-2             PIC XX.
  2398         16  MA-QUALIFY-CODE-3             PIC XX.
  2399         16  MA-QUALIFY-CODE-4             PIC XX.
  2400         16  MA-QUALIFY-CODE-5             PIC XX.
  2401
  2402         16  MA-INSURED-LAST-NAME          PIC X(15).
  2403         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2404         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2405         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2406         16  MA-INSURED-BIRTH-DT           PIC XX.
  2407         16  MA-INSURED-SEX                PIC X.
  2408             88  MA-SEX-MALE                   VALUE 'M'.
  2409             88  MA-SEX-FEMALE                 VALUE 'F'.
  2410         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2411
  2412         16  MA-ADDRESS-CORRECTED          PIC X.
  2413         16  MA-JOINT-BIRTH-DT             PIC XX.
  2414*        16  FILLER                        PIC X(12).
  2415
  2416         16  MA-ADDRESS-LINE-1             PIC X(30).
  2417         16  MA-ADDRESS-LINE-2             PIC X(30).
  2418         16  MA-CITY-STATE.
  2419             20  MA-CITY                   PIC X(28).
  2420             20  MA-ADDR-STATE             PIC XX.
  2421         16  MA-ZIP.
  2422             20  MA-ZIP-CODE.
  2423                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2424                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2425                 24  FILLER                PIC X(4).
  2426             20  MA-ZIP-PLUS4              PIC X(4).
  2427         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2428             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2429             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2430             20  FILLER                    PIC X(3).
  2431
  2432         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2433
  2434         16  FILLER                        PIC XXX.
  2435*        16  FILLER                        PIC X(10).
  2436
  2437     12  MA-CRED-BENE-INFO.
  2438         16  MA-CRED-BENE-NAME                 PIC X(25).
  2439         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2440         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2441         16  MA-CRED-BENE-CTYST.
  2442             20  MA-CRED-BENE-CITY             PIC X(28).
  2443             20  MA-CRED-BENE-STATE            PIC XX.
  2444         16  MA-CRED-BENE-ZIP.
  2445             20  MA-CB-ZIP-CODE.
  2446                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  47
* EL050.cbl
  2447                     88  MA-CB-CANADIAN-POST-CODE
  2448                                           VALUE 'A' THRU 'Z'.
  2449                 24  FILLER                    PIC X(4).
  2450             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2451         16  MA-CB-CANADIAN-POSTAL-CODE
  2452                            REDEFINES MA-CRED-BENE-ZIP.
  2453             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2454             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2455             20  FILLER                        PIC X(3).
  2456     12  MA-POST-CARD-MAIL-DATA.
  2457         16  MA-MAIL-DATA OCCURS 7.
  2458             20  MA-MAIL-TYPE              PIC X.
  2459                 88  MA-12MO-MAILING           VALUE '1'.
  2460                 88  MA-EXP-MAILING            VALUE '2'.
  2461             20  MA-MAIL-STATUS            PIC X.
  2462                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2463                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2464                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2465             20  MA-MAIL-DATE              PIC XX.
  2466     12  FILLER                            PIC XX.
  2467     12  FILLER                            PIC XX.
  2468*    12  FILLER                            PIC X(30).
  2469******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  48
* EL050.cbl
  2471*    COPY ERCPNDM.
  2472******************************************************************
  2473*                                                                *
  2474*                                                                *
  2475*                            ERCPNDM                             *
  2476*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2477*                            VMOD=2.003                          *
  2478*                                                                *
  2479*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2480*                                                                *
  2481*   FILE TYPE = VSAM,KSDS                                        *
  2482*   RECORD SIZE = 374   RECFORM = FIX                            *
  2483*                                                                *
  2484*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2485*   ALTERNATE PATH    = NOT USED                                 *
  2486*                                                                *
  2487*   LOG = YES                                                    *
  2488*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2489******************************************************************
  2490*                   C H A N G E   L O G
  2491*
  2492* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2493*-----------------------------------------------------------------
  2494*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2495* EFFECTIVE    NUMBER
  2496*-----------------------------------------------------------------
  2497* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2498* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2499* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2500******************************************************************
  2501
  2502 01  PENDING-MAILING-DATA.
  2503     12  PM-RECORD-ID                      PIC XX.
  2504         88  VALID-MA-ID                       VALUE 'PM'.
  2505
  2506     12  PM-CONTROL-PRIMARY.
  2507         16  PM-COMPANY-CD                 PIC X.
  2508         16  PM-ENTRY-BATCH                PIC X(6).
  2509         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2510         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2511
  2512     12  FILLER                            PIC X(14).
  2513
  2514     12  PM-ACCESS-CONTROL.
  2515         16  PM-SOURCE-SYSTEM              PIC XX.
  2516             88  PM-FROM-CREDIT                VALUE 'CR'.
  2517             88  PM-FROM-VSI                   VALUE 'VS'.
  2518             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2519             88  PM-FROM-OTHER                 VALUE 'OT'.
  2520         16  PM-RECORD-ADD-DT              PIC XX.
  2521         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2522         16  PM-LAST-MAINT-DT              PIC XX.
  2523         16  PM-LAST-MAINT-BY              PIC XXXX.
  2524         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2525
  2526     12  PM-PROFILE-INFO.
  2527         16  PM-QUALIFY-CODE-1             PIC XX.
  2528         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  49
* EL050.cbl
  2529         16  PM-QUALIFY-CODE-3             PIC XX.
  2530         16  PM-QUALIFY-CODE-4             PIC XX.
  2531         16  PM-QUALIFY-CODE-5             PIC XX.
  2532
  2533         16  PM-INSURED-LAST-NAME          PIC X(15).
  2534         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2535         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2536         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2537         16  PM-INSURED-BIRTH-DT           PIC XX.
  2538         16  PM-INSURED-SEX                PIC X.
  2539             88  PM-SEX-MALE                   VALUE 'M'.
  2540             88  PM-SEX-FEMALE                 VALUE 'F'.
  2541         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2542
  2543         16  PM-ADDRESS-CORRECTED          PIC X.
  2544         16  PM-JOINT-BIRTH-DT             PIC XX.
  2545*        16  FILLER                        PIC X(12).
  2546
  2547         16  PM-ADDRESS-LINE-1             PIC X(30).
  2548         16  PM-ADDRESS-LINE-2             PIC X(30).
  2549         16  PM-CITY-STATE.
  2550             20  PM-CITY                   PIC X(28).
  2551             20  PM-STATE                  PIC XX.
  2552         16  PM-ZIP.
  2553             20  PM-ZIP-CODE.
  2554                 24  PM-ZIP-1              PIC X.
  2555                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2556                 24  FILLER                PIC X(4).
  2557             20  PM-ZIP-PLUS4              PIC X(4).
  2558         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2559             20  PM-CAN-POST1              PIC XXX.
  2560             20  PM-CAN-POST2              PIC XXX.
  2561             20  FILLER                    PIC XXX.
  2562
  2563         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2564
  2565         16  FILLER                        PIC X(03).
  2566
  2567     12  PM-CRED-BENE-INFO.
  2568         16  PM-CRED-BENE-NAME             PIC X(25).
  2569         16  PM-CRED-BENE-ADDR             PIC X(30).
  2570         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2571         16  PM-CRED-BENE-CTYST.
  2572             20  PM-CRED-BENE-CITY         PIC X(28).
  2573             20  PM-CRED-BENE-STATE        PIC XX.
  2574         16  PM-CRED-BENE-ZIP.
  2575             20  PM-CB-ZIP-CODE.
  2576                 24  PM-CB-ZIP-1           PIC X.
  2577                     88  PM-CB-CANADIAN-POST-CODE
  2578                                  VALUE 'A' THRU 'Z'.
  2579                 24  FILLER                PIC X(4).
  2580             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2581         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2582             20  PM-CB-CAN-POST1           PIC XXX.
  2583             20  PM-CB-CAN-POST2           PIC XXX.
  2584             20  FILLER                    PIC XXX.
  2585     12  PM-POST-CARD-MAIL-DATA.
  2586         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  50
* EL050.cbl
  2587             20  PM-MAIL-TYPE              PIC X.
  2588                 88  PM-12MO-MAILING           VALUE '1'.
  2589                 88  PM-EXP-MAILING            VALUE '2'.
  2590             20  PM-MAIL-STATUS            PIC X.
  2591                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2592                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2593                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2594             20  PM-MAIL-DATE              PIC XX.
  2595     12  FILLER                            PIC XX.
  2596     12  FILLER                            PIC X(12).
  2597*    12  FILLER                            PIC X(30).
  2598
  2599******************************************************************
  2600*                                COPY ERCLOFC.
  2601******************************************************************
  2602*                                                                *
  2603*                                                                *
  2604*                            ERCLOFC                             *
  2605*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2606*                            VMOD=2.003                          *
  2607*                                                                *
  2608*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2609*                                                                *
  2610*   FILE TYPE = VSAM,KSDS                                        *
  2611*   RECORD SIZE = 670   RECFORM = FIX                            *
  2612*                                                                *
  2613*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2614*                                                                *
  2615*   LOG = YES                                                    *
  2616*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2617*                                                                *
  2618******************************************************************
  2619
  2620 01  LOAN-OFFICER-MASTER.
  2621     12  LO-RECORD-ID                PIC XX.
  2622         88  VALID-LO-ID                VALUE 'LO'.
  2623
  2624     12  LO-CONTROL-PRIMARY.
  2625         16  LO-COMPANY-CD           PIC X.
  2626         16  LO-CARRIER              PIC X.
  2627         16  LO-GROUPING.
  2628             20  LO-GROUPING-PREFIX  PIC XXX.
  2629             20  LO-GROUPING-PRIME   PIC XXX.
  2630         16  LO-STATE                PIC XX.
  2631         16  LO-ACCOUNT.
  2632             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2633             20  LO-ACCOUNT-PRIME    PIC X(6).
  2634         16  LO-OFFICER-CODE         PIC X(5).
  2635
  2636     12  LO-OFFICER-NAME             PIC X(30).
  2637
  2638     12  LO-LAST-MAINT-DT            PIC XX.
  2639     12  LO-LAST-USER                PIC X(4).
  2640     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2641
  2642     12  LO-COMP-CONTROL             PIC X.
  2643             88  LO-SHOW-COMP           VALUE 'Y'.
  2644             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  51
* EL050.cbl
  2645     12  LO-DETAIL-CONTROL           PIC X.
  2646             88  LO-PRINT-DETAIL        VALUE 'D'.
  2647             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2648
  2649     12  LO-SV-CARRIER               PIC X.
  2650     12  LO-SV-GROUPING              PIC X(6).
  2651     12  LO-SV-STATE                 PIC XX.
  2652
  2653     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2654     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2655
  2656     12  LO-OFFICER-INFO.
  2657         16  FILLER OCCURS 12 TIMES.
  2658             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2659             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2660             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2661             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2662             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2663             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2664             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2665             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2666     12  FILLER                      PIC X(198).
  2667******************************************************************
  2668*                                COPY ERCPDEF.
  2669******************************************************************
  2670*                                                                *
  2671*                                                                *
  2672*                            ERCPDEF.                            *
  2673*                                                                *
  2674*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2675*                                                                *
  2676*    FILE TYPE = VSAM,KSDS                                       *
  2677*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2678*                                                                *
  2679*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2680*                                                                *
  2681*    LOG = YES                                                   *
  2682*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2683******************************************************************
  2684 01  PRODUCT-MASTER.
  2685    12  PD-RECORD-ID                 PIC X(02).
  2686        88  VALID-PD-ID                  VALUE 'PD'.
  2687    12  PD-CONTROL-PRIMARY.
  2688        16  PD-COMPANY-CD            PIC X.
  2689        16  PD-STATE                 PIC XX.
  2690        16  PD-PRODUCT-CD            PIC XXX.
  2691        16  PD-FILLER                PIC X(7).
  2692        16  PD-BEN-TYPE              PIC X.
  2693        16  PD-BEN-CODE              PIC XX.
  2694        16  PD-PROD-EXP-DT           PIC XX.
  2695    12  FILLER                       PIC X(50).
  2696    12  PD-PRODUCT-DATA OCCURS 8.
  2697        16  PD-PROD-CODE             PIC X.
  2698            88  PD-PROD-LIFE           VALUE 'L'.
  2699            88  PD-PROD-PROP           VALUE 'P'.
  2700            88  PD-PROD-AH             VALUE 'A'.
  2701            88  PD-PROD-IU             VALUE 'I'.
  2702            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  52
* EL050.cbl
  2703        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2704        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2705        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2706        16  PD-MAX-TERM              PIC S999        COMP-3.
  2707        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2708        16  FILLER                   PIC X.
  2709        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2710        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2711        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2712        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2713        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2714        16  PD-REC-CRIT-PERIOD       PIC X.
  2715        16  PD-RTW-MOS               PIC 99.
  2716        16  FILLER                   PIC X(5).
  2717    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2718    12  PD-TERM-LIMITS OCCURS 15.
  2719        16  PD-LOW-TERM              PIC S999        COMP-3.
  2720        16  PD-HI-TERM               PIC S999        COMP-3.
  2721*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2722    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2723        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2724        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2725    12  PD-EARN-FACTORS.
  2726        16  FILLER OCCURS 15.
  2727            20  FILLER OCCURS 15.
  2728                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2729    12  PD-PRODUCT-DESC              PIC X(80).
  2730    12  FILLER                       PIC X(60).
  2731    12  PD-MAINT-INFORMATION.
  2732        16  PD-LAST-MAINT-DT         PIC X(02).
  2733        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2734        16  PD-LAST-MAINT-BY         PIC X(04).
  2735*                                COPY ELCSTATE.
  2736******************************************************************
  2737*                                                                *
  2738*                                                                *
  2739*                            ELCSTATE.                           *
  2740*                                                                *
  2741*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2742*                                                                *
  2743*   FILE TYPE = VSAM,KSDS                                        *
  2744*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2745*                                                                *
  2746*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2747*       ALTERNATE INDEX = NONE                                   *
  2748*                                                                *
  2749*   LOG = YES                                                    *
  2750*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2751******************************************************************
  2752*                   C H A N G E   L O G
  2753*
  2754* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2755*-----------------------------------------------------------------
  2756*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2757* EFFECTIVE    NUMBER
  2758*-----------------------------------------------------------------
  2759* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2760******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  53
* EL050.cbl
  2761*
  2762 01  STATE-FILE.
  2763     12  SF-RECORD-ID                       PIC XX.
  2764         88  VALID-CF-ID                        VALUE 'SF'.
  2765     12  SF-CONTROL-PRIMARY.
  2766         16  SF-COMPANY-ID                  PIC XXX.
  2767         16  SF-CARRIER-CODE                PIC X.
  2768         16  SF-GROUPING                    PIC X(6).
  2769         16  SF-STATE-CODE                  PIC XX.
  2770         16  SF-EXPIRE-DATE                 PIC 9(8).
  2771****************************************************************
  2772*             STATE CONTROLS
  2773****************************************************************
  2774     12  SF-LAST-MAINT-DT                   PIC XX.
  2775     12  SF-LAST-MAINT-BY                   PIC X(4).
  2776     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2777     12  SF-STATE-RT-CONTROLS.
  2778         16  SF-ST-RT-CALC                  PIC X.
  2779     12  SF-ST-TAX-CONTROLS.
  2780         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2781         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2782         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2783     12  SF-ST-REFUND-OPTIONS.
  2784         16  SF-ST-RF-LR-CALC               PIC X.
  2785         16  SF-ST-RF-LL-CALC               PIC X.
  2786         16  SF-ST-RF-LN-CALC               PIC X.
  2787         16  SF-ST-RF-AH-CALC               PIC X.
  2788         16  SF-ST-RF-CP-CALC               PIC X.
  2789     12  SF-ST-UNEARN-PREM-OPTIONS.
  2790         16  SF-ST-LUEP-R78                 PIC X.
  2791         16  SF-ST-LUEP-PRO                 PIC X.
  2792         16  SF-ST-LUEP-ST                  PIC X.
  2793         16  SF-ST-LUEP-DOM                 PIC X.
  2794         16  SF-ST-AUEP-R78                 PIC X.
  2795         16  SF-ST-AUEP-PRO                 PIC X.
  2796         16  SF-ST-AUEP-ST                  PIC X.
  2797         16  SF-ST-AUEP-DOM                 PIC X.
  2798         16  SF-ST-CUEP-R78                 PIC X.
  2799         16  SF-ST-CUEP-PRO                 PIC X.
  2800         16  SF-ST-CUEP-ST                  PIC X.
  2801         16  SF-ST-CUEP-DOM                 PIC X.
  2802     12  SF-ST-EARN-PREM-OPTIONS.
  2803         16  SF-ST-LEP-R78                  PIC X.
  2804         16  SF-ST-LEP-PRO                  PIC X.
  2805         16  SF-ST-LEP-ST                   PIC X.
  2806         16  SF-ST-LEP-DOM                  PIC X.
  2807         16  SF-ST-AEP-R78                  PIC X.
  2808         16  SF-ST-AEP-PRO                  PIC X.
  2809         16  SF-ST-AEP-ST                   PIC X.
  2810         16  SF-ST-AEP-DOM                  PIC X.
  2811         16  SF-ST-CEP-R78                  PIC X.
  2812         16  SF-ST-CEP-PRO                  PIC X.
  2813         16  SF-ST-CEP-ST                   PIC X.
  2814         16  SF-ST-CEP-DOM                  PIC X.
  2815     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  54
* EL050.cbl
  2817*    COPY ELCCRTT.
  2818******************************************************************
  2819*                                                                *
  2820*                            ELCCRTT.                            *
  2821*                                                                *
  2822*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2823*                                                                *
  2824*   FILE TYPE = VSAM,KSDS                                        *
  2825*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2826*                                                                *
  2827*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2828*                                                                *
  2829*   LOG = YES                                                    *
  2830*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2831******************************************************************
  2832*                   C H A N G E   L O G
  2833*
  2834* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2835*-----------------------------------------------------------------
  2836*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2837* EFFECTIVE    NUMBER
  2838*-----------------------------------------------------------------
  2839* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2840* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2841* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2842******************************************************************
  2843
  2844 01  CERTIFICATE-TRAILERS.
  2845     12  CS-RECORD-ID                      PIC XX.
  2846         88  VALID-CS-ID                      VALUE 'CS'.
  2847
  2848     12  CS-CONTROL-PRIMARY.
  2849         16  CS-COMPANY-CD                 PIC X.
  2850         16  CS-CARRIER                    PIC X.
  2851         16  CS-GROUPING                   PIC X(6).
  2852         16  CS-STATE                      PIC XX.
  2853         16  CS-ACCOUNT                    PIC X(10).
  2854         16  CS-CERT-EFF-DT                PIC XX.
  2855         16  CS-CERT-NO.
  2856             20  CS-CERT-PRIME             PIC X(10).
  2857             20  CS-CERT-SFX               PIC X.
  2858         16  CS-TRAILER-TYPE               PIC X.
  2859             88  COMM-TRLR           VALUE 'A'.
  2860             88  FUTURE-TRLR         VALUE 'B'.
  2861             88  CERT-DATA-TRLR      VALUE 'C'.
  2862
  2863     12  CS-DATA-AREA                      PIC X(516).
  2864
  2865     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2866         16  CS-BANK-COMMISSION-AREA.
  2867             20  CS-BANK-COMMS       OCCURS 10.
  2868                 24  CS-AGT                PIC X(10).
  2869                 24  CS-COM-TYP            PIC X.
  2870                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2871                 24  CS-RECALC-LV-INDIC    PIC X.
  2872                 24  FILLER                PIC X(10).
  2873         16  FILLER                        PIC X(256).
  2874
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  55
* EL050.cbl
  2875     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2876         16  CS-VIN-NUMBER                 PIC X(17).
  2877         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2878         16  FILLER                        PIC X(498).
  2879******************************************************************
  2880
  2881*    COPY ELCDATE.
  2882******************************************************************
  2883*                                                                *
  2884*                                                                *
  2885*                            ELCDATE.                            *
  2886*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2887*                            VMOD=2.003
  2888*                                                                *
  2889*                                                                *
  2890*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2891*                 LENGTH = 200                                   *
  2892******************************************************************
  2893
  2894 01  DATE-CONVERSION-DATA.
  2895     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2896     12  DC-OPTION-CODE                PIC X.
  2897         88  BIN-TO-GREG                VALUE ' '.
  2898         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2899         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2900         88  YMD-GREG-TO-BIN            VALUE '3'.
  2901         88  MDY-GREG-TO-BIN            VALUE '4'.
  2902         88  JULIAN-TO-BIN              VALUE '5'.
  2903         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2904         88  FIND-CENTURY               VALUE '7'.
  2905         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2906         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2907         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2908         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2909         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2910         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2911         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2912         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2913         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2914         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2915         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2916         88  BIN-3-TO-GREG              VALUE 'I'.
  2917         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2918         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2919         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2920         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2921         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2922         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2923         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2924         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2925         88  THREE-CHARACTER-BIN
  2926                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2927         88  GREGORIAN-TO-BIN
  2928                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2929         88  BIN-TO-GREGORIAN
  2930                  VALUES ' ' '1' 'I' '8' 'G'.
  2931         88  JULIAN-TO-BINARY
  2932                  VALUES '5' 'C' 'E' 'F'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  56
* EL050.cbl
  2933     12  DC-ERROR-CODE                 PIC X.
  2934         88  NO-CONVERSION-ERROR        VALUE ' '.
  2935         88  DATE-CONVERSION-ERROR
  2936                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2937         88  DATE-IS-ZERO               VALUE '1'.
  2938         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2939         88  DATE-IS-INVALID            VALUE '3'.
  2940         88  DATE1-GREATER-DATE2        VALUE '4'.
  2941         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2942         88  DATE-INVALID-OPTION        VALUE '9'.
  2943         88  INVALID-CENTURY            VALUE 'A'.
  2944         88  ONLY-CENTURY               VALUE 'B'.
  2945         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2946         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2947     12  DC-END-OF-MONTH               PIC X.
  2948         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2949     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2950         88  USE-NORMAL-PROCESS         VALUE ' '.
  2951         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2952         88  ADJUST-UP-100-YRS          VALUE '2'.
  2953     12  FILLER                        PIC X.
  2954     12  DC-CONVERSION-DATES.
  2955         16  DC-BIN-DATE-1             PIC XX.
  2956         16  DC-BIN-DATE-2             PIC XX.
  2957         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2958         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2959                       DC-GREG-DATE-1-EDIT.
  2960             20  DC-EDIT1-MONTH        PIC 99.
  2961             20  SLASH1-1              PIC X.
  2962             20  DC-EDIT1-DAY          PIC 99.
  2963             20  SLASH1-2              PIC X.
  2964             20  DC-EDIT1-YEAR         PIC 99.
  2965         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2966         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2967                     DC-GREG-DATE-2-EDIT.
  2968             20  DC-EDIT2-MONTH        PIC 99.
  2969             20  SLASH2-1              PIC X.
  2970             20  DC-EDIT2-DAY          PIC 99.
  2971             20  SLASH2-2              PIC X.
  2972             20  DC-EDIT2-YEAR         PIC 99.
  2973         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2974         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2975                     DC-GREG-DATE-1-YMD.
  2976             20  DC-YMD-YEAR           PIC 99.
  2977             20  DC-YMD-MONTH          PIC 99.
  2978             20  DC-YMD-DAY            PIC 99.
  2979         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2980         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2981                      DC-GREG-DATE-1-MDY.
  2982             20  DC-MDY-MONTH          PIC 99.
  2983             20  DC-MDY-DAY            PIC 99.
  2984             20  DC-MDY-YEAR           PIC 99.
  2985         16  DC-GREG-DATE-1-ALPHA.
  2986             20  DC-ALPHA-MONTH        PIC X(10).
  2987             20  DC-ALPHA-DAY          PIC 99.
  2988             20  FILLER                PIC XX.
  2989             20  DC-ALPHA-CENTURY.
  2990                 24 DC-ALPHA-CEN-N     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  57
* EL050.cbl
  2991             20  DC-ALPHA-YEAR         PIC 99.
  2992         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2993         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2994         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2995         16  DC-JULIAN-DATE            PIC 9(05).
  2996         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2997                                       PIC 9(05).
  2998         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2999             20  DC-JULIAN-YEAR        PIC 99.
  3000             20  DC-JULIAN-DAYS        PIC 999.
  3001         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3002         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3003         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3004     12  DATE-CONVERSION-VARIBLES.
  3005         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3006         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3007             20  FILLER                PIC 9(3).
  3008             20  HOLD-CEN-1-CCYY.
  3009                 24  HOLD-CEN-1-CC     PIC 99.
  3010                 24  HOLD-CEN-1-YY     PIC 99.
  3011             20  HOLD-CEN-1-MO         PIC 99.
  3012             20  HOLD-CEN-1-DA         PIC 99.
  3013         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3014             20  HOLD-CEN-1-R-MO       PIC 99.
  3015             20  HOLD-CEN-1-R-DA       PIC 99.
  3016             20  HOLD-CEN-1-R-CCYY.
  3017                 24  HOLD-CEN-1-R-CC   PIC 99.
  3018                 24  HOLD-CEN-1-R-YY   PIC 99.
  3019             20  FILLER                PIC 9(3).
  3020         16  HOLD-CENTURY-1-X.
  3021             20  FILLER                PIC X(3)  VALUE SPACES.
  3022             20  HOLD-CEN-1-X-CCYY.
  3023                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3024                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3025             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3026             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3027         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3028             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3029             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3030             20  HOLD-CEN-1-R-X-CCYY.
  3031                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3032                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3033             20  FILLER                PIC XXX.
  3034         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3035         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3036         16  DC-JULIAN-DATE-1          PIC 9(07).
  3037         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3038             20  DC-JULIAN-1-CCYY.
  3039                 24  DC-JULIAN-1-CC    PIC 99.
  3040                 24  DC-JULIAN-1-YR    PIC 99.
  3041             20  DC-JULIAN-DA-1        PIC 999.
  3042         16  DC-JULIAN-DATE-2          PIC 9(07).
  3043         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3044             20  DC-JULIAN-2-CCYY.
  3045                 24  DC-JULIAN-2-CC    PIC 99.
  3046                 24  DC-JULIAN-2-YR    PIC 99.
  3047             20  DC-JULIAN-DA-2        PIC 999.
  3048         16  DC-GREG-DATE-A-EDIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  58
* EL050.cbl
  3049             20  DC-EDITA-MONTH        PIC 99.
  3050             20  SLASHA-1              PIC X VALUE '/'.
  3051             20  DC-EDITA-DAY          PIC 99.
  3052             20  SLASHA-2              PIC X VALUE '/'.
  3053             20  DC-EDITA-CCYY.
  3054                 24  DC-EDITA-CENT     PIC 99.
  3055                 24  DC-EDITA-YEAR     PIC 99.
  3056         16  DC-GREG-DATE-B-EDIT.
  3057             20  DC-EDITB-MONTH        PIC 99.
  3058             20  SLASHB-1              PIC X VALUE '/'.
  3059             20  DC-EDITB-DAY          PIC 99.
  3060             20  SLASHB-2              PIC X VALUE '/'.
  3061             20  DC-EDITB-CCYY.
  3062                 24  DC-EDITB-CENT     PIC 99.
  3063                 24  DC-EDITB-YEAR     PIC 99.
  3064         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3065         16  DC-GREG-DATE-CYMD-R REDEFINES
  3066                              DC-GREG-DATE-CYMD.
  3067             20  DC-CYMD-CEN           PIC 99.
  3068             20  DC-CYMD-YEAR          PIC 99.
  3069             20  DC-CYMD-MONTH         PIC 99.
  3070             20  DC-CYMD-DAY           PIC 99.
  3071         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3072         16  DC-GREG-DATE-MDCY-R REDEFINES
  3073                              DC-GREG-DATE-MDCY.
  3074             20  DC-MDCY-MONTH         PIC 99.
  3075             20  DC-MDCY-DAY           PIC 99.
  3076             20  DC-MDCY-CEN           PIC 99.
  3077             20  DC-MDCY-YEAR          PIC 99.
  3078    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3079        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3080    12  DC-EL310-DATE                  PIC X(21).
  3081    12  FILLER                         PIC X(28).
  3082
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  59
* EL050.cbl
  3084*    COPY ELCCALC.
  3085******************************************************************
  3086*                                                                *
  3087*                           ELCCALC.                            *
  3088*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3089*                            VMOD=2.025                          *
  3090*                                                                *
  3091*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3092*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3093*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3094*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3095*                                                                *
  3096*  PASSED TO ELRTRM                                              *
  3097*  -----------------                                             *
  3098*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3099*  ORIGINAL TERM                                                 *
  3100*  BEGINNING DATE                                                *
  3101*  ENDING DATE                                                   *
  3102*  COMPANY I.D.                                                  *
  3103*  ACCOUNT MASTER USER FIELD                                     *
  3104*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3105*  FREE LOOK DAYS                                                *
  3106*                                                                *
  3107*  RETURNED FROM ELRTRM                                          *
  3108*  ---------------------                                         *
  3109*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3110*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3111*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3112*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3113*----------------------------------------------------------------*
  3114*  PASSED TO ELRAMT                                              *
  3115*  ----------------                                              *
  3116*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3117*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3118*  ORIGINAL AMOUNT                                               *
  3119*  ALTERNATE BENEFIT (BALLON)                                    *
  3120*  A.P.R. - NET PAY ONLY                                         *
  3121*  METHOD
  3122*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3123*  COMPANY I.D.                                                  *
  3124*  BENEFIT TYPE                                                  *
  3125*                                                                *
  3126*  RETURNED FROM ELRAMT                                          *
  3127*  --------------------                                          *
  3128*  REMAINING AMOUNT 1 - CURRENT                                  *
  3129*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3130*  REMAINING AMOUNT FACTOR
  3131*----------------------------------------------------------------*
  3132*  PASSED TO ELRESV                                              *
  3133*  -----------------                                             *
  3134*  CERTIFICATE EFFECTIVE DATE                                    *
  3135*  VALUATION DATE                                                *
  3136*  PAID THRU DATE                                                *
  3137*  BENEFIT                                                       *
  3138*  INCURRED DATE                                                 *
  3139*  REPORTED DATE                                                 *
  3140*  ISSUE AGE                                                     *
  3141*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  60
* EL050.cbl
  3142*  CDT PERCENT                                                   *
  3143*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3144* *CLAIM TYPE (LIFE, A/H)                                        *
  3145* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3146* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3147*                                                                *
  3148*  RETURNED FROM ELRESV                                          *
  3149*  --------------------                                          *
  3150*  CDT TABLE USED                                                *
  3151*  CDT FACTOR USED                                               *
  3152*  PAY TO CURRENT RESERVE                                        *
  3153*  I.B.N.R. - A/H ONLY                                           *
  3154*  FUTURE (ACCRUED) AH ONLY                                      *
  3155*----------------------------------------------------------------*
  3156*  PASSED TO ELRATE                                              *
  3157*  ----------------                                              *
  3158*  CERT ISSUE DATE                                               *
  3159*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3160*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3161*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3162*  STATE CODE (CLIENT DEFINED)                                   *
  3163*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3164*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3165*  DEVIATION CODE                                                *
  3166*  ISSUE AGE                                                     *
  3167*  ORIGINAL BENEFIT AMOUNT                                       *
  3168*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3169*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3170*  BENEFIT KIND (LIFE OR A/H)                                    *
  3171*  A.P.R.                                                        *
  3172*  METHOD
  3173*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3174*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3175*  COMPANY I.D. (3 CHARACTER)                                    *
  3176*  BENEFIT CODE                                                  *
  3177*  BENEFIT OVERRIDE CODE                                         *
  3178*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3179*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3180*  JOINT INDICATOR (CSL ONLY)                                    *
  3181*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3182*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3183*                                                                *
  3184*  RETURNED FROM ELRATE                                          *
  3185*  --------------------                                          *
  3186*  CALCULATED PREMIUM                                            *
  3187*  PREMIUM RATE                                                  *
  3188*  MORTALITY CODE                                                *
  3189*  MAX ATTAINED AGE                                              *
  3190*  MAX AGE                                                       *
  3191*  MAX TERM                                                      *
  3192*  MAX MONTHLY BENEFIT                                           *
  3193*  MAX TOTAL BENIFIT                                             *
  3194*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3195*----------------------------------------------------------------*
  3196*  PASSED TO ELRFND                                              *
  3197*  ----------------                                              *
  3198*  CERT ISSUE DATE                                               *
  3199*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  61
* EL050.cbl
  3200*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3201*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3202*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3203*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3204*  STATE CODE (CLIENT DEFINED)                                   *
  3205*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3206*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3207*  DEVIATION CODE                                                *
  3208*  ISSUE AGE                                                     *
  3209*  ORIGINAL BENEFIT AMOUNT                                       *
  3210*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3211*  PROCESS TYPE (CANCEL)                                         *
  3212*  BENEFIT KIND (LIFE OR A/H)                                    *
  3213*  A.P.R.                                                        *
  3214*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3215*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3216*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3217*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3218*  COMPANY I.D. (3 CHARACTER)                                    *
  3219*  BENEFIT CODE                                                  *
  3220*  BENEFIT OVERRIDE CODE                                         *
  3221*                                                                *
  3222*  RETURNED FROM ELRFND                                          *
  3223*  --------------------                                          *
  3224*  CALCULATED REFUND                                             *
  3225*----------------------------------------------------------------*
  3226*  PASSED TO ELEARN                                              *
  3227*  ----------------                                              *
  3228*  CERT ISSUE DATE                                               *
  3229*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3230*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3231*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3232*  STATE CODE (CLIENT DEFINED)                                   *
  3233*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3234*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3235*  DEVIATION CODE                                                *
  3236*  ISSUE AGE                                                     *
  3237*  ORIGINAL BENEFIT AMOUNT                                       *
  3238*  BENEFIT KIND (LIFE OR A/H)                                    *
  3239*  A.P.R.                                                        *
  3240*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3241*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3242*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3243*  COMPANY I.D. (3 CHARACTER)                                    *
  3244*  BENEFIT CODE                                                  *
  3245*  BENEFIT OVERRIDE CODE                                         *
  3246*                                                                *
  3247*  RETURNED FROM ELEARN                                          *
  3248*  --------------------                                          *
  3249*  INDICATED  EARNINGS                                           *
  3250*----------------------------------------------------------------*
  3251*                 LENGTH = 450                                   *
  3252*                                                                *
  3253******************************************************************
  3254******************************************************************
  3255*                   C H A N G E   L O G
  3256*
  3257* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  62
* EL050.cbl
  3258*-----------------------------------------------------------------
  3259*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3260* EFFECTIVE    NUMBER
  3261*-----------------------------------------------------------------
  3262* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3263* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3264* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3265* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3266* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3267* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3268* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3269* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3270* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3271******************************************************************
  3272
  3273 01  CALCULATION-PASS-AREA.
  3274     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3275                                     COMP.
  3276
  3277     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3278       88  NO-CP-ERROR                             VALUE ZERO.
  3279       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3280                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3281       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3282       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3283       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3284       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3285       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3286       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3287       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3288       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3289       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3290       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3291       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3292       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3293       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3294       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3295       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3296       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3297       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3298
  3299     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3300       88  NO-CP-ERROR-2                           VALUE ZERO.
  3301***********************  INPUT AREAS ****************************
  3302
  3303     12  CP-CALCULATION-AREA.
  3304         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3305         16  CP-CERT-EFF-DT        PIC XX.
  3306         16  CP-VALUATION-DT       PIC XX.
  3307         16  CP-PAID-THRU-DT       PIC XX.
  3308         16  CP-BENEFIT-TYPE       PIC X.
  3309           88  CP-AH                               VALUE 'A' 'D'
  3310                                                   'I' 'U'.
  3311           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3312           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3313         16  CP-INCURRED-DT        PIC XX.
  3314         16  CP-REPORTED-DT        PIC XX.
  3315         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  63
* EL050.cbl
  3316         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3317         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3318                                     COMP-3.
  3319         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3320                                     COMP-3.
  3321         16  CP-CDT-METHOD         PIC X.
  3322           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3323           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3324           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3325         16  CP-CLAIM-TYPE         PIC X.
  3326           88  CP-AH-CLAIM                         VALUE 'A'.
  3327           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3328         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3329                                     COMP-3.
  3330         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3331                                     COMP-3.
  3332         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3333                                     COMP-3.
  3334         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3335                                     COMP-3.
  3336         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3337                                     COMP-3.
  3338         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3339                                     COMP-3.
  3340         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3341                                     COMP-3.
  3342         16  CP-REM-TERM-METHOD    PIC X.
  3343           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3344           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3345           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3346           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3347           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3348           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3349           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3350         16  CP-EARNING-METHOD     PIC X.
  3351           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3352           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3353           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3354           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3355           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3356           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3357           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3358           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3359           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3360           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3361           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3362           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3363           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3364           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3365         16  CP-PROCESS-TYPE       PIC X.
  3366           88  CP-CLAIM                            VALUE '1'.
  3367           88  CP-CANCEL                           VALUE '2'.
  3368           88  CP-ISSUE                            VALUE '3'.
  3369         16  CP-SPECIAL-CALC-CD    PIC X.
  3370           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3371           88  CP-1-MTH-INTEREST               VALUE ' '.
  3372           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3373           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  64
* EL050.cbl
  3374           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3375           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3376           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3377           88  CP-FARM-PLAN                    VALUE 'F'.
  3378           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3379           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3380           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3381           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3382           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3383           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3384           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3385           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3386           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3387           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3388                                                     'W' 'X'.
  3389           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3390           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3391           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3392           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3393           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3394           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3395           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3396           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3397           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3398           88  CP-CSL-METH-1                   VALUE '5'.
  3399           88  CP-CSL-METH-2                   VALUE '6'.
  3400           88  CP-CSL-METH-3                   VALUE '7'.
  3401           88  CP-CSL-METH-4                   VALUE '8'.
  3402
  3403         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3404                                     COMP-3.
  3405         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3406         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3407         16  CP-STATE              PIC XX          VALUE SPACE.
  3408         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3409         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3410           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3411               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3412         16  CP-R78-OPTION         PIC X.
  3413           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3414           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3415
  3416         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3417         16  CP-IBNR-RESERVE-SW    PIC X.
  3418         16  CP-CLAIM-STATUS       PIC X.
  3419         16  CP-RATE-FILE          PIC X.
  3420         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3421                                     COMP-3.
  3422
  3423         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3424         16  CP-AH-OVERRIDE-CODE   PIC X.
  3425
  3426         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3427                                     COMP-3.
  3428         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3429                                   PIC S9(5)V99 COMP-3.
  3430         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3431                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  65
* EL050.cbl
  3432         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3433                                     COMP-3.
  3434         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3435                                     COMP-3.
  3436         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3437                                  PIC S9(7)V99 COMP-3.
  3438
  3439         16  CP-PAID-FROM-DATE     PIC X(02).
  3440         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3441         16  CP-EXT-DAYS-CALC      PIC X.
  3442           88  CP-EXT-NO-CHG                   VALUE ' '.
  3443           88  CP-EXT-CHG-LF                   VALUE '1'.
  3444           88  CP-EXT-CHG-AH                   VALUE '2'.
  3445           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3446         16  CP-DOMICILE-STATE     PIC XX.
  3447         16  CP-CARRIER            PIC X.
  3448         16  CP-REIN-FLAG          PIC X.
  3449         16  CP-REM-TRM-CALC-OPTION PIC X.
  3450           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3451                      '2' '3' '4' '5'.
  3452           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3453           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3454           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3455           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3456           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3457           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3458           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3459           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3460         16  CP-SIG-SWITCH         PIC X.
  3461         16  CP-RATING-METHOD      PIC X.
  3462           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3463           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3464           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3465           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3466           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3467           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3468           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3469           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3470           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3471         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3472                                     COMP-3.
  3473         16  CP-BEN-CATEGORY       PIC X.
  3474         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3475         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3476                                   PIC S99V9(5) COMP-3.
  3477         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3478         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3479                                   PIC S99V9(5) COMP-3.
  3480         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3481         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3482         16  CP-EXPIRE-DT          PIC XX.
  3483         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3484         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3485         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3486         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3487         16  CP-DDF-SPEC-CALC      PIC X.
  3488             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3489             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  66
* EL050.cbl
  3490         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3491         16  CP-CANCEL-REASON      PIC X.
  3492         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3493         16  CP-PMT-MODE           PIC X.
  3494         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3495         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3496         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3497         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3498         16  FILLER                PIC X.
  3499
  3500***************    OUTPUT FROM ELRESV   ************************
  3501
  3502         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3503
  3504         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3505                                     COMP-3.
  3506         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3507                                     COMP-3.
  3508         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3509                                     COMP-3.
  3510         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3511                                     COMP-3.
  3512         16  FILLER                PIC X(09).
  3513***************    OUTPUT FROM ELRTRM   *************************
  3514
  3515         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3516                                     COMP-3.
  3517         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3518                                     COMP-3.
  3519         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3520                                     COMP-3.
  3521         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3522                                     COMP-3.
  3523         16  FILLER                PIC X(12).
  3524
  3525***************    OUTPUT FROM ELRAMT   *************************
  3526
  3527         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3528                                     COMP-3.
  3529         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3530                                     COMP-3.
  3531         16  FILLER                PIC X(12).
  3532
  3533***************    OUTPUT FROM ELRATE   *************************
  3534
  3535         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3536                                     COMP-3.
  3537         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3538                                     COMP-3.
  3539         16  CP-MORTALITY-CODE     PIC X(4).
  3540         16  CP-RATE-EDIT-FLAG     PIC X.
  3541             88  CP-RATES-NEED-APR                  VALUE '1'.
  3542         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3543                                     COMP-3.
  3544         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3545         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3546         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3547                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  67
* EL050.cbl
  3548         16  FILLER                PIC X(07).
  3549
  3550***************    OUTPUT FROM ELRFND   *************************
  3551
  3552         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3553                                     COMP-3.
  3554         16  CP-REFUND-TYPE-USED   PIC X.
  3555           88  CP-R-AS-R78                         VALUE '1'.
  3556           88  CP-R-AS-PRORATA                     VALUE '2'.
  3557           88  CP-R-AS-CALIF                       VALUE '3'.
  3558           88  CP-R-AS-TEXAS                       VALUE '4'.
  3559           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3560           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3561           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3562           88  CP-R-AS-MEAN                        VALUE '8'.
  3563           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3564           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3565           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3566           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3567           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3568           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3569         16  FILLER                PIC X(12).
  3570
  3571***************    OUTPUT FROM ELEARN   *************************
  3572
  3573         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3574                                     COMP-3.
  3575         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3576                                     COMP-3.
  3577         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3578                                     COMP-3.
  3579         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3580                                     COMP-3.
  3581         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3582                                     COMP-3.
  3583         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3584                                     COMP-3.
  3585         16  CP-EARNING-TYPE-USED  PIC X.
  3586           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3587           88  CP-E-AS-R78                         VALUE '1'.
  3588           88  CP-E-AS-PRORATA                     VALUE '2'.
  3589           88  CP-E-AS-TEXAS                       VALUE '4'.
  3590           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3591           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3592           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3593           88  CP-E-AS-MEAN                        VALUE '8'.
  3594           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3595         16  FILLER                PIC X(12).
  3596
  3597***************    OUTPUT FROM ELPMNT   *************************
  3598
  3599         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3600                                     COMP-3.
  3601         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3602                                     COMP-3.
  3603         16  FILLER                PIC X(12).
  3604
  3605***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  68
* EL050.cbl
  3606         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3607                                     COMP-3.
  3608         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3609                                     COMP-3.
  3610         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3611                                     COMP-3.
  3612         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3613                                     COMP-3.
  3614         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3615                                     COMP-3.
  3616         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3617                                     COMP-3.
  3618         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3619             88  OPEN-RATE-FILE                   VALUE 'O'.
  3620             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3621             88  IO-ERROR                         VALUE 'E'.
  3622
  3623         16  CP-FIRST-PAY-DATE     PIC XX.
  3624
  3625         16  CP-JOINT-INDICATOR    PIC X.
  3626
  3627         16  CP-RESERVE-REMAINING-TERM
  3628                                   PIC S9(4)V9    VALUE ZERO
  3629                                     COMP-3.
  3630
  3631         16  CP-INSURED-BIRTH-DT   PIC XX.
  3632
  3633         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3634                                     COMP-3.
  3635
  3636         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3637                                     COMP-3.
  3638
  3639         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3640                                     COMP-3.
  3641
  3642         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3643                                     COMP-3.
  3644
  3645         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3646                                     COMP-3.
  3647
  3648         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3649                                     COMP-3.
  3650
  3651         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3652                                     COMP-3.
  3653
  3654         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3655             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3656
  3657         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3658                                     COMP-3.
  3659         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3660                                     COMP-3.
  3661         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3662         16  FILLER                PIC X(15).
  3663******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  69
* EL050.cbl
  3665******************************************************************
  3666*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3667*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3668*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3669*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3670*** MODIFICATION.                                              ***
  3671*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3672*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3673******************************************************************
  3674*    COPY ERCPNDB.
  3675******************************************************************
  3676*                                                                *
  3677*                                                                *
  3678*                            ERCPNDB.                            *
  3679*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3680*                            VMOD=2.025                          *
  3681*                                                                *
  3682*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3683*                                                                *
  3684******************************************************************
  3685*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3686*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3687******************************************************************
  3688*                                                                *
  3689*                                                                *
  3690*   FILE TYPE = VSAM,KSDS                                        *
  3691*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3692*                                                                *
  3693*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3694*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3695*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3696*                                                 RKP=13,LEN=36  *
  3697*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3698*                                      AND CHG-SEQ.)             *
  3699*                                                RKP=49,LEN=11   *
  3700*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3701*                                      AND CHG-SEQ.)             *
  3702*                                                RKP=60,LEN=15   *
  3703*                                                                *
  3704*   LOG = NO                                                     *
  3705*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3706******************************************************************
  3707******************************************************************
  3708*                   C H A N G E   L O G
  3709*
  3710* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3711*-----------------------------------------------------------------
  3712*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3713* EFFECTIVE    NUMBER
  3714*-----------------------------------------------------------------
  3715* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3716* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3717* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3718* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3719* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3720* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3721* 032306                   PEMA  ADD BOW LOAN NUMBER
  3722* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  70
* EL050.cbl
  3723* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3724* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3725* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3726* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3727* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3728* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3729* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3730******************************************************************
  3731
  3732 01  PENDING-BUSINESS.
  3733     12  PB-RECORD-ID                     PIC XX.
  3734         88  VALID-PB-ID                        VALUE 'PB'.
  3735
  3736     12  PB-CONTROL-PRIMARY.
  3737         16  PB-COMPANY-CD                PIC X.
  3738         16  PB-ENTRY-BATCH               PIC X(6).
  3739         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3740         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3741
  3742     12  PB-CONTROL-BY-ACCOUNT.
  3743         16  PB-COMPANY-CD-A1             PIC X.
  3744         16  PB-CARRIER                   PIC X.
  3745         16  PB-GROUPING.
  3746             20  PB-GROUPING-PREFIX       PIC XXX.
  3747             20  PB-GROUPING-PRIME        PIC XXX.
  3748         16  PB-STATE                     PIC XX.
  3749         16  PB-ACCOUNT.
  3750             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3751             20  PB-ACCOUNT-PRIME         PIC X(6).
  3752         16  PB-CERT-EFF-DT               PIC XX.
  3753         16  PB-CERT-NO.
  3754             20  PB-CERT-PRIME            PIC X(10).
  3755             20  PB-CERT-SFX              PIC X.
  3756         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3757
  3758         16  PB-RECORD-TYPE               PIC X.
  3759             88  PB-MAILING-DATA                VALUE '0'.
  3760             88  PB-ISSUE                       VALUE '1'.
  3761             88  PB-CANCELLATION                VALUE '2'.
  3762             88  PB-BATCH-TRAILER               VALUE '9'.
  3763
  3764     12  PB-CONTROL-BY-ORIG-BATCH.
  3765         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3766         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3767         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3768         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3769
  3770     12  PB-CONTROL-BY-CSR.
  3771         16  PB-CSR-COMPANY-CD            PIC X.
  3772         16  PB-CSR-ID                    PIC X(4).
  3773         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3774         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3775         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3776******************************************************************
  3777*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3778******************************************************************
  3779
  3780     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  71
* EL050.cbl
  3781     12  PB-LAST-MAINT-BY                 PIC X(4).
  3782     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3783
  3784     12  PB-RECORD-BODY                   PIC X(375).
  3785
  3786     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3787         16  PB-CERT-ORIGIN               PIC X.
  3788             88  CLASIC-CREATED-CERT         VALUE '1'.
  3789         16  PB-I-NAME.
  3790             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3791             20  PB-I-INSURED-FIRST-NAME.
  3792                 24  PB-I-INSURED-1ST-INIT PIC X.
  3793                 24  FILLER                PIC X(9).
  3794             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3795         16  PB-I-AGE                     PIC S99   COMP-3.
  3796         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3797         16  PB-I-BIRTHDAY                PIC XX.
  3798         16  PB-I-INSURED-SEX             PIC X.
  3799             88  PB-SEX-MALE     VALUE 'M'.
  3800             88  PB-SEX-FEMALE   VALUE 'F'.
  3801
  3802         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3803         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3804         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3805         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3806         16  PB-I-SKIP-CODE               PIC X.
  3807             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3808             88  PB-SKIP-JULY              VALUE '1'.
  3809             88  PB-SKIP-AUGUST            VALUE '2'.
  3810             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3811             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3812             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3813             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3814             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3815             88  PB-SKIP-JUNE              VALUE '8'.
  3816             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3817             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3818             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3819         16  PB-I-TERM-TYPE               PIC X.
  3820             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3821             88  PB-PAID-WEEKLY            VALUE 'W'.
  3822             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3823             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3824             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3825         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3826         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3827         16  PB-I-DATA-ENTRY-SW           PIC X.
  3828             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3829             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3830             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3831             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3832         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3833         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3834*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3835         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3836         16  FILLER                       PIC X.
  3837
  3838         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  72
* EL050.cbl
  3839             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3840             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3841                                                   '90' THRU '99'.
  3842         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3843                                          PIC XX.
  3844         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3845         16  PB-I-AMOUNT-FINANCED REDEFINES
  3846                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3847         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3848         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3849                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3850         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3851         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3852         16  PB-I-CLP-AMOUNT REDEFINES
  3853                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3854         16  PB-I-LF-CALC-FLAG            PIC X.
  3855             88 PB-COMP-LF-PREM               VALUE '?'.
  3856         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3857         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3858         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3859         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3860         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3861         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3862         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3863         16  PB-I-LF-ABBR                 PIC XXX.
  3864         16  PB-I-LF-INPUT-CD             PIC XX.
  3865
  3866         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3867             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3868             88  PB-INVALID-AH               VALUE '  ' '00'
  3869                                                   '90' THRU '99'.
  3870         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3871         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3872         16  PB-I-AH-CALC-FLAG            PIC X.
  3873             88 PB-COMP-AH-PREM                  VALUE '?'.
  3874         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3875         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3876         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3877         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3878         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3879         16  PB-I-AH-ABBR                 PIC XXX.
  3880         16  PB-I-AH-INPUT-CD             PIC XXX.
  3881
  3882         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  3883         16  PB-I-REIN-TABLE              PIC XXX.
  3884         16  PB-I-BUSINESS-TYPE           PIC 99.
  3885         16  PB-I-INDV-GRP-CD             PIC X.
  3886         16  PB-I-MORT-CODE.
  3887             20  PB-I-TABLE               PIC X.
  3888             20  PB-I-INTEREST            PIC XX.
  3889             20  PB-I-MORT-TYP            PIC X.
  3890         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  3891         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  3892         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  3893         16  PB-I-INDV-GRP-OVRD           PIC X.
  3894         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  3895         16  PB-I-SIG-SW                  PIC X.
  3896             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  73
* EL050.cbl
  3897         16  PB-I-RATE-CLASS              PIC XX.
  3898         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  3899         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  3900         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  3901         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  3902         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  3903         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  3904         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  3905         16  PB-I-BENEFIT-TYPE            PIC XXX.
  3906         16  PB-I-OB-FLAG                 PIC X.
  3907             88  PB-I-OB                      VALUE 'B'.
  3908             88  PB-I-SUMMARY                 VALUE 'Z'.
  3909         16  PB-I-ENTRY-STATUS            PIC X.
  3910             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  3911                                              'M' '5' '9' '2'.
  3912             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  3913             88  PB-I-POLICY-PENDING          VALUE '2'.
  3914             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  3915             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  3916             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  3917             88  PB-I-REIN-ONLY               VALUE '9'.
  3918             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  3919             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  3920             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  3921             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  3922         16  PB-I-INT-CODE                PIC X.
  3923             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  3924             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  3925         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  3926         16  PB-I-SOC-SEC-NO              PIC X(11).
  3927         16  PB-I-MEMBER-NO               PIC X(12).
  3928         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  3929*        16  PB-I-LOAN-OFFICER            PIC XXX.
  3930         16  PB-I-OLD-LOF                 PIC XXX.
  3931         16  PB-I-LF-EXPIRE-DT            PIC XX.
  3932         16  PB-I-AH-EXPIRE-DT            PIC XX.
  3933         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  3934         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  3935         16  PB-I-LIFE-INDICATOR          PIC X.
  3936             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  3937         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  3938         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  3939                                          PIC S9(5)V99    COMP-3.
  3940         16  PB-I-MAIL-ADDRS-SW           PIC X.
  3941             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  3942             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  3943         16  PB-I-1ST-PMT-DT              PIC XX.
  3944         16  PB-I-JOINT-INSURED.
  3945             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  3946             20 PB-I-JOINT-FIRST-NAME.
  3947                24  PB-I-JOINT-FIRST-INIT PIC X.
  3948                24  FILLER                PIC X(9).
  3949             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  3950*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  3951         16  PB-I-BENEFICIARY-NAME.
  3952             20  PB-I-BANK-NUMBER         PIC X(10).
  3953             20  FILLER                   PIC X(15).
  3954         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  74
* EL050.cbl
  3955         16  PB-I-REFERENCE               PIC X(12).
  3956         16  FILLER REDEFINES PB-I-REFERENCE.
  3957             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  3958             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  3959             20  PB-I-CLP-STATE           PIC XX.
  3960         16  PB-I-UNDERWRITING-STATUS     PIC X.
  3961             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  3962             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  3963             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  3964         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  3965         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  3966         16  PB-I-RESIDENT-STATE          PIC XX.
  3967         16  PB-I-RATE-CODE               PIC X(4).
  3968         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  3969         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3970         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3971         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  3972         16  PB-I-BANK-NOCHRGB            PIC 99.
  3973         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  3974         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  3975
  3976     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  3977         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  3978             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  3979         16  PB-C-CANCEL-ORIGIN           PIC X.
  3980             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  3981         16  PB-C-LF-CANCEL-DT            PIC XX.
  3982         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3983         16  PB-C-LF-CALC-REQ             PIC X.
  3984             88 PB-COMP-LF-CANCEL            VALUE '?'.
  3985         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  3986         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  3987         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  3988             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  3989         16  PB-C-AH-CANCEL-DT            PIC XX.
  3990         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3991         16  PB-C-AH-CALC-REQ             PIC X.
  3992             88 PB-COMP-AH-CANCEL            VALUE '?'.
  3993         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  3994         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  3995         16  PB-C-LAST-NAME               PIC X(15).
  3996         16  PB-C-REFUND-SW               PIC X.
  3997             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  3998             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  3999         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4000         16  PB-C-PAYEE-CODE              PIC X(6).
  4001         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4002         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4003         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4004         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4005         16  PB-C-REFERENCE               PIC X(12).
  4006         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4007         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4008         16  PB-C-POST-CARD-IND           PIC X.
  4009         16  PB-C-CANCEL-REASON           PIC X.
  4010         16  PB-C-REF-INTERFACE-SW        PIC X.
  4011         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4012         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  75
* EL050.cbl
  4013         16  FILLER                       PIC X(01).
  4014*        16  FILLER                       PIC X(18).
  4015         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4016*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4017         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4018         16  PB-CANCELED-CERT-DATA.
  4019             20  PB-CI-INSURED-NAME.
  4020                 24  PB-CI-LAST-NAME      PIC X(15).
  4021                 24  PB-CI-INITIALS       PIC XX.
  4022             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4023             20  PB-CI-INSURED-SEX        PIC X.
  4024             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4025             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4026             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4027             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4028             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4029             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4030             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4031             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4032             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4033             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4034             20  PB-CI-RATE-CLASS         PIC XX.
  4035             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4036             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4037             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4038             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4039             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4040             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4041             20  PB-CI-LF-ABBR            PIC X(3).
  4042             20  PB-CI-AH-ABBR            PIC X(3).
  4043             20  PB-CI-OB-FLAG            PIC X.
  4044                 88  PB-CI-OB                VALUE 'B'.
  4045             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4046                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4047                                           'M' '4' '5' '9' '2'.
  4048                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4049                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4050                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4051                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4052                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4053                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4054                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4055                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4056                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4057                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4058                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4059                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4060             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4061                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4062                                           'M' '4' '5' '9' '2'.
  4063                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4064                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4065                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4066                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4067                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4068                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4069                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4070                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  76
* EL050.cbl
  4071                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4072                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4073                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4074                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4075             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4076             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4077             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4078             20  PB-CI-MEMBER-NO          PIC X(12).
  4079             20  PB-CI-INT-CODE           PIC X.
  4080                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4081                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4082             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4083             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4084             20  PB-CI-COMP-EXCP-SW       PIC X.
  4085                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4086                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4087             20  PB-CI-ENTRY-STATUS       PIC X.
  4088             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4089             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4090             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4091             20  PB-CI-DEATH-DT           PIC XX.
  4092             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4093             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4094             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4095             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4096             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4097             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4098             20  PB-CI-ENTRY-DT              PIC XX.
  4099             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4100             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4101             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4102             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4103             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4104             20  PB-CI-OLD-LOF               PIC XXX.
  4105*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4106             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4107             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4108             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4109             20  PB-CI-INDV-GRP-CD           PIC X.
  4110             20  PB-CI-BENEFICIARY-NAME.
  4111                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4112                 24  FILLER                  PIC X(15).
  4113             20  PB-CI-NOTE-SW               PIC X.
  4114             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4115             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4116             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4117             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4118             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4119             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4120             20  PB-CI-FIRST-NAME            PIC X(10).
  4121             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4122
  4123         16  FILLER                       PIC X(13).
  4124*032306  16  FILLER                       PIC X(27).
  4125*        16  FILLER                       PIC X(46).
  4126
  4127     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4128         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  77
* EL050.cbl
  4129         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4130         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4131         16  PB-M-INSURED-MID-INIT        PIC X.
  4132         16  PB-M-INSURED-AGE             PIC 99.
  4133         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4134         16  PB-M-INSURED-SEX             PIC X.
  4135         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4136         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4137         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4138         16  PB-M-INSURED-CITY-STATE.
  4139             20  PB-M-INSURED-CITY        PIC X(28).
  4140             20  PB-M-INSURED-STATE       PIC XX.
  4141         16  PB-M-INSURED-ZIP-CODE.
  4142             20  PB-M-INSURED-ZIP-PRIME.
  4143                 24  PB-M-INSURED-ZIP-1   PIC X.
  4144                     88  PB-M-CANADIAN-POST-CODE
  4145                                             VALUE 'A' THRU 'Z'.
  4146                 24  FILLER               PIC X(4).
  4147             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4148         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4149                                        PB-M-INSURED-ZIP-CODE.
  4150             20  PM-M-INS-CAN-POST1       PIC XXX.
  4151             20  PM-M-INS-CAN-POST2       PIC XXX.
  4152             20  FILLER                   PIC XXX.
  4153         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4154         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4155         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4156         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4157         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4158         16  PB-M-CRED-BENE-CITYST.
  4159             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4160             20  PB-M-CRED-BENE-STATE     PIC XX.
  4161         16  FILLER                       PIC X(92).
  4162
  4163     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4164         16  FILLER                       PIC X(10).
  4165         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4166         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4167         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4168         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4169         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4170         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4171         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4172         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4173         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4174         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4175         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4176         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4177         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4178         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4179         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4180         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4181         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4182         16  PB-ACCOUNT-NAME              PIC X(30).
  4183         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4184         16  PB-REFERENCE                 PIC X(12).
  4185         16  PB-B-RECEIVED-DT             PIC XX.
  4186         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  78
* EL050.cbl
  4187
  4188     12  PB-RECORD-STATUS.
  4189         16  PB-CREDIT-SELECT-DT          PIC XX.
  4190         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4191         16  PB-BILLED-DT                 PIC XX.
  4192         16  PB-BILLING-STATUS            PIC X.
  4193             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4194             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4195             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4196         16  PB-RECORD-BILL               PIC X.
  4197             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4198             88  PB-RECORD-RETURNED           VALUE 'R'.
  4199             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4200             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4201             88  PB-OVERRIDE-AH               VALUE 'A'.
  4202             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4203         16  PB-BATCH-ENTRY               PIC X.
  4204             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4205             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4206             88  PB-REISSUED-CERT             VALUE 'E'.
  4207             88  PB-MONTHLY-CERT              VALUE 'M'.
  4208             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4209             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4210             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4211         16  PB-FORCE-CODE                PIC X.
  4212             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4213             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4214             88  PB-CANCEL-FORCE              VALUE '8'.
  4215             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4216             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4217             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4218             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4219             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4220             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4221             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4222         16  PB-FATAL-FLAG                PIC X.
  4223             88  PB-FATAL-ERRORS              VALUE 'X'.
  4224         16  PB-FORCE-ER-CD               PIC X.
  4225             88  PB-FORCE-ERRORS              VALUE 'F'.
  4226             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4227         16  PB-WARN-ER-CD                PIC X.
  4228             88  PB-WARNING-ERRORS            VALUE 'W'.
  4229         16  FILLER                       PIC X.
  4230         16  PB-OUT-BAL-CD                PIC X.
  4231             88  PB-OUT-OF-BAL                VALUE 'O'.
  4232         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4233         16  PB-AH-OVERRIDE-L1            PIC X.
  4234         16  PB-INPUT-DT                  PIC XX.
  4235         16  PB-INPUT-BY                  PIC X(4).
  4236         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4237         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4238         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4239         16  PB-LF-EARNING-METHOD         PIC X.
  4240         16  PB-AH-EARNING-METHOD         PIC X.
  4241         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4242         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4243         16  PB-REIN-CD                   PIC XXX.
  4244         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  79
* EL050.cbl
  4245         16  PB-AH-REFUND-TYPE            PIC X.
  4246         16  PB-ACCT-EFF-DT               PIC XX.
  4247         16  PB-ACCT-EXP-DT               PIC XX.
  4248         16  PB-COMPANY-ID                PIC X(3).
  4249         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4250         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4251         16  PB-SV-CARRIER                PIC X.
  4252         16  PB-SV-GROUPING               PIC X(6).
  4253         16  PB-SV-STATE                  PIC XX.
  4254         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4255         16  PB-GA-BILLING-INFO.
  4256             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4257                                          PIC XX.
  4258         16  PB-SV-REMIT-TO  REDEFINES
  4259             PB-GA-BILLING-INFO           PIC X(10).
  4260         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4261         16  PB-I-LOAN-OFFICER            PIC X(5).
  4262         16  PB-I-VIN                     PIC X(17).
  4263
  4264         16  FILLER                       PIC X(04).
  4265         16  IMNET-BYPASS-SW              PIC X.
  4266
  4267******************************************************************
  4268*                COMMON EDIT ERRORS                              *
  4269******************************************************************
  4270
  4271     12  PB-COMMON-ERRORS.
  4272         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4273                                           PIC S9(4)     COMP.
  4274
  4275******************************************************************
  4276
  4277* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4278*    COPY ELC50W1.
  4279******************************************************************
  4280*                                                                *
  4281*                                                                *
  4282*                             ELC50W1                            *
  4283*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4284*                            VMOD=2.004                          *
  4285*                                                                *
  4286*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4287*                                                                *
  4288*                                                                *
  4289******************************************************************
  4290
  4291     12  WK-WORK-AREA.
  4292         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4293         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4294         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4295         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4296         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4297         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4298         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4299         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4300         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4301         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4302         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  80
* EL050.cbl
  4303         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4304         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4305         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4306         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4307         16  WK-CREDIT-EDIT-CONTROLS.
  4308             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4309             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4310             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4311             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4312             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4313             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4314         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4315         16  WK-SAVE-REIN-DATA.
  4316             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4317             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4318             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4319         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4320             88  ENTRY-FROM-EL6311       VALUE '6'.
  4321         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4322         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4323     12  WK-RECORD-ADDRESSES.
  4324         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4325         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4326         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4327         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4328         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4329         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4330         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4331         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4332     12  WK-OVER-SHORT-AREA.
  4333         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4334         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4335         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4336             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4337         16  FILLER                   PIC X(5) VALUE SPACES.
  4338
  4339*    COPY ELCEDITC.
  4340******************************************************************
  4341*                                                                *
  4342*                                                                *
  4343*                            ELCEDITC                            *
  4344*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4345*                            VMOD=2.012                          *
  4346*                                                                *
  4347*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4348*                     EL6313, EL050 AND EL517.                   *
  4349*                                                                *
  4350******************************************************************
  4351******************************************************************
  4352*                   C H A N G E   L O G
  4353*
  4354* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4355*-----------------------------------------------------------------
  4356*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4357* EFFECTIVE    NUMBER
  4358*-----------------------------------------------------------------
  4359* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4360******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  81
* EL050.cbl
  4361
  4362     12  EDIT-CRITERIA-DATA.
  4363         16  EC-CO-MONTH-END-DT       PIC XX.
  4364         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4365         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4366         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4367         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4368         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4369         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4370         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4371         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4372         16  EC-CO-REM-TERM-CALC      PIC X.
  4373               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4374               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4375               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4376               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4377
  4378         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4379               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4380               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4381               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4382               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4383               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4384               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4385               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4386               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4387               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4388               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4389
  4390         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4391               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4392               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4393               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4394               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4395               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4396               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4397               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4398               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4399
  4400         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4401                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4402                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4403
  4404         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4405                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4406                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4407                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4408                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4409                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4410                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4411                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4412                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4413
  4414         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4415               88  EC-BR-REDUCING                   VALUE 'R'.
  4416               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4417
  4418         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  82
* EL050.cbl
  4419         16  EC-BR-LF-DESC             PIC X(10).
  4420         16  EC-BR-AH-DESC             PIC X(10).
  4421         16  EC-BR-LF-COMMENT          PIC X(10).
  4422         16  EC-BR-AH-COMMENT          PIC X(10).
  4423
  4424         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4425               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4426               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4427               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4428               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4429
  4430         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4431               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4432               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4433               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4434               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4435
  4436         16  EC-BR-LF-REFUND-CALC      PIC X.
  4437                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4438                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4439                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4440                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4441                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4442                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4443                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4444
  4445         16  EC-BR-AH-REFUND-CALC      PIC X.
  4446                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4447                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4448                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4449                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4450                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4451                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4452                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4453                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4454
  4455         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4456                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4457                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4458                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4459
  4460         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4461                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4462                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4463                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4464
  4465         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4466         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4467         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4468         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4469
  4470         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4471         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4472                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4473                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4474                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4475                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4476
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  83
* EL050.cbl
  4477         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4478               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4479               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4480               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4481               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4482               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4483
  4484         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4485               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4486               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4487               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4488               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4489               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4490
  4491         16  EC-ST-LF-REFUND-CALC      PIC X.
  4492                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4493                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4494                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4495                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4496                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4497                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4498                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4499                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4500
  4501         16  EC-ST-AH-REFUND-CALC      PIC X.
  4502                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4503                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4504                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4505                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4506                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4507                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4508                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4509                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4510
  4511         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4512         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4513         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4514         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4515         16  EC-AM-EXPIRATION-DT       PIC XX.
  4516         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4517         16  EC-AM-CLASS-CD            PIC XX.
  4518         16  EC-AM-LF-DEVIATION        PIC XXX.
  4519         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4520         16  EC-AM-AH-DEVIATION        PIC XXX.
  4521         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4522         16  EC-AM-PHONE-NO            PIC X(10).
  4523
  4524         16  EC-AM-LF-REFUND-CALC      PIC X.
  4525                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4526                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4527                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4528                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4529                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4530                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4531                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4532
  4533         16  EC-AM-AH-REFUND-CALC      PIC X.
  4534                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  84
* EL050.cbl
  4535                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4536                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4537                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4538                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4539                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4540                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4541
  4542         16  EC-AM-BEN-I-G-CD          PIC X.
  4543                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4544                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4545                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4546
  4547         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4548         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4549         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4550         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4551         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4552         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4553         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4554         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4555         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4556
  4557         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4558         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4559         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4560         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4561         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4562         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4563         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4564         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4565         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4566         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4567         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4568         16  EC-RT-LF-NSP-ST           PIC XX.
  4569         16  EC-RT-AH-NSP-ST           PIC XX.
  4570         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4571         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4572
  4573         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4574             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4575                                             'M' '5' '9' '2'.
  4576             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4577             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4578             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4579             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4580             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4581             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4582             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4583             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4584             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4585             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4586
  4587         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4588             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4589                                             'M' '5' '9' '2'.
  4590             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4591             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4592             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  85
* EL050.cbl
  4593             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4594             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4595             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4596             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4597             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4598             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4599             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4600
  4601         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4602         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4603         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4604         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4605         16  EC-CM-DEATH-DT            PIC XX.
  4606
  4607*DMD CUSTOM CODING FIELDS BELOW
  4608*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4609         16  EC-BR-DMD-RATING-SW       PIC X.
  4610                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4611                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4612                 88  NO-DMD-RATING               VALUE 'N'.
  4613
  4614         16  EC-NEW-CERT               PIC X(11).
  4615         16  EC-NEW-STATE              PIC XX.
  4616         16  FILLER                    PIC X.
  4617*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4618         16  OVER-SHORT-EDIT-FIELDS.
  4619             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4620             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4621             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4622             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4623             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4624             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4625             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4626             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4627             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4628         16  FILLER                    PIC X(71).
  4629******************************************************************
  4630
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  86
* EL050.cbl
  4632*    COPY ELCDIFRD.
  4633******************************************************************
  4634*                                                                *
  4635*                                                                *
  4636*                            ELCDIFRD.                           *
  4637*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4638*                            VMOD=2.004                          *
  4639*                                                                *
  4640*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4641*                                                                *
  4642******************************************************************
  4643*
  4644  01  WS-DIFFERENCE-CALCULATION.
  4645        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4646        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4647        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4648        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4649        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4650        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4651        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4652        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4653        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4654        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4655        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4656
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  87
* EL050.cbl
  4658****************************************************************
  4659*
  4660* Copyright (c) 2007 by Clerity Solutions, Inc.
  4661* All rights reserved.
  4662*
  4663****************************************************************
  4664 01  DFHEIV.
  4665   02  DFHEIV0               PIC X(35).
  4666   02  DFHEIV1               PIC X(08).
  4667   02  DFHEIV2               PIC X(08).
  4668   02  DFHEIV3               PIC X(08).
  4669   02  DFHEIV4               PIC X(06).
  4670   02  DFHEIV5               PIC X(04).
  4671   02  DFHEIV6               PIC X(04).
  4672   02  DFHEIV7               PIC X(02).
  4673   02  DFHEIV8               PIC X(02).
  4674   02  DFHEIV9               PIC X(01).
  4675   02  DFHEIV10              PIC S9(7) COMP-3.
  4676   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4677   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4678   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4679   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4680   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4681   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4682   02  DFHEIV17              PIC X(04).
  4683   02  DFHEIV18              PIC X(04).
  4684   02  DFHEIV19              PIC X(04).
  4685   02  DFHEIV20              USAGE IS POINTER.
  4686   02  DFHEIV21              USAGE IS POINTER.
  4687   02  DFHEIV22              USAGE IS POINTER.
  4688   02  DFHEIV23              USAGE IS POINTER.
  4689   02  DFHEIV24              USAGE IS POINTER.
  4690   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4691   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4692   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4693   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4694   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4695   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4696   02  FILLER                PIC X(02).
  4697   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4698   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4699   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4700   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4701   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4702 LINKAGE  SECTION.
  4703*****************************************************************
  4704*                                                               *
  4705* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4706* All rights reserved.                                          *
  4707*                                                               *
  4708*****************************************************************
  4709 01  dfheiblk.
  4710     02  eibtime          pic s9(7) comp-3.
  4711     02  eibdate          pic s9(7) comp-3.
  4712     02  eibtrnid         pic x(4).
  4713     02  eibtaskn         pic s9(7) comp-3.
  4714     02  eibtrmid         pic x(4).
  4715     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  88
* EL050.cbl
  4716     02  eibcposn         pic s9(4) comp.
  4717     02  eibcalen         pic s9(4) comp.
  4718     02  eibaid           pic x(1).
  4719     02  eibfiller1       pic x(1).
  4720     02  eibfn            pic x(2).
  4721     02  eibfiller2       pic x(2).
  4722     02  eibrcode         pic x(6).
  4723     02  eibfiller3       pic x(2).
  4724     02  eibds            pic x(8).
  4725     02  eibreqid         pic x(8).
  4726     02  eibrsrce         pic x(8).
  4727     02  eibsync          pic x(1).
  4728     02  eibfree          pic x(1).
  4729     02  eibrecv          pic x(1).
  4730     02  eibsend          pic x(1).
  4731     02  eibatt           pic x(1).
  4732     02  eibeoc           pic x(1).
  4733     02  eibfmh           pic x(1).
  4734     02  eibcompl         pic x(1).
  4735     02  eibsig           pic x(1).
  4736     02  eibconf          pic x(1).
  4737     02  eiberr           pic x(1).
  4738     02  eibrldbk         pic x(1).
  4739     02  eiberrcd         pic x(4).
  4740     02  eibsynrb         pic x(1).
  4741     02  eibnodat         pic x(1).
  4742     02  eibfiller5       pic x(2).
  4743     02  eibresp          pic 9(09) comp.
  4744     02  eibresp2         pic 9(09) comp.
  4745     02  dfheigdj         pic s9(4) comp.
  4746     02  dfheigdk         pic s9(4) comp.
  4747
  4748 01  DFHCOMMAREA                   PIC X(1036).
  4749
  4750*01 PARMLIST .
  4751*    02  FILLER                    PIC S9(8)   COMP.
  4752*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4753*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4754*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4755*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4756*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4757*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4758*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4759
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  89
* EL050.cbl
  4761*    COPY ELCCNTL.
  4762******************************************************************
  4763*                                                                *
  4764*                                                                *
  4765*                            ELCCNTL.                            *
  4766*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4767*                            VMOD=2.059                          *
  4768*                                                                *
  4769*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4770*                                                                *
  4771*   FILE TYPE = VSAM,KSDS                                        *
  4772*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4773*                                                                *
  4774*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4775*       ALTERNATE INDEX = NONE                                   *
  4776*                                                                *
  4777*   LOG = YES                                                    *
  4778*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4779******************************************************************
  4780*                   C H A N G E   L O G
  4781*
  4782* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4783*-----------------------------------------------------------------
  4784*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4785* EFFECTIVE    NUMBER
  4786*-----------------------------------------------------------------
  4787* 082503                   PEMA  ADD BENEFIT GROUP
  4788* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4789* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4790* 092705    2005050300006  PEMA  ADD SPP LEASES
  4791* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4792* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4793* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4794* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4795* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4796******************************************************************
  4797*
  4798 01  CONTROL-FILE.
  4799     12  CF-RECORD-ID                       PIC XX.
  4800         88  VALID-CF-ID                        VALUE 'CF'.
  4801
  4802     12  CF-CONTROL-PRIMARY.
  4803         16  CF-COMPANY-ID                  PIC XXX.
  4804         16  CF-RECORD-TYPE                 PIC X.
  4805             88  CF-COMPANY-MASTER              VALUE '1'.
  4806             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4807             88  CF-STATE-MASTER                VALUE '3'.
  4808             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4809             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4810             88  CF-CARRIER-MASTER              VALUE '6'.
  4811             88  CF-MORTALITY-MASTER            VALUE '7'.
  4812             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4813             88  CF-TERMINAL-MASTER             VALUE '9'.
  4814             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4815             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4816             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4817             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4818             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  90
* EL050.cbl
  4819             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4820             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4821             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4822             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4823         16  CF-ACCESS-CD-GENL              PIC X(4).
  4824         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4825             20  CF-PROCESSOR               PIC X(4).
  4826         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4827             20  CF-STATE-CODE              PIC XX.
  4828             20  FILLER                     PIC XX.
  4829         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4830             20  FILLER                     PIC XX.
  4831             20  CF-HI-BEN-IN-REC           PIC XX.
  4832         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4833             20  FILLER                     PIC XXX.
  4834             20  CF-CARRIER-CNTL            PIC X.
  4835         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4836             20  FILLER                     PIC XX.
  4837             20  CF-HI-TYPE-IN-REC          PIC 99.
  4838         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4839             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4840                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4841             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4842             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4843         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4844             20  FILLER                     PIC X.
  4845             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4846         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4847             20  FILLER                     PIC XX.
  4848             20  CF-MORTGAGE-PLAN           PIC XX.
  4849         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4850
  4851     12  CF-LAST-MAINT-DT                   PIC XX.
  4852     12  CF-LAST-MAINT-BY                   PIC X(4).
  4853     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4854
  4855     12  CF-RECORD-BODY                     PIC X(728).
  4856
  4857
  4858****************************************************************
  4859*             COMPANY MASTER RECORD                            *
  4860****************************************************************
  4861
  4862     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4863         16  CF-COMPANY-ADDRESS.
  4864             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4865             20  CF-CL-IN-CARE-OF           PIC X(30).
  4866             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4867             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4868             20  CF-CL-CITY-STATE           PIC X(30).
  4869             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4870             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4871         16  CF-COMPANY-CD                  PIC X.
  4872         16  CF-COMPANY-PASSWORD            PIC X(8).
  4873         16  CF-SECURITY-OPTION             PIC X.
  4874             88  ALL-SECURITY                   VALUE '1'.
  4875             88  COMPANY-VERIFY                 VALUE '2'.
  4876             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  91
* EL050.cbl
  4877             88  NO-SECURITY                    VALUE '4'.
  4878             88  ALL-BUT-TERM                   VALUE '5'.
  4879         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4880             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4881         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4882             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4883         16  CF-INFORCE-LOCATION            PIC X.
  4884             88  CERTS-ARE-ONLINE               VALUE '1'.
  4885             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4886             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4887         16  CF-LOWER-CASE-LETTERS          PIC X.
  4888         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4889             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4890             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4891             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4892             88  CF-ACCNT-CNTL                  VALUE '3'.
  4893             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4894
  4895         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4896         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4897
  4898         16  CF-LGX-CREDIT-USER             PIC X.
  4899             88  CO-IS-NOT-USER                 VALUE 'N'.
  4900             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4901
  4902         16 CF-CREDIT-CALC-CODES.
  4903             20  CF-CR-REM-TERM-CALC PIC X.
  4904               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4905               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4906               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4907               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4908               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4909               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4910               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4911             20  CF-CR-R78-METHOD           PIC X.
  4912               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4913               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4914
  4915         16  CF-CLAIM-CONTROL-COUNTS.
  4916             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4917                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4918
  4919             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4920                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4921
  4922             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4923                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4924
  4925             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4926                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4927
  4928         16  CF-CURRENT-MONTH-END           PIC XX.
  4929
  4930         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4931             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4932             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4933             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4934             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  92
* EL050.cbl
  4935                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4936                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4937             20  CF-CO-PREM-REJECT-SW       PIC X.
  4938                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4939                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4940             20  CF-CO-REF-REJECT-SW        PIC X.
  4941                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4942                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4943
  4944         16  CF-CO-REPORTING-DT             PIC XX.
  4945         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4946         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4947           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4948           88  CF-CO-MONTH-END                  VALUE '1'.
  4949
  4950         16  CF-LGX-CLAIM-USER              PIC X.
  4951             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4952             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4953
  4954         16  CF-CREDIT-EDIT-CONTROLS.
  4955             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4956             20  CF-MIN-AGE                 PIC 99.
  4957             20  CF-DEFAULT-AGE             PIC 99.
  4958             20  CF-MIN-TERM                PIC S999      COMP-3.
  4959             20  CF-MAX-TERM                PIC S999      COMP-3.
  4960             20  CF-DEFAULT-SEX             PIC X.
  4961             20  CF-JOINT-AGE-INPUT         PIC X.
  4962                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4963             20  CF-BIRTH-DATE-INPUT        PIC X.
  4964                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4965             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4966                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4967                 88  CF-ZERO-CARRIER            VALUE '1'.
  4968                 88  CF-ZERO-GROUPING           VALUE '2'.
  4969                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4970             20  CF-EDIT-SW                 PIC X.
  4971                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4972             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4973             20  CF-CR-PR-METHOD            PIC X.
  4974               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4975               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4976             20  FILLER                     PIC X.
  4977
  4978         16  CF-CREDIT-MISC-CONTROLS.
  4979             20  CF-REIN-TABLE-SW           PIC X.
  4980                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4981             20  CF-COMP-TABLE-SW           PIC X.
  4982                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4983             20  CF-EXPERIENCE-RETENTION-AGE
  4984                                            PIC S9        COMP-3.
  4985             20  CF-CONVERSION-DT           PIC XX.
  4986             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4987             20  CF-RUN-FREQUENCY-SW        PIC X.
  4988                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4989                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4990
  4991             20  CF-CR-CHECK-NO-CONTROL.
  4992                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  93
* EL050.cbl
  4993                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4994                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4995                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4996                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4997                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4998
  4999                 24  CF-CR-CHECK-COUNT       REDEFINES
  5000                     CF-CR-CHECK-COUNTER      PIC X(4).
  5001
  5002                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5003                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5004
  5005                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5006                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5007                 24  CF-MAIL-PROCESSING       PIC X.
  5008                     88  MAIL-PROCESSING          VALUE 'Y'.
  5009
  5010         16  CF-MISC-SYSTEM-CONTROL.
  5011             20  CF-SYSTEM-C                 PIC X.
  5012                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5013             20  CF-SYSTEM-D                 PIC X.
  5014                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5015             20  CF-SOC-SEC-NO-SW            PIC X.
  5016                 88  SOC-SEC-NO-USED             VALUE '1'.
  5017             20  CF-MEMBER-NO-SW             PIC X.
  5018                 88  MEMBER-NO-USED              VALUE '1'.
  5019             20  CF-TAX-ID-NUMBER            PIC X(11).
  5020             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5021             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5022                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5023                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5024                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5025                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5026             20  CF-SYSTEM-E                 PIC X.
  5027                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5028
  5029         16  CF-LGX-LIFE-USER               PIC X.
  5030             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5031             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5032
  5033         16  CF-CR-MONTH-END-DT             PIC XX.
  5034
  5035         16  CF-FILE-MAINT-DATES.
  5036             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5037                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5038             20  CF-LAST-BATCH       REDEFINES
  5039                 CF-LAST-BATCH-NO               PIC X(4).
  5040             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5041             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5042             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5043             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5044             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5045             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5046             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5047             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5048             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5049             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5050
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  94
* EL050.cbl
  5051         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5052         16  FILLER                         PIC X.
  5053
  5054         16  CF-ALT-MORT-CODE               PIC X(4).
  5055         16  CF-MEMBER-CAPTION              PIC X(10).
  5056
  5057         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5058             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5059             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5060             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5061             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5062             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5063
  5064         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5065
  5066         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5067         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5068         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5069         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5070
  5071         16  CF-AH-OVERRIDE-L1              PIC X.
  5072         16  CF-AH-OVERRIDE-L2              PIC XX.
  5073         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5074         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5075
  5076         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5077         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5078
  5079         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5080         16  CF-AR-LAST-EL860-DT            PIC XX.
  5081         16  CF-MP-MONTH-END-DT             PIC XX.
  5082
  5083         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5084         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5085             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5086
  5087         16  CF-AR-MONTH-END-DT             PIC XX.
  5088
  5089         16  CF-CRDTCRD-USER                PIC X.
  5090             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5091             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5092
  5093         16  CF-CC-MONTH-END-DT             PIC XX.
  5094
  5095         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5096
  5097         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5098             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5099             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5100             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5101         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5102         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5103         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5104         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5105             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5106             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5107         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5108         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  95
* EL050.cbl
  5109         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5110             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5111         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5112
  5113         16  CF-CL-ZIP-CODE.
  5114             20  CF-CL-ZIP-PRIME.
  5115                 24  CF-CL-ZIP-1ST          PIC X.
  5116                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5117                 24  FILLER                 PIC X(4).
  5118             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5119         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5120             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5121             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5122             20  FILLER                     PIC XXX.
  5123
  5124         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5125         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5126         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5127         16  CF-CO-OPTION-START-DATE        PIC XX.
  5128         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5129           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5130                                                      '3' '4'.
  5131           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5132           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5133           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5134           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5135           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5136           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5137
  5138         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5139
  5140         16  CF-PAYMENT-APPROVAL-LEVELS.
  5141             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5142             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5143             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5144             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5145             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5146             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5147
  5148         16  CF-END-USER-REPORTING-USER     PIC X.
  5149             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5150             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5151
  5152         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5153             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5154             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5155
  5156         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5157
  5158         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5159         16  FILLER                         PIC X.
  5160
  5161         16  CF-CREDIT-ARCHIVE-CNTL.
  5162             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5163             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5164             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5165
  5166         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  96
* EL050.cbl
  5167
  5168         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5169             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5170             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5171
  5172         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5173             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5174             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5175
  5176         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5177
  5178         16  CF-CO-ACH-ID-CODE              PIC  X.
  5179             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5180             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5181             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5182         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5183         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5184         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5185         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5186         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5187         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5188         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5189         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5190         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5191                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5192         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5193                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5194
  5195         16  CF-CO-OVER-SHORT.
  5196             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5197             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5198
  5199*         16  FILLER                         PIC X(102).
  5200         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5201             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5202             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5203
  5204         16  CF-AH-APPROVAL-DAYS.
  5205             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5206             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5207             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5208             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5209
  5210         16  FILLER                         PIC X(82).
  5211****************************************************************
  5212*             PROCESSOR/USER RECORD                            *
  5213****************************************************************
  5214
  5215     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5216         16  CF-PROCESSOR-NAME              PIC X(30).
  5217         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5218         16  CF-PROCESSOR-TITLE             PIC X(26).
  5219         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5220                 88  MESSAGE-YES                VALUE 'Y'.
  5221                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5222
  5223*****************************************************
  5224****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  97
* EL050.cbl
  5225****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5226****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5227****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5228*****************************************************
  5229
  5230         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5231             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5232             20  CF-APPLICATION-FORCE       PIC X.
  5233             20  CF-INDIVIDUAL-APP.
  5234                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5235                     28  CF-BROWSE-APP      PIC X.
  5236                     28  CF-UPDATE-APP      PIC X.
  5237
  5238         16  CF-CURRENT-TERM-ON             PIC X(4).
  5239         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5240             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5241             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5242             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5243             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5244             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5245             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5246             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5247         16  CF-PROCESSOR-CARRIER           PIC X.
  5248             88  NO-CARRIER-SECURITY            VALUE ' '.
  5249         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5250             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5251         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5252             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5253         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5254             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5255
  5256         16  CF-PROC-SYS-ACCESS-SW.
  5257             20  CF-PROC-CREDIT-CLAIMS-SW.
  5258                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5259                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5260                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5261                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5262             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5263                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5264                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5265             20  CF-PROC-LIFE-GNRLDGR-SW.
  5266                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5267                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5268                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5269                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5270             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5271                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5272                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5273         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5274             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5275             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5276         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5277
  5278         16  CF-APPROVAL-LEVEL                  PIC X.
  5279             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5280             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5281             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5282             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  98
* EL050.cbl
  5283
  5284         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5285
  5286         16  CF-LANGUAGE-TYPE                   PIC X.
  5287             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5288             88  CF-LANG-IS-FR                      VALUE 'F'.
  5289         16  FILLER                             PIC  X(240).
  5290
  5291****************************************************************
  5292*             PROCESSOR/REMINDERS RECORD                       *
  5293****************************************************************
  5294
  5295     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5296         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5297             20  CF-START-REMIND-DT         PIC XX.
  5298             20  CF-END-REMIND-DT           PIC XX.
  5299             20  CF-REMINDER-TEXT           PIC X(50).
  5300         16  FILLER                         PIC X(296).
  5301
  5302
  5303****************************************************************
  5304*             STATE MASTER RECORD                              *
  5305****************************************************************
  5306
  5307     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5308         16  CF-STATE-ABBREVIATION          PIC XX.
  5309         16  CF-STATE-NAME                  PIC X(25).
  5310         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5311         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5312             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5313             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5314             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5315             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5316                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5317                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5318             20  CF-ST-PREM-REJECT-SW       PIC X.
  5319                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5320                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5321             20  CF-ST-REF-REJECT-SW        PIC X.
  5322                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5323                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5324         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5325         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5326         16  CF-ST-REFUND-RULES.
  5327             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5328             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5329             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5330         16  CF-ST-FST-PMT-EXTENSION.
  5331             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5332             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5333                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5334                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5335                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5336                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5337         16  CF-ST-STATE-CALL.
  5338             20  CF-ST-CALL-UNEARNED        PIC X.
  5339             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5340             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page  99
* EL050.cbl
  5341         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5342             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5343             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5344         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5345         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5346         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5347         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5348         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5349         16  FILLER                         PIC X.
  5350         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5351             20  CF-ST-BENEFIT-CD           PIC XX.
  5352             20  CF-ST-BENEFIT-KIND         PIC X.
  5353                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5354                 88  CF-ST-AH-KIND              VALUE 'A'.
  5355             20  CF-ST-REM-TERM-CALC        PIC X.
  5356                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5357                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5358                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5359                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5360                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5361                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5362                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5363                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5364
  5365             20  CF-ST-REFUND-CALC          PIC X.
  5366                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5367                 88  ST-REFD-BY-R78             VALUE '1'.
  5368                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5369                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5370                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5371                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5372                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5373                 88  ST-REFD-UTAH               VALUE '7'.
  5374                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5375                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5376                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5377
  5378             20  CF-ST-EARNING-CALC         PIC X.
  5379                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5380                 88  ST-EARN-BY-R78             VALUE '1'.
  5381                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5382                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5383                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5384                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5385                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5386                 88  ST-EARN-MEAN               VALUE '8'.
  5387                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5388
  5389             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5390                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5391                 88  ST-OVRD-BY-R78             VALUE '1'.
  5392                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5393                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5394                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5395                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5396                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5397                 88  ST-OVRD-MEAN               VALUE '8'.
  5398                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 100
* EL050.cbl
  5399             20  FILLER                     PIC X.
  5400
  5401         16  CF-ST-COMMISSION-CAPS.
  5402             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5403             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5404             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5405             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5406         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5407                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5408
  5409         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5410
  5411         16  CF-ST-STATUTORY-INTEREST.
  5412             20  CF-ST-STAT-DATE-FROM       PIC X.
  5413                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5414                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5415             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5416             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5417             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5418             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5419             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5420
  5421         16  CF-ST-OVER-SHORT.
  5422             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5423             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5424
  5425         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5426
  5427         16  CF-ST-RT-CALC                  PIC X.
  5428
  5429         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5430         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5431         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5432         16  CF-ST-RF-LR-CALC               PIC X.
  5433         16  CF-ST-RF-LL-CALC               PIC X.
  5434         16  CF-ST-RF-LN-CALC               PIC X.
  5435         16  CF-ST-RF-AH-CALC               PIC X.
  5436         16  CF-ST-RF-CP-CALC               PIC X.
  5437*        16  FILLER                         PIC X(206).
  5438*CIDMOD         16  FILLER                         PIC X(192).
  5439         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5440             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5441         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5442         16  CF-ST-VFY-2ND-BENE             PIC X.
  5443         16  FILLER                         PIC X(186).
  5444
  5445****************************************************************
  5446*             BENEFIT MASTER RECORD                            *
  5447****************************************************************
  5448
  5449     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5450         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5451             20  CF-BENEFIT-CODE            PIC XX.
  5452             20  CF-BENEFIT-NUMERIC  REDEFINES
  5453                 CF-BENEFIT-CODE            PIC XX.
  5454             20  CF-BENEFIT-ALPHA           PIC XXX.
  5455             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5456             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 101
* EL050.cbl
  5457
  5458             20  CF-LF-COVERAGE-TYPE        PIC X.
  5459                 88  CF-REDUCING                VALUE 'R'.
  5460                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5461
  5462             20  CF-SPECIAL-CALC-CD         PIC X.
  5463                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5464                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5465                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5466                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5467                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5468                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5469                 88  CF-FARM-PLAN               VALUE 'F'.
  5470                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5471                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5472                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5473                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5474                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5475                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5476                 88  CF-PRUDENTIAL              VALUE 'P'.
  5477                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5478                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5479                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5480                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5481                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5482                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5483
  5484             20  CF-JOINT-INDICATOR         PIC X.
  5485                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5486
  5487*            20  FILLER                     PIC X(12).
  5488             20  FILLER                     PIC X(11).
  5489             20  CF-BENEFIT-CATEGORY        PIC X.
  5490             20  CF-LOAN-TYPE               PIC X(8).
  5491
  5492             20  CF-CO-REM-TERM-CALC        PIC X.
  5493                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5494                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5495                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5496                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5497                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5498
  5499             20  CF-CO-EARNINGS-CALC        PIC X.
  5500                 88  CO-EARN-BY-R78             VALUE '1'.
  5501                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5502                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5503                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5504                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5505                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5506                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5507                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5508
  5509             20  CF-CO-REFUND-CALC          PIC X.
  5510                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5511                 88  CO-REFD-BY-R78             VALUE '1'.
  5512                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5513                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5514                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 102
* EL050.cbl
  5515                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5516                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5517                 88  CO-REFD-MEAN               VALUE '8'.
  5518                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5519                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5520                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5521
  5522             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5523                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5524                 88  CO-OVRD-BY-R78             VALUE '1'.
  5525                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5526                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5527                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5528                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5529                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5530                 88  CO-OVRD-MEAN               VALUE '8'.
  5531                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5532
  5533             20  CF-CO-BEN-I-G-CD           PIC X.
  5534                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5535                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5536                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5537
  5538         16  FILLER                         PIC X(304).
  5539
  5540
  5541****************************************************************
  5542*             CARRIER MASTER RECORD                            *
  5543****************************************************************
  5544
  5545     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5546         16  CF-ADDRESS-DATA.
  5547             20  CF-MAIL-TO-NAME            PIC X(30).
  5548             20  CF-IN-CARE-OF              PIC X(30).
  5549             20  CF-ADDRESS-LINE-1          PIC X(30).
  5550             20  CF-ADDRESS-LINE-2          PIC X(30).
  5551             20  CF-CITY-STATE              PIC X(30).
  5552             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5553             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5554
  5555         16  CF-CLAIM-NO-CONTROL.
  5556             20  CF-CLAIM-NO-METHOD         PIC X.
  5557                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5558                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5559                 88  CLAIM-NO-SEQ               VALUE '3'.
  5560                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5561             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5562                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5563                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5564                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5565
  5566         16  CF-CHECK-NO-CONTROL.
  5567             20  CF-CHECK-NO-METHOD         PIC X.
  5568                 88  CHECK-NO-MANUAL            VALUE '1'.
  5569                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5570                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5571                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5572             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 103
* EL050.cbl
  5573                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5574
  5575         16  CF-DOMICILE-STATE              PIC XX.
  5576
  5577         16  CF-EXPENSE-CONTROLS.
  5578             20  CF-EXPENSE-METHOD          PIC X.
  5579                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5580                 88  DOLLARS-PER-PMT            VALUE '2'.
  5581                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5582                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5583             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5584             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5585
  5586         16  CF-CORRESPONDENCE-CONTROL.
  5587             20  CF-LETTER-RESEND-OPT       PIC X.
  5588                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5589                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5590             20  FILLER                     PIC X(4).
  5591
  5592         16  CF-RESERVE-CONTROLS.
  5593             20  CF-MANUAL-SW               PIC X.
  5594                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5595             20  CF-FUTURE-SW               PIC X.
  5596                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5597             20  CF-PTC-SW                  PIC X.
  5598                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5599             20  CF-IBNR-SW                 PIC X.
  5600                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5601             20  CF-PTC-LF-SW               PIC X.
  5602                 88  CF-LF-PTC-USED             VALUE '1'.
  5603             20  CF-CDT-ACCESS-METHOD       PIC X.
  5604                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5605                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5606                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5607             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5608
  5609         16  CF-CLAIM-CALC-METHOD           PIC X.
  5610             88  360-PLUS-MONTHS                VALUE '1'.
  5611             88  365-PLUS-MONTHS                VALUE '2'.
  5612             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5613             88  360-DAILY                      VALUE '4'.
  5614             88  365-DAILY                      VALUE '5'.
  5615
  5616         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5617         16  FILLER                         PIC X(11).
  5618
  5619         16  CF-LIMIT-AMOUNTS.
  5620             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5621             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5622             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5623             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5624             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5625             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5626             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5627             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5628             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5629             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5630
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 104
* EL050.cbl
  5631         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5632         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5633         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5634
  5635         16  CF-ZIP-CODE.
  5636             20  CF-ZIP-PRIME.
  5637                 24  CF-ZIP-1ST             PIC X.
  5638                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5639                 24  FILLER                 PIC X(4).
  5640             20  CF-ZIP-PLUS4               PIC X(4).
  5641         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5642             20  CF-CAN-POSTAL-1            PIC XXX.
  5643             20  CF-CAN-POSTAL-2            PIC XXX.
  5644             20  FILLER                     PIC XXX.
  5645
  5646         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5647         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5648         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5649
  5650         16  CF-RATING-SWITCH               PIC X.
  5651             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5652             88  CF-NO-RATING                   VALUE 'N'.
  5653
  5654         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5655
  5656         16  CF-CARRIER-OVER-SHORT.
  5657             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5658             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5659
  5660         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5661         16  CF-SECPAY-SWITCH               PIC X.
  5662             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5663             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5664         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5665         16  FILLER                         PIC X(448).
  5666*        16  FILLER                         PIC X(452).
  5667
  5668
  5669****************************************************************
  5670*             MORTALITY MASTER RECORD                          *
  5671****************************************************************
  5672
  5673     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5674         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5675                                INDEXED BY CF-MORT-NDX.
  5676             20  CF-MORT-TABLE              PIC X(5).
  5677             20  CF-MORT-TABLE-TYPE         PIC X.
  5678                 88  CF-MORT-JOINT              VALUE 'J'.
  5679                 88  CF-MORT-SINGLE             VALUE 'S'.
  5680                 88  CF-MORT-COMBINED           VALUE 'C'.
  5681                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5682                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5683             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5684             20  CF-MORT-AGE-METHOD         PIC XX.
  5685                 88  CF-AGE-LAST                VALUE 'AL'.
  5686                 88  CF-AGE-NEAR                VALUE 'AN'.
  5687             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5688             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 105
* EL050.cbl
  5689                                            PIC X.
  5690                 88  CF-MINUS                   VALUE '-'.
  5691                 88  CF-PLUS                    VALUE '+'.
  5692             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5693             20  CF-MORT-JOINT-CODE         PIC X.
  5694                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5695             20  CF-MORT-PC-Q               PIC X.
  5696                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5697             20  CF-MORT-TABLE-CODE         PIC X(4).
  5698             20  CF-MORT-COMMENTS           PIC X(15).
  5699             20  FILLER                     PIC X(14).
  5700
  5701         16  FILLER                         PIC X(251).
  5702
  5703
  5704****************************************************************
  5705*             BUSSINESS TYPE MASTER RECORD                     *
  5706****************************************************************
  5707
  5708     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5709* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5710* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5711* AND RECORD 05 IS TYPES 81-99
  5712         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5713             20  CF-BUSINESS-TITLE          PIC  X(19).
  5714             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5715                                            PIC S9V9(4) COMP-3.
  5716             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5717             20  FILLER                     PIC  X.
  5718         16  FILLER                         PIC  X(248).
  5719
  5720
  5721****************************************************************
  5722*             TERMINAL MASTER RECORD                           *
  5723****************************************************************
  5724
  5725     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5726
  5727         16  CF-COMPANY-TERMINALS.
  5728             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5729                                  PIC X(4).
  5730         16  FILLER               PIC X(248).
  5731
  5732
  5733****************************************************************
  5734*             LIFE EDIT MASTER RECORD                          *
  5735****************************************************************
  5736
  5737     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5738         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5739             20  CF-LIFE-CODE-IN            PIC XX.
  5740             20  CF-LIFE-CODE-OUT           PIC XX.
  5741         16  FILLER                         PIC X(248).
  5742
  5743
  5744****************************************************************
  5745*             AH EDIT MASTER RECORD                            *
  5746****************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 106
* EL050.cbl
  5747
  5748     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5749         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5750             20  CF-AH-CODE-IN              PIC XXX.
  5751             20  CF-AH-CODE-OUT             PIC XX.
  5752         16  FILLER                         PIC X(248).
  5753
  5754
  5755****************************************************************
  5756*             CREDIBILITY TABLES                               *
  5757****************************************************************
  5758
  5759     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5760         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5761                             INDEXED BY CF-CRDB-NDX.
  5762             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5763             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5764             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5765         16  FILLER                         PIC  X(332).
  5766
  5767
  5768****************************************************************
  5769*             REPORT CUSTOMIZATION RECORD                      *
  5770****************************************************************
  5771
  5772     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5773         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5774             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5775             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5776             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5777**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5778****       A T-TRANSFER.                                   ****
  5779             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5780
  5781         16  FILLER                         PIC XX.
  5782
  5783         16  CF-CARRIER-CNTL-OPT.
  5784             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5785                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5786                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5787             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5788                                            PIC X.
  5789         16  CF-GROUP-CNTL-OPT.
  5790             20  CF-GROUP-OPT-SEQ           PIC 9.
  5791                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5792                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5793             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5794                                            PIC X(6).
  5795         16  CF-STATE-CNTL-OPT.
  5796             20  CF-STATE-OPT-SEQ           PIC 9.
  5797                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5798                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5799             20  CF-STATE-SELECT OCCURS 3 TIMES
  5800                                            PIC XX.
  5801         16  CF-ACCOUNT-CNTL-OPT.
  5802             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5803                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5804                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 107
* EL050.cbl
  5805             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5806                                            PIC X(10).
  5807         16  CF-BUS-TYP-CNTL-OPT.
  5808             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5809                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5810                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5811             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5812                                            PIC XX.
  5813         16  CF-LF-TYP-CNTL-OPT.
  5814             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5815                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5816                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5817             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5818                                            PIC XX.
  5819         16  CF-AH-TYP-CNTL-OPT.
  5820             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5821                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5822                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5823             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5824                                            PIC XX.
  5825         16  CF-REPTCD1-CNTL-OPT.
  5826             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5827                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5828                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5829             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5830                                            PIC X(10).
  5831         16  CF-REPTCD2-CNTL-OPT.
  5832             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5833                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5834                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5835             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5836                                            PIC X(10).
  5837         16  CF-USER1-CNTL-OPT.
  5838             20  CF-USER1-OPT-SEQ           PIC 9.
  5839                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5840                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5841             20  CF-USER1-SELECT OCCURS 3 TIMES
  5842                                            PIC X(10).
  5843         16  CF-USER2-CNTL-OPT.
  5844             20  CF-USER2-OPT-SEQ           PIC 9.
  5845                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5846                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5847             20  CF-USER2-SELECT OCCURS 3 TIMES
  5848                                            PIC X(10).
  5849         16  CF-USER3-CNTL-OPT.
  5850             20  CF-USER3-OPT-SEQ           PIC 9.
  5851                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5852                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5853             20  CF-USER3-SELECT OCCURS 3 TIMES
  5854                                            PIC X(10).
  5855         16  CF-USER4-CNTL-OPT.
  5856             20  CF-USER4-OPT-SEQ           PIC 9.
  5857                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5858                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5859             20  CF-USER4-SELECT OCCURS 3 TIMES
  5860                                            PIC X(10).
  5861         16  CF-USER5-CNTL-OPT.
  5862             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 108
* EL050.cbl
  5863                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5864                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5865             20  CF-USER5-SELECT OCCURS 3 TIMES
  5866                                            PIC X(10).
  5867         16  CF-REINS-CNTL-OPT.
  5868             20  CF-REINS-OPT-SEQ           PIC 9.
  5869                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5870                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5871             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5872                 24  CF-REINS-PRIME         PIC XXX.
  5873                 24  CF-REINS-SUB           PIC XXX.
  5874
  5875         16  CF-AGENT-CNTL-OPT.
  5876             20  CF-AGENT-OPT-SEQ           PIC 9.
  5877                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5878                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5879             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5880                                            PIC X(10).
  5881
  5882         16  FILLER                         PIC X(43).
  5883
  5884         16  CF-LOSS-RATIO-SELECT.
  5885             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5886             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5887         16  CF-ENTRY-DATE-SELECT.
  5888             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5889             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5890         16  CF-EFFECTIVE-DATE-SELECT.
  5891             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5892             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5893
  5894         16  CF-EXCEPTION-LIST-IND          PIC X.
  5895             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5896
  5897         16  FILLER                         PIC X(318).
  5898
  5899****************************************************************
  5900*                  EXCEPTION REPORTING RECORD                  *
  5901****************************************************************
  5902
  5903     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5904         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5905             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5906
  5907         16  CF-COMBINED-LIFE-AH-OPT.
  5908             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5909             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5910             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5911             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5912
  5913         16  CF-LIFE-OPT.
  5914             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5915             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5916             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5917             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5918             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5919             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5920             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 109
* EL050.cbl
  5921             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5922             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5923             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5924
  5925         16  CF-AH-OPT.
  5926             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5927             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5928             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5929             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5930             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5931             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5932             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5933             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5934             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5935             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5936
  5937         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5938             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5939             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5940             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5941
  5942         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5943
  5944         16  FILLER                         PIC X(673).
  5945
  5946
  5947****************************************************************
  5948*             MORTGAGE SYSTEM PLAN RECORD                      *
  5949****************************************************************
  5950
  5951     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5952         16  CF-PLAN-TYPE                   PIC X.
  5953             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5954             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5955             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5956         16  CF-PLAN-ABBREV                 PIC XXX.
  5957         16  CF-PLAN-DESCRIPT               PIC X(10).
  5958         16  CF-PLAN-NOTES                  PIC X(20).
  5959         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5960         16  CF-PLAN-UNDERWRITING.
  5961             20  CF-PLAN-TERM-DATA.
  5962                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5963                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5964             20  CF-PLAN-AGE-DATA.
  5965                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5966                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5967                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5968             20  CF-PLAN-BENEFIT-DATA.
  5969                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5970                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5971                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5972                                            PIC S9(7)V99  COMP-3.
  5973         16  CF-PLAN-POLICY-FORMS.
  5974             20  CF-POLICY-FORM             PIC X(12).
  5975             20  CF-MASTER-APPLICATION      PIC X(12).
  5976             20  CF-MASTER-POLICY           PIC X(12).
  5977         16  CF-PLAN-RATING.
  5978             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 110
* EL050.cbl
  5979             20  CF-SEX-RATING              PIC X.
  5980                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5981                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5982             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5983             20  CF-SUB-STD-TYPE            PIC X.
  5984                 88  CF-PCT-OF-PREM            VALUE '1'.
  5985                 88  CF-PCT-OF-BENE            VALUE '2'.
  5986         16  CF-PLAN-PREM-TOLERANCES.
  5987             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5988             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5989         16  CF-PLAN-PYMT-TOLERANCES.
  5990             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5991             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5992         16  CF-PLAN-MISC-DATA.
  5993             20  FILLER                     PIC X.
  5994             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5995             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5996         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5997         16  CF-PLAN-IND-GRP                PIC X.
  5998             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5999                                                     '1'.
  6000             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6001                                                     '2'.
  6002         16  CF-MIB-SEARCH-SW               PIC X.
  6003             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6004             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6005             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6006             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6007         16  CF-ALPHA-SEARCH-SW             PIC X.
  6008             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6009             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6010             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6011             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6012             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6013             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6014             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6015             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6016             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6017             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6018                                                     'A' 'B' 'C'
  6019                                                     'X' 'Y' 'Z'.
  6020         16  CF-EFF-DT-RULE-SW              PIC X.
  6021             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6022             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6023             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6024             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6025             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6026         16  FILLER                         PIC X(4).
  6027         16  CF-HEALTH-QUESTIONS            PIC X.
  6028             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6029         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6030         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6031         16  CF-PLAN-SNGL-JNT               PIC X.
  6032             88  CF-COMBINED-PLAN              VALUE 'C'.
  6033             88  CF-JNT-PLAN                   VALUE 'J'.
  6034             88  CF-SNGL-PLAN                  VALUE 'S'.
  6035         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6036         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 111
* EL050.cbl
  6037         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6038         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6039         16  CF-RERATE-CNTL                 PIC  X.
  6040             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6041             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6042             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6043             88  CF-AUTO-RECALC                 VALUE '4'.
  6044         16  CF-BENEFIT-TYPE                PIC  X.
  6045             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6046             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6047         16  CF-POLICY-FEE                  PIC S999V99
  6048                                                    COMP-3.
  6049         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6050         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6051         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6052         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6053         16  FILLER                         PIC  X(32).
  6054         16  CF-TERMINATION-FORM            PIC  X(04).
  6055         16  FILLER                         PIC  X(08).
  6056         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6057                                                       COMP-3.
  6058         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6059         16  CF-ISSUE-LETTER                PIC  X(4).
  6060         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6061         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6062             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6063             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6064         16  CF-MP-REFUND-CALC              PIC X.
  6065             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6066             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6067             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6068             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6069             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6070             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6071             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6072             88  CF-MP-REFD-MEAN                VALUE '8'.
  6073         16  CF-ALT-RATE-CODE               PIC  X(5).
  6074
  6075
  6076         16  FILLER                         PIC X(498).
  6077****************************************************************
  6078*             MORTGAGE COMPANY MASTER RECORD                   *
  6079****************************************************************
  6080
  6081     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6082         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6083         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6084             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6085             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6086             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6087             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6088             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6089
  6090         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6091         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6092         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6093         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6094         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 112
* EL050.cbl
  6095
  6096         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6097             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6098         16  CF-MP-RECON-USE-IND            PIC X(1).
  6099             88  CF-MP-USE-RECON             VALUE 'Y'.
  6100         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6101             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6102         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6103             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6104             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6105         16  FILLER                         PIC X(1).
  6106         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6107             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6108         16  CF-MORTG-MIB-VERSION           PIC X.
  6109             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6110             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6111             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6112         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6113             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6114                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6115             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6116                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6117             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6118                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6119             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6120                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6121             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6122                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6123             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6124                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6125         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6126         16  FILLER                         PIC X(7).
  6127         16  CF-MORTG-DESTINATION-SYMBOL.
  6128             20  CF-MORTG-MIB-COMM          PIC X(5).
  6129             20  CF-MORTG-MIB-TERM          PIC X(5).
  6130         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6131             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6132         16  FILLER                         PIC X(03).
  6133         16  CF-MP-CHECK-NO-CONTROL.
  6134             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6135                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6136                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6137                                                ' ' LOW-VALUES.
  6138                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6139                                               VALUE '3'.
  6140         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6141         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6142         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6143             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6144                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6145             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6146                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6147             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6148                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6149             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6150                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6151             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6152                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 113
* EL050.cbl
  6153             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6154                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6155         16  CF-MORTG-BILLING-AREA.
  6156             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6157                                            PIC X.
  6158         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6159         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6160         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6161         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6162             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6163             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6164         16  FILLER                         PIC X.
  6165         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6166             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6167             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6168         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6169         16  FILLER                         PIC X(8).
  6170         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6171         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6172         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6173         16  CF-ACH-COMPANY-ID.
  6174             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6175                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6176                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6177                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6178             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6179         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6180             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6181         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6182             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6183             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6184         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6185         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6186         16  FILLER                         PIC X(536).
  6187
  6188****************************************************************
  6189*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6190****************************************************************
  6191
  6192     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6193         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6194             20  CF-FEMALE-HEIGHT.
  6195                 24  CF-FEMALE-FT           PIC 99.
  6196                 24  CF-FEMALE-IN           PIC 99.
  6197             20  CF-FEMALE-MIN-WT           PIC 999.
  6198             20  CF-FEMALE-MAX-WT           PIC 999.
  6199         16  FILLER                         PIC X(428).
  6200
  6201     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6202         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6203             20  CF-MALE-HEIGHT.
  6204                 24  CF-MALE-FT             PIC 99.
  6205                 24  CF-MALE-IN             PIC 99.
  6206             20  CF-MALE-MIN-WT             PIC 999.
  6207             20  CF-MALE-MAX-WT             PIC 999.
  6208         16  FILLER                         PIC X(428).
  6209******************************************************************
  6210*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 114
* EL050.cbl
  6211******************************************************************
  6212     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6213         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6214             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6215             20  CF-SYS-LETTER-ID           PIC X(04).
  6216             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6217             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6218             20  CF-SYS-RESET-SW            PIC X(01).
  6219             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6220             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6221
  6222         16  FILLER                         PIC X(50).
  6223
  6224         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6225             20  CF-USER-ACTIVE-SW          PIC X(01).
  6226             20  CF-USER-LETTER-ID          PIC X(04).
  6227             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6228             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6229             20  CF-USER-RESET-SW           PIC X(01).
  6230             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6231             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6232             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6233
  6234         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 115
* EL050.cbl
  6236*    COPY ERCACCT.
  6237******************************************************************
  6238*                                                                *
  6239*                                                                *
  6240*                            ERCACCT                             *
  6241*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6242*                            VMOD=2.031                          *
  6243*                                                                *
  6244*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6245*                                                                *
  6246*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6247*   VSAM ACCOUNT MASTER FILES.                                   *
  6248*                                                                *
  6249*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6250*                                                                *
  6251*   FILE TYPE = VSAM,KSDS                                        *
  6252*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6253*                                                                *
  6254*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6255*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6256*                                                                *
  6257*   LOG = NO                                                     *
  6258*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6259*                                                                *
  6260*                                                                *
  6261******************************************************************
  6262*                   C H A N G E   L O G
  6263*
  6264* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6265*-----------------------------------------------------------------
  6266*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6267* EFFECTIVE    NUMBER
  6268*-----------------------------------------------------------------
  6269* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6270* 092705    2005050300006  PEMA  ADD SPP LEASES
  6271* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6272* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6273* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6274* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6275******************************************************************
  6276
  6277 01  ACCOUNT-MASTER.
  6278     12  AM-RECORD-ID                      PIC XX.
  6279         88  VALID-AM-ID                      VALUE 'AM'.
  6280
  6281     12  AM-CONTROL-PRIMARY.
  6282         16  AM-COMPANY-CD                 PIC X.
  6283         16  AM-MSTR-CNTRL.
  6284             20  AM-CONTROL-A.
  6285                 24  AM-CARRIER            PIC X.
  6286                 24  AM-GROUPING.
  6287                     28 AM-GROUPING-PREFIX PIC XXX.
  6288                     28 AM-GROUPING-PRIME  PIC XXX.
  6289                 24  AM-STATE              PIC XX.
  6290                 24  AM-ACCOUNT.
  6291                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6292                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6293             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 116
* EL050.cbl
  6294                                           PIC X(19).
  6295             20  AM-CNTRL-B.
  6296                 24  AM-EXPIRATION-DT      PIC XX.
  6297                 24  FILLER                PIC X(4).
  6298             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6299                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6300
  6301     12  AM-CONTROL-BY-VAR-GRP.
  6302         16  AM-COMPANY-CD-A1              PIC X.
  6303         16  AM-VG-CARRIER                 PIC X.
  6304         16  AM-VG-GROUPING                PIC X(6).
  6305         16  AM-VG-STATE                   PIC XX.
  6306         16  AM-VG-ACCOUNT                 PIC X(10).
  6307         16  AM-VG-DATE.
  6308             20  AM-VG-EXPIRATION-DT       PIC XX.
  6309             20  FILLER                    PIC X(4).
  6310         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6311                                           PIC 9(11)      COMP-3.
  6312     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6313         16  FILLER                        PIC X(10).
  6314         16  AM-VG-KEY3.
  6315             20  AM-VG3-ACCOUNT            PIC X(10).
  6316             20  AM-VG3-EXP-DT             PIC XX.
  6317         16  FILLER                        PIC X(4).
  6318     12  AM-MAINT-INFORMATION.
  6319         16  AM-LAST-MAINT-DT              PIC XX.
  6320         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6321         16  AM-LAST-MAINT-USER            PIC X(4).
  6322         16  FILLER                        PIC XX.
  6323
  6324     12  AM-EFFECTIVE-DT                   PIC XX.
  6325     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6326
  6327     12  AM-PREV-DATES  COMP-3.
  6328         16  AM-PREV-EXP-DT                PIC 9(11).
  6329         16  AM-PREV-EFF-DT                PIC 9(11).
  6330
  6331     12  AM-REPORT-CODE-1                  PIC X(10).
  6332     12  AM-REPORT-CODE-2                  PIC X(10).
  6333
  6334     12  AM-CITY-CODE                      PIC X(4).
  6335     12  AM-COUNTY-PARISH                  PIC X(6).
  6336
  6337     12  AM-NAME                           PIC X(30).
  6338     12  AM-PERSON                         PIC X(30).
  6339     12  AM-ADDRS                          PIC X(30).
  6340     12  AM-CITY.
  6341         16  AM-ADDR-CITY                  PIC X(28).
  6342         16  AM-ADDR-STATE                 PIC XX.
  6343     12  AM-ZIP.
  6344         16  AM-ZIP-PRIME.
  6345             20  AM-ZIP-PRI-1ST            PIC X.
  6346                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6347             20  FILLER                    PIC X(4).
  6348         16  AM-ZIP-PLUS4                  PIC X(4).
  6349     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6350         16  AM-CAN-POSTAL-1               PIC XXX.
  6351         16  AM-CAN-POSTAL-2               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 117
* EL050.cbl
  6352         16  FILLER                        PIC XXX.
  6353     12  AM-TEL-NO.
  6354         16  AM-AREA-CODE                  PIC 999.
  6355         16  AM-TEL-PRE                    PIC 999.
  6356         16  AM-TEL-NBR                    PIC 9(4).
  6357     12  AM-TEL-LOC                        PIC X.
  6358         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6359         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6360
  6361     12  AM-COMM-STRUCTURE.
  6362         16  AM-DEFN-1.
  6363             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6364                 24  AM-AGT.
  6365                     28  AM-AGT-PREFIX     PIC X(4).
  6366                     28  AM-AGT-PRIME      PIC X(6).
  6367                 24  AM-COM-TYP            PIC X.
  6368                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6369                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6370                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6371                 24  AM-RECALC-LV-INDIC    PIC X.
  6372                 24  AM-RETRO-LV-INDIC     PIC X.
  6373                 24  AM-GL-CODES           PIC X.
  6374                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6375                 24  FILLER                PIC X(01).
  6376         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6377             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6378                 24  FILLER                PIC X(11).
  6379                 24  AM-L-COMA             PIC XXX.
  6380                 24  AM-J-COMA             PIC XXX.
  6381                 24  AM-A-COMA             PIC XXX.
  6382                 24  FILLER                PIC X(6).
  6383
  6384     12  AM-COMM-CHANGE-STATUS             PIC X.
  6385         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6386
  6387     12  AM-CSR-CODE                       PIC X(4).
  6388
  6389     12  AM-BILLING-STATUS                 PIC X.
  6390         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6391         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6392     12  AM-AUTO-REFUND-SW                 PIC X.
  6393         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6394         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6395     12  AM-GPCD                           PIC 99.
  6396     12  AM-IG                             PIC X.
  6397         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6398         88  AM-HAS-GROUP                     VALUE '2'.
  6399     12  AM-STATUS                         PIC X.
  6400         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6401         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6402         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6403         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6404         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6405         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6406     12  AM-REMIT-TO                       PIC 99.
  6407     12  AM-ID-NO                          PIC X(11).
  6408
  6409     12  AM-CAL-TABLE                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 118
* EL050.cbl
  6410     12  AM-LF-DEVIATION                   PIC XXX.
  6411     12  AM-AH-DEVIATION                   PIC XXX.
  6412     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6413     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6414     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6415     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6416     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6417     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6418
  6419     12  AM-USER-FIELDS.
  6420         16  AM-FLD-1                      PIC XX.
  6421         16  AM-FLD-2                      PIC XX.
  6422         16  AM-FLD-3                      PIC XX.
  6423         16  AM-FLD-4                      PIC XX.
  6424         16  AM-FLD-5                      PIC XX.
  6425
  6426     12  AM-1ST-PROD-DATE.
  6427         16  AM-1ST-PROD-YR                PIC XX.
  6428         16  AM-1ST-PROD-MO                PIC XX.
  6429         16  AM-1ST-PROD-DA                PIC XX.
  6430     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6431     12  AM-CERTS-PURGED-DATE.
  6432         16  AM-PUR-YR                     PIC XX.
  6433         16  AM-PUR-MO                     PIC XX.
  6434         16  AM-PUR-DA                     PIC XX.
  6435     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6436     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6437     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6438     12  AM-INACTIVE-DATE.
  6439         16  AM-INA-MO                     PIC 99.
  6440         16  AM-INA-DA                     PIC 99.
  6441         16  AM-INA-YR                     PIC 99.
  6442     12  AM-AR-HI-CERT-DATE                PIC XX.
  6443
  6444     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6445     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6446
  6447     12  AM-OB-PAYMENT-MODE                PIC X.
  6448         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6449         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6450         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6451         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6452
  6453     12  AM-AH-ONLY-INDICATOR              PIC X.
  6454         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6455         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6456
  6457     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6458
  6459     12  AM-OVER-SHORT.
  6460         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6461         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6462
  6463     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6464     12  AM-DCC-CLP-STATE                  PIC XX.
  6465
  6466     12  AM-RECALC-COMM                    PIC X.
  6467     12  AM-RECALC-REIN                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 119
* EL050.cbl
  6468
  6469     12  AM-REI-TABLE                      PIC XXX.
  6470     12  AM-REI-ET-LF                      PIC X.
  6471     12  AM-REI-ET-AH                      PIC X.
  6472     12  AM-REI-PE-LF                      PIC X.
  6473     12  AM-REI-PE-AH                      PIC X.
  6474     12  AM-REI-PRT-ST                     PIC X.
  6475     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6476     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6477     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6478     12  AM-REI-GROUP-A                    PIC X(6).
  6479     12  AM-REI-MORT                       PIC X(4).
  6480     12  AM-REI-PRT-OW                     PIC X.
  6481     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6482     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6483     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6484     12  AM-REI-GROUP-B                    PIC X(6).
  6485
  6486     12  AM-TRUST-TYPE                     PIC X(2).
  6487
  6488     12  AM-EMPLOYER-STMT-USED             PIC X.
  6489     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6490
  6491     12  AM-STD-AH-TYPE                    PIC XX.
  6492     12  AM-EARN-METHODS.
  6493         16  AM-EARN-METHOD-R              PIC X.
  6494             88 AM-REF-RL-R78                 VALUE 'R'.
  6495             88 AM-REF-RL-PR                  VALUE 'P'.
  6496             88 AM-REF-RL-MEAN                VALUE 'M'.
  6497             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6498         16  AM-EARN-METHOD-L              PIC X.
  6499             88 AM-REF-LL-R78                 VALUE 'R'.
  6500             88 AM-REF-LL-PR                  VALUE 'P'.
  6501             88 AM-REF-LL-MEAN                VALUE 'M'.
  6502             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6503         16  AM-EARN-METHOD-A              PIC X.
  6504             88 AM-REF-AH-R78                 VALUE 'R'.
  6505             88 AM-REF-AH-PR                  VALUE 'P'.
  6506             88 AM-REF-AH-MEAN                VALUE 'M'.
  6507             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6508             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6509             88 AM-REF-AH-NET                 VALUE 'N'.
  6510
  6511     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6512     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6513     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6514
  6515     12  AM-RET-Y-N                        PIC X.
  6516     12  AM-RET-P-E                        PIC X.
  6517     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6518     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6519     12  AM-RET-GRP                        PIC X(6).
  6520     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6521         16  AM-POOL-PRIME                 PIC XXX.
  6522         16  AM-POOL-SUB                   PIC XXX.
  6523     12  AM-RETRO-EARNINGS.
  6524         16  AM-RET-EARN-R                 PIC X.
  6525         16  AM-RET-EARN-L                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 120
* EL050.cbl
  6526         16  AM-RET-EARN-A                 PIC X.
  6527     12  AM-RET-ST-TAX-USE                 PIC X.
  6528         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6529         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6530     12  AM-RETRO-BEG-EARNINGS.
  6531         16  AM-RET-BEG-EARN-R             PIC X.
  6532         16  AM-RET-BEG-EARN-L             PIC X.
  6533         16  AM-RET-BEG-EARN-A             PIC X.
  6534     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6535     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6536
  6537     12  AM-USER-SELECT-OPTIONS.
  6538         16  AM-USER-SELECT-1              PIC X(10).
  6539         16  AM-USER-SELECT-2              PIC X(10).
  6540         16  AM-USER-SELECT-3              PIC X(10).
  6541         16  AM-USER-SELECT-4              PIC X(10).
  6542         16  AM-USER-SELECT-5              PIC X(10).
  6543
  6544     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6545
  6546     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6547
  6548     12  AM-RPT045A-SWITCH                 PIC X.
  6549         88  RPT045A-OFF                   VALUE 'N'.
  6550
  6551     12  AM-INSURANCE-LIMITS.
  6552         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6553         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6554
  6555     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6556         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6557
  6558     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6559         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6560         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6561
  6562     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6563
  6564     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6565     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6566     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6567     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6568     12  FILLER                            PIC X(5).
  6569     12  AM-REPORT-CODE-3                  PIC X(10).
  6570*    12  FILLER                            PIC X(22).
  6571
  6572     12  AM-RESERVE-DATE.
  6573         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6574         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6575         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6576
  6577     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6578     12  AM-NOTIFICATION-TYPES.
  6579         16  AM-NOTIF-OF-LETTERS           PIC X.
  6580         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6581         16  AM-NOTIF-OF-REPORTS           PIC X.
  6582         16  AM-NOTIF-OF-STATUS            PIC X.
  6583
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 121
* EL050.cbl
  6584     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6585         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6586         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6587         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6588         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6589
  6590     12  AM-BENEFIT-CONTROLS.
  6591         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6592             20  AM-BENEFIT-CODE           PIC XX.
  6593             20  AM-BENEFIT-TYPE           PIC X.
  6594             20  AM-BENEFIT-REVISION       PIC XXX.
  6595             20  AM-BENEFIT-REM-TERM       PIC X.
  6596             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6597             20  FILLER                    PIC XX.
  6598         16  FILLER                        PIC X(80).
  6599
  6600     12  AM-TRANSFER-DATA.
  6601         16  AM-TRANSFERRED-FROM.
  6602             20  AM-TRNFROM-CARRIER        PIC X.
  6603             20  AM-TRNFROM-GROUPING.
  6604                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6605                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6606             20  AM-TRNFROM-STATE          PIC XX.
  6607             20  AM-TRNFROM-ACCOUNT.
  6608                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6609                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6610             20  AM-TRNFROM-DTE            PIC XX.
  6611         16  AM-TRANSFERRED-TO.
  6612             20  AM-TRNTO-CARRIER          PIC X.
  6613             20  AM-TRNTO-GROUPING.
  6614                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6615                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6616             20  AM-TRNTO-STATE            PIC XX.
  6617             20  AM-TRNTO-ACCOUNT.
  6618                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6619                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6620             20  AM-TRNTO-DTE              PIC XX.
  6621         16  FILLER                        PIC X(10).
  6622
  6623     12  AM-SAVED-REMIT-TO                 PIC 99.
  6624
  6625     12  AM-COMM-STRUCTURE-SAVED.
  6626         16  AM-DEFN-1-SAVED.
  6627             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6628                 24  AM-AGT-SV             PIC X(10).
  6629                 24  AM-COM-TYP-SV         PIC X.
  6630                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6631                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6632                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6633                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6634                 24  FILLER                PIC X.
  6635                 24  AM-GL-CODES-SV        PIC X.
  6636                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6637                 24  FILLER                PIC X.
  6638         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6639             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6640                 24  FILLER                PIC X(11).
  6641                 24  AM-L-COMA-SV          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 122
* EL050.cbl
  6642                 24  AM-J-COMA-SV          PIC XXX.
  6643                 24  AM-A-COMA-SV          PIC XXX.
  6644                 24  FILLER                PIC X(6).
  6645
  6646     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6647         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6648            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6649            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6650            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6651
  6652     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6653     12  FILLER                            PIC X(120).
  6654
  6655     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6656         16  AM-CONTROL-NAME               PIC X(30).
  6657         16  AM-EXECUTIVE-ONE.
  6658             20  AM-EXEC1-NAME             PIC X(15).
  6659             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6660                                                          COMP-3.
  6661             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6662                                                          COMP-3.
  6663         16  AM-EXECUTIVE-TWO.
  6664             20  AM-EXEC2-NAME             PIC X(15).
  6665             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6666                                                          COMP-3.
  6667             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6668                                                          COMP-3.
  6669
  6670     12  AM-RETRO-ADDITIONAL-DATA.
  6671         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6672         16  AM-RETRO-PREM-P-E             PIC X.
  6673         16  AM-RETRO-CLMS-P-I             PIC X.
  6674         16  AM-RETRO-RET-BRACKET-LF.
  6675             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6676                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6677                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6678             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6679                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6680                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6681             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6682                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6683                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6684         16  AM-RETRO-RET-BRACKET-AH.
  6685             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6686                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6687                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6688                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6689             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6690                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6691                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6692             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6693                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6694                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6695
  6696     12  AM-COMMENTS.
  6697         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6698
  6699     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 123
* EL050.cbl
  6700         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6701         16  AM-FLI-BILLING-CODE           PIC X.
  6702         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6703         16  AM-FLI-UNITED-IDENT           PIC X.
  6704         16  AM-FLI-INTEREST-LOST-DATA.
  6705             20  AM-FLI-BANK-NO            PIC X(5).
  6706             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6707             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6708             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6709         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6710             20  AM-FLI-AGT                PIC X(9).
  6711             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6712             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6713         16  FILLER                        PIC X(102).
  6714
  6715     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6716         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6717             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6718             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6719             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6720             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6721             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6722         16  FILLER                          PIC X(10).
  6723******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 124
* EL050.cbl
  6725*    COPY ERCREIN.
  6726******************************************************************
  6727*                                                                *
  6728*                            ERCREIN                             *
  6729*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6730*                            VMOD=2.010                          *
  6731*                                                                *
  6732*   ONLINE CREDIT SYSTEM                                         *
  6733*                                                                *
  6734*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6735*                                                                *
  6736*   FILE TYPE = VSAM,KSDS                                        *
  6737*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6738*                                                                *
  6739*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6740*       ALTERNATE PATH = NONE                                    *
  6741*                                                                *
  6742*   LOG = NO                                                     *
  6743*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6744*                                                                *
  6745******************************************************************
  6746*                   C H A N G E   L O G
  6747*
  6748* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6749*-----------------------------------------------------------------
  6750*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6751* EFFECTIVE    NUMBER
  6752*-----------------------------------------------------------------
  6753* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6754* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6755******************************************************************
  6756 01  REINSURANCE-RECORD.
  6757     12  RE-RECORD-ID                      PIC XX.
  6758         88  VALID-RE-ID                      VALUE 'RE'.
  6759
  6760     12  RE-CONTROL-PRIMARY.
  6761         16  RE-COMPANY-CD                 PIC X.
  6762         16  RE-KEY.
  6763             20  RE-CODE                   PIC X.
  6764                 88  RE-TABLE-RECORD          VALUE 'A'.
  6765                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6766             20  RE-TABLE                  PIC XXX.
  6767             20  FILLER                    PIC XXX.
  6768         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6769             20  FILLER                    PIC X.
  6770             20  RE-COMPANY.
  6771                 24  RE-COMP-PRIME         PIC XXX.
  6772                 24  RE-COMP-SUB           PIC XXX.
  6773
  6774     12  RE-MAINT-INFORMATION.
  6775         16  RE-LAST-MAINT-DT              PIC XX.
  6776         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6777         16  RE-LAST-MAINT-USER            PIC X(4).
  6778         16  FILLER                        PIC X(10).
  6779
  6780     12  RE-TABLE-DATA.
  6781         16  RE-100-COMP                   PIC 99.
  6782
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 125
* EL050.cbl
  6783         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6784             20  RE-REI-COMP-NO.
  6785                 24  RE-REI-COMP           PIC XXX.
  6786                 24  RE-REI-COMP-SUB       PIC XXX.
  6787             20  RE-LF-QC                  PIC X.
  6788             20  RE-AH-QC                  PIC X.
  6789             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6790             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6791             20  RE-LFAGE-LO               PIC 99.
  6792             20  RE-LFAGE-HI               PIC 99.
  6793             20  RE-AHAGE-LO               PIC 99.
  6794             20  RE-AHAGE-HI               PIC 99.
  6795             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6796             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6797             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6798             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6799             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6800             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6801             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6802             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6803             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6804             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6805             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6806             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6807             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6808             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6809             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6810             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6811             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6812             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6813             20  RE-LF-BEN-CODE            PIC X.
  6814             20  RE-AH-BEN-CODE            PIC X.
  6815             20  RE-INTERACTIVE            PIC X.
  6816             20  RE-REMAINING              PIC X.
  6817             20  RE-LF-RUNOFF-SW           PIC X.
  6818             20  RE-AH-RUNOFF-SW           PIC X.
  6819             20  FILLER                    PIC X(19).
  6820
  6821         16  RE-COMP-INFO-END              PIC X(6).
  6822         16  RE-NSP-ST-CD-LF               PIC XX.
  6823         16  RE-NSP-ST-CD-AH               PIC XX.
  6824         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6825             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6826
  6827         16  FILLER                        PIC X(27).
  6828
  6829     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6830         16  RE-NAME                       PIC X(30).
  6831         16  RE-LF-PE                      PIC X.
  6832         16  RE-AH-PE                      PIC X.
  6833         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6834         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6835         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6836         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6837         16  RE-PRT-ST                     PIC X.
  6838         16  RE-PRT-OW                     PIC X.
  6839         16  RE-MORT-CODE                  PIC X(4).
  6840         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 126
* EL050.cbl
  6841         16  RE-ZERO-LF-FEE                PIC X.
  6842         16  RE-ZERO-AH-FEE                PIC X.
  6843         16  RE-CEDE-NAME                  PIC X(30).
  6844         16  RE-LF-COMM                    PIC X.
  6845         16  RE-AH-COMM                    PIC X.
  6846         16  RE-LF-TAX                     PIC X.
  6847         16  RE-AH-TAX                     PIC X.
  6848         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6849         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6850         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6851
  6852         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6853             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6854
  6855         16  RE-LF-CEDING-FEE-BRACKETS.
  6856             20  RE-LF-FEE-METHOD          PIC X.
  6857                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6858                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6859                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6860                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6861             20  RE-LF-FEE-BASIS           PIC X.
  6862                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6863                 88  RE-LF-NET-CEDED               VALUE '2'.
  6864                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6865                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6866                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6867                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6868                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6869                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6870             20  FILLER                    PIC XXX.
  6871             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6872                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6873                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6874
  6875         16  RE-AH-CEDING-FEE-BRACKETS.
  6876             20  RE-AH-FEE-METHOD          PIC X.
  6877                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6878                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6879                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6880                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6881             20  RE-AH-FEE-BASIS           PIC X.
  6882                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6883                 88  RE-AH-NET-CEDED               VALUE '2'.
  6884                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6885                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6886                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6887                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6888                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6889                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6890             20  FILLER                    PIC XXX.
  6891             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6892                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6893                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6894
  6895         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6896
  6897         16  RE-OLD-CEDING-STMT            PIC X.
  6898
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 127
* EL050.cbl
  6899         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6900         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6901         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6902         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6903         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6904         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6905         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6906         16  RE-MORT-SW                    PIC X.
  6907         16  RE-CEDING-TYPE-FLAG           PIC X.
  6908             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6909             88  RE-CEDED                          VALUE 'C'.
  6910             88  RE-ASSUMED                        VALUE 'A'.
  6911             88  RE-PHANTOM                        VALUE 'P'.
  6912
  6913         16  RE-CEDING-STMT-OPT-A          PIC X.
  6914             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6915         16  RE-CEDING-STMT-OPT-B          PIC X.
  6916             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6917         16  RE-CEDING-STMT-OPT-C          PIC X.
  6918             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6919         16  RE-CEDING-STMT-OPT-D          PIC X.
  6920             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6921         16  RE-CEDING-STMT-OPT-E          PIC X.
  6922             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6923
  6924         16  RE-PRT-CRSV                   PIC X.
  6925
  6926         16  RE-GL-CENTER                  PIC X(4).
  6927
  6928         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6929
  6930         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6931
  6932         16  RE-EARN-STOP-CODE             PIC X.
  6933             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6934             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6935
  6936         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6937             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6938
  6939         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6940         16  FILLER                        PIC X(2281).
  6941
  6942         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6943
  6944******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 128
* EL050.cbl
  6946*    COPY ERCCTBL.
  6947******************************************************************
  6948*                                                                *
  6949*                                                                *
  6950*                            ERCCTBL                             *
  6951*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6952*                            VMOD=2.003
  6953*                                                                *
  6954*   ONLINE CREDIT SYSTEM                                         *
  6955*                                                                *
  6956*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  6957*                                                                *
  6958*   FILE TYPE = VSAM,KSDS                                        *
  6959*   RECORD SIZE = 200   RECFORM = FIXED                          *
  6960*                                                                *
  6961*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  6962*       ALTERNATE PATH = NONE                                    *
  6963*                                                                *
  6964*   LOG = NO                                                     *
  6965*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6966*                                                                *
  6967*                                                                *
  6968******************************************************************
  6969
  6970 01  COMM-TABLE-RECORD.
  6971     12  CT-RECORD-ID                      PIC XX.
  6972         88  VALID-CT-ID                      VALUE 'CT'.
  6973
  6974     12  CT-CONTROL-PRIMARY.
  6975         16  CT-COMPANY-CD                 PIC X.
  6976         16  CT-TABLE                      PIC XXX.
  6977         16  CT-CNTRL-2.
  6978             20  CT-BEN-TYPE               PIC X.
  6979             20  CT-BEN-CODE               PIC XX.
  6980
  6981     12  CT-MAINT-INFORMATION.
  6982         16  CT-LAST-MAINT-DT              PIC XX.
  6983         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6984         16  CT-LAST-MAINT-USER            PIC X(4).
  6985         16  FILLER                        PIC X(31).
  6986
  6987     12  CT-LIMITS.
  6988         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  6989
  6990         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  6991
  6992         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  6993
  6994     12  CT-RATES.
  6995         16  CT-RTX          OCCURS 27 TIMES.
  6996             20  CT-RT                     PIC SV9(5)     COMP-3.
  6997             20  CT-RT-R   REDEFINES
  6998                 CT-RT                     PIC XXX.
  6999
  7000     12  FILLER                            PIC  X(42).
  7001
  7002******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 129
* EL050.cbl
  7004*    COPY ERCFORM.
  7005******************************************************************
  7006*                                                                *
  7007*                                                                *
  7008*                            ERCFORM.                            *
  7009*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7010*                            VMOD=2.003                          *
  7011*                                                                *
  7012*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7013*                                                                *
  7014*    FILE TYPE = VSAM,KSDS                                       *
  7015*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7016*                                                                *
  7017*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7018*                                                                *
  7019*    LOG = YES                                                   *
  7020*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7021******************************************************************
  7022 01  FORM-MASTER.
  7023    12  FO-RECORD-ID                 PIC X(02).
  7024        88  VALID-FO-ID                  VALUE 'FO'.
  7025
  7026    12  FO-CONTROL-PRIMARY.
  7027        16  FO-COMPANY-CD            PIC X(01).
  7028        16  FO-STATE                 PIC X(02).
  7029        16  FO-FORM-ID               PIC X(12).
  7030        16  FO-FORM-EXP-DT           PIC X(02).
  7031
  7032    12  FO-POLICY-FORM-DATA.
  7033        16  FO-IND-GRP-CD            PIC X(01).
  7034        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7035        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7036        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7037        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7038        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7039        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7040        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7041        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7042        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7043        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7044        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7045        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7046        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7047        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7048        16  FO-APP-CERT-USE-CD       PIC X(01).
  7049
  7050    12  FILLER                       PIC X(29).
  7051
  7052    12  FO-FORM-PLAN-TABLE.
  7053        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7054            20  FO-PLAN-TYPE         PIC X(01).
  7055            20  FO-PLAN-ID           PIC X(02).
  7056            20  FO-PLAN-TERM         PIC 9(03).
  7057            20  FO-PLAN-REFUND-METHOD
  7058                                     PIC X.
  7059
  7060    12  FILLER                       PIC X(30).
  7061
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 130
* EL050.cbl
  7062    12  FO-COMMENTS-AREA.
  7063        16  FO-COMMENT-LINE-1        PIC X(78).
  7064
  7065    12  FILLER                       PIC X(20).
  7066
  7067    12  FO-MAINT-INFORMATION.
  7068        16  FO-LAST-MAINT-DT         PIC X(02).
  7069        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7070        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 131
* EL050.cbl
  7072*    COPY ELCMSTR.
  7073******************************************************************
  7074*                                                                *
  7075*                            ELCMSTR.                            *
  7076*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7077*                            VMOD=2.012                          *
  7078*                                                                *
  7079*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7080*                                                                *
  7081*   FILE TYPE = VSAM,KSDS                                        *
  7082*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7083*                                                                *
  7084*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7085*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7086*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7087*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7088*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7089*                                                 RKP=75,LEN=21  *
  7090*                                                                *
  7091*   **** NOTE ****                                               *
  7092*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7093*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7094*                                                                *
  7095*   LOG = YES                                                    *
  7096*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7097******************************************************************
  7098*                   C H A N G E   L O G
  7099*
  7100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7101*-----------------------------------------------------------------
  7102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7103* EFFECTIVE    NUMBER
  7104*-----------------------------------------------------------------
  7105* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7106* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7107******************************************************************
  7108 01  CLAIM-MASTER.
  7109     12  CL-RECORD-ID                PIC XX.
  7110         88  VALID-CL-ID         VALUE 'CL'.
  7111
  7112     12  CL-CONTROL-PRIMARY.
  7113         16  CL-COMPANY-CD           PIC X.
  7114         16  CL-CARRIER              PIC X.
  7115         16  CL-CLAIM-NO             PIC X(7).
  7116         16  CL-CERT-NO.
  7117             20  CL-CERT-PRIME       PIC X(10).
  7118             20  CL-CERT-SFX         PIC X.
  7119
  7120     12  CL-CONTROL-BY-NAME.
  7121         16  CL-COMPANY-CD-A1        PIC X.
  7122         16  CL-INSURED-LAST-NAME    PIC X(15).
  7123         16  CL-INSURED-NAME.
  7124             20  CL-INSURED-1ST-NAME PIC X(12).
  7125             20  CL-INSURED-MID-INIT PIC X.
  7126
  7127     12  CL-CONTROL-BY-SSN.
  7128         16  CL-COMPANY-CD-A2        PIC X.
  7129         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 132
* EL050.cbl
  7130             20  CL-SSN-STATE        PIC XX.
  7131             20  CL-SSN-ACCOUNT      PIC X(6).
  7132             20  CL-SSN-LN3          PIC X(3).
  7133
  7134     12  CL-CONTROL-BY-CERT-NO.
  7135         16  CL-COMPANY-CD-A4        PIC X.
  7136         16  CL-CERT-NO-A4.
  7137             20  CL-CERT-A4-PRIME    PIC X(10).
  7138             20  CL-CERT-A4-SFX      PIC X.
  7139
  7140     12  CL-CONTROL-BY-CCN.
  7141         16  CL-COMPANY-CD-A5        PIC X.
  7142         16  CL-CCN-A5.
  7143             20  CL-CCN.
  7144                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7145                 24  CL-CCN-PRIME-A5 PIC X(12).
  7146             20  CL-CCN-FILLER-A5    PIC X(4).
  7147
  7148     12  CL-INSURED-PROFILE-DATA.
  7149         16  CL-INSURED-BIRTH-DT     PIC XX.
  7150         16  CL-INSURED-SEX-CD       PIC X.
  7151             88  INSURED-IS-MALE        VALUE 'M'.
  7152             88  INSURED-IS-FEMALE      VALUE 'F'.
  7153             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7154         16  CL-INSURED-OCC-CD       PIC X(6).
  7155         16  FILLER                  PIC X(5).
  7156
  7157     12  CL-PROCESSING-INFO.
  7158         16  CL-PROCESSOR-ID         PIC X(4).
  7159         16  CL-CLAIM-STATUS         PIC X.
  7160             88  CLAIM-IS-OPEN          VALUE 'O'.
  7161             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7162         16  CL-CLAIM-TYPE           PIC X.
  7163*            88  AH-CLAIM               VALUE 'A'.
  7164*            88  LIFE-CLAIM             VALUE 'L'.
  7165*            88  PROPERTY-CLAIM         VALUE 'P'.
  7166*            88  IUI-CLAIM              VALUE 'I'.
  7167*            88  GAP-CLAIM              VALUE 'G'.
  7168         16  CL-CLAIM-PREM-TYPE      PIC X.
  7169             88  SINGLE-PREMIUM         VALUE '1'.
  7170             88  O-B-COVERAGE           VALUE '2'.
  7171             88  OPEN-END-COVERAGE      VALUE '3'.
  7172         16  CL-INCURRED-DT          PIC XX.
  7173         16  CL-REPORTED-DT          PIC XX.
  7174         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7175         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7176         16  CL-LAST-PMT-DT          PIC XX.
  7177         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7178         16  CL-PAID-THRU-DT         PIC XX.
  7179         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7180         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7181         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7182         16  CL-PMT-CALC-METHOD      PIC X.
  7183             88  CL-360-DAY-YR          VALUE '1'.
  7184             88  CL-365-DAY-YR          VALUE '2'.
  7185             88  CL-FULL-MONTHS         VALUE '3'.
  7186         16  CL-CAUSE-CD             PIC X(6).
  7187
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 133
* EL050.cbl
  7188         16  CL-PRIME-CERT-NO.
  7189             20  CL-PRIME-CERT-PRIME PIC X(10).
  7190             20  CL-PRIME-CERT-SFX   PIC X.
  7191
  7192         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7193             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7194             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7195
  7196         16  CL-MICROFILM-NO         PIC X(10).
  7197         16  CL-PROG-FORM-TYPE       PIC X.
  7198         16  CL-LAST-ADD-ON-DT       PIC XX.
  7199
  7200         16  CL-LAST-REOPEN-DT       PIC XX.
  7201         16  CL-LAST-CLOSE-DT        PIC XX.
  7202         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7203             88  FINAL-PAID             VALUE '1'.
  7204             88  CLAIM-DENIED           VALUE '2'.
  7205             88  AUTO-CLOSE             VALUE '3'.
  7206             88  MANUAL-CLOSE           VALUE '4'.
  7207             88  BENEFITS-CHANGED       VALUE 'C'.
  7208             88  SETUP-ERRORS           VALUE 'E'.
  7209         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7210         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7211         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7212             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7213         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7214         16  FILLER                  PIC X.
  7215
  7216     12  CL-CERTIFICATE-DATA.
  7217         16  CL-CERT-ORIGIN          PIC X.
  7218             88  CERT-WAS-ONLINE        VALUE '1'.
  7219             88  CERT-WAS-CREATED       VALUE '2'.
  7220             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7221         16  CL-CERT-KEY-DATA.
  7222             20  CL-CERT-CARRIER     PIC X.
  7223             20  CL-CERT-GROUPING    PIC X(6).
  7224             20  CL-CERT-STATE       PIC XX.
  7225             20  CL-CERT-ACCOUNT.
  7226                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7227                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7228             20  CL-CERT-EFF-DT      PIC XX.
  7229
  7230     12  CL-STATUS-CONTROLS.
  7231         16  CL-PRIORITY-CD          PIC X.
  7232             88  CONFIDENTIAL-DATA      VALUE '8'.
  7233             88  HIGHEST-PRIORITY       VALUE '9'.
  7234         16  CL-SUPV-ATTN-CD         PIC X.
  7235             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7236             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7237         16  CL-PURGED-DT            PIC XX.
  7238         16  CL-RESTORED-DT          PIC XX.
  7239         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7240         16  CL-NEXT-RESEND-DT       PIC XX.
  7241         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7242         16  FILLER                  PIC XX.
  7243         16  CL-LAST-MAINT-DT        PIC XX.
  7244         16  CL-LAST-MAINT-USER      PIC X(4).
  7245         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 134
* EL050.cbl
  7246         16  CL-LAST-MAINT-TYPE      PIC X.
  7247             88  CLAIM-SET-UP           VALUE ' '.
  7248             88  PAYMENT-MADE           VALUE '1'.
  7249             88  LETTER-SENT            VALUE '2'.
  7250             88  MASTER-WAS-ALTERED     VALUE '3'.
  7251             88  MASTER-WAS-RESTORED    VALUE '4'.
  7252             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7253             88  FILE-CONVERTED         VALUE '6'.
  7254             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7255             88  ERROR-CORRECTION       VALUE 'E'.
  7256         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7257         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7258         16  CL-BENEFICIARY          PIC X(10).
  7259         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7260         16  CL-DENIAL-TYPE          PIC X.
  7261             88  CL-TYPE-DENIAL          VALUE '1'.
  7262             88  CL-TYPE-RESCISSION      VALUE '2'.
  7263             88  CL-TYPE-REFORMATION     VALUE '3'.
  7264             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7265             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7266         16  FILLER                  PIC X(5).
  7267
  7268     12  CL-TRAILER-CONTROLS.
  7269         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7270             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7271             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7272             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7273         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7274         16  FILLER                  PIC XX.
  7275         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7276         16  CL-ADDRESS-TRAILER-CNT.
  7277             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7278                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7279             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7280                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7281             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7282                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7283             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7284                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7285             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7286                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7287             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7288                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7289             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7290                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7291
  7292     12  CL-CV-REFERENCE-NO.
  7293         16  CL-CV-REFNO-PRIME       PIC X(18).
  7294         16  CL-CV-REFNO-SFX         PIC XX.
  7295
  7296     12  CL-FILE-LOCATION            PIC X(4).
  7297
  7298     12  CL-PROCESS-ERRORS.
  7299         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7300             88  NO-FATAL-ERRORS        VALUE ZERO.
  7301         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7302             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7303
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 135
* EL050.cbl
  7304     12  CL-PRODUCT-CD               PIC X.
  7305
  7306     12  CL-CURRENT-KEY-DATA.
  7307         16  CL-CURRENT-CARRIER      PIC X.
  7308         16  CL-CURRENT-GROUPING     PIC X(6).
  7309         16  CL-CURRENT-STATE        PIC XX.
  7310         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7311
  7312     12  CL-ASSOCIATES               PIC X.
  7313         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7314         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7315         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7316         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7317
  7318     12  CL-ACTIVITY-CODE            PIC 99.
  7319     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7320     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7321
  7322     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7323     12  CL-LAG-REPORT-CODE          PIC 9.
  7324     12  CL-LOAN-TYPE                PIC XX.
  7325     12  CL-LEGAL-STATE              PIC XX.
  7326
  7327*    12  FILLER                      PIC X(5).
  7328     12  CL-YESNOSW                  PIC X.
  7329     12  FILLER                      PIC X(4).
  7330
  7331 01  PLAN-RECORDS.
  7332     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7333     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7334
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 136
* EL050.cbl
  7336 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7337                          ACCOUNT-MASTER REINSURANCE-RECORD
  7338                          COMM-TABLE-RECORD FORM-MASTER
  7339                          CLAIM-MASTER PLAN-RECORDS.
  7340 0000-DFHEXIT SECTION.
  7341     MOVE '9#                    $   ' TO DFHEIV0.
  7342     MOVE 'EL050' TO DFHEIV1.
  7343     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7344
  7345     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7346
  7347
  7348* EXEC CICS  HANDLE CONDITION
  7349*           ERROR    (9300-ABEND)
  7350*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7351*    END-EXEC.
  7352*    MOVE '"$.J                  ! " #00007343' TO DFHEIV0
  7353     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7355     MOVE X'2220233030303037333433' TO DFHEIV0(25:11)
  7356     CALL 'kxdfhei1' USING DFHEIV0
  7357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7358
  7359
  7360 0000-COPY-PROCEDURE-DIV.
  7361*                          COPY ELC50PD.
  7362******************************************************************
  7363*                                                                *
  7364*                            ELC50PD                             *
  7365*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7366*                            VMOD=2.188                          *
  7367*                                                                *
  7368******************************************************************
  7369*                   C H A N G E   L O G
  7370*
  7371* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7372*-----------------------------------------------------------------
  7373*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7374* EFFECTIVE    NUMBER
  7375*-----------------------------------------------------------------
  7376* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7377* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7378* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7379*                             2709 AND 2718
  7380* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7381* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7382* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7383* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7384* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7385*                                IS OPEN OR CNC DT < PD THRU
  7386* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7387* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7388* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7389* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7390* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7391* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7392* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7393* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 137
* EL050.cbl
  7394* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7395* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7396* 020906                   PEMA  EXPAND LOAN OFFICER
  7397* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7398* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7399* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7400* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7401* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7402* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7403* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7404* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7405* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7406* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7407* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7408* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7409* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7410* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7411* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7412* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7413* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7414* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7415* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7416* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7417* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7418* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7419* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7420* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7421* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7422*                                UPDATE VIN ON CERT TRAILER
  7423* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7424* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7425* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7426* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7427* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7428* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7429* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7430* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7431* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7432* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7433* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7434* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7435* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7436* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7437* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7438* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7439* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7440* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7441* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7442* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7443* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7444* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7445* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7446* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7447* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7448* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7449* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7450******************************************************************
  7451************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 138
* EL050.cbl
  7452******************************************************************
  7453
  7454     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7455
  7456     MOVE SPACES                 TO PB-FATAL-FLAG
  7457                                    PB-FORCE-ER-CD
  7458                                    PB-WARN-ER-CD
  7459                                    PB-OUT-BAL-CD.
  7460
  7461     MOVE SPACE                  TO WS-IG-OVRD-AH
  7462                                    WS-IG-OVRD-LF
  7463                                    WS-IG-OVRD-AM
  7464                                    WS-IG-OVRD
  7465                                    WS-IG-OVRD-AH-PL
  7466                                    WS-IG-OVRD-LF-PL
  7467                                    WS-IG-OVRD-AH-BEN
  7468                                    WS-IG-OVRD-LF-BEN.
  7469
  7470******************************************************************
  7471*************       INITIALIZE COMMON ERRORS       ***************
  7472******************************************************************
  7473
  7474     MOVE +0                     TO PB-NO-OF-ERRORS.
  7475     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7476
  7477******************************************************************
  7478
  7479     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7480     SET JULIAN-TO-BIN           TO TRUE.
  7481*    MOVE 5                      TO DC-OPTION-CODE.
  7482     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7483     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7484
  7485     MOVE ZERO                   TO  SUB4.
  7486
  7487 0040-INITIALIZE-GA-BILL-DT.
  7488
  7489     ADD +1                      TO  SUB4.
  7490
  7491     IF  SUB4 GREATER THAN +5
  7492         GO TO 0050-CHECK-CNTL-FOUND.
  7493
  7494     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7495         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7496
  7497     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7498
  7499 0050-CHECK-CNTL-FOUND.
  7500
  7501     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7502        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7503                                         WS-AH-REM-TERM-CALC
  7504                                         EC-CO-REM-TERM-CALC
  7505        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7506        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7507        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7508                                         WS-TOL-AH-CLAIM
  7509        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 139
* EL050.cbl
  7510                                         WS-TOL-AH-PREM
  7511                                         EC-CO-TOL-PREM
  7512        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7513                                         WS-TOL-AH-REFUND
  7514                                         EC-CO-TOL-REFUND
  7515        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7516                                         WS-AH-REFUND-OVS-AMT
  7517                                         EC-CO-OVR-SHT-AMT
  7518        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7519                                         WS-TOL-AH-PREM-PCT
  7520                                         EC-CO-TOL-PREM-PCT
  7521        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7522                                         WS-TOL-AH-REFUND-PCT
  7523                                         EC-CO-TOL-REFUND-PCT
  7524        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7525                                         WS-AH-REFUND-OVS-PCT
  7526                                         EC-CO-OVR-SHT-PCT
  7527        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7528        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7529        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7530        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7531        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7532        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7533        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7534        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7535        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7536        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7537        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7538        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7539                                         EC-CO-MONTH-END-DT
  7540        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7541          GO TO 0100-READ-ACCT.
  7542
  7543     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7544     MOVE SPACES                 TO CNTL-ACCESS.
  7545     MOVE '1'                    TO CNTL-REC-TYPE.
  7546     MOVE +0                     TO CNTL-SEQ-NO.
  7547
  7548     MOVE '1' TO RC-SW-1.
  7549     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7550     IF NOT CF-COMPANY-MASTER
  7551         MOVE ZEROS             TO WK-CO-TOL-PREM
  7552                                   WK-CO-TOL-CLAIM
  7553                                   WK-CO-TOL-REFUND
  7554                                   WK-REFUND-OVS-AMT
  7555                                   WK-REFUND-OVS-PCT
  7556                                   WK-CO-TOL-PREM-PCT
  7557                                   WK-CO-TOL-REFUND-PCT
  7558                                   WK-DEFAULT-APR
  7559                                   WK-CO-MAX-CAP
  7560        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7561                                   WK-CR-R78-METHOD
  7562                                   WK-CO-REF-REJECT-SW
  7563                                   WK-CO-PREM-REJECT-SW
  7564                                   WK-REM-TRM-CALC-OPTION
  7565                                   WK-BIRTH-DATE-INPUT
  7566                                   WK-JOINT-AGE-INPUT
  7567        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 140
* EL050.cbl
  7568        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7569        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7570        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7571          GO TO 0099-COMPANY-NOT-FOUND.
  7572
  7573     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7574        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7575     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7576        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7577     IF CF-CO-TOL-CAP NOT NUMERIC
  7578        MOVE +0                    TO CF-CO-TOL-CAP.
  7579     IF CF-DEFAULT-APR NOT NUMERIC
  7580        MOVE +0                    TO CF-DEFAULT-APR.
  7581
  7582     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7583     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7584     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7585     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7586     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7587     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7588     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7589     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7590     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7591     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7592     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7593     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7594
  7595     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7596          CF-CO-OVR-SHT-AMT > +0
  7597        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7598
  7599     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7600          CF-CO-OVR-SHT-PCT > +0
  7601        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7602
  7603     IF CF-VALID-REM-TRM-OPTION
  7604         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7605     ELSE
  7606         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7607
  7608     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7609     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7610     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7611     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7612
  7613     GO TO 0050-CHECK-CNTL-FOUND.
  7614
  7615 0099-COMPANY-NOT-FOUND.
  7616
  7617     MOVE ER-2616                TO WS-ERROR.
  7618     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7619
  7620 0100-READ-ACCT.
  7621
  7622     MOVE SPACES                 TO DATE-RANGE-SW.
  7623
  7624     IF WK-ACCT-ADDR = ZEROS
  7625        GO TO 0102-ACCT-GETMAIN.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 141
* EL050.cbl
  7626
  7627     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7628     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7629     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7630
  7631     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7632        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7633        GO TO 0105-READ-ACCT
  7634     END-IF
  7635
  7636     IF PB-CARRIER NOT = SPACES
  7637        IF PB-CARRIER NOT = AM-VG-CARRIER
  7638           GO TO 0105-READ-ACCT.
  7639
  7640     IF PB-STATE NOT = SPACES
  7641        IF PB-STATE NOT = AM-VG-STATE
  7642           GO TO 0105-READ-ACCT.
  7643
  7644     IF PB-GROUPING NOT = SPACES
  7645        IF PB-GROUPING NOT = AM-VG-GROUPING
  7646           GO TO 0105-READ-ACCT.
  7647
  7648     MOVE 'X'                 TO DATE-RANGE-SW.
  7649
  7650     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7651        MOVE 'X'                 TO DATE-RANGE-SW
  7652        GO TO 0105-READ-ACCT.
  7653
  7654     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7655        GO TO 0105-READ-ACCT.
  7656
  7657     GO TO 0180-ACCOUNT-FOUND.
  7658
  7659 0102-ACCT-GETMAIN.
  7660     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7661     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7662
  7663 0105-READ-ACCT.
  7664     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7665     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7666     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7667     MOVE PB-STATE               TO ACCT-STATE.
  7668     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7669     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7670
  7671     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7672
  7673     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7674
  7675 0110-FIND-ACCT-TOLERANCES-LOOP.
  7676     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7677
  7678     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7679        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7680        GO TO 0199-ACCT-NOT-FOUND
  7681     END-IF
  7682     IF PB-CARRIER NOT = SPACES
  7683        IF PB-CARRIER NOT = AM-VG-CARRIER
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 142
* EL050.cbl
  7684           GO TO 0199-ACCT-NOT-FOUND.
  7685
  7686     IF PB-STATE NOT = SPACES
  7687        IF PB-STATE NOT = AM-VG-STATE
  7688           GO TO 0199-ACCT-NOT-FOUND.
  7689
  7690     IF PB-GROUPING NOT = SPACES
  7691        IF PB-GROUPING NOT = AM-VG-GROUPING
  7692           GO TO 0199-ACCT-NOT-FOUND.
  7693
  7694     MOVE 'X'                    TO DATE-RANGE-SW.
  7695
  7696     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7697        MOVE 'X'                 TO DATE-RANGE-SW
  7698        GO TO 0199-ACCT-NOT-FOUND.
  7699
  7700     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7701        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7702
  7703 0180-ACCOUNT-FOUND.
  7704     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7705     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7706     MOVE AM-STATE               TO PB-SV-STATE.
  7707     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7708
  7709     IF AM-CANCEL-FEE  NOT NUMERIC
  7710        MOVE ZEROS TO AM-CANCEL-FEE.
  7711
  7712     IF AM-MAX-MON-BEN NOT NUMERIC
  7713        MOVE ZEROS TO AM-MAX-MON-BEN.
  7714
  7715     IF AM-MAX-TOT-BEN NOT NUMERIC
  7716        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7717
  7718     IF AM-CLP-TOL-PCT NOT NUMERIC
  7719        MOVE +0                  TO AM-CLP-TOL-PCT
  7720     END-IF
  7721     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7722        MOVE +0                  TO AM-SPP-LEASE-COMM
  7723     END-IF
  7724     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7725        MOVE ER-2611             TO   WS-ERROR
  7726        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7727
  7728     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7729        MOVE ER-2621             TO   WS-ERROR
  7730        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7731
  7732     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7733        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7734        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7735        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7736         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7737
  7738     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7739     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7740     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7741     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 143
* EL050.cbl
  7742     IF AM-CLP-TOL-PCT NOT = ZEROS
  7743        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7744     END-IF
  7745     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7746        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7747     END-IF
  7748*    IF PB-COMPANY-ID = 'DCC'
  7749*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7750*                                   WS-ADMIN-FEES
  7751*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7752*          (SUB5 > +10)
  7753*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7754*             AND (AM-A-COM (SUB5) NUMERIC)
  7755*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7756*                + (AM-A-COM (SUB5) * 1000)
  7757*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7758*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7759*                + (AM-A-COM (SUB5) * 1000)
  7760*             END-IF
  7761*             IF AM-COM-TYP (SUB5) = 'N'
  7762*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7763*                + (AM-A-COM (SUB5) * 1000)
  7764*             END-IF
  7765*          END-IF
  7766*       END-PERFORM
  7767*    END-IF
  7768     IF (PB-COMPANY-ID = 'DCC')
  7769        AND (PB-ISSUE)
  7770        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7771        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7772           (SUB5 > +10)
  7773           MOVE +0 TO WS-WK-RATE
  7774           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7775              IF (AM-A-COM (SUB5) NUMERIC)
  7776                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7777                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7778              ELSE
  7779                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7780                 IF PB-ISSUE
  7781                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7782                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7783                 ELSE
  7784                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7785                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7786                 END-IF
  7787                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7788                 MOVE ZEROS             TO WS-SUB1
  7789                                           WS-COMMISSION
  7790                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7791                 MOVE '0530'               TO CTBL-SW
  7792                 MOVE ' '                  TO WS-CTBL-READ-SW
  7793                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7794                 IF FIRST-TIME-THROUGH
  7795                    MOVE 'AA'              TO CTBL-BEN-CODE
  7796                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7797                 END-IF
  7798                 IF CTBL-TABLE-FOUND
  7799                    IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 144
* EL050.cbl
  7800                       COMPUTE WS-COMM-CK-AMT =
  7801                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7802                    ELSE
  7803                       COMPUTE WS-COMM-CK-AMT =
  7804                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7805                    END-IF
  7806                    PERFORM 8800-GET-COMP-RATE
  7807                              THRU 8800-EXIT
  7808                 END-IF
  7809              END-IF
  7810              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7811                + (WS-WK-RATE * 1000)
  7812           END-IF
  7813        END-PERFORM
  7814     END-IF
  7815     IF PB-COMPANY-ID EQUAL 'CRI'
  7816         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7817
  7818     IF PB-COMPANY-ID EQUAL 'NCL'
  7819         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7820     END-IF
  7821
  7822     GO TO 0200-READ-CERT.
  7823
  7824 0199-ACCT-NOT-FOUND.
  7825
  7826     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7827
  7828     IF DATE-RANGE-SW NOT = SPACES
  7829        MOVE ER-2601             TO WS-ERROR
  7830        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7831     ELSE
  7832        MOVE ER-2619             TO WS-ERROR
  7833        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7834
  7835     GO TO 9990-RETURN.
  7836
  7837 0200-READ-CERT.
  7838
  7839     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  7840     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7841     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7842     MOVE PB-SV-STATE            TO CERT-STATE.
  7843     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  7844     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  7845     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  7846
  7847     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  7848
  7849     IF CERT-WAS-NOT-FOUND
  7850        GO TO 0299-CERT-NOT-FOUND.
  7851
  7852     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  7853        MOVE ER-2759             TO WS-ERROR
  7854        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7855        GO TO 0298-UNLOCK-RETURN.
  7856
  7857     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 145
* EL050.cbl
  7858         MOVE ER-2758            TO WS-ERROR
  7859         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7860         GO TO 0298-UNLOCK-RETURN.
  7861
  7862     IF PB-ISSUE
  7863        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  7864           IF CERT-WAS-CREATED-FOR-CLAIM
  7865              NEXT SENTENCE
  7866            ELSE
  7867              MOVE ER-2626       TO WS-ERROR
  7868              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7869              GO TO 0298-UNLOCK-RETURN.
  7870
  7871     IF NOT PB-CANCELLATION
  7872        GO TO 0300-CONTINUE-EDIT.
  7873
  7874     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  7875     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  7876     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  7877     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  7878     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  7879     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  7880
  7881     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  7882     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  7883     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  7884     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  7885     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  7886     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  7887     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  7888     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  7889     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  7890
  7891     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  7892     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  7893     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  7894     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  7895     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  7896     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  7897     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  7898
  7899     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  7900     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  7901
  7902     MOVE CM-CREDIT-INTERFACE-SW-1
  7903                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  7904     MOVE CM-CREDIT-INTERFACE-SW-2
  7905                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  7906
  7907     IF CM-O-B-COVERAGE
  7908         MOVE 'B'                 TO PB-CI-OB-FLAG.
  7909
  7910     IF CM-LIVES NOT NUMERIC
  7911         MOVE ZERO                TO CM-LIVES.
  7912
  7913     IF CM-BILLED NOT NUMERIC
  7914         MOVE ZERO                TO CM-BILLED.
  7915
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 146
* EL050.cbl
  7916     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  7917         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  7918         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  7919         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  7920         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  7921         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  7922         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  7923         MOVE CM-LIVES             TO PB-CI-LIVES
  7924*The next line causes a problem with my change  I dont think it is
  7925*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  7926
  7927     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  7928     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  7929     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  7930     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  7931     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  7932     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  7933
  7934     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  7935     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  7936     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  7937     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  7938
  7939     IF CM-LIFE-COMM-PCT NUMERIC
  7940         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  7941     ELSE
  7942         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  7943
  7944     IF CM-AH-COMM-PCT NUMERIC
  7945         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  7946     ELSE
  7947         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  7948
  7949     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  7950
  7951     IF CM-LOAN-APR       NOT NUMERIC
  7952           MOVE ZERO               TO CM-LOAN-APR.
  7953
  7954     IF CM-PAY-FREQUENCY  NOT NUMERIC
  7955           MOVE ZERO               TO CM-PAY-FREQUENCY.
  7956
  7957     IF CM-LOAN-TERM      NOT NUMERIC
  7958           MOVE ZERO               TO CM-LOAN-TERM.
  7959
  7960     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  7961           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  7962
  7963     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  7964           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  7965
  7966     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  7967     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  7968     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  7969     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  7970     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  7971     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  7972     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  7973     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 147
* EL050.cbl
  7974     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  7975     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  7976     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  7977     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  7978
  7979     IF CM-STATE = CM-SSN-STATE
  7980         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  7981
  7982     IF CM-STATE NOT = CM-MEMB-STATE
  7983         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  7984
  7985     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  7986
  7987     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  7988        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  7989        IF CM-ADDL-CLP NOT NUMERIC
  7990           MOVE +0               TO CM-ADDL-CLP
  7991        END-IF
  7992        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  7993        IF AM-DCC-PRODUCT-CODE = 'DDF'
  7994           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  7995        END-IF
  7996     END-IF
  7997     IF PB-COMPANY-ID = 'DCC'
  7998        MOVE +0                  TO WS-ADMIN-FEES
  7999                                    WS-CSO-ADMIN-FEE
  8000                                    WS-COMM-AND-MFEE
  8001                                    WS-1ST-YR-ALLOW
  8002        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8003           (SUB5 > +10)
  8004           MOVE +0 TO WS-WK-RATE
  8005           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8006              IF (AM-A-COM (SUB5) NUMERIC)
  8007                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8008                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8009              ELSE
  8010                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8011                 IF PB-ISSUE
  8012                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8013                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8014                 ELSE
  8015                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8016                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8017                 END-IF
  8018                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8019                 MOVE ZEROS             TO WS-SUB1
  8020                                           WS-COMMISSION
  8021                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8022                 MOVE '0530'               TO CTBL-SW
  8023                 MOVE ' '                  TO WS-CTBL-READ-SW
  8024                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8025                 IF FIRST-TIME-THROUGH
  8026                    MOVE 'AA'              TO CTBL-BEN-CODE
  8027                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8028                 END-IF
  8029                 IF CTBL-TABLE-FOUND
  8030                    IF PB-ISSUE
  8031                       COMPUTE WS-COMM-CK-AMT =
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 148
* EL050.cbl
  8032                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8033                    ELSE
  8034                       COMPUTE WS-COMM-CK-AMT =
  8035                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8036                    END-IF
  8037                    PERFORM 8800-GET-COMP-RATE
  8038                              THRU 8800-EXIT
  8039                 END-IF
  8040              END-IF
  8041              IF AM-COM-TYP (SUB5) = 'I'
  8042                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8043                   + (WS-WK-RATE * 1000)
  8044              END-IF
  8045              IF AM-COM-TYP (SUB5) = 'N'
  8046                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8047                   + (WS-WK-RATE * 1000)
  8048              END-IF
  8049              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8050                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8051                   + (WS-WK-RATE * 1000)
  8052              END-IF
  8053              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8054                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8055                   + (WS-WK-RATE * 1000)
  8056              END-IF
  8057           END-IF
  8058        END-PERFORM
  8059     END-IF
  8060     GO TO 0300-CONTINUE-EDIT.
  8061
  8062 0298-UNLOCK-RETURN.
  8063      PERFORM 9250-UNLOCK-RETURN
  8064      GO TO 9990-RETURN.
  8065
  8066 0299-CERT-NOT-FOUND.
  8067
  8068     MOVE '1'                     TO CERT-STATUS-SW.
  8069
  8070     IF PB-COMPANY-ID = 'UCL'
  8071         IF WS-ERROR = ER-2799
  8072             GO TO 3000-CONTINUE-EDIT.
  8073
  8074     IF NOT PB-CANCELLATION
  8075         GO TO 0300-CONTINUE-EDIT.
  8076
  8077     MOVE ER-2726                  TO  WS-ERROR.
  8078     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8079     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8080     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8081                                    PB-CI-LF-TERM
  8082                                    PB-C-LF-REM-TERM
  8083                                    PB-CI-AH-TERM
  8084                                    PB-C-AH-REM-TERM
  8085                                    PB-CI-LF-BENEFIT-CD
  8086                                    PB-CI-LF-BENEFIT-AMT
  8087                                    PB-CI-LF-ALT-BENEFIT-AMT
  8088                                    PB-CI-LF-PREMIUM-AMT
  8089                                    PB-CI-LF-ALT-PREMIUM-AMT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 149
* EL050.cbl
  8090                                    PB-CI-AH-BENEFIT-CD
  8091                                    PB-CI-AH-BENEFIT-AMT
  8092                                    PB-CI-AH-PREMIUM-AMT
  8093                                    PB-CI-PAY-FREQUENCY
  8094                                    PB-CI-LOAN-APR
  8095                                    PB-CI-LOAN-TERM
  8096                                    PB-CI-LIFE-COMMISSION
  8097                                    PB-CI-AH-COMMISSION
  8098                                    PB-CI-CURR-SEQ
  8099                                    PB-CI-AH-CANCEL-AMT
  8100                                    PB-CI-LF-CANCEL-AMT
  8101                                    PB-CI-RATE-DEV-PCT-LF
  8102                                    PB-CI-RATE-DEV-PCT-AH
  8103                                    PB-CI-EXTENTION-DAYS
  8104                                    PB-CI-TERM-IN-DAYS
  8105                                    PB-CI-LIVES
  8106                                    PB-CI-LF-CRIT-PER
  8107                                    PB-CI-AH-CRIT-PER
  8108                                    PB-CI-ADDL-CLP
  8109                                    PB-CI-DDF-IU-RATE-UP.
  8110
  8111     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8112                                    PB-CI-AH-SETTLEMENT-DT
  8113                                    PB-CI-DEATH-DT
  8114                                    PB-CI-LF-PRIOR-CANCEL-DT
  8115                                    PB-CI-AH-PRIOR-CANCEL-DT
  8116                                    PB-CI-ENTRY-DT
  8117                                    PB-CI-LF-EXPIRE-DT
  8118                                    PB-CI-AH-EXPIRE-DT
  8119                                    PB-CI-LOAN-1ST-PMT-DT.
  8120
  8121     IF ACCOUNT-MAST-FOUND
  8122        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8123        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8124
  8125     GO TO 3000-CONTINUE-EDIT.
  8126
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 150
* EL050.cbl
  8128
  8129 0300-CONTINUE-EDIT.
  8130
  8131     IF PB-ISSUE
  8132        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8133            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8134
  8135     IF PB-ISSUE
  8136        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8137            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8138
  8139     IF PB-ISSUE
  8140       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8141          (AM-NO-AH-ONLY)
  8142           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8143               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8144                   MOVE ER-2679 TO WS-ERROR
  8145                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8146
  8147     IF PB-ISSUE
  8148        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8149        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8150        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8151     ELSE
  8152        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8153        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8154        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8155
  8156     MOVE 'N'                    TO PLAN-MASTER-SW
  8157                                    PLAN-MASTER-LIFE-SW
  8158                                    FORM-MASTER-SW
  8159                                    WS-APP-CERT-SW.
  8160
  8161     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8162                                    WS-PL-TOL-LF-REFUND
  8163                                    WS-PL-REF-OVS-AMT
  8164                                    WS-PL-TOL-LF-PREM-PCT
  8165                                    WS-PL-TOL-LF-REFUND-PCT
  8166                                    WS-PL-REF-OVS-PCT
  8167                                    WS-PL-TOL-LF-CLAIM.
  8168
  8169     IF PB-COMPANY-ID = 'NCL'
  8170       IF PB-ISSUE
  8171         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8172             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8173             IF FORM-MASTER-FOUND
  8174                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8175
  8176     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8177        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8178
  8179********************** MON CODE **********************
  8180     IF PB-COMPANY-ID = 'MON'
  8181     IF PB-ISSUE
  8182     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8183        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8184             PB-I-LOAN-APR = ZERO)
  8185               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 151
* EL050.cbl
  8186******************************************************
  8187
  8188     IF PB-COMPANY-ID = 'NCL'
  8189       IF PB-ISSUE
  8190           IF FORM-MASTER-FOUND
  8191             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8192                AM-DISMBR-COVERAGE
  8193                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8194                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8195                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8196                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8197                                           PB-I-LIFE-BENEFIT-CD.
  8198
  8199     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8200
  8201     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8202         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8203         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8204         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8205         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8206         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8207           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8208             GO TO 0301-LIFE-BENEFIT-SEARCH
  8209         ELSE
  8210             NEXT SENTENCE
  8211     ELSE
  8212         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8213
  8214     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8215     MOVE '4'                    TO CNTL-REC-TYPE.
  8216     MOVE +0                     TO CNTL-SEQ-NO.
  8217     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8218
  8219     MOVE '1' TO RC-SW-2.
  8220     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8221
  8222     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8223        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8224         GO TO 0305-BENEFIT-NOT-FOUND.
  8225
  8226     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8227
  8228 0301-LIFE-BENEFIT-SEARCH.
  8229
  8230     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8231
  8232     IF NO-BENEFIT-FOUND
  8233        GO TO 0305-BENEFIT-NOT-FOUND.
  8234
  8235     IF WS-BEN-CD = '99'
  8236        GO TO 0305-BENEFIT-NOT-FOUND.
  8237
  8238     IF PB-COMPANY-ID = 'NCL'
  8239         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8240             GO TO 0304-LIFE-BENEFIT-FOUND.
  8241
  8242     MOVE +1                     TO SUB5.
  8243     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 152
* EL050.cbl
  8244
  8245* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8246* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8247     IF PB-COMPANY-ID = 'DMD'
  8248         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8249
  8250 0302-EDIT-ACCT-LF-BENEFITS.
  8251
  8252     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8253        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8254           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8255                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8256           GO TO 03XX-GET-LIFE-ERPLAN.
  8257
  8258     IF SUB5 LESS THAN +20
  8259        ADD +1                   TO SUB5
  8260        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8261
  8262     MOVE +1                     TO SUB5.
  8263
  8264     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8265        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8266
  8267 0303-EDIT-DMD-EXTRA-BENEFITS.
  8268
  8269     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8270        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8271           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8272                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8273           GO TO 03XX-GET-LIFE-ERPLAN.
  8274
  8275     IF SUB5 LESS THAN +30
  8276        ADD +1                   TO SUB5
  8277        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8278
  8279     MOVE +1                     TO SUB5.
  8280
  8281 03XX-EDIT-FOR-NINETY-LF.
  8282
  8283***************************************************************
  8284*                                                             *
  8285*    NINETY BENEFIT PLAN TYPES:                               *
  8286*                                                             *
  8287*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8288*      92 = ALL GROUP REDUCING BENEFITS                       *
  8289*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8290*      94 = ALL GROUP LEVEL BENEFITS                          *
  8291*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8292*           BENEFIT CONTROLS.                                 *
  8293*      99 = ALL BENEFITS                                      *
  8294*                                                             *
  8295***************************************************************
  8296
  8297     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8298                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8299
  8300     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8301       AND
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 153
* EL050.cbl
  8302        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8303        GO TO 03XX-GET-LIFE-ERPLAN.
  8304
  8305     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8306       AND
  8307        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8308        IF CF-REDUCING (SUB3)
  8309           IF (PB-I-INDV-GRP-OVRD = 'I')
  8310              OR
  8311           ((AM-IG = '1') AND
  8312           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8313              OR
  8314           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8315           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8316           (AM-IG NOT = '2'))
  8317              GO TO 03XX-GET-LIFE-ERPLAN.
  8318
  8319     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8320       AND
  8321        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8322        IF CF-REDUCING (SUB3)
  8323           IF (PB-I-INDV-GRP-OVRD = 'G')
  8324              OR
  8325           ((AM-IG = '2') AND
  8326           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8327              OR
  8328           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8329           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8330           (AM-IG NOT = '1'))
  8331              GO TO 03XX-GET-LIFE-ERPLAN.
  8332
  8333     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8334       AND
  8335        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8336        IF CF-LEVEL    (SUB3)
  8337           IF (PB-I-INDV-GRP-OVRD = 'I')
  8338              OR
  8339           ((AM-IG = '1') AND
  8340           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8341              OR
  8342           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8343           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8344            (AM-IG NOT = '2'))
  8345              GO TO 03XX-GET-LIFE-ERPLAN.
  8346
  8347     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8348       AND
  8349        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8350        IF CF-LEVEL    (SUB3)
  8351           IF (PB-I-INDV-GRP-OVRD = 'G')
  8352              OR
  8353           ((AM-IG = '2') AND
  8354           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8355              OR
  8356           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8357           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8358           (AM-IG NOT = '1'))
  8359              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 154
* EL050.cbl
  8360
  8361     IF SUB5 LESS THAN +20
  8362        ADD +1                   TO SUB5
  8363        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8364
  8365     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8366
  8367     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8368        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8369
  8370     MOVE +1                     TO SUB5.
  8371
  8372 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8373
  8374     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8375                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8376
  8377     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8378       AND
  8379        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8380        GO TO 03XX-GET-LIFE-ERPLAN.
  8381
  8382     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8383       AND
  8384        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8385        IF CF-REDUCING (SUB3)
  8386           IF (PB-I-INDV-GRP-OVRD = 'I')
  8387              OR
  8388           ((AM-IG = '1') AND
  8389           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8390              OR
  8391           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8392           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8393           (AM-IG NOT = '2'))
  8394              GO TO 03XX-GET-LIFE-ERPLAN.
  8395
  8396     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8397       AND
  8398        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8399        IF CF-REDUCING (SUB3)
  8400           IF (PB-I-INDV-GRP-OVRD = 'G')
  8401              OR
  8402           ((AM-IG = '2') AND
  8403           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8404              OR
  8405           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8406           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8407           (AM-IG NOT = '1'))
  8408              GO TO 03XX-GET-LIFE-ERPLAN.
  8409
  8410     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8411       AND
  8412        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8413        IF CF-LEVEL    (SUB3)
  8414           IF (PB-I-INDV-GRP-OVRD = 'I')
  8415              OR
  8416           ((AM-IG = '1') AND
  8417           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 155
* EL050.cbl
  8418              OR
  8419           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8420           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8421            (AM-IG NOT = '2'))
  8422              GO TO 03XX-GET-LIFE-ERPLAN.
  8423
  8424     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8425       AND
  8426        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8427        IF CF-LEVEL    (SUB3)
  8428           IF (PB-I-INDV-GRP-OVRD = 'G')
  8429              OR
  8430           ((AM-IG = '2') AND
  8431           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8432              OR
  8433           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8434           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8435           (AM-IG NOT = '1'))
  8436              GO TO 03XX-GET-LIFE-ERPLAN.
  8437
  8438     IF SUB5 LESS THAN +30
  8439        ADD +1                   TO SUB5
  8440        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8441
  8442     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8443
  8444 03XX-EDIT-FOR-NINETY-LF-CONT.
  8445
  8446     MOVE +99                    TO SUB5.
  8447
  8448     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8449        IF PB-ISSUE
  8450           MOVE ER-1924          TO  WS-ERROR
  8451           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8452
  8453     GO TO 0304-LIFE-BENEFIT-FOUND.
  8454
  8455 03XX-GET-LIFE-ERPLAN.
  8456
  8457     IF WK-PLAN-ADDR EQUAL +0
  8458        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8459
  8460     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8461     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8462     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8463     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8464     MOVE 'Y'                    TO PLAN-MASTER-SW
  8465                                    PLAN-MASTER-LIFE-SW.
  8466     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8467
  8468 03XX-ERPLAN-LIFE-GETMAIN.
  8469
  8470     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8471     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8472
  8473 03XX-ERPLAN-LIFE-READ.
  8474
  8475     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 156
* EL050.cbl
  8476     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8477     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8478     MOVE PB-SV-STATE            TO PLAN-STATE.
  8479     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8480     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8481     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8482     MOVE WS-SAVE-BENEFIT-REVISION
  8483                                 TO PLAN-REVISION-NO.
  8484
  8485     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8486     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8487
  8488     IF PB-COMPANY-ID = 'NCL'
  8489       IF NOT LF-PLAN-MASTER-FOUND
  8490         IF NOT PB-POLICY-IS-DECLINED  AND
  8491            NOT PB-POLICY-IS-VOIDED
  8492             MOVE  ER-1921         TO  WS-ERROR
  8493             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8494             GO TO 0304-LIFE-BENEFIT-FOUND.
  8495
  8496     IF NOT LF-PLAN-MASTER-FOUND
  8497        GO TO 0304-LIFE-BENEFIT-FOUND.
  8498
  8499 XXXX-CHECK-LF-PLAN-KEY.
  8500
  8501     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8502        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8503        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8504        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8505        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8506        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8507        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8508        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8509        MOVE 'N'                 TO PLAN-MASTER-SW
  8510          GO TO 03XX-ERPLAN-LIFE-READ.
  8511
  8512     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8513
  8514     IF  PB-CANCELLATION
  8515         GO TO  0303-LF-ACCT-BEN-FOUND.
  8516
  8517     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8518        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8519           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8520           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8521              MOVE ER-2644             TO WS-ERROR
  8522              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8523           ELSE
  8524              NEXT SENTENCE
  8525        ELSE
  8526           IF PB-COMPANY-ID NOT = 'NCL'
  8527              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8528                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8529
  8530 0303-LF-ACCT-BEN-FOUND.
  8531
  8532     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8533
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 157
* EL050.cbl
  8534     IF PL-DEV-CODE NOT = SPACES
  8535        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8536
  8537     IF PL-DEV-PCT NUMERIC AND
  8538        PL-DEV-PCT NOT = ZEROS
  8539        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8540
  8541     IF PL-TOL-PREM-AMT GREATER THAN +0
  8542        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8543
  8544     IF PL-TOL-REF-AMT GREATER THAN +0
  8545        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8546
  8547     IF PL-TOL-PREM-PCT GREATER THAN +0
  8548        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8549
  8550     IF PL-TOL-REF-PCT GREATER THAN +0
  8551        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8552
  8553     IF PL-TOL-CLM-AMT GREATER THAN +0
  8554        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8555
  8556     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8557                          PL-OVER-SHORT-AMT > +0
  8558        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8559
  8560     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8561                          PL-OVER-SHORT-PCT > +0
  8562        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8563
  8564     IF PL-SALES-TAX NUMERIC AND
  8565                          PL-SALES-TAX > +0
  8566         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8567
  8568     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8569        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8570                                    WS-IG-OVRD-AM.
  8571
  8572 0304-LIFE-BENEFIT-FOUND.
  8573
  8574     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8575
  8576     IF PB-ISSUE
  8577        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8578     ELSE
  8579        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8580
  8581     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8582     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8583     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8584     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8585     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8586                                         WS-LF-REFUND-CALC.
  8587
  8588     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8589        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8590
  8591     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 158
* EL050.cbl
  8592        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8593     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8594
  8595     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8596     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8597     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8598     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8599     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8600     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8601
  8602     IF PB-COMPANY-ID = 'NCL'  AND
  8603        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8604         NEXT SENTENCE
  8605     ELSE
  8606         IF SUB5 NOT GREATER THAN +20
  8607            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8608               MOVE WS-SAVE-BENEFIT-REM-TERM
  8609                                      TO WS-AM-LF-BENE-REM-TERM
  8610                                         EC-BR-LF-REM-TERM-CALC.
  8611
  8612     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8613     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8614
  8615     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8616
  8617 0305-BENEFIT-NOT-FOUND.
  8618
  8619     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8620     MOVE ER-2604                TO WS-ERROR.
  8621     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8622
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 159
* EL050.cbl
  8624
  8625 0310-FIND-AH-BENEFIT-RECORD.
  8626
  8627     MOVE 'N'                    TO PLAN-MASTER-SW
  8628                                    PLAN-MASTER-AH-SW.
  8629
  8630     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8631                                    WS-PL-TOL-AH-REFUND
  8632                                    WS-AH-PL-REF-OVS-AMT
  8633                                    WS-PL-TOL-AH-PREM-PCT
  8634                                    WS-PL-TOL-AH-REFUND-PCT
  8635                                    WS-AH-PL-REF-OVS-PCT
  8636                                    WS-PL-TOL-AH-CLAIM.
  8637
  8638
  8639     IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8640        MOVE SPACES              TO PB-I-AH-INPUT-CD.
  8641
  8642     IF PB-I-AH-INPUT-CD NOT EQUAL SPACES AND
  8643       (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8644          GO TO 0399-BENEFIT-NOT-FOUND.
  8645
  8646     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8647        GO TO 0400-FIND-CARRIER.
  8648
  8649     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8650
  8651     IF WK-AH-BEN-ADDR NOT = ZEROS
  8652         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8653         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8654         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8655         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8656           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8657             GO TO 0311-AH-BENEFIT-SEARCH
  8658         ELSE
  8659             NEXT SENTENCE
  8660     ELSE
  8661         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8662
  8663     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8664     MOVE '5'                    TO CNTL-REC-TYPE.
  8665     MOVE +0                     TO CNTL-SEQ-NO.
  8666     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8667
  8668     MOVE '2' TO RC-SW-2.
  8669     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8670
  8671     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8672        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8673          GO TO 0399-BENEFIT-NOT-FOUND.
  8674
  8675     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8676
  8677 0311-AH-BENEFIT-SEARCH.
  8678
  8679     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8680
  8681     IF NO-BENEFIT-FOUND
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 160
* EL050.cbl
  8682         GO TO 0399-BENEFIT-NOT-FOUND.
  8683
  8684     IF WS-BEN-CD = '99'
  8685        GO TO 0399-BENEFIT-NOT-FOUND.
  8686
  8687     IF PB-COMPANY-ID  =  'NCL'
  8688         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8689             GO TO 0314-A-H-BENEFIT-FOUND.
  8690
  8691     MOVE +1                     TO SUB5.
  8692     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8693
  8694* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8695* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8696     IF PB-COMPANY-ID = 'DMD'
  8697         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8698
  8699 0312-EDIT-ACCT-AH-BENEFITS.
  8700
  8701     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8702        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8703           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8704                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8705           GO TO 03XX-GET-AH-ERPLAN.
  8706
  8707     IF SUB5 LESS THAN +20
  8708        ADD +1                   TO SUB5
  8709        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8710
  8711     MOVE +1                     TO SUB5.
  8712
  8713     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8714        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8715
  8716 0313-EDIT-DMD-EXTRA-BENEFITS.
  8717
  8718     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8719        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8720           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8721                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8722           GO TO 03XX-GET-AH-ERPLAN.
  8723
  8724     IF SUB5 LESS THAN +30
  8725        ADD +1                   TO SUB5
  8726        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8727
  8728     MOVE +1                     TO SUB5.
  8729
  8730 03XX-EDIT-FOR-NINETY-AH.
  8731
  8732***************************************************************
  8733*                                                             *
  8734*    NINETY BENEFIT PLAN TYPES:                               *
  8735*                                                             *
  8736*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8737*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8738*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8739*           BENEFIT CONTROLS.                                 *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 161
* EL050.cbl
  8740*      99 = ALL BENEFITS.                                     *
  8741*                                                             *
  8742***************************************************************
  8743
  8744     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8745                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8746
  8747     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8748       AND
  8749        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8750        GO TO 03XX-GET-AH-ERPLAN.
  8751
  8752     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8753       AND
  8754        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8755           IF (PB-I-INDV-GRP-OVRD = 'I')
  8756              OR
  8757           ((AM-IG = '1') AND
  8758           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8759              OR
  8760           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8761           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8762           (AM-IG NOT = '2'))
  8763              GO TO 03XX-GET-AH-ERPLAN.
  8764
  8765     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8766       AND
  8767        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8768           IF (PB-I-INDV-GRP-OVRD = 'G')
  8769              OR
  8770           ((AM-IG = '2') AND
  8771           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8772              OR
  8773           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8774           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8775           (AM-IG NOT = '1'))
  8776              GO TO 03XX-GET-AH-ERPLAN.
  8777
  8778     IF SUB5 LESS THAN +20
  8779        ADD +1                   TO SUB5
  8780        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8781
  8782     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8783        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8784
  8785     MOVE +1                    TO SUB5.
  8786
  8787 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8788
  8789     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8790                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8791
  8792     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8793       AND
  8794        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8795        GO TO 03XX-GET-AH-ERPLAN.
  8796
  8797     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 162
* EL050.cbl
  8798       AND
  8799        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8800           IF (PB-I-INDV-GRP-OVRD = 'I')
  8801              OR
  8802           ((AM-IG = '1') AND
  8803           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8804              OR
  8805           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8806           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8807           (AM-IG NOT = '2'))
  8808              GO TO 03XX-GET-AH-ERPLAN.
  8809
  8810     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8811       AND
  8812        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8813           IF (PB-I-INDV-GRP-OVRD = 'G')
  8814              OR
  8815           ((AM-IG = '2') AND
  8816           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8817              OR
  8818           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8819           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8820           (AM-IG NOT = '1'))
  8821              GO TO 03XX-GET-AH-ERPLAN.
  8822
  8823     IF SUB5 LESS THAN +30
  8824        ADD +1                   TO SUB5
  8825        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8826
  8827 03XX-EDIT-FOR-NINETY-AH-CONT.
  8828
  8829     MOVE +99                    TO SUB5.
  8830
  8831     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8832
  8833     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8834        IF PB-ISSUE
  8835           MOVE ER-1925          TO  WS-ERROR
  8836           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8837
  8838     GO TO 0314-A-H-BENEFIT-FOUND.
  8839
  8840 03XX-GET-AH-ERPLAN.
  8841
  8842     IF WK-PLAN-ADDR EQUAL +0
  8843         GO TO 03XX-ERPLAN-AH-GETMAIN.
  8844
  8845     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8846     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8847     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8848     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  8849     MOVE 'Y'                    TO PLAN-MASTER-SW
  8850                                    PLAN-MASTER-AH-SW.
  8851*****GO TO XXXX-CHECK-AH-PLAN-KEY.
  8852     GO TO 03XX-ERPLAN-AH-READ.
  8853
  8854 03XX-ERPLAN-AH-GETMAIN.
  8855
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 163
* EL050.cbl
  8856     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8857     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8858
  8859 03XX-ERPLAN-AH-READ.
  8860
  8861     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8862     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8863     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8864     MOVE PB-SV-STATE            TO PLAN-STATE.
  8865     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8866     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  8867     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8868     MOVE WS-SAVE-BENEFIT-REVISION
  8869                                 TO PLAN-REVISION-NO.
  8870
  8871     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8872     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  8873
  8874     IF PB-COMPANY-ID = 'NCL'
  8875       IF NOT AH-PLAN-MASTER-FOUND
  8876         IF NOT PB-POLICY-IS-DECLINED  AND
  8877            NOT PB-POLICY-IS-VOIDED
  8878             MOVE  ER-1922         TO  WS-ERROR
  8879             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8880             GO TO 0314-A-H-BENEFIT-FOUND.
  8881
  8882     IF NOT AH-PLAN-MASTER-FOUND
  8883        GO TO 0314-A-H-BENEFIT-FOUND.
  8884
  8885 XXXX-CHECK-AH-PLAN-KEY.
  8886
  8887     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8888        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8889        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8890        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8891        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8892        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8893        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8894        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8895        MOVE 'N'                 TO PLAN-MASTER-SW
  8896          GO TO 03XX-ERPLAN-AH-READ.
  8897
  8898     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  8899
  8900     IF  PB-CANCELLATION
  8901         GO TO  0313-AH-ACCT-BEN-FOUND.
  8902
  8903     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8904       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8905          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8906          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8907             MOVE ER-2644             TO WS-ERROR
  8908             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8909          ELSE
  8910             NEXT SENTENCE
  8911       ELSE
  8912          IF PB-COMPANY-ID NOT = 'NCL'
  8913             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 164
* EL050.cbl
  8914                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8915
  8916 0313-AH-ACCT-BEN-FOUND.
  8917
  8918     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  8919
  8920     IF PL-DEV-CODE NOT = SPACES
  8921        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  8922
  8923     IF PL-DEV-PCT NUMERIC AND
  8924        PL-DEV-PCT NOT = ZEROS
  8925        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  8926
  8927     IF PL-TOL-PREM-AMT NOT EQUAL +0
  8928        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  8929
  8930     IF PL-TOL-REF-AMT NOT EQUAL +0
  8931        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  8932
  8933     IF PL-TOL-PREM-PCT GREATER THAN +0
  8934        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  8935
  8936     IF PL-TOL-REF-PCT GREATER THAN +0
  8937        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  8938
  8939     IF PL-TOL-CLM-AMT NOT EQUAL +0
  8940        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  8941
  8942     IF PL-OVER-SHORT-AMT NUMERIC AND
  8943                          PL-OVER-SHORT-AMT > +0
  8944        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  8945
  8946     IF PL-OVER-SHORT-PCT NUMERIC AND
  8947                          PL-OVER-SHORT-PCT > +0
  8948        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  8949
  8950     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8951        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  8952        IF WS-IG-OVRD-AM EQUAL SPACES
  8953            MOVE PL-IG           TO WS-IG-OVRD-AM.
  8954
  8955 0314-A-H-BENEFIT-FOUND.
  8956
  8957     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  8958
  8959     IF PB-ISSUE
  8960        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  8961       ELSE
  8962        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  8963
  8964     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  8965     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  8966     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  8967     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  8968                                         WS-AH-REFUND-CALC.
  8969
  8970     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8971        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 165
* EL050.cbl
  8972
  8973     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8974        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  8975     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  8976
  8977     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  8978     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  8979     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  8980     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  8981     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  8982     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  8983
  8984     IF PB-COMPANY-ID = 'NCL'  AND
  8985        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8986         NEXT SENTENCE
  8987     ELSE
  8988         IF SUB5 NOT GREATER THAN +20
  8989            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  8990                MOVE WS-SAVE-BENEFIT-REM-TERM
  8991                                      TO WS-AM-AH-BENE-REM-TERM
  8992                                         EC-BR-AH-REM-TERM-CALC.
  8993
  8994     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  8995     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  8996
  8997     GO TO 0400-FIND-CARRIER.
  8998
  8999 0399-BENEFIT-NOT-FOUND.
  9000
  9001     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9002     MOVE ER-2605                TO WS-ERROR.
  9003     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9004
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 166
* EL050.cbl
  9006
  9007 0400-FIND-CARRIER.
  9008
  9009     MOVE PB-SV-CARRIER          TO WS-CARR.
  9010
  9011     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9012     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9013     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9014     MOVE '6'                    TO CNTL-REC-TYPE.
  9015
  9016*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9017     MOVE SPACE                  TO WS-DMD-RATING-SW
  9018                                    EC-BR-DMD-RATING-SW.
  9019
  9020     MOVE '2'                    TO RC-SW-1.
  9021     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9022
  9023     IF NOT CF-CARRIER-MASTER
  9024        GO TO 0400-CARRIER-NOT-FOUND.
  9025
  9026 0400-BUILD-CARR-TOL.
  9027
  9028     IF CF-CR-TOL-PREM NUMERIC AND
  9029        CF-CR-TOL-PREM GREATER THAN +0
  9030        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9031                                    WS-TOL-AH-PREM.
  9032
  9033     IF CF-CR-TOL-REFUND NUMERIC AND
  9034        CF-CR-TOL-REFUND GREATER THAN +0
  9035        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9036                                    WS-TOL-AH-REFUND.
  9037
  9038     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9039        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9040        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9041                                    WS-AH-REFUND-OVS-AMT.
  9042
  9043     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9044        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9045        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9046                                    WS-AH-REFUND-OVS-PCT.
  9047
  9048     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9049        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9050        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9051                                    WS-TOL-AH-PREM-PCT.
  9052
  9053     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9054        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9055        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9056                                     WS-TOL-AH-REFUND-PCT.
  9057
  9058     IF CF-COMPANY-ID EQUAL 'DMD'
  9059         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9060                                    EC-BR-DMD-RATING-SW.
  9061
  9062     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9063     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 167
* EL050.cbl
  9064        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9065     END-IF
  9066     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9067        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9068     END-IF
  9069     IF WS-TOL-CLP-PCT = ZEROS
  9070        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9071     END-IF
  9072
  9073     IF WS-SPP-LEASE-COMM = ZEROS
  9074        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9075     END-IF
  9076     GO TO 0400-FIND-ERCOMP.
  9077
  9078 0400-CARRIER-NOT-FOUND.
  9079
  9080     MOVE ER-2602                TO WS-ERROR.
  9081     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9082
  9083 0400-FIND-ERCOMP.
  9084     IF PB-COMPANY-ID = 'DCC'
  9085        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9086           (WS-SUB1 > +10)
  9087           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9088                 OR 'A' OR 'N'
  9089              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9090              MOVE PB-CARRIER    TO COMP-CARRIER
  9091              MOVE PB-GROUPING   TO COMP-GROUPING
  9092              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9093              MOVE AM-AGT (WS-SUB1)
  9094                                 TO COMP-FIN-RESP
  9095              MOVE 'G'           TO COMP-TYPE
  9096              PERFORM 8582-READ-COMPENSATION-MASTER
  9097                                 THRU 8582-EXIT
  9098              IF COMP-MASTER-FOUND
  9099                 IF CO-GA-INACTIVE
  9100                    MOVE ER-2763 TO WS-ERROR
  9101                    PERFORM 9900-ERROR-FORMAT
  9102                                 THRU 9900-EXIT
  9103                    MOVE +11     TO WS-SUB1
  9104                 END-IF
  9105                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9106                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9107                    MOVE ER-2788 TO WS-ERROR
  9108                    PERFORM 9900-ERROR-FORMAT
  9109                                 THRU 9900-EXIT
  9110                    MOVE +11     TO WS-SUB1
  9111                 END-IF
  9112              END-IF
  9113           END-IF
  9114        END-PERFORM
  9115     END-IF
  9116     IF (PB-COMPANY-ID = 'DCC')
  9117               AND
  9118        ((WS-LF-BEN-CATEGORY = 'D')
  9119        OR (WS-AH-BEN-CATEGORY = 'D')
  9120        OR (AM-DCC-PRODUCT-CODE = 'DDF'))
  9121        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 168
* EL050.cbl
  9122           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9123                                    WS-CLP-STATE
  9124        ELSE
  9125           MOVE SPACES           TO PB-I-CLP-STATE
  9126                                    WS-CLP-STATE
  9127        END-IF
  9128     END-IF
  9129
  9130     IF (PB-COMPANY-ID = 'DCC')
  9131        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9132        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9133        CONTINUE
  9134     ELSE
  9135        GO TO 0400-FIND-STATE-RECORD
  9136     END-IF
  9137     MOVE SPACES                 TO WS-CLP-STATE
  9138     MOVE +0                     TO WS-BANK-FEE
  9139                                    WS-BANK-LFEE
  9140                                    WS-BANK-NOCHRGB
  9141
  9142     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9143     IF (PB-ISSUE)
  9144        AND (PB-I-BANK-NUMBER NOT =
  9145            SPACES AND ZEROS AND LOW-VALUES)
  9146        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9147     ELSE
  9148        IF (PB-CANCELLATION)
  9149           AND (PB-CI-BANK-NUMBER NOT =
  9150                SPACES AND ZEROS AND LOW-VALUES)
  9151           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9152        END-IF
  9153     END-IF
  9154     IF COMP-FIN-RESP NOT = LOW-VALUES
  9155        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9156        MOVE PB-CARRIER          TO COMP-CARRIER
  9157        MOVE PB-GROUPING         TO COMP-GROUPING
  9158        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9159        MOVE 'B'                 TO COMP-TYPE
  9160        PERFORM 8582-READ-COMPENSATION-MASTER
  9161                                 THRU 8582-EXIT
  9162        IF COMP-MASTER-FOUND
  9163           IF CO-MAX-BANK-FEE NOT NUMERIC
  9164              MOVE +0            TO CO-MAX-BANK-FEE
  9165           END-IF
  9166           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9167              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9168           END-IF
  9169           IF CO-GA-INACTIVE
  9170              MOVE ER-2763       TO WS-ERROR
  9171              PERFORM 9900-ERROR-FORMAT
  9172                                 THRU 9900-EXIT
  9173           END-IF
  9174           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9175              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9176              MOVE ER-2788 TO WS-ERROR
  9177              PERFORM 9900-ERROR-FORMAT
  9178                                 THRU 9900-EXIT
  9179              MOVE +11     TO WS-SUB1
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 169
* EL050.cbl
  9180           END-IF
  9181           IF WS-AH-BEN-CATEGORY = 'G'
  9182              MOVE CO-MAX-BANK-FEE
  9183                                 TO WS-BANK-FEE
  9184                                    PB-I-BANK-FEE
  9185           ELSE
  9186              MOVE CO-MAX-BANK-FEE-LEASE
  9187                                 TO WS-BANK-LFEE
  9188                                    PB-I-BANK-FEE
  9189           END-IF
  9190           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9191              AND (WS-AH-REFUND-CALC = 'G'))
  9192                        OR
  9193              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9194              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9195              CONTINUE
  9196           ELSE
  9197              MOVE ER-2789 TO WS-ERROR
  9198              PERFORM 9900-ERROR-FORMAT
  9199                                 THRU 9900-EXIT
  9200           END-IF
  9201           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9202                                    PB-I-CLP-STATE
  9203           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9204           MOVE CO-CARRIER       TO BXRF-CARRIER
  9205           MOVE CO-GROUPING      TO BXRF-GROUPING
  9206           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9207           MOVE BXRF-MAX-REC-LENGTH
  9208                                 TO BXRF-REC-LENGTH
  9209           PERFORM 8584-READ-BANK-CROSS-REF
  9210                                 THRU 8584-EXIT
  9211           IF BXRF-MASTER-FOUND
  9212              MOVE ' '           TO BANK-ACCT-SW
  9213              MOVE BK-BANK-POINTER-CNT
  9214                                 TO BK-BANK-POINTER-CNT
  9215              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9216                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9217                 OR (BANK-ACCT-FOUND)
  9218                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9219                    AND (BK-AM-EXP-DT (WS-SUB1)
  9220                                 > PB-CERT-EFF-DT)
  9221                    AND (BK-AM-EFF-DT (WS-SUB1)
  9222                                 NOT > PB-CERT-EFF-DT)
  9223                    SET BANK-ACCT-FOUND TO TRUE
  9224                 END-IF
  9225              END-PERFORM
  9226              IF NOT BANK-ACCT-FOUND
  9227                 MOVE ZEROS      TO WS-BANK-FEE
  9228                                    WS-BANK-LFEE
  9229                 MOVE ER-2869    TO WS-ERROR
  9230                 PERFORM 9900-ERROR-FORMAT
  9231                                 THRU 9900-EXIT
  9232              ELSE
  9233                 PERFORM 5000-PROCESS-REPS
  9234                                 THRU 5000-EXIT
  9235                 IF AGENT-MASTER-FOUND
  9236                    MOVE +0      TO WS-BANK-FEE
  9237                                    WS-BANK-LFEE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 170
* EL050.cbl
  9238*                   MOVE AG-SPP-FEES (1)
  9239*                                TO PB-I-BANK-FEE
  9240*                                   WS-BANK-FEE
  9241                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9242                       (WS-SUB1 > +10)
  9243                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9244                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9245                       END-IF
  9246                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9247                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9248                       END-IF
  9249                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9250                          AG-SPP-FEES (WS-SUB1)
  9251                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9252                          AG-SPP-LFEES (WS-SUB1)
  9253                    END-PERFORM
  9254                    IF WS-AH-BEN-CATEGORY = 'G'
  9255                       MOVE WS-BANK-FEE
  9256                                 TO PB-I-BANK-FEE
  9257                    ELSE
  9258                       MOVE WS-BANK-LFEE
  9259                                 TO PB-I-BANK-FEE
  9260                    END-IF
  9261                 END-IF
  9262              END-IF
  9263           END-IF
  9264        ELSE
  9265           MOVE ER-2879          TO WS-ERROR
  9266           PERFORM 9900-ERROR-FORMAT
  9267                                 THRU 9900-EXIT
  9268        END-IF
  9269     ELSE
  9270        MOVE ER-2879             TO WS-ERROR
  9271        PERFORM 9900-ERROR-FORMAT
  9272                                 THRU 9900-EXIT
  9273     END-IF
  9274     IF WS-AH-BEN-CATEGORY = 'G'
  9275        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9276        + WS-BANK-FEE
  9277     ELSE
  9278        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9279        + WS-BANK-LFEE
  9280     END-IF
  9281     .
  9282 0400-FIND-STATE-RECORD.
  9283
  9284     IF WK-STATE-ADDR NOT = ZEROS
  9285         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9286         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9287         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9288         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9289         IF PB-SV-STATE = CF-STATE-CODE
  9290             GO TO 0405-CONTINUE-EDIT
  9291         ELSE
  9292             NEXT SENTENCE
  9293     ELSE
  9294         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9295
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 171
* EL050.cbl
  9296     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9297     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9298     MOVE '3'                    TO CNTL-REC-TYPE.
  9299     MOVE +0                     TO CNTL-SEQ-NO.
  9300
  9301     MOVE '3'                    TO RC-SW-2.
  9302     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9303
  9304     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9305        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9306        PB-SV-STATE   NOT = CF-STATE-CODE)
  9307        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9308                                    WS-TOL-AH-CLAIM
  9309                                    WS-MINIMUM-REFUND
  9310                                    WS-TOL-LF-PREM
  9311                                    WS-TOL-AH-PREM
  9312                                    WS-TOL-LF-REFUND
  9313                                    WS-TOL-AH-REFUND
  9314                                    EC-ST-TOL-PREM-PCT
  9315                                    WS-TOL-LF-PREM-PCT
  9316                                    WS-TOL-AH-PREM-PCT
  9317                                    EC-ST-TOL-REFUND-PCT
  9318                                    WS-TOL-LF-REFUND-PCT
  9319                                    WS-TOL-AH-REFUND-PCT
  9320                                    EC-ST-TOL-PREM
  9321                                    EC-ST-TOL-REFUND
  9322                                    EC-ST-FST-PMT-DAYS-MAX
  9323                                    WS-FREE-LOOK-PERIOD
  9324                                    WS-ST-LF-PREM-TAX
  9325                                    WS-ST-AH-PREM-TAX-I
  9326                                    WS-ST-AH-PREM-TAX-G
  9327                                    WS-BANK-FEE
  9328                                    WS-BANK-LFEE
  9329                                    WS-TOL-CLP-PCT
  9330                                    WS-SPP-LEASE-COMM
  9331        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9332                                    EC-ST-FST-PMT-DAYS-CHG
  9333                                    WS-LF-REM-TERM-CALC
  9334                                    WS-LF-REFUND-CALC
  9335                                    EC-ST-LF-REM-TERM-CALC
  9336                                    EC-ST-LF-REFUND-CALC
  9337                                    WS-AH-REM-TERM-CALC
  9338                                    WS-AH-REFUND-CALC
  9339                                    WS-LF-BEN-CATEGORY
  9340                                    WS-AH-BEN-CATEGORY
  9341                                    WS-CLP-STATE
  9342                                    WS-ST-REFUND-CLAIM-FLAG
  9343                                    EC-ST-AH-REM-TERM-CALC
  9344                                    EC-ST-AH-REFUND-CALC
  9345          GO TO 0499-STATE-NOT-FOUND.
  9346
  9347     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9348
  9349 0405-CONTINUE-EDIT.
  9350
  9351     IF PB-CERT-PRIME NOT NUMERIC
  9352        MOVE ER-2722             TO WS-ERROR
  9353        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 172
* EL050.cbl
  9354                                 THRU 9900-EXIT
  9355     END-IF
  9356*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9357*       MOVE +0                  TO SUB3
  9358*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9359*       IF SUB3 > +0
  9360*          MOVE ER-2722          TO WS-ERROR
  9361*          PERFORM 9900-ERROR-FORMAT
  9362*                                THRU 9900-EXIT
  9363*       END-IF
  9364*    END-IF
  9365*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9366*       IF PB-CERT-PRIME NOT NUMERIC
  9367*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9368*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9369*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9370*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9371*
  9372*          MOVE ER-2722          TO WS-ERROR
  9373*          PERFORM 9900-ERROR-FORMAT
  9374*                                THRU 9900-EXIT
  9375*       END-IF
  9376*    END-IF
  9377
  9378     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9379
  9380     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9381        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9382                                    WS-TOL-AH-CLAIM.
  9383
  9384     IF CF-ST-REFUND-MIN NOT NUMERIC
  9385        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9386
  9387     IF CF-ST-REFUND-MIN NOT = ZEROS
  9388        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9389
  9390     IF CF-ST-TOL-PREM  NOT = ZEROS
  9391        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9392                                    WS-TOL-AH-PREM
  9393        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9394
  9395     IF CF-ST-TOL-REFUND NOT = ZEROS
  9396        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9397                                    WS-TOL-AH-REFUND
  9398        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9399
  9400     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9401        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9402        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9403                                    WS-AH-REFUND-OVS-AMT
  9404                                    EC-ST-OVR-SHT-AMT.
  9405
  9406     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9407        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9408        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9409                                    WS-TOL-LF-PREM-PCT
  9410                                    WS-TOL-AH-PREM-PCT.
  9411
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 173
* EL050.cbl
  9412     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9413        CF-ST-TOL-REF-PCT GREATER THAN +0
  9414        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9415                                    WS-TOL-LF-REFUND-PCT
  9416                                    WS-TOL-AH-REFUND-PCT.
  9417
  9418     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9419        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9420        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9421                                    WS-AH-REFUND-OVS-PCT
  9422                                    EC-ST-OVR-SHT-PCT.
  9423
  9424     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9425     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9426
  9427     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9428          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9429
  9430     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9431     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9432     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9433
  9434     IF CF-ST-LF-PREM-TAX NUMERIC
  9435        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9436     END-IF
  9437     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9438        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9439     END-IF
  9440     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9441        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9442     END-IF
  9443
  9444     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9445         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9446     END-IF.
  9447
  9448     IF WS-LF-BENEFIT-CD = ZEROS
  9449        GO TO 0410-CHECK-AH.
  9450
  9451     IF CF-ST-RT-CALC NOT = SPACES
  9452        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9453                                    EC-ST-LF-REM-TERM-CALC
  9454     END-IF
  9455
  9456     IF WS-LF-COVERAGE-TYPE = 'R'
  9457        IF WS-LF-EARNINGS-CALC = '5'
  9458           IF CF-ST-RF-LN-CALC > '0'
  9459              MOVE CF-ST-RF-LN-CALC
  9460                                 TO WS-LF-REFUND-CALC
  9461                                    EC-ST-LF-REFUND-CALC
  9462           END-IF
  9463        ELSE
  9464           IF CF-ST-RF-LR-CALC > '0'
  9465              MOVE CF-ST-RF-LR-CALC
  9466                                 TO WS-LF-REFUND-CALC
  9467                                    EC-ST-LF-REFUND-CALC
  9468           END-IF
  9469        END-IF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 174
* EL050.cbl
  9470     ELSE
  9471        IF CF-ST-RF-LL-CALC > '0'
  9472           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9473                                    EC-ST-LF-REFUND-CALC
  9474        END-IF
  9475     END-IF
  9476
  9477     IF CF-ST-RT-CALC NOT = SPACES
  9478        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9479                                    EC-ST-LF-REM-TERM-CALC
  9480     END-IF
  9481
  9482     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9483     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9484
  9485     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9486
  9487     IF NO-BENEFIT-FOUND
  9488        GO TO 0410-CHECK-AH.
  9489
  9490     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9491        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9492                                 TO EC-ST-LF-REM-TERM-CALC
  9493                                    WS-LF-REM-TERM-CALC
  9494     END-IF
  9495
  9496     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9497        MOVE CF-ST-REFUND-CALC (SUB3)
  9498                                 TO WS-LF-REFUND-CALC
  9499                                    EC-ST-LF-REFUND-CALC
  9500     END-IF
  9501*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9502
  9503     .
  9504 0410-CHECK-AH.
  9505
  9506     IF WS-AH-BENEFIT-CD = ZEROS
  9507        GO TO 0500-SET-ACCOUNT.
  9508
  9509     IF CF-ST-RT-CALC NOT = SPACES
  9510        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9511                                    EC-ST-AH-REM-TERM-CALC
  9512     END-IF
  9513
  9514     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9515        IF CF-ST-RF-CP-CALC > '0'
  9516           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9517                                    EC-ST-AH-REFUND-CALC
  9518        END-IF
  9519     ELSE
  9520        IF CF-ST-RF-AH-CALC > '0'
  9521           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9522                                    EC-ST-AH-REFUND-CALC
  9523        END-IF
  9524     END-IF
  9525     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9526     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9527
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 175
* EL050.cbl
  9528     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9529
  9530     IF NO-BENEFIT-FOUND
  9531        GO TO 0500-SET-ACCOUNT.
  9532
  9533     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9534        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9535                                 TO WS-AH-REM-TERM-CALC
  9536                                    EC-ST-AH-REM-TERM-CALC
  9537     END-IF
  9538
  9539     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9540        MOVE CF-ST-REFUND-CALC (SUB3)
  9541                                 TO WS-AH-REFUND-CALC
  9542                                    EC-ST-AH-REFUND-CALC
  9543     END-IF
  9544
  9545*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9546
  9547     GO TO 0500-SET-ACCOUNT.
  9548
  9549 0499-STATE-NOT-FOUND.
  9550
  9551     MOVE ER-2603                TO WS-ERROR.
  9552     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9553
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 176
* EL050.cbl
  9555
  9556 0500-SET-ACCOUNT.
  9557*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9558     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9559        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9560        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9561        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9562        MOVE '3'                 TO CNTL-REC-TYPE
  9563        MOVE +0                  TO CNTL-SEQ-NO
  9564
  9565        MOVE '3'                 TO RC-SW-2
  9566        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9567
  9568        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9569           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9570           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9571           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9572                                    WS-ST-AH-PREM-TAX-I
  9573                                    WS-ST-AH-PREM-TAX-G
  9574        ELSE
  9575           IF CF-ST-LF-PREM-TAX NUMERIC
  9576              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9577           END-IF
  9578           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9579              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9580           END-IF
  9581           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9582              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9583           END-IF
  9584        END-IF
  9585        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9586     END-IF
  9587*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9588*  FOR DCC ONLY
  9589     IF PB-COMPANY-ID = 'DCC'
  9590
  9591     MOVE ' '                    TO STAT-MASTER-SW
  9592     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9593     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9594     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9595     MOVE PB-STATE               TO ELSTAT-STATE
  9596     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9597        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9598     END-IF
  9599
  9600     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9601     SET BIN-TO-GREG             TO TRUE
  9602     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9603     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9604     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9605
  9606     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9607     IF STAT-MASTER-FOUND
  9608        MOVE 'N'                 TO STAT-MASTER-SW
  9609        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9610        IF STAT-MASTER-FOUND
  9611           IF (ELSTAT-KEY-SAVE (1:12) =
  9612                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 177
* EL050.cbl
  9613              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9614                 MOVE 'F'        TO STAT-MASTER-SW
  9615              ELSE
  9616                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9617                 IF (STAT-MASTER-FOUND)
  9618                    AND (ELSTAT-KEY-SAVE (1:12) =
  9619                        SF-CONTROL-PRIMARY (1:12))
  9620                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9621                    MOVE 'F'     TO STAT-MASTER-SW
  9622                 END-IF
  9623              END-IF
  9624           END-IF
  9625        END-IF
  9626     END-IF
  9627
  9628     IF STAT-MASTER-SW = 'F'
  9629        IF SF-ST-LF-PREM-TAX NUMERIC
  9630           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9631        END-IF
  9632        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9633           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9634        END-IF
  9635        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9636           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9637        END-IF
  9638     END-IF
  9639
  9640     END-IF
  9641     IF (PB-COMPANY-ID = 'DCC')
  9642        AND (PB-ISSUE)
  9643        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9644        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9645        AND (AM-GPCD = 06)
  9646        MOVE 'Y'                 TO WS-GOOD-HIN
  9647        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9648           MOVE PB-I-VIN         TO WS-WORK-VIN
  9649           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9650              (V1 > 16)
  9651              IF WS-WORK-VIN (V1:1) NUMERIC
  9652                 MOVE WS-WORK-VIN-N (V1)
  9653                                 TO WS-ROW-B-VAL (V1)
  9654              ELSE
  9655                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9656                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9657                    OR (V2 > 26)
  9658                 END-PERFORM
  9659                 IF V2 < 27
  9660                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9661                 ELSE
  9662                    MOVE 'N'     TO WS-GOOD-HIN
  9663                 END-IF
  9664              END-IF
  9665              COMPUTE WS-ROW-D-VAL (V1) =
  9666                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9667              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9668                 WS-ROW-D-VAL (V1)
  9669           END-PERFORM
  9670           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 178
* EL050.cbl
  9671           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9672             REMAINDER WS-VIN-REMAINDER
  9673           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9674              CONTINUE
  9675           ELSE
  9676              MOVE 'N'           TO WS-GOOD-HIN
  9677           END-IF
  9678        ELSE
  9679           MOVE 'N'              TO WS-GOOD-HIN
  9680        END-IF
  9681        IF WS-GOOD-HIN NOT = 'Y'
  9682           MOVE ER-3826           TO WS-ERROR
  9683           PERFORM 9900-ERROR-FORMAT
  9684                                 THRU 9900-EXIT
  9685        END-IF
  9686     END-IF
  9687     IF (PB-COMPANY-ID = 'DCC')
  9688        AND (PB-ISSUE)
  9689        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9690        AND (AM-GPCD NOT = 06)
  9691        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9692          MOVE PB-I-VIN          TO WS-WORK-VIN
  9693          MOVE +8                TO V2
  9694          MOVE ZEROS             TO WS-VIN-TOTAL
  9695          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9696           (V1 > 17)
  9697             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9698                MOVE ER-3825     TO WS-ERROR
  9699                PERFORM 9900-ERROR-FORMAT
  9700                                 THRU 9900-EXIT
  9701             ELSE
  9702                IF V1 = 8
  9703                   MOVE 10       TO V2
  9704                END-IF
  9705                IF V1 = 9
  9706                   MOVE 0        TO V2
  9707                END-IF
  9708                IF V1 = 10
  9709                   MOVE 9        TO V2
  9710                END-IF
  9711                IF WS-WORK-VIN (V1:1) NUMERIC
  9712                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9713                    + (WS-WORK-VIN-N (V1) * V2)
  9714                ELSE
  9715                   MOVE WS-WORK-VIN (V1:1)
  9716                                 TO WS-HEX-BYTE
  9717                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9718                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9719                    + (WS-NUM (V3) * V2)
  9720                END-IF
  9721                COMPUTE V2 = V2 - 1
  9722             END-IF
  9723          END-PERFORM
  9724          MOVE ZEROS TO WS-VIN-REMAINDER
  9725          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9726             REMAINDER WS-VIN-REMAINDER
  9727          IF ((WS-WORK-VIN (9:1) = 'X')
  9728             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 179
* EL050.cbl
  9729                     OR
  9730             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9731             CONTINUE
  9732          ELSE
  9733             MOVE ER-3826        TO WS-ERROR
  9734             PERFORM 9900-ERROR-FORMAT
  9735                                 THRU 9900-EXIT
  9736          END-IF
  9737        ELSE
  9738          MOVE ER-3826           TO WS-ERROR
  9739          PERFORM 9900-ERROR-FORMAT
  9740                                 THRU 9900-EXIT
  9741        END-IF
  9742     END-IF
  9743******************************************************************
  9744******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9745******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9746******* METHODS.
  9747******************************************************************
  9748     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9749        IF PB-CANCELLATION
  9750           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9751              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9752                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9753                IF FORM-MASTER-FOUND
  9754                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9755******************************************************************
  9756
  9757     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9758     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9759
  9760     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9761     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9762     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9763     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9764
  9765
  9766     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9767     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9768     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9769
  9770     IF AM-LF-OB-RATE NOT NUMERIC
  9771         MOVE ZERO               TO AM-LF-OB-RATE.
  9772
  9773     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9774         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9775
  9776     IF AM-AH-OB-RATE NOT NUMERIC
  9777         MOVE ZERO               TO AM-AH-OB-RATE.
  9778
  9779     IF WS-LF-JOINT-INDICATOR = 'J'
  9780         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9781     ELSE
  9782         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9783
  9784     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9785
  9786     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 180
* EL050.cbl
  9787         MOVE AM-IG              TO WS-IG-OVRD-AM.
  9788
  9789     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
  9790         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
  9791                                       WS-IG-OVRD
  9792     ELSE
  9793         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
  9794             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
  9795                                       WS-IG-OVRD
  9796         ELSE
  9797             MOVE AM-IG             TO WS-IG-OVRD-AH
  9798                                       WS-IG-OVRD.
  9799
  9800     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
  9801         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
  9802                                       WS-IG-OVRD
  9803     ELSE
  9804         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
  9805             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
  9806                                       WS-IG-OVRD
  9807         ELSE
  9808             MOVE AM-IG             TO WS-IG-OVRD-LF
  9809                                       WS-IG-OVRD.
  9810
  9811     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
  9812     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
  9813     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
  9814     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
  9815     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
  9816
  9817     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
  9818     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
  9819     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
  9820     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
  9821
  9822     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
  9823     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
  9824     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
  9825     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
  9826     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
  9827     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
  9828     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
  9829
  9830     IF WS-ACCT-AH-DEV-PCT > +0
  9831        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
  9832     ELSE
  9833        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
  9834
  9835     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
  9836        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
  9837     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
  9838        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
  9839
  9840        IF AM-EARN-METHOD-L = 'S'
  9841            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9842                                        WS-LF-REFUND-CALC.
  9843
  9844        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 181
* EL050.cbl
  9845            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9846                                        WS-LF-REFUND-CALC.
  9847
  9848     IF WS-LF-COVERAGE-TYPE = 'R'
  9849         IF AM-EARN-METHOD-R = 'R'
  9850            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9851                                    WS-LF-REFUND-CALC.
  9852     IF WS-LF-COVERAGE-TYPE = 'R'
  9853         IF AM-EARN-METHOD-R = 'P'
  9854            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9855                                    WS-LF-REFUND-CALC.
  9856     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9857         IF AM-EARN-METHOD-L = 'R'
  9858            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9859                                    WS-LF-REFUND-CALC.
  9860     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9861         IF AM-EARN-METHOD-L = 'P'
  9862            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9863                                    WS-LF-REFUND-CALC.
  9864     IF WS-LF-COVERAGE-TYPE = 'R'
  9865         IF AM-EARN-METHOD-R = 'A'
  9866            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9867                                    WS-LF-REFUND-CALC.
  9868     IF WS-LF-COVERAGE-TYPE = 'R'
  9869         IF AM-EARN-METHOD-R = 'M'
  9870            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9871                                    WS-LF-REFUND-CALC.
  9872     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9873         IF AM-EARN-METHOD-L = 'A'
  9874            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9875                                    WS-LF-REFUND-CALC.
  9876     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9877         IF AM-EARN-METHOD-L = 'M'
  9878            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9879                                    WS-LF-REFUND-CALC.
  9880
  9881     IF AM-EARN-METHOD-A = 'R'
  9882        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
  9883                                    WS-AH-REFUND-CALC.
  9884     IF AM-EARN-METHOD-A = 'P'
  9885        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
  9886                                    WS-AH-REFUND-CALC.
  9887     IF AM-EARN-METHOD-A = 'C'
  9888        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
  9889                                    WS-AH-REFUND-CALC.
  9890     IF AM-EARN-METHOD-A = 'A'
  9891        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
  9892                                    WS-AH-REFUND-CALC.
  9893     IF AM-EARN-METHOD-A = 'M'
  9894        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
  9895                                    WS-AH-REFUND-CALC.
  9896     IF AM-EARN-METHOD-A = 'N'
  9897        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
  9898                                    WS-AH-REFUND-CALC.
  9899     IF AM-EARN-METHOD-A = 'S'
  9900        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
  9901                                    WS-AH-REFUND-CALC.
  9902
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 182
* EL050.cbl
  9903     IF AM-TOL-PREM NOT = ZEROS
  9904        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
  9905                                    WS-TOL-AH-PREM.
  9906
  9907     IF AM-OVR-SHT-AMT NUMERIC AND
  9908                  AM-OVR-SHT-AMT > 0
  9909        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
  9910                                    EC-AM-LF-OVR-SHT-AMT
  9911                                    WS-AH-REFUND-OVS-AMT
  9912                                    EC-AM-AH-OVR-SHT-AMT.
  9913
  9914     IF AM-OVR-SHT-PCT NUMERIC AND
  9915                    AM-OVR-SHT-PCT > 0
  9916        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
  9917                                    EC-AM-LF-OVR-SHT-PCT
  9918                                    WS-AH-REFUND-OVS-PCT
  9919                                    EC-AM-AH-OVR-SHT-PCT.
  9920
  9921     IF AM-TOL-REF-PCT NUMERIC AND
  9922                  AM-TOL-REF-PCT > 0
  9923        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
  9924                                    WS-TOL-AH-REFUND-PCT.
  9925
  9926     IF AM-TOL-REF  NOT = ZEROS  AND
  9927                  AM-TOL-REF NUMERIC
  9928        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
  9929                                    EC-AM-LF-TOL-REFUND
  9930                                    WS-TOL-AH-REFUND
  9931                                    EC-AM-AH-TOL-REFUND.
  9932
  9933     IF AM-TOL-CLM  NOT = ZEROS
  9934        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
  9935                                    WS-TOL-AH-CLAIM.
  9936
  9937     IF AM-CLP-TOL-PCT NOT NUMERIC
  9938        MOVE +0                  TO AM-CLP-TOL-PCT
  9939     END-IF
  9940
  9941     IF AM-SPP-LEASE-COMM NOT NUMERIC
  9942        MOVE +0                  TO AM-SPP-LEASE-COMM
  9943     END-IF
  9944     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
  9945        MOVE WS-PL-TOL-LF-PREM-PCT
  9946                                 TO WS-TOL-LF-PREM-PCT.
  9947
  9948     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
  9949        MOVE WS-PL-TOL-AH-PREM-PCT
  9950                                 TO WS-TOL-AH-PREM-PCT.
  9951
  9952     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
  9953        MOVE WS-PL-TOL-LF-REFUND-PCT
  9954                                 TO WS-TOL-LF-REFUND-PCT.
  9955
  9956     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
  9957        MOVE WS-PL-TOL-AH-REFUND-PCT
  9958                                 TO WS-TOL-AH-REFUND-PCT.
  9959
  9960     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 183
* EL050.cbl
  9961        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
  9962
  9963     IF WS-PL-REF-OVS-PCT > +0
  9964        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
  9965
  9966     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
  9967        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
  9968     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
  9969        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
  9970     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
  9971        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
  9972     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
  9973        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
  9974     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
  9975        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
  9976     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
  9977        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
  9978
  9979     IF WS-AH-PL-REF-OVS-AMT > +0
  9980        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
  9981
  9982     IF WS-AH-PL-REF-OVS-PCT > +0
  9983        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
  9984
  9985     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
  9986     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
  9987
  9988     IF PB-CANCELLATION
  9989        GO TO 3000-CONTINUE-EDIT.
  9990
  9991     MOVE +1 TO SUB1.
  9992     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
  9993     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
  9994
  9995     IF CF-COMPANY-ID = 'DMD'
  9996       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  9997         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
  9998        ELSE
  9999         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10000
 10001  0525-FIND-ACCT-COMM.
 10002     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10003        NEXT SENTENCE
 10004      ELSE
 10005         ADD +1 TO SUB1
 10006         IF SUB1 LESS +11
 10007            GO TO 0525-FIND-ACCT-COMM
 10008          ELSE
 10009             GO TO 0560-EDIT-CONTINUE.
 10010
 10011     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10012     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10013                                    PB-I-LIFE-COMMISSION.
 10014***  IF PB-COMPANY-ID = 'CRI'
 10015     IF PB-PREM-ACCTNG-ONLY
 10016         GO TO 0560-EDIT-CONTINUE.
 10017
 10018     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 184
* EL050.cbl
 10019     MOVE ' '    TO WS-CTBL-READ-SW.
 10020
 10021
 10022 0530-GET-AH-COMP.
 10023     IF NO-AH-COVERAGE  OR
 10024        NO-AH-BENEFIT-MATCH
 10025           GO TO 0540-NEXT-READ-STEP.
 10026
 10027     IF AM-A-COM (SUB1) NUMERIC
 10028        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10029         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10030         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10031         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10032         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10033     ELSE
 10034          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10035          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10036          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10037          MOVE ZEROS             TO WS-SUB1
 10038                                    WS-COMMISSION
 10039          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10040          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10041          IF WS-COMMISSION > ZEROS
 10042             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10043             GO TO 0540-NEXT-READ-STEP
 10044          END-IF
 10045          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10046          IF CTBL-TABLE-FOUND
 10047             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10048                                        PB-I-AH-TERM
 10049             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10050             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10051             GO TO 0540-NEXT-READ-STEP
 10052          ELSE
 10053             IF FIRST-TIME-THROUGH
 10054                 GO TO 0530-GET-AH-COMP
 10055             ELSE
 10056                 MOVE ER-2609                TO WS-ERROR
 10057                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10058
 10059 0540-NEXT-READ-STEP.
 10060     MOVE '0540' TO CTBL-SW.
 10061     MOVE ' '    TO WS-CTBL-READ-SW.
 10062
 10063 0540-GET-LF-COMP.
 10064     IF NO-LIFE-COVERAGE  OR
 10065        NO-LF-BENEFIT-MATCH
 10066           GO TO 0560-EDIT-CONTINUE.
 10067
 10068     IF WS-LF-JOINT-INDICATOR = 'J'
 10069        IF AM-J-COM (SUB1) NUMERIC
 10070           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10071           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10072           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10073           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10074           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10075        ELSE
 10076           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 185
* EL050.cbl
 10077           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10078           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10079           MOVE ZEROS                TO WS-SUB1
 10080                                        WS-COMMISSION
 10081           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10082           IF WS-COMMISSION > ZEROS
 10083              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10084              GO TO 0560-EDIT-CONTINUE
 10085           END-IF
 10086           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10087           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10088           IF CTBL-TABLE-FOUND
 10089              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10090              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10091              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10092              GO TO 0560-EDIT-CONTINUE
 10093           ELSE
 10094              IF FIRST-TIME-THROUGH
 10095                  GO TO 0540-GET-LF-COMP
 10096              ELSE
 10097                  MOVE ER-2609                TO WS-ERROR
 10098                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10099                  GO TO 0560-EDIT-CONTINUE.
 10100
 10101     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10102        IF AM-L-COM (SUB1) NUMERIC
 10103           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10104           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10105           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10106           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10107           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10108        ELSE
 10109           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10110           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10111           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10112           MOVE ZEROS                TO WS-SUB1
 10113                                        WS-COMMISSION
 10114           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10115           IF WS-COMMISSION IS GREATER THAN ZEROS
 10116              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10117              GO TO 0560-EDIT-CONTINUE
 10118           END-IF
 10119           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10120           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10121           IF CTBL-TABLE-FOUND
 10122              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10123              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10124              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10125              GO TO 0560-EDIT-CONTINUE
 10126           ELSE
 10127              IF FIRST-TIME-THROUGH
 10128                  GO TO 0540-GET-LF-COMP
 10129              ELSE
 10130                  MOVE ER-2609                TO WS-ERROR
 10131                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10132
 10133*    GO TO 0560-EDIT-CONTINUE.
 10134
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 186
* EL050.cbl
 10135 0560-EDIT-CONTINUE.
 10136     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10137                                    WS-AH-PMF-COMM
 10138*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10139*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10140     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10141        (SUB1 > +10)
 10142        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10143           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10144           MOVE '0530'           TO CTBL-SW
 10145           MOVE ' '              TO WS-CTBL-READ-SW
 10146           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10147           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10148           MOVE '0540'           TO CTBL-SW
 10149           MOVE ' '              TO WS-CTBL-READ-SW
 10150           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10151        END-IF
 10152     END-PERFORM
 10153     GO TO 0564-EDIT-CONTINUE
 10154     .
 10155 0561-CHECK-AH.
 10156     IF (NO-AH-COVERAGE)
 10157        OR (NO-AH-BENEFIT-MATCH)
 10158        CONTINUE
 10159     ELSE
 10160        IF (AM-A-COM (SUB1) NUMERIC)
 10161           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10162           IF (AM-COM-TYP (SUB1) = 'A')
 10163              AND (WS-AH-PMF-COMM = ZEROS)
 10164              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10165           END-IF
 10166           CONTINUE
 10167        ELSE
 10168           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10169           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10170           MOVE PB-AH-OVERRIDE-L1
 10171                                 TO CTBL-BEN-TYPE
 10172           MOVE ZEROS            TO WS-SUB1
 10173                                    WS-COMMISSION
 10174           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10175           PERFORM 8300-READ-CTBL-TABLE
 10176                                 THRU 8300-EXIT
 10177           IF CTBL-TABLE-FOUND
 10178              IF (AM-COM-TYP (SUB1) = 'A')
 10179                 AND (WS-AH-PMF-COMM = ZEROS)
 10180                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10181                                        PB-I-AH-TERM
 10182                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10183                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10184              END-IF
 10185              CONTINUE
 10186           ELSE
 10187              IF FIRST-TIME-THROUGH
 10188                 GO TO 0561-CHECK-AH
 10189              ELSE
 10190                 MOVE ER-2609    TO WS-ERROR
 10191                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10192              END-IF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 187
* EL050.cbl
 10193           END-IF
 10194        END-IF
 10195     END-IF
 10196     .
 10197 0561-EXIT.
 10198     EXIT.
 10199 0563-CHECK-LF.
 10200     IF (NO-LIFE-COVERAGE)
 10201        OR (NO-LF-BENEFIT-MATCH)
 10202        CONTINUE
 10203     ELSE
 10204        IF WS-LF-JOINT-INDICATOR = 'J'
 10205           IF AM-J-COM (SUB1) NUMERIC
 10206              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10207              IF (AM-COM-TYP (SUB1) = 'A')
 10208                 AND (WS-LF-PMF-COMM = ZEROS)
 10209                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10210              END-IF
 10211              CONTINUE
 10212           ELSE
 10213              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10214              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10215              MOVE PB-LIFE-OVERRIDE-L1
 10216                                 TO CTBL-BEN-TYPE
 10217              MOVE ZEROS         TO WS-SUB1
 10218                                    WS-COMMISSION
 10219              MOVE AM-J-COMA (SUB1)
 10220                                 TO CTBL-TABLE
 10221              PERFORM 8300-READ-CTBL-TABLE
 10222                                 THRU 8300-EXIT
 10223              IF CTBL-TABLE-FOUND
 10224                 IF (AM-COM-TYP (SUB1) = 'A')
 10225                    AND (WS-LF-PMF-COMM = ZEROS)
 10226                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10227                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10228                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10229                 END-IF
 10230                 CONTINUE
 10231              ELSE
 10232                 IF FIRST-TIME-THROUGH
 10233                    GO TO 0563-CHECK-LF
 10234                 ELSE
 10235                    MOVE ER-2609 TO WS-ERROR
 10236                    PERFORM 9900-ERROR-FORMAT
 10237                                 THRU 9900-EXIT
 10238*                   GO TO 0560-EDIT-CONTINUE
 10239                 END-IF
 10240              END-IF
 10241           END-IF
 10242        ELSE
 10243           IF AM-L-COM (SUB1) NUMERIC
 10244              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10245              IF (AM-COM-TYP (SUB1) = 'A')
 10246                 AND (WS-LF-PMF-COMM = ZEROS)
 10247                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10248              END-IF
 10249              CONTINUE
 10250           ELSE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 188
* EL050.cbl
 10251              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10252              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10253              MOVE PB-LIFE-OVERRIDE-L1
 10254                                 TO CTBL-BEN-TYPE
 10255              MOVE ZEROS         TO WS-SUB1
 10256                                    WS-COMMISSION
 10257              MOVE AM-L-COMA (SUB1)
 10258                                 TO CTBL-TABLE
 10259              PERFORM 8300-READ-CTBL-TABLE
 10260                                 THRU 8300-EXIT
 10261              IF CTBL-TABLE-FOUND
 10262                 CONTINUE
 10263              ELSE
 10264                 IF FIRST-TIME-THROUGH
 10265                    GO TO 0563-CHECK-LF
 10266                 ELSE
 10267                    MOVE ER-2609 TO WS-ERROR
 10268                    PERFORM 9900-ERROR-FORMAT
 10269                                 THRU 9900-EXIT
 10270                 END-IF
 10271              END-IF
 10272           END-IF
 10273        END-IF
 10274     END-IF
 10275     .
 10276 0563-EXIT.
 10277     EXIT.
 10278 0564-EDIT-CONTINUE.
 10279
 10280     IF  PB-COMPANY-ID EQUAL 'DMD'
 10281         IF PB-I-NUM-BILLED EQUAL ZEROS
 10282            MOVE ER-8148       TO WS-ERROR
 10283            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10284
 10285*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10286*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10287*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10288*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10289*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10290*         IF NO-CONVERSION-ERROR
 10291*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10292*         ELSE
 10293*             IF PB-COMPANY-ID EQUAL 'HAN'
 10294*                 MOVE ZEROS     TO PB-I-AGE.
 10295     IF PB-I-BIRTHDAY > LOW-VALUES
 10296        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10297        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10298        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10299        PERFORM 8500-DATE-CONVERT
 10300                                 THRU 8500-EXIT
 10301        IF NO-CONVERSION-ERROR
 10302           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10303           IF PB-I-AGE > ZEROS
 10304              IF WS-WORK-AGE NOT = PB-I-AGE
 10305                 MOVE ER-9501    TO WS-ERROR
 10306                 PERFORM 9900-ERROR-FORMAT
 10307                                 THRU 9900-EXIT
 10308              END-IF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 189
* EL050.cbl
 10309           ELSE
 10310              MOVE WS-WORK-AGE   TO PB-I-AGE
 10311           END-IF
 10312        END-IF
 10313     END-IF
 10314     IF PB-I-AGE = ZEROS
 10315        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10316           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10317
 10318     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10319                                   WS-AH-EDIT-AGE.
 10320
 10321     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10322        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10323        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10324        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10325        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10326        IF NO-CONVERSION-ERROR
 10327           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10328           IF PB-I-JOINT-AGE > 0
 10329              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10330                 MOVE ER-9503    TO WS-ERROR
 10331                 PERFORM 9900-ERROR-FORMAT
 10332                                 THRU 9900-EXIT
 10333              END-IF
 10334           ELSE
 10335              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10336           END-IF
 10337        ELSE
 10338           MOVE ZEROS            TO PB-I-JOINT-AGE
 10339        END-IF
 10340     END-IF
 10341     IF PB-I-JOINT-AGE NOT NUMERIC
 10342        MOVE ZERO               TO PB-I-JOINT-AGE.
 10343
 10344     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC'
 10345        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10346           (WS-AH-JOINT-INDICATOR = 'J')
 10347           IF PB-I-JOINT-AGE = ZEROS
 10348               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10349           END-IF
 10350        END-IF
 10351     END-IF
 10352
 10353     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10354     IF WS-LF-JOINT-INDICATOR = 'J'
 10355        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10356        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10357            IF  PB-I-JOINT-AGE = ZERO
 10358                MOVE ER-2686       TO WS-ERROR
 10359                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10360            ELSE
 10361                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10362                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10363                    IF PB-COMPANY-ID NOT = 'LBL'
 10364                        MOVE ER-2685    TO WS-ERROR
 10365                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10366
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 190
* EL050.cbl
 10367     IF WS-AH-JOINT-INDICATOR = 'J'
 10368        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10369            IF  PB-I-JOINT-AGE = ZERO
 10370                MOVE ER-2686       TO WS-ERROR
 10371                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10372            ELSE
 10373                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10374                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10375                                           WS-EDIT-AGE
 10376                    IF PB-COMPANY-ID NOT = 'LBL'
 10377                        MOVE ER-2685    TO WS-ERROR
 10378                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10379
 10380******************************************************************
 10381*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10382******************************************************************
 10383
 10384     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10385        (WS-AH-SPECIAL-CALC-CD = 'O')
 10386        NEXT SENTENCE
 10387     ELSE
 10388        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10389          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10390           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10391            WS-AH-JOINT-INDICATOR = 'J')  AND
 10392           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10393            MOVE ER-2627             TO WS-ERROR
 10394            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10395
 10396     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10397        (WS-AH-SPECIAL-CALC-CD = 'O')
 10398         NEXT SENTENCE
 10399     ELSE
 10400         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10401            WS-AH-JOINT-INDICATOR = 'J'
 10402             IF PB-I-JOINT-INSURED = SPACES
 10403                 IF PB-COMPANY-ID NOT = 'JAL'
 10404                     MOVE ER-2696    TO WS-ERROR
 10405                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10406
 10407     IF PB-COMPANY-ID NOT = 'BOA'
 10408        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10409           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10410           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10411               PB-I-JOINT-INSURED NOT = SPACES)
 10412                MOVE ER-2691         TO WS-ERROR
 10413                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10414
 10415     IF PB-COMPANY-ID = 'BOA'
 10416        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10417           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10418            IF PB-I-JOINT-AGE NOT = ZEROS
 10419                MOVE ER-2691         TO WS-ERROR
 10420                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10421
 10422     IF PB-COMPANY-ID = 'CRI'
 10423        IF PB-I-SIG-SW = 'J'
 10424           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 191
* EL050.cbl
 10425              WS-AH-JOINT-INDICATOR NOT = 'J'
 10426              MOVE ER-2675       TO WS-ERROR
 10427              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10428
 10429     IF PB-COMPANY-ID = 'CRI'
 10430        IF PB-I-SIG-SW = 'S'
 10431           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10432              WS-AH-JOINT-INDICATOR = 'J'
 10433              MOVE ER-2676       TO WS-ERROR
 10434              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10435
 10436     IF PB-COMPANY-ID = 'CVL'
 10437         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10438            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10439              MOVE ER-2783           TO WS-ERROR
 10440              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10441     IF (WS-LF-JOINT-INDICATOR = 'J')
 10442        AND (WS-AH-JOINT-INDICATOR = 'J')
 10443        AND (PB-I-LF-TERM > 120)
 10444        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10445        MOVE ER-2783             TO WS-ERROR
 10446        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10447     END-IF
 10448     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10449
 10450     IF PB-I-INDV-GRP-OVRD = 'I'
 10451        MOVE ER-2666             TO WS-ERROR
 10452        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10453        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10454
 10455     IF PB-I-INDV-GRP-OVRD = 'G'
 10456        MOVE ER-2666             TO WS-ERROR
 10457        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10458        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10459
 10460     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10461        NEXT SENTENCE
 10462     ELSE
 10463        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10464
 10465     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10466        IF WS-ERROR = ER-2666
 10467           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10468           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10469
 10470     IF PB-COMPANY-ID = 'CID'
 10471        IF PB-STATE = 'UT' OR 'MO'
 10472           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10473                 OR '76' OR '77')
 10474                      OR
 10475               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10476                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10477                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10478                   OR '2K' OR '2L'))
 10479              AND PB-I-INDV-GRP-CD = 'I'
 10480              MOVE ER-2721             TO WS-ERROR
 10481              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10482           END-IF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 192
* EL050.cbl
 10483        END-IF
 10484     END-IF
 10485
 10486     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10487     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10488        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10489     ELSE
 10490        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10491     END-IF
 10492
 10493*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10494*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10495     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10496                                    ACCOUNT-AH-CK-SW.
 10497
 10498     IF PB-REISSUED-CERT       OR
 10499        PB-REIN-ONLY-CERT      OR
 10500        PB-POLICY-IS-DECLINED  OR
 10501        PB-POLICY-IS-VOIDED
 10502*       OR PB-MONTHLY-CERT
 10503         GO TO 3000-CONTINUE-EDIT.
 10504
 10505     IF PB-COMPANY-ID = 'CID'
 10506        IF WS-EDIT-AGE           > +65
 10507           MOVE ER-2709          TO WS-ERROR
 10508           PERFORM 9900-ERROR-FORMAT
 10509                                 THRU 9900-EXIT
 10510        ELSE
 10511           IF WS-EDIT-AGE        > +55
 10512              MOVE ER-2718       TO WS-ERROR
 10513              PERFORM 9900-ERROR-FORMAT
 10514                                 THRU 9900-EXIT
 10515           END-IF
 10516        END-IF
 10517     IF PB-COMPANY-ID = 'DCC'
 10518        IF WS-EDIT-AGE           > +65
 10519           MOVE ER-2709          TO WS-ERROR
 10520           PERFORM 9900-ERROR-FORMAT
 10521                                 THRU 9900-EXIT
 10522        END-IF
 10523     END-IF
 10524     .
 10525
 10526 0565-LIFE-PLAN-LIMIT-EDITS.
 10527
 10528     IF NOT LF-PLAN-MASTER-FOUND
 10529        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10530                                    EC-AM-LF-MAX-TOT-BEN
 10531        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10532
 10533     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10534
 10535     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10536         IF PL-LM-AGE (1) = ZEROS
 10537             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10538
 10539     IF NO-LF-BENEFIT-MATCH          OR
 10540        WS-LF-BENEFIT-CD = ZEROS     OR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 193
* EL050.cbl
 10541        WS-LF-SPECIAL-CALC-CD = 'M'
 10542        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10543
 10544     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10545     MOVE +1                     TO SUB2.
 10546
 10547     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10548        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10549           MOVE +5   TO SUB2
 10550           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10551              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10552              (PL-LM-AGE (SUB2) EQUAL +0)
 10553              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10554              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10555
 10556     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10557
 10558     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10559                               + PB-I-LF-ALT-BENEFIT-AMT.
 10560
 10561 0568-CHECK-LIFE-ATT-AGE.
 10562
 10563     IF PL-ATT-AGE NUMERIC AND
 10564        PL-ATT-AGE > +0
 10565        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10566     END-IF
 10567*    IF PL-ATT-AGE NUMERIC AND
 10568*       PL-ATT-AGE > +0
 10569*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10570*       IF PB-I-BIRTHDAY > LOW-VALUES
 10571*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10572*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10573*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10574*          SET BIN-PLUS-ELAPSED  TO TRUE
 10575*          PERFORM 8500-DATE-CONVERT
 10576*                                THRU 8500-EXIT
 10577*          IF NO-CONVERSION-ERROR
 10578*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10579*             MOVE ER-2669       TO WS-ERROR
 10580*             PERFORM 9900-ERROR-FORMAT
 10581*                                THRU 9900-EXIT
 10582*          END-IF
 10583*       ELSE
 10584*          IF WS-ATT-AGE >= PL-ATT-AGE
 10585*             MOVE ER-2669       TO WS-ERROR
 10586*             PERFORM 9900-ERROR-FORMAT
 10587*                                THRU 9900-EXIT
 10588*          END-IF
 10589*       END-IF
 10590*    END-IF
 10591     .
 10592 0570-CHECK-LIFE-LIMITS.
 10593
 10594     IF PB-COMPANY-ID EQUAL 'CRI'
 10595        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10596           IF SUB2 GREATER THAN +4
 10597              MOVE ER-2637 TO WS-ERROR
 10598              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 194
* EL050.cbl
 10599              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10600
 10601     IF PB-COMPANY-ID  =  'NCL'
 10602        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10603            SUB2 GREATER THAN +8
 10604             MOVE 'U'         TO PB-BATCH-ENTRY
 10605             MOVE ER-2637     TO WS-ERROR
 10606             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10607             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10608
 10609     IF SUB2 > +8
 10610        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10611           AND (PB-I-SIG-SW = 'Y')
 10612           CONTINUE
 10613        ELSE
 10614           MOVE ER-2637          TO WS-ERROR
 10615           PERFORM 9900-ERROR-FORMAT
 10616                                 THRU 9900-EXIT
 10617        END-IF
 10618        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10619     END-IF
 10620     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10621     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10622     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10623
 10624     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10625        ADD +1  TO SUB2
 10626        GO TO 0570-CHECK-LIFE-LIMITS.
 10627
 10628     IF PB-COMPANY-ID = 'NCL'
 10629         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10630
 10631     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10632        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10633        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10634           AND (PB-I-SIG-SW = 'Y')
 10635           CONTINUE
 10636        ELSE
 10637           MOVE ER-2637          TO WS-ERROR
 10638           PERFORM 9900-ERROR-FORMAT
 10639                                 THRU 9900-EXIT
 10640        END-IF
 10641     END-IF
 10642     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10643
 10644
 10645 0570-CHECK-NCL-LIFE-LIMITS.
 10646
 10647     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10648        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 10649         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10650
 10651     IF APP-CERT-USED
 10652         IF SUB2  LESS THAN  +5
 10653             MOVE +5          TO SUB2
 10654             GO TO 0570-CHECK-LIFE-LIMITS.
 10655
 10656     MOVE ER-2637             TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 195
* EL050.cbl
 10657     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10658
 10659     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10660
 10661 0575-CHECK-NCL-SIG-SWITCH.
 10662
 10663     IF NOT APP-CERT-USED
 10664         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10665
 10666     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10667        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10668        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10669        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10670         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10671
 10672     IF SUB2 GREATER THAN +4
 10673         IF PL-LM-AGE (5) = ZEROS  AND
 10674            PL-LM-AGE (6) = ZEROS  AND
 10675            PL-LM-AGE (7) = ZEROS  AND
 10676            PL-LM-AGE (8) = ZEROS
 10677             MOVE  ER-1927        TO WS-ERROR
 10678             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10679             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10680         ELSE
 10681             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10682                 MOVE  ER-1920    TO WS-ERROR
 10683                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10684
 10685     IF PB-I-SIG-SW  = 'Y'
 10686       IF NOT PB-I-POLICY-ACCEPTED  AND
 10687          NOT PB-I-POLICY-DECLINED
 10688           MOVE 'U'               TO PB-BATCH-ENTRY
 10689           MOVE  ER-1926          TO WS-ERROR
 10690           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10691
 10692
 10693 0580-AH-PLAN-LIMIT-EDITS.
 10694
 10695     IF PB-COMPANY-ID = 'CID'
 10696        IF PB-I-AH-BENEFIT-AMT > +1250
 10697           MOVE ER-2702          TO WS-ERROR
 10698           PERFORM 9900-ERROR-FORMAT
 10699                                 THRU 9900-EXIT
 10700        END-IF
 10701     END-IF
 10702
 10703     IF (PB-COMPANY-ID = 'DCC')
 10704        AND (PB-MONTHLY-CERT)
 10705        IF PB-I-AH-BENEFIT-AMT > +1000
 10706           MOVE ER-2881          TO WS-ERROR
 10707           PERFORM 9900-ERROR-FORMAT
 10708                                 THRU 9900-EXIT
 10709        END-IF
 10710     END-IF
 10711     IF NOT AH-PLAN-MASTER-FOUND
 10712        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10713        GO TO 3000-CONTINUE-EDIT.
 10714
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 196
* EL050.cbl
 10715     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10716
 10717     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10718         IF PL-LM-AGE (1) = ZEROS
 10719             GO TO 3000-CONTINUE-EDIT.
 10720
 10721     IF NO-AH-BENEFIT-MATCH          OR
 10722        WS-AH-BENEFIT-CD = ZEROS     OR
 10723        WS-AH-SPECIAL-CALC-CD = 'M'
 10724        GO TO 3000-CONTINUE-EDIT.
 10725
 10726     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10727     MOVE +1                     TO SUB2.
 10728
 10729     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10730        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10731           MOVE +5 TO SUB2
 10732           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10733              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10734              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10735              (PL-LM-AGE (SUB2) EQUAL +0)
 10736              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10737              GO TO 3000-CONTINUE-EDIT.
 10738
 10739     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10740
 10741 0590-CHECK-AH-ATT-AGE.
 10742
 10743     IF PL-ATT-AGE NUMERIC AND
 10744        PL-ATT-AGE GREATER THAN +0
 10745        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10746     END-IF
 10747*       IF WS-ATT-AGE >= PL-ATT-AGE
 10748*          MOVE ER-3054          TO WS-ERROR
 10749*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10750     .
 10751 0597-CHECK-AH-LIMITS.
 10752
 10753     IF PB-COMPANY-ID EQUAL 'CRI'
 10754        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10755           IF SUB2 GREATER THAN +4
 10756              MOVE ER-2638       TO WS-ERROR
 10757              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10758              GO TO 3000-CONTINUE-EDIT.
 10759
 10760     IF PB-COMPANY-ID  =  'NCL'
 10761        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10762            SUB2 GREATER THAN +8
 10763             MOVE 'U'            TO PB-BATCH-ENTRY
 10764             MOVE ER-2638        TO WS-ERROR
 10765             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10766             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10767
 10768     IF SUB2 > +8
 10769        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10770           AND (PB-I-SIG-SW = 'Y')
 10771           CONTINUE
 10772        ELSE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 197
* EL050.cbl
 10773           MOVE ER-2638          TO WS-ERROR
 10774           PERFORM 9900-ERROR-FORMAT
 10775                                 THRU 9900-EXIT
 10776        END-IF
 10777        GO TO 3000-CONTINUE-EDIT
 10778     END-IF
 10779
 10780     IF PB-COMPANY-ID = 'CRI'
 10781        IF WS-ERROR = ER-2638
 10782           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 10783
 10784     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 10785     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 10786     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 10787     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 10788
 10789     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10790        ADD +1                   TO SUB2
 10791        GO TO 0597-CHECK-AH-LIMITS.
 10792
 10793     IF PB-COMPANY-ID = 'NCL'
 10794         GO TO 0597-CHECK-NCL-AH-LIMITS.
 10795
 10796     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 10797        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 10798        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10799                                 > PL-LM-AMT (SUB2))
 10800        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10801           AND (PB-I-SIG-SW = 'Y')
 10802           CONTINUE
 10803        ELSE
 10804           MOVE ER-2638          TO WS-ERROR
 10805           PERFORM 9900-ERROR-FORMAT
 10806                                 THRU 9900-EXIT
 10807        END-IF
 10808     END-IF
 10809
 10810     IF  PB-COMPANY-ID   EQUAL    'CRI'
 10811         IF  WS-ERROR    EQUAL    ER-2638
 10812             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 10813                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 10814                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10815                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10816                MOVE  ER-1910    TO  WS-ERROR
 10817                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 10818
 10819     IF PB-COMPANY-ID = 'CRI'
 10820        IF WS-ERROR = ER-2638
 10821            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10822            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10823            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 10824
 10825     GO TO 3000-CONTINUE-EDIT.
 10826
 10827 0597-CHECK-NCL-AH-LIMITS.
 10828
 10829     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 10830        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 198
* EL050.cbl
 10831        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10832                            NOT GREATER THAN PL-LM-AMT (SUB2))
 10833         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10834
 10835     IF APP-CERT-USED
 10836         IF SUB2  LESS THAN  +5
 10837             MOVE +5             TO SUB2
 10838             GO TO 0597-CHECK-AH-LIMITS.
 10839
 10840     MOVE ER-2638                TO WS-ERROR.
 10841     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10842
 10843     MOVE 'U'                    TO PB-BATCH-ENTRY.
 10844
 10845 0599-CHECK-NCL-SIG-SWITCH.
 10846
 10847     IF NOT APP-CERT-USED
 10848         GO TO 3000-CONTINUE-EDIT.
 10849
 10850     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10851        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10852        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10853        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10854         GO TO 3000-CONTINUE-EDIT.
 10855
 10856     IF SUB2 GREATER THAN +4
 10857         IF PL-LM-AGE (5) = ZEROS  AND
 10858            PL-LM-AGE (6) = ZEROS  AND
 10859            PL-LM-AGE (7) = ZEROS  AND
 10860            PL-LM-AGE (8) = ZEROS
 10861             MOVE  ER-1927        TO WS-ERROR
 10862             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10863             GO TO 3000-CONTINUE-EDIT
 10864         ELSE
 10865             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10866                 MOVE  ER-1920    TO WS-ERROR
 10867                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10868
 10869     IF PB-I-SIG-SW  = 'Y'
 10870       IF NOT PB-I-POLICY-ACCEPTED  AND
 10871          NOT PB-I-POLICY-DECLINED
 10872           MOVE 'U'               TO PB-BATCH-ENTRY
 10873           MOVE  ER-1926          TO WS-ERROR
 10874           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10875
 10876******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 199
* EL050.cbl
 10878
 10879 3000-CONTINUE-EDIT.
 10880
 10881     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10882     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 10883     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10884     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10885     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10886
 10887     IF BROWSE-STARTED
 10888        PERFORM 9990-RETURN THRU 9990-EXIT
 10889        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 10890
 10891     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 10892        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 10893        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10894        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10895*       MOVE 1                   TO DC-OPTION-CODE
 10896        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10897        IF DATE-CONVERSION-ERROR
 10898           MOVE ER-2622          TO WS-ERROR
 10899           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10900        ELSE
 10901           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 10902              MOVE ER-2623       TO WS-ERROR
 10903              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10904           ELSE
 10905              MOVE ER-2622       TO WS-ERROR
 10906              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10907
 10908     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 10909     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 10910     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 10911*    MOVE 1                      TO DC-OPTION-CODE.
 10912     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10913     IF DATE-CONVERSION-ERROR
 10914        GO TO 3005-EDIT-CONTINUE
 10915     ELSE
 10916        IF DC-ELAPSED-DAYS GREATER +180
 10917           MOVE ER-2613          TO WS-ERROR
 10918           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10919        ELSE
 10920           IF DC-ELAPSED-DAYS GREATER +90
 10921              MOVE ER-2612       TO WS-ERROR
 10922              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10923           ELSE
 10924             IF DC-ELAPSED-DAYS GREATER +60
 10925                MOVE ER-2614     TO WS-ERROR
 10926                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10927
 10928 3005-EDIT-CONTINUE.
 10929
 10930     IF PB-CANCELLATION
 10931         GO TO 3700-EDIT-CANCEL.
 10932
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 200
* EL050.cbl
 10934******************************************************************
 10935*                  E D I T   I S S U E                           *
 10936******************************************************************
 10937
 10938 3020-EDIT-ISSUE.
 10939
 10940      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 10941      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 10942      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 10943      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 10944      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 10945
 10946     IF PB-ISSUE-FORCE
 10947        OR PB-ISSUE-DATE-FORCED
 10948        OR PB-FORCE-OFF
 10949        OR PB-OVERCHARGE-FORCE
 10950        CONTINUE
 10951     ELSE
 10952        MOVE ER-2670             TO WS-ERROR
 10953        PERFORM 9900-ERROR-FORMAT
 10954                                 THRU 9900-EXIT
 10955     END-IF
 10956     .
 10957 3022-SET-POLICY-STATUS.
 10958
 10959     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 10960
 10961     IF (PB-REISSUED-CERT)
 10962             OR
 10963        ((PB-COMPANY-ID NOT = 'DCC')
 10964         AND (PB-MONTHLY-CERT))
 10965         MOVE '5'                TO PB-I-ENTRY-STATUS
 10966         MOVE 'E'                TO PB-BATCH-ENTRY
 10967     END-IF
 10968
 10969     IF PB-COMPANY-ID = 'DCC'
 10970        IF PB-MONTHLY-CERT
 10971           MOVE 'M'              TO PB-I-ENTRY-STATUS
 10972        END-IF
 10973     END-IF
 10974     IF PB-POLICY-IS-DECLINED
 10975         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 10976     IF PB-POLICY-IS-VOIDED
 10977         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 10978     IF PB-NEEDS-UNDERWRITING
 10979         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 10980     IF PB-REIN-ONLY-CERT
 10981         MOVE '9'                TO PB-I-ENTRY-STATUS.
 10982     IF PB-PREM-ACCTNG-ONLY
 10983         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 10984
 10985     MOVE SPACE                  TO PB-I-OB-FLAG.
 10986
 10987     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 10988         MOVE ER-2665            TO WS-ERROR
 10989         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10990         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 10991
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 201
* EL050.cbl
 10992     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 10993        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 10994           MOVE 'Z'             TO PB-I-OB-FLAG.
 10995
 10996     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 10997        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 10998           MOVE 'Z'             TO PB-I-OB-FLAG.
 10999
 11000     IF ACCOUNT-MAST-FOUND
 11001         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11002         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11003         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11004         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11005         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11006         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11007         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11008     END-IF
 11009
 11010     IF ACCOUNT-MAST-FOUND
 11011        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11012         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11013
 11014     IF (ACCOUNT-MAST-FOUND)
 11015        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11016        IF PB-REISSUED-CERT
 11017           CONTINUE
 11018        ELSE
 11019           MOVE ER-2608          TO WS-ERROR
 11020           PERFORM 9900-ERROR-FORMAT
 11021                                 THRU 9900-EXIT
 11022         END-IF
 11023     END-IF
 11024
 11025     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11026        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11027        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11028
 11029**********   DMD CUSTOM CODE FOLLOWS  **********
 11030 3024-EDIT-DMD-FIELDS.
 11031     IF PB-COMPANY-ID NOT = 'DMD'
 11032        GO TO 3025-EDIT-REINSURANCE.
 11033
 11034*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11035*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11036*** ERROR IF THEY ARE NOT EQUAL.
 11037
 11038     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11039     SET BIN-TO-GREG               TO TRUE.
 11040     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11041     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11042**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11043
 11044     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11045     SET BIN-TO-GREG               TO TRUE.
 11046     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11047     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11048**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11049
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 202
* EL050.cbl
 11050     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11051        MOVE ER-8116               TO WS-ERROR
 11052        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11053
 11054     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11055
 11056     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11057                                      WK-FULL-CERT-NO.
 11058     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11059
 11060     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11061
 11062     IF PB-VALID-LIFE
 11063        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11064     ELSE
 11065        IF PB-VALID-AH
 11066          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11067
 11068
 11069     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11070     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11071     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11072                                      DCUA-UNDRWRTR-CODE
 11073                                      DCUA-UNDRWRTR-GROUP-CODE
 11074                                      DCUA-RETURN-CODE.
 11075
 11076****************************************************************
 11077*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11078***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11079***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11080***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11081***   TO THIS RECORD.                                        ***
 11082****************************************************************
 11083     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11084     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11085     IF DCUA-SUCCESSFUL-PROCESS
 11086        GO TO 3024-EDIT-DL7-CONT.
 11087
 11088     IF DCUA-RETURN-CODE EQUAL '01'
 11089        MOVE ER-8110               TO WS-ERROR
 11090        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11091        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11092        GO TO 3024-EDIT-DL7-CONT.
 11093
 11094     IF DCUA-RETURN-CODE EQUAL '02'
 11095        MOVE ER-8111               TO WS-ERROR
 11096        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11097        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11098        GO TO 3024-EDIT-DL7-CONT.
 11099
 11100     IF DCUA-RETURN-CODE EQUAL '03'
 11101        MOVE ER-8074               TO WS-ERROR
 11102        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11103        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11104        GO TO 3024-EDIT-DL7-CONT.
 11105
 11106     IF DCUA-RETURN-CODE EQUAL '04'
 11107        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 203
* EL050.cbl
 11108        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11109        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11110        GO TO 3024-EDIT-DL7-CONT.
 11111
 11112     IF DCUA-RETURN-CODE EQUAL '05'
 11113        MOVE ER-8076               TO WS-ERROR
 11114        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11115        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11116        GO TO 3024-EDIT-DL7-CONT.
 11117
 11118     IF DCUA-RETURN-CODE EQUAL '06'
 11119        MOVE ER-8077               TO WS-ERROR
 11120        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11121        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11122        GO TO 3024-EDIT-DL7-CONT.
 11123
 11124     IF DCUA-RETURN-CODE EQUAL '07'
 11125        MOVE ER-8078               TO WS-ERROR
 11126        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11127        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11128        GO TO 3024-EDIT-DL7-CONT.
 11129
 11130     IF DCUA-RETURN-CODE EQUAL 'E1'
 11131        MOVE ER-8079               TO WS-ERROR
 11132        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11133        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11134        GO TO 3024-EDIT-DL7-CONT.
 11135
 11136     IF DCUA-RETURN-CODE EQUAL 'E2'
 11137        MOVE ER-8080               TO WS-ERROR
 11138        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11139        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11140        GO TO 3024-EDIT-DL7-CONT.
 11141
 11142     IF DCUA-RETURN-CODE EQUAL 'E3'
 11143        MOVE ER-8098               TO WS-ERROR
 11144        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11145        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11146        GO TO 3024-EDIT-DL7-CONT.
 11147
 11148     IF DCUA-RETURN-CODE EQUAL 'C1'
 11149        MOVE ER-8099               TO WS-ERROR
 11150        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11151        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11152        GO TO 3024-EDIT-DL7-CONT.
 11153
 11154     IF DCUA-RETURN-CODE EQUAL 'U1'
 11155        MOVE ER-8109               TO WS-ERROR
 11156        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11157        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11158        GO TO 3024-EDIT-DL7-CONT.
 11159
 11160     IF DCUA-RETURN-CODE EQUAL 'N1'
 11161        MOVE ER-8112               TO WS-ERROR
 11162        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11163        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11164        GO TO 3024-EDIT-DL7-CONT.
 11165
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 204
* EL050.cbl
 11166     IF DCUA-RETURN-CODE EQUAL 'N2'
 11167        MOVE ER-8113               TO WS-ERROR
 11168        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11169        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11170        GO TO 3024-EDIT-DL7-CONT.
 11171
 11172     IF DCUA-RETURN-CODE EQUAL 'N3'
 11173        MOVE ER-8114               TO WS-ERROR
 11174        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11175        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11176        GO TO 3024-EDIT-DL7-CONT.
 11177
 11178     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11179     MOVE ER-8097                  TO WS-ERROR.
 11180     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11181     GO TO 3024-EDIT-DL7-CONT.
 11182
 11183 3024-EDIT-DL7-CONT.
 11184
 11185     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11186     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11187     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11188        NEXT SENTENCE
 11189     ELSE
 11190        MOVE ER-9263               TO WS-ERROR
 11191        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11192
 11193******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11194******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11195     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11196        NEXT SENTENCE
 11197     ELSE
 11198        MOVE ER-8039               TO WS-ERROR
 11199        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11200
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 205
* EL050.cbl
 11202****************************************************************
 11203*** VALIDATE STATE  : DLO022                                 ***
 11204****************************************************************
 11205     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11206     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11207
 11208     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11209     IF DVSC-SUCCESSFUL-EDIT
 11210        GO TO 3024-EDIT-DL22-CONT.
 11211
 11212     IF DVSC-RETURN-CODE EQUAL '01'
 11213        MOVE ER-8300               TO WS-ERROR
 11214        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11215        GO TO 3024-EDIT-DL22-CONT.
 11216
 11217     IF DVSC-RETURN-CODE EQUAL '02'
 11218        MOVE ER-8301               TO WS-ERROR
 11219        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11220        GO TO 3024-EDIT-DL22-CONT.
 11221
 11222     IF DVSC-RETURN-CODE EQUAL '03'
 11223        MOVE ER-8302               TO WS-ERROR
 11224        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11225        GO TO 3024-EDIT-DL22-CONT.
 11226
 11227     IF DVSC-RETURN-CODE EQUAL 'N1'
 11228        MOVE ER-8304               TO WS-ERROR
 11229        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11230        GO TO 3024-EDIT-DL22-CONT.
 11231
 11232     MOVE ER-8303                  TO WS-ERROR
 11233     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11234
 11235 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 206
* EL050.cbl
 11237****************************************************************
 11238*** VALIDATE LOAN OFFICER : DLO021                           ***
 11239****************************************************************
 11240
 11241     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11242     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11243     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11244     IF DVLO-SUCCESSFUL-EDIT
 11245        GO TO 3024-EDIT-DL21-CONT.
 11246
 11247     IF DVLO-RETURN-CODE EQUAL '01'
 11248        MOVE ER-8081               TO WS-ERROR
 11249        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11250        GO TO 3024-EDIT-DL21-CONT.
 11251
 11252     IF DVLO-RETURN-CODE EQUAL '02'
 11253        MOVE ER-8082               TO WS-ERROR
 11254        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11255        GO TO 3024-EDIT-DL21-CONT.
 11256
 11257     IF DVLO-RETURN-CODE EQUAL '03'
 11258        MOVE ER-8083               TO WS-ERROR
 11259        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11260        GO TO 3024-EDIT-DL21-CONT.
 11261
 11262     IF DVLO-RETURN-CODE EQUAL '04'
 11263        MOVE ER-8084               TO WS-ERROR
 11264        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11265        GO TO 3024-EDIT-DL21-CONT.
 11266
 11267     IF DVLO-RETURN-CODE EQUAL '05'
 11268        MOVE ER-8085               TO WS-ERROR
 11269        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11270        GO TO 3024-EDIT-DL21-CONT.
 11271
 11272     MOVE ER-7825                  TO WS-ERROR
 11273     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11274     GO TO 3024-EDIT-DL21-CONT.
 11275
 11276 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 207
* EL050.cbl
 11278
 11279****************************************************************
 11280*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11281****************************************************************
 11282
 11283     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11284     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11285     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11286     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11287     IF DIPF-SUCCESSFUL-EDIT
 11288        GO TO 3024-EDIT-DL02-CONT.
 11289
 11290     IF DIPF-RETURN-CODE EQUAL '01'
 11291        MOVE ER-8086               TO WS-ERROR
 11292        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11293        GO TO 3024-EDIT-DL02-CONT.
 11294
 11295     IF DIPF-RETURN-CODE EQUAL '02'
 11296        MOVE ER-8087               TO WS-ERROR
 11297        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11298        GO TO 3024-EDIT-DL02-CONT.
 11299
 11300     IF DIPF-RETURN-CODE EQUAL '03'
 11301        MOVE ER-8088               TO WS-ERROR
 11302        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11303        GO TO 3024-EDIT-DL02-CONT.
 11304
 11305     MOVE ER-8095                  TO WS-ERROR
 11306     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11307     GO TO 3024-EDIT-DL02-CONT.
 11308
 11309 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 208
* EL050.cbl
 11311
 11312****************************************************************
 11313*** VALIDATE BANK ID : DLO003                                ***
 11314****************************************************************
 11315
 11316     MOVE WK-GREG-CENT           TO WCG-CENT.
 11317     MOVE WK-GREG-YYMM           TO WCG-REST.
 11318     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11319        MOVE ER-8040               TO WS-ERROR
 11320        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11321
 11322     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11323     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11324     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11325     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11326     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11327     IF DVBI-SUCCESSFUL-EDIT
 11328        GO TO 3024-EDIT-DL03-CONT.
 11329
 11330     IF DVBI-RETURN-CODE EQUAL '01'
 11331        MOVE ER-8089               TO WS-ERROR
 11332        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11333        GO TO 3024-EDIT-DL03-CONT.
 11334
 11335     IF DVBI-RETURN-CODE EQUAL '02'
 11336        MOVE ER-8090               TO WS-ERROR
 11337        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11338        GO TO 3024-EDIT-DL03-CONT.
 11339
 11340     IF DVBI-RETURN-CODE EQUAL '03'
 11341        MOVE ER-8091               TO WS-ERROR
 11342        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11343        GO TO 3024-EDIT-DL03-CONT.
 11344
 11345     IF DVBI-RETURN-CODE EQUAL '04'
 11346        MOVE ER-8092               TO WS-ERROR
 11347        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11348        GO TO 3024-EDIT-DL03-CONT.
 11349
 11350     IF DVBI-RETURN-CODE EQUAL '05'
 11351        MOVE ER-8093               TO WS-ERROR
 11352        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11353        GO TO 3024-EDIT-DL03-CONT.
 11354
 11355     IF DVBI-RETURN-CODE EQUAL '06'
 11356        MOVE ER-8094               TO WS-ERROR
 11357        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11358        GO TO 3024-EDIT-DL03-CONT.
 11359
 11360     MOVE ER-8096                  TO WS-ERROR
 11361     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11362     GO TO 3024-EDIT-DL03-CONT.
 11363
 11364 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 209
* EL050.cbl
 11366
 11367     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11368        NEXT SENTENCE
 11369     ELSE
 11370        MOVE ER-8042               TO WS-ERROR
 11371        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11372
 11373     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11374     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11375     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11376
 11377     IF DMPF-RETURN-CODE = '01'
 11378        MOVE ER-8067               TO WS-ERROR
 11379        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11380        GO TO 3024-EDIT-DL01-CONT.
 11381
 11382     IF DMPF-RETURN-CODE = '02'
 11383        MOVE ER-8068               TO WS-ERROR
 11384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11385        GO TO 3024-EDIT-DL01-CONT.
 11386
 11387     IF DMPF-RETURN-CODE = '03'
 11388        MOVE ER-8069               TO WS-ERROR
 11389        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11390        GO TO 3024-EDIT-DL01-CONT.
 11391
 11392     IF DMPF-RETURN-CODE = 'E1'
 11393        MOVE ER-8070               TO WS-ERROR
 11394        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11395        GO TO 3024-EDIT-DL01-CONT.
 11396
 11397     IF DMPF-RETURN-CODE = 'N1'
 11398        MOVE ER-8071               TO WS-ERROR
 11399        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11400        GO TO 3024-EDIT-DL01-CONT.
 11401
 11402     IF DMPF-RETURN-CODE NOT = 'OK'
 11403        MOVE ER-8072               TO WS-ERROR
 11404        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11405
 11406 3024-EDIT-DL01-CONT.
 11407******************************************************************
 11408***  VALIDATES RATE CODES : DLO017                             ***
 11409******************************************************************
 11410
 11411      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11412      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11413      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11414      IF DVRC-SUCCESSFUL-EDIT
 11415        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11416        GO TO 3024-CHECK-VALID-RATE.
 11417
 11418      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11419
 11420      IF DVRC-RETURN-CODE EQUAL '01'
 11421         MOVE ER-7817                   TO WS-ERROR
 11422         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11423         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 210
* EL050.cbl
 11424
 11425      IF DVRC-RETURN-CODE EQUAL '02'
 11426         MOVE ER-7818                   TO WS-ERROR
 11427         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11428         GO TO 3025-EDIT-REINSURANCE.
 11429
 11430      IF DVRC-RETURN-CODE EQUAL '03'
 11431         MOVE ER-7819                   TO WS-ERROR
 11432         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11433         GO TO 3025-EDIT-REINSURANCE.
 11434
 11435       MOVE ER-7820                     TO WS-ERROR.
 11436       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11437       GO TO 3025-EDIT-REINSURANCE.
 11438
 11439******************************************************************
 11440***  GET PREMIUM RATES : DLO011                                ***
 11441******************************************************************
 11442
 11443 3024-CHECK-VALID-RATE.
 11444
 11445     IF VALID-RATE-CODE
 11446        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11447        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11448        MOVE SPACES                TO DPRB-RETURN-CODE
 11449        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11450     ELSE
 11451         GO TO 3025-EDIT-REINSURANCE.
 11452
 11453      IF DPRB-SUCCESSFUL-PROCESS
 11454         IF PB-VALID-LIFE
 11455             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11456             GO TO 3025-EDIT-REINSURANCE
 11457         ELSE
 11458             IF PB-VALID-AH
 11459                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11460                 GO TO 3025-EDIT-REINSURANCE.
 11461
 11462      IF DPRB-RETURN-CODE EQUAL '01'
 11463         MOVE ER-7812                   TO WS-ERROR
 11464         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11465         GO TO 3025-EDIT-REINSURANCE.
 11466
 11467      IF DPRB-RETURN-CODE EQUAL '02'
 11468         MOVE ER-7813                   TO WS-ERROR
 11469         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11470         GO TO 3025-EDIT-REINSURANCE.
 11471
 11472      IF DPRB-RETURN-CODE EQUAL '03'
 11473         MOVE ER-7814                   TO WS-ERROR
 11474         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11475         GO TO 3025-EDIT-REINSURANCE.
 11476
 11477      IF DPRB-RETURN-CODE EQUAL '04'
 11478         IF NOT DPRB-1ST-TIME
 11479            MOVE ER-7815                   TO WS-ERROR
 11480            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11481            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 211
* EL050.cbl
 11482          ELSE
 11483         IF PB-VALID-LIFE
 11484            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11485          ELSE
 11486            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11487         END-IF
 11488         MOVE SPACES                TO DOCC-RETURN-CODE
 11489         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11490         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11491         IF DOCC-RETURN-CODE = 'OK'
 11492             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11493             GO TO 3024-CHECK-VALID-RATE
 11494           ELSE
 11495             MOVE ER-7823               TO WS-ERROR
 11496             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11497             GO TO 3025-EDIT-REINSURANCE.
 11498
 11499       MOVE ER-7816                     TO WS-ERROR.
 11500       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11501       GO TO 3025-EDIT-REINSURANCE.
 11502
 11503**********   DMD CUSTOM CODE ABOVE    **********
 11504
 11505 3025-EDIT-REINSURANCE.
 11506     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11507         GO TO 3027-EDIT-CONTINUE.
 11508
 11509     MOVE LOW-VALUES               TO ERREIN-KEY.
 11510     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11511     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11512                                      REIN-CODE-2
 11513                                      REIN-CODE-3.
 11514     MOVE 'A'                      TO REIN-TYPE.
 11515
 11516     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11517
 11518     MOVE '3026' TO REIN-SW.
 11519     MOVE ' '                   TO WS-REIN-READ-SW.
 11520
 11521     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11522     IF REIN-TABLE-NOT-FOUND
 11523         GO TO 3026-NO-SPEC-TABLE.
 11524
 11525     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11526     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11527                                   WS-NSP-ST-CD-LF.
 11528     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11529                                   WS-NSP-ST-CD-AH.
 11530
 11531     GO TO 3040-EDIT-CONTINUE.
 11532
 11533 3026-NO-SPEC-TABLE.
 11534
 11535     MOVE ER-2664                TO WS-ERROR.
 11536     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11537     GO TO 3040-EDIT-CONTINUE.
 11538
 11539 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 212
* EL050.cbl
 11540
 11541     IF PB-I-REIN-TABLE = SPACES
 11542       GO TO 3040-EDIT-CONTINUE.
 11543
 11544     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11545          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11546          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11547           GO TO 3040-EDIT-CONTINUE.
 11548
 11549     MOVE LOW-VALUES            TO ERREIN-KEY.
 11550     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11551     MOVE 'A'                   TO REIN-TYPE.
 11552     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11553
 11554     MOVE '3028'                TO REIN-SW.
 11555     MOVE ' '                   TO WS-REIN-READ-SW.
 11556
 11557     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11558     IF REIN-TABLE-NOT-FOUND
 11559         GO TO 3028-NO-REIN-TABLE.
 11560
 11561     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11562     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11563                                   WS-NSP-ST-CD-LF.
 11564     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11565                                   WS-NSP-ST-CD-AH.
 11566
 11567     GO TO 3040-EDIT-CONTINUE.
 11568
 11569 3028-NO-REIN-TABLE.
 11570
 11571     MOVE ER-2615                TO WS-ERROR.
 11572     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11573     GO TO 3040-EDIT-CONTINUE.
 11574
 11575 3040-EDIT-CONTINUE.
 11576
 11577     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11578         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11579
 11580     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11581         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11582
 11583     IF (NOT PB-REISSUED-CERT)
 11584        AND (NOT PB-MONTHLY-CERT)
 11585        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11586            MOVE '001'           TO PB-I-LF-TERM
 11587            MOVE 'M'             TO PB-I-INSURED-SEX.
 11588
 11589     IF (NOT PB-REISSUED-CERT)
 11590        AND (NOT PB-MONTHLY-CERT)
 11591        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11592            MOVE '001'           TO PB-I-AH-TERM
 11593            MOVE 'M'             TO PB-I-INSURED-SEX.
 11594
 11595 3040-EDIT-1ST-PMT-DT.
 11596     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11597     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 213
* EL050.cbl
 11598         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11599
 11600******************************************************************
 11601*                                                                *
 11602*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11603*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11604*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11605*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11606*                                                                *
 11607******************************************************************
 11608
 11609     IF PB-EFF-DT-PROCESSING
 11610        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11611                                    PB-I-LF-EXPIRE-DT
 11612                                    PB-I-AH-EXPIRE-DT
 11613        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11614        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11615        MOVE ZERO                TO DC-ELAPSED-DAYS
 11616        MOVE +1                  TO DC-ELAPSED-MONTHS
 11617        SET BIN-PLUS-ELAPSED     TO TRUE
 11618*       MOVE 6                   TO DC-OPTION-CODE
 11619        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11620        IF NO-CONVERSION-ERROR
 11621           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11622
 11623******************************************************************
 11624*                                                                *
 11625*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11626*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11627*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11628*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11629*                                                                *
 11630******************************************************************
 11631
 11632     IF PB-EXT-DAYS-PROCESSING
 11633          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11634                                         PB-I-LF-EXPIRE-DT
 11635                                         PB-I-AH-EXPIRE-DT
 11636          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11637          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11638          MOVE +1                     TO DC-ELAPSED-MONTHS
 11639          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11640          SET BIN-PLUS-ELAPSED        TO TRUE
 11641*         MOVE 6                      TO DC-OPTION-CODE
 11642          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11643          IF NO-CONVERSION-ERROR
 11644             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11645
 11646******************************************************************
 11647*                                                                *
 11648*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11649*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11650*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11651*        (EXPIRE DATE - (TERM -1))  *  -1.
 11652*                                                                *
 11653******************************************************************
 11654
 11655     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 214
* EL050.cbl
 11656        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11657           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11658              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11659              MOVE PB-I-AH-TERM      TO WS-TERM
 11660           ELSE
 11661              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11662              MOVE PB-I-LF-TERM      TO WS-TERM
 11663        ELSE
 11664           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11665              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11666              MOVE PB-I-LF-TERM      TO WS-TERM
 11667           ELSE
 11668              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11669              MOVE PB-I-AH-TERM      TO WS-TERM.
 11670
 11671     IF PB-EXPIRE-DT-PROCESSING
 11672        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11673        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11674        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11675        MOVE ZERO                TO DC-ELAPSED-DAYS
 11676                                    DC-ODD-DAYS-OVER
 11677          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11678          SET BIN-PLUS-ELAPSED    TO TRUE
 11679*         MOVE 6                  TO DC-OPTION-CODE
 11680          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11681          IF NO-CONVERSION-ERROR
 11682             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11683
 11684******************************************************************
 11685*                                                                *
 11686*            1ST PAYMENT DATE PROCESSING                         *
 11687*                                                                *
 11688******************************************************************
 11689
 11690     IF PB-1ST-PMT-DT-PROCESSING
 11691        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11692                                    PB-I-AH-EXPIRE-DT
 11693        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11694
 11695     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11696         NEXT SENTENCE
 11697     ELSE
 11698         MOVE ER-2680                 TO WS-ERROR
 11699         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11700         GO TO 3060-ORIG-TERM-CHECK.
 11701
 11702     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11703     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11704     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11705*    MOVE 1                      TO DC-OPTION-CODE.
 11706     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11707                                    DC-ELAPSED-DAYS
 11708                                    DC-ODD-DAYS-OVER.
 11709
 11710     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11711
 11712     IF DATE-CONVERSION-ERROR
 11713        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 215
* EL050.cbl
 11714
 11715     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11716     IF (PB-COMPANY-ID = 'CID')
 11717        AND (WS-LF-COVERAGE-TYPE = 'L')
 11718        IF (DC-ELAPSED-MONTHS > 1)
 11719                      OR
 11720           ((DC-ELAPSED-MONTHS = 1)
 11721           AND (DC-ODD-DAYS-OVER > 0))
 11722           MOVE ER-2882          TO WS-ERROR
 11723           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11724        END-IF
 11725     END-IF
 11726     IF PB-EXT-DAYS-PROCESSING
 11727        CONTINUE
 11728     ELSE
 11729        IF DC-ELAPSED-MONTHS = +0
 11730           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11731        ELSE
 11732           IF (WS-LF-EARNINGS-CALC = '4')
 11733              AND (DC-ELAPSED-MONTHS > ZERO)
 11734              AND (DC-ELAPSED-DAYS > ZERO)
 11735              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11736           ELSE
 11737              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11738                                 THRU 6499-EXIT
 11739              MOVE WS-ODD-DAYS-OVER
 11740                                 TO PB-I-EXTENTION-DAYS
 11741           END-IF
 11742        END-IF
 11743     END-IF
 11744******************************************************************
 11745*                                                                *
 11746*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11747*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11748*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11749*            AND ANY ODD DAYS.                                   *
 11750*                                                                *
 11751******************************************************************
 11752
 11753     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11754                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11755     IF WS-LF-EARNINGS-CALC NOT = '4'
 11756        IF DC-ELAPSED-DAYS > ZEROS
 11757           MOVE ER-2681          TO WS-ERROR
 11758           PERFORM 9900-ERROR-FORMAT
 11759                                 THRU 9900-EXIT
 11760        END-IF
 11761     END-IF
 11762
 11763     IF WS-LF-EARNINGS-CALC NOT = '4'
 11764        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11765           MOVE ER-2681          TO WS-ERROR
 11766           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11767
 11768     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11769        (PB-I-LF-TERM NOT = ZERO) AND
 11770         NOT NO-LIFE-COVERAGE
 11771          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 216
* EL050.cbl
 11772          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11773          IF WS-LF-EARNINGS-CALC = '4'
 11774             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 11775             PB-I-PAY-FREQUENCY
 11776          END-IF
 11777          MOVE ZERO              TO DC-ELAPSED-DAYS
 11778                                    DC-ODD-DAYS-OVER
 11779          MOVE 1                 TO DC-END-OF-MONTH
 11780          SET BIN-PLUS-ELAPSED        TO TRUE
 11781*         MOVE 6                 TO DC-OPTION-CODE
 11782          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11783          IF NO-CONVERSION-ERROR
 11784             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 11785             IF (WS-LF-EARNINGS-CALC = 'B') AND
 11786                (WS-LF-SPECIAL-CALC-CD = 'L')
 11787                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 11788                  MOVE ZERO           TO DC-ELAPSED-DAYS
 11789                  MOVE +1             TO DC-ELAPSED-MONTHS
 11790                  SET BIN-PLUS-ELAPSED  TO TRUE
 11791*                 MOVE 6              TO DC-OPTION-CODE
 11792                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11793                  IF NO-CONVERSION-ERROR
 11794                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 11795
 11796* okay, i had to move the new att age edit down here because the
 11797* expiration date could get recalculated and i need the exp date
 11798     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 11799        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 11800        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 11801        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11802           AND ZEROS
 11803           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11804           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11805           SET ELAPSED-BETWEEN-BIN TO TRUE
 11806           PERFORM 8500-DATE-CONVERT
 11807                                 THRU 8500-EXIT
 11808           IF NO-CONVERSION-ERROR
 11809              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11810                 MOVE ER-2669       TO WS-ERROR
 11811*                PERFORM 9900-ERROR-FORMAT
 11812*                                THRU 9900-EXIT
 11813              END-IF
 11814           END-IF
 11815        ELSE
 11816           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 11817           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11818              MOVE ER-2669       TO WS-ERROR
 11819*             PERFORM 9900-ERROR-FORMAT
 11820*                                THRU 9900-EXIT
 11821           ELSE
 11822              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11823                 MOVE ER-1570    TO WS-ERROR
 11824                 PERFORM 9900-ERROR-FORMAT
 11825                                 THRU 9900-EXIT
 11826              END-IF
 11827           END-IF
 11828        END-IF
 11829        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 217
* EL050.cbl
 11830           AND ZEROS
 11831           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11832           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11833           SET ELAPSED-BETWEEN-BIN TO TRUE
 11834           PERFORM 8500-DATE-CONVERT
 11835                                 THRU 8500-EXIT
 11836           IF NO-CONVERSION-ERROR
 11837              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11838                 MOVE ER-2669       TO WS-ERROR
 11839*                PERFORM 9900-ERROR-FORMAT
 11840*                                THRU 9900-EXIT
 11841              END-IF
 11842           END-IF
 11843        ELSE
 11844           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 11845             (PB-I-LF-TERM / 12)
 11846           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11847              MOVE ER-2669       TO WS-ERROR
 11848*             PERFORM 9900-ERROR-FORMAT
 11849*                                THRU 9900-EXIT
 11850           ELSE
 11851              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11852                 MOVE ER-1571    TO WS-ERROR
 11853                 PERFORM 9900-ERROR-FORMAT
 11854                                 THRU 9900-EXIT
 11855              END-IF
 11856           END-IF
 11857        END-IF
 11858        IF WS-ERROR = ER-2669
 11859           PERFORM 9900-ERROR-FORMAT
 11860                                 THRU 9900-EXIT
 11861        END-IF
 11862     END-IF
 11863     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 11864        (PB-I-AH-TERM NOT = ZERO) AND
 11865         NOT NO-AH-COVERAGE
 11866          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 11867             AND (PB-COMPANY-ID = 'DCC')
 11868             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11869             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 11870          ELSE
 11871             IF WS-LF-EARNINGS-CALC = '4'
 11872                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 11873                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 11874                PB-I-PAY-FREQUENCY
 11875             ELSE
 11876                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 11877                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 11878             END-IF
 11879          END-IF
 11880          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11881                                         DC-ODD-DAYS-OVER
 11882          MOVE 1                      TO DC-END-OF-MONTH
 11883          SET BIN-PLUS-ELAPSED        TO TRUE
 11884*         MOVE 6                      TO DC-OPTION-CODE
 11885          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11886          IF NO-CONVERSION-ERROR
 11887             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 218
* EL050.cbl
 11888     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 11889        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 11890        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 11891        IF PB-I-BIRTHDAY > LOW-VALUES
 11892           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11893           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11894           SET ELAPSED-BETWEEN-BIN TO TRUE
 11895           PERFORM 8500-DATE-CONVERT
 11896                                 THRU 8500-EXIT
 11897           IF NO-CONVERSION-ERROR
 11898              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11899                 MOVE ER-3054       TO WS-ERROR
 11900*                PERFORM 9900-ERROR-FORMAT
 11901*                                THRU 9900-EXIT
 11902              END-IF
 11903           END-IF
 11904        ELSE
 11905           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 11906           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 11907              MOVE ER-3054       TO WS-ERROR
 11908*             PERFORM 9900-ERROR-FORMAT
 11909*                                THRU 9900-EXIT
 11910           END-IF
 11911        END-IF
 11912        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11913           AND ZEROS
 11914           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11915           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11916           SET ELAPSED-BETWEEN-BIN TO TRUE
 11917           PERFORM 8500-DATE-CONVERT
 11918                                 THRU 8500-EXIT
 11919           IF NO-CONVERSION-ERROR
 11920              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11921                 MOVE ER-3054       TO WS-ERROR
 11922*                PERFORM 9900-ERROR-FORMAT
 11923*                                THRU 9900-EXIT
 11924              END-IF
 11925           END-IF
 11926        ELSE
 11927           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 11928             (PB-I-AH-TERM / 12)
 11929           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 11930              MOVE ER-3054       TO WS-ERROR
 11931*             PERFORM 9900-ERROR-FORMAT
 11932*                                THRU 9900-EXIT
 11933           END-IF
 11934        END-IF
 11935        IF WS-ERROR = ER-3054
 11936           PERFORM 9900-ERROR-FORMAT
 11937                                 THRU 9900-EXIT
 11938        END-IF
 11939     END-IF
 11940     MOVE SPACE                       TO DC-END-OF-MONTH.
 11941
 11942     IF PB-COMPANY-ID = 'NCB'
 11943        GO TO 3040-EDIT-EXTENSION-DAYS.
 11944
 11945     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 219
* EL050.cbl
 11946       AND
 11947        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 11948        NEXT SENTENCE
 11949     ELSE
 11950        GO TO 3040-EDIT-EXTENSION-DAYS.
 11951
 11952     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 11953        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 11954        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 11955     ELSE
 11956        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 11957        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 11958
 11959     SET ELAPSED-BETWEEN-BIN TO TRUE.
 11960*    MOVE '1'      TO DC-OPTION-CODE
 11961     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11962     IF (NO-CONVERSION-ERROR)
 11963        AND (DC-ELAPSED-MONTHS > +1)
 11964        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 11965        MOVE ER-2668   TO WS-ERROR
 11966        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11967
 11968 3040-EDIT-EXTENSION-DAYS.
 11969
 11970     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 11971        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 11972         GO TO 3050-EDIT-TERM-IN-DAYS
 11973     ELSE
 11974         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 11975
 11976     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 11977         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 11978     ELSE
 11979        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 11980           AND (WS-LF-EARNINGS-CALC NOT = '4')
 11981           MOVE ER-2681         TO WS-ERROR
 11982           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11983
 11984     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 11985        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 11986        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 11987         GO TO 3060-ORIG-TERM-CHECK.
 11988
 11989     GO TO 3060-ORIG-TERM-CHECK.
 11990
 11991 3050-EDIT-TERM-IN-DAYS.
 11992
 11993     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 11994
 11995     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 11996         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 11997     ELSE
 11998         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 11999            MOVE ER-2682         TO WS-ERROR
 12000            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12001
 12002     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12003                                       REMAINDER WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 220
* EL050.cbl
 12004     IF WS-WORK-TERM GREATER THAN ZERO
 12005         ADD +1 TO PB-I-LF-TERM.
 12006
 12007     IF NOT NO-AH-COVERAGE
 12008         MOVE ER-2684            TO WS-ERROR
 12009         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12010
 12011
 12012 3060-ORIG-TERM-CHECK.
 12013
 12014******************************************************************
 12015*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12016******************************************************************
 12017
 12018     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12019        NEXT SENTENCE
 12020     ELSE
 12021        IF NOT NO-LIFE-COVERAGE
 12022           IF PB-I-LF-TERM NUMERIC
 12023              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12024              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12025              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12026                  NEXT SENTENCE
 12027           ELSE
 12028              MOVE ER-2647       TO WS-ERROR
 12029              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12030
 12031     IF NOT NO-AH-COVERAGE
 12032         IF PB-I-AH-TERM NUMERIC
 12033            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12034            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12035            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12036             NEXT SENTENCE
 12037          ELSE
 12038              MOVE ER-2658       TO WS-ERROR
 12039              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12040
 12041     IF PB-COMPANY-ID = 'NCB'
 12042        GO TO 3070-LOAN-TERM-CHECK.
 12043
 12044     IF POLICY-HAS-AH
 12045       AND
 12046        POLICY-HAS-LIFE
 12047       AND
 12048        PB-I-LF-TERM NUMERIC
 12049       AND
 12050        PB-I-AH-TERM NUMERIC
 12051        NEXT SENTENCE
 12052     ELSE
 12053        GO TO 3070-LOAN-TERM-CHECK.
 12054
 12055     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12056     IF WS-TEX-FACT-2 LESS THAN +0
 12057        MULTIPLY +1 BY WS-TEX-FACT-2.
 12058
 12059     IF WS-TEX-FACT-2 GREATER THAN +1
 12060        MOVE ER-2668             TO WS-ERROR
 12061        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 221
* EL050.cbl
 12062
 12063 3070-LOAN-TERM-CHECK.
 12064
 12065     IF (WS-LF-BENEFIT-CD = ZERO)
 12066         OR (NO-LF-BENEFIT-MATCH)
 12067            GO TO 3125-EDIT-PMT-FREQ.
 12068
 12069     IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U' AND 'V' AND
 12070                                     'W' AND 'X'
 12071         GO TO 3125-EDIT-PMT-FREQ.
 12072
 12073     IF PB-I-LOAN-TERM NOT NUMERIC
 12074         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12075
 12076     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12077        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12078        PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12079        PB-I-LOAN-TERM NOT GREATER THAN +360
 12080         NEXT SENTENCE
 12081     ELSE
 12082         MOVE ER-2648            TO WS-ERROR
 12083         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12084
 12085     IF WS-STATE-ABBREVIATION = 'NC'
 12086        IF PB-I-LOAN-TERM > +59
 12087           CONTINUE
 12088        ELSE
 12089           MOVE ER-2792          TO WS-ERROR
 12090           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12091        END-IF
 12092     END-IF
 12093
 12094     .
 12095 3125-EDIT-PMT-FREQ.
 12096     IF (WS-LF-BENEFIT-CD = ZERO)
 12097         OR (NO-LF-BENEFIT-MATCH)
 12098            GO TO 3127-EDIT-LOAN-OFFICER.
 12099     IF WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 12100        CONTINUE
 12101     ELSE
 12102        IF (PB-I-LOAN-TERM > ZEROS)
 12103           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12104           MOVE ER-1575          TO WS-ERROR
 12105           PERFORM 9900-ERROR-FORMAT
 12106                                 THRU 9900-EXIT
 12107        END-IF
 12108     END-IF
 12109     IF WS-LF-EARNINGS-CALC NOT = '4'
 12110         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12111            MOVE ER-2653         TO WS-ERROR
 12112            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12113            GO TO 3127-EDIT-LOAN-OFFICER
 12114         ELSE
 12115            GO TO 3127-EDIT-LOAN-OFFICER.
 12116
 12117     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12118         MOVE ER-2655            TO WS-ERROR
 12119         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 222
* EL050.cbl
 12120         GO TO 3127-EDIT-LOAN-OFFICER.
 12121
 12122     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12123         MOVE ER-2654            TO WS-ERROR
 12124         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12125         GO TO 3127-EDIT-LOAN-OFFICER.
 12126
 12127     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12128         GIVING WS-TEX-FACT-2
 12129             REMAINDER WS-TEX-FACT-3.
 12130
 12131*    IF WS-TEX-FACT-3 NOT = ZERO
 12132*       MOVE ER-2654             TO WS-ERROR
 12133*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12134
 12135
 12136 3127-EDIT-LOAN-OFFICER.
 12137
 12138     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12139        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12140           MOVE ER-2690          TO WS-ERROR
 12141           PERFORM 9900-ERROR-FORMAT
 12142                                 THRU 9900-EXIT
 12143        ELSE
 12144           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12145           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12146           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12147           MOVE PB-SV-STATE      TO LOFC-STATE
 12148           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 12149           MOVE PB-I-LOAN-OFFICER
 12150                                 TO LOFC-CODE
 12151           PERFORM 8586-READ-LOAN-OFFICER
 12152                                 THRU 8586-EXIT
 12153           IF (NOT LOFC-MASTER-FOUND)
 12154              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12155              MOVE ER-3006       TO WS-ERROR
 12156              PERFORM 9900-ERROR-FORMAT
 12157                                 THRU 9900-EXIT
 12158           END-IF
 12159        END-IF
 12160     END-IF
 12161     .
 12162 3129-EDIT-APR.
 12163
 12164     IF (WS-LF-BENEFIT-CD = ZERO)
 12165        OR (NO-LF-BENEFIT-MATCH)
 12166        IF PB-COMPANY-ID NOT = 'DCC'
 12167           GO TO 3130-EDIT-AGE
 12168*       ELSE
 12169*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12170*             GO TO 3130-EDIT-AGE
 12171*          END-IF
 12172        END-IF
 12173     END-IF
 12174
 12175     IF (WS-STATE-ABBREVIATION = 'OH')
 12176         AND (PB-I-RATE-CLASS NOT = 'L ')
 12177         AND (PB-I-LF-TERM GREATER THAN 60)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 223
* EL050.cbl
 12178         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12179         GO TO 3129-APR-CONT.
 12180
 12181     IF (WS-STATE-ABBREVIATION = 'RI')
 12182         AND (PB-I-LF-TERM GREATER THAN 60)
 12183         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12184         GO TO 3129-APR-CONT.
 12185
 12186     IF (WS-STATE-ABBREVIATION = 'UT')
 12187         AND (PB-I-LF-TERM GREATER THAN 62)
 12188         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12189         AND (PB-CERT-EFF-DT LESS WS-830901)
 12190         GO TO 3129-APR-CONT.
 12191
 12192     IF PB-COMPANY-ID = 'LAP'
 12193        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12194           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12195              MOVE ER-2656         TO WS-ERROR
 12196              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12197              GO TO 3130-EDIT-AGE.
 12198
 12199     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12200        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12201        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12202        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12203         GO TO 3130-EDIT-AGE.
 12204
 12205 3129-APR-CONT.
 12206     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12207         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12208         GO TO 3130-EDIT-AGE.
 12209
 12210     IF (WS-LF-BENEFIT-CD (1:1) = 'S')
 12211        AND (PB-COMPANY-ID = 'DCC')
 12212        AND (PB-I-LOAN-APR = ZERO)
 12213        MOVE ER-2657             TO WS-ERROR
 12214        PERFORM 9900-ERROR-FORMAT
 12215                                 THRU 9900-EXIT
 12216        GO TO 3130-EDIT-AGE
 12217     END-IF
 12218     IF PB-I-LOAN-APR = ZERO
 12219        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12220     END-IF
 12221
 12222     IF PB-I-LOAN-APR = ZERO
 12223        MOVE ER-2656             TO WS-ERROR
 12224        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12225        GO TO 3130-EDIT-AGE.
 12226
 12227*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12228     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12229        MOVE ER-2657             TO WS-ERROR
 12230        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12231
 12232 3130-EDIT-AGE.
 12233
 12234******************************************************************
 12235*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 224
* EL050.cbl
 12236******************************************************************
 12237
 12238     IF NOT NO-LIFE-COVERAGE
 12239        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12240           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12241               MOVE ER-2628             TO WS-ERROR
 12242               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12243
 12244     IF NOT NO-AH-COVERAGE
 12245        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12246           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12247               MOVE ER-2628         TO WS-ERROR
 12248               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12249
 12250 3133-SEX-CODE.
 12251     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12252         IF WS-DEFAULT-SEX = 'M'
 12253             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12254          ELSE
 12255             IF WS-DEFAULT-SEX = 'F'
 12256             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12257
 12258     IF PB-I-INSURED-SEX = '1'
 12259         MOVE 'M' TO PB-I-INSURED-SEX.
 12260
 12261     IF PB-I-INSURED-SEX = '2'
 12262         MOVE 'F' TO PB-I-INSURED-SEX.
 12263
 12264 3134-SIG-SW-EDIT.
 12265     IF PB-I-SIG-SW = SPACE
 12266         MOVE 'N'                TO  PB-I-SIG-SW.
 12267
 12268     IF PB-COMPANY-ID = 'NCL'
 12269         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12270             NEXT SENTENCE
 12271         ELSE
 12272             MOVE ER-1923        TO  WS-ERROR
 12273             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12274     ELSE
 12275     IF PB-COMPANY-ID = 'CRI'
 12276         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12277             NEXT SENTENCE
 12278         ELSE
 12279             MOVE ER-2606        TO  WS-ERROR
 12280             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12281     ELSE
 12282     IF PB-COMPANY-ID = 'TMS'
 12283         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12284             NEXT SENTENCE
 12285         ELSE
 12286             MOVE ER-2689        TO  WS-ERROR
 12287             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12288     ELSE
 12289         IF PB-I-SIG-SW = 'Y' OR 'N'
 12290             NEXT SENTENCE
 12291         ELSE
 12292             MOVE ER-2651        TO  WS-ERROR
 12293             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 225
* EL050.cbl
 12294
 12295     IF PB-COMPANY-ID = 'FLA'
 12296         IF (WS-EDIT-AGE GREATER 54  OR
 12297             WS-AH-EDIT-AGE GREATER 54)  AND
 12298            PB-I-SIG-SW = 'N'
 12299            MOVE ER-2651         TO  WS-ERROR
 12300            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12301
 12302 3135-NAME-EDIT.
 12303
 12304     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12305        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12306        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12307           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12308                                 TO PB-I-JOINT-FIRST-NAME
 12309        END-PERFORM
 12310     END-IF
 12311     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12312        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12313        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12314           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12315                                 TO PB-I-JOINT-LAST-NAME
 12316        END-PERFORM
 12317     END-IF
 12318     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12319        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12320        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12321           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12322                                 TO PB-I-INSURED-FIRST-NAME
 12323        END-PERFORM
 12324     END-IF
 12325     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12326        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12327        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12328           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12329                                 TO PB-I-INSURED-LAST-NAME
 12330        END-PERFORM
 12331     END-IF
 12332     IF PB-I-INSURED-LAST-NAME = SPACES
 12333       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12334       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12335           MOVE ER-2660    TO WS-ERROR
 12336           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12337
 12338 3136-EDIT-SEX.
 12339
 12340******************************************************************
 12341*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12342******************************************************************
 12343
 12344     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12345        (WS-AH-SPECIAL-CALC-CD = 'O')
 12346        NEXT SENTENCE
 12347     ELSE
 12348        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12349           NEXT SENTENCE
 12350        ELSE
 12351           MOVE ER-2629            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 226
* EL050.cbl
 12352           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12353
 12354 3137-EDIT-EFF-DATE.
 12355
 12356     IF PB-REISSUED-CERT       OR
 12357        PB-POLICY-IS-DECLINED  OR
 12358        PB-POLICY-IS-VOIDED
 12359         GO TO 3139-EDIT-COVERAGE-CODES.
 12360
 12361     MOVE SPACE                  TO WS-2671-SW
 12362                                    WS-2672-SW.
 12363
 12364     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12365         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12366             MOVE ER-2703        TO WS-ERROR
 12367             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12368             GO TO 3139-EDIT-COVERAGE-CODES.
 12369
 12370     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12371         GO TO 3139-EDIT-COVERAGE-CODES.
 12372
 12373     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12374     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12375*    MOVE '1'                    TO DC-OPTION-CODE.
 12376     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12377     MOVE +0                     TO DC-ELAPSED-MONTHS
 12378                                    DC-ELAPSED-DAYS.
 12379     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12380
 12381     IF DATE-CONVERSION-ERROR
 12382         GO TO 3139-EDIT-COVERAGE-CODES.
 12383
 12384     IF DC-ELAPSED-DAYS GREATER +180
 12385         MOVE ER-2672            TO WS-ERROR
 12386         MOVE 'Y'                TO WS-2672-SW
 12387         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12388     END-IF
 12389
 12390     IF WS-ERROR = ER-2671  AND
 12391        PB-COMPANY-ID  = 'LBL'
 12392        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12393        MOVE SPACE               TO WS-2671-SW
 12394        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12395
 12396     IF PB-ISSUE-DATE-FORCED  AND
 12397      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12398         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12399         MOVE ER-2673            TO WS-ERROR
 12400         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12401         MOVE SPACE              TO WS-2671-SW
 12402                                    WS-2672-SW.
 12403
 12404     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12405         IF PB-ISSUE-DATE-FORCED
 12406             MOVE ER-2600          TO  WS-ERROR
 12407             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12408         ELSE
 12409             MOVE ER-2692          TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 227
* EL050.cbl
 12410             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12411
 12412
 12413 3139-EDIT-COVERAGE-CODES.
 12414
 12415     IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12416        PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12417        MOVE ER-2787             TO WS-ERROR
 12418        PERFORM 9900-ERROR-FORMAT
 12419                                 THRU 9900-EXIT
 12420     END-IF
 12421     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12422        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12423                                 > 250000.00
 12424           MOVE ER-2719          TO WS-ERROR
 12425           PERFORM 9900-ERROR-FORMAT
 12426                                 THRU 9900-EXIT
 12427        END-IF
 12428     END-IF
 12429
 12430     IF PB-POLICY-IS-DECLINED  OR
 12431        PB-POLICY-IS-VOIDED
 12432         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12433
 12434     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12435        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12436         MOVE ER-2630                TO WS-ERROR
 12437         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12438
 12439     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12440        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12441        PB-I-LF-PREMIUM-AMT = ZERO
 12442         GO TO 3140-CHECK-AH-FOR-ZERO.
 12443
 12444     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12445        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12446        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12447         GO TO 3140-CHECK-AH-FOR-ZERO.
 12448
 12449     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12450        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12451        MOVE ER-2631             TO WS-ERROR
 12452        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12453     END-IF
 12454
 12455
 12456******************************************************************
 12457*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12458******************************************************************
 12459
 12460     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12461        NEXT SENTENCE
 12462     ELSE
 12463        IF PB-I-LF-BENEFIT-AMT = ZERO
 12464           MOVE ER-2632             TO WS-ERROR
 12465           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12466
 12467
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 228
* EL050.cbl
 12468******************************************************************
 12469*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12470******************************************************************
 12471
 12472     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12473        CONTINUE
 12474     ELSE
 12475        IF PB-I-LF-PREMIUM-AMT = ZERO
 12476           IF (NOT PB-COMP-LF-PREM)
 12477              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12478              MOVE ER-2633       TO WS-ERROR
 12479              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12480           END-IF
 12481        END-IF
 12482     END-IF
 12483     .
 12484 3140-CHECK-AH-FOR-ZERO.
 12485
 12486     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12487        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12488        PB-I-AH-PREMIUM-AMT = ZERO
 12489         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12490
 12491     IF PB-COMPANY-ID = 'CSL'  AND
 12492        PB-I-AH-BENEFIT-CD = ZERO  AND
 12493        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12494        PB-I-AH-PREMIUM-AMT = ZERO
 12495         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12496
 12497     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12498        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12499        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12500         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12501
 12502     IF PB-I-AH-BENEFIT-CD = ZERO
 12503         MOVE ER-2634            TO WS-ERROR
 12504         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12505
 12506******************************************************************
 12507*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12508******************************************************************
 12509
 12510     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12511        NEXT SENTENCE
 12512     ELSE
 12513        IF PB-I-AH-BENEFIT-AMT = ZERO
 12514           MOVE ER-2635             TO WS-ERROR
 12515           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12516
 12517******************************************************************
 12518*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12519******************************************************************
 12520
 12521     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12522        NEXT SENTENCE
 12523     ELSE
 12524        IF PB-I-AH-PREMIUM-AMT = ZERO
 12525            IF NOT PB-COMP-AH-PREM
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 229
* EL050.cbl
 12526                MOVE ER-2636    TO WS-ERROR
 12527                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12528
 12529
 12530 3140-EDIT-MAX-AMT-SIZES.
 12531* CUSTOM CODE FOR CLIENT    'DMD'
 12532     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12533                                     WS-RES-MUNI-TAX
 12534                                     PB-I-STATE-TAX
 12535                                     PB-I-MUNI-TAX.
 12536
 12537     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12538
 12539     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12540        GO TO 3150-RATE-OUTSTAND-BAL.
 12541
 12542     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12543        GO TO 3150-RATE-OUTSTAND-BAL.
 12544
 12545     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12546        GO TO 3150-RATE-OUTSTAND-BAL.
 12547
 12548     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12549                             OR 'RIC')
 12550        GO TO 3150-RATE-OUTSTAND-BAL.
 12551
 12552     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12553        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12554            GO TO 3150-RATE-OUTSTAND-BAL
 12555        ELSE
 12556           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12557               GO TO 3150-RATE-OUTSTAND-BAL.
 12558
 12559     IF NOT PB-NO-MONTHS-SKIPPED
 12560        GO TO 3150-RATE-OUTSTAND-BAL.
 12561
 12562     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12563        GO TO 3150-RATE-OUTSTAND-BAL.
 12564
 12565     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12566        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12567           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12568             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12569           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12570           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12571              MOVE ER-2693     TO WS-ERROR
 12572              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12573              GO TO 3150-RATE-OUTSTAND-BAL
 12574           ELSE
 12575              GO TO 3150-RATE-OUTSTAND-BAL.
 12576
 12577 3150-RATE-OUTSTAND-BAL.
 12578
 12579* DMD RATING TEST
 12580     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12581         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12582         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12583         MOVE ER-2687                 TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 230
* EL050.cbl
 12584         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12585         MOVE 'B'                     TO PB-I-OB-FLAG
 12586         GO TO 3260-EDIT-CONTINUE.
 12587
 12588     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12589         IF  WS-ERROR    EQUAL    ER-2693
 12590             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12591                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12592                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12593                 MOVE  +0            TO  WS-ERROR.
 12594
 12595     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12596         IF  WS-ERROR    EQUAL    ER-2693
 12597             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12598                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12599                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12600                 MOVE  +0            TO  WS-ERROR.
 12601
 12602     IF PLAN-MASTER-AH-SW = 'Y'
 12603        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12604            IF  WS-ERROR    EQUAL    ER-2693
 12605              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12606                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12607                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12608                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12609                 MOVE  ER-1910           TO  WS-ERROR
 12610                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12611
 12612     IF PLAN-MASTER-AH-SW = 'Y'
 12613        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12614            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12615               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12616               MOVE  ER-1910           TO  WS-ERROR
 12617               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12618
 12619     IF PLAN-MASTER-AH-SW = 'Y'
 12620        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12621            IF  WS-ERROR    EQUAL    ER-2693
 12622                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12623                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12624                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12625                 MOVE  +0       TO  WS-ERROR.
 12626
 12627     IF WS-ERROR = ER-2693
 12628        IF PB-COMPANY-ID = 'JAL' AND
 12629           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12630           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12631           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12632
 12633     IF WS-ERROR = ER-2693
 12634        IF PB-COMPANY-ID = 'NCL'  AND
 12635           PB-I-AH-BENEFIT-CD = 'OA'
 12636           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12637           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12638
 12639     IF WS-ERROR = ER-2693
 12640        IF PB-COMPANY-ID = 'CNL' AND
 12641           PB-I-LF-BENEFIT-CD = '71' OR '72'
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 231
* EL050.cbl
 12642           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12643           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12644
 12645     IF WS-ERROR = ER-2693
 12646        IF PB-COMPANY-ID = 'HER'
 12647           IF WS-LEVEL
 12648              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12649              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12650
 12651     IF ((LF-BENEFIT-FOUND) AND
 12652         (NOT NO-LIFE-COVERAGE)  AND
 12653         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12654       OR   ((AH-BENEFIT-FOUND) AND
 12655             (NOT NO-AH-COVERAGE)    AND
 12656             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12657         NEXT SENTENCE
 12658     ELSE
 12659         GO TO 3215-EDIT-RATES.
 12660
 12661     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12662        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12663           MOVE ER-2674          TO WS-ERROR
 12664           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12665           GO TO 3215-EDIT-RATES.
 12666
 12667     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12668        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12669           MOVE ER-2674          TO WS-ERROR
 12670           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12671           GO TO 3215-EDIT-RATES.
 12672
 12673     MOVE 'B'                    TO PB-I-OB-FLAG.
 12674
 12675     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12676         NEXT SENTENCE
 12677     ELSE
 12678         IF NOT NO-LIFE-COVERAGE
 12679             IF WS-ACCT-LF-OB-RT = ZERO
 12680                MOVE ER-2641    TO WS-ERROR
 12681                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12682
 12683     IF PB-COMPANY-ID = 'CRI'
 12684       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12685         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12686         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12687         IF WS-ERROR = ER-2675
 12688            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12689            MOVE ER-2687              TO WS-ERROR
 12690            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12691         ELSE
 12692            MOVE ER-2687              TO WS-ERROR
 12693            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12694
 12695
 12696     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12697         NEXT SENTENCE
 12698     ELSE
 12699         IF NOT NO-AH-COVERAGE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 232
* EL050.cbl
 12700             IF WS-ACCT-AH-OB-RT = ZERO
 12701                MOVE ER-2642    TO WS-ERROR
 12702                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12703
 12704     IF PB-COMPANY-ID = 'CRI'
 12705       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12706         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12707         IF WS-ERROR = ER-2676
 12708            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12709            MOVE ER-2687              TO WS-ERROR
 12710            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12711         ELSE
 12712            MOVE ER-2687              TO WS-ERROR
 12713            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12714
 12715     IF PB-COMPANY-ID NOT = 'GIC'
 12716         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12717            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12718     ELSE
 12719         IF PB-I-LF-PREM-CALC = ZEROS
 12720             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12721                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12722
 12723     IF PB-COMPANY-ID NOT = 'GIC'
 12724         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12725            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12726     ELSE
 12727         IF PB-I-AH-PREM-CALC = ZEROS
 12728             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12729                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 12730
 12731     MOVE ZEROS TO PB-I-MORT-CODE.
 12732
 12733     GO TO 3260-EDIT-CONTINUE.
 12734
 12735
 12736 3215-EDIT-RATES.
 12737     IF ACCOUNT-MAST-FOUND
 12738         NEXT SENTENCE
 12739     ELSE
 12740         GO TO 3999-END-EDIT.
 12741
 12742 3220-CHECK-LF-RATES.
 12743
 12744     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 12745                                    PB-I-AH-PREM-CALC
 12746                                    PB-I-LF-ALT-PREM-CALC
 12747                                    PB-I-LF-ALT-RATE
 12748                                    PB-I-LF-REI-RATE
 12749                                    PB-I-LF-ALT-REI-RATE
 12750                                    PB-I-AH-REI-RATE
 12751                                    PB-I-TOT-FEES-CALC.
 12752
 12753     IF PB-COMPANY-ID EQUAL 'DMD'
 12754        NEXT SENTENCE
 12755     ELSE
 12756        MOVE ZEROS               TO PB-I-LF-RATE
 12757                                    PB-I-AH-RATE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 233
* EL050.cbl
 12758
 12759     IF PB-I-TOT-FEES NOT NUMERIC
 12760        MOVE ZEROS               TO PB-I-TOT-FEES
 12761     END-IF
 12762     IF PB-I-LIVES NOT NUMERIC
 12763         MOVE ZERO               TO PB-I-LIVES.
 12764
 12765     IF PB-I-NUM-BILLED NOT NUMERIC
 12766         MOVE ZERO               TO PB-I-NUM-BILLED.
 12767
 12768     IF PB-I-LF-PREM-TAX NOT NUMERIC
 12769        MOVE +0                  TO PB-I-LF-PREM-TAX
 12770     END-IF
 12771
 12772     IF PB-I-AH-PREM-TAX NOT NUMERIC
 12773        MOVE +0                  TO PB-I-AH-PREM-TAX
 12774     END-IF
 12775
 12776     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 12777        PB-I-PAY-FREQUENCY = ZEROS
 12778            MOVE 12 TO CP-PAY-FREQUENCY
 12779     ELSE
 12780            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 12781
 12782     IF PB-I-STATE-TAX NOT NUMERIC
 12783         MOVE ZEROS               TO PB-I-STATE-TAX.
 12784
 12785     IF PB-I-MUNI-TAX NOT NUMERIC
 12786         MOVE ZEROS               TO PB-I-MUNI-TAX.
 12787
 12788     MOVE SPACES                 TO CP-BEN-CATEGORY
 12789     IF PB-COMPANY-ID  = 'CSL'  AND
 12790        PB-I-LF-TERM NOT = ZERO
 12791        COMPUTE WS-PAYMENT-AMT =
 12792             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 12793        COMPUTE WS-CSL-AMT1 =
 12794             PB-I-LF-TERM * AM-MAX-MON-BEN
 12795        COMPUTE WS-CSL-AMT2 =
 12796             WS-PAYMENT-AMT * PB-I-LF-TERM
 12797        IF CP-PAY-FREQUENCY NOT = 12
 12798           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 12799           MOVE '8' TO WS-CSL-CALC-CD
 12800        ELSE
 12801           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 12802              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 12803               AM-MAX-TOT-BEN
 12804               MOVE '6' TO WS-CSL-CALC-CD
 12805           ELSE
 12806              IF (WS-CSL-AMT1  GREATER THAN
 12807                 AM-MAX-TOT-BEN) AND
 12808                 (WS-CSL-AMT2  GREATER THAN
 12809                 AM-MAX-TOT-BEN)
 12810                 MOVE '7' TO WS-CSL-CALC-CD
 12811              ELSE
 12812                 MOVE '5' TO WS-CSL-CALC-CD.
 12813
 12814     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 12815         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 234
* EL050.cbl
 12816     ELSE
 12817         GO TO 3300-CHECK-AH-RATES.
 12818
 12819*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 12820
 12821     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12822        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 12823              OR
 12824           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 12825           MOVE ER-2618          TO WS-ERROR
 12826           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12827           GO TO 3300-CHECK-AH-RATES.
 12828
 12829     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12830           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 12831                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 12832
 12833     IF WS-LF-SPECIAL-CALC-CD = 'M'
 12834         MOVE ER-2687             TO WS-ERROR
 12835         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12836         MOVE 'Z000'              TO PB-I-MORT-CODE
 12837         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 12838         GO TO 3300-CHECK-AH-RATES.
 12839
 12840     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 12841        IF PB-I-LIVES = ZERO
 12842           MOVE ER-2688          TO WS-ERROR
 12843           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12844
 12845     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 12846
 12847     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 12848     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 12849     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 12850     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 12851     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 12852     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 12853     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12854     MOVE '3'                    TO CP-PROCESS-TYPE.
 12855     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 12856     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 12857
 12858******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 12859     IF PB-COMPANY-ID EQUAL 'CDL'
 12860         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 12861            CP-EARN-AS-NET-PAY)
 12862             IF PB-CERT-EFF-DT GREATER  WS-931231
 12863                 MOVE '1'        TO CP-EARNING-METHOD.
 12864*******
 12865
 12866     MOVE PB-SV-STATE            TO CP-STATE.
 12867     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 12868     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 12869     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 12870     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 12871     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 12872                                    CP-RATING-BENEFIT-AMT.
 12873     IF CP-STATE-STD-ABBRV = 'OR'
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 235
* EL050.cbl
 12874         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 12875                                         PB-I-LF-ALT-BENEFIT-AMT.
 12876     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 12877     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 12878     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 12879     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12880     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 12881     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 12882     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 12883     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 12884     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 12885                                    CP-REMAINING-TERM
 12886                                    CP-LOAN-TERM.
 12887
 12888     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 12889         NEXT SENTENCE
 12890     ELSE
 12891         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 12892             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 12893                                           PB-I-LF-PREMIUM-AMT.
 12894
 12895     IF PB-COMPANY-ID EQUAL 'CSL'
 12896        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 12897           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 12898                                         PB-I-LF-PREMIUM-AMT.
 12899
 12900     IF PB-COMPANY-ID EQUAL 'NCB'
 12901         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 12902            CP-EARN-AS-NET-PAY
 12903             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 12904                 PB-I-LF-PREMIUM-AMT.
 12905
 12906     IF CP-TRUNCATED-LIFE
 12907        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 12908
 12909     IF PB-COMPANY-ID EQUAL 'CRI'
 12910        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 12911
 12912     IF CP-TERM-IS-DAYS
 12913         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 12914     ELSE
 12915         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12916     IF PB-COMPANY-ID = 'DCC'
 12917        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 12918        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 12919        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 12920        IF WS-LF-BEN-CATEGORY = 'D'
 12921           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 12922           MOVE PB-I-LIFE-COMMISSION
 12923                                 TO CP-DCC-ACT-COMM
 12924           MOVE WS-LF-BEN-CATEGORY
 12925                                 TO CP-BEN-CATEGORY
 12926        END-IF
 12927        IF (CP-BENEFIT-CD (1:1) = 'P')
 12928           AND (PB-I-LOAN-TERM NOT = ZEROS)
 12929           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 12930        END-IF
 12931     END-IF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 236
* EL050.cbl
 12932     IF PB-COMPANY-ID = 'CSL'
 12933         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 12934         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 12935         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 12936
 12937     IF PB-COMPANY-ID = 'CSL'
 12938        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 12939
 12940     IF (CP-SPECIAL-CALC-CD = 'H')
 12941        OR (PB-COMPANY-ID = 'DCC')
 12942         MOVE PB-I-LF-ALT-BENEFIT-AMT
 12943                                    TO CP-ALTERNATE-BENEFIT
 12944         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 12945
 12946     IF (PB-COMPANY-ID = 'CID')
 12947        AND (WS-LF-EARNINGS-CALC = 'B')
 12948        AND (CP-STATE-STD-ABBRV = 'MN')
 12949        MOVE PB-I-LF-ALT-BENEFIT-AMT
 12950                                 TO CP-ALTERNATE-BENEFIT
 12951        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 12952     END-IF
 12953     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 12954     MOVE 'R'                   TO CP-RATE-FILE.
 12955     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 12956
 12957     IF CP-ERROR-RATE-NOT-FOUND
 12958        MOVE ER-2641            TO WS-ERROR
 12959        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12960        GO TO 3300-CHECK-AH-RATES.
 12961
 12962     IF PB-COMPANY-ID EQUAL 'CRI'
 12963        IF CP-ERROR-NO-LIMITS-CRI
 12964           IF NOT ACCOUNT-LIFE-CHECKED
 12965              MOVE ER-2607      TO WS-ERROR
 12966              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12967
 12968******************************************************************
 12969*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 12970*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 12971******************************************************************
 12972
 12973* CALC LIFE AGE AT EXPIRATION.
 12974
 12975     COMPUTE WS-AGE-AT-EXPIRE =
 12976          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 12977
 12978*    IF PB-STATE = 'CO' OR 'UT'
 12979*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 12980*        MOVE 'F'            TO PB-FATAL-FLAG
 12981*        MOVE ER-2709        TO WS-ERROR
 12982*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12983*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 12984
 12985*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 12986*        MOVE 'X'            TO PB-FATAL-FLAG
 12987*        MOVE ER-2718        TO WS-ERROR
 12988*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12989*        GO TO PREMIUM-EDITING-IS-BYPASSED.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 237
* EL050.cbl
 12990
 12991* CALC A & H AGE AT EXPIRATION.
 12992
 12993     COMPUTE WS-AGE-AT-EXPIRE =
 12994          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 12995
 12996*    IF PB-STATE = 'CO' OR 'UT'
 12997*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 12998*        MOVE 'F'            TO PB-FATAL-FLAG
 12999*        MOVE ER-2709        TO WS-ERROR
 13000*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13001*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13002
 13003*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13004*        MOVE 'X'            TO PB-FATAL-FLAG
 13005*        MOVE ER-2718        TO WS-ERROR
 13006*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13007*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13008
 13009     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13010        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13011
 13012     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13013        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13014
 13015     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13016        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13017
 13018     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13019         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13020         MOVE ER-2639        TO WS-ERROR
 13021         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13022
 13023
 13024******************************************************************
 13025*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13026******************************************************************
 13027
 13028 PREMIUM-EDITING-IS-BYPASSED.
 13029     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13030        AND (CP-R-MAX-ATT-AGE > +0)
 13031        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13032        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13033           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13034           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13035           MOVE '1'              TO DC-OPTION-CODE
 13036           PERFORM 8500-DATE-CONVERT
 13037                                 THRU 8500-EXIT
 13038           IF NO-CONVERSION-ERROR
 13039              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13040                 MOVE ER-2661       TO WS-ERROR
 13041*                PERFORM 9900-ERROR-FORMAT
 13042*                                THRU 9900-EXIT
 13043              END-IF
 13044           END-IF
 13045        ELSE
 13046           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13047           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 238
* EL050.cbl
 13048              MOVE ER-2661       TO WS-ERROR
 13049*             PERFORM 9900-ERROR-FORMAT
 13050*                                THRU 9900-EXIT
 13051           ELSE
 13052              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13053                 MOVE ER-1570    TO WS-ERROR
 13054                 PERFORM 9900-ERROR-FORMAT
 13055                                 THRU 9900-EXIT
 13056              END-IF
 13057           END-IF
 13058        END-IF
 13059        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13060           MOVE PB-I-JOINT-BIRTHDAY
 13061                                 TO DC-BIN-DATE-1
 13062           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13063           MOVE '1'              TO DC-OPTION-CODE
 13064           PERFORM 8500-DATE-CONVERT
 13065                                 THRU 8500-EXIT
 13066           IF NO-CONVERSION-ERROR
 13067              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13068                 MOVE ER-2661       TO WS-ERROR
 13069*                PERFORM 9900-ERROR-FORMAT
 13070*                                THRU 9900-EXIT
 13071              END-IF
 13072           ELSE
 13073              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13074           END-IF
 13075        ELSE
 13076           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13077             (PB-I-LF-TERM / 12)
 13078           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13079              MOVE ER-2661       TO WS-ERROR
 13080*             PERFORM 9900-ERROR-FORMAT
 13081*                                THRU 9900-EXIT
 13082           ELSE
 13083              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13084                 MOVE ER-1571    TO WS-ERROR
 13085                 PERFORM 9900-ERROR-FORMAT
 13086                                 THRU 9900-EXIT
 13087              END-IF
 13088           END-IF
 13089        END-IF
 13090        IF WS-ERROR = ER-2661
 13091           PERFORM 9900-ERROR-FORMAT
 13092                                 THRU 9900-EXIT
 13093        END-IF
 13094     END-IF
 13095*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13096*       MOVE ER-2661             TO WS-ERROR
 13097*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13098
 13099     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13100        MOVE ER-2662             TO WS-ERROR
 13101        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13102
 13103     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13104        MOVE ER-2677             TO WS-ERROR
 13105        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 239
* EL050.cbl
 13106
 13107     IF CP-ERROR-LOAN-TERM
 13108        MOVE ER-2648             TO WS-ERROR
 13109        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13110
 13111 3221-CHECK-ERROR-RATE-OPEN.
 13112
 13113     IF CP-ERROR-RATE-FILE-NOTOPEN
 13114         GO TO 3990-FILES-NOT-OPEN.
 13115
 13116     IF PB-COMPANY-ID NOT = 'DMD'
 13117        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13118     END-IF
 13119     .
 13120 3221-CONTINUE.
 13121     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13122                                    WS-DCC-AH-RATE
 13123     IF PB-COMPANY-ID = 'DCC'
 13124        IF WS-LF-BEN-CATEGORY = 'D'
 13125           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13126              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13127        END-IF
 13128     END-IF
 13129     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13130*   X'A4FF' = 12/31/2009
 13131     IF (PB-COMPANY-ID = 'CID')
 13132        AND (WS-LF-EARNINGS-CALC = 'B')
 13133        AND (CP-STATE-STD-ABBRV = 'MN')
 13134        AND (PB-CERT-EFF-DT > X'A4FF')
 13135        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13136     END-IF
 13137     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13138
 13139     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13140     IF (PB-COMPANY-ID = 'DCC')
 13141        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13142        AND (PB-I-POLICY-IS-MONTHLY)
 13143        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13144        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13145     END-IF
 13146     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13147     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13148     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13149     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13150     IF (PB-COMPANY-ID = 'DCC')
 13151        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13152        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13153        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13154        MOVE ER-2786             TO WS-ERROR
 13155        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13156     END-IF
 13157
 13158     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13159
 13160******************************************************************
 13161*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13162******************************************************************
 13163     IF WS-LF-SPECIAL-CALC-CD = 'E'
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 240
* EL050.cbl
 13164        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13165
 13166     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13167        GO TO 3225-CHECK-ALT-LIFE-RATE
 13168     ELSE
 13169       IF PB-I-LF-RATE = ZERO
 13170          MOVE ER-2641          TO WS-ERROR
 13171          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13172
 13173 3225-CHECK-ALT-LIFE-RATE.
 13174
 13175     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13176        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13177        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13178         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13179
 13180     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13181         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13182             AND PB-COMPANY-ID NOT = 'DCC')
 13183                   OR
 13184              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13185              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13186              AND PB-COMPANY-ID NOT = 'DCC')
 13187             MOVE ER-2720        TO  WS-ERROR
 13188             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13189             GO TO 3225-RATING-CONT
 13190         ELSE
 13191             GO TO 3225-RATING-CONT.
 13192     IF (PB-COMPANY-ID = 'CID')
 13193        AND (AM-GPCD = 01 OR 06 OR 15)
 13194        MOVE ER-2798             TO WS-ERROR
 13195        PERFORM 9900-ERROR-FORMAT
 13196                                 THRU 9900-EXIT
 13197*       GO TO 3225-RATING-CONT
 13198     END-IF
 13199     IF (PB-COMPANY-ID = 'CID')
 13200        AND (WS-LF-EARNINGS-CALC = 'B')
 13201        AND (CP-STATE-STD-ABBRV = 'MN')
 13202        AND (PB-CERT-EFF-DT > X'A4FF')
 13203        GO TO 3225-RATING-CONT
 13204     END-IF
 13205     IF PB-COMPANY-ID = 'DCC'
 13206        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13207           AND (PB-I-POLICY-IS-MONTHLY)
 13208           GO TO 3225-RATING-CONT
 13209        END-IF
 13210     END-IF
 13211
 13212     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13213        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13214        CP-EARN-AS-REG-BALLOON
 13215        NEXT SENTENCE
 13216     ELSE
 13217        MOVE '2'                 TO CP-EARNING-METHOD.
 13218
 13219 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13220
 13221     MOVE 'L'                    TO CP-BENEFIT-TYPE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 241
* EL050.cbl
 13222
 13223     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13224        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13225        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13226         NEXT SENTENCE
 13227     ELSE
 13228         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13229
 13230     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13231     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13232     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13233                                     CP-RATING-BENEFIT-AMT.
 13234     IF CP-STATE-STD-ABBRV = 'OR'
 13235         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13236                                         PB-I-LF-ALT-BENEFIT-AMT.
 13237     IF PB-COMPANY-ID = 'DCC'
 13238        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13239     END-IF
 13240     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13241     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13242     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13243                                    CP-REMAINING-TERM
 13244                                    CP-LOAN-TERM.
 13245     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13246        ADD +1                   TO CP-ORIGINAL-TERM
 13247                                    CP-REMAINING-TERM
 13248                                    CP-LOAN-TERM.
 13249
 13250     MOVE 'R'                   TO CP-RATE-FILE.
 13251     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13252
 13253     IF CP-ERROR-RATE-NOT-FOUND
 13254         MOVE ER-2641            TO WS-ERROR
 13255         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13256         GO TO 3300-CHECK-AH-RATES.
 13257
 13258     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13259     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13260
 13261     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13262         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13263
 13264     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13265                               + PB-I-LF-ALT-BENEFIT-AMT.
 13266
 13267     IF ACCOUNT-LIFE-CHECKED  OR
 13268        PB-POLICY-IS-VOIDED   OR
 13269        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13270        GO TO 3225-CONTINUE.
 13271
 13272     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13273        GO TO 3225-CONTINUE.
 13274
 13275     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13276                             EC-RT-LF-MAX-TOT-BEN
 13277        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13278        MOVE ER-2639       TO WS-ERROR
 13279        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 242
* EL050.cbl
 13280
 13281 3225-CONTINUE.
 13282     IF PB-I-LF-ALT-RATE = ZERO
 13283         MOVE ER-2659            TO WS-ERROR
 13284         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13285
 13286     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13287        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13288        MOVE ER-2698             TO WS-ERROR
 13289        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13290
 13291 3225-RATING-CONT.
 13292
 13293     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13294         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13295         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13296         MOVE ER-2687             TO WS-ERROR
 13297         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13298         GO TO 3290-EDIT-LF-REIN-RATE.
 13299
 13300* DMD RATING TEST
 13301     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13302         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13303         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13304         MOVE ER-2687                 TO WS-ERROR
 13305         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13306         GO TO 3290-EDIT-LF-REIN-RATE.
 13307
 13308 3230-CLIENT-MORT-CD-SPECIALS.
 13309
 13310     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13311     SET BIN-TO-GREG          TO TRUE.
 13312*    MOVE ' '                 TO DC-OPTION-CODE.
 13313     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13314     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13315
 13316 C-POS-3230-MORT-CD.
 13317     IF PB-COMPANY-ID = 'POS' AND
 13318        PB-SV-CARRIER = '2'
 13319         NEXT SENTENCE
 13320     ELSE
 13321         GO TO C-POS-3240-MORT-CD.
 13322
 13323     IF PB-SV-GROUPING = '030'
 13324        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13325         MOVE '2350' TO PB-I-MORT-CODE
 13326      ELSE
 13327         MOVE '3300' TO PB-I-MORT-CODE.
 13328
 13329
 13330 C-POS-3240-MORT-CD.
 13331     IF PB-COMPANY-ID = 'POS' AND
 13332        PB-SV-CARRIER = '1'
 13333         NEXT SENTENCE
 13334     ELSE
 13335         GO TO 3230-CONTINUE.
 13336
 13337     IF PB-SV-STATE = '45' OR '47'
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 243
* EL050.cbl
 13338        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13339         MOVE '5200' TO PB-I-MORT-CODE
 13340     ELSE
 13341         MOVE '8300' TO PB-I-MORT-CODE.
 13342
 13343 3230-CONTINUE.
 13344
 13345     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13346        GO TO 3240-CONTINUE
 13347     END-IF
 13348
 13349     IF PB-CERT-EFF-DT > WS-971231
 13350        GO TO 3240-CONTINUE
 13351     END-IF
 13352
 13353     IF LF-BENEFIT-FOUND AND
 13354        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13355         MOVE 'F250'       TO PB-I-MORT-CODE
 13356     ELSE
 13357         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13358             MOVE '7250'   TO PB-I-MORT-CODE
 13359         ELSE
 13360             MOVE '4251'   TO PB-I-MORT-CODE
 13361         END-IF
 13362     END-IF
 13363
 13364     .
 13365 3240-CONTINUE.
 13366
 13367     IF PB-COMPANY-ID NOT = 'GNL'
 13368         GO TO 3256-CONTINUE.
 13369
 13370     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13371         MOVE 'A300' TO PB-I-MORT-CODE
 13372     ELSE
 13373         MOVE '8350' TO PB-I-MORT-CODE.
 13374
 13375 3256-CONTINUE.
 13376     IF PB-COMPANY-ID NOT = 'ABL'
 13377         GO TO 3260-EDIT-CONTINUE.
 13378
 13379     IF PB-I-LF-TERM GREATER THAN 59
 13380         MOVE 'F550' TO PB-I-MORT-CODE
 13381     ELSE
 13382         MOVE 'E550' TO PB-I-MORT-CODE.
 13383
 13384 3260-EDIT-CONTINUE.
 13385     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13386
 13387 3290-EDIT-LF-REIN-RATE.
 13388     IF LF-REIN-NSP-NOT-USED
 13389         GO TO 3290-RATING-CONT.
 13390
 13391     IF PB-COMPANY-ID = 'DCC'
 13392        GO TO 3290-RATING-CONT.
 13393     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13394     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13395     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 244
* EL050.cbl
 13396     MOVE '3'                   TO CP-PROCESS-TYPE.
 13397     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13398
 13399******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13400     IF PB-COMPANY-ID EQUAL 'CDL'
 13401         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13402            CP-EARN-AS-NET-PAY)
 13403             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13404*            MOVE SPACE          TO DC-OPTION-CODE
 13405             SET BIN-TO-GREG     TO TRUE
 13406             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13407***  Y2K PROJ 7744
 13408             IF DC-GREG-DATE-CYMD GREATER 19931231
 13409                 MOVE '1'        TO CP-EARNING-METHOD.
 13410***  Y2K PROJ 7744
 13411*******
 13412
 13413     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13414     MOVE PB-SV-STATE           TO CP-STATE.
 13415     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13416     MOVE ZERO                  TO CP-DEVIATION-CODE
 13417                                   CP-RATE-DEV-PCT.
 13418     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13419     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13420                                   CP-RATING-BENEFIT-AMT.
 13421
 13422************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13423     IF PB-COMPANY-ID EQUAL 'NCB'
 13424         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13425            CP-EARN-AS-NET-PAY
 13426             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13427                 PB-I-LF-PREMIUM-AMT.
 13428************
 13429
 13430     IF CP-STATE-STD-ABBRV = 'OR'
 13431         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13432                                         PB-I-LF-ALT-BENEFIT-AMT.
 13433     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13434     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13435     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13436     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13437     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13438     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13439     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13440     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13441                                   CP-REMAINING-TERM
 13442                                   CP-LOAN-TERM.
 13443     IF CP-TRUNCATED-LIFE
 13444        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13445
 13446     IF CP-TERM-IS-DAYS
 13447         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13448     ELSE
 13449         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13450
 13451     IF PB-COMPANY-ID = 'DCC'
 13452        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13453     END-IF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 245
* EL050.cbl
 13454     IF PB-COMPANY-ID NOT = 'TIC'
 13455          MOVE ZERO          TO CP-CLASS-CODE.
 13456
 13457     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13458
 13459     MOVE 'R'                   TO CP-RATE-FILE.
 13460     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13461
 13462     IF CP-ERROR-RATE-NOT-FOUND
 13463        IF PB-I-OB
 13464           MOVE ER-2625      TO WS-ERROR
 13465           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13466           GO TO 3299-EDIT-CONTINUE
 13467        ELSE
 13468           MOVE ER-2643      TO WS-ERROR
 13469           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13470           GO TO 3299-EDIT-CONTINUE.
 13471
 13472     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13473
 13474     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13475     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13476
 13477     IF PB-I-LF-REI-RATE = ZERO
 13478         MOVE ER-2643        TO WS-ERROR
 13479         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13480
 13481 3290-CHECK-ALT-REIN-RATE.
 13482
 13483     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13484        GO TO 3290-RATING-CONT.
 13485
 13486     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13487     MOVE '2'                    TO CP-EARNING-METHOD.
 13488     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13489     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13490     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13491     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13492                                     CP-RATING-BENEFIT-AMT.
 13493     IF CP-STATE-STD-ABBRV = 'OR'
 13494         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13495                                         PB-I-LF-ALT-BENEFIT-AMT.
 13496     IF PB-COMPANY-ID = 'DCC'
 13497        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13498     END-IF
 13499     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13500     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13501     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13502                                    CP-REMAINING-TERM
 13503                                    CP-LOAN-TERM.
 13504     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13505        ADD +1                   TO CP-ORIGINAL-TERM
 13506                                    CP-REMAINING-TERM
 13507                                    CP-LOAN-TERM.
 13508
 13509     MOVE 'R'                   TO CP-RATE-FILE.
 13510     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13511
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 246
* EL050.cbl
 13512     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13513
 13514     IF PB-I-LF-ALT-REI-RATE = ZERO
 13515         MOVE ER-2643            TO WS-ERROR
 13516         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13517
 13518 3290-RATING-CONT.
 13519
 13520     IF PB-I-OB
 13521*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13522        GO TO 3300-CHECK-AH-RATES.
 13523
 13524 3299-EDIT-CONTINUE.
 13525
 13526     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13527         NEXT SENTENCE
 13528     ELSE
 13529         MOVE ER-2620           TO WS-ERROR
 13530         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13531
 13532 3300-CHECK-AH-RATES.
 13533     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13534         NEXT SENTENCE
 13535     ELSE
 13536         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13537
 13538     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13539        ((CF-COMPANY-ID = 'DMD') AND
 13540                (NO-DMD-RATING))
 13541         MOVE ER-2687             TO WS-ERROR
 13542         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13543         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13544         GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13545
 13546     IF PB-I-OB
 13547        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13548
 13549     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13550         MOVE ER-2687             TO WS-ERROR
 13551         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13552         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13553         GO TO 3999-END-EDIT.
 13554
 13555*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13556
 13557     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13558        IF PB-I-AH-CRIT-PER = ZERO
 13559           IF PB-COMPANY-ID = 'DCC'
 13560              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13561              CONTINUE
 13562           ELSE
 13563              MOVE ER-2618       TO WS-ERROR
 13564              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13565              GO TO 3999-END-EDIT
 13566           END-IF
 13567        END-IF
 13568     END-IF
 13569     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 247
* EL050.cbl
 13570     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13571     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13572     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13573     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13574     MOVE PB-SV-STATE            TO CP-STATE.
 13575     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13576     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13577     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13578*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13579     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13580     MOVE '3'                    TO CP-PROCESS-TYPE.
 13581     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13582     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13583                                    CP-RATING-BENEFIT-AMT.
 13584     IF PB-COMPANY-ID = 'CID'
 13585               OR
 13586        CP-STATE-STD-ABBRV = 'OR'
 13587         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13588                                         PB-I-AH-TERM.
 13589     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13590        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13591           AND (PB-I-POLICY-IS-MONTHLY)
 13592           MOVE PB-I-LF-BENEFIT-AMT
 13593                                 TO CP-NET-BENEFIT-AMT
 13594        END-IF
 13595     END-IF
 13596     MOVE SPACES                 TO CP-BEN-CATEGORY
 13597     IF PB-COMPANY-ID = 'DCC'
 13598        IF WS-AH-BEN-CATEGORY = 'G'
 13599           MOVE WS-AH-BEN-CATEGORY
 13600                                 TO CP-BEN-CATEGORY
 13601           MOVE PB-I-UNPAID-CASH-PRICE
 13602                                 TO CP-RATING-BENEFIT-AMT
 13603        ELSE
 13604           IF WS-AH-BEN-CATEGORY = 'L'
 13605              MOVE WS-AH-BEN-CATEGORY
 13606                                 TO CP-BEN-CATEGORY
 13607           ELSE
 13608              IF WS-AH-BEN-CATEGORY = 'D'
 13609                 MOVE WS-AH-BEN-CATEGORY
 13610                                 TO CP-BEN-CATEGORY
 13611                 MOVE WS-AH-PMF-COMM
 13612                                 TO CP-DCC-PMF-COMM
 13613                 MOVE PB-I-AH-COMMISSION
 13614                                 TO CP-DCC-ACT-COMM
 13615              END-IF
 13616           END-IF
 13617        END-IF
 13618     END-IF
 13619     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13620     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13621     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13622     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13623     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13624     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13625     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13626                                    CP-REMAINING-TERM
 13627                                    WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 248
* EL050.cbl
 13628     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13629
 13630     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13631     SET BIN-TO-GREG             TO TRUE.
 13632*    MOVE ' '                    TO DC-OPTION-CODE.
 13633     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13634     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13635
 13636     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13637     IF NOT VALID-SKIP-CODE
 13638         MOVE ER-2683            TO WS-ERROR
 13639         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13640         GO TO 3320-RATE-CONTINUE.
 13641
 13642     IF PB-NO-MONTHS-SKIPPED
 13643         GO TO 3320-RATE-CONTINUE.
 13644
 13645     MOVE SPACE TO NUMBER-OF-MONTHS.
 13646
 13647     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13648         MOVE 'S'                TO SK-MO (6).
 13649     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13650         MOVE 'S'                TO SK-MO (7).
 13651     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13652         MOVE 'S'                TO SK-MO (8).
 13653     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13654         MOVE 'S'                TO SK-MO (9).
 13655     IF PB-I-SKIP-CODE = 'A'
 13656         MOVE 'S'                TO SK-MO (10).
 13657
 13658     MOVE 1                      TO SUB2.
 13659     MOVE PB-I-AH-TERM           TO SUB3.
 13660     MOVE WS-MONTH               TO SUB1.
 13661     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13662     GO TO 3320-RATE-CONTINUE.
 13663
 13664 3310-GET-SKIP-MO.
 13665     IF SUB1 = 13
 13666         MOVE 1                  TO SUB1.
 13667
 13668     IF SK-MO (SUB1) = 'S'
 13669         SUBTRACT 1 FROM WS-WORK-TERM.
 13670
 13671     ADD 1 TO SUB2
 13672              SUB1.
 13673
 13674 3320-RATE-CONTINUE.
 13675
 13676     IF WS-WORK-TERM = ZERO
 13677         MOVE 1                  TO WS-WORK-TERM.
 13678
 13679     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13680                                    CP-LOAN-TERM.
 13681
 13682     IF PB-COMPANY-ID EQUAL 'DMD'
 13683         NEXT SENTENCE
 13684     ELSE
 13685         MOVE ZERO               TO PB-I-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 249
* EL050.cbl
 13686                                    PB-I-AH-REI-RATE.
 13687
 13688
 13689     IF PB-COMPANY-ID EQUAL 'CRI'
 13690        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13691
 13692     IF PB-COMPANY-ID = 'CSL'
 13693         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13694         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13695         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13696         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13697
 13698     IF PB-COMPANY-ID = 'DCC'
 13699        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13700           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13701              PB-I-RATE-DEV-PCT-LF
 13702        END-IF
 13703        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13704                                 TO CP-ALTERNATE-BENEFIT
 13705        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13706        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13707        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13708     END-IF
 13709     IF (PB-COMPANY-ID = 'CID')
 13710        AND (WS-LF-EARNINGS-CALC = 'B')
 13711        AND (CP-STATE-STD-ABBRV = 'MN')
 13712        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 13713     ELSE
 13714        MOVE ' '                 TO CP-AH-BALLOON-SW
 13715     END-IF
 13716     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 13717     MOVE 'R'                   TO CP-RATE-FILE.
 13718     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13719
 13720     IF CP-ERROR-RATE-NOT-FOUND
 13721        IF PB-I-OB
 13722           MOVE ER-2624          TO WS-ERROR
 13723           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13724           GO TO 3340-CALCULATE-PREMIUM-AMT
 13725        ELSE
 13726           MOVE ER-2642          TO WS-ERROR
 13727           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13728           GO TO 3340-CALCULATE-PREMIUM-AMT.
 13729
 13730     IF PB-COMPANY-ID EQUAL 'CSL' AND
 13731        CP-ERROR-DIV-BY-ZERO
 13732           MOVE ER-3782          TO WS-ERROR
 13733           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13734
 13735     IF PB-COMPANY-ID EQUAL 'CRI'
 13736        IF CP-ERROR-NO-LIMITS-CRI
 13737           IF NOT ACCOUNT-AH-CHECKED
 13738              MOVE ER-2607          TO WS-ERROR
 13739              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13740
 13741     IF ACCOUNT-AH-CHECKED
 13742        NEXT SENTENCE
 13743     ELSE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 250
* EL050.cbl
 13744       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13745          MOVE ER-2640           TO WS-ERROR
 13746          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13747
 13748     IF PB-COMPANY-ID = 'CRI'
 13749         IF WS-ERROR = ER-2640
 13750             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13751     IF ACCOUNT-AH-CHECKED
 13752        CONTINUE
 13753     ELSE
 13754        IF (CP-R-MAX-ATT-AGE NUMERIC)
 13755           AND (CP-R-MAX-ATT-AGE > +0)
 13756           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 13757           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 13758              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 13759              MOVE PB-I-AH-EXPIRE-DT
 13760                                 TO DC-BIN-DATE-2
 13761              MOVE '1'           TO DC-OPTION-CODE
 13762              PERFORM 8500-DATE-CONVERT
 13763                                 THRU 8500-EXIT
 13764              IF NO-CONVERSION-ERROR
 13765                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13766                    MOVE ER-2661       TO WS-ERROR
 13767*                   PERFORM 9900-ERROR-FORMAT
 13768*                                THRU 9900-EXIT
 13769                 END-IF
 13770              END-IF
 13771           ELSE
 13772              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 13773              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13774                 MOVE ER-2661    TO WS-ERROR
 13775*                PERFORM 9900-ERROR-FORMAT
 13776*                                THRU 9900-EXIT
 13777              ELSE
 13778                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13779                    MOVE ER-1570 TO WS-ERROR
 13780                    PERFORM 9900-ERROR-FORMAT
 13781                                 THRU 9900-EXIT
 13782                 END-IF
 13783              END-IF
 13784           END-IF
 13785           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13786              MOVE PB-I-JOINT-BIRTHDAY
 13787                                    TO DC-BIN-DATE-1
 13788              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 13789              MOVE '1'              TO DC-OPTION-CODE
 13790              PERFORM 8500-DATE-CONVERT
 13791                                    THRU 8500-EXIT
 13792              IF NO-CONVERSION-ERROR
 13793                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13794                    MOVE ER-2661       TO WS-ERROR
 13795*                   PERFORM 9900-ERROR-FORMAT
 13796*                                   THRU 9900-EXIT
 13797                 END-IF
 13798              END-IF
 13799           ELSE
 13800              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13801                (PB-I-AH-TERM / 12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 251
* EL050.cbl
 13802              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13803                 MOVE ER-2661       TO WS-ERROR
 13804*                PERFORM 9900-ERROR-FORMAT
 13805*                                   THRU 9900-EXIT
 13806              ELSE
 13807                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13808                    MOVE ER-1571 TO WS-ERROR
 13809                    PERFORM 9900-ERROR-FORMAT
 13810                                 THRU 9900-EXIT
 13811                 END-IF
 13812              END-IF
 13813           END-IF
 13814           IF WS-ERROR = ER-2661
 13815              PERFORM 9900-ERROR-FORMAT
 13816                                    THRU 9900-EXIT
 13817           END-IF
 13818        END-IF
 13819     END-IF
 13820*    IF ACCOUNT-AH-CHECKED
 13821*       NEXT SENTENCE
 13822*    ELSE
 13823*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13824*          MOVE ER-2661          TO WS-ERROR
 13825*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13826
 13827     IF ACCOUNT-AH-CHECKED
 13828        NEXT SENTENCE
 13829     ELSE
 13830        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13831           MOVE ER-2663          TO WS-ERROR
 13832           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13833
 13834     IF ACCOUNT-AH-CHECKED OR
 13835        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 13836         PB-POLICY-IS-VOIDED
 13837        NEXT SENTENCE
 13838     ELSE
 13839        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 13840           MOVE ER-2667            TO WS-ERROR
 13841           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13842
 13843     IF PB-COMPANY-ID = 'CRI'
 13844         IF WS-ERROR = ER-2667
 13845             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13846
 13847     IF ACCOUNT-AH-CHECKED
 13848        NEXT SENTENCE
 13849     ELSE
 13850        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13851           MOVE ER-2678            TO WS-ERROR
 13852           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13853
 13854     IF CP-ERROR-RATE-FILE-NOTOPEN
 13855         GO TO 3990-FILES-NOT-OPEN.
 13856
 13857 3321-CONTINUE.
 13858     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 13859     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 252
* EL050.cbl
 13860     IF (PB-COMPANY-ID = 'DCC')
 13861        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 13862        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 13863                                    PB-I-LF-ALT-PREM-CALC
 13864        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13865        IF WS-AH-BEN-CATEGORY = 'G'
 13866           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13867           + PB-I-ADDL-CLP)
 13868           * (1 + WS-TOL-CLP-PCT)
 13869*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 13870        ELSE
 13871           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13872           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 13873*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 13874        END-IF
 13875        MOVE WS-TOL-LF-HIGH-PREM-AMT
 13876                                 TO PB-I-AH-PREM-CALC
 13877        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 13878           MOVE ER-8148          TO WS-ERROR
 13879           PERFORM 9900-ERROR-FORMAT
 13880                                 THRU 9900-EXIT
 13881        ELSE
 13882           IF PB-I-AH-PREMIUM-AMT < PB-I-CLP-AMOUNT
 13883              MOVE ER-8148       TO WS-ERROR
 13884              PERFORM 9900-ERROR-FORMAT
 13885                                 THRU 9900-EXIT
 13886           END-IF
 13887        END-IF
 13888     END-IF
 13889     IF (PB-COMPANY-ID = 'DCC')
 13890        AND (PB-I-POLICY-IS-MONTHLY)
 13891        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 13892        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 13893        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 13894           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 13895        END-IF
 13896     END-IF
 13897     IF (PB-COMPANY-ID = 'DCC')
 13898        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 13899        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13900        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 13901        MOVE ER-2786             TO WS-ERROR
 13902        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13903     END-IF
 13904     MOVE +0                     TO PB-I-AH-CLP
 13905     IF PB-COMPANY-ID = 'DCC'
 13906        IF WS-AH-BEN-CATEGORY = 'D'
 13907           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 13908              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13909        ELSE
 13910           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13911              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 13912           END-IF
 13913        END-IF
 13914     END-IF
 13915     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 13916
 13917     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 253
* EL050.cbl
 13918         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 13919
 13920     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 13921         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 13922
 13923     IF PB-COMPANY-ID = 'CRI'
 13924         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 13925            PB-I-PAYMENT-AMOUNT = ZERO
 13926             NEXT SENTENCE
 13927         ELSE
 13928             COMPUTE PB-I-AH-PREM-CALC =
 13929                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 13930                 (CP-PREMIUM-RATE / 100)
 13931             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 13932                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 13933                                             PB-I-RATE-DEV-PCT-AH.
 13934
 13935     IF PB-I-AH-RATE  = ZERO
 13936         MOVE ER-2642            TO WS-ERROR
 13937         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13938
 13939     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 13940     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 13941     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 13942     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 13943     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 13944     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 13945
 13946     IF (PB-COMPANY-ID = 'DCC')
 13947        AND (WS-AH-BEN-CATEGORY = 'G')
 13948        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13949        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 13950        IF CP-DEVIATION-CODE NOT = '000'
 13951           MOVE '000'            TO CP-DEVIATION-CODE
 13952           PERFORM 7000-GET-RATE THRU 7000-EXIT
 13953           IF NO-CP-ERROR
 13954              COMPUTE PB-I-DDF-IU-RATE-UP =
 13955              PB-I-AH-CLP - CP-CALC-PREMIUM
 13956           ELSE
 13957              MOVE ER-3057        TO WS-ERROR
 13958              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13959           END-IF
 13960        END-IF
 13961     END-IF
 13962     .
 13963 3335-EDIT-AH-REIN-NSP-RATE.
 13964     IF AH-REIN-NSP-NOT-USED
 13965         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13966
 13967     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 13968     IF PB-COMPANY-ID = 'DCC'
 13969         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13970     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13971     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13972     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13973     MOVE PB-SV-STATE            TO CP-STATE.
 13974     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13975     MOVE ZERO                   TO CP-DEVIATION-CODE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 254
* EL050.cbl
 13976                                    CP-RATE-DEV-PCT.
 13977*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13978     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13979     MOVE '3'                    TO CP-PROCESS-TYPE.
 13980     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13981     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13982                                    CP-RATING-BENEFIT-AMT.
 13983     IF CP-STATE-STD-ABBRV = 'OR'
 13984         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13985                                         PB-I-AH-TERM.
 13986     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13987     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13988     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13989     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13990     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13991     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13992                                    CP-REMAINING-TERM
 13993                                    WS-WORK-TERM.
 13994     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 13995     IF PB-COMPANY-ID = 'DCC'
 13996        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13997     END-IF
 13998     IF  PB-COMPANY-ID = 'TIC'
 13999         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14000            MOVE ZERO TO CP-CLASS-CODE.
 14001
 14002     IF PB-COMPANY-ID NOT = 'TIC'
 14003          MOVE ZERO          TO CP-CLASS-CODE.
 14004
 14005     MOVE ZERO               TO CP-DEVIATION-CODE.
 14006
 14007     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14008
 14009     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14010
 14011     MOVE 'R'                   TO CP-RATE-FILE.
 14012     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14013
 14014     IF CP-ERROR-RATE-NOT-FOUND
 14015         MOVE ER-2645        TO WS-ERROR
 14016         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14017         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14018
 14019     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14020
 14021     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14022     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14023
 14024     IF PB-I-AH-REI-RATE = ZERO
 14025         MOVE ER-2645        TO WS-ERROR
 14026         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14027
 14028
 14029 3340-CALCULATE-PREMIUM-AMT.
 14030
 14031     IF PB-COMPANY-ID = 'NCL'
 14032         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14033             WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 255
* EL050.cbl
 14034             GO TO 3999-END-EDIT.
 14035
 14036     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14037                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14038                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14039         NEXT SENTENCE
 14040     ELSE
 14041         IF WS-STATE-ABBREVIATION = 'CT'
 14042             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14043                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14044                 COMPUTE PB-I-LF-PREM-CALC =
 14045                                     PB-I-LF-PREM-CALC * .90
 14046                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14047                                     PB-I-LF-ALT-PREM-CALC * .90
 14048                 COMPUTE PB-I-AH-PREM-CALC =
 14049                                     PB-I-AH-PREM-CALC * .90.
 14050
 14051     IF PB-COMP-LF-PREM
 14052        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14053        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14054
 14055     IF PB-COMP-AH-PREM
 14056        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14057
 14058 3340-CHECK-DCC-TOT-FEES.
 14059     IF (PB-COMPANY-ID = 'DCC')
 14060        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14061        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14062        AND (PB-I-POLICY-IS-MONTHLY)
 14063        CONTINUE
 14064     ELSE
 14065        GO TO 3340-EDIT-LF-AH-TOL
 14066     END-IF
 14067     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14068     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14069     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14070        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14071           PB-I-RATE-DEV-PCT-LF
 14072     END-IF
 14073     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14074        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14075           PB-I-RATE-DEV-PCT-AH
 14076     END-IF
 14077     MOVE 'N'                    TO CP-BEN-CATEGORY
 14078     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14079
 14080     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14081     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14082     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14083     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14084     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14085     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14086     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14087     MOVE '3'                    TO CP-PROCESS-TYPE.
 14088     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14089     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14090
 14091     MOVE PB-SV-STATE            TO CP-STATE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 256
* EL050.cbl
 14092     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14093     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14094     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14095     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14096     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14097                                    CP-RATING-BENEFIT-AMT.
 14098     IF CP-STATE-STD-ABBRV = 'OR'
 14099         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14100                                         PB-I-LF-ALT-BENEFIT-AMT.
 14101     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14102     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14103     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14104     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14105     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14106     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14107     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14108     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14109     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14110                                    CP-REMAINING-TERM
 14111                                    CP-LOAN-TERM.
 14112
 14113     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14114         NEXT SENTENCE
 14115     ELSE
 14116         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14117             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14118                                           PB-I-LF-PREMIUM-AMT.
 14119
 14120     IF CP-TRUNCATED-LIFE
 14121        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14122
 14123     IF CP-TERM-IS-DAYS
 14124         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14125     ELSE
 14126         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14127
 14128     IF PB-COMPANY-ID = 'DCC'
 14129        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14130     END-IF
 14131     IF CP-SPECIAL-CALC-CD = 'H'
 14132         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14133                                    TO CP-ALTERNATE-BENEFIT
 14134         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14135     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14136     MOVE 'R'                    TO CP-RATE-FILE
 14137     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14138     IF NOT CP-ERROR-RATE-NOT-FOUND
 14139        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14140        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14141           AND (CP-BENEFIT-CD (1:1) = 'S')
 14142           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14143                                    PB-I-LF-PREMIUM-AMT
 14144        END-IF
 14145     ELSE
 14146        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14147     END-IF
 14148     .
 14149 3340-EDIT-LF-AH-TOL.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 257
* EL050.cbl
 14150
 14151***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14152***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14153***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14154***
 14155     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14156         PB-I-AH-PREMIUM-AMT
 14157          GIVING WS-CALC-WORK.
 14158
 14159     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14160        AND WS-CALC-WORK NOT = ZERO
 14161         MOVE ER-2649            TO WS-ERROR
 14162         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14163
 14164     SUBTRACT PB-I-LF-PREM-CALC
 14165             FROM PB-I-LF-PREMIUM-AMT
 14166                 GIVING WS-UNSIGN-WRK1.
 14167
 14168     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14169             FROM PB-I-LF-ALT-PREMIUM-AMT
 14170                 GIVING WS-UNSIGN-WRK4.
 14171
 14172     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14173                                + WS-UNSIGN-WRK4.
 14174
 14175     SUBTRACT PB-I-AH-PREM-CALC
 14176             FROM PB-I-AH-PREMIUM-AMT
 14177                 GIVING WS-UNSIGN-WRK2.
 14178
 14179******************************************************************
 14180*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14181******************************************************************
 14182
 14183     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14184         MOVE ZERO TO WS-UNSIGN-WRK1.
 14185
 14186     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14187         MOVE ZERO TO WS-UNSIGN-WRK2.
 14188
 14189     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14190             GIVING WS-UNSIGN-WRK3.
 14191
 14192 3342-CONTINUE.
 14193
 14194     IF (PB-I-LF-RATE = ZERO  AND
 14195         PB-I-AH-RATE = ZERO)
 14196         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14197            WS-AH-SPECIAL-CALC-CD = 'O'
 14198              NEXT SENTENCE
 14199         ELSE
 14200             GO TO 3345-EDIT-CONTINUE.
 14201
 14202     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14203         NEXT SENTENCE
 14204     ELSE
 14205     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14206        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14207           IF (PB-REISSUED-CERT         OR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 258
* EL050.cbl
 14208               PB-POLICY-IS-DECLINED    OR
 14209               PB-POLICY-IS-VOIDED)
 14210              NEXT SENTENCE
 14211           ELSE
 14212              IF WS-PREM-REJECT-SW = SPACE
 14213                 MOVE ER-2652    TO WS-ERROR
 14214                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14215                 GO TO 3344-CHECK-AH
 14216              ELSE
 14217                 MOVE ER-2650    TO WS-ERROR
 14218                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14219                 GO TO 3344-CHECK-AH.
 14220
 14221***
 14222***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14223***
 14224
 14225     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14226         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14227            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14228             (1 + WS-TOL-LF-PREM-PCT)
 14229         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14230            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14231             (1 - WS-TOL-LF-PREM-PCT)
 14232     ELSE
 14233         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 14234         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14235
 14236***
 14237***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14238***
 14239
 14240     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14241         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14242          WS-TOL-LF-PREM.
 14243
 14244     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14245         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14246          WS-TOL-LF-PREM.
 14247
 14248     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14249        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14250
 14251     IF (PB-REISSUED-CERT        OR
 14252         PB-POLICY-IS-DECLINED   OR
 14253         PB-POLICY-IS-VOIDED)
 14254        NEXT SENTENCE
 14255     ELSE
 14256     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14257           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 14258       OR
 14259        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14260           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 14261       AND
 14262        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14263           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 14264         OR
 14265          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 259
* EL050.cbl
 14266           LESS WS-TOL-LF-LOW-PREM-PCT))
 14267              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14268                  MOVE ER-2652   TO  WS-ERROR
 14269                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14270              ELSE
 14271                  MOVE ER-2650   TO  WS-ERROR
 14272                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14273
 14274*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14275*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14276*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14277*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14278
 14279     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14280        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14281                      OR
 14282           ((PB-COMPANY-ID = 'DCC')
 14283           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 14284           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14285           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14286        END-IF
 14287     END-IF
 14288
 14289     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14290        IF WS-COMP-MAX-CAP GREATER THAN +0
 14291           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14292              IF (PB-REISSUED-CERT         OR
 14293                  PB-POLICY-IS-DECLINED    OR
 14294                  PB-POLICY-IS-VOIDED)
 14295                 NEXT SENTENCE
 14296              ELSE
 14297                  MOVE ER-2646   TO  WS-ERROR
 14298                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14299
 14300 3344-CVL-TOLERANCE-CHECK.
 14301
 14302      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14303          GO TO 3344-CHECK-AH.
 14304
 14305      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14306          GO TO 3344-CHECK-AH.
 14307
 14308      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14309                                     WS-UNSIGN-WRK6.
 14310
 14311      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14312          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14313                                 + PB-I-LF-PREMIUM-AMT
 14314                                 - PB-I-LF-PREM-CALC.
 14315
 14316      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14317          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14318                                 + PB-I-LF-ALT-PREMIUM-AMT
 14319                                 - PB-I-LF-ALT-PREM-CALC.
 14320
 14321      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14322          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14323              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 260
* EL050.cbl
 14324                 MOVE ER-2652    TO  WS-ERROR
 14325                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14326              ELSE
 14327                 MOVE ER-2650    TO  WS-ERROR
 14328                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14329
 14330      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14331          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14332              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14333                 MOVE ER-2652    TO  WS-ERROR
 14334                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14335              ELSE
 14336                 MOVE ER-2650    TO  WS-ERROR
 14337                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14338
 14339 3344-CHECK-AH.
 14340
 14341****************************************************************
 14342***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14343***
 14344
 14345     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14346         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14347             (1 + WS-TOL-AH-PREM-PCT)
 14348         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14349             (1 - WS-TOL-AH-PREM-PCT)
 14350     ELSE
 14351         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 14352         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14353
 14354***
 14355***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14356***
 14357
 14358     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14359         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14360
 14361     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14362         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14363
 14364     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14365        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14366
 14367     IF (PB-REISSUED-CERT         OR
 14368         PB-POLICY-IS-DECLINED    OR
 14369         PB-POLICY-IS-VOIDED)
 14370        NEXT SENTENCE
 14371     ELSE
 14372     IF ((PB-I-AH-PREMIUM-AMT GREATER THAN
 14373                             WS-TOL-AH-HIGH-PREM-AMT)
 14374       OR
 14375        (PB-I-AH-PREMIUM-AMT LESS THAN WS-TOL-AH-LOW-PREM-AMT))
 14376       AND
 14377        ((PB-I-AH-PREMIUM-AMT GREATER WS-TOL-AH-HIGH-PREM-PCT)
 14378         OR
 14379          (PB-I-AH-PREMIUM-AMT LESS WS-TOL-AH-LOW-PREM-PCT))
 14380              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14381                 MOVE ER-3052   TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 261
* EL050.cbl
 14382                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14383              ELSE
 14384                 MOVE ER-3050    TO  WS-ERROR
 14385                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14386
 14387     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14388         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14389             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14390             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14391
 14392     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14393        IF WS-COMP-MAX-CAP GREATER THAN +0
 14394           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14395              IF (PB-REISSUED-CERT         OR
 14396                  PB-POLICY-IS-DECLINED    OR
 14397                  PB-POLICY-IS-VOIDED)
 14398                 NEXT SENTENCE
 14399              ELSE
 14400                  MOVE ER-2646   TO  WS-ERROR
 14401                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14402
 14403     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14404        (WS-COMP-MAX-CAP EQUAL +0)
 14405           GO TO 3345-EDIT-CONTINUE.
 14406
 14407     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14408        GREATER THAN WS-COMP-MAX-CAP
 14409           MOVE ER-2646          TO  WS-ERROR
 14410           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14411
 14412 3345-EDIT-CONTINUE.
 14413
 14414*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14415*       IF PB-ENTRY-BATCH   NUMERIC
 14416*          IF PB-ISSUE
 14417*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14418*          ELSE
 14419*              IF PB-CANCELLATION
 14420*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14421
 14422*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14423*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14424*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14425*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14426*        ELSE
 14427*            MOVE  ER-1909            TO  WS-ERROR
 14428*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14429
 14430     IF PB-I-POLICY-ACCEPTED
 14431        IF PB-POLICY-IS-DECLINED  OR
 14432           PB-REISSUED-CERT  OR
 14433           PB-REIN-ONLY-CERT  OR
 14434           PB-POLICY-IS-VOIDED
 14435            MOVE  ER-1891         TO  WS-ERROR
 14436            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14437        ELSE
 14438            MOVE SPACE            TO  PB-BATCH-ENTRY
 14439            MOVE '2'              TO  PB-I-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 262
* EL050.cbl
 14440
 14441     IF PB-I-POLICY-DECLINED
 14442        IF PB-REISSUED-CERT  OR
 14443           PB-REIN-ONLY-CERT  OR
 14444           PB-POLICY-IS-VOIDED
 14445            MOVE  ER-1906         TO  WS-ERROR
 14446            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14447        ELSE
 14448            MOVE  'D'             TO  PB-BATCH-ENTRY
 14449                                      PB-I-ENTRY-STATUS.
 14450
 14451     IF PB-I-NEEDS-UNDERWRITING
 14452        IF PB-POLICY-IS-DECLINED OR
 14453           PB-REISSUED-CERT  OR
 14454           PB-REIN-ONLY-CERT  OR
 14455           PB-POLICY-IS-VOIDED
 14456            MOVE  ER-1907         TO  WS-ERROR
 14457            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14458        ELSE
 14459            MOVE 'U'              TO  PB-BATCH-ENTRY
 14460                                      PB-I-ENTRY-STATUS.
 14461
 14462     IF PB-NEEDS-UNDERWRITING
 14463        MOVE  ER-1901             TO  WS-ERROR
 14464        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14465     IF PB-COMPANY-ID = 'DCC'
 14466        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14467        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14468        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S')
 14469           AND (NOT WS-LF-CASH))
 14470                           OR
 14471           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S')
 14472           AND (NOT WS-AH-CASH)))
 14473                       AND
 14474           (PB-I-ENTRY-STATUS NOT = '5')
 14475           MOVE 'M'              TO PB-BATCH-ENTRY
 14476                                    PB-I-ENTRY-STATUS
 14477        END-IF
 14478     END-IF
 14479     IF  PB-COMPANY-ID NOT = 'NCL'
 14480         GO TO 3999-END-EDIT.
 14481
 14482     IF PB-REISSUED-CERT  OR
 14483        PB-POLICY-IS-DECLINED  OR
 14484        PB-POLICY-IS-VOIDED  OR
 14485        PB-I-OB
 14486         GO TO 3999-END-EDIT.
 14487
 14488     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14489         MOVE  ER-2644            TO  WS-ERROR
 14490         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14491         GO TO 3999-END-EDIT.
 14492
 14493     MOVE 'N'                     TO  FORM-MASTER-SW.
 14494     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14495
 14496     IF NOT FORM-MASTER-FOUND
 14497         GO TO 3999-END-EDIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 263
* EL050.cbl
 14498
 14499     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14500                                      FORM-MASTER-AH-SW.
 14501
 14502     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14503         MOVE  +1                 TO SUB6
 14504         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14505
 14506     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14507         MOVE  +1                 TO SUB6
 14508         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14509
 14510     IF LF-FORM-MASTER-FOUND  OR
 14511        AH-FORM-MASTER-FOUND
 14512         GO TO 3360-CHECK-FORM-LIMITS
 14513     ELSE
 14514         GO TO 3999-END-EDIT.
 14515
 14516******************************************************************
 14517*                  3350-GET-ERFORM                               *
 14518*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14519*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14520******************************************************************
 14521
 14522 3350-GET-ERFORM.
 14523
 14524     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14525         GO TO  3350-ERFORM-GETMAIN.
 14526
 14527     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14528     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14529     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14530     MOVE 'Y'                     TO FORM-MASTER-SW.
 14531
 14532     IF PB-CANCELLATION
 14533         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14534            PB-SV-STATE          EQUAL   FO-STATE       AND
 14535            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14536              GO TO 3350-EXIT
 14537         ELSE
 14538             NEXT SENTENCE
 14539     ELSE
 14540         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14541            PB-SV-STATE          EQUAL   FO-STATE       AND
 14542            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14543              GO TO 3350-EXIT.
 14544
 14545 3350-ERFORM-GETMAIN.
 14546
 14547     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14548     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14549
 14550 3350-ERFORM-READ.
 14551
 14552     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14553     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14554     IF PB-CANCELLATION
 14555         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 264
* EL050.cbl
 14556     ELSE
 14557         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14558     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14559
 14560     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14561
 14562     IF FORM-MASTER-FOUND
 14563       IF PB-CANCELLATION
 14564          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14565             PB-SV-STATE          EQUAL   FO-STATE       AND
 14566             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14567              GO  TO 3350-EXIT
 14568          ELSE
 14569              NEXT SENTENCE
 14570       ELSE
 14571          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14572             PB-SV-STATE          EQUAL   FO-STATE       AND
 14573             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14574              GO  TO 3350-EXIT.
 14575
 14576     MOVE  'N'                    TO  FORM-MASTER-SW.
 14577     MOVE  ER-1895                TO  WS-ERROR.
 14578     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14579
 14580 3350-EXIT.
 14581      EXIT.
 14582
 14583******************************************************************
 14584*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14585*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14586*   VALID FOR THE POLICY FORM USED.                              *
 14587******************************************************************
 14588
 14589 3355-EDIT-FORM-LF-BENEFITS.
 14590
 14591     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14592        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14593         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14594         GO TO   3355-EXIT.
 14595
 14596     IF  SUB6    LESS THAN   +40
 14597         ADD  +1      TO  SUB6
 14598         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14599
 14600     MOVE  ER-1896         TO  WS-ERROR.
 14601     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14602
 14603 3355-EXIT.
 14604      EXIT.
 14605
 14606******************************************************************
 14607*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14608*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14609*   VALID FOR THE POLICY FORM USED.                              *
 14610******************************************************************
 14611
 14612 3356-EDIT-FORM-AH-BENEFITS.
 14613
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 265
* EL050.cbl
 14614     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14615        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14616         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14617         GO TO  3356-EXIT.
 14618
 14619      IF  SUB6    LESS THAN     +40
 14620          ADD  +1      TO  SUB6
 14621          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14622
 14623     MOVE  ER-1897         TO  WS-ERROR.
 14624     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14625
 14626 3356-EXIT.
 14627      EXIT.
 14628
 14629******************************************************************
 14630*                  3357-BENEFIT-SEARCH                           *
 14631*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14632*   CANCELLATIONS ONLY.                                          *
 14633******************************************************************
 14634 3357-BENEFIT-SEARCH.
 14635     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14636         MOVE +1                          TO SUB6
 14637         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14638
 14639     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14640         MOVE +1                          TO SUB6
 14641         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14642
 14643 3357-EXIT.
 14644     EXIT.
 14645
 14646******************************************************************
 14647*                  3358-BENEFIT-LIFE-SEARCH                      *
 14648*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14649*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14650*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14651******************************************************************
 14652 3358-BENEFIT-LIFE-SEARCH.
 14653     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14654       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14655         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14656           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14657              IF FO-PLAN-REFUND-METHOD (SUB6)
 14658                     IS GREATER THAN SPACES
 14659                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14660                                          WS-LF-REFUND-CALC
 14661                 GO TO 3358-EXIT.
 14662
 14663     IF SUB6 LESS THAN +40
 14664         ADD +1                 TO SUB6
 14665         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14666
 14667 3358-EXIT.
 14668     EXIT.
 14669******************************************************************
 14670*                  3359-BENEFIT-AH-SEARCH                        *
 14671*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 266
* EL050.cbl
 14672*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14673*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14674******************************************************************
 14675 3359-BENEFIT-AH-SEARCH.
 14676     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14677       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14678         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14679           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14680              IF FO-PLAN-REFUND-METHOD (SUB6)
 14681                      IS GREATER THAN SPACES
 14682                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14683                                          WS-AH-REFUND-CALC
 14684                 GO TO 3359-EXIT.
 14685
 14686     IF SUB6 LESS THAN +40
 14687         ADD +1                 TO SUB6
 14688         GO TO 3359-BENEFIT-AH-SEARCH.
 14689
 14690 3359-EXIT.
 14691     EXIT.
 14692
 14693******************************************************************
 14694*                  3360-CHECK-FORM-LIMITS                        *
 14695*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14696*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14697******************************************************************
 14698
 14699 3360-CHECK-FORM-LIMITS.
 14700
 14701     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14702         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 14703
 14704     IF NOT LF-FORM-MASTER-FOUND
 14705         GO TO 3360-CHECK-FORM-AH-LIMITS.
 14706
 14707 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 14708
 14709     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 14710       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 14711        WS-LF-JOINT-INDICATOR = 'J'  AND
 14712        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14713         IF PB-COMPANY-ID = 'NCL'
 14714            MOVE  ER-1911          TO  WS-ERROR
 14715            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14716         ELSE
 14717            MOVE  ER-1892          TO  WS-ERROR
 14718            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14719
 14720 3360-CHECK-FORM-LF-ATT-AGE.
 14721
 14722     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 14723
 14724     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 14725         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14726         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 14727            IF PB-COMPANY-ID = 'NCL'
 14728                MOVE  ER-1913      TO  WS-ERROR
 14729                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 267
* EL050.cbl
 14730            ELSE
 14731                MOVE  ER-1894      TO  WS-ERROR
 14732                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14733
 14734 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 14735
 14736     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 14737         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 14738         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 14739            IF PB-COMPANY-ID = 'NCL'
 14740                MOVE  ER-1914      TO  WS-ERROR
 14741                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14742            ELSE
 14743                MOVE  ER-1899      TO  WS-ERROR
 14744                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14745
 14746 3360-CHECK-FORM-LF-TERM-BAMT.
 14747
 14748     IF  FO-LF-MAX-TERM   NUMERIC   AND
 14749         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 14750         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 14751           IF  PB-COMPANY-ID = 'NCL'
 14752               MOVE  ER-1916       TO  WS-ERROR
 14753               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14754           ELSE
 14755               MOVE  ER-1902       TO  WS-ERROR
 14756               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14757
 14758     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 14759                                    PB-I-LF-ALT-BENEFIT-AMT.
 14760
 14761     IF  FO-MAX-LF-AMT   NUMERIC   AND
 14762         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 14763         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 14764             IF  PB-COMPANY-ID = 'NCL'
 14765                 MOVE  ER-1918     TO  WS-ERROR
 14766                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14767             ELSE
 14768                 MOVE  ER-1904     TO  WS-ERROR
 14769                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14770
 14771******************************************************************
 14772*                  3360-CHECK-FORM-AH-LIMITS                     *
 14773*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14774*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14775******************************************************************
 14776
 14777 3360-CHECK-FORM-AH-LIMITS.
 14778
 14779     IF NOT AH-FORM-MASTER-FOUND
 14780         GO TO 3999-END-EDIT.
 14781
 14782 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 14783
 14784     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 14785       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 14786        WS-AH-JOINT-INDICATOR = 'J'  AND
 14787        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 268
* EL050.cbl
 14788         IF PB-COMPANY-ID = 'NCL'
 14789            MOVE  ER-1912          TO  WS-ERROR
 14790            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14791         ELSE
 14792            MOVE  ER-1893          TO  WS-ERROR
 14793            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14794
 14795 3360-CHECK-FORM-AH-ATT-AGE.
 14796
 14797     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 14798
 14799     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 14800         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14801         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 14802            IF PB-COMPANY-ID = 'NCL'
 14803                MOVE  ER-1913      TO  WS-ERROR
 14804                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14805            ELSE
 14806                MOVE  ER-1894      TO  WS-ERROR
 14807                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14808
 14809 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 14810
 14811     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 14812         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 14813         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 14814            IF PB-COMPANY-ID = 'NCL'
 14815                MOVE  ER-1915      TO  WS-ERROR
 14816                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14817            ELSE
 14818                MOVE  ER-1900      TO  WS-ERROR
 14819                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14820
 14821 3360-CHECK-FORM-AH-TERM-BAMT.
 14822
 14823     IF  FO-AH-MAX-TERM    NUMERIC   AND
 14824         FO-AH-MAX-TERM    GREATER THAN  +0
 14825         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 14826             IF  PB-COMPANY-ID = 'NCL'
 14827                 MOVE  ER-1917     TO  WS-ERROR
 14828                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14829             ELSE
 14830                  MOVE  ER-1903    TO  WS-ERROR
 14831                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14832
 14833     IF  FO-MAX-AH-AMT    NUMERIC   AND
 14834         FO-MAX-AH-AMT    GREATER THAN  +0
 14835         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 14836             IF  PB-COMPANY-ID = 'NCL'
 14837                 MOVE  ER-1919     TO  WS-ERROR
 14838                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14839             ELSE
 14840                 MOVE  ER-1905     TO  WS-ERROR
 14841                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14842
 14843     GO TO 3999-END-EDIT.
 14844
 14845******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 269
* EL050.cbl
 14847******************************************************************
 14848*                  E D I T   C A N C E L                         *
 14849******************************************************************
 14850
 14851 3700-EDIT-CANCEL.
 14852     IF PB-COMPANY-ID = 'DMD'
 14853         MOVE ZEROS                   TO WS-RES-STATE-TAX
 14854                                         WS-RES-MUNI-TAX
 14855                                         PB-CI-STATE-TAX
 14856                                         PB-CI-MUNI-TAX
 14857         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 14858
 14859*    IF PB-COMPANY-ID  EQUAL  'NCL'
 14860*       IF PB-ENTRY-BATCH  NUMERIC
 14861*          IF PB-CANCELLATION
 14862*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 14863*          ELSE
 14864*             IF PB-ISSUE
 14865*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 14866
 14867     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 14868        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 14869     END-IF
 14870*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 14871*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 14872
 14873     IF CM-ENTRY-STATUS = 'V'
 14874        MOVE ER-2780             TO WS-ERROR
 14875        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14876        GO TO 3999-END-EDIT.
 14877
 14878     IF CM-ENTRY-STATUS = 'D'
 14879        MOVE ER-2781             TO WS-ERROR
 14880        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14881        GO TO 3999-END-EDIT.
 14882
 14883     IF CM-ENTRY-STATUS = 'U'
 14884        MOVE ER-2782             TO WS-ERROR
 14885        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14886
 14887***************************************************************
 14888*                                                             *
 14889*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 14890*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 14891*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 14892*   OF ANOTHER COVERAGE.                                      *
 14893*                                                             *
 14894***************************************************************
 14895
 14896     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 14897                                    PB-C-AH-CANCEL-VOID-SW.
 14898
 14899     IF PB-C-LF-CANCEL-AMT = ZERO
 14900        NEXT SENTENCE
 14901     ELSE
 14902        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 14903           AND
 14904           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 270
* EL050.cbl
 14905               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 14906               MOVE ER-2745           TO WS-ERROR
 14907               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14908
 14909     IF PB-C-AH-CANCEL-AMT = ZERO
 14910        NEXT SENTENCE
 14911     ELSE
 14912        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 14913           AND
 14914           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 14915               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 14916               MOVE ER-2745           TO WS-ERROR
 14917               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14918
 14919     IF WS-LF-EARNINGS-CALC = '4'
 14920        MOVE '4'                   TO WS-LF-REFUND-CALC.
 14921
 14922     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 14923     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 14924     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 14925     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 14926     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 14927     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 14928
 14929     MOVE ZERO                     TO PB-C-LF-REF-CALC
 14930                                      PB-C-AH-REF-CALC.
 14931     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 14932
 14933******************************************************************
 14934*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 14935*             TO VALIDATE COVERAGE.                              *
 14936******************************************************************
 14937
 14938     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 14939        PB-C-LF-CANCEL-AMT = ZEROS
 14940          MOVE 'N'                 TO WS-LF-CANCEL-SW
 14941      ELSE
 14942          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 14943
 14944     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 14945        PB-C-AH-CANCEL-AMT = ZEROS
 14946          MOVE 'N'                 TO WS-AH-CANCEL-SW
 14947      ELSE
 14948          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 14949
 14950     EVALUATE TRUE
 14951         WHEN PB-CANCEL-FORCE             OR
 14952              PB-CANCEL-DATE-FORCED       OR
 14953              PB-FORCE-OFF
 14954                  IF PB-COMPANY-ID = 'ACE'
 14955                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 14956                  END-IF
 14957         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 14958               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 14959              (PB-COMPANY-ID = 'ACE' )
 14960                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 14961         WHEN OTHER
 14962              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 271
* EL050.cbl
 14963                 MOVE ER-2794              TO WS-ERROR
 14964              ELSE
 14965                 MOVE ER-2749              TO WS-ERROR
 14966              END-IF
 14967              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14968     END-EVALUATE.
 14969
 14970
 14971*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14972*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 14973*            MOVE  ER-1909            TO  WS-ERROR
 14974*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14975*        ELSE
 14976*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 14977
 14978     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 14979     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 14980        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 14981     ELSE
 14982        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 14983     END-IF
 14984     .
 14985 3705-EDIT-CANCEL-DT.
 14986
 14987     IF LF-COVERAGE-CANCELLED
 14988        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 14989         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 14990         MOVE WS-CURRENT-MONTH-END
 14991                                 TO DC-BIN-DATE-2
 14992         SET ELAPSED-BETWEEN-BIN TO TRUE
 14993*        MOVE 1                  TO DC-OPTION-CODE
 14994         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14995         IF DATE-CONVERSION-ERROR
 14996            NEXT SENTENCE
 14997          ELSE
 14998             IF DC-ELAPSED-DAYS GREATER +180
 14999                IF PB-CANCEL-DATE-FORCED  OR
 15000                   PB-CANCEL-DATE-FORCED-NO-FEE
 15001                      MOVE ER-2751  TO WS-ERROR
 15002                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15003                 ELSE
 15004                   MOVE ER-2752  TO WS-ERROR
 15005                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15006
 15007     IF AH-COVERAGE-CANCELLED
 15008        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15009         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15010         MOVE WS-CURRENT-MONTH-END
 15011                                 TO DC-BIN-DATE-2
 15012         SET ELAPSED-BETWEEN-BIN TO TRUE
 15013*        MOVE 1                  TO DC-OPTION-CODE
 15014         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15015         IF DATE-CONVERSION-ERROR
 15016            NEXT SENTENCE
 15017          ELSE
 15018             IF DC-ELAPSED-DAYS GREATER +180
 15019                IF PB-CANCEL-DATE-FORCED OR
 15020                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 272
* EL050.cbl
 15021                      MOVE ER-2751  TO WS-ERROR
 15022                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15023                 ELSE
 15024                   MOVE ER-2752  TO WS-ERROR
 15025                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15026
 15027     IF WS-ERROR = ER-2752
 15028        AND (PB-COMPANY-ID = 'ABL'
 15029         OR  PB-COMPANY-ID = 'FGL'
 15030         OR  PB-COMPANY-ID = 'IST'
 15031         OR  PB-COMPANY-ID = 'JHL'
 15032         OR  PB-COMPANY-ID = 'LAP'
 15033         OR  PB-COMPANY-ID = 'LBL'
 15034         OR  PB-COMPANY-ID = 'NCB'
 15035         OR  PB-COMPANY-ID = 'NLI'
 15036         OR  PB-COMPANY-ID = 'OFI'
 15037         OR  PB-COMPANY-ID = 'PLI'
 15038         OR  PB-COMPANY-ID = 'TAO'
 15039         OR  PB-COMPANY-ID = 'TIC'
 15040         OR  PB-COMPANY-ID = 'HER'
 15041         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15042         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15043            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15044            MOVE ER-2762     TO WS-ERROR
 15045            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15046
 15047     IF LF-COVERAGE-CANCELLED
 15048        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15049        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15050             MOVE ER-2733         TO WS-ERROR
 15051             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15052
 15053     IF AH-COVERAGE-CANCELLED
 15054        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15055        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15056              MOVE ER-2733        TO WS-ERROR
 15057              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15058
 15059     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15060        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15061        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15062           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15063            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15064              IF PB-COMPANY-ID NOT = 'LAP'
 15065               MOVE ER-2704            TO WS-ERROR
 15066               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15067
 15068     IF CERT-WAS-NOT-FOUND
 15069         GO TO 3999-END-EDIT.
 15070
 15071     IF PB-COMPANY-ID EQUAL 'CDC'
 15072        IF LF-COVERAGE-CANCELLED
 15073           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15074            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15075            MOVE PB-C-LF-CANCEL-DT
 15076                                 TO DC-BIN-DATE-2
 15077            SET ELAPSED-BETWEEN-BIN TO TRUE
 15078*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 273
* EL050.cbl
 15079            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15080            IF DATE-CONVERSION-ERROR
 15081               NEXT SENTENCE
 15082             ELSE
 15083                IF DC-ELAPSED-DAYS GREATER +60
 15084                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15085
 15086     IF PB-COMPANY-ID EQUAL 'CDC'
 15087        IF AH-COVERAGE-CANCELLED
 15088           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15089            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15090            MOVE PB-C-AH-CANCEL-DT
 15091                                 TO DC-BIN-DATE-2
 15092            MOVE +0              TO DC-ELAPSED-DAYS
 15093                                    DC-ELAPSED-MONTHS
 15094            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15095*           MOVE 1               TO DC-OPTION-CODE
 15096            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15097            IF DATE-CONVERSION-ERROR
 15098               NEXT SENTENCE
 15099             ELSE
 15100                IF DC-ELAPSED-DAYS GREATER +60
 15101                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15102
 15103     MOVE +0                     TO DC-ELAPSED-DAYS
 15104                                    DC-ELAPSED-MONTHS.
 15105
 15106     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15107        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15108          MOVE 'Z'                TO PB-CI-OB-FLAG
 15109          MOVE ER-2767            TO WS-ERROR
 15110          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15111          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15112          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15113          GO TO 3775-OVER-REF-CHK
 15114        ELSE
 15115          MOVE ZEROS              TO PB-CI-LIVES
 15116                                     PB-C-LIVES
 15117          IF PB-CI-OB-FLAG NOT = 'B'
 15118             MOVE SPACE           TO PB-CI-OB-FLAG.
 15119
 15120     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15121         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15122     ELSE
 15123         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15124
 15125     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15126        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15127            MOVE ER-2760         TO WS-ERROR
 15128            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15129
 15130     IF LF-COVERAGE-CANCELLED
 15131        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15132         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15133            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15134               MOVE ER-2774       TO WS-ERROR
 15135               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15136
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 274
* EL050.cbl
 15137     IF AH-COVERAGE-CANCELLED
 15138        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15139         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15140            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15141               MOVE ER-2775       TO WS-ERROR
 15142               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15143
 15144     IF LF-COVERAGE-CANCELLED
 15145        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15146         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15147            MOVE ER-2776         TO WS-ERROR
 15148            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15149
 15150     IF AH-COVERAGE-CANCELLED
 15151        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15152         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15153            MOVE ER-2777         TO WS-ERROR
 15154            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15155
 15156     IF LF-COVERAGE-CANCELLED
 15157        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15158         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15159         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15160         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15161*        MOVE 6                    TO DC-OPTION-CODE
 15162         SET BIN-PLUS-ELAPSED      TO TRUE
 15163         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15164         IF DATE-CONVERSION-ERROR
 15165            NEXT SENTENCE
 15166          ELSE
 15167            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15168              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15169                             OR  'FIA'
 15170                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15171               ELSE
 15172                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15173                MOVE ER-2731       TO WS-ERROR
 15174                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15175
 15176 3705-EDIT-AH-CANCEL-DT.
 15177
 15178     IF AH-COVERAGE-CANCELLED
 15179        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15180         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15181         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15182         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15183*        MOVE 6                    TO DC-OPTION-CODE
 15184         SET BIN-PLUS-ELAPSED      TO TRUE
 15185         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15186         IF DATE-CONVERSION-ERROR
 15187            NEXT SENTENCE
 15188          ELSE
 15189            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15190              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15191                              OR 'FIA'
 15192                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15193              ELSE
 15194               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 275
* EL050.cbl
 15195               MOVE ER-2771       TO WS-ERROR
 15196               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15197
 15198 3705-EDIT-CONTINUED.
 15199
 15200*    IF LF-COVERAGE-CANCELLED
 15201*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15202*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15203*            MOVE ER-2727         TO WS-ERROR
 15204*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15205*
 15206*    IF AH-COVERAGE-CANCELLED
 15207*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15208*        IF PB-COMPANY-ID = 'ACE'
 15209*           MOVE ER-2727        TO WS-ERROR
 15210*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15211*        ELSE
 15212*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15213*              MOVE ER-2727     TO WS-ERROR
 15214*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15215
 15216     IF PB-COMPANY-ID = 'ACE'
 15217       IF AH-COVERAGE-CANCELLED
 15218         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15219           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15220              MOVE ER-2732      TO WS-ERROR
 15221              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15222
 15223     IF PB-COMPANY-ID      EQUAL   'HER'
 15224        IF WS-ERROR        EQUAL   ER-2727
 15225            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15226            MOVE  ER-2725          TO  WS-ERROR
 15227            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15228
 15229     IF PB-C-CLAIM-CREATED-CANCEL
 15230            MOVE ER-2748         TO WS-ERROR
 15231            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15232
 15233     IF PB-C-LAST-NAME NOT = SPACES
 15234         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15235            MOVE ER-2747         TO WS-ERROR
 15236            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15237
 15238 3710-EDIT-LUMP-SUM-PRIOR.
 15239
 15240     IF AH-COVERAGE-CANCELLED
 15241         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15242             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15243                MOVE ER-2735    TO WS-ERROR
 15244                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15245
 15246     IF LF-COVERAGE-CANCELLED
 15247         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15248             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15249                MOVE ER-2735    TO WS-ERROR
 15250                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15251
 15252 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 276
* EL050.cbl
 15253
 15254*    IF LF-COVERAGE-CANCELLED
 15255*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15256*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15257*           (NOT PB-CI-OB)
 15258*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15259*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15260*                   MOVE ER-2732  TO WS-ERROR
 15261*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15262*
 15263*    IF AH-COVERAGE-CANCELLED
 15264*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15265*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15266*           (NOT PB-CI-OB)
 15267*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15268*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15269*                   MOVE ER-2732  TO WS-ERROR
 15270*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15271
 15272     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15273         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15274            (NOT PB-COMP-LF-CANCEL)
 15275             NEXT SENTENCE
 15276         ELSE
 15277           IF PB-C-LF-CANCEL-VOIDED
 15278              NEXT SENTENCE
 15279           ELSE
 15280              MOVE ER-2753      TO WS-ERROR
 15281              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15282
 15283     IF CANCEL-FUTURE-DT
 15284         GO TO 3999-END-EDIT.
 15285
 15286 3715-GET-REMAIN-TERM-LF.
 15287
 15288     IF NO-LF-BENEFIT-MATCH  OR
 15289        WS-LF-BENEFIT-CD = ZEROS
 15290        GO TO 3730-GET-AH-REMAIN-TERM.
 15291
 15292     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15293     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15294     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15295     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15296     MOVE PB-SV-STATE            TO CP-STATE.
 15297     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15298     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15299     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15300     MOVE '2'                    TO CP-PROCESS-TYPE.
 15301     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15302     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15303     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15304     IF (PB-COMPANY-ID = 'CID')
 15305        AND (CP-STATE-STD-ABBRV = 'WI')
 15306        MOVE '7'                 TO CP-REM-TERM-METHOD
 15307        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15308     ELSE
 15309        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15310        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 277
* EL050.cbl
 15311                                 TO CP-REM-TRM-CALC-OPTION
 15312     END-IF
 15313**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15314     IF (PB-COMPANY-ID = 'CID')
 15315        AND (CP-STATE-STD-ABBRV = 'MO')
 15316        AND (PB-CERT-EFF-DT >= X'9B41')
 15317        AND (PB-CERT-EFF-DT <= X'A2FB')
 15318        MOVE '7'                 TO CP-REM-TERM-METHOD
 15319        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15320     END-IF
 15321     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15322                                    CP-LOAN-TERM.
 15323     IF CP-TRUNCATED-LIFE
 15324        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15325
 15326     IF CP-TERM-IS-DAYS
 15327         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15328     ELSE
 15329         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15330
 15331     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15332
 15333     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15334
 15335     IF LF-COVERAGE-CANCELLED
 15336        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15337        NEXT SENTENCE
 15338      ELSE
 15339          GO TO 3730-GET-AH-REMAIN-TERM.
 15340
 15341 3720-GET-LF-REFUND.
 15342
 15343     IF PB-C-LF-CANCEL-VOIDED OR
 15344        PB-C-AH-CANCEL-VOIDED
 15345        GO TO 3780-UPDATE-CANCEL-CERT.
 15346
 15347     IF PB-COMPANY-ID EQUAL 'BOA'
 15348         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15349         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15350         GO TO 3730-GET-AH-REMAIN-TERM.
 15351
 15352     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15353        (WS-AH-SPECIAL-CALC-CD = 'M')
 15354         MOVE ER-2767            TO WS-ERROR
 15355         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15356         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15357         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15358         GO TO 3780-UPDATE-CANCEL-CERT.
 15359
 15360     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15361
 15362     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15363     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15364     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15365     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15366     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15367     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15368     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 278
* EL050.cbl
 15369        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15370        MOVE ' '                 TO PDEF-MASTER-SW
 15371        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15372        MOVE PB-STATE            TO ERPDEF-STATE
 15373        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15374        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15375        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15376        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15377        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15378        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15379        IF PDEF-MASTER-FOUND
 15380           MOVE 'N'              TO PDEF-MASTER-SW
 15381           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15382           IF PDEF-MASTER-FOUND
 15383              IF (ERPDEF-KEY-SAVE (1:16) =
 15384                           PD-CONTROL-PRIMARY (1:16))
 15385                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15386                 CONTINUE
 15387              ELSE
 15388                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15389                 IF (ERPDEF-KEY-SAVE (1:16) =
 15390                           PD-CONTROL-PRIMARY (1:16))
 15391                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15392                    CONTINUE
 15393                 ELSE
 15394                    MOVE 'N'     TO PDEF-MASTER-SW
 15395                 END-IF
 15396              END-IF
 15397              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15398
 15399              IF PDEF-MASTER-FOUND
 15400                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15401                    (V1 > +8)
 15402                    OR (PD-PROD-CODE (V1) = 'L')
 15403                 END-PERFORM
 15404                 IF V1 < +9
 15405                    MOVE PD-MAX-AMT (V1)
 15406                                 TO CP-R-MAX-TOT-BEN
 15407                                    EC-AM-LF-MAX-TOT-BEN
 15408                 END-IF
 15409              END-IF
 15410           END-IF
 15411           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15412        END-IF
 15413     END-IF
 15414     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15415
 15416     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15417
 15418     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15419                                    PB-C-LF-REM-TERM.
 15420
 15421     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15422     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15423
 15424     IF PB-COMPANY-ID EQUAL 'FLC'
 15425        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15426           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 279
* EL050.cbl
 15427           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15428                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15429                    - CM-LF-ITD-DEATH-AMT
 15430           IF PB-C-LF-REF-CALC LESS THAN +0
 15431              MOVE +0            TO PB-C-LF-REF-CALC
 15432              GO TO 3730-GET-AH-REMAIN-TERM
 15433           ELSE
 15434              GO TO 3730-GET-AH-REMAIN-TERM.
 15435
 15436     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15437                            OR '4' OR '5' OR '6' OR '8'
 15438                            OR '9' OR 'G'
 15439        MOVE PB-C-LF-REFUND-OVERRIDE
 15440                                 TO CP-EARNING-METHOD.
 15441
 15442     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15443     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15444     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15445                                    CP-RATING-BENEFIT-AMT.
 15446     IF CP-STATE-STD-ABBRV = 'OR'
 15447         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15448                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15449     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15450     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15451     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15452     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15453     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15454     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15455     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15456     IF WS-DEFAULT-APR NOT NUMERIC
 15457         MOVE ZEROS TO WS-DEFAULT-APR.
 15458****   N O T E   ****
 15459*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15460*      THE OH HARD CODING IN ELCRFNDP
 15461
 15462     IF PB-COMPANY-ID = 'CID'
 15463        IF CP-STATE-STD-ABBRV = 'OH'
 15464           MOVE WS-LF-EARNINGS-CALC
 15465                                 TO CP-EARNING-METHOD
 15466        END-IF
 15467     END-IF
 15468
 15469****   N O T E   ****
 15470
 15471     IF CP-EARN-AS-NET-PAY
 15472         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15473            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15474                MOVE WS-DEFAULT-APR
 15475                                 TO  CP-LOAN-APR
 15476                MOVE ER-3780     TO  WS-ERROR
 15477                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15478            ELSE
 15479                MOVE ER-3781     TO  WS-ERROR
 15480                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15481     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15482     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15483
 15484     IF CP-REFUND-TYPE-USED NOT = SPACE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 280
* EL050.cbl
 15485         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15486
 15487     IF CP-ERROR-RATE-IS-ZERO OR
 15488        CP-ERROR-RATE-NOT-FOUND
 15489        MOVE ER-2740             TO WS-ERROR
 15490        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15491
 15492     IF CP-ERROR-RATE-FILE-NOTOPEN
 15493        MOVE ER-2617             TO WS-ERROR
 15494        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15495
 15496     IF PB-COMPANY-ID = 'DCC'
 15497        AND PB-CI-ENTRY-STATUS = 'M'
 15498        MOVE +0                  TO PB-C-LF-REF-CALC
 15499     ELSE
 15500        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15501     END-IF
 15502
 15503     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15504         GO TO 3730-GET-AH-REMAIN-TERM.
 15505
 15506*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15507*       ADD +1                   TO PB-C-LF-REM-TERM
 15508*                                   CP-REMAINING-TERM
 15509*                                   CP-ORIGINAL-TERM.
 15510
 15511     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15512     MOVE '2'                    TO CP-EARNING-METHOD
 15513                                    CP-RATING-METHOD.
 15514     IF PB-COMPANY-ID = 'CID'
 15515        IF (CP-STATE-STD-ABBRV = 'MN')
 15516           AND (PB-CERT-EFF-DT > X'A4FF')
 15517           AND (WS-LF-EARNINGS-CALC = 'B')
 15518           MOVE '5'              TO CP-EARNING-METHOD
 15519           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15520        END-IF
 15521     END-IF
 15522     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15523                                        CP-REMAINING-BENEFIT
 15524                                        CP-RATING-BENEFIT-AMT.
 15525     IF CP-STATE-STD-ABBRV = 'OR'
 15526         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15527                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15528     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15529     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15530
 15531     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15532
 15533     IF CP-ERROR-RATE-IS-ZERO OR
 15534        CP-ERROR-RATE-NOT-FOUND
 15535        MOVE ER-2740             TO WS-ERROR
 15536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15537
 15538     IF CP-ERROR-RATE-FILE-NOTOPEN
 15539        MOVE ER-2617             TO WS-ERROR
 15540        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15541
 15542     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 281
* EL050.cbl
 15543
 15544******************************************************************
 15545
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 282
* EL050.cbl
 15547 3730-GET-AH-REMAIN-TERM.
 15548     IF NO-AH-BENEFIT-MATCH  OR
 15549        WS-AH-BENEFIT-CD = ZEROS
 15550         GO TO 3770-CHECK-REFUNDS.
 15551
 15552     IF PB-CI-AH-LUMP-SUM-DISAB
 15553         IF  PB-C-AH-CANCEL-AMT = ZERO
 15554            IF NOT PB-COMP-AH-CANCEL
 15555             GO TO 3770-CHECK-REFUNDS.
 15556
 15557     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15558     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15559     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15560     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15561     MOVE PB-SV-STATE            TO CP-STATE.
 15562     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15563     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15564     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15565     MOVE '2'                    TO CP-PROCESS-TYPE.
 15566     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15567     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15568     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15569     IF (PB-COMPANY-ID = 'CID')
 15570        AND (CP-STATE-STD-ABBRV = 'WI')
 15571        MOVE '7'                 TO CP-REM-TERM-METHOD
 15572        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15573     ELSE
 15574        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15575        MOVE WS-REM-TRM-CALC-OPTION
 15576                                 TO CP-REM-TRM-CALC-OPTION
 15577     END-IF
 15578     IF (PB-COMPANY-ID = 'CID')
 15579        AND (CP-STATE-STD-ABBRV = 'MO')
 15580        AND (PB-CERT-EFF-DT >= X'9B41')
 15581        AND (PB-CERT-EFF-DT <= X'A2FB')
 15582        MOVE '7'                 TO CP-REM-TERM-METHOD
 15583        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15584     END-IF
 15585     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15586                                    CP-LOAN-TERM.
 15587     IF NOT CP-TERM-IS-DAYS
 15588         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15589
 15590     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15591
 15592     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15593
 15594     IF AH-COVERAGE-CANCELLED
 15595        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15596        NEXT SENTENCE
 15597      ELSE
 15598         GO TO 3770-CHECK-REFUNDS.
 15599
 15600 3740-GET-AH-REFUND.
 15601
 15602     IF PB-C-LF-CANCEL-VOIDED OR
 15603        PB-C-AH-CANCEL-VOIDED
 15604        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 283
* EL050.cbl
 15605
 15606     IF PB-COMPANY-ID = 'BOA'
 15607         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15608         GO TO 3770-CHECK-REFUNDS.
 15609
 15610     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15611*    MOVE ' '                    TO DC-OPTION-CODE
 15612     SET BIN-TO-GREG             TO TRUE
 15613     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15614     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15615                                    PB-C-AH-REM-TERM.
 15616     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15617     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15618
 15619     IF PB-COMPANY-ID EQUAL 'FLC'
 15620        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15621           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15622           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15623                    - CM-AH-ITD-AH-PMT)
 15624           IF PB-C-AH-REF-CALC LESS THAN +0
 15625              MOVE +0            TO PB-C-AH-REF-CALC
 15626              GO TO 3770-CHECK-REFUNDS
 15627           ELSE
 15628              GO TO 3770-CHECK-REFUNDS.
 15629
 15630     IF PB-COMPANY-ID = 'DCC'
 15631        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15632            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15633           MOVE 'S'              TO CP-EARNING-METHOD
 15634        END-IF
 15635     END-IF
 15636     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15637                            OR '4' OR '5' OR '6' OR '8'
 15638                            OR '9' OR 'G' OR 'S'
 15639        MOVE PB-C-AH-REFUND-OVERRIDE
 15640                                 TO CP-EARNING-METHOD.
 15641
 15642     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15643     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15644     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15645                                    CP-RATING-BENEFIT-AMT.
 15646     IF CP-STATE-STD-ABBRV = 'OR'
 15647         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15648                                         PB-CI-AH-TERM.
 15649     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15650     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15651     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15652     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15653     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15654     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15655
 15656     IF CP-STATE-STD-ABBRV = 'OH'
 15657        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15658                                AND 'CID' AND 'DCC')
 15659           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15660              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15661              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15662              MOVE '6' TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 284
* EL050.cbl
 15663           END-IF
 15664        END-IF
 15665        IF PB-COMPANY-ID = 'CID'
 15666           IF NO-LIFE-COVERAGE
 15667              IF CP-CRITICAL-PERIOD
 15668                 MOVE '2'       TO CP-EARNING-METHOD
 15669              ELSE
 15670                 MOVE '6'       TO CP-EARNING-METHOD
 15671              END-IF
 15672           ELSE
 15673              IF WS-LF-COVERAGE-TYPE = 'L'
 15674                 MOVE '2'       TO CP-EARNING-METHOD
 15675              ELSE
 15676                 IF (PB-CI-LF-TERM > +60) OR
 15677                    (WS-LF-EARNINGS-CALC = '5')
 15678                    IF CP-CRITICAL-PERIOD
 15679                       MOVE '2'  TO CP-EARNING-METHOD
 15680                    ELSE
 15681                       MOVE '6'  TO CP-EARNING-METHOD
 15682                    END-IF
 15683                 ELSE
 15684                    MOVE '1'     TO CP-EARNING-METHOD
 15685                 END-IF
 15686              END-IF
 15687           END-IF
 15688        END-IF
 15689     END-IF
 15690
 15691*    IF CP-STATE-STD-ABBRV = 'VA'
 15692*       IF DC-GREG-DATE-CYMD GREATER 19921231
 15693*          IF CP-ORIGINAL-TERM GREATER 61
 15694*             MOVE '6' TO CP-EARNING-METHOD
 15695*          ELSE
 15696*             MOVE '1' TO CP-EARNING-METHOD.
 15697
 15698     IF WS-DEFAULT-APR NOT NUMERIC
 15699         MOVE ZEROS TO WS-DEFAULT-APR.
 15700     IF CP-EARN-AS-NET-PAY
 15701         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15702            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15703                MOVE WS-DEFAULT-APR
 15704                                 TO  CP-LOAN-APR
 15705                MOVE ER-3780     TO  WS-ERROR
 15706                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15707            ELSE
 15708                MOVE ER-3781     TO  WS-ERROR
 15709                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15710     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15711     IF PB-COMPANY-ID = 'DCC'
 15712        AND CP-CANCEL-REASON = 'R'
 15713        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15714        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 15715     END-IF
 15716     IF PB-COMPANY-ID = 'DCC'
 15717        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15718        AND (CP-EARNING-METHOD = 'D')
 15719        AND (CP-CANCEL-REASON NOT = 'R')
 15720        MOVE ' '                 TO DD-IU-SW
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 285
* EL050.cbl
 15721        MOVE ' '                 TO PDEF-MASTER-SW
 15722        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15723        MOVE PB-STATE            TO ERPDEF-STATE
 15724        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15725        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15726        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15727        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15728        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15729        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15730        IF PDEF-MASTER-FOUND
 15731           MOVE 'N'              TO PDEF-MASTER-SW
 15732           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15733           IF PDEF-MASTER-FOUND
 15734              IF (ERPDEF-KEY-SAVE (1:16) =
 15735                           PD-CONTROL-PRIMARY (1:16))
 15736                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15737                 CONTINUE
 15738              ELSE
 15739                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15740                 IF (ERPDEF-KEY-SAVE (1:16) =
 15741                           PD-CONTROL-PRIMARY (1:16))
 15742                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15743                    CONTINUE
 15744                 ELSE
 15745                    MOVE ER-2740 TO WS-ERROR
 15746                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15747                    GO TO 3770-CHECK-REFUNDS
 15748                 END-IF
 15749              END-IF
 15750
 15751              PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15752                 (V1 > +8)
 15753                 OR (PD-PROD-CODE (V1) = 'I')
 15754              END-PERFORM
 15755              IF V1 < +9
 15756                 SET DD-IU-PRESENT        TO TRUE
 15757              END-IF
 15758
 15759              EVALUATE TRUE
 15760                 WHEN CP-ORIGINAL-TERM > +168
 15761                    MOVE 15               TO V1
 15762                 WHEN CP-ORIGINAL-TERM > +156
 15763                    MOVE 14               TO V1
 15764                 WHEN CP-ORIGINAL-TERM > +144
 15765                    MOVE 13               TO V1
 15766                 WHEN CP-ORIGINAL-TERM > +132
 15767                    MOVE 12               TO V1
 15768                 WHEN CP-ORIGINAL-TERM > +120
 15769                    MOVE 11               TO V1
 15770                 WHEN CP-ORIGINAL-TERM > +108
 15771                    MOVE 10               TO V1
 15772                 WHEN CP-ORIGINAL-TERM > +96
 15773                    MOVE 9                TO V1
 15774                 WHEN CP-ORIGINAL-TERM > +84
 15775                    MOVE 8                TO V1
 15776                 WHEN CP-ORIGINAL-TERM > +72
 15777                    MOVE 7                TO V1
 15778                 WHEN CP-ORIGINAL-TERM > +60
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 286
* EL050.cbl
 15779                    MOVE 6                TO V1
 15780                 WHEN CP-ORIGINAL-TERM > +48
 15781                    MOVE 5                TO V1
 15782                 WHEN CP-ORIGINAL-TERM > +36
 15783                    MOVE 4                TO V1
 15784                 WHEN CP-ORIGINAL-TERM > +24
 15785                    MOVE 3                TO V1
 15786                 WHEN CP-ORIGINAL-TERM > +12
 15787                    MOVE 2                TO V1
 15788                 WHEN OTHER
 15789                    MOVE 1                TO V1
 15790              END-EVALUATE
 15791
 15792              EVALUATE TRUE
 15793*                WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 15794*                   < +13)
 15795*                   AND (DD-IU-PRESENT)
 15796*                   MOVE 2                TO V2
 15797*                WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 15798*                   MOVE 1                TO V2
 15799                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 15800                    MOVE 2                TO V2
 15801                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 15802                    MOVE 3                TO V2
 15803                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 15804                    MOVE 4                TO V2
 15805                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 15806                    MOVE 5                TO V2
 15807                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 15808                    MOVE 6                TO V2
 15809                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 15810                    MOVE 7                TO V2
 15811                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 15812                    MOVE 8                TO V2
 15813                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +10
 15814                    MOVE 9                TO V2
 15815                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +12
 15816                    MOVE 10               TO V2
 15817                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 15818                    MOVE 11               TO V2
 15819                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +14
 15820                    MOVE 12               TO V2
 15821                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +15
 15822                    MOVE 13               TO V2
 15823                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +16
 15824                    MOVE 14               TO V2
 15825                 WHEN OTHER
 15826                    MOVE 15               TO V2
 15827              END-EVALUATE
 15828
 15829              MOVE PD-UEP-FACTOR (V1 V2 + 1)
 15830                                       TO CP-DDF-LO-FACT
 15831              MOVE PD-UEP-FACTOR (V1 V2)
 15832                                       TO CP-DDF-HI-FACT
 15833
 15834              MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 15835              MOVE CM-AH-CLP     TO CP-DDF-CLP
 15836              COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 287
* EL050.cbl
 15837                 (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 15838              MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 15839              MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 15840              COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 15841                 + PD-1ST-YR-ADMIN-ALLOW
 15842
 15843              MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15844*             IF PI-CLP-YN = 'Y'
 15845*                MOVE 'C'              TO CP-DDF-SPEC-CALC
 15846*                MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 15847*                MOVE ZEROS            TO CP-DDF-ADDL-CLP
 15848*             END-IF
 15849
 15850              IF DD-IU-PRESENT
 15851                 MOVE 'I'              TO CP-EARNING-METHOD
 15852              END-IF
 15853              MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 15854                                           CP-CLP-RATE-UP
 15855              IF CP-IU-RATE-UP NOT = ZEROS
 15856                 COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 15857                    + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 15858                 COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 15859                    / (1 - WS-WORK-FACT)
 15860              END-IF
 15861           END-IF
 15862           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15863        END-IF
 15864     END-IF
 15865     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15866
 15867     IF CP-REFUND-TYPE-USED NOT = SPACE
 15868         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 15869
 15870     IF CP-ERROR-RATE-IS-ZERO OR
 15871        CP-ERROR-RATE-NOT-FOUND
 15872        MOVE ER-2740             TO WS-ERROR
 15873        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15874
 15875     IF CP-ERROR-RATE-FILE-NOTOPEN
 15876        MOVE ER-2617             TO WS-ERROR
 15877        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15878     IF PB-COMPANY-ID = 'DCC'
 15879        AND PB-CI-ENTRY-STATUS = 'M'
 15880        MOVE +0                  TO PB-C-AH-REF-CALC
 15881     ELSE
 15882        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 15883     END-IF
 15884     IF PB-COMPANY-ID = 'DCC'
 15885        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15886        AND (CP-EARNING-METHOD = 'D' OR 'I')
 15887        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 15888        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 15889        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 15890        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 15891        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 15892        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 15893        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 15894     END-IF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 288
* EL050.cbl
 15895     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 289
* EL050.cbl
 15897
 15898 3770-CHECK-REFUNDS.
 15899
 15900     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 15901        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 15902           MOVE ER-2766          TO WS-ERROR
 15903           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15904           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 15905           IF PB-C-LF-REF-CALC LESS THAN ZERO
 15906              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 15907
 15908     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 15909        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 15910           MOVE ER-2766          TO WS-ERROR
 15911           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15912           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 15913           IF PB-C-AH-REF-CALC LESS THAN ZERO
 15914              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 15915
 15916     IF PB-COMP-LF-CANCEL
 15917        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 15918        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 15919           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 15920              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 15921
 15922     IF PB-COMP-AH-CANCEL
 15923        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 15924        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 15925           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 15926              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 15927
 15928     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 15929             GIVING WS-UNSIGN-WRK1
 15930     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 15931             GIVING WS-UNSIGN-WRK2.
 15932
 15933     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15934         MOVE ZERO TO WS-UNSIGN-WRK1.
 15935
 15936     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15937         MOVE ZERO TO WS-UNSIGN-WRK2.
 15938
 15939     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 15940
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 290
* EL050.cbl
 15942
 15943 3772-CONTINUE.
 15944
 15945**********************************
 15946*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 15947*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 15948*** DOUBLES THE TOLERANCE AMOUNT.
 15949***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 15950**********************************
 15951     IF PB-COMPANY-ID = 'MON'
 15952     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 15953         IF WS-REF-REJECT-SW = SPACE
 15954             MOVE ER-2754        TO WS-ERROR
 15955             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15956           ELSE
 15957             MOVE ER-2736        TO WS-ERROR
 15958             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15959**********************************
 15960
 15961 3773-CONTINUE.
 15962
 15963     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 15964        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 15965           MOVE ER-2723          TO WS-ERROR
 15966           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15967
 15968     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 15969        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 15970           MOVE ER-2724          TO WS-ERROR
 15971           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15972
 15973     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 15974         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 15975             (1 + WS-LF-REFUND-OVS-PCT)
 15976     ELSE
 15977         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 15978
 15979     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 15980         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 15981             (1 - WS-TOL-LF-REFUND-PCT)
 15982     ELSE
 15983         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15984
 15985     IF (PB-COMPANY-ID = 'DCC')
 15986        AND (PB-CI-ENTRY-STATUS = 'M')
 15987        AND (PB-C-LF-CANCEL-AMT > +0)
 15988        MOVE ER-3843             TO WS-ERROR
 15989        PERFORM 9900-ERROR-FORMAT
 15990                                 THRU 9900-EXIT
 15991     END-IF
 15992     EVALUATE TRUE
 15993        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 15994           CONTINUE
 15995        WHEN PB-C-LF-CANCEL-AMT = +0
 15996                 AND PB-C-LF-REF-CALC > +0
 15997           CONTINUE
 15998        WHEN WS-LF-REFUND-OVS-AMT = 0
 15999                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 291
* EL050.cbl
 16000           CONTINUE
 16001        WHEN OTHER
 16002           IF WS-TOL-LF-REFUND  = +0
 16003              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16004           END-IF
 16005           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16006                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16007                          (PB-C-LF-CANCEL-AMT))
 16008              CONTINUE
 16009           ELSE
 16010              IF WS-LF-REFUND-OVS-AMT = +0
 16011                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16012              END-IF
 16013              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16014                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16015                                       PB-C-LF-CANCEL-AMT)
 16016                 CONTINUE
 16017              ELSE
 16018                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16019                   MOVE ER-2754   TO  WS-ERROR
 16020                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16021                 ELSE
 16022                    MOVE ER-2736   TO  WS-ERROR
 16023                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16024                 END-IF
 16025              END-IF
 16026           END-IF
 16027     END-EVALUATE.
 16028
 16029     EVALUATE TRUE
 16030        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16031           CONTINUE
 16032        WHEN PB-C-LF-CANCEL-AMT = +0
 16033                 AND PB-C-LF-REF-CALC > +0
 16034           CONTINUE
 16035        WHEN OTHER
 16036           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16037               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16038              CONTINUE
 16039           ELSE
 16040              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16041               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16042                CONTINUE
 16043              ELSE
 16044                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16045                     MOVE ER-2754   TO  WS-ERROR
 16046                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16047                 ELSE
 16048                     MOVE ER-2736   TO  WS-ERROR
 16049                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16050                 END-IF
 16051              END-IF
 16052           END-IF
 16053     END-EVALUATE.
 16054
 16055     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16056         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16057             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 292
* EL050.cbl
 16058     ELSE
 16059         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16060
 16061     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16062         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16063             (1 - WS-TOL-AH-REFUND-PCT)
 16064     ELSE
 16065         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16066
 16067     IF (PB-COMPANY-ID = 'DCC')
 16068        AND (PB-CI-ENTRY-STATUS = 'M')
 16069        AND (PB-C-AH-CANCEL-AMT > +0)
 16070        MOVE ER-3843             TO WS-ERROR
 16071        PERFORM 9900-ERROR-FORMAT
 16072                                 THRU 9900-EXIT
 16073     END-IF
 16074     EVALUATE TRUE
 16075        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16076           CONTINUE
 16077*       WHEN PB-C-AH-REF-CALC = +0 AND
 16078*                  PB-C-AH-CANCEL-AMT > +0
 16079        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16080                   PB-C-AH-REF-CALC > +0
 16081           CONTINUE
 16082        WHEN WS-AH-REFUND-OVS-AMT = +0
 16083                AND WS-TOL-AH-REFUND = +0
 16084           CONTINUE
 16085        WHEN OTHER
 16086           IF WS-TOL-AH-REFUND = +0
 16087              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16088           END-IF
 16089           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16090               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16091                                         PB-C-AH-CANCEL-AMT)
 16092              CONTINUE
 16093           ELSE
 16094              IF WS-AH-REFUND-OVS-AMT = +0
 16095                 MOVE +9999999.99 TO
 16096                         WS-AH-REFUND-OVS-AMT
 16097              END-IF
 16098              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16099                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16100                                         PB-C-AH-CANCEL-AMT)
 16101                 CONTINUE
 16102              ELSE
 16103                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16104                    MOVE ER-2754   TO  WS-ERROR
 16105                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16106                 ELSE
 16107                    MOVE ER-2736   TO  WS-ERROR
 16108                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16109                 END-IF
 16110              END-IF
 16111           END-IF
 16112     END-EVALUATE.
 16113
 16114     EVALUATE TRUE
 16115        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 293
* EL050.cbl
 16116           CONTINUE
 16117*       WHEN PB-C-AH-REF-CALC > +0 AND
 16118*                  PB-C-AH-CANCEL-AMT = +0
 16119        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16120                   PB-C-AH-REF-CALC = +0
 16121           CONTINUE
 16122        WHEN OTHER
 16123           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16124               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16125              CONTINUE
 16126           ELSE
 16127              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16128                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16129                 CONTINUE
 16130              ELSE
 16131                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16132                     MOVE ER-2754   TO  WS-ERROR
 16133                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16134                 ELSE
 16135                     MOVE ER-2736   TO  WS-ERROR
 16136                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16137                 END-IF
 16138              END-IF
 16139           END-IF
 16140     END-EVALUATE.
 16141
 16142     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16143        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16144        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16145           AND  PB-C-LF-REF-CALC < +1.00
 16146           AND  PB-C-AH-REF-CALC < +1.00
 16147           CONTINUE
 16148        ELSE
 16149           IF (PB-COMPANY-ID = 'DCC')
 16150              AND (PB-CI-ENTRY-STATUS = 'M')
 16151              CONTINUE
 16152           ELSE
 16153              MOVE ER-2741       TO WS-ERROR
 16154              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16155           END-IF
 16156        END-IF
 16157     END-IF
 16158
 16159     IF (PB-C-LF-CANCEL-AMT = ZERO
 16160        AND WS-LF-BENEFIT-CD NOT = ZERO
 16161        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16162        AND PB-C-LF-REF-CALC NOT = ZERO)
 16163        OR
 16164        (PB-C-LF-CANCEL-AMT = ZERO
 16165        AND WS-LF-BENEFIT-CD NOT = ZERO
 16166        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16167             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16168                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16169                NEXT SENTENCE
 16170             ELSE
 16171                MOVE ER-2739        TO WS-ERROR
 16172                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16173
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 294
* EL050.cbl
 16174     IF (PB-C-AH-CANCEL-AMT = ZERO
 16175        AND WS-AH-BENEFIT-CD NOT = ZERO
 16176        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16177        AND PB-C-AH-REF-CALC NOT = ZERO)
 16178        OR
 16179        (PB-C-AH-CANCEL-AMT = ZERO
 16180        AND WS-AH-BENEFIT-CD NOT = ZERO
 16181        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16182             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16183                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16184                NEXT SENTENCE
 16185             ELSE
 16186                MOVE ER-2738        TO WS-ERROR
 16187                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16188
 16189 3775-OVER-REF-CHK.
 16190
 16191     IF PB-CI-ENTRY-STATUS = '5'
 16192        GO TO 3780-UPDATE-CANCEL-CERT.
 16193
 16194     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16195                              PB-CI-LF-ALT-PREMIUM-AMT.
 16196
 16197     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16198        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16199                                 PB-C-LF-REF-CALC
 16200      ELSE
 16201        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16202                                 PB-C-LF-CANCEL-AMT.
 16203
 16204     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16205        MOVE ER-2755             TO WS-ERROR
 16206        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16207
 16208     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16209
 16210     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16211        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16212                                 PB-C-AH-REF-CALC
 16213      ELSE
 16214        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16215                                 PB-C-AH-CANCEL-AMT.
 16216
 16217     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16218        MOVE ER-2778             TO WS-ERROR
 16219        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16220
 16221     IF PB-CI-OB-FLAG NOT = 'Z'
 16222        NEXT SENTENCE
 16223       ELSE
 16224         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16225            MOVE ER-2757           TO WS-ERROR
 16226            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16227
 16228 3780-UPDATE-CANCEL-CERT.
 16229
 16230     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16231        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 295
* EL050.cbl
 16232        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16233
 16234     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16235         MOVE ER-2729              TO WS-ERROR
 16236         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16237
 16238     IF PB-CI-LF-BENEFIT-CD = ZERO
 16239         GO TO 3780-UPDATE-CONT-1.
 16240
 16241     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16242         GO TO 3780-UPDATE-CONT-1.
 16243
 16244     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16245       AND
 16246        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16247       AND
 16248        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16249       AND
 16250        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16251            NEXT SENTENCE
 16252       ELSE
 16253        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16254          AND
 16255***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16256***       AND
 16257           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16258            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16259               MOVE ER-2730      TO WS-ERROR
 16260               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16261               GO TO 3999-END-EDIT
 16262            ELSE
 16263               GO TO 3999-END-EDIT
 16264        ELSE
 16265            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16266               MOVE ER-2765           TO WS-ERROR
 16267               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16268               GO TO 3785-CHECK-NH.
 16269*              GO TO 3999-END-EDIT.
 16270
 16271 3780-UPDATE-CONT-1.
 16272     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16273
 16274     IF PB-CI-AH-BENEFIT-CD = ZERO
 16275         GO TO 3780-UPDATE-CONT-2.
 16276
 16277     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16278         GO TO 3780-UPDATE-CONT-2.
 16279
 16280     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16281
 16282     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16283       AND
 16284        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16285       AND
 16286        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16287       AND
 16288        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16289            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 296
* EL050.cbl
 16290       ELSE
 16291        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16292          AND
 16293***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16294***       AND
 16295           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16296           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16297            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16298               MOVE ER-2773      TO WS-ERROR
 16299               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16300               GO TO 3999-END-EDIT
 16301            ELSE
 16302               GO TO 3999-END-EDIT
 16303            END-IF
 16304           ELSE
 16305             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16306                MOVE ER-2890 TO WS-ERROR
 16307                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16308                GO TO 3999-END-EDIT
 16309             ELSE
 16310                GO TO 3785-CHECK-NH
 16311             END-IF
 16312           END-IF
 16313          ELSE
 16314            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16315              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16316                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16317                   MOVE ER-2890 TO WS-ERROR
 16318                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16319                   GO TO 3999-END-EDIT
 16320                ELSE
 16321                   MOVE ER-2765 TO WS-ERROR
 16322                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16323                   GO TO 3785-CHECK-NH
 16324                END-IF
 16325              ELSE
 16326               MOVE ER-2765      TO WS-ERROR
 16327               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16328               GO TO 3785-CHECK-NH.
 16329*              GO TO 3999-END-EDIT.
 16330
 16331 3780-UPDATE-CONT-2.
 16332
 16333     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16334        AND WS-LF-BENEFIT-CD = ZERO
 16335           MOVE ER-2743           TO WS-ERROR
 16336           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16337
 16338     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16339        AND WS-AH-BENEFIT-CD = ZERO
 16340           MOVE ER-2744           TO WS-ERROR
 16341           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16342
 16343     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16344        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16345        AND
 16346        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16347         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 297
* EL050.cbl
 16348           MOVE ER-2746           TO WS-ERROR
 16349           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16350
 16351     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16352       AND
 16353        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16354             MOVE ER-2737        TO WS-ERROR
 16355             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16356
 16357     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16358       AND
 16359        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16360             MOVE ER-2737        TO WS-ERROR
 16361             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16362
 16363     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16364         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16365             OR 'CID' OR 'DCC'
 16366             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16367         ELSE
 16368             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16369                 MOVE ER-2768    TO WS-ERROR
 16370                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16371             ELSE
 16372                 MOVE ER-2756    TO WS-ERROR
 16373                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16374
 16375     IF CERT-PEND-ISSUE-RETURNED
 16376        MOVE ER-2772             TO WS-ERROR
 16377        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16378 3785-CHECK-NH.
 16379     IF PB-STATE NOT = 'NH'
 16380        GO TO 3999-END-EDIT
 16381     END-IF
 16382
 16383     MOVE ER-2796                TO WS-ERROR
 16384     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16385     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16386        OR (CM-NH-INTERFACE-SW = 'Y')
 16387        MOVE ER-2793             TO WS-ERROR
 16388        PERFORM 9900-ERROR-FORMAT
 16389                                 THRU 9900-EXIT
 16390     END-IF
 16391     MOVE +0                     TO WS-PAYMENT-AMT
 16392     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16393        GO TO 3999-END-EDIT
 16394     END-IF
 16395     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16396        GO TO 3999-END-EDIT
 16397     END-IF
 16398     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16399     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16400     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16401        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16402     END-IF
 16403     MOVE '1'                    TO DC-OPTION-CODE
 16404     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16405     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 298
* EL050.cbl
 16406        IF DC-ELAPSED-DAYS < +16
 16407           GO TO 3999-END-EDIT
 16408        END-IF
 16409     END-IF
 16410     MOVE +0                     TO DC-ELAPSED-DAYS
 16411     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16412     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16413     MOVE '1'                    TO DC-OPTION-CODE
 16414     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16415     IF NO-CONVERSION-ERROR
 16416        IF DC-ELAPSED-DAYS > +30
 16417           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16418        ELSE
 16419           GO TO 3999-END-EDIT
 16420        END-IF
 16421     ELSE
 16422        GO TO 3999-END-EDIT
 16423     END-IF
 16424     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16425        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16426           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16427     IF WS-PAYMENT-AMT < 600.00
 16428        GO TO 3999-END-EDIT
 16429     END-IF
 16430     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16431
 16432     IF (ERMAIL-FOUND = ' ')
 16433         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16434         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16435        GO TO 3999-END-EDIT
 16436     END-IF
 16437     MOVE ER-2795                TO WS-ERROR
 16438     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16439
 16440     GO TO 3999-END-EDIT.
 16441******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 299
* EL050.cbl
 16443 3990-FILES-NOT-OPEN.
 16444
 16445     MOVE ER-2617                TO WS-ERROR.
 16446     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16447     GO TO 9990-RETURN.
 16448
 16449 3999-END-EDIT.
 16450
 16451     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16452
 16453     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16454         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16455         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16456             PERFORM 9250-UNLOCK-RETURN
 16457             GO TO 9990-RETURN
 16458          ELSE
 16459             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16460             GO TO 9990-RETURN.
 16461
 16462     IF PB-CANCELLATION
 16463          GO TO 9990-RETURN.
 16464
 16465     IF CERT-WAS-NOT-FOUND
 16466        MOVE SPACES              TO CERTIFICATE-MASTER.
 16467
 16468     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16469
 16470     IF CERT-WAS-FOUND
 16471         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16472             PERFORM 9250-UNLOCK-RETURN
 16473          ELSE
 16474            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16475      ELSE
 16476         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16477
 16478     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16479        IF PB-COMPANY-ID = 'DCC' AND
 16480           (PB-CARRIER = '2' OR '4' OR '6')
 16481              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16482        END-IF
 16483     END-IF.
 16484
 16485     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16486     IF ((PB-COMPANY-ID = 'DCC')
 16487        AND (WS-NO-SECURE-PAY))
 16488                  OR
 16489        (WS-LF-SPECIAL-CALC-CD = 'O'
 16490        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16491        SET SKIP-ADDR-EDIT       TO TRUE
 16492     END-IF
 16493     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16494        AND (NOT SKIP-ADDR-EDIT)
 16495        MOVE ER-2963             TO WS-ERROR
 16496        PERFORM 9900-ERROR-FORMAT
 16497                                 THRU 9900-EXIT
 16498        GO TO 9990-RETURN
 16499     END-IF
 16500     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 300
* EL050.cbl
 16501     IF ERPNDM-FOUND NOT = 'X'
 16502        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16503           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16504           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16505           AND (NOT SKIP-ADDR-EDIT)
 16506           MOVE ER-2694          TO WS-ERROR
 16507           PERFORM 9900-ERROR-FORMAT
 16508                                 THRU 9900-EXIT
 16509        END-IF
 16510        MOVE ' '                 TO STATE-RECORD-ERROR
 16511        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16512        MOVE PM-STATE            TO CNTL-ACCESS
 16513        MOVE '3'                 TO CNTL-REC-TYPE
 16514        MOVE +0                  TO CNTL-SEQ-NO
 16515        MOVE '0'                 TO RC-SW-2
 16516        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16517        IF (NO-STATE-RECORD)
 16518           OR (CF-RECORD-TYPE NOT = '3')
 16519           OR (PM-STATE NOT = CF-STATE-CODE)
 16520           IF (PM-STATE = SPACES)
 16521              AND (SKIP-ADDR-EDIT)
 16522              CONTINUE
 16523           ELSE
 16524              MOVE ER-2963       TO WS-ERROR
 16525              PERFORM 9900-ERROR-FORMAT
 16526                                 THRU 9900-EXIT
 16527           END-IF
 16528        END-IF
 16529        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16530           MOVE ER-2883          TO WS-ERROR
 16531           PERFORM 9900-ERROR-FORMAT
 16532                                 THRU 9900-EXIT
 16533        END-IF
 16534        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16535           MOVE ' '                 TO STATE-RECORD-ERROR
 16536           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16537           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16538           MOVE '3'                 TO CNTL-REC-TYPE
 16539           MOVE +0                  TO CNTL-SEQ-NO
 16540           MOVE '0'                 TO RC-SW-2
 16541           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16542           IF NO-STATE-RECORD
 16543              OR (CF-RECORD-TYPE NOT = '3')
 16544              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16545              MOVE ER-2964          TO WS-ERROR
 16546              PERFORM 9900-ERROR-FORMAT
 16547                                    THRU 9900-EXIT
 16548           END-IF
 16549        END-IF
 16550     ELSE
 16551        IF NOT SKIP-ADDR-EDIT
 16552           MOVE ER-2393          TO WS-ERROR
 16553           PERFORM 9900-ERROR-FORMAT
 16554                                 THRU 9900-EXIT
 16555        END-IF
 16556     END-IF
 16557
 16558     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 301
* EL050.cbl
 16559
 16560     IF (ERMAIL-FOUND = ' ' AND
 16561        ERPNDM-FOUND = ' ')
 16562        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16563           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16564           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16565          OR
 16566           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16567          OR
 16568           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16569           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16570           GO TO 3999-UNLOCK-ERMAIL.
 16571
 16572     IF ERPNDM-FOUND = 'X'
 16573        GO TO 3999-UNLOCK-ERMAIL.
 16574
 16575     IF PM-INSURED-LAST-NAME      = SPACES
 16576        AND PM-INSURED-FIRST-NAME = SPACES
 16577        AND PM-ADDRESS-LINE-1     = SPACES
 16578        AND PM-ADDRESS-LINE-2     = SPACES
 16579        AND PM-CITY-STATE         = SPACES
 16580        AND PM-CRED-BENE-NAME     = SPACES
 16581        AND PM-CRED-BENE-ADDR     = SPACES
 16582        AND PM-CRED-BENE-CTYST    = SPACES
 16583        GO TO 3999-UNLOCK-ERMAIL
 16584     END-IF
 16585
 16586     MOVE SPACES                 TO MAILING-DATA.
 16587
 16588     MOVE 'MA'                   TO MA-RECORD-ID.
 16589     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16590     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16591     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16592     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16593     MOVE PB-SV-STATE            TO MA-STATE.
 16594     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16595     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16596
 16597     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16598     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16599
 16600     IF ERMAIL-FOUND = ' '
 16601        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16602     ELSE
 16603        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16604        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16605        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16606
 16607     GO TO 9990-RETURN.
 16608
 16609 3999-UNLOCK-ERMAIL.
 16610     IF ERMAIL-FOUND = ' '
 16611        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16612
 16613     GO TO 9990-RETURN.
 16614******************************************************************
 16615
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 302
* EL050.cbl
 16617 4000-UPDATE-CANCELLED-CERT.
 16618     IF CERT-WAS-NOT-FOUND
 16619        GO TO 4299-EXIT.
 16620
 16621*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16622     IF PB-C-NH-INT-ON-REFS > ZEROS
 16623        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16624     END-IF
 16625     IF PB-C-REF-INTERFACE-SW = 'Y'
 16626        MOVE PB-C-REF-INTERFACE-SW
 16627                                 TO CM-NH-INTERFACE-SW
 16628     END-IF
 16629     IF PB-C-POST-CARD-IND = 'Y'
 16630        MOVE +8                  TO SUB
 16631        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 16632        IF ERMAIL-FOUND = ' '
 16633           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 16634              (SUB > +7)
 16635              OR (MA-MAIL-STATUS (SUB) = '1')
 16636           END-PERFORM
 16637        END-IF
 16638        IF (SUB > +7)
 16639           OR (ERMAIL-FOUND = 'X')
 16640           MOVE ER-3789          TO WS-ERROR
 16641           PERFORM 9900-ERROR-FORMAT
 16642                                 THRU 9900-EXIT
 16643        END-IF
 16644     ELSE
 16645        MOVE 'N'                 TO PB-C-POST-CARD-IND
 16646     END-IF
 16647     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 16648
 16649     IF PB-CI-OB-FLAG = 'Z'
 16650        GO TO 4150-SUMMARY-CERT-CANCEL.
 16651
 16652     IF PB-C-LF-CANCEL-VOIDED
 16653         PERFORM 4200-REVERSE-LF-CANCEL.
 16654     IF PB-C-AH-CANCEL-VOIDED
 16655         PERFORM 4200-REVERSE-AH-CANCEL.
 16656
 16657 4100-APPLY-LF-CANCEL.
 16658
 16659     MOVE +0                     TO WS-SUB.
 16660
 16661 4100-CHECK-LF-ERRORS.
 16662
 16663     ADD +1                       TO WS-SUB.
 16664
 16665     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16666        IF LF-COVERAGE-CANCELLED
 16667           GO TO 4100-LF-CANCEL-CONT
 16668        ELSE
 16669           GO TO 4100-UPDATE-LF-COVERAGE.
 16670
 16671     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16672                                   ER-2729 OR
 16673                                   ER-2730 OR
 16674                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 303
* EL050.cbl
 16675                                   ER-2732 OR
 16676                                   ER-2737 OR
 16677                                   ER-2740 OR
 16678                                   ER-2743 OR
 16679                                   ER-2749 OR
 16680                                   ER-2750 OR
 16681                                   ER-2755 OR
 16682                                   ER-2757 OR
 16683                                   ER-2760 OR
 16684                                   ER-2772 OR
 16685                                   ER-2774 OR
 16686                                   ER-2776 OR
 16687                                   ER-2794
 16688        GO TO 4100-UPDATE-LF-COVERAGE.
 16689
 16690     GO TO 4100-CHECK-LF-ERRORS.
 16691
 16692 4100-UPDATE-LF-COVERAGE.
 16693
 16694     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 16695     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 16696     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 16697        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 16698     END-IF
 16699     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16700                                      TO CM-CREDIT-INTERFACE-SW-2.
 16701     IF CM-LF-CANCEL-DT = LOW-VALUE
 16702         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 16703
 16704     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 16705         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 16706                                         CM-LF-STATUS-AT-CANCEL.
 16707
 16708     GO TO 4100-APPLY-AH-CANCEL.
 16709
 16710 4100-LF-CANCEL-CONT.
 16711     IF PB-C-LF-CANCEL-VOIDED
 16712         GO TO 4100-APPLY-AH-CANCEL.
 16713
 16714     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16715         GO TO 4100-APPLY-AH-CANCEL.
 16716
 16717     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 16718        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16719           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 16720        ELSE
 16721           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 16722
 16723     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 16724     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 16725
 16726     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 16727         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 16728
 16729     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 16730        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 16731         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 16732         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 304
* EL050.cbl
 16733
 16734     IF PB-RECORD-RETURNED
 16735        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16736      ELSE
 16737        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 16738
 16739 4100-APPLY-AH-CANCEL.
 16740
 16741     MOVE +0                      TO WS-SUB.
 16742
 16743 4100-CHECK-AH-ERRORS.
 16744
 16745     ADD +1                       TO WS-SUB.
 16746
 16747     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16748        IF AH-COVERAGE-CANCELLED
 16749           GO TO 4100-AH-CANCEL-CONT
 16750        ELSE
 16751           GO TO 4100-UPDATE-AH-COVERAGE.
 16752
 16753     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16754                                   ER-2729 OR
 16755                                   ER-2732 OR
 16756                                   ER-2737 OR
 16757                                   ER-2740 OR
 16758                                   ER-2744 OR
 16759                                   ER-2749 OR
 16760                                   ER-2750 OR
 16761                                   ER-2755 OR
 16762                                   ER-2757 OR
 16763                                   ER-2760 OR
 16764                                   ER-2771 OR
 16765                                   ER-2772 OR
 16766                                   ER-2773 OR
 16767                                   ER-2775 OR
 16768                                   ER-2777 OR
 16769                                   ER-2794
 16770        GO TO 4100-UPDATE-AH-COVERAGE.
 16771
 16772     GO TO 4100-CHECK-AH-ERRORS.
 16773
 16774 4100-UPDATE-AH-COVERAGE.
 16775
 16776     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 16777     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 16778     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 16779     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16780                                      TO CM-CREDIT-INTERFACE-SW-2.
 16781     IF CM-AH-CANCEL-DT = LOW-VALUE
 16782         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 16783
 16784     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 16785         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 16786                                         CM-AH-STATUS-AT-CANCEL.
 16787
 16788     IF LF-COVERAGE-CANCELLED
 16789         IF PB-RECORD-RETURNED
 16790              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 305
* EL050.cbl
 16791          ELSE
 16792              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 16793
 16794     GO TO 4299-EXIT.
 16795
 16796 4100-AH-CANCEL-CONT.
 16797     IF PB-C-AH-CANCEL-VOIDED
 16798         GO TO 4299-EXIT.
 16799
 16800     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16801         GO TO 4299-EXIT.
 16802
 16803     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 16804        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16805           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 16806        ELSE
 16807           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 16808
 16809     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 16810     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 16811
 16812     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 16813         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 16814
 16815     IF CM-AH-STATUS-AT-CANCEL = SPACE
 16816         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 16817         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 16818
 16819     IF PB-RECORD-RETURNED
 16820        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 16821      ELSE
 16822        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 16823
 16824     GO TO 4299-EXIT.
 16825
 16826 4150-SUMMARY-CERT-CANCEL.
 16827     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 16828
 16829     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16830        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16831                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 16832     ELSE
 16833        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16834                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 16835
 16836     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16837        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16838                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 16839     ELSE
 16840        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16841                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 16842
 16843     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16844        NEXT SENTENCE
 16845     ELSE
 16846        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 16847
 16848     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 306
* EL050.cbl
 16849
 16850 4200-REVERSE-LF-CANCEL.
 16851     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 16852
 16853     IF CM-LF-CANCEL-APPLIED
 16854        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 16855        MOVE SPACES                TO CM-LF-EXIT-BATCH
 16856        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 16857
 16858     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 16859
 16860     IF PB-RECORD-RETURNED
 16861        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16862       ELSE
 16863        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 16864
 16865 4200-REVERSE-LF-EXIT.
 16866       EXIT.
 16867
 16868 4200-REVERSE-AH-CANCEL.
 16869     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 16870
 16871     IF CM-AH-CANCEL-APPLIED
 16872        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 16873        MOVE SPACES                TO CM-AH-EXIT-BATCH
 16874        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 16875
 16876     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 16877
 16878     IF PB-RECORD-RETURNED
 16879        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16880       ELSE
 16881        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 16882
 16883 4200-REVERSE-AH-EXIT.
 16884       EXIT.
 16885
 16886 4299-EXIT.
 16887       EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 307
* EL050.cbl
 16889
 16890 4500-UPDATE-NEW-CERT.
 16891     IF CERT-WAS-FOUND
 16892         NEXT SENTENCE
 16893       ELSE
 16894         GO TO 4520-BUILD-NEW-KEY.
 16895
 16896     IF  CLASIC-CREATED-CERT
 16897         GO TO 4999-EXIT.
 16898
 16899     IF  CERT-WAS-CREATED-FOR-CLAIM
 16900         GO TO 4520-BUILD-NEW-KEY.
 16901
 16902     IF CERT-ADDED-BATCH
 16903        IF CM-RECORD-ID = 'CM'
 16904            GO TO 4999-EXIT.
 16905
 16906 4520-BUILD-NEW-KEY.
 16907* BUILD CONTROL PRIMARY
 16908
 16909     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 16910                                       CM-COMPANY-CD-A1
 16911                                       CM-COMPANY-CD-A2
 16912                                       CM-COMPANY-CD-A4
 16913                                       CM-COMPANY-CD-A5.
 16914
 16915     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 16916     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 16917     MOVE PB-SV-STATE               TO CM-STATE.
 16918     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 16919     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 16920     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 16921     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 16922
 16923     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 16924
 16925     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 16926     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 16927     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 16928     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 16929
 16930     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 16931        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 16932
 16933     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 16934         MOVE PB-SV-STATE            TO CM-SSN-STATE
 16935         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 16936         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 16937         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 16938     ELSE
 16939         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 16940
 16941     IF PB-COMPANY-ID   EQUAL  'CRI'
 16942         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 16943         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 16944         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 16945         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 16946         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 308
* EL050.cbl
 16947
 16948     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 16949        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 16950         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 16951
 16952     IF PB-COMPANY-ID  = 'LBL'
 16953        IF PB-I-JOINT-COVERAGE
 16954            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 16955                                           PB-I-MEMBER-NO
 16956            GO TO 4550-CONT-CERT-PROCESS.
 16957
 16958     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 16959        NEXT SENTENCE
 16960     ELSE
 16961        GO TO 4540-BUILD-MEMBER-NO.
 16962
 16963******************************************************************
 16964*                                                                *
 16965*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 16966*    FOR 'MON'.                                                  *
 16967*                                                                *
 16968******************************************************************
 16969
 16970     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 16971     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 16972     MOVE +1                     TO WS-SUB1
 16973                                    WS-SUB2.
 16974
 16975 4530-EDIT-MEMB-NAME.
 16976
 16977     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 16978        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 16979        ADD +1                       TO WS-SUB2.
 16980
 16981     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 16982        ADD +1                       TO WS-SUB1
 16983        GO TO 4530-EDIT-MEMB-NAME.
 16984
 16985     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 16986     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 16987     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 16988*    MOVE SPACE                      TO DC-OPTION-CODE.
 16989     SET  BIN-TO-GREG                TO TRUE.
 16990     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16991     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 16992
 16993     GO TO 4550-CONT-CERT-PROCESS.
 16994
 16995******************************************************************
 16996*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 16997******************************************************************
 16998
 16999 4540-BUILD-MEMBER-NO.
 17000
 17001     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17002         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17003         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17004         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 309
* EL050.cbl
 17005         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17006     ELSE
 17007         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17008
 17009     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17010        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17011         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17012
 17013 4550-CONT-CERT-PROCESS.
 17014
 17015*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17016*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17017*    ELSE
 17018*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17019
 17020     IF CERT-WAS-CREATED-FOR-CLAIM
 17021        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17022        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17023
 17024     IF CERT-AND-CLAIM-ONLINE
 17025        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17026        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17027
 17028     MOVE 'CM'                     TO CM-RECORD-ID.
 17029     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17030
 17031     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17032        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17033        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17034     ELSE
 17035        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17036        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17037
 17038     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17039     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17040     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17041     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17042     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17043     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17044     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17045                                      CM-LF-ITD-CANCEL-AMT
 17046                                      CM-LF-ITD-DEATH-AMT
 17047                                      CM-AH-ITD-AH-PMT
 17048                                      CM-AH-ITD-LUMP-PMT
 17049                                      CM-AH-ITD-CANCEL-AMT
 17050                                      CM-LF-NSP-PREMIUM-AMT
 17051                                      CM-AH-NSP-PREMIUM-AMT.
 17052*                                     CM-CLAIM-DEDUCT-WITHHELD
 17053*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17054     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17055     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17056     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17057     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17058     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17059     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17060     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17061     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17062     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 310
* EL050.cbl
 17063     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17064     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17065     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17066
 17067     IF PB-I-LIVES NOT NUMERIC
 17068         MOVE ZERO                 TO PB-I-LIVES.
 17069
 17070     IF PB-I-NUM-BILLED NOT NUMERIC
 17071         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17072
 17073     MOVE PB-I-LIVES               TO CM-LIVES.
 17074     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17075
 17076     IF PB-COMPANY-ID EQUAL  'DMD'
 17077         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17078         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17079
 17080     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17081     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17082     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17083     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17084     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17085     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17086
 17087     IF PB-I-LF-POLICY-FEE NUMERIC
 17088        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17089     ELSE
 17090        MOVE +0                    TO CM-LF-POLICY-FEE.
 17091
 17092     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17093        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17094        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17095     ELSE
 17096        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17097
 17098     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17099     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17100     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17101     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17102     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17103     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17104     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17105     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17106     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17107
 17108     IF PB-I-AH-POLICY-FEE NUMERIC
 17109        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17110     ELSE
 17111        MOVE +0                    TO CM-AH-POLICY-FEE.
 17112
 17113     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17114        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17115     ELSE
 17116        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17117
 17118     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17119     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17120
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 311
* EL050.cbl
 17121     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17122                                      CM-LF-DEATH-EXIT-DT
 17123                                      CM-AH-SETTLEMENT-EXIT-DT.
 17124
 17125*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17126*                       'TIH' OR 'OFL' OR 'FLA' OR
 17127*                       'TII' OR 'TMS' OR 'CRI' OR
 17128*                       'NCL'
 17129     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17130
 17131     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17132         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17133            MOVE '2'                TO CM-PREMIUM-TYPE.
 17134
 17135     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17136         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17137            MOVE '2'                TO CM-PREMIUM-TYPE.
 17138
 17139     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17140         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17141     ELSE
 17142         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17143         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17144
 17145     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17146     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17147     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17148     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17149     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17150     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17151     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17152     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17153
 17154     IF PB-NO-MONTHS-SKIPPED
 17155         MOVE SPACE                 TO CM-SKIP-CODE
 17156     ELSE
 17157         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17158
 17159     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17160     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17161                                       CM-LF-STATUS-AT-CANCEL.
 17162
 17163     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17164     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17165                                       CM-AH-STATUS-AT-CANCEL.
 17166
 17167     MOVE '1'                       TO CM-ENTRY-STATUS.
 17168
 17169     IF PB-REISSUED-CERT
 17170        MOVE '5'                    TO CM-ENTRY-STATUS.
 17171
 17172     IF PB-MONTHLY-CERT
 17173        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17174
 17175     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17176     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17177     IF PB-POLICY-IS-DECLINED
 17178        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 312
* EL050.cbl
 17179
 17180     IF PB-POLICY-IS-VOIDED
 17181        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17182
 17183     IF PB-NEEDS-UNDERWRITING
 17184        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17185
 17186     IF PB-REIN-ONLY-CERT
 17187        MOVE '9'                    TO CM-ENTRY-STATUS.
 17188
 17189     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17190         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17191     ELSE
 17192         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17193
 17194     IF PB-RECORD-RETURNED
 17195        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17196      ELSE
 17197        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17198
 17199     IF PB-I-MAIL-ADDRS-PRESENT
 17200        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17201
 17202     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17203                                       CM-ENTRY-DT.
 17204
 17205 4999-EXIT.
 17206     EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 313
* EL050.cbl
 17208
 17209 5000-PROCESS-REPS.
 17210     MOVE ' '                    TO AGTC-MASTER-SW
 17211     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17212     MOVE CO-TYPE                TO AGTC-TYPE
 17213     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17214     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17215     IF (AGTC-MASTER-SW NOT = 'N')
 17216        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17217        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17218        PERFORM 8583-READ-ERAGTC-NEXT
 17219                                 THRU 8583-EXIT
 17220     END-IF
 17221     IF AGTC-MASTER-SW = 'N'
 17222        CONTINUE
 17223     ELSE
 17224        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17225           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17226              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17227              MOVE 'Y'           TO AGTC-MASTER-SW
 17228           END-IF
 17229        END-IF
 17230     END-IF
 17231     .
 17232 5000-EXIT.
 17233     EXIT.
 17234 6370-EDIT-INPUT-LF-CODE.
 17235     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17236        MOVE +1                  TO SUB
 17237        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17238        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17239        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17240        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17241        GO TO 6370-SEARCH-LOOP.
 17242
 17243     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17244
 17245     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17246     MOVE SPACES                 TO CNTL-ACCESS.
 17247*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17248     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17249     MOVE +0                     TO CNTL-SEQ-NO.
 17250     MOVE '4' TO RC-SW-2.
 17251     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17252
 17253     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17254        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17255        GO TO 6370-NO-LF-FOUND.
 17256
 17257     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17258     MOVE +1                     TO SUB.
 17259
 17260 6370-SEARCH-LOOP.
 17261     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17262         GO TO 6370-NO-LF-FOUND.
 17263
 17264     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17265         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 314
* EL050.cbl
 17266         GO TO 6370-HER-NET-PAY-CHECK.
 17267
 17268     ADD 1   TO SUB.
 17269*    IF SUB GREATER 120
 17270     IF SUB GREATER 200
 17271         GO TO 6370-NO-LF-FOUND.
 17272
 17273     GO TO 6370-SEARCH-LOOP.
 17274
 17275 6370-NO-LF-FOUND.
 17276
 17277     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17278
 17279 6370-HER-NET-PAY-CHECK.
 17280
 17281     IF PB-COMPANY-ID = 'CID'
 17282        IF PB-SV-STATE = 'CA' OR 'MN'
 17283           IF PB-I-LF-BENEFIT-CD = '02'
 17284              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17285           ELSE
 17286              IF PB-I-LF-BENEFIT-CD = '04'
 17287                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17288              END-IF
 17289           END-IF
 17290        END-IF
 17291     END-IF
 17292
 17293     IF PB-COMPANY-ID NOT = 'HER'
 17294         GO TO 6370-EXIT.
 17295
 17296     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17297         GO TO 6370-EXIT.
 17298
 17299     IF PB-I-LF-TERM NOT NUMERIC
 17300         MOVE ZEROS              TO PB-I-LF-TERM.
 17301
 17302     IF PB-I-LOAN-TERM NOT NUMERIC
 17303         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17304
 17305     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17306         GO TO 6370-EXIT.
 17307
 17308     IF PB-I-LF-BENEFIT-CD = '33'
 17309         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17310
 17311     IF PB-I-LF-BENEFIT-CD = '34'
 17312         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17313
 17314 6370-EXIT.
 17315     EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 315
* EL050.cbl
 17317
 17318 6380-EDIT-INPUT-AH-CODE.
 17319     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17320        MOVE +1                  TO SUB
 17321        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17322        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17323        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17324        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17325        GO TO 6380-SEARCH-LOOP.
 17326
 17327     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17328
 17329     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17330     MOVE SPACES                 TO CNTL-ACCESS.
 17331     MOVE 'A'                    TO CNTL-REC-TYPE.
 17332*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17333     MOVE +0                     TO CNTL-SEQ-NO.
 17334     MOVE '5' TO RC-SW-2.
 17335     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17336
 17337     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17338        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17339        GO TO 6380-NO-AH-FOUND.
 17340
 17341     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17342     MOVE +1 TO SUB.
 17343
 17344 6380-SEARCH-LOOP.
 17345     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17346         GO TO 6380-NO-AH-FOUND.
 17347
 17348     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17349         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17350         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17351
 17352     ADD 1   TO SUB.
 17353     IF SUB GREATER THAN 96
 17354*    IF SUB GREATER THAN 300
 17355         GO TO 6380-NO-AH-FOUND.
 17356
 17357     GO TO 6380-SEARCH-LOOP.
 17358
 17359 6380-NO-AH-FOUND.
 17360
 17361     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17362
 17363     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17364         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17365     ELSE
 17366         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17367
 17368 6380-CSO-AH-ONLY-CHECKS.
 17369
 17370     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17371        NEXT SENTENCE
 17372      ELSE
 17373        GO TO 6380-EXIT.
 17374
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 316
* EL050.cbl
 17375     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17376         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17377
 17378
 17379     GO TO 6380-EXIT
 17380     .
 17381 6380-CSO-LIFE-WITH-AH-CHECKS.
 17382
 17383
 17384     .
 17385 6380-EXIT.
 17386     EXIT.
 17387
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 317
* EL050.cbl
 17389
 17390 6400-COMPUTE-EXTENSION-DAYS.
 17391
 17392******************************************************************
 17393*                                                                *
 17394*                   COMPUTE EXTENSION DAYS                       *
 17395*                                                                *
 17396*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17397*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17398*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17399*    THE EXTENSION DAYS.                                         *
 17400*                                                                *
 17401******************************************************************
 17402
 17403     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17404     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17405
 17406******************************************************************
 17407*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17408*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17409******************************************************************
 17410
 17411     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17412        COMPUTE WS-ODD-DAYS-OVER =
 17413               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17414     ELSE
 17415        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17416
 17417     IF WS-ODD-DAYS-OVER = ZEROS
 17418           GO TO 6499-EXIT
 17419     ELSE
 17420        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17421           IF WS-WDF-MONTH = 02
 17422              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17423              ADD 2       TO  WS-ODD-DAYS-OVER
 17424              GO TO 6499-EXIT
 17425           ELSE
 17426              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17427                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17428                 GO TO 6499-EXIT
 17429               ELSE
 17430                 GO TO 6499-EXIT
 17431        ELSE
 17432           GO TO 6499-EXIT.
 17433
 17434 6412-CHECK-TO-DAY.
 17435
 17436        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17437           IF WS-WDT-DAY = 28
 17438              ADD 2              TO WS-ODD-DAYS-OVER
 17439           ELSE
 17440              IF WS-WDT-DAY = 29
 17441                 ADD 1           TO WS-ODD-DAYS-OVER
 17442              ELSE
 17443                 NEXT SENTENCE
 17444        ELSE
 17445           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17446              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 318
* EL050.cbl
 17447
 17448     GO TO 6499-EXIT.
 17449
 17450
 17451 6415-CHECK-LEAP-YEAR.
 17452
 17453     IF DC-DAYS-IN-MONTH = 29
 17454        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17455
 17456 6415-EXIT.
 17457     EXIT.
 17458
 17459 6499-EXIT.
 17460      EXIT.
 17461
 17462 6500-END.
 17463     EXIT.
 17464
 17465
 17466******************************************************************
 17467************* PROCEDURE DIVISION FOR EL050 ***********************
 17468********************** ELC50PD END *******************************
 17469
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 319
* EL050.cbl
 17471
 17472**START***********************************************************
 17473*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17474*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17475******************************************************************
 17476*
 17477 6600-GET-STATE-MUNICIPAL-TAX.
 17478
 17479     IF PB-COMPANY-ID NOT = 'DMD'
 17480         GO TO 6640-EXIT.
 17481
 17482     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17483     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17484     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17485*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17486*
 17487***  Y2K PROJ 7744
 17488     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17489     SET BIN-TO-GREG          TO TRUE.
 17490     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17491
 17492     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17493
 17494     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17495     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17496
 17497
 17498* EXEC CICS HANDLE CONDITION
 17499*        INVREQ    (6610-START-BROWSE)
 17500*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17501*        NOTFND    (6630-END-OF-FILE)
 17502*    END-EXEC.
 17503*    MOVE '"$8JI                 ! # #00017485' TO DFHEIV0
 17504     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17505     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17506     MOVE X'2320233030303137343835' TO DFHEIV0(25:11)
 17507     CALL 'kxdfhei1' USING DFHEIV0
 17508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17509
 17510
 17511 6610-START-BROWSE.
 17512
 17513
 17514* EXEC CICS HANDLE CONDITION
 17515*        NOTFND    (6630-END-OF-FILE)
 17516*        DISABLED  (6630-ERRESS-PROBLEM)
 17517*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17518*        ENDFILE   (6630-END-OF-FILE)
 17519*    END-EXEC.
 17520*    MOVE '"$IcJ''                ! $ #00017493' TO DFHEIV0
 17521     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17523     MOVE X'2420233030303137343933' TO DFHEIV0(25:11)
 17524     CALL 'kxdfhei1' USING DFHEIV0
 17525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17526
 17527
 17528
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 320
* EL050.cbl
 17529* EXEC CICS STARTBR
 17530*        DATASET (FILE-ID-ERRESS)
 17531*        RIDFLD  (WS-ERRESS-KEY)
 17532*        GTEQ
 17533*    END-EXEC.
 17534     MOVE 0
 17535       TO DFHEIV11
 17536*    MOVE '&,         G          &   #00017500' TO DFHEIV0
 17537     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17538     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17539     MOVE X'2020233030303137353030' TO DFHEIV0(25:11)
 17540     CALL 'kxdfhei1' USING DFHEIV0,
 17541           FILE-ID-ERRESS,
 17542           WS-ERRESS-KEY,
 17543           DFHEIV99,
 17544           DFHEIV11,
 17545           DFHEIV99
 17546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17547
 17548
 17549 6620-READ-NEXT-ERRESS-MASTER.
 17550
 17551
 17552* EXEC CICS HANDLE CONDITION
 17553*        NOTFND    (6630-END-OF-FILE)
 17554*        ENDFILE   (6630-END-OF-FILE)
 17555*        DISABLED  (6630-ERRESS-PROBLEM)
 17556*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17557*    END-EXEC.
 17558*    MOVE '"$I''cJ                ! % #00017508' TO DFHEIV0
 17559     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17561     MOVE X'2520233030303137353038' TO DFHEIV0(25:11)
 17562     CALL 'kxdfhei1' USING DFHEIV0
 17563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17564
 17565
 17566
 17567* EXEC CICS READNEXT
 17568*        DATASET (FILE-ID-ERRESS)
 17569*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17570*        RIDFLD  (WS-ERRESS-KEY)
 17571*    END-EXEC.
 17572     MOVE LENGTH OF
 17573      RESIDENT-STATE-TAX-MASTER
 17574       TO DFHEIV12
 17575     MOVE 0
 17576       TO DFHEIV11
 17577*    MOVE '&.IL                  )   #00017515' TO DFHEIV0
 17578     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17579     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17580     MOVE X'2020233030303137353135' TO DFHEIV0(25:11)
 17581     CALL 'kxdfhei1' USING DFHEIV0,
 17582           FILE-ID-ERRESS,
 17583           RESIDENT-STATE-TAX-MASTER,
 17584           DFHEIV12,
 17585           WS-ERRESS-KEY,
 17586           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 321
* EL050.cbl
 17587           DFHEIV11,
 17588           DFHEIV99,
 17589           DFHEIV99
 17590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17591
 17592
 17593     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17594
 17595* EXEC CICS ENDBR
 17596*            DATASET (FILE-ID-ERRESS)
 17597*       END-EXEC
 17598     MOVE 0
 17599       TO DFHEIV11
 17600*    MOVE '&2                    $   #00017522' TO DFHEIV0
 17601     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17602     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17603     MOVE X'2020233030303137353232' TO DFHEIV0(25:11)
 17604     CALL 'kxdfhei1' USING DFHEIV0,
 17605           FILE-ID-ERRESS,
 17606           DFHEIV11,
 17607           DFHEIV99
 17608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17609        GO TO 6630-END-OF-FILE.
 17610
 17611     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17612        NEXT SENTENCE
 17613      ELSE
 17614        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17615
 17616*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17617*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17618*
 17619     MOVE +2                     TO WS-SUB1.
 17620
 17621     IF PB-ISSUE
 17622     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17623        MOVE +1                  TO WS-SUB1.
 17624
 17625     IF PB-CANCELLATION
 17626     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 17627        MOVE +1                  TO WS-SUB1.
 17628*
 17629*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 17630*
 17631***  Y2K PROJ 7744
 17632     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 17633***  Y2K PROJ 7744
 17634
 17635*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 17636* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 17637* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 17638
 17639     ADD 1                    TO WS-YEAR-YY.
 17640
 17641     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 17642         MOVE RES-REN-STATE-TAX (WS-SUB1)
 17643                              TO WS-RES-STATE-TAX
 17644         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 322
* EL050.cbl
 17645                              TO WS-RES-MUNI-TAX
 17646     ELSE
 17647         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 17648                              TO WS-RES-STATE-TAX
 17649         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 17650                              TO WS-RES-MUNI-TAX.
 17651
 17652*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 17653
 17654     IF PB-CANCELLATION
 17655         GO TO 6640-CANCEL-TAX.
 17656
 17657     IF PB-I-LF-PREMIUM-AMT > ZEROS
 17658         COMPUTE PB-I-STATE-TAX ROUNDED =
 17659                                   PB-I-LF-PREMIUM-AMT
 17660                                 * WS-RES-STATE-TAX
 17661         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17662                                   PB-I-LF-PREMIUM-AMT
 17663                                 * WS-RES-MUNI-TAX
 17664     ELSE
 17665     IF PB-I-AH-PREMIUM-AMT > ZEROS
 17666         COMPUTE PB-I-STATE-TAX ROUNDED =
 17667                                   PB-I-AH-PREMIUM-AMT
 17668                                 * WS-RES-STATE-TAX
 17669         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17670                                   PB-I-AH-PREMIUM-AMT
 17671                                 * WS-RES-MUNI-TAX.
 17672
 17673
 17674* EXEC CICS ENDBR
 17675*         DATASET (FILE-ID-ERRESS)
 17676*    END-EXEC.
 17677     MOVE 0
 17678       TO DFHEIV11
 17679*    MOVE '&2                    $   #00017589' TO DFHEIV0
 17680     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17681     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17682     MOVE X'2020233030303137353839' TO DFHEIV0(25:11)
 17683     CALL 'kxdfhei1' USING DFHEIV0,
 17684           FILE-ID-ERRESS,
 17685           DFHEIV11,
 17686           DFHEIV99
 17687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17688
 17689
 17690     GO TO 6640-EXIT.
 17691
 17692 6640-CANCEL-TAX.
 17693     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 17694
 17695     IF PB-C-LF-CANCEL-AMT > ZEROS
 17696         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17697                                   PB-C-LF-CANCEL-AMT
 17698                                 * WS-RES-STATE-TAX
 17699         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17700                                   PB-C-LF-CANCEL-AMT
 17701                                *  WS-RES-MUNI-TAX
 17702     ELSE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 323
* EL050.cbl
 17703     IF PB-C-AH-CANCEL-AMT > ZEROS
 17704         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17705                                   PB-C-AH-CANCEL-AMT
 17706                                 * WS-RES-STATE-TAX
 17707         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17708                                   PB-C-AH-CANCEL-AMT
 17709                                *  WS-RES-MUNI-TAX.
 17710
 17711
 17712* EXEC CICS ENDBR
 17713*         DATASET (FILE-ID-ERRESS)
 17714*    END-EXEC.
 17715     MOVE 0
 17716       TO DFHEIV11
 17717*    MOVE '&2                    $   #00017614' TO DFHEIV0
 17718     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17719     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17720     MOVE X'2020233030303137363134' TO DFHEIV0(25:11)
 17721     CALL 'kxdfhei1' USING DFHEIV0,
 17722           FILE-ID-ERRESS,
 17723           DFHEIV11,
 17724           DFHEIV99
 17725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17726
 17727
 17728     GO TO 6640-EXIT.
 17729
 17730 6630-END-OF-FILE.
 17731     MOVE ER-8002              TO WS-ERROR.
 17732     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17733
 17734     GO TO 6640-EXIT.
 17735
 17736 6630-ERRESS-PROBLEM.
 17737     MOVE ER-8044              TO WS-ERROR.
 17738     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17739
 17740 6640-EXIT.
 17741     EXIT.
 17742
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 324
* EL050.cbl
 17744 6650-GET-RES-STATE-COMM.
 17745
 17746     IF PB-COMPANY-ID NOT = 'DMD'
 17747         GO TO 6700-COMM-EXIT.
 17748
 17749     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 17750     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 17751     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 17752     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 17753     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 17754     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 17755     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 17756
 17757*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 17758*
 17759***  Y2K PROJ 7744
 17760     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17761     SET BIN-TO-GREG          TO TRUE.
 17762     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17763
 17764     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17765***  Y2K PROJ 7744
 17766
 17767     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 17768
 17769
 17770* EXEC CICS HANDLE CONDITION
 17771*        INVREQ    (6660-START-BROWSE)
 17772*        DISABLED  (6690-ERRESC-PROBLEM)
 17773*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17774*        NOTFND    (6690-END-OF-FILE)
 17775*    END-EXEC.
 17776*    MOVE '"$8cJI                ! & #00017659' TO DFHEIV0
 17777     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 17778     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17779     MOVE X'2620233030303137363539' TO DFHEIV0(25:11)
 17780     CALL 'kxdfhei1' USING DFHEIV0
 17781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17782
 17783
 17784
 17785* EXEC CICS RESETBR
 17786*        DATASET (FILE-ID-ERRESC)
 17787*        RIDFLD  (WS-ERRESC-KEY)
 17788*    END-EXEC.
 17789     MOVE 0
 17790       TO DFHEIV11
 17791*    MOVE '&4         G          &   #00017666' TO DFHEIV0
 17792     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 17793     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17794     MOVE X'2020233030303137363636' TO DFHEIV0(25:11)
 17795     CALL 'kxdfhei1' USING DFHEIV0,
 17796           FILE-ID-ERRESC,
 17797           WS-ERRESC-KEY,
 17798           DFHEIV99,
 17799           DFHEIV11,
 17800           DFHEIV99
 17801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 325
* EL050.cbl
 17802
 17803
 17804 6660-START-BROWSE.
 17805
 17806
 17807* EXEC CICS HANDLE CONDITION
 17808*        NOTFND    (6690-END-OF-FILE)
 17809*        DISABLED  (6690-ERRESC-PROBLEM)
 17810*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17811*        ENDFILE   (6690-END-OF-FILE)
 17812*    END-EXEC.
 17813*    MOVE '"$IcJ''                ! '' #00017673' TO DFHEIV0
 17814     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17816     MOVE X'2720233030303137363733' TO DFHEIV0(25:11)
 17817     CALL 'kxdfhei1' USING DFHEIV0
 17818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17819
 17820
 17821
 17822* EXEC CICS STARTBR
 17823*        DATASET (FILE-ID-ERRESC)
 17824*        RIDFLD  (WS-ERRESC-KEY)
 17825*        GTEQ
 17826*    END-EXEC.
 17827     MOVE 0
 17828       TO DFHEIV11
 17829*    MOVE '&,         G          &   #00017680' TO DFHEIV0
 17830     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17831     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17832     MOVE X'2020233030303137363830' TO DFHEIV0(25:11)
 17833     CALL 'kxdfhei1' USING DFHEIV0,
 17834           FILE-ID-ERRESC,
 17835           WS-ERRESC-KEY,
 17836           DFHEIV99,
 17837           DFHEIV11,
 17838           DFHEIV99
 17839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17840
 17841
 17842     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 17843
 17844 6670-READ-NEXT-ERRESC-MASTER.
 17845
 17846
 17847* EXEC CICS HANDLE CONDITION
 17848*        NOTFND    (6690-END-OF-FILE)
 17849*        DISABLED  (6690-ERRESC-PROBLEM)
 17850*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17851*        ENDFILE   (6690-END-OF-FILE)
 17852*    END-EXEC.
 17853*    MOVE '"$IcJ''                ! ( #00017690' TO DFHEIV0
 17854     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17855     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17856     MOVE X'2820233030303137363930' TO DFHEIV0(25:11)
 17857     CALL 'kxdfhei1' USING DFHEIV0
 17858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17859
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 326
* EL050.cbl
 17860
 17861
 17862* EXEC CICS READNEXT
 17863*        DATASET (FILE-ID-ERRESC)
 17864*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 17865*        RIDFLD  (ERRESC-RECORD-KEY)
 17866*    END-EXEC.
 17867     MOVE LENGTH OF
 17868      ACCOUNT-RESIDENT-ST-COMMISSION
 17869       TO DFHEIV12
 17870     MOVE 0
 17871       TO DFHEIV11
 17872*    MOVE '&.IL                  )   #00017697' TO DFHEIV0
 17873     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17874     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17875     MOVE X'2020233030303137363937' TO DFHEIV0(25:11)
 17876     CALL 'kxdfhei1' USING DFHEIV0,
 17877           FILE-ID-ERRESC,
 17878           ACCOUNT-RESIDENT-ST-COMMISSION,
 17879           DFHEIV12,
 17880           ERRESC-RECORD-KEY,
 17881           DFHEIV99,
 17882           DFHEIV11,
 17883           DFHEIV99,
 17884           DFHEIV99
 17885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17886
 17887
 17888     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 17889        NEXT SENTENCE
 17890     ELSE
 17891
 17892* EXEC CICS ENDBR
 17893*            DATASET (FILE-ID-ERRESC)
 17894*       END-EXEC
 17895     MOVE 0
 17896       TO DFHEIV11
 17897*    MOVE '&2                    $   #00017706' TO DFHEIV0
 17898     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17899     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17900     MOVE X'2020233030303137373036' TO DFHEIV0(25:11)
 17901     CALL 'kxdfhei1' USING DFHEIV0,
 17902           FILE-ID-ERRESC,
 17903           DFHEIV11,
 17904           DFHEIV99
 17905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17906        GO TO 6690-END-OF-FILE.
 17907
 17908     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 17909
 17910* EXEC CICS ENDBR
 17911*            DATASET (FILE-ID-ERRESC)
 17912*       END-EXEC
 17913     MOVE 0
 17914       TO DFHEIV11
 17915*    MOVE '&2                    $   #00017712' TO DFHEIV0
 17916     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17917     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 327
* EL050.cbl
 17918     MOVE X'2020233030303137373132' TO DFHEIV0(25:11)
 17919     CALL 'kxdfhei1' USING DFHEIV0,
 17920           FILE-ID-ERRESC,
 17921           DFHEIV11,
 17922           DFHEIV99
 17923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17924        GO TO 6690-END-OF-FILE.
 17925
 17926     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 17927        NEXT SENTENCE
 17928      ELSE
 17929        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 17930
 17931* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 17932*
 17933     MOVE ZEROS               TO WS-SUB WS-SUB1.
 17934
 17935     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 17936
 17937     IF WS-SUB1 > ZERO
 17938         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 17939             PERFORM 6680-SET-COMMISSION
 17940         ELSE
 17941             PERFORM 6680-SET-TABLE-CODE.
 17942
 17943
 17944* EXEC CICS ENDBR
 17945*         DATASET (FILE-ID-ERRESC)
 17946*    END-EXEC.
 17947     MOVE 0
 17948       TO DFHEIV11
 17949*    MOVE '&2                    $   #00017734' TO DFHEIV0
 17950     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17951     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17952     MOVE X'2020233030303137373334' TO DFHEIV0(25:11)
 17953     CALL 'kxdfhei1' USING DFHEIV0,
 17954           FILE-ID-ERRESC,
 17955           DFHEIV11,
 17956           DFHEIV99
 17957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17958
 17959
 17960     GO TO 6700-COMM-EXIT.
 17961
 17962 6680-SET-TABLE-CODE.
 17963     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 17964        MOVE ZEROS             TO WS-SUB1
 17965     ELSE
 17966* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 17967* TO COMPUTE AH COMMISSION.
 17968        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 17969        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 17970        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 17971        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 17972        PERFORM 6680-READ-CTBL-TABLE
 17973        IF WS-CTBL-READ-SW NOT = 'Y'
 17974           MOVE ZEROS          TO WS-SUB1.
 17975
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 328
* EL050.cbl
 17976 6680-READ-CTBL-TABLE.
 17977*
 17978* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 17979* TO COMPUTE LIFE COMMISSION
 17980
 17981     IF CTBL-SW = '0540'
 17982        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 17983        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 17984        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 17985
 17986     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 17987
 17988     IF CTBL-TABLE-FOUND
 17989        IF CTBL-SW = '0530'
 17990             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 17991                                    * PB-I-AH-TERM
 17992             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 17993             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 17994        ELSE
 17995             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 17996             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 17997             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 17998     ELSE
 17999        IF FIRST-TIME-THROUGH
 18000            GO TO 6680-READ-CTBL-TABLE
 18001        ELSE
 18002            MOVE ZEROS         TO WS-SUB1.
 18003
 18004 6680-SET-COMMISSION.
 18005     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18006           MOVE ZEROS          TO WS-SUB1
 18007       ELSE
 18008           MOVE RESC-COMMISSION-PER (WS-SUB)
 18009                               TO WS-COMMISSION
 18010           IF CTBL-SW = '0530'
 18011               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18012           ELSE
 18013               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18014
 18015 6680-SEARCH-CATEGORY.
 18016     ADD +1                   TO WS-SUB.
 18017     IF WS-SUB > +12
 18018         GO TO 6680-EXIT.
 18019
 18020     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18021          MOVE WS-SUB         TO WS-SUB1
 18022          GO TO 6680-EXIT.
 18023
 18024     GO TO 6680-SEARCH-CATEGORY.
 18025
 18026 6680-EXIT.
 18027     EXIT.
 18028
 18029 6690-END-OF-FILE.
 18030     GO TO 6700-COMM-EXIT.
 18031
 18032 6690-ERRESC-PROBLEM.
 18033      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 329
* EL050.cbl
 18034      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18035
 18036      GO TO 6700-COMM-EXIT.
 18037
 18038 6700-COMM-EXIT.
 18039     EXIT.
 18040
 18041 7000-GET-RATE.
 18042
 18043* EXEC CICS LINK
 18044*        PROGRAM    ('ELRATE')
 18045*        COMMAREA   (CALCULATION-PASS-AREA)
 18046*        LENGTH     (CP-COMM-LENGTH)
 18047*    END-EXEC.
 18048     MOVE 'ELRATE' TO DFHEIV1
 18049*    MOVE '."C                   ''   #00017820' TO DFHEIV0
 18050     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18051     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18052     MOVE X'2020233030303137383230' TO DFHEIV0(25:11)
 18053     CALL 'kxdfhei1' USING DFHEIV0,
 18054           DFHEIV1,
 18055           CALCULATION-PASS-AREA,
 18056           CP-COMM-LENGTH,
 18057           DFHEIV99,
 18058           DFHEIV99,
 18059           DFHEIV99
 18060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18061
 18062
 18063 7000-EXIT.
 18064     EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 330
* EL050.cbl
 18066 7100-FIND-BENEFIT-IN-STATE.
 18067     MOVE 'N'                    TO BEN-SEARCH-SW.
 18068
 18069     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18070         VARYING SUB3 FROM 1 BY 1 UNTIL
 18071            ((SUB3 GREATER 50) OR
 18072              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18073               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18074
 18075     IF SUB3 NOT = 51
 18076         MOVE 'Y'                TO BEN-SEARCH-SW.
 18077
 18078     GO TO 7199-EXIT.
 18079
 18080 7100-BENEFIT-DUMMY.
 18081
 18082 7100-DUMMY-EXIT.
 18083     EXIT.
 18084
 18085 7199-EXIT.
 18086     EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 331
* EL050.cbl
 18088 7200-FIND-BENEFIT.
 18089     MOVE 'N'                    TO BEN-SEARCH-SW.
 18090
 18091     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18092         VARYING SUB3 FROM 1 BY 1 UNTIL
 18093            ((SUB3 GREATER 8) OR
 18094            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18095
 18096     IF SUB3 NOT = 9
 18097         MOVE 'Y'                TO BEN-SEARCH-SW.
 18098
 18099     GO TO 7200-EXIT.
 18100
 18101 7200-BENEFIT-DUMMY.
 18102
 18103 7200-DUMMY-EXIT.
 18104     EXIT.
 18105
 18106 7200-EXIT.
 18107     EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 332
* EL050.cbl
 18109 7250-LOOK-FOR-RESCINDED-CLAIM.
 18110     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18111                                    W-CL-COMP-CD.
 18112     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18113                                    W-CL-CERT-NO.
 18114
 18115
 18116* EXEC CICS HANDLE CONDITION
 18117*        NOTFND  (7250-CONTINUE)
 18118*        ENDFILE (7250-CONTINUE)
 18119*    END-EXEC.
 18120*    MOVE '"$I''                  ! ) #00017878' TO DFHEIV0
 18121     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18122     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18123     MOVE X'2920233030303137383738' TO DFHEIV0(25:11)
 18124     CALL 'kxdfhei1' USING DFHEIV0
 18125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18126
 18127
 18128
 18129* EXEC CICS IGNORE CONDITION
 18130*        DUPKEY
 18131*    END-EXEC.
 18132*    MOVE '"*$                   !   #00017883' TO DFHEIV0
 18133     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18134     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18135     MOVE X'2020233030303137383833' TO DFHEIV0(25:11)
 18136     CALL 'kxdfhei1' USING DFHEIV0
 18137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18138
 18139
 18140
 18141* EXEC CICS STARTBR
 18142*        DATASET   (CLMS-ID)
 18143*        RIDFLD    (ELMSTR-KEY)
 18144*        GENERIC   EQUAL
 18145*        KEYLENGTH (ELMSTR-LENGTH)
 18146*    END-EXEC.
 18147     MOVE 0
 18148       TO DFHEIV11
 18149*    MOVE '&,   KG    E          &   #00017887' TO DFHEIV0
 18150     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18151     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18152     MOVE X'2020233030303137383837' TO DFHEIV0(25:11)
 18153     CALL 'kxdfhei1' USING DFHEIV0,
 18154           CLMS-ID,
 18155           ELMSTR-KEY,
 18156           ELMSTR-LENGTH,
 18157           DFHEIV11,
 18158           DFHEIV99
 18159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18160
 18161
 18162     MOVE 'Y'                    TO W-BROWSE-SW.
 18163
 18164 7250-NEXT-CLAIM.
 18165
 18166
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 333
* EL050.cbl
 18167* EXEC CICS READNEXT
 18168*        DATASET   (CLMS-ID)
 18169*        RIDFLD    (ELMSTR-KEY)
 18170*        SET       (ADDRESS OF CLAIM-MASTER)
 18171*    END-EXEC.
 18172     MOVE 0
 18173       TO DFHEIV11
 18174*    MOVE '&.S                   )   #00017898' TO DFHEIV0
 18175     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18176     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18177     MOVE X'2020233030303137383938' TO DFHEIV0(25:11)
 18178     CALL 'kxdfhei1' USING DFHEIV0,
 18179           CLMS-ID,
 18180           DFHEIV20,
 18181           DFHEIV99,
 18182           ELMSTR-KEY,
 18183           DFHEIV99,
 18184           DFHEIV11,
 18185           DFHEIV99,
 18186           DFHEIV99
 18187     SET ADDRESS OF CLAIM-MASTER TO
 18188         DFHEIV20
 18189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18190
 18191
 18192     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18193        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18194         GO TO 7250-CONTINUE
 18195     END-IF.
 18196
 18197     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18198        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18199        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18200        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18201        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18202         GO TO 7250-NEXT-CLAIM
 18203     END-IF.
 18204
 18205     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18206        OR (CL-CLAIM-TYPE = 'I')
 18207        OR (CL-CLAIM-TYPE = 'G')
 18208          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18209              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18210              GO TO 7250-CONTINUE
 18211          END-IF
 18212     END-IF.
 18213
 18214     GO TO 7250-NEXT-CLAIM.
 18215
 18216 7250-CONTINUE.
 18217
 18218     IF W-BROWSE-SW = 'Y'
 18219
 18220* EXEC CICS ENDBR
 18221*            DATASET   (CLMS-ID)
 18222*        END-EXEC
 18223     MOVE 0
 18224       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 334
* EL050.cbl
 18225*    MOVE '&2                    $   #00017931' TO DFHEIV0
 18226     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18227     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18228     MOVE X'2020233030303137393331' TO DFHEIV0(25:11)
 18229     CALL 'kxdfhei1' USING DFHEIV0,
 18230           CLMS-ID,
 18231           DFHEIV11,
 18232           DFHEIV99
 18233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18234         MOVE 'N' TO W-BROWSE-SW
 18235     END-IF.
 18236
 18237 7250-EXIT.
 18238     EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 335
* EL050.cbl
 18240 7300-CHECK-FOR-OPEN-CLMS.
 18241
 18242*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18243*    MOVE SPACES                 TO CNTL-ACCESS.
 18244*    MOVE '1'                    TO CNTL-REC-TYPE.
 18245*    MOVE +0                     TO CNTL-SEQ-NO.
 18246
 18247*    MOVE '3'                    TO RC-SW-1.
 18248*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18249
 18250*    IF NOT CF-COMPANY-MASTER
 18251*         PERFORM 0099-COMPANY-NOT-FOUND
 18252*         GO TO 7300-EXIT.
 18253
 18254     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18255                                    W-CL-COMP-CD.
 18256     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18257                                    W-CL-CERT-NO.
 18258
 18259
 18260* EXEC CICS HANDLE CONDITION
 18261*        NOTFND  (7300-CONTINUE)
 18262*        ENDFILE (7300-CONTINUE)
 18263*    END-EXEC.
 18264*    MOVE '"$I''                  ! * #00017959' TO DFHEIV0
 18265     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18266     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18267     MOVE X'2A20233030303137393539' TO DFHEIV0(25:11)
 18268     CALL 'kxdfhei1' USING DFHEIV0
 18269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18270
 18271
 18272
 18273* EXEC CICS IGNORE CONDITION
 18274*        DUPKEY
 18275*    END-EXEC.
 18276*    MOVE '"*$                   !   #00017964' TO DFHEIV0
 18277     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18278     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18279     MOVE X'2020233030303137393634' TO DFHEIV0(25:11)
 18280     CALL 'kxdfhei1' USING DFHEIV0
 18281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18282
 18283
 18284
 18285* EXEC CICS STARTBR
 18286*        DATASET   (CLMS-ID)
 18287*        RIDFLD    (ELMSTR-KEY)
 18288*        GENERIC   EQUAL
 18289*        KEYLENGTH (ELMSTR-LENGTH)
 18290*    END-EXEC.
 18291     MOVE 0
 18292       TO DFHEIV11
 18293*    MOVE '&,   KG    E          &   #00017968' TO DFHEIV0
 18294     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18295     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18296     MOVE X'2020233030303137393638' TO DFHEIV0(25:11)
 18297     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 336
* EL050.cbl
 18298           CLMS-ID,
 18299           ELMSTR-KEY,
 18300           ELMSTR-LENGTH,
 18301           DFHEIV11,
 18302           DFHEIV99
 18303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18304
 18305
 18306     MOVE 'Y'                    TO W-BROWSE-SW.
 18307
 18308 7300-NEXT-CLAIM.
 18309
 18310
 18311* EXEC CICS READNEXT
 18312*        DATASET   (CLMS-ID)
 18313*        RIDFLD    (ELMSTR-KEY)
 18314*        SET       (ADDRESS OF CLAIM-MASTER)
 18315*    END-EXEC.
 18316     MOVE 0
 18317       TO DFHEIV11
 18318*    MOVE '&.S                   )   #00017979' TO DFHEIV0
 18319     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18320     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18321     MOVE X'2020233030303137393739' TO DFHEIV0(25:11)
 18322     CALL 'kxdfhei1' USING DFHEIV0,
 18323           CLMS-ID,
 18324           DFHEIV20,
 18325           DFHEIV99,
 18326           ELMSTR-KEY,
 18327           DFHEIV99,
 18328           DFHEIV11,
 18329           DFHEIV99,
 18330           DFHEIV99
 18331     SET ADDRESS OF CLAIM-MASTER TO
 18332         DFHEIV20
 18333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18334
 18335
 18336     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18337        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18338         GO TO 7300-CONTINUE.
 18339
 18340     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18341        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18342        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18343        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18344        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18345         GO TO 7300-NEXT-CLAIM.
 18346
 18347*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18348     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18349        OR (CL-CLAIM-TYPE = 'I')
 18350        OR (CL-CLAIM-TYPE = 'G')
 18351        IF CLAIM-IS-OPEN
 18352           EVALUATE TRUE
 18353             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18354                 MOVE ER-2884      TO WS-ERROR
 18355             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 337
* EL050.cbl
 18356                 MOVE ER-2887      TO WS-ERROR
 18357             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18358                 MOVE ER-2886      TO WS-ERROR
 18359             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18360                 MOVE ER-2888      TO WS-ERROR
 18361             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18362                 MOVE ER-2885      TO WS-ERROR
 18363             WHEN OTHER
 18364                 MOVE ER-2768      TO WS-ERROR
 18365           END-EVALUATE
 18366           IF PB-C-AH-CANCEL-VOIDED OR
 18367              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18368                NOT AH-COVERAGE-CANCELLED)
 18369               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18370               MOVE ER-2768      TO WS-ERROR
 18371           END-IF
 18372           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18373           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18374              PB-FORCE-CODE NOT EQUAL '8'
 18375               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18376           END-IF
 18377           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18378           GO TO 7300-CONTINUE
 18379        ELSE
 18380           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18381*****THIS IS A RESCISSION OR REFORMATION
 18382              IF (AH-COVERAGE-CANCELLED AND
 18383                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18384                    MOVE ER-2890 TO WS-ERROR
 18385                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18386                    GO TO 7300-CONTINUE
 18387              END-IF
 18388           ELSE
 18389              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18390                 MOVE ER-2756        TO WS-ERROR
 18391                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18392                 GO TO 7300-CONTINUE
 18393              END-IF
 18394           END-IF
 18395        END-IF
 18396     ELSE
 18397*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18398        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18399           IF CLAIM-IS-OPEN
 18400              MOVE ER-2889      TO WS-ERROR
 18401              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18402              GO TO 7300-CONTINUE
 18403           ELSE
 18404              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18405*****THIS IS A RESCISSION OR REFORMATION
 18406                 IF (LF-COVERAGE-CANCELLED AND
 18407                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18408                       MOVE ER-2890 TO WS-ERROR
 18409                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18410                       GO TO 7300-CONTINUE
 18411                 END-IF
 18412              ELSE
 18413                 IF (AH-COVERAGE-CANCELLED AND
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 338
* EL050.cbl
 18414                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18415                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18416                    (LF-COVERAGE-CANCELLED AND
 18417                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18418                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18419                       MOVE ER-2965 TO WS-ERROR
 18420                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18421                       GO TO 7300-CONTINUE
 18422                 END-IF
 18423                 IF LF-COVERAGE-CANCELLED
 18424                  IF CL-TOTAL-PAID-AMT > 0
 18425                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18426                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18427                        MOVE ER-2891 TO WS-ERROR
 18428                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18429                        GO TO 7300-CONTINUE
 18430                      END-IF
 18431                    ELSE
 18432                      MOVE ER-2892 TO WS-ERROR
 18433                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18434                      GO TO 7300-CONTINUE
 18435                    END-IF
 18436                  END-IF
 18437                 END-IF
 18438              END-IF
 18439           END-IF
 18440        END-IF
 18441     END-IF
 18442
 18443     GO TO 7300-NEXT-CLAIM.
 18444
 18445 7300-CONTINUE.
 18446
 18447     IF W-BROWSE-SW = 'Y'
 18448
 18449* EXEC CICS ENDBR
 18450*            DATASET   (CLMS-ID)
 18451*        END-EXEC.
 18452     MOVE 0
 18453       TO DFHEIV11
 18454*    MOVE '&2                    $   #00018097' TO DFHEIV0
 18455     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18456     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18457     MOVE X'2020233030303138303937' TO DFHEIV0(25:11)
 18458     CALL 'kxdfhei1' USING DFHEIV0,
 18459           CLMS-ID,
 18460           DFHEIV11,
 18461           DFHEIV99
 18462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18463
 18464
 18465 7300-EXIT.
 18466     EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 339
* EL050.cbl
 18468
 18469 7400-GET-REMAIN-TERM.
 18470
 18471* EXEC CICS LINK
 18472*        PROGRAM    ('ELRTRM')
 18473*        COMMAREA   (CALCULATION-PASS-AREA)
 18474*        LENGTH     (CP-COMM-LENGTH)
 18475*    END-EXEC.
 18476     MOVE 'ELRTRM' TO DFHEIV1
 18477*    MOVE '."C                   ''   #00018106' TO DFHEIV0
 18478     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18479     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18480     MOVE X'2020233030303138313036' TO DFHEIV0(25:11)
 18481     CALL 'kxdfhei1' USING DFHEIV0,
 18482           DFHEIV1,
 18483           CALCULATION-PASS-AREA,
 18484           CP-COMM-LENGTH,
 18485           DFHEIV99,
 18486           DFHEIV99,
 18487           DFHEIV99
 18488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18489
 18490
 18491 7400-EXIT.
 18492     EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 340
* EL050.cbl
 18494
 18495 7500-GET-REMAIN-AMOUNT.
 18496
 18497* EXEC CICS LINK
 18498*        PROGRAM    ('ELRAMT')
 18499*        COMMAREA   (CALCULATION-PASS-AREA)
 18500*        LENGTH     (CP-COMM-LENGTH)
 18501*    END-EXEC.
 18502     MOVE 'ELRAMT' TO DFHEIV1
 18503*    MOVE '."C                   ''   #00018117' TO DFHEIV0
 18504     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18505     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18506     MOVE X'2020233030303138313137' TO DFHEIV0(25:11)
 18507     CALL 'kxdfhei1' USING DFHEIV0,
 18508           DFHEIV1,
 18509           CALCULATION-PASS-AREA,
 18510           CP-COMM-LENGTH,
 18511           DFHEIV99,
 18512           DFHEIV99,
 18513           DFHEIV99
 18514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18515
 18516
 18517 7500-EXIT.
 18518     EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 341
* EL050.cbl
 18520
 18521 7600-GET-REFUND.
 18522
 18523* EXEC CICS LINK
 18524*        PROGRAM    ('ELRFND')
 18525*        COMMAREA   (CALCULATION-PASS-AREA)
 18526*        LENGTH     (CP-COMM-LENGTH)
 18527*    END-EXEC.
 18528     MOVE 'ELRFND' TO DFHEIV1
 18529*    MOVE '."C                   ''   #00018128' TO DFHEIV0
 18530     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18531     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18532     MOVE X'2020233030303138313238' TO DFHEIV0(25:11)
 18533     CALL 'kxdfhei1' USING DFHEIV0,
 18534           DFHEIV1,
 18535           CALCULATION-PASS-AREA,
 18536           CP-COMM-LENGTH,
 18537           DFHEIV99,
 18538           DFHEIV99,
 18539           DFHEIV99
 18540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18541
 18542
 18543 7600-EXIT.
 18544     EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 342
* EL050.cbl
 18546 7700-CALL-DL1.
 18547
 18548* EXEC CICS LINK
 18549*        PROGRAM    ('DLO001')
 18550*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18551*        LENGTH     (DLO001-COMM-LENGTH)
 18552*    END-EXEC.
 18553     MOVE 'DLO001' TO DFHEIV1
 18554*    MOVE '."C                   ''   #00018138' TO DFHEIV0
 18555     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18556     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18557     MOVE X'2020233030303138313338' TO DFHEIV0(25:11)
 18558     CALL 'kxdfhei1' USING DFHEIV0,
 18559           DFHEIV1,
 18560           WS-DLO-MASTER-POLICY-FORM,
 18561           DLO001-COMM-LENGTH,
 18562           DFHEIV99,
 18563           DFHEIV99,
 18564           DFHEIV99
 18565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18566
 18567
 18568 7700-EXIT.
 18569     EXIT.
 18570
 18571 7710-CALL-DL2.
 18572
 18573* EXEC CICS LINK
 18574*        PROGRAM    ('DLO002')
 18575*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18576*        LENGTH     (DLO002-COMM-LENGTH)
 18577*    END-EXEC.
 18578     MOVE 'DLO002' TO DFHEIV1
 18579*    MOVE '."C                   ''   #00018148' TO DFHEIV0
 18580     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18581     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18582     MOVE X'2020233030303138313438' TO DFHEIV0(25:11)
 18583     CALL 'kxdfhei1' USING DFHEIV0,
 18584           DFHEIV1,
 18585           WS-DLO-INTERNAL-POLICY-FORM,
 18586           DLO002-COMM-LENGTH,
 18587           DFHEIV99,
 18588           DFHEIV99,
 18589           DFHEIV99
 18590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18591
 18592
 18593 7710-EXIT.
 18594     EXIT.
 18595
 18596 7720-CALL-DL3.
 18597
 18598* EXEC CICS LINK
 18599*        PROGRAM    ('DLO003')
 18600*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18601*        LENGTH     (DLO003-COMM-LENGTH)
 18602*    END-EXEC.
 18603     MOVE 'DLO003' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 343
* EL050.cbl
 18604*    MOVE '."C                   ''   #00018158' TO DFHEIV0
 18605     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18606     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18607     MOVE X'2020233030303138313538' TO DFHEIV0(25:11)
 18608     CALL 'kxdfhei1' USING DFHEIV0,
 18609           DFHEIV1,
 18610           WS-DLO-VALID-BANK-ID,
 18611           DLO003-COMM-LENGTH,
 18612           DFHEIV99,
 18613           DFHEIV99,
 18614           DFHEIV99
 18615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18616
 18617
 18618 7720-EXIT.
 18619     EXIT.
 18620
 18621 7730-CALL-DL7.
 18622
 18623* EXEC CICS LINK
 18624*        PROGRAM    ('DLO007')
 18625*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 18626*        LENGTH     (DLO007-COMM-LENGTH)
 18627*    END-EXEC.
 18628     MOVE 'DLO007' TO DFHEIV1
 18629*    MOVE '."C                   ''   #00018168' TO DFHEIV0
 18630     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18631     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18632     MOVE X'2020233030303138313638' TO DFHEIV0(25:11)
 18633     CALL 'kxdfhei1' USING DFHEIV0,
 18634           DFHEIV1,
 18635           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 18636           DLO007-COMM-LENGTH,
 18637           DFHEIV99,
 18638           DFHEIV99,
 18639           DFHEIV99
 18640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18641
 18642
 18643 7730-EXIT.
 18644     EXIT.
 18645
 18646 7740-CALL-DL11.
 18647
 18648* EXEC CICS LINK
 18649*        PROGRAM    ('DLO011')
 18650*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 18651*        LENGTH     (DLO011-COMM-LENGTH)
 18652*    END-EXEC.
 18653     MOVE 'DLO011' TO DFHEIV1
 18654*    MOVE '."C                   ''   #00018178' TO DFHEIV0
 18655     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18656     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18657     MOVE X'2020233030303138313738' TO DFHEIV0(25:11)
 18658     CALL 'kxdfhei1' USING DFHEIV0,
 18659           DFHEIV1,
 18660           WS-DLO-PREM-RATES-BEN-TYPE,
 18661           DLO011-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 344
* EL050.cbl
 18662           DFHEIV99,
 18663           DFHEIV99,
 18664           DFHEIV99
 18665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18666
 18667
 18668 7740-EXIT.
 18669     EXIT.
 18670
 18671 7750-CALL-DL17.
 18672
 18673* EXEC CICS LINK
 18674*        PROGRAM    ('DLO017')
 18675*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 18676*        LENGTH     (DLO017-COMM-LENGTH)
 18677*    END-EXEC.
 18678     MOVE 'DLO017' TO DFHEIV1
 18679*    MOVE '."C                   ''   #00018188' TO DFHEIV0
 18680     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18681     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18682     MOVE X'2020233030303138313838' TO DFHEIV0(25:11)
 18683     CALL 'kxdfhei1' USING DFHEIV0,
 18684           DFHEIV1,
 18685           WS-DLO-VALID-RATE-CODE,
 18686           DLO017-COMM-LENGTH,
 18687           DFHEIV99,
 18688           DFHEIV99,
 18689           DFHEIV99
 18690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18691
 18692
 18693 7750-EXIT.
 18694     EXIT.
 18695
 18696 7755-CALL-DL19.
 18697
 18698* EXEC CICS LINK
 18699*        PROGRAM    ('DLO019')
 18700*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 18701*        LENGTH     (DLO019-COMM-LENGTH)
 18702*    END-EXEC.
 18703     MOVE 'DLO019' TO DFHEIV1
 18704*    MOVE '."C                   ''   #00018198' TO DFHEIV0
 18705     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18706     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18707     MOVE X'2020233030303138313938' TO DFHEIV0(25:11)
 18708     CALL 'kxdfhei1' USING DFHEIV0,
 18709           DFHEIV1,
 18710           WS-DLO-ORIG-COV-CAT,
 18711           DLO019-COMM-LENGTH,
 18712           DFHEIV99,
 18713           DFHEIV99,
 18714           DFHEIV99
 18715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18716
 18717
 18718 7755-EXIT.
 18719     EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 345
* EL050.cbl
 18720
 18721 7760-CALL-DL21.
 18722
 18723* EXEC CICS LINK
 18724*        PROGRAM    ('DLO021')
 18725*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 18726*        LENGTH     (DLO021-COMM-LENGTH)
 18727*    END-EXEC.
 18728     MOVE 'DLO021' TO DFHEIV1
 18729*    MOVE '."C                   ''   #00018208' TO DFHEIV0
 18730     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18731     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18732     MOVE X'2020233030303138323038' TO DFHEIV0(25:11)
 18733     CALL 'kxdfhei1' USING DFHEIV0,
 18734           DFHEIV1,
 18735           WS-DLO-VALID-LOAN-OFFICER,
 18736           DLO021-COMM-LENGTH,
 18737           DFHEIV99,
 18738           DFHEIV99,
 18739           DFHEIV99
 18740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18741
 18742
 18743 7760-EXIT.
 18744     EXIT.
 18745
 18746 7770-CALL-DL22.
 18747
 18748* EXEC CICS LINK
 18749*        PROGRAM    ('DLO022')
 18750*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 18751*        LENGTH     (DLO022-COMM-LENGTH)
 18752*    END-EXEC.
 18753     MOVE 'DLO022' TO DFHEIV1
 18754*    MOVE '."C                   ''   #00018218' TO DFHEIV0
 18755     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18756     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18757     MOVE X'2020233030303138323138' TO DFHEIV0(25:11)
 18758     CALL 'kxdfhei1' USING DFHEIV0,
 18759           DFHEIV1,
 18760           WS-DLO-VALID-STATE-CODE,
 18761           DLO022-COMM-LENGTH,
 18762           DFHEIV99,
 18763           DFHEIV99,
 18764           DFHEIV99
 18765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18766
 18767
 18768 7770-EXIT.
 18769     EXIT.
 18770
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 346
* EL050.cbl
 18772
 18773 7800-REWRITE-CERT.
 18774******************************************************************
 18775*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 18776*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 18777******************************************************************
 18778
 18779     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 18780        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 18781        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 18782        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 18783
 18784* EXEC CICS REWRITE
 18785*                  DATASET (CERT-ID)
 18786*                  FROM    (CERTIFICATE-MASTER)
 18787*              END-EXEC
 18788     MOVE LENGTH OF
 18789      CERTIFICATE-MASTER
 18790       TO DFHEIV11
 18791*    MOVE '&& L                  %   #00018239' TO DFHEIV0
 18792     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18793     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18794     MOVE X'2020233030303138323339' TO DFHEIV0(25:11)
 18795     CALL 'kxdfhei1' USING DFHEIV0,
 18796           CERT-ID,
 18797           CERTIFICATE-MASTER,
 18798           DFHEIV11,
 18799           DFHEIV99
 18800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18801        GO TO 7800-EXIT.
 18802
 18803       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 18804       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 18805
 18806 7800-EXIT.
 18807      EXIT.
 18808
 18809 7900-DELETE-CERT.
 18810
 18811* EXEC CICS DELETE
 18812*        DATASET (CERT-ID)
 18813*    END-EXEC.
 18814*    MOVE '&(                    &   #00018252' TO DFHEIV0
 18815     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 18816     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18817     MOVE X'2020233030303138323532' TO DFHEIV0(25:11)
 18818     CALL 'kxdfhei1' USING DFHEIV0,
 18819           CERT-ID,
 18820           DFHEIV99,
 18821           DFHEIV99,
 18822           DFHEIV99,
 18823           DFHEIV99
 18824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18825
 18826
 18827 7900-EXIT.
 18828     EXIT.
 18829
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 347
* EL050.cbl
 18830 8000-WRITE-CERT.
 18831
 18832* EXEC CICS HANDLE CONDITION
 18833*        DUPKEY    (8000-FREE-MAIN)
 18834*    END-EXEC.
 18835*    MOVE '"$$                   ! + #00018260' TO DFHEIV0
 18836     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 18837     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18838     MOVE X'2B20233030303138323630' TO DFHEIV0(25:11)
 18839     CALL 'kxdfhei1' USING DFHEIV0
 18840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18841
 18842
 18843
 18844* EXEC CICS WRITE
 18845*        DATASET     (CERT-ID)
 18846*        FROM        (CERTIFICATE-MASTER)
 18847*        RIDFLD      (ELCERT-KEY)
 18848*    END-EXEC.
 18849     MOVE LENGTH OF
 18850      CERTIFICATE-MASTER
 18851       TO DFHEIV11
 18852*    MOVE '&$ L                  ''   #00018264' TO DFHEIV0
 18853     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18854     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18855     MOVE X'2020233030303138323634' TO DFHEIV0(25:11)
 18856     CALL 'kxdfhei1' USING DFHEIV0,
 18857           CERT-ID,
 18858           CERTIFICATE-MASTER,
 18859           DFHEIV11,
 18860           ELCERT-KEY,
 18861           DFHEIV99,
 18862           DFHEIV99
 18863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18864
 18865
 18866 8000-FREE-MAIN.
 18867
 18868 8000-EXIT.
 18869      EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 348
* EL050.cbl
 18871
 18872 8100-READ-ERPNDM.
 18873
 18874* EXEC CICS HANDLE CONDITION
 18875*         NOTFND     (8100-NOTFND)
 18876*         ENDFILE    (8100-NOTFND)
 18877*    END-EXEC.
 18878*    MOVE '"$I''                  ! , #00018277' TO DFHEIV0
 18879     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18881     MOVE X'2C20233030303138323737' TO DFHEIV0(25:11)
 18882     CALL 'kxdfhei1' USING DFHEIV0
 18883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18884
 18885
 18886     MOVE SPACES                 TO ERPNDM-FOUND.
 18887     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 18888
 18889
 18890* EXEC CICS READ
 18891*         DATASET   (FILE-ERPNDM)
 18892*         RIDFLD    (PM-CONTROL-PRIMARY)
 18893*         INTO      (PENDING-MAILING-DATA)
 18894*    END-EXEC.
 18895     MOVE LENGTH OF
 18896      PENDING-MAILING-DATA
 18897       TO DFHEIV11
 18898*    MOVE '&"IL       E          (   #00018285' TO DFHEIV0
 18899     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 18900     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18901     MOVE X'2020233030303138323835' TO DFHEIV0(25:11)
 18902     CALL 'kxdfhei1' USING DFHEIV0,
 18903           FILE-ERPNDM,
 18904           PENDING-MAILING-DATA,
 18905           DFHEIV11,
 18906           PM-CONTROL-PRIMARY,
 18907           DFHEIV99,
 18908           DFHEIV99,
 18909           DFHEIV99
 18910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18911
 18912
 18913     GO TO 8100-EXIT.
 18914
 18915 8100-NOTFND.
 18916
 18917     MOVE 'X'                    TO ERPNDM-FOUND.
 18918     MOVE ER-2694                TO WS-ERROR.
 18919     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18920     MOVE ER-2883                TO WS-ERROR
 18921     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 18922     .
 18923 8100-EXIT.
 18924     EXIT.
 18925
 18926 8110-READ-ERMAIL.
 18927
 18928* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 349
* EL050.cbl
 18929*         NOTFND     (8110-NOTFND)
 18930*         ENDFILE    (8110-NOTFND)
 18931*    END-EXEC.
 18932*    MOVE '"$I''                  ! - #00018305' TO DFHEIV0
 18933     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18935     MOVE X'2D20233030303138333035' TO DFHEIV0(25:11)
 18936     CALL 'kxdfhei1' USING DFHEIV0
 18937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18938
 18939
 18940     MOVE SPACES                 TO ERMAIL-FOUND.
 18941     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18942     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18943     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18944     MOVE PB-SV-STATE            TO MA-STATE.
 18945
 18946
 18947* EXEC CICS READ
 18948*         UPDATE
 18949*         DATASET   (FILE-ERMAIL)
 18950*         RIDFLD    (MA-CONTROL-PRIMARY)
 18951*         INTO      (MAILING-DATA)
 18952*    END-EXEC.
 18953     MOVE LENGTH OF
 18954      MAILING-DATA
 18955       TO DFHEIV11
 18956*    MOVE '&"IL       EU         (   #00018316' TO DFHEIV0
 18957     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 18958     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18959     MOVE X'2020233030303138333136' TO DFHEIV0(25:11)
 18960     CALL 'kxdfhei1' USING DFHEIV0,
 18961           FILE-ERMAIL,
 18962           MAILING-DATA,
 18963           DFHEIV11,
 18964           MA-CONTROL-PRIMARY,
 18965           DFHEIV99,
 18966           DFHEIV99,
 18967           DFHEIV99
 18968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18969
 18970
 18971     GO TO 8110-EXIT.
 18972
 18973 8110-NOTFND.
 18974     MOVE 'X'                    TO ERMAIL-FOUND.
 18975
 18976 8110-EXIT.
 18977     EXIT.
 18978
 18979 8120-REWRITE-ERMAIL.
 18980
 18981* EXEC CICS REWRITE
 18982*         DATASET    (FILE-ERMAIL)
 18983*         FROM       (MAILING-DATA)
 18984*    END-EXEC.
 18985     MOVE LENGTH OF
 18986      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 350
* EL050.cbl
 18987       TO DFHEIV11
 18988*    MOVE '&& L                  %   #00018332' TO DFHEIV0
 18989     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18990     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18991     MOVE X'2020233030303138333332' TO DFHEIV0(25:11)
 18992     CALL 'kxdfhei1' USING DFHEIV0,
 18993           FILE-ERMAIL,
 18994           MAILING-DATA,
 18995           DFHEIV11,
 18996           DFHEIV99
 18997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18998
 18999
 19000 8120-EXIT.
 19001     EXIT.
 19002
 19003 8130-WRITE-ERMAIL.
 19004
 19005* EXEC CICS HANDLE CONDITION
 19006*         DUPKEY   (8130-EXIT)
 19007*    END-EXEC.
 19008*    MOVE '"$$                   ! . #00018341' TO DFHEIV0
 19009     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19010     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19011     MOVE X'2E20233030303138333431' TO DFHEIV0(25:11)
 19012     CALL 'kxdfhei1' USING DFHEIV0
 19013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19014
 19015
 19016
 19017* EXEC CICS WRITE
 19018*         DATASET     (FILE-ERMAIL)
 19019*         RIDFLD      (MA-CONTROL-PRIMARY)
 19020*         FROM        (MAILING-DATA)
 19021*    END-EXEC.
 19022     MOVE LENGTH OF
 19023      MAILING-DATA
 19024       TO DFHEIV11
 19025*    MOVE '&$ L                  ''   #00018345' TO DFHEIV0
 19026     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19027     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19028     MOVE X'2020233030303138333435' TO DFHEIV0(25:11)
 19029     CALL 'kxdfhei1' USING DFHEIV0,
 19030           FILE-ERMAIL,
 19031           MAILING-DATA,
 19032           DFHEIV11,
 19033           MA-CONTROL-PRIMARY,
 19034           DFHEIV99,
 19035           DFHEIV99
 19036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19037
 19038
 19039 8130-EXIT.
 19040     EXIT.
 19041
 19042 8140-UNLOCK-ERMAIL.
 19043
 19044* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 351
* EL050.cbl
 19045*         DATASET   (FILE-ERMAIL)
 19046*    END-EXEC.
 19047*    MOVE '&*                    #   #00018355' TO DFHEIV0
 19048     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19049     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19050     MOVE X'2020233030303138333535' TO DFHEIV0(25:11)
 19051     CALL 'kxdfhei1' USING DFHEIV0,
 19052           FILE-ERMAIL,
 19053           DFHEIV99
 19054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19055
 19056
 19057 8140-EXIT.
 19058     EXIT.
 19059
 19060 8180-UPDATE-VIN-NUMBER.
 19061
 19062* EXEC CICS HANDLE CONDITION
 19063*        NOTFND   (8180-NOTFND)
 19064*    END-EXEC.
 19065*    MOVE '"$I                   ! / #00018363' TO DFHEIV0
 19066     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19067     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19068     MOVE X'2F20233030303138333633' TO DFHEIV0(25:11)
 19069     CALL 'kxdfhei1' USING DFHEIV0
 19070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19071
 19072
 19073     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19074     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19075
 19076
 19077* EXEC CICS READ
 19078*        UPDATE
 19079*        DATASET  (CRTT-ID)
 19080*        RIDFLD   (WS-ELCRTT-KEY)
 19081*        INTO     (CERTIFICATE-TRAILERS)
 19082*    END-EXEC.
 19083     MOVE LENGTH OF
 19084      CERTIFICATE-TRAILERS
 19085       TO DFHEIV11
 19086*    MOVE '&"IL       EU         (   #00018370' TO DFHEIV0
 19087     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19088     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19089     MOVE X'2020233030303138333730' TO DFHEIV0(25:11)
 19090     CALL 'kxdfhei1' USING DFHEIV0,
 19091           CRTT-ID,
 19092           CERTIFICATE-TRAILERS,
 19093           DFHEIV11,
 19094           WS-ELCRTT-KEY,
 19095           DFHEIV99,
 19096           DFHEIV99,
 19097           DFHEIV99
 19098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19099
 19100
 19101     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19102         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 352
* EL050.cbl
 19103
 19104* EXEC CICS REWRITE
 19105*           DATASET  (CRTT-ID)
 19106*           FROM     (CERTIFICATE-TRAILERS)
 19107*        END-EXEC
 19108     MOVE LENGTH OF
 19109      CERTIFICATE-TRAILERS
 19110       TO DFHEIV11
 19111*    MOVE '&& L                  %   #00018379' TO DFHEIV0
 19112     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19113     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19114     MOVE X'2020233030303138333739' TO DFHEIV0(25:11)
 19115     CALL 'kxdfhei1' USING DFHEIV0,
 19116           CRTT-ID,
 19117           CERTIFICATE-TRAILERS,
 19118           DFHEIV11,
 19119           DFHEIV99
 19120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19121     ELSE
 19122
 19123* EXEC CICS UNLOCK
 19124*          DATASET  (CRTT-ID)
 19125*       END-EXEC
 19126*    MOVE '&*                    #   #00018384' TO DFHEIV0
 19127     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19128     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19129     MOVE X'2020233030303138333834' TO DFHEIV0(25:11)
 19130     CALL 'kxdfhei1' USING DFHEIV0,
 19131           CRTT-ID,
 19132           DFHEIV99
 19133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19134     END-IF.
 19135
 19136     GO TO 8180-EXIT.
 19137
 19138 8180-NOTFND.
 19139
 19140     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19141     MOVE 'CS'         TO CS-RECORD-ID.
 19142     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19143     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19144     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19145     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19146
 19147* EXEC CICS WRITE
 19148*       DATASET  (CRTT-ID)
 19149*       RIDFLD   (WS-ELCRTT-KEY)
 19150*       FROM     (CERTIFICATE-TRAILERS)
 19151*    END-EXEC.
 19152     MOVE LENGTH OF
 19153      CERTIFICATE-TRAILERS
 19154       TO DFHEIV11
 19155*    MOVE '&$ L                  ''   #00018399' TO DFHEIV0
 19156     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19157     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19158     MOVE X'2020233030303138333939' TO DFHEIV0(25:11)
 19159     CALL 'kxdfhei1' USING DFHEIV0,
 19160           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 353
* EL050.cbl
 19161           CERTIFICATE-TRAILERS,
 19162           DFHEIV11,
 19163           WS-ELCRTT-KEY,
 19164           DFHEIV99,
 19165           DFHEIV99
 19166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19167
 19168
 19169 8180-EXIT.
 19170     EXIT.
 19171
 19172 8190-UPDATE-REFUND-CLAIM-FLAG.
 19173
 19174* EXEC CICS HANDLE CONDITION
 19175*        NOTFND   (8190-NOTFND)
 19176*    END-EXEC.
 19177*    MOVE '"$I                   ! 0 #00018409' TO DFHEIV0
 19178     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19180     MOVE X'3020233030303138343039' TO DFHEIV0(25:11)
 19181     CALL 'kxdfhei1' USING DFHEIV0
 19182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19183
 19184
 19185     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19186     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19187
 19188
 19189* EXEC CICS READ
 19190*        UPDATE
 19191*        DATASET  (CRTT-ID)
 19192*        RIDFLD   (WS-ELCRTT-KEY)
 19193*        INTO     (CERTIFICATE-TRAILERS)
 19194*    END-EXEC.
 19195     MOVE LENGTH OF
 19196      CERTIFICATE-TRAILERS
 19197       TO DFHEIV11
 19198*    MOVE '&"IL       EU         (   #00018416' TO DFHEIV0
 19199     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19200     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19201     MOVE X'2020233030303138343136' TO DFHEIV0(25:11)
 19202     CALL 'kxdfhei1' USING DFHEIV0,
 19203           CRTT-ID,
 19204           CERTIFICATE-TRAILERS,
 19205           DFHEIV11,
 19206           WS-ELCRTT-KEY,
 19207           DFHEIV99,
 19208           DFHEIV99,
 19209           DFHEIV99
 19210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19211
 19212
 19213     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19214
 19215* EXEC CICS REWRITE
 19216*       DATASET  (CRTT-ID)
 19217*       FROM     (CERTIFICATE-TRAILERS)
 19218*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 354
* EL050.cbl
 19219     MOVE LENGTH OF
 19220      CERTIFICATE-TRAILERS
 19221       TO DFHEIV11
 19222*    MOVE '&& L                  %   #00018424' TO DFHEIV0
 19223     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19224     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19225     MOVE X'2020233030303138343234' TO DFHEIV0(25:11)
 19226     CALL 'kxdfhei1' USING DFHEIV0,
 19227           CRTT-ID,
 19228           CERTIFICATE-TRAILERS,
 19229           DFHEIV11,
 19230           DFHEIV99
 19231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19232
 19233
 19234     GO TO 8190-EXIT.
 19235
 19236 8190-NOTFND.
 19237
 19238     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19239     MOVE 'CS'         TO CS-RECORD-ID.
 19240     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19241     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19242     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19243     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19244
 19245* EXEC CICS WRITE
 19246*       DATASET  (CRTT-ID)
 19247*       RIDFLD   (WS-ELCRTT-KEY)
 19248*       FROM     (CERTIFICATE-TRAILERS)
 19249*    END-EXEC.
 19250     MOVE LENGTH OF
 19251      CERTIFICATE-TRAILERS
 19252       TO DFHEIV11
 19253*    MOVE '&$ L                  ''   #00018439' TO DFHEIV0
 19254     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19255     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19256     MOVE X'2020233030303138343339' TO DFHEIV0(25:11)
 19257     CALL 'kxdfhei1' USING DFHEIV0,
 19258           CRTT-ID,
 19259           CERTIFICATE-TRAILERS,
 19260           DFHEIV11,
 19261           WS-ELCRTT-KEY,
 19262           DFHEIV99,
 19263           DFHEIV99
 19264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19265
 19266
 19267 8190-EXIT.
 19268     EXIT.
 19269
 19270 8200-READ-REIN-TABLE.
 19271
 19272* EXEC CICS HANDLE CONDITION
 19273*         NOTFND   (8200-NOTFND)
 19274*    END-EXEC.
 19275*    MOVE '"$I                   ! 1 #00018449' TO DFHEIV0
 19276     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 355
* EL050.cbl
 19277     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19278     MOVE X'3120233030303138343439' TO DFHEIV0(25:11)
 19279     CALL 'kxdfhei1' USING DFHEIV0
 19280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19281
 19282
 19283
 19284* EXEC CICS READ
 19285*        DATASET     (REIN-ID)
 19286*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19287*        RIDFLD      (ERREIN-KEY)
 19288*    END-EXEC.
 19289*    MOVE '&"S        E          (   #00018453' TO DFHEIV0
 19290     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19291     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19292     MOVE X'2020233030303138343533' TO DFHEIV0(25:11)
 19293     CALL 'kxdfhei1' USING DFHEIV0,
 19294           REIN-ID,
 19295           DFHEIV20,
 19296           DFHEIV99,
 19297           ERREIN-KEY,
 19298           DFHEIV99,
 19299           DFHEIV99,
 19300           DFHEIV99
 19301     SET ADDRESS OF REINSURANCE-RECORD TO
 19302         DFHEIV20
 19303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19304
 19305
 19306     GO TO 8200-EXIT.
 19307
 19308 8200-NOTFND.
 19309     MOVE 'N'             TO WS-REIN-READ-SW.
 19310
 19311 8200-EXIT.
 19312      EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 356
* EL050.cbl
 19314
 19315 8300-READ-CTBL-TABLE.
 19316
 19317* EXEC CICS HANDLE CONDITION
 19318*        NOTFND    (8300-NOTFND)
 19319*        DISABLED  (8300-ERRESS-PROBLEM)
 19320*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19321*        ENDFILE   (8300-NOTFND)
 19322*    END-EXEC.
 19323*    MOVE '"$IcJ''                ! 2 #00018469' TO DFHEIV0
 19324     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19325     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19326     MOVE X'3220233030303138343639' TO DFHEIV0(25:11)
 19327     CALL 'kxdfhei1' USING DFHEIV0
 19328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19329
 19330
 19331
 19332* EXEC CICS READ
 19333*        DATASET     (CTBL-ID)
 19334*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19335*        RIDFLD      (ERCTBL-KEY)
 19336*    END-EXEC.
 19337*    MOVE '&"S        E          (   #00018476' TO DFHEIV0
 19338     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19339     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19340     MOVE X'2020233030303138343736' TO DFHEIV0(25:11)
 19341     CALL 'kxdfhei1' USING DFHEIV0,
 19342           CTBL-ID,
 19343           DFHEIV20,
 19344           DFHEIV99,
 19345           ERCTBL-KEY,
 19346           DFHEIV99,
 19347           DFHEIV99,
 19348           DFHEIV99
 19349     SET ADDRESS OF COMM-TABLE-RECORD TO
 19350         DFHEIV20
 19351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19352
 19353
 19354     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19355
 19356     GO TO 8300-EXIT.
 19357
 19358 8300-NOTFND.
 19359
 19360     IF CTBL-SW = '0530'
 19361         MOVE 'AA'                     TO WS-AH-COMP-CD
 19362         MOVE '0550'                   TO CTBL-SW
 19363         MOVE '1'                      TO WS-CTBL-READ-SW
 19364         GO TO 8300-EXIT.
 19365
 19366     IF CTBL-SW = '0540'
 19367         MOVE 'AA'                     TO WS-LF-COMP-CD
 19368         MOVE '0550'                   TO CTBL-SW
 19369         MOVE '1'                      TO WS-CTBL-READ-SW
 19370         GO TO 8300-EXIT.
 19371
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 357
* EL050.cbl
 19372     IF CTBL-SW = '0550'
 19373         MOVE '2'                      TO WS-CTBL-READ-SW
 19374         GO TO 8300-EXIT.
 19375
 19376     GO TO 8300-EXIT.
 19377
 19378 8300-ERRESS-PROBLEM.
 19379
 19380      MOVE ER-8050              TO WS-ERROR.
 19381      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19382
 19383     GO TO 8300-EXIT.
 19384
 19385 8300-EXIT.
 19386      EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 358
* EL050.cbl
 19388
 19389
 19390 8400-GETMAIN-ERFORM.
 19391
 19392
 19393* EXEC CICS   GETMAIN
 19394*        LENGTH  (500)
 19395*        SET     (ADDRESS OF FORM-MASTER)
 19396*    END-EXEC.
 19397     MOVE 500
 19398       TO DFHEIV11
 19399*    MOVE '," L                  $   #00018520' TO DFHEIV0
 19400     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19401     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19402     MOVE X'2020233030303138353230' TO DFHEIV0(25:11)
 19403     CALL 'kxdfhei1' USING DFHEIV0,
 19404           DFHEIV20,
 19405           DFHEIV11,
 19406           DFHEIV99
 19407     SET ADDRESS OF FORM-MASTER TO
 19408         DFHEIV20
 19409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19410
 19411
 19412     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19413
 19414 8400-EXIT.
 19415      EXIT.
 19416
 19417 8450-READ-FORM-MASTER.
 19418
 19419
 19420* EXEC CICS  HANDLE CONDITION
 19421*        NOTFND   (8450-FORM-NOT-FOUND)
 19422*        ENDFILE  (8450-FORM-NOT-FOUND)
 19423*    END-EXEC.
 19424*    MOVE '"$I''                  ! 3 #00018532' TO DFHEIV0
 19425     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19426     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19427     MOVE X'3320233030303138353332' TO DFHEIV0(25:11)
 19428     CALL 'kxdfhei1' USING DFHEIV0
 19429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19430
 19431
 19432
 19433* EXEC CICS   READ
 19434*        DATASET   (FORM-ID)
 19435*        RIDFLD    (ERFORM-KEY)
 19436*        INTO      (FORM-MASTER)
 19437*        GTEQ
 19438*    END-EXEC.
 19439     MOVE LENGTH OF
 19440      FORM-MASTER
 19441       TO DFHEIV11
 19442*    MOVE '&"IL       G          (   #00018537' TO DFHEIV0
 19443     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19444     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19445     MOVE X'2020233030303138353337' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 359
* EL050.cbl
 19446     CALL 'kxdfhei1' USING DFHEIV0,
 19447           FORM-ID,
 19448           FORM-MASTER,
 19449           DFHEIV11,
 19450           ERFORM-KEY,
 19451           DFHEIV99,
 19452           DFHEIV99,
 19453           DFHEIV99
 19454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19455
 19456
 19457     MOVE  'Y'           TO  FORM-MASTER-SW.
 19458
 19459     GO TO  8450-EXIT.
 19460
 19461 8450-FORM-NOT-FOUND.
 19462
 19463     MOVE  'N'           TO  FORM-MASTER-SW.
 19464
 19465 8450-EXIT.
 19466      EXIT.
 19467
 19468 8500-DATE-CONVERT.
 19469
 19470* EXEC CICS LINK
 19471*        PROGRAM    ('ELDATCV')
 19472*        COMMAREA   (DATE-CONVERSION-DATA)
 19473*        LENGTH     (DC-COMM-LENGTH)
 19474*    END-EXEC.
 19475     MOVE 'ELDATCV' TO DFHEIV1
 19476*    MOVE '."C                   ''   #00018556' TO DFHEIV0
 19477     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19478     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19479     MOVE X'2020233030303138353536' TO DFHEIV0(25:11)
 19480     CALL 'kxdfhei1' USING DFHEIV0,
 19481           DFHEIV1,
 19482           DATE-CONVERSION-DATA,
 19483           DC-COMM-LENGTH,
 19484           DFHEIV99,
 19485           DFHEIV99,
 19486           DFHEIV99
 19487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19488
 19489
 19490 8500-EXIT.
 19491     EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 360
* EL050.cbl
 19493
 19494 8555-RELOAD-CONTROL-FILE.
 19495     CONTINUE.
 19496
 19497 8555-EXIT.
 19498     EXIT.
 19499
 19500 8557-GETMAIN-ERPLAN.
 19501
 19502
 19503* EXEC CICS GETMAIN
 19504*        LENGTH    (840)
 19505*        SET       (ADDRESS OF PLAN-RECORDS)
 19506*    END-EXEC.
 19507     MOVE 840
 19508       TO DFHEIV11
 19509*    MOVE '," L                  $   #00018574' TO DFHEIV0
 19510     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19511     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19512     MOVE X'2020233030303138353734' TO DFHEIV0(25:11)
 19513     CALL 'kxdfhei1' USING DFHEIV0,
 19514           DFHEIV20,
 19515           DFHEIV11,
 19516           DFHEIV99
 19517     SET ADDRESS OF PLAN-RECORDS TO
 19518         DFHEIV20
 19519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19520
 19521
 19522     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 19523
 19524 8557-EXIT.
 19525     EXIT.
 19526
 19527 8560-GETMAIN.
 19528
 19529* EXEC CICS GETMAIN
 19530*        LENGTH    (2000)
 19531*        SET       (ADDRESS OF ACCOUNT-MASTER)
 19532*    END-EXEC.
 19533     MOVE 2000
 19534       TO DFHEIV11
 19535*    MOVE '," L                  $   #00018585' TO DFHEIV0
 19536     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19537     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19538     MOVE X'2020233030303138353835' TO DFHEIV0(25:11)
 19539     CALL 'kxdfhei1' USING DFHEIV0,
 19540           DFHEIV20,
 19541           DFHEIV11,
 19542           DFHEIV99
 19543     SET ADDRESS OF ACCOUNT-MASTER TO
 19544         DFHEIV20
 19545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19546
 19547
 19548     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 19549
 19550 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 361
* EL050.cbl
 19551     EXIT.
 19552
 19553 8570-START-ACCOUNT-MASTER.
 19554
 19555* EXEC CICS HANDLE CONDITION
 19556*        NOTFND    (0199-ACCT-NOT-FOUND)
 19557*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19558*    END-EXEC.
 19559*    MOVE '"$I''                  ! 4 #00018596' TO DFHEIV0
 19560     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19561     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19562     MOVE X'3420233030303138353936' TO DFHEIV0(25:11)
 19563     CALL 'kxdfhei1' USING DFHEIV0
 19564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19565
 19566
 19567
 19568* EXEC CICS STARTBR
 19569*        DATASET    (ACCT-ID)
 19570*        RIDFLD     (ERACCT-KEY)
 19571*        GTEQ
 19572*    END-EXEC.
 19573     MOVE 0
 19574       TO DFHEIV11
 19575*    MOVE '&,         G          &   #00018601' TO DFHEIV0
 19576     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19577     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19578     MOVE X'2020233030303138363031' TO DFHEIV0(25:11)
 19579     CALL 'kxdfhei1' USING DFHEIV0,
 19580           ACCT-ID,
 19581           ERACCT-KEY,
 19582           DFHEIV99,
 19583           DFHEIV11,
 19584           DFHEIV99
 19585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19586
 19587
 19588 8570-EXIT.
 19589     EXIT.
 19590
 19591 8580-READ-ACCOUNT-MASTER.
 19592
 19593* EXEC CICS HANDLE CONDITION
 19594*        NOTFND    (0199-ACCT-NOT-FOUND)
 19595*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19596*    END-EXEC.
 19597*    MOVE '"$I''                  ! 5 #00018611' TO DFHEIV0
 19598     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19599     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19600     MOVE X'3520233030303138363131' TO DFHEIV0(25:11)
 19601     CALL 'kxdfhei1' USING DFHEIV0
 19602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19603
 19604
 19605
 19606* EXEC CICS READNEXT
 19607*        DATASET     (ACCT-ID)
 19608*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 362
* EL050.cbl
 19609*        RIDFLD      (ERACCT-KEY)
 19610*    END-EXEC.
 19611     MOVE LENGTH OF
 19612      ACCOUNT-MASTER
 19613       TO DFHEIV12
 19614     MOVE 0
 19615       TO DFHEIV11
 19616*    MOVE '&.IL                  )   #00018616' TO DFHEIV0
 19617     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19618     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19619     MOVE X'2020233030303138363136' TO DFHEIV0(25:11)
 19620     CALL 'kxdfhei1' USING DFHEIV0,
 19621           ACCT-ID,
 19622           ACCOUNT-MASTER,
 19623           DFHEIV12,
 19624           ERACCT-KEY,
 19625           DFHEIV99,
 19626           DFHEIV11,
 19627           DFHEIV99,
 19628           DFHEIV99
 19629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19630
 19631
 19632 8580-EXIT.
 19633     EXIT.
 19634
 19635 8582-READ-COMPENSATION-MASTER.
 19636
 19637* EXEC CICS HANDLE CONDITION
 19638*        NOTFND    (8582-COMP-NOT-FOUND)
 19639*        ENDFILE   (8582-COMP-NOT-FOUND)
 19640*    END-EXEC.
 19641*    MOVE '"$I''                  ! 6 #00018626' TO DFHEIV0
 19642     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19643     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19644     MOVE X'3620233030303138363236' TO DFHEIV0(25:11)
 19645     CALL 'kxdfhei1' USING DFHEIV0
 19646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19647
 19648
 19649
 19650* EXEC CICS READ
 19651*        DATASET     (COMP-ID)
 19652*        INTO        (COMPENSATION-MASTER)
 19653*        RIDFLD      (ERCOMP-KEY)
 19654*    END-EXEC.
 19655     MOVE LENGTH OF
 19656      COMPENSATION-MASTER
 19657       TO DFHEIV11
 19658*    MOVE '&"IL       E          (   #00018631' TO DFHEIV0
 19659     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19660     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19661     MOVE X'2020233030303138363331' TO DFHEIV0(25:11)
 19662     CALL 'kxdfhei1' USING DFHEIV0,
 19663           COMP-ID,
 19664           COMPENSATION-MASTER,
 19665           DFHEIV11,
 19666           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 363
* EL050.cbl
 19667           DFHEIV99,
 19668           DFHEIV99,
 19669           DFHEIV99
 19670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19671
 19672
 19673     MOVE 'Y'                    TO COMP-MASTER-SW
 19674
 19675     GO TO 8582-EXIT
 19676     .
 19677 8582-COMP-NOT-FOUND.
 19678
 19679     MOVE 'N'                    TO COMP-MASTER-SW.
 19680
 19681 8582-EXIT.
 19682     EXIT.
 19683
 19684 8583-READ-ERAGTC.
 19685
 19686* EXEC CICS HANDLE CONDITION
 19687*        NOTFND    (8583-AGTC-NOT-FOUND)
 19688*        ENDFILE   (8583-AGTC-NOT-FOUND)
 19689*    END-EXEC.
 19690*    MOVE '"$I''                  ! 7 #00018649' TO DFHEIV0
 19691     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19692     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19693     MOVE X'3720233030303138363439' TO DFHEIV0(25:11)
 19694     CALL 'kxdfhei1' USING DFHEIV0
 19695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19696
 19697
 19698
 19699* EXEC CICS STARTBR
 19700*        DATASET    (AGTC-ID)
 19701*        RIDFLD     (ERAGTC-KEY)
 19702*        GTEQ
 19703*    END-EXEC.
 19704     MOVE 0
 19705       TO DFHEIV11
 19706*    MOVE '&,         G          &   #00018654' TO DFHEIV0
 19707     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19708     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19709     MOVE X'2020233030303138363534' TO DFHEIV0(25:11)
 19710     CALL 'kxdfhei1' USING DFHEIV0,
 19711           AGTC-ID,
 19712           ERAGTC-KEY,
 19713           DFHEIV99,
 19714           DFHEIV11,
 19715           DFHEIV99
 19716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19717
 19718
 19719 8583-READ-ERAGTC-NEXT.
 19720
 19721* EXEC CICS READNEXT
 19722*        DATASET     (AGTC-ID)
 19723*        INTO        (AGENT-COMMISSIONS)
 19724*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 364
* EL050.cbl
 19725*    END-EXEC.
 19726     MOVE LENGTH OF
 19727      AGENT-COMMISSIONS
 19728       TO DFHEIV12
 19729     MOVE 0
 19730       TO DFHEIV11
 19731*    MOVE '&.IL                  )   #00018661' TO DFHEIV0
 19732     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19733     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19734     MOVE X'2020233030303138363631' TO DFHEIV0(25:11)
 19735     CALL 'kxdfhei1' USING DFHEIV0,
 19736           AGTC-ID,
 19737           AGENT-COMMISSIONS,
 19738           DFHEIV12,
 19739           ERAGTC-KEY,
 19740           DFHEIV99,
 19741           DFHEIV11,
 19742           DFHEIV99,
 19743           DFHEIV99
 19744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19745
 19746
 19747*    MOVE 'Y'                    TO AGTC-MASTER-SW
 19748
 19749     GO TO 8583-EXIT
 19750     .
 19751 8583-AGTC-NOT-FOUND.
 19752
 19753     MOVE 'N'                    TO AGTC-MASTER-SW.
 19754
 19755 8583-EXIT.
 19756     EXIT.
 19757
 19758 8584-READ-BANK-CROSS-REF.
 19759
 19760* EXEC CICS HANDLE CONDITION
 19761*        NOTFND    (8584-BXRF-NOT-FOUND)
 19762*        ENDFILE   (8584-BXRF-NOT-FOUND)
 19763*    END-EXEC.
 19764*    MOVE '"$I''                  ! 8 #00018679' TO DFHEIV0
 19765     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19766     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19767     MOVE X'3820233030303138363739' TO DFHEIV0(25:11)
 19768     CALL 'kxdfhei1' USING DFHEIV0
 19769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19770
 19771
 19772
 19773* EXEC CICS READ
 19774*        DATASET     (BXRF-ID)
 19775*        INTO        (BANK-CROSS-REFERENCE)
 19776*        RIDFLD      (ERBXRF-KEY)
 19777*        LENGTH      (BXRF-REC-LENGTH)
 19778*    END-EXEC.
 19779*    MOVE '&"IL       E          (   #00018684' TO DFHEIV0
 19780     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19781     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19782     MOVE X'2020233030303138363834' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 365
* EL050.cbl
 19783     CALL 'kxdfhei1' USING DFHEIV0,
 19784           BXRF-ID,
 19785           BANK-CROSS-REFERENCE,
 19786           BXRF-REC-LENGTH,
 19787           ERBXRF-KEY,
 19788           DFHEIV99,
 19789           DFHEIV99,
 19790           DFHEIV99
 19791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19792
 19793
 19794     MOVE 'Y'                    TO BXRF-MASTER-SW
 19795
 19796     GO TO 8584-EXIT
 19797     .
 19798 8584-BXRF-NOT-FOUND.
 19799
 19800     MOVE 'N'                    TO BXRF-MASTER-SW.
 19801
 19802 8584-EXIT.
 19803     EXIT.
 19804
 19805 8585-READ-PLAN-MASTER.
 19806
 19807
 19808* EXEC CICS HANDLE CONDITION
 19809*        NOTFND    (8585-PLAN-NOT-FOUND)
 19810*        ENDFILE   (8585-PLAN-NOT-FOUND)
 19811*    END-EXEC.
 19812*    MOVE '"$I''                  ! 9 #00018704' TO DFHEIV0
 19813     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19814     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19815     MOVE X'3920233030303138373034' TO DFHEIV0(25:11)
 19816     CALL 'kxdfhei1' USING DFHEIV0
 19817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19818
 19819
 19820
 19821* EXEC CICS READ
 19822*        DATASET     (PLAN-ID)
 19823*        INTO        (PLAN-MASTER)
 19824*        RIDFLD      (ERPLAN-KEY)
 19825*    END-EXEC.
 19826     MOVE LENGTH OF
 19827      PLAN-MASTER
 19828       TO DFHEIV11
 19829*    MOVE '&"IL       E          (   #00018709' TO DFHEIV0
 19830     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19831     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19832     MOVE X'2020233030303138373039' TO DFHEIV0(25:11)
 19833     CALL 'kxdfhei1' USING DFHEIV0,
 19834           PLAN-ID,
 19835           PLAN-MASTER,
 19836           DFHEIV11,
 19837           ERPLAN-KEY,
 19838           DFHEIV99,
 19839           DFHEIV99,
 19840           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 366
* EL050.cbl
 19841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19842
 19843
 19844     MOVE 'Y'                    TO PLAN-MASTER-SW.
 19845
 19846     GO TO 8585-EXIT.
 19847
 19848 8585-PLAN-NOT-FOUND.
 19849
 19850     MOVE 'N'                    TO PLAN-MASTER-SW.
 19851
 19852 8585-EXIT.
 19853     EXIT.
 19854
 19855 8586-READ-LOAN-OFFICER.
 19856
 19857* EXEC CICS READ
 19858*        DATASET     (LOFC-ID)
 19859*        INTO        (LOAN-OFFICER-MASTER)
 19860*        RIDFLD      (ERLOFC-KEY)
 19861*        RESP        (WS-RESPONSE)
 19862*    END-EXEC
 19863     MOVE LENGTH OF
 19864      LOAN-OFFICER-MASTER
 19865       TO DFHEIV11
 19866*    MOVE '&"IL       E          (  N#00018727' TO DFHEIV0
 19867     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19868     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19869     MOVE X'204E233030303138373237' TO DFHEIV0(25:11)
 19870     CALL 'kxdfhei1' USING DFHEIV0,
 19871           LOFC-ID,
 19872           LOAN-OFFICER-MASTER,
 19873           DFHEIV11,
 19874           ERLOFC-KEY,
 19875           DFHEIV99,
 19876           DFHEIV99,
 19877           DFHEIV99
 19878     MOVE EIBRESP  TO WS-RESPONSE
 19879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19880
 19881     IF WS-RESP-NORMAL
 19882        MOVE 'Y'                 TO LOFC-MASTER-SW
 19883     ELSE
 19884        MOVE 'N'                 TO LOFC-MASTER-SW
 19885     END-IF
 19886     .
 19887 8586-EXIT.
 19888     EXIT.
 19889 8587-START-ERPDEF.
 19890
 19891* EXEC CICS STARTBR
 19892*       DATASET   (PDEF-ID)
 19893*       RIDFLD    (ERPDEF-KEY)
 19894*       GTEQ
 19895*       RESP      (WS-RESPONSE)
 19896*    END-EXEC
 19897     MOVE 0
 19898       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 367
* EL050.cbl
 19899*    MOVE '&,         G          &  N#00018743' TO DFHEIV0
 19900     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19901     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19902     MOVE X'204E233030303138373433' TO DFHEIV0(25:11)
 19903     CALL 'kxdfhei1' USING DFHEIV0,
 19904           PDEF-ID,
 19905           ERPDEF-KEY,
 19906           DFHEIV99,
 19907           DFHEIV11,
 19908           DFHEIV99
 19909     MOVE EIBRESP  TO WS-RESPONSE
 19910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19911     IF WS-RESP-NORMAL
 19912        MOVE 'Y'                 TO PDEF-MASTER-SW
 19913     ELSE
 19914        MOVE 'N'                 TO PDEF-MASTER-SW
 19915     END-IF
 19916     .
 19917 8587-EXIT.
 19918     EXIT.
 19919 8588-READ-ERPDEF.
 19920
 19921* EXEC CICS READNEXT
 19922*       DATASET   (PDEF-ID)
 19923*       RIDFLD    (ERPDEF-KEY)
 19924*       INTO      (PRODUCT-MASTER)
 19925*       RESP      (WS-RESPONSE)
 19926*    END-EXEC
 19927     MOVE LENGTH OF
 19928      PRODUCT-MASTER
 19929       TO DFHEIV12
 19930     MOVE 0
 19931       TO DFHEIV11
 19932*    MOVE '&.IL                  )  N#00018758' TO DFHEIV0
 19933     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19934     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19935     MOVE X'204E233030303138373538' TO DFHEIV0(25:11)
 19936     CALL 'kxdfhei1' USING DFHEIV0,
 19937           PDEF-ID,
 19938           PRODUCT-MASTER,
 19939           DFHEIV12,
 19940           ERPDEF-KEY,
 19941           DFHEIV99,
 19942           DFHEIV11,
 19943           DFHEIV99,
 19944           DFHEIV99
 19945     MOVE EIBRESP  TO WS-RESPONSE
 19946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19947     IF WS-RESP-NORMAL
 19948        MOVE 'Y'                 TO PDEF-MASTER-SW
 19949     ELSE
 19950        MOVE 'N'                 TO PDEF-MASTER-SW
 19951     END-IF
 19952     .
 19953 8588-EXIT.
 19954     EXIT.
 19955 8589-ENDBR-ERPDEF.
 19956
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 368
* EL050.cbl
 19957* EXEC CICS ENDBR
 19958*       DATASET   (PDEF-ID)
 19959*    END-EXEC
 19960     MOVE 0
 19961       TO DFHEIV11
 19962*    MOVE '&2                    $   #00018773' TO DFHEIV0
 19963     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19964     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19965     MOVE X'2020233030303138373733' TO DFHEIV0(25:11)
 19966     CALL 'kxdfhei1' USING DFHEIV0,
 19967           PDEF-ID,
 19968           DFHEIV11,
 19969           DFHEIV99
 19970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19971     .
 19972 8589-EXIT.
 19973     EXIT.
 19974 8590-READ-CERT-MASTER.
 19975     IF PB-COMPANY-ID = 'UCL'
 19976         GO TO 8690-READ-CERT-MASTER-UCL.
 19977
 19978
 19979* EXEC CICS HANDLE CONDITION
 19980*         NOTFND    (0299-CERT-NOT-FOUND)
 19981*    END-EXEC.
 19982*    MOVE '"$I                   ! : #00018783' TO DFHEIV0
 19983     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19984     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19985     MOVE X'3A20233030303138373833' TO DFHEIV0(25:11)
 19986     CALL 'kxdfhei1' USING DFHEIV0
 19987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19988
 19989
 19990
 19991* EXEC CICS READ
 19992*        DATASET     (CERT-ID)
 19993*        INTO        (CERTIFICATE-MASTER)
 19994*        RIDFLD      (ELCERT-KEY)
 19995*        UPDATE
 19996*    END-EXEC.
 19997     MOVE LENGTH OF
 19998      CERTIFICATE-MASTER
 19999       TO DFHEIV11
 20000*    MOVE '&"IL       EU         (   #00018787' TO DFHEIV0
 20001     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20002     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20003     MOVE X'2020233030303138373837' TO DFHEIV0(25:11)
 20004     CALL 'kxdfhei1' USING DFHEIV0,
 20005           CERT-ID,
 20006           CERTIFICATE-MASTER,
 20007           DFHEIV11,
 20008           ELCERT-KEY,
 20009           DFHEIV99,
 20010           DFHEIV99,
 20011           DFHEIV99
 20012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20013
 20014
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 369
* EL050.cbl
 20015 8590-EXIT.
 20016     EXIT.
 20017
 20018 8690-READ-CERT-MASTER-UCL.
 20019
 20020* EXEC CICS HANDLE CONDITION
 20021*         NOTFND    (8700-READ-CERT-MASTER)
 20022*    END-EXEC.
 20023*    MOVE '"$I                   ! ; #00018798' TO DFHEIV0
 20024     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20025     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20026     MOVE X'3B20233030303138373938' TO DFHEIV0(25:11)
 20027     CALL 'kxdfhei1' USING DFHEIV0
 20028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20029
 20030
 20031 8690-READ-CERT-CONT.
 20032
 20033* EXEC CICS READ
 20034*        DATASET     (CERT-ID)
 20035*        INTO        (CERTIFICATE-MASTER)
 20036*        RIDFLD      (ELCERT-KEY)
 20037*        UPDATE
 20038*    END-EXEC.
 20039     MOVE LENGTH OF
 20040      CERTIFICATE-MASTER
 20041       TO DFHEIV11
 20042*    MOVE '&"IL       EU         (   #00018803' TO DFHEIV0
 20043     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20044     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20045     MOVE X'2020233030303138383033' TO DFHEIV0(25:11)
 20046     CALL 'kxdfhei1' USING DFHEIV0,
 20047           CERT-ID,
 20048           CERTIFICATE-MASTER,
 20049           DFHEIV11,
 20050           ELCERT-KEY,
 20051           DFHEIV99,
 20052           DFHEIV99,
 20053           DFHEIV99
 20054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20055
 20056
 20057     GO TO 8590-EXIT.
 20058
 20059 8700-READ-CERT-MASTER.
 20060     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20061     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20062
 20063* EXEC CICS HANDLE CONDITION
 20064*         DUPKEY    (8720-COMP-ACCOUNTS)
 20065*         ENDFILE   (8730-END-BROWSE)
 20066*         NOTFND    (8740-NOT-FOUND)
 20067*    END-EXEC.
 20068*    MOVE '"$$''I                 ! < #00018815' TO DFHEIV0
 20069     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20070     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20071     MOVE X'3C20233030303138383135' TO DFHEIV0(25:11)
 20072     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 370
* EL050.cbl
 20073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20074
 20075
 20076
 20077* EXEC CICS STARTBR
 20078*        DATASET     ('ELCERT5')
 20079*        RIDFLD      (ELCERT2-KEY)
 20080*        EQUAL
 20081*    END-EXEC.
 20082     MOVE 'ELCERT5' TO DFHEIV1
 20083     MOVE 0
 20084       TO DFHEIV11
 20085*    MOVE '&,         E          &   #00018821' TO DFHEIV0
 20086     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20087     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20088     MOVE X'2020233030303138383231' TO DFHEIV0(25:11)
 20089     CALL 'kxdfhei1' USING DFHEIV0,
 20090           DFHEIV1,
 20091           ELCERT2-KEY,
 20092           DFHEIV99,
 20093           DFHEIV11,
 20094           DFHEIV99
 20095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20096
 20097
 20098 8710-READ-NEXT.
 20099
 20100* EXEC CICS READNEXT
 20101*        DATASET     ('ELCERT5')
 20102*        INTO        (CERTIFICATE-MASTER)
 20103*        RIDFLD      (ELCERT2-KEY)
 20104*    END-EXEC.
 20105     MOVE LENGTH OF
 20106      CERTIFICATE-MASTER
 20107       TO DFHEIV12
 20108     MOVE 'ELCERT5' TO DFHEIV1
 20109     MOVE 0
 20110       TO DFHEIV11
 20111*    MOVE '&.IL                  )   #00018828' TO DFHEIV0
 20112     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20113     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20114     MOVE X'2020233030303138383238' TO DFHEIV0(25:11)
 20115     CALL 'kxdfhei1' USING DFHEIV0,
 20116           DFHEIV1,
 20117           CERTIFICATE-MASTER,
 20118           DFHEIV12,
 20119           ELCERT2-KEY,
 20120           DFHEIV99,
 20121           DFHEIV11,
 20122           DFHEIV99,
 20123           DFHEIV99
 20124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20125
 20126
 20127 8720-COMP-ACCOUNTS.
 20128
 20129* EXEC CICS ENTER
 20130*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 371
* EL050.cbl
 20131*         FROM (PB-C-LAST-NAME)
 20132*    END-EXEC.
 20133     MOVE 001
 20134       TO DFHEIV11
 20135*    MOVE ':$F                   %   #00018835' TO DFHEIV0
 20136     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20137     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20138     MOVE X'2020233030303138383335' TO DFHEIV0(25:11)
 20139     CALL 'kxdfhei1' USING DFHEIV0,
 20140           DFHEIV11,
 20141           PB-C-LAST-NAME,
 20142           DFHEIV99,
 20143           DFHEIV99
 20144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20145
 20146
 20147
 20148* EXEC CICS ENTER
 20149*         TRACEID (002)
 20150*         FROM (CM-INSURED-LAST-NAME)
 20151*    END-EXEC.
 20152     MOVE 002
 20153       TO DFHEIV11
 20154*    MOVE ':$F                   %   #00018840' TO DFHEIV0
 20155     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20156     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20157     MOVE X'2020233030303138383430' TO DFHEIV0(25:11)
 20158     CALL 'kxdfhei1' USING DFHEIV0,
 20159           DFHEIV11,
 20160           CM-INSURED-LAST-NAME,
 20161           DFHEIV99,
 20162           DFHEIV99
 20163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20164
 20165
 20166     IF PB-CERT-NO NOT = CM-CERT-NO
 20167         GO TO 8730-END-BROWSE.
 20168
 20169     IF PB-ACCOUNT = CM-ACCOUNT
 20170         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20171             MOVE ER-2799        TO WS-ERROR
 20172             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20173             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20174             GO TO 8730-END-BROWSE.
 20175
 20176     GO TO 8710-READ-NEXT.
 20177
 20178 8730-END-BROWSE.
 20179
 20180* EXEC CICS ENDBR
 20181*         DATASET    ('ELCERT5')
 20182*    END-EXEC.
 20183     MOVE 'ELCERT5' TO DFHEIV1
 20184     MOVE 0
 20185       TO DFHEIV11
 20186*    MOVE '&2                    $   #00018858' TO DFHEIV0
 20187     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20188     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 372
* EL050.cbl
 20189     MOVE X'2020233030303138383538' TO DFHEIV0(25:11)
 20190     CALL 'kxdfhei1' USING DFHEIV0,
 20191           DFHEIV1,
 20192           DFHEIV11,
 20193           DFHEIV99
 20194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20195
 20196
 20197 8740-NOT-FOUND.
 20198     GO TO 0299-CERT-NOT-FOUND.
 20199
 20200 8750-START-ELSTAT.
 20201
 20202* EXEC CICS STARTBR
 20203*       DATASET   (STAT-ID)
 20204*       RIDFLD    (ELSTAT-KEY)
 20205*       GTEQ
 20206*       RESP      (WS-RESPONSE)
 20207*    END-EXEC
 20208     MOVE 0
 20209       TO DFHEIV11
 20210*    MOVE '&,         G          &  N#00018866' TO DFHEIV0
 20211     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20212     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20213     MOVE X'204E233030303138383636' TO DFHEIV0(25:11)
 20214     CALL 'kxdfhei1' USING DFHEIV0,
 20215           STAT-ID,
 20216           ELSTAT-KEY,
 20217           DFHEIV99,
 20218           DFHEIV11,
 20219           DFHEIV99
 20220     MOVE EIBRESP  TO WS-RESPONSE
 20221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20222     IF WS-RESP-NORMAL
 20223        MOVE 'Y'                 TO STAT-MASTER-SW
 20224     ELSE
 20225        MOVE 'N'                 TO STAT-MASTER-SW
 20226     END-IF
 20227     .
 20228 8750-EXIT.
 20229     EXIT.
 20230 8752-READ-ELSTAT.
 20231
 20232* EXEC CICS READNEXT
 20233*       DATASET   (STAT-ID)
 20234*       RIDFLD    (ELSTAT-KEY)
 20235*       INTO      (STATE-FILE)
 20236*       RESP      (WS-RESPONSE)
 20237*    END-EXEC
 20238     MOVE LENGTH OF
 20239      STATE-FILE
 20240       TO DFHEIV12
 20241     MOVE 0
 20242       TO DFHEIV11
 20243*    MOVE '&.IL                  )  N#00018881' TO DFHEIV0
 20244     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20245     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20246     MOVE X'204E233030303138383831' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 373
* EL050.cbl
 20247     CALL 'kxdfhei1' USING DFHEIV0,
 20248           STAT-ID,
 20249           STATE-FILE,
 20250           DFHEIV12,
 20251           ELSTAT-KEY,
 20252           DFHEIV99,
 20253           DFHEIV11,
 20254           DFHEIV99,
 20255           DFHEIV99
 20256     MOVE EIBRESP  TO WS-RESPONSE
 20257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20258     IF WS-RESP-NORMAL
 20259        MOVE 'Y'                 TO STAT-MASTER-SW
 20260     ELSE
 20261        MOVE 'N'                 TO STAT-MASTER-SW
 20262     END-IF
 20263     .
 20264 8752-EXIT.
 20265     EXIT.
 20266 8800-GET-COMP-RATE.
 20267     MOVE +1 TO IB.
 20268     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20269         ADD +9 TO IB
 20270         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20271             ADD +9 TO IB
 20272             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20273                MOVE ZEROS       TO WS-WK-RATE
 20274                GO TO 8800-EXIT.
 20275
 20276     IF PB-I-AGE GREATER CT-AGE (1)
 20277         ADD +3 TO IB
 20278         IF PB-I-AGE GREATER CT-AGE (2)
 20279             ADD +3 TO IB
 20280             IF PB-I-AGE GREATER CT-AGE (3)
 20281                MOVE ZEROS       TO WS-WK-RATE
 20282                GO TO 8800-EXIT.
 20283
 20284     IF WS-WORK-TERM GREATER CT-TRM (1)
 20285         ADD +1 TO IB
 20286         IF WS-WORK-TERM GREATER CT-TRM (2)
 20287             ADD +1 TO IB
 20288             IF WS-WORK-TERM GREATER CT-TRM (3)
 20289                MOVE ZEROS       TO WS-WK-RATE
 20290                GO TO 8800-EXIT.
 20291
 20292     IF CT-RT (IB) NOT NUMERIC
 20293         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20294         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20295         GO TO 8800-GET-COMP-RATE.
 20296
 20297     MOVE CT-RT (IB) TO WS-WK-RATE.
 20298
 20299 8800-EXIT.
 20300     EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 374
* EL050.cbl
 20302 8900-ADDRESS-FILE.
 20303     IF ERACCT-FILE-ADDRESSED
 20304         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20305         GO TO 8900-ADDRESS-EXIT.
 20306
 20307     IF ELCNTL-FILE-ADDRESSED
 20308         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20309         GO TO 8900-ADDRESS-EXIT.
 20310
 20311     IF ERPLAN-FILE-ADDRESSED
 20312         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20313         GO TO 8900-ADDRESS-EXIT.
 20314
 20315     IF ERFORM-FILE-ADDRESSED
 20316         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20317         GO TO 8900-ADDRESS-EXIT.
 20318
 20319 8900-ADDRESS-EXIT.
 20320     EXIT.
 20321
 20322 9000-READ-CONTROL.
 20323
 20324* EXEC CICS HANDLE CONDITION
 20325*        NOTFND    (9000-NOTFND)
 20326*    END-EXEC.
 20327*    MOVE '"$I                   ! = #00018952' TO DFHEIV0
 20328     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20329     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20330     MOVE X'3D20233030303138393532' TO DFHEIV0(25:11)
 20331     CALL 'kxdfhei1' USING DFHEIV0
 20332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20333
 20334
 20335
 20336* EXEC CICS READ
 20337*        DATASET     (CNTL-ID)
 20338*        SET         (ADDRESS OF CONTROL-FILE)
 20339*        RIDFLD      (ELCNTL-KEY)
 20340*        GTEQ
 20341*    END-EXEC.
 20342*    MOVE '&"S        G          (   #00018956' TO DFHEIV0
 20343     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20344     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20345     MOVE X'2020233030303138393536' TO DFHEIV0(25:11)
 20346     CALL 'kxdfhei1' USING DFHEIV0,
 20347           CNTL-ID,
 20348           DFHEIV20,
 20349           DFHEIV99,
 20350           ELCNTL-KEY,
 20351           DFHEIV99,
 20352           DFHEIV99,
 20353           DFHEIV99
 20354     SET ADDRESS OF CONTROL-FILE TO
 20355         DFHEIV20
 20356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20357
 20358
 20359     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 375
* EL050.cbl
 20360
 20361 9000-NOTFND.
 20362     IF RC-SW-1 = '1'
 20363        MOVE ER-2616              TO WS-ERROR
 20364        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20365        GO TO 9000-EXIT.
 20366
 20367     IF RC-SW-1 = '2'
 20368        MOVE ER-2602              TO WS-ERROR
 20369        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20370
 20371 9000-EXIT.
 20372      EXIT.
 20373
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 376
* EL050.cbl
 20375 9100-READ-CONTROL.
 20376
 20377* EXEC CICS HANDLE CONDITION
 20378*        NOTFND  (9100-NOTFND)
 20379*        ENDFILE (9100-NOTFND)
 20380*    END-EXEC.
 20381*    MOVE '"$I''                  ! > #00018980' TO DFHEIV0
 20382     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20383     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20384     MOVE X'3E20233030303138393830' TO DFHEIV0(25:11)
 20385     CALL 'kxdfhei1' USING DFHEIV0
 20386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20387
 20388
 20389
 20390* EXEC CICS READ
 20391*        DATASET     (CNTL-ID)
 20392*        INTO        (CONTROL-FILE)
 20393*        RIDFLD      (ELCNTL-KEY)
 20394*        GTEQ
 20395*    END-EXEC.
 20396     MOVE LENGTH OF
 20397      CONTROL-FILE
 20398       TO DFHEIV11
 20399*    MOVE '&"IL       G          (   #00018985' TO DFHEIV0
 20400     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20401     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20402     MOVE X'2020233030303138393835' TO DFHEIV0(25:11)
 20403     CALL 'kxdfhei1' USING DFHEIV0,
 20404           CNTL-ID,
 20405           CONTROL-FILE,
 20406           DFHEIV11,
 20407           ELCNTL-KEY,
 20408           DFHEIV99,
 20409           DFHEIV99,
 20410           DFHEIV99
 20411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20412
 20413
 20414     GO TO 9100-EXIT.
 20415
 20416 9100-NOTFND.
 20417     IF RC-SW-2 = '0'
 20418        MOVE '1'                  TO STATE-RECORD-ERROR
 20419        GO TO 9100-EXIT
 20420     END-IF
 20421     IF RC-SW-2 = '1'
 20422        MOVE '1'                  TO LF-BENEFIT-ERROR
 20423        MOVE ER-2604              TO WS-ERROR
 20424        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20425        GO TO 9100-EXIT.
 20426
 20427     IF RC-SW-2 = '2'
 20428        MOVE '1'                  TO AH-BENEFIT-ERROR
 20429        MOVE ER-2605              TO WS-ERROR
 20430        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20431        GO TO 9100-EXIT.
 20432
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 377
* EL050.cbl
 20433     IF RC-SW-2 = '3'
 20434         MOVE ER-2603           TO WS-ERROR
 20435         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20436         GO TO 9100-EXIT.
 20437
 20438     IF RC-SW-2 = '4'
 20439         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20440         GO TO 9100-EXIT.
 20441
 20442     IF RC-SW-2 = '5'
 20443         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20444         IF WS-AH-INPUT-CD-1 = SPACE
 20445             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20446         ELSE
 20447             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20448
 20449 9100-EXIT.
 20450      EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 378
* EL050.cbl
 20452 9200-CONTROL-GETMAIN.
 20453
 20454* EXEC CICS GETMAIN
 20455*         LENGTH   (750)
 20456*         SET      (ADDRESS OF CONTROL-FILE)
 20457*    END-EXEC.
 20458     MOVE 750
 20459       TO DFHEIV11
 20460*    MOVE '," L                  $   #00019031' TO DFHEIV0
 20461     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20462     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20463     MOVE X'2020233030303139303331' TO DFHEIV0(25:11)
 20464     CALL 'kxdfhei1' USING DFHEIV0,
 20465           DFHEIV20,
 20466           DFHEIV11,
 20467           DFHEIV99
 20468     SET ADDRESS OF CONTROL-FILE TO
 20469         DFHEIV20
 20470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20471
 20472
 20473     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20474
 20475 9200-EXIT.
 20476     EXIT.
 20477
 20478 9250-UNLOCK-RETURN.
 20479
 20480* EXEC CICS UNLOCK
 20481*        DATASET   (CERT-ID)
 20482*    END-EXEC.
 20483*    MOVE '&*                    #   #00019042' TO DFHEIV0
 20484     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20485     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20486     MOVE X'2020233030303139303432' TO DFHEIV0(25:11)
 20487     CALL 'kxdfhei1' USING DFHEIV0,
 20488           CERT-ID,
 20489           DFHEIV99
 20490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20491
 20492
 20493 9300-ABEND.
 20494     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20495
 20496
 20497* EXEC CICS LINK
 20498*        PROGRAM   ('EL004')
 20499*        COMMAREA  (WS-ERROR-LINE)
 20500*        LENGTH    (72)
 20501*    END-EXEC.
 20502     MOVE 'EL004' TO DFHEIV1
 20503     MOVE 72
 20504       TO DFHEIV11
 20505*    MOVE '."C                   ''   #00019049' TO DFHEIV0
 20506     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20507     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20508     MOVE X'2020233030303139303439' TO DFHEIV0(25:11)
 20509     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 379
* EL050.cbl
 20510           DFHEIV1,
 20511           WS-ERROR-LINE,
 20512           DFHEIV11,
 20513           DFHEIV99,
 20514           DFHEIV99,
 20515           DFHEIV99
 20516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20517
 20518
 20519     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 20520
 20521
 20522* EXEC CICS ABEND
 20523*        ABCODE ('EL50')
 20524*    END-EXEC.
 20525     MOVE 'EL50' TO DFHEIV5
 20526*    MOVE '.,A                   "   #00019057' TO DFHEIV0
 20527     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 20528     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 20529     MOVE X'2020233030303139303537' TO DFHEIV0(25:11)
 20530     CALL 'kxdfhei1' USING DFHEIV0,
 20531           DFHEIV5
 20532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20533
 20534
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 380
* EL050.cbl
 20536
 20537******************************************************************
 20538*                                                                *
 20539*            E R R O R   F O R M A T   R O U T I N E             *
 20540*                                                                *
 20541******************************************************************
 20542
 20543 9900-ERROR-FORMAT.
 20544
 20545     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 20546                    PB-COMMON-ERROR (2) OR
 20547                    PB-COMMON-ERROR (3) OR
 20548                    PB-COMMON-ERROR (4) OR
 20549                    PB-COMMON-ERROR (5) OR
 20550                    PB-COMMON-ERROR (6) OR
 20551                    PB-COMMON-ERROR (7) OR
 20552                    PB-COMMON-ERROR (8) OR
 20553                    PB-COMMON-ERROR (9) OR
 20554                    PB-COMMON-ERROR (10)
 20555        GO TO 9900-EXIT.
 20556
 20557     IF PB-NO-OF-ERRORS = +10
 20558        GO TO 9900-EXIT.
 20559
 20560     ADD +1  TO PB-NO-OF-ERRORS.
 20561     MOVE WS-ERROR               TO PB-COMMON-ERROR
 20562                                       (PB-NO-OF-ERRORS).
 20563 9900-EXIT.
 20564     EXIT.
 20565
 20566 9990-RETURN.
 20567     IF BROWSE-STARTED
 20568
 20569* EXEC CICS ENDBR
 20570*            DATASET  (ACCT-ID)
 20571*       END-EXEC.
 20572     MOVE 0
 20573       TO DFHEIV11
 20574*    MOVE '&2                    $   #00019094' TO DFHEIV0
 20575     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20576     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20577     MOVE X'2020233030303139303934' TO DFHEIV0(25:11)
 20578     CALL 'kxdfhei1' USING DFHEIV0,
 20579           ACCT-ID,
 20580           DFHEIV11,
 20581           DFHEIV99
 20582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20583
 20584
 20585 9990-EXIT.
 20586     EXIT.
 20587
 20588 9999-RETURN.
 20589     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 20590
 20591
 20592* EXEC CICS RETURN
 20593*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 381
* EL050.cbl
 20594*    MOVE '.(                    &   #00019104' TO DFHEIV0
 20595     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20596     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20597     MOVE X'2020233030303139313034' TO DFHEIV0(25:11)
 20598     CALL 'kxdfhei1' USING DFHEIV0,
 20599           DFHEIV99,
 20600           DFHEIV99,
 20601           DFHEIV99,
 20602           DFHEIV99,
 20603           DFHEIV99
 20604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20605
 20606
 20607
 20608* GOBACK.
 20609     MOVE '9%                    "   ' TO DFHEIV0
 20610     MOVE 'EL050' TO DFHEIV1
 20611     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20612     GOBACK.
 20613
 20614 9999-DFHBACK SECTION.
 20615     MOVE '9%                    "   ' TO DFHEIV0
 20616     MOVE 'EL050' TO DFHEIV1
 20617     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20618     GOBACK.
 20619 9999-DFHEXIT.
 20620     IF DFHEIGDJ EQUAL 0001
 20621         NEXT SENTENCE
 20622     ELSE IF DFHEIGDJ EQUAL 2
 20623         GO TO 9300-ABEND,
 20624               3990-FILES-NOT-OPEN
 20625         DEPENDING ON DFHEIGDI
 20626     ELSE IF DFHEIGDJ EQUAL 3
 20627         GO TO 6610-START-BROWSE,
 20628               6630-ERRESS-PROBLEM,
 20629               6630-END-OF-FILE
 20630         DEPENDING ON DFHEIGDI
 20631     ELSE IF DFHEIGDJ EQUAL 4
 20632         GO TO 6630-END-OF-FILE,
 20633               6630-ERRESS-PROBLEM,
 20634               6630-ERRESS-PROBLEM,
 20635               6630-END-OF-FILE
 20636         DEPENDING ON DFHEIGDI
 20637     ELSE IF DFHEIGDJ EQUAL 5
 20638         GO TO 6630-END-OF-FILE,
 20639               6630-END-OF-FILE,
 20640               6630-ERRESS-PROBLEM,
 20641               6630-ERRESS-PROBLEM
 20642         DEPENDING ON DFHEIGDI
 20643     ELSE IF DFHEIGDJ EQUAL 6
 20644         GO TO 6660-START-BROWSE,
 20645               6690-ERRESC-PROBLEM,
 20646               6690-ERRESC-PROBLEM,
 20647               6690-END-OF-FILE
 20648         DEPENDING ON DFHEIGDI
 20649     ELSE IF DFHEIGDJ EQUAL 7
 20650         GO TO 6690-END-OF-FILE,
 20651               6690-ERRESC-PROBLEM,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 382
* EL050.cbl
 20652               6690-ERRESC-PROBLEM,
 20653               6690-END-OF-FILE
 20654         DEPENDING ON DFHEIGDI
 20655     ELSE IF DFHEIGDJ EQUAL 8
 20656         GO TO 6690-END-OF-FILE,
 20657               6690-ERRESC-PROBLEM,
 20658               6690-ERRESC-PROBLEM,
 20659               6690-END-OF-FILE
 20660         DEPENDING ON DFHEIGDI
 20661     ELSE IF DFHEIGDJ EQUAL 9
 20662         GO TO 7250-CONTINUE,
 20663               7250-CONTINUE
 20664         DEPENDING ON DFHEIGDI
 20665     ELSE IF DFHEIGDJ EQUAL 10
 20666         GO TO 7300-CONTINUE,
 20667               7300-CONTINUE
 20668         DEPENDING ON DFHEIGDI
 20669     ELSE IF DFHEIGDJ EQUAL 11
 20670         GO TO 8000-FREE-MAIN
 20671         DEPENDING ON DFHEIGDI
 20672     ELSE IF DFHEIGDJ EQUAL 12
 20673         GO TO 8100-NOTFND,
 20674               8100-NOTFND
 20675         DEPENDING ON DFHEIGDI
 20676     ELSE IF DFHEIGDJ EQUAL 13
 20677         GO TO 8110-NOTFND,
 20678               8110-NOTFND
 20679         DEPENDING ON DFHEIGDI
 20680     ELSE IF DFHEIGDJ EQUAL 14
 20681         GO TO 8130-EXIT
 20682         DEPENDING ON DFHEIGDI
 20683     ELSE IF DFHEIGDJ EQUAL 15
 20684         GO TO 8180-NOTFND
 20685         DEPENDING ON DFHEIGDI
 20686     ELSE IF DFHEIGDJ EQUAL 16
 20687         GO TO 8190-NOTFND
 20688         DEPENDING ON DFHEIGDI
 20689     ELSE IF DFHEIGDJ EQUAL 17
 20690         GO TO 8200-NOTFND
 20691         DEPENDING ON DFHEIGDI
 20692     ELSE IF DFHEIGDJ EQUAL 18
 20693         GO TO 8300-NOTFND,
 20694               8300-ERRESS-PROBLEM,
 20695               8300-ERRESS-PROBLEM,
 20696               8300-NOTFND
 20697         DEPENDING ON DFHEIGDI
 20698     ELSE IF DFHEIGDJ EQUAL 19
 20699         GO TO 8450-FORM-NOT-FOUND,
 20700               8450-FORM-NOT-FOUND
 20701         DEPENDING ON DFHEIGDI
 20702     ELSE IF DFHEIGDJ EQUAL 20
 20703         GO TO 0199-ACCT-NOT-FOUND,
 20704               0199-ACCT-NOT-FOUND
 20705         DEPENDING ON DFHEIGDI
 20706     ELSE IF DFHEIGDJ EQUAL 21
 20707         GO TO 0199-ACCT-NOT-FOUND,
 20708               0199-ACCT-NOT-FOUND
 20709         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 31-Aug-11 16:55 Page 383
* EL050.cbl
 20710     ELSE IF DFHEIGDJ EQUAL 22
 20711         GO TO 8582-COMP-NOT-FOUND,
 20712               8582-COMP-NOT-FOUND
 20713         DEPENDING ON DFHEIGDI
 20714     ELSE IF DFHEIGDJ EQUAL 23
 20715         GO TO 8583-AGTC-NOT-FOUND,
 20716               8583-AGTC-NOT-FOUND
 20717         DEPENDING ON DFHEIGDI
 20718     ELSE IF DFHEIGDJ EQUAL 24
 20719         GO TO 8584-BXRF-NOT-FOUND,
 20720               8584-BXRF-NOT-FOUND
 20721         DEPENDING ON DFHEIGDI
 20722     ELSE IF DFHEIGDJ EQUAL 25
 20723         GO TO 8585-PLAN-NOT-FOUND,
 20724               8585-PLAN-NOT-FOUND
 20725         DEPENDING ON DFHEIGDI
 20726     ELSE IF DFHEIGDJ EQUAL 26
 20727         GO TO 0299-CERT-NOT-FOUND
 20728         DEPENDING ON DFHEIGDI
 20729     ELSE IF DFHEIGDJ EQUAL 27
 20730         GO TO 8700-READ-CERT-MASTER
 20731         DEPENDING ON DFHEIGDI
 20732     ELSE IF DFHEIGDJ EQUAL 28
 20733         GO TO 8720-COMP-ACCOUNTS,
 20734               8730-END-BROWSE,
 20735               8740-NOT-FOUND
 20736         DEPENDING ON DFHEIGDI
 20737     ELSE IF DFHEIGDJ EQUAL 29
 20738         GO TO 9000-NOTFND
 20739         DEPENDING ON DFHEIGDI
 20740     ELSE IF DFHEIGDJ EQUAL 30
 20741         GO TO 9100-NOTFND,
 20742               9100-NOTFND
 20743         DEPENDING ON DFHEIGDI.
 20744     MOVE '9%                    "   ' TO DFHEIV0
 20745     MOVE 'EL050' TO DFHEIV1
 20746     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20747     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       39412     Code:       83617
