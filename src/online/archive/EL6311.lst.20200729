* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
    79* 022017  IR2017022000002  PEMA  PREVENT DEL OF ISS W/CHECK
    80* 101016  CR2015082500001  PEMA  ADD COMPANY VPP
    81* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    82* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    83* 052918  CR2018040600002  PEMA  ADD REFUND DIRECT INDICATOR
    84* 021519  CR2019021100001  PEMA  non-monthly al calcs
    85* 012220  CR2018092700002  TANA  Add letter reqd field
    86* 012820  CR2020012800001  PEMA  Addd minimum term edit for extd t
    87* 031620  CR2019092700001  PEMA  Remove post card indicator
    88* 041320  CR2020040200001  PEMA  PENDING BUSINESS JOURNALING
    89* 052020  CR2019111300001  PEMA  Include all files in "K" trans
    90******************************************************************
    91
    92 ENVIRONMENT DIVISION.
    93
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   4
* EL6311.cbl
    95 DATA DIVISION.
    96 WORKING-STORAGE SECTION.
    97 01  DFH-START PIC X(04).
    98 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    99 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
   100 77  FILLER  PIC X(32)  VALUE '********************************'.
   101 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
   102 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
   103 77  A1                          PIC S999 COMP-3 VALUE +0.
   104 77  N1                          PIC S999 COMP-3 VALUE +0.
   105 77  N2                          PIC S999 COMP-3 VALUE +0.
   106 77  N3                          PIC S999 COMP-3 VALUE +0.
   107 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
   108 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
   109 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   110     88  REVERSAL                    VALUE 'Y'.
   111 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   112 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   113 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   114 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   115 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   116     88  ERMAIL-FOUND                 VALUE 'Y'.
   117 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   118 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   119 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   120 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   121     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   122 77  ws-stop-sw                  pic x value ' '.
   123     88  i-say-stop                 value 'Y'.
   124 77  ws-check-sw                 pic x value ' '.
   125     88  i-have-checks              value 'Y'.
   126 77  ws-proc-check-sw            pic x value ' '.
   127     88  i-have-processed-checks    value 'Y'.
   128 77  ws-any-check-sw             pic x value ' '.
   129     88  i-have-a-check-period      value 'Y'.
   130 77  ws-chek-browse-sw           pic x value ' '.
   131 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   132 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   133 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   134 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   135 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   136 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   137 77  ws-elcrtt-update-sw         pic x value ' '.
   138     88  update-elcrtt              value 'Y'.
   139 01  P pointer.
   140 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   141 01  var-ptr pointer.
   142 01  env-var-len                 pic 9(4)  binary.
   143 01  rc                          pic 9(9)  binary.
   144 01  WS-KIXSYS.
   145     05  WS-KIX-FIL1             PIC X(10).
   146     05  WS-KIX-APPS             PIC X(10).
   147     05  WS-KIX-ENV              PIC X(10).
   148     05  WS-KIX-MYENV            PIC X(10).
   149     05  WS-KIX-SYS              PIC X(10).
   150*    COPY ELCSCTM.
   151******************************************************************
   152*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   5
* EL6311.cbl
   153*                                                                *
   154*                            ELCSCTM                             *
   155*                            VMOD=2.001                          *
   156*                                                                *
   157*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   158*                                                                *
   159******************************************************************
   160 01  SECURITY-MESSAGE.
   161     12  FILLER                          PIC X(30)
   162            VALUE '** LOGIC SECURITY VIOLATION -'.
   163     12  SM-READ                         PIC X(6).
   164     12  FILLER                          PIC X(5)
   165            VALUE ' PGM='.
   166     12  SM-PGM                          PIC X(6).
   167     12  FILLER                          PIC X(5)
   168            VALUE ' OPR='.
   169     12  SM-PROCESSOR-ID                 PIC X(4).
   170     12  FILLER                          PIC X(6)
   171            VALUE ' TERM='.
   172     12  SM-TERMID                       PIC X(4).
   173     12  FILLER                          PIC XX   VALUE SPACE.
   174     12  SM-JUL-DATE                     PIC 9(5).
   175     12  FILLER                          PIC X    VALUE SPACE.
   176     12  SM-TIME                         PIC 99.99.
   177
   178
   179*    COPY ELCSCRTY.
   180******************************************************************
   181*                                                                *
   182*                                                                *
   183*                            ELCSCRTY                            *
   184*                            VMOD=2.001                          *
   185*                                                                *
   186*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   187*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   188*        SAVED IN PI-SECURITY-ADDRESS.                           *
   189*                                                                *
   190******************************************************************
   191 01  SECURITY-CONTROL.
   192     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   193     12  FILLER                       PIC XX    VALUE 'SC'.
   194     12  SC-CREDIT-CODES.
   195         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   196             20  SC-CREDIT-DISPLAY    PIC X.
   197             20  SC-CREDIT-UPDATE     PIC X.
   198     12  SC-CLAIMS-CODES.
   199         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   200             20  SC-CLAIMS-DISPLAY    PIC X.
   201             20  SC-CLAIMS-UPDATE     PIC X.
   202
   203 01  WS-VA-NO-COMM-MESS.
   204     12  FILLER                  PIC X(41) VALUE
   205        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   206 01  WS-OC-MESSAGE.
   207     12  FILLER                  PIC X(43) VALUE
   208        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   209     12  WS-OC-DIS-AMT           PIC -----9.99.
   210     12  FILLER                  PIC X(4) VALUE ' ON '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   6
* EL6311.cbl
   211     12  WS-OC-DATE              PIC X(10).
   212 01  WS-DATE-AREA.
   213     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   214     12  WS-CURRENT-DT.
   215         16  FILLER              PIC X(6)    VALUE SPACES.
   216         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   217     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   218     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   219     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   220
   221 01  STANDARD-AREAS.
   222     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   223     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   224     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   225     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   226     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   227     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   228     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   229     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   230     12  PGM-NAME                PIC X(8).
   231     12  TIME-IN                 PIC S9(7).
   232     12  TIME-OUT-R  REDEFINES TIME-IN.
   233         16  FILLER              PIC X.
   234         16  TIME-OUT            PIC 99V99.
   235         16  FILLER              PIC XX.
   236     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   237     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   238     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   239     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   240     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   241     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   242     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   243     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   244     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   245     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   246     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   247     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   248     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   249     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   250     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   251     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   252     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   253     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   254     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   255     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   256     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   257     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   258     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   259     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   260     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   261     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   262     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   263     12  FILE-ID                 PIC X(8).
   264     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   265     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   266     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   267     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   268     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   7
* EL6311.cbl
   269     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   270     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   271     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   272     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   273     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   274     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   275     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   276     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   277     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   278     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   279
   280 01  WS-PASS-AREA.
   281     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   282     05  WS-PASS-VADS-REC    PIC X(350).
   283*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   284*                                COPY ELCZREC.
   285******************************************************************
   286*                                                                *
   287*                                                                *
   288*                            ELCZREC.                            *
   289*                                                                *
   290*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   291*                                                                *
   292******************************************************************
   293*-----------------------------------------------------------------
   294*                   C H A N G E   L O G
   295*
   296* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   297*-----------------------------------------------------------------
   298*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   299* EFFECTIVE    NUMBER
   300*-----------------------------------------------------------------
   301* 122011    2011022800001  AJRA  NEW FILE
   302* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   303* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   304* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   305* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   306*-----------------------------------------------------------------
   307 01  W-Z-CONTROL-DATA.
   308     05  W-NUMBER-OF-COPIES      PIC  9.
   309     05  FILLER                  PIC  X.
   310     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   311     05  FILLER                  PIC  X.
   312     05  W-DAYS-TO-RESEND        PIC  999.
   313     05  FILLER                  PIC  X.
   314     05  W-FORM-TO-RESEND        PIC  X(4).
   315     05  W-ADD-BAR-CODE          PIC  X.
   316     05  W-PROMPT-LETTER         PIC  X.
   317     05  W-HAS-RETURN-ENV        PIC  X.
   318     05  W-ENCLOSURE-CD          PIC  XXX.
   319     05  W-SIG-FLAG-DEFAULT      PIC  X.
   320     05  W-AUTO-CLOSE-IND        PIC  X.
   321     05  FILLER                  PIC  X.
   322     05  W-LETTER-TO-BENE        PIC  X.
   323     05  FILLER                  PIC  X.
   324     05  W-LETTER-TO-ACCT        PIC  X.
   325     05  FILLER                  PIC  X.
   326     05  W-LETTER-TYPE           PIC  X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   8
* EL6311.cbl
   327     05  FILLER                  PIC  X.
   328     05  W-PRINT-CERTIFICATE     PIC  X.
   329     05  FILLER                  PIC  X.
   330     05  W-REFUND-REQUIRED       PIC  X.
   331     05  FILLER                  PIC  X.
   332     05  W-ONBASE-CODE           PIC  XX.
   333     05  FILLER                  PIC  X.
   334     05  W-ACCT-SUMM             PIC  X.
   335     05  FILLER                  PIC  X.
   336     05  W-CSO-SUMM              PIC  X.
   337     05  FILLER                  PIC  X.
   338     05  W-REASONS-REQUIRED      PIC  X.
   339     05  FILLER                  PIC  X(29).
   340******************************************************************
   341*                                                                *
   342*              A C C E S S   K E Y S                             *
   343*                                                                *
   344******************************************************************
   345
   346 01  ACCESS-KEYS.
   347     12  ERPYAJ-KEY.
   348         16  ERPYAJ-COMPANY-CD       PIC X.
   349         16  ERPYAJ-CARRIER          PIC X.
   350         16  ERPYAJ-GROUPING         PIC X(6).
   351         16  ERPYAJ-FIN-RESP         PIC X(10).
   352         16  ERPYAJ-ACCOUNT          PIC X(10).
   353         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   354         16  ERPYAJ-TYPE             PIC X.
   355     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   356     12  ELCERT-KEY.
   357         16  ELCERT-COMPANY-CD       PIC X.
   358         16  ELCERT-CARRIER          PIC X.
   359         16  ELCERT-GROUPING         PIC X(6).
   360         16  ELCERT-STATE            PIC XX.
   361         16  ELCERT-ACCOUNT          PIC X(10).
   362         16  ELCERT-CERT-EFF-DT      PIC XX.
   363         16  ELCERT-CERT-NO.
   364             20  ELCERT-CERT-PRIME   PIC X(10).
   365             20  ELCERT-CERT-SFX     PIC X.
   366
   367     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   368     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   369     12  ELCRTO-KEY.
   370         16  ELCRTO-COMPANY-CD       PIC X.
   371         16  ELCRTO-CARRIER          PIC X.
   372         16  ELCRTO-GROUPING         PIC X(6).
   373         16  ELCRTO-STATE            PIC XX.
   374         16  ELCRTO-ACCOUNT          PIC X(10).
   375         16  ELCRTO-CERT-EFF-DT      PIC XX.
   376         16  ELCRTO-CERT-NO.
   377             20  ELCRTO-CERT-PRIME   PIC X(10).
   378             20  ELCRTO-CERT-SFX     PIC X.
   379         16  ELCRTO-RECORD-TYPE      PIC X.
   380         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   381
   382     12  ELCRTT-KEY.
   383         16  ELCRTT-PRIMARY          PIC X(33).
   384         16  ELCRTT-REC-TYPE         PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   9
* EL6311.cbl
   385     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   386     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   387
   388     12  ERPNDB-KEY.
   389         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   390         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   391         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   392         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   393             ERPNDB-BATCH-SEQ-NO     PIC XX.
   394         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   395
   396     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   397     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   398     12  ERCHEK-KEY.
   399         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   400         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   401         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   402         16  CHEK-STATE              PIC XX      VALUE SPACES.
   403         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   404         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   405         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   406         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   407         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   408     12  ELLETR-KEY.
   409         16  LETR-COMPANY-CD     PIC X.
   410         16  LETR-LETTER-ID      PIC X(4).
   411         16  LETR-FILLER         PIC X(8).
   412         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   413     12  ERPNDM-KEY.
   414         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   415         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   416         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   417         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   418
   419*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   420     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   421*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   422     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   423
   424     12  ERPNDB-ALT-KEY.
   425         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   426         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   427         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   428         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   429         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   430         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   431         16  ERPNDB-CERT-NO.
   432             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   433             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   434         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   435         16  ERPNDB-RECORD-TYPE      PIC X.
   436
   437      12  ERPNDB-CSR-KEY.
   438          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   439          20  ERPNDB-CSR-ID                PIC X(4).
   440          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   441          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   442          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  10
* EL6311.cbl
   443
   444     12  ERNOTE-KEY.
   445         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   446         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   447         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   448         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   449         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   450         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   451         16  ERNOTE-CERT-NO.
   452             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   453             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   454
   455     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   456     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   457
   458     12  ERCNOT-KEY.
   459         16  ERCNOT-PART-KEY.
   460             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   461             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   462             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   463             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   464             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   465             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   466             20  ERCNOT-CERT-NO.
   467                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   468                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   469         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   470         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   471
   472     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   473     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   474
   475     12  ERMAIL-KEY.
   476         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   477         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   478         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   479         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   480         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   481         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   482         16  ERMAIL-CERT-NO.
   483             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   484             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   485
   486     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   487     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   488
   489     12  ERRQST-KEY.
   490         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   491         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   492
   493     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   494     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   495
   496     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   497
   498     12  ERLOFC-KEY.
   499         16  ERLOFC-COMPANY-CD          PIC  X.
   500         16  ERLOFC-CARRIER             PIC  X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  11
* EL6311.cbl
   501         16  ERLOFC-GROUPING            PIC  X(6).
   502         16  ERLOFC-STATE               PIC  XX.
   503         16  ERLOFC-ACCOUNT             PIC  X(10).
   504         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   505*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   506
   507     12  ERACCT-KEY.
   508         16  ERACCT-COMPANY-CD          PIC  X.
   509         16  ERACCT-CARRIER             PIC  X.
   510         16  ERACCT-GROUPING            PIC  X(6).
   511         16  ERACCT-STATE               PIC  XX.
   512         16  ERACCT-ACCOUNT             PIC  X(10).
   513         16  ERACCT-EXP-DT.
   514             20  ERACCT-DT              PIC  XX.
   515             20  ERACCT-FILL            PIC  X(4).
   516     12  ERACNT-KEY.
   517         16  ERACNT-COMPANY-CD          PIC  X.
   518         16  ERACNT-CARRIER             PIC  X.
   519         16  ERACNT-GROUPING            PIC  X(6).
   520         16  ERACNT-STATE               PIC  XX.
   521         16  ERACNT-ACCOUNT             PIC  X(10).
   522         16  ERACNT-REC-TYPE            PIC  X.
   523         16  ERACNT-SEQ-NO              PIC  S9(4) COMP.
   524     12  ERENDT-KEY.
   525         16  ENDT-COMPANY-CD       PIC X.
   526         16  ENDT-CARRIER          PIC X.
   527         16  ENDT-GROUPING         PIC X(6).
   528         16  ENDT-STATE            PIC XX.
   529         16  ENDT-ACCOUNT          PIC X(10).
   530         16  ENDT-CERT-EFF-DT      PIC XX.
   531         16  ENDT-CERT-PRIME       PIC X(10).
   532         16  ENDT-CERT-SFX         PIC X.
   533         16  ENDT-RECORD-TYPE      PIC X.
   534         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   535
   536 01  WS-ELMSTR-WORK.
   537     12  ELMSTR-KEY.
   538         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   539         16  MSTR-CERT-NO.
   540             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   541             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   542     12  W-CLAIM-KEY.
   543         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   544         16  W-CL-CERT-NO.
   545             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   546             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   547      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   548 01  EL055-PASS-AREA.
   549     05  PA-CURRENT-KEY          PIC X(11).
   550     05  PA-NEW-ALT-KEY          PIC X(36).
   551     05  PA-RETURN-AREA.
   552         10  ra-status-code      pic 9(4).
   553         10  ra-message          pic x(205).
   554 01  CANCEL-GEN-PASS-AREA.
   555     05  CG-OPTION-CODE          PIC X.
   556         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   557         88  CG-FLAT-CANCEL        VALUE '1'.
   558         88  CG-CANCEL             VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  12
* EL6311.cbl
   559         88  CG-CANCEL-REISSUE     VALUE '3'.
   560     05  CG-ERROR-CODE           PIC 99.
   561         88  CG-SUCCESS            VALUE 00.
   562         88  CG-DATE-ERROR         VALUE 01.
   563         88  CG-CERT-NOT-FOUND     VALUE 02.
   564         88  CG-AMOUNT-ERROR       VALUE 04.
   565         88  CG-OPTION-ERROR       VALUE 05.
   566         88  CG-PREV-CAN           VALUE 06.
   567         88  CG-INVALID-DATA       VALUE 07.
   568         88  CG-NO-ACCT-MSTR       VALUE 08.
   569         88  CG-SFX-A-EXIST        VALUE 09.
   570         88  CG-MISC-ERROR         VALUE 99.
   571     05  CG-COMPANY-ID           PIC XXX.
   572     05  CG-PROC-ID              PIC XXXX.
   573     05  CG-CURRENT-DT           PIC XX.
   574     05  CG-MONTH-END-DT         PIC XX.
   575     05  CG-CERT-KEY.
   576         10  CG-CERT-COMPANY-CD  PIC X.
   577         10  CG-CERT-CARRIER     PIC X.
   578         10  CG-CERT-GROUP       PIC X(6).
   579         10  CG-CERT-STATE       PIC XX.
   580         10  CG-CERT-ACCOUNT     PIC X(10).
   581         10  CG-CERT-EFF-DT      PIC XX.
   582         10  CG-CERT-CERT-NO     PIC X(11).
   583     05  CG-LF-CAN-DATA.
   584         10  CG-LF-CAN-DT        PIC XX.
   585         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   586     05  CG-AH-CAN-DATA.
   587         10  CG-AH-CAN-DT        PIC XX.
   588         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   589     05  CG-CERT-PROFILE-DATA.
   590         10  CG-INS-LNAME        PIC X(15).
   591         10  CG-INS-FNAME        PIC X(10).
   592         10  CG-INS-MID-INIT     PIC X.
   593         10  CG-INS-AGE          PIC 99.
   594         10  CG-JNT-LNAME        PIC X(15).
   595         10  CG-JNT-FNAME        PIC X(10).
   596         10  CG-JNT-MID-INIT     PIC X.
   597         10  CG-JNT-AGE          PIC 99.
   598     05  CG-LF-ISS-DATA.
   599         10  CG-LF-BENCD         PIC XX.
   600         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   601         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   602     05  CG-AH-ISS-DATA.
   603         10  CG-AH-BENCD         PIC XX.
   604         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   605     05  CG-BATCH-NO             PIC X(6).
   606     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   607     05  FILLER                  PIC X(306).
   608******************************************************************
   609*                                                                *
   610*            G E N E R A L   W O R K   A R E A                   *
   611*                                                                *
   612******************************************************************
   613
   614 01  WORK-AREA.
   615     12  WS-RESPONSE             PIC S9(8)   COMP.
   616         88  RESP-NORMAL           VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  13
* EL6311.cbl
   617         88  resp-file-notfnd      value +12.
   618         88  RESP-NOTFND           VALUE +13.
   619         88  resp-duprec           value +14.
   620         88  resp-dupkey           value +15.
   621         88  resp-invreq           value +16.
   622         88  RESP-NOTOPEN          VALUE +19.
   623         88  RESP-ENDFILE          VALUE +20.
   624         88  resp-lengtherr        value +22.
   625     12  DEEDIT-FIELD            PIC X(15).
   626     12  FILLER          REDEFINES DEEDIT-FIELD.
   627         16  FILLER              PIC X(4).
   628         16  DEEDIT-FIELD-X11    PIC X(11).
   629     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   630                                 PIC S9(15).
   631     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   632                                 PIC S9(13)V99.
   633     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   634                                 PIC S9(11)V9999.
   635     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   636     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   637     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   638         16  WS-CALC-TERM-WHOLE  PIC S999.
   639         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   640
   641     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   642     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   643         16  WS-HR-MINS          PIC 99V99.
   644         16  FILLER              PIC XX.
   645
   646     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   647     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   648
   649     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   650     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   651
   652     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   653     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   654     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   655     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   656     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   657     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   658     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   659
   660     12  QID.
   661         16  QID-TERM            PIC X(4).
   662         16  FILLER              PIC X(4)    VALUE '607B'.
   663
   664     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   665         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   666
   667     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   668         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   669
   670     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   671         88 WS-MODE-CODE-VALID     VALUE ' '
   672                                         'W'     *> Weekly
   673                                         'B'     *> Bi-weekly
   674                                         'S'     *> Semi-monthly
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  14
* EL6311.cbl
   675                                         'M'     *> Monthly (Def)
   676                                         'Q'     *> Quarterly
   677                                         'N'     *> Bi-Monthly??
   678                                         'T'     *> Semi-annual
   679                                         'A'.    *> Annual Pay
   680
   681     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   682
   683     12  WS-NUMERIC-SW           PIC X.
   684        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   685
   686     12  WS-EDIT-CSO-FIELD.
   687         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   688                                 PIC X.
   689     12  WS-SAVE-PEND-ISSUE          PIC X(375).
   690     12  WS-ARCHIVE-LETTER-SW    PIC X    VALUE 'N'.
   691        88  ARCHIVE-LETTER-RELEASED   VALUE 'Y'.
   692        88  CALLED-FROM-6315          VALUE '5'.
   693
   694     12  WS-SAVE-INPUT-FIELDS.
   695         16  WS-BAGE             PIC 99       VALUE ZERO.
   696*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   697         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   698         16  FILLER REDEFINES WS-BAPR.
   699             20  WS-APR-WHOLE-NUM    PIC 99.
   700             20  WS-APR-DEC          PIC 9999.
   701         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   702         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   703
   704         16  WS-B-COVERAGE OCCURS 2 TIMES.
   705             20  WS-TERM-IN-DAYS-SW  PIC X.
   706                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   707             20  WS-BTERM        PIC 999       COMP-3.
   708             20  WS-BALT-TERM    PIC 999       COMP-3.
   709             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   710             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   711             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   712             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   713             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   714             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   715
   716         16  WS-C-FIELDS COMP-3.
   717             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   718             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   719             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   720
   721         16  WS-D-FIELDS COMP-3.
   722             20  WS-DRISS        PIC S9(5)    VALUE +0.
   723             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   724             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   725             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   726             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   727             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   728
   729     12  WS-SAVE-BIRTH-DATE.
   730         16  FILLER              PIC X(4)   VALUE SPACES.
   731         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   732
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  15
* EL6311.cbl
   733     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   734     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   735     12  FILLER REDEFINES WS-WORK-BIN-RED.
   736         16  FILLER              PIC X(02).
   737         16  WS-WORK-BIN-DT      PIC X(02).
   738     12  WS-SW-1                 PIC X     VALUE SPACE.
   739     12  WS-SW-2                 PIC X     VALUE SPACE.
   740     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   741         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   742     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   743         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   744
   745     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   746     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   747     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   748     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   749     12  WS-CONVERTED-CANCEL-DATES.
   750         16  WS-CONVERTED-CANDT1                  PIC XX.
   751         16  WS-CONVERTED-CANDT2                  PIC XX.
   752
   753     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   754
   755     12  WS-REC-FOUND-SW         PIC X.
   756         88  RECORD-NOT-FOUND    VALUE 'N'.
   757
   758     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   759         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   760         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   761
   762     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   763         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   764         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   765
   766     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   767         88  BROWSE-STARTED      VALUE 'Y'.
   768
   769     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   770         88  FIRST-TIME          VALUE 'Y'.
   771
   772     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   773         88  FIRST-ENTRY         VALUE 'Y'.
   774
   775     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   776         88  REC-BILLED          VALUE 'Y'.
   777
   778     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   779         88  NO-CURSOR-SET       VALUE +0.
   780         88  CURSOR-SET          VALUE +1.
   781
   782     12  WS-ERR-SW               PIC X.
   783         88  STD-ERRORS          VALUE 'S'.
   784         88  TRN-ERRORS          VALUE 'T'.
   785
   786     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   787         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   788
   789     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   790         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  16
* EL6311.cbl
   791
   792     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   793         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   794
   795     12  WS-ERR-CODE.
   796         16  FILLER              PIC 99.
   797         16  WS-ERROR-SUB        PIC 99.
   798
   799     12  WS-DATE-WORK.
   800         16  WS-WORK-MM          PIC XX.
   801         16  WS-WORK-DD          PIC XX.
   802         16  WS-WORK-YY          PIC XX.
   803
   804     12  WS-MM-YY.
   805         16  WS-MM               PIC XX.
   806         16  FILLER              PIC X     VALUE '/'.
   807         16  WS-YY               PIC XX.
   808
   809     12  WS-CERT-EFF-DT          PIC XX.
   810
   811     12  WS-MEMBER-NO            PIC X(12).
   812     12  FILLER  REDEFINES  WS-MEMBER-NO.
   813         16  WS-MEMBER-NO-1-8    PIC 9(8).
   814         16  FILLER              PIC X(4).
   815
   816     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   817
   818     12  WS-ERPNDB-ALT-KEY.
   819         16  WS-PB-COMPANY-CD-A1         PIC X.
   820         16  WS-PB-CARRIER               PIC X.
   821         16  WS-PB-GROUPING              PIC X(6).
   822         16  WS-PB-STATE                 PIC XX.
   823         16  WS-PB-ACCOUNT               PIC X(10).
   824         16  WS-PB-CERT-EFF-DT           PIC XX.
   825         16  WS-PB-CERT-NO.
   826             20  WS-PB-CERT-PRIME        PIC X(10).
   827             20  WS-PB-CERT-SFX          PIC X.
   828         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   829         16  WS-PB-RECORD-TYPE           PIC X.
   830
   831     12  WS-SHOW-SAVE-AREAS.
   832         16  WS-NEW-CERT-NO.
   833             20  WS-NEW-PRIME    PIC X(10).
   834             20  WS-NEW-SUFFIX   PIC X.
   835         16  WS-NEW-CERT-EFF-DT  PIC XX.
   836         16  WS-NEW-RECORD-TYPE  PIC X.
   837         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   838             88   SHOW-RECORD            VALUE 'Y'.
   839
   840     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   841
   842     12  WS-BATCH-NO.
   843         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   844         16  FILLER              PIC X(5) VALUE SPACES.
   845
   846     12  WS-FIRST-NAME.
   847         16  WS-1ST-INIT         PIC X.
   848         16  FILLER              PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  17
* EL6311.cbl
   849
   850     12  WS-INITIALS.
   851         16  WS-INITIAL-1        PIC X.
   852         16  WS-INITIAL-2        PIC X.
   853
   854     12  WS-C-HDG.
   855         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   856         16  FILLER              PIC X(4) VALUE '-REF'.
   857
   858     12  WS-D-PREM-HDG.
   859         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   860         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   861
   862     12  WS-D-REFUND-HDG.
   863         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   864         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   865
   866     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   867
   868     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   869     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   870     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   871     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   872     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   873     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   874     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   875
   876     12  WS-01-CANCEL-ERR        PIC X(25)
   877         VALUE 'CANCEL DATE ERROR'.
   878     12  WS-02-CANCEL-ERR        PIC X(25)
   879         VALUE 'CERT NOT FOUND'.
   880     12  WS-04-CANCEL-ERR        PIC X(25)
   881         VALUE 'CANCEL AMOUNT ERROR'.
   882     12  WS-05-CANCEL-ERR        PIC X(25)
   883         VALUE 'CANCEL OPTION ERROR'.
   884     12  WS-06-CANCEL-ERR        PIC X(25)
   885         VALUE 'PREVIOUSLY CANCELLED'.
   886     12  WS-07-CANCEL-ERR        PIC X(25)
   887         VALUE 'INVALID DATA'.
   888     12  WS-08-CANCEL-ERR        PIC X(25)
   889         VALUE 'NO ACCOUNT MASTER'.
   890     12  WS-09-CANCEL-ERR        PIC X(25)
   891         VALUE 'SUFFIX ALREADY EXISTS'.
   892     12  WS-99-CANCEL-ERR        PIC X(25)
   893         VALUE 'MISC CANCEL ERROR'.
   894
   895     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   896     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   897
   898     12  WS-AGE-FIELDS.
   899         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   900         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   901         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   902         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   903
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  18
* EL6311.cbl
   905
   906******************************************************************
   907*                                                                *
   908*                 B A T C H   T O T A L S                        *
   909*                                                                *
   910******************************************************************
   911
   912     12  WS-BATCH-RECORD.
   913         16  FILLER                       PIC X(10).
   914         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   915         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   916         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   917         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   918         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   919         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   920         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   921         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   922         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   923         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   924         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   925         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   926         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   927         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   928         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   929         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   930         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   931         16  WS-ACCOUNT-NAME              PIC X(30).
   932         16  FILLER                       PIC X.
   933         16  WS-REFERENCE                 PIC X(12).
   934         16  FILLER                       PIC X(197).
   935
   936     12  WS-BATCH-TOTALS.
   937         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   938         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   939         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   940         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   941         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   942         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   943         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   944         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   945         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   946         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   947         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   948         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   949         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   950         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   951         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   952         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   953         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   954         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   955         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   956
   957     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   958
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  19
* EL6311.cbl
   960
   961******************************************************************
   962*                                                                *
   963*                E R R O R   M E S S A G E S                     *
   964*                                                                *
   965******************************************************************
   966
   967 01  ERROR-MESSAGES.
   968     12  ER-0004                 PIC  9(4) VALUE 0004.
   969     12  ER-0008                 PIC  9(4) VALUE 0008.
   970     12  ER-0023                 PIC  9(4) VALUE 0023.
   971     12  ER-0029                 PIC  9(4) VALUE 0029.
   972     12  ER-0033                 PIC  9(4) VALUE 0033.
   973     12  ER-0070                 PIC  9(4) VALUE 0070.
   974     12  ER-0220                 PIC  9(4) VALUE 0220.
   975     12  er-0229                 pic  9(4) value 0229.
   976     12  ER-0248                 PIC  9(4) VALUE 0248.
   977     12  ER-0280                 PIC  9(4) VALUE 0280.
   978     12  ER-0348                 PIC  9(4) VALUE 0348.
   979     12  ER-0582                 PIC  9(4) VALUE 0582.
   980     12  ER-0877                 PIC  9(4) VALUE 0877.
   981     12  ER-1236                 PIC  9(4) VALUE 1236.
   982     12  ER-1570                 PIC  9(4) VALUE 1570.
   983     12  ER-1575                 PIC  9(4) VALUE 1575.
   984     12  ER-1577                 PIC  9(4) VALUE 1577.
   985     12  ER-1584                 PIC  9(4) VALUE 1584.
   986     12  ER-1585                 PIC  9(4) VALUE 1585.
   987     12  ER-1609                 PIC  9(4) VALUE 1609.
   988     12  er-1762                 pic  9(4) value 1762.
   989     12  ER-1819                 PIC  9(4) VALUE 1819.
   990     12  ER-2077                 PIC  9(4) VALUE 2077.
   991     12  ER-2129                 PIC  9(4) VALUE 2129.
   992     12  ER-2188                 PIC  9(4) VALUE 2188.
   993     12  ER-2192                 PIC  9(4) VALUE 2192.
   994     12  ER-2196                 PIC  9(4) VALUE 2196.
   995     12  ER-2197                 PIC  9(4) VALUE 2197.
   996     12  ER-2198                 PIC  9(4) VALUE 2198.
   997     12  ER-2200                 PIC  9(4) VALUE 2200.
   998     12  ER-2212                 PIC  9(4) VALUE 2212.
   999     12  ER-2218                 PIC  9(4) VALUE 2218.
  1000     12  ER-2220                 PIC  9(4) VALUE 2220.
  1001     12  ER-2222                 PIC  9(4) VALUE 2222.
  1002     12  ER-2223                 PIC  9(4) VALUE 2223.
  1003     12  ER-2224                 PIC  9(4) VALUE 2224.
  1004     12  ER-2225                 PIC  9(4) VALUE 2225.
  1005     12  ER-2226                 PIC  9(4) VALUE 2226.
  1006     12  ER-2227                 PIC  9(4) VALUE 2227.
  1007     12  ER-2228                 PIC  9(4) VALUE 2228.
  1008     12  ER-2240                 PIC  9(4) VALUE 2240.
  1009     12  ER-2241                 PIC  9(4) VALUE 2241.
  1010     12  ER-2242                 PIC  9(4) VALUE 2242.
  1011     12  ER-2243                 PIC  9(4) VALUE 2243.
  1012     12  ER-2244                 PIC  9(4) VALUE 2244.
  1013     12  ER-2245                 PIC  9(4) VALUE 2245.
  1014     12  ER-2246                 PIC  9(4) VALUE 2246.
  1015     12  ER-2247                 PIC  9(4) VALUE 2247.
  1016     12  ER-2251                 PIC  9(4) VALUE 2251.
  1017     12  ER-2252                 PIC  9(4) VALUE 2252.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  20
* EL6311.cbl
  1018     12  ER-2253                 PIC  9(4) VALUE 2253.
  1019     12  ER-2254                 PIC  9(4) VALUE 2254.
  1020     12  ER-2255                 PIC  9(4) VALUE 2255.
  1021     12  ER-2256                 PIC  9(4) VALUE 2256.
  1022     12  ER-2257                 PIC  9(4) VALUE 2257.
  1023     12  ER-2258                 PIC  9(4) VALUE 2258.
  1024     12  ER-2259                 PIC  9(4) VALUE 2259.
  1025     12  ER-2260                 PIC  9(4) VALUE 2260.
  1026     12  ER-2261                 PIC  9(4) VALUE 2261.
  1027     12  ER-2287                 PIC  9(4) VALUE 2287.
  1028     12  ER-2336                 PIC  9(4) VALUE 2336.
  1029     12  ER-2337                 PIC  9(4) VALUE 2337.
  1030     12  ER-2437                 PIC  9(4) VALUE 2437.
  1031     12  ER-2471                 PIC  9(4) VALUE 2471.
  1032     12  ER-2530                 PIC  9(4) VALUE 2530.
  1033     12  ER-2531                 PIC  9(4) VALUE 2531.
  1034     12  ER-2532                 PIC  9(4) VALUE 2532.
  1035     12  ER-2533                 PIC  9(4) VALUE 2533.
  1036     12  ER-2547                 PIC  9(4) VALUE 2547.
  1037     12  ER-2591                 PIC  9(4) VALUE 2591.
  1038     12  ER-2592                 PIC  9(4) VALUE 2592.
  1039     12  ER-2593                 PIC  9(4) VALUE 2593.
  1040     12  ER-2600                 PIC  9(4) VALUE 2600.
  1041     12  ER-2601                 PIC  9(4) VALUE 2601.
  1042     12  ER-2604                 PIC  9(4) VALUE 2604.
  1043     12  ER-2605                 PIC  9(4) VALUE 2605.
  1044     12  ER-2606                 PIC  9(4) VALUE 2606.
  1045     12  ER-2607                 PIC  9(4) VALUE 2607.
  1046     12  ER-2622                 PIC  9(4) VALUE 2622.
  1047     12  ER-2625                 PIC  9(4) VALUE 2625.
  1048     12  ER-2626                 PIC  9(4) VALUE 2626.
  1049     12  ER-2627                 PIC  9(4) VALUE 2627.
  1050     12  ER-2628                 PIC  9(4) VALUE 2628.
  1051     12  ER-2629                 PIC  9(4) VALUE 2629.
  1052     12  ER-2630                 PIC  9(4) VALUE 2630.
  1053     12  ER-2631                 PIC  9(4) VALUE 2631.
  1054     12  ER-2632                 PIC  9(4) VALUE 2632.
  1055     12  ER-2633                 PIC  9(4) VALUE 2633.
  1056     12  ER-2634                 PIC  9(4) VALUE 2634.
  1057     12  ER-2635                 PIC  9(4) VALUE 2635.
  1058     12  ER-2636                 PIC  9(4) VALUE 2636.
  1059     12  ER-2639                 PIC  9(4) VALUE 2639.
  1060     12  ER-2640                 PIC  9(4) VALUE 2640.
  1061     12  ER-2647                 PIC  9(4) VALUE 2647.
  1062     12  ER-2648                 PIC  9(4) VALUE 2648.
  1063     12  ER-2649                 PIC  9(4) VALUE 2649.
  1064     12  ER-2650                 PIC  9(4) VALUE 2650.
  1065     12  ER-2651                 PIC  9(4) VALUE 2651.
  1066     12  ER-2653                 PIC  9(4) VALUE 2653.
  1067     12  ER-2654                 PIC  9(4) VALUE 2654.
  1068     12  ER-2655                 PIC  9(4) VALUE 2655.
  1069     12  ER-2656                 PIC  9(4) VALUE 2656.
  1070     12  ER-2657                 PIC  9(4) VALUE 2657.
  1071     12  ER-2660                 PIC  9(4) VALUE 2660.
  1072     12  ER-2661                 PIC  9(4) VALUE 2661.
  1073     12  ER-2662                 PIC  9(4) VALUE 2662.
  1074     12  ER-2663                 PIC  9(4) VALUE 2663.
  1075     12  ER-2664                 PIC  9(4) VALUE 2664.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  21
* EL6311.cbl
  1076     12  ER-2667                 PIC  9(4) VALUE 2667.
  1077     12  ER-2668                 PIC  9(4) VALUE 2668.
  1078     12  ER-2669                 PIC  9(4) VALUE 2669.
  1079     12  ER-2670                 PIC  9(4) VALUE 2670.
  1080     12  ER-2671                 PIC  9(4) VALUE 2671.
  1081     12  ER-2672                 PIC  9(4) VALUE 2672.
  1082     12  ER-2673                 PIC  9(4) VALUE 2673.
  1083     12  ER-2677                 PIC  9(4) VALUE 2677.
  1084     12  ER-2678                 PIC  9(4) VALUE 2678.
  1085     12  ER-2679                 PIC  9(4) VALUE 2679.
  1086     12  ER-2680                 PIC  9(4) VALUE 2680.
  1087     12  ER-2681                 PIC  9(4) VALUE 2681.
  1088     12  ER-2682                 PIC  9(4) VALUE 2682.
  1089     12  ER-2683                 PIC  9(4) VALUE 2683.
  1090     12  ER-2684                 PIC  9(4) VALUE 2684.
  1091     12  ER-2686                 PIC  9(4) VALUE 2686.
  1092     12  ER-2689                 PIC  9(4) VALUE 2689.
  1093     12  ER-2690                 PIC  9(4) VALUE 2690.
  1094     12  ER-2693                 PIC  9(4) VALUE 2693.
  1095     12  ER-2695                 PIC  9(4) VALUE 2695.
  1096     12  ER-2701                 PIC  9(4) VALUE 2701.
  1097     12  ER-2720                 PIC  9(4) VALUE 2720.
  1098     12  ER-2709                 PIC  9(4) VALUE 2709.
  1099     12  ER-2704                 PIC  9(4) VALUE 2704.
  1100     12  ER-2725                 PIC  9(4) VALUE 2725.
  1101     12  ER-2726                 PIC  9(4) VALUE 2726.
  1102     12  ER-2728                 PIC  9(4) VALUE 2728.
  1103     12  ER-2729                 PIC  9(4) VALUE 2729.
  1104     12  ER-2731                 PIC  9(4) VALUE 2731.
  1105     12  ER-2732                 PIC  9(4) VALUE 2732.
  1106     12  ER-2733                 PIC  9(4) VALUE 2733.
  1107     12  ER-2735                 PIC  9(4) VALUE 2735.
  1108     12  ER-2738                 PIC  9(4) VALUE 2738.
  1109     12  ER-2742                 PIC  9(4) VALUE 2742.
  1110     12  ER-2743                 PIC  9(4) VALUE 2743.
  1111     12  ER-2744                 PIC  9(4) VALUE 2744.
  1112     12  ER-2747                 PIC  9(4) VALUE 2747.
  1113     12  ER-2749                 PIC  9(4) VALUE 2749.
  1114     12  ER-2753                 PIC  9(4) VALUE 2753.
  1115     12  ER-2755                 PIC  9(4) VALUE 2755.
  1116     12  ER-2757                 PIC  9(4) VALUE 2757.
  1117     12  ER-2771                 PIC  9(4) VALUE 2771.
  1118     12  ER-2774                 PIC  9(4) VALUE 2774.
  1119     12  ER-2775                 PIC  9(4) VALUE 2775.
  1120     12  ER-2776                 PIC  9(4) VALUE 2776.
  1121     12  ER-2777                 PIC  9(4) VALUE 2777.
  1122     12  ER-2794                 PIC  9(4) VALUE 2794.
  1123     12  ER-2799                 PIC  9(4) VALUE 2799.
  1124     12  er-2878                 pic  9(4) value 2878.
  1125     12  ER-2900                 PIC  9(4) VALUE 2900.
  1126     12  ER-2902                 PIC  9(4) VALUE 2902.
  1127     12  ER-2945                 PIC  9(4) VALUE 2945.
  1128     12  ER-3000                 PIC  9(4) VALUE 3000.
  1129     12  ER-3006                 PIC  9(4) VALUE 3006.
  1130     12  ER-3054                 PIC  9(4) VALUE 3054.
  1131     12  er-3070                 pic  9(4) value 3070.
  1132     12  ER-3224                 PIC  9(4) VALUE 3224.
  1133     12  ER-3269                 PIC  9(4) VALUE 3269.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  22
* EL6311.cbl
  1134     12  er-3444                 pic  9(4) value 3444.
  1135     12  er-3446                 pic  9(4) value 3446.
  1136     12  er-3447                 pic  9(4) value 3447.
  1137     12  er-3448                 pic  9(4) value 3448.
  1138     12  er-3449                 pic  9(4) value 3449.
  1139     12  ER-3456                 PIC  9(4) VALUE 3456.
  1140     12  ER-3457                 PIC  9(4) VALUE 3457.
  1141     12  ER-3458                 PIC  9(4) VALUE 3458.
  1142     12  ER-3504                 PIC  9(4) VALUE 3504.
  1143     12  ER-3513                 PIC  9(4) VALUE 3513.
  1144     12  ER-3831                 PIC  9(4) VALUE 3831.
  1145     12  ER-3834                 PIC  9(4) VALUE 3834.
  1146     12  ER-3835                 PIC  9(4) VALUE 3835.
  1147     12  ER-4005                 PIC  9(4) VALUE 4005.
  1148     12  ER-7144                 PIC  9(4) VALUE 7144.
  1149     12  ER-7401                 PIC  9(4) VALUE 7401.
  1150     12  ER-7402                 PIC  9(4) VALUE 7402.
  1151     12  ER-7403                 PIC  9(4) VALUE 7403.
  1152     12  ER-7404                 PIC  9(4) VALUE 7404.
  1153     12  ER-7423                 PIC  9(4) VALUE 7423.
  1154     12  ER-7424                 PIC  9(4) VALUE 7424.
  1155     12  ER-7433                 PIC  9(4) VALUE 7433.
  1156     12  ER-7450                 PIC  9(4) VALUE 7450.
  1157     12  ER-7451                 PIC  9(4) VALUE 7451.
  1158     12  ER-7530                 PIC  9(4) VALUE 7530.
  1159     12  ER-7573                 PIC  9(4) VALUE 7573.
  1160     12  ER-7631                 PIC  9(4) VALUE 7631.
  1161     12  ER-7632                 PIC  9(4) VALUE 7632.
  1162     12  ER-7633                 PIC  9(4) VALUE 7633.
  1163     12  ER-7537                 PIC  9(4) VALUE 7537.
  1164     12  ER-7538                 PIC  9(4) VALUE 7538.
  1165     12  ER-7574                 PIC  9(4) VALUE 7574.
  1166     12  ER-7997                 PIC  9(4) VALUE 7997.
  1167     12  ER-7998                 PIC  9(4) VALUE 7998.
  1168     12  ER-8148                 PIC  9(4) VALUE 8148.
  1169     12  ER-9063                 PIC  9(4) VALUE 9063.
  1170     12  ER-9076                 PIC  9(4) VALUE 9076.
  1171     12  ER-9618                 PIC  9(4) VALUE 9618.
  1172     12  ER-9841                 PIC  9(4) VALUE 9841.
  1173     12  er-9853                 pic  9(4) value 9853.
  1174
  1175*                                COPY ELCTEXT.
  1176******************************************************************
  1177*                                                                *
  1178*                                                                *
  1179*                            ELCTEXT.                            *
  1180*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1181*                            VMOD=2.008                          *
  1182*                                                                *
  1183*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1184*                                     FORM LETTERS,              *
  1185*                                     CERT FORM DISPLAY.
  1186*                                                                *
  1187*   FILE TYPE = VSAM,KSDS                                        *
  1188*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1189*                                                                *
  1190*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1191*       ALTERNATE INDEX = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  23
* EL6311.cbl
  1192*                                                                *
  1193*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1194*       ALTERNATE INDEX = NONE                                   *
  1195*                                                                *
  1196*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1197*       ALTERNATE INDEX = NONE                                   *
  1198*                                                                *
  1199*   LOG = NO                                                     *
  1200*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1201******************************************************************
  1202 01  TEXT-FILES.
  1203     12  TEXT-FILE-ID                PIC XX.
  1204         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1205         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1206         88  HELP-FILE-TEXT             VALUE 'TH'.
  1207
  1208     12  TX-CONTROL-PRIMARY.
  1209         16  TX-COMPANY-CD           PIC X.
  1210             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1211         16  TX-ACCESS-CD-GENL       PIC X(12).
  1212
  1213         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1214             20  TX-LETTER-NO        PIC X(4).
  1215             20  FILLER              PIC X(8).
  1216
  1217         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1218             20  TX-FORM-NO          PIC X(12).
  1219
  1220         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1221             20  TX-HELP-TYPE        PIC X.
  1222                 88  HELP-FOR-GENERAL   VALUE ' '.
  1223                 88  HELP-BY-SCREEN     VALUE 'S'.
  1224                 88  HELP-BY-ERROR      VALUE 'E'.
  1225             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1226                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1227             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1228                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1229             20  FILLER              PIC X(4).
  1230
  1231         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1232
  1233     12  TX-PROCESS-CONTROL          PIC XX.
  1234         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1235
  1236     12  TX-TEXT-LINE                PIC X(70).
  1237
  1238     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1239         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1240         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1241         88  TX-VALID-FORM-SQUEEZE-VALUE
  1242                                        VALUE 'Y' ' '.
  1243
  1244     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1245         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1246         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1247         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1248         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1249         88  TX-NEW-PARAGRAPH           VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  24
* EL6311.cbl
  1250         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1251         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1252                                              'K' 'N' ' '
  1253                                              'Z'.
  1254
  1255     12  TX-ARCHIVE-SW               PIC X.
  1256         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1257         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1258         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1259
  1260     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1261     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1262
  1263     12  TX-BSR-CODE                 PIC X.
  1264         88  TX-BSR-LETTER              VALUE 'B'.
  1265         88  TX-NON-BSR-LETTER          VALUE ' '.
  1266
  1267     12  FILLER                      PIC X.
  1268*****************************************************************
  1269*                                COPY ELCCRTO.
  1270******************************************************************
  1271*                                                                *
  1272*                            ELCCRTO.                            *
  1273*                                                                *
  1274*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1275*                                                                *
  1276*   FILE TYPE = VSAM,KSDS                                        *
  1277*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1278*                                                                *
  1279*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1280*                                                                *
  1281*   LOG = YES                                                    *
  1282*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1283******************************************************************
  1284*                   C H A N G E   L O G
  1285*
  1286* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1287*-----------------------------------------------------------------
  1288*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1289* EFFECTIVE    NUMBER
  1290*-----------------------------------------------------------------
  1291* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1292* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1293* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1294* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1295* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1296******************************************************************
  1297 01  ORIGINAL-CERTIFICATE.
  1298     12  OC-RECORD-ID                      PIC XX.
  1299         88  VALID-OC-ID                      VALUE 'OC'.
  1300     12  OC-CONTROL-PRIMARY.
  1301         16  OC-COMPANY-CD                 PIC X.
  1302         16  OC-CARRIER                    PIC X.
  1303         16  OC-GROUPING                   PIC X(6).
  1304         16  OC-STATE                      PIC XX.
  1305         16  OC-ACCOUNT                    PIC X(10).
  1306         16  OC-CERT-EFF-DT                PIC XX.
  1307         16  OC-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  25
* EL6311.cbl
  1308             20  OC-CERT-PRIME             PIC X(10).
  1309             20  OC-CERT-SFX               PIC X.
  1310         16  OC-RECORD-TYPE                PIC X.
  1311         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1312     12  OC-LAST-MAINT-DT                  PIC XX.
  1313     12  OC-LAST-MAINT-BY                  PIC X(4).
  1314     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1315     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1316     12  FILLER                            PIC X(49).
  1317     12  OC-ORIG-REC.
  1318         16  OC-INS-LAST-NAME              PIC X(15).
  1319         16  OC-INS-FIRST-NAME             PIC X(10).
  1320         16  OC-INS-MIDDLE-INIT            PIC X.
  1321         16  OC-INS-AGE                    PIC S999     COMP-3.
  1322         16  OC-JNT-LAST-NAME              PIC X(15).
  1323         16  OC-JNT-FIRST-NAME             PIC X(10).
  1324         16  OC-JNT-MIDDLE-INIT            PIC X.
  1325         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1326         16  OC-LF-BENCD                   PIC XX.
  1327         16  OC-LF-TERM                    PIC S999      COMP-3.
  1328         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1329         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1330         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1331         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1332         16  OC-LF-EXP-DT                  PIC XX.
  1333         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1334         16  OC-LF-CANCEL-DT               PIC XX.
  1335         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1336         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1337         16  OC-AH-BENCD                   PIC XX.
  1338         16  OC-AH-TERM                    PIC S999      COMP-3.
  1339         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1340         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1341         16  OC-AH-EXP-DT                  PIC XX.
  1342         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1343         16  OC-AH-CP                      PIC 99.
  1344         16  OC-AH-CANCEL-DT               PIC XX.
  1345         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1346         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1347         16  OC-CRED-BENE-NAME             PIC X(25).
  1348         16  OC-1ST-PMT-DT                 PIC XX.
  1349         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1350         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1351         16  OC-ISSUE-TRAN-IND             PIC X.
  1352         16  OC-CANCEL-TRAN-IND            PIC X.
  1353         16  FILLER                        PIC X(211).
  1354
  1355     12  FILLER                            PIC X(50).
  1356******************************************************************
  1357*                                COPY ERCACCT.
  1358******************************************************************
  1359*                                                                *
  1360*                                                                *
  1361*                            ERCACCT                             *
  1362*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1363*                            VMOD=2.031                          *
  1364*                                                                *
  1365*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  26
* EL6311.cbl
  1366*                                                                *
  1367*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1368*   VSAM ACCOUNT MASTER FILES.                                   *
  1369*                                                                *
  1370*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1371*                                                                *
  1372*   FILE TYPE = VSAM,KSDS                                        *
  1373*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1374*                                                                *
  1375*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1376*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1377*                                                                *
  1378*   LOG = NO                                                     *
  1379*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1380*                                                                *
  1381*                                                                *
  1382******************************************************************
  1383*                   C H A N G E   L O G
  1384*
  1385* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1386*-----------------------------------------------------------------
  1387*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1388* EFFECTIVE    NUMBER
  1389*-----------------------------------------------------------------
  1390* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1391* 092705    2005050300006  PEMA  ADD SPP LEASES
  1392* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1393* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1394* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1395* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1396* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1397* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1398******************************************************************
  1399
  1400 01  ACCOUNT-MASTER.
  1401     12  AM-RECORD-ID                      PIC XX.
  1402         88  VALID-AM-ID                      VALUE 'AM'.
  1403
  1404     12  AM-CONTROL-PRIMARY.
  1405         16  AM-COMPANY-CD                 PIC X.
  1406         16  AM-MSTR-CNTRL.
  1407             20  AM-CONTROL-A.
  1408                 24  AM-CARRIER            PIC X.
  1409                 24  AM-GROUPING.
  1410                     28 AM-GROUPING-PREFIX PIC XXX.
  1411                     28 AM-GROUPING-PRIME  PIC XXX.
  1412                 24  AM-STATE              PIC XX.
  1413                 24  AM-ACCOUNT.
  1414                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1415                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1416             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1417                                           PIC X(19).
  1418             20  AM-CNTRL-B.
  1419                 24  AM-EXPIRATION-DT      PIC XX.
  1420                 24  FILLER                PIC X(4).
  1421             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1422                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1423
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  27
* EL6311.cbl
  1424     12  AM-CONTROL-BY-VAR-GRP.
  1425         16  AM-COMPANY-CD-A1              PIC X.
  1426         16  AM-VG-CARRIER                 PIC X.
  1427         16  AM-VG-GROUPING                PIC X(6).
  1428         16  AM-VG-STATE                   PIC XX.
  1429         16  AM-VG-ACCOUNT                 PIC X(10).
  1430         16  AM-VG-DATE.
  1431             20  AM-VG-EXPIRATION-DT       PIC XX.
  1432             20  FILLER                    PIC X(4).
  1433         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1434                                           PIC 9(11)      COMP-3.
  1435     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1436         16  FILLER                        PIC X(10).
  1437         16  AM-VG-KEY3.
  1438             20  AM-VG3-ACCOUNT            PIC X(10).
  1439             20  AM-VG3-EXP-DT             PIC XX.
  1440         16  FILLER                        PIC X(4).
  1441     12  AM-MAINT-INFORMATION.
  1442         16  AM-LAST-MAINT-DT              PIC XX.
  1443         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1444         16  AM-LAST-MAINT-USER            PIC X(4).
  1445         16  FILLER                        PIC XX.
  1446
  1447     12  AM-EFFECTIVE-DT                   PIC XX.
  1448     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1449
  1450     12  AM-PREV-DATES  COMP-3.
  1451         16  AM-PREV-EXP-DT                PIC 9(11).
  1452         16  AM-PREV-EFF-DT                PIC 9(11).
  1453
  1454     12  AM-REPORT-CODE-1                  PIC X(10).
  1455     12  AM-REPORT-CODE-2                  PIC X(10).
  1456
  1457     12  AM-CITY-CODE                      PIC X(4).
  1458     12  AM-COUNTY-PARISH                  PIC X(6).
  1459
  1460     12  AM-NAME                           PIC X(30).
  1461     12  AM-PERSON                         PIC X(30).
  1462     12  AM-ADDRS                          PIC X(30).
  1463     12  AM-CITY.
  1464         16  AM-ADDR-CITY                  PIC X(28).
  1465         16  AM-ADDR-STATE                 PIC XX.
  1466     12  AM-ZIP.
  1467         16  AM-ZIP-PRIME.
  1468             20  AM-ZIP-PRI-1ST            PIC X.
  1469                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1470             20  FILLER                    PIC X(4).
  1471         16  AM-ZIP-PLUS4                  PIC X(4).
  1472     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1473         16  AM-CAN-POSTAL-1               PIC XXX.
  1474         16  AM-CAN-POSTAL-2               PIC XXX.
  1475         16  FILLER                        PIC XXX.
  1476     12  AM-TEL-NO.
  1477         16  AM-AREA-CODE                  PIC 999.
  1478         16  AM-TEL-PRE                    PIC 999.
  1479         16  AM-TEL-NBR                    PIC 9(4).
  1480     12  AM-TEL-LOC                        PIC X.
  1481         88  AM-TEL-AT-HOME                   VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  28
* EL6311.cbl
  1482         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1483
  1484     12  AM-COMM-STRUCTURE.
  1485         16  AM-DEFN-1.
  1486             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1487                 24  AM-AGT.
  1488                     28  AM-AGT-PREFIX     PIC X(4).
  1489                     28  AM-AGT-PRIME      PIC X(6).
  1490                 24  AM-COM-TYP            PIC X.
  1491                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1492                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1493                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1494                 24  AM-RECALC-LV-INDIC    PIC X.
  1495                 24  AM-RETRO-LV-INDIC     PIC X.
  1496                 24  AM-GL-CODES           PIC X.
  1497                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1498                 24  FILLER                PIC X(01).
  1499         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1500             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1501                 24  FILLER                PIC X(11).
  1502                 24  AM-L-COMA             PIC XXX.
  1503                 24  AM-J-COMA             PIC XXX.
  1504                 24  AM-A-COMA             PIC XXX.
  1505                 24  FILLER                PIC X(6).
  1506
  1507     12  AM-COMM-CHANGE-STATUS             PIC X.
  1508         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1509
  1510     12  AM-CSR-CODE                       PIC X(4).
  1511
  1512     12  AM-BILLING-STATUS                 PIC X.
  1513         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1514         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1515     12  AM-AUTO-REFUND-SW                 PIC X.
  1516         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1517         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1518     12  AM-GPCD                           PIC 99.
  1519     12  AM-IG                             PIC X.
  1520         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1521         88  AM-HAS-GROUP                     VALUE '2'.
  1522     12  AM-STATUS                         PIC X.
  1523         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1524         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1525         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1526         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1527         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1528         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1529         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1530         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1531         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1532         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1533     12  AM-REMIT-TO                       PIC 99.
  1534     12  AM-ID-NO                          PIC X(11).
  1535
  1536     12  AM-CAL-TABLE                      PIC XX.
  1537     12  AM-LF-DEVIATION                   PIC XXX.
  1538     12  AM-AH-DEVIATION                   PIC XXX.
  1539     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  29
* EL6311.cbl
  1540     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1541     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1542     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1543     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1544     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1545
  1546     12  AM-USER-FIELDS.
  1547         16  AM-FLD-1                      PIC XX.
  1548         16  AM-FLD-2                      PIC XX.
  1549         16  AM-FLD-3                      PIC XX.
  1550         16  AM-FLD-4                      PIC XX.
  1551         16  AM-FLD-5                      PIC XX.
  1552
  1553     12  AM-1ST-PROD-DATE.
  1554         16  AM-1ST-PROD-YR                PIC XX.
  1555         16  AM-1ST-PROD-MO                PIC XX.
  1556         16  AM-1ST-PROD-DA                PIC XX.
  1557     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1558     12  AM-CERTS-PURGED-DATE.
  1559         16  AM-PUR-YR                     PIC XX.
  1560         16  AM-PUR-MO                     PIC XX.
  1561         16  AM-PUR-DA                     PIC XX.
  1562     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1563     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1564     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1565     12  AM-INACTIVE-DATE.
  1566         16  AM-INA-MO                     PIC 99.
  1567         16  AM-INA-DA                     PIC 99.
  1568         16  AM-INA-YR                     PIC 99.
  1569     12  AM-AR-HI-CERT-DATE                PIC XX.
  1570
  1571     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1572     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1573
  1574     12  AM-OB-PAYMENT-MODE                PIC X.
  1575         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1576         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1577         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1578         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1579
  1580     12  AM-AH-ONLY-INDICATOR              PIC X.
  1581         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1582         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1583
  1584     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1585
  1586     12  AM-OVER-SHORT.
  1587         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1588         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1589
  1590     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1591     12  AM-DCC-CLP-STATE                  PIC XX.
  1592
  1593     12  AM-RECALC-COMM                    PIC X.
  1594     12  AM-RECALC-REIN                    PIC X.
  1595
  1596     12  AM-REI-TABLE                      PIC XXX.
  1597     12  AM-REI-ET-LF                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  30
* EL6311.cbl
  1598     12  AM-REI-ET-AH                      PIC X.
  1599     12  AM-REI-PE-LF                      PIC X.
  1600     12  AM-REI-PE-AH                      PIC X.
  1601     12  AM-REI-PRT-ST                     PIC X.
  1602     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1603     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1604     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1605     12  AM-REI-GROUP-A                    PIC X(6).
  1606     12  AM-REI-MORT                       PIC X(4).
  1607     12  AM-REI-PRT-OW                     PIC X.
  1608     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1609     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1610     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1611     12  AM-REI-GROUP-B                    PIC X(6).
  1612
  1613     12  AM-TRUST-TYPE                     PIC X(2).
  1614
  1615     12  AM-EMPLOYER-STMT-USED             PIC X.
  1616     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1617
  1618     12  AM-STD-AH-TYPE                    PIC XX.
  1619     12  AM-EARN-METHODS.
  1620         16  AM-EARN-METHOD-R              PIC X.
  1621             88 AM-REF-RL-R78                 VALUE 'R'.
  1622             88 AM-REF-RL-PR                  VALUE 'P'.
  1623             88 AM-REF-RL-MEAN                VALUE 'M'.
  1624             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1625         16  AM-EARN-METHOD-L              PIC X.
  1626             88 AM-REF-LL-R78                 VALUE 'R'.
  1627             88 AM-REF-LL-PR                  VALUE 'P'.
  1628             88 AM-REF-LL-MEAN                VALUE 'M'.
  1629             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1630         16  AM-EARN-METHOD-A              PIC X.
  1631             88 AM-REF-AH-R78                 VALUE 'R'.
  1632             88 AM-REF-AH-PR                  VALUE 'P'.
  1633             88 AM-REF-AH-MEAN                VALUE 'M'.
  1634             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1635             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1636             88 AM-REF-AH-NET                 VALUE 'N'.
  1637
  1638     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1639     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1640     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1641
  1642     12  AM-RET-Y-N                        PIC X.
  1643     12  AM-RET-P-E                        PIC X.
  1644     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1645     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1646     12  AM-RET-GRP                        PIC X(6).
  1647     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1648         16  AM-POOL-PRIME                 PIC XXX.
  1649         16  AM-POOL-SUB                   PIC XXX.
  1650     12  AM-RETRO-EARNINGS.
  1651         16  AM-RET-EARN-R                 PIC X.
  1652         16  AM-RET-EARN-L                 PIC X.
  1653         16  AM-RET-EARN-A                 PIC X.
  1654     12  AM-RET-ST-TAX-USE                 PIC X.
  1655         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  31
* EL6311.cbl
  1656         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1657     12  AM-RETRO-BEG-EARNINGS.
  1658         16  AM-RET-BEG-EARN-R             PIC X.
  1659         16  AM-RET-BEG-EARN-L             PIC X.
  1660         16  AM-RET-BEG-EARN-A             PIC X.
  1661     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1662     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1663
  1664     12  AM-USER-SELECT-OPTIONS.
  1665         16  AM-USER-SELECT-1              PIC X(10).
  1666         16  AM-USER-SELECT-2              PIC X(10).
  1667         16  AM-USER-SELECT-3              PIC X(10).
  1668         16  AM-USER-SELECT-4              PIC X(10).
  1669         16  AM-USER-SELECT-5              PIC X(10).
  1670
  1671     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1672
  1673     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1674
  1675     12  AM-RPT045A-SWITCH                 PIC X.
  1676         88  RPT045A-OFF                   VALUE 'N'.
  1677
  1678     12  AM-INSURANCE-LIMITS.
  1679         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1680         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1681
  1682     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1683         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1684
  1685     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1686         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1687         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1688
  1689     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1690
  1691     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1692     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1693     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1694     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1695     12  AM-DCC-UEF-STATE                  PIC XX.
  1696     12  FILLER                            PIC XXX.
  1697     12  AM-REPORT-CODE-3                  PIC X(10).
  1698*    12  FILLER                            PIC X(22).
  1699
  1700     12  AM-RESERVE-DATE.
  1701         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1702         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1703         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1704
  1705     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1706     12  AM-NOTIFICATION-TYPES.
  1707         16  AM-NOTIF-OF-LETTERS           PIC X.
  1708         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1709         16  AM-NOTIF-OF-REPORTS           PIC X.
  1710         16  AM-NOTIF-OF-STATUS            PIC X.
  1711
  1712     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1713         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  32
* EL6311.cbl
  1714         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1715         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1716         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1717
  1718     12  AM-BENEFIT-CONTROLS.
  1719         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1720             20  AM-BENEFIT-CODE           PIC XX.
  1721             20  AM-BENEFIT-TYPE           PIC X.
  1722             20  AM-BENEFIT-REVISION       PIC XXX.
  1723             20  AM-BENEFIT-REM-TERM       PIC X.
  1724             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1725             20  FILLER                    PIC XX.
  1726         16  FILLER                        PIC X(80).
  1727
  1728     12  AM-TRANSFER-DATA.
  1729         16  AM-TRANSFERRED-FROM.
  1730             20  AM-TRNFROM-CARRIER        PIC X.
  1731             20  AM-TRNFROM-GROUPING.
  1732                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1733                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1734             20  AM-TRNFROM-STATE          PIC XX.
  1735             20  AM-TRNFROM-ACCOUNT.
  1736                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1737                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1738             20  AM-TRNFROM-DTE            PIC XX.
  1739         16  AM-TRANSFERRED-TO.
  1740             20  AM-TRNTO-CARRIER          PIC X.
  1741             20  AM-TRNTO-GROUPING.
  1742                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1743                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1744             20  AM-TRNTO-STATE            PIC XX.
  1745             20  AM-TRNTO-ACCOUNT.
  1746                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1747                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1748             20  AM-TRNTO-DTE              PIC XX.
  1749         16  FILLER                        PIC X(10).
  1750
  1751     12  AM-SAVED-REMIT-TO                 PIC 99.
  1752
  1753     12  AM-COMM-STRUCTURE-SAVED.
  1754         16  AM-DEFN-1-SAVED.
  1755             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1756                 24  AM-AGT-SV             PIC X(10).
  1757                 24  AM-COM-TYP-SV         PIC X.
  1758                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1759                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1760                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1761                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1762                 24  FILLER                PIC X.
  1763                 24  AM-GL-CODES-SV        PIC X.
  1764                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1765                 24  FILLER                PIC X.
  1766         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1767             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1768                 24  FILLER                PIC X(11).
  1769                 24  AM-L-COMA-SV          PIC XXX.
  1770                 24  AM-J-COMA-SV          PIC XXX.
  1771                 24  AM-A-COMA-SV          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  33
* EL6311.cbl
  1772                 24  FILLER                PIC X(6).
  1773
  1774     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1775         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1776            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1777            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1778            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1779
  1780     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1781     12  FILLER                            PIC X(120).
  1782
  1783     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1784         16  AM-CONTROL-NAME               PIC X(30).
  1785         16  AM-EXECUTIVE-ONE.
  1786             20  AM-EXEC1-NAME             PIC X(15).
  1787             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1788                                                          COMP-3.
  1789             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1790                                                          COMP-3.
  1791         16  AM-EXECUTIVE-TWO.
  1792             20  AM-EXEC2-NAME             PIC X(15).
  1793             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1794                                                          COMP-3.
  1795             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1796                                                          COMP-3.
  1797
  1798     12  AM-RETRO-ADDITIONAL-DATA.
  1799         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1800         16  AM-RETRO-PREM-P-E             PIC X.
  1801         16  AM-RETRO-CLMS-P-I             PIC X.
  1802         16  AM-RETRO-RET-BRACKET-LF.
  1803             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1804                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1805                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1806             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1807                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1808                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1809             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1810                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1811                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1812         16  AM-RETRO-RET-BRACKET-AH.
  1813             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1814                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1815                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1816                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1817             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1818                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1819                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1820             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1821                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1822                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1823
  1824     12  AM-COMMENTS.
  1825         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1826
  1827     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1828         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1829         16  AM-FLI-BILLING-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  34
* EL6311.cbl
  1830         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1831         16  AM-FLI-UNITED-IDENT           PIC X.
  1832         16  AM-FLI-INTEREST-LOST-DATA.
  1833             20  AM-FLI-BANK-NO            PIC X(5).
  1834             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1835             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1836             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1837         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1838             20  AM-FLI-AGT                PIC X(9).
  1839             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1840             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1841         16  FILLER                        PIC X(102).
  1842
  1843     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1844         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1845             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1846             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1847             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1848             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1849             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1850         16  FILLER                          PIC X(10).
  1851******************************************************************
  1852*                                copy ERCACNT.
  1853******************************************************************
  1854*                                                                *
  1855*                                                                *
  1856*                            ERCACNT.                            *
  1857*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1858*                            VMOD=2.002                          *
  1859*                                                                *
  1860*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1861*                                                                *
  1862*   FILE TYPE = VSAM,KSDS                                        *
  1863*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1864*                                                                *
  1865*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1866*       ALTERNATE INDEX = NONE                                   *
  1867*                                                                *
  1868*                                                                *
  1869*   LOG = YES                                                    *
  1870*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1871******************************************************************
  1872*                   C H A N G E   L O G
  1873*
  1874* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1875*-----------------------------------------------------------------
  1876*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1877* EFFECTIVE    NUMBER
  1878*-----------------------------------------------------------------
  1879* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1880*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1881******************************************************************
  1882 01  NOTE-FILE.
  1883     12  NT-FILE-ID                  PIC XX.
  1884         88  VALID-NOTE-ID              VALUE 'NT'.
  1885
  1886     12  NT-CONTROL-PRIMARY.
  1887         16  NT-COMPANY-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  35
* EL6311.cbl
  1888         16  NT-ACCT-NOTE-KEY.
  1889             18  NT-CARRIER              PIC X.
  1890             18  NT-GROUPING             PIC X(06).
  1891             18  NT-STATE                PIC XX.
  1892             18  NT-ACCOUNT              PIC X(10).
  1893         16  NT-RECORD-TYPE          PIC X.
  1894              88  ACCT-NOTE          VALUE '1'.
  1895              88  ACCT-BRANCH-LOC    VALUE '2'.
  1896              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1897         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1898
  1899     12  NT-LAST-MAINT-DT            PIC XX.
  1900     12  NT-LAST-MAINT-BY            PIC X(4).
  1901     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1902
  1903*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1904*     SEQUENCE NUMBERS
  1905     12  NT-NOTE-INFORMATION.
  1906         16  NT-NOTE-LINE            PIC X(60).
  1907         16  FILLER                  PIC X(25).
  1908*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1909     12  NT-LOCATION-INFORMATION REDEFINES
  1910                         NT-NOTE-INFORMATION.
  1911         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1912         16  FILLER                  PIC X(25).
  1913* Account special indicator is record type '2', sequence 3
  1914     12  filler REDEFINES NT-NOTE-INFORMATION.
  1915         16  nt-account-special      PIC X.
  1916         16  FILLER                  PIC X(84).
  1917*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1918*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1919*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1920*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1921*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1922*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1923*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1924     12  NT-SHIPPING-INFORMATION REDEFINES
  1925                         NT-NOTE-INFORMATION.
  1926         16  NT-SHIPPING-LINE        PIC X(60).
  1927         16  NT-SHIP-STATE           PIC XX.
  1928         16  NT-SHIP-ZIP             PIC X(10).
  1929         16  FILLER                  PIC X(13).
  1930*****************************************************************
  1931*                                COPY ELCVADS.
  1932******************************************************************
  1933*                                                                *
  1934*                                                                *
  1935*                            ELCVADS.                            *
  1936*                                                                *
  1937*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1938*   ELVADS                  LENGTH = 350                         *
  1939******************************************************************
  1940******************************************************************
  1941*                   C H A N G E   L O G
  1942*
  1943* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1944*-----------------------------------------------------------------
  1945*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  36
* EL6311.cbl
  1946* EFFECTIVE    NUMBER
  1947*-----------------------------------------------------------------
  1948* 100111    2011022800001  AJRA  NAPERSOFT
  1949******************************************************************
  1950
  1951 01  VIRGINIA-DISCLOSURE.
  1952     12  VD-COMPANY-CD              PIC X.
  1953     12  VD-CARRIER                 PIC X.
  1954     12  VD-GROUPING.
  1955         20  VD-GROUPING-PREFIX     PIC XXX.
  1956         20  VD-GROUPING-PRIME      PIC XXX.
  1957     12  VD-STATE                   PIC XX.
  1958     12  VD-ACCOUNT.
  1959         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1960         20  VD-ACCOUNT-PRIME       PIC X(6).
  1961     12  VD-CERT-EFF-DT             PIC XX.
  1962     12  VD-CERT-NO.
  1963         20  VD-CERT-PRIME          PIC X(10).
  1964         20  VD-CERT-SFX            PIC X.
  1965     12  VD-ENTRY-BATCH             PIC X(6).
  1966     12  VD-CSR-ID                  PIC X(4).
  1967     12  VD-NAME.
  1968         20  VD-INSURED-LAST-NAME   PIC X(15).
  1969         20  VD-INSURED-FIRST-NAME.
  1970             24  VD-INSURED-1ST-INIT PIC X.
  1971             24  FILLER             PIC X(9).
  1972         20  VD-INSURED-MIDDLE-INIT PIC X.
  1973     12  VD-JOINT-INSURED.
  1974         20 VD-JOINT-LAST-NAME      PIC X(15).
  1975         20 VD-JOINT-FIRST-NAME.
  1976            24  VD-JOINT-FIRST-INIT PIC X.
  1977            24  FILLER              PIC X(9).
  1978         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1979     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1980     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1981     12  VD-INSURED-CITY-STATE.
  1982         20  VD-INSURED-CITY        PIC X(28).
  1983         20  VD-INSURED-STATE       PIC XX.
  1984     12  VD-INSURED-ZIP-CODE.
  1985         20  VD-INSURED-ZIP-PRIME.
  1986             24  VD-INSURED-ZIP-1   PIC X.
  1987                 88  VD-CANADIAN-POST-CODE
  1988                                       VALUE 'A' THRU 'Z'.
  1989             24  FILLER             PIC X(4).
  1990         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1991     12  VD-BENEFICIARY-NAME        PIC X(30).
  1992     12  VD-ACCOUNT-NAME            PIC X(30).
  1993     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1994     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1995     12  VD-1ST-PMT-DT              PIC XX.
  1996     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1997         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1998         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1999                                             '90' THRU '99'.
  2000     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  2001                                    PIC XX.
  2002     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2003     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  37
* EL6311.cbl
  2004     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  2005     12  VD-LF-TERM                 PIC S999   COMP-3.
  2006     12  VD-AH-BENEFIT-CD           PIC XX.
  2007         88  VD-VALID-AH               VALUE '01' THRU '89'.
  2008         88  VD-INVALID-AH             VALUE '  ' '00'
  2009                                             '90' THRU '99'.
  2010     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2011     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2012     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  2013     12  VD-AH-TERM                 PIC S999   COMP-3.
  2014     12  VD-LETTER-ID               PIC X(4).
  2015     12  VD-PROC-ID                 PIC X(4).
  2016     12  VD-COMP-ID                 PIC X(3).
  2017     12  VD-CURRENT-DATE            PIC XX.
  2018     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  2019     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  2020     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  38
* EL6311.cbl
  2022*    COPY ELCDATE.
  2023******************************************************************
  2024*                                                                *
  2025*                                                                *
  2026*                            ELCDATE.                            *
  2027*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2028*                            VMOD=2.003
  2029*                                                                *
  2030*                                                                *
  2031*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2032*                 LENGTH = 200                                   *
  2033******************************************************************
  2034
  2035 01  DATE-CONVERSION-DATA.
  2036     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2037     12  DC-OPTION-CODE                PIC X.
  2038         88  BIN-TO-GREG                VALUE ' '.
  2039         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2040         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2041         88  YMD-GREG-TO-BIN            VALUE '3'.
  2042         88  MDY-GREG-TO-BIN            VALUE '4'.
  2043         88  JULIAN-TO-BIN              VALUE '5'.
  2044         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2045         88  FIND-CENTURY               VALUE '7'.
  2046         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2047         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2048         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2049         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2050         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2051         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2052         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2053         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2054         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2055         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2056         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2057         88  BIN-3-TO-GREG              VALUE 'I'.
  2058         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2059         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2060         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2061         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2062         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2063         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2064         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2065         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2066         88  THREE-CHARACTER-BIN
  2067                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2068         88  GREGORIAN-TO-BIN
  2069                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2070         88  BIN-TO-GREGORIAN
  2071                  VALUES ' ' '1' 'I' '8' 'G'.
  2072         88  JULIAN-TO-BINARY
  2073                  VALUES '5' 'C' 'E' 'F'.
  2074     12  DC-ERROR-CODE                 PIC X.
  2075         88  NO-CONVERSION-ERROR        VALUE ' '.
  2076         88  DATE-CONVERSION-ERROR
  2077                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2078         88  DATE-IS-ZERO               VALUE '1'.
  2079         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  39
* EL6311.cbl
  2080         88  DATE-IS-INVALID            VALUE '3'.
  2081         88  DATE1-GREATER-DATE2        VALUE '4'.
  2082         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2083         88  DATE-INVALID-OPTION        VALUE '9'.
  2084         88  INVALID-CENTURY            VALUE 'A'.
  2085         88  ONLY-CENTURY               VALUE 'B'.
  2086         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2087         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2088     12  DC-END-OF-MONTH               PIC X.
  2089         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2090     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2091         88  USE-NORMAL-PROCESS         VALUE ' '.
  2092         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2093         88  ADJUST-UP-100-YRS          VALUE '2'.
  2094     12  FILLER                        PIC X.
  2095     12  DC-CONVERSION-DATES.
  2096         16  DC-BIN-DATE-1             PIC XX.
  2097         16  DC-BIN-DATE-2             PIC XX.
  2098         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2099         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2100                       DC-GREG-DATE-1-EDIT.
  2101             20  DC-EDIT1-MONTH        PIC 99.
  2102             20  SLASH1-1              PIC X.
  2103             20  DC-EDIT1-DAY          PIC 99.
  2104             20  SLASH1-2              PIC X.
  2105             20  DC-EDIT1-YEAR         PIC 99.
  2106         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2107         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2108                     DC-GREG-DATE-2-EDIT.
  2109             20  DC-EDIT2-MONTH        PIC 99.
  2110             20  SLASH2-1              PIC X.
  2111             20  DC-EDIT2-DAY          PIC 99.
  2112             20  SLASH2-2              PIC X.
  2113             20  DC-EDIT2-YEAR         PIC 99.
  2114         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2115         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2116                     DC-GREG-DATE-1-YMD.
  2117             20  DC-YMD-YEAR           PIC 99.
  2118             20  DC-YMD-MONTH          PIC 99.
  2119             20  DC-YMD-DAY            PIC 99.
  2120         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2121         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2122                      DC-GREG-DATE-1-MDY.
  2123             20  DC-MDY-MONTH          PIC 99.
  2124             20  DC-MDY-DAY            PIC 99.
  2125             20  DC-MDY-YEAR           PIC 99.
  2126         16  DC-GREG-DATE-1-ALPHA.
  2127             20  DC-ALPHA-MONTH        PIC X(10).
  2128             20  DC-ALPHA-DAY          PIC 99.
  2129             20  FILLER                PIC XX.
  2130             20  DC-ALPHA-CENTURY.
  2131                 24 DC-ALPHA-CEN-N     PIC 99.
  2132             20  DC-ALPHA-YEAR         PIC 99.
  2133         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2134         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2135         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2136         16  DC-JULIAN-DATE            PIC 9(05).
  2137         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  40
* EL6311.cbl
  2138                                       PIC 9(05).
  2139         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2140             20  DC-JULIAN-YEAR        PIC 99.
  2141             20  DC-JULIAN-DAYS        PIC 999.
  2142         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2143         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2144         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2145     12  DATE-CONVERSION-VARIBLES.
  2146         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2147         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2148             20  FILLER                PIC 9(3).
  2149             20  HOLD-CEN-1-CCYY.
  2150                 24  HOLD-CEN-1-CC     PIC 99.
  2151                 24  HOLD-CEN-1-YY     PIC 99.
  2152             20  HOLD-CEN-1-MO         PIC 99.
  2153             20  HOLD-CEN-1-DA         PIC 99.
  2154         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2155             20  HOLD-CEN-1-R-MO       PIC 99.
  2156             20  HOLD-CEN-1-R-DA       PIC 99.
  2157             20  HOLD-CEN-1-R-CCYY.
  2158                 24  HOLD-CEN-1-R-CC   PIC 99.
  2159                 24  HOLD-CEN-1-R-YY   PIC 99.
  2160             20  FILLER                PIC 9(3).
  2161         16  HOLD-CENTURY-1-X.
  2162             20  FILLER                PIC X(3)  VALUE SPACES.
  2163             20  HOLD-CEN-1-X-CCYY.
  2164                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2165                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2166             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2167             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2168         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2169             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2170             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2171             20  HOLD-CEN-1-R-X-CCYY.
  2172                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2173                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2174             20  FILLER                PIC XXX.
  2175         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2176         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2177         16  DC-JULIAN-DATE-1          PIC 9(07).
  2178         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2179             20  DC-JULIAN-1-CCYY.
  2180                 24  DC-JULIAN-1-CC    PIC 99.
  2181                 24  DC-JULIAN-1-YR    PIC 99.
  2182             20  DC-JULIAN-DA-1        PIC 999.
  2183         16  DC-JULIAN-DATE-2          PIC 9(07).
  2184         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2185             20  DC-JULIAN-2-CCYY.
  2186                 24  DC-JULIAN-2-CC    PIC 99.
  2187                 24  DC-JULIAN-2-YR    PIC 99.
  2188             20  DC-JULIAN-DA-2        PIC 999.
  2189         16  DC-GREG-DATE-A-EDIT.
  2190             20  DC-EDITA-MONTH        PIC 99.
  2191             20  SLASHA-1              PIC X VALUE '/'.
  2192             20  DC-EDITA-DAY          PIC 99.
  2193             20  SLASHA-2              PIC X VALUE '/'.
  2194             20  DC-EDITA-CCYY.
  2195                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  41
* EL6311.cbl
  2196                 24  DC-EDITA-YEAR     PIC 99.
  2197         16  DC-GREG-DATE-B-EDIT.
  2198             20  DC-EDITB-MONTH        PIC 99.
  2199             20  SLASHB-1              PIC X VALUE '/'.
  2200             20  DC-EDITB-DAY          PIC 99.
  2201             20  SLASHB-2              PIC X VALUE '/'.
  2202             20  DC-EDITB-CCYY.
  2203                 24  DC-EDITB-CENT     PIC 99.
  2204                 24  DC-EDITB-YEAR     PIC 99.
  2205         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2206         16  DC-GREG-DATE-CYMD-R REDEFINES
  2207                              DC-GREG-DATE-CYMD.
  2208             20  DC-CYMD-CEN           PIC 99.
  2209             20  DC-CYMD-YEAR          PIC 99.
  2210             20  DC-CYMD-MONTH         PIC 99.
  2211             20  DC-CYMD-DAY           PIC 99.
  2212         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2213         16  DC-GREG-DATE-MDCY-R REDEFINES
  2214                              DC-GREG-DATE-MDCY.
  2215             20  DC-MDCY-MONTH         PIC 99.
  2216             20  DC-MDCY-DAY           PIC 99.
  2217             20  DC-MDCY-CEN           PIC 99.
  2218             20  DC-MDCY-YEAR          PIC 99.
  2219    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2220        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2221    12  DC-EL310-DATE                  PIC X(21).
  2222    12  FILLER                         PIC X(28).
  2223
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  42
* EL6311.cbl
  2225*    COPY ELCLOGOF.
  2226******************************************************************
  2227*                                                                *
  2228*                                                                *
  2229*                            ELCLOGOF.                           *
  2230*                            VMOD=2.001                          *
  2231*                                                                *
  2232*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2233*                                                                *
  2234******************************************************************
  2235 01  CLASIC-LOGOFF.
  2236     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2237     12  LOGOFF-TEXT.
  2238         16  FILLER          PIC X(5)    VALUE SPACES.
  2239         16  LOGOFF-MSG.
  2240             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2241             20  FILLER      PIC X       VALUE SPACES.
  2242             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2243         16  FILLER          PIC X(80)
  2244           VALUE '* YOU ARE NOW LOGGED OFF'.
  2245         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2246         16  FILLER          PIC X       VALUE QUOTE.
  2247         16  LOGOFF-SYS-MSG  PIC X(17)
  2248           VALUE 'S CLAS-IC SYSTEM '.
  2249     12  TEXT-MESSAGES.
  2250         16  UNACCESS-MSG    PIC X(29)
  2251             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2252         16  PGMIDERR-MSG    PIC X(17)
  2253             VALUE 'PROGRAM NOT FOUND'.
  2254
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  43
* EL6311.cbl
  2256*    COPY ELCATTR.
  2257******************************************************************
  2258*                                                                *
  2259*                            ELCATTR.                            *
  2260*                            VMOD=2.001                          *
  2261*                                                                *
  2262*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2263*                                                                *
  2264*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2265*                                                                *
  2266*                   POS 1   P=PROTECTED                          *
  2267*                           U=UNPROTECTED                        *
  2268*                           S=ASKIP                              *
  2269*                   POS 2   A=ALPHA/NUMERIC                      *
  2270*                           N=NUMERIC                            *
  2271*                   POS 3   N=NORMAL                             *
  2272*                           B=BRIGHT                             *
  2273*                           D=DARK                               *
  2274*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2275*                           OF=MODIFIED DATA TAG OFF             *
  2276*                                                                *
  2277*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2278******************************************************************
  2279 01  ATTRIBUTE-LIST.
  2280     12  AL-PABOF            PIC X       VALUE 'Y'.
  2281     12  AL-PABON            PIC X       VALUE 'Z'.
  2282     12  AL-PADOF            PIC X       VALUE '%'.
  2283     12  AL-PADON            PIC X       VALUE '_'.
  2284     12  AL-PANOF            PIC X       VALUE '-'.
  2285     12  AL-PANON            PIC X       VALUE '/'.
  2286     12  AL-SABOF            PIC X       VALUE '8'.
  2287     12  AL-SABON            PIC X       VALUE '9'.
  2288     12  AL-SADOF            PIC X       VALUE '@'.
  2289     12  AL-SADON            PIC X       VALUE QUOTE.
  2290     12  AL-SANOF            PIC X       VALUE '0'.
  2291     12  AL-SANON            PIC X       VALUE '1'.
  2292     12  AL-UABOF            PIC X       VALUE 'H'.
  2293     12  AL-UABON            PIC X       VALUE 'I'.
  2294     12  AL-UADOF            PIC X       VALUE '<'.
  2295     12  AL-UADON            PIC X       VALUE '('.
  2296     12  AL-UANOF            PIC X       VALUE ' '.
  2297     12  AL-UANON            PIC X       VALUE 'A'.
  2298     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2299     12  AL-UNBON            PIC X       VALUE 'R'.
  2300     12  AL-UNDOF            PIC X       VALUE '*'.
  2301     12  AL-UNDON            PIC X       VALUE ')'.
  2302     12  AL-UNNOF            PIC X       VALUE '&'.
  2303     12  AL-UNNON            PIC X       VALUE 'J'.
  2304
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  44
* EL6311.cbl
  2306*    COPY ELCEMIB.
  2307******************************************************************
  2308*                                                                *
  2309*                                                                *
  2310*                            ELCEMIB.                            *
  2311*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2312*                            VMOD=2.005                          *
  2313*                                                                *
  2314*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2315*                                                                *
  2316******************************************************************
  2317 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2318     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2319     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2320     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2321     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2322     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2323     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2324     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2325     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2326     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2327         88  EMI-NO-ERRORS                    VALUE '1'.
  2328         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2329         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2330     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2331         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2332     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2333         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2334         88  EMI-AREA1-FULL                   VALUE '2'.
  2335     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2336         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2337         88  EMI-AREA2-FULL                   VALUE '2'.
  2338     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2339         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2340         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2341         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2342         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2343         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2344     12  EMI-ERROR-LINES.
  2345         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2346         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2347         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2348         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2349             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2350                 24  EMI-ERR-NUM         PIC X(4).
  2351                 24  EMI-FILLER          PIC X.
  2352                 24  EMI-SEV             PIC X.
  2353                 24  FILLER              PIC X.
  2354             20  FILLER                  PIC X(02).
  2355     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2356         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2357             20  EMI-ERROR-NUMBER    PIC X(4).
  2358             20  EMI-FILL            PIC X.
  2359             20  EMI-SEVERITY        PIC X.
  2360             20  FILLER              PIC X.
  2361             20  EMI-ERROR-TEXT.
  2362                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2363                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  45
* EL6311.cbl
  2364     12  EMI-SEVERITY-SAVE           PIC X.
  2365         88  EMI-NOTE                    VALUE 'N'.
  2366         88  EMI-WARNING                 VALUE 'W'.
  2367         88  EMI-FORCABLE                VALUE 'F'.
  2368         88  EMI-FATAL                   VALUE 'X'.
  2369     12  EMI-MESSAGE-FLAG            PIC X.
  2370         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2371         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2372     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2373     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2374         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2375         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2376         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2377     12  emi-claim-no                pic x(7).
  2378     12  emi-claim-type              pic x(6).
  2379     12  FILLER                      PIC X(124)  VALUE SPACES.
  2380     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2381     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2382     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2383     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2384
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  46
* EL6311.cbl
  2386*    COPY ELCINTF.
  2387******************************************************************
  2388*                                                                *
  2389*                                                                *
  2390*                            ELCINTF.                            *
  2391*                            VMOD=2.017                          *
  2392*                                                                *
  2393*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2394*                                                                *
  2395*       LENGTH = 1024                                            *
  2396*                                                                *
  2397******************************************************************
  2398*                   C H A N G E   L O G
  2399*
  2400* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2401*-----------------------------------------------------------------
  2402*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2403* EFFECTIVE    NUMBER
  2404*-----------------------------------------------------------------
  2405* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2406******************************************************************
  2407 01  PROGRAM-INTERFACE-BLOCK.
  2408     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2409     12  PI-CALLING-PROGRAM              PIC X(8).
  2410     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2411     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2412     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2413     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2414     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2415     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2416     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2417     12  PI-COMPANY-ID                   PIC XXX.
  2418     12  PI-COMPANY-CD                   PIC X.
  2419
  2420     12  PI-COMPANY-PASSWORD             PIC X(8).
  2421
  2422     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2423
  2424     12  PI-CONTROL-IN-PROGRESS.
  2425         16  PI-CARRIER                  PIC X.
  2426         16  PI-GROUPING                 PIC X(6).
  2427         16  PI-STATE                    PIC XX.
  2428         16  PI-ACCOUNT                  PIC X(10).
  2429         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2430                                         PIC X(10).
  2431         16  PI-CLAIM-CERT-GRP.
  2432             20  PI-CLAIM-NO             PIC X(7).
  2433             20  PI-CERT-NO.
  2434                 25  PI-CERT-PRIME       PIC X(10).
  2435                 25  PI-CERT-SFX         PIC X.
  2436             20  PI-CERT-EFF-DT          PIC XX.
  2437         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2438             20  PI-PLAN-CODE            PIC X(2).
  2439             20  PI-REVISION-NUMBER      PIC X(3).
  2440             20  PI-PLAN-EFF-DT          PIC X(2).
  2441             20  PI-PLAN-EXP-DT          PIC X(2).
  2442             20  FILLER                  PIC X(11).
  2443         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  47
* EL6311.cbl
  2444             20  PI-OE-REFERENCE-1.
  2445                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2446                 25  PI-OE-REF-1-SUFF    PIC XX.
  2447
  2448     12  PI-SESSION-IN-PROGRESS          PIC X.
  2449         88  CLAIM-SESSION                   VALUE '1'.
  2450         88  CREDIT-SESSION                  VALUE '2'.
  2451         88  WARRANTY-SESSION                VALUE '3'.
  2452         88  MORTGAGE-SESSION                VALUE '4'.
  2453         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2454
  2455
  2456*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2457
  2458     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2459     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2460
  2461     12  PI-CREDIT-USER                  PIC X.
  2462         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2463         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2464
  2465     12  PI-CLAIM-USER                   PIC X.
  2466         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2467         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2468
  2469     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2470         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2471         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2472         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2473         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2474         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2475
  2476     12  PI-PROCESSOR-ID                 PIC X(4).
  2477
  2478     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2479
  2480     12  PI-MEMBER-CAPTION               PIC X(10).
  2481
  2482     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2483         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2484
  2485     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2486     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2487     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2488     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2489
  2490     12  PI-AH-OVERRIDE-L1               PIC X.
  2491     12  PI-AH-OVERRIDE-L2               PIC XX.
  2492     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2493     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2494
  2495     12  PI-NEW-SYSTEM                   PIC X(2).
  2496
  2497     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2498     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2499         88  PI-USES-PAID-TO                 VALUE '1'.
  2500     12  PI-CRDTCRD-SYSTEM.
  2501         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  48
* EL6311.cbl
  2502             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2503             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2504         16  PI-CC-MONTH-END-DT          PIC XX.
  2505     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2506
  2507     12  PI-OE-REFERENCE-2.
  2508         16  PI-OE-REF-2-PRIME           PIC X(10).
  2509         16  PI-OE-REF-2-SUFF            PIC X.
  2510
  2511     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2512
  2513     12  PI-LANGUAGE-TYPE                PIC X.
  2514             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2515             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2516             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2517
  2518     12  PI-POLICY-LINKAGE-IND           PIC X.
  2519         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2520         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2521                                                   LOW-VALUES.
  2522
  2523     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2524     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2525         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2526         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2527
  2528     12  PI-PROCESSOR-CSR-IND            PIC X.
  2529         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2530         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2531
  2532     12  FILLER                          PIC X(3).
  2533
  2534     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2535
  2536     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2537         PI-SYSTEM-LEVEL.
  2538
  2539         16  PI-ENTRY-CODES.
  2540             20  PI-ENTRY-CD-1           PIC X.
  2541             20  PI-ENTRY-CD-2           PIC X.
  2542
  2543         16  PI-RETURN-CODES.
  2544             20  PI-RETURN-CD-1          PIC X.
  2545             20  PI-RETURN-CD-2          PIC X.
  2546
  2547         16  PI-UPDATE-STATUS-SAVE.
  2548             20  PI-UPDATE-BY            PIC X(4).
  2549             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2550
  2551         16  PI-LOWER-CASE-LETTERS       PIC X.
  2552             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2553
  2554*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2555*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2556*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2557
  2558         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2559             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  49
* EL6311.cbl
  2560             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2561             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2562             88  ACCNT-CNTL                  VALUE '3'.
  2563             88  CARR-ACCNT-CNTL             VALUE '4'.
  2564
  2565         16  PI-PROCESSOR-CAP-LIST.
  2566             20  PI-SYSTEM-CONTROLS.
  2567                24 PI-SYSTEM-DISPLAY     PIC X.
  2568                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2569                24 PI-SYSTEM-MODIFY      PIC X.
  2570                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2571             20  FILLER                  PIC XX.
  2572             20  PI-DISPLAY-CAP          PIC X.
  2573                 88  DISPLAY-CAP             VALUE 'Y'.
  2574             20  PI-MODIFY-CAP           PIC X.
  2575                 88  MODIFY-CAP              VALUE 'Y'.
  2576             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2577                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2578             20  PI-FORCE-CAP            PIC X.
  2579                 88  FORCE-CAP               VALUE 'Y'.
  2580
  2581         16  PI-PROGRAM-CONTROLS.
  2582             20  PI-PGM-PRINT-OPT        PIC X.
  2583             20  PI-PGM-FORMAT-OPT       PIC X.
  2584             20  PI-PGM-PROCESS-OPT      PIC X.
  2585             20  PI-PGM-TOTALS-OPT       PIC X.
  2586
  2587         16  PI-HELP-INTERFACE.
  2588             20  PI-LAST-ERROR-NO        PIC X(4).
  2589             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2590
  2591         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2592             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2593
  2594         16  PI-CR-CONTROL-IN-PROGRESS.
  2595             20  PI-CR-CARRIER           PIC X.
  2596             20  PI-CR-GROUPING          PIC X(6).
  2597             20  PI-CR-STATE             PIC XX.
  2598             20  PI-CR-ACCOUNT           PIC X(10).
  2599             20  PI-CR-FIN-RESP          PIC X(10).
  2600             20  PI-CR-TYPE              PIC X.
  2601
  2602         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2603
  2604         16  PI-CR-MONTH-END-DT          PIC XX.
  2605
  2606         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2607             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2608             88  PI-ZERO-CARRIER             VALUE '1'.
  2609             88  PI-ZERO-GROUPING            VALUE '2'.
  2610             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2611
  2612         16  PI-CARRIER-SECURITY         PIC X.
  2613             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2614
  2615         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2616             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2617             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  50
* EL6311.cbl
  2618
  2619         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2620             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2621                                         INDEXED BY PI-ACCESS-NDX
  2622                                         PIC X.
  2623
  2624         16  PI-GA-BILLING-CONTROL       PIC X.
  2625             88  PI-GA-BILLING               VALUE '1'.
  2626
  2627         16  PI-MAIL-PROCESSING          PIC X.
  2628             88  PI-MAIL-YES                 VALUE 'Y'.
  2629
  2630         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2631
  2632         16  PI-AR-SYSTEM.
  2633             20  PI-AR-PROCESSING-CNTL   PIC X.
  2634                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2635             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2636             20  PI-AR-MONTH-END-DT      PIC XX.
  2637
  2638         16  PI-MP-SYSTEM.
  2639             20  PI-MORTGAGE-USER            PIC X.
  2640                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2641                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2642             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2643                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2644                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2645                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2646                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2647                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2648             20  PI-MP-MONTH-END-DT          PIC XX.
  2649             20  PI-MP-REFERENCE-NO.
  2650                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2651                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2652
  2653         16  PI-LABEL-CONTROL            PIC X(01).
  2654             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2655             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2656
  2657         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2658             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2659
  2660         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2661             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2662             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2663
  2664         16  FILLER                      PIC X(14).
  2665
  2666     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2667******************************************************************
  2668
  2669     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2670*    COPY ELC631PI.
  2671******************************************************************
  2672*                                                                *
  2673*                                                                *
  2674*                            ELC631PI                            *
  2675*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  51
* EL6311.cbl
  2676*                                                                *
  2677*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2678*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2679*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2680*                                                                *
  2681*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2682*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2683*    BETWEEN PROGRAMS.                                           *
  2684*                                                                *
  2685*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2686*                                                                *
  2687*               EL631 - EL6311 - EL6312 - EL6313                 *
  2688*                                                                *
  2689******************************************************************
  2690*                   C H A N G E   L O G
  2691*
  2692* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2693*-----------------------------------------------------------------
  2694*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2695* EFFECTIVE    NUMBER
  2696*-----------------------------------------------------------------
  2697* 021414    2003053000001  PEMA  changes for auto chk request
  2698******************************************************************
  2699
  2700         16  PI-631-DATA.
  2701             20  PI-ERPNDB-KEY.
  2702                 24  PI-PB-COMPANY-CD     PIC X.
  2703                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2704                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2705                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2706
  2707             20  PI-ERPNDB-ALT-KEY.
  2708                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2709                 24  PI-PB-CARRIER        PIC X.
  2710                 24  PI-PB-GROUPING       PIC X(6).
  2711                 24  PI-PB-STATE          PIC XX.
  2712                 24  PI-PB-ACCOUNT        PIC X(10).
  2713                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2714                 24  PI-PB-CERT-NO.
  2715                     28  PI-PB-CERT-PRIME PIC X(10).
  2716                     28  PI-PB-CERT-SFX   PIC X.
  2717                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2718                 24  PI-PB-RECORD-TYPE    PIC X.
  2719
  2720             20  PI-ERPNDB-CSR-KEY.
  2721                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2722                 24  PI-PB-CSR-ID             PIC X(4).
  2723                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2724                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2725                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2726
  2727             20  PI-BROWSE-TYPE               PIC X.
  2728                 88  PI-FILE-BROWSE             VALUE ' '.
  2729                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2730                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2731                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2732                 88  PI-CSR-BROWSE              VALUE '4'.
  2733
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  52
* EL6311.cbl
  2734             20  PI-MAINT-FUNCTION            PIC X.
  2735                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2736                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2737                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2738                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2739                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2740                 88  PI-PF5-FUNCTION            VALUE '5'.
  2741                 88  PI-PF6-FUNCTION            VALUE '6'.
  2742
  2743             20  PI-FILE-SWITCHES.
  2744                 24  PI-ALL-ISSUES-SW         PIC X.
  2745                     88  ALL-ISSUES             VALUE 'Y'.
  2746                 24  PI-ALL-CANCELS-SW        PIC X.
  2747                     88  ALL-CANCELS            VALUE 'Y'.
  2748                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2749                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2750                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2751                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2752                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2753                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2754                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2755                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2756                 24  PI-HOLD-REC-SW           PIC X.
  2757                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2758                 24  PI-CHANGE-REC-SW         PIC X.
  2759                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2760                 24  PI-CHK-REQ-REC-SW        PIC X.
  2761                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2762                 24  PI-ISSUE-WARNING-SW      PIC X.
  2763                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2764                 24  PI-CANCEL-WARNING-SW     PIC X.
  2765                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2766             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2767                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2768             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2769                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2770
  2771             20  PI-MAP-NAME                  PIC X(8).
  2772
  2773             20  PI-CURSOR                    PIC S9(4) COMP.
  2774
  2775             20  PI-PREV-ALT-KEY              PIC X(36).
  2776             20  PI-PREV-CSR-KEY              PIC X(15).
  2777             20  PI-PREV-KEY.
  2778                 24  PI-PREV-COMPANY-CD       PIC X.
  2779                 24  PI-PREV-BATCH            PIC X(6).
  2780                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2781                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2782             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2783             20  PI-BROWSE-SW                 PIC X.
  2784                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2785                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2786             20  PI-SV-CARRIER                PIC X.
  2787             20  PI-SV-GROUPING               PIC X(6).
  2788             20  PI-SV-STATE                  PIC XX.
  2789             20  PI-EDIT-SW                   PIC X.
  2790             20  PI-DISPLAY-SW                PIC XX.
  2791                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  53
* EL6311.cbl
  2792                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2793             20  PI-CRITERIA-DATA             PIC X(350).
  2794             20  PI-BMODE                     PIC X.
  2795             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2796             20  PI-BPMTS                     PIC S999     COMP-3.
  2797             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2798             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2799             20  PI-CSR-SESSION-SW            PIC X.
  2800                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2801             20  PI-ERRORS-SW                 PIC X.
  2802                 88  FATAL-ERRORS               VALUE 'X'.
  2803*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2804             20  pi-unforced-sw               pic x.
  2805                 88  unforced-errors            value 'X'.
  2806             20  FILLER                       PIC X(4).
  2807
  2808        16  pi-6311-fatal-ctr    pic s999 comp-3.
  2809        16  FILLER             PIC X(92).
  2810
  2811 01  W-LETTER-COMMUNICATION-AREAS.
  2812*    COPY ELC1042.
  2813******************************************************************
  2814*                                                                *
  2815*                                                                *
  2816*                           ELC1042                              *
  2817*                            VMOD=2.002                          *
  2818*                                                                *
  2819*    NOTE                                                        *
  2820*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2821*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2822*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2823*        TO THESE PROGRAMS.                                      *
  2824*                                                                *
  2825*    NOTE                                                        *
  2826*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2827*        USE ONLY!                                               *
  2828*                                                                *
  2829******************************************************************
  2830
  2831         16  PI-1042-WA.
  2832             20  PI-ACTION       PIC  X(01).
  2833                 88 PI-SHOW-MODE           VALUE '1'.
  2834                 88 PI-CLEAR-MODE          VALUE '2'.
  2835                 88 PI-CREATE-MODE         VALUE '3'.
  2836             20  PI-COMM-CONTROL PIC  X(12).
  2837             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2838             20  PI-EOF-SW       PIC  X(01).
  2839                 88  PI-FILE-EOF           VALUE 'Y'.
  2840             20  PI-FILETYP      PIC  X(01).
  2841             20  PI-FORM-SQUEEZE-CONTROL
  2842                                 PIC  X(01).
  2843                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2844                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2845             20  PI-LAST-CONTROL PIC  X(12).
  2846             20  PI-TEMP-STOR-ITEMS
  2847                                 PIC S9(04) COMP.
  2848             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2849             20  PI-UPDATE-SW    PIC  9(01).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  54
* EL6311.cbl
  2850                 88 ANY-UPDATES            VALUE 1.
  2851             20  PI-104-SCREEN-SENT-IND
  2852                                 PIC  X(01).
  2853                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2854                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2855             20  PI-1042-SCREEN-SENT-IND
  2856                                 PIC  X(01).
  2857                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2858                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2859             20  PI-1042-ARCHIVE-IND
  2860                                 PIC  X(01).
  2861                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2862             20  FILLER          PIC  X(29).
  2863*    COPY ELC689PI.
  2864******************************************************************
  2865*                                                                *
  2866*                            ELC689PI                            *
  2867*                            VMOD=2.003                          *
  2868*                                                                *
  2869*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2870*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2871*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2872*                                                                *
  2873*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2874*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2875*    BETWEEN PROGRAMS.                                           *
  2876*                                                                *
  2877*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2878*                                                                *
  2879*               EL631 - EL689  - EL6891 - EL6892                 *
  2880*                                                                *
  2881******************************************************************
  2882*                   C H A N G E   L O G
  2883*
  2884* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2885*-----------------------------------------------------------------
  2886*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2887* EFFECTIVE    NUMBER
  2888*-----------------------------------------------------------------
  2889* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2890* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2891* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2892******************************************************************
  2893
  2894
  2895         16  PI-689-WORK-AREA.
  2896             20  PI-689-ALT-PRINTER-ID
  2897                                 PIC  X(04).
  2898             20  PI-689-ARCHIVE-NUMBER
  2899                                 PIC  9(08).
  2900             20  PI-689-ARCHIVE-SW
  2901                                 PIC  X(01).
  2902                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2903             20  PI-689-DATA-SOURCE
  2904                                 PIC  X(01).
  2905                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2906                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2907                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  55
* EL6311.cbl
  2908                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2909                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2910             20  PI-689-ERROR-IND
  2911                                 PIC  X(01).
  2912                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2913             20  PI-689-ERROR    PIC  9(04).
  2914                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2915                 88  PI-689-FATAL-ERROR
  2916                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2917                            0042 0047 0051 0066 0067 0070
  2918                            0168 0169 0174 0175 0176 0177 0179
  2919                            0180 0181 0182 0184 0185 0189 0190
  2920                            0191
  2921                            0215 0279 0280
  2922                            0412 0413 0454
  2923                            0533 0537
  2924                            2055 2114 2208 2209 2216 2232 2369
  2925                            2398 2433 2908 2999
  2926                            3000 3770 3771 3775
  2927                            7250 7365 7367 7368 7369 7370 7371
  2928                            7272 7373 7374 7376 7377 7378 7379
  2929                            7381 7388 7390 7393 7395 7396 7398
  2930                            9095 9096 9281 9298 9299 9320 9327
  2931                            9426 9427.
  2932                 88  PI-689-STOP-ERROR
  2933                     VALUES 0004 0008 0013 0023 0029 0033
  2934                            0042 0047 0066 0067 0070
  2935                            0168 0169 0174 0175 0176 0177
  2936                            0181 0182 0184 0185 0189 0190
  2937                            0279 0280
  2938                            0412 0413 0454
  2939                            2055 2208 2209 2216 2232
  2940                            2398 2999
  2941                            3000 3770 3771 3775
  2942                            7250 7365 7369 7370 7371
  2943                            7272 7373 7374 7376 7377 7378 7379
  2944                            7381 7388 7390 7393 7396 7398
  2945                            9095 9096 9299 9320 9426.
  2946             20  PI-689-FOLLOW-UP-DATE
  2947                                 PIC  X(02).
  2948             20  PI-689-FORM-NUMBER
  2949                                 PIC  X(04).
  2950             20  PI-689-LABEL-SOURCE
  2951                                 PIC X(01).
  2952                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2953                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2954                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2955                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2956                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2957                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2958                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2959             20  PI-689-NUMBER-COPIES
  2960                                 PIC  9(01).
  2961             20  PI-689-NUMBER-LABEL-LINES
  2962                                 PIC  9(01).
  2963             20  PI-689-NUMBER-TEXT-RECORDS
  2964                                 PIC  9(03).
  2965             20  PI-689-PRINT-ORDER-SW
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  56
* EL6311.cbl
  2966                                 PIC  X(01).
  2967                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2968                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2969                 88  PI-689-PRINT-LATER     VALUE '3'.
  2970                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2971             20  PI-689-PRINT-RESTRICTION
  2972                                 PIC  X(01).
  2973                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2974                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2975                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2976             20  PI-689-PRINT-SW PIC  X(01).
  2977                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2978             20  PI-689-RESEND-DATE-1
  2979                                 PIC  X(02).
  2980             20  PI-689-RESEND-LETR-1
  2981                                 PIC X(4).
  2982             20  PI-689-TEMP-STOR-ID
  2983                                 PIC  X(08).
  2984             20  PI-689-USE-SCREEN-IND
  2985                                 PIC  X(01).
  2986                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2987             20  PI-689-ARCH-POINTER
  2988                                 PIC S9(08) COMP.
  2989                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2990             20  PI-689-ARCT-POINTER
  2991                                 PIC S9(08) COMP.
  2992                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2993             20  PI-689-VARIABLE-DATA-GRP.
  2994                 24  PI-689-VARIABLE-DATA-1
  2995                                 PIC  X(30).
  2996                 24  PI-689-VARIABLE-DATA-2
  2997                                 PIC  X(30).
  2998                 24  PI-689-VARIABLE-DATA-3
  2999                                 PIC  X(30).
  3000                 24  PI-689-VARIABLE-DATA-4
  3001                                 PIC  X(30).
  3002
  3003         16  PI-689-KEY-DATA-FIELDS.
  3004             20  PI-689-ACCOUNT  PIC  X(10).
  3005             20  PI-689-CARRIER  PIC  X(01).
  3006             20  PI-689-CERT-NO.
  3007                 24  PI-689-CERT-PRIME
  3008                                 PIC  X(10).
  3009                 24  PI-689-CERT-SFX
  3010                                 PIC  X(01).
  3011             20  PI-689-CHG-SEQ-NO
  3012                                 PIC S9(04)    COMP.
  3013             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  3014                                 PIC  X(02).
  3015             20  PI-689-ENTRY-BATCH
  3016                                 PIC  X(06).
  3017             20  PI-689-EFF-DATE PIC  X(02).
  3018             20  PI-689-EXP-DATE PIC  X(02).
  3019             20  PI-689-GROUPING PIC  X(06).
  3020             20  PI-689-RESP-PERSON
  3021                                 PIC  X(10).
  3022             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  3023             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  57
* EL6311.cbl
  3024                                 PIC  X(04).
  3025             20  PI-689-STATE    PIC  X(02).
  3026             20  PI-689-TYPE     PIC  X(01).
  3027             20  PI-689-CONTROL  PIC S9(08)    COMP.
  3028             20  PI-689-ALT-SEQ-NO
  3029                                 PIC S9(04)    COMP.
  3030         16  PI-689-DATE-EDIT    PIC  X(08).
  3031         16  PI-689-FOLLOW-UP-EDIT
  3032                                 PIC  X(08).
  3033         16  PI-689-RESEND1-EDIT PIC  X(08).
  3034         16  PI-689-SEQ-EDIT     PIC  X(08).
  3035         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  3036         16  PI-689-LBL-OVERRIDE PIC  X(01).
  3037             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  3038         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  3039         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  58
* EL6311.cbl
  3041
  3042 01  WS-EL6315-PASS-AREA.
  3043        16  PI-6315-ISS-CAN-SW      PIC X.
  3044        16  FILLER                  PIC X(120).
  3045        16  PI-RES-REF-CLM-TYPE     PIC X.
  3046        16  FILLER                  PIC X.
  3047        16  PI-6315-PASS-AREA.
  3048            20 FILLER               PIC X(236).
  3049            20 PI-6315-FINALIZED    PIC X.
  3050            20 FILLER               PIC X(280).
  3051
  3052 01  WS-EL6316-PASS-AREA.
  3053        16  PI-ISS-CAN-SW           PIC X.
  3054        16  FILLER                  PIC X(121).
  3055        16  PI-CLM-RESC-IND         PIC X.
  3056        16  PI-6316-PASS-AREA.
  3057            20 FILLER               PIC X(236).
  3058            20 PI-6316-FINALIZED    PIC X.
  3059            20 FILLER               PIC X(280).
  3060
  3061******************************************************************
  3062*                                                                *
  3063*         P A S S   A R E A   F O R   E D I T                    *
  3064*                                                                *
  3065******************************************************************
  3066
  3067 01  PASSED-RECORD.
  3068     12  RECORD-SAVE                  PIC X(585).
  3069* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  3070*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  3071*                    BY  WK-CURRENT-DATE.
  3072******************************************************************
  3073*                                                                *
  3074*                                                                *
  3075*                             ELC50W1                            *
  3076*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3077*                            VMOD=2.004                          *
  3078*                                                                *
  3079*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  3080*                                                                *
  3081*                                                                *
  3082******************************************************************
  3083
  3084     12  WK-WORK-AREA.
  3085         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  3086         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  3087         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  3088         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  3089         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  3090         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  3091         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  3092         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  3093         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  3094         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  3095         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  3096         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  3097         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  3098         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  59
* EL6311.cbl
  3099         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  3100         16  WK-CREDIT-EDIT-CONTROLS.
  3101             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  3102             20  WK-MIN-AGE           PIC 99  VALUE 00.
  3103             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  3104             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  3105             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  3106             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  3107         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  3108         16  WK-SAVE-REIN-DATA.
  3109             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  3110             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  3111             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  3112         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  3113             88  ENTRY-FROM-EL6311       VALUE '6'.
  3114         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  3115         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  3116     12  WK-RECORD-ADDRESSES.
  3117         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3118         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  3119         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  3120         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  3121         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  3122         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  3123         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3124         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3125     12  WK-OVER-SHORT-AREA.
  3126         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3127         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3128         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3129             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3130         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  60
* EL6311.cbl
  3132
  3133*    COPY ELCEDITC.
  3134******************************************************************
  3135*                                                                *
  3136*                                                                *
  3137*                            ELCEDITC                            *
  3138*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3139*                            VMOD=2.012                          *
  3140*                                                                *
  3141*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3142*                     EL6313, EL050 AND EL517.                   *
  3143*                                                                *
  3144******************************************************************
  3145******************************************************************
  3146*                   C H A N G E   L O G
  3147*
  3148* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3149*-----------------------------------------------------------------
  3150*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3151* EFFECTIVE    NUMBER
  3152*-----------------------------------------------------------------
  3153* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3154******************************************************************
  3155
  3156     12  EDIT-CRITERIA-DATA.
  3157         16  EC-CO-MONTH-END-DT       PIC XX.
  3158         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3159         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3160         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3161         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3162         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3163         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3164         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3165         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3166         16  EC-CO-REM-TERM-CALC      PIC X.
  3167               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3168               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3169               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3170               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3171
  3172         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3173               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3174               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3175               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3176               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3177               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3178               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3179               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3180               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3181               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3182               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3183
  3184         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3185               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3186               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3187               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3188               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3189               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  61
* EL6311.cbl
  3190               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3191               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3192               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3193
  3194         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3195                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3196                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3197
  3198         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3199                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3200                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3201                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3202                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3203                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3204                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3205                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3206                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3207
  3208         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3209               88  EC-BR-REDUCING                   VALUE 'R'.
  3210               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3211
  3212         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3213         16  EC-BR-LF-DESC             PIC X(10).
  3214         16  EC-BR-AH-DESC             PIC X(10).
  3215         16  EC-BR-LF-COMMENT          PIC X(10).
  3216         16  EC-BR-AH-COMMENT          PIC X(10).
  3217
  3218         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3219               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3220               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3221               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3222               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3223
  3224         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3225               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3226               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3227               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3228               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3229
  3230         16  EC-BR-LF-REFUND-CALC      PIC X.
  3231                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3232                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3233                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3234                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3235                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3236                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3237                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3238
  3239         16  EC-BR-AH-REFUND-CALC      PIC X.
  3240                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3241                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3242                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3243                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3244                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3245                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3246                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3247                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  62
* EL6311.cbl
  3248
  3249         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3250                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3251                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3252                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3253
  3254         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3255                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3256                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3257                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3258
  3259         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3260         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3261         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3262         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3263
  3264         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3265         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3266                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3267                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3268                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3269                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3270
  3271         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3272               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3273               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3274               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3275               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3276               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3277
  3278         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3279               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3280               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3281               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3282               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3283               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3284
  3285         16  EC-ST-LF-REFUND-CALC      PIC X.
  3286                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3287                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3288                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3289                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3290                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3291                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3292                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3293                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3294
  3295         16  EC-ST-AH-REFUND-CALC      PIC X.
  3296                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3297                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3298                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3299                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3300                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3301                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3302                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3303                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3304
  3305         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  63
* EL6311.cbl
  3306         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3307         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3308         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3309         16  EC-AM-EXPIRATION-DT       PIC XX.
  3310         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3311         16  EC-AM-CLASS-CD            PIC XX.
  3312         16  EC-AM-LF-DEVIATION        PIC XXX.
  3313         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3314         16  EC-AM-AH-DEVIATION        PIC XXX.
  3315         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3316         16  EC-AM-PHONE-NO            PIC X(10).
  3317
  3318         16  EC-AM-LF-REFUND-CALC      PIC X.
  3319                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3320                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3321                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3322                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3323                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3324                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3325                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3326
  3327         16  EC-AM-AH-REFUND-CALC      PIC X.
  3328                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3329                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3330                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3331                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3332                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3333                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3334                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3335
  3336         16  EC-AM-BEN-I-G-CD          PIC X.
  3337                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3338                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3339                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3340
  3341         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3342         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3343         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3344         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3345         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3346         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3347         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3348         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3349         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3350
  3351         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3352         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3353         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3354         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3355         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3356         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3357         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3358         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3359         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3360         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3361         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3362         16  EC-RT-LF-NSP-ST           PIC XX.
  3363         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  64
* EL6311.cbl
  3364         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3365         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3366
  3367         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3368             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3369                                             'M' '5' '9' '2'.
  3370             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3371             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3372             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3373             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3374             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3375             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3376             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3377             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3378             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3379             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3380
  3381         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3382             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3383                                             'M' '5' '9' '2'.
  3384             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3385             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3386             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3387             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3388             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3389             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3390             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3391             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3392             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3393             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3394
  3395         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3396         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3397         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3398         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3399         16  EC-CM-DEATH-DT            PIC XX.
  3400
  3401*DMD CUSTOM CODING FIELDS BELOW
  3402*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3403         16  EC-BR-DMD-RATING-SW       PIC X.
  3404                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3405                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3406                 88  NO-DMD-RATING               VALUE 'N'.
  3407
  3408         16  EC-NEW-CERT               PIC X(11).
  3409         16  EC-NEW-STATE              PIC XX.
  3410         16  FILLER                    PIC X.
  3411*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3412         16  OVER-SHORT-EDIT-FIELDS.
  3413             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3414             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3415             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3416             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3417             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3418             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3419             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3420             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3421             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  65
* EL6311.cbl
  3422         16  FILLER                    PIC X(71).
  3423
  3424******************************************************************
  3425
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  66
* EL6311.cbl
  3427
  3428*    COPY ELCJPFX.
  3429******************************************************************
  3430*                                                                *
  3431*                                                                *
  3432*                            ELCJPFX.                            *
  3433*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3434*                            VMOD=2.002                          *
  3435*                                                                *
  3436*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3437*                                                                *
  3438*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3439*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3440*        ELCNTL - CONTROL FILE                                   *
  3441*        ELMSTR - CLAIM MASTERS                                  *
  3442*        ELTRLR - ACTIVITY TRAILERS                              *
  3443*        ELCHKQ - CHECK QUE                                      *
  3444******************************************************************
  3445 01  JOURNAL-RECORD.
  3446     12  jp-date                     pic s9(5) comp-3.
  3447     12  jp-time                     pic s9(7) comp-3.
  3448     12  JP-USER-ID                  PIC X(4).
  3449     12  JP-FILE-ID                  PIC X(8).
  3450     12  JP-PROGRAM-ID               PIC X(8).
  3451     12  JP-RECORD-TYPE              PIC X.
  3452         88 JP-ADD              VALUE 'A'.
  3453         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3454         88 JP-AFTER-CHANGE     VALUE 'C'.
  3455         88 JP-DELETE           VALUE 'D'.
  3456         88 JP-GENERIC-DELETE   VALUE 'G'.
  3457         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3458         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3459     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3460     12  JP-RECORD-AREA
  3461
  3462
  3463                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  67
* EL6311.cbl
  3465*    COPY ELCAID.
  3466******************************************************************
  3467*                                                                *
  3468*                            ELCAID.                             *
  3469*                            VMOD=2.001                          *
  3470*                                                                *
  3471*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3472*                                                                *
  3473*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3474*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3475******************************************************************
  3476
  3477 01  DFHAID.
  3478   02  DFHNULL   PIC  X  VALUE  ' '.
  3479   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3480   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3481   02  DFHPEN    PIC  X  VALUE  '='.
  3482   02  DFHOPID   PIC  X  VALUE  'W'.
  3483   02  DFHPA1    PIC  X  VALUE  '%'.
  3484   02  DFHPA2    PIC  X  VALUE  '>'.
  3485   02  DFHPA3    PIC  X  VALUE  ','.
  3486   02  DFHPF1    PIC  X  VALUE  '1'.
  3487   02  DFHPF2    PIC  X  VALUE  '2'.
  3488   02  DFHPF3    PIC  X  VALUE  '3'.
  3489   02  DFHPF4    PIC  X  VALUE  '4'.
  3490   02  DFHPF5    PIC  X  VALUE  '5'.
  3491   02  DFHPF6    PIC  X  VALUE  '6'.
  3492   02  DFHPF7    PIC  X  VALUE  '7'.
  3493   02  DFHPF8    PIC  X  VALUE  '8'.
  3494   02  DFHPF9    PIC  X  VALUE  '9'.
  3495   02  DFHPF10   PIC  X  VALUE  ':'.
  3496   02  DFHPF11   PIC  X  VALUE  '#'.
  3497   02  DFHPF12   PIC  X  VALUE  '@'.
  3498   02  DFHPF13   PIC  X  VALUE  'A'.
  3499   02  DFHPF14   PIC  X  VALUE  'B'.
  3500   02  DFHPF15   PIC  X  VALUE  'C'.
  3501   02  DFHPF16   PIC  X  VALUE  'D'.
  3502   02  DFHPF17   PIC  X  VALUE  'E'.
  3503   02  DFHPF18   PIC  X  VALUE  'F'.
  3504   02  DFHPF19   PIC  X  VALUE  'G'.
  3505   02  DFHPF20   PIC  X  VALUE  'H'.
  3506   02  DFHPF21   PIC  X  VALUE  'I'.
  3507*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3508   02  DFHPF22   PIC  X  VALUE  '['.
  3509   02  DFHPF23   PIC  X  VALUE  '.'.
  3510   02  DFHPF24   PIC  X  VALUE  '<'.
  3511   02  DFHMSRE   PIC  X  VALUE  'X'.
  3512   02  DFHSTRF   PIC  X  VALUE  'h'.
  3513   02  DFHTRIG   PIC  X  VALUE  '"'.
  3514
  3515 01  FILLER    REDEFINES DFHAID.
  3516     12  FILLER              PIC X(8).
  3517     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3518
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  68
* EL6311.cbl
  3520*    COPY EL6311S.
  3521 01  EL631BI.
  3522     05  FILLER            PIC  X(0012).
  3523*    -------------------------------
  3524     05  BDATEL PIC S9(0004) COMP.
  3525     05  BDATEF PIC  X(0001).
  3526     05  FILLER REDEFINES BDATEF.
  3527         10  BDATEA PIC  X(0001).
  3528     05  BDATEI PIC  X(0008).
  3529*    -------------------------------
  3530     05  BTIMEL PIC S9(0004) COMP.
  3531     05  BTIMEF PIC  X(0001).
  3532     05  FILLER REDEFINES BTIMEF.
  3533         10  BTIMEA PIC  X(0001).
  3534     05  BTIMEI PIC  X(0005).
  3535*    -------------------------------
  3536     05  BHEADL PIC S9(0004) COMP.
  3537     05  BHEADF PIC  X(0001).
  3538     05  FILLER REDEFINES BHEADF.
  3539         10  BHEADA PIC  X(0001).
  3540     05  BHEADI PIC  X(0038).
  3541*    -------------------------------
  3542     05  BNCERTLL PIC S9(0004) COMP.
  3543     05  BNCERTLF PIC  X(0001).
  3544     05  FILLER REDEFINES BNCERTLF.
  3545         10  BNCERTLA PIC  X(0001).
  3546     05  BNCERTLI PIC  X(0008).
  3547*    -------------------------------
  3548     05  BNCERTL PIC S9(0004) COMP.
  3549     05  BNCERTF PIC  X(0001).
  3550     05  FILLER REDEFINES BNCERTF.
  3551         10  BNCERTA PIC  X(0001).
  3552     05  BNCERTI PIC  X(0011).
  3553*    -------------------------------
  3554     05  BNSTATLL PIC S9(0004) COMP.
  3555     05  BNSTATLF PIC  X(0001).
  3556     05  FILLER REDEFINES BNSTATLF.
  3557         10  BNSTATLA PIC  X(0001).
  3558     05  BNSTATLI PIC  X(0009).
  3559*    -------------------------------
  3560     05  BNSTATL PIC S9(0004) COMP.
  3561     05  BNSTATF PIC  X(0001).
  3562     05  FILLER REDEFINES BNSTATF.
  3563         10  BNSTATA PIC  X(0001).
  3564     05  BNSTATI PIC  X(0002).
  3565*    -------------------------------
  3566     05  BCHGTL PIC S9(0004) COMP.
  3567     05  BCHGTF PIC  X(0001).
  3568     05  FILLER REDEFINES BCHGTF.
  3569         10  BCHGTA PIC  X(0001).
  3570     05  BCHGTI PIC  X(0004).
  3571*    -------------------------------
  3572     05  BCHGL PIC S9(0004) COMP.
  3573     05  BCHGF PIC  X(0001).
  3574     05  FILLER REDEFINES BCHGF.
  3575         10  BCHGA PIC  X(0001).
  3576     05  BCHGI PIC  X(0004).
  3577*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  69
* EL6311.cbl
  3578     05  BCOMPIDL PIC S9(0004) COMP.
  3579     05  BCOMPIDF PIC  X(0001).
  3580     05  FILLER REDEFINES BCOMPIDF.
  3581         10  BCOMPIDA PIC  X(0001).
  3582     05  BCOMPIDI PIC  X(0003).
  3583*    -------------------------------
  3584     05  BREGIONL PIC S9(0004) COMP.
  3585     05  BREGIONF PIC  X(0001).
  3586     05  FILLER REDEFINES BREGIONF.
  3587         10  BREGIONA PIC  X(0001).
  3588     05  BREGIONI PIC  X(0006).
  3589*    -------------------------------
  3590     05  BUSERL PIC S9(0004) COMP.
  3591     05  BUSERF PIC  X(0001).
  3592     05  FILLER REDEFINES BUSERF.
  3593         10  BUSERA PIC  X(0001).
  3594     05  BUSERI PIC  X(0004).
  3595*    -------------------------------
  3596     05  BMAINTL PIC S9(0004) COMP.
  3597     05  BMAINTF PIC  X(0001).
  3598     05  FILLER REDEFINES BMAINTF.
  3599         10  BMAINTA PIC  X(0001).
  3600     05  BMAINTI PIC  X(0001).
  3601*    -------------------------------
  3602     05  BMANTBYL PIC S9(0004) COMP.
  3603     05  BMANTBYF PIC  X(0001).
  3604     05  FILLER REDEFINES BMANTBYF.
  3605         10  BMANTBYA PIC  X(0001).
  3606     05  BMANTBYI PIC  X(0004).
  3607*    -------------------------------
  3608     05  BCHGHDGL PIC S9(0004) COMP.
  3609     05  BCHGHDGF PIC  X(0001).
  3610     05  FILLER REDEFINES BCHGHDGF.
  3611         10  BCHGHDGA PIC  X(0001).
  3612     05  BCHGHDGI PIC  X(0003).
  3613*    -------------------------------
  3614     05  BMANTDTL PIC S9(0004) COMP.
  3615     05  BMANTDTF PIC  X(0001).
  3616     05  FILLER REDEFINES BMANTDTF.
  3617         10  BMANTDTA PIC  X(0001).
  3618     05  BMANTDTI PIC  X(0008).
  3619*    -------------------------------
  3620     05  BMANTATL PIC S9(0004) COMP.
  3621     05  BMANTATF PIC  X(0001).
  3622     05  FILLER REDEFINES BMANTATF.
  3623         10  BMANTATA PIC  X(0001).
  3624     05  BMANTATI PIC  X(0005).
  3625*    -------------------------------
  3626     05  BCSRL PIC S9(0004) COMP.
  3627     05  BCSRF PIC  X(0001).
  3628     05  FILLER REDEFINES BCSRF.
  3629         10  BCSRA PIC  X(0001).
  3630     05  BCSRI PIC  X(0004).
  3631*    -------------------------------
  3632     05  BBATCHL PIC S9(0004) COMP.
  3633     05  BBATCHF PIC  X(0001).
  3634     05  FILLER REDEFINES BBATCHF.
  3635         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  70
* EL6311.cbl
  3636     05  BBATCHI PIC  X(0006).
  3637*    -------------------------------
  3638     05  BSEQL PIC S9(0004) COMP.
  3639     05  BSEQF PIC  X(0001).
  3640     05  FILLER REDEFINES BSEQF.
  3641         10  BSEQA PIC  X(0001).
  3642     05  BSEQI PIC  X(0004).
  3643*    -------------------------------
  3644     05  BMOENDTL PIC S9(0004) COMP.
  3645     05  BMOENDTF PIC  X(0001).
  3646     05  FILLER REDEFINES BMOENDTF.
  3647         10  BMOENDTA PIC  X(0001).
  3648     05  BMOENDTI PIC  X(0008).
  3649*    -------------------------------
  3650     05  BCARRL PIC S9(0004) COMP.
  3651     05  BCARRF PIC  X(0001).
  3652     05  FILLER REDEFINES BCARRF.
  3653         10  BCARRA PIC  X(0001).
  3654     05  BCARRI PIC  X(0001).
  3655*    -------------------------------
  3656     05  BGROUPL PIC S9(0004) COMP.
  3657     05  BGROUPF PIC  X(0001).
  3658     05  FILLER REDEFINES BGROUPF.
  3659         10  BGROUPA PIC  X(0001).
  3660     05  BGROUPI PIC  X(0006).
  3661*    -------------------------------
  3662     05  BSTATEL PIC S9(0004) COMP.
  3663     05  BSTATEF PIC  X(0001).
  3664     05  FILLER REDEFINES BSTATEF.
  3665         10  BSTATEA PIC  X(0001).
  3666     05  BSTATEI PIC  X(0002).
  3667*    -------------------------------
  3668     05  BACCTL PIC S9(0004) COMP.
  3669     05  BACCTF PIC  X(0001).
  3670     05  FILLER REDEFINES BACCTF.
  3671         10  BACCTA PIC  X(0001).
  3672     05  BACCTI PIC  X(0010).
  3673*    -------------------------------
  3674     05  BVINHL PIC S9(0004) COMP.
  3675     05  BVINHF PIC  X(0001).
  3676     05  FILLER REDEFINES BVINHF.
  3677         10  BVINHA PIC  X(0001).
  3678     05  BVINHI PIC  X(0004).
  3679*    -------------------------------
  3680     05  BVINL PIC S9(0004) COMP.
  3681     05  BVINF PIC  X(0001).
  3682     05  FILLER REDEFINES BVINF.
  3683         10  BVINA PIC  X(0001).
  3684     05  BVINI PIC  X(0017).
  3685*    -------------------------------
  3686     05  BREFHDGL PIC S9(0004) COMP.
  3687     05  BREFHDGF PIC  X(0001).
  3688     05  FILLER REDEFINES BREFHDGF.
  3689         10  BREFHDGA PIC  X(0001).
  3690     05  BREFHDGI PIC  X(0004).
  3691*    -------------------------------
  3692     05  BREFL PIC S9(0004) COMP.
  3693     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  71
* EL6311.cbl
  3694     05  FILLER REDEFINES BREFF.
  3695         10  BREFA PIC  X(0001).
  3696     05  BREFI PIC  X(0012).
  3697*    -------------------------------
  3698     05  LETRREQL PIC S9(0004) COMP.
  3699     05  LETRREQF PIC  X(0001).
  3700     05  FILLER REDEFINES LETRREQF.
  3701         10  LETRREQA PIC  X(0001).
  3702     05  LETRREQI PIC  X(0001).
  3703*    -------------------------------
  3704     05  BAGEDEFL PIC S9(0004) COMP.
  3705     05  BAGEDEFF PIC  X(0001).
  3706     05  FILLER REDEFINES BAGEDEFF.
  3707         10  BAGEDEFA PIC  X(0001).
  3708     05  BAGEDEFI PIC  X(0004).
  3709*    -------------------------------
  3710     05  BCERTNOL PIC S9(0004) COMP.
  3711     05  BCERTNOF PIC  X(0001).
  3712     05  FILLER REDEFINES BCERTNOF.
  3713         10  BCERTNOA PIC  X(0001).
  3714     05  BCERTNOI PIC  X(0010).
  3715*    -------------------------------
  3716     05  BSUFIXL PIC S9(0004) COMP.
  3717     05  BSUFIXF PIC  X(0001).
  3718     05  FILLER REDEFINES BSUFIXF.
  3719         10  BSUFIXA PIC  X(0001).
  3720     05  BSUFIXI PIC  X(0001).
  3721*    -------------------------------
  3722     05  BEFFDTL PIC S9(0004) COMP.
  3723     05  BEFFDTF PIC  X(0001).
  3724     05  FILLER REDEFINES BEFFDTF.
  3725         10  BEFFDTA PIC  X(0001).
  3726     05  BEFFDTI PIC  X(0008).
  3727*    -------------------------------
  3728     05  BLSTNML PIC S9(0004) COMP.
  3729     05  BLSTNMF PIC  X(0001).
  3730     05  FILLER REDEFINES BLSTNMF.
  3731         10  BLSTNMA PIC  X(0001).
  3732     05  BLSTNMI PIC  X(0015).
  3733*    -------------------------------
  3734     05  B1STNML PIC S9(0004) COMP.
  3735     05  B1STNMF PIC  X(0001).
  3736     05  FILLER REDEFINES B1STNMF.
  3737         10  B1STNMA PIC  X(0001).
  3738     05  B1STNMI PIC  X(0010).
  3739*    -------------------------------
  3740     05  BINITL PIC S9(0004) COMP.
  3741     05  BINITF PIC  X(0001).
  3742     05  FILLER REDEFINES BINITF.
  3743         10  BINITA PIC  X(0001).
  3744     05  BINITI PIC  X(0001).
  3745*    -------------------------------
  3746     05  BSEXL PIC S9(0004) COMP.
  3747     05  BSEXF PIC  X(0001).
  3748     05  FILLER REDEFINES BSEXF.
  3749         10  BSEXA PIC  X(0001).
  3750     05  BSEXI PIC  X(0001).
  3751*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  72
* EL6311.cbl
  3752     05  BAGEL PIC S9(0004) COMP.
  3753     05  BAGEF PIC  X(0001).
  3754     05  FILLER REDEFINES BAGEF.
  3755         10  BAGEA PIC  X(0001).
  3756     05  BAGEI PIC  X(0002).
  3757*    -------------------------------
  3758     05  BBIRTHL PIC S9(0004) COMP.
  3759     05  BBIRTHF PIC  X(0001).
  3760     05  FILLER REDEFINES BBIRTHF.
  3761         10  BBIRTHA PIC  X(0001).
  3762     05  BBIRTHI PIC  X(0008).
  3763*    -------------------------------
  3764     05  B1STPMTL PIC S9(0004) COMP.
  3765     05  B1STPMTF PIC  X(0001).
  3766     05  FILLER REDEFINES B1STPMTF.
  3767         10  B1STPMTA PIC  X(0001).
  3768     05  B1STPMTI PIC  X(0008).
  3769*    -------------------------------
  3770     05  BDAYSL PIC S9(0004) COMP.
  3771     05  BDAYSF PIC  X(0001).
  3772     05  FILLER REDEFINES BDAYSF.
  3773         10  BDAYSA PIC  X(0001).
  3774     05  BDAYSI PIC  X(0003).
  3775*    -------------------------------
  3776     05  BLNTRML PIC S9(0004) COMP.
  3777     05  BLNTRMF PIC  X(0001).
  3778     05  FILLER REDEFINES BLNTRMF.
  3779         10  BLNTRMA PIC  X(0001).
  3780     05  BLNTRMI PIC  X(0003).
  3781*    -------------------------------
  3782     05  BLNOFCRL PIC S9(0004) COMP.
  3783     05  BLNOFCRF PIC  X(0001).
  3784     05  FILLER REDEFINES BLNOFCRF.
  3785         10  BLNOFCRA PIC  X(0001).
  3786     05  BLNOFCRI PIC  X(0005).
  3787*    -------------------------------
  3788     05  BMODEL PIC S9(0004) COMP.
  3789     05  BMODEF PIC  X(0001).
  3790     05  FILLER REDEFINES BMODEF.
  3791         10  BMODEA PIC  X(0001).
  3792     05  BMODEI PIC  X(0001).
  3793*    -------------------------------
  3794     05  BFREQL PIC S9(0004) COMP.
  3795     05  BFREQF PIC  X(0001).
  3796     05  FILLER REDEFINES BFREQF.
  3797         10  BFREQA PIC  X(0001).
  3798     05  BFREQI PIC  X(0002).
  3799*    -------------------------------
  3800     05  BPMTSL PIC S9(0004) COMP.
  3801     05  BPMTSF PIC  X(0001).
  3802     05  FILLER REDEFINES BPMTSF.
  3803         10  BPMTSA PIC  X(0001).
  3804     05  BPMTSI PIC  999.
  3805*    -------------------------------
  3806     05  BPMTAMTL PIC S9(0004) COMP.
  3807     05  BPMTAMTF PIC  X(0001).
  3808     05  FILLER REDEFINES BPMTAMTF.
  3809         10  BPMTAMTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  73
* EL6311.cbl
  3810     05  BPMTAMTI PIC  9(7)V99.
  3811*    -------------------------------
  3812     05  BAPRL PIC S9(0004) COMP.
  3813     05  BAPRF PIC  X(0001).
  3814     05  FILLER REDEFINES BAPRF.
  3815         10  BAPRA PIC  X(0001).
  3816     05  BAPRI PIC  X(7).
  3817*    -------------------------------
  3818     05  BLIVESL PIC S9(0004) COMP.
  3819     05  BLIVESF PIC  X(0001).
  3820     05  FILLER REDEFINES BLIVESF.
  3821         10  BLIVESA PIC  X(0001).
  3822     05  BLIVESI PIC  X(0009).
  3823*    -------------------------------
  3824     05  BMEMCAPL PIC S9(0004) COMP.
  3825     05  BMEMCAPF PIC  X(0001).
  3826     05  FILLER REDEFINES BMEMCAPF.
  3827         10  BMEMCAPA PIC  X(0001).
  3828     05  BMEMCAPI PIC  X(0011).
  3829*    -------------------------------
  3830     05  BORIGHDL PIC S9(0004) COMP.
  3831     05  BORIGHDF PIC  X(0001).
  3832     05  FILLER REDEFINES BORIGHDF.
  3833         10  BORIGHDA PIC  X(0001).
  3834     05  BORIGHDI PIC  X(0009).
  3835*    -------------------------------
  3836     05  DMDBILL PIC S9(0004) COMP.
  3837     05  DMDBILF PIC  X(0001).
  3838     05  FILLER REDEFINES DMDBILF.
  3839         10  DMDBILA PIC  X(0001).
  3840     05  DMDBILI PIC  X(0006).
  3841*    -------------------------------
  3842     05  BFORCEL PIC S9(0004) COMP.
  3843     05  BFORCEF PIC  X(0001).
  3844     05  FILLER REDEFINES BFORCEF.
  3845         10  BFORCEA PIC  X(0001).
  3846     05  BFORCEI PIC  X(0001).
  3847*    -------------------------------
  3848     05  BENTRYL PIC S9(0004) COMP.
  3849     05  BENTRYF PIC  X(0001).
  3850     05  FILLER REDEFINES BENTRYF.
  3851         10  BENTRYA PIC  X(0001).
  3852     05  BENTRYI PIC  X(0001).
  3853*    -------------------------------
  3854     05  BREINL PIC S9(0004) COMP.
  3855     05  BREINF PIC  X(0001).
  3856     05  FILLER REDEFINES BREINF.
  3857         10  BREINA PIC  X(0001).
  3858     05  BREINI PIC  X(0001).
  3859*    -------------------------------
  3860     05  BBILCDL PIC S9(0004) COMP.
  3861     05  BBILCDF PIC  X(0001).
  3862     05  FILLER REDEFINES BBILCDF.
  3863         10  BBILCDA PIC  X(0001).
  3864     05  BBILCDI PIC  X(0001).
  3865*    -------------------------------
  3866     05  BUNWRITL PIC S9(0004) COMP.
  3867     05  BUNWRITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  74
* EL6311.cbl
  3868     05  FILLER REDEFINES BUNWRITF.
  3869         10  BUNWRITA PIC  X(0001).
  3870     05  BUNWRITI PIC  X(0001).
  3871*    -------------------------------
  3872     05  BSKPCDL PIC S9(0004) COMP.
  3873     05  BSKPCDF PIC  X(0001).
  3874     05  FILLER REDEFINES BSKPCDF.
  3875         10  BSKPCDA PIC  X(0001).
  3876     05  BSKPCDI PIC  X(0001).
  3877*    -------------------------------
  3878     05  BINDGRPL PIC S9(0004) COMP.
  3879     05  BINDGRPF PIC  X(0001).
  3880     05  FILLER REDEFINES BINDGRPF.
  3881         10  BINDGRPA PIC  X(0001).
  3882     05  BINDGRPI PIC  X(0001).
  3883*    -------------------------------
  3884     05  BSIGL PIC S9(0004) COMP.
  3885     05  BSIGF PIC  X(0001).
  3886     05  FILLER REDEFINES BSIGF.
  3887         10  BSIGA PIC  X(0001).
  3888     05  BSIGI PIC  X(0001).
  3889*    -------------------------------
  3890     05  BRTCLSL PIC S9(0004) COMP.
  3891     05  BRTCLSF PIC  X(0001).
  3892     05  FILLER REDEFINES BRTCLSF.
  3893         10  BRTCLSA PIC  X(0001).
  3894     05  BRTCLSI PIC  X(0002).
  3895*    -------------------------------
  3896     05  BCHGCNTL PIC S9(0004) COMP.
  3897     05  BCHGCNTF PIC  X(0001).
  3898     05  FILLER REDEFINES BCHGCNTF.
  3899         10  BCHGCNTA PIC  X(0001).
  3900     05  BCHGCNTI PIC  X(0003).
  3901*    -------------------------------
  3902     05  BMEMBERL PIC S9(0004) COMP.
  3903     05  BMEMBERF PIC  X(0001).
  3904     05  FILLER REDEFINES BMEMBERF.
  3905         10  BMEMBERA PIC  X(0001).
  3906     05  BMEMBERI PIC  X(0012).
  3907*    -------------------------------
  3908     05  BORGNOL PIC S9(0004) COMP.
  3909     05  BORGNOF PIC  X(0001).
  3910     05  FILLER REDEFINES BORGNOF.
  3911         10  BORGNOA PIC  X(0001).
  3912     05  BORGNOI PIC  X(0006).
  3913*    -------------------------------
  3914     05  BORGSEQL PIC S9(0004) COMP.
  3915     05  BORGSEQF PIC  X(0001).
  3916     05  FILLER REDEFINES BORGSEQF.
  3917         10  BORGSEQA PIC  X(0001).
  3918     05  BORGSEQI PIC  X(0004).
  3919*    -------------------------------
  3920     05  BBILLEDL PIC S9(0004) COMP.
  3921     05  BBILLEDF PIC  X(0001).
  3922     05  FILLER REDEFINES BBILLEDF.
  3923         10  BBILLEDA PIC  X(0001).
  3924     05  BBILLEDI PIC  9(9).
  3925*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  75
* EL6311.cbl
  3926     05  BKIND1L PIC S9(0004) COMP.
  3927     05  BKIND1F PIC  X(0001).
  3928     05  FILLER REDEFINES BKIND1F.
  3929         10  BKIND1A PIC  X(0001).
  3930     05  BKIND1I PIC  X(0002).
  3931*    -------------------------------
  3932     05  BTYPE1L PIC S9(0004) COMP.
  3933     05  BTYPE1F PIC  X(0001).
  3934     05  FILLER REDEFINES BTYPE1F.
  3935         10  BTYPE1A PIC  X(0001).
  3936     05  BTYPE1I PIC  X(0003).
  3937*    -------------------------------
  3938     05  BTERM1L PIC S9(0004) COMP.
  3939     05  BTERM1F PIC  X(0001).
  3940     05  FILLER REDEFINES BTERM1F.
  3941         10  BTERM1A PIC  X(0001).
  3942     05  BTERM1I PIC  X(0003).
  3943*    -------------------------------
  3944     05  BBEN1L PIC S9(0004) COMP.
  3945     05  BBEN1F PIC  X(0001).
  3946     05  FILLER REDEFINES BBEN1F.
  3947         10  BBEN1A PIC  X(0001).
  3948     05  BBEN1I PIC  X(0012).
  3949*    -------------------------------
  3950     05  BPREM1L PIC S9(0004) COMP.
  3951     05  BPREM1F PIC  X(0001).
  3952     05  FILLER REDEFINES BPREM1F.
  3953         10  BPREM1A PIC  X(0001).
  3954     05  BPREM1I PIC  X(0011).
  3955*    -------------------------------
  3956     05  BEXPIR1L PIC S9(0004) COMP.
  3957     05  BEXPIR1F PIC  X(0001).
  3958     05  FILLER REDEFINES BEXPIR1F.
  3959         10  BEXPIR1A PIC  X(0001).
  3960     05  BEXPIR1I PIC  X(0008).
  3961*    -------------------------------
  3962     05  BCP1L PIC S9(0004) COMP.
  3963     05  BCP1F PIC  X(0001).
  3964     05  FILLER REDEFINES BCP1F.
  3965         10  BCP1A PIC  X(0001).
  3966     05  BCP1I PIC  X(0002).
  3967*    -------------------------------
  3968     05  BALTBN1L PIC S9(0004) COMP.
  3969     05  BALTBN1F PIC  X(0001).
  3970     05  FILLER REDEFINES BALTBN1F.
  3971         10  BALTBN1A PIC  X(0001).
  3972     05  BALTBN1I PIC  X(0012).
  3973*    -------------------------------
  3974     05  BALTPR1L PIC S9(0004) COMP.
  3975     05  BALTPR1F PIC  X(0001).
  3976     05  FILLER REDEFINES BALTPR1F.
  3977         10  BALTPR1A PIC  X(0001).
  3978     05  BALTPR1I PIC  X(0011).
  3979*    -------------------------------
  3980     05  BBNCD1L PIC S9(0004) COMP.
  3981     05  BBNCD1F PIC  X(0001).
  3982     05  FILLER REDEFINES BBNCD1F.
  3983         10  BBNCD1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  76
* EL6311.cbl
  3984     05  BBNCD1I PIC  X(0003).
  3985*    -------------------------------
  3986     05  BCPRM1L PIC S9(0004) COMP.
  3987     05  BCPRM1F PIC  X(0001).
  3988     05  FILLER REDEFINES BCPRM1F.
  3989         10  BCPRM1A PIC  X(0001).
  3990     05  BCPRM1I PIC  X(0011).
  3991*    -------------------------------
  3992     05  BCAPRM1L PIC S9(0004) COMP.
  3993     05  BCAPRM1F PIC  X(0001).
  3994     05  FILLER REDEFINES BCAPRM1F.
  3995         10  BCAPRM1A PIC  X(0001).
  3996     05  BCAPRM1I PIC  X(0011).
  3997*    -------------------------------
  3998     05  BENABR1L PIC S9(0004) COMP.
  3999     05  BENABR1F PIC  X(0001).
  4000     05  FILLER REDEFINES BENABR1F.
  4001         10  BENABR1A PIC  X(0001).
  4002     05  BENABR1I PIC  X(0005).
  4003*    -------------------------------
  4004     05  BDIFF1L PIC S9(0004) COMP.
  4005     05  BDIFF1F PIC  X(0001).
  4006     05  FILLER REDEFINES BDIFF1F.
  4007         10  BDIFF1A PIC  X(0001).
  4008     05  BDIFF1I PIC  X(0011).
  4009*    -------------------------------
  4010     05  BBILIT1L PIC S9(0004) COMP.
  4011     05  BBILIT1F PIC  X(0001).
  4012     05  FILLER REDEFINES BBILIT1F.
  4013         10  BBILIT1A PIC  X(0001).
  4014     05  BBILIT1I PIC  X(0008).
  4015*    -------------------------------
  4016     05  BADIFF1L PIC S9(0004) COMP.
  4017     05  BADIFF1F PIC  X(0001).
  4018     05  FILLER REDEFINES BADIFF1F.
  4019         10  BADIFF1A PIC  X(0001).
  4020     05  BADIFF1I PIC  X(0011).
  4021*    -------------------------------
  4022     05  BKIND2L PIC S9(0004) COMP.
  4023     05  BKIND2F PIC  X(0001).
  4024     05  FILLER REDEFINES BKIND2F.
  4025         10  BKIND2A PIC  X(0001).
  4026     05  BKIND2I PIC  X(0002).
  4027*    -------------------------------
  4028     05  BTYPE2L PIC S9(0004) COMP.
  4029     05  BTYPE2F PIC  X(0001).
  4030     05  FILLER REDEFINES BTYPE2F.
  4031         10  BTYPE2A PIC  X(0001).
  4032     05  BTYPE2I PIC  X(0003).
  4033*    -------------------------------
  4034     05  BTERM2L PIC S9(0004) COMP.
  4035     05  BTERM2F PIC  X(0001).
  4036     05  FILLER REDEFINES BTERM2F.
  4037         10  BTERM2A PIC  X(0001).
  4038     05  BTERM2I PIC  X(0003).
  4039*    -------------------------------
  4040     05  BBEN2L PIC S9(0004) COMP.
  4041     05  BBEN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  77
* EL6311.cbl
  4042     05  FILLER REDEFINES BBEN2F.
  4043         10  BBEN2A PIC  X(0001).
  4044     05  BBEN2I PIC  X(0012).
  4045*    -------------------------------
  4046     05  BPREM2L PIC S9(0004) COMP.
  4047     05  BPREM2F PIC  X(0001).
  4048     05  FILLER REDEFINES BPREM2F.
  4049         10  BPREM2A PIC  X(0001).
  4050     05  BPREM2I PIC  X(0011).
  4051*    -------------------------------
  4052     05  BEXPIR2L PIC S9(0004) COMP.
  4053     05  BEXPIR2F PIC  X(0001).
  4054     05  FILLER REDEFINES BEXPIR2F.
  4055         10  BEXPIR2A PIC  X(0001).
  4056     05  BEXPIR2I PIC  X(0008).
  4057*    -------------------------------
  4058     05  BCP2L PIC S9(0004) COMP.
  4059     05  BCP2F PIC  X(0001).
  4060     05  FILLER REDEFINES BCP2F.
  4061         10  BCP2A PIC  X(0001).
  4062     05  BCP2I PIC  X(0002).
  4063*    -------------------------------
  4064     05  BALTBN2L PIC S9(0004) COMP.
  4065     05  BALTBN2F PIC  X(0001).
  4066     05  FILLER REDEFINES BALTBN2F.
  4067         10  BALTBN2A PIC  X(0001).
  4068     05  BALTBN2I PIC  X(0012).
  4069*    -------------------------------
  4070     05  BALTPR2L PIC S9(0004) COMP.
  4071     05  BALTPR2F PIC  X(0001).
  4072     05  FILLER REDEFINES BALTPR2F.
  4073         10  BALTPR2A PIC  X(0001).
  4074     05  BALTPR2I PIC  X(0011).
  4075*    -------------------------------
  4076     05  BBNCD2L PIC S9(0004) COMP.
  4077     05  BBNCD2F PIC  X(0001).
  4078     05  FILLER REDEFINES BBNCD2F.
  4079         10  BBNCD2A PIC  X(0001).
  4080     05  BBNCD2I PIC  X(0003).
  4081*    -------------------------------
  4082     05  BCPRM2L PIC S9(0004) COMP.
  4083     05  BCPRM2F PIC  X(0001).
  4084     05  FILLER REDEFINES BCPRM2F.
  4085         10  BCPRM2A PIC  X(0001).
  4086     05  BCPRM2I PIC  X(0011).
  4087*    -------------------------------
  4088     05  BCAPRM2L PIC S9(0004) COMP.
  4089     05  BCAPRM2F PIC  X(0001).
  4090     05  FILLER REDEFINES BCAPRM2F.
  4091         10  BCAPRM2A PIC  X(0001).
  4092     05  BCAPRM2I PIC  X(0011).
  4093*    -------------------------------
  4094     05  BENABR2L PIC S9(0004) COMP.
  4095     05  BENABR2F PIC  X(0001).
  4096     05  FILLER REDEFINES BENABR2F.
  4097         10  BENABR2A PIC  X(0001).
  4098     05  BENABR2I PIC  X(0005).
  4099*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  78
* EL6311.cbl
  4100     05  BDIFF2L PIC S9(0004) COMP.
  4101     05  BDIFF2F PIC  X(0001).
  4102     05  FILLER REDEFINES BDIFF2F.
  4103         10  BDIFF2A PIC  X(0001).
  4104     05  BDIFF2I PIC  X(0011).
  4105*    -------------------------------
  4106     05  BBILIT2L PIC S9(0004) COMP.
  4107     05  BBILIT2F PIC  X(0001).
  4108     05  FILLER REDEFINES BBILIT2F.
  4109         10  BBILIT2A PIC  X(0001).
  4110     05  BBILIT2I PIC  X(0008).
  4111*    -------------------------------
  4112     05  BADIFF2L PIC S9(0004) COMP.
  4113     05  BADIFF2F PIC  X(0001).
  4114     05  FILLER REDEFINES BADIFF2F.
  4115         10  BADIFF2A PIC  X(0001).
  4116     05  BADIFF2I PIC  X(0011).
  4117*    -------------------------------
  4118     05  BERMSG1L PIC S9(0004) COMP.
  4119     05  BERMSG1F PIC  X(0001).
  4120     05  FILLER REDEFINES BERMSG1F.
  4121         10  BERMSG1A PIC  X(0001).
  4122     05  BERMSG1I PIC  X(0078).
  4123*    -------------------------------
  4124     05  BERMSG2L PIC S9(0004) COMP.
  4125     05  BERMSG2F PIC  X(0001).
  4126     05  FILLER REDEFINES BERMSG2F.
  4127         10  BERMSG2A PIC  X(0001).
  4128     05  BERMSG2I PIC  X(0078).
  4129*    -------------------------------
  4130     05  BERMSG3L PIC S9(0004) COMP.
  4131     05  BERMSG3F PIC  X(0001).
  4132     05  FILLER REDEFINES BERMSG3F.
  4133         10  BERMSG3A PIC  X(0001).
  4134     05  BERMSG3I PIC  X(0078).
  4135*    -------------------------------
  4136     05  BPFENTRL PIC S9(0004) COMP.
  4137     05  BPFENTRF PIC  X(0001).
  4138     05  FILLER REDEFINES BPFENTRF.
  4139         10  BPFENTRA PIC  X(0001).
  4140     05  BPFENTRI PIC  9(2).
  4141*    -------------------------------
  4142     05  BPF5HDRL PIC S9(0004) COMP.
  4143     05  BPF5HDRF PIC  X(0001).
  4144     05  FILLER REDEFINES BPF5HDRF.
  4145         10  BPF5HDRA PIC  X(0001).
  4146     05  BPF5HDRI PIC  X(0005).
  4147*    -------------------------------
  4148     05  BPF4HDRL PIC S9(0004) COMP.
  4149     05  BPF4HDRF PIC  X(0001).
  4150     05  FILLER REDEFINES BPF4HDRF.
  4151         10  BPF4HDRA PIC  X(0001).
  4152     05  BPF4HDRI PIC  X(0013).
  4153*    -------------------------------
  4154     05  BF15HDRL PIC S9(0004) COMP.
  4155     05  BF15HDRF PIC  X(0001).
  4156     05  FILLER REDEFINES BF15HDRF.
  4157         10  BF15HDRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  79
* EL6311.cbl
  4158     05  BF15HDRI PIC  X(0010).
  4159 01  EL631BO REDEFINES EL631BI.
  4160     05  FILLER            PIC  X(0012).
  4161*    -------------------------------
  4162     05  FILLER            PIC  X(0003).
  4163     05  BDATEO PIC  X(0008).
  4164*    -------------------------------
  4165     05  FILLER            PIC  X(0003).
  4166     05  BTIMEO PIC  99.99.
  4167*    -------------------------------
  4168     05  FILLER            PIC  X(0003).
  4169     05  BHEADO PIC  X(0038).
  4170*    -------------------------------
  4171     05  FILLER            PIC  X(0003).
  4172     05  BNCERTLO PIC  X(0008).
  4173*    -------------------------------
  4174     05  FILLER            PIC  X(0003).
  4175     05  BNCERTO PIC  X(0011).
  4176*    -------------------------------
  4177     05  FILLER            PIC  X(0003).
  4178     05  BNSTATLO PIC  X(0009).
  4179*    -------------------------------
  4180     05  FILLER            PIC  X(0003).
  4181     05  BNSTATO PIC  X(0002).
  4182*    -------------------------------
  4183     05  FILLER            PIC  X(0003).
  4184     05  BCHGTO PIC  X(0004).
  4185*    -------------------------------
  4186     05  FILLER            PIC  X(0003).
  4187     05  BCHGO PIC  ZZZ9.
  4188*    -------------------------------
  4189     05  FILLER            PIC  X(0003).
  4190     05  BCOMPIDO PIC  X(0003).
  4191*    -------------------------------
  4192     05  FILLER            PIC  X(0003).
  4193     05  BREGIONO PIC  X(0006).
  4194*    -------------------------------
  4195     05  FILLER            PIC  X(0003).
  4196     05  BUSERO PIC  X(0004).
  4197*    -------------------------------
  4198     05  FILLER            PIC  X(0003).
  4199     05  BMAINTO PIC  X(0001).
  4200*    -------------------------------
  4201     05  FILLER            PIC  X(0003).
  4202     05  BMANTBYO PIC  X(0004).
  4203*    -------------------------------
  4204     05  FILLER            PIC  X(0003).
  4205     05  BCHGHDGO PIC  X(0003).
  4206*    -------------------------------
  4207     05  FILLER            PIC  X(0003).
  4208     05  BMANTDTO PIC  X(0008).
  4209*    -------------------------------
  4210     05  FILLER            PIC  X(0003).
  4211     05  BMANTATO PIC  99.99.
  4212*    -------------------------------
  4213     05  FILLER            PIC  X(0003).
  4214     05  BCSRO PIC  X(0004).
  4215*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  80
* EL6311.cbl
  4216     05  FILLER            PIC  X(0003).
  4217     05  BBATCHO PIC  X(0006).
  4218*    -------------------------------
  4219     05  FILLER            PIC  X(0003).
  4220     05  BSEQO PIC  X(0004).
  4221*    -------------------------------
  4222     05  FILLER            PIC  X(0003).
  4223     05  BMOENDTO PIC  X(0008).
  4224*    -------------------------------
  4225     05  FILLER            PIC  X(0003).
  4226     05  BCARRO PIC  X(0001).
  4227*    -------------------------------
  4228     05  FILLER            PIC  X(0003).
  4229     05  BGROUPO PIC  X(0006).
  4230*    -------------------------------
  4231     05  FILLER            PIC  X(0003).
  4232     05  BSTATEO PIC  X(0002).
  4233*    -------------------------------
  4234     05  FILLER            PIC  X(0003).
  4235     05  BACCTO PIC  X(0010).
  4236*    -------------------------------
  4237     05  FILLER            PIC  X(0003).
  4238     05  BVINHO PIC  X(0004).
  4239*    -------------------------------
  4240     05  FILLER            PIC  X(0003).
  4241     05  BVINO PIC  X(0017).
  4242*    -------------------------------
  4243     05  FILLER            PIC  X(0003).
  4244     05  BREFHDGO PIC  X(0004).
  4245*    -------------------------------
  4246     05  FILLER            PIC  X(0003).
  4247     05  BREFO PIC  X(0012).
  4248*    -------------------------------
  4249     05  FILLER            PIC  X(0003).
  4250     05  LETRREQO PIC  X(0001).
  4251*    -------------------------------
  4252     05  FILLER            PIC  X(0003).
  4253     05  BAGEDEFO PIC  X(0004).
  4254*    -------------------------------
  4255     05  FILLER            PIC  X(0003).
  4256     05  BCERTNOO PIC  X(0010).
  4257*    -------------------------------
  4258     05  FILLER            PIC  X(0003).
  4259     05  BSUFIXO PIC  X(0001).
  4260*    -------------------------------
  4261     05  FILLER            PIC  X(0003).
  4262     05  BEFFDTO PIC  X(0008).
  4263*    -------------------------------
  4264     05  FILLER            PIC  X(0003).
  4265     05  BLSTNMO PIC  X(0015).
  4266*    -------------------------------
  4267     05  FILLER            PIC  X(0003).
  4268     05  B1STNMO PIC  X(0010).
  4269*    -------------------------------
  4270     05  FILLER            PIC  X(0003).
  4271     05  BINITO PIC  X(0001).
  4272*    -------------------------------
  4273     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  81
* EL6311.cbl
  4274     05  BSEXO PIC  X(0001).
  4275*    -------------------------------
  4276     05  FILLER            PIC  X(0003).
  4277     05  BAGEO PIC  X(0002).
  4278*    -------------------------------
  4279     05  FILLER            PIC  X(0003).
  4280     05  BBIRTHO PIC  X(0008).
  4281*    -------------------------------
  4282     05  FILLER            PIC  X(0003).
  4283     05  B1STPMTO PIC  X(0008).
  4284*    -------------------------------
  4285     05  FILLER            PIC  X(0003).
  4286     05  BDAYSO PIC  X(0003).
  4287*    -------------------------------
  4288     05  FILLER            PIC  X(0003).
  4289     05  BLNTRMO PIC  X(0003).
  4290*    -------------------------------
  4291     05  FILLER            PIC  X(0003).
  4292     05  BLNOFCRO PIC  X(0005).
  4293*    -------------------------------
  4294     05  FILLER            PIC  X(0003).
  4295     05  BMODEO PIC  X(0001).
  4296*    -------------------------------
  4297     05  FILLER            PIC  X(0003).
  4298     05  BFREQO PIC  X(0002).
  4299*    -------------------------------
  4300     05  FILLER            PIC  X(0003).
  4301     05  BPMTSO PIC  X(0003).
  4302*    -------------------------------
  4303     05  FILLER            PIC  X(0003).
  4304     05  BPMTAMTO PIC  ZZZZZ9.99.
  4305*    -------------------------------
  4306     05  FILLER            PIC  X(0003).
  4307     05  BAPRO PIC  99.9999.
  4308*    -------------------------------
  4309     05  FILLER            PIC  X(0003).
  4310     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4311*    -------------------------------
  4312     05  FILLER            PIC  X(0003).
  4313     05  BMEMCAPO PIC  X(0011).
  4314*    -------------------------------
  4315     05  FILLER            PIC  X(0003).
  4316     05  BORIGHDO PIC  X(0009).
  4317*    -------------------------------
  4318     05  FILLER            PIC  X(0003).
  4319     05  DMDBILO PIC  X(0006).
  4320*    -------------------------------
  4321     05  FILLER            PIC  X(0003).
  4322     05  BFORCEO PIC  X(0001).
  4323*    -------------------------------
  4324     05  FILLER            PIC  X(0003).
  4325     05  BENTRYO PIC  X(0001).
  4326*    -------------------------------
  4327     05  FILLER            PIC  X(0003).
  4328     05  BREINO PIC  X(0001).
  4329*    -------------------------------
  4330     05  FILLER            PIC  X(0003).
  4331     05  BBILCDO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  82
* EL6311.cbl
  4332*    -------------------------------
  4333     05  FILLER            PIC  X(0003).
  4334     05  BUNWRITO PIC  X(0001).
  4335*    -------------------------------
  4336     05  FILLER            PIC  X(0003).
  4337     05  BSKPCDO PIC  X(0001).
  4338*    -------------------------------
  4339     05  FILLER            PIC  X(0003).
  4340     05  BINDGRPO PIC  X(0001).
  4341*    -------------------------------
  4342     05  FILLER            PIC  X(0003).
  4343     05  BSIGO PIC  X(0001).
  4344*    -------------------------------
  4345     05  FILLER            PIC  X(0003).
  4346     05  BRTCLSO PIC  X(0002).
  4347*    -------------------------------
  4348     05  FILLER            PIC  X(0003).
  4349     05  BCHGCNTO PIC  X(0003).
  4350*    -------------------------------
  4351     05  FILLER            PIC  X(0003).
  4352     05  BMEMBERO PIC  X(0012).
  4353*    -------------------------------
  4354     05  FILLER            PIC  X(0003).
  4355     05  BORGNOO PIC  X(0006).
  4356*    -------------------------------
  4357     05  FILLER            PIC  X(0003).
  4358     05  BORGSEQO PIC  X(0004).
  4359*    -------------------------------
  4360     05  FILLER            PIC  X(0003).
  4361     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4362*    -------------------------------
  4363     05  FILLER            PIC  X(0003).
  4364     05  BKIND1O PIC  X(0002).
  4365*    -------------------------------
  4366     05  FILLER            PIC  X(0003).
  4367     05  BTYPE1O PIC  X(0003).
  4368*    -------------------------------
  4369     05  FILLER            PIC  X(0003).
  4370     05  BTERM1O PIC  X(0003).
  4371*    -------------------------------
  4372     05  FILLER            PIC  X(0003).
  4373     05  BBEN1O PIC  X(0012).
  4374*    -------------------------------
  4375     05  FILLER            PIC  X(0003).
  4376     05  BPREM1O PIC  X(0011).
  4377*    -------------------------------
  4378     05  FILLER            PIC  X(0003).
  4379     05  BEXPIR1O PIC  X(0008).
  4380*    -------------------------------
  4381     05  FILLER            PIC  X(0003).
  4382     05  BCP1O PIC  X(0002).
  4383*    -------------------------------
  4384     05  FILLER            PIC  X(0003).
  4385     05  BALTBN1O PIC  X(0012).
  4386*    -------------------------------
  4387     05  FILLER            PIC  X(0003).
  4388     05  BALTPR1O PIC  X(0011).
  4389*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  83
* EL6311.cbl
  4390     05  FILLER            PIC  X(0003).
  4391     05  BBNCD1O PIC  X(0003).
  4392*    -------------------------------
  4393     05  FILLER            PIC  X(0003).
  4394     05  BCPRM1O PIC  X(0011).
  4395*    -------------------------------
  4396     05  FILLER            PIC  X(0003).
  4397     05  BCAPRM1O PIC  X(0011).
  4398*    -------------------------------
  4399     05  FILLER            PIC  X(0003).
  4400     05  BENABR1O PIC  X(0005).
  4401*    -------------------------------
  4402     05  FILLER            PIC  X(0003).
  4403     05  BDIFF1O PIC  X(0011).
  4404*    -------------------------------
  4405     05  FILLER            PIC  X(0003).
  4406     05  BBILIT1O PIC  X(0008).
  4407*    -------------------------------
  4408     05  FILLER            PIC  X(0003).
  4409     05  BADIFF1O PIC  X(0011).
  4410*    -------------------------------
  4411     05  FILLER            PIC  X(0003).
  4412     05  BKIND2O PIC  X(0002).
  4413*    -------------------------------
  4414     05  FILLER            PIC  X(0003).
  4415     05  BTYPE2O PIC  X(0003).
  4416*    -------------------------------
  4417     05  FILLER            PIC  X(0003).
  4418     05  BTERM2O PIC  X(0003).
  4419*    -------------------------------
  4420     05  FILLER            PIC  X(0003).
  4421     05  BBEN2O PIC  X(0012).
  4422*    -------------------------------
  4423     05  FILLER            PIC  X(0003).
  4424     05  BPREM2O PIC  X(0011).
  4425*    -------------------------------
  4426     05  FILLER            PIC  X(0003).
  4427     05  BEXPIR2O PIC  X(0008).
  4428*    -------------------------------
  4429     05  FILLER            PIC  X(0003).
  4430     05  BCP2O PIC  X(0002).
  4431*    -------------------------------
  4432     05  FILLER            PIC  X(0003).
  4433     05  BALTBN2O PIC  X(0012).
  4434*    -------------------------------
  4435     05  FILLER            PIC  X(0003).
  4436     05  BALTPR2O PIC  X(0011).
  4437*    -------------------------------
  4438     05  FILLER            PIC  X(0003).
  4439     05  BBNCD2O PIC  X(0003).
  4440*    -------------------------------
  4441     05  FILLER            PIC  X(0003).
  4442     05  BCPRM2O PIC  X(0011).
  4443*    -------------------------------
  4444     05  FILLER            PIC  X(0003).
  4445     05  BCAPRM2O PIC  X(0011).
  4446*    -------------------------------
  4447     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  84
* EL6311.cbl
  4448     05  BENABR2O PIC  X(0005).
  4449*    -------------------------------
  4450     05  FILLER            PIC  X(0003).
  4451     05  BDIFF2O PIC  X(0011).
  4452*    -------------------------------
  4453     05  FILLER            PIC  X(0003).
  4454     05  BBILIT2O PIC  X(0008).
  4455*    -------------------------------
  4456     05  FILLER            PIC  X(0003).
  4457     05  BADIFF2O PIC  X(0011).
  4458*    -------------------------------
  4459     05  FILLER            PIC  X(0003).
  4460     05  BERMSG1O PIC  X(0078).
  4461*    -------------------------------
  4462     05  FILLER            PIC  X(0003).
  4463     05  BERMSG2O PIC  X(0078).
  4464*    -------------------------------
  4465     05  FILLER            PIC  X(0003).
  4466     05  BERMSG3O PIC  X(0078).
  4467*    -------------------------------
  4468     05  FILLER            PIC  X(0003).
  4469     05  BPFENTRO PIC  X(0002).
  4470*    -------------------------------
  4471     05  FILLER            PIC  X(0003).
  4472     05  BPF5HDRO PIC  X(0005).
  4473*    -------------------------------
  4474     05  FILLER            PIC  X(0003).
  4475     05  BPF4HDRO PIC  X(0013).
  4476*    -------------------------------
  4477     05  FILLER            PIC  X(0003).
  4478     05  BF15HDRO PIC  X(0010).
  4479*    -------------------------------
  4480 01  EL631CI REDEFINES EL631BI.
  4481     05  FILLER            PIC  X(0012).
  4482*    -------------------------------
  4483     05  CDATEL PIC S9(0004) COMP.
  4484     05  CDATEF PIC  X(0001).
  4485     05  FILLER REDEFINES CDATEF.
  4486         10  CDATEA PIC  X(0001).
  4487     05  CDATEI PIC  X(0008).
  4488*    -------------------------------
  4489     05  CTIMEL PIC S9(0004) COMP.
  4490     05  CTIMEF PIC  X(0001).
  4491     05  FILLER REDEFINES CTIMEF.
  4492         10  CTIMEA PIC  X(0001).
  4493     05  CTIMEI PIC  X(0005).
  4494*    -------------------------------
  4495     05  CHEADL PIC S9(0004) COMP.
  4496     05  CHEADF PIC  X(0001).
  4497     05  FILLER REDEFINES CHEADF.
  4498         10  CHEADA PIC  X(0001).
  4499     05  CHEADI PIC  X(0038).
  4500*    -------------------------------
  4501     05  CCHGTL PIC S9(0004) COMP.
  4502     05  CCHGTF PIC  X(0001).
  4503     05  FILLER REDEFINES CCHGTF.
  4504         10  CCHGTA PIC  X(0001).
  4505     05  CCHGTI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  85
* EL6311.cbl
  4506*    -------------------------------
  4507     05  CCHGL PIC S9(0004) COMP.
  4508     05  CCHGF PIC  X(0001).
  4509     05  FILLER REDEFINES CCHGF.
  4510         10  CCHGA PIC  X(0001).
  4511     05  CCHGI PIC  X(0004).
  4512*    -------------------------------
  4513     05  CMAINTL PIC S9(0004) COMP.
  4514     05  CMAINTF PIC  X(0001).
  4515     05  FILLER REDEFINES CMAINTF.
  4516         10  CMAINTA PIC  X(0001).
  4517     05  CMAINTI PIC  X(0001).
  4518*    -------------------------------
  4519     05  CMANTBYL PIC S9(0004) COMP.
  4520     05  CMANTBYF PIC  X(0001).
  4521     05  FILLER REDEFINES CMANTBYF.
  4522         10  CMANTBYA PIC  X(0001).
  4523     05  CMANTBYI PIC  X(0004).
  4524*    -------------------------------
  4525     05  CCHGHDGL PIC S9(0004) COMP.
  4526     05  CCHGHDGF PIC  X(0001).
  4527     05  FILLER REDEFINES CCHGHDGF.
  4528         10  CCHGHDGA PIC  X(0001).
  4529     05  CCHGHDGI PIC  X(0003).
  4530*    -------------------------------
  4531     05  CMANTDTL PIC S9(0004) COMP.
  4532     05  CMANTDTF PIC  X(0001).
  4533     05  FILLER REDEFINES CMANTDTF.
  4534         10  CMANTDTA PIC  X(0001).
  4535     05  CMANTDTI PIC  X(0008).
  4536*    -------------------------------
  4537     05  CMANTATL PIC S9(0004) COMP.
  4538     05  CMANTATF PIC  X(0001).
  4539     05  FILLER REDEFINES CMANTATF.
  4540         10  CMANTATA PIC  X(0001).
  4541     05  CMANTATI PIC  X(0005).
  4542*    -------------------------------
  4543     05  CCSRL PIC S9(0004) COMP.
  4544     05  CCSRF PIC  X(0001).
  4545     05  FILLER REDEFINES CCSRF.
  4546         10  CCSRA PIC  X(0001).
  4547     05  CCSRI PIC  X(0004).
  4548*    -------------------------------
  4549     05  CBATCHL PIC S9(0004) COMP.
  4550     05  CBATCHF PIC  X(0001).
  4551     05  FILLER REDEFINES CBATCHF.
  4552         10  CBATCHA PIC  X(0001).
  4553     05  CBATCHI PIC  X(0006).
  4554*    -------------------------------
  4555     05  CSEQL PIC S9(0004) COMP.
  4556     05  CSEQF PIC  X(0001).
  4557     05  FILLER REDEFINES CSEQF.
  4558         10  CSEQA PIC  X(0001).
  4559     05  CSEQI PIC  X(0004).
  4560*    -------------------------------
  4561     05  CMOENDTL PIC S9(0004) COMP.
  4562     05  CMOENDTF PIC  X(0001).
  4563     05  FILLER REDEFINES CMOENDTF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  86
* EL6311.cbl
  4564         10  CMOENDTA PIC  X(0001).
  4565     05  CMOENDTI PIC  X(0008).
  4566*    -------------------------------
  4567     05  CCARRL PIC S9(0004) COMP.
  4568     05  CCARRF PIC  X(0001).
  4569     05  FILLER REDEFINES CCARRF.
  4570         10  CCARRA PIC  X(0001).
  4571     05  CCARRI PIC  X(0001).
  4572*    -------------------------------
  4573     05  CGROUPL PIC S9(0004) COMP.
  4574     05  CGROUPF PIC  X(0001).
  4575     05  FILLER REDEFINES CGROUPF.
  4576         10  CGROUPA PIC  X(0001).
  4577     05  CGROUPI PIC  X(0006).
  4578*    -------------------------------
  4579     05  CSTATEL PIC S9(0004) COMP.
  4580     05  CSTATEF PIC  X(0001).
  4581     05  FILLER REDEFINES CSTATEF.
  4582         10  CSTATEA PIC  X(0001).
  4583     05  CSTATEI PIC  X(0002).
  4584*    -------------------------------
  4585     05  CACCTL PIC S9(0004) COMP.
  4586     05  CACCTF PIC  X(0001).
  4587     05  FILLER REDEFINES CACCTF.
  4588         10  CACCTA PIC  X(0001).
  4589     05  CACCTI PIC  X(0010).
  4590*    -------------------------------
  4591     05  CORIGHDL PIC S9(0004) COMP.
  4592     05  CORIGHDF PIC  X(0001).
  4593     05  FILLER REDEFINES CORIGHDF.
  4594         10  CORIGHDA PIC  X(0001).
  4595     05  CORIGHDI PIC  X(0011).
  4596*    -------------------------------
  4597     05  CORGNOL PIC S9(0004) COMP.
  4598     05  CORGNOF PIC  X(0001).
  4599     05  FILLER REDEFINES CORGNOF.
  4600         10  CORGNOA PIC  X(0001).
  4601     05  CORGNOI PIC  X(0006).
  4602*    -------------------------------
  4603     05  CORGSEQL PIC S9(0004) COMP.
  4604     05  CORGSEQF PIC  X(0001).
  4605     05  FILLER REDEFINES CORGSEQF.
  4606         10  CORGSEQA PIC  X(0001).
  4607     05  CORGSEQI PIC  X(0004).
  4608*    -------------------------------
  4609     05  CREFHDGL PIC S9(0004) COMP.
  4610     05  CREFHDGF PIC  X(0001).
  4611     05  FILLER REDEFINES CREFHDGF.
  4612         10  CREFHDGA PIC  X(0001).
  4613     05  CREFHDGI PIC  X(0010).
  4614*    -------------------------------
  4615     05  CREFL PIC S9(0004) COMP.
  4616     05  CREFF PIC  X(0001).
  4617     05  FILLER REDEFINES CREFF.
  4618         10  CREFA PIC  X(0001).
  4619     05  CREFI PIC  X(0012).
  4620*    -------------------------------
  4621     05  CNHINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  87
* EL6311.cbl
  4622     05  CNHINTF PIC  X(0001).
  4623     05  FILLER REDEFINES CNHINTF.
  4624         10  CNHINTA PIC  X(0001).
  4625     05  CNHINTI PIC  9(7)V99.
  4626*    -------------------------------
  4627     05  CCERTNOL PIC S9(0004) COMP.
  4628     05  CCERTNOF PIC  X(0001).
  4629     05  FILLER REDEFINES CCERTNOF.
  4630         10  CCERTNOA PIC  X(0001).
  4631     05  CCERTNOI PIC  X(0010).
  4632*    -------------------------------
  4633     05  CSUFIXL PIC S9(0004) COMP.
  4634     05  CSUFIXF PIC  X(0001).
  4635     05  FILLER REDEFINES CSUFIXF.
  4636         10  CSUFIXA PIC  X(0001).
  4637     05  CSUFIXI PIC  X(0001).
  4638*    -------------------------------
  4639     05  CEFFDTL PIC S9(0004) COMP.
  4640     05  CEFFDTF PIC  X(0001).
  4641     05  FILLER REDEFINES CEFFDTF.
  4642         10  CEFFDTA PIC  X(0001).
  4643     05  CEFFDTI PIC  X(0008).
  4644*    -------------------------------
  4645     05  CLSTNML PIC S9(0004) COMP.
  4646     05  CLSTNMF PIC  X(0001).
  4647     05  FILLER REDEFINES CLSTNMF.
  4648         10  CLSTNMA PIC  X(0001).
  4649     05  CLSTNMI PIC  X(0015).
  4650*    -------------------------------
  4651     05  CINAMEL PIC S9(0004) COMP.
  4652     05  CINAMEF PIC  X(0001).
  4653     05  FILLER REDEFINES CINAMEF.
  4654         10  CINAMEA PIC  X(0001).
  4655     05  CINAMEI PIC  X(0015).
  4656*    -------------------------------
  4657     05  CINITSL PIC S9(0004) COMP.
  4658     05  CINITSF PIC  X(0001).
  4659     05  FILLER REDEFINES CINITSF.
  4660         10  CINITSA PIC  X(0001).
  4661     05  CINITSI PIC  X(0010).
  4662*    -------------------------------
  4663     05  CCANREAL PIC S9(0004) COMP.
  4664     05  CCANREAF PIC  X(0001).
  4665     05  FILLER REDEFINES CCANREAF.
  4666         10  CCANREAA PIC  X(0001).
  4667     05  CCANREAI PIC  X(0001).
  4668*    -------------------------------
  4669     05  ACTSPCL PIC S9(0004) COMP.
  4670     05  ACTSPCF PIC  X(0001).
  4671     05  FILLER REDEFINES ACTSPCF.
  4672         10  ACTSPCA PIC  X(0001).
  4673     05  ACTSPCI PIC  X(0001).
  4674*    -------------------------------
  4675     05  CKIND1L PIC S9(0004) COMP.
  4676     05  CKIND1F PIC  X(0001).
  4677     05  FILLER REDEFINES CKIND1F.
  4678         10  CKIND1A PIC  X(0001).
  4679     05  CKIND1I PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  88
* EL6311.cbl
  4680*    -------------------------------
  4681     05  CCANDT1L PIC S9(0004) COMP.
  4682     05  CCANDT1F PIC  X(0001).
  4683     05  FILLER REDEFINES CCANDT1F.
  4684         10  CCANDT1A PIC  X(0001).
  4685     05  CCANDT1I PIC  X(0008).
  4686*    -------------------------------
  4687     05  CREFND1L PIC S9(0004) COMP.
  4688     05  CREFND1F PIC  X(0001).
  4689     05  FILLER REDEFINES CREFND1F.
  4690         10  CREFND1A PIC  X(0001).
  4691     05  CREFND1I PIC  S9(9)V99.
  4692*    -------------------------------
  4693     05  CMTHD1L PIC S9(0004) COMP.
  4694     05  CMTHD1F PIC  X(0001).
  4695     05  FILLER REDEFINES CMTHD1F.
  4696         10  CMTHD1A PIC  X(0001).
  4697     05  CMTHD1I PIC  X(0001).
  4698*    -------------------------------
  4699     05  CKIND2L PIC S9(0004) COMP.
  4700     05  CKIND2F PIC  X(0001).
  4701     05  FILLER REDEFINES CKIND2F.
  4702         10  CKIND2A PIC  X(0001).
  4703     05  CKIND2I PIC  X(0002).
  4704*    -------------------------------
  4705     05  CCANDT2L PIC S9(0004) COMP.
  4706     05  CCANDT2F PIC  X(0001).
  4707     05  FILLER REDEFINES CCANDT2F.
  4708         10  CCANDT2A PIC  X(0001).
  4709     05  CCANDT2I PIC  X(0008).
  4710*    -------------------------------
  4711     05  CREFND2L PIC S9(0004) COMP.
  4712     05  CREFND2F PIC  X(0001).
  4713     05  FILLER REDEFINES CREFND2F.
  4714         10  CREFND2A PIC  X(0001).
  4715     05  CREFND2I PIC  S9(9)V99.
  4716*    -------------------------------
  4717     05  CMTHD2L PIC S9(0004) COMP.
  4718     05  CMTHD2F PIC  X(0001).
  4719     05  FILLER REDEFINES CMTHD2F.
  4720         10  CMTHD2A PIC  X(0001).
  4721     05  CMTHD2I PIC  X(0001).
  4722*    -------------------------------
  4723     05  CLIVESL PIC S9(0004) COMP.
  4724     05  CLIVESF PIC  X(0001).
  4725     05  FILLER REDEFINES CLIVESF.
  4726         10  CLIVESA PIC  X(0001).
  4727     05  CLIVESI PIC  X(0003).
  4728*    -------------------------------
  4729     05  CFORCEL PIC S9(0004) COMP.
  4730     05  CFORCEF PIC  X(0001).
  4731     05  FILLER REDEFINES CFORCEF.
  4732         10  CFORCEA PIC  X(0001).
  4733     05  CFORCEI PIC  X(0001).
  4734*    -------------------------------
  4735     05  CBILCDL PIC S9(0004) COMP.
  4736     05  CBILCDF PIC  X(0001).
  4737     05  FILLER REDEFINES CBILCDF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  89
* EL6311.cbl
  4738         10  CBILCDA PIC  X(0001).
  4739     05  CBILCDI PIC  X(0001).
  4740*    -------------------------------
  4741     05  CCRFND1L PIC S9(0004) COMP.
  4742     05  CCRFND1F PIC  X(0001).
  4743     05  FILLER REDEFINES CCRFND1F.
  4744         10  CCRFND1A PIC  X(0001).
  4745     05  CCRFND1I PIC  X(0011).
  4746*    -------------------------------
  4747     05  CCRFND2L PIC S9(0004) COMP.
  4748     05  CCRFND2F PIC  X(0001).
  4749     05  FILLER REDEFINES CCRFND2F.
  4750         10  CCRFND2A PIC  X(0001).
  4751     05  CCRFND2I PIC  X(0011).
  4752*    -------------------------------
  4753     05  CBILIT1L PIC S9(0004) COMP.
  4754     05  CBILIT1F PIC  X(0001).
  4755     05  FILLER REDEFINES CBILIT1F.
  4756         10  CBILIT1A PIC  X(0001).
  4757     05  CBILIT1I PIC  X(0008).
  4758*    -------------------------------
  4759     05  CDRFND1L PIC S9(0004) COMP.
  4760     05  CDRFND1F PIC  X(0001).
  4761     05  FILLER REDEFINES CDRFND1F.
  4762         10  CDRFND1A PIC  X(0001).
  4763     05  CDRFND1I PIC  X(0011).
  4764*    -------------------------------
  4765     05  CBILIT2L PIC S9(0004) COMP.
  4766     05  CBILIT2F PIC  X(0001).
  4767     05  FILLER REDEFINES CBILIT2F.
  4768         10  CBILIT2A PIC  X(0001).
  4769     05  CBILIT2I PIC  X(0008).
  4770*    -------------------------------
  4771     05  CDRFND2L PIC S9(0004) COMP.
  4772     05  CDRFND2F PIC  X(0001).
  4773     05  FILLER REDEFINES CDRFND2F.
  4774         10  CDRFND2A PIC  X(0001).
  4775     05  CDRFND2I PIC  X(0011).
  4776*    -------------------------------
  4777     05  CCANTXTL PIC S9(0004) COMP.
  4778     05  CCANTXTF PIC  X(0001).
  4779     05  FILLER REDEFINES CCANTXTF.
  4780         10  CCANTXTA PIC  X(0001).
  4781     05  CCANTXTI PIC  X(0005).
  4782*    -------------------------------
  4783     05  CCANFEEL PIC S9(0004) COMP.
  4784     05  CCANFEEF PIC  X(0001).
  4785     05  FILLER REDEFINES CCANFEEF.
  4786         10  CCANFEEA PIC  X(0001).
  4787     05  CCANFEEI PIC  X(0002).
  4788*    -------------------------------
  4789     05  CTERM1L PIC S9(0004) COMP.
  4790     05  CTERM1F PIC  X(0001).
  4791     05  FILLER REDEFINES CTERM1F.
  4792         10  CTERM1A PIC  X(0001).
  4793     05  CTERM1I PIC  X(0003).
  4794*    -------------------------------
  4795     05  CRTERM1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  90
* EL6311.cbl
  4796     05  CRTERM1F PIC  X(0001).
  4797     05  FILLER REDEFINES CRTERM1F.
  4798         10  CRTERM1A PIC  X(0001).
  4799     05  CRTERM1I PIC  X(0003).
  4800*    -------------------------------
  4801     05  CPREM1L PIC S9(0004) COMP.
  4802     05  CPREM1F PIC  X(0001).
  4803     05  FILLER REDEFINES CPREM1F.
  4804         10  CPREM1A PIC  X(0001).
  4805     05  CPREM1I PIC  X(0011).
  4806*    -------------------------------
  4807     05  CTERM2L PIC S9(0004) COMP.
  4808     05  CTERM2F PIC  X(0001).
  4809     05  FILLER REDEFINES CTERM2F.
  4810         10  CTERM2A PIC  X(0001).
  4811     05  CTERM2I PIC  X(0003).
  4812*    -------------------------------
  4813     05  CRTERM2L PIC S9(0004) COMP.
  4814     05  CRTERM2F PIC  X(0001).
  4815     05  FILLER REDEFINES CRTERM2F.
  4816         10  CRTERM2A PIC  X(0001).
  4817     05  CRTERM2I PIC  X(0003).
  4818*    -------------------------------
  4819     05  CPREM2L PIC S9(0004) COMP.
  4820     05  CPREM2F PIC  X(0001).
  4821     05  FILLER REDEFINES CPREM2F.
  4822         10  CPREM2A PIC  X(0001).
  4823     05  CPREM2I PIC  X(0011).
  4824*    -------------------------------
  4825     05  CENTRDTL PIC S9(0004) COMP.
  4826     05  CENTRDTF PIC  X(0001).
  4827     05  FILLER REDEFINES CENTRDTF.
  4828         10  CENTRDTA PIC  X(0001).
  4829     05  CENTRDTI PIC  X(0008).
  4830*    -------------------------------
  4831     05  CPAYEEL PIC S9(0004) COMP.
  4832     05  CPAYEEF PIC  X(0001).
  4833     05  FILLER REDEFINES CPAYEEF.
  4834         10  CPAYEEA PIC  X(0001).
  4835     05  CPAYEEI PIC  X(0006).
  4836*    -------------------------------
  4837     05  CRFNDSWL PIC S9(0004) COMP.
  4838     05  CRFNDSWF PIC  X(0001).
  4839     05  FILLER REDEFINES CRFNDSWF.
  4840         10  CRFNDSWA PIC  X(0001).
  4841     05  CRFNDSWI PIC  X(0003).
  4842*    -------------------------------
  4843     05  CLFHDGL PIC S9(0004) COMP.
  4844     05  CLFHDGF PIC  X(0001).
  4845     05  FILLER REDEFINES CLFHDGF.
  4846         10  CLFHDGA PIC  X(0001).
  4847     05  CLFHDGI PIC  X(0006).
  4848*    -------------------------------
  4849     05  CAHHDGL PIC S9(0004) COMP.
  4850     05  CAHHDGF PIC  X(0001).
  4851     05  FILLER REDEFINES CAHHDGF.
  4852         10  CAHHDGA PIC  X(0001).
  4853     05  CAHHDGI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  91
* EL6311.cbl
  4854*    -------------------------------
  4855     05  CENTDTL PIC S9(0004) COMP.
  4856     05  CENTDTF PIC  X(0001).
  4857     05  FILLER REDEFINES CENTDTF.
  4858         10  CENTDTA PIC  X(0001).
  4859     05  CENTDTI PIC  X(0008).
  4860*    -------------------------------
  4861     05  CENTBYL PIC S9(0004) COMP.
  4862     05  CENTBYF PIC  X(0001).
  4863     05  FILLER REDEFINES CENTBYF.
  4864         10  CENTBYA PIC  X(0001).
  4865     05  CENTBYI PIC  X(0004).
  4866*    -------------------------------
  4867     05  CCHGCNTL PIC S9(0004) COMP.
  4868     05  CCHGCNTF PIC  X(0001).
  4869     05  FILLER REDEFINES CCHGCNTF.
  4870         10  CCHGCNTA PIC  X(0001).
  4871     05  CCHGCNTI PIC  X(0003).
  4872*    -------------------------------
  4873     05  CLFREFNL PIC S9(0004) COMP.
  4874     05  CLFREFNF PIC  X(0001).
  4875     05  FILLER REDEFINES CLFREFNF.
  4876         10  CLFREFNA PIC  X(0001).
  4877     05  CLFREFNI PIC  X(0006).
  4878*    -------------------------------
  4879     05  CAHREFNL PIC S9(0004) COMP.
  4880     05  CAHREFNF PIC  X(0001).
  4881     05  FILLER REDEFINES CAHREFNF.
  4882         10  CAHREFNA PIC  X(0001).
  4883     05  CAHREFNI PIC  X(0006).
  4884*    -------------------------------
  4885     05  CREINCDL PIC S9(0004) COMP.
  4886     05  CREINCDF PIC  X(0001).
  4887     05  FILLER REDEFINES CREINCDF.
  4888         10  CREINCDA PIC  X(0001).
  4889     05  CREINCDI PIC  X(0003).
  4890*    -------------------------------
  4891     05  CAEFFDTL PIC S9(0004) COMP.
  4892     05  CAEFFDTF PIC  X(0001).
  4893     05  FILLER REDEFINES CAEFFDTF.
  4894         10  CAEFFDTA PIC  X(0001).
  4895     05  CAEFFDTI PIC  X(0008).
  4896*    -------------------------------
  4897     05  CAEXPDTL PIC S9(0004) COMP.
  4898     05  CAEXPDTF PIC  X(0001).
  4899     05  FILLER REDEFINES CAEXPDTF.
  4900         10  CAEXPDTA PIC  X(0001).
  4901     05  CAEXPDTI PIC  X(0008).
  4902*    -------------------------------
  4903     05  COMMLFL PIC S9(0004) COMP.
  4904     05  COMMLFF PIC  X(0001).
  4905     05  FILLER REDEFINES COMMLFF.
  4906         10  COMMLFA PIC  X(0001).
  4907     05  COMMLFI PIC  X(0006).
  4908*    -------------------------------
  4909     05  COMMAHL PIC S9(0004) COMP.
  4910     05  COMMAHF PIC  X(0001).
  4911     05  FILLER REDEFINES COMMAHF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  92
* EL6311.cbl
  4912         10  COMMAHA PIC  X(0001).
  4913     05  COMMAHI PIC  X(0006).
  4914*    -------------------------------
  4915     05  CERMSG1L PIC S9(0004) COMP.
  4916     05  CERMSG1F PIC  X(0001).
  4917     05  FILLER REDEFINES CERMSG1F.
  4918         10  CERMSG1A PIC  X(0001).
  4919     05  CERMSG1I PIC  X(0078).
  4920*    -------------------------------
  4921     05  CERMSG2L PIC S9(0004) COMP.
  4922     05  CERMSG2F PIC  X(0001).
  4923     05  FILLER REDEFINES CERMSG2F.
  4924         10  CERMSG2A PIC  X(0001).
  4925     05  CERMSG2I PIC  X(0078).
  4926*    -------------------------------
  4927     05  CERMSG3L PIC S9(0004) COMP.
  4928     05  CERMSG3F PIC  X(0001).
  4929     05  FILLER REDEFINES CERMSG3F.
  4930         10  CERMSG3A PIC  X(0001).
  4931     05  CERMSG3I PIC  X(0078).
  4932*    -------------------------------
  4933     05  CPFENTRL PIC S9(0004) COMP.
  4934     05  CPFENTRF PIC  X(0001).
  4935     05  FILLER REDEFINES CPFENTRF.
  4936         10  CPFENTRA PIC  X(0001).
  4937     05  CPFENTRI PIC  9(2).
  4938*    -------------------------------
  4939     05  CPF5HDRL PIC S9(0004) COMP.
  4940     05  CPF5HDRF PIC  X(0001).
  4941     05  FILLER REDEFINES CPF5HDRF.
  4942         10  CPF5HDRA PIC  X(0001).
  4943     05  CPF5HDRI PIC  X(0005).
  4944*    -------------------------------
  4945     05  CPF4HDRL PIC S9(0004) COMP.
  4946     05  CPF4HDRF PIC  X(0001).
  4947     05  FILLER REDEFINES CPF4HDRF.
  4948         10  CPF4HDRA PIC  X(0001).
  4949     05  CPF4HDRI PIC  X(0013).
  4950*    -------------------------------
  4951     05  CF15HDRL PIC S9(0004) COMP.
  4952     05  CF15HDRF PIC  X(0001).
  4953     05  FILLER REDEFINES CF15HDRF.
  4954         10  CF15HDRA PIC  X(0001).
  4955     05  CF15HDRI PIC  X(0022).
  4956 01  EL631CO REDEFINES EL631BI.
  4957     05  FILLER            PIC  X(0012).
  4958*    -------------------------------
  4959     05  FILLER            PIC  X(0003).
  4960     05  CDATEO PIC  X(0008).
  4961*    -------------------------------
  4962     05  FILLER            PIC  X(0003).
  4963     05  CTIMEO PIC  99.99.
  4964*    -------------------------------
  4965     05  FILLER            PIC  X(0003).
  4966     05  CHEADO PIC  X(0038).
  4967*    -------------------------------
  4968     05  FILLER            PIC  X(0003).
  4969     05  CCHGTO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  93
* EL6311.cbl
  4970*    -------------------------------
  4971     05  FILLER            PIC  X(0003).
  4972     05  CCHGO PIC  ZZZ9.
  4973*    -------------------------------
  4974     05  FILLER            PIC  X(0003).
  4975     05  CMAINTO PIC  X(0001).
  4976*    -------------------------------
  4977     05  FILLER            PIC  X(0003).
  4978     05  CMANTBYO PIC  X(0004).
  4979*    -------------------------------
  4980     05  FILLER            PIC  X(0003).
  4981     05  CCHGHDGO PIC  X(0003).
  4982*    -------------------------------
  4983     05  FILLER            PIC  X(0003).
  4984     05  CMANTDTO PIC  X(0008).
  4985*    -------------------------------
  4986     05  FILLER            PIC  X(0003).
  4987     05  CMANTATO PIC  99.99.
  4988*    -------------------------------
  4989     05  FILLER            PIC  X(0003).
  4990     05  CCSRO PIC  X(0004).
  4991*    -------------------------------
  4992     05  FILLER            PIC  X(0003).
  4993     05  CBATCHO PIC  X(0006).
  4994*    -------------------------------
  4995     05  FILLER            PIC  X(0003).
  4996     05  CSEQO PIC  X(0004).
  4997*    -------------------------------
  4998     05  FILLER            PIC  X(0003).
  4999     05  CMOENDTO PIC  X(0008).
  5000*    -------------------------------
  5001     05  FILLER            PIC  X(0003).
  5002     05  CCARRO PIC  X(0001).
  5003*    -------------------------------
  5004     05  FILLER            PIC  X(0003).
  5005     05  CGROUPO PIC  X(0006).
  5006*    -------------------------------
  5007     05  FILLER            PIC  X(0003).
  5008     05  CSTATEO PIC  X(0002).
  5009*    -------------------------------
  5010     05  FILLER            PIC  X(0003).
  5011     05  CACCTO PIC  X(0010).
  5012*    -------------------------------
  5013     05  FILLER            PIC  X(0003).
  5014     05  CORIGHDO PIC  X(0011).
  5015*    -------------------------------
  5016     05  FILLER            PIC  X(0003).
  5017     05  CORGNOO PIC  X(0006).
  5018*    -------------------------------
  5019     05  FILLER            PIC  X(0003).
  5020     05  CORGSEQO PIC  X(0004).
  5021*    -------------------------------
  5022     05  FILLER            PIC  X(0003).
  5023     05  CREFHDGO PIC  X(0010).
  5024*    -------------------------------
  5025     05  FILLER            PIC  X(0003).
  5026     05  CREFO PIC  X(0012).
  5027*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  94
* EL6311.cbl
  5028     05  FILLER            PIC  X(0003).
  5029     05  CNHINTO PIC  ZZZZZ9.99.
  5030*    -------------------------------
  5031     05  FILLER            PIC  X(0003).
  5032     05  CCERTNOO PIC  X(0010).
  5033*    -------------------------------
  5034     05  FILLER            PIC  X(0003).
  5035     05  CSUFIXO PIC  X(0001).
  5036*    -------------------------------
  5037     05  FILLER            PIC  X(0003).
  5038     05  CEFFDTO PIC  X(0008).
  5039*    -------------------------------
  5040     05  FILLER            PIC  X(0003).
  5041     05  CLSTNMO PIC  X(0015).
  5042*    -------------------------------
  5043     05  FILLER            PIC  X(0003).
  5044     05  CINAMEO PIC  X(0015).
  5045*    -------------------------------
  5046     05  FILLER            PIC  X(0003).
  5047     05  CINITSO PIC  X(0010).
  5048*    -------------------------------
  5049     05  FILLER            PIC  X(0003).
  5050     05  CCANREAO PIC  X(0001).
  5051*    -------------------------------
  5052     05  FILLER            PIC  X(0003).
  5053     05  ACTSPCO PIC  X(0001).
  5054*    -------------------------------
  5055     05  FILLER            PIC  X(0003).
  5056     05  CKIND1O PIC  X(0002).
  5057*    -------------------------------
  5058     05  FILLER            PIC  X(0003).
  5059     05  CCANDT1O PIC  X(0008).
  5060*    -------------------------------
  5061     05  FILLER            PIC  X(0003).
  5062     05  CREFND1O PIC  Z(7).99-.
  5063*    -------------------------------
  5064     05  FILLER            PIC  X(0003).
  5065     05  CMTHD1O PIC  X(0001).
  5066*    -------------------------------
  5067     05  FILLER            PIC  X(0003).
  5068     05  CKIND2O PIC  X(0002).
  5069*    -------------------------------
  5070     05  FILLER            PIC  X(0003).
  5071     05  CCANDT2O PIC  X(0008).
  5072*    -------------------------------
  5073     05  FILLER            PIC  X(0003).
  5074     05  CREFND2O PIC  Z(7).99-.
  5075*    -------------------------------
  5076     05  FILLER            PIC  X(0003).
  5077     05  CMTHD2O PIC  X(0001).
  5078*    -------------------------------
  5079     05  FILLER            PIC  X(0003).
  5080     05  CLIVESO PIC  X(0003).
  5081*    -------------------------------
  5082     05  FILLER            PIC  X(0003).
  5083     05  CFORCEO PIC  X(0001).
  5084*    -------------------------------
  5085     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  95
* EL6311.cbl
  5086     05  CBILCDO PIC  X(0001).
  5087*    -------------------------------
  5088     05  FILLER            PIC  X(0003).
  5089     05  CCRFND1O PIC  Z(7).99-.
  5090*    -------------------------------
  5091     05  FILLER            PIC  X(0003).
  5092     05  CCRFND2O PIC  Z(7).99-.
  5093*    -------------------------------
  5094     05  FILLER            PIC  X(0003).
  5095     05  CBILIT1O PIC  X(0008).
  5096*    -------------------------------
  5097     05  FILLER            PIC  X(0003).
  5098     05  CDRFND1O PIC  Z(7).99-.
  5099*    -------------------------------
  5100     05  FILLER            PIC  X(0003).
  5101     05  CBILIT2O PIC  X(0008).
  5102*    -------------------------------
  5103     05  FILLER            PIC  X(0003).
  5104     05  CDRFND2O PIC  Z(7).99-.
  5105*    -------------------------------
  5106     05  FILLER            PIC  X(0003).
  5107     05  CCANTXTO PIC  X(0005).
  5108*    -------------------------------
  5109     05  FILLER            PIC  X(0003).
  5110     05  CCANFEEO PIC  Z9.
  5111*    -------------------------------
  5112     05  FILLER            PIC  X(0003).
  5113     05  CTERM1O PIC  ZZ9.
  5114*    -------------------------------
  5115     05  FILLER            PIC  X(0003).
  5116     05  CRTERM1O PIC  ZZ9.
  5117*    -------------------------------
  5118     05  FILLER            PIC  X(0003).
  5119     05  CPREM1O PIC  ZZZZZZ9.99-.
  5120*    -------------------------------
  5121     05  FILLER            PIC  X(0003).
  5122     05  CTERM2O PIC  ZZ9.
  5123*    -------------------------------
  5124     05  FILLER            PIC  X(0003).
  5125     05  CRTERM2O PIC  ZZ9.
  5126*    -------------------------------
  5127     05  FILLER            PIC  X(0003).
  5128     05  CPREM2O PIC  ZZZZZZ9.99-.
  5129*    -------------------------------
  5130     05  FILLER            PIC  X(0003).
  5131     05  CENTRDTO PIC  X(0008).
  5132*    -------------------------------
  5133     05  FILLER            PIC  X(0003).
  5134     05  CPAYEEO PIC  X(0006).
  5135*    -------------------------------
  5136     05  FILLER            PIC  X(0003).
  5137     05  CRFNDSWO PIC  X(0003).
  5138*    -------------------------------
  5139     05  FILLER            PIC  X(0003).
  5140     05  CLFHDGO PIC  X(0006).
  5141*    -------------------------------
  5142     05  FILLER            PIC  X(0003).
  5143     05  CAHHDGO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  96
* EL6311.cbl
  5144*    -------------------------------
  5145     05  FILLER            PIC  X(0003).
  5146     05  CENTDTO PIC  X(0008).
  5147*    -------------------------------
  5148     05  FILLER            PIC  X(0003).
  5149     05  CENTBYO PIC  X(0004).
  5150*    -------------------------------
  5151     05  FILLER            PIC  X(0003).
  5152     05  CCHGCNTO PIC  X(0003).
  5153*    -------------------------------
  5154     05  FILLER            PIC  X(0003).
  5155     05  CLFREFNO PIC  X(0006).
  5156*    -------------------------------
  5157     05  FILLER            PIC  X(0003).
  5158     05  CAHREFNO PIC  X(0006).
  5159*    -------------------------------
  5160     05  FILLER            PIC  X(0003).
  5161     05  CREINCDO PIC  X(0003).
  5162*    -------------------------------
  5163     05  FILLER            PIC  X(0003).
  5164     05  CAEFFDTO PIC  X(0008).
  5165*    -------------------------------
  5166     05  FILLER            PIC  X(0003).
  5167     05  CAEXPDTO PIC  X(0008).
  5168*    -------------------------------
  5169     05  FILLER            PIC  X(0003).
  5170     05  COMMLFO PIC  .99999.
  5171*    -------------------------------
  5172     05  FILLER            PIC  X(0003).
  5173     05  COMMAHO PIC  .99999.
  5174*    -------------------------------
  5175     05  FILLER            PIC  X(0003).
  5176     05  CERMSG1O PIC  X(0078).
  5177*    -------------------------------
  5178     05  FILLER            PIC  X(0003).
  5179     05  CERMSG2O PIC  X(0078).
  5180*    -------------------------------
  5181     05  FILLER            PIC  X(0003).
  5182     05  CERMSG3O PIC  X(0078).
  5183*    -------------------------------
  5184     05  FILLER            PIC  X(0003).
  5185     05  CPFENTRO PIC  X(0002).
  5186*    -------------------------------
  5187     05  FILLER            PIC  X(0003).
  5188     05  CPF5HDRO PIC  X(0005).
  5189*    -------------------------------
  5190     05  FILLER            PIC  X(0003).
  5191     05  CPF4HDRO PIC  X(0013).
  5192*    -------------------------------
  5193     05  FILLER            PIC  X(0003).
  5194     05  CF15HDRO PIC  X(0022).
  5195*    -------------------------------
  5196 01  EL631DI REDEFINES EL631BI.
  5197     05  FILLER            PIC  X(0012).
  5198*    -------------------------------
  5199     05  DDATEL PIC S9(0004) COMP.
  5200     05  DDATEF PIC  X(0001).
  5201     05  FILLER REDEFINES DDATEF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  97
* EL6311.cbl
  5202         10  DDATEA PIC  X(0001).
  5203     05  DDATEI PIC  X(0008).
  5204*    -------------------------------
  5205     05  DTIMEL PIC S9(0004) COMP.
  5206     05  DTIMEF PIC  X(0001).
  5207     05  FILLER REDEFINES DTIMEF.
  5208         10  DTIMEA PIC  X(0001).
  5209     05  DTIMEI PIC  X(0005).
  5210*    -------------------------------
  5211     05  DHEADL PIC S9(0004) COMP.
  5212     05  DHEADF PIC  X(0001).
  5213     05  FILLER REDEFINES DHEADF.
  5214         10  DHEADA PIC  X(0001).
  5215     05  DHEADI PIC  X(0038).
  5216*    -------------------------------
  5217     05  DLDATEL PIC S9(0004) COMP.
  5218     05  DLDATEF PIC  X(0001).
  5219     05  FILLER REDEFINES DLDATEF.
  5220         10  DLDATEA PIC  X(0001).
  5221     05  DLDATEI PIC  X(0010).
  5222*    -------------------------------
  5223     05  DBATCHL PIC S9(0004) COMP.
  5224     05  DBATCHF PIC  X(0001).
  5225     05  FILLER REDEFINES DBATCHF.
  5226         10  DBATCHA PIC  X(0001).
  5227     05  DBATCHI PIC  X(0011).
  5228*    -------------------------------
  5229     05  DACCTNML PIC S9(0004) COMP.
  5230     05  DACCTNMF PIC  X(0001).
  5231     05  FILLER REDEFINES DACCTNMF.
  5232         10  DACCTNMA PIC  X(0001).
  5233     05  DACCTNMI PIC  X(0030).
  5234*    -------------------------------
  5235     05  DPROCDTL PIC S9(0004) COMP.
  5236     05  DPROCDTF PIC  X(0001).
  5237     05  FILLER REDEFINES DPROCDTF.
  5238         10  DPROCDTA PIC  X(0001).
  5239     05  DPROCDTI PIC  X(0008).
  5240*    -------------------------------
  5241     05  DINPUTL PIC S9(0004) COMP.
  5242     05  DINPUTF PIC  X(0001).
  5243     05  FILLER REDEFINES DINPUTF.
  5244         10  DINPUTA PIC  X(0001).
  5245     05  DINPUTI PIC  X(0008).
  5246*    -------------------------------
  5247     05  DMAINDTL PIC S9(0004) COMP.
  5248     05  DMAINDTF PIC  X(0001).
  5249     05  FILLER REDEFINES DMAINDTF.
  5250         10  DMAINDTA PIC  X(0001).
  5251     05  DMAINDTI PIC  X(0008).
  5252*    -------------------------------
  5253     05  DCARRL PIC S9(0004) COMP.
  5254     05  DCARRF PIC  X(0001).
  5255     05  FILLER REDEFINES DCARRF.
  5256         10  DCARRA PIC  X(0001).
  5257     05  DCARRI PIC  X(0001).
  5258*    -------------------------------
  5259     05  DGROUPL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  98
* EL6311.cbl
  5260     05  DGROUPF PIC  X(0001).
  5261     05  FILLER REDEFINES DGROUPF.
  5262         10  DGROUPA PIC  X(0001).
  5263     05  DGROUPI PIC  X(0006).
  5264*    -------------------------------
  5265     05  DSTATEL PIC S9(0004) COMP.
  5266     05  DSTATEF PIC  X(0001).
  5267     05  FILLER REDEFINES DSTATEF.
  5268         10  DSTATEA PIC  X(0001).
  5269     05  DSTATEI PIC  X(0002).
  5270*    -------------------------------
  5271     05  DACCTL PIC S9(0004) COMP.
  5272     05  DACCTF PIC  X(0001).
  5273     05  FILLER REDEFINES DACCTF.
  5274         10  DACCTA PIC  X(0001).
  5275     05  DACCTI PIC  X(0010).
  5276*    -------------------------------
  5277     05  DRECVDTL PIC S9(0004) COMP.
  5278     05  DRECVDTF PIC  X(0001).
  5279     05  FILLER REDEFINES DRECVDTF.
  5280         10  DRECVDTA PIC  X(0001).
  5281     05  DRECVDTI PIC  X(0008).
  5282*    -------------------------------
  5283     05  DCSRL PIC S9(0004) COMP.
  5284     05  DCSRF PIC  X(0001).
  5285     05  FILLER REDEFINES DCSRF.
  5286         10  DCSRA PIC  X(0001).
  5287     05  DCSRI PIC  X(0004).
  5288*    -------------------------------
  5289     05  DREFHDGL PIC S9(0004) COMP.
  5290     05  DREFHDGF PIC  X(0001).
  5291     05  FILLER REDEFINES DREFHDGF.
  5292         10  DREFHDGA PIC  X(0001).
  5293     05  DREFHDGI PIC  X(0010).
  5294*    -------------------------------
  5295     05  DREFL PIC S9(0004) COMP.
  5296     05  DREFF PIC  X(0001).
  5297     05  FILLER REDEFINES DREFF.
  5298         10  DREFA PIC  X(0001).
  5299     05  DREFI PIC  X(0012).
  5300*    -------------------------------
  5301     05  DLFPHDGL PIC S9(0004) COMP.
  5302     05  DLFPHDGF PIC  X(0001).
  5303     05  FILLER REDEFINES DLFPHDGF.
  5304         10  DLFPHDGA PIC  X(0001).
  5305     05  DLFPHDGI PIC  X(0010).
  5306*    -------------------------------
  5307     05  DAHPHDGL PIC S9(0004) COMP.
  5308     05  DAHPHDGF PIC  X(0001).
  5309     05  FILLER REDEFINES DAHPHDGF.
  5310         10  DAHPHDGA PIC  X(0001).
  5311     05  DAHPHDGI PIC  X(0010).
  5312*    -------------------------------
  5313     05  DLFRHDGL PIC S9(0004) COMP.
  5314     05  DLFRHDGF PIC  X(0001).
  5315     05  FILLER REDEFINES DLFRHDGF.
  5316         10  DLFRHDGA PIC  X(0001).
  5317     05  DLFRHDGI PIC  X(0009).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  99
* EL6311.cbl
  5318*    -------------------------------
  5319     05  DAHRHDGL PIC S9(0004) COMP.
  5320     05  DAHRHDGF PIC  X(0001).
  5321     05  FILLER REDEFINES DAHRHDGF.
  5322         10  DAHRHDGA PIC  X(0001).
  5323     05  DAHRHDGI PIC  X(0009).
  5324*    -------------------------------
  5325     05  DRISSL PIC S9(0004) COMP.
  5326     05  DRISSF PIC  X(0001).
  5327     05  FILLER REDEFINES DRISSF.
  5328         10  DRISSA PIC  X(0001).
  5329     05  DRISSI PIC  X(0005).
  5330*    -------------------------------
  5331     05  DRLFPRML PIC S9(0004) COMP.
  5332     05  DRLFPRMF PIC  X(0001).
  5333     05  FILLER REDEFINES DRLFPRMF.
  5334         10  DRLFPRMA PIC  X(0001).
  5335     05  DRLFPRMI PIC  S9(9)V99.
  5336*    -------------------------------
  5337     05  DRAHPRML PIC S9(0004) COMP.
  5338     05  DRAHPRMF PIC  X(0001).
  5339     05  FILLER REDEFINES DRAHPRMF.
  5340         10  DRAHPRMA PIC  X(0001).
  5341     05  DRAHPRMI PIC  S9(9)V99.
  5342*    -------------------------------
  5343     05  DRCANCL PIC S9(0004) COMP.
  5344     05  DRCANCF PIC  X(0001).
  5345     05  FILLER REDEFINES DRCANCF.
  5346         10  DRCANCA PIC  X(0001).
  5347     05  DRCANCI PIC  X(0005).
  5348*    -------------------------------
  5349     05  DRLFRFDL PIC S9(0004) COMP.
  5350     05  DRLFRFDF PIC  X(0001).
  5351     05  FILLER REDEFINES DRLFRFDF.
  5352         10  DRLFRFDA PIC  X(0001).
  5353     05  DRLFRFDI PIC  S9(9)V99.
  5354*    -------------------------------
  5355     05  DRAHRFDL PIC S9(0004) COMP.
  5356     05  DRAHRFDF PIC  X(0001).
  5357     05  FILLER REDEFINES DRAHRFDF.
  5358         10  DRAHRFDA PIC  X(0001).
  5359     05  DRAHRFDI PIC  S9(9)V99.
  5360*    -------------------------------
  5361     05  DEISSL PIC S9(0004) COMP.
  5362     05  DEISSF PIC  X(0001).
  5363     05  FILLER REDEFINES DEISSF.
  5364         10  DEISSA PIC  X(0001).
  5365     05  DEISSI PIC  X(0005).
  5366*    -------------------------------
  5367     05  DELFPRML PIC S9(0004) COMP.
  5368     05  DELFPRMF PIC  X(0001).
  5369     05  FILLER REDEFINES DELFPRMF.
  5370         10  DELFPRMA PIC  X(0001).
  5371     05  DELFPRMI PIC  X(0011).
  5372*    -------------------------------
  5373     05  DEAHPRML PIC S9(0004) COMP.
  5374     05  DEAHPRMF PIC  X(0001).
  5375     05  FILLER REDEFINES DEAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 100
* EL6311.cbl
  5376         10  DEAHPRMA PIC  X(0001).
  5377     05  DEAHPRMI PIC  X(0011).
  5378*    -------------------------------
  5379     05  DECANCL PIC S9(0004) COMP.
  5380     05  DECANCF PIC  X(0001).
  5381     05  FILLER REDEFINES DECANCF.
  5382         10  DECANCA PIC  X(0001).
  5383     05  DECANCI PIC  X(0005).
  5384*    -------------------------------
  5385     05  DELFRFDL PIC S9(0004) COMP.
  5386     05  DELFRFDF PIC  X(0001).
  5387     05  FILLER REDEFINES DELFRFDF.
  5388         10  DELFRFDA PIC  X(0001).
  5389     05  DELFRFDI PIC  X(0011).
  5390*    -------------------------------
  5391     05  DEAHRFDL PIC S9(0004) COMP.
  5392     05  DEAHRFDF PIC  X(0001).
  5393     05  FILLER REDEFINES DEAHRFDF.
  5394         10  DEAHRFDA PIC  X(0001).
  5395     05  DEAHRFDI PIC  X(0011).
  5396*    -------------------------------
  5397     05  DCISSL PIC S9(0004) COMP.
  5398     05  DCISSF PIC  X(0001).
  5399     05  FILLER REDEFINES DCISSF.
  5400         10  DCISSA PIC  X(0001).
  5401     05  DCISSI PIC  X(0005).
  5402*    -------------------------------
  5403     05  DCLFPRML PIC S9(0004) COMP.
  5404     05  DCLFPRMF PIC  X(0001).
  5405     05  FILLER REDEFINES DCLFPRMF.
  5406         10  DCLFPRMA PIC  X(0001).
  5407     05  DCLFPRMI PIC  X(0011).
  5408*    -------------------------------
  5409     05  DCAHPRML PIC S9(0004) COMP.
  5410     05  DCAHPRMF PIC  X(0001).
  5411     05  FILLER REDEFINES DCAHPRMF.
  5412         10  DCAHPRMA PIC  X(0001).
  5413     05  DCAHPRMI PIC  X(0011).
  5414*    -------------------------------
  5415     05  DCCANCL PIC S9(0004) COMP.
  5416     05  DCCANCF PIC  X(0001).
  5417     05  FILLER REDEFINES DCCANCF.
  5418         10  DCCANCA PIC  X(0001).
  5419     05  DCCANCI PIC  X(0005).
  5420*    -------------------------------
  5421     05  DCLFRFDL PIC S9(0004) COMP.
  5422     05  DCLFRFDF PIC  X(0001).
  5423     05  FILLER REDEFINES DCLFRFDF.
  5424         10  DCLFRFDA PIC  X(0001).
  5425     05  DCLFRFDI PIC  X(0011).
  5426*    -------------------------------
  5427     05  DCAHRFDL PIC S9(0004) COMP.
  5428     05  DCAHRFDF PIC  X(0001).
  5429     05  FILLER REDEFINES DCAHRFDF.
  5430         10  DCAHRFDA PIC  X(0001).
  5431     05  DCAHRFDI PIC  X(0011).
  5432*    -------------------------------
  5433     05  DOISSL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 101
* EL6311.cbl
  5434     05  DOISSF PIC  X(0001).
  5435     05  FILLER REDEFINES DOISSF.
  5436         10  DOISSA PIC  X(0001).
  5437     05  DOISSI PIC  X(0005).
  5438*    -------------------------------
  5439     05  DOLFPRML PIC S9(0004) COMP.
  5440     05  DOLFPRMF PIC  X(0001).
  5441     05  FILLER REDEFINES DOLFPRMF.
  5442         10  DOLFPRMA PIC  X(0001).
  5443     05  DOLFPRMI PIC  X(0011).
  5444*    -------------------------------
  5445     05  DOAHPRML PIC S9(0004) COMP.
  5446     05  DOAHPRMF PIC  X(0001).
  5447     05  FILLER REDEFINES DOAHPRMF.
  5448         10  DOAHPRMA PIC  X(0001).
  5449     05  DOAHPRMI PIC  X(0011).
  5450*    -------------------------------
  5451     05  DOCANCL PIC S9(0004) COMP.
  5452     05  DOCANCF PIC  X(0001).
  5453     05  FILLER REDEFINES DOCANCF.
  5454         10  DOCANCA PIC  X(0001).
  5455     05  DOCANCI PIC  X(0005).
  5456*    -------------------------------
  5457     05  DOLFRFDL PIC S9(0004) COMP.
  5458     05  DOLFRFDF PIC  X(0001).
  5459     05  FILLER REDEFINES DOLFRFDF.
  5460         10  DOLFRFDA PIC  X(0001).
  5461     05  DOLFRFDI PIC  X(0011).
  5462*    -------------------------------
  5463     05  DOAHRFDL PIC S9(0004) COMP.
  5464     05  DOAHRFDF PIC  X(0001).
  5465     05  FILLER REDEFINES DOAHRFDF.
  5466         10  DOAHRFDA PIC  X(0001).
  5467     05  DOAHRFDI PIC  X(0011).
  5468*    -------------------------------
  5469     05  DITOTALL PIC S9(0004) COMP.
  5470     05  DITOTALF PIC  X(0001).
  5471     05  FILLER REDEFINES DITOTALF.
  5472         10  DITOTALA PIC  X(0001).
  5473     05  DITOTALI PIC  X(0005).
  5474*    -------------------------------
  5475     05  DIFATALL PIC S9(0004) COMP.
  5476     05  DIFATALF PIC  X(0001).
  5477     05  FILLER REDEFINES DIFATALF.
  5478         10  DIFATALA PIC  X(0001).
  5479     05  DIFATALI PIC  X(0005).
  5480*    -------------------------------
  5481     05  DIFORCEL PIC S9(0004) COMP.
  5482     05  DIFORCEF PIC  X(0001).
  5483     05  FILLER REDEFINES DIFORCEF.
  5484         10  DIFORCEA PIC  X(0001).
  5485     05  DIFORCEI PIC  X(0005).
  5486*    -------------------------------
  5487     05  DIHOLDL PIC S9(0004) COMP.
  5488     05  DIHOLDF PIC  X(0001).
  5489     05  FILLER REDEFINES DIHOLDF.
  5490         10  DIHOLDA PIC  X(0001).
  5491     05  DIHOLDI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 102
* EL6311.cbl
  5492*    -------------------------------
  5493     05  DIAVAILL PIC S9(0004) COMP.
  5494     05  DIAVAILF PIC  X(0001).
  5495     05  FILLER REDEFINES DIAVAILF.
  5496         10  DIAVAILA PIC  X(0001).
  5497     05  DIAVAILI PIC  X(0005).
  5498*    -------------------------------
  5499     05  DIGPREML PIC S9(0004) COMP.
  5500     05  DIGPREMF PIC  X(0001).
  5501     05  FILLER REDEFINES DIGPREMF.
  5502         10  DIGPREMA PIC  X(0001).
  5503     05  DIGPREMI PIC  X(0011).
  5504*    -------------------------------
  5505     05  DIBPREML PIC S9(0004) COMP.
  5506     05  DIBPREMF PIC  X(0001).
  5507     05  FILLER REDEFINES DIBPREMF.
  5508         10  DIBPREMA PIC  X(0001).
  5509     05  DIBPREMI PIC  X(0011).
  5510*    -------------------------------
  5511     05  DCTOTALL PIC S9(0004) COMP.
  5512     05  DCTOTALF PIC  X(0001).
  5513     05  FILLER REDEFINES DCTOTALF.
  5514         10  DCTOTALA PIC  X(0001).
  5515     05  DCTOTALI PIC  X(0005).
  5516*    -------------------------------
  5517     05  DCFATALL PIC S9(0004) COMP.
  5518     05  DCFATALF PIC  X(0001).
  5519     05  FILLER REDEFINES DCFATALF.
  5520         10  DCFATALA PIC  X(0001).
  5521     05  DCFATALI PIC  X(0005).
  5522*    -------------------------------
  5523     05  DCFORCEL PIC S9(0004) COMP.
  5524     05  DCFORCEF PIC  X(0001).
  5525     05  FILLER REDEFINES DCFORCEF.
  5526         10  DCFORCEA PIC  X(0001).
  5527     05  DCFORCEI PIC  X(0005).
  5528*    -------------------------------
  5529     05  DCHOLDL PIC S9(0004) COMP.
  5530     05  DCHOLDF PIC  X(0001).
  5531     05  FILLER REDEFINES DCHOLDF.
  5532         10  DCHOLDA PIC  X(0001).
  5533     05  DCHOLDI PIC  X(0005).
  5534*    -------------------------------
  5535     05  DCAVAILL PIC S9(0004) COMP.
  5536     05  DCAVAILF PIC  X(0001).
  5537     05  FILLER REDEFINES DCAVAILF.
  5538         10  DCAVAILA PIC  X(0001).
  5539     05  DCAVAILI PIC  X(0005).
  5540*    -------------------------------
  5541     05  DCGPREML PIC S9(0004) COMP.
  5542     05  DCGPREMF PIC  X(0001).
  5543     05  FILLER REDEFINES DCGPREMF.
  5544         10  DCGPREMA PIC  X(0001).
  5545     05  DCGPREMI PIC  X(0011).
  5546*    -------------------------------
  5547     05  DCBPREML PIC S9(0004) COMP.
  5548     05  DCBPREMF PIC  X(0001).
  5549     05  FILLER REDEFINES DCBPREMF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 103
* EL6311.cbl
  5550         10  DCBPREMA PIC  X(0001).
  5551     05  DCBPREMI PIC  X(0011).
  5552*    -------------------------------
  5553     05  DNTOTALL PIC S9(0004) COMP.
  5554     05  DNTOTALF PIC  X(0001).
  5555     05  FILLER REDEFINES DNTOTALF.
  5556         10  DNTOTALA PIC  X(0001).
  5557     05  DNTOTALI PIC  X(0005).
  5558*    -------------------------------
  5559     05  DNFATALL PIC S9(0004) COMP.
  5560     05  DNFATALF PIC  X(0001).
  5561     05  FILLER REDEFINES DNFATALF.
  5562         10  DNFATALA PIC  X(0001).
  5563     05  DNFATALI PIC  X(0005).
  5564*    -------------------------------
  5565     05  DNFORCEL PIC S9(0004) COMP.
  5566     05  DNFORCEF PIC  X(0001).
  5567     05  FILLER REDEFINES DNFORCEF.
  5568         10  DNFORCEA PIC  X(0001).
  5569     05  DNFORCEI PIC  X(0005).
  5570*    -------------------------------
  5571     05  DNHOLDL PIC S9(0004) COMP.
  5572     05  DNHOLDF PIC  X(0001).
  5573     05  FILLER REDEFINES DNHOLDF.
  5574         10  DNHOLDA PIC  X(0001).
  5575     05  DNHOLDI PIC  X(0005).
  5576*    -------------------------------
  5577     05  DNAVAILL PIC S9(0004) COMP.
  5578     05  DNAVAILF PIC  X(0001).
  5579     05  FILLER REDEFINES DNAVAILF.
  5580         10  DNAVAILA PIC  X(0001).
  5581     05  DNAVAILI PIC  X(0005).
  5582*    -------------------------------
  5583     05  DNGPREML PIC S9(0004) COMP.
  5584     05  DNGPREMF PIC  X(0001).
  5585     05  FILLER REDEFINES DNGPREMF.
  5586         10  DNGPREMA PIC  X(0001).
  5587     05  DNGPREMI PIC  X(0011).
  5588*    -------------------------------
  5589     05  DNBPREML PIC S9(0004) COMP.
  5590     05  DNBPREMF PIC  X(0001).
  5591     05  FILLER REDEFINES DNBPREMF.
  5592         10  DNBPREMA PIC  X(0001).
  5593     05  DNBPREMI PIC  X(0011).
  5594*    -------------------------------
  5595     05  DERMSGL PIC S9(0004) COMP.
  5596     05  DERMSGF PIC  X(0001).
  5597     05  FILLER REDEFINES DERMSGF.
  5598         10  DERMSGA PIC  X(0001).
  5599     05  DERMSGI PIC  X(0075).
  5600*    -------------------------------
  5601     05  DPFENTRL PIC S9(0004) COMP.
  5602     05  DPFENTRF PIC  X(0001).
  5603     05  FILLER REDEFINES DPFENTRF.
  5604         10  DPFENTRA PIC  X(0001).
  5605     05  DPFENTRI PIC  9(2).
  5606 01  EL631DO REDEFINES EL631BI.
  5607     05  FILLER            PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 104
* EL6311.cbl
  5608*    -------------------------------
  5609     05  FILLER            PIC  X(0003).
  5610     05  DDATEO PIC  X(0008).
  5611*    -------------------------------
  5612     05  FILLER            PIC  X(0003).
  5613     05  DTIMEO PIC  99.99.
  5614*    -------------------------------
  5615     05  FILLER            PIC  X(0003).
  5616     05  DHEADO PIC  X(0038).
  5617*    -------------------------------
  5618     05  FILLER            PIC  X(0003).
  5619     05  DLDATEO PIC  X(0010).
  5620*    -------------------------------
  5621     05  FILLER            PIC  X(0003).
  5622     05  DBATCHO PIC  X(0011).
  5623*    -------------------------------
  5624     05  FILLER            PIC  X(0003).
  5625     05  DACCTNMO PIC  X(0030).
  5626*    -------------------------------
  5627     05  FILLER            PIC  X(0003).
  5628     05  DPROCDTO PIC  X(0008).
  5629*    -------------------------------
  5630     05  FILLER            PIC  X(0003).
  5631     05  DINPUTO PIC  X(0008).
  5632*    -------------------------------
  5633     05  FILLER            PIC  X(0003).
  5634     05  DMAINDTO PIC  X(0008).
  5635*    -------------------------------
  5636     05  FILLER            PIC  X(0003).
  5637     05  DCARRO PIC  X(0001).
  5638*    -------------------------------
  5639     05  FILLER            PIC  X(0003).
  5640     05  DGROUPO PIC  X(0006).
  5641*    -------------------------------
  5642     05  FILLER            PIC  X(0003).
  5643     05  DSTATEO PIC  X(0002).
  5644*    -------------------------------
  5645     05  FILLER            PIC  X(0003).
  5646     05  DACCTO PIC  X(0010).
  5647*    -------------------------------
  5648     05  FILLER            PIC  X(0003).
  5649     05  DRECVDTO PIC  X(0008).
  5650*    -------------------------------
  5651     05  FILLER            PIC  X(0003).
  5652     05  DCSRO PIC  X(0004).
  5653*    -------------------------------
  5654     05  FILLER            PIC  X(0003).
  5655     05  DREFHDGO PIC  X(0010).
  5656*    -------------------------------
  5657     05  FILLER            PIC  X(0003).
  5658     05  DREFO PIC  X(0012).
  5659*    -------------------------------
  5660     05  FILLER            PIC  X(0003).
  5661     05  DLFPHDGO PIC  X(0010).
  5662*    -------------------------------
  5663     05  FILLER            PIC  X(0003).
  5664     05  DAHPHDGO PIC  X(0010).
  5665*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 105
* EL6311.cbl
  5666     05  FILLER            PIC  X(0003).
  5667     05  DLFRHDGO PIC  X(0009).
  5668*    -------------------------------
  5669     05  FILLER            PIC  X(0003).
  5670     05  DAHRHDGO PIC  X(0009).
  5671*    -------------------------------
  5672     05  FILLER            PIC  X(0003).
  5673     05  DRISSO PIC  ZZ99-.
  5674*    -------------------------------
  5675     05  FILLER            PIC  X(0003).
  5676     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5677*    -------------------------------
  5678     05  FILLER            PIC  X(0003).
  5679     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5680*    -------------------------------
  5681     05  FILLER            PIC  X(0003).
  5682     05  DRCANCO PIC  ZZ99-.
  5683*    -------------------------------
  5684     05  FILLER            PIC  X(0003).
  5685     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5686*    -------------------------------
  5687     05  FILLER            PIC  X(0003).
  5688     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5689*    -------------------------------
  5690     05  FILLER            PIC  X(0003).
  5691     05  DEISSO PIC  ZZ99-.
  5692*    -------------------------------
  5693     05  FILLER            PIC  X(0003).
  5694     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5695*    -------------------------------
  5696     05  FILLER            PIC  X(0003).
  5697     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5698*    -------------------------------
  5699     05  FILLER            PIC  X(0003).
  5700     05  DECANCO PIC  ZZ99-.
  5701*    -------------------------------
  5702     05  FILLER            PIC  X(0003).
  5703     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5704*    -------------------------------
  5705     05  FILLER            PIC  X(0003).
  5706     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5707*    -------------------------------
  5708     05  FILLER            PIC  X(0003).
  5709     05  DCISSO PIC  ZZ99-.
  5710*    -------------------------------
  5711     05  FILLER            PIC  X(0003).
  5712     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5713*    -------------------------------
  5714     05  FILLER            PIC  X(0003).
  5715     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5716*    -------------------------------
  5717     05  FILLER            PIC  X(0003).
  5718     05  DCCANCO PIC  ZZ99-.
  5719*    -------------------------------
  5720     05  FILLER            PIC  X(0003).
  5721     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5722*    -------------------------------
  5723     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 106
* EL6311.cbl
  5724     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5725*    -------------------------------
  5726     05  FILLER            PIC  X(0003).
  5727     05  DOISSO PIC  ZZ99-.
  5728*    -------------------------------
  5729     05  FILLER            PIC  X(0003).
  5730     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5731*    -------------------------------
  5732     05  FILLER            PIC  X(0003).
  5733     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5734*    -------------------------------
  5735     05  FILLER            PIC  X(0003).
  5736     05  DOCANCO PIC  ZZ99-.
  5737*    -------------------------------
  5738     05  FILLER            PIC  X(0003).
  5739     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5740*    -------------------------------
  5741     05  FILLER            PIC  X(0003).
  5742     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5743*    -------------------------------
  5744     05  FILLER            PIC  X(0003).
  5745     05  DITOTALO PIC  ZZZ99.
  5746*    -------------------------------
  5747     05  FILLER            PIC  X(0003).
  5748     05  DIFATALO PIC  ZZZ99.
  5749*    -------------------------------
  5750     05  FILLER            PIC  X(0003).
  5751     05  DIFORCEO PIC  ZZZ99.
  5752*    -------------------------------
  5753     05  FILLER            PIC  X(0003).
  5754     05  DIHOLDO PIC  ZZZ99.
  5755*    -------------------------------
  5756     05  FILLER            PIC  X(0003).
  5757     05  DIAVAILO PIC  ZZZ99.
  5758*    -------------------------------
  5759     05  FILLER            PIC  X(0003).
  5760     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5761*    -------------------------------
  5762     05  FILLER            PIC  X(0003).
  5763     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5764*    -------------------------------
  5765     05  FILLER            PIC  X(0003).
  5766     05  DCTOTALO PIC  ZZZ99.
  5767*    -------------------------------
  5768     05  FILLER            PIC  X(0003).
  5769     05  DCFATALO PIC  ZZZ99.
  5770*    -------------------------------
  5771     05  FILLER            PIC  X(0003).
  5772     05  DCFORCEO PIC  ZZZ99.
  5773*    -------------------------------
  5774     05  FILLER            PIC  X(0003).
  5775     05  DCHOLDO PIC  ZZZ99.
  5776*    -------------------------------
  5777     05  FILLER            PIC  X(0003).
  5778     05  DCAVAILO PIC  ZZZ99.
  5779*    -------------------------------
  5780     05  FILLER            PIC  X(0003).
  5781     05  DCGPREMO PIC  ZZZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 107
* EL6311.cbl
  5782*    -------------------------------
  5783     05  FILLER            PIC  X(0003).
  5784     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5785*    -------------------------------
  5786     05  FILLER            PIC  X(0003).
  5787     05  DNTOTALO PIC  ---99.
  5788*    -------------------------------
  5789     05  FILLER            PIC  X(0003).
  5790     05  DNFATALO PIC  ---99.
  5791*    -------------------------------
  5792     05  FILLER            PIC  X(0003).
  5793     05  DNFORCEO PIC  ---99.
  5794*    -------------------------------
  5795     05  FILLER            PIC  X(0003).
  5796     05  DNHOLDO PIC  ---99.
  5797*    -------------------------------
  5798     05  FILLER            PIC  X(0003).
  5799     05  DNAVAILO PIC  ---99.
  5800*    -------------------------------
  5801     05  FILLER            PIC  X(0003).
  5802     05  DNGPREMO PIC  -------9.99.
  5803*    -------------------------------
  5804     05  FILLER            PIC  X(0003).
  5805     05  DNBPREMO PIC  -------9.99.
  5806*    -------------------------------
  5807     05  FILLER            PIC  X(0003).
  5808     05  DERMSGO PIC  X(0075).
  5809*    -------------------------------
  5810     05  FILLER            PIC  X(0003).
  5811     05  DPFENTRO PIC  X(0002).
  5812*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 108
* EL6311.cbl
  5814 01  MAP-B REDEFINES EL631BI.
  5815     12  FILLER                  PIC X(595).
  5816*    12  FILLER                  PIC X(591).
  5817*    12  FILLER                  PIC X(512).
  5818*    12  FILLER                  PIC X(510).
  5819     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5820         16  BKIND-LEN               PIC S9(4)  COMP.
  5821         16  BKIND-ATTRB             PIC X.
  5822         16  BKIND                   PIC XX.
  5823         16  BTYPE-LEN               PIC S9(4)  COMP.
  5824         16  BTYPE-ATTRB             PIC X.
  5825         16  BTYPE                   PIC X(3).
  5826         16  BTERM-LEN               PIC S9(4)  COMP.
  5827         16  BTERM-ATTRB             PIC X.
  5828         16  BTERMI                  PIC 999.
  5829         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5830         16  BBEN-LEN                PIC S9(4)  COMP.
  5831         16  BBEN-ATTRB              PIC X.
  5832         16  BBENI                   PIC 9(10)V99.
  5833*        16  BBENI                   PIC 9(12).
  5834         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5835         16  BPREM-LEN               PIC S9(4)  COMP.
  5836         16  BPREM-ATTRB             PIC X.
  5837         16  BPREMI                  PIC S9(9)V99.
  5838*        16  BPREMI                  PIC 9(11).
  5839         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5840         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5841         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5842         16  BEXPIRE-ATTRB           PIC X.
  5843         16  BEXPIRE                 PIC X(8).
  5844         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5845         16  BCRIT-PERD-ATTRB        PIC X.
  5846         16  BCRIT-PERDI             PIC 99.
  5847         16  BCRIT-PERDO REDEFINES
  5848                         BCRIT-PERDI PIC ZZ.
  5849         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5850         16  BALT-BEN-ATTRB          PIC X.
  5851         16  BALT-BENI               PIC 9(10)V99.
  5852*        16  BALT-BENI               PIC 9(12).
  5853         16  BALT-BENO REDEFINES
  5854                           BALT-BENI PIC Z(9).ZZ.
  5855         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5856         16  BALT-PREM-ATTRB         PIC X.
  5857         16  BALT-PREMI              PIC 9(9)V99.
  5858*        16  BALT-PREMI              PIC 9(11).
  5859         16  BALT-PREMO REDEFINES
  5860                          BALT-PREMI PIC Z(7).ZZ-.
  5861         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5862         16  BBEN-CD-ATTRB           PIC X.
  5863         16  BBEN-CD                 PIC XXX.
  5864         16  BCPREM-LEN              PIC S9(4)  COMP.
  5865         16  BCPREM-ATTRB            PIC X.
  5866         16  BCPREMI                 PIC S9(9)V99.
  5867*        16  BCPREMI                 PIC X(11).
  5868         16  BCPREMO REDEFINES BCPREMI
  5869                                     PIC Z(7).99-.
  5870         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5871         16  BCALT-PREM-ATTRB        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 109
* EL6311.cbl
  5872         16  BCALT-PREM              PIC Z(7).99-.
  5873         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5874         16  BBEN-ABBR-ATTRB         PIC X.
  5875         16  BBEN-ABBR               PIC X(5).
  5876         16  BDIFF-LEN               PIC S9(4)  COMP.
  5877         16  BDIFF-ATTRB             PIC X.
  5878         16  BDIFFO                  PIC Z(7).99-.
  5879         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5880         16  BBILL-LIT-ATTRB         PIC X.
  5881         16  BBILL-LIT               PIC X(8).
  5882         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5883         16  BDALT-PREM-ATTRB        PIC X.
  5884         16  BDALT-PREM              PIC Z(7).99-.
  5885
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 110
* EL6311.cbl
  5887
  5888****************************************************************
  5889*
  5890* Copyright (c) 2007-2013 Dell Inc.
  5891* All rights reserved.
  5892*
  5893****************************************************************
  5894 01  DFHEIV.
  5895   02  DFHEIV0               PIC X(35).
  5896   02  DFHEIV1               PIC X(08).
  5897   02  DFHEIV2               PIC X(08).
  5898   02  DFHEIV3               PIC X(08).
  5899   02  DFHEIV4               PIC X(06).
  5900   02  DFHEIV5               PIC X(04).
  5901   02  DFHEIV6               PIC X(04).
  5902   02  DFHEIV7               PIC X(02).
  5903   02  DFHEIV8               PIC X(02).
  5904   02  DFHEIV9               PIC X(01).
  5905   02  DFHEIV10              PIC S9(7) COMP-3.
  5906   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5907   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5908   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5909   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5910   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5911   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5912   02  DFHEIV17              PIC X(04).
  5913   02  DFHEIV18              PIC X(04).
  5914   02  DFHEIV19              PIC X(04).
  5915   02  DFHEIV20              USAGE IS POINTER.
  5916   02  DFHEIV21              USAGE IS POINTER.
  5917   02  DFHEIV22              USAGE IS POINTER.
  5918   02  DFHEIV23              USAGE IS POINTER.
  5919   02  DFHEIV24              USAGE IS POINTER.
  5920   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5921   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5922   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5923   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5924   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5925   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5926   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5927   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5928   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5929   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5930   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5931   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5932   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5933   02  FILLER                PIC X(02).
  5934   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5935   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5936   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5937   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5938   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5939   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5940   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5941 LINKAGE  SECTION.
  5942*****************************************************************
  5943*                                                               *
  5944* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 111
* EL6311.cbl
  5945* All rights reserved.                                          *
  5946*                                                               *
  5947*****************************************************************
  5948 01  dfheiblk.
  5949     02  eibtime          pic s9(7) comp-3.
  5950     02  eibdate          pic s9(7) comp-3.
  5951     02  eibtrnid         pic x(4).
  5952     02  eibtaskn         pic s9(7) comp-3.
  5953     02  eibtrmid         pic x(4).
  5954     02  dfheigdi         pic s9(4) comp.
  5955     02  eibcposn         pic s9(4) comp.
  5956     02  eibcalen         pic s9(4) comp.
  5957     02  eibaid           pic x(1).
  5958     02  eibfiller1       pic x(1).
  5959     02  eibfn            pic x(2).
  5960     02  eibfiller2       pic x(2).
  5961     02  eibrcode         pic x(6).
  5962     02  eibfiller3       pic x(2).
  5963     02  eibds            pic x(8).
  5964     02  eibreqid         pic x(8).
  5965     02  eibrsrce         pic x(8).
  5966     02  eibsync          pic x(1).
  5967     02  eibfree          pic x(1).
  5968     02  eibrecv          pic x(1).
  5969     02  eibsend          pic x(1).
  5970     02  eibatt           pic x(1).
  5971     02  eibeoc           pic x(1).
  5972     02  eibfmh           pic x(1).
  5973     02  eibcompl         pic x(1).
  5974     02  eibsig           pic x(1).
  5975     02  eibconf          pic x(1).
  5976     02  eiberr           pic x(1).
  5977     02  eibrldbk         pic x(1).
  5978     02  eiberrcd         pic x(4).
  5979     02  eibsynrb         pic x(1).
  5980     02  eibnodat         pic x(1).
  5981     02  eibfiller5       pic x(2).
  5982     02  eibresp          pic s9(8) comp.
  5983     02  eibresp2         pic s9(8) comp.
  5984     02  dfheigdj         pic s9(4) comp.
  5985     02  dfheigdk         pic s9(4) comp.
  5986 01  DFHCOMMAREA                 PIC X(1300).
  5987*                                COPY ERCPNDB.
  5988******************************************************************
  5989*                                                                *
  5990*                                                                *
  5991*                            ERCPNDB.                            *
  5992*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5993*                            VMOD=2.025                          *
  5994*                                                                *
  5995*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5996*                                                                *
  5997******************************************************************
  5998*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5999*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  6000******************************************************************
  6001*                                                                *
  6002*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 112
* EL6311.cbl
  6003*   FILE TYPE = VSAM,KSDS                                        *
  6004*   RECORD SIZE = 585  RECFORM = FIXED                           *
  6005*                                                                *
  6006*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  6007*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  6008*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  6009*                                                 RKP=13,LEN=36  *
  6010*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  6011*                                      AND CHG-SEQ.)             *
  6012*                                                RKP=49,LEN=11   *
  6013*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  6014*                                      AND CHG-SEQ.)             *
  6015*                                                RKP=60,LEN=15   *
  6016*                                                                *
  6017*   LOG = NO                                                     *
  6018*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6019******************************************************************
  6020******************************************************************
  6021*                   C H A N G E   L O G
  6022*
  6023* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6024*-----------------------------------------------------------------
  6025*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6026* EFFECTIVE    NUMBER
  6027*-----------------------------------------------------------------
  6028* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6029* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6030* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  6031* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6032* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  6033* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6034* 032306                   PEMA  ADD BOW LOAN NUMBER
  6035* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  6036* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  6037* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6038* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6039* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  6040* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  6041* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6042* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  6043* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  6044* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6045* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  6046* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6047* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  6048******************************************************************
  6049
  6050 01  PENDING-BUSINESS.
  6051     12  PB-RECORD-ID                     PIC XX.
  6052         88  VALID-PB-ID                        VALUE 'PB'.
  6053
  6054     12  PB-CONTROL-PRIMARY.
  6055         16  PB-COMPANY-CD                PIC X.
  6056         16  PB-ENTRY-BATCH               PIC X(6).
  6057         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  6058         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  6059
  6060     12  PB-CONTROL-BY-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 113
* EL6311.cbl
  6061         16  PB-COMPANY-CD-A1             PIC X.
  6062         16  PB-CARRIER                   PIC X.
  6063         16  PB-GROUPING.
  6064             20  PB-GROUPING-PREFIX       PIC XXX.
  6065             20  PB-GROUPING-PRIME        PIC XXX.
  6066         16  PB-STATE                     PIC XX.
  6067         16  PB-ACCOUNT.
  6068             20  PB-ACCOUNT-PREFIX        PIC X(4).
  6069             20  PB-ACCOUNT-PRIME         PIC X(6).
  6070         16  PB-CERT-EFF-DT               PIC XX.
  6071         16  PB-CERT-NO.
  6072             20  PB-CERT-PRIME            PIC X(10).
  6073             20  PB-CERT-SFX              PIC X.
  6074         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  6075
  6076         16  PB-RECORD-TYPE               PIC X.
  6077             88  PB-MAILING-DATA                VALUE '0'.
  6078             88  PB-ISSUE                       VALUE '1'.
  6079             88  PB-CANCELLATION                VALUE '2'.
  6080             88  PB-BATCH-TRAILER               VALUE '9'.
  6081
  6082     12  PB-CONTROL-BY-ORIG-BATCH.
  6083         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  6084         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  6085         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  6086         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  6087
  6088     12  PB-CONTROL-BY-CSR.
  6089         16  PB-CSR-COMPANY-CD            PIC X.
  6090         16  PB-CSR-ID                    PIC X(4).
  6091         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  6092         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  6093         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  6094******************************************************************
  6095*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  6096******************************************************************
  6097
  6098     12  PB-LAST-MAINT-DT                 PIC XX.
  6099     12  PB-LAST-MAINT-BY                 PIC X(4).
  6100     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  6101
  6102     12  PB-RECORD-BODY                   PIC X(375).
  6103
  6104     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  6105         16  PB-CERT-ORIGIN               PIC X.
  6106             88  CLASIC-CREATED-CERT         VALUE '1'.
  6107         16  PB-I-NAME.
  6108             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  6109             20  PB-I-INSURED-FIRST-NAME.
  6110                 24  PB-I-INSURED-1ST-INIT PIC X.
  6111                 24  FILLER                PIC X(9).
  6112             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  6113         16  PB-I-AGE                     PIC S99   COMP-3.
  6114         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  6115         16  PB-I-BIRTHDAY                PIC XX.
  6116         16  PB-I-INSURED-SEX             PIC X.
  6117             88  PB-SEX-MALE     VALUE 'M'.
  6118             88  PB-SEX-FEMALE   VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 114
* EL6311.cbl
  6119
  6120         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  6121         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  6122         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  6123         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  6124         16  PB-I-SKIP-CODE               PIC X.
  6125             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  6126             88  PB-SKIP-JULY              VALUE '1'.
  6127             88  PB-SKIP-AUGUST            VALUE '2'.
  6128             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  6129             88  PB-SKIP-JULY-AUG          VALUE '4'.
  6130             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  6131             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  6132             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  6133             88  PB-SKIP-JUNE              VALUE '8'.
  6134             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  6135             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6136             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6137         16  PB-I-TERM-TYPE               PIC X.
  6138             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6139             88  PB-PAID-WEEKLY            VALUE 'W'.
  6140             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6141             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6142             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6143         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6144         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6145         16  PB-I-DATA-ENTRY-SW           PIC X.
  6146             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6147             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6148             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6149             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6150         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6151         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6152*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6153         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6154         16  PB-I-LETTER-REQD             PIC X.
  6155
  6156         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6157             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6158             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6159                                                   '90' THRU '99'.
  6160         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6161                                          PIC XX.
  6162         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6163         16  PB-I-AMOUNT-FINANCED REDEFINES
  6164                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6165         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6166         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6167                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6168         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6169         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6170         16  PB-I-CLP-AMOUNT REDEFINES
  6171                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6172         16  PB-I-LF-CALC-FLAG            PIC X.
  6173             88 PB-COMP-LF-PREM               VALUE '?'.
  6174         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6175         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6176         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 115
* EL6311.cbl
  6177         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6178         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6179         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6180         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6181         16  PB-I-LF-ABBR                 PIC XXX.
  6182         16  PB-I-LF-INPUT-CD             PIC XX.
  6183
  6184         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6185             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6186             88  PB-INVALID-AH               VALUE '  ' '00'
  6187                                                   '90' THRU '99'.
  6188         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6189         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6190         16  PB-I-AH-CALC-FLAG            PIC X.
  6191             88 PB-COMP-AH-PREM                  VALUE '?'.
  6192         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6193         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6194         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  6195         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6196         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6197         16  PB-I-AH-ABBR                 PIC XXX.
  6198         16  PB-I-AH-INPUT-CD             PIC XXX.
  6199
  6200         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6201         16  PB-I-REIN-TABLE              PIC XXX.
  6202         16  PB-I-BUSINESS-TYPE           PIC 99.
  6203         16  PB-I-INDV-GRP-CD             PIC X.
  6204         16  PB-I-MORT-CODE.
  6205             20  PB-I-TABLE               PIC X.
  6206             20  PB-I-INTEREST            PIC XX.
  6207             20  PB-I-MORT-TYP            PIC X.
  6208         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6209         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6210         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6211         16  PB-I-INDV-GRP-OVRD           PIC X.
  6212         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6213         16  PB-I-SIG-SW                  PIC X.
  6214             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6215         16  PB-I-RATE-CLASS              PIC XX.
  6216         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6217         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6218         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6219         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6220         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6221         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6222         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6223         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6224         16  PB-I-OB-FLAG                 PIC X.
  6225             88  PB-I-OB                      VALUE 'B'.
  6226             88  PB-I-SUMMARY                 VALUE 'Z'.
  6227         16  PB-I-ENTRY-STATUS            PIC X.
  6228             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6229                                              'M' '5' '9' '2'.
  6230             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6231             88  PB-I-POLICY-PENDING          VALUE '2'.
  6232             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6233             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6234             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 116
* EL6311.cbl
  6235             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6236             88  PB-I-REIN-ONLY               VALUE '9'.
  6237             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6238             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6239             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6240             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6241         16  PB-I-INT-CODE                PIC X.
  6242             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6243             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6244         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6245         16  PB-I-SOC-SEC-NO              PIC X(11).
  6246         16  PB-I-MEMBER-NO               PIC X(12).
  6247         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6248*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6249         16  PB-I-OLD-LOF                 PIC XXX.
  6250         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6251         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6252         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6253         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6254         16  PB-I-LIFE-INDICATOR          PIC X.
  6255             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6256         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6257         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6258                                          PIC S9(5)V99    COMP-3.
  6259         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6260             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6261             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6262         16  PB-I-1ST-PMT-DT              PIC XX.
  6263         16  PB-I-JOINT-INSURED.
  6264             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6265             20 PB-I-JOINT-FIRST-NAME.
  6266                24  PB-I-JOINT-FIRST-INIT PIC X.
  6267                24  FILLER                PIC X(9).
  6268             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6269*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6270         16  PB-I-BENEFICIARY-NAME.
  6271             20  PB-I-BANK-NUMBER         PIC X(10).
  6272             20  FILLER                   PIC X(15).
  6273         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6274         16  PB-I-REFERENCE               PIC X(12).
  6275         16  FILLER REDEFINES PB-I-REFERENCE.
  6276             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6277             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6278             20  PB-I-CLP-STATE           PIC XX.
  6279         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6280             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6281             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6282             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6283         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6284         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6285         16  PB-I-RESIDENT-STATE          PIC XX.
  6286         16  PB-I-RATE-CODE               PIC X(4).
  6287         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6288         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6289         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6290         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6291         16  PB-I-BANK-NOCHRGB            PIC 99.
  6292         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 117
* EL6311.cbl
  6293         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6294
  6295     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6296         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6297             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6298         16  PB-C-CANCEL-ORIGIN           PIC X.
  6299             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6300         16  PB-C-LF-CANCEL-DT            PIC XX.
  6301         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6302         16  PB-C-LF-CALC-REQ             PIC X.
  6303             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6304         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6305         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6306         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6307             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6308         16  PB-C-AH-CANCEL-DT            PIC XX.
  6309         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6310         16  PB-C-AH-CALC-REQ             PIC X.
  6311             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6312         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6313         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6314         16  PB-C-LAST-NAME               PIC X(15).
  6315         16  PB-C-REFUND-SW               PIC X.
  6316             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6317             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6318         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6319         16  PB-C-PAYEE-CODE              PIC X(6).
  6320         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6321         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6322         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6323         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6324         16  PB-C-REFERENCE               PIC X(12).
  6325         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6326         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6327         16  PB-C-POST-CARD-IND           PIC X.
  6328         16  PB-C-CANCEL-REASON           PIC X.
  6329         16  PB-C-REF-INTERFACE-SW        PIC X.
  6330         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6331         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6332         16  FILLER                       PIC X(01).
  6333*        16  FILLER                       PIC X(18).
  6334         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6335*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6336         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  6337         16  PB-CANCELED-CERT-DATA.
  6338             20  PB-CI-INSURED-NAME.
  6339                 24  PB-CI-LAST-NAME      PIC X(15).
  6340                 24  PB-CI-INITIALS       PIC XX.
  6341             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6342             20  PB-CI-INSURED-SEX        PIC X.
  6343             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6344             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6345             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6346             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6347             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6348             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6349             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6350             20  PB-CI-AH-BENEFIT-CD      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 118
* EL6311.cbl
  6351             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6352             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6353             20  PB-CI-RATE-CLASS         PIC XX.
  6354             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6355             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6356             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6357             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6358             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6359             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6360             20  PB-CI-LF-ABBR            PIC X(3).
  6361             20  PB-CI-AH-ABBR            PIC X(3).
  6362             20  PB-CI-OB-FLAG            PIC X.
  6363                 88  PB-CI-OB                VALUE 'B'.
  6364             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6365                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6366                                           'M' '4' '5' '9' '2'.
  6367                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6368                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6369                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6370                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6371                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6372                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6373                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6374                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6375                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6376                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6377                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6378                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6379                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6380             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6381                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6382                                           'M' '4' '5' '9' '2'.
  6383                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6384                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6385                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6386                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6387                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6388                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6389                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6390                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6391                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6392                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6393                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6394                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6395                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6396             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6397             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6398             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6399             20  PB-CI-MEMBER-NO          PIC X(12).
  6400             20  PB-CI-INT-CODE           PIC X.
  6401                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6402                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6403             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6404             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6405             20  PB-CI-COMP-EXCP-SW       PIC X.
  6406                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6407                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6408             20  PB-CI-ENTRY-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 119
* EL6311.cbl
  6409             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6410             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6411             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6412             20  PB-CI-DEATH-DT           PIC XX.
  6413             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6414             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6415             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6416             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6417             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6418             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6419             20  PB-CI-ENTRY-DT              PIC XX.
  6420             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6421             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6422             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6423             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6424             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6425             20  PB-CI-OLD-LOF               PIC XXX.
  6426*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6427             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6428             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6429             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6430             20  PB-CI-INDV-GRP-CD           PIC X.
  6431             20  PB-CI-BENEFICIARY-NAME.
  6432                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6433                 24  FILLER                  PIC X(15).
  6434             20  PB-CI-NOTE-SW               PIC X.
  6435             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6436             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6437             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6438             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6439             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6440             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6441             20  PB-CI-FIRST-NAME            PIC X(10).
  6442             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6443
  6444         16  FILLER                       PIC X(13).
  6445*032306  16  FILLER                       PIC X(27).
  6446*        16  FILLER                       PIC X(46).
  6447
  6448     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6449         16  FILLER                       PIC X(10).
  6450         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6451         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6452         16  PB-M-INSURED-MID-INIT        PIC X.
  6453         16  PB-M-INSURED-AGE             PIC 99.
  6454         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6455         16  PB-M-INSURED-SEX             PIC X.
  6456         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6457         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6458         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6459         16  PB-M-INSURED-CITY-STATE.
  6460             20  PB-M-INSURED-CITY        PIC X(28).
  6461             20  PB-M-INSURED-STATE       PIC XX.
  6462         16  PB-M-INSURED-ZIP-CODE.
  6463             20  PB-M-INSURED-ZIP-PRIME.
  6464                 24  PB-M-INSURED-ZIP-1   PIC X.
  6465                     88  PB-M-CANADIAN-POST-CODE
  6466                                             VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 120
* EL6311.cbl
  6467                 24  FILLER               PIC X(4).
  6468             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6469         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6470                                        PB-M-INSURED-ZIP-CODE.
  6471             20  PM-M-INS-CAN-POST1       PIC XXX.
  6472             20  PM-M-INS-CAN-POST2       PIC XXX.
  6473             20  FILLER                   PIC XXX.
  6474         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6475         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6476         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6477         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6478         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6479         16  PB-M-CRED-BENE-CITYST.
  6480             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6481             20  PB-M-CRED-BENE-STATE     PIC XX.
  6482         16  FILLER                       PIC X(92).
  6483
  6484     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6485         16  FILLER                       PIC X(10).
  6486         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6487         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6488         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6489         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6490         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6491         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6492         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6493         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6494         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6495         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6496         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6497         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6498         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6499         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6500         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6501         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6502         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6503         16  PB-ACCOUNT-NAME              PIC X(30).
  6504         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6505         16  PB-REFERENCE                 PIC X(12).
  6506         16  PB-B-RECEIVED-DT             PIC XX.
  6507         16  FILLER                       PIC X(234).
  6508
  6509     12  PB-RECORD-STATUS.
  6510         16  PB-CREDIT-SELECT-DT          PIC XX.
  6511         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6512         16  PB-BILLED-DT                 PIC XX.
  6513         16  PB-BILLING-STATUS            PIC X.
  6514             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6515             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6516             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6517         16  PB-RECORD-BILL               PIC X.
  6518             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6519             88  PB-RECORD-RETURNED           VALUE 'R'.
  6520             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6521             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6522             88  PB-OVERRIDE-AH               VALUE 'A'.
  6523             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6524         16  PB-BATCH-ENTRY               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 121
* EL6311.cbl
  6525             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6526             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6527             88  PB-REISSUED-CERT             VALUE 'E'.
  6528             88  PB-CASH-CERT                 VALUE 'C'.
  6529             88  PB-MONTHLY-CERT              VALUE 'M'.
  6530             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6531             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6532             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6533         16  PB-FORCE-CODE                PIC X.
  6534             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6535             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6536             88  PB-CANCEL-FORCE              VALUE '8'.
  6537             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6538             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6539             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6540             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6541             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6542             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6543             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6544             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6545         16  PB-FATAL-FLAG                PIC X.
  6546             88  PB-FATAL-ERRORS              VALUE 'X'.
  6547         16  PB-FORCE-ER-CD               PIC X.
  6548             88  PB-FORCE-ERRORS              VALUE 'F'.
  6549             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6550         16  PB-WARN-ER-CD                PIC X.
  6551             88  PB-WARNING-ERRORS            VALUE 'W'.
  6552         16  FILLER                       PIC X.
  6553         16  PB-OUT-BAL-CD                PIC X.
  6554             88  PB-OUT-OF-BAL                VALUE 'O'.
  6555         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6556         16  PB-AH-OVERRIDE-L1            PIC X.
  6557         16  PB-INPUT-DT                  PIC XX.
  6558         16  PB-INPUT-BY                  PIC X(4).
  6559         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6560         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6561         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6562         16  PB-LF-EARNING-METHOD         PIC X.
  6563         16  PB-AH-EARNING-METHOD         PIC X.
  6564         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6565         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6566         16  PB-REIN-CD                   PIC XXX.
  6567         16  PB-LF-REFUND-TYPE            PIC X.
  6568         16  PB-AH-REFUND-TYPE            PIC X.
  6569         16  PB-ACCT-EFF-DT               PIC XX.
  6570         16  PB-ACCT-EXP-DT               PIC XX.
  6571         16  PB-COMPANY-ID                PIC X(3).
  6572         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6573         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6574         16  PB-SV-CARRIER                PIC X.
  6575         16  PB-SV-GROUPING               PIC X(6).
  6576         16  PB-SV-STATE                  PIC XX.
  6577         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6578         16  PB-GA-BILLING-INFO.
  6579             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6580                                          PIC XX.
  6581         16  PB-SV-REMIT-TO  REDEFINES
  6582             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 122
* EL6311.cbl
  6583         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6584         16  PB-I-LOAN-OFFICER            PIC X(5).
  6585         16  PB-I-VIN                     PIC X(17).
  6586
  6587         16  FILLER                       PIC X(04).
  6588         16  IMNET-BYPASS-SW              PIC X.
  6589
  6590******************************************************************
  6591*                COMMON EDIT ERRORS                              *
  6592******************************************************************
  6593
  6594     12  PB-COMMON-ERRORS.
  6595         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6596                                           PIC S9(4)     COMP.
  6597
  6598******************************************************************
  6599*                                COPY ELCCERT.
  6600******************************************************************
  6601*                                                                *
  6602*                            ELCCERT.                            *
  6603*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6604*                            VMOD=2.013                          *
  6605*                                                                *
  6606*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6607*                                                                *
  6608*   FILE TYPE = VSAM,KSDS                                        *
  6609*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6610*                                                                *
  6611*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6612*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6613*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6614*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6615*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6616*                                                                *
  6617*   LOG = YES                                                    *
  6618*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6619******************************************************************
  6620*                   C H A N G E   L O G
  6621*
  6622* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6623*-----------------------------------------------------------------
  6624*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6625* EFFECTIVE    NUMBER
  6626*-----------------------------------------------------------------
  6627* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6628* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6629* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6630* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6631* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6632* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6633* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6634* 032612  CR2011110200001  PEMA  AHL CHANGES
  6635* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6636* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6637* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6638******************************************************************
  6639
  6640 01  CERTIFICATE-MASTER.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 123
* EL6311.cbl
  6641     12  CM-RECORD-ID                      PIC XX.
  6642         88  VALID-CM-ID                      VALUE 'CM'.
  6643
  6644     12  CM-CONTROL-PRIMARY.
  6645         16  CM-COMPANY-CD                 PIC X.
  6646         16  CM-CARRIER                    PIC X.
  6647         16  CM-GROUPING.
  6648             20  CM-GROUPING-PREFIX        PIC X(3).
  6649             20  CM-GROUPING-PRIME         PIC X(3).
  6650         16  CM-STATE                      PIC XX.
  6651         16  CM-ACCOUNT.
  6652             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6653             20  CM-ACCOUNT-PRIME          PIC X(6).
  6654         16  CM-CERT-EFF-DT                PIC XX.
  6655         16  CM-CERT-NO.
  6656             20  CM-CERT-PRIME             PIC X(10).
  6657             20  CM-CERT-SFX               PIC X.
  6658
  6659     12  CM-CONTROL-BY-NAME.
  6660         16  CM-COMPANY-CD-A1              PIC X.
  6661         16  CM-INSURED-LAST-NAME          PIC X(15).
  6662         16  CM-INSURED-INITIALS.
  6663             20  CM-INSURED-INITIAL1       PIC X.
  6664             20  CM-INSURED-INITIAL2       PIC X.
  6665
  6666     12  CM-CONTROL-BY-SSN.
  6667         16  CM-COMPANY-CD-A2              PIC X.
  6668         16  CM-SOC-SEC-NO.
  6669             20  CM-SSN-STATE              PIC XX.
  6670             20  CM-SSN-ACCOUNT            PIC X(6).
  6671             20  CM-SSN-LN3.
  6672                 25  CM-INSURED-INITIALS-A2.
  6673                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6674                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6675                 25 CM-PART-LAST-NAME-A2         PIC X.
  6676
  6677     12  CM-CONTROL-BY-CERT-NO.
  6678         16  CM-COMPANY-CD-A4              PIC X.
  6679         16  CM-CERT-NO-A4                 PIC X(11).
  6680
  6681     12  CM-CONTROL-BY-MEMB.
  6682         16  CM-COMPANY-CD-A5              PIC X.
  6683         16  CM-MEMBER-NO.
  6684             20  CM-MEMB-STATE             PIC XX.
  6685             20  CM-MEMB-ACCOUNT           PIC X(6).
  6686             20  CM-MEMB-LN4.
  6687                 25  CM-INSURED-INITIALS-A5.
  6688                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6689                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6690                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6691
  6692     12  CM-INSURED-PROFILE-DATA.
  6693         16  CM-INSURED-FIRST-NAME.
  6694             20  CM-INSURED-1ST-INIT       PIC X.
  6695             20  FILLER                    PIC X(9).
  6696         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6697         16  CM-INSURED-SEX                PIC X.
  6698             88  CM-SEX-MALE                  VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 124
* EL6311.cbl
  6699             88  CM-SEX-FEMAL                 VALUE 'F'.
  6700         16  CM-INSURED-JOINT-AGE          PIC 99.
  6701         16  CM-JOINT-INSURED-NAME.
  6702             20  CM-JT-LAST-NAME           PIC X(15).
  6703             20  CM-JT-FIRST-NAME.
  6704                 24  CM-JT-1ST-INIT        PIC X.
  6705                 24  FILLER                PIC X(9).
  6706             20  CM-JT-INITIAL             PIC X.
  6707
  6708     12  CM-LIFE-DATA.
  6709         16  CM-LF-BENEFIT-CD              PIC XX.
  6710         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6711         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6712         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6713         16  CM-LF-DEV-CODE                PIC XXX.
  6714         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6715         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6716         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6717         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6718         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6719         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6720         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6721         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6722         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6723         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6724         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6725         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6726         16  cm-temp-epiq                  pic xx.
  6727             88  EPIQ-CLASS                  value 'EQ'.
  6728*        16  FILLER                        PIC XX.
  6729
  6730     12  CM-AH-DATA.
  6731         16  CM-AH-BENEFIT-CD              PIC XX.
  6732         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6733         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6734         16  CM-AH-DEV-CODE                PIC XXX.
  6735         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6736         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6737         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6738         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6739         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6740         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6741         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6742         16  CM-AH-PAID-THRU-DT            PIC XX.
  6743             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6744         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6745         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6746         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6747         16  FILLER                        PIC X.
  6748
  6749     12  CM-LOAN-INFORMATION.
  6750         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6751         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6752                                           PIC S9(5)V99  COMP-3.
  6753         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6754         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6755         16  CM-PAY-FREQUENCY              PIC S99.
  6756         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 125
* EL6311.cbl
  6757         16  CM-RATE-CLASS                 PIC XX.
  6758         16  CM-BENEFICIARY                PIC X(25).
  6759         16  CM-POLICY-FORM-NO             PIC X(12).
  6760         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6761         16  CM-LAST-ADD-ON-DT             PIC XX.
  6762         16  CM-DEDUCTIBLE-AMOUNTS.
  6763             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6764             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6765         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6766             20  CM-RESIDENT-STATE         PIC XX.
  6767             20  CM-RATE-CODE              PIC X(4).
  6768             20  FILLER                    PIC XX.
  6769         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6770             20  CM-LOAN-OFFICER           PIC X(5).
  6771             20  FILLER                    PIC XXX.
  6772         16  CM-CSR-CODE                   PIC XXX.
  6773         16  CM-UNDERWRITING-CODE          PIC X.
  6774             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6775         16  CM-POST-CARD-IND              PIC X.
  6776         16  CM-REF-INTERFACE-SW           PIC X.
  6777         16  CM-PREMIUM-TYPE               PIC X.
  6778             88  CM-SING-PRM                  VALUE '1'.
  6779             88  CM-O-B-COVERAGE              VALUE '2'.
  6780             88  CM-OPEN-END                  VALUE '3'.
  6781         16  CM-IND-GRP-TYPE               PIC X.
  6782             88  CM-INDIVIDUAL                VALUE 'I'.
  6783             88  CM-GROUP                     VALUE 'G'.
  6784         16  CM-SKIP-CODE                  PIC X.
  6785             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6786             88  SKIP-JULY                    VALUE '1'.
  6787             88  SKIP-AUGUST                  VALUE '2'.
  6788             88  SKIP-SEPTEMBER               VALUE '3'.
  6789             88  SKIP-JULY-AUG                VALUE '4'.
  6790             88  SKIP-AUG-SEPT                VALUE '5'.
  6791             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6792             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6793             88  SKIP-JUNE                    VALUE '8'.
  6794             88  SKIP-JUNE-JULY               VALUE '9'.
  6795             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6796             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6797         16  CM-PAYMENT-MODE               PIC X.
  6798             88  PAY-MONTHLY                  VALUE SPACE.
  6799             88  PAY-WEEKLY                   VALUE '1'.
  6800             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6801             88  PAY-BI-WEEKLY                VALUE '3'.
  6802             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6803         16  CM-LOAN-NUMBER                PIC X(8).
  6804         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6805         16  CM-OLD-LOF                    PIC XXX.
  6806*        16  CM-LOAN-OFFICER               PIC XXX.
  6807         16  CM-REIN-TABLE                 PIC XXX.
  6808         16  CM-SPECIAL-REIN-CODE          PIC X.
  6809         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6810         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6811         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6812
  6813     12  CM-STATUS-DATA.
  6814         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 126
* EL6311.cbl
  6815         16  CM-ENTRY-DT                   PIC XX.
  6816
  6817         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6818         16  CM-LF-CANCEL-DT               PIC XX.
  6819         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6820
  6821         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6822         16  CM-LF-DEATH-DT                PIC XX.
  6823         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6824
  6825         16  CM-LF-CURRENT-STATUS          PIC X.
  6826             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6827                                                'M' '4' '5' '9'.
  6828             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6829             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6830             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6831             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6832             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6833             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6834             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6835             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6836             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6837             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6838             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6839             88  CM-LF-DECLINED               VALUE 'D'.
  6840             88  CM-LF-VOIDED                 VALUE 'V'.
  6841
  6842         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6843         16  CM-AH-CANCEL-DT               PIC XX.
  6844         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6845
  6846         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6847         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6848         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6849
  6850         16  CM-AH-CURRENT-STATUS          PIC X.
  6851             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6852                                                'M' '4' '5' '9'.
  6853             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6854             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6855             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6856             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6857             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6858             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6859             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6860             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6861             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6862             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6863             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6864             88  CM-AH-DECLINED               VALUE 'D'.
  6865             88  CM-AH-VOIDED                 VALUE 'V'.
  6866
  6867         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6868             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6869             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6870             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6871         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6872
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 127
* EL6311.cbl
  6873         16  CM-ENTRY-BATCH                PIC X(6).
  6874         16  CM-LF-EXIT-BATCH              PIC X(6).
  6875         16  CM-AH-EXIT-BATCH              PIC X(6).
  6876         16  CM-LAST-MONTH-END             PIC XX.
  6877
  6878     12  CM-NOTE-SW                        PIC X.
  6879         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6880         88  CERT-NOTES-PRESENT               VALUE '1'.
  6881         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6882         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6883         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6884         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6885         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6886         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6887     12  CM-COMP-EXCP-SW                   PIC X.
  6888         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6889         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6890     12  CM-INSURED-ADDRESS-SW             PIC X.
  6891         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6892         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6893
  6894*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6895     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6896     12  FILLER                            PIC X.
  6897
  6898*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6899     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6900     12  FILLER                            PIC X.
  6901*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6902     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  6903
  6904     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6905         88  CERT-ADDED-BATCH                 VALUE ' '.
  6906         88  CERT-ADDED-ONLINE                VALUE '1'.
  6907         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6908         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6909         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6910     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6911         88  CERT-AS-LOADED                   VALUE ' '.
  6912         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6913         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6914         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6915         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6916         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6917         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6918         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6919
  6920     12  CM-ACCOUNT-COMM-PCTS.
  6921         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6922         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6923
  6924     12  CM-USER-FIELD                     PIC X.
  6925     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6926     12  CM-CLP-STATE                      PIC XX.
  6927     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6928     12  CM-USER-RESERVED                  PIC XXX.
  6929     12  FILLER REDEFINES CM-USER-RESERVED.
  6930         16  CM-AH-CLASS-CD                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 128
* EL6311.cbl
  6931         16  F                             PIC X.
  6932******************************************************************
  6933*                                COPY ERCNOTE.
  6934******************************************************************
  6935*                                                                *
  6936*                                                                *
  6937*                            ERCNOTE                             *
  6938*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6939*                            VMOD=2.003                          *
  6940*                                                                *
  6941*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6942*                                                                *
  6943*        FILE TYPE= VSAM,KSDS                                    *
  6944*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6945*                                                                *
  6946*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6947*                                                                *
  6948*        LOG = YES                                               *
  6949*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6950*                                                                *
  6951******************************************************************
  6952*                   C H A N G E   L O G
  6953*
  6954* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6955*-----------------------------------------------------------------
  6956*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6957* EFFECTIVE    NUMBER
  6958*-----------------------------------------------------------------
  6959* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6960*                                FILE WILL CONTAIN BILLING NOTES O
  6961******************************************************************
  6962
  6963 01  CERTIFICATE-NOTE.
  6964     12  CN-RECORD-ID                PIC  XX.
  6965         88  VALID-CN-ID                  VALUE 'CN'.
  6966
  6967     12  CN-CONTROL-PRIMARY.
  6968         16  CN-COMPANY-CD           PIC X.
  6969         16  CN-CARRIER              PIC X.
  6970         16  CN-GROUPING.
  6971             20 CN-GROUPING-PREFIX   PIC XXX.
  6972             20 CN-GROUPING-PRIME    PIC XXX.
  6973         16  CN-STATE                PIC XX.
  6974         16  CN-ACCOUNT.
  6975             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6976             20 CN-ACCOUNT-PRIME     PIC X(6).
  6977         16  CN-CERT-EFF-DT          PIC XX.
  6978         16  CN-CERT-NO.
  6979             20  CN-CERT-PRIME       PIC X(10).
  6980             20  CN-CERT-SFX         PIC X.
  6981
  6982     12  CN-BILLING-START-LINE-NO    PIC 99.
  6983     12  CN-BILLING-END-LINE-NO      PIC 99.
  6984
  6985     12  CN-LINES.
  6986         16  CN-LINE OCCURS 10       PIC X(77).
  6987
  6988     12  CN-LAST-MAINT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 129
* EL6311.cbl
  6989     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6990     12  CN-LAST-MAINT-USER          PIC X(4).
  6991     12  FILLER                      PIC X(6).
  6992******************************************************************
  6993*                                COPY ERCPNDM.
  6994******************************************************************
  6995*                                                                *
  6996*                                                                *
  6997*                            ERCPNDM                             *
  6998*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6999*                            VMOD=2.003                          *
  7000*                                                                *
  7001*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  7002*                                                                *
  7003*   FILE TYPE = VSAM,KSDS                                        *
  7004*   RECORD SIZE = 374   RECFORM = FIX                            *
  7005*                                                                *
  7006*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  7007*   ALTERNATE PATH    = NOT USED                                 *
  7008*                                                                *
  7009*   LOG = YES                                                    *
  7010*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7011******************************************************************
  7012*                   C H A N G E   L O G
  7013*
  7014* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7015*-----------------------------------------------------------------
  7016*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7017* EFFECTIVE    NUMBER
  7018*-----------------------------------------------------------------
  7019* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7020* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  7021* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7022* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7023******************************************************************
  7024
  7025 01  PENDING-MAILING-DATA.
  7026     12  PM-RECORD-ID                      PIC XX.
  7027         88  VALID-MA-ID                       VALUE 'PM'.
  7028
  7029     12  PM-CONTROL-PRIMARY.
  7030         16  PM-COMPANY-CD                 PIC X.
  7031         16  PM-ENTRY-BATCH                PIC X(6).
  7032         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  7033         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  7034
  7035     12  FILLER                            PIC X(14).
  7036
  7037     12  PM-ACCESS-CONTROL.
  7038         16  PM-SOURCE-SYSTEM              PIC XX.
  7039             88  PM-FROM-CREDIT                VALUE 'CR'.
  7040             88  PM-FROM-VSI                   VALUE 'VS'.
  7041             88  PM-FROM-WARRANTY              VALUE 'WA'.
  7042             88  PM-FROM-OTHER                 VALUE 'OT'.
  7043         16  PM-RECORD-ADD-DT              PIC XX.
  7044         16  PM-RECORD-ADDED-BY            PIC XXXX.
  7045         16  PM-LAST-MAINT-DT              PIC XX.
  7046         16  PM-LAST-MAINT-BY              PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 130
* EL6311.cbl
  7047         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7048
  7049     12  PM-PROFILE-INFO.
  7050         16  PM-QUALIFY-CODE-1             PIC XX.
  7051         16  PM-QUALIFY-CODE-2             PIC XX.
  7052         16  PM-QUALIFY-CODE-3             PIC XX.
  7053         16  PM-QUALIFY-CODE-4             PIC XX.
  7054         16  PM-QUALIFY-CODE-5             PIC XX.
  7055
  7056         16  PM-INSURED-LAST-NAME          PIC X(15).
  7057         16  PM-INSURED-FIRST-NAME         PIC X(10).
  7058         16  PM-INSURED-MIDDLE-INIT        PIC X.
  7059         16  PM-INSURED-ISSUE-AGE          PIC 99.
  7060         16  PM-INSURED-BIRTH-DT           PIC XX.
  7061         16  PM-INSURED-SEX                PIC X.
  7062             88  PM-SEX-MALE                   VALUE 'M'.
  7063             88  PM-SEX-FEMALE                 VALUE 'F'.
  7064         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  7065
  7066         16  PM-ADDRESS-CORRECTED          PIC X.
  7067         16  PM-JOINT-BIRTH-DT             PIC XX.
  7068*        16  FILLER                        PIC X(12).
  7069
  7070         16  PM-ADDRESS-LINE-1             PIC X(30).
  7071         16  PM-ADDRESS-LINE-2             PIC X(30).
  7072         16  PM-CITY-STATE.
  7073             20  PM-CITY                   PIC X(28).
  7074             20  PM-STATE                  PIC XX.
  7075         16  PM-ZIP.
  7076             20  PM-ZIP-CODE.
  7077                 24  PM-ZIP-1              PIC X.
  7078                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7079                 24  FILLER                PIC X(4).
  7080             20  PM-ZIP-PLUS4              PIC X(4).
  7081         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  7082             20  PM-CAN-POST1              PIC XXX.
  7083             20  PM-CAN-POST2              PIC XXX.
  7084             20  FILLER                    PIC XXX.
  7085
  7086         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  7087         16  pm-city-st-zip-verified       pic x.
  7088         16  FILLER                        PIC XX.
  7089
  7090     12  PM-CRED-BENE-INFO.
  7091         16  PM-CRED-BENE-NAME             PIC X(25).
  7092         16  PM-CRED-BENE-ADDR             PIC X(30).
  7093         16  PM-CRED-BENE-ADDR2            PIC X(30).
  7094         16  PM-CRED-BENE-CTYST.
  7095             20  PM-CRED-BENE-CITY         PIC X(28).
  7096             20  PM-CRED-BENE-STATE        PIC XX.
  7097         16  PM-CRED-BENE-ZIP.
  7098             20  PM-CB-ZIP-CODE.
  7099                 24  PM-CB-ZIP-1           PIC X.
  7100                     88  PM-CB-CANADIAN-POST-CODE
  7101                                  VALUE 'A' THRU 'Z'.
  7102                 24  FILLER                PIC X(4).
  7103             20  PM-CB-ZIP-PLUS4           PIC X(4).
  7104         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 131
* EL6311.cbl
  7105             20  PM-CB-CAN-POST1           PIC XXX.
  7106             20  PM-CB-CAN-POST2           PIC XXX.
  7107             20  FILLER                    PIC XXX.
  7108     12  PM-POST-CARD-MAIL-DATA.
  7109         16  PM-MAIL-DATA OCCURS 7.
  7110             20  PM-MAIL-TYPE              PIC X.
  7111                 88  PM-12MO-MAILING           VALUE '1'.
  7112                 88  PM-EXP-MAILING            VALUE '2'.
  7113             20  PM-MAIL-STATUS            PIC X.
  7114                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  7115                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  7116                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  7117             20  PM-MAIL-DATE              PIC XX.
  7118     12  FILLER                            PIC XX.
  7119     12  FILLER                            PIC X(12).
  7120*    12  FILLER                            PIC X(30).
  7121
  7122******************************************************************
  7123*                                COPY ERCMAIL.
  7124******************************************************************
  7125*                                                                *
  7126*                                                                *
  7127*                            ERCMAIL                             *
  7128*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7129*                            VMOD=2.003                          *
  7130*                                                                *
  7131*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7132*                                                                *
  7133*   FILE TYPE = VSAM,KSDS                                        *
  7134*   RECORD SIZE = 374   RECFORM = FIX                            *
  7135*                                                                *
  7136*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7137*   ALTERNATE PATH    = NOT USED                                 *
  7138*                                                                *
  7139*   LOG = YES                                                    *
  7140*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7141******************************************************************
  7142*                   C H A N G E   L O G
  7143*
  7144* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7145*-----------------------------------------------------------------
  7146*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7147* EFFECTIVE    NUMBER
  7148*-----------------------------------------------------------------
  7149* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7150* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7151* 111108                   PEMA  ADD CRED BENE ADDR2
  7152******************************************************************
  7153
  7154 01  MAILING-DATA.
  7155     12  MA-RECORD-ID                      PIC XX.
  7156         88  VALID-MA-ID                       VALUE 'MA'.
  7157
  7158     12  MA-CONTROL-PRIMARY.
  7159         16  MA-COMPANY-CD                 PIC X.
  7160         16  MA-CARRIER                    PIC X.
  7161         16  MA-GROUPING.
  7162             20  MA-GROUPING-PREFIX        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 132
* EL6311.cbl
  7163             20  MA-GROUPING-PRIME         PIC XXX.
  7164         16  MA-STATE                      PIC XX.
  7165         16  MA-ACCOUNT.
  7166             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7167             20  MA-ACCOUNT-PRIME          PIC X(6).
  7168         16  MA-CERT-EFF-DT                PIC XX.
  7169         16  MA-CERT-NO.
  7170             20  MA-CERT-PRIME             PIC X(10).
  7171             20  MA-CERT-SFX               PIC X.
  7172
  7173     12  FILLER                            PIC XX.
  7174
  7175     12  MA-ACCESS-CONTROL.
  7176         16  MA-SOURCE-SYSTEM              PIC XX.
  7177             88  MA-FROM-CREDIT                VALUE 'CR'.
  7178             88  MA-FROM-VSI                   VALUE 'VS'.
  7179             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7180             88  MA-FROM-OTHER                 VALUE 'OT'.
  7181         16  MA-RECORD-ADD-DT              PIC XX.
  7182         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7183         16  MA-LAST-MAINT-DT              PIC XX.
  7184         16  MA-LAST-MAINT-BY              PIC XXXX.
  7185         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7186
  7187     12  MA-PROFILE-INFO.
  7188         16  MA-QUALIFY-CODE-1             PIC XX.
  7189         16  MA-QUALIFY-CODE-2             PIC XX.
  7190         16  MA-QUALIFY-CODE-3             PIC XX.
  7191         16  MA-QUALIFY-CODE-4             PIC XX.
  7192         16  MA-QUALIFY-CODE-5             PIC XX.
  7193
  7194         16  MA-INSURED-LAST-NAME          PIC X(15).
  7195         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7196         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7197         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7198         16  MA-INSURED-BIRTH-DT           PIC XX.
  7199         16  MA-INSURED-SEX                PIC X.
  7200             88  MA-SEX-MALE                   VALUE 'M'.
  7201             88  MA-SEX-FEMALE                 VALUE 'F'.
  7202         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7203
  7204         16  MA-ADDRESS-CORRECTED          PIC X.
  7205         16  MA-JOINT-BIRTH-DT             PIC XX.
  7206*        16  FILLER                        PIC X(12).
  7207
  7208         16  MA-ADDRESS-LINE-1             PIC X(30).
  7209         16  MA-ADDRESS-LINE-2             PIC X(30).
  7210         16  MA-CITY-STATE.
  7211             20  MA-CITY                   PIC X(28).
  7212             20  MA-ADDR-STATE             PIC XX.
  7213         16  MA-ZIP.
  7214             20  MA-ZIP-CODE.
  7215                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7216                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7217                 24  FILLER                PIC X(4).
  7218             20  MA-ZIP-PLUS4              PIC X(4).
  7219         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7220             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 133
* EL6311.cbl
  7221             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7222             20  FILLER                    PIC X(3).
  7223
  7224         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7225
  7226         16  FILLER                        PIC XXX.
  7227*        16  FILLER                        PIC X(10).
  7228
  7229     12  MA-CRED-BENE-INFO.
  7230         16  MA-CRED-BENE-NAME                 PIC X(25).
  7231         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7232         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7233         16  MA-CRED-BENE-CTYST.
  7234             20  MA-CRED-BENE-CITY             PIC X(28).
  7235             20  MA-CRED-BENE-STATE            PIC XX.
  7236         16  MA-CRED-BENE-ZIP.
  7237             20  MA-CB-ZIP-CODE.
  7238                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7239                     88  MA-CB-CANADIAN-POST-CODE
  7240                                           VALUE 'A' THRU 'Z'.
  7241                 24  FILLER                    PIC X(4).
  7242             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7243         16  MA-CB-CANADIAN-POSTAL-CODE
  7244                            REDEFINES MA-CRED-BENE-ZIP.
  7245             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7246             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7247             20  FILLER                        PIC X(3).
  7248     12  MA-POST-CARD-MAIL-DATA.
  7249         16  MA-MAIL-DATA OCCURS 7.
  7250             20  MA-MAIL-TYPE              PIC X.
  7251                 88  MA-12MO-MAILING           VALUE '1'.
  7252                 88  MA-EXP-MAILING            VALUE '2'.
  7253             20  MA-MAIL-STATUS            PIC X.
  7254                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7255                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7256                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7257             20  MA-MAIL-DATE              PIC XX.
  7258     12  FILLER                            PIC XX.
  7259     12  FILLER                            PIC XX.
  7260*    12  FILLER                            PIC X(30).
  7261******************************************************************
  7262*                                COPY ERCRQST.
  7263******************************************************************
  7264*                                                                *
  7265*                                                                *
  7266*                            ERCRQST.                            *
  7267*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7268*                            VMOD=2.002                          *
  7269*                                                                *
  7270*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7271*                                                                *
  7272*   FILE TYPE = VSAM,KSDS                                        *
  7273*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7274*                                                                *
  7275*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7276*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7277*                                   ACCOUNT, REF, BATCH)         *
  7278*                                                RKP=9, LEN=38   *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 134
* EL6311.cbl
  7279*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7280*                                   ACCOUNT, REF, BATCH)         *
  7281*                                                RKP=47, LEN=46  *
  7282*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7283*                                   BATCH)                       *
  7284*                                                RKP=93, LEN=24  *
  7285*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7286*                                   REF, BATCH)                  *
  7287*                                                RKP=117, LEN=35 *
  7288*   LOG = NO                                                     *
  7289*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7290******************************************************************
  7291
  7292 01  AR-REQUEST-RECORD.
  7293     12  RQ-RECORD-ID                     PIC XX.
  7294         88  VALID-RQ-ID                        VALUE 'RQ'.
  7295
  7296     12  RQ-CONTROL-PRIMARY.
  7297         16  RQ-COMPANY-CD                PIC X.
  7298         16  RQ-ENTRY-BATCH               PIC X(6).
  7299
  7300     12  RQ-CONTROL-BY-ACCT-REF.
  7301         16  RQ-COMPANY-CD-A1             PIC X.
  7302         16  RQ-CARRIER-A1                PIC X.
  7303         16  RQ-GROUPING-A1               PIC X(6).
  7304         16  RQ-STATE-A1                  PIC XX.
  7305         16  RQ-ACCOUNT-A1                PIC X(10).
  7306         16  RQ-REFERENCE-A1              PIC X(12).
  7307         16  RQ-BATCH-A1                  PIC X(6).
  7308
  7309     12  RQ-CONTROL-BY-FIN-RESP.
  7310         16  RQ-COMPANY-CD-A2             PIC X.
  7311         16  RQ-CARRIER-A2                PIC X.
  7312         16  RQ-GROUPING-A2               PIC X(6).
  7313         16  RQ-FIN-RESP-A2               PIC X(10).
  7314         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7315         16  RQ-REFERENCE-A2              PIC X(12).
  7316         16  RQ-BATCH-A2                  PIC X(6).
  7317
  7318     12  RQ-CONTROL-BY-ACCT-AGENT.
  7319         16  RQ-COMPANY-CD-A3             PIC X.
  7320         16  RQ-CARRIER-A3                PIC X.
  7321         16  RQ-GROUPING-A3               PIC X(6).
  7322         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7323         16  RQ-BATCH-A3                  PIC X(6).
  7324
  7325     12  RQ-CONTROL-BY-SUMMARY.
  7326         16  RQ-COMPANY-CD-A4             PIC X.
  7327         16  RQ-SUMMARY-CODE              PIC X(6).
  7328         16  RQ-ACCOUNT-A4                PIC X(10).
  7329         16  RQ-REFERENCE-A4              PIC X(12).
  7330         16  RQ-BATCH-A4                  PIC X(6).
  7331
  7332     12  RQ-REQUEST-METHOD                PIC X.
  7333         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7334         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7335         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7336         88 RQ-BATCH-REQUEST                  VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 135
* EL6311.cbl
  7337     12  FILLER                           PIC X.
  7338     12  RQ-STATUS                        PIC X.
  7339         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7340         88  RQ-RESUBMIT                      VALUE 'R'.
  7341     12  RQ-PROCESSOR-ID                  PIC X(4).
  7342     12  RQ-ENTRY-DT                      PIC XX.
  7343     12  RQ-MO-END-DT                     PIC XX.
  7344     12  RQ-REQUEST-DT                    PIC XX.
  7345     12  RQ-STMT-DT                       PIC XX.
  7346     12  RQ-REVERSAL-DT                   PIC XX.
  7347     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7348     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7349
  7350     12  FILLER                           PIC X(27).
  7351
  7352******************************************************************
  7353
  7354*                                COPY ERCLOFC.
  7355******************************************************************
  7356*                                                                *
  7357*                                                                *
  7358*                            ERCLOFC                             *
  7359*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7360*                            VMOD=2.003                          *
  7361*                                                                *
  7362*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7363*                                                                *
  7364*   FILE TYPE = VSAM,KSDS                                        *
  7365*   RECORD SIZE = 670   RECFORM = FIX                            *
  7366*                                                                *
  7367*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7368*                                                                *
  7369*   LOG = YES                                                    *
  7370*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7371*                                                                *
  7372******************************************************************
  7373
  7374 01  LOAN-OFFICER-MASTER.
  7375     12  LO-RECORD-ID                PIC XX.
  7376         88  VALID-LO-ID                VALUE 'LO'.
  7377
  7378     12  LO-CONTROL-PRIMARY.
  7379         16  LO-COMPANY-CD           PIC X.
  7380         16  LO-CARRIER              PIC X.
  7381         16  LO-GROUPING.
  7382             20  LO-GROUPING-PREFIX  PIC XXX.
  7383             20  LO-GROUPING-PRIME   PIC XXX.
  7384         16  LO-STATE                PIC XX.
  7385         16  LO-ACCOUNT.
  7386             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7387             20  LO-ACCOUNT-PRIME    PIC X(6).
  7388         16  LO-OFFICER-CODE         PIC X(5).
  7389
  7390     12  LO-OFFICER-NAME             PIC X(30).
  7391
  7392     12  LO-LAST-MAINT-DT            PIC XX.
  7393     12  LO-LAST-USER                PIC X(4).
  7394     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 136
* EL6311.cbl
  7395
  7396     12  LO-COMP-CONTROL             PIC X.
  7397             88  LO-SHOW-COMP           VALUE 'Y'.
  7398             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7399     12  LO-DETAIL-CONTROL           PIC X.
  7400             88  LO-PRINT-DETAIL        VALUE 'D'.
  7401             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7402
  7403     12  LO-SV-CARRIER               PIC X.
  7404     12  LO-SV-GROUPING              PIC X(6).
  7405     12  LO-SV-STATE                 PIC XX.
  7406
  7407     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7408     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7409
  7410     12  LO-OFFICER-INFO.
  7411         16  FILLER OCCURS 12 TIMES.
  7412             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7413             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7414             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7415             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7416             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7417             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7418             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7419             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7420     12  FILLER                      PIC X(198).
  7421******************************************************************
  7422*                                COPY ERCPYAJ.
  7423******************************************************************
  7424*                                                                *
  7425*                            ERCPYAJ                             *
  7426*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7427*                            VMOD=2.015                          *
  7428*                                                                *
  7429*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7430*                                                                *
  7431*                                                                *
  7432*   FILE TYPE = VSAM,KSDS                                        *
  7433*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7434*                                                                *
  7435*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7436*       ALTERNATE PATHS = NONE                                   *
  7437*                                                                *
  7438*   LOG = YES                                                    *
  7439*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7440******************************************************************
  7441******************************************************************
  7442*                   C H A N G E   L O G
  7443*
  7444* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7445*-----------------------------------------------------------------
  7446*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7447* EFFECTIVE    NUMBER
  7448*-----------------------------------------------------------------
  7449* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7450* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7451******************************************************************
  7452
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 137
* EL6311.cbl
  7453 01  PENDING-PAY-ADJ.
  7454     12  PY-RECORD-ID                     PIC XX.
  7455         88  VALID-PY-ID                        VALUE 'PY'.
  7456
  7457     12  PY-CONTROL-PRIMARY.
  7458         16  PY-COMPANY-CD                PIC X.
  7459         16  PY-CARRIER                   PIC X.
  7460         16  PY-GROUPING                  PIC X(6).
  7461         16  PY-FIN-RESP                  PIC X(10).
  7462         16  PY-ACCOUNT                   PIC X(10).
  7463         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7464                                          PIC X(10).
  7465         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7466         16  PY-RECORD-TYPE               PIC X.
  7467             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7468             88  PY-DEPOSIT                   VALUE 'D'.
  7469             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7470             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7471             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7472             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7473             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7474             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7475             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7476             88  PY-FICA-ENTRY                VALUE 'F'.
  7477             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7478             88  PY-POLICY-FEE                VALUE 'W'.
  7479             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7480
  7481     12  PY-PYMT-TYPE                     PIC X.
  7482             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7483             88  PY-REINS-PYMT                VALUE 'R'.
  7484             88  PY-EXP-PYMT                  VALUE 'E'.
  7485
  7486     12  PY-BIL-INV                       PIC X(6).
  7487     12  PY-REF-NO                        PIC X(12).
  7488
  7489     12  PY-LAST-MAINT-DT                 PIC XX.
  7490     12  PY-LAST-MAINT-BY                 PIC X(4).
  7491     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7492
  7493     12  PY-PYADJ-RECORD.
  7494         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7495         16  PY-ENTRY-COMMENT             PIC X(30).
  7496         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7497             20  PY-GL-ACCOUNT            PIC X(10).
  7498             20  PY-GL-STATE              PIC X(02).
  7499             20  PY-GL-CANC-SW            PIC X(01).
  7500                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7501                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7502             20  PY-GL-COMMENT            PIC X(10).
  7503             20  FILLER      REDEFINES PY-GL-COMMENT.
  7504                 24  PY-GL-CHECK-NO       PIC 9(06).
  7505                 24  FILLER               PIC X(04).
  7506             20  FILLER                   PIC X(07).
  7507         16  PY-SAVE-ACCOUNT              PIC X(10).
  7508         16  PY-SAVE-TYPE                 PIC X(01).
  7509
  7510         16  PY-LETTERS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 138
* EL6311.cbl
  7511             20  PY-LETTER OCCURS 3 TIMES
  7512                           INDEXED BY PY-LET-NDX
  7513                                          PIC X(04).
  7514
  7515         16  PY-ERCOMP-TYPE               PIC X.
  7516             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7517             88  PY-GA-TYPE                   VALUE 'G'.
  7518             88  PY-BANK-TYPE                 VALUE 'B'.
  7519         16  FILLER                       PIC X(05).
  7520
  7521     12  PY-RECORD-STATUS.
  7522         16  PY-CREDIT-SELECT-DT          PIC XX.
  7523         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7524         16  PY-BILLED-DATE               PIC XX.
  7525         16  PY-REPORTED-DT               PIC XX.
  7526         16  PY-PMT-APPLIED               PIC X.
  7527             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7528             88  PY-GA-PMT                    VALUE 'G'.
  7529             88  PY-OVWRITE-PMT               VALUE 'O'.
  7530             88  PY-NON-AR-PMT                VALUE 'N'.
  7531         16  FILLER                       PIC X(5).
  7532         16  PY-INPUT-DT                  PIC XX.
  7533         16  PY-CHECK-NUMBER              PIC X(6).
  7534         16  PY-VOID-SW                   PIC X.
  7535             88  PY-CHECK-VOIDED              VALUE 'V'.
  7536         16  PY-CHECK-ORIGIN-SW           PIC X.
  7537             88  PY-BILLING-CHECK             VALUE 'B'.
  7538             88  PY-REFUND-CHECK              VALUE 'R'.
  7539             88  PY-GA-CHECK                  VALUE 'G'.
  7540             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7541             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7542         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7543         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7544         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7545         16  PY-BILL-FLAG                 PIC X.
  7546             88  PY-BILLED                    VALUE 'B'.
  7547         16  PY-AR-FLAG                   PIC X.
  7548             88  PY-AR-CYCLE                  VALUE 'C'.
  7549             88  PY-AR-MONTH-END              VALUE 'M'.
  7550         16  PY-AR-DATE                   PIC XX.
  7551
  7552     12  PY-GL-CODES.
  7553         16  PY-GL-DB                     PIC X(14).
  7554         16  PY-GL-CR                     PIC X(14).
  7555         16  PY-GL-FLAG                   PIC X.
  7556         16  PY-GL-DATE                   PIC XX.
  7557
  7558     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7559     12  FILLER                           PIC X(3).
  7560******************************************************************
  7561*                                COPY ERCCNOT.
  7562******************************************************************
  7563*                                                                *
  7564*                            ERCCNOT                             *
  7565*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7566*                            VMOD=2.003                          *
  7567*                                                                *
  7568*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 139
* EL6311.cbl
  7569*                                                                *
  7570*        FILE TYPE= VSAM,KSDS                                    *
  7571*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7572*                                                                *
  7573*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7574*                                                                *
  7575*        LOG = YES                                               *
  7576*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7577*                                                                *
  7578******************************************************************
  7579*                   C H A N G E   L O G
  7580*
  7581* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7582*-----------------------------------------------------------------
  7583*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7584* EFFECTIVE    NUMBER
  7585*-----------------------------------------------------------------
  7586* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7587******************************************************************
  7588
  7589 01  CERT-NOTE-FILE.
  7590     12  CZ-RECORD-ID                PIC  XX.
  7591         88  VALID-CZ-ID                  VALUE 'CZ'.
  7592
  7593     12  CZ-CONTROL-PRIMARY.
  7594         16  CZ-COMPANY-CD           PIC X.
  7595         16  CZ-CARRIER              PIC X.
  7596         16  CZ-GROUPING.
  7597             20 CZ-GROUPING-PREFIX   PIC XXX.
  7598             20 CZ-GROUPING-PRIME    PIC XXX.
  7599         16  CZ-STATE                PIC XX.
  7600         16  CZ-ACCOUNT.
  7601             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7602             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7603         16  CZ-CERT-EFF-DT          PIC XX.
  7604         16  CZ-CERT-NO.
  7605             20  CZ-CERT-PRIME       PIC X(10).
  7606             20  CZ-CERT-SFX         PIC X.
  7607         16  CZ-RECORD-TYPE          PIC X.
  7608             88  CERT-NOTE           VALUE '1'.
  7609             88  CLAIM-CERT-NOTE     VALUE '2'.
  7610         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7611
  7612     12  CZ-LAST-MAINT-DT            PIC XX.
  7613     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7614     12  CZ-LAST-MAINT-USER          PIC X(4).
  7615
  7616     12  CZ-NOTE-INFORMATION.
  7617         16  CZ-NOTE                 PIC X(63).
  7618         16  FILLER                  PIC X(39).
  7619******************************************************************
  7620*                                COPY ELCMSTR.
  7621******************************************************************
  7622*                                                                *
  7623*                            ELCMSTR.                            *
  7624*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7625*                            VMOD=2.012                          *
  7626*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 140
* EL6311.cbl
  7627*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7628*                                                                *
  7629*   FILE TYPE = VSAM,KSDS                                        *
  7630*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7631*                                                                *
  7632*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7633*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7634*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7635*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7636*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7637*                                                 RKP=75,LEN=21  *
  7638*                                                                *
  7639*   **** NOTE ****                                               *
  7640*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7641*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7642*                                                                *
  7643*   LOG = YES                                                    *
  7644*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7645******************************************************************
  7646*                   C H A N G E   L O G
  7647*
  7648* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7649*-----------------------------------------------------------------
  7650*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7651* EFFECTIVE    NUMBER
  7652*-----------------------------------------------------------------
  7653* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7654* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7655* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7656* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7657* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7658* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7659* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7660******************************************************************
  7661 01  CLAIM-MASTER.
  7662     12  CL-RECORD-ID                PIC XX.
  7663         88  VALID-CL-ID         VALUE 'CL'.
  7664
  7665     12  CL-CONTROL-PRIMARY.
  7666         16  CL-COMPANY-CD           PIC X.
  7667         16  CL-CARRIER              PIC X.
  7668         16  CL-CLAIM-NO             PIC X(7).
  7669         16  CL-CERT-NO.
  7670             20  CL-CERT-PRIME       PIC X(10).
  7671             20  CL-CERT-SFX         PIC X.
  7672
  7673     12  CL-CONTROL-BY-NAME.
  7674         16  CL-COMPANY-CD-A1        PIC X.
  7675         16  CL-INSURED-LAST-NAME    PIC X(15).
  7676         16  CL-INSURED-NAME.
  7677             20  CL-INSURED-1ST-NAME PIC X(12).
  7678             20  CL-INSURED-MID-INIT PIC X.
  7679
  7680     12  CL-CONTROL-BY-SSN.
  7681         16  CL-COMPANY-CD-A2        PIC X.
  7682         16  CL-SOC-SEC-NO.
  7683             20  CL-SSN-STATE        PIC XX.
  7684             20  CL-SSN-ACCOUNT      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 141
* EL6311.cbl
  7685             20  CL-SSN-LN3          PIC X(3).
  7686
  7687     12  CL-CONTROL-BY-CERT-NO.
  7688         16  CL-COMPANY-CD-A4        PIC X.
  7689         16  CL-CERT-NO-A4.
  7690             20  CL-CERT-A4-PRIME    PIC X(10).
  7691             20  CL-CERT-A4-SFX      PIC X.
  7692
  7693     12  CL-CONTROL-BY-CCN.
  7694         16  CL-COMPANY-CD-A5        PIC X.
  7695         16  CL-CCN-A5.
  7696             20  CL-CCN.
  7697                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7698                 24  CL-CCN-PRIME-A5 PIC X(12).
  7699             20  CL-CCN-FILLER-A5    PIC X(4).
  7700
  7701     12  CL-INSURED-PROFILE-DATA.
  7702         16  CL-INSURED-BIRTH-DT     PIC XX.
  7703         16  CL-INSURED-SEX-CD       PIC X.
  7704             88  INSURED-IS-MALE        VALUE 'M'.
  7705             88  INSURED-IS-FEMALE      VALUE 'F'.
  7706             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7707         16  CL-INSURED-OCC-CD       PIC X(6).
  7708         16  FILLER                  PIC X(5).
  7709
  7710     12  CL-PROCESSING-INFO.
  7711         16  CL-PROCESSOR-ID         PIC X(4).
  7712         16  CL-CLAIM-STATUS         PIC X.
  7713             88  CLAIM-IS-OPEN          VALUE 'O'.
  7714             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7715         16  CL-CLAIM-TYPE           PIC X.
  7716*            88  AH-CLAIM               VALUE 'A'.
  7717*            88  LIFE-CLAIM             VALUE 'L'.
  7718*            88  PROPERTY-CLAIM         VALUE 'P'.
  7719*            88  IUI-CLAIM              VALUE 'I'.
  7720*            88  GAP-CLAIM              VALUE 'G'.
  7721*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7722*            88  OTHER-CLAIM            VALUE 'O'.
  7723         16  CL-CLAIM-PREM-TYPE      PIC X.
  7724             88  SINGLE-PREMIUM         VALUE '1'.
  7725             88  O-B-COVERAGE           VALUE '2'.
  7726             88  OPEN-END-COVERAGE      VALUE '3'.
  7727         16  CL-INCURRED-DT          PIC XX.
  7728         16  CL-REPORTED-DT          PIC XX.
  7729         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7730         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7731         16  CL-LAST-PMT-DT          PIC XX.
  7732         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7733         16  CL-PAID-THRU-DT         PIC XX.
  7734         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7735         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7736         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7737         16  CL-PMT-CALC-METHOD      PIC X.
  7738             88  CL-360-DAY-YR          VALUE '1'.
  7739             88  CL-365-DAY-YR          VALUE '2'.
  7740             88  CL-FULL-MONTHS         VALUE '3'.
  7741         16  CL-CAUSE-CD             PIC X(6).
  7742
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 142
* EL6311.cbl
  7743         16  CL-PRIME-CERT-NO.
  7744             20  CL-PRIME-CERT-PRIME PIC X(10).
  7745             20  CL-PRIME-CERT-SFX   PIC X.
  7746
  7747         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7748             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7749             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7750
  7751         16  CL-MICROFILM-NO         PIC X(10).
  7752         16  FILLER REDEFINES CL-MICROFILM-NO.
  7753             20  CL-BENEFIT-PERIOD   PIC 99.
  7754             20  FILLER              PIC X(8).
  7755         16  CL-PROG-FORM-TYPE       PIC X.
  7756         16  CL-LAST-ADD-ON-DT       PIC XX.
  7757
  7758         16  CL-LAST-REOPEN-DT       PIC XX.
  7759         16  CL-LAST-CLOSE-DT        PIC XX.
  7760         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7761             88  FINAL-PAID             VALUE '1'.
  7762             88  CLAIM-DENIED           VALUE '2'.
  7763             88  AUTO-CLOSE             VALUE '3'.
  7764             88  MANUAL-CLOSE           VALUE '4'.
  7765             88  BENEFITS-CHANGED       VALUE 'C'.
  7766             88  SETUP-ERRORS           VALUE 'E'.
  7767         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7768         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7769         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7770             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7771         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7772         16  FILLER                  PIC X.
  7773
  7774     12  CL-CERTIFICATE-DATA.
  7775         16  CL-CERT-ORIGIN          PIC X.
  7776             88  CERT-WAS-ONLINE        VALUE '1'.
  7777             88  CERT-WAS-CREATED       VALUE '2'.
  7778             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7779         16  CL-CERT-KEY-DATA.
  7780             20  CL-CERT-CARRIER     PIC X.
  7781             20  CL-CERT-GROUPING    PIC X(6).
  7782             20  CL-CERT-STATE       PIC XX.
  7783             20  CL-CERT-ACCOUNT.
  7784                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7785                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7786             20  CL-CERT-EFF-DT      PIC XX.
  7787
  7788     12  CL-STATUS-CONTROLS.
  7789         16  CL-PRIORITY-CD          PIC X.
  7790             88  CONFIDENTIAL-DATA      VALUE '8'.
  7791             88  HIGHEST-PRIORITY       VALUE '9'.
  7792         16  CL-SUPV-ATTN-CD         PIC X.
  7793             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7794             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7795         16  CL-PURGED-DT            PIC XX.
  7796         16  CL-RESTORED-DT          PIC XX.
  7797         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7798         16  CL-NEXT-RESEND-DT       PIC XX.
  7799         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7800         16  CL-CRITICAL-PERIOD      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 143
* EL6311.cbl
  7801*        16  FILLER                  PIC XX.
  7802         16  CL-LAST-MAINT-DT        PIC XX.
  7803         16  CL-LAST-MAINT-USER      PIC X(4).
  7804         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7805         16  CL-LAST-MAINT-TYPE      PIC X.
  7806             88  CLAIM-SET-UP           VALUE ' '.
  7807             88  PAYMENT-MADE           VALUE '1'.
  7808             88  LETTER-SENT            VALUE '2'.
  7809             88  MASTER-WAS-ALTERED     VALUE '3'.
  7810             88  MASTER-WAS-RESTORED    VALUE '4'.
  7811             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7812             88  FILE-CONVERTED         VALUE '6'.
  7813             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7814             88  ERROR-CORRECTION       VALUE 'E'.
  7815         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7816         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7817         16  CL-BENEFICIARY          PIC X(10).
  7818         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7819         16  CL-DENIAL-TYPE          PIC X.
  7820             88  CL-TYPE-DENIAL          VALUE '1'.
  7821             88  CL-TYPE-RESCISSION      VALUE '2'.
  7822             88  CL-TYPE-REFORMATION     VALUE '3'.
  7823             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7824             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7825         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7826         16  filler                  pic x(3).
  7827*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7828*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7829*        16  CL-RTW-DT               PIC XX.
  7830
  7831     12  CL-TRAILER-CONTROLS.
  7832         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7833             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7834             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7835             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7836         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7837         16  FILLER                  PIC XX.
  7838         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7839         16  CL-ADDRESS-TRAILER-CNT.
  7840             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7841                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7842             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7843                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7844             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7845                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7846             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7847                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7848             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7849                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7850             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7851                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7852             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7853                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7854
  7855     12  CL-CV-REFERENCE-NO.
  7856         16  CL-CV-REFNO-PRIME       PIC X(18).
  7857         16  CL-CV-REFNO-SFX         PIC XX.
  7858
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 144
* EL6311.cbl
  7859     12  CL-FILE-LOCATION            PIC X(4).
  7860
  7861     12  CL-PROCESS-ERRORS.
  7862         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7863             88  NO-FATAL-ERRORS        VALUE ZERO.
  7864         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7865             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7866
  7867     12  CL-PRODUCT-CD               PIC X.
  7868
  7869     12  CL-CURRENT-KEY-DATA.
  7870         16  CL-CURRENT-CARRIER      PIC X.
  7871         16  CL-CURRENT-GROUPING     PIC X(6).
  7872         16  CL-CURRENT-STATE        PIC XX.
  7873         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7874
  7875     12  CL-ASSOCIATES               PIC X.
  7876         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7877         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7878         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7879         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7880
  7881     12  CL-ACTIVITY-CODE            PIC 99.
  7882     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7883     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7884
  7885     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7886     12  CL-LAG-REPORT-CODE          PIC 9.
  7887     12  CL-LOAN-TYPE                PIC XX.
  7888     12  CL-LEGAL-STATE              PIC XX.
  7889
  7890     12  CL-YESNOSW                  PIC X.
  7891     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7892         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7893         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7894         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7895     12  cl-insured-type             pic x.
  7896         88  cl-claim-on-primary         value 'P'.
  7897         88  cl-claim-on-co-borrower     value 'C'.
  7898     12  cl-benefit-expiration-dt    PIC XX.
  7899*                                COPY ERCENDT.
  7900******************************************************************
  7901*                                                                *
  7902*                                                                *
  7903*                            ERCENDT.                            *
  7904*                            VMOD=2.001                          *
  7905*                                                                *
  7906*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7907*                                                                *
  7908*   FILE TYPE = VSAM,KSDS                                        *
  7909*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7910*                                                                *
  7911*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7912*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7913*                                                                *
  7914*   LOG = NO                                                     *
  7915*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7916******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 145
* EL6311.cbl
  7917*-----------------------------------------------------------------
  7918*                   C H A N G E   L O G
  7919*
  7920* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7921*-----------------------------------------------------------------
  7922*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7923* EFFECTIVE    NUMBER
  7924*-----------------------------------------------------------------
  7925* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7926*                                WITH OPEN CLAIMS
  7927* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7928* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7929* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7930* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7931*-----------------------------------------------------------------
  7932 01  ENDORSEMENT-RECORD.
  7933     12  EN-RECORD-ID                PIC XX.
  7934         88  VALID-EN-ID                VALUE 'EN'.
  7935     12  EN-CONTROL-PRIMARY.
  7936         16  EN-COMPANY-CD           PIC X.
  7937         16  EN-CARRIER              PIC X.
  7938         16  EN-GROUPING             PIC X(6).
  7939         16  EN-STATE                PIC XX.
  7940         16  EN-ACCOUNT              PIC X(10).
  7941         16  EN-CERT-EFF-DT          PIC XX.
  7942         16  EN-CERT-NO.
  7943             20  EN-CERT-PRIME       PIC X(10).
  7944             20  EN-CERT-SFX         PIC X.
  7945         16  EN-REC-TYPE             PIC X.
  7946             88  EN-ISSUE               VALUE 'I'.
  7947             88  EN-CANCELLATION        VALUE 'C'.
  7948         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7949     12  EN-CONTROL-BY-ARCH-NO.
  7950         16  EN-COMPANY-CD-A1              PIC X.
  7951         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7952     12  EN-LAST-MAINT-DT            PIC XX.
  7953     12  EN-LAST-MAINT-BY            PIC X(4).
  7954     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7955     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7956     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7957         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7958         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7959         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7960         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7961         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7962         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7963         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7964         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7965         16  EN-LF-ORIG-BENCD        PIC XX.
  7966         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7967         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7968         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7969         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7970         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7971         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7972*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7973         16  EN-ORIG-CRED-BENE       PIC X(25).
  7974         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 146
* EL6311.cbl
  7975         16  FILLER                  PIC X.
  7976         16  EN-AH-ORIG-BENCD        PIC XX.
  7977         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7978         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7979         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7980         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7981*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7982*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7983         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7984         16  F                       PIC X(09).
  7985         16  EN-AH-ORIG-CP           PIC 99.
  7986         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7987         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7988         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7989         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7990         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7991         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7992         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7993         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7994         16  EN-LF-NEW-BENCD         PIC XX.
  7995         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7996         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7997         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7998         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7999         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  8000         16  EN-LF-NEW-EXP-DT        PIC XX.
  8001         16  EN-NEW-CRED-BENE        PIC X(25).
  8002         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8003         16  FILLER                  PIC X.
  8004         16  EN-AH-NEW-BENCD         PIC XX.
  8005         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  8006         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8007         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8008         16  EN-AH-NEW-EXP-DT        PIC XX.
  8009*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  8010*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  8011*        16  F                       PIC X(12).
  8012         16  EN-AH-NEW-CP            PIC 99.
  8013         16  EN-SIG-SW               PIC X.
  8014         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8015         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  8016         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  8017         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  8018         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  8019         16  FILLER                  PIC X(33).
  8020     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8021         16  EN-LF-ORIG-REF-DT       PIC XX.
  8022         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8023         16  EN-AH-ORIG-REF-DT       PIC XX.
  8024         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8025         16  EN-LF-NEW-REF-DT        PIC XX.
  8026         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8027         16  EN-AH-NEW-REF-DT        PIC XX.
  8028         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8029         16  EN-FLAG-CERT            PIC X.
  8030         16  EN-INS-LAST-NAME        PIC X(15).
  8031         16  EN-INS-FIRST-NAME       PIC X(10).
  8032         16  EN-INS-MIDDLE-INIT      PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 147
* EL6311.cbl
  8033         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8034         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8035         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8036         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8037         16  FILLER                  PIC X(262).
  8038     12  EN-MONEY-SW             PIC X.
  8039     12  EN-HEALTH-APP           PIC X.
  8040     12  EN-VOUCHER-SW           PIC X.
  8041     12  EN-PAYEE                PIC X(14).
  8042     12  EN-INPUT-DT             PIC XX.
  8043     12  EN-PROCESS-DT           PIC XX.
  8044     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8045     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8046     12  EN-REASON-CODES.
  8047         16  F OCCURS 12.
  8048             20  EN-REASON-CODE  PIC X(4).
  8049     12  EN-TEMPLATE-USED        PIC X(8).
  8050     12  EN-DOCU-TYPE            PIC X.
  8051         88  EN-VERI-DOCU          VALUE 'V'.
  8052         88  EN-GCE-DOCU           VALUE 'G'.
  8053         88  EN-CANC-DOCU          VALUE 'C'.
  8054     12  EN-COMMENTS1            PIC X(13).
  8055     12  EN-COMMENTS2            PIC X(70).
  8056     12  EN-COMM-CHGBK           PIC X.
  8057         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8058         88  EN-CHG-ACCT           VALUE 'Y'.
  8059     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8060     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8061     12  EN-BATCH-NUMBER         PIC X(6).
  8062     12  EN-ACCT-SUMM            PIC X.
  8063     12  EN-CSO-SUMM             PIC X.
  8064     12  en-check-type           pic x.
  8065     12  FILLER                  PIC X(12).
  8066******************************************************************
  8067*                                COPY ELCCRTT.
  8068******************************************************************
  8069*                                                                *
  8070*                            ELCCRTT.                            *
  8071*                                                                *
  8072*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8073*                                                                *
  8074*   FILE TYPE = VSAM,KSDS                                        *
  8075*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8076*                                                                *
  8077*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8078*                                                                *
  8079*   LOG = YES                                                    *
  8080*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8081******************************************************************
  8082*                   C H A N G E   L O G
  8083*
  8084* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8085*-----------------------------------------------------------------
  8086*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8087* EFFECTIVE    NUMBER
  8088*-----------------------------------------------------------------
  8089* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8090* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 148
* EL6311.cbl
  8091* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8092* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8093* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8094* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8095* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8096* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8097* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8098* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8099* 091318  CR2018073000001  PEMA  ADD Refund methods
  8100* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8101******************************************************************
  8102
  8103 01  CERTIFICATE-TRAILERS.
  8104     12  CS-RECORD-ID                      PIC XX.
  8105         88  VALID-CS-ID                      VALUE 'CS'.
  8106
  8107     12  CS-CONTROL-PRIMARY.
  8108         16  CS-COMPANY-CD                 PIC X.
  8109         16  CS-CARRIER                    PIC X.
  8110         16  CS-GROUPING                   PIC X(6).
  8111         16  CS-STATE                      PIC XX.
  8112         16  CS-ACCOUNT                    PIC X(10).
  8113         16  CS-CERT-EFF-DT                PIC XX.
  8114         16  CS-CERT-NO.
  8115             20  CS-CERT-PRIME             PIC X(10).
  8116             20  CS-CERT-SFX               PIC X.
  8117         16  CS-TRAILER-TYPE               PIC X.
  8118             88  COMM-TRLR           VALUE 'A'.
  8119             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8120             88  CERT-DATA-TRLR      VALUE 'C'.
  8121
  8122     12  CS-DATA-AREA                      PIC X(516).
  8123
  8124     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8125         16  CS-BANK-COMMISSION-AREA.
  8126             20  CS-BANK-COMMS       OCCURS 10.
  8127                 24  CS-AGT                PIC X(10).
  8128                 24  CS-COM-TYP            PIC X.
  8129                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8130                 24  CS-RECALC-LV-INDIC    PIC X.
  8131                 24  FILLER                PIC X(10).
  8132         16  FILLER                        PIC X(256).
  8133
  8134     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8135****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8136         16  CS-MB-CLAIM-DATA OCCURS 24.
  8137             20  CS-CLAIM-NO               PIC X(7).
  8138             20  CS-CLAIM-TYPE             PIC X.
  8139                 88  CS-AH-CLM               VALUE 'A'.
  8140                 88  CS-IU-CLM               VALUE 'I'.
  8141                 88  CS-GP-CLM               VALUE 'G'.
  8142                 88  CS-LF-CLM               VALUE 'L'.
  8143                 88  CS-PR-CLM               VALUE 'P'.
  8144                 88  CS-FL-CLM               VALUE 'F'.
  8145                 88  CS-OT-CLM               VALUE 'O'.
  8146             20  CS-INSURED-TYPE           PIC X.
  8147                 88  CS-PRIM-INSURED          VALUE 'P'.
  8148                 88  CS-CO-BORROWER           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 149
* EL6311.cbl
  8149             20  CS-BENEFIT-PERIOD         PIC 99.
  8150             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8151             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8152             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8153         16  FILLER                        PIC X(12).
  8154     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8155         16  CS-VIN-NUMBER                 PIC X(17).
  8156         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8157         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8158         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8159         16  cs-agent-name.
  8160             20  cs-agent-fname            pic x(20).
  8161             20  cs-agent-mi               pic x.
  8162             20  cs-agent-lname            pic x(25).
  8163         16  cs-license-no                 pic x(15).
  8164         16  cs-npn-number                 pic x(10).
  8165         16  cs-agent-edit-status          pic x.
  8166             88  cs-ae-refer-to-manager      value 'M'.
  8167             88  cs-ae-cover-sheet           value 'C'.
  8168             88  cs-ae-sig-form              value 'S'.
  8169             88  cs-ae-verified              value 'V'.
  8170             88  cs-unidentified-signature   value 'U'.
  8171             88  cs-cert-returned            value 'R'.
  8172             88  cs-accept-no-commission     value 'N'.
  8173         16  cs-year                       pic 9999.
  8174         16  cs-make                       pic x(20).
  8175         16  cs-model                      pic x(20).
  8176         16  cs-future                     pic x(20).
  8177         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8178         16  cs-claim-verification-status  pic x.
  8179             88  cs-clm-ver-eligible         value 'A'.
  8180             88  cs-clm-ver-partial-elig     value 'B'.
  8181             88  cs-clm-ver-not-eligible     value 'C'.
  8182             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8183             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8184             88  cs-clm-ver-ND-CERT          value 'F'.
  8185             88  cs-clm-ver-spec-other       value 'G'.
  8186             88  cs-clam-ver-pratial-corrected
  8187                                             value 'H'.
  8188             88  cs-clm-ver-no-matches       value 'I'.
  8189             88  cs-clm-ver-not-elig-corrected
  8190                                             value 'J'.
  8191             88  cs-clm-ver-needs-review     value 'R'.
  8192             88  cs-clm-ver-sent-to-claims   value 'W'.
  8193         16  CS-LF-REFUND-METHOD           PIC X.
  8194         16  CS-AH-REFUND-METHOD           PIC X.
  8195         16  FILLER                        PIC X(353). *> was 420
  8196*        16  FILLER                        PIC X(496).
  8197*                                COPY ERCCHEK.
  8198******************************************************************
  8199*                                                                *
  8200*                                                                *
  8201*                            ERCCHEK                             *
  8202*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8203*                            VMOD=2.008                          *
  8204*                                                                *
  8205*   FILE DESCRIPTION = CHECK RECORDS                             *
  8206*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 150
* EL6311.cbl
  8207*   FILE TYPE = VSAM,KSDS                                        *
  8208*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8209*                                                                *
  8210*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8211*       ALTERNATE INDEX = NONE                                   *
  8212*                                                                *
  8213*   LOG = YES                                                    *
  8214*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8215******************************************************************
  8216*                   C H A N G E   L O G
  8217*
  8218* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8219*-----------------------------------------------------------------
  8220*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8221* EFFECTIVE    NUMBER
  8222*-----------------------------------------------------------------
  8223* 021414    2003053000001  PEMA  changes for auto chk request
  8224******************************************************************
  8225 01  CHECK-RECORDS.
  8226     12  CH-RECORD-ID                      PIC XX.
  8227         88  VALID-CH-ID                      VALUE 'CH'.
  8228
  8229     12  CH-CONTROL-PRIMARY.
  8230         16  CH-COMPANY-CD                 PIC X.
  8231         16  CH-CARRIER                    PIC X.
  8232         16  CH-GROUPING                   PIC X(6).
  8233         16  CH-STATE                      PIC XX.
  8234         16  CH-ACCOUNT                    PIC X(10).
  8235         16  CH-CERT-EFF-DT                PIC XX.
  8236         16  CH-CERT-NO.
  8237             20  CH-CERT-PRIME             PIC X(10).
  8238             20  CH-CERT-SFX               PIC X.
  8239         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8240
  8241     12  CH-RECORDED-DT                    PIC XX.
  8242     12  CH-RECORDED-BY                    PIC X(4).
  8243     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8244
  8245     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8246     12  CH-CHECK-NO                       PIC X(7).
  8247     12  CH-REASON-FOR-CHECK               PIC X(25).
  8248     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8249     12  FILLER                            PIC X.
  8250
  8251     12  CH-PAYEE-INFO.
  8252         16  CH-PAYEE-NAME-1               PIC X(30).
  8253         16  CH-PAYEE-NAME-2               PIC X(30).
  8254         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8255         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8256         16  CH-PAYEE-CITY-ST.
  8257             20  CH-PAYEE-CITY             PIC X(28).
  8258             20  CH-PAYEE-STATE            PIC XX.
  8259         16  CH-PAYEE-ZIP-CODE.
  8260             20  CH-PAYEE-ZIP.
  8261                 24  CH-ZIP-PRI-1ST        PIC X.
  8262                     88  CH-CANADIAN-POST-CODE
  8263                                           VALUES 'A' THRU 'Z'.
  8264                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 151
* EL6311.cbl
  8265             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8266         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8267             20  CH-CAN-POSTAL-1           PIC XXX.
  8268             20  CH-CAN-POSTAL-2           PIC XXX.
  8269             20  FILLER                    PIC XXX.
  8270
  8271     12  CH-CHECK-STUB-TEXT.
  8272         16  CH-STUB-LINE-1                PIC X(30).
  8273         16  CH-TEXT-LINE-1                PIC X(50).
  8274         16  CH-TEXT-LINE-2                PIC X(50).
  8275         16  CH-TEXT-LINE-3                PIC X(40).
  8276     12  CH-RETURN-TO                      PIC X(30).
  8277
  8278     12  CH-COMPENSATION-CONTROL.
  8279         16  CH-COMP-CARRIER               PIC X.
  8280         16  CH-COMP-GROUPING              PIC X(6).
  8281         16  CH-COMP-FIN-RESP              PIC X(10).
  8282         16  CH-COMP-ACCOUNT               PIC X(10).
  8283
  8284     12  CH-CREDIT-SELECT-DT               PIC XX.
  8285     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8286     12  CH-PAYEE-CODE                     PIC X(6).
  8287
  8288     12  CH-VOID-DATA.
  8289         20  CH-VOID-DT                    PIC XX.
  8290         20  CH-VOID-BY                    PIC X(4).
  8291         20  CH-VOID-REASON                PIC X(25).
  8292
  8293     12  CH-APPROVAL-DATA.
  8294         20  CH-APPROVAL-DT                PIC XX.
  8295         20  CH-APPROVAL-STATUS            PIC X.
  8296             88  CH-IN-LIMBO                  VALUE ' '.
  8297             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8298             88  CH-APPROVED                  VALUE 'A'.
  8299             88  CH-DENIED                    VALUE 'D'.
  8300         20  CH-APPROVED-BY                PIC XXXX.
  8301     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8302             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8303     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8304
  8305     12  ch-released-dt                    pic xx.
  8306     12  ch-check-cashed-dt                pic xx.
  8307     12  FILLER                            PIC X.
  8308*    12  CH-CHECK-REFERENCE                PIC X(12).
  8309     12  CH-CHECK-ORIGIN-SW                PIC X.
  8310             88  CH-REFUND-CHECK              VALUE 'R'.
  8311             88  CH-MAINT-CHECK               VALUE 'M'.
  8312
  8313     12  CH-CANC-DT                        PIC XX.
  8314     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8315     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8316
  8317     12  CH-INSURED-NAME                   PIC X(28).
  8318
  8319     12  ch-released-by                    pic x(4).
  8320     12  ch-csr                            pic x(4).
  8321     12  ch-deduct-commission              pic x.
  8322         88  ch-deduct-comm                  value 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 152
* EL6311.cbl
  8323         88  ch-do-not-deduct-comm           value 'N'.
  8324
  8325     12  FILLER                            PIC X(11).
  8326*    12  CH-LETTER-TABLE.
  8327*        16  CH-LETTERS OCCURS 3 TIMES
  8328*                       INDEXED BY CH-LT-NDX
  8329*                                          PIC X(04).
  8330
  8331     12  FILLER                            PIC X(07).
  8332
  8333 01  var                         pic x(30).
  8334 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8335                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8336                          PENDING-MAILING-DATA MAILING-DATA
  8337                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8338                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8339                          CLAIM-MASTER ENDORSEMENT-RECORD
  8340                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8341                          VAR.
  8342 0000-DFHEXIT SECTION.
  8343     MOVE '9#                    $   ' TO DFHEIV0.
  8344     MOVE 'EL6311' TO DFHEIV1.
  8345     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8346
  8347     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8348     MOVE EIBTRMID               TO QID-TERM.
  8349     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8350     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8351     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8352     MOVE 2                      TO EMI-SWITCH2.
  8353
  8354     move spaces to ws-kix-myenv
  8355     set P to address of KIXSYS
  8356     CALL "getenv" using by value P returning var-ptr
  8357     if var-ptr = null then
  8358        display ' kixsys not set '
  8359     else
  8360        set address of var to var-ptr
  8361        move 0 to env-var-len
  8362        inspect var tallying env-var-len
  8363          for characters before X'00'
  8364        unstring var (1:env-var-len) delimited by '/'
  8365           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8366              WS-KIX-SYS
  8367        end-unstring
  8368     end-if
  8369     perform varying a1 from +1 by +1 until a1 > +10
  8370        if ws-kix-myenv (a1:1) = low-values or high-values
  8371           display ' found low or hi val '
  8372           move spaces to ws-kix-myenv (a1:1)
  8373        end-if
  8374     end-perform
  8375*    display ' env *' ws-kix-myenv '*'
  8376     IF EIBCALEN = 0
  8377         GO TO 8800-UNAUTHORIZED-ACCESS.
  8378
  8379     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8380     MOVE '5'                   TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 153
* EL6311.cbl
  8381     PERFORM 9700-DATE-LINK.
  8382     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8383     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8384
  8385     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8386     MOVE SPACE                  TO DC-OPTION-CODE.
  8387     PERFORM 9700-DATE-LINK.
  8388     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8389     MOVE LOW-VALUES             TO EL631BI.
  8390
  8391
  8392* EXEC CICS HANDLE CONDITION
  8393*        PGMIDERR  (9600-PGMID-ERROR)
  8394*        ERROR     (9990-ABEND)
  8395*        INVREQ    (9990-ABEND)
  8396*        QIDERR    (0010-MAIN-LOGIC)
  8397*    END-EXEC.
  8398*    MOVE '"$L.8N                ! " #00008387' TO DFHEIV0
  8399     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8401     MOVE X'2220233030303038333837' TO DFHEIV0(25:11)
  8402     CALL 'kxdfhei1' USING DFHEIV0
  8403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8404
  8405
  8406     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8407         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8408             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8409             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8410             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8411             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8412             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8413             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8414             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8415             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8416
  8417             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8418                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8419
  8420             ELSE
  8421                 NEXT SENTENCE
  8422
  8423         ELSE
  8424             IF PI-CALLING-PROGRAM = 'EL6315'
  8425                SET CALLED-FROM-6315 TO TRUE
  8426             END-IF
  8427             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8428             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8429             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8430             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8431             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8432             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8433             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8434             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8435             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8436             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8437             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8438             GO TO 3900-RE-DISPLAY-RECORD
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 154
* EL6311.cbl
  8439     ELSE
  8440         GO TO 0020-MAIN-LOGIC.
  8441
  8442 0010-MAIN-LOGIC.
  8443     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8444                                    WS-FIRST-ENTRY-SW.
  8445
  8446     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8447
  8448     MOVE LOW-VALUES             TO EC-NEW-CERT
  8449                                    EC-NEW-STATE.
  8450
  8451     IF PI-DISPLAY-ORIGINAL-BATCH
  8452         NEXT SENTENCE
  8453     ELSE
  8454         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8455             GO TO 5000-BROWSE-BATCH-HEADERS.
  8456
  8457     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8458         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8459
  8460     IF PI-CSR-BROWSE
  8461        GO TO 4200-BROWSE-CSR-FORWARD.
  8462
  8463     IF PI-FILE-BROWSE
  8464         GO TO 4300-BROWSE-FILE-FORWARD.
  8465
  8466     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8467
  8468 0020-MAIN-LOGIC.
  8469     IF EIBAID = DFHCLEAR
  8470         GO TO 9400-CLEAR.
  8471
  8472     MOVE LOW-VALUES             TO EC-NEW-CERT
  8473                                    EC-NEW-STATE.
  8474
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 155
* EL6311.cbl
  8476
  8477******************************************************************
  8478*                                                                *
  8479*              R E C E I V E   M A P                             *
  8480*                                                                *
  8481******************************************************************
  8482
  8483 0200-RECEIVE.
  8484     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8485         MOVE ER-0008            TO EMI-ERROR
  8486         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8487         IF PI-MAP-NAME = EL631B
  8488             MOVE -1                 TO BMAINTL
  8489             GO TO 8200-SEND-DATAONLY
  8490         ELSE
  8491             IF PI-MAP-NAME = EL631C
  8492                 MOVE -1                 TO CMAINTL
  8493                 GO TO 8200-SEND-DATAONLY
  8494             ELSE
  8495                 IF PI-MAP-NAME = EL631D
  8496                     MOVE -1                 TO DPFENTRL
  8497                     GO TO 8200-SEND-DATAONLY.
  8498
  8499
  8500* EXEC CICS RECEIVE
  8501*        MAP      (PI-MAP-NAME)
  8502*        MAPSET   (MAPSET-EL6311S)
  8503*        INTO     (EL631BI)
  8504*    END-EXEC.
  8505     MOVE LENGTH OF
  8506      EL631BI
  8507       TO DFHEIV11
  8508*    MOVE '8"T I  L              ''   #00008487' TO DFHEIV0
  8509     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8510     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8511     MOVE X'2020233030303038343837' TO DFHEIV0(25:11)
  8512     CALL 'kxdfhei1' USING DFHEIV0,
  8513           PI-MAP-NAME,
  8514           EL631BI,
  8515           DFHEIV11,
  8516           MAPSET-EL6311S,
  8517           DFHEIV99,
  8518           DFHEIV99
  8519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8520
  8521
  8522******************************************************************
  8523*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8524******************************************************************
  8525
  8526     IF BTYPE-LEN (1) EQUAL +3
  8527        IF BTYPE (1) EQUAL ALL ' '
  8528            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8529
  8530     IF BTYPE-LEN (2) EQUAL +3
  8531        IF BTYPE (2) EQUAL ALL ' '
  8532            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8533
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 156
* EL6311.cbl
  8534     INSPECT EL631BI CONVERTING '_' TO ' '.
  8535
  8536     IF PI-MAP-NAME = EL631B
  8537         IF BPFENTRL GREATER THAN ZEROS
  8538             IF EIBAID NOT = DFHENTER
  8539                 MOVE ER-0004       TO EMI-ERROR
  8540                 MOVE -1            TO BPFENTRL
  8541                 MOVE AL-UNBOF      TO BPFENTRA
  8542                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8543                 GO TO 8200-SEND-DATAONLY
  8544             ELSE
  8545                 IF BPFENTRI NUMERIC AND
  8546                   (BPFENTRI GREATER 0 AND LESS 25)
  8547                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8548                 ELSE
  8549                     MOVE ER-0029  TO EMI-ERROR
  8550                     MOVE AL-UNBON TO BPFENTRA
  8551                     MOVE -1       TO BPFENTRL
  8552                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8553                     GO TO 8200-SEND-DATAONLY
  8554         ELSE
  8555             NEXT SENTENCE
  8556     ELSE
  8557         IF PI-MAP-NAME = EL631C
  8558            IF CPFENTRL GREATER THAN ZEROS
  8559                IF EIBAID NOT = DFHENTER
  8560                 MOVE ER-0004         TO EMI-ERROR
  8561                 MOVE -1              TO CPFENTRL
  8562                 MOVE AL-UNBOF        TO CPFENTRA
  8563                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8564                 GO TO 8200-SEND-DATAONLY
  8565             ELSE
  8566                 IF CPFENTRI NUMERIC AND
  8567                   (CPFENTRI GREATER 0 AND LESS 25)
  8568                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8569                 ELSE
  8570                     MOVE ER-0029      TO EMI-ERROR
  8571                     MOVE AL-UNBON     TO CPFENTRA
  8572                     MOVE -1           TO CPFENTRL
  8573                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8574                     GO TO 8200-SEND-DATAONLY
  8575         ELSE
  8576             NEXT SENTENCE
  8577     ELSE
  8578     IF PI-MAP-NAME = EL631D
  8579         IF DPFENTRL GREATER THAN ZEROS
  8580             IF EIBAID NOT = DFHENTER
  8581                 MOVE ER-0004         TO EMI-ERROR
  8582                 MOVE -1              TO DPFENTRL
  8583                 MOVE AL-UNBOF        TO DPFENTRA
  8584                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8585                 GO TO 8200-SEND-DATAONLY
  8586             ELSE
  8587                 IF DPFENTRI NUMERIC AND
  8588                   (DPFENTRI GREATER 0 AND LESS 25)
  8589                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8590                 ELSE
  8591                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 157
* EL6311.cbl
  8592                     MOVE AL-UNBON     TO DPFENTRA
  8593                     MOVE -1           TO DPFENTRL
  8594                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8595                     GO TO 8200-SEND-DATAONLY.
  8596
  8597     IF EIBAID = DFHPF23
  8598         GO TO 8810-PF23.
  8599
  8600     IF EIBAID = DFHPF24
  8601         GO TO 9200-RETURN-MAIN-MENU.
  8602
  8603     IF EIBAID = DFHPF12
  8604         GO TO 9500-PF12.
  8605
  8606     IF PI-MAP-NAME = EL631B
  8607        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8608
  8609     IF PI-MAP-NAME = EL631C
  8610        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8611
  8612     IF PI-MAP-NAME = EL631D
  8613        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8614
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 158
* EL6311.cbl
  8616
  8617******************************************************************
  8618*                                                                *
  8619*      ISSUE SCREEN PF KEY CHECKING                              *
  8620*                                                                *
  8621******************************************************************
  8622
  8623******************************************************************
  8624*                                                                *
  8625*      PF KEY FUNCTIONS:                                         *
  8626*                                                                *
  8627*      PF1  = BROWSE FORWARD                                     *
  8628*      PF2  = BROWSE BACKWARD                                    *
  8629*      PF3  = CERTIFICATE LOOKUP                                 *
  8630*      PF4  = DISPLAY BATCH HEADER                               *
  8631*      PF5  = ADD ISSUE  SCREEN                                  *
  8632*      PF6  = ADD CANCEL SCREEN                                  *
  8633*      PF7  = CERTIFICATE DISPLAY                                *
  8634*      PF8  = CERTIFICATE NOTES                                  *
  8635*      PF9  = EDIT CONTROL                                       *
  8636*      PF10 = DISPLAY LETTER SCREEN                              *
  8637*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8638*      PF12 = HELP SCREEN                                        *
  8639*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8640*      PF14 = ACCOUNT MASTER                                     *
  8641*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8642*      PF16 = DISPLAY LETTER REVIEW                              *
  8643*                                                                *
  8644******************************************************************
  8645
  8646 0300-CHECK-ISSUE-PF-KEYS.
  8647     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8648        MOVE ER-2337            TO EMI-ERROR
  8649        MOVE -1                  TO BMAINTL
  8650        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8651        GO TO 8200-SEND-DATAONLY.
  8652
  8653     IF EIBAID = DFHPF1
  8654        MOVE '0'                TO PI-EDIT-SW
  8655        IF PI-PRIMARY-BROWSE
  8656           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8657        ELSE
  8658           IF PI-PRIMARY-WITH-SELECT
  8659              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8660           ELSE
  8661              IF PI-FILE-BROWSE
  8662                 GO TO 4300-BROWSE-FILE-FORWARD
  8663              ELSE
  8664                 IF PI-CSR-BROWSE
  8665                    GO TO 4200-BROWSE-CSR-FORWARD
  8666                 ELSE
  8667                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8668
  8669     IF EIBAID = DFHPF2
  8670        MOVE '0'                TO PI-EDIT-SW
  8671        IF PI-PRIMARY-BROWSE
  8672           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8673        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 159
* EL6311.cbl
  8674           IF PI-PRIMARY-WITH-SELECT
  8675              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8676           ELSE
  8677              IF PI-FILE-BROWSE
  8678                 GO TO 4800-BROWSE-FILE-BACKWARD
  8679              ELSE
  8680                 IF PI-CSR-BROWSE
  8681                    GO TO 4900-BROWSE-CSR-BACKWARD
  8682                 ELSE
  8683                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8684
  8685     IF EIBAID = DFHPF3
  8686        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8687        MOVE XCTL-EL127         TO PGM-NAME
  8688        GO TO 9300-XCTL.
  8689
  8690     IF (EIBAID = DFHPF15 OR DFHPF6)
  8691        AND (CSR-EDIT-SESSION)
  8692*       AND (FATAL-OR-UNFORCED)
  8693*       AND (FATAL-ERRORS)
  8694        and (pi-6311-fatal-ctr <> +0)
  8695        MOVE ER-1819             TO EMI-ERROR
  8696        MOVE -1                  TO BMAINTL
  8697        MOVE AL-UANON            TO BMAINTA
  8698        PERFORM 9900-ERROR-FORMAT
  8699                                 THRU 9900-EXIT
  8700        GO TO 8200-SEND-DATAONLY
  8701     END-IF
  8702     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8703      OR (EIBAID = DFHPF10)
  8704        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8705        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8706        IF (RESP-NORMAL)
  8707           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8708              AM-CONTROL-PRIMARY (1:20))
  8709            IF AM-NAME NOT GREATER THAN SPACES OR
  8710               AM-ADDRS NOT GREATER THAN SPACES  OR
  8711               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8712               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8713               AM-ZIP NOT GREATER THAN SPACES
  8714               MOVE ER-3834             TO EMI-ERROR
  8715               MOVE -1                  TO BMAINTL
  8716               MOVE AL-UANON            TO BMAINTA
  8717               PERFORM 9900-ERROR-FORMAT
  8718                                 THRU 9900-EXIT
  8719               GO TO 8200-SEND-DATAONLY
  8720            END-IF
  8721        ELSE
  8722           MOVE ER-1609             TO EMI-ERROR
  8723           MOVE -1                  TO BMAINTL
  8724           MOVE AL-UANON            TO BMAINTA
  8725           PERFORM 9900-ERROR-FORMAT
  8726                                THRU 9900-EXIT
  8727           GO TO 8200-SEND-DATAONLY
  8728        END-IF
  8729
  8730        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8731        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 160
* EL6311.cbl
  8732        IF (ERMAIL-FOUND)
  8733            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8734               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8735               MA-CITY NOT GREATER THAN SPACES OR
  8736               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8737               MA-ZIP-CODE NOT GREATER THAN SPACES
  8738               MOVE ER-3835             TO EMI-ERROR
  8739               MOVE -1                  TO BMAINTL
  8740               MOVE AL-UANON            TO BMAINTA
  8741               PERFORM 9900-ERROR-FORMAT
  8742                                 THRU 9900-EXIT
  8743               GO TO 8200-SEND-DATAONLY
  8744            END-IF
  8745        ELSE
  8746           MOVE ER-3000             TO EMI-ERROR
  8747           MOVE -1                  TO BMAINTL
  8748           MOVE AL-UANON            TO BMAINTA
  8749           PERFORM 9900-ERROR-FORMAT
  8750                                THRU 9900-EXIT
  8751           GO TO 8200-SEND-DATAONLY
  8752        END-IF
  8753
  8754     END-IF
  8755     IF (EIBAID = DFHPF15)
  8756        AND (CSR-EDIT-SESSION)
  8757        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8758        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8759        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8760        MOVE PI-SV-STATE         TO PI-STATE
  8761        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8762        MOVE BCERTNOI            TO PI-CERT-PRIME
  8763        MOVE BSUFIXI             TO PI-CERT-SFX
  8764        MOVE BEFFDTI             TO DEEDIT-FIELD
  8765        PERFORM 8600-DEEDIT
  8766        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8767        MOVE '4'                 TO DC-OPTION-CODE
  8768        PERFORM 9700-DATE-LINK
  8769        IF DATE-CONVERSION-ERROR
  8770           MOVE ER-0348          TO EMI-ERROR
  8771           MOVE -1               TO BEFFDTL
  8772           MOVE AL-UABON         TO BEFFDTA
  8773           PERFORM 9900-ERROR-FORMAT
  8774                                 THRU 9900-EXIT
  8775           GO TO 8200-SEND-DATAONLY
  8776        ELSE
  8777           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8778           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8779           MOVE XCTL-EL6315      TO PGM-NAME
  8780           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8781           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8782           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8783           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8784           GO TO 9300-XCTL
  8785        END-IF
  8786     END-IF
  8787
  8788     IF EIBAID = DFHPF4
  8789        MOVE '0'                TO PI-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 161
* EL6311.cbl
  8790        IF PI-DISPLAY-ORIGINAL-BATCH
  8791           NEXT SENTENCE
  8792        ELSE
  8793           GO TO 7200-DISPLAY-BATCHES.
  8794
  8795     IF EIBAID = DFHPF5
  8796        MOVE ER-0029                TO EMI-ERROR
  8797        MOVE -1                     TO BPFENTRL
  8798        MOVE AL-UNBON               TO BPFENTRA
  8799        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8800        GO TO 8200-SEND-DATAONLY.
  8801*        MOVE '0'                TO PI-EDIT-SW
  8802*        IF PI-DISPLAY-ORIGINAL-BATCH
  8803*           NEXT SENTENCE
  8804*        ELSE
  8805*           MOVE EL631B              TO PI-MAP-NAME
  8806*           MOVE LOW-VALUES          TO EL631BI
  8807*           MOVE 'A'                 TO BMAINTO
  8808*           MOVE AL-UANON            TO BMAINTA
  8809*           MOVE -1                  TO BMAINTL
  8810*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8811*           GO TO 8100-SEND-INITIAL-MAP.
  8812
  8813     IF EIBAID = DFHPF6
  8814        IF NOT CSR-EDIT-SESSION
  8815           MOVE ER-0029                TO EMI-ERROR
  8816           MOVE -1                     TO BPFENTRL
  8817           MOVE AL-UNBON               TO BPFENTRA
  8818           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8819           GO TO 8200-SEND-DATAONLY
  8820*           MOVE '0'              TO PI-EDIT-SW
  8821*           IF PI-DISPLAY-ORIGINAL-BATCH
  8822*              NEXT SENTENCE
  8823*           ELSE
  8824*              MOVE EL631C        TO PI-MAP-NAME
  8825*              MOVE LOW-VALUES    TO EL631CI
  8826*              MOVE 'A'           TO CMAINTO
  8827*              MOVE AL-UANON      TO CMAINTA
  8828*              MOVE -1            TO CMAINTL
  8829*              MOVE '6'           TO PI-MAINT-FUNCTION
  8830*              GO TO 8100-SEND-INITIAL-MAP
  8831*           END-IF
  8832        ELSE
  8833           PERFORM 5100-PROCESS-POL-RESC
  8834                                 THRU 5100-EXIT
  8835           MOVE  PI-PREV-CONTROL-PRIMARY
  8836                                 TO ERPNDB-KEY
  8837
  8838* EXEC CICS READ
  8839*              SET     (ADDRESS OF PENDING-BUSINESS)
  8840*              DATASET (FILE-ID-ERPNDB)
  8841*              RIDFLD  (ERPNDB-KEY)
  8842*          END-EXEC
  8843*    MOVE '&"S        E          (   #00008808' TO DFHEIV0
  8844     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8845     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8846     MOVE X'2020233030303038383038' TO DFHEIV0(25:11)
  8847     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 162
* EL6311.cbl
  8848           FILE-ID-ERPNDB,
  8849           DFHEIV20,
  8850           DFHEIV99,
  8851           ERPNDB-KEY,
  8852           DFHEIV99,
  8853           DFHEIV99,
  8854           DFHEIV99
  8855     SET ADDRESS OF PENDING-BUSINESS TO
  8856         DFHEIV20
  8857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8858           PERFORM 9800-LINK-PENDING-EDIT
  8859                                 THRU 9800-EXIT
  8860           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8861           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8862                                    PI-PREV-SEQ-NO
  8863           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8864*                                    WS-CANCEL-LETTER-SW
  8865                                    PI-ALL-ISSUES-SW
  8866                                    PI-ALL-CANCELS-SW
  8867           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8868        END-IF
  8869     END-IF
  8870     IF EIBAID = DFHPF7
  8871        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8872        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8873        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8874        MOVE PI-SV-STATE            TO PI-STATE
  8875        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8876        MOVE BCERTNOI               TO PI-CERT-PRIME
  8877        MOVE BSUFIXI                TO PI-CERT-SFX
  8878        MOVE BEFFDTI                TO DEEDIT-FIELD
  8879        PERFORM 8600-DEEDIT
  8880        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8881        MOVE '4'                    TO DC-OPTION-CODE
  8882        PERFORM 9700-DATE-LINK
  8883        IF DATE-CONVERSION-ERROR
  8884           MOVE ER-0348            TO EMI-ERROR
  8885           MOVE -1                  TO BEFFDTL
  8886           MOVE AL-UABON            TO BEFFDTA
  8887           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8888           GO TO 8200-SEND-DATAONLY
  8889        ELSE
  8890           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8891           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8892           MOVE XCTL-EL1273        TO PGM-NAME
  8893           GO TO 9300-XCTL.
  8894
  8895     IF EIBAID = DFHPF8
  8896        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8897        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8898        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8899        MOVE PI-SV-STATE            TO PI-STATE
  8900        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8901        MOVE BCERTNOI               TO PI-CERT-PRIME
  8902        MOVE BSUFIXI                TO PI-CERT-SFX
  8903        MOVE BEFFDTI                TO DEEDIT-FIELD
  8904        PERFORM 8600-DEEDIT
  8905        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 163
* EL6311.cbl
  8906        MOVE '4'                    TO DC-OPTION-CODE
  8907        PERFORM 9700-DATE-LINK
  8908        IF DATE-CONVERSION-ERROR
  8909           MOVE ER-0348            TO EMI-ERROR
  8910           MOVE -1                  TO BEFFDTL
  8911           MOVE AL-UABON            TO BEFFDTA
  8912           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8913           GO TO 8200-SEND-DATAONLY
  8914        ELSE
  8915           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8916           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8917           IF PI-COMPANY-ID = 'DMD'
  8918               MOVE XCTL-EL401DMD      TO PGM-NAME
  8919             ELSE
  8920               MOVE XCTL-EL1279        TO PGM-NAME
  8921           END-IF
  8922           GO TO 9300-XCTL.
  8923
  8924     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8925        MOVE XCTL-EL6312         TO PGM-NAME
  8926
  8927* EXEC CICS XCTL
  8928*           PROGRAM   (PGM-NAME)
  8929*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8930*           LENGTH    (WS-COMM-LENGTH)
  8931*       END-EXEC
  8932*    MOVE '.$C                   %   #00008881' TO DFHEIV0
  8933     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8934     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8935     MOVE X'2020233030303038383831' TO DFHEIV0(25:11)
  8936     CALL 'kxdfhei1' USING DFHEIV0,
  8937           PGM-NAME,
  8938           PROGRAM-INTERFACE-BLOCK,
  8939           WS-COMM-LENGTH,
  8940           DFHEIV99
  8941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8942     ELSE
  8943        MOVE '0'                 TO  PI-EDIT-SW.
  8944
  8945     IF  EIBAID = DFHPF10
  8946         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8947         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8948         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8949                                    PI-1042-WA
  8950         MOVE 4                  TO PI-689-DATA-SOURCE
  8951         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8952         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8953         MOVE PI-SV-STATE        TO PI-689-STATE
  8954         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8955         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8956         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8957         MOVE PI-PB-ALT-CHG-SEQ-NO
  8958                                 TO PI-689-ALT-SEQ-NO
  8959         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8960         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8961         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8962         MOVE +0                 TO PI-689-CONTROL
  8963         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 164
* EL6311.cbl
  8964                                    PI-689-EXP-DATE
  8965                                    PI-689-RESP-PERSON
  8966                                    PI-689-TYPE
  8967                                    PI-689-FOLLOW-UP-EDIT
  8968                                    PI-689-RESEND1-EDIT
  8969                                    PI-689-SEQ-EDIT
  8970                                    PI-689-BCSEQ-EDIT
  8971                                    PI-689-LBL-OVERRIDE
  8972         MOVE W-LETTER-COMMUNICATION-AREAS
  8973                                 TO PI-PROGRAM-WORK-AREA
  8974         MOVE XCTL-EL689         TO PGM-NAME
  8975         GO TO 9300-XCTL.
  8976
  8977     IF  EIBAID = DFHPF16
  8978         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8979         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8980         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8981                                    PI-1042-WA
  8982         MOVE 4                  TO PI-689-DATA-SOURCE
  8983         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8984         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8985         MOVE PI-SV-STATE        TO PI-689-STATE
  8986         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8987         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8988         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8989         MOVE PI-PB-ALT-CHG-SEQ-NO
  8990                                 TO PI-689-ALT-SEQ-NO
  8991         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8992         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8993         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8994         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8995         MOVE W-LETTER-COMMUNICATION-AREAS
  8996                                 TO PI-PROGRAM-WORK-AREA
  8997         MOVE XCTL-EL690         TO PGM-NAME
  8998         GO TO 9300-XCTL.
  8999
  9000     IF EIBAID = DFHPF13
  9001         MOVE XCTL-EL6313        TO PGM-NAME
  9002         GO TO 9300-XCTL.
  9003
  9004     IF EIBAID = DFHPF17
  9005        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  9006        IF (PB-I-LOAN-APR numeric)
  9007           and (pb-i-loan-apr < 99.9999)
  9008           AND (PB-I-BENEFICIARY-NAME NOT
  9009              = SPACES AND LOW-VALUES)
  9010
  9011           MOVE LINK-ELVADS          TO PGM-NAME
  9012
  9013* EXEC CICS LINK
  9014*              PROGRAM    (PGM-NAME)
  9015*              COMMAREA   (WS-PASS-AREA)
  9016*              LENGTH     (WS-PASS-AREA-LENGTH)
  9017*          END-EXEC
  9018*    MOVE '."C                   (   #00008956' TO DFHEIV0
  9019     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9020     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9021     MOVE X'2020233030303038393536' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 165
* EL6311.cbl
  9022     CALL 'kxdfhei1' USING DFHEIV0,
  9023           PGM-NAME,
  9024           WS-PASS-AREA,
  9025           WS-PASS-AREA-LENGTH,
  9026           DFHEIV99,
  9027           DFHEIV99,
  9028           DFHEIV99,
  9029           DFHEIV99
  9030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9031
  9032           MOVE 0000             TO EMI-ERROR
  9033           MOVE -1               TO BMAINTL
  9034           PERFORM 9900-ERROR-FORMAT
  9035                                 THRU 9900-EXIT
  9036           GO TO 8200-SEND-DATAONLY
  9037        ELSE
  9038           MOVE ER-0877            TO EMI-ERROR
  9039           MOVE -1                  TO BEFFDTL
  9040           MOVE AL-UABON            TO BEFFDTA
  9041           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9042           GO TO 8200-SEND-DATAONLY
  9043        END-IF
  9044     END-IF
  9045     IF EIBAID = DFHPF14
  9046        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9047        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9048        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9049        MOVE PI-SV-STATE            TO PI-CR-STATE
  9050        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9051        MOVE SPACE                  TO PI-EDIT-SW
  9052        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9053        MOVE XCTL-EL650             TO PGM-NAME
  9054        GO TO 9300-XCTL.
  9055
  9056     IF EIBAID = DFHPF15
  9057        IF PI-COMPANY-ID  =  'HER'
  9058            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9059            MOVE XCTL-EL680         TO PGM-NAME
  9060            GO TO 9300-XCTL.
  9061
  9062     IF EIBAID = DFHENTER OR DFHPF11
  9063        GO TO 1000-ISSUE-MAINLINE.
  9064
  9065     MOVE ER-0029                TO EMI-ERROR
  9066     MOVE -1                     TO BPFENTRL
  9067     MOVE AL-UNBON               TO BPFENTRA
  9068     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9069     GO TO 8200-SEND-DATAONLY.
  9070
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 166
* EL6311.cbl
  9072
  9073******************************************************************
  9074*                                                                *
  9075*      CANCEL SCREEN PF KEY CHECKING                             *
  9076*                                                                *
  9077******************************************************************
  9078
  9079******************************************************************
  9080*                                                                *
  9081*      PF KEY FUNCTIONS:                                         *
  9082*                                                                *
  9083*      PF1  = BROWSE FORWARD                                     *
  9084*      PF2  = BROWSE BACKWARD                                    *
  9085*      PF3  = CERTIFICATE LOOKUP                                 *
  9086*      PF4  = DISPLAY BATCH HEADER                               *
  9087*      PF5  = ADD ISSUE SCREEN                                   *
  9088*      PF6  = ADD CANCEL SCREEN                                  *
  9089*      PF7  = CERTIFICATE DISPLAY                                *
  9090*      PF8  = CERTIFICATE NOTES                                  *
  9091*      PF9  = EDIT CONTROL                                       *
  9092*      PF10 = DISPLAY LETTER SCREEN                              *
  9093*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  9094*      PF12 = DISPLAY HELP SCREEN                                *
  9095*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  9096*      PF14 = ACCOUNT MASTER                                     *
  9097*      PF16 = LETTER REVIEW                                      *
  9098*                                                                *
  9099******************************************************************
  9100
  9101 0400-CHECK-CANCEL-PF-KEYS.
  9102     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  9103        MOVE ER-2337             TO EMI-ERROR
  9104        MOVE -1                  TO CMAINTL
  9105        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9106        GO TO 8200-SEND-DATAONLY.
  9107
  9108     IF EIBAID = DFHPF1
  9109        MOVE '0'                TO PI-EDIT-SW
  9110        IF PI-PRIMARY-BROWSE
  9111           GO TO 4100-BROWSE-PRIMARY-FORWARD
  9112        ELSE
  9113           IF PI-PRIMARY-WITH-SELECT
  9114              GO TO 4100-BROWSE-PRIMARY-FORWARD
  9115           ELSE
  9116              IF PI-FILE-BROWSE
  9117                 GO TO 4300-BROWSE-FILE-FORWARD
  9118              ELSE
  9119                 IF PI-CSR-BROWSE
  9120                    GO TO 4200-BROWSE-CSR-FORWARD
  9121                 ELSE
  9122                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  9123
  9124     IF EIBAID = DFHPF2
  9125        MOVE '0'                TO PI-EDIT-SW
  9126        IF PI-PRIMARY-BROWSE
  9127           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9128        ELSE
  9129           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 167
* EL6311.cbl
  9130              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9131           ELSE
  9132              IF PI-FILE-BROWSE
  9133                 GO TO 4800-BROWSE-FILE-BACKWARD
  9134              ELSE
  9135                 IF PI-CSR-BROWSE
  9136                    GO TO 4900-BROWSE-CSR-BACKWARD
  9137                 ELSE
  9138                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  9139
  9140     IF EIBAID = DFHPF3
  9141        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9142        MOVE XCTL-EL127         TO PGM-NAME
  9143        GO TO 9300-XCTL.
  9144
  9145     IF (EIBAID = DFHPF15 OR DFHPF17)
  9146        AND (CSR-EDIT-SESSION)
  9147*       AND (FATAL-OR-UNFORCED)
  9148        AND (FATAL-ERRORS)
  9149        MOVE ER-1819             TO EMI-ERROR
  9150        MOVE -1                  TO CMAINTL
  9151        MOVE AL-UANON            TO CMAINTA
  9152        PERFORM 9900-ERROR-FORMAT
  9153                                 THRU 9900-EXIT
  9154        GO TO 8200-SEND-DATAONLY
  9155     END-IF
  9156     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  9157       AND (CSR-EDIT-SESSION)
  9158        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  9159        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  9160        IF (RESP-NORMAL)
  9161           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  9162              AM-CONTROL-PRIMARY (1:20))
  9163            IF AM-NAME NOT GREATER THAN SPACES OR
  9164               AM-ADDRS NOT GREATER THAN SPACES  OR
  9165               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  9166               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  9167               AM-ZIP NOT GREATER THAN SPACES
  9168               MOVE ER-3834             TO EMI-ERROR
  9169               MOVE -1                  TO BMAINTL
  9170               MOVE AL-UANON            TO BMAINTA
  9171               PERFORM 9900-ERROR-FORMAT
  9172                                 THRU 9900-EXIT
  9173               GO TO 8200-SEND-DATAONLY
  9174            END-IF
  9175        ELSE
  9176           MOVE ER-1609             TO EMI-ERROR
  9177           MOVE -1                  TO BMAINTL
  9178           MOVE AL-UANON            TO BMAINTA
  9179           PERFORM 9900-ERROR-FORMAT
  9180                                THRU 9900-EXIT
  9181           GO TO 8200-SEND-DATAONLY
  9182        END-IF
  9183
  9184        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  9185        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  9186        IF (ERMAIL-FOUND)
  9187            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 168
* EL6311.cbl
  9188               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  9189               MA-CITY NOT GREATER THAN SPACES OR
  9190               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  9191               MA-ZIP-CODE NOT GREATER THAN SPACES
  9192               MOVE ER-3835             TO EMI-ERROR
  9193               MOVE -1                  TO BMAINTL
  9194               MOVE AL-UANON            TO BMAINTA
  9195               PERFORM 9900-ERROR-FORMAT
  9196                                 THRU 9900-EXIT
  9197               GO TO 8200-SEND-DATAONLY
  9198            END-IF
  9199        ELSE
  9200           MOVE ER-3000             TO EMI-ERROR
  9201           MOVE -1                  TO BMAINTL
  9202           MOVE AL-UANON            TO BMAINTA
  9203           PERFORM 9900-ERROR-FORMAT
  9204                                THRU 9900-EXIT
  9205           GO TO 8200-SEND-DATAONLY
  9206        END-IF
  9207
  9208     END-IF
  9209     IF (EIBAID = DFHPF15 OR DFHPF17)
  9210        AND (CSR-EDIT-SESSION)
  9211        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9212        MOVE PI-SV-CARRIER       TO PI-CARRIER
  9213        MOVE PI-SV-GROUPING      TO PI-GROUPING
  9214        MOVE PI-SV-STATE         TO PI-STATE
  9215        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  9216        MOVE CCERTNOI            TO PI-CERT-PRIME
  9217        MOVE CSUFIXI             TO PI-CERT-SFX
  9218        MOVE CEFFDTI             TO DEEDIT-FIELD
  9219        PERFORM 8600-DEEDIT
  9220        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9221        MOVE '4'                 TO DC-OPTION-CODE
  9222        PERFORM 9700-DATE-LINK
  9223        IF DATE-CONVERSION-ERROR
  9224           MOVE ER-0348          TO EMI-ERROR
  9225           MOVE -1               TO CEFFDTL
  9226           MOVE AL-UABON         TO CEFFDTA
  9227           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9228           GO TO 8200-SEND-DATAONLY
  9229        ELSE
  9230           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9231           PERFORM 6000-CREATE-TEMP-STORAGE
  9232                                 THRU 6000-EXIT
  9233           IF EIBAID = DFHPF17
  9234               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9235                                  THRU 6400-EXIT
  9236               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9237                                 '2' AND '3' AND '4'
  9238                  MOVE ER-3831     TO  EMI-ERROR
  9239                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9240                  GO TO 8200-SEND-DATAONLY
  9241               END-IF
  9242               MOVE 'Y'          TO PI-CLM-RESC-IND
  9243           ELSE
  9244               MOVE 'N'          TO PI-CLM-RESC-IND
  9245           END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 169
* EL6311.cbl
  9246           MOVE XCTL-EL6316      TO PGM-NAME
  9247           MOVE '2'              TO PI-ISS-CAN-SW
  9248           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9249           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9250           GO TO 9300-XCTL
  9251        END-IF
  9252     END-IF
  9253
  9254     IF EIBAID = DFHPF4
  9255        MOVE '0'                TO PI-EDIT-SW
  9256        IF PI-DISPLAY-ORIGINAL-BATCH
  9257           NEXT SENTENCE
  9258        ELSE
  9259           GO TO 7200-DISPLAY-BATCHES.
  9260
  9261     IF EIBAID = DFHPF5
  9262        MOVE ER-0029                TO EMI-ERROR
  9263        MOVE -1                     TO BPFENTRL
  9264        MOVE AL-UNBON               TO BPFENTRA
  9265        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9266        GO TO 8200-SEND-DATAONLY.
  9267*        MOVE '0'                TO PI-EDIT-SW
  9268*        IF PI-DISPLAY-ORIGINAL-BATCH
  9269*           NEXT SENTENCE
  9270*        ELSE
  9271*           MOVE EL631B              TO PI-MAP-NAME
  9272*           MOVE LOW-VALUES          TO EL631BI
  9273*           MOVE 'A'                 TO BMAINTO
  9274*           MOVE AL-UANON            TO BMAINTA
  9275*           MOVE -1                  TO BMAINTL
  9276*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9277*           GO TO 8100-SEND-INITIAL-MAP.
  9278
  9279     IF EIBAID = DFHPF6
  9280        MOVE ER-0029                TO EMI-ERROR
  9281        MOVE -1                     TO BPFENTRL
  9282        MOVE AL-UNBON               TO BPFENTRA
  9283        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9284        GO TO 8200-SEND-DATAONLY.
  9285*        MOVE '0'                TO PI-EDIT-SW
  9286*        IF PI-DISPLAY-ORIGINAL-BATCH
  9287*           NEXT SENTENCE
  9288*        ELSE
  9289*           MOVE EL631C              TO PI-MAP-NAME
  9290*           MOVE LOW-VALUES          TO EL631CI
  9291*           MOVE 'A'                 TO CMAINTO
  9292*           MOVE AL-UANON            TO CMAINTA
  9293*           MOVE -1                  TO CMAINTL
  9294*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9295*           GO TO 8100-SEND-INITIAL-MAP.
  9296
  9297     IF EIBAID = DFHPF7
  9298        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9299        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9300        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9301        MOVE PI-SV-STATE            TO PI-STATE
  9302        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9303        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 170
* EL6311.cbl
  9304        MOVE CSUFIXI                TO PI-CERT-SFX
  9305        MOVE CEFFDTI                TO DEEDIT-FIELD
  9306        PERFORM 8600-DEEDIT
  9307        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9308        MOVE '4'                    TO DC-OPTION-CODE
  9309        PERFORM 9700-DATE-LINK
  9310        IF DATE-CONVERSION-ERROR
  9311           MOVE ER-0348            TO EMI-ERROR
  9312           MOVE -1                  TO BEFFDTL
  9313           MOVE AL-UABON            TO BEFFDTA
  9314           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9315           GO TO 8200-SEND-DATAONLY
  9316        ELSE
  9317           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9318           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9319           MOVE XCTL-EL1273        TO PGM-NAME
  9320           GO TO 9300-XCTL.
  9321
  9322     IF EIBAID = DFHPF8
  9323        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9324        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9325        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9326        MOVE PI-SV-STATE            TO PI-STATE
  9327        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9328        MOVE CCERTNOI               TO PI-CERT-PRIME
  9329        MOVE CSUFIXI                TO PI-CERT-SFX
  9330        MOVE CEFFDTI                TO DEEDIT-FIELD
  9331        PERFORM 8600-DEEDIT
  9332        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9333        MOVE '4'                    TO DC-OPTION-CODE
  9334        PERFORM 9700-DATE-LINK
  9335        IF DATE-CONVERSION-ERROR
  9336           MOVE ER-0348             TO EMI-ERROR
  9337           MOVE -1                  TO BEFFDTL
  9338           MOVE AL-UABON            TO BEFFDTA
  9339           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9340           GO TO 8200-SEND-DATAONLY
  9341        ELSE
  9342           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9343           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9344           IF PI-COMPANY-ID = 'DMD'
  9345               MOVE XCTL-EL401DMD      TO PGM-NAME
  9346             ELSE
  9347               MOVE XCTL-EL1279        TO PGM-NAME
  9348           END-IF
  9349           GO TO 9300-XCTL.
  9350
  9351     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9352        MOVE XCTL-EL6312     TO PGM-NAME
  9353
  9354* EXEC CICS XCTL
  9355*           PROGRAM  (PGM-NAME)
  9356*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9357*           LENGTH   (WS-COMM-LENGTH)
  9358*       END-EXEC
  9359*    MOVE '.$C                   %   #00009283' TO DFHEIV0
  9360     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9361     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 171
* EL6311.cbl
  9362     MOVE X'2020233030303039323833' TO DFHEIV0(25:11)
  9363     CALL 'kxdfhei1' USING DFHEIV0,
  9364           PGM-NAME,
  9365           PROGRAM-INTERFACE-BLOCK,
  9366           WS-COMM-LENGTH,
  9367           DFHEIV99
  9368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9369     ELSE
  9370        MOVE '0'                 TO  PI-EDIT-SW.
  9371
  9372     IF EIBAID = DFHPF10
  9373         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9374         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9375         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9376         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9377                                    PI-1042-WA
  9378         MOVE 4                  TO PI-689-DATA-SOURCE
  9379         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9380         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9381         MOVE PI-SV-STATE        TO PI-689-STATE
  9382         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9383         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9384         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9385         MOVE PI-PB-ALT-CHG-SEQ-NO
  9386                                 TO PI-689-ALT-SEQ-NO
  9387         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9388         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9389         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9390         MOVE +0                 TO PI-689-CONTROL
  9391         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9392                                    PI-689-EXP-DATE
  9393                                    PI-689-RESP-PERSON
  9394                                    PI-689-TYPE
  9395                                    PI-689-FOLLOW-UP-EDIT
  9396                                    PI-689-RESEND1-EDIT
  9397                                    PI-689-SEQ-EDIT
  9398                                    PI-689-BCSEQ-EDIT
  9399                                    PI-689-LBL-OVERRIDE
  9400         MOVE W-LETTER-COMMUNICATION-AREAS
  9401                                 TO PI-PROGRAM-WORK-AREA
  9402         MOVE XCTL-EL689         TO PGM-NAME
  9403         GO TO 9300-XCTL.
  9404
  9405     IF  EIBAID = DFHPF16
  9406         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9407         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9408         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9409                                    PI-1042-WA
  9410         MOVE 4                  TO PI-689-DATA-SOURCE
  9411         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9412         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9413         MOVE PI-SV-STATE        TO PI-689-STATE
  9414         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9415         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9416         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9417         MOVE PI-PB-ALT-CHG-SEQ-NO
  9418                                 TO PI-689-ALT-SEQ-NO
  9419         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 172
* EL6311.cbl
  9420         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9421         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9422         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9423         MOVE W-LETTER-COMMUNICATION-AREAS
  9424                                 TO PI-PROGRAM-WORK-AREA
  9425         MOVE XCTL-EL690         TO PGM-NAME
  9426         GO TO 9300-XCTL.
  9427     IF (EIBAID = DFHPF13)
  9428        if (not fatal-errors)
  9429           and (not unforced-errors)
  9430           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9431           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9432           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9433           MOVE PI-SV-STATE      TO PI-STATE
  9434           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9435           MOVE CCERTNOI         TO PI-CERT-PRIME
  9436           MOVE CSUFIXI          TO PI-CERT-SFX
  9437           MOVE CEFFDTI          TO DEEDIT-FIELD
  9438           PERFORM 8600-DEEDIT
  9439           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9440           MOVE '4'              TO DC-OPTION-CODE
  9441           PERFORM 9700-DATE-LINK
  9442           IF DATE-CONVERSION-ERROR
  9443              MOVE ER-0348       TO EMI-ERROR
  9444              MOVE -1            TO CEFFDTL
  9445              MOVE AL-UABON      TO CEFFDTA
  9446              PERFORM 9900-ERROR-FORMAT
  9447                                 THRU 9900-EXIT
  9448              GO TO 8200-SEND-DATAONLY
  9449           ELSE
  9450              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9451              MOVE AL-UANON      TO CEFFDTA
  9452              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9453              PERFORM 6000-CREATE-TEMP-STORAGE
  9454                                 THRU 6000-EXIT
  9455              MOVE XCTL-EL677    TO PGM-NAME
  9456              GO TO 9300-XCTL
  9457           end-if
  9458        else
  9459           MOVE ER-3444          TO EMI-ERROR
  9460           MOVE -1               TO CPFENTRL
  9461           MOVE AL-UNBON         TO CPFENTRA
  9462           PERFORM 9900-ERROR-FORMAT
  9463                                 THRU 9900-EXIT
  9464           GO TO 8200-SEND-DATAONLY
  9465        end-if
  9466     end-if
  9467
  9468     IF EIBAID = DFHPF14
  9469        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9470        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9471        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9472        MOVE PI-SV-STATE            TO PI-CR-STATE
  9473        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9474        MOVE SPACE                  TO PI-EDIT-SW
  9475        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9476        MOVE XCTL-EL650             TO PGM-NAME
  9477        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 173
* EL6311.cbl
  9478
  9479     IF EIBAID = DFHENTER OR DFHPF11
  9480        GO TO 2000-CANCEL-MAINLINE.
  9481
  9482     MOVE ER-0029                TO EMI-ERROR.
  9483     MOVE -1                     TO CPFENTRL.
  9484     MOVE AL-UNBON               TO CPFENTRA.
  9485     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9486     GO TO 8200-SEND-DATAONLY.
  9487
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 174
* EL6311.cbl
  9489
  9490******************************************************************
  9491*                                                                *
  9492*      BATCH SCREEN PF KEY CHECKING                              *
  9493*                                                                *
  9494******************************************************************
  9495
  9496******************************************************************
  9497*                                                                *
  9498*      PF KEY FUNCTIONS:                                         *
  9499*                                                                *
  9500*      PF1 = BROWSE FORWARD                                      *
  9501*      PF2 = BROWSE BACKWARD                                     *
  9502*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9503*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9504*                                                                *
  9505*                                                                *
  9506******************************************************************
  9507
  9508 0500-CHECK-BATCH-PF-KEYS.
  9509     IF EIBAID = DFHPF1
  9510        MOVE '0'                TO PI-EDIT-SW
  9511        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9512           GO TO 5000-BROWSE-BATCH-HEADERS
  9513        ELSE
  9514           IF PI-GOOD-BROWSE
  9515              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9516                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9517              ELSE
  9518                 IF PI-FILE-BROWSE
  9519                    GO TO 4300-BROWSE-FILE-FORWARD
  9520                 ELSE
  9521                    IF PI-CSR-BROWSE
  9522                       GO TO 4200-BROWSE-CSR-FORWARD
  9523                    ELSE
  9524                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9525           ELSE
  9526              GO TO 0800-BROWSE-ERROR.
  9527
  9528     IF EIBAID = DFHPF2
  9529        MOVE '0'                TO PI-EDIT-SW
  9530        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9531           GO TO 5500-BROWSE-BATCH-BACKWARD
  9532        ELSE
  9533           IF PI-GOOD-BROWSE
  9534              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9535                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9536              ELSE
  9537                 IF PI-FILE-BROWSE
  9538                    GO TO 4800-BROWSE-FILE-BACKWARD
  9539                 ELSE
  9540                    IF PI-CSR-BROWSE
  9541                       GO TO 4900-BROWSE-CSR-BACKWARD
  9542                    ELSE
  9543                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9544           ELSE
  9545              GO TO 0800-BROWSE-ERROR.
  9546
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 175
* EL6311.cbl
  9547     IF EIBAID = DFHPF3
  9548        GO TO 3000-BATCH-MAINLINE.
  9549
  9550     IF  EIBAID = DFHPF4
  9551        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9552        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9553        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9554        MOVE PI-SV-STATE            TO PI-CR-STATE
  9555        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9556                                       PI-CR-FIN-RESP
  9557        MOVE 'A'                    TO PI-CR-TYPE
  9558        MOVE SPACE                  TO PI-EDIT-SW
  9559        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9560        MOVE XCTL-EL640             TO PGM-NAME
  9561        GO TO 9300-XCTL.
  9562
  9563     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9564       AND
  9565        (EIBAID = DFHENTER)
  9566           GO TO 3500-EDIT-BATCH-DATA.
  9567
  9568     IF EIBAID = DFHENTER
  9569        GO TO 3500-EDIT-BATCH-DATA.
  9570
  9571     MOVE ER-0029             TO EMI-ERROR.
  9572     MOVE -1                  TO DPFENTRL.
  9573     MOVE AL-UNBON            TO DPFENTRA.
  9574     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9575     GO TO 8200-SEND-DATAONLY.
  9576
  9577 0800-BROWSE-ERROR.
  9578     MOVE ER-2258                TO EMI-ERROR.
  9579     MOVE -1                     TO DPFENTRL.
  9580     MOVE AL-UNBON               TO DPFENTRA.
  9581     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9582     GO TO 8200-SEND-DATAONLY.
  9583
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 176
* EL6311.cbl
  9585
  9586******************************************************************
  9587*                                                                *
  9588*                I S S U E   M A I N L I N E                     *
  9589*                                                                *
  9590******************************************************************
  9591
  9592 1000-ISSUE-MAINLINE.
  9593     IF PI-DISPLAY-ORIGINAL-BATCH
  9594        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9595           MOVE ER-0023             TO EMI-ERROR
  9596           MOVE -1                  TO BMAINTL
  9597           MOVE AL-UABON            TO BMAINTA
  9598           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9599           GO TO 8200-SEND-DATAONLY
  9600        ELSE
  9601           NEXT SENTENCE
  9602     ELSE
  9603        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9604           MOVE ER-0023             TO EMI-ERROR
  9605           MOVE -1                  TO BMAINTL
  9606           MOVE AL-UABON            TO BMAINTA
  9607           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9608           GO TO 8200-SEND-DATAONLY.
  9609
  9610     IF BMAINTI = 'S'
  9611        GO TO 1100-SHOW-REQUEST.
  9612
  9613     IF NOT MODIFY-CAP
  9614         MOVE 'UPDATE'       TO SM-READ
  9615         PERFORM 9995-SECURITY-VIOLATION
  9616         MOVE ER-0070        TO EMI-ERROR
  9617         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9618         GO TO 8100-SEND-INITIAL-MAP.
  9619
  9620     IF BMAINTL GREATER THAN ZEROS
  9621        IF PI-PF5-FUNCTION
  9622           IF BMAINTI NOT = 'A'
  9623              MOVE AL-UABON  TO BMAINTA
  9624              MOVE -1        TO BMAINTL
  9625              MOVE ER-2260   TO EMI-ERROR
  9626              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9627              GO TO 8200-SEND-DATAONLY.
  9628
  9629     IF BCERTNOL = ZEROS
  9630       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9631         NEXT SENTENCE
  9632     ELSE
  9633         IF BCERTNOL NOT = ZEROS
  9634             MOVE AL-UANON       TO BCERTNOA
  9635         ELSE
  9636             MOVE -1             TO BCERTNOL
  9637             MOVE  1             TO SET-CURSOR-SW
  9638             MOVE ER-2218        TO EMI-ERROR
  9639             MOVE AL-UABON       TO BCERTNOA
  9640             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9641
  9642     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 177
* EL6311.cbl
  9643         MOVE AL-UANON       TO BSUFIXA
  9644     ELSE
  9645         MOVE AL-SANOF       TO BSUFIXA.
  9646
  9647
  9648* EXEC CICS READ
  9649*        DATASET (FILE-ID-ERPNDB)
  9650*        INTO    (PENDING-BUSINESS)
  9651*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
  9652*    END-EXEC.
  9653     MOVE LENGTH OF
  9654      PENDING-BUSINESS
  9655       TO DFHEIV11
  9656*    MOVE '&"IL       E          (   #00009566' TO DFHEIV0
  9657     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9658     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9659     MOVE X'2020233030303039353636' TO DFHEIV0(25:11)
  9660     CALL 'kxdfhei1' USING DFHEIV0,
  9661           FILE-ID-ERPNDB,
  9662           PENDING-BUSINESS,
  9663           DFHEIV11,
  9664           PI-PREV-CONTROL-PRIMARY,
  9665           DFHEIV99,
  9666           DFHEIV99,
  9667           DFHEIV99
  9668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9669
  9670
  9671     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9672        NEXT SENTENCE
  9673     ELSE
  9674        IF BEFFDTL NOT = ZEROS
  9675           MOVE AL-UNNON             TO BEFFDTA
  9676           MOVE BEFFDTI              TO DEEDIT-FIELD
  9677           PERFORM 8600-DEEDIT
  9678           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9679           MOVE 4                    TO DC-OPTION-CODE
  9680           PERFORM 9700-DATE-LINK
  9681           IF NO-CONVERSION-ERROR
  9682              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9683              ELSE
  9684              MOVE -1                TO BEFFDTL
  9685              MOVE  1                TO SET-CURSOR-SW
  9686              MOVE ER-2226           TO EMI-ERROR
  9687              MOVE AL-UNBON          TO BEFFDTA
  9688              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9689           ELSE
  9690              MOVE -1                TO BEFFDTL
  9691              MOVE  1                TO SET-CURSOR-SW
  9692              MOVE ER-2220           TO EMI-ERROR
  9693              MOVE AL-UNBON          TO BEFFDTA
  9694              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9695
  9696     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9697
  9698     IF BCERTNOL NOT = ZEROS
  9699        MOVE BCERTNOI                TO WS-NEW-PRIME
  9700     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 178
* EL6311.cbl
  9701        MOVE SPACES                  TO WS-NEW-PRIME.
  9702
  9703     IF BSUFIXL NOT = ZEROS
  9704        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9705     ELSE
  9706        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9707
  9708     IF BEFFDTL NOT = ZEROS
  9709        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9710     ELSE
  9711        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9712
  9713     IF BMAINTI = 'A' OR 'K' OR 'S'
  9714        NEXT SENTENCE
  9715     ELSE
  9716        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9717        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9718           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9719           WS-PB-RECORD-TYPE NOT = '1'
  9720           IF BMAINTI = 'C'
  9721               MOVE ER-2287          TO EMI-ERROR
  9722               MOVE -1               TO BCERTNOL
  9723               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9724               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9725               GO TO 8200-SEND-DATAONLY
  9726             ELSE
  9727               MOVE ER-2260          TO EMI-ERROR
  9728               MOVE -1               TO BCERTNOL
  9729               MOVE AL-UABON         TO BCERTNOA
  9730               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9731               GO TO 8200-SEND-DATAONLY.
  9732
  9733     IF BMAINTI = 'D'
  9734         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9735
  9736*    IF BMICRNOL  NOT =  ZEROS
  9737*        IF BMICRNOI  NUMERIC
  9738*            MOVE AL-UNNON       TO  BMICRNOA
  9739*        ELSE
  9740*            MOVE -1             TO  BMICRNOL
  9741*            MOVE 1              TO  SET-CURSOR-SW
  9742*            MOVE AL-UNBON       TO  BMICRNOA
  9743*            MOVE ER-2701        TO  EMI-ERROR
  9744*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9745     IF BVINL NOT = ZEROS
  9746        MOVE AL-UANON            TO BVINA
  9747     END-IF
  9748
  9749     IF LETRREQL   GREATER THAN ZEROS
  9750        IF LETRREQI = 'Y'
  9751          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9752           CONTINUE
  9753        ELSE
  9754        IF LETRREQI = 'N'
  9755          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9756           CONTINUE
  9757        ELSE
  9758           MOVE -1               TO LETRREQL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 179
* EL6311.cbl
  9759           MOVE ER-1585          TO EMI-ERROR
  9760           MOVE AL-UABON         TO LETRREQA
  9761           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9762        END-IF
  9763     END-IF.
  9764     IF B1STNML NOT = ZEROS
  9765         MOVE AL-UANON                TO B1STNMA.
  9766
  9767     IF BINITL  NOT = ZEROS
  9768        MOVE AL-UANON                TO BINITA.
  9769
  9770     IF BSEXL NOT = ZEROS
  9771        IF BSEXI = 'M' OR 'F'
  9772           MOVE AL-UANON             TO BSEXA
  9773        ELSE
  9774           MOVE -1               TO BSEXL
  9775           MOVE ER-2629          TO EMI-ERROR
  9776           MOVE AL-UABON         TO BSEXA
  9777           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9778
  9779     IF BAGEL NOT = ZEROS
  9780         IF BAGEI NUMERIC
  9781             MOVE BAGEI              TO WS-BAGE
  9782             MOVE AL-UNNON           TO BAGEA
  9783         ELSE
  9784             MOVE -1                 TO BAGEL
  9785             MOVE  1                 TO SET-CURSOR-SW
  9786             MOVE ER-2223            TO EMI-ERROR
  9787             MOVE AL-UNBON           TO BAGEA
  9788             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9789
  9790     IF BLSTNML NOT = ZERO  OR
  9791        B1STNML NOT = ZERO  OR
  9792        BINITL NOT = ZERO
  9793         IF BAGEL = ZEROS
  9794             MOVE -1                 TO BAGEL
  9795             MOVE  1                 TO SET-CURSOR-SW
  9796             MOVE ER-3269            TO EMI-ERROR
  9797             MOVE AL-UNBON           TO BAGEA
  9798             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9799         END-IF
  9800     END-IF.
  9801
  9802     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9803
  9804     IF (BBIRTHL GREATER THAN +0) AND
  9805        (BBIRTHI NOT EQUAL SPACES)
  9806        NEXT SENTENCE
  9807     ELSE
  9808        GO TO 1010-CHECK-AGE.
  9809
  9810     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9811     PERFORM 8600-DEEDIT.
  9812     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9813     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9814     MOVE AL-UNNON               TO BBIRTHA.
  9815     MOVE '4'                    TO DC-OPTION-CODE.
  9816     PERFORM 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 180
* EL6311.cbl
  9817     IF DATE-CONVERSION-ERROR
  9818        MOVE -1                  TO BBIRTHL
  9819        MOVE  1                  TO SET-CURSOR-SW
  9820        MOVE ER-2228             TO EMI-ERROR
  9821        MOVE AL-UNBON            TO BBIRTHA
  9822        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9823        GO TO 1010-CHECK-AGE.
  9824
  9825     IF (NO-CONVERSION-ERROR) AND
  9826        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9827        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9828        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9829        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9830                                    WS-CONVERTED-BIRTH
  9831        MOVE AL-UANON            TO BBIRTHA
  9832     ELSE
  9833        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9834        MOVE AL-UANON            TO BBIRTHA.
  9835
  9836 1010-CHECK-AGE.
  9837
  9838*    IF BAGEL = ZERO
  9839*       IF BBIRTHL GREATER THAN ZERO
  9840*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9841
  9842     IF B1STPMTL NOT = ZEROS
  9843        IF B1STPMTI = SPACES
  9844           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9845        ELSE
  9846           MOVE B1STPMTI             TO DEEDIT-FIELD
  9847           PERFORM 8600-DEEDIT
  9848           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9849           MOVE AL-UNNON             TO B1STPMTA
  9850           MOVE 4                    TO DC-OPTION-CODE
  9851           PERFORM 9700-DATE-LINK
  9852           IF NO-CONVERSION-ERROR
  9853              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9854              MOVE AL-UANON          TO B1STPMTA
  9855           ELSE
  9856              MOVE -1                TO B1STPMTL
  9857              MOVE  1                TO SET-CURSOR-SW
  9858              MOVE ER-2200           TO EMI-ERROR
  9859              MOVE AL-UNBON          TO B1STPMTA
  9860              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9861
  9862     IF BDAYSL NOT = ZEROS
  9863         IF BDAYSI NUMERIC
  9864             MOVE AL-UNNON           TO BDAYSA
  9865         ELSE
  9866             MOVE -1                 TO BDAYSL
  9867             MOVE ER-2530            TO EMI-ERROR
  9868             MOVE AL-UNBON           TO BDAYSA
  9869             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9870
  9871     IF BLNTRML NOT = ZEROS
  9872         IF BLNTRMI NUMERIC
  9873             MOVE AL-UNNON       TO BLNTRMA
  9874         ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 181
* EL6311.cbl
  9875             MOVE -1             TO BLNTRML
  9876             MOVE ER-2533        TO EMI-ERROR
  9877             MOVE AL-UNBON       TO BLNTRMA
  9878             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9879
  9880**   IF PI-COMPANY-ID = 'DMD'
  9881     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9882        NEXT SENTENCE
  9883     ELSE
  9884         IF BLNOFCRL NOT = ZEROS
  9885            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9886            IF LOAN-OFFICER-FOUND
  9887                MOVE AL-UANON        TO BLNOFCRA
  9888             ELSE
  9889                 MOVE SPACE          TO WS-LOAN-OFFICER
  9890                 MOVE -1             TO BLNOFCRL
  9891                 MOVE  1             TO SET-CURSOR-SW
  9892                 MOVE ER-3006        TO EMI-ERROR
  9893                 MOVE AL-UNBON       TO BLNOFCRA
  9894                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9895
  9896     IF BFREQL NOT = ZEROS
  9897         IF BFREQI NUMERIC
  9898             MOVE AL-UNNON       TO BFREQA
  9899         ELSE
  9900             MOVE -1             TO BFREQL
  9901             MOVE  1             TO SET-CURSOR-SW
  9902             MOVE ER-2223        TO EMI-ERROR
  9903             MOVE AL-UNBON       TO BFREQA
  9904             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9905
  9906     IF BMODEL NOT = ZEROS
  9907         MOVE BMODEI             TO WS-MODE-CODE
  9908                                    PI-BMODE
  9909         IF WS-MODE-CODE-VALID
  9910             MOVE AL-UANON       TO BMODEA
  9911         ELSE
  9912             MOVE -1             TO BMODEL
  9913             MOVE ER-2591        TO EMI-ERROR
  9914             MOVE AL-UABON       TO BMODEA
  9915             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9916
  9917     IF BPMTSL NOT = ZEROS
  9918         IF BPMTSI NUMERIC
  9919             MOVE AL-UNNON           TO BPMTSA
  9920             MOVE BPMTSI             TO PI-BPMTS
  9921         ELSE
  9922             MOVE -1                 TO BPMTSL
  9923             MOVE ER-2592            TO EMI-ERROR
  9924             MOVE AL-UNBON           TO BPMTSA
  9925             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9926
  9927     IF BPMTAMTL NOT = ZEROS
  9928
  9929* EXEC CICS BIF DEEDIT
  9930*            FIELD  (BPMTAMTI)
  9931*            LENGTH (9)
  9932*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 182
* EL6311.cbl
  9933     MOVE 9
  9934       TO DFHEIV11
  9935*    MOVE '@"L                   #   #00009829' TO DFHEIV0
  9936     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9937     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9938     MOVE X'2020233030303039383239' TO DFHEIV0(25:11)
  9939     CALL 'kxdfhei1' USING DFHEIV0,
  9940           BPMTAMTI,
  9941           DFHEIV11
  9942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9943        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9944*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9945*        PERFORM 8600-DEEDIT
  9946*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9947
  9948*    IF BAPRL NOT = ZEROS
  9949*        EXEC CICS BIF DEEDIT
  9950*            FIELD  (BAPRI)
  9951*            LENGTH (7)
  9952*        END-EXEC
  9953*        MOVE BAPRI              TO WS-BAPR.
  9954
  9955     IF BAPRL > 0
  9956        MOVE +0                  TO  WS-BAPR
  9957        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9958           (WS-SUB > 7)
  9959           OR (BAPRI (WS-SUB:1) NUMERIC)
  9960           OR (BAPRI (WS-SUB:1) = '.')
  9961        END-PERFORM
  9962        IF WS-SUB > 7
  9963           MOVE ER-2471       TO EMI-ERROR
  9964           MOVE -1            TO BAPRL
  9965           MOVE AL-UNBON      TO BAPRA
  9966           PERFORM 9900-ERROR-FORMAT
  9967                                 THRU 9900-EXIT
  9968        ELSE
  9969           IF BAPRI (WS-SUB:1) NUMERIC
  9970              MOVE WS-SUB           TO WS-BEG
  9971              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9972                 (WS-SUB > 7)
  9973                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9974              END-PERFORM
  9975              COMPUTE WS-END = WS-SUB - WS-BEG
  9976              MOVE BAPRI (WS-BEG:WS-END)
  9977                                 TO WS-APR-WHOLE-NUM
  9978           END-IF
  9979           IF BAPRI (WS-SUB:1) = '.'
  9980              COMPUTE WS-BEG = WS-SUB + 1
  9981              IF (WS-BEG < 8)
  9982                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9983                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9984                    (WS-SUB > 7)
  9985                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9986                 END-PERFORM
  9987                 COMPUTE WS-END = WS-SUB - WS-BEG
  9988                 MOVE BAPRI (WS-BEG:WS-END)
  9989                                 TO WS-APR-DEC (1:WS-END)
  9990              END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 183
* EL6311.cbl
  9991           END-IF
  9992           MOVE AL-UNNON      TO BAPRA
  9993           MOVE WS-BAPR       TO BAPRO
  9994        END-IF
  9995     END-IF
  9996*     IF BAPRL NOT = ZEROS
  9997*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9998*        PERFORM 8600-DEEDIT
  9999*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
 10000
 10001     IF BLIVESL NOT = ZEROS
 10002        MOVE BLIVESI             TO DEEDIT-FIELD
 10003        PERFORM 8600-DEEDIT
 10004        IF DEEDIT-FIELD-V0 NUMERIC
 10005           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
 10006           MOVE AL-UNNON         TO BLIVESA
 10007        ELSE
 10008           MOVE -1               TO BLIVESL
 10009           MOVE AL-UNBON         TO BLIVESA
 10010           MOVE ER-2223          TO EMI-ERROR
 10011           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10012
 10013*DMD CUSTOM CODING*************START
 10014*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
 10015     IF PI-COMPANY-ID NOT = 'DMD'
 10016         MOVE ZEROS               TO BBILLEDL
 10017         GO TO 1010-EDIT-CONT.
 10018
 10019     IF BBILLEDL NOT = ZEROS
 10020        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
 10021        MOVE 'Y'                 TO WS-NUMERIC-SW
 10022        MOVE +1                  TO WS-CSO-SUB
 10023        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
 10024        IF CSO-NUMERIC-FIELD
 10025
 10026* EXEC CICS BIF DEEDIT
 10027*              FIELD  (BBILLEDI)
 10028*              LENGTH (9)
 10029*          END-EXEC
 10030     MOVE 9
 10031       TO DFHEIV11
 10032*    MOVE '@"L                   #   #00009915' TO DFHEIV0
 10033     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10034     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10035     MOVE X'2020233030303039393135' TO DFHEIV0(25:11)
 10036     CALL 'kxdfhei1' USING DFHEIV0,
 10037           BBILLEDI,
 10038           DFHEIV11
 10039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10040           MOVE BBILLEDI         TO WS-BILLED
 10041           MOVE AL-UNNON         TO BBILLEDA
 10042        ELSE
 10043           MOVE -1               TO BBILLEDL
 10044           MOVE AL-UNBON         TO BBILLEDA
 10045           MOVE ER-2547          TO EMI-ERROR
 10046           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10047     ELSE
 10048        IF BMAINTI EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 184
* EL6311.cbl
 10049           MOVE -1               TO BBILLEDL
 10050           MOVE AL-UNBON         TO BBILLEDA
 10051           MOVE ER-8148          TO EMI-ERROR
 10052           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10053
 10054 1010-EDIT-CONT.
 10055
 10056     IF BFORCEL  NOT = ZEROS
 10057         IF FORCE-CAP
 10058            MOVE AL-UANON            TO BFORCEA
 10059         ELSE
 10060            MOVE ER-2945             TO EMI-ERROR
 10061            MOVE AL-UABON            TO BFORCEA
 10062            MOVE -1                  TO BFORCEL
 10063            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10064
 10065     if (bforcel not = zeros)
 10066        and (bforcei = 'L')
 10067        and (not csr-edit-session)
 10068        and (emi-error <> er-2945)
 10069        MOVE ER-2670             TO EMI-ERROR
 10070        MOVE AL-UABON            TO BFORCEA
 10071        MOVE -1                  TO BFORCEL
 10072        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10073     end-if
 10074     IF BENTRYL NOT = ZEROS
 10075        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
 10076                 'C' and 'D' AND 'V' AND 'U' AND 'M'
 10077           MOVE ER-2224              TO EMI-ERROR
 10078           MOVE AL-UABON             TO BENTRYA
 10079           MOVE -1                   TO BENTRYL
 10080           MOVE  1                   TO SET-CURSOR-SW
 10081           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10082        ELSE
 10083           MOVE AL-UANON             TO BENTRYA.
 10084
 10085     IF BUNWRITL NOT = ZEROS
 10086        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
 10087           MOVE ER-7574              TO EMI-ERROR
 10088           MOVE AL-UABON             TO BUNWRITA
 10089           MOVE -1                   TO BUNWRITL
 10090           MOVE  1                   TO SET-CURSOR-SW
 10091           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10092        ELSE
 10093           MOVE AL-UANON             TO BUNWRITA.
 10094
 10095     IF BREINL  NOT = ZEROS
 10096         MOVE AL-UANON               TO BREINA.
 10097
 10098     IF BBILCDL NOT = ZEROS
 10099        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 10100                             AND 'A' AND 'B' AND 'E'
 10101           MOVE ER-2225              TO EMI-ERROR
 10102           MOVE AL-UABON             TO BBILCDA
 10103           MOVE -1                   TO BBILCDL
 10104           MOVE  1                   TO SET-CURSOR-SW
 10105           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10106        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 185
* EL6311.cbl
 10107           MOVE AL-UANON             TO BBILCDA.
 10108
 10109     IF BSKPCDL NOT = ZEROS
 10110         MOVE AL-UANON               TO BSKPCDA.
 10111
 10112     IF BINDGRPL NOT = ZEROS
 10113         MOVE AL-UANON               TO BINDGRPA.
 10114
 10115     IF BSIGL   NOT = ZEROS
 10116         MOVE AL-UANON               TO BSIGA.
 10117
 10118     IF BRTCLSL NOT = ZEROS
 10119         MOVE AL-UANON               TO BRTCLSA.
 10120
 10121     IF BMEMBERL NOT = ZEROS
 10122         MOVE AL-UANON               TO BMEMBERA.
 10123
 10124     MOVE +0                         TO WS-SUB1.
 10125
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 186
* EL6311.cbl
 10127
 10128******************************************************************
 10129*                                                                *
 10130*           E D I T   I S S U E   C O V E R A G E S              *
 10131*                                                                *
 10132******************************************************************
 10133
 10134 1020-EDIT-COVERAGES.
 10135     ADD +1                      TO WS-SUB1.
 10136
 10137     IF WS-SUB1 GREATER +2
 10138        GO TO 1025-EDIT-CONTINUE
 10139     END-IF
 10140
 10141     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10142       IF (BMODEL   GREATER ZERO  OR
 10143            BPMTSL   GREATER ZERO  OR
 10144            BPMTAMTL GREATER ZERO)
 10145          AND
 10146            BTYPE-LEN (WS-SUB1) GREATER THAN +0
 10147               GO TO 1021-CONT-EDIT.
 10148
 10149     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10150        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10151        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
 10152        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10153        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
 10154        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
 10155        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
 10156        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
 10157        NEXT SENTENCE
 10158         ELSE
 10159            GO TO 1020-EDIT-COVERAGES.
 10160
 10161 1021-CONT-EDIT.
 10162
 10163     IF BMAINTI = 'A'
 10164        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10165           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
 10166        ELSE
 10167           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
 10168           MOVE ER-7404          TO EMI-ERROR
 10169           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
 10170           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10171     ELSE
 10172        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10173           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
 10174
 10175     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
 10176        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
 10177        PERFORM 8600-DEEDIT
 10178        IF DEEDIT-FIELD-V0 NUMERIC
 10179           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
 10180        ELSE
 10181           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
 10182
 10183     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10184*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 187
* EL6311.cbl
 10185        IF BMODEL  GREATER THAN ZEROS  AND
 10186           BPMTSL  GREATER THAN ZEROS
 10187           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10188
 10189     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10190         IF BMODEL   GREATER THAN ZEROS  OR
 10191            BPMTSL   GREATER THAN ZEROS  OR
 10192            BPMTAMTL GREATER THAN ZEROS
 10193             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10194
 10195     IF BMAINTI = ('C' OR 'K')
 10196        IF BTERM-LEN (WS-SUB1)  = ZEROS
 10197           NEXT SENTENCE
 10198        ELSE
 10199           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10200           PERFORM 8600-DEEDIT
 10201           IF DEEDIT-FIELD-V0 NUMERIC
 10202              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
 10203              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
 10204                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
 10205              ELSE
 10206                    MOVE ER-2241      TO EMI-ERROR
 10207                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
 10208                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
 10209                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10210           ELSE
 10211              MOVE ER-2223          TO EMI-ERROR
 10212              MOVE -1               TO BTERM-LEN     (WS-SUB1)
 10213              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
 10214              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10215     ELSE
 10216        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
 10217            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10218            PERFORM 8600-DEEDIT
 10219            IF DEEDIT-FIELD-V0      NUMERIC
 10220               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
 10221                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
 10222                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
 10223               ELSE
 10224                  MOVE ER-2241         TO EMI-ERROR
 10225                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
 10226                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
 10227                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10228            ELSE
 10229              MOVE ER-2223             TO EMI-ERROR
 10230              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
 10231              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
 10232              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10233        ELSE
 10234            MOVE ER-2240               TO EMI-ERROR
 10235            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
 10236            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10237*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10238*        IF BMODEL  GREATER THAN ZEROS  AND
 10239*           BPMTSL  GREATER THAN ZEROS
 10240*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10241
 10242     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 188
* EL6311.cbl
 10243        AND BMAINTI = ('C' OR 'K')
 10244           NEXT SENTENCE
 10245     ELSE
 10246        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
 10247           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
 10248
 10249* EXEC CICS BIF DEEDIT
 10250*              FIELD  (BBENI (WS-SUB1))
 10251*              LENGTH (12)
 10252*          END-EXEC
 10253     MOVE 12
 10254       TO DFHEIV11
 10255*    MOVE '@"L                   #   #00010127' TO DFHEIV0
 10256     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10257     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10258     MOVE X'2020233030303130313237' TO DFHEIV0(25:11)
 10259     CALL 'kxdfhei1' USING DFHEIV0,
 10260           BBENI(WS-SUB1),
 10261           DFHEIV11
 10262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10263           IF BBENI (WS-SUB1)  NUMERIC
 10264              IF BBENI (WS-SUB1) GREATER THAN ZEROS
 10265                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
 10266*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
 10267*          PERFORM 8600-DEEDIT
 10268*          IF DEEDIT-FIELD-V2  NUMERIC
 10269*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10270*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10271              ELSE
 10272                 MOVE ER-7632    TO EMI-ERROR
 10273                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10274                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10275                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10276           ELSE
 10277              MOVE ER-2223         TO EMI-ERROR
 10278              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10279              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10280              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10281        ELSE
 10282           MOVE ER-7632    TO EMI-ERROR
 10283           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10284           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10285           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10286
 10287     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10288        AND (BMAINTI = ('C' OR 'K'))
 10289        CONTINUE
 10290     ELSE
 10291        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10292           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10293           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10294              FOR ALL '.'
 10295           IF WS-TALLY > 1
 10296              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10297                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10298              END-PERFORM
 10299              IF A1 < 9
 10300                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 189
* EL6311.cbl
 10301                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10302              END-IF
 10303           ELSE
 10304              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10305                (A1 > 11)
 10306                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10307                  LOW-VALUES OR SPACES)
 10308              END-PERFORM
 10309              IF A1 > 1 AND < 12
 10310                 MOVE SPACES
 10311                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10312              END-IF
 10313           END-IF
 10314
 10315* EXEC CICS BIF DEEDIT
 10316*              FIELD  (BPREMI (WS-SUB1))
 10317*              LENGTH (11)
 10318*          END-EXEC
 10319     MOVE 11
 10320       TO DFHEIV11
 10321*    MOVE '@"L                   #   #00010182' TO DFHEIV0
 10322     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10323     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10324     MOVE X'2020233030303130313832' TO DFHEIV0(25:11)
 10325     CALL 'kxdfhei1' USING DFHEIV0,
 10326           BPREMI(WS-SUB1),
 10327           DFHEIV11
 10328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10329           IF BPREMI (WS-SUB1) NUMERIC
 10330              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10331                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10332*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10333*          PERFORM 8600-DEEDIT
 10334*          IF DEEDIT-FIELD-V2  NUMERIC
 10335*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10336*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10337              ELSE
 10338                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10339                    MOVE ER-7633    TO EMI-ERROR
 10340                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10341                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10342                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10343                 END-IF
 10344              END-IF
 10345           ELSE
 10346              MOVE ER-2223         TO EMI-ERROR
 10347              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10348              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10349              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10350           END-IF
 10351        ELSE
 10352           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10353              MOVE ER-7633         TO EMI-ERROR
 10354              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10355              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10356              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10357           END-IF
 10358        END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 190
* EL6311.cbl
 10359     END-IF
 10360
 10361     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10362        NEXT SENTENCE
 10363     ELSE
 10364        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10365
 10366* EXEC CICS BIF DEEDIT
 10367*           FIELD  (BCPREMI (WS-SUB1))
 10368*           LENGTH (11)
 10369*       END-EXEC
 10370     MOVE 11
 10371       TO DFHEIV11
 10372*    MOVE '@"L                   #   #00010222' TO DFHEIV0
 10373     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10374     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10375     MOVE X'2020233030303130323232' TO DFHEIV0(25:11)
 10376     CALL 'kxdfhei1' USING DFHEIV0,
 10377           BCPREMI(WS-SUB1),
 10378           DFHEIV11
 10379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10380        IF BCPREMI (WS-SUB1) NUMERIC
 10381           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10382*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10383*       PERFORM 8600-DEEDIT
 10384*       IF DEEDIT-FIELD-V2  NUMERIC
 10385*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10386        ELSE
 10387           MOVE ER-2223         TO EMI-ERROR
 10388           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10389           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10390           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10391
 10392     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10393        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10394        PERFORM 8600-DEEDIT
 10395        IF DEEDIT-FIELD-V0 NUMERIC
 10396           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10397           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10398         ELSE
 10399           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10400           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10401           MOVE ER-2223              TO EMI-ERROR
 10402           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10403
 10404     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10405        IF BEXPIRE   (WS-SUB1) = SPACES
 10406           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10407        ELSE
 10408           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10409           PERFORM 8600-DEEDIT
 10410           IF DEEDIT-FIELD-V0        NUMERIC
 10411              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10412              MOVE 4                TO DC-OPTION-CODE
 10413              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10414              PERFORM 9700-DATE-LINK
 10415              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10416                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 191
* EL6311.cbl
 10417              IF NO-CONVERSION-ERROR
 10418                 NEXT SENTENCE
 10419              ELSE
 10420                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10421                 MOVE ER-2531    TO EMI-ERROR
 10422                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10423                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10424           ELSE
 10425             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10426             MOVE ER-2532        TO EMI-ERROR
 10427             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10428             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10429
 10430     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10431        NEXT SENTENCE
 10432     ELSE
 10433
 10434* EXEC CICS BIF DEEDIT
 10435*           FIELD  (BALT-BENI (WS-SUB1))
 10436*           LENGTH (12)
 10437*       END-EXEC
 10438     MOVE 12
 10439       TO DFHEIV11
 10440*    MOVE '@"L                   #   #00010279' TO DFHEIV0
 10441     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10442     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10443     MOVE X'2020233030303130323739' TO DFHEIV0(25:11)
 10444     CALL 'kxdfhei1' USING DFHEIV0,
 10445           BALT-BENI(WS-SUB1),
 10446           DFHEIV11
 10447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10448        IF BALT-BENI (WS-SUB1) NUMERIC
 10449           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10450*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10451*       PERFORM 8600-DEEDIT
 10452*       IF DEEDIT-FIELD-V0 NUMERIC
 10453*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10454        ELSE
 10455           MOVE ER-2223         TO EMI-ERROR
 10456           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10457           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10458           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10459
 10460     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10461        NEXT SENTENCE
 10462     ELSE
 10463
 10464* EXEC CICS BIF DEEDIT
 10465*           FIELD  (BALT-PREMI (WS-SUB1))
 10466*           LENGTH (11)
 10467*       END-EXEC
 10468     MOVE 11
 10469       TO DFHEIV11
 10470*    MOVE '@"L                   #   #00010298' TO DFHEIV0
 10471     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10472     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10473     MOVE X'2020233030303130323938' TO DFHEIV0(25:11)
 10474     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 192
* EL6311.cbl
 10475           BALT-PREMI(WS-SUB1),
 10476           DFHEIV11
 10477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10478        IF BALT-PREMI (WS-SUB1) NUMERIC
 10479           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10480*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10481*       PERFORM 8600-DEEDIT
 10482*       IF DEEDIT-FIELD-V0 NUMERIC
 10483*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10484        ELSE
 10485           MOVE ER-2223         TO EMI-ERROR
 10486           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10487           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10488           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10489
 10490      GO TO 1020-EDIT-COVERAGES.
 10491     .
 10492 1025-edit-continue.
 10493     IF PI-COMPANY-ID  =  'DMD'
 10494        MOVE LOW-VALUES             TO BNCERTI
 10495                                       BNSTATI.
 10496
 10497     IF EMI-ERROR = ZEROS
 10498         NEXT SENTENCE
 10499     ELSE
 10500         GO TO 8200-SEND-DATAONLY.
 10501
 10502     IF BMAINTI = 'A'
 10503         GO TO 1200-ADD-ISSUE-ROUTINE.
 10504
 10505     IF BMAINTI = 'C'
 10506         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10507**  This must be a 'K' transaction A,C,S & D spoke for
 10508
 10509     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10510
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 193
* EL6311.cbl
 10512
 10513 1030-EDIT-FOR-NUMERICS.
 10514     IF WS-CSO-SUB EQUAL 10
 10515        GO TO 1030-EDIT-EXIT.
 10516
 10517     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10518        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10519        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10520           ADD +1               TO WS-CSO-SUB
 10521           GO TO 1030-EDIT-FOR-NUMERICS.
 10522
 10523     MOVE 'N'                   TO WS-NUMERIC-SW.
 10524
 10525 1030-EDIT-EXIT.
 10526******************************************************************
 10527*                                                                *
 10528*                 C A L C U L A T E   A G E                      *
 10529*                                                                *
 10530******************************************************************
 10531
 10532
 10533 1095-CALC-AGE.
 10534
 10535     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10536     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10537     MOVE 1                  TO DC-OPTION-CODE.
 10538     PERFORM 9700-DATE-LINK
 10539     IF NO-CONVERSION-ERROR
 10540         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10541         MOVE WS-BAGE            TO BAGEI
 10542         MOVE +2                 TO BAGEL
 10543         MOVE AL-UNNON TO BAGEA.
 10544
 10545 1099-EXIT.
 10546     EXIT.
 10547
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 194
* EL6311.cbl
 10549
 10550******************************************************************
 10551*                                                                *
 10552*                   S H O W   I S S U E                          *
 10553*                                                                *
 10554******************************************************************
 10555
 10556 1100-SHOW-REQUEST.
 10557     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10558
 10559     IF BCERTNOL = ZEROS AND
 10560        BEFFDTL  = ZEROS
 10561        MOVE -1                  TO BMAINTL
 10562        GO TO 8200-SEND-DATAONLY.
 10563
 10564     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10565
 10566     IF BSUFIXL NOT = ZEROS
 10567        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10568     ELSE
 10569        MOVE SPACE               TO WS-NEW-SUFFIX.
 10570
 10571     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10572     PERFORM 8600-DEEDIT.
 10573     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10574     MOVE '4'                    TO DC-OPTION-CODE.
 10575     PERFORM 9700-DATE-LINK.
 10576     IF DATE-CONVERSION-ERROR
 10577        MOVE ER-0348             TO EMI-ERROR
 10578        MOVE -1                  TO BEFFDTL
 10579        MOVE AL-UABON            TO BEFFDTA
 10580        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10581        GO TO 8200-SEND-DATAONLY
 10582     ELSE
 10583        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10584        MOVE AL-UANON            TO BEFFDTA
 10585        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10586
 10587     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10588
 10589     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10590        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10591          MOVE 'Y'                    TO WS-SHOW-SW
 10592          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10593             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10594           ELSE
 10595             IF PI-FILE-BROWSE
 10596                GO TO 4300-BROWSE-FILE-FORWARD
 10597              ELSE
 10598                IF PI-CSR-BROWSE
 10599                   GO TO 4200-BROWSE-CSR-FORWARD
 10600                ELSE
 10601                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10602        ELSE
 10603           GO TO 3900-RE-DISPLAY-RECORD.
 10604
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 195
* EL6311.cbl
 10606
 10607******************************************************************
 10608*                                                                *
 10609*            A D D   I S S U E   R O U T I N E                   *
 10610*                                                                *
 10611******************************************************************
 10612
 10613***************************************************************
 10614*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10615*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10616*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10617*     4. LINK TO THE EDIT ROUTINE.                            *
 10618*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10619*     6. WRITE THE NEW ISSUE RECORD.                          *
 10620*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10621*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10622*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10623*        ELSE                                                 *
 10624*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10625***************************************************************
 10626
 10627 1200-ADD-ISSUE-ROUTINE.
 10628     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10629
 10630
 10631* EXEC CICS GETMAIN
 10632*        SET     (ADDRESS OF PENDING-BUSINESS)
 10633*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10634*    END-EXEC.
 10635*    MOVE '," L                  $   #00010454' TO DFHEIV0
 10636     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10637     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10638     MOVE X'2020233030303130343534' TO DFHEIV0(25:11)
 10639     CALL 'kxdfhei1' USING DFHEIV0,
 10640           DFHEIV20,
 10641           ERPNDB-RECORD-LENGTH,
 10642           DFHEIV99
 10643     SET ADDRESS OF PENDING-BUSINESS TO
 10644         DFHEIV20
 10645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10646
 10647
 10648
 10649* EXEC CICS HANDLE CONDITION
 10650*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10651*    END-EXEC.
 10652*    MOVE '"$I                   ! # #00010459' TO DFHEIV0
 10653     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10655     MOVE X'2320233030303130343539' TO DFHEIV0(25:11)
 10656     CALL 'kxdfhei1' USING DFHEIV0
 10657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10658
 10659
 10660     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10661     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10662     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10663
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 196
* EL6311.cbl
 10664
 10665* EXEC CICS READ
 10666*        INTO    (PENDING-BUSINESS)
 10667*        DATASET (FILE-ID-ERPNDB)
 10668*        RIDFLD  (ERPNDB-KEY)
 10669*    END-EXEC.
 10670     MOVE LENGTH OF
 10671      PENDING-BUSINESS
 10672       TO DFHEIV11
 10673*    MOVE '&"IL       E          (   #00010467' TO DFHEIV0
 10674     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10675     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10676     MOVE X'2020233030303130343637' TO DFHEIV0(25:11)
 10677     CALL 'kxdfhei1' USING DFHEIV0,
 10678           FILE-ID-ERPNDB,
 10679           PENDING-BUSINESS,
 10680           DFHEIV11,
 10681           ERPNDB-KEY,
 10682           DFHEIV99,
 10683           DFHEIV99,
 10684           DFHEIV99
 10685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10686
 10687
 10688     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10689
 10690     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10691     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10692     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10693     MOVE SPACES                 TO PENDING-BUSINESS.
 10694     MOVE 'PB'                   TO PB-RECORD-ID.
 10695     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10696     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10697     MOVE SPACES                 TO PB-CERT-SFX.
 10698     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10699     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10700                                    PB-ALT-CHG-SEQ-NO.
 10701
 10702     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10703     MOVE '1'                    TO PB-RECORD-TYPE.
 10704
 10705     IF BSUFIXL NOT = ZEROS
 10706        MOVE BSUFIXI             TO PB-CERT-SFX.
 10707
 10708     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10709
 10710     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10711     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10712
 10713     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10714                                    PB-I-LF-PREM-CALC
 10715                                    PB-I-LF-ALT-PREM-CALC
 10716                                    PB-I-LF-RATE
 10717                                    PB-I-LF-ALT-RATE
 10718                                    PB-I-LF-REI-RATE
 10719                                    PB-I-LF-ALT-REI-RATE
 10720                                    PB-I-RATE-DEV-PCT-LF
 10721                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 197
* EL6311.cbl
 10722                                    PB-I-AH-RATE
 10723                                    PB-I-AH-REI-RATE
 10724                                    PB-I-AH-RATE-TRM
 10725                                    PB-I-RATE-DEV-PCT-AH
 10726                                    PB-I-BUSINESS-TYPE
 10727                                    PB-I-LIFE-COMMISSION
 10728                                    PB-I-JOINT-COMMISSION
 10729                                    PB-I-JOINT-AGE
 10730                                    PB-I-AH-COMMISSION
 10731                                    PB-I-CURR-SEQ
 10732                                    PB-CHG-COUNT
 10733                                    PB-LF-BILLED-AMTS
 10734                                    PB-AH-BILLED-AMTS
 10735                                    PB-CALC-TOLERANCE
 10736                                    PB-I-EXTENTION-DAYS
 10737*                                   PB-I-MICROFILM-NO
 10738                                    PB-I-TERM-IN-DAYS.
 10739
 10740     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10741                                    PB-I-LF-EXPIRE-DT
 10742                                    PB-I-AH-EXPIRE-DT
 10743                                    PB-BILLED-DT
 10744                                    PB-ACCT-EFF-DT
 10745                                    PB-ACCT-EXP-DT
 10746                                    PB-I-1ST-PMT-DT.
 10747
 10748     MOVE 'X'                    TO PB-FATAL-FLAG.
 10749
 10750     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10751
 10752     IF BLSTNML GREATER THAN ZEROS
 10753         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10754
 10755*    IF BMICRNOL  GREATER  ZEROS
 10756*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10757*    ELSE
 10758*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10759     IF BVINL > ZEROS
 10760        MOVE BVINI               TO PB-I-VIN
 10761     END-IF
 10762     IF B1STNML GREATER THAN ZEROS
 10763         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10764
 10765     IF BINITL  GREATER THAN ZEROS
 10766         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10767
 10768     IF BBIRTHL GREATER THAN ZERO
 10769         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10770     ELSE
 10771         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10772
 10773     IF B1STPMTL GREATER THAN ZERO
 10774         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10775     ELSE
 10776         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10777
 10778     IF BAGEL    GREATER THAN ZEROS
 10779         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 198
* EL6311.cbl
 10780        ELSE
 10781         MOVE ZEROS              TO PB-I-AGE.
 10782
 10783     IF BSEXL    GREATER THAN ZEROS
 10784         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10785
 10786     IF BTERM-LEN (1) GREATER THAN ZEROS
 10787        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10788     ELSE
 10789        MOVE ZEROS               TO PB-I-LF-TERM.
 10790
 10791     IF BTERM-LEN (2) GREATER THAN ZEROS
 10792        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10793     ELSE
 10794        MOVE ZEROS               TO PB-I-AH-TERM.
 10795
 10796     IF BLNTRML       GREATER THAN ZEROS
 10797         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10798        ELSE
 10799         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10800
 10801     IF BFREQL        GREATER THAN ZEROS
 10802         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10803        ELSE
 10804         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10805
 10806     IF BSKPCDL       GREATER THAN ZEROS
 10807         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10808
 10809     IF BMODEL        GREATER THAN ZEROS
 10810         MOVE BMODEI             TO PB-I-TERM-TYPE
 10811                                    PI-BMODE.
 10812
 10813     IF BPMTSL        GREATER THAN ZEROS
 10814         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10815                                    PI-BPMTS
 10816        ELSE
 10817         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10818                                    PI-BPMTS.
 10819
 10820     IF BPMTAMTL      GREATER THAN ZEROS
 10821         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10822        ELSE
 10823         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10824
 10825     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10826        IF BTYPE  (1)   NOT = ZEROS
 10827           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10828                                    PI-BTYPE (1)
 10829           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10830           MOVE SPACES           TO PB-I-LF-ABBR
 10831        ELSE
 10832           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10833                                    PB-I-LF-ABBR
 10834           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10835     ELSE
 10836        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10837                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 199
* EL6311.cbl
 10838        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10839
 10840     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10841         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10842     ELSE
 10843         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10844
 10845     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10846         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10847     ELSE
 10848         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10849
 10850     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10851         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10852            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10853            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10854         ELSE
 10855            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10856*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10857*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10858         END-IF
 10859     ELSE
 10860         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10861
 10862     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10863         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10864
 10865     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10866         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10867         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10868     ELSE
 10869         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10870
 10871     IF  BALT-PREM-LEN     (2) > ZEROS
 10872         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10873     ELSE
 10874         MOVE ZEROS            TO PB-I-TOT-FEES.
 10875
 10876     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10877        IF BTYPE      (2)   NOT = ZEROS
 10878           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10879                                  PI-BTYPE (2)
 10880           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10881           MOVE SPACES         TO PB-I-AH-ABBR
 10882        ELSE
 10883           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10884                                  PB-I-AH-ABBR
 10885           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10886     ELSE
 10887        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10888                                  PB-I-AH-ABBR
 10889        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10890
 10891     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10892         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10893     ELSE
 10894         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10895
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 200
* EL6311.cbl
 10896     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10897         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10898            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10899            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10900         ELSE
 10901            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10902*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10903*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10904         END-IF
 10905     ELSE
 10906         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10907
 10908     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10909         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10910
 10911     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10912        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10913     ELSE
 10914        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10915
 10916     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10917        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10918     ELSE
 10919        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10920
 10921     IF BINDGRPL  GREATER THAN ZEROS
 10922         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10923
 10924     IF BRTCLSL   GREATER THAN ZEROS
 10925         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10926
 10927     IF BSIGL     GREATER THAN ZEROS
 10928         MOVE BSIGI              TO PB-I-SIG-SW.
 10929     IF BAPRL > ZEROS
 10930         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10931     ELSE
 10932        if pi-company-id = 'CID'
 10933           move +99.9999         to pb-i-loan-apr
 10934        else
 10935           MOVE ZEROS            TO PB-I-LOAN-APR
 10936        end-if
 10937     end-if
 10938     IF BMEMBERL  GREATER THAN ZEROS
 10939         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10940
 10941     IF BLNOFCRL  GREATER THAN ZEROS
 10942         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10943
 10944     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10945        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10946     ELSE
 10947        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10948
 10949     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10950        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10951     ELSE
 10952        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10953
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 201
* EL6311.cbl
 10954     IF BDAYSL   GREATER THAN ZEROS
 10955        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10956                                    PB-I-EXTENTION-DAYS
 10957     ELSE
 10958        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10959                                    PB-I-EXTENTION-DAYS.
 10960
 10961     IF BDAYSL GREATER THAN ZEROS
 10962        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10963
 10964     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10965        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10966           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10967
 10968     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10969        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10970           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10971
 10972     IF B1STPMTL GREATER THAN ZEROS
 10973        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10974
 10975     IF PB-EXT-DAYS-PROCESSING
 10976        IF PB-I-EXTENTION-DAYS = ZEROS
 10977           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10978
 10979     IF PB-EXPIRE-DT-PROCESSING
 10980        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10981           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10982             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10983
 10984     IF PB-1ST-PMT-DT-PROCESSING
 10985        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10986           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10987
 10988     IF BREINL GREATER THAN ZEROS
 10989        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10990
 10991     IF BENTRYL NOT = ZEROS
 10992        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10993        IF PI-COMPANY-ID = 'CID'
 10994           AND (PB-BATCH-ENTRY = 'P')
 10995           AND (PB-STATE = 'VA')
 10996           PERFORM 1500-UPDATE-ERNOTE
 10997                                 THRU 1500-EXIT
 10998        END-IF
 10999     END-IF
 11000     IF BUNWRITL NOT = ZEROS
 11001        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11002
 11003     IF BFORCEL NOT = ZEROS
 11004        MOVE BFORCEI             TO PB-FORCE-CODE.
 11005
 11006     IF BBILCDL NOT = ZEROS
 11007        MOVE BBILCDI             TO PB-RECORD-BILL.
 11008
 11009     IF BLIVESL GREATER THAN ZEROS
 11010        MOVE WS-BLIVES           TO PB-I-LIVES
 11011     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 202
* EL6311.cbl
 11012        MOVE ZEROS               TO PB-I-LIVES.
 11013
 11014     IF BBILLEDL GREATER THAN ZEROS
 11015        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 11016     ELSE
 11017        MOVE ZEROS               TO PB-I-NUM-BILLED.
 11018
 11019*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 11020
 11021 1260-WRITE-PB-RECORD.
 11022     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 11023                                    PB-INPUT-BY.
 11024     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11025     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 11026                                    PB-INPUT-DT.
 11027
 11028     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11029     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 11030                                    PB-CONTROL-BY-ORIG-BATCH.
 11031
 11032
 11033     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11034     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 11035     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11036     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11037     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11038
 11039     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11040
 11041     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11042
 11043     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11044     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11045     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11046
 11047     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 11048     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 11049
 11050 1275-WRITE-PENDING-BUSINESS.
 11051     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11052     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11053     MOVE 'A'                    TO JP-RECORD-TYPE.
 11054     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11055
 11056
 11057* EXEC CICS HANDLE CONDITION
 11058*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 11059*    END-EXEC.
 11060*    MOVE '"$%                   ! $ #00010841' TO DFHEIV0
 11061     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11062     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11063     MOVE X'2420233030303130383431' TO DFHEIV0(25:11)
 11064     CALL 'kxdfhei1' USING DFHEIV0
 11065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11066
 11067
 11068
 11069* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 203
* EL6311.cbl
 11070*        DATASET (FILE-ID-ERPNDB)
 11071*        FROM    (PENDING-BUSINESS)
 11072*        RIDFLD  (PB-CONTROL-PRIMARY)
 11073*    END-EXEC.
 11074     MOVE LENGTH OF
 11075      PENDING-BUSINESS
 11076       TO DFHEIV11
 11077*    MOVE '&$ L                  ''   #00010845' TO DFHEIV0
 11078     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11079     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11080     MOVE X'2020233030303130383435' TO DFHEIV0(25:11)
 11081     CALL 'kxdfhei1' USING DFHEIV0,
 11082           FILE-ID-ERPNDB,
 11083           PENDING-BUSINESS,
 11084           DFHEIV11,
 11085           PB-CONTROL-PRIMARY,
 11086           DFHEIV99,
 11087           DFHEIV99
 11088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11089
 11090
 11091     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 11092
 11093     PERFORM 8400-LOG-JOURNAL-RECORD *> New Issue record
 11094
 11095******************************************************************
 11096*       A D D  O R I G I N A L  C E R T  I N F O                 *
 11097******************************************************************
 11098     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11099     MOVE ' '                    TO WS-ERMAIL-SW
 11100
 11101* EXEC CICS READ
 11102*       DATASET   (FILE-ID-ERMAIL)
 11103*       SET       (ADDRESS OF MAILING-DATA)
 11104*       RIDFLD    (ERMAIL-KEY)
 11105*       RESP      (WS-RESPONSE)
 11106*    END-EXEC
 11107*    MOVE '&"S        E          (  N#00010861' TO DFHEIV0
 11108     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11109     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11110     MOVE X'204E233030303130383631' TO DFHEIV0(25:11)
 11111     CALL 'kxdfhei1' USING DFHEIV0,
 11112           FILE-ID-ERMAIL,
 11113           DFHEIV20,
 11114           DFHEIV99,
 11115           ERMAIL-KEY,
 11116           DFHEIV99,
 11117           DFHEIV99,
 11118           DFHEIV99
 11119     SET ADDRESS OF MAILING-DATA TO
 11120         DFHEIV20
 11121     MOVE EIBRESP  TO WS-RESPONSE
 11122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11123     IF RESP-NORMAL
 11124        SET ERMAIL-FOUND TO TRUE
 11125     END-IF
 11126
 11127     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 204
* EL6311.cbl
 11128     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 11129     MOVE 'OC'                   TO OC-RECORD-ID
 11130     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11131                                 TO OC-CONTROL-PRIMARY (1:33)
 11132     MOVE 'I'                    TO OC-RECORD-TYPE
 11133     MOVE +4096                  TO OC-KEY-SEQ-NO
 11134     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 11135     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 11136     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 11137     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11138     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11139     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11140     MOVE PB-I-AGE               TO OC-INS-AGE
 11141     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 11142     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 11143     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11144     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 11145     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 11146     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 11147     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 11148     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 11149     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11150     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11151     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 11152     IF PB-I-JOINT-COMMISSION > +0
 11153         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 11154     ELSE
 11155         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 11156     END-IF
 11157     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 11158     MOVE +0                     TO OC-LF-CANCEL-AMT
 11159                                    OC-LF-ITD-CANCEL-AMT
 11160     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 11161     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 11162     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 11163     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 11164     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 11165     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 11166     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 11167     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 11168     MOVE +0                     TO OC-AH-CANCEL-AMT
 11169                                    OC-AH-ITD-CANCEL-AMT
 11170     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 11171     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 11172     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 11173     IF ERMAIL-FOUND
 11174        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 11175     END-IF
 11176     IF NOT CERT-TRL-REC-NOT-FOUND
 11177        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11178                           OC-INS-AGE-DEFAULT-FLAG
 11179        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11180                           OC-JNT-AGE-DEFAULT-FLAG
 11181     END-IF
 11182     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 11183     .
 11184 1275-WRITE-ELCRTO.
 11185
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 205
* EL6311.cbl
 11186* EXEC CICS WRITE
 11187*       DATASET   ('ELCRTO')
 11188*       FROM      (ORIGINAL-CERTIFICATE)
 11189*       RIDFLD    (OC-CONTROL-PRIMARY)
 11190*       RESP      (WS-RESPONSE)
 11191*    END-EXEC
 11192     MOVE LENGTH OF
 11193      ORIGINAL-CERTIFICATE
 11194       TO DFHEIV11
 11195     MOVE 'ELCRTO' TO DFHEIV1
 11196*    MOVE '&$ L                  ''  N#00010929' TO DFHEIV0
 11197     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11198     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11199     MOVE X'204E233030303130393239' TO DFHEIV0(25:11)
 11200     CALL 'kxdfhei1' USING DFHEIV0,
 11201           DFHEIV1,
 11202           ORIGINAL-CERTIFICATE,
 11203           DFHEIV11,
 11204           OC-CONTROL-PRIMARY,
 11205           DFHEIV99,
 11206           DFHEIV99
 11207     MOVE EIBRESP  TO WS-RESPONSE
 11208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11209*    display ' just wrote 1275 ' ws-response
 11210     IF RESP-DUPKEY
 11211        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 11212        GO TO 1275-WRITE-ELCRTO
 11213     ELSE
 11214        IF NOT RESP-NORMAL
 11215           MOVE -1               TO BMAINTL
 11216           MOVE ER-7450          TO EMI-ERROR
 11217           PERFORM 9900-ERROR-FORMAT
 11218                                 THRU 9900-EXIT
 11219           GO TO 8200-SEND-DATAONLY
 11220        END-IF
 11221     END-IF
 11222******************************************************************
 11223*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11224******************************************************************
 11225
 11226
 11227* EXEC CICS READ
 11228*        INTO    (PENDING-BUSINESS)
 11229*        DATASET (FILE-ID-ERPNDB)
 11230*        RIDFLD  (ERPNDB-KEY)
 11231*        UPDATE
 11232*    END-EXEC.
 11233     MOVE LENGTH OF
 11234      PENDING-BUSINESS
 11235       TO DFHEIV11
 11236*    MOVE '&"IL       EU         (   #00010952' TO DFHEIV0
 11237     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11238     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11239     MOVE X'2020233030303130393532' TO DFHEIV0(25:11)
 11240     CALL 'kxdfhei1' USING DFHEIV0,
 11241           FILE-ID-ERPNDB,
 11242           PENDING-BUSINESS,
 11243           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 206
* EL6311.cbl
 11244           ERPNDB-KEY,
 11245           DFHEIV99,
 11246           DFHEIV99,
 11247           DFHEIV99
 11248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11249
 11250
 11251     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11252     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11253     MOVE 'B'                    TO JP-RECORD-TYPE.
 11254     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11255
 11256     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 11257
 11258     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 11259
 11260
 11261* EXEC CICS REWRITE
 11262*        DATASET (FILE-ID-ERPNDB)
 11263*        FROM    (PENDING-BUSINESS)
 11264*    END-EXEC.
 11265     MOVE LENGTH OF
 11266      PENDING-BUSINESS
 11267       TO DFHEIV11
 11268*    MOVE '&& L                  %   #00010968' TO DFHEIV0
 11269     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11270     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11271     MOVE X'2020233030303130393638' TO DFHEIV0(25:11)
 11272     CALL 'kxdfhei1' USING DFHEIV0,
 11273           FILE-ID-ERPNDB,
 11274           PENDING-BUSINESS,
 11275           DFHEIV11,
 11276           DFHEIV99
 11277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11278
 11279
 11280     MOVE 'C'                    TO JP-RECORD-TYPE.
 11281     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11282
 11283     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 11284
 11285     IF WS-ERRORS-PRESENT
 11286         GO TO 3900-RE-DISPLAY-RECORD.
 11287
 11288     MOVE ZEROS                  TO EMI-ERROR.
 11289     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11290     MOVE LOW-VALUES             TO EL631BI.
 11291     MOVE  -1                    TO BMAINTL.
 11292     GO TO 8100-SEND-INITIAL-MAP.
 11293
 11294 1280-BATCH-HDR-NOT-FOUND.
 11295     MOVE -1                     TO BMAINTL.
 11296     MOVE ER-7450                TO EMI-ERROR.
 11297     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11298     GO TO 8200-SEND-DATAONLY.
 11299
 11300 1290-DUPLICATE-ALT-INDEX.
 11301
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 207
* EL6311.cbl
 11302******************************************************************
 11303*                                                                *
 11304*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11305*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11306*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11307*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11308*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11309*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11310*                                                                *
 11311******************************************************************
 11312
 11313     IF LCP-ONCTR-01 =  0
 11314         ADD 1 TO LCP-ONCTR-01
 11315        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11316
 11317     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11318
 11319     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11320         NEXT SENTENCE
 11321     ELSE
 11322         ADD +1 TO PB-BATCH-SEQ-NO
 11323                   PB-CSR-BATCH-SEQ-NO
 11324         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11325         GO TO 1275-WRITE-PENDING-BUSINESS.
 11326
 11327     MOVE -1                     TO BCERTNOL.
 11328     MOVE AL-UABON               TO BCERTNOA.
 11329     MOVE AL-UNBON               TO BEFFDTA.
 11330
 11331     MOVE 1                      TO EMI-SUB
 11332                                    EMI-SWITCH1
 11333                                    EMI-SWITCH-AREA-1
 11334                                    EMI-SWITCH-AREA-2.
 11335
 11336     MOVE SPACES                 TO EMI-ERROR-LINES.
 11337
 11338
 11339* EXEC CICS SYNCPOINT ROLLBACK
 11340*    END-EXEC.
 11341*    MOVE '6"R                   !   #00011031' TO DFHEIV0
 11342     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11343     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11344     MOVE X'2020233030303131303331' TO DFHEIV0(25:11)
 11345     CALL 'kxdfhei1' USING DFHEIV0
 11346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11347
 11348
 11349     MOVE ER-2247                TO EMI-ERROR.
 11350     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11351     GO TO 8200-SEND-DATAONLY.
 11352
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 208
* EL6311.cbl
 11354
 11355
 11356 1295-READ-CERT-TRAILER.
 11357
 11358
 11359* EXEC CICS GETMAIN
 11360*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11361*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11362*        INITIMG (GETMAIN-SPACE)
 11363*    END-EXEC
 11364*    MOVE ',"IL                  $   #00011043' TO DFHEIV0
 11365     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11366     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11367     MOVE X'2020233030303131303433' TO DFHEIV0(25:11)
 11368     CALL 'kxdfhei1' USING DFHEIV0,
 11369           DFHEIV20,
 11370           ELCRTT-RECORD-LENGTH,
 11371           GETMAIN-SPACE
 11372     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11373         DFHEIV20
 11374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11375
 11376     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11377     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11378     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11379
 11380
 11381* EXEC CICS HANDLE CONDITION
 11382*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11383*    END-EXEC.
 11384*    MOVE '"$I                   ! % #00011053' TO DFHEIV0
 11385     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11386     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11387     MOVE X'2520233030303131303533' TO DFHEIV0(25:11)
 11388     CALL 'kxdfhei1' USING DFHEIV0
 11389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11390
 11391
 11392
 11393* EXEC CICS READ
 11394*        DATASET  (CRTT-ID)
 11395*        RIDFLD   (ELCRTT-KEY)
 11396*        INTO     (CERTIFICATE-TRAILERS)
 11397*    END-EXEC.
 11398     MOVE LENGTH OF
 11399      CERTIFICATE-TRAILERS
 11400       TO DFHEIV11
 11401*    MOVE '&"IL       E          (   #00011057' TO DFHEIV0
 11402     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11403     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11404     MOVE X'2020233030303131303537' TO DFHEIV0(25:11)
 11405     CALL 'kxdfhei1' USING DFHEIV0,
 11406           CRTT-ID,
 11407           CERTIFICATE-TRAILERS,
 11408           DFHEIV11,
 11409           ELCRTT-KEY,
 11410           DFHEIV99,
 11411           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 209
* EL6311.cbl
 11412           DFHEIV99
 11413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11414
 11415
 11416     GO TO 1295-EXIT.
 11417
 11418 1295-CERT-TRL-REC-NOTFND.
 11419     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11420
 11421 1295-EXIT.
 11422     EXIT.
 11423
 11424******************************************************************
 11425*                                                                *
 11426*          C H A N G E   I S S U E   R O U T I N E               *
 11427*                                                                *
 11428******************************************************************
 11429
 11430***************************************************************
 11431*                                                             *
 11432*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11433*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11434*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11435*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11436*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11437*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11438*     5. LINK TO THE EDIT ROUTINE.                            *
 11439*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11440*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11441*              THE EDIT ROUTINE.                              *
 11442*     7. REWRITE THE NEW ISSUE                                *
 11443*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11444*                                                             *
 11445***************************************************************
 11446
 11447 1300-CHANGE-ISSUE-ROUTINE.
 11448     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11449
 11450     IF BCHGL NOT = ZEROS
 11451        MOVE ER-2196             TO EMI-ERROR
 11452        MOVE AL-UABON            TO BMAINTA
 11453        MOVE -1                  TO BMAINTL
 11454        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11455        GO TO 8200-SEND-DATAONLY.
 11456
 11457     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11458
 11459     IF BSUFIXL NOT = ZEROS
 11460        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11461     ELSE
 11462        MOVE SPACE               TO WS-NEW-SUFFIX.
 11463
 11464     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11465     PERFORM 8600-DEEDIT.
 11466     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11467     MOVE '4'                    TO DC-OPTION-CODE.
 11468     PERFORM 9700-DATE-LINK.
 11469     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 210
* EL6311.cbl
 11470        MOVE ER-0348             TO EMI-ERROR
 11471        MOVE -1                  TO BEFFDTL
 11472        MOVE AL-UABON            TO BEFFDTA
 11473        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11474        GO TO 8200-SEND-DATAONLY
 11475     ELSE
 11476        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11477        MOVE AL-UANON            TO BEFFDTA
 11478        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11479
 11480 1325-PROCESS-ISSUE-CHANGES.
 11481
 11482* EXEC CICS HANDLE CONDITION
 11483*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11484*    END-EXEC.
 11485*    MOVE '"$I                   ! & #00011128' TO DFHEIV0
 11486     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11487     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11488     MOVE X'2620233030303131313238' TO DFHEIV0(25:11)
 11489     CALL 'kxdfhei1' USING DFHEIV0
 11490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11491
 11492
 11493     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11494     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11495     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11496
 11497
 11498* EXEC CICS GETMAIN
 11499*        SET      (ADDRESS OF PENDING-BUSINESS)
 11500*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11501*        INITIMG  (GETMAIN-SPACE)
 11502*     END-EXEC.
 11503*    MOVE ',"IL                  $   #00011136' TO DFHEIV0
 11504     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11505     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11506     MOVE X'2020233030303131313336' TO DFHEIV0(25:11)
 11507     CALL 'kxdfhei1' USING DFHEIV0,
 11508           DFHEIV20,
 11509           ERPNDB-RECORD-LENGTH,
 11510           GETMAIN-SPACE
 11511     SET ADDRESS OF PENDING-BUSINESS TO
 11512         DFHEIV20
 11513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11514
 11515
 11516
 11517* EXEC CICS READ
 11518*        INTO    (PENDING-BUSINESS)
 11519*        DATASET (FILE-ID-ERPNDB)
 11520*        RIDFLD  (ERPNDB-KEY)
 11521*    END-EXEC.
 11522     MOVE LENGTH OF
 11523      PENDING-BUSINESS
 11524       TO DFHEIV11
 11525*    MOVE '&"IL       E          (   #00011142' TO DFHEIV0
 11526     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11527     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 211
* EL6311.cbl
 11528     MOVE X'2020233030303131313432' TO DFHEIV0(25:11)
 11529     CALL 'kxdfhei1' USING DFHEIV0,
 11530           FILE-ID-ERPNDB,
 11531           PENDING-BUSINESS,
 11532           DFHEIV11,
 11533           ERPNDB-KEY,
 11534           DFHEIV99,
 11535           DFHEIV99,
 11536           DFHEIV99
 11537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11538
 11539
 11540     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11541
 11542
 11543* EXEC CICS HANDLE CONDITION
 11544*         NOTFND     (1385-REC-NOT-FOUND)
 11545*    END-EXEC.
 11546*    MOVE '"$I                   ! '' #00011150' TO DFHEIV0
 11547     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11548     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11549     MOVE X'2720233030303131313530' TO DFHEIV0(25:11)
 11550     CALL 'kxdfhei1' USING DFHEIV0
 11551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11552
 11553
 11554**********************************************************
 11555*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11556*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11557**********************************************************
 11558
 11559
 11560* EXEC CICS READ
 11561*        DATASET (FILE-ID-ERPNDB)
 11562*        INTO    (PENDING-BUSINESS)
 11563*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11564*    END-EXEC.
 11565     MOVE LENGTH OF
 11566      PENDING-BUSINESS
 11567       TO DFHEIV11
 11568*    MOVE '&"IL       E          (   #00011159' TO DFHEIV0
 11569     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11570     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11571     MOVE X'2020233030303131313539' TO DFHEIV0(25:11)
 11572     CALL 'kxdfhei1' USING DFHEIV0,
 11573           FILE-ID-ERPNDB,
 11574           PENDING-BUSINESS,
 11575           DFHEIV11,
 11576           PI-PREV-CONTROL-PRIMARY,
 11577           DFHEIV99,
 11578           DFHEIV99,
 11579           DFHEIV99
 11580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11581
 11582
 11583********** DO NOT ALLOW CHANGES IF THRU A/R
 11584     IF BMAINTI = 'C'
 11585         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 212
* EL6311.cbl
 11586             MOVE ER-4005          TO EMI-ERROR
 11587             MOVE -1               TO BMAINTL
 11588             MOVE AL-UABON         TO BMAINTA
 11589             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11590             GO TO 8200-SEND-DATAONLY.
 11591**********
 11592     MOVE PB-ISSUE-RECORD TO WS-SAVE-PEND-ISSUE
 11593
 11594     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11595        MOVE -1                 TO BMAINTL
 11596        MOVE ER-2197            TO EMI-ERROR
 11597        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11598        GO TO 8200-SEND-DATAONLY.
 11599
 11600     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11601        MOVE ER-2196             TO EMI-ERROR
 11602        MOVE AL-UABON            TO BMAINTA
 11603        MOVE -1                  TO BMAINTL
 11604        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11605        GO TO 8200-SEND-DATAONLY.
 11606
 11607     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11608
 11609     IF PB-BILLED-DT = LOW-VALUES AND
 11610        PB-CHG-COUNT = ZEROS
 11611        NEXT SENTENCE
 11612     ELSE
 11613        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11614            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11615           OR
 11616           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11617            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11618           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11619     move zeros                  to ws-check-amts
 11620     move ' '                    to ws-stop-sw
 11621                                    ws-check-sw
 11622                                    ws-proc-check-sw
 11623                                    ws-any-check-sw
 11624                                    ws-chek-browse-sw
 11625
 11626     perform 2500-browse-checks  thru 2500-exit
 11627
 11628     if i-have-processed-checks
 11629        or i-have-checks
 11630        continue
 11631     else
 11632        go to 1330-continue
 11633     end-if
 11634
 11635     compute ws-tot-orig-prem =
 11636        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11637        pb-i-lf-alt-premium-amt
 11638
 11639     if bprem1l <> zeros
 11640        MOVE AL-UNNON            TO bprem1a
 11641        move ws-bprem (1)        to ws-new-iss-total
 11642     else
 11643        move pb-i-lf-premium-amt to ws-new-iss-total
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 213
* EL6311.cbl
 11644     end-if
 11645     display ' new iss totala ' ws-new-iss-total
 11646
 11647     if baltpr1l <> zeros
 11648        MOVE AL-UNNON            TO baltpr1a
 11649        compute ws-new-iss-total =
 11650           ws-new-iss-total + ws-balt-prem(1)
 11651     else
 11652        compute ws-new-iss-total =
 11653           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11654     end-if
 11655
 11656     if bprem2l <> zeros
 11657        MOVE AL-UNNON            TO bprem2a
 11658        compute ws-new-iss-total = ws-new-iss-total +
 11659           ws-bprem (2)
 11660     else
 11661        compute ws-new-iss-total = ws-new-iss-total +
 11662           pb-i-ah-premium-amt
 11663     end-if
 11664
 11665     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11666        if ((bprem1l <> zeros)
 11667           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11668                      or
 11669           ((bprem2l <> zeros)
 11670           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11671           move er-3456          to emi-error
 11672           perform 9900-error-format
 11673                                 thru 9900-exit
 11674           go to 1330-continue
 11675        end-if
 11676     end-if
 11677
 11678     if ws-new-iss-total > ws-tot-orig-prem
 11679        move er-3458             to emi-error
 11680        perform 9900-error-format thru 9900-exit
 11681        move al-uabon            to bmainta
 11682        move -1                  to bmaintl
 11683        go to 8200-send-dataonly
 11684     end-if
 11685
 11686     if ws-new-iss-total < ws-tot-orig-prem
 11687        move er-3457             to emi-error
 11688        move al-uabon            to bprem1a
 11689                                    bprem2a
 11690        move +0 to bprem1l bprem2l
 11691        perform 9900-error-format thru 9900-exit
 11692        move -1                  to bmaintl
 11693        go to 1330-continue
 11694     end-if
 11695
 11696     .
 11697 1330-continue.
 11698
 11699
 11700* EXEC CICS READ
 11701*        DATASET (FILE-ID-ERPNDB)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 214
* EL6311.cbl
 11702*        INTO    (PENDING-BUSINESS)
 11703*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11704*        UPDATE
 11705*    END-EXEC.
 11706     MOVE LENGTH OF
 11707      PENDING-BUSINESS
 11708       TO DFHEIV11
 11709*    MOVE '&"IL       EU         (   #00011281' TO DFHEIV0
 11710     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11711     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11712     MOVE X'2020233030303131323831' TO DFHEIV0(25:11)
 11713     CALL 'kxdfhei1' USING DFHEIV0,
 11714           FILE-ID-ERPNDB,
 11715           PENDING-BUSINESS,
 11716           DFHEIV11,
 11717           PI-PREV-CONTROL-PRIMARY,
 11718           DFHEIV99,
 11719           DFHEIV99,
 11720           DFHEIV99
 11721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11722
 11723
 11724     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11725     MOVE 'B'                    TO JP-RECORD-TYPE
 11726     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11727     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11728
 11729*    PERFORM 8400-LOG-JOURNAL-RECORD. *> move closer to rewite
 11730
 11731     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11732        PB-CHG-COUNT NOT = ZEROS
 11733        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11734            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11735           OR
 11736           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11737            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11738            MOVE LOW-VALUES             TO PB-BILLED-DT
 11739            ADD +1                      TO PB-CHG-COUNT.
 11740
 11741     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11742     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11743     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11744     MOVE '5'                    TO DC-OPTION-CODE.
 11745     PERFORM 9700-DATE-LINK
 11746     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11747
 11748*    IF BMICRNOL  GREATER  ZEROS
 11749*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11750
 11751     IF BVINL > ZEROS
 11752        MOVE BVINI               TO PB-I-VIN
 11753     END-IF
 11754     IF (BFORCEL NOT = ZEROS)
 11755        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11756        AND (BFORCEI = ' ')
 11757        AND (PB-FORCE-CODE = 'O')
 11758        COMPUTE PB-I-AH-PREMIUM-AMT =
 11759           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 215
* EL6311.cbl
 11760        PERFORM 1800-REMOVE-CERT-NOTES
 11761                                 THRU 1800-EXIT
 11762        PERFORM 1900-DELETE-ERPYAJ
 11763                                 THRU 1900-EXIT
 11764        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11765     END-IF
 11766     IF (BFORCEL NOT = ZEROS)
 11767        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11768        AND (BFORCEI = 'O')
 11769        AND (PB-FORCE-CODE NOT = 'O')
 11770        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11771           PB-I-AH-PREM-CALC
 11772        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11773        MOVE SPACE               TO DC-OPTION-CODE
 11774        PERFORM 9700-DATE-LINK
 11775        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11776        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11777        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11778        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11779        PERFORM 1500-UPDATE-ERNOTE
 11780                                 THRU 1500-EXIT
 11781        PERFORM 1600-UPDATE-ERPYAJ
 11782                                 THRU 1600-EXIT
 11783     END-IF
 11784     IF BLSTNML  GREATER THAN ZEROS
 11785         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11786
 11787     IF B1STNML  GREATER THAN ZEROS
 11788         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11789
 11790     IF BINITL   GREATER THAN ZEROS
 11791         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11792
 11793     IF BBIRTHL  GREATER THAN ZERO
 11794         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11795
 11796     IF B1STPMTL GREATER THAN ZERO
 11797         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11798
 11799     IF BAGEL    GREATER THAN ZEROS
 11800         MOVE BAGEI              TO PB-I-AGE.
 11801
 11802     MOVE 'N'                    TO WS-INS-AGE-SET
 11803                                    WS-JNT-AGE-SET.
 11804     IF BAGEL    GREATER THAN ZEROS
 11805        MOVE 'Y'                TO WS-INS-AGE-SET
 11806        IF BAGEI = ZERO AND
 11807             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11808           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11809           MOVE 'AGE*'          TO BAGEDEFO
 11810        ELSE
 11811           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11812           MOVE 'AGE '          TO BAGEDEFO
 11813        END-IF
 11814        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11815     END-IF.
 11816
 11817     IF BSEXL    GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 216
* EL6311.cbl
 11818         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11819
 11820     IF LETRREQL   GREATER THAN ZEROS
 11821        MOVE LETRREQI TO PB-I-LETTER-REQD
 11822     END-IF.
 11823
 11824     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11825        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11826
 11827     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11828        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11829
 11830     IF BLNTRML  GREATER THAN ZEROS
 11831         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11832
 11833     IF BFREQL   GREATER THAN ZEROS
 11834         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11835
 11836     IF BSKPCDL  GREATER THAN ZEROS
 11837         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11838
 11839     IF BMODEL   GREATER THAN ZEROS
 11840         MOVE BMODEI             TO PB-I-TERM-TYPE
 11841                                    PI-BMODE.
 11842
 11843     IF BPMTSL   GREATER THAN ZEROS
 11844         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11845                                    PI-BPMTS.
 11846
 11847     IF BPMTAMTL GREATER THAN ZEROS
 11848         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11849
 11850     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11851         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11852
 11853     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11854         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11855
 11856     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11857
 11858     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11859         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11860            SUBTRACT PB-I-LF-PREMIUM-AMT
 11861                     FROM WS-B-LF-ISS-PRM-ENTERED
 11862            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11863            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11864            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11865         ELSE
 11866            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11867*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11868*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11869         END-IF
 11870     END-IF.
 11871
 11872     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11873            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11874                     FROM WS-B-LF-ISS-PRM-ENTERED
 11875         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 217
* EL6311.cbl
 11876         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11877
 11878     IF  BALT-PREM-LEN     (2)  > ZEROS
 11879         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11880
 11881     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11882         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11883
 11884     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11885         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11886            SUBTRACT PB-I-AH-PREMIUM-AMT
 11887                     FROM WS-B-AH-ISS-PRM-ENTERED
 11888            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11889            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11890            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11891         ELSE
 11892            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11893*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11894*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11895         END-IF
 11896     END-IF
 11897
 11898     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11899        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11900
 11901     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11902        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11903
 11904     IF BINDGRPL            GREATER THAN ZEROS
 11905         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11906
 11907     IF BRTCLSL             GREATER THAN ZEROS
 11908         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11909
 11910     IF BSIGL               GREATER THAN ZEROS
 11911         MOVE BSIGI              TO PB-I-SIG-SW.
 11912
 11913     IF BAPRL               GREATER THAN ZEROS
 11914         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11915
 11916     IF BMEMBERL            GREATER THAN ZEROS
 11917         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11918
 11919     IF BLNOFCRL            GREATER THAN ZEROS
 11920         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11921
 11922     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11923        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11924
 11925     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11926        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11927
 11928     IF BDAYSL              GREATER THAN ZEROS
 11929        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11930                                    PB-I-EXTENTION-DAYS.
 11931
 11932     IF BDAYSL GREATER THAN ZEROS
 11933        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 218
* EL6311.cbl
 11934
 11935     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11936        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11937           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11938
 11939     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11940        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11941           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11942
 11943     IF B1STPMTL GREATER THAN ZEROS
 11944        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11945
 11946     IF PB-EXT-DAYS-PROCESSING
 11947        IF PB-I-EXTENTION-DAYS = ZEROS
 11948           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11949
 11950     IF PB-EXPIRE-DT-PROCESSING
 11951        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11952           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11953             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11954
 11955     IF PB-1ST-PMT-DT-PROCESSING
 11956        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11957           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11958
 11959     IF BREINL GREATER THAN ZEROS
 11960        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11961
 11962     IF BFORCEL NOT = ZEROS
 11963        MOVE BFORCEI             TO PB-FORCE-CODE.
 11964     IF (BENTRYL NOT = ZEROS)
 11965        AND (PB-COMPANY-ID = 'CID')
 11966        AND (PB-STATE = 'VA')
 11967        AND (BENTRYI NOT = 'P')
 11968        AND (PB-BATCH-ENTRY = 'P')
 11969        PERFORM 1800-REMOVE-CERT-NOTES
 11970                                 THRU 1800-EXIT
 11971     END-IF
 11972     IF BENTRYL NOT = ZEROS
 11973        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11974        IF PI-COMPANY-ID = 'CID'
 11975           AND (PB-BATCH-ENTRY = 'P')
 11976           AND (PB-STATE = 'VA')
 11977           PERFORM 1500-UPDATE-ERNOTE
 11978                                 THRU 1500-EXIT
 11979        END-IF
 11980     END-IF
 11981
 11982     IF BUNWRITL NOT = ZEROS
 11983        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11984
 11985     IF BBILCDL NOT = ZEROS
 11986        MOVE BBILCDI             TO PB-RECORD-BILL.
 11987
 11988     IF BLIVESL GREATER THAN ZEROS
 11989        MOVE WS-BLIVES           TO PB-I-LIVES.
 11990
 11991
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 219
* EL6311.cbl
 11992*DMD CUSTOM CODING*************START
 11993     IF PI-COMPANY-ID NOT = 'DMD'
 11994         MOVE ZEROS               TO BBILLEDL.
 11995*DMD CUSTOM CODING*************END
 11996
 11997     IF BBILLEDL GREATER THAN ZEROS
 11998        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11999
 12000
 12001*****************************************************************
 12002*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 12003*****************************************************************
 12004
 12005     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 12006        IF BTYPE  (1)   = ZEROS OR SPACES
 12007           IF REMOVE-LF-COVERAGE
 12008               MOVE SPACES           TO PB-I-LF-INPUT-CD
 12009                                        PI-BTYPE (1)
 12010               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 12011                                        WS-B-LF-ISS-PRM-ENTERED
 12012               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 12013                                        WS-B-LF-ISS-PRM-ENTERED
 12014               SUBTRACT PB-I-LF-PREM-CALC FROM
 12015                                        WS-B-LF-ISS-PRM-COMPUTED
 12016               MOVE ZEROS            TO PB-I-LF-TERM
 12017                                        PB-I-LF-BENEFIT-AMT
 12018                                        PB-I-LF-PREMIUM-AMT
 12019                                        PB-I-LF-BENEFIT-CD
 12020                                        PB-I-LF-PREM-CALC
 12021                                        PB-I-LF-CRIT-PER
 12022                                        PB-I-LF-ALT-BENEFIT-AMT
 12023                                        PB-I-LF-ALT-PREMIUM-AMT
 12024               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 12025           ELSE
 12026               NEXT SENTENCE
 12027        ELSE
 12028           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 12029                                    PI-BTYPE (1).
 12030     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 12031        IF BTYPE  (2)   = ZEROS OR SPACES
 12032           IF  REMOVE-AH-COVERAGE
 12033               MOVE SPACES           TO PB-I-AH-INPUT-CD
 12034                                        PI-BTYPE (2)
 12035               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 12036                                        WS-B-AH-ISS-PRM-ENTERED
 12037               SUBTRACT PB-I-AH-PREM-CALC FROM
 12038                                        WS-B-AH-ISS-PRM-COMPUTED
 12039               MOVE ZEROS            TO PB-I-AH-TERM
 12040                                        PB-I-AH-BENEFIT-AMT
 12041                                        PB-I-AH-PREMIUM-AMT
 12042                                        PB-I-AH-BENEFIT-CD
 12043                                        PB-I-AH-PREM-CALC
 12044                                        PB-I-AH-CRIT-PER
 12045               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 12046           ELSE
 12047               NEXT SENTENCE
 12048        ELSE
 12049           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 220
* EL6311.cbl
 12050                                    PI-BTYPE (2).
 12051 1360-REWRITE-PB-RECORD.
 12052     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 12053
 12054     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 12055     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 12056
 12057     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 12058
 12059     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 12060     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 12061
 12062     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 12063         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 12064
 12065     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 12066         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 12067
 12068     IF CSR-EDIT-SESSION
 12069        PERFORM 139A-SET-LETTER-REQD THRU 139A-EXIT
 12070     END-IF.
 12071
 12072     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 12073
 12074     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 12075
 12076     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 12077
 12078     IF ARCHIVE-LETTER-RELEASED
 12079        MOVE 'C' TO PB-I-LETTER-REQD
 12080        PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT
 12081        PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT
 12082     END-IF
 12083
 12084     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 12085     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 12086     MOVE PB-SV-STATE            TO PI-SV-STATE.
 12087
 12088     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 12089     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 12090
 12091 1375-REWRITE-PB-RECORD.
 12092     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before Issue image
 12093     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12094     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 12095     MOVE 'C'                    TO JP-RECORD-TYPE.
 12096     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12097
 12098
 12099* EXEC CICS REWRITE
 12100*        DATASET (FILE-ID-ERPNDB)
 12101*        FROM    (PENDING-BUSINESS)
 12102*    END-EXEC.
 12103     MOVE LENGTH OF
 12104      PENDING-BUSINESS
 12105       TO DFHEIV11
 12106*    MOVE '&& L                  %   #00011662' TO DFHEIV0
 12107     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 221
* EL6311.cbl
 12108     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12109     MOVE X'2020233030303131363632' TO DFHEIV0(25:11)
 12110     CALL 'kxdfhei1' USING DFHEIV0,
 12111           FILE-ID-ERPNDB,
 12112           PENDING-BUSINESS,
 12113           DFHEIV11,
 12114           DFHEIV99
 12115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12116
 12117
 12118     PERFORM 8400-LOG-JOURNAL-RECORD  *> After Issue Image
 12119******************************************************************
 12120*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 12121******************************************************************
 12122     MOVE ELCERT-KEY             TO ERMAIL-KEY
 12123     MOVE ' '                    TO WS-ERMAIL-SW
 12124
 12125* EXEC CICS READ
 12126*       DATASET   (FILE-ID-ERMAIL)
 12127*       SET       (ADDRESS OF MAILING-DATA)
 12128*       RIDFLD    (ERMAIL-KEY)
 12129*       RESP      (WS-RESPONSE)
 12130*    END-EXEC
 12131*    MOVE '&"S        E          (  N#00011673' TO DFHEIV0
 12132     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12133     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12134     MOVE X'204E233030303131363733' TO DFHEIV0(25:11)
 12135     CALL 'kxdfhei1' USING DFHEIV0,
 12136           FILE-ID-ERMAIL,
 12137           DFHEIV20,
 12138           DFHEIV99,
 12139           ERMAIL-KEY,
 12140           DFHEIV99,
 12141           DFHEIV99,
 12142           DFHEIV99
 12143     SET ADDRESS OF MAILING-DATA TO
 12144         DFHEIV20
 12145     MOVE EIBRESP  TO WS-RESPONSE
 12146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12147     IF RESP-NORMAL
 12148        SET ERMAIL-FOUND TO TRUE
 12149     END-IF
 12150
 12151     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 12152     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12153                                 TO ELCRTO-KEY
 12154     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12155     MOVE +0                     TO ELCRTO-SEQ-NO
 12156
 12157* EXEC CICS READ
 12158*       DATASET   ('ELCRTO')
 12159*       INTO      (ORIGINAL-CERTIFICATE)
 12160*       RIDFLD    (ELCRTO-KEY)
 12161*       GTEQ
 12162*       RESP      (WS-RESPONSE)
 12163*    END-EXEC
 12164     MOVE LENGTH OF
 12165      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 222
* EL6311.cbl
 12166       TO DFHEIV11
 12167     MOVE 'ELCRTO' TO DFHEIV1
 12168*    MOVE '&"IL       G          (  N#00011688' TO DFHEIV0
 12169     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12170     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12171     MOVE X'204E233030303131363838' TO DFHEIV0(25:11)
 12172     CALL 'kxdfhei1' USING DFHEIV0,
 12173           DFHEIV1,
 12174           ORIGINAL-CERTIFICATE,
 12175           DFHEIV11,
 12176           ELCRTO-KEY,
 12177           DFHEIV99,
 12178           DFHEIV99,
 12179           DFHEIV99
 12180     MOVE EIBRESP  TO WS-RESPONSE
 12181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12182*    display ' just read gteq ' ws-response
 12183     IF RESP-NORMAL
 12184        AND (OC-CONTROL-PRIMARY (1:33) =
 12185                 PB-CONTROL-BY-ACCOUNT (1:33))
 12186        AND (OC-RECORD-TYPE = 'I')
 12187        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 12188           display ' csr edit session ' PI-CSR-SESSION-SW
 12189           IF NOT CSR-EDIT-SESSION
 12190
 12191* EXEC CICS READ
 12192*                DATASET   ('ELCRTO')
 12193*                INTO      (ORIGINAL-CERTIFICATE)
 12194*                RIDFLD    (OC-CONTROL-PRIMARY)
 12195*                UPDATE
 12196*                RESP      (WS-RESPONSE)
 12197*             END-EXEC
 12198     MOVE LENGTH OF
 12199      ORIGINAL-CERTIFICATE
 12200       TO DFHEIV11
 12201     MOVE 'ELCRTO' TO DFHEIV1
 12202*    MOVE '&"IL       EU         (  N#00011705' TO DFHEIV0
 12203     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12204     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12205     MOVE X'204E233030303131373035' TO DFHEIV0(25:11)
 12206     CALL 'kxdfhei1' USING DFHEIV0,
 12207           DFHEIV1,
 12208           ORIGINAL-CERTIFICATE,
 12209           DFHEIV11,
 12210           OC-CONTROL-PRIMARY,
 12211           DFHEIV99,
 12212           DFHEIV99,
 12213           DFHEIV99
 12214     MOVE EIBRESP  TO WS-RESPONSE
 12215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12216              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 12217              IF RESP-NORMAL
 12218                 display ' good read upd '
 12219                 MOVE PB-I-INSURED-LAST-NAME TO
 12220                         OC-INS-LAST-NAME
 12221                 MOVE PB-I-INSURED-FIRST-NAME TO
 12222                         OC-INS-FIRST-NAME
 12223                 MOVE PB-I-INSURED-MIDDLE-INIT TO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 223
* EL6311.cbl
 12224                         OC-INS-MIDDLE-INIT
 12225                 MOVE PB-I-AGE         TO OC-INS-AGE
 12226                 MOVE PB-I-JOINT-LAST-NAME   TO
 12227                         OC-JNT-LAST-NAME
 12228                 MOVE PB-I-JOINT-FIRST-NAME  TO
 12229                         OC-JNT-FIRST-NAME
 12230                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 12231                         OC-JNT-MIDDLE-INIT
 12232                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12233                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12234                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12235                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12236                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12237                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 12238                         OC-LF-ALT-BEN-AMT
 12239                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 12240                         OC-LF-ALT-PRM-AMT
 12241                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12242                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12243                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12244                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12245                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12246                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12247                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12248                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12249                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12250                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12251                 IF OC-CANCEL-TRAN-IND = 'N'
 12252                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 12253                    MOVE +0            TO OC-LF-CANCEL-AMT
 12254                                          OC-LF-ITD-CANCEL-AMT
 12255                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 12256                    MOVE +0            TO OC-AH-CANCEL-AMT
 12257                                          OC-AH-ITD-CANCEL-AMT
 12258                 END-IF
 12259                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12260                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12261                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12262                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12263                 IF ERMAIL-FOUND
 12264                    MOVE MA-CRED-BENE-NAME
 12265                                 TO OC-CRED-BENE-NAME
 12266                 END-IF
 12267                 IF NOT CERT-TRL-REC-NOT-FOUND
 12268                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12269                           OC-INS-AGE-DEFAULT-FLAG
 12270                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12271                           OC-JNT-AGE-DEFAULT-FLAG
 12272                 END-IF
 12273
 12274* EXEC CICS REWRITE
 12275*                   DATASET   ('ELCRTO')
 12276*                   FROM      (ORIGINAL-CERTIFICATE)
 12277*                   RESP      (WS-RESPONSE)
 12278*                END-EXEC
 12279     MOVE LENGTH OF
 12280      ORIGINAL-CERTIFICATE
 12281       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 224
* EL6311.cbl
 12282     MOVE 'ELCRTO' TO DFHEIV1
 12283*    MOVE '&& L                  %  N#00011769' TO DFHEIV0
 12284     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12285     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12286     MOVE X'204E233030303131373639' TO DFHEIV0(25:11)
 12287     CALL 'kxdfhei1' USING DFHEIV0,
 12288           DFHEIV1,
 12289           ORIGINAL-CERTIFICATE,
 12290           DFHEIV11,
 12291           DFHEIV99
 12292     MOVE EIBRESP  TO WS-RESPONSE
 12293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12294                 display ' just rewrote ' ws-response
 12295              END-IF
 12296           END-IF
 12297        ELSE
 12298           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12299           MOVE 'OC'             TO OC-RECORD-ID
 12300           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12301           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12302           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12303           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12304           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12305           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12306           MOVE PB-I-AGE         TO OC-INS-AGE
 12307           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12308           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12309           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12310           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12311           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12312           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12313           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12314           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12315           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12316           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12317           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12318           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12319           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12320           MOVE +0               TO OC-LF-CANCEL-AMT
 12321                                    OC-LF-ITD-CANCEL-AMT
 12322           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12323           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12324           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12325           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12326           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12327           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12328           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12329           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12330           MOVE +0               TO OC-AH-CANCEL-AMT
 12331                                    OC-AH-ITD-CANCEL-AMT
 12332           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12333           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12334           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12335           IF ERMAIL-FOUND
 12336              MOVE MA-CRED-BENE-NAME
 12337                                 TO OC-CRED-BENE-NAME
 12338           END-IF
 12339           IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 225
* EL6311.cbl
 12340              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12341                           OC-INS-AGE-DEFAULT-FLAG
 12342              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12343                           OC-JNT-AGE-DEFAULT-FLAG
 12344           END-IF
 12345           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12346
 12347* EXEC CICS WRITE
 12348*             DATASET   ('ELCRTO')
 12349*             FROM      (ORIGINAL-CERTIFICATE)
 12350*             RIDFLD    (OC-CONTROL-PRIMARY)
 12351*             RESP      (WS-RESPONSE)
 12352*          END-EXEC
 12353     MOVE LENGTH OF
 12354      ORIGINAL-CERTIFICATE
 12355       TO DFHEIV11
 12356     MOVE 'ELCRTO' TO DFHEIV1
 12357*    MOVE '&$ L                  ''  N#00011826' TO DFHEIV0
 12358     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12359     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12360     MOVE X'204E233030303131383236' TO DFHEIV0(25:11)
 12361     CALL 'kxdfhei1' USING DFHEIV0,
 12362           DFHEIV1,
 12363           ORIGINAL-CERTIFICATE,
 12364           DFHEIV11,
 12365           OC-CONTROL-PRIMARY,
 12366           DFHEIV99,
 12367           DFHEIV99
 12368     MOVE EIBRESP  TO WS-RESPONSE
 12369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12370        END-IF
 12371     ELSE
 12372        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12373        MOVE 'OC'                TO OC-RECORD-ID
 12374        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12375                                 TO OC-CONTROL-PRIMARY (1:33)
 12376        MOVE 'I'                 TO OC-RECORD-TYPE
 12377        MOVE +4096               TO OC-KEY-SEQ-NO
 12378        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12379        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12380        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12381        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12382        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12383        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12384        MOVE PB-I-AGE            TO OC-INS-AGE
 12385        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12386        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12387        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12388        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12389        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12390        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12391        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12392        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12393        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12394        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12395        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12396        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12397        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 226
* EL6311.cbl
 12398        MOVE +0                  TO OC-LF-CANCEL-AMT
 12399                                    OC-LF-ITD-CANCEL-AMT
 12400        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12401        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12402        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12403        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12404        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12405        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12406        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12407        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12408        MOVE +0                  TO OC-AH-CANCEL-AMT
 12409                                    OC-AH-ITD-CANCEL-AMT
 12410        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12411        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12412        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12413        IF ERMAIL-FOUND
 12414           MOVE MA-CRED-BENE-NAME
 12415                                 TO OC-CRED-BENE-NAME
 12416        END-IF
 12417        IF NOT CERT-TRL-REC-NOT-FOUND
 12418           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12419                           OC-INS-AGE-DEFAULT-FLAG
 12420           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12421                           OC-JNT-AGE-DEFAULT-FLAG
 12422        END-IF
 12423        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12424
 12425* EXEC CICS WRITE
 12426*          DATASET   ('ELCRTO')
 12427*          FROM      (ORIGINAL-CERTIFICATE)
 12428*          RIDFLD    (OC-CONTROL-PRIMARY)
 12429*          RESP      (WS-RESPONSE)
 12430*       END-EXEC
 12431     MOVE LENGTH OF
 12432      ORIGINAL-CERTIFICATE
 12433       TO DFHEIV11
 12434     MOVE 'ELCRTO' TO DFHEIV1
 12435*    MOVE '&$ L                  ''  N#00011886' TO DFHEIV0
 12436     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12437     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12438     MOVE X'204E233030303131383836' TO DFHEIV0(25:11)
 12439     CALL 'kxdfhei1' USING DFHEIV0,
 12440           DFHEIV1,
 12441           ORIGINAL-CERTIFICATE,
 12442           DFHEIV11,
 12443           OC-CONTROL-PRIMARY,
 12444           DFHEIV99,
 12445           DFHEIV99
 12446     MOVE EIBRESP  TO WS-RESPONSE
 12447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12448     END-IF
 12449******************************************************************
 12450*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12451******************************************************************
 12452
 12453     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12454     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12455
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 227
* EL6311.cbl
 12456
 12457* EXEC CICS READ
 12458*        INTO    (PENDING-BUSINESS)
 12459*        DATASET (FILE-ID-ERPNDB)
 12460*        RIDFLD  (ERPNDB-KEY)
 12461*        UPDATE
 12462*    END-EXEC.
 12463     MOVE LENGTH OF
 12464      PENDING-BUSINESS
 12465       TO DFHEIV11
 12466*    MOVE '&"IL       EU         (   #00011900' TO DFHEIV0
 12467     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12468     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12469     MOVE X'2020233030303131393030' TO DFHEIV0(25:11)
 12470     CALL 'kxdfhei1' USING DFHEIV0,
 12471           FILE-ID-ERPNDB,
 12472           PENDING-BUSINESS,
 12473           DFHEIV11,
 12474           ERPNDB-KEY,
 12475           DFHEIV99,
 12476           DFHEIV99,
 12477           DFHEIV99
 12478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12479
 12480
 12481     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12482     MOVE 'B'                    TO JP-RECORD-TYPE.
 12483     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12484
 12485     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12486
 12487     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 12488
 12489     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12490
 12491     MOVE 'C'                    TO JP-RECORD-TYPE.
 12492     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12493
 12494
 12495* EXEC CICS REWRITE
 12496*        DATASET    (FILE-ID-ERPNDB)
 12497*        FROM       (PENDING-BUSINESS)
 12498*    END-EXEC.
 12499     MOVE LENGTH OF
 12500      PENDING-BUSINESS
 12501       TO DFHEIV11
 12502*    MOVE '&& L                  %   #00011920' TO DFHEIV0
 12503     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12504     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12505     MOVE X'2020233030303131393230' TO DFHEIV0(25:11)
 12506     CALL 'kxdfhei1' USING DFHEIV0,
 12507           FILE-ID-ERPNDB,
 12508           PENDING-BUSINESS,
 12509           DFHEIV11,
 12510           DFHEIV99
 12511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12512
 12513
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 228
* EL6311.cbl
 12514     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 12515
 12516     IF WS-ERRORS-PRESENT
 12517        GO TO 3900-RE-DISPLAY-RECORD.
 12518
 12519     MOVE ZEROS                  TO EMI-ERROR.
 12520     MOVE -1                     TO BMAINTL.
 12521     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12522     GO TO 3900-RE-DISPLAY-RECORD.
 12523
 12524 1380-BATCH-HDR-NOT-FOUND.
 12525     MOVE -1                     TO BMAINTL.
 12526     MOVE ER-7450                TO EMI-ERROR.
 12527     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12528     GO TO 8200-SEND-DATAONLY.
 12529
 12530 1385-REC-NOT-FOUND.
 12531     MOVE -1                     TO BMAINTL.
 12532     MOVE ER-7451                TO EMI-ERROR.
 12533     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12534     GO TO 8200-SEND-DATAONLY.
 12535
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 229
* EL6311.cbl
 12537
 12538 1386-UPDATE-AGE-FLAGS.
 12539
 12540
 12541* EXEC CICS GETMAIN
 12542*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12543*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12544*        INITIMG (GETMAIN-SPACE)
 12545*    END-EXEC
 12546*    MOVE ',"IL                  $   #00011951' TO DFHEIV0
 12547     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12548     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12549     MOVE X'2020233030303131393531' TO DFHEIV0(25:11)
 12550     CALL 'kxdfhei1' USING DFHEIV0,
 12551           DFHEIV20,
 12552           ELCRTT-RECORD-LENGTH,
 12553           GETMAIN-SPACE
 12554     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12555         DFHEIV20
 12556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12557
 12558
 12559* EXEC CICS HANDLE CONDITION
 12560*        NOTFND   (1386-NOTFND)
 12561*    END-EXEC.
 12562*    MOVE '"$I                   ! ( #00011957' TO DFHEIV0
 12563     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12565     MOVE X'2820233030303131393537' TO DFHEIV0(25:11)
 12566     CALL 'kxdfhei1' USING DFHEIV0
 12567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12568
 12569
 12570     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12571     MOVE 'C'                TO ELCRTT-REC-TYPE
 12572
 12573
 12574* EXEC CICS READ
 12575*        UPDATE
 12576*        DATASET  (CRTT-ID)
 12577*        RIDFLD   (ELCRTT-KEY)
 12578*        INTO     (CERTIFICATE-TRAILERS)
 12579*    END-EXEC.
 12580     MOVE LENGTH OF
 12581      CERTIFICATE-TRAILERS
 12582       TO DFHEIV11
 12583*    MOVE '&"IL       EU         (   #00011964' TO DFHEIV0
 12584     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12585     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12586     MOVE X'2020233030303131393634' TO DFHEIV0(25:11)
 12587     CALL 'kxdfhei1' USING DFHEIV0,
 12588           CRTT-ID,
 12589           CERTIFICATE-TRAILERS,
 12590           DFHEIV11,
 12591           ELCRTT-KEY,
 12592           DFHEIV99,
 12593           DFHEIV99,
 12594           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 230
* EL6311.cbl
 12595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12596
 12597
 12598     IF WS-INS-AGE-SET = 'Y'
 12599        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12600     END-IF
 12601     IF WS-JNT-AGE-SET = 'Y'
 12602        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12603     END-IF
 12604
 12605
 12606* EXEC CICS REWRITE
 12607*       DATASET  (CRTT-ID)
 12608*       FROM     (CERTIFICATE-TRAILERS)
 12609*    END-EXEC.
 12610     MOVE LENGTH OF
 12611      CERTIFICATE-TRAILERS
 12612       TO DFHEIV11
 12613*    MOVE '&& L                  %   #00011978' TO DFHEIV0
 12614     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12615     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12616     MOVE X'2020233030303131393738' TO DFHEIV0(25:11)
 12617     CALL 'kxdfhei1' USING DFHEIV0,
 12618           CRTT-ID,
 12619           CERTIFICATE-TRAILERS,
 12620           DFHEIV11,
 12621           DFHEIV99
 12622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12623
 12624
 12625     GO TO 1386-EXIT.
 12626
 12627 1386-NOTFND.
 12628
 12629     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12630     MOVE 'CS'         TO CS-RECORD-ID.
 12631     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12632     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12633     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12634     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12635     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12636
 12637* EXEC CICS WRITE
 12638*       DATASET  (CRTT-ID)
 12639*       RIDFLD   (ELCRTT-KEY)
 12640*       FROM     (CERTIFICATE-TRAILERS)
 12641*    END-EXEC.
 12642     MOVE LENGTH OF
 12643      CERTIFICATE-TRAILERS
 12644       TO DFHEIV11
 12645*    MOVE '&$ L                  ''   #00011994' TO DFHEIV0
 12646     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12647     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12648     MOVE X'2020233030303131393934' TO DFHEIV0(25:11)
 12649     CALL 'kxdfhei1' USING DFHEIV0,
 12650           CRTT-ID,
 12651           CERTIFICATE-TRAILERS,
 12652           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 231
* EL6311.cbl
 12653           ELCRTT-KEY,
 12654           DFHEIV99,
 12655           DFHEIV99
 12656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12657
 12658
 12659 1386-EXIT.
 12660     EXIT.
 12661
 12662 1390-UPDATE-ERPNDM.
 12663
 12664
 12665* EXEC CICS HANDLE CONDITION
 12666*        NOTFND (1399-EXIT)
 12667*    END-EXEC.
 12668*    MOVE '"$I                   ! ) #00012005' TO DFHEIV0
 12669     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12670     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12671     MOVE X'2920233030303132303035' TO DFHEIV0(25:11)
 12672     CALL 'kxdfhei1' USING DFHEIV0
 12673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12674
 12675
 12676     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12677
 12678
 12679* EXEC CICS READ
 12680*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12681*        DATASET (FILE-ID-ERPNDM)
 12682*        RIDFLD  (ERPNDM-KEY)
 12683*        UPDATE
 12684*    END-EXEC.
 12685*    MOVE '&"S        EU         (   #00012011' TO DFHEIV0
 12686     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12687     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12688     MOVE X'2020233030303132303131' TO DFHEIV0(25:11)
 12689     CALL 'kxdfhei1' USING DFHEIV0,
 12690           FILE-ID-ERPNDM,
 12691           DFHEIV20,
 12692           DFHEIV99,
 12693           ERPNDM-KEY,
 12694           DFHEIV99,
 12695           DFHEIV99,
 12696           DFHEIV99
 12697     SET ADDRESS OF PENDING-MAILING-DATA TO
 12698         DFHEIV20
 12699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12700
 12701
 12702     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12703     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12704     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12705
 12706     IF BLSTNML GREATER THAN ZEROS
 12707         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12708
 12709     IF B1STNML GREATER  THAN ZEROS
 12710         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 232
* EL6311.cbl
 12711
 12712     IF BINITL GREATER THAN ZEROS
 12713         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12714
 12715     IF BAGEL GREATER THAN ZEROS
 12716         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12717
 12718     IF BBIRTHL GREATER THAN ZEROS
 12719         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12720
 12721     IF BSEXL GREATER THAN ZEROS
 12722         MOVE  BSEXI             TO PM-INSURED-SEX.
 12723
 12724
 12725* EXEC CICS REWRITE
 12726*        DATASET (FILE-ID-ERPNDM)
 12727*        FROM    (PENDING-MAILING-DATA)
 12728*    END-EXEC.
 12729     MOVE LENGTH OF
 12730      PENDING-MAILING-DATA
 12731       TO DFHEIV11
 12732*    MOVE '&& L                  %   #00012040' TO DFHEIV0
 12733     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12734     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12735     MOVE X'2020233030303132303430' TO DFHEIV0(25:11)
 12736     CALL 'kxdfhei1' USING DFHEIV0,
 12737           FILE-ID-ERPNDM,
 12738           PENDING-MAILING-DATA,
 12739           DFHEIV11,
 12740           DFHEIV99
 12741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12742
 12743
 12744 1399-EXIT.
 12745     EXIT.
 12746 139A-SET-LETTER-REQD.
 12747*  COMPARE BEFORE AND AFTER CHANGE
 12748     IF PB-ISSUE-RECORD = WS-SAVE-PEND-ISSUE
 12749        GO TO 139A-EXIT
 12750     END-IF
 12751
 12752*  READ ELCRTO
 12753     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12754                                 TO ELCRTO-KEY
 12755     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12756     MOVE +0                     TO ELCRTO-SEQ-NO
 12757
 12758
 12759* EXEC CICS READ
 12760*       DATASET   ('ELCRTO')
 12761*       INTO      (ORIGINAL-CERTIFICATE)
 12762*       RIDFLD    (ELCRTO-KEY)
 12763*       GTEQ
 12764*       RESP      (WS-RESPONSE)
 12765*    END-EXEC
 12766     MOVE LENGTH OF
 12767      ORIGINAL-CERTIFICATE
 12768       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 233
* EL6311.cbl
 12769     MOVE 'ELCRTO' TO DFHEIV1
 12770*    MOVE '&"IL       G          (  N#00012059' TO DFHEIV0
 12771     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12772     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12773     MOVE X'204E233030303132303539' TO DFHEIV0(25:11)
 12774     CALL 'kxdfhei1' USING DFHEIV0,
 12775           DFHEIV1,
 12776           ORIGINAL-CERTIFICATE,
 12777           DFHEIV11,
 12778           ELCRTO-KEY,
 12779           DFHEIV99,
 12780           DFHEIV99,
 12781           DFHEIV99
 12782     MOVE EIBRESP  TO WS-RESPONSE
 12783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12784
 12785*    display ' just read gteq ' ws-response
 12786     IF RESP-NORMAL
 12787        AND (OC-CONTROL-PRIMARY (1:33) =
 12788                 PB-CONTROL-BY-ACCOUNT (1:33))
 12789        AND (OC-RECORD-TYPE = 'I')
 12790*      compare individual fields
 12791        IF LETRREQL   GREATER THAN ZEROS
 12792           CONTINUE
 12793        ELSE
 12794        IF OC-CERT-NO = PB-CERT-NO
 12795          AND OC-CERT-EFF-DT = PB-CERT-EFF-DT
 12796          AND OC-INS-LAST-NAME = PB-I-INSURED-LAST-NAME
 12797          AND OC-INS-FIRST-NAME = PB-I-INSURED-FIRST-NAME
 12798          AND OC-INS-MIDDLE-INIT =  PB-I-INSURED-MIDDLE-INIT
 12799          AND OC-INS-AGE = PB-I-AGE
 12800          AND OC-LF-BENCD = PB-I-LIFE-BENEFIT-CD
 12801          AND OC-LF-TERM = PB-I-LF-TERM
 12802          AND OC-LF-BEN-AMT = PB-I-LF-BENEFIT-AMT
 12803          AND OC-LF-PRM-AMT = PB-I-LF-PREMIUM-AMT
 12804          AND OC-LF-EXP-DT = PB-I-LF-EXPIRE-DT
 12805          AND OC-LF-ALT-BEN-AMT = PB-I-LF-ALT-BENEFIT-AMT
 12806          AND PB-I-LF-ALT-PREMIUM-AMT = OC-LF-ALT-PRM-AMT
 12807          AND PB-I-LF-EXPIRE-DT = OC-LF-EXP-DT
 12808          AND PB-I-AH-BENEFIT-CD     = OC-AH-BENCD
 12809          AND PB-I-AH-TERM           = OC-AH-TERM
 12810          AND PB-I-AH-BENEFIT-AMT    = OC-AH-BEN-AMT
 12811          AND PB-I-AH-PREMIUM-AMT    = OC-AH-PRM-AMT
 12812          AND PB-I-AH-EXPIRE-DT      = OC-AH-EXP-DT
 12813          AND PB-I-AH-COMMISSION     = OC-AH-COMM-PCT
 12814          AND PB-I-AH-CRIT-PER       = OC-AH-CP
 12815           MOVE SPACE TO PB-I-LETTER-REQD
 12816        ELSE
 12817           MOVE 'Y' TO PB-I-LETTER-REQD
 12818        END-IF
 12819     END-IF.
 12820
 12821 139A-EXIT.
 12822     EXIT.
 12823
 12824******************************************************************
 12825*                                                                *
 12826*          D E L E T E   I S S U E   R O U T I N E               *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 234
* EL6311.cbl
 12827*                                                                *
 12828******************************************************************
 12829
 12830 1400-DELETE-ISSUE-ROUTINE.
 12831     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12832
 12833     IF BCHGL NOT = ZEROS
 12834        MOVE ER-2196             TO EMI-ERROR
 12835        MOVE AL-UABON            TO BMAINTA
 12836        MOVE -1                  TO BMAINTL
 12837        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12838        GO TO 8200-SEND-DATAONLY.
 12839
 12840
 12841* EXEC CICS HANDLE CONDITION
 12842*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12843*    END-EXEC.
 12844*    MOVE '"$I                   ! * #00012122' TO DFHEIV0
 12845     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12846     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12847     MOVE X'2A20233030303132313232' TO DFHEIV0(25:11)
 12848     CALL 'kxdfhei1' USING DFHEIV0
 12849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12850
 12851
 12852     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12853     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12854     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12855
 12856
 12857* EXEC CICS READ
 12858*        SET     (ADDRESS OF PENDING-BUSINESS)
 12859*        DATASET (FILE-ID-ERPNDB)
 12860*        RIDFLD  (ERPNDB-KEY)
 12861*    END-EXEC.
 12862*    MOVE '&"S        E          (   #00012130' TO DFHEIV0
 12863     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12864     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12865     MOVE X'2020233030303132313330' TO DFHEIV0(25:11)
 12866     CALL 'kxdfhei1' USING DFHEIV0,
 12867           FILE-ID-ERPNDB,
 12868           DFHEIV20,
 12869           DFHEIV99,
 12870           ERPNDB-KEY,
 12871           DFHEIV99,
 12872           DFHEIV99,
 12873           DFHEIV99
 12874     SET ADDRESS OF PENDING-BUSINESS TO
 12875         DFHEIV20
 12876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12877
 12878
 12879     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12880
 12881     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12882
 12883     IF BSUFIXL NOT = ZEROS
 12884        MOVE BSUFIXI             TO WS-NEW-SUFFIX
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 235
* EL6311.cbl
 12885     ELSE
 12886        MOVE SPACE               TO WS-NEW-SUFFIX.
 12887
 12888     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12889     PERFORM 8600-DEEDIT.
 12890     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12891     MOVE '4'                    TO DC-OPTION-CODE.
 12892     PERFORM 9700-DATE-LINK.
 12893     IF DATE-CONVERSION-ERROR
 12894        MOVE ER-0348             TO EMI-ERROR
 12895        MOVE -1                  TO BEFFDTL
 12896        MOVE AL-UABON            TO BEFFDTA
 12897        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12898        GO TO 8200-SEND-DATAONLY
 12899     ELSE
 12900        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12901        MOVE AL-UANON            TO BEFFDTA
 12902        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12903
 12904
 12905* EXEC CICS HANDLE CONDITION
 12906*         NOTFND    (1490-RECORD-NOT-FOUND)
 12907*    END-EXEC.
 12908*    MOVE '"$I                   ! + #00012161' TO DFHEIV0
 12909     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12910     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12911     MOVE X'2B20233030303132313631' TO DFHEIV0(25:11)
 12912     CALL 'kxdfhei1' USING DFHEIV0
 12913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12914
 12915
 12916
 12917* EXEC CICS READ
 12918*        SET     (ADDRESS OF PENDING-BUSINESS)
 12919*        DATASET (FILE-ID-ERPNDB)
 12920*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12921*        UPDATE
 12922*    END-EXEC.
 12923*    MOVE '&"S        EU         (   #00012165' TO DFHEIV0
 12924     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12925     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12926     MOVE X'2020233030303132313635' TO DFHEIV0(25:11)
 12927     CALL 'kxdfhei1' USING DFHEIV0,
 12928           FILE-ID-ERPNDB,
 12929           DFHEIV20,
 12930           DFHEIV99,
 12931           PI-PREV-CONTROL-PRIMARY,
 12932           DFHEIV99,
 12933           DFHEIV99,
 12934           DFHEIV99
 12935     SET ADDRESS OF PENDING-BUSINESS TO
 12936         DFHEIV20
 12937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12938
 12939
 12940     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12941        MOVE -1                 TO BMAINTL
 12942        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 236
* EL6311.cbl
 12943        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12944        GO TO 8200-SEND-DATAONLY.
 12945
 12946     IF PB-BILLED-DT NOT = LOW-VALUES
 12947        MOVE -1                 TO BMAINTL
 12948        MOVE ER-2129            TO EMI-ERROR
 12949        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12950        GO TO 8200-SEND-DATAONLY.
 12951
 12952     IF PB-CHG-COUNT NOT = ZEROS
 12953        MOVE ER-2336            TO EMI-ERROR
 12954        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12955        MOVE AL-UABON            TO BMAINTA
 12956        MOVE -1                  TO BMAINTL
 12957        GO TO 8200-SEND-DATAONLY.
 12958
 12959     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12960        PB-CHG-COUNT NOT = ZEROS
 12961        MOVE ER-2196             TO EMI-ERROR
 12962        MOVE AL-UABON            TO BMAINTA
 12963        MOVE -1                  TO BMAINTL
 12964        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12965        GO TO 8200-SEND-DATAONLY.
 12966******************************************************************
 12967*                                                                *
 12968*       Determine if there have been any checks created          *
 12969*                                                                *
 12970******************************************************************
 12971
 12972     perform 2500-browse-checks  thru 2500-exit
 12973
 12974     if i-have-processed-checks
 12975        or i-have-checks
 12976        or i-have-a-check-period
 12977        move er-3446             to emi-error
 12978        perform 9900-error-format thru 9900-exit
 12979        move al-uabon            to bmainta
 12980        move -1                  to bmaintl
 12981        go to 8200-send-dataonly
 12982     end-if
 12983******************************************************************
 12984*                                                                *
 12985*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12986*                                                                *
 12987******************************************************************
 12988     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12989     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12990     MOVE +0                     TO ELCRTO-SEQ-NO
 12991
 12992* EXEC CICS READ
 12993*       DATASET   ('ELCRTO')
 12994*       INTO      (ORIGINAL-CERTIFICATE)
 12995*       RIDFLD    (ELCRTO-KEY)
 12996*       GTEQ
 12997*       RESP      (WS-RESPONSE)
 12998*    END-EXEC
 12999     MOVE LENGTH OF
 13000      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 237
* EL6311.cbl
 13001       TO DFHEIV11
 13002     MOVE 'ELCRTO' TO DFHEIV1
 13003*    MOVE '&"IL       G          (  N#00012223' TO DFHEIV0
 13004     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 13005     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13006     MOVE X'204E233030303132323233' TO DFHEIV0(25:11)
 13007     CALL 'kxdfhei1' USING DFHEIV0,
 13008           DFHEIV1,
 13009           ORIGINAL-CERTIFICATE,
 13010           DFHEIV11,
 13011           ELCRTO-KEY,
 13012           DFHEIV99,
 13013           DFHEIV99,
 13014           DFHEIV99
 13015     MOVE EIBRESP  TO WS-RESPONSE
 13016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13017     IF RESP-NORMAL
 13018        AND (OC-CONTROL-PRIMARY (1:33) =
 13019                 PB-CONTROL-BY-ACCOUNT (1:33))
 13020        AND (OC-RECORD-TYPE = 'I')
 13021
 13022* EXEC CICS READ
 13023*          DATASET   ('ELCRTO')
 13024*          INTO      (ORIGINAL-CERTIFICATE)
 13025*          RIDFLD    (ELCRTO-KEY)
 13026*          UPDATE
 13027*          RESP      (WS-RESPONSE)
 13028*       END-EXEC
 13029     MOVE LENGTH OF
 13030      ORIGINAL-CERTIFICATE
 13031       TO DFHEIV11
 13032     MOVE 'ELCRTO' TO DFHEIV1
 13033*    MOVE '&"IL       EU         (  N#00012234' TO DFHEIV0
 13034     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13035     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13036     MOVE X'204E233030303132323334' TO DFHEIV0(25:11)
 13037     CALL 'kxdfhei1' USING DFHEIV0,
 13038           DFHEIV1,
 13039           ORIGINAL-CERTIFICATE,
 13040           DFHEIV11,
 13041           ELCRTO-KEY,
 13042           DFHEIV99,
 13043           DFHEIV99,
 13044           DFHEIV99
 13045     MOVE EIBRESP  TO WS-RESPONSE
 13046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13047        IF RESP-NORMAL
 13048
 13049* EXEC CICS DELETE
 13050*             DATASET   ('ELCRTO')
 13051*          END-EXEC
 13052     MOVE 'ELCRTO' TO DFHEIV1
 13053*    MOVE '&(                    &   #00012242' TO DFHEIV0
 13054     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13055     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13056     MOVE X'2020233030303132323432' TO DFHEIV0(25:11)
 13057     CALL 'kxdfhei1' USING DFHEIV0,
 13058           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 238
* EL6311.cbl
 13059           DFHEIV99,
 13060           DFHEIV99,
 13061           DFHEIV99,
 13062           DFHEIV99
 13063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13064        END-IF
 13065     END-IF
 13066******************************************************************
 13067*                                                                *
 13068*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 13069*                                                                *
 13070******************************************************************
 13071
 13072* EXEC CICS HANDLE CONDITION
 13073*        NOTFND    (1405-DELETE-CERTIFICATE)
 13074*    END-EXEC.
 13075*    MOVE '"$I                   ! , #00012252' TO DFHEIV0
 13076     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13077     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13078     MOVE X'2C20233030303132323532' TO DFHEIV0(25:11)
 13079     CALL 'kxdfhei1' USING DFHEIV0
 13080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13081
 13082
 13083
 13084* EXEC CICS READ
 13085*        EQUAL
 13086*        DATASET   (FILE-ID-ERPNDM)
 13087*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 13088*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 13089*        UPDATE
 13090*    END-EXEC.
 13091*    MOVE '&"S        EU         (   #00012256' TO DFHEIV0
 13092     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13093     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13094     MOVE X'2020233030303132323536' TO DFHEIV0(25:11)
 13095     CALL 'kxdfhei1' USING DFHEIV0,
 13096           FILE-ID-ERPNDM,
 13097           DFHEIV20,
 13098           DFHEIV99,
 13099           PI-PREV-CONTROL-PRIMARY,
 13100           DFHEIV99,
 13101           DFHEIV99,
 13102           DFHEIV99
 13103     SET ADDRESS OF PENDING-MAILING-DATA TO
 13104         DFHEIV20
 13105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13106
 13107
 13108     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 13109     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13110     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 13111
 13112     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13113
 13114
 13115* EXEC CICS DELETE
 13116*        DATASET   (FILE-ID-ERPNDM)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 239
* EL6311.cbl
 13117*    END-EXEC.
 13118*    MOVE '&(                    &   #00012270' TO DFHEIV0
 13119     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13120     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13121     MOVE X'2020233030303132323730' TO DFHEIV0(25:11)
 13122     CALL 'kxdfhei1' USING DFHEIV0,
 13123           FILE-ID-ERPNDM,
 13124           DFHEIV99,
 13125           DFHEIV99,
 13126           DFHEIV99,
 13127           DFHEIV99
 13128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13129
 13130
 13131******************************************************************
 13132*                PROCESS   CERTIFICATE                           *
 13133******************************************************************
 13134
 13135 1405-DELETE-CERTIFICATE.
 13136
 13137* EXEC CICS HANDLE CONDITION
 13138*         NOTFND  (1420-CONTINUE-DELETE)
 13139*    END-EXEC.
 13140*    MOVE '"$I                   ! - #00012279' TO DFHEIV0
 13141     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13142     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13143     MOVE X'2D20233030303132323739' TO DFHEIV0(25:11)
 13144     CALL 'kxdfhei1' USING DFHEIV0
 13145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13146
 13147
 13148     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 13149     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 13150     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 13151     MOVE PB-SV-STATE            TO ELCERT-STATE.
 13152
 13153
 13154* EXEC CICS READ
 13155*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13156*        DATASET (FILE-ID-ELCERT)
 13157*        RIDFLD  (ELCERT-KEY)
 13158*        UPDATE
 13159*    END-EXEC.
 13160*    MOVE '&"S        EU         (   #00012288' TO DFHEIV0
 13161     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13162     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13163     MOVE X'2020233030303132323838' TO DFHEIV0(25:11)
 13164     CALL 'kxdfhei1' USING DFHEIV0,
 13165           FILE-ID-ELCERT,
 13166           DFHEIV20,
 13167           DFHEIV99,
 13168           ELCERT-KEY,
 13169           DFHEIV99,
 13170           DFHEIV99,
 13171           DFHEIV99
 13172     SET ADDRESS OF CERTIFICATE-MASTER TO
 13173         DFHEIV20
 13174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 240
* EL6311.cbl
 13175
 13176
 13177     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13178
 13179     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 13180     MOVE 'B'                    TO JP-RECORD-TYPE
 13181     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 13182
 13183     PERFORM 8400-LOG-JOURNAL-RECORD.
 13184
 13185     IF CERT-NOTES-ARE-NOT-PRESENT
 13186        MOVE ' '                 TO WS-CERT-NOTE-SW
 13187     ELSE
 13188        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 13189
 13190     IF INSURED-ADDR-PRESENT
 13191        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 13192
 13193******************************************************************
 13194******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 13195******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 13196******************************************************************
 13197******************************************************************
 13198
 13199     IF CERT-ADDED-BATCH AND
 13200        (NOT NO-CLAIM-ATTACHED
 13201         OR
 13202         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 13203        GO TO 1410-REWRITE-CERT.
 13204
 13205******************************************************************
 13206******************************************************************
 13207
 13208     IF CERT-ADDED-BATCH  AND
 13209        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 13210        GO TO 1410-REWRITE-CERT.
 13211
 13212     IF NO-CLAIM-ATTACHED
 13213        NEXT SENTENCE
 13214     ELSE
 13215        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 13216        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 13217        GO TO 1410-REWRITE-CERT.
 13218
 13219     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13220     MOVE 'D'                      TO JP-RECORD-TYPE.
 13221     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13222
 13223
 13224* EXEC CICS DELETE
 13225*         DATASET    (FILE-ID-ELCERT)
 13226*    END-EXEC.
 13227*    MOVE '&(                    &   #00012341' TO DFHEIV0
 13228     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13229     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13230     MOVE X'2020233030303132333431' TO DFHEIV0(25:11)
 13231     CALL 'kxdfhei1' USING DFHEIV0,
 13232           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 241
* EL6311.cbl
 13233           DFHEIV99,
 13234           DFHEIV99,
 13235           DFHEIV99,
 13236           DFHEIV99
 13237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13238
 13239
 13240     PERFORM 8400-LOG-JOURNAL-RECORD.
 13241
 13242******************************************************************
 13243*                                                                *
 13244*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 13245*                                                                *
 13246******************************************************************
 13247
 13248     IF  CERT-NOTES-ARE-PRESENT
 13249         NEXT SENTENCE
 13250     ELSE
 13251         GO TO 1407-DELETE-MAILING.
 13252
 13253
 13254* EXEC CICS HANDLE CONDITION
 13255*         NOTFND  (1406-DELETE-ERNOTE)
 13256*    END-EXEC.
 13257*    MOVE '"$I                   ! . #00012358' TO DFHEIV0
 13258     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13259     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13260     MOVE X'2E20233030303132333538' TO DFHEIV0(25:11)
 13261     CALL 'kxdfhei1' USING DFHEIV0
 13262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13263
 13264
 13265     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 13266     MOVE '0'                   TO ERCNOT-REC-TYPE.
 13267     MOVE 0                     TO ERCNOT-SEQUENCE.
 13268
 13269 1406-DELETE-ERCNOT-LOOP.
 13270
 13271
 13272* EXEC CICS READ
 13273*        GTEQ
 13274*        DATASET   (FILE-ID-ERCNOT)
 13275*        SET       (ADDRESS OF CERT-NOTE-FILE)
 13276*        RIDFLD    (ERCNOT-KEY)
 13277*    END-EXEC.
 13278*    MOVE '&"S        G          (   #00012368' TO DFHEIV0
 13279     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13280     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13281     MOVE X'2020233030303132333638' TO DFHEIV0(25:11)
 13282     CALL 'kxdfhei1' USING DFHEIV0,
 13283           FILE-ID-ERCNOT,
 13284           DFHEIV20,
 13285           DFHEIV99,
 13286           ERCNOT-KEY,
 13287           DFHEIV99,
 13288           DFHEIV99,
 13289           DFHEIV99
 13290     SET ADDRESS OF CERT-NOTE-FILE TO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 242
* EL6311.cbl
 13291         DFHEIV20
 13292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13293
 13294
 13295     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 13296     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 13297         GO TO 1406-DELETE-ERNOTE
 13298     END-IF.
 13299
 13300     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 13301     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13302     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 13303
 13304     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13305
 13306
 13307* EXEC CICS DELETE
 13308*        DATASET   (FILE-ID-ERCNOT)
 13309*        RIDFLD    (ERCNOT-KEY)
 13310*        END-EXEC.
 13311*    MOVE '&(  R                 &   #00012386' TO DFHEIV0
 13312     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13313     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13314     MOVE X'2020233030303132333836' TO DFHEIV0(25:11)
 13315     CALL 'kxdfhei1' USING DFHEIV0,
 13316           FILE-ID-ERCNOT,
 13317           ERCNOT-KEY,
 13318           DFHEIV99,
 13319           DFHEIV99,
 13320           DFHEIV99
 13321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13322
 13323
 13324     PERFORM 8400-LOG-JOURNAL-RECORD.
 13325
 13326     GO TO 1406-DELETE-ERCNOT-LOOP.
 13327
 13328 1406-DELETE-ERNOTE.
 13329
 13330
 13331* EXEC CICS HANDLE CONDITION
 13332*         NOTFND  (1407-DELETE-MAILING)
 13333*    END-EXEC.
 13334*    MOVE '"$I                   ! / #00012397' TO DFHEIV0
 13335     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13336     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13337     MOVE X'2F20233030303132333937' TO DFHEIV0(25:11)
 13338     CALL 'kxdfhei1' USING DFHEIV0
 13339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13340
 13341
 13342
 13343* EXEC CICS READ
 13344*        EQUAL
 13345*        DATASET   (FILE-ID-ERNOTE)
 13346*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 13347*        RIDFLD    (ELCERT-KEY)
 13348*        UPDATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 243
* EL6311.cbl
 13349*    END-EXEC.
 13350*    MOVE '&"S        EU         (   #00012401' TO DFHEIV0
 13351     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13352     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13353     MOVE X'2020233030303132343031' TO DFHEIV0(25:11)
 13354     CALL 'kxdfhei1' USING DFHEIV0,
 13355           FILE-ID-ERNOTE,
 13356           DFHEIV20,
 13357           DFHEIV99,
 13358           ELCERT-KEY,
 13359           DFHEIV99,
 13360           DFHEIV99,
 13361           DFHEIV99
 13362     SET ADDRESS OF CERTIFICATE-NOTE TO
 13363         DFHEIV20
 13364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13365
 13366
 13367     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 13368     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13369     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13370
 13371     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13372
 13373
 13374* EXEC CICS DELETE
 13375*        DATASET   (FILE-ID-ERNOTE)
 13376*        END-EXEC.
 13377*    MOVE '&(                    &   #00012415' TO DFHEIV0
 13378     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13379     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13380     MOVE X'2020233030303132343135' TO DFHEIV0(25:11)
 13381     CALL 'kxdfhei1' USING DFHEIV0,
 13382           FILE-ID-ERNOTE,
 13383           DFHEIV99,
 13384           DFHEIV99,
 13385           DFHEIV99,
 13386           DFHEIV99
 13387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13388
 13389
 13390     PERFORM 8400-LOG-JOURNAL-RECORD.
 13391
 13392******************************************************************
 13393*                                                                *
 13394*                DELETE MAILING ADDRESS RECORDS                  *
 13395*                                                                *
 13396******************************************************************
 13397
 13398 1407-DELETE-MAILING.
 13399     IF CERT-ADDRESS-PRESENT
 13400        NEXT SENTENCE
 13401     ELSE
 13402        GO TO 1420-CONTINUE-DELETE.
 13403
 13404
 13405* EXEC CICS HANDLE CONDITION
 13406*         NOTFND  (1420-CONTINUE-DELETE)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 244
* EL6311.cbl
 13407*    END-EXEC.
 13408*    MOVE '"$I                   ! 0 #00012433' TO DFHEIV0
 13409     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13410     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13411     MOVE X'3020233030303132343333' TO DFHEIV0(25:11)
 13412     CALL 'kxdfhei1' USING DFHEIV0
 13413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13414
 13415
 13416
 13417* EXEC CICS READ
 13418*        EQUAL
 13419*        DATASET   (FILE-ID-ERMAIL)
 13420*        SET       (ADDRESS OF MAILING-DATA)
 13421*        RIDFLD    (ELCERT-KEY)
 13422*        UPDATE
 13423*    END-EXEC.
 13424*    MOVE '&"S        EU         (   #00012437' TO DFHEIV0
 13425     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13426     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13427     MOVE X'2020233030303132343337' TO DFHEIV0(25:11)
 13428     CALL 'kxdfhei1' USING DFHEIV0,
 13429           FILE-ID-ERMAIL,
 13430           DFHEIV20,
 13431           DFHEIV99,
 13432           ELCERT-KEY,
 13433           DFHEIV99,
 13434           DFHEIV99,
 13435           DFHEIV99
 13436     SET ADDRESS OF MAILING-DATA TO
 13437         DFHEIV20
 13438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13439
 13440
 13441     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13442     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13443     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13444
 13445     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13446
 13447
 13448* EXEC CICS DELETE
 13449*        DATASET   (FILE-ID-ERMAIL)
 13450*    END-EXEC.
 13451*    MOVE '&(                    &   #00012451' TO DFHEIV0
 13452     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13453     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13454     MOVE X'2020233030303132343531' TO DFHEIV0(25:11)
 13455     CALL 'kxdfhei1' USING DFHEIV0,
 13456           FILE-ID-ERMAIL,
 13457           DFHEIV99,
 13458           DFHEIV99,
 13459           DFHEIV99,
 13460           DFHEIV99
 13461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13462
 13463
 13464     GO TO 1420-CONTINUE-DELETE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 245
* EL6311.cbl
 13465
 13466 1410-REWRITE-CERT.
 13467     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13468     MOVE 'C'                      TO JP-RECORD-TYPE.
 13469     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13470     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13471
 13472
 13473* EXEC CICS REWRITE
 13474*         DATASET    (FILE-ID-ELCERT)
 13475*         FROM       (CERTIFICATE-MASTER)
 13476*         END-EXEC.
 13477     MOVE LENGTH OF
 13478      CERTIFICATE-MASTER
 13479       TO DFHEIV11
 13480*    MOVE '&& L                  %   #00012463' TO DFHEIV0
 13481     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13482     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13483     MOVE X'2020233030303132343633' TO DFHEIV0(25:11)
 13484     CALL 'kxdfhei1' USING DFHEIV0,
 13485           FILE-ID-ELCERT,
 13486           CERTIFICATE-MASTER,
 13487           DFHEIV11,
 13488           DFHEIV99
 13489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13490
 13491
 13492     PERFORM 8400-LOG-JOURNAL-RECORD.
 13493
 13494 1420-CONTINUE-DELETE.
 13495     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 13496     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13497
 13498     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13499     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13500
 13501     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13502
 13503 1450-DELETE-PB-RECORD.
 13504     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13505     MOVE 'D'                      TO JP-RECORD-TYPE
 13506     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13507
 13508
 13509* EXEC CICS DELETE
 13510*        DATASET    (FILE-ID-ERPNDB)
 13511*    END-EXEC.
 13512*    MOVE '&(                    &   #00012484' TO DFHEIV0
 13513     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13514     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13515     MOVE X'2020233030303132343834' TO DFHEIV0(25:11)
 13516     CALL 'kxdfhei1' USING DFHEIV0,
 13517           FILE-ID-ERPNDB,
 13518           DFHEIV99,
 13519           DFHEIV99,
 13520           DFHEIV99,
 13521           DFHEIV99
 13522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 246
* EL6311.cbl
 13523
 13524
 13525     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13526
 13527     PERFORM 8400-LOG-JOURNAL-RECORD *> Journal Delete
 13528
 13529     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13530     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13531     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13532
 13533
 13534* EXEC CICS HANDLE CONDITION
 13535*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13536*    END-EXEC.
 13537*    MOVE '"$I                   ! 1 #00012496' TO DFHEIV0
 13538     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13539     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13540     MOVE X'3120233030303132343936' TO DFHEIV0(25:11)
 13541     CALL 'kxdfhei1' USING DFHEIV0
 13542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13543
 13544
 13545
 13546* EXEC CICS READ
 13547*        SET     (ADDRESS OF PENDING-BUSINESS)
 13548*        DATASET (FILE-ID-ERPNDB)
 13549*        RIDFLD  (ERPNDB-KEY)
 13550*        UPDATE
 13551*    END-EXEC.
 13552*    MOVE '&"S        EU         (   #00012500' TO DFHEIV0
 13553     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13554     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13555     MOVE X'2020233030303132353030' TO DFHEIV0(25:11)
 13556     CALL 'kxdfhei1' USING DFHEIV0,
 13557           FILE-ID-ERPNDB,
 13558           DFHEIV20,
 13559           DFHEIV99,
 13560           ERPNDB-KEY,
 13561           DFHEIV99,
 13562           DFHEIV99,
 13563           DFHEIV99
 13564     SET ADDRESS OF PENDING-BUSINESS TO
 13565         DFHEIV20
 13566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13567
 13568
 13569     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13570
 13571     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13572
 13573     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13574        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13575        MOVE 'D'                   TO JP-RECORD-TYPE
 13576        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13577
 13578* EXEC CICS DELETE
 13579*            DATASET    (FILE-ID-ERPNDB)
 13580*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 247
* EL6311.cbl
 13581*    MOVE '&(                    &   #00012515' TO DFHEIV0
 13582     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13583     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13584     MOVE X'2020233030303132353135' TO DFHEIV0(25:11)
 13585     CALL 'kxdfhei1' USING DFHEIV0,
 13586           FILE-ID-ERPNDB,
 13587           DFHEIV99,
 13588           DFHEIV99,
 13589           DFHEIV99,
 13590           DFHEIV99
 13591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13592        PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Delete
 13593     ELSE
 13594        MOVE 'B'                 TO JP-RECORD-TYPE
 13595        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13596        PERFORM 8400-LOG-JOURNAL-RECORD  *> Before Image
 13597        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13598        MOVE 'C'                 TO JP-RECORD-TYPE
 13599        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13600
 13601* EXEC CICS REWRITE
 13602*            DATASET    (FILE-ID-ERPNDB)
 13603*            FROM       (PENDING-BUSINESS)
 13604*       END-EXEC
 13605     MOVE LENGTH OF
 13606      PENDING-BUSINESS
 13607       TO DFHEIV11
 13608*    MOVE '&& L                  %   #00012526' TO DFHEIV0
 13609     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13610     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13611     MOVE X'2020233030303132353236' TO DFHEIV0(25:11)
 13612     CALL 'kxdfhei1' USING DFHEIV0,
 13613           FILE-ID-ERPNDB,
 13614           PENDING-BUSINESS,
 13615           DFHEIV11,
 13616           DFHEIV99
 13617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13618        PERFORM 8400-LOG-JOURNAL-RECORD  *> After Image
 13619     end-if
 13620******************************************************************
 13621*                                                                *
 13622*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13623*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13624*                                                                *
 13625******************************************************************
 13626
 13627     IF NOT PI-AR-PROCESSING
 13628        GO TO 1475-DELETE-FINISHED.
 13629
 13630     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13631        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13632        NEXT SENTENCE
 13633     ELSE
 13634        GO TO 1475-DELETE-FINISHED.
 13635
 13636
 13637* EXEC CICS HANDLE CONDITION
 13638*         NOTFND    (1475-DELETE-FINISHED)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 248
* EL6311.cbl
 13639*         END-EXEC.
 13640*    MOVE '"$I                   ! 2 #00012548' TO DFHEIV0
 13641     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13643     MOVE X'3220233030303132353438' TO DFHEIV0(25:11)
 13644     CALL 'kxdfhei1' USING DFHEIV0
 13645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13646
 13647
 13648     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13649     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13650
 13651
 13652* EXEC CICS READ
 13653*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13654*        DATASET (FILE-ID-ERRQST)
 13655*        RIDFLD  (ERRQST-KEY)
 13656*        UPDATE
 13657*    END-EXEC.
 13658*    MOVE '&"S        EU         (   #00012555' TO DFHEIV0
 13659     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13660     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13661     MOVE X'2020233030303132353535' TO DFHEIV0(25:11)
 13662     CALL 'kxdfhei1' USING DFHEIV0,
 13663           FILE-ID-ERRQST,
 13664           DFHEIV20,
 13665           DFHEIV99,
 13666           ERRQST-KEY,
 13667           DFHEIV99,
 13668           DFHEIV99,
 13669           DFHEIV99
 13670     SET ADDRESS OF AR-REQUEST-RECORD TO
 13671         DFHEIV20
 13672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13673
 13674
 13675     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13676
 13677     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13678
 13679     MOVE 'D'                      TO JP-RECORD-TYPE.
 13680     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13681
 13682
 13683* EXEC CICS DELETE
 13684*         DATASET    (FILE-ID-ERRQST)
 13685*    END-EXEC.
 13686*    MOVE '&(                    &   #00012569' TO DFHEIV0
 13687     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13688     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13689     MOVE X'2020233030303132353639' TO DFHEIV0(25:11)
 13690     CALL 'kxdfhei1' USING DFHEIV0,
 13691           FILE-ID-ERRQST,
 13692           DFHEIV99,
 13693           DFHEIV99,
 13694           DFHEIV99,
 13695           DFHEIV99
 13696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 249
* EL6311.cbl
 13697
 13698
 13699     PERFORM 8400-LOG-JOURNAL-RECORD.
 13700
 13701 1475-DELETE-FINISHED.
 13702     MOVE ZEROS                  TO EMI-ERROR.
 13703     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13704     MOVE LOW-VALUES             TO EL631BI.
 13705     MOVE -1                     TO BMAINTL.
 13706     GO TO 8100-SEND-INITIAL-MAP.
 13707
 13708 1480-BATCH-HDR-NOT-FOUND.
 13709     MOVE -1                     TO BMAINTL.
 13710     MOVE ER-7450                TO EMI-ERROR.
 13711     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13712     GO TO 8200-SEND-DATAONLY.
 13713
 13714 1490-RECORD-NOT-FOUND.
 13715     MOVE -1                     TO BMAINTL.
 13716     MOVE ER-7451                TO EMI-ERROR.
 13717     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13718     GO TO 8200-SEND-DATAONLY.
 13719
 13720******************************************************************
 13721*            O V E R   C H A R G E   P R O C E S S I N G         *
 13722******************************************************************
 13723 1500-UPDATE-ERNOTE.
 13724     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13725     MOVE 'A'                    TO WS-NOTE-SW
 13726     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13727     .
 13728 1500-EXIT.
 13729     EXIT.
 13730 1510-ADD-ERNOTE-REC.
 13731
 13732* EXEC CICS GETMAIN
 13733*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13734*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13735*        INITIMG (GETMAIN-SPACE)
 13736*    END-EXEC
 13737*    MOVE ',"IL                  $   #00012605' TO DFHEIV0
 13738     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13739     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13740     MOVE X'2020233030303132363035' TO DFHEIV0(25:11)
 13741     CALL 'kxdfhei1' USING DFHEIV0,
 13742           DFHEIV20,
 13743           ERNOTE-RECORD-LENGTH,
 13744           GETMAIN-SPACE
 13745     SET ADDRESS OF CERTIFICATE-NOTE TO
 13746         DFHEIV20
 13747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13748     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13749                                 TO ERNOTE-KEY
 13750
 13751* EXEC CICS READ
 13752*       DATASET    (FILE-ID-ERNOTE)
 13753*       RIDFLD     (ERNOTE-KEY)
 13754*       INTO       (CERTIFICATE-NOTE)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 250
* EL6311.cbl
 13755*       RESP       (WS-RESPONSE)
 13756*       UPDATE
 13757*    END-EXEC
 13758     MOVE LENGTH OF
 13759      CERTIFICATE-NOTE
 13760       TO DFHEIV11
 13761*    MOVE '&"IL       EU         (  N#00012612' TO DFHEIV0
 13762     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13763     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13764     MOVE X'204E233030303132363132' TO DFHEIV0(25:11)
 13765     CALL 'kxdfhei1' USING DFHEIV0,
 13766           FILE-ID-ERNOTE,
 13767           CERTIFICATE-NOTE,
 13768           DFHEIV11,
 13769           ERNOTE-KEY,
 13770           DFHEIV99,
 13771           DFHEIV99,
 13772           DFHEIV99
 13773     MOVE EIBRESP  TO WS-RESPONSE
 13774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13775     IF RESP-NORMAL
 13776        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13777           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13778        END-IF
 13779        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13780           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13781        END-IF
 13782        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13783           (N1 > +10)
 13784           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13785           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13786        END-PERFORM
 13787        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13788          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13789
 13790* EXEC CICS UNLOCK
 13791*            DATASET    (FILE-ID-ERNOTE)
 13792*          END-EXEC
 13793*    MOVE '&*                    #   #00012633' TO DFHEIV0
 13794     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13795     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13796     MOVE X'2020233030303132363333' TO DFHEIV0(25:11)
 13797     CALL 'kxdfhei1' USING DFHEIV0,
 13798           FILE-ID-ERNOTE,
 13799           DFHEIV99
 13800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13801        ELSE
 13802          PERFORM VARYING N1 FROM +1 BY +1
 13803           UNTIL (N1 > +10)
 13804           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13805          END-PERFORM
 13806          IF (N1 < +11)
 13807            IF N1 >= CN-BILLING-START-LINE-NO AND
 13808              N1 <= CN-BILLING-END-LINE-NO
 13809              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13810                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13811              ELSE
 13812                 MOVE WS-VA-NO-COMM-MESS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 251
* EL6311.cbl
 13813                                    TO CN-LINE (N1)
 13814              END-IF
 13815            ELSE
 13816              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13817               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13818                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13819                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13820                ELSE
 13821                  MOVE WS-VA-NO-COMM-MESS
 13822                                    TO CN-LINE (N1)
 13823                END-IF
 13824                MOVE N1             TO CN-BILLING-END-LINE-NO
 13825              ELSE
 13826                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13827                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13828                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13829                  ELSE
 13830                     MOVE WS-VA-NO-COMM-MESS
 13831                                    TO CN-LINE (N1)
 13832                  END-IF
 13833                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13834                                      CN-BILLING-START-LINE-NO
 13835                ELSE
 13836                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13837                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13838                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13839                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13840                     ELSE
 13841                       MOVE WS-VA-NO-COMM-MESS
 13842                                    TO CN-LINE (N1)
 13843                     END-IF
 13844                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13845                  ELSE
 13846                     PERFORM 1700-SQUEEZE-IT-IN
 13847                                 THRU 1700-EXIT
 13848                  END-IF
 13849                END-IF
 13850              END-IF
 13851            END-IF
 13852            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13853            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13854            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13855
 13856* EXEC CICS REWRITE
 13857*              DATASET    (FILE-ID-ERNOTE)
 13858*              FROM       (CERTIFICATE-NOTE)
 13859*              RESP       (WS-RESPONSE)
 13860*           END-EXEC
 13861     MOVE LENGTH OF
 13862      CERTIFICATE-NOTE
 13863       TO DFHEIV11
 13864*    MOVE '&& L                  %  N#00012690' TO DFHEIV0
 13865     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13866     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13867     MOVE X'204E233030303132363930' TO DFHEIV0(25:11)
 13868     CALL 'kxdfhei1' USING DFHEIV0,
 13869           FILE-ID-ERNOTE,
 13870           CERTIFICATE-NOTE,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 252
* EL6311.cbl
 13871           DFHEIV11,
 13872           DFHEIV99
 13873     MOVE EIBRESP  TO WS-RESPONSE
 13874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13875          END-IF
 13876        END-IF
 13877     ELSE
 13878        MOVE SPACES              TO CERTIFICATE-NOTE
 13879        MOVE 'CN'                TO CN-RECORD-ID
 13880        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13881                                 TO CN-CONTROL-PRIMARY
 13882                                    ERNOTE-KEY
 13883        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13884                                    CN-BILLING-END-LINE-NO
 13885        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13886           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13887        ELSE
 13888           MOVE WS-VA-NO-COMM-MESS
 13889                                 TO CN-LINE (1)
 13890        END-IF
 13891        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13892        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13893        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13894
 13895* EXEC CICS WRITE
 13896*          DATASET    (FILE-ID-ERNOTE)
 13897*          FROM       (CERTIFICATE-NOTE)
 13898*          RIDFLD     (ERNOTE-KEY)
 13899*          RESP       (WS-RESPONSE)
 13900*       END-EXEC
 13901     MOVE LENGTH OF
 13902      CERTIFICATE-NOTE
 13903       TO DFHEIV11
 13904*    MOVE '&$ L                  ''  N#00012714' TO DFHEIV0
 13905     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13906     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13907     MOVE X'204E233030303132373134' TO DFHEIV0(25:11)
 13908     CALL 'kxdfhei1' USING DFHEIV0,
 13909           FILE-ID-ERNOTE,
 13910           CERTIFICATE-NOTE,
 13911           DFHEIV11,
 13912           ERNOTE-KEY,
 13913           DFHEIV99,
 13914           DFHEIV99
 13915     MOVE EIBRESP  TO WS-RESPONSE
 13916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13917     END-IF
 13918     .
 13919 1510-EXIT.
 13920     EXIT.
 13921 1520-UPDATE-ELCERT.
 13922     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13923                                 TO ELCERT-KEY
 13924
 13925* EXEC CICS READ
 13926*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13927*        DATASET (FILE-ID-ELCERT)
 13928*        RIDFLD  (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 253
* EL6311.cbl
 13929*        UPDATE
 13930*        RESP    (WS-RESPONSE)
 13931*    END-EXEC
 13932*    MOVE '&"S        EU         (  N#00012727' TO DFHEIV0
 13933     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13934     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13935     MOVE X'204E233030303132373237' TO DFHEIV0(25:11)
 13936     CALL 'kxdfhei1' USING DFHEIV0,
 13937           FILE-ID-ELCERT,
 13938           DFHEIV20,
 13939           DFHEIV99,
 13940           ELCERT-KEY,
 13941           DFHEIV99,
 13942           DFHEIV99,
 13943           DFHEIV99
 13944     SET ADDRESS OF CERTIFICATE-MASTER TO
 13945         DFHEIV20
 13946     MOVE EIBRESP  TO WS-RESPONSE
 13947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13948     IF RESP-NORMAL
 13949        IF WS-NOTE-SW = 'A'
 13950           IF CM-NOTE-SW = ' '
 13951              MOVE '2'             TO CM-NOTE-SW
 13952           ELSE
 13953             IF CM-NOTE-SW = '1'
 13954                MOVE '3'           TO CM-NOTE-SW
 13955             ELSE
 13956               IF CM-NOTE-SW = '4'
 13957                  MOVE '6'         TO CM-NOTE-SW
 13958               ELSE
 13959                 IF CM-NOTE-SW = '5'
 13960                    MOVE '7'       TO CM-NOTE-SW
 13961                 END-IF
 13962               END-IF
 13963             END-IF
 13964           END-IF
 13965        ELSE
 13966           IF CM-NOTE-SW = '2'
 13967              MOVE ' '             TO CM-NOTE-SW
 13968           ELSE
 13969             IF CM-NOTE-SW = '3'
 13970                MOVE '1'           TO CM-NOTE-SW
 13971             ELSE
 13972               IF CM-NOTE-SW = '6'
 13973                  MOVE '4'         TO CM-NOTE-SW
 13974               ELSE
 13975                 IF CM-NOTE-SW = '7'
 13976                    MOVE '5'       TO CM-NOTE-SW
 13977                 END-IF
 13978               END-IF
 13979             END-IF
 13980           END-IF
 13981        END-IF
 13982
 13983* EXEC CICS REWRITE
 13984*          DATASET    (FILE-ID-ELCERT)
 13985*          FROM       (CERTIFICATE-MASTER)
 13986*          RESP       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 254
* EL6311.cbl
 13987*       END-EXEC
 13988     MOVE LENGTH OF
 13989      CERTIFICATE-MASTER
 13990       TO DFHEIV11
 13991*    MOVE '&& L                  %  N#00012768' TO DFHEIV0
 13992     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13993     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13994     MOVE X'204E233030303132373638' TO DFHEIV0(25:11)
 13995     CALL 'kxdfhei1' USING DFHEIV0,
 13996           FILE-ID-ELCERT,
 13997           CERTIFICATE-MASTER,
 13998           DFHEIV11,
 13999           DFHEIV99
 14000     MOVE EIBRESP  TO WS-RESPONSE
 14001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14002        IF RESP-NORMAL
 14003           CONTINUE
 14004        ELSE
 14005           MOVE WS-RESPONSE TO EMI-ERROR
 14006           PERFORM 9900-ERROR-FORMAT
 14007                                 THRU 9900-EXIT
 14008           GO TO 8200-SEND-DATAONLY
 14009        END-IF
 14010     ELSE
 14011        MOVE -1                  TO BMAINTL
 14012        MOVE 0249                TO EMI-ERROR
 14013        PERFORM 9900-ERROR-FORMAT
 14014                                 THRU 9900-EXIT
 14015        GO TO 8200-SEND-DATAONLY
 14016     END-IF
 14017     .
 14018 1520-EXIT.
 14019     EXIT.
 14020 1600-UPDATE-ERPYAJ.
 14021     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 14022                                 THRU 1610-EXIT
 14023     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 14024                                 THRU 1620-EXIT
 14025     .
 14026 1600-EXIT.
 14027     EXIT.
 14028 1610-ADD-ERPYAJ-BANK-REC.
 14029
 14030* EXEC CICS GETMAIN
 14031*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 14032*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 14033*        INITIMG (GETMAIN-SPACE)
 14034*    END-EXEC
 14035*    MOVE ',"IL                  $   #00012800' TO DFHEIV0
 14036     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14037     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14038     MOVE X'2020233030303132383030' TO DFHEIV0(25:11)
 14039     CALL 'kxdfhei1' USING DFHEIV0,
 14040           DFHEIV20,
 14041           ERPYAJ-RECORD-LENGTH,
 14042           GETMAIN-SPACE
 14043     SET ADDRESS OF PENDING-PAY-ADJ TO
 14044         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 255
* EL6311.cbl
 14045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14046     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14047     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14048     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14049     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14050     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14051     MOVE +10                    TO ERPYAJ-SEQ-NO
 14052     MOVE 'R'                    TO ERPYAJ-TYPE
 14053     IF REVERSAL
 14054        MOVE 'C'                 TO ERPYAJ-TYPE
 14055     END-IF
 14056     MOVE SPACES                 TO PENDING-PAY-ADJ
 14057     MOVE 'PY'                   TO PY-RECORD-ID
 14058     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14059     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 14060     IF REVERSAL
 14061        MOVE PB-I-DCC-OVER-CHG-AMT
 14062                                 TO PY-ENTRY-AMT
 14063     END-IF
 14064     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 14065                                    PY-INPUT-DT
 14066*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 14067*                                   PY-INPUT-DT
 14068     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 14069     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 14070     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 14071     MOVE 'B'                    TO PY-ERCOMP-TYPE
 14072     IF PB-CARRIER = '2'
 14073        MOVE '2725040330'        TO PY-GL-ACCOUNT
 14074     ELSE
 14075        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14076     END-IF
 14077     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 14078                                    PY-BILLED-DATE
 14079                                    PY-AR-DATE
 14080                                    PY-REPORTED-DT
 14081                                    PY-CHECK-WRITTEN-DT
 14082     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 14083                                    PY-CHECK-QUE-SEQUENCE
 14084     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 14085     PERFORM WITH TEST AFTER
 14086        UNTIL (NOT RESP-DUPKEY)
 14087           AND (NOT RESP-DUPREC)
 14088
 14089* EXEC CICS WRITE
 14090*          DATASET    (FILE-ID-ERPYAJ)
 14091*          FROM       (PENDING-PAY-ADJ)
 14092*          RIDFLD     (ERPYAJ-KEY)
 14093*          RESP       (WS-RESPONSE)
 14094*       END-EXEC
 14095     MOVE LENGTH OF
 14096      PENDING-PAY-ADJ
 14097       TO DFHEIV11
 14098*    MOVE '&$ L                  ''  N#00012847' TO DFHEIV0
 14099     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14100     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14101     MOVE X'204E233030303132383437' TO DFHEIV0(25:11)
 14102     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 256
* EL6311.cbl
 14103           FILE-ID-ERPYAJ,
 14104           PENDING-PAY-ADJ,
 14105           DFHEIV11,
 14106           ERPYAJ-KEY,
 14107           DFHEIV99,
 14108           DFHEIV99
 14109     MOVE EIBRESP  TO WS-RESPONSE
 14110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14111        IF RESP-DUPKEY OR RESP-DUPREC
 14112           ADD +1                TO ERPYAJ-SEQ-NO
 14113           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14114        END-IF
 14115     END-PERFORM
 14116     .
 14117 1610-EXIT.
 14118     EXIT.
 14119 1620-ADD-ERPYAJ-DLR-REC.
 14120     MOVE 'C'                    TO ERPYAJ-TYPE
 14121     IF REVERSAL
 14122        MOVE 'R'                 TO ERPYAJ-TYPE
 14123     END-IF
 14124     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14125                                    ERPYAJ-ACCOUNT
 14126     ADD +1                      TO ERPYAJ-SEQ-NO
 14127     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14128     MOVE 'A'                    TO PY-ERCOMP-TYPE
 14129     IF PB-CARRIER = '2'
 14130        MOVE '2725040330'        TO PY-GL-ACCOUNT
 14131     ELSE
 14132        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14133     END-IF
 14134     PERFORM WITH TEST AFTER
 14135        UNTIL (NOT RESP-DUPKEY)
 14136           AND (NOT RESP-DUPREC)
 14137
 14138* EXEC CICS WRITE
 14139*          DATASET    (FILE-ID-ERPYAJ)
 14140*          FROM       (PENDING-PAY-ADJ)
 14141*          RIDFLD     (ERPYAJ-KEY)
 14142*          RESP       (WS-RESPONSE)
 14143*       END-EXEC
 14144     MOVE LENGTH OF
 14145      PENDING-PAY-ADJ
 14146       TO DFHEIV11
 14147*    MOVE '&$ L                  ''  N#00012879' TO DFHEIV0
 14148     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14149     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14150     MOVE X'204E233030303132383739' TO DFHEIV0(25:11)
 14151     CALL 'kxdfhei1' USING DFHEIV0,
 14152           FILE-ID-ERPYAJ,
 14153           PENDING-PAY-ADJ,
 14154           DFHEIV11,
 14155           ERPYAJ-KEY,
 14156           DFHEIV99,
 14157           DFHEIV99
 14158     MOVE EIBRESP  TO WS-RESPONSE
 14159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14160        IF RESP-DUPKEY OR RESP-DUPREC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 257
* EL6311.cbl
 14161           ADD +1                TO ERPYAJ-SEQ-NO
 14162           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14163        END-IF
 14164     END-PERFORM
 14165     .
 14166 1620-EXIT.
 14167     EXIT.
 14168 1700-SQUEEZE-IT-IN.
 14169     IF (N1 > CN-BILLING-END-LINE-NO)
 14170        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 14171           N1 = +1
 14172           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 14173           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 14174              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14175                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 14176              ELSE
 14177                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 14178              END-IF
 14179              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 14180              MOVE +2 TO N1
 14181           END-IF
 14182        END-PERFORM
 14183     ELSE
 14184        IF (N1 < CN-BILLING-START-LINE-NO)
 14185           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 14186              N1 = +10
 14187              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 14188              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 14189                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14190                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 14191                 ELSE
 14192                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 14193                 END-IF
 14194                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 14195                 MOVE +9 TO N1
 14196              END-IF
 14197           END-PERFORM
 14198        END-IF
 14199     END-IF
 14200     .
 14201 1700-EXIT.
 14202     EXIT.
 14203 1800-REMOVE-CERT-NOTES.
 14204     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14205                                 TO ERNOTE-KEY
 14206
 14207* EXEC CICS READ
 14208*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 14209*       DATASET    (FILE-ID-ERNOTE)
 14210*       RIDFLD     (ERNOTE-KEY)
 14211*       RESP       (WS-RESPONSE)
 14212*       UPDATE
 14213*    END-EXEC
 14214*    MOVE '&"S        EU         (  N#00012931' TO DFHEIV0
 14215     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14216     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14217     MOVE X'204E233030303132393331' TO DFHEIV0(25:11)
 14218     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 258
* EL6311.cbl
 14219           FILE-ID-ERNOTE,
 14220           DFHEIV20,
 14221           DFHEIV99,
 14222           ERNOTE-KEY,
 14223           DFHEIV99,
 14224           DFHEIV99,
 14225           DFHEIV99
 14226     SET ADDRESS OF CERTIFICATE-NOTE TO
 14227         DFHEIV20
 14228     MOVE EIBRESP  TO WS-RESPONSE
 14229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14230     IF RESP-NORMAL
 14231        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 14232           (N1 > +10)
 14233           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 14234           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 14235        END-PERFORM
 14236        IF N1 < +11
 14237           MOVE SPACES              TO CN-LINE (N1)
 14238           IF N1 >= CN-BILLING-START-LINE-NO  AND
 14239              N1 <= CN-BILLING-END-LINE-NO
 14240              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 14241              IF CN-BILLING-END-LINE-NO <
 14242                               CN-BILLING-START-LINE-NO
 14243                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 14244                                     CN-BILLING-START-LINE-NO
 14245              END-IF
 14246              PERFORM 1820-SQUEEZE-ERNOTE
 14247                                  THRU 1820-EXIT
 14248           END-IF
 14249           IF CN-LINES = SPACES
 14250
 14251* EXEC CICS DELETE
 14252*                DATASET    (FILE-ID-ERNOTE)
 14253*                RESP       (WS-RESPONSE)
 14254*             END-EXEC
 14255*    MOVE '&(                    &  N#00012958' TO DFHEIV0
 14256     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14257     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14258     MOVE X'204E233030303132393538' TO DFHEIV0(25:11)
 14259     CALL 'kxdfhei1' USING DFHEIV0,
 14260           FILE-ID-ERNOTE,
 14261           DFHEIV99,
 14262           DFHEIV99,
 14263           DFHEIV99,
 14264           DFHEIV99
 14265     MOVE EIBRESP  TO WS-RESPONSE
 14266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14267              IF RESP-NORMAL
 14268                 MOVE 'D'        TO WS-NOTE-SW
 14269                 PERFORM 1520-UPDATE-ELCERT
 14270                                 THRU 1520-EXIT
 14271              END-IF
 14272           ELSE
 14273
 14274* EXEC CICS REWRITE
 14275*                DATASET    (FILE-ID-ERNOTE)
 14276*                FROM       (CERTIFICATE-NOTE)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 259
* EL6311.cbl
 14277*                RESP       (WS-RESPONSE)
 14278*             END-EXEC
 14279     MOVE LENGTH OF
 14280      CERTIFICATE-NOTE
 14281       TO DFHEIV11
 14282*    MOVE '&& L                  %  N#00012968' TO DFHEIV0
 14283     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14284     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14285     MOVE X'204E233030303132393638' TO DFHEIV0(25:11)
 14286     CALL 'kxdfhei1' USING DFHEIV0,
 14287           FILE-ID-ERNOTE,
 14288           CERTIFICATE-NOTE,
 14289           DFHEIV11,
 14290           DFHEIV99
 14291     MOVE EIBRESP  TO WS-RESPONSE
 14292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14293           END-IF
 14294        END-IF
 14295     END-IF
 14296     .
 14297 1800-EXIT.
 14298     EXIT.
 14299 1820-SQUEEZE-ERNOTE.
 14300     MOVE CN-BILLING-START-LINE-NO TO N2
 14301     IF N2 = 0
 14302         MOVE +1                 TO N2
 14303     END-IF
 14304     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 14305        (N1 > +9)
 14306        IF CN-LINE (N1) = SPACES
 14307           MOVE CN-LINE (N1 + +1)
 14308                                 TO CN-LINE (N1)
 14309           MOVE SPACES           TO CN-LINE (N1 + +1)
 14310        END-IF
 14311     END-PERFORM
 14312     .
 14313 1820-EXIT.
 14314     EXIT.
 14315 1900-DELETE-ERPYAJ.
 14316     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14317     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14318     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14319     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14320     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14321     MOVE +10                    TO ERPYAJ-SEQ-NO
 14322     MOVE 'R'                    TO ERPYAJ-TYPE
 14323     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14324
 14325* EXEC CICS STARTBR
 14326*       DATASET    (FILE-ID-ERPYAJ)
 14327*       RIDFLD     (ERPYAJ-KEY)
 14328*       RESP       (WS-RESPONSE)
 14329*    END-EXEC
 14330     MOVE 0
 14331       TO DFHEIV11
 14332*    MOVE '&,         G          &  N#00013004' TO DFHEIV0
 14333     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14334     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 260
* EL6311.cbl
 14335     MOVE X'204E233030303133303034' TO DFHEIV0(25:11)
 14336     CALL 'kxdfhei1' USING DFHEIV0,
 14337           FILE-ID-ERPYAJ,
 14338           ERPYAJ-KEY,
 14339           DFHEIV99,
 14340           DFHEIV11,
 14341           DFHEIV99
 14342     MOVE EIBRESP  TO WS-RESPONSE
 14343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14344     IF RESP-NORMAL
 14345        CONTINUE
 14346     ELSE
 14347        GO TO 1900-GET-DEALER
 14348     END-IF
 14349     .
 14350 1900-READNEXT-ERPYAJ-B.
 14351*  GET THE BANK ERPYAJ RECORD
 14352
 14353* EXEC CICS READNEXT
 14354*       DATASET    (FILE-ID-ERPYAJ)
 14355*       RIDFLD     (ERPYAJ-KEY)
 14356*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14357*       RESP       (WS-RESPONSE)
 14358*    END-EXEC
 14359     MOVE 0
 14360       TO DFHEIV11
 14361*    MOVE '&.S                   )  N#00013017' TO DFHEIV0
 14362     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14363     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14364     MOVE X'204E233030303133303137' TO DFHEIV0(25:11)
 14365     CALL 'kxdfhei1' USING DFHEIV0,
 14366           FILE-ID-ERPYAJ,
 14367           DFHEIV20,
 14368           DFHEIV99,
 14369           ERPYAJ-KEY,
 14370           DFHEIV99,
 14371           DFHEIV11,
 14372           DFHEIV99,
 14373           DFHEIV99
 14374     SET ADDRESS OF PENDING-PAY-ADJ TO
 14375         DFHEIV20
 14376     MOVE EIBRESP  TO WS-RESPONSE
 14377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14378     IF RESP-NORMAL
 14379        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14380           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14381              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14382                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14383
 14384* EXEC CICS READ
 14385*                   DATASET    (FILE-ID-ERPYAJ)
 14386*                   RIDFLD     (ERPYAJ-KEY)
 14387*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14388*                   RESP       (WS-RESPONSE)
 14389*                   UPDATE
 14390*                END-EXEC
 14391*    MOVE '&"S        EU         (  N#00013028' TO DFHEIV0
 14392     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 261
* EL6311.cbl
 14393     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14394     MOVE X'204E233030303133303238' TO DFHEIV0(25:11)
 14395     CALL 'kxdfhei1' USING DFHEIV0,
 14396           FILE-ID-ERPYAJ,
 14397           DFHEIV20,
 14398           DFHEIV99,
 14399           ERPYAJ-KEY,
 14400           DFHEIV99,
 14401           DFHEIV99,
 14402           DFHEIV99
 14403     SET ADDRESS OF PENDING-PAY-ADJ TO
 14404         DFHEIV20
 14405     MOVE EIBRESP  TO WS-RESPONSE
 14406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14407                 IF RESP-NORMAL
 14408
 14409* EXEC CICS DELETE
 14410*                      DATASET   (FILE-ID-ERPYAJ)
 14411*                      RESP      (WS-RESPONSE)
 14412*                   END-EXEC
 14413*    MOVE '&(                    &  N#00013036' TO DFHEIV0
 14414     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14415     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14416     MOVE X'204E233030303133303336' TO DFHEIV0(25:11)
 14417     CALL 'kxdfhei1' USING DFHEIV0,
 14418           FILE-ID-ERPYAJ,
 14419           DFHEIV99,
 14420           DFHEIV99,
 14421           DFHEIV99,
 14422           DFHEIV99
 14423     MOVE EIBRESP  TO WS-RESPONSE
 14424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14425                 END-IF
 14426              ELSE
 14427                 SET REVERSAL    TO TRUE
 14428                 PERFORM 1600-UPDATE-ERPYAJ
 14429                                 THRU 1600-EXIT
 14430                 GO TO 1900-EXIT
 14431              END-IF
 14432           ELSE
 14433              GO TO 1900-READNEXT-ERPYAJ-B
 14434           END-IF
 14435        END-IF
 14436
 14437* EXEC CICS ENDBR
 14438*          DATASET   (FILE-ID-ERPYAJ)
 14439*       END-EXEC
 14440     MOVE 0
 14441       TO DFHEIV11
 14442*    MOVE '&2                    $   #00013051' TO DFHEIV0
 14443     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14444     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14445     MOVE X'2020233030303133303531' TO DFHEIV0(25:11)
 14446     CALL 'kxdfhei1' USING DFHEIV0,
 14447           FILE-ID-ERPYAJ,
 14448           DFHEIV11,
 14449           DFHEIV99
 14450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 262
* EL6311.cbl
 14451     END-IF
 14452     .
 14453 1900-GET-DEALER.
 14454     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14455     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14456     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14457     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14458     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14459     MOVE +10                    TO ERPYAJ-SEQ-NO
 14460     MOVE 'C'                    TO ERPYAJ-TYPE
 14461     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14462
 14463* EXEC CICS STARTBR
 14464*       DATASET    (FILE-ID-ERPYAJ)
 14465*       RIDFLD     (ERPYAJ-KEY)
 14466*       RESP       (WS-RESPONSE)
 14467*    END-EXEC
 14468     MOVE 0
 14469       TO DFHEIV11
 14470*    MOVE '&,         G          &  N#00013065' TO DFHEIV0
 14471     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14472     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14473     MOVE X'204E233030303133303635' TO DFHEIV0(25:11)
 14474     CALL 'kxdfhei1' USING DFHEIV0,
 14475           FILE-ID-ERPYAJ,
 14476           ERPYAJ-KEY,
 14477           DFHEIV99,
 14478           DFHEIV11,
 14479           DFHEIV99
 14480     MOVE EIBRESP  TO WS-RESPONSE
 14481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14482     IF RESP-NORMAL
 14483        CONTINUE
 14484     ELSE
 14485        GO TO 1900-EXIT
 14486     END-IF
 14487     .
 14488 1900-READNEXT-ERPYAJ-D.
 14489*  GET THE DEALER ERPYAJ RECORD
 14490
 14491* EXEC CICS READNEXT
 14492*       DATASET    (FILE-ID-ERPYAJ)
 14493*       RIDFLD     (ERPYAJ-KEY)
 14494*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14495*       RESP       (WS-RESPONSE)
 14496*    END-EXEC
 14497     MOVE 0
 14498       TO DFHEIV11
 14499*    MOVE '&.S                   )  N#00013078' TO DFHEIV0
 14500     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14501     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14502     MOVE X'204E233030303133303738' TO DFHEIV0(25:11)
 14503     CALL 'kxdfhei1' USING DFHEIV0,
 14504           FILE-ID-ERPYAJ,
 14505           DFHEIV20,
 14506           DFHEIV99,
 14507           ERPYAJ-KEY,
 14508           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 263
* EL6311.cbl
 14509           DFHEIV11,
 14510           DFHEIV99,
 14511           DFHEIV99
 14512     SET ADDRESS OF PENDING-PAY-ADJ TO
 14513         DFHEIV20
 14514     MOVE EIBRESP  TO WS-RESPONSE
 14515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14516     IF RESP-NORMAL
 14517        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14518           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14519              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14520                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14521
 14522* EXEC CICS READ
 14523*                   DATASET    (FILE-ID-ERPYAJ)
 14524*                   RIDFLD     (ERPYAJ-KEY)
 14525*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14526*                   RESP       (WS-RESPONSE)
 14527*                   UPDATE
 14528*                END-EXEC
 14529*    MOVE '&"S        EU         (  N#00013089' TO DFHEIV0
 14530     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14531     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14532     MOVE X'204E233030303133303839' TO DFHEIV0(25:11)
 14533     CALL 'kxdfhei1' USING DFHEIV0,
 14534           FILE-ID-ERPYAJ,
 14535           DFHEIV20,
 14536           DFHEIV99,
 14537           ERPYAJ-KEY,
 14538           DFHEIV99,
 14539           DFHEIV99,
 14540           DFHEIV99
 14541     SET ADDRESS OF PENDING-PAY-ADJ TO
 14542         DFHEIV20
 14543     MOVE EIBRESP  TO WS-RESPONSE
 14544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14545                 IF RESP-NORMAL
 14546
 14547* EXEC CICS DELETE
 14548*                      DATASET   (FILE-ID-ERPYAJ)
 14549*                      RESP      (WS-RESPONSE)
 14550*                   END-EXEC
 14551*    MOVE '&(                    &  N#00013097' TO DFHEIV0
 14552     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14553     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14554     MOVE X'204E233030303133303937' TO DFHEIV0(25:11)
 14555     CALL 'kxdfhei1' USING DFHEIV0,
 14556           FILE-ID-ERPYAJ,
 14557           DFHEIV99,
 14558           DFHEIV99,
 14559           DFHEIV99,
 14560           DFHEIV99
 14561     MOVE EIBRESP  TO WS-RESPONSE
 14562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14563                 END-IF
 14564              ELSE
 14565                 SET REVERSAL    TO TRUE
 14566              END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 264
* EL6311.cbl
 14567           ELSE
 14568              GO TO 1900-READNEXT-ERPYAJ-D
 14569           END-IF
 14570        END-IF
 14571
 14572* EXEC CICS ENDBR
 14573*          DATASET   (FILE-ID-ERPYAJ)
 14574*       END-EXEC
 14575     MOVE 0
 14576       TO DFHEIV11
 14577*    MOVE '&2                    $   #00013109' TO DFHEIV0
 14578     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14579     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14580     MOVE X'2020233030303133313039' TO DFHEIV0(25:11)
 14581     CALL 'kxdfhei1' USING DFHEIV0,
 14582           FILE-ID-ERPYAJ,
 14583           DFHEIV11,
 14584           DFHEIV99
 14585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14586     END-IF
 14587     .
 14588 1900-EXIT.
 14589     EXIT.
 14590******************************************************************
 14591*            C A N C E L   M A I N L I N E                       *
 14592******************************************************************
 14593
 14594 2000-CANCEL-MAINLINE.
 14595     IF PI-DISPLAY-ORIGINAL-BATCH
 14596        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14597           MOVE ER-0023             TO EMI-ERROR
 14598           MOVE -1                  TO CMAINTL
 14599           MOVE AL-UABON            TO CMAINTA
 14600           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14601           GO TO 8200-SEND-DATAONLY
 14602        ELSE
 14603           NEXT SENTENCE
 14604     ELSE
 14605        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14606           MOVE ER-0023             TO EMI-ERROR
 14607           MOVE -1                  TO CMAINTL
 14608           MOVE AL-UABON            TO CMAINTA
 14609           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14610           GO TO 8200-SEND-DATAONLY.
 14611
 14612     IF CMAINTI = 'S'
 14613        GO TO 2100-SHOW-REQUEST.
 14614
 14615     IF NOT MODIFY-CAP
 14616         MOVE 'UPDATE'       TO SM-READ
 14617         PERFORM 9995-SECURITY-VIOLATION
 14618         MOVE ER-0070        TO EMI-ERROR
 14619         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14620         GO TO 8100-SEND-INITIAL-MAP.
 14621
 14622     IF CMAINTL GREATER THAN ZEROS
 14623        IF PI-PF6-FUNCTION
 14624           IF CMAINTI NOT = 'A'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 265
* EL6311.cbl
 14625              MOVE AL-UABON  TO CMAINTA
 14626              MOVE -1        TO CMAINTL
 14627              MOVE ER-2260   TO EMI-ERROR
 14628              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14629              GO TO 8200-SEND-DATAONLY.
 14630
 14631     IF CCERTNOL = ZEROS
 14632       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14633         NEXT SENTENCE
 14634     ELSE
 14635         IF CCERTNOL NOT = ZEROS
 14636             MOVE AL-UANON       TO CCERTNOA
 14637         ELSE
 14638             MOVE -1             TO CCERTNOL
 14639             MOVE  1             TO SET-CURSOR-SW
 14640             MOVE ER-2218       TO EMI-ERROR
 14641             MOVE AL-UABON       TO CCERTNOA
 14642             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14643
 14644     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14645        NEXT SENTENCE
 14646     ELSE
 14647        IF CEFFDTL NOT = ZEROS
 14648           MOVE AL-UNNON         TO CEFFDTA
 14649           MOVE CEFFDTI TO DEEDIT-FIELD
 14650           PERFORM 8600-DEEDIT
 14651           MOVE 4                TO DC-OPTION-CODE
 14652           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14653           PERFORM 9700-DATE-LINK
 14654           IF NO-CONVERSION-ERROR
 14655              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14656              ELSE
 14657              MOVE -1            TO CEFFDTL
 14658              MOVE  1            TO SET-CURSOR-SW
 14659              MOVE ER-2226      TO EMI-ERROR
 14660              MOVE AL-UNBON      TO CEFFDTA
 14661              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14662          ELSE
 14663          MOVE -1                 TO CEFFDTL
 14664          MOVE  1                 TO SET-CURSOR-SW
 14665          MOVE ER-2220            TO EMI-ERROR
 14666          MOVE AL-UNBON           TO CEFFDTA
 14667          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14668
 14669     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14670
 14671     IF CCERTNOL NOT = ZEROS
 14672        MOVE CCERTNOI                TO WS-NEW-PRIME
 14673     ELSE
 14674        MOVE SPACES                  TO WS-NEW-PRIME.
 14675
 14676     IF CSUFIXL NOT = ZEROS
 14677        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14678     ELSE
 14679        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14680
 14681     IF CEFFDTL NOT = ZEROS
 14682        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 266
* EL6311.cbl
 14683     ELSE
 14684        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14685
 14686     IF CMAINTI = 'A' OR 'K' OR 'S'
 14687        NEXT SENTENCE
 14688     ELSE
 14689        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14690        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14691           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14692           WS-PB-RECORD-TYPE NOT = '2'
 14693           IF CMAINTI = 'C'
 14694              MOVE ER-2287          TO EMI-ERROR
 14695              MOVE -1               TO CCERTNOL
 14696              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14697              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14698              GO TO 8200-SEND-DATAONLY
 14699             ELSE
 14700              MOVE ER-2260          TO EMI-ERROR
 14701              MOVE -1               TO CCERTNOL
 14702              MOVE AL-UABON         TO CCERTNOA
 14703              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14704              GO TO 8200-SEND-DATAONLY.
 14705
 14706     IF CMAINTI = 'D'
 14707        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14708
 14709     IF CLSTNML GREATER THAN ZEROS
 14710         MOVE AL-UANON           TO CLSTNMA.
 14711
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 267
* EL6311.cbl
 14713
 14714******************************************************************
 14715*                                                                *
 14716*           E D I T   C A N C E L   C O V E R A G E S            *
 14717*                                                                *
 14718******************************************************************
 14719
 14720 2015-EDIT-COVERAGES.
 14721     IF CCANDT1L      GREATER THAN ZEROS OR
 14722        CREFND1L      GREATER THAN ZEROS OR
 14723        CCANDT2L      GREATER THAN ZEROS OR
 14724        CREFND2L      GREATER THAN ZEROS OR
 14725        CMTHD1L       GREATER THAN ZEROS OR
 14726        CMTHD2L       GREATER THAN ZEROS OR
 14727        CLIVESL       GREATER THAN ZEROS OR
 14728        CPAYEEL       GREATER THAN ZEROS OR
 14729        CFORCEL       GREATER THAN ZEROS OR
 14730        CBILCDL       GREATER THAN ZEROS OR
 14731        CCANREAL      GREATER THAN ZEROS
 14732            NEXT SENTENCE
 14733         ELSE
 14734            GO TO 2030-EDIT-COMPLETE.
 14735
 14736     IF CCANDT1L = ZEROS
 14737        AND (CMAINTI = 'C' OR 'K')
 14738        NEXT SENTENCE
 14739     ELSE
 14740        IF CCANDT1L      GREATER THAN ZEROS
 14741            MOVE AL-UNNON            TO CCANDT1A
 14742            IF CCANDT1I = SPACES
 14743               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14744            ELSE
 14745               MOVE CCANDT1I            TO DEEDIT-FIELD
 14746               PERFORM 8600-DEEDIT
 14747               IF DEEDIT-FIELD-V0   NUMERIC
 14748                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14749                  MOVE 4                TO DC-OPTION-CODE
 14750                  PERFORM 9700-DATE-LINK
 14751                  IF NO-CONVERSION-ERROR
 14752                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14753                  ELSE
 14754                      MOVE -1        TO CCANDT1L
 14755                      MOVE ER-2227   TO EMI-ERROR
 14756                      MOVE AL-UNBON  TO CCANDT1A
 14757                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14758               ELSE
 14759                  MOVE -1         TO CCANDT1L
 14760                  MOVE ER-2223    TO EMI-ERROR
 14761                  MOVE AL-UNBON   TO CCANDT1A
 14762                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14763        ELSE
 14764            IF CREFND1L GREATER THAN ZEROS
 14765               MOVE -1             TO CCANDT1L
 14766               MOVE ER-2222        TO EMI-ERROR
 14767               MOVE AL-UNBOF       TO CCANDT1A
 14768               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14769
 14770     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 268
* EL6311.cbl
 14771        AND (CMAINTI = 'C' OR 'K')
 14772         NEXT SENTENCE
 14773     ELSE
 14774         IF CREFND1L NOT = ZEROS
 14775            MOVE AL-UNNON        TO CREFND1A
 14776
 14777* EXEC CICS BIF DEEDIT
 14778*               FIELD  (CREFND1I)
 14779*               LENGTH (11)
 14780*           END-EXEC
 14781     MOVE 11
 14782       TO DFHEIV11
 14783*    MOVE '@"L                   #   #00013302' TO DFHEIV0
 14784     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14785     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14786     MOVE X'2020233030303133333032' TO DFHEIV0(25:11)
 14787     CALL 'kxdfhei1' USING DFHEIV0,
 14788           CREFND1I,
 14789           DFHEIV11
 14790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14791            MOVE CREFND1I        TO WS-CREFND1
 14792*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14793*           PERFORM 8600-DEEDIT
 14794*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14795            IF WS-CREFND1  = ZEROS
 14796               AND CMAINTI = 'A'
 14797             MOVE ER-2437        TO EMI-ERROR
 14798             MOVE -1             TO CREFND1L
 14799             MOVE AL-UNBON       TO CREFND1A
 14800             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14801
 14802     IF CCANREAL > +0
 14803        MOVE AL-UANON            TO CCANREAA
 14804        IF CCANREAI = 'R' OR ' '
 14805           CONTINUE
 14806        ELSE
 14807           MOVE ER-9841        TO EMI-ERROR
 14808           MOVE -1             TO CCANREAL
 14809           MOVE AL-UABON       TO CCANREAA
 14810           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14811        END-IF
 14812     END-IF
 14813     IF CMTHD1L EQUAL +0
 14814        NEXT SENTENCE
 14815     ELSE
 14816        IF CMTHD1L NOT = +0
 14817           MOVE AL-UNNON        TO CMTHD1A
 14818           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14819                         OR '5' OR '6' OR '8' OR '9'
 14820                         OR 'R' OR ' '
 14821              NEXT SENTENCE
 14822           ELSE
 14823              MOVE ER-0582        TO EMI-ERROR
 14824              MOVE -1             TO CMTHD1L
 14825              MOVE AL-UNBON       TO CMTHD1A
 14826              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14827
 14828     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 269
* EL6311.cbl
 14829        AND (CMAINTI = 'C' OR 'K')
 14830         NEXT SENTENCE
 14831     ELSE
 14832         IF CCANDT2L  GREATER THAN ZEROS
 14833             MOVE AL-UNNON       TO CCANDT2A
 14834             IF CCANDT2I = SPACES
 14835                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14836             ELSE
 14837                MOVE CCANDT2I       TO DEEDIT-FIELD
 14838                PERFORM 8600-DEEDIT
 14839                IF DEEDIT-FIELD-V0   NUMERIC
 14840                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14841                   MOVE 4                TO DC-OPTION-CODE
 14842                   PERFORM 9700-DATE-LINK
 14843                   IF NO-CONVERSION-ERROR
 14844                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14845                   ELSE
 14846                      MOVE -1       TO CCANDT2L
 14847                      MOVE ER-2227  TO EMI-ERROR
 14848                      MOVE AL-UNBON TO CCANDT2A
 14849                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14850                ELSE
 14851                   MOVE -1         TO CCANDT2L
 14852                   MOVE ER-2223    TO EMI-ERROR
 14853                   MOVE AL-UNBON   TO CCANDT2A
 14854                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14855         ELSE
 14856            IF CREFND2L GREATER THAN ZEROS
 14857               MOVE -1             TO CCANDT2L
 14858               MOVE ER-2222        TO EMI-ERROR
 14859               MOVE AL-UNBOF       TO CCANDT2A
 14860               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14861
 14862     IF CREFND2L = ZEROS
 14863        AND (CMAINTI = 'C' OR 'K')
 14864         NEXT SENTENCE
 14865     ELSE
 14866         IF CREFND2L NOT = ZEROS
 14867            MOVE AL-UNNON        TO CREFND2A
 14868
 14869* EXEC CICS BIF DEEDIT
 14870*               FIELD  (CREFND2I)
 14871*               LENGTH (11)
 14872*           END-EXEC
 14873     MOVE 11
 14874       TO DFHEIV11
 14875*    MOVE '@"L                   #   #00013383' TO DFHEIV0
 14876     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14877     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14878     MOVE X'2020233030303133333833' TO DFHEIV0(25:11)
 14879     CALL 'kxdfhei1' USING DFHEIV0,
 14880           CREFND2I,
 14881           DFHEIV11
 14882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14883            MOVE CREFND2I        TO WS-CREFND2
 14884*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14885*           PERFORM 8600-DEEDIT
 14886*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 270
* EL6311.cbl
 14887            IF WS-CREFND2  = ZEROS
 14888               AND CMAINTI = 'A'
 14889             MOVE ER-2437        TO EMI-ERROR
 14890             MOVE -1             TO CREFND2L
 14891             MOVE AL-UNBON       TO CREFND2A
 14892             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14893
 14894     IF CMTHD2L EQUAL +0
 14895        NEXT SENTENCE
 14896     ELSE
 14897        IF CMTHD2L NOT = +0
 14898           MOVE AL-UNNON        TO CMTHD2A
 14899           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14900                         OR '5' OR '6' OR '8' OR '9'
 14901                         OR ' ' OR 'R'
 14902              NEXT SENTENCE
 14903           ELSE
 14904              MOVE ER-0582        TO EMI-ERROR
 14905              MOVE -1             TO CMTHD2L
 14906              MOVE AL-UNBON       TO CMTHD2A
 14907              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14908
 14909     IF CLIVESL GREATER THAN ZEROS
 14910         MOVE CLIVESI            TO DEEDIT-FIELD
 14911         PERFORM 8600-DEEDIT
 14912         IF DEEDIT-FIELD-V0 NUMERIC
 14913             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14914             MOVE AL-UNNON       TO CLIVESA
 14915         ELSE
 14916             MOVE -1             TO CLIVESL
 14917             MOVE AL-UNBON       TO CLIVESA
 14918             MOVE ER-2223        TO EMI-ERROR
 14919             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14920
 14921     IF CFORCEL  NOT = ZEROS
 14922         IF FORCE-CAP
 14923            MOVE AL-UANON            TO CFORCEA
 14924         ELSE
 14925            MOVE ER-2945             TO EMI-ERROR
 14926            MOVE AL-UABON            TO CFORCEA
 14927            MOVE -1                  TO CFORCEL
 14928            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14929
 14930     IF CPAYEEL GREATER THAN ZEROS
 14931        MOVE AL-UANON            TO CPAYEEA.
 14932
 14933     IF CBILCDL NOT = ZEROS
 14934        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14935                             AND 'A' AND 'B' AND 'E'
 14936           MOVE ER-2225              TO EMI-ERROR
 14937           MOVE AL-UABON             TO CBILCDA
 14938           MOVE -1                   TO CBILCDL
 14939           MOVE  1                   TO SET-CURSOR-SW
 14940           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14941        ELSE
 14942           MOVE AL-UANON             TO CBILCDA.
 14943
 14944 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 271
* EL6311.cbl
 14945     IF EMI-ERROR = ZEROS
 14946         NEXT SENTENCE
 14947     ELSE
 14948         GO TO 8200-SEND-DATAONLY.
 14949
 14950     IF CMAINTI = 'A'
 14951        GO TO 2200-ADD-CANCEL-ROUTINE.
 14952
 14953     IF CMAINTI = 'C'
 14954        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14955
 14956     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14957
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 272
* EL6311.cbl
 14959
 14960******************************************************************
 14961*                                                                *
 14962*                   S H O W   C A N C E L                        *
 14963*                                                                *
 14964******************************************************************
 14965
 14966 2100-SHOW-REQUEST.
 14967     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14968
 14969     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14970        MOVE -1                  TO CMAINTL
 14971        GO TO 8200-SEND-DATAONLY.
 14972
 14973     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14974
 14975     IF CSUFIXL NOT = ZEROS
 14976        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14977       ELSE
 14978        MOVE SPACE            TO WS-NEW-SUFFIX.
 14979
 14980     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14981     PERFORM 8600-DEEDIT.
 14982     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14983     MOVE '4'                    TO DC-OPTION-CODE.
 14984     PERFORM 9700-DATE-LINK.
 14985     IF DATE-CONVERSION-ERROR
 14986        MOVE ER-0348             TO EMI-ERROR
 14987        MOVE -1                  TO CEFFDTL
 14988        MOVE AL-UABON            TO CEFFDTA
 14989        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14990        GO TO 8200-SEND-DATAONLY
 14991     ELSE
 14992        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14993        MOVE AL-UANON            TO CEFFDTA
 14994        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14995
 14996     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14997
 14998     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14999        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 15000        MOVE 'Y'                    TO WS-SHOW-SW
 15001        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 15002           GO TO 4100-BROWSE-PRIMARY-FORWARD
 15003        ELSE
 15004           IF PI-FILE-BROWSE
 15005              GO TO 4300-BROWSE-FILE-FORWARD
 15006           ELSE
 15007              IF PI-CSR-BROWSE
 15008                 GO TO 4200-BROWSE-CSR-FORWARD
 15009              ELSE
 15010                 GO TO 4000-BROWSE-DETAIL-FORWARD
 15011     ELSE
 15012        GO TO 3900-RE-DISPLAY-RECORD.
 15013
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 273
* EL6311.cbl
 15015
 15016
 15017******************************************************************
 15018*                                                                *
 15019*            A D D   C A N C E L   R O U T I N E                 *
 15020*                                                                *
 15021******************************************************************
 15022
 15023 2200-ADD-CANCEL-ROUTINE.
 15024     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 15025
 15026
 15027* EXEC CICS GETMAIN
 15028*        SET     (ADDRESS OF PENDING-BUSINESS)
 15029*        LENGTH  (ERPNDB-RECORD-LENGTH)
 15030*    END-EXEC.
 15031*    MOVE '," L                  $   #00013530' TO DFHEIV0
 15032     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 15033     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15034     MOVE X'2020233030303133353330' TO DFHEIV0(25:11)
 15035     CALL 'kxdfhei1' USING DFHEIV0,
 15036           DFHEIV20,
 15037           ERPNDB-RECORD-LENGTH,
 15038           DFHEIV99
 15039     SET ADDRESS OF PENDING-BUSINESS TO
 15040         DFHEIV20
 15041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15042
 15043
 15044
 15045* EXEC CICS HANDLE CONDITION
 15046*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 15047*    END-EXEC.
 15048*    MOVE '"$I                   ! 3 #00013535' TO DFHEIV0
 15049     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15050     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15051     MOVE X'3320233030303133353335' TO DFHEIV0(25:11)
 15052     CALL 'kxdfhei1' USING DFHEIV0
 15053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15054
 15055
 15056     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 15057     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15058     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15059
 15060
 15061* EXEC CICS READ
 15062*        INTO    (PENDING-BUSINESS)
 15063*        DATASET (FILE-ID-ERPNDB)
 15064*        RIDFLD  (ERPNDB-KEY)
 15065*    END-EXEC.
 15066     MOVE LENGTH OF
 15067      PENDING-BUSINESS
 15068       TO DFHEIV11
 15069*    MOVE '&"IL       E          (   #00013543' TO DFHEIV0
 15070     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15071     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15072     MOVE X'2020233030303133353433' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 274
* EL6311.cbl
 15073     CALL 'kxdfhei1' USING DFHEIV0,
 15074           FILE-ID-ERPNDB,
 15075           PENDING-BUSINESS,
 15076           DFHEIV11,
 15077           ERPNDB-KEY,
 15078           DFHEIV99,
 15079           DFHEIV99,
 15080           DFHEIV99
 15081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15082
 15083
 15084     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 15085
 15086     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15087     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 15088     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 15089     MOVE SPACES                 TO PENDING-BUSINESS.
 15090     MOVE 'PB'                   TO PB-RECORD-ID.
 15091     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 15092     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 15093     MOVE SPACES                 TO PB-CERT-SFX.
 15094     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 15095     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15096                                    PB-ALT-CHG-SEQ-NO.
 15097
 15098     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 15099     MOVE CCERTNOI               TO PB-CERT-PRIME.
 15100     MOVE '2'                    TO PB-RECORD-TYPE.
 15101
 15102     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 15103     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 15104
 15105
 15106     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15107                                    PB-ALT-CHG-SEQ-NO
 15108                                    PB-C-LF-REF-CALC
 15109                                    PB-C-AH-REF-CALC
 15110                                    PB-C-LF-RFND-CLP
 15111                                    PB-C-AH-RFND-CLP
 15112                                    PB-CI-INSURED-AGE
 15113                                    PB-CI-LF-TERM
 15114                                    PB-CI-AH-TERM
 15115                                    PB-CI-LF-BENEFIT-CD
 15116                                    PB-CI-LF-BENEFIT-AMT
 15117                                    PB-CI-LF-ALT-BENEFIT-AMT
 15118                                    PB-CI-LF-PREMIUM-AMT
 15119                                    PB-CI-LF-ALT-PREMIUM-AMT
 15120                                    PB-CI-AH-BENEFIT-CD
 15121                                    PB-CI-AH-BENEFIT-AMT
 15122                                    PB-CI-AH-PREMIUM-AMT
 15123                                    PB-CI-PAY-FREQUENCY
 15124                                    PB-CI-LOAN-APR
 15125                                    PB-CI-LOAN-TERM
 15126                                    PB-CI-LIFE-COMMISSION
 15127                                    PB-CI-AH-COMMISSION
 15128                                    PB-CI-CURR-SEQ
 15129                                    PB-CI-AH-CANCEL-AMT
 15130                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 275
* EL6311.cbl
 15131                                    PB-CI-RATE-DEV-PCT-LF
 15132                                    PB-CI-RATE-DEV-PCT-AH
 15133                                    PB-CI-EXTENTION-DAYS
 15134                                    PB-CI-TERM-IN-DAYS
 15135                                    PB-CI-LIVES
 15136                                    PB-CI-LF-CRIT-PER
 15137                                    PB-CI-AH-CRIT-PER
 15138                                    PB-C-LF-REM-TERM
 15139                                    PB-C-AH-REM-TERM
 15140                                    PB-CHG-COUNT
 15141                                    PB-LF-BILLED-AMTS
 15142                                    PB-AH-BILLED-AMTS
 15143                                    PB-C-INT-ON-REFS
 15144*                                   PB-C-MICROFILM-NO
 15145                                    PB-CALC-TOLERANCE.
 15146
 15147     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 15148                                    PB-CI-AH-SETTLEMENT-DT
 15149                                    PB-CI-DEATH-DT
 15150                                    PB-CI-LF-PRIOR-CANCEL-DT
 15151                                    PB-CI-AH-PRIOR-CANCEL-DT
 15152                                    PB-CI-ENTRY-DT
 15153                                    PB-CI-LF-EXPIRE-DT
 15154                                    PB-CI-AH-EXPIRE-DT
 15155                                    PB-CI-LOAN-1ST-PMT-DT
 15156                                    PB-C-LF-CANCEL-DT
 15157                                    PB-C-AH-CANCEL-DT
 15158                                    PB-CREDIT-ACCEPT-DT
 15159                                    PB-BILLED-DT
 15160                                    PB-ACCT-EFF-DT
 15161                                    PB-ACCT-EXP-DT.
 15162
 15163     MOVE 'X'                    TO PB-FATAL-FLAG.
 15164
 15165     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 15166
 15167     IF CSUFIXL     GREATER THAN ZEROS
 15168        MOVE CSUFIXI             TO PB-CERT-SFX.
 15169
 15170*    IF CMICRNOL  GREATER  ZEROS
 15171*        IF CMICRNOI  NUMERIC
 15172*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15173*            MOVE AL-UNNON       TO  CMICRNOA
 15174*        ELSE
 15175*            MOVE -1             TO  CMICRNOL
 15176*            MOVE AL-UNBON       TO  CMICRNOA
 15177*            MOVE ER-2701        TO  EMI-ERROR
 15178*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15179
 15180     IF CLSTNML     GREATER THAN ZEROS
 15181        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 15182
 15183     IF CCANREAL > ZEROS
 15184        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15185     END-IF
 15186     IF CCANDT1L    GREATER THAN ZEROS
 15187        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15188
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 276
* EL6311.cbl
 15189     IF CCANDT2L    GREATER THAN ZEROS
 15190        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15191
 15192     IF CMTHD1L    GREATER THAN +0
 15193        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15194
 15195     IF CMTHD2L    GREATER THAN +0
 15196        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15197
 15198     IF CREFND1L    GREATER THAN ZEROS
 15199        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15200        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15201     ELSE
 15202        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 15203
 15204     IF CREFND2L    GREATER THAN ZEROS
 15205        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15206        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15207     ELSE
 15208        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 15209
 15210     IF CLIVESL     GREATER THAN ZEROS
 15211        MOVE WS-CLIVES           TO PB-C-LIVES
 15212     ELSE
 15213        MOVE ZEROS               TO PB-C-LIVES.
 15214
 15215     IF CPAYEEL     GREATER THAN ZEROS
 15216        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15217
 15218     IF CFORCEL     GREATER THAN ZEROS
 15219        MOVE CFORCEI             TO PB-FORCE-CODE.
 15220
 15221     IF CBILCDL     GREATER THAN ZEROS
 15222        MOVE CBILCDI             TO PB-RECORD-BILL.
 15223
 15224*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 15225
 15226 2260-WRITE-PB-RECORD.
 15227     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 15228                                    PB-INPUT-BY.
 15229     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15230     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 15231                                    PB-INPUT-DT.
 15232
 15233     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15234     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15235                                    PB-CONTROL-BY-ORIG-BATCH.
 15236
 15237     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 15238     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 15239     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 15240     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 15241     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 15242
 15243     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15244
 15245     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15246
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 277
* EL6311.cbl
 15247     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15248     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15249     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15250
 15251     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15252     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15253
 15254 2275-WRITE-PENDING-BUSINESS.
 15255     MOVE 'A'                    TO JP-RECORD-TYPE.
 15256     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15257     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15258     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15259
 15260
 15261* EXEC CICS HANDLE CONDITION
 15262*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 15263*    END-EXEC.
 15264*    MOVE '"$%                   ! 4 #00013725' TO DFHEIV0
 15265     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15266     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15267     MOVE X'3420233030303133373235' TO DFHEIV0(25:11)
 15268     CALL 'kxdfhei1' USING DFHEIV0
 15269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15270
 15271
 15272
 15273* EXEC CICS WRITE
 15274*        DATASET (FILE-ID-ERPNDB)
 15275*        FROM    (PENDING-BUSINESS)
 15276*        RIDFLD  (PB-CONTROL-PRIMARY)
 15277*    END-EXEC.
 15278     MOVE LENGTH OF
 15279      PENDING-BUSINESS
 15280       TO DFHEIV11
 15281*    MOVE '&$ L                  ''   #00013729' TO DFHEIV0
 15282     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15283     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15284     MOVE X'2020233030303133373239' TO DFHEIV0(25:11)
 15285     CALL 'kxdfhei1' USING DFHEIV0,
 15286           FILE-ID-ERPNDB,
 15287           PENDING-BUSINESS,
 15288           DFHEIV11,
 15289           PB-CONTROL-PRIMARY,
 15290           DFHEIV99,
 15291           DFHEIV99
 15292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15293
 15294
 15295     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 15296
 15297     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Add
 15298
 15299******************************************************************
 15300*       A D D  O R I G I N A L  C E R T  I N F O                 *
 15301******************************************************************
 15302
 15303     display ' made it to add orig CANCEL cert '
 15304     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 278
* EL6311.cbl
 15305     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15306     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15307     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15308
 15309
 15310* EXEC CICS READ
 15311*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15312*        DATASET (FILE-ID-ELCERT)
 15313*        RIDFLD  (ELCERT-KEY)
 15314*        RESP    (WS-RESPONSE)
 15315*    END-EXEC.
 15316*    MOVE '&"S        E          (  N#00013749' TO DFHEIV0
 15317     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15318     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15319     MOVE X'204E233030303133373439' TO DFHEIV0(25:11)
 15320     CALL 'kxdfhei1' USING DFHEIV0,
 15321           FILE-ID-ELCERT,
 15322           DFHEIV20,
 15323           DFHEIV99,
 15324           ELCERT-KEY,
 15325           DFHEIV99,
 15326           DFHEIV99,
 15327           DFHEIV99
 15328     SET ADDRESS OF CERTIFICATE-MASTER TO
 15329         DFHEIV20
 15330     MOVE EIBRESP  TO WS-RESPONSE
 15331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15332
 15333
 15334     IF NOT RESP-NORMAL
 15335        GO TO 2276-BYPASS-CRTO
 15336     END-IF
 15337
 15338     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15339     MOVE ' '                    TO WS-ERMAIL-SW
 15340
 15341
 15342* EXEC CICS READ
 15343*       DATASET   (FILE-ID-ERMAIL)
 15344*       SET       (ADDRESS OF MAILING-DATA)
 15345*       RIDFLD    (ERMAIL-KEY)
 15346*       RESP      (WS-RESPONSE)
 15347*    END-EXEC
 15348*    MOVE '&"S        E          (  N#00013763' TO DFHEIV0
 15349     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15350     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15351     MOVE X'204E233030303133373633' TO DFHEIV0(25:11)
 15352     CALL 'kxdfhei1' USING DFHEIV0,
 15353           FILE-ID-ERMAIL,
 15354           DFHEIV20,
 15355           DFHEIV99,
 15356           ERMAIL-KEY,
 15357           DFHEIV99,
 15358           DFHEIV99,
 15359           DFHEIV99
 15360     SET ADDRESS OF MAILING-DATA TO
 15361         DFHEIV20
 15362     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 279
* EL6311.cbl
 15363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15364
 15365     IF RESP-NORMAL
 15366        SET ERMAIL-FOUND TO TRUE
 15367     END-IF
 15368
 15369     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15370
 15371     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 15372     MOVE 'OC'                   TO OC-RECORD-ID
 15373     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15374                                 TO OC-CONTROL-PRIMARY (1:33)
 15375     MOVE 'I'                    TO OC-RECORD-TYPE
 15376     MOVE +4096                  TO OC-KEY-SEQ-NO
 15377     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15378     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15379     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15380
 15381     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15382     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15383     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15384     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15385     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15386     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15387     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15388     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15389     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15390     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15391     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15392     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15393     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15394     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15395     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15396     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15397     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15398     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15399     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15400     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15401     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15402     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15403     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15404     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15405     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15406     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15407     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15408     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15409     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15410     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15411     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15412     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15413
 15414     IF ERMAIL-FOUND
 15415        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15416     END-IF
 15417     IF NOT CERT-TRL-REC-NOT-FOUND
 15418        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15419                           OC-INS-AGE-DEFAULT-FLAG
 15420        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 280
* EL6311.cbl
 15421                           OC-JNT-AGE-DEFAULT-FLAG
 15422     END-IF
 15423     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15424     .
 15425 2275-WRITE-ELCRTO.
 15426
 15427
 15428* EXEC CICS WRITE
 15429*       DATASET   ('ELCRTO')
 15430*       FROM      (ORIGINAL-CERTIFICATE)
 15431*       RIDFLD    (OC-CONTROL-PRIMARY)
 15432*       RESP      (WS-RESPONSE)
 15433*    END-EXEC
 15434     MOVE LENGTH OF
 15435      ORIGINAL-CERTIFICATE
 15436       TO DFHEIV11
 15437     MOVE 'ELCRTO' TO DFHEIV1
 15438*    MOVE '&$ L                  ''  N#00013832' TO DFHEIV0
 15439     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15440     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15441     MOVE X'204E233030303133383332' TO DFHEIV0(25:11)
 15442     CALL 'kxdfhei1' USING DFHEIV0,
 15443           DFHEIV1,
 15444           ORIGINAL-CERTIFICATE,
 15445           DFHEIV11,
 15446           OC-CONTROL-PRIMARY,
 15447           DFHEIV99,
 15448           DFHEIV99
 15449     MOVE EIBRESP  TO WS-RESPONSE
 15450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15451
 15452     display ' just wrote 2275 ' ws-response
 15453     IF RESP-DUPKEY
 15454        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15455        GO TO 2275-WRITE-ELCRTO
 15456     ELSE
 15457        IF NOT RESP-NORMAL
 15458           MOVE -1               TO BMAINTL
 15459           MOVE ER-7450          TO EMI-ERROR
 15460           PERFORM 9900-ERROR-FORMAT
 15461                                 THRU 9900-EXIT
 15462           GO TO 8200-SEND-DATAONLY
 15463        END-IF
 15464     END-IF.
 15465
 15466 2276-BYPASS-CRTO.
 15467******************************************************************
 15468*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15469******************************************************************
 15470
 15471
 15472* EXEC CICS READ
 15473*        INTO    (PENDING-BUSINESS)
 15474*        DATASET (FILE-ID-ERPNDB)
 15475*        RIDFLD  (ERPNDB-KEY)
 15476*        UPDATE
 15477*    END-EXEC.
 15478     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 281
* EL6311.cbl
 15479      PENDING-BUSINESS
 15480       TO DFHEIV11
 15481*    MOVE '&"IL       EU         (   #00013858' TO DFHEIV0
 15482     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15483     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15484     MOVE X'2020233030303133383538' TO DFHEIV0(25:11)
 15485     CALL 'kxdfhei1' USING DFHEIV0,
 15486           FILE-ID-ERPNDB,
 15487           PENDING-BUSINESS,
 15488           DFHEIV11,
 15489           ERPNDB-KEY,
 15490           DFHEIV99,
 15491           DFHEIV99,
 15492           DFHEIV99
 15493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15494
 15495
 15496     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15497     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15498     MOVE 'B'                    TO JP-RECORD-TYPE.
 15499     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15500
 15501     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 15502
 15503     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15504
 15505
 15506* EXEC CICS REWRITE
 15507*        DATASET (FILE-ID-ERPNDB)
 15508*        FROM    (PENDING-BUSINESS)
 15509*    END-EXEC.
 15510     MOVE LENGTH OF
 15511      PENDING-BUSINESS
 15512       TO DFHEIV11
 15513*    MOVE '&& L                  %   #00013874' TO DFHEIV0
 15514     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15515     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15516     MOVE X'2020233030303133383734' TO DFHEIV0(25:11)
 15517     CALL 'kxdfhei1' USING DFHEIV0,
 15518           FILE-ID-ERPNDB,
 15519           PENDING-BUSINESS,
 15520           DFHEIV11,
 15521           DFHEIV99
 15522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15523
 15524
 15525     MOVE 'C'                    TO JP-RECORD-TYPE.
 15526     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15527
 15528     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 15529
 15530     IF WS-ERRORS-PRESENT
 15531        GO TO 3900-RE-DISPLAY-RECORD.
 15532
 15533     MOVE ZEROS                  TO EMI-ERROR.
 15534     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15535     MOVE LOW-VALUES             TO EL631CI.
 15536     MOVE  -1                    TO CMAINTL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 282
* EL6311.cbl
 15537     GO TO 8100-SEND-INITIAL-MAP.
 15538
 15539 2280-BATCH-HDR-NOT-FOUND.
 15540     MOVE -1                     TO BMAINTL.
 15541     MOVE ER-7450                TO EMI-ERROR.
 15542     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15543     GO TO 8200-SEND-DATAONLY.
 15544
 15545 2290-DUPLICATE-ALT-INDEX.
 15546
 15547******************************************************************
 15548*                                                                *
 15549*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15550*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15551*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15552*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15553*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15554*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15555*                                                                *
 15556******************************************************************
 15557
 15558     IF LCP-ONCTR-02 =  0
 15559         ADD 1 TO LCP-ONCTR-02
 15560        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15561
 15562     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15563
 15564     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15565         NEXT SENTENCE
 15566     ELSE
 15567         ADD +1 TO PB-BATCH-SEQ-NO
 15568                   PB-CSR-BATCH-SEQ-NO
 15569         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15570         GO TO 2275-WRITE-PENDING-BUSINESS.
 15571
 15572     MOVE -1                     TO CCERTNOL.
 15573     MOVE AL-UABON               TO CCERTNOA.
 15574     MOVE AL-UNBON               TO CEFFDTA.
 15575
 15576     MOVE 1                      TO EMI-SUB
 15577                                    EMI-SWITCH1
 15578                                    EMI-SWITCH-AREA-1
 15579                                    EMI-SWITCH-AREA-2.
 15580
 15581     MOVE SPACES                 TO EMI-ERROR-LINES.
 15582
 15583
 15584* EXEC CICS SYNCPOINT ROLLBACK
 15585*    END-EXEC.
 15586*    MOVE '6"R                   !   #00013937' TO DFHEIV0
 15587     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15589     MOVE X'2020233030303133393337' TO DFHEIV0(25:11)
 15590     CALL 'kxdfhei1' USING DFHEIV0
 15591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15592
 15593
 15594     MOVE ER-2247                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 283
* EL6311.cbl
 15595     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15596     GO TO 8200-SEND-DATAONLY.
 15597
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 284
* EL6311.cbl
 15599
 15600******************************************************************
 15601*                                                                *
 15602*          C H A N G E   C A N C E L   R O U T I N E             *
 15603*                                                                *
 15604******************************************************************
 15605
 15606***************************************************************
 15607*                                                             *
 15608*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15609*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15610*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15611*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15612*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15613*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15614*     5. LINK TO THE EDIT ROUTINE.                            *
 15615*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15616*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15617*              THE EDIT ROUTINE.                              *
 15618*     7. REWRITE THE NEW ISSUE                                *
 15619*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15620*                                                             *
 15621***************************************************************
 15622 2300-CHANGE-CANCEL-ROUTINE.
 15623     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15624
 15625     IF CCHGL NOT = ZEROS
 15626        MOVE ER-2196             TO EMI-ERROR
 15627        MOVE AL-UABON            TO CMAINTA
 15628        MOVE -1                  TO CMAINTL
 15629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15630        GO TO 8200-SEND-DATAONLY.
 15631
 15632     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15633
 15634     IF CSUFIXL NOT = ZEROS
 15635        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15636     ELSE
 15637        MOVE SPACE               TO WS-NEW-SUFFIX.
 15638
 15639     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15640     PERFORM 8600-DEEDIT.
 15641     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15642     MOVE '4'                    TO DC-OPTION-CODE.
 15643
 15644     PERFORM 9700-DATE-LINK.
 15645
 15646     IF DATE-CONVERSION-ERROR
 15647        MOVE ER-0348             TO EMI-ERROR
 15648        MOVE -1                  TO CEFFDTL
 15649        MOVE AL-UABON            TO CEFFDTA
 15650        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15651        GO TO 8200-SEND-DATAONLY
 15652     ELSE
 15653        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15654        MOVE AL-UANON            TO CEFFDTA
 15655        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15656
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 285
* EL6311.cbl
 15657 2325-PROCESS-CANCEL-CHANGES.
 15658
 15659* EXEC CICS HANDLE CONDITION
 15660*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15661*    END-EXEC.
 15662*    MOVE '"$I                   ! 5 #00014004' TO DFHEIV0
 15663     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15664     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15665     MOVE X'3520233030303134303034' TO DFHEIV0(25:11)
 15666     CALL 'kxdfhei1' USING DFHEIV0
 15667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15668
 15669
 15670     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15671     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15672     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15673
 15674
 15675* EXEC CICS GETMAIN
 15676*        SET      (ADDRESS OF PENDING-BUSINESS)
 15677*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15678*        INITIMG  (GETMAIN-SPACE)
 15679*     END-EXEC.
 15680*    MOVE ',"IL                  $   #00014012' TO DFHEIV0
 15681     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15682     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15683     MOVE X'2020233030303134303132' TO DFHEIV0(25:11)
 15684     CALL 'kxdfhei1' USING DFHEIV0,
 15685           DFHEIV20,
 15686           ERPNDB-RECORD-LENGTH,
 15687           GETMAIN-SPACE
 15688     SET ADDRESS OF PENDING-BUSINESS TO
 15689         DFHEIV20
 15690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15691
 15692
 15693
 15694* EXEC CICS READ
 15695*        INTO    (PENDING-BUSINESS)
 15696*        DATASET (FILE-ID-ERPNDB)
 15697*        RIDFLD  (ERPNDB-KEY)
 15698*    END-EXEC.
 15699     MOVE LENGTH OF
 15700      PENDING-BUSINESS
 15701       TO DFHEIV11
 15702*    MOVE '&"IL       E          (   #00014018' TO DFHEIV0
 15703     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15704     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15705     MOVE X'2020233030303134303138' TO DFHEIV0(25:11)
 15706     CALL 'kxdfhei1' USING DFHEIV0,
 15707           FILE-ID-ERPNDB,
 15708           PENDING-BUSINESS,
 15709           DFHEIV11,
 15710           ERPNDB-KEY,
 15711           DFHEIV99,
 15712           DFHEIV99,
 15713           DFHEIV99
 15714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 286
* EL6311.cbl
 15715
 15716
 15717     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15718
 15719
 15720* EXEC CICS HANDLE CONDITION
 15721*         NOTFND     (2385-REC-NOT-FOUND)
 15722*    END-EXEC.
 15723*    MOVE '"$I                   ! 6 #00014026' TO DFHEIV0
 15724     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15725     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15726     MOVE X'3620233030303134303236' TO DFHEIV0(25:11)
 15727     CALL 'kxdfhei1' USING DFHEIV0
 15728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15729
 15730
 15731**********************************************************
 15732*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15733*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15734**********************************************************
 15735
 15736
 15737* EXEC CICS READ
 15738*        DATASET (FILE-ID-ERPNDB)
 15739*        INTO    (PENDING-BUSINESS)
 15740*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15741*    END-EXEC.
 15742     MOVE LENGTH OF
 15743      PENDING-BUSINESS
 15744       TO DFHEIV11
 15745*    MOVE '&"IL       E          (   #00014035' TO DFHEIV0
 15746     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15747     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15748     MOVE X'2020233030303134303335' TO DFHEIV0(25:11)
 15749     CALL 'kxdfhei1' USING DFHEIV0,
 15750           FILE-ID-ERPNDB,
 15751           PENDING-BUSINESS,
 15752           DFHEIV11,
 15753           PI-PREV-CONTROL-PRIMARY,
 15754           DFHEIV99,
 15755           DFHEIV99,
 15756           DFHEIV99
 15757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15758
 15759
 15760********** DO NOT ALLOW CHANGES IF THRU A/R
 15761     IF BMAINTI = 'C'
 15762         IF PB-EL860-INTERNAL-PROCESS
 15763             MOVE ER-4005          TO EMI-ERROR
 15764             MOVE -1               TO BMAINTL
 15765             MOVE AL-UABON         TO BMAINTA
 15766             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15767             GO TO 8200-SEND-DATAONLY.
 15768**********
 15769
 15770     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15771        MOVE -1                 TO CMAINTL
 15772        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 287
* EL6311.cbl
 15773        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15774        GO TO 8200-SEND-DATAONLY.
 15775
 15776     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15777        MOVE ER-2196             TO EMI-ERROR
 15778        MOVE AL-UABON            TO CMAINTA
 15779        MOVE -1                  TO CMAINTL
 15780        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15781        GO TO 8200-SEND-DATAONLY.
 15782     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15783
 15784     IF PB-BILLED-DT = LOW-VALUES AND
 15785        PB-CHG-COUNT = ZEROS
 15786        NEXT SENTENCE
 15787     ELSE
 15788        IF (CREFND1L GREATER THAN ZEROS AND
 15789            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15790           OR
 15791           (CREFND2L GREATER THAN ZEROS AND
 15792            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15793           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15794     if ((crefnd1l <> zeros)
 15795        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15796                      or
 15797        ((crefnd2l <> zeros)
 15798        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15799        continue
 15800     else
 15801        go to 2330-continue-change
 15802     end-if
 15803
 15804     move zeros                  to ws-check-amts
 15805     move ' '                    to ws-stop-sw
 15806                                    ws-check-sw
 15807                                    ws-any-check-sw
 15808                                    ws-proc-check-sw
 15809                                    ws-chek-browse-sw
 15810
 15811     perform 2500-browse-checks  thru 2500-exit
 15812
 15813     if i-have-processed-checks
 15814        or i-have-checks
 15815        continue
 15816     else
 15817        go to 2330-continue-change
 15818     end-if
 15819
 15820     if crefnd1l <> zeros
 15821        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15822        move ws-crefnd1 to ws-new-ref-total
 15823     else
 15824        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15825     end-if
 15826     if crefnd2l <> zeros
 15827        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15828        compute ws-new-ref-total = ws-new-ref-total +
 15829           ws-crefnd2
 15830     else
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 288
* EL6311.cbl
 15831        compute ws-new-ref-total = ws-new-ref-total +
 15832           pb-c-ah-cancel-amt
 15833     end-if
 15834
 15835     if zeros = (ws-lf-diff + ws-ah-diff)
 15836        move er-3449             to emi-error
 15837        perform 9900-error-format thru 9900-exit
 15838        go to 2330-continue-change
 15839     end-if
 15840
 15841     if (ws-new-ref-total < ws-check-amts)
 15842        and (pb-c-refund-sw = 'Y')
 15843        move er-3447             to emi-error
 15844        perform 9900-error-format thru 9900-exit
 15845        move al-uabon            to cmainta
 15846        move -1                  to cmaintl
 15847        go to 8200-send-dataonly
 15848     end-if
 15849
 15850     if (ws-new-ref-total > ws-check-amts)
 15851        and (ws-check-amts not = zeros)
 15852        move er-3448             to emi-error
 15853        move al-uabon            to crefnd1a
 15854                                    crefnd2a
 15855        perform 9900-error-format thru 9900-exit
 15856     end-if
 15857
 15858*     if (ws-lf-diff + ws-ah-diff) < zeros
 15859*        move er-3447             to emi-error
 15860*        perform 9900-error-format thru 9900-exit
 15861*        move al-uabon            to cmainta
 15862*        move -1                  to cmaintl
 15863*        go to 8200-send-dataonly
 15864*     end-if
 15865     .
 15866 2330-continue-change.
 15867
 15868
 15869* EXEC CICS READ
 15870*        DATASET (FILE-ID-ERPNDB)
 15871*        INTO    (PENDING-BUSINESS)
 15872*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15873*        UPDATE
 15874*    END-EXEC.
 15875     MOVE LENGTH OF
 15876      PENDING-BUSINESS
 15877       TO DFHEIV11
 15878*    MOVE '&"IL       EU         (   #00014149' TO DFHEIV0
 15879     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15880     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15881     MOVE X'2020233030303134313439' TO DFHEIV0(25:11)
 15882     CALL 'kxdfhei1' USING DFHEIV0,
 15883           FILE-ID-ERPNDB,
 15884           PENDING-BUSINESS,
 15885           DFHEIV11,
 15886           PI-PREV-CONTROL-PRIMARY,
 15887           DFHEIV99,
 15888           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 289
* EL6311.cbl
 15889           DFHEIV99
 15890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15891
 15892
 15893     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15894     MOVE 'B'                    TO JP-RECORD-TYPE
 15895     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15896     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15897
 15898*    PERFORM 8400-LOG-JOURNAL-RECORD  *>Move closer to rewrite
 15899
 15900     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15901          PB-CHG-COUNT NOT = ZEROS
 15902        IF (CREFND1L GREATER THAN ZEROS AND
 15903            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15904           OR
 15905           (CREFND2L GREATER THAN ZEROS AND
 15906            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15907            ADD +1                      TO PB-CHG-COUNT
 15908            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15909
 15910*    IF CMICRNOL  GREATER  ZEROS
 15911*        IF CMICRNOI  NUMERIC
 15912*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15913*            MOVE AL-UNNON       TO  CMICRNOA
 15914*        ELSE
 15915*            MOVE -1             TO  CMICRNOL
 15916*            MOVE AL-UNBON       TO  CMICRNOA
 15917*            MOVE ER-2701        TO  EMI-ERROR
 15918*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15919
 15920     IF CSUFIXL GREATER THAN ZEROS
 15921        MOVE CSUFIXI             TO PB-CERT-SFX.
 15922
 15923     IF CLSTNML GREATER THAN ZEROS
 15924         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15925
 15926     IF CCANREAL > ZEROS
 15927        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15928     END-IF
 15929     IF CCANDT1L    GREATER THAN ZEROS
 15930        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15931
 15932     IF CCANDT2L    GREATER THAN ZEROS
 15933        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15934
 15935     IF CMTHD1L    GREATER THAN +0
 15936        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15937
 15938     IF CMTHD2L    GREATER THAN +0
 15939        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15940
 15941     IF CREFND1L    GREATER THAN ZEROS
 15942        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15943        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15944        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15945        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15946
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 290
* EL6311.cbl
 15947     IF CREFND2L    GREATER THAN ZEROS
 15948        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15949        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15950        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15951        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15952
 15953     IF CLIVESL     GREATER THAN ZEROS
 15954        MOVE WS-CLIVES           TO PB-C-LIVES.
 15955
 15956     IF CPAYEEL     GREATER THAN ZEROS
 15957        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15958
 15959     IF CFORCEL     GREATER THAN ZEROS
 15960        MOVE CFORCEI             TO PB-FORCE-CODE.
 15961
 15962     IF CBILCDL     GREATER THAN ZEROS
 15963        MOVE CBILCDI             TO PB-RECORD-BILL.
 15964
 15965 2360-REWRITE-PB-RECORD.
 15966     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15967     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15968     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15969*    MOVE 'C'                    TO JP-RECORD-TYPE.
 15970*    MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15971     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15972*    MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15973
 15974     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15975
 15976     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15977     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15978
 15979     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15980
 15981     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15982
 15983     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15984     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15985     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15986
 15987     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15988     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15989
 15990 2375-REWRITE-PENDING-BUSINESS.
 15991     PERFORM 8400-LOG-JOURNAL-RECORD  *>Before Cancel Image
 15992     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15993     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15994     MOVE 'C'                    TO JP-RECORD-TYPE.
 15995     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15996
 15997
 15998* EXEC CICS REWRITE
 15999*        DATASET (FILE-ID-ERPNDB)
 16000*        FROM    (PENDING-BUSINESS)
 16001*    END-EXEC.
 16002     MOVE LENGTH OF
 16003      PENDING-BUSINESS
 16004       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 291
* EL6311.cbl
 16005*    MOVE '&& L                  %   #00014260' TO DFHEIV0
 16006     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16007     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16008     MOVE X'2020233030303134323630' TO DFHEIV0(25:11)
 16009     CALL 'kxdfhei1' USING DFHEIV0,
 16010           FILE-ID-ERPNDB,
 16011           PENDING-BUSINESS,
 16012           DFHEIV11,
 16013           DFHEIV99
 16014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16015
 16016
 16017     PERFORM 8400-LOG-JOURNAL-RECORD  *> After Cancel Image
 16018
 16019******************************************************************
 16020*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 16021******************************************************************
 16022
 16023     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16024     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16025     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16026     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16027
 16028
 16029* EXEC CICS READ
 16030*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16031*        DATASET (FILE-ID-ELCERT)
 16032*        RIDFLD  (ELCERT-KEY)
 16033*        RESP    (WS-RESPONSE)
 16034*    END-EXEC.
 16035*    MOVE '&"S        E          (  N#00014276' TO DFHEIV0
 16036     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16037     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16038     MOVE X'204E233030303134323736' TO DFHEIV0(25:11)
 16039     CALL 'kxdfhei1' USING DFHEIV0,
 16040           FILE-ID-ELCERT,
 16041           DFHEIV20,
 16042           DFHEIV99,
 16043           ELCERT-KEY,
 16044           DFHEIV99,
 16045           DFHEIV99,
 16046           DFHEIV99
 16047     SET ADDRESS OF CERTIFICATE-MASTER TO
 16048         DFHEIV20
 16049     MOVE EIBRESP  TO WS-RESPONSE
 16050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16051
 16052
 16053     IF NOT RESP-NORMAL
 16054        GO TO 2376-BYPASS-CRTO
 16055     END-IF
 16056
 16057
 16058     MOVE ELCERT-KEY             TO ERMAIL-KEY
 16059     MOVE ' '                    TO WS-ERMAIL-SW
 16060
 16061
 16062* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 292
* EL6311.cbl
 16063*       DATASET   (FILE-ID-ERMAIL)
 16064*       SET       (ADDRESS OF MAILING-DATA)
 16065*       RIDFLD    (ERMAIL-KEY)
 16066*       RESP      (WS-RESPONSE)
 16067*    END-EXEC
 16068*    MOVE '&"S        E          (  N#00014291' TO DFHEIV0
 16069     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16070     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16071     MOVE X'204E233030303134323931' TO DFHEIV0(25:11)
 16072     CALL 'kxdfhei1' USING DFHEIV0,
 16073           FILE-ID-ERMAIL,
 16074           DFHEIV20,
 16075           DFHEIV99,
 16076           ERMAIL-KEY,
 16077           DFHEIV99,
 16078           DFHEIV99,
 16079           DFHEIV99
 16080     SET ADDRESS OF MAILING-DATA TO
 16081         DFHEIV20
 16082     MOVE EIBRESP  TO WS-RESPONSE
 16083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16084
 16085     IF RESP-NORMAL
 16086        SET ERMAIL-FOUND TO TRUE
 16087     END-IF
 16088
 16089     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 16090
 16091     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16092                                 TO ELCRTO-KEY
 16093     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 16094     MOVE +0                     TO ELCRTO-SEQ-NO
 16095
 16096
 16097* EXEC CICS READ
 16098*       DATASET   ('ELCRTO')
 16099*       INTO      (ORIGINAL-CERTIFICATE)
 16100*       RIDFLD    (ELCRTO-KEY)
 16101*       GTEQ
 16102*       RESP      (WS-RESPONSE)
 16103*    END-EXEC
 16104     MOVE LENGTH OF
 16105      ORIGINAL-CERTIFICATE
 16106       TO DFHEIV11
 16107     MOVE 'ELCRTO' TO DFHEIV1
 16108*    MOVE '&"IL       G          (  N#00014309' TO DFHEIV0
 16109     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 16110     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16111     MOVE X'204E233030303134333039' TO DFHEIV0(25:11)
 16112     CALL 'kxdfhei1' USING DFHEIV0,
 16113           DFHEIV1,
 16114           ORIGINAL-CERTIFICATE,
 16115           DFHEIV11,
 16116           ELCRTO-KEY,
 16117           DFHEIV99,
 16118           DFHEIV99,
 16119           DFHEIV99
 16120     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 293
* EL6311.cbl
 16121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16122
 16123     IF RESP-NORMAL
 16124        AND (OC-CONTROL-PRIMARY (1:33) =
 16125                 PB-CONTROL-BY-ACCOUNT (1:33))
 16126        AND (OC-RECORD-TYPE = 'I')
 16127        display ' resp norm, key =, type i '
 16128        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 16129           display ' end proc blank '
 16130           display ' csr edit session ' PI-CSR-SESSION-SW
 16131           IF NOT CSR-EDIT-SESSION
 16132
 16133* EXEC CICS READ
 16134*                DATASET   ('ELCRTO')
 16135*                INTO      (ORIGINAL-CERTIFICATE)
 16136*                RIDFLD    (OC-CONTROL-PRIMARY)
 16137*                UPDATE
 16138*                RESP      (WS-RESPONSE)
 16139*             END-EXEC
 16140     MOVE LENGTH OF
 16141      ORIGINAL-CERTIFICATE
 16142       TO DFHEIV11
 16143     MOVE 'ELCRTO' TO DFHEIV1
 16144*    MOVE '&"IL       EU         (  N#00014326' TO DFHEIV0
 16145     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16146     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16147     MOVE X'204E233030303134333236' TO DFHEIV0(25:11)
 16148     CALL 'kxdfhei1' USING DFHEIV0,
 16149           DFHEIV1,
 16150           ORIGINAL-CERTIFICATE,
 16151           DFHEIV11,
 16152           OC-CONTROL-PRIMARY,
 16153           DFHEIV99,
 16154           DFHEIV99,
 16155           DFHEIV99
 16156     MOVE EIBRESP  TO WS-RESPONSE
 16157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16158              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 16159              IF RESP-NORMAL
 16160                 display ' good read upd '
 16161                 IF OC-ISSUE-TRAN-IND = 'N'
 16162                    MOVE CM-INSURED-LAST-NAME   TO
 16163                         OC-INS-LAST-NAME
 16164                    MOVE CM-INSURED-FIRST-NAME  TO
 16165                         OC-INS-FIRST-NAME
 16166                    MOVE CM-INSURED-INITIAL2    TO
 16167                         OC-INS-MIDDLE-INIT
 16168                    MOVE CM-INSURED-ISSUE-AGE   TO
 16169                         OC-INS-AGE
 16170                    MOVE CM-JT-LAST-NAME        TO
 16171                         OC-JNT-LAST-NAME
 16172                    MOVE CM-JT-FIRST-NAME       TO
 16173                         OC-JNT-FIRST-NAME
 16174                    MOVE CM-JT-INITIAL          TO
 16175                         OC-JNT-MIDDLE-INIT
 16176                    MOVE CM-INSURED-JOINT-AGE   TO
 16177                         OC-JNT-AGE
 16178                    MOVE CM-LF-BENEFIT-CD       TO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 294
* EL6311.cbl
 16179                         OC-LF-BENCD
 16180                    MOVE CM-LF-ORIG-TERM        TO
 16181                         OC-LF-TERM
 16182                    MOVE CM-LF-BENEFIT-AMT      TO
 16183                         OC-LF-BEN-AMT
 16184                    MOVE CM-LF-PREMIUM-AMT      TO
 16185                         OC-LF-PRM-AMT
 16186                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 16187                         OC-LF-ALT-BEN-AMT
 16188                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 16189                         OC-LF-ALT-PRM-AMT
 16190                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 16191                         OC-LF-EXP-DT
 16192                    MOVE CM-LIFE-COMM-PCT       TO
 16193                         OC-LF-COMM-PCT
 16194                    MOVE CM-AH-BENEFIT-CD       TO
 16195                         OC-AH-BENCD
 16196                    MOVE CM-AH-ORIG-TERM        TO
 16197                         OC-AH-TERM
 16198                    MOVE CM-AH-BENEFIT-AMT      TO
 16199                         OC-AH-BEN-AMT
 16200                    MOVE CM-AH-PREMIUM-AMT      TO
 16201                         OC-AH-PRM-AMT
 16202                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 16203                         OC-AH-EXP-DT
 16204                    MOVE CM-AH-COMM-PCT         TO
 16205                         OC-AH-COMM-PCT
 16206                    MOVE CM-AH-CRITICAL-PERIOD  TO
 16207                         OC-AH-CP
 16208                    MOVE CM-LOAN-1ST-PMT-DT     TO
 16209                         OC-1ST-PMT-DT
 16210                 END-IF
 16211                 MOVE PB-C-LF-CANCEL-DT      TO
 16212                         OC-LF-CANCEL-DT
 16213                 MOVE PB-C-LF-CANCEL-AMT     TO
 16214                         OC-LF-CANCEL-AMT
 16215                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 16216                         OC-LF-ITD-CANCEL-AMT
 16217                 MOVE PB-C-AH-CANCEL-DT      TO
 16218                         OC-AH-CANCEL-DT
 16219                 MOVE PB-C-AH-CANCEL-AMT     TO
 16220                         OC-AH-CANCEL-AMT
 16221                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 16222                         OC-AH-ITD-CANCEL-AMT
 16223                 MOVE 'Y'                    TO
 16224                         OC-CANCEL-TRAN-IND
 16225                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16226                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16227                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16228                 IF ERMAIL-FOUND
 16229                    MOVE MA-CRED-BENE-NAME
 16230                                 TO OC-CRED-BENE-NAME
 16231                 END-IF
 16232                 IF NOT CERT-TRL-REC-NOT-FOUND
 16233                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16234                           OC-INS-AGE-DEFAULT-FLAG
 16235                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16236                           OC-JNT-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 295
* EL6311.cbl
 16237                 END-IF
 16238
 16239* EXEC CICS REWRITE
 16240*                   DATASET   ('ELCRTO')
 16241*                   FROM      (ORIGINAL-CERTIFICATE)
 16242*                   RESP      (WS-RESPONSE)
 16243*                END-EXEC
 16244     MOVE LENGTH OF
 16245      ORIGINAL-CERTIFICATE
 16246       TO DFHEIV11
 16247     MOVE 'ELCRTO' TO DFHEIV1
 16248*    MOVE '&& L                  %  N#00014413' TO DFHEIV0
 16249     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16250     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16251     MOVE X'204E233030303134343133' TO DFHEIV0(25:11)
 16252     CALL 'kxdfhei1' USING DFHEIV0,
 16253           DFHEIV1,
 16254           ORIGINAL-CERTIFICATE,
 16255           DFHEIV11,
 16256           DFHEIV99
 16257     MOVE EIBRESP  TO WS-RESPONSE
 16258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16259                 display ' just rewrote ' ws-response
 16260              END-IF
 16261           END-IF
 16262        ELSE
 16263           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 16264           MOVE 'OC'             TO OC-RECORD-ID
 16265           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16266           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16267           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16268           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16269           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16270           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16271           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16272           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16273           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16274           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16275           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16276           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16277           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16278           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16279           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16280           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16281           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16282           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16283           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16284           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16285           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16286           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16287           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16288           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16289           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16290           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16291           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16292           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16293           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16294           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 296
* EL6311.cbl
 16295           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16296           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16297           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16298           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16299           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16300           IF ERMAIL-FOUND
 16301              MOVE MA-CRED-BENE-NAME
 16302                                 TO OC-CRED-BENE-NAME
 16303           END-IF
 16304           IF NOT CERT-TRL-REC-NOT-FOUND
 16305              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16306                           OC-INS-AGE-DEFAULT-FLAG
 16307              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16308                           OC-JNT-AGE-DEFAULT-FLAG
 16309           END-IF
 16310           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 16311
 16312* EXEC CICS WRITE
 16313*             DATASET   ('ELCRTO')
 16314*             FROM      (ORIGINAL-CERTIFICATE)
 16315*             RIDFLD    (OC-CONTROL-PRIMARY)
 16316*             RESP      (WS-RESPONSE)
 16317*          END-EXEC
 16318     MOVE LENGTH OF
 16319      ORIGINAL-CERTIFICATE
 16320       TO DFHEIV11
 16321     MOVE 'ELCRTO' TO DFHEIV1
 16322*    MOVE '&$ L                  ''  N#00014470' TO DFHEIV0
 16323     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16324     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16325     MOVE X'204E233030303134343730' TO DFHEIV0(25:11)
 16326     CALL 'kxdfhei1' USING DFHEIV0,
 16327           DFHEIV1,
 16328           ORIGINAL-CERTIFICATE,
 16329           DFHEIV11,
 16330           OC-CONTROL-PRIMARY,
 16331           DFHEIV99,
 16332           DFHEIV99
 16333     MOVE EIBRESP  TO WS-RESPONSE
 16334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16335        END-IF
 16336     ELSE
 16337        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 16338        MOVE 'OC'                TO OC-RECORD-ID
 16339        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16340                                 TO OC-CONTROL-PRIMARY (1:33)
 16341        MOVE 'I'                 TO OC-RECORD-TYPE
 16342        MOVE +4096               TO OC-KEY-SEQ-NO
 16343        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 16344        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 16345        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 16346        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16347        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16348        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16349        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16350        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16351        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16352        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 297
* EL6311.cbl
 16353        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16354        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16355        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16356        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16357        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16358        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16359        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16360        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16361        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16362        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16363        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16364        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16365        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16366        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16367        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16368        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16369        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16370        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16371        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16372        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16373        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16374        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16375        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16376        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16377        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16378        IF ERMAIL-FOUND
 16379           MOVE MA-CRED-BENE-NAME
 16380                                 TO OC-CRED-BENE-NAME
 16381        END-IF
 16382        IF NOT CERT-TRL-REC-NOT-FOUND
 16383           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16384                           OC-INS-AGE-DEFAULT-FLAG
 16385           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16386                           OC-JNT-AGE-DEFAULT-FLAG
 16387        END-IF
 16388        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16389
 16390
 16391* EXEC CICS WRITE
 16392*          DATASET   ('ELCRTO')
 16393*          FROM      (ORIGINAL-CERTIFICATE)
 16394*          RIDFLD    (OC-CONTROL-PRIMARY)
 16395*          RESP      (WS-RESPONSE)
 16396*       END-EXEC
 16397     MOVE LENGTH OF
 16398      ORIGINAL-CERTIFICATE
 16399       TO DFHEIV11
 16400     MOVE 'ELCRTO' TO DFHEIV1
 16401*    MOVE '&$ L                  ''  N#00014531' TO DFHEIV0
 16402     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16403     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16404     MOVE X'204E233030303134353331' TO DFHEIV0(25:11)
 16405     CALL 'kxdfhei1' USING DFHEIV0,
 16406           DFHEIV1,
 16407           ORIGINAL-CERTIFICATE,
 16408           DFHEIV11,
 16409           OC-CONTROL-PRIMARY,
 16410           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 298
* EL6311.cbl
 16411           DFHEIV99
 16412     MOVE EIBRESP  TO WS-RESPONSE
 16413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16414     END-IF.
 16415
 16416 2376-BYPASS-CRTO.
 16417******************************************************************
 16418*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16419******************************************************************
 16420
 16421
 16422* EXEC CICS HANDLE CONDITION
 16423*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16424*    END-EXEC.
 16425*    MOVE '"$I                   ! 7 #00014544' TO DFHEIV0
 16426     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16427     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16428     MOVE X'3720233030303134353434' TO DFHEIV0(25:11)
 16429     CALL 'kxdfhei1' USING DFHEIV0
 16430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16431
 16432
 16433
 16434* EXEC CICS READ
 16435*        INTO    (PENDING-BUSINESS)
 16436*        DATASET (FILE-ID-ERPNDB)
 16437*        RIDFLD  (ERPNDB-KEY)
 16438*        UPDATE
 16439*    END-EXEC.
 16440     MOVE LENGTH OF
 16441      PENDING-BUSINESS
 16442       TO DFHEIV11
 16443*    MOVE '&"IL       EU         (   #00014548' TO DFHEIV0
 16444     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16445     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16446     MOVE X'2020233030303134353438' TO DFHEIV0(25:11)
 16447     CALL 'kxdfhei1' USING DFHEIV0,
 16448           FILE-ID-ERPNDB,
 16449           PENDING-BUSINESS,
 16450           DFHEIV11,
 16451           ERPNDB-KEY,
 16452           DFHEIV99,
 16453           DFHEIV99,
 16454           DFHEIV99
 16455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16456
 16457
 16458     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16459     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16460     MOVE 'B'                    TO JP-RECORD-TYPE.
 16461     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16462
 16463     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 16464
 16465     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16466
 16467
 16468* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 299
* EL6311.cbl
 16469*        DATASET (FILE-ID-ERPNDB)
 16470*        FROM    (PENDING-BUSINESS)
 16471*    END-EXEC.
 16472     MOVE LENGTH OF
 16473      PENDING-BUSINESS
 16474       TO DFHEIV11
 16475*    MOVE '&& L                  %   #00014564' TO DFHEIV0
 16476     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16477     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16478     MOVE X'2020233030303134353634' TO DFHEIV0(25:11)
 16479     CALL 'kxdfhei1' USING DFHEIV0,
 16480           FILE-ID-ERPNDB,
 16481           PENDING-BUSINESS,
 16482           DFHEIV11,
 16483           DFHEIV99
 16484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16485
 16486
 16487     MOVE 'C'                    TO JP-RECORD-TYPE.
 16488     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16489
 16490     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 16491
 16492     IF WS-ERRORS-PRESENT
 16493         GO TO 3900-RE-DISPLAY-RECORD.
 16494
 16495     MOVE ZEROS                  TO EMI-ERROR
 16496     MOVE -1                     TO CMAINTL
 16497     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16498     GO TO 3900-RE-DISPLAY-RECORD.
 16499
 16500 2380-BATCH-HDR-NOT-FOUND.
 16501     MOVE -1                     TO BMAINTL.
 16502     MOVE ER-7450                TO EMI-ERROR.
 16503     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16504     GO TO 8200-SEND-DATAONLY.
 16505
 16506 2385-REC-NOT-FOUND.
 16507     MOVE -1                     TO BMAINTL.
 16508     MOVE ER-7451                TO EMI-ERROR.
 16509     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16510     GO TO 8200-SEND-DATAONLY.
 16511
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 300
* EL6311.cbl
 16513
 16514******************************************************************
 16515*                                                                *
 16516*          D E L E T E   C A N C E L   R O U T I N E             *
 16517*                                                                *
 16518******************************************************************
 16519
 16520 2400-DELETE-CANCEL-ROUTINE.
 16521     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16522
 16523     IF CCHGL NOT = ZEROS
 16524        MOVE ER-2196             TO EMI-ERROR
 16525        MOVE AL-UABON            TO CMAINTA
 16526        MOVE -1                  TO CMAINTL
 16527        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16528        GO TO 8200-SEND-DATAONLY.
 16529
 16530
 16531* EXEC CICS HANDLE CONDITION
 16532*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16533*    END-EXEC.
 16534*    MOVE '"$I                   ! 8 #00014612' TO DFHEIV0
 16535     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16537     MOVE X'3820233030303134363132' TO DFHEIV0(25:11)
 16538     CALL 'kxdfhei1' USING DFHEIV0
 16539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16540
 16541
 16542     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16543     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16544     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16545
 16546
 16547* EXEC CICS READ
 16548*        SET     (ADDRESS OF PENDING-BUSINESS)
 16549*        DATASET (FILE-ID-ERPNDB)
 16550*        RIDFLD  (ERPNDB-KEY)
 16551*    END-EXEC.
 16552*    MOVE '&"S        E          (   #00014620' TO DFHEIV0
 16553     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16555     MOVE X'2020233030303134363230' TO DFHEIV0(25:11)
 16556     CALL 'kxdfhei1' USING DFHEIV0,
 16557           FILE-ID-ERPNDB,
 16558           DFHEIV20,
 16559           DFHEIV99,
 16560           ERPNDB-KEY,
 16561           DFHEIV99,
 16562           DFHEIV99,
 16563           DFHEIV99
 16564     SET ADDRESS OF PENDING-BUSINESS TO
 16565         DFHEIV20
 16566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16567
 16568
 16569     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16570
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 301
* EL6311.cbl
 16571     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16572
 16573     IF CSUFIXL NOT = ZEROS
 16574        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16575     ELSE
 16576        MOVE SPACE               TO WS-NEW-SUFFIX.
 16577
 16578     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16579
 16580     PERFORM 8600-DEEDIT.
 16581     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16582     MOVE '4'                    TO DC-OPTION-CODE.
 16583     PERFORM 9700-DATE-LINK.
 16584
 16585     IF DATE-CONVERSION-ERROR
 16586        MOVE ER-0348             TO EMI-ERROR
 16587        MOVE -1                  TO CEFFDTL
 16588        MOVE AL-UABON            TO CEFFDTA
 16589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16590        GO TO 8200-SEND-DATAONLY
 16591     ELSE
 16592        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16593        MOVE AL-UANON            TO CEFFDTA
 16594        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16595
 16596
 16597* EXEC CICS HANDLE CONDITION
 16598*         NOTFND    (2490-RECORD-NOT-FOUND)
 16599*    END-EXEC.
 16600*    MOVE '"$I                   ! 9 #00014653' TO DFHEIV0
 16601     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16602     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16603     MOVE X'3920233030303134363533' TO DFHEIV0(25:11)
 16604     CALL 'kxdfhei1' USING DFHEIV0
 16605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16606
 16607
 16608
 16609* EXEC CICS READ
 16610*        SET     (ADDRESS OF PENDING-BUSINESS)
 16611*        DATASET (FILE-ID-ERPNDB)
 16612*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16613*        UPDATE
 16614*    END-EXEC.
 16615*    MOVE '&"S        EU         (   #00014657' TO DFHEIV0
 16616     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16617     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16618     MOVE X'2020233030303134363537' TO DFHEIV0(25:11)
 16619     CALL 'kxdfhei1' USING DFHEIV0,
 16620           FILE-ID-ERPNDB,
 16621           DFHEIV20,
 16622           DFHEIV99,
 16623           PI-PREV-CONTROL-PRIMARY,
 16624           DFHEIV99,
 16625           DFHEIV99,
 16626           DFHEIV99
 16627     SET ADDRESS OF PENDING-BUSINESS TO
 16628         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 302
* EL6311.cbl
 16629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16630
 16631
 16632     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16633        MOVE -1                 TO CMAINTL
 16634        MOVE ER-2197            TO EMI-ERROR
 16635        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16636        GO TO 8200-SEND-DATAONLY.
 16637
 16638     IF PB-BILLED-DT NOT = LOW-VALUES
 16639        MOVE -1                 TO CMAINTL
 16640        MOVE ER-2129            TO EMI-ERROR
 16641        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16642        GO TO 8200-SEND-DATAONLY.
 16643
 16644     IF PB-CHG-COUNT NOT = ZEROS
 16645        MOVE ER-2336            TO EMI-ERROR
 16646        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16647        MOVE AL-UABON            TO CMAINTA
 16648        MOVE -1                  TO CMAINTL
 16649        GO TO 8200-SEND-DATAONLY.
 16650
 16651     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16652        PB-CHG-COUNT NOT = ZEROS
 16653        MOVE ER-2196             TO EMI-ERROR
 16654        MOVE AL-UABON            TO CMAINTA
 16655        MOVE -1                  TO CMAINTL
 16656        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16657        GO TO 8200-SEND-DATAONLY.
 16658
 16659     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16660        MOVE ER-2900 TO EMI-ERROR
 16661        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16662        MOVE AL-UABON         TO CMAINTA
 16663        MOVE -1               TO CMAINTL
 16664        GO TO 8200-SEND-DATAONLY.
 16665     move ' '                    to ws-stop-sw
 16666                                    ws-check-sw
 16667                                    ws-any-check-sw
 16668                                    ws-proc-check-sw
 16669                                    ws-chek-browse-sw
 16670
 16671     perform 2500-browse-checks  thru 2500-exit
 16672     if (i-have-processed-checks)
 16673        and (pb-c-refund-sw = 'Y')
 16674        move er-3446             to emi-error
 16675        perform 9900-error-format thru 9900-exit
 16676        move al-uabon            to cmainta
 16677        move -1                  to cmaintl
 16678        go to 8200-send-dataonly
 16679     end-if
 16680
 16681* EXEC CICS HANDLE CONDITION
 16682*         NOTFND  (2475-CONTINUE-DELETE)
 16683*    END-EXEC
 16684*    MOVE '"$I                   ! : #00014712' TO DFHEIV0
 16685     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16686     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 303
* EL6311.cbl
 16687     MOVE X'3A20233030303134373132' TO DFHEIV0(25:11)
 16688     CALL 'kxdfhei1' USING DFHEIV0
 16689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16690
 16691     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16692     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16693     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16694     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16695
 16696
 16697* EXEC CICS READ
 16698*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16699*        DATASET (FILE-ID-ELCERT)
 16700*        RIDFLD  (ELCERT-KEY)
 16701*        UPDATE
 16702*    END-EXEC.
 16703*    MOVE '&"S        EU         (   #00014721' TO DFHEIV0
 16704     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16705     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16706     MOVE X'2020233030303134373231' TO DFHEIV0(25:11)
 16707     CALL 'kxdfhei1' USING DFHEIV0,
 16708           FILE-ID-ELCERT,
 16709           DFHEIV20,
 16710           DFHEIV99,
 16711           ELCERT-KEY,
 16712           DFHEIV99,
 16713           DFHEIV99,
 16714           DFHEIV99
 16715     SET ADDRESS OF CERTIFICATE-MASTER TO
 16716         DFHEIV20
 16717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16718
 16719
 16720     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16721
 16722     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16723     MOVE 'B'                    TO JP-RECORD-TYPE.
 16724     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16725     PERFORM 8400-LOG-JOURNAL-RECORD.
 16726
 16727     IF PB-CI-LIVES NOT NUMERIC
 16728         MOVE ZERO                    TO PB-CI-LIVES.
 16729
 16730     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16731        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16732           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16733           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16734           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16735                                            CM-LF-CANCEL-DT
 16736           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16737        ELSE
 16738           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16739           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16740           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16741           MOVE PB-CI-LIVES              TO CM-LIVES.
 16742
 16743     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16744        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 304
* EL6311.cbl
 16745           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16746               MOVE CM-LF-STATUS-AT-CANCEL
 16747                                        TO CM-LF-CURRENT-STATUS
 16748               MOVE SPACE
 16749                                        TO CM-LF-STATUS-AT-CANCEL
 16750           ELSE
 16751               MOVE PB-CI-LF-POLICY-STATUS
 16752                                        TO CM-LF-CURRENT-STATUS
 16753        ELSE
 16754           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16755
 16756
 16757     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16758        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16759           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16760           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16761           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16762                                            CM-AH-CANCEL-DT
 16763           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16764        ELSE
 16765           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16766           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16767           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16768           MOVE PB-CI-LIVES              TO CM-LIVES.
 16769
 16770     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16771        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16772           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16773               MOVE CM-AH-STATUS-AT-CANCEL
 16774                                        TO CM-AH-CURRENT-STATUS
 16775               MOVE SPACE
 16776                                        TO CM-AH-STATUS-AT-CANCEL
 16777           ELSE
 16778               MOVE PB-CI-AH-POLICY-STATUS
 16779                                        TO CM-AH-CURRENT-STATUS
 16780        ELSE
 16781           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16782
 16783 2450-REWRITE-CERT.
 16784     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16785     MOVE 'C'                      TO JP-RECORD-TYPE.
 16786     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16787
 16788
 16789* EXEC CICS REWRITE
 16790*        DATASET  (FILE-ID-ELCERT)
 16791*        FROM     (CERTIFICATE-MASTER)
 16792*    END-EXEC.
 16793     MOVE LENGTH OF
 16794      CERTIFICATE-MASTER
 16795       TO DFHEIV11
 16796*    MOVE '&& L                  %   #00014796' TO DFHEIV0
 16797     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16798     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16799     MOVE X'2020233030303134373936' TO DFHEIV0(25:11)
 16800     CALL 'kxdfhei1' USING DFHEIV0,
 16801           FILE-ID-ELCERT,
 16802           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 305
* EL6311.cbl
 16803           DFHEIV11,
 16804           DFHEIV99
 16805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16806
 16807
 16808     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16809
 16810     PERFORM 8400-LOG-JOURNAL-RECORD.
 16811
 16812     move ' '                    to ws-stop-sw
 16813                                    ws-any-check-sw
 16814                                    ws-proc-check-sw
 16815                                    ws-chek-browse-sw
 16816
 16817     if i-have-checks
 16818        perform until i-say-stop
 16819           perform 2510-startbr-erchek
 16820                                 thru 2510-exit
 16821           if resp-normal
 16822              perform 2520-readnext-erchek
 16823                                 thru 2520-exit
 16824           end-if
 16825           if (not resp-normal)
 16826              or (pb-control-by-account (1:33) not =
 16827                 ch-control-primary (1:33))
 16828                 set i-say-stop to true
 16829           else
 16830              perform 2530-readupd-erchek
 16831                                 thru 2530-exit
 16832              if resp-normal
 16833                 perform 2540-delete-erchek
 16834                                 thru 2540-exit
 16835              end-if
 16836              if ws-chek-browse-sw = 'Y'
 16837                 perform 2525-endbr-erchek
 16838                                 thru 2525-exit
 16839                 move ' '        to ws-chek-browse-sw
 16840              end-if
 16841           end-if
 16842        end-perform
 16843     end-if
 16844
 16845     if ws-chek-browse-sw = 'Y'
 16846        perform 2525-endbr-erchek thru 2525-exit
 16847     end-if
 16848     .
 16849 2475-CONTINUE-DELETE.
 16850     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16851     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16852
 16853     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16854     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16855
 16856     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16857
 16858     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16859     MOVE 'D'                    TO JP-RECORD-TYPE
 16860     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 306
* EL6311.cbl
 16861
 16862
 16863* EXEC CICS DELETE
 16864*        DATASET    (FILE-ID-ERPNDB)
 16865*    END-EXEC.
 16866*    MOVE '&(                    &   #00014855' TO DFHEIV0
 16867     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16868     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16869     MOVE X'2020233030303134383535' TO DFHEIV0(25:11)
 16870     CALL 'kxdfhei1' USING DFHEIV0,
 16871           FILE-ID-ERPNDB,
 16872           DFHEIV99,
 16873           DFHEIV99,
 16874           DFHEIV99,
 16875           DFHEIV99
 16876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16877
 16878
 16879     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16880
 16881     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Delete
 16882
 16883     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16884     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16885
 16886
 16887* EXEC CICS HANDLE CONDITION
 16888*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16889*    END-EXEC.
 16890*    MOVE '"$I                   ! ; #00014866' TO DFHEIV0
 16891     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16893     MOVE X'3B20233030303134383636' TO DFHEIV0(25:11)
 16894     CALL 'kxdfhei1' USING DFHEIV0
 16895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16896
 16897
 16898
 16899* EXEC CICS READ
 16900*        SET     (ADDRESS OF PENDING-BUSINESS)
 16901*        DATASET (FILE-ID-ERPNDB)
 16902*        RIDFLD  (ERPNDB-KEY)
 16903*        UPDATE
 16904*    END-EXEC.
 16905*    MOVE '&"S        EU         (   #00014870' TO DFHEIV0
 16906     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16907     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16908     MOVE X'2020233030303134383730' TO DFHEIV0(25:11)
 16909     CALL 'kxdfhei1' USING DFHEIV0,
 16910           FILE-ID-ERPNDB,
 16911           DFHEIV20,
 16912           DFHEIV99,
 16913           ERPNDB-KEY,
 16914           DFHEIV99,
 16915           DFHEIV99,
 16916           DFHEIV99
 16917     SET ADDRESS OF PENDING-BUSINESS TO
 16918         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 307
* EL6311.cbl
 16919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16920
 16921
 16922     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16923     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16924
 16925     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16926        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16927        MOVE 'D'                 TO JP-RECORD-TYPE
 16928        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16929
 16930* EXEC CICS DELETE
 16931*            DATASET    (FILE-ID-ERPNDB)
 16932*       END-EXEC
 16933*    MOVE '&(                    &   #00014884' TO DFHEIV0
 16934     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16935     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16936     MOVE X'2020233030303134383834' TO DFHEIV0(25:11)
 16937     CALL 'kxdfhei1' USING DFHEIV0,
 16938           FILE-ID-ERPNDB,
 16939           DFHEIV99,
 16940           DFHEIV99,
 16941           DFHEIV99,
 16942           DFHEIV99
 16943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16944        PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal BHDR Delete
 16945     ELSE
 16946        MOVE 'B'                 TO JP-RECORD-TYPE
 16947        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16948        PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 16949        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16950        MOVE 'C'                 TO JP-RECORD-TYPE
 16951        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16952
 16953* EXEC CICS REWRITE
 16954*            DATASET    (FILE-ID-ERPNDB)
 16955*            FROM       (PENDING-BUSINESS)
 16956*       END-EXEC
 16957     MOVE LENGTH OF
 16958      PENDING-BUSINESS
 16959       TO DFHEIV11
 16960*    MOVE '&& L                  %   #00014895' TO DFHEIV0
 16961     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16962     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16963     MOVE X'2020233030303134383935' TO DFHEIV0(25:11)
 16964     CALL 'kxdfhei1' USING DFHEIV0,
 16965           FILE-ID-ERPNDB,
 16966           PENDING-BUSINESS,
 16967           DFHEIV11,
 16968           DFHEIV99
 16969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16970        PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 16971     end-if
 16972
 16973******************************************************************
 16974*                                                                *
 16975*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16976*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 308
* EL6311.cbl
 16977*                                                                *
 16978******************************************************************
 16979
 16980     IF NOT PI-AR-PROCESSING
 16981        GO TO 2480-DELETE-FINISHED.
 16982
 16983     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16984        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16985        NEXT SENTENCE
 16986     ELSE
 16987        GO TO 2480-DELETE-FINISHED.
 16988
 16989
 16990* EXEC CICS HANDLE CONDITION
 16991*         NOTFND    (2480-DELETE-FINISHED)
 16992*    END-EXEC.
 16993*    MOVE '"$I                   ! < #00014918' TO DFHEIV0
 16994     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16995     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16996     MOVE X'3C20233030303134393138' TO DFHEIV0(25:11)
 16997     CALL 'kxdfhei1' USING DFHEIV0
 16998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16999
 17000
 17001     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 17002     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 17003
 17004
 17005* EXEC CICS READ
 17006*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 17007*        DATASET (FILE-ID-ERRQST)
 17008*        RIDFLD  (ERRQST-KEY)
 17009*        UPDATE
 17010*    END-EXEC.
 17011*    MOVE '&"S        EU         (   #00014925' TO DFHEIV0
 17012     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17013     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17014     MOVE X'2020233030303134393235' TO DFHEIV0(25:11)
 17015     CALL 'kxdfhei1' USING DFHEIV0,
 17016           FILE-ID-ERRQST,
 17017           DFHEIV20,
 17018           DFHEIV99,
 17019           ERRQST-KEY,
 17020           DFHEIV99,
 17021           DFHEIV99,
 17022           DFHEIV99
 17023     SET ADDRESS OF AR-REQUEST-RECORD TO
 17024         DFHEIV20
 17025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17026
 17027
 17028     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17029
 17030     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 17031
 17032     MOVE 'D'                      TO JP-RECORD-TYPE.
 17033     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 17034
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 309
* EL6311.cbl
 17035
 17036* EXEC CICS DELETE
 17037*         DATASET    (FILE-ID-ERRQST)
 17038*    END-EXEC.
 17039*    MOVE '&(                    &   #00014939' TO DFHEIV0
 17040     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17041     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17042     MOVE X'2020233030303134393339' TO DFHEIV0(25:11)
 17043     CALL 'kxdfhei1' USING DFHEIV0,
 17044           FILE-ID-ERRQST,
 17045           DFHEIV99,
 17046           DFHEIV99,
 17047           DFHEIV99,
 17048           DFHEIV99
 17049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17050
 17051
 17052     PERFORM 8400-LOG-JOURNAL-RECORD.
 17053
 17054 2480-DELETE-FINISHED.
 17055     MOVE ZEROS                  TO EMI-ERROR.
 17056     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17057     MOVE LOW-VALUES             TO EL631CI.
 17058     MOVE -1                     TO CMAINTL.
 17059     GO TO 8100-SEND-INITIAL-MAP.
 17060
 17061 2485-BATCH-HDR-NOT-FOUND.
 17062     MOVE -1                     TO CMAINTL
 17063     MOVE AL-UABON               TO CMAINTA.
 17064     MOVE ER-7450                TO EMI-ERROR.
 17065     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17066     GO TO 8200-SEND-DATAONLY.
 17067
 17068 2490-RECORD-NOT-FOUND.
 17069     MOVE -1                     TO CMAINTL
 17070     MOVE AL-UABON               TO CMAINTA.
 17071     MOVE ER-7451                TO EMI-ERROR.
 17072     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17073     GO TO 8200-SEND-DATAONLY.
 17074***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 17075***                                                            ***
 17076***     2500  B R O W S E   C H E C K S                        ***
 17077***  We perform this routine from 2 different places.          ***
 17078***  1. If the user changes the refund amount on a cancel, we  ***
 17079***    want to.........                                        ***
 17080***    a. determine if prior checks have been processed        ***
 17081***    b. If the amt is larger, display message instructing    ***
 17082***     them to create another check to make up the difference.***
 17083***    c. If the amt is less, do not allow the change and      ***
 17084***     display a FATAL error suggesting they deal with check  ***
 17085***     records befor continuing.                              ***
 17086***  2. If the user wants to delete a cancel record we......   ***
 17087***    a. browse through all the checks and if there is a      ***
 17088***     processed check, send FATAL message.                   ***
 17089***    b. If there is a non-released check, then delete that   ***
 17090***     check after you delete the pending cancel record.      ***
 17091***                                                            ***
 17092***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 310
* EL6311.cbl
 17093
 17094 2500-browse-checks.
 17095
 17096     perform 2510-startbr-erchek thru 2510-exit
 17097
 17098     if not resp-normal
 17099        go to 2500-exit
 17100     end-if
 17101
 17102     perform until i-say-stop
 17103        perform 2520-readnext-erchek
 17104                                 thru 2520-exit
 17105        if (not resp-normal)
 17106           or (pb-control-by-account (1:33) not =
 17107              ch-control-primary (1:33))
 17108              set i-say-stop to true
 17109        else
 17110           set i-have-a-check-period to true
 17111           if (ch-approval-status) = ' '
 17112              and (ch-void-dt = low-values)
 17113              and (ch-released-dt = low-values)
 17114              set i-have-checks to true
 17115           else
 17116              if ch-void-dt = low-values
 17117                 set i-have-processed-checks to true
 17118              end-if
 17119           end-if
 17120           if (ch-credit-accept-dt = low-values)
 17121              and (ch-void-dt = low-values)
 17122              and (ch-approval-status = ' ' OR 'P' OR 'A')
 17123              if (ch-check-origin-sw not = 'R')
 17124                 and (pb-record-type = '2')
 17125                 continue
 17126              else
 17127                 compute ws-check-amts =
 17128                    ws-check-amts + ch-amount-paid
 17129              end-if
 17130           end-if
 17131        end-if
 17132     end-perform
 17133
 17134     if ws-chek-browse-sw = 'Y'
 17135        perform 2525-endbr-erchek thru 2525-exit
 17136     end-if
 17137
 17138    .
 17139 2500-exit.
 17140     exit.
 17141
 17142 2510-startbr-erchek.
 17143
 17144     move pb-control-by-account  to erchek-key
 17145     move +0                     to chek-record-seq
 17146
 17147
 17148* exec cics startbr
 17149*       dataset   ('ERCHEK')
 17150*       ridfld    (erchek-key)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 311
* EL6311.cbl
 17151*       gteq
 17152*       resp      (ws-response)
 17153*    end-exec
 17154     MOVE 'ERCHEK' TO DFHEIV1
 17155     MOVE 0
 17156       TO DFHEIV11
 17157*    MOVE '&,         G          &  N#00015038' TO DFHEIV0
 17158     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17159     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17160     MOVE X'204E233030303135303338' TO DFHEIV0(25:11)
 17161     CALL 'kxdfhei1' USING DFHEIV0,
 17162           DFHEIV1,
 17163           erchek-key,
 17164           DFHEIV99,
 17165           DFHEIV11,
 17166           DFHEIV99
 17167     MOVE EIBRESP  TO ws-response
 17168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17169
 17170     IF RESP-NORMAL
 17171        move 'Y'                 to ws-chek-browse-sw
 17172     end-if
 17173
 17174     .
 17175 2510-exit.
 17176     exit.
 17177
 17178 2520-readnext-erchek.
 17179
 17180
 17181* EXEC CICS READNEXT
 17182*       SET     (ADDRESS OF CHECK-RECORDS)
 17183*       DATASET ('ERCHEK')
 17184*       RIDFLD  (ERCHEK-KEY)
 17185*       RESP    (WS-RESPONSE)
 17186*    END-EXEC
 17187     MOVE 'ERCHEK' TO DFHEIV1
 17188     MOVE 0
 17189       TO DFHEIV11
 17190*    MOVE '&.S                   )  N#00015055' TO DFHEIV0
 17191     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17192     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17193     MOVE X'204E233030303135303535' TO DFHEIV0(25:11)
 17194     CALL 'kxdfhei1' USING DFHEIV0,
 17195           DFHEIV1,
 17196           DFHEIV20,
 17197           DFHEIV99,
 17198           ERCHEK-KEY,
 17199           DFHEIV99,
 17200           DFHEIV11,
 17201           DFHEIV99,
 17202           DFHEIV99
 17203     SET ADDRESS OF CHECK-RECORDS TO
 17204         DFHEIV20
 17205     MOVE EIBRESP  TO WS-RESPONSE
 17206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17207
 17208     .
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 312
* EL6311.cbl
 17209 2520-exit.
 17210     exit.
 17211
 17212 2525-endbr-erchek.
 17213
 17214
 17215* exec cics endbr
 17216*       dataset  ('ERCHEK')
 17217*    end-exec
 17218     MOVE 'ERCHEK' TO DFHEIV1
 17219     MOVE 0
 17220       TO DFHEIV11
 17221*    MOVE '&2                    $   #00015068' TO DFHEIV0
 17222     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17223     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17224     MOVE X'2020233030303135303638' TO DFHEIV0(25:11)
 17225     CALL 'kxdfhei1' USING DFHEIV0,
 17226           DFHEIV1,
 17227           DFHEIV11,
 17228           DFHEIV99
 17229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17230
 17231     .
 17232 2525-exit.
 17233     exit.
 17234
 17235 2530-readupd-erchek.
 17236
 17237
 17238* EXEC CICS READ
 17239*       UPDATE
 17240*       SET     (ADDRESS OF CHECK-RECORDS)
 17241*       DATASET ('ERCHEK')
 17242*       RIDFLD  (ERCHEK-KEY)
 17243*       RESP    (WS-RESPONSE)
 17244*    END-EXEC
 17245     MOVE 'ERCHEK' TO DFHEIV1
 17246*    MOVE '&"S        EU         (  N#00015078' TO DFHEIV0
 17247     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17248     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17249     MOVE X'204E233030303135303738' TO DFHEIV0(25:11)
 17250     CALL 'kxdfhei1' USING DFHEIV0,
 17251           DFHEIV1,
 17252           DFHEIV20,
 17253           DFHEIV99,
 17254           ERCHEK-KEY,
 17255           DFHEIV99,
 17256           DFHEIV99,
 17257           DFHEIV99
 17258     SET ADDRESS OF CHECK-RECORDS TO
 17259         DFHEIV20
 17260     MOVE EIBRESP  TO WS-RESPONSE
 17261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17262
 17263     .
 17264 2530-exit.
 17265     exit.
 17266
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 313
* EL6311.cbl
 17267 2540-delete-erchek.
 17268
 17269
 17270* EXEC CICS DELETE
 17271*       DATASET ('ERCHEK')
 17272*       RESP    (WS-RESPONSE)
 17273*    END-EXEC
 17274     MOVE 'ERCHEK' TO DFHEIV1
 17275*    MOVE '&(                    &  N#00015092' TO DFHEIV0
 17276     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17277     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17278     MOVE X'204E233030303135303932' TO DFHEIV0(25:11)
 17279     CALL 'kxdfhei1' USING DFHEIV0,
 17280           DFHEIV1,
 17281           DFHEIV99,
 17282           DFHEIV99,
 17283           DFHEIV99,
 17284           DFHEIV99
 17285     MOVE EIBRESP  TO WS-RESPONSE
 17286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17287
 17288     .
 17289 2540-exit.
 17290     exit.
 17291***************************************************************
 17292*                                                             *
 17293*       B U I L D   C O R R E C T I O N   R E C O R D         *
 17294*                                                             *
 17295***************************************************************
 17296
 17297***************************************************************
 17298*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 17299*     AN ALREADY BILLED RECORD.                               *
 17300***************************************************************
 17301
 17302 2700-BUILD-CORRECTION-RECORD.
 17303     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17304     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17305     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17306     MOVE '5'                    TO DC-OPTION-CODE.
 17307     PERFORM 9700-DATE-LINK.
 17308     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17309
 17310     IF PB-CHG-COUNT = ZEROS
 17311        MOVE +1                  TO WS-SEQ-SAVE
 17312     ELSE
 17313        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 17314
 17315     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 17316     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 17317
 17318     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 17319
 17320     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17321     MOVE 'A'                    TO JP-RECORD-TYPE.
 17322     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17323
 17324
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 314
* EL6311.cbl
 17325* EXEC CICS WRITE
 17326*        DATASET    (FILE-ID-ERPNDB)
 17327*        FROM       (PENDING-BUSINESS)
 17328*        RIDFLD     (PB-CONTROL-PRIMARY)
 17329*    END-EXEC.
 17330     MOVE LENGTH OF
 17331      PENDING-BUSINESS
 17332       TO DFHEIV11
 17333*    MOVE '&$ L                  ''   #00015133' TO DFHEIV0
 17334     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17335     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17336     MOVE X'2020233030303135313333' TO DFHEIV0(25:11)
 17337     CALL 'kxdfhei1' USING DFHEIV0,
 17338           FILE-ID-ERPNDB,
 17339           PENDING-BUSINESS,
 17340           DFHEIV11,
 17341           PB-CONTROL-PRIMARY,
 17342           DFHEIV99,
 17343           DFHEIV99
 17344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17345
 17346
 17347     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17348
 17349     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Add
 17350     .
 17351 2799-EXIT.
 17352      EXIT.
 17353
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 315
* EL6311.cbl
 17355
 17356******************************************************************
 17357*                                                                *
 17358*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 17359*                 'K' transaction                                *
 17360******************************************************************
 17361
 17362 2800-REWRITE-ISSUE-CERT-KEY.
 17363     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17364
 17365     IF  BCERTNOL GREATER THAN ZEROS
 17366         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 17367
 17368     IF  BSUFIXL  GREATER THAN ZEROS
 17369         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 17370
 17371     IF  BEFFDTL  GREATER THAN ZEROS
 17372         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17373     move pi-prev-control-primary to pa-current-key
 17374     move erpndb-alt-key          to pa-new-alt-key
 17375     move spaces                  to pa-return-area
 17376
 17377
 17378* EXEC CICS LINK
 17379*       PROGRAM   ('EL055')
 17380*       COMMAREA  (EL055-PASS-AREA)
 17381*       LENGTH    (256)
 17382*    END-EXEC
 17383     MOVE 'EL055' TO DFHEIV1
 17384     MOVE 256
 17385       TO DFHEIV11
 17386*    MOVE '."C                   (   #00015169' TO DFHEIV0
 17387     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17388     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17389     MOVE X'2020233030303135313639' TO DFHEIV0(25:11)
 17390     CALL 'kxdfhei1' USING DFHEIV0,
 17391           DFHEIV1,
 17392           EL055-PASS-AREA,
 17393           DFHEIV11,
 17394           DFHEIV99,
 17395           DFHEIV99,
 17396           DFHEIV99,
 17397           DFHEIV99
 17398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17399     if ra-status-code = +99  *> found a claim
 17400        move -1                  to bmaintl
 17401        move al-uabon            to bmainta
 17402        move er-2878             to emi-error
 17403        perform 9900-error-format thru 9900-exit
 17404        go to 8200-send-dataonly
 17405     end-if
 17406
 17407     if ra-status-code = +88  *> found dup cert
 17408        move -1                  to bmaintl
 17409        move al-uabon            to bmainta
 17410        move er-0229             to emi-error
 17411        perform 9900-error-format thru 9900-exit
 17412        go to 8200-send-dataonly
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 316
* EL6311.cbl
 17413     end-if
 17414     GO TO 1325-PROCESS-ISSUE-CHANGES
 17415     .
 17416******************************************************************
 17417*                                                                *
 17418*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17419*                                                                *
 17420******************************************************************
 17421
 17422 2900-REWRITE-CAN-CERT-KEY.
 17423     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17424
 17425     IF  CCERTNOL GREATER THAN ZEROS
 17426         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17427
 17428     IF  CSUFIXL  GREATER THAN ZEROS
 17429         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17430
 17431     IF  CEFFDTL  GREATER THAN ZEROS
 17432         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17433
 17434 2910-READ-BY-ACCOUNT.
 17435
 17436* EXEC CICS HANDLE CONDITION
 17437*         NOTFND    (2920-PROCESS-REWRITE)
 17438*    END-EXEC.
 17439*    MOVE '"$I                   ! = #00015210' TO DFHEIV0
 17440     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17441     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17442     MOVE X'3D20233030303135323130' TO DFHEIV0(25:11)
 17443     CALL 'kxdfhei1' USING DFHEIV0
 17444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17445
 17446
 17447
 17448* EXEC CICS READ
 17449*        SET     (ADDRESS OF PENDING-BUSINESS)
 17450*        DATASET (FILE-ID-ERPNDB2)
 17451*        RIDFLD  (ERPNDB-ALT-KEY)
 17452*    END-EXEC.
 17453*    MOVE '&"S        E          (   #00015214' TO DFHEIV0
 17454     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17455     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17456     MOVE X'2020233030303135323134' TO DFHEIV0(25:11)
 17457     CALL 'kxdfhei1' USING DFHEIV0,
 17458           FILE-ID-ERPNDB2,
 17459           DFHEIV20,
 17460           DFHEIV99,
 17461           ERPNDB-ALT-KEY,
 17462           DFHEIV99,
 17463           DFHEIV99,
 17464           DFHEIV99
 17465     SET ADDRESS OF PENDING-BUSINESS TO
 17466         DFHEIV20
 17467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17468
 17469
 17470     GO TO 2990-DUPLICATE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 317
* EL6311.cbl
 17471
 17472  2920-PROCESS-REWRITE.
 17473
 17474* EXEC CICS HANDLE CONDITION
 17475*         NOTFND    (2985-RECORD-MISSING)
 17476*    END-EXEC.
 17477*    MOVE '"$I                   ! > #00015223' TO DFHEIV0
 17478     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17479     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17480     MOVE X'3E20233030303135323233' TO DFHEIV0(25:11)
 17481     CALL 'kxdfhei1' USING DFHEIV0
 17482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17483
 17484
 17485     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17486
 17487
 17488* EXEC CICS READ
 17489*        SET     (ADDRESS OF PENDING-BUSINESS)
 17490*        DATASET (FILE-ID-ERPNDB)
 17491*        RIDFLD  (ERPNDB-KEY)
 17492*        UPDATE
 17493*    END-EXEC.
 17494*    MOVE '&"S        EU         (   #00015229' TO DFHEIV0
 17495     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17496     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17497     MOVE X'2020233030303135323239' TO DFHEIV0(25:11)
 17498     CALL 'kxdfhei1' USING DFHEIV0,
 17499           FILE-ID-ERPNDB,
 17500           DFHEIV20,
 17501           DFHEIV99,
 17502           ERPNDB-KEY,
 17503           DFHEIV99,
 17504           DFHEIV99,
 17505           DFHEIV99
 17506     SET ADDRESS OF PENDING-BUSINESS TO
 17507         DFHEIV20
 17508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17509
 17510
 17511     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17512     MOVE 'D'                    TO JP-RECORD-TYPE.
 17513     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17514     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17515
 17516     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17517
 17518     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17519     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17520     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17521
 17522
 17523* EXEC CICS DELETE
 17524*        DATASET    (FILE-ID-ERPNDB)
 17525*    END-EXEC.
 17526*    MOVE '&(                    &   #00015247' TO DFHEIV0
 17527     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17528     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 318
* EL6311.cbl
 17529     MOVE X'2020233030303135323437' TO DFHEIV0(25:11)
 17530     CALL 'kxdfhei1' USING DFHEIV0,
 17531           FILE-ID-ERPNDB,
 17532           DFHEIV99,
 17533           DFHEIV99,
 17534           DFHEIV99,
 17535           DFHEIV99
 17536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17537
 17538
 17539     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Delete
 17540
 17541
 17542* EXEC CICS GETMAIN
 17543*        SET      (ADDRESS OF PENDING-BUSINESS)
 17544*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17545*        INITIMG  (GETMAIN-SPACE)
 17546*    END-EXEC.
 17547*    MOVE ',"IL                  $   #00015253' TO DFHEIV0
 17548     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17549     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17550     MOVE X'2020233030303135323533' TO DFHEIV0(25:11)
 17551     CALL 'kxdfhei1' USING DFHEIV0,
 17552           DFHEIV20,
 17553           ERPNDB-RECORD-LENGTH,
 17554           GETMAIN-SPACE
 17555     SET ADDRESS OF PENDING-BUSINESS TO
 17556         DFHEIV20
 17557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17558
 17559
 17560     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17561
 17562 2950-PROCESS-CANCELS.
 17563
 17564
 17565* EXEC CICS HANDLE CONDITION
 17566*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17567*    END-EXEC.
 17568*    MOVE '"$I                   ! ? #00015263' TO DFHEIV0
 17569     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17570     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17571     MOVE X'3F20233030303135323633' TO DFHEIV0(25:11)
 17572     CALL 'kxdfhei1' USING DFHEIV0
 17573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17574
 17575
 17576
 17577* EXEC CICS READ
 17578*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17579*        DATASET (FILE-ID-ELCERT)
 17580*        RIDFLD  (ELCERT-KEY)
 17581*        UPDATE
 17582*    END-EXEC.
 17583*    MOVE '&"S        EU         (   #00015267' TO DFHEIV0
 17584     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17585     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17586     MOVE X'2020233030303135323637' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 319
* EL6311.cbl
 17587     CALL 'kxdfhei1' USING DFHEIV0,
 17588           FILE-ID-ELCERT,
 17589           DFHEIV20,
 17590           DFHEIV99,
 17591           ELCERT-KEY,
 17592           DFHEIV99,
 17593           DFHEIV99,
 17594           DFHEIV99
 17595     SET ADDRESS OF CERTIFICATE-MASTER TO
 17596         DFHEIV20
 17597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17598
 17599
 17600     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17601
 17602     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17603     MOVE 'B'                      TO JP-RECORD-TYPE.
 17604     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17605     PERFORM 8400-LOG-JOURNAL-RECORD.
 17606
 17607     IF PB-CI-LIVES NOT NUMERIC
 17608         MOVE ZERO                    TO PB-CI-LIVES.
 17609
 17610     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17611        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17612        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17613        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17614                                         CM-LF-CANCEL-DT
 17615     ELSE
 17616        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17617        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17618        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17619        MOVE PB-CI-LIVES              TO CM-LIVES.
 17620
 17621     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17622        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17623            MOVE CM-LF-STATUS-AT-CANCEL
 17624                                     TO CM-LF-CURRENT-STATUS
 17625            MOVE SPACE
 17626                                     TO CM-LF-STATUS-AT-CANCEL
 17627        ELSE
 17628            MOVE PB-CI-LF-POLICY-STATUS
 17629                                     TO CM-LF-CURRENT-STATUS
 17630     ELSE
 17631        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17632
 17633     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17634        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17635        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17636        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17637                                         CM-AH-CANCEL-DT
 17638     ELSE
 17639        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17640        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17641        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17642        MOVE PB-CI-LIVES              TO CM-LIVES.
 17643
 17644     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 320
* EL6311.cbl
 17645        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17646            MOVE CM-AH-STATUS-AT-CANCEL
 17647                                     TO CM-AH-CURRENT-STATUS
 17648            MOVE SPACE
 17649                                     TO CM-AH-STATUS-AT-CANCEL
 17650        ELSE
 17651            MOVE PB-CI-AH-POLICY-STATUS
 17652                                     TO CM-AH-CURRENT-STATUS
 17653     ELSE
 17654        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17655
 17656 2975-REWRITE-CERT.
 17657     MOVE 'C'                      TO JP-RECORD-TYPE.
 17658     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17659
 17660
 17661* EXEC CICS REWRITE
 17662*        DATASET    (FILE-ID-ELCERT)
 17663*        FROM       (CERTIFICATE-MASTER)
 17664*    END-EXEC.
 17665     MOVE LENGTH OF
 17666      CERTIFICATE-MASTER
 17667       TO DFHEIV11
 17668*    MOVE '&& L                  %   #00015334' TO DFHEIV0
 17669     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17670     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17671     MOVE X'2020233030303135333334' TO DFHEIV0(25:11)
 17672     CALL 'kxdfhei1' USING DFHEIV0,
 17673           FILE-ID-ELCERT,
 17674           CERTIFICATE-MASTER,
 17675           DFHEIV11,
 17676           DFHEIV99
 17677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17678
 17679
 17680     PERFORM 8400-LOG-JOURNAL-RECORD.
 17681
 17682 2960-BUILD-NEW-CANCEL-RECORD.
 17683     IF  CCERTNOL GREATER THAN ZEROS
 17684         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17685
 17686     IF  CSUFIXL  GREATER THAN ZEROS
 17687         MOVE CSUFIXI             TO PB-CERT-SFX.
 17688
 17689     IF  CEFFDTL  GREATER  THAN ZEROS
 17690         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17691
 17692 2970-WRITE-PENDING-BUSINESS.
 17693     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17694     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17695     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17696     MOVE '5'                    TO DC-OPTION-CODE.
 17697     PERFORM 9700-DATE-LINK.
 17698     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17699
 17700     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17701
 17702     MOVE SPACES                 TO PB-CI-INSURED-NAME
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 321
* EL6311.cbl
 17703                                    PB-CI-INSURED-SEX
 17704                                    PB-CI-LF-BENEFIT-CD
 17705                                    PB-CI-AH-BENEFIT-CD
 17706                                    PB-CI-RATE-CLASS
 17707                                    PB-CI-RATE-DEV-LF
 17708                                    PB-CI-RATE-DEV-AH
 17709                                    PB-CI-LF-ABBR
 17710                                    PB-CI-AH-ABBR
 17711                                    PB-CI-OB-FLAG
 17712                                    PB-CI-LF-POLICY-STATUS
 17713                                    PB-CI-AH-POLICY-STATUS
 17714                                    PB-CI-INDV-GRP-CD
 17715                                    PB-CI-BENEFICIARY-NAME
 17716                                    PB-CI-NOTE-SW
 17717                                    PB-CI-SOC-SEC-NO
 17718                                    PB-CI-MEMBER-NO
 17719                                    PB-CI-INT-CODE
 17720                                    PB-CI-COMP-EXCP-SW
 17721                                    PB-CI-ENTRY-STATUS
 17722                                    PB-CI-CREDIT-INTERFACE-SW-1
 17723                                    PB-CI-CREDIT-INTERFACE-SW-2
 17724                                    PB-CI-ENTRY-BATCH.
 17725
 17726     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17727                                    PB-CI-AH-SETTLEMENT-DT
 17728                                    PB-CI-DEATH-DT
 17729                                    PB-CI-LF-PRIOR-CANCEL-DT
 17730                                    PB-CI-AH-PRIOR-CANCEL-DT
 17731                                    PB-CI-LOAN-1ST-PMT-DT
 17732                                    PB-CI-ENTRY-DT
 17733                                    PB-CI-LF-EXPIRE-DT
 17734                                    PB-CI-AH-EXPIRE-DT.
 17735
 17736     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17737                                    PB-CI-LF-TERM
 17738                                    PB-CI-LF-BENEFIT-AMT
 17739                                    PB-CI-LF-ALT-BENEFIT-AMT
 17740                                    PB-CI-LF-PREMIUM-AMT
 17741                                    PB-CI-LF-ALT-PREMIUM-AMT
 17742                                    PB-CI-AH-TERM
 17743                                    PB-CI-AH-BENEFIT-AMT
 17744                                    PB-CI-AH-PREMIUM-AMT
 17745                                    PB-CI-RATE-DEV-PCT-LF
 17746                                    PB-CI-RATE-DEV-PCT-AH
 17747                                    PB-CI-LIFE-COMMISSION
 17748                                    PB-CI-AH-COMMISSION
 17749                                    PB-CI-PAY-FREQUENCY
 17750                                    PB-CI-LOAN-APR
 17751                                    PB-CI-LOAN-TERM
 17752                                    PB-CI-CURR-SEQ
 17753                                    PB-CI-AH-CANCEL-AMT
 17754                                    PB-CI-LF-CANCEL-AMT
 17755                                    PB-CI-EXTENTION-DAYS
 17756                                    PB-CI-TERM-IN-DAYS
 17757                                    PB-CI-LOAN-OFFICER
 17758                                    PB-CI-LIVES
 17759                                    PB-CI-LF-CRIT-PER
 17760                                    PB-CI-AH-CRIT-PER
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 322
* EL6311.cbl
 17761                                    PB-C-LF-REM-TERM
 17762                                    PB-C-AH-REM-TERM.
 17763
 17764     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17765     MOVE 'A'                    TO JP-RECORD-TYPE.
 17766     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17767
 17768
 17769* EXEC CICS HANDLE CONDITION
 17770*        DUPREC   (2990-DUPLICATE-RECORD)
 17771*    END-EXEC.
 17772*    MOVE '"$%                   ! @ #00015427' TO DFHEIV0
 17773     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17775     MOVE X'4020233030303135343237' TO DFHEIV0(25:11)
 17776     CALL 'kxdfhei1' USING DFHEIV0
 17777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17778
 17779
 17780
 17781* EXEC CICS WRITE
 17782*        DATASET  (FILE-ID-ERPNDB)
 17783*        FROM     (PENDING-BUSINESS)
 17784*        RIDFLD   (PB-CONTROL-PRIMARY)
 17785*    END-EXEC.
 17786     MOVE LENGTH OF
 17787      PENDING-BUSINESS
 17788       TO DFHEIV11
 17789*    MOVE '&$ L                  ''   #00015431' TO DFHEIV0
 17790     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17791     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17792     MOVE X'2020233030303135343331' TO DFHEIV0(25:11)
 17793     CALL 'kxdfhei1' USING DFHEIV0,
 17794           FILE-ID-ERPNDB,
 17795           PENDING-BUSINESS,
 17796           DFHEIV11,
 17797           PB-CONTROL-PRIMARY,
 17798           DFHEIV99,
 17799           DFHEIV99
 17800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17801
 17802
 17803     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17804
 17805     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Add
 17806
 17807     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17808
 17809 2985-RECORD-MISSING.
 17810     MOVE -1                     TO CMAINTL
 17811     MOVE AL-UABON               TO CMAINTA.
 17812
 17813     MOVE ER-2902                TO EMI-ERROR.
 17814     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17815     GO TO 8200-SEND-DATAONLY.
 17816
 17817 2990-DUPLICATE-RECORD.
 17818     MOVE SPACE                  TO CMAINTI.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 323
* EL6311.cbl
 17819     MOVE -1                     TO CMAINTL.
 17820     MOVE AL-UABON               TO CCERTNOA.
 17821     MOVE AL-UNBON               TO CEFFDTA.
 17822
 17823     MOVE 1                      TO EMI-SUB
 17824                                    EMI-SWITCH1
 17825                                    EMI-SWITCH-AREA-1
 17826                                    EMI-SWITCH-AREA-2.
 17827     MOVE SPACES                 TO EMI-ERROR-LINES.
 17828
 17829
 17830* EXEC CICS SYNCPOINT ROLLBACK
 17831*    END-EXEC.
 17832*    MOVE '6"R                   !   #00015463' TO DFHEIV0
 17833     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17834     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17835     MOVE X'2020233030303135343633' TO DFHEIV0(25:11)
 17836     CALL 'kxdfhei1' USING DFHEIV0
 17837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17838
 17839
 17840     MOVE ER-2247                TO EMI-ERROR.
 17841     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17842     GO TO 8200-SEND-DATAONLY.
 17843
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 324
* EL6311.cbl
 17845
 17846***************************************************************
 17847*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17848*     PREMIUM FOR A SINGLE BATCH.                             *
 17849*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17850***************************************************************
 17851
 17852 3000-BATCH-MAINLINE.
 17853     IF PI-PREV-KEY NOT = SPACES
 17854         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17855     ELSE
 17856         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17857
 17858     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17859
 17860 3010-READNEXT.
 17861
 17862* EXEC CICS READ
 17863*         DATASET    (FILE-ID-ERPNDB)
 17864*         SET        (ADDRESS OF PENDING-BUSINESS)
 17865*         RIDFLD     (ERPNDB-KEY)
 17866*         GTEQ
 17867*    END-EXEC.
 17868*    MOVE '&"S        G          (   #00015487' TO DFHEIV0
 17869     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17870     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17871     MOVE X'2020233030303135343837' TO DFHEIV0(25:11)
 17872     CALL 'kxdfhei1' USING DFHEIV0,
 17873           FILE-ID-ERPNDB,
 17874           DFHEIV20,
 17875           DFHEIV99,
 17876           ERPNDB-KEY,
 17877           DFHEIV99,
 17878           DFHEIV99,
 17879           DFHEIV99
 17880     SET ADDRESS OF PENDING-BUSINESS TO
 17881         DFHEIV20
 17882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17883
 17884
 17885     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17886        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17887          GO TO 3030-END-BATCH.
 17888
 17889     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17890
 17891     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17892        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17893          GO TO 3020-BUMP-SEQ.
 17894
 17895     IF PB-ISSUE
 17896        ADD +1                   TO WS-ISS-TOTAL-CNT
 17897        IF PB-FATAL-ERRORS
 17898           ADD +1                      TO WS-ISS-FATAL-CNT
 17899           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17900           GO TO 3020-BUMP-SEQ
 17901        ELSE
 17902           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 325
* EL6311.cbl
 17903              ADD +1                      TO WS-ISS-FORCE-CNT
 17904              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17905              GO TO 3020-BUMP-SEQ
 17906           ELSE
 17907              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17908                 ADD +1                      TO WS-ISS-HOLD-CNT
 17909                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17910                 GO TO 3020-BUMP-SEQ
 17911              ELSE
 17912                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17913                     THRU  3299-EXIT
 17914                 GO TO 3020-BUMP-SEQ.
 17915
 17916     IF PB-CANCELLATION
 17917        ADD +1                   TO WS-CAN-TOTAL-CNT
 17918        IF PB-FATAL-ERRORS
 17919           ADD +1                 TO WS-CAN-FATAL-CNT
 17920           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17921           GO TO 3020-BUMP-SEQ
 17922        ELSE
 17923           IF PB-UNFORCED-ERRORS
 17924              ADD +1                 TO WS-CAN-FORCE-CNT
 17925              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17926              GO TO 3020-BUMP-SEQ
 17927           ELSE
 17928              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17929                 ADD +1                 TO WS-CAN-HOLD-CNT
 17930                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17931                 GO TO 3020-BUMP-SEQ
 17932              ELSE
 17933                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17934                     THRU  3499-EXIT
 17935                 GO TO 3020-BUMP-SEQ.
 17936
 17937     IF PB-BATCH-TRAILER
 17938         GO TO 3030-END-BATCH.
 17939
 17940 3020-BUMP-SEQ.
 17941     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17942     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17943     GO TO 3010-READNEXT.
 17944
 17945 3030-END-BATCH.
 17946     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17947     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17948     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17949     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17950
 17951     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17952                                          - WS-ISS-FORCE-CNT
 17953                                          - WS-ISS-HOLD-CNT).
 17954
 17955     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17956     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17957
 17958     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17959     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17960     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 326
* EL6311.cbl
 17961     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17962     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17963                                          - WS-CAN-FORCE-CNT
 17964                                          - WS-CAN-HOLD-CNT).
 17965     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17966     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17967
 17968     COMPUTE WS-NET-TOTAL-CNT
 17969         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17970     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17971     COMPUTE WS-NET-FATAL-CNT
 17972         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17973     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17974     COMPUTE WS-NET-FORCE-CNT
 17975         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17976     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17977     COMPUTE WS-NET-HOLD-CNT
 17978         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17979     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17980
 17981     COMPUTE WS-NET-AVAIL-CNT
 17982          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17983                              - WS-ISS-FORCE-CNT
 17984                              - WS-ISS-HOLD-CNT)
 17985          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17986                              - WS-CAN-FORCE-CNT
 17987                              - WS-CAN-HOLD-CNT).
 17988     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17989
 17990     COMPUTE WS-NET-GOOD-PREM
 17991         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17992     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17993     COMPUTE WS-NET-BAD-PREM
 17994         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17995     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17996
 17997     MOVE 0000                   TO EMI-ERROR.
 17998     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17999     MOVE -1                     TO DPFENTRL.
 18000     GO TO 8200-SEND-DATAONLY.
 18001
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 327
* EL6311.cbl
 18003
 18004******************************************************************
 18005*                                                                *
 18006*           A D D    B A D   I S S U E   P R E M I U M           *
 18007*                                                                *
 18008******************************************************************
 18009
 18010 3100-ADD-BAD-ISSUE-PREM.
 18011     IF PB-OVERRIDE-LIFE
 18012       OR PB-OVERRIDE-BOTH
 18013           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18014           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18015       ELSE
 18016           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18017           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18018
 18019     IF PB-OVERRIDE-AH
 18020       OR PB-OVERRIDE-BOTH
 18021           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18022       ELSE
 18023           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18024
 18025 3199-EXIT.
 18026     EXIT.
 18027
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 328
* EL6311.cbl
 18029
 18030******************************************************************
 18031*                                                                *
 18032*       A D D   G O O D   I S S U E   P R E M I U M              *
 18033*                                                                *
 18034******************************************************************
 18035
 18036 3200-ADD-GOOD-ISSUE-PREM.
 18037     IF PB-OVERRIDE-LIFE
 18038       OR PB-OVERRIDE-BOTH
 18039           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18040           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18041       ELSE
 18042           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18043           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18044
 18045     IF PB-OVERRIDE-AH
 18046       OR PB-OVERRIDE-BOTH
 18047           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18048       ELSE
 18049           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18050
 18051 3299-EXIT.
 18052     EXIT.
 18053
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 329
* EL6311.cbl
 18055
 18056
 18057******************************************************************
 18058*                                                                *
 18059*        A D D   B A D   C A N C E L   P R E M I U M             *
 18060*                                                                *
 18061******************************************************************
 18062
 18063 3300-ADD-BAD-CANCEL-PREM.
 18064     IF PB-OVERRIDE-LIFE
 18065       OR PB-OVERRIDE-BOTH
 18066           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18067       ELSE
 18068           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18069
 18070     IF PB-OVERRIDE-AH
 18071       OR PB-OVERRIDE-BOTH
 18072           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18073       ELSE
 18074           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18075
 18076 3399-EXIT.
 18077     EXIT.
 18078
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 330
* EL6311.cbl
 18080
 18081******************************************************************
 18082*                                                                *
 18083*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18084*                                                                *
 18085******************************************************************
 18086
 18087 3400-ADD-GOOD-CANCEL-PREM.
 18088     IF PB-OVERRIDE-LIFE
 18089       OR PB-OVERRIDE-BOTH
 18090           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18091       ELSE
 18092           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18093
 18094     IF PB-OVERRIDE-AH
 18095       OR PB-OVERRIDE-BOTH
 18096           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18097       ELSE
 18098           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18099
 18100 3499-EXIT.
 18101     EXIT.
 18102
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 331
* EL6311.cbl
 18104
 18105******************************************************************
 18106*                                                                *
 18107*           E D I T   B A T C H   D A T A                        *
 18108*                                                                *
 18109******************************************************************
 18110
 18111 3500-EDIT-BATCH-DATA.
 18112     IF PI-PREV-KEY NOT = SPACES
 18113        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18114     ELSE
 18115        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18116
 18117     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18118     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18119
 18120
 18121* EXEC CICS HANDLE CONDITION
 18122*         NOTFND      (3590-NOT-FOUND)
 18123*    END-EXEC.
 18124*    MOVE '"$I                   ! A #00015729' TO DFHEIV0
 18125     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18126     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18127     MOVE X'4120233030303135373239' TO DFHEIV0(25:11)
 18128     CALL 'kxdfhei1' USING DFHEIV0
 18129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18130
 18131
 18132     IF DRISSL   GREATER THAN ZEROS OR
 18133        DRISSL   GREATER THAN ZEROS OR
 18134        DRLFPRML GREATER THAN ZEROS OR
 18135        DRAHPRML GREATER THAN ZEROS OR
 18136        DRCANCL  GREATER THAN ZEROS OR
 18137        DRLFRFDL GREATER THAN ZEROS OR
 18138        DRAHRFDL GREATER THAN ZEROS
 18139              NEXT SENTENCE
 18140          ELSE
 18141              MOVE ER-3224    TO EMI-ERROR
 18142              MOVE -1         TO DPFENTRL
 18143              MOVE AL-UNBON   TO DPFENTRA
 18144              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18145              GO TO 8200-SEND-DATAONLY.
 18146
 18147     IF NOT MODIFY-CAP
 18148         MOVE 'UPDATE'       TO SM-READ
 18149         PERFORM 9995-SECURITY-VIOLATION
 18150         MOVE ER-0070        TO EMI-ERROR
 18151         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18152         GO TO 8100-SEND-INITIAL-MAP.
 18153
 18154        IF DRISSL GREATER THAN ZEROS
 18155           MOVE AL-UNNON         TO DRISSA
 18156           MOVE DRISSI           TO DEEDIT-FIELD
 18157           PERFORM 8600-DEEDIT
 18158           IF DEEDIT-FIELD-V0  NUMERIC
 18159              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18160           ELSE
 18161              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 332
* EL6311.cbl
 18162              MOVE -1         TO DRISSL
 18163              MOVE AL-UNBON   TO DRISSA
 18164              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18165
 18166        IF DRLFPRML GREATER THAN ZEROS
 18167           MOVE AL-UNNON         TO DRLFPRMA
 18168
 18169* EXEC CICS BIF DEEDIT
 18170*              FIELD  (DRLFPRMI)
 18171*              LENGTH (11)
 18172*          END-EXEC
 18173     MOVE 11
 18174       TO DFHEIV11
 18175*    MOVE '@"L                   #   #00015769' TO DFHEIV0
 18176     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18177     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18178     MOVE X'2020233030303135373639' TO DFHEIV0(25:11)
 18179     CALL 'kxdfhei1' USING DFHEIV0,
 18180           DRLFPRMI,
 18181           DFHEIV11
 18182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18183           IF DRLFPRMI NUMERIC
 18184              MOVE DRLFPRMI   TO WS-DRLFPRM
 18185*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18186*          PERFORM 8600-DEEDIT
 18187*          IF DEEDIT-FIELD-V2  NUMERIC
 18188*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18189           ELSE
 18190              MOVE ER-2223    TO EMI-ERROR
 18191              MOVE -1         TO DRLFPRML
 18192              MOVE AL-UNBON   TO DRLFPRMA
 18193              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18194
 18195        IF DRAHPRML GREATER THAN ZEROS
 18196           MOVE AL-UNNON         TO DRAHPRMA
 18197
 18198* EXEC CICS BIF DEEDIT
 18199*              FIELD  (DRAHPRMI)
 18200*              LENGTH (11)
 18201*          END-EXEC
 18202     MOVE 11
 18203       TO DFHEIV11
 18204*    MOVE '@"L                   #   #00015787' TO DFHEIV0
 18205     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18206     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18207     MOVE X'2020233030303135373837' TO DFHEIV0(25:11)
 18208     CALL 'kxdfhei1' USING DFHEIV0,
 18209           DRAHPRMI,
 18210           DFHEIV11
 18211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18212           IF DRAHPRMI NUMERIC
 18213              MOVE DRAHPRMI   TO WS-DRAHPRM
 18214*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18215*          PERFORM 8600-DEEDIT
 18216*          IF DEEDIT-FIELD-V2  NUMERIC
 18217*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18218           ELSE
 18219              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 333
* EL6311.cbl
 18220              MOVE -1         TO DRAHPRML
 18221              MOVE AL-UNBON   TO DRAHPRMA
 18222              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18223
 18224        IF DRCANCL GREATER THAN ZEROS
 18225           MOVE AL-UNNON         TO DRCANCA
 18226           MOVE DRCANCI          TO DEEDIT-FIELD
 18227           PERFORM 8600-DEEDIT
 18228           IF DEEDIT-FIELD-V0  NUMERIC
 18229              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18230           ELSE
 18231              MOVE ER-2223    TO EMI-ERROR
 18232              MOVE -1         TO DRCANCL
 18233              MOVE AL-UNBON   TO DRCANCL
 18234              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18235
 18236        IF DRLFRFDL GREATER THAN ZEROS
 18237           MOVE AL-UNNON         TO DRLFRFDA
 18238
 18239* EXEC CICS BIF DEEDIT
 18240*              FIELD  (DRLFRFDI)
 18241*              LENGTH (11)
 18242*          END-EXEC
 18243     MOVE 11
 18244       TO DFHEIV11
 18245*    MOVE '@"L                   #   #00015817' TO DFHEIV0
 18246     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18247     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18248     MOVE X'2020233030303135383137' TO DFHEIV0(25:11)
 18249     CALL 'kxdfhei1' USING DFHEIV0,
 18250           DRLFRFDI,
 18251           DFHEIV11
 18252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18253           IF DRLFRFDI NUMERIC
 18254              MOVE DRLFRFDI   TO WS-DRLFRFD
 18255*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18256*          PERFORM 8600-DEEDIT
 18257*          IF DEEDIT-FIELD-V2  NUMERIC
 18258*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18259           ELSE
 18260              MOVE ER-2223    TO EMI-ERROR
 18261              MOVE -1         TO DRLFRFDL
 18262              MOVE AL-UNBON   TO DRLFRFDA
 18263              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18264
 18265        IF DRAHRFDL GREATER THAN ZEROS
 18266           MOVE AL-UNNON         TO DRAHRFDA
 18267
 18268* EXEC CICS BIF DEEDIT
 18269*              FIELD  (DRAHRFDI)
 18270*              LENGTH (11)
 18271*          END-EXEC
 18272     MOVE 11
 18273       TO DFHEIV11
 18274*    MOVE '@"L                   #   #00015835' TO DFHEIV0
 18275     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18276     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18277     MOVE X'2020233030303135383335' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 334
* EL6311.cbl
 18278     CALL 'kxdfhei1' USING DFHEIV0,
 18279           DRAHRFDI,
 18280           DFHEIV11
 18281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18282           IF DRAHRFDI NUMERIC
 18283              MOVE DRAHRFDI   TO WS-DRAHRFD
 18284*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18285*          PERFORM 8600-DEEDIT
 18286*          IF DEEDIT-FIELD-V2  NUMERIC
 18287*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18288           ELSE
 18289              MOVE ER-2223    TO EMI-ERROR
 18290              MOVE -1         TO DRAHRFDL
 18291              MOVE AL-UNBON   TO DRAHRFDA
 18292              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18293
 18294     IF EMI-ERROR = ZEROS
 18295        GO 3600-UPDATE-BATCH-HEADER.
 18296
 18297     GO TO 8200-SEND-DATAONLY.
 18298
 18299 3590-NOT-FOUND.
 18300     MOVE ER-2192                TO EMI-ERROR.
 18301     MOVE -1                     TO DPFENTRL.
 18302     MOVE AL-UNBON               TO DPFENTRA.
 18303     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18304     GO TO 8200-SEND-DATAONLY.
 18305
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 335
* EL6311.cbl
 18307
 18308******************************************************************
 18309*                                                                *
 18310*           U P D A T E   B A T C H   H E A D E R                *
 18311*                                                                *
 18312******************************************************************
 18313
 18314 3600-UPDATE-BATCH-HEADER.
 18315
 18316* EXEC CICS HANDLE CONDITION
 18317*         NOTFND      (3690-NOT-FOUND)
 18318*    END-EXEC.
 18319*    MOVE '"$I                   ! B #00015872' TO DFHEIV0
 18320     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18321     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18322     MOVE X'4220233030303135383732' TO DFHEIV0(25:11)
 18323     CALL 'kxdfhei1' USING DFHEIV0
 18324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18325
 18326
 18327
 18328* EXEC CICS READ
 18329*        DATASET (FILE-ID-ERPNDB)
 18330*        RIDFLD  (ERPNDB-KEY)
 18331*        SET     (ADDRESS OF PENDING-BUSINESS)
 18332*        UPDATE
 18333*    END-EXEC.
 18334*    MOVE '&"S        EU         (   #00015876' TO DFHEIV0
 18335     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18336     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18337     MOVE X'2020233030303135383736' TO DFHEIV0(25:11)
 18338     CALL 'kxdfhei1' USING DFHEIV0,
 18339           FILE-ID-ERPNDB,
 18340           DFHEIV20,
 18341           DFHEIV99,
 18342           ERPNDB-KEY,
 18343           DFHEIV99,
 18344           DFHEIV99,
 18345           DFHEIV99
 18346     SET ADDRESS OF PENDING-BUSINESS TO
 18347         DFHEIV20
 18348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18349
 18350
 18351     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18352     MOVE 'B'                    TO JP-RECORD-TYPE.
 18353     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18354
 18355     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18356
 18357     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 18358
 18359     IF DRISSL GREATER THAN ZEROS
 18360        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18361
 18362     IF DRCANCL GREATER THAN ZEROS
 18363        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18364
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 336
* EL6311.cbl
 18365
 18366     IF DRLFPRML GREATER THAN ZEROS
 18367        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18368
 18369     IF DRAHPRML GREATER THAN ZEROS
 18370        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18371
 18372     IF DRLFRFDL GREATER THAN ZEROS
 18373        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18374
 18375     IF DRAHRFDL GREATER THAN ZEROS
 18376        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18377
 18378 3670-REWRITE-BATCH-HEADER.
 18379     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18380        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18381        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18382        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18383        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18384        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18385        MOVE SPACE               TO PB-OUT-BAL-CD
 18386     ELSE
 18387        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18388
 18389     MOVE 'C'                    TO JP-RECORD-TYPE.
 18390     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18391
 18392
 18393* EXEC CICS REWRITE
 18394*         DATASET      (FILE-ID-ERPNDB)
 18395*         FROM         (PENDING-BUSINESS)
 18396*    END-EXEC.
 18397     MOVE LENGTH OF
 18398      PENDING-BUSINESS
 18399       TO DFHEIV11
 18400*    MOVE '&& L                  %   #00015924' TO DFHEIV0
 18401     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18402     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18403     MOVE X'2020233030303135393234' TO DFHEIV0(25:11)
 18404     CALL 'kxdfhei1' USING DFHEIV0,
 18405           FILE-ID-ERPNDB,
 18406           PENDING-BUSINESS,
 18407           DFHEIV11,
 18408           DFHEIV99
 18409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18410
 18411
 18412     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 18413
 18414     GO TO 7200-DISPLAY-BATCHES.
 18415
 18416 3690-NOT-FOUND.
 18417     MOVE ER-2192                TO EMI-ERROR.
 18418     MOVE -1                     TO DPFENTRL.
 18419     MOVE AL-UNBON               TO DPFENTRA.
 18420     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18421     GO TO 8200-SEND-DATAONLY.
 18422
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 337
* EL6311.cbl
 18424
 18425******************************************************************
 18426*                                                                *
 18427*           R E - D I S P L A Y   R E C O R D                    *
 18428*                                                                *
 18429******************************************************************
 18430
 18431 3900-RE-DISPLAY-RECORD.
 18432
 18433* EXEC CICS HANDLE CONDITION
 18434*         NOTFND   (3990-NOT-FOUND)
 18435*    END-EXEC.
 18436*    MOVE '"$I                   ! C #00015949' TO DFHEIV0
 18437     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18438     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18439     MOVE X'4320233030303135393439' TO DFHEIV0(25:11)
 18440     CALL 'kxdfhei1' USING DFHEIV0
 18441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18442
 18443
 18444     IF PI-DISPLAY-ORIGINAL-BATCH
 18445         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18446     ELSE
 18447         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18448
 18449
 18450* EXEC CICS READ
 18451*         DATASET   (FILE-ID)
 18452*         RIDFLD    (PI-PREV-KEY)
 18453*         SET       (ADDRESS OF PENDING-BUSINESS)
 18454*    END-EXEC.
 18455*    MOVE '&"S        E          (   #00015958' TO DFHEIV0
 18456     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18457     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18458     MOVE X'2020233030303135393538' TO DFHEIV0(25:11)
 18459     CALL 'kxdfhei1' USING DFHEIV0,
 18460           FILE-ID,
 18461           DFHEIV20,
 18462           DFHEIV99,
 18463           PI-PREV-KEY,
 18464           DFHEIV99,
 18465           DFHEIV99,
 18466           DFHEIV99
 18467     SET ADDRESS OF PENDING-BUSINESS TO
 18468         DFHEIV20
 18469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18470
 18471
 18472     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18473
 18474     IF PB-ISSUE
 18475         GO TO 7000-DISPLAY-ISSUES.
 18476
 18477     IF PB-CANCELLATION
 18478         GO TO 7100-DISPLAY-CANCELS.
 18479
 18480     IF PB-BATCH-TRAILER
 18481         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 338
* EL6311.cbl
 18482
 18483 3990-NOT-FOUND.
 18484     MOVE LOW-VALUES             TO EL631BI.
 18485
 18486     IF PI-MAP-NAME = EL631B
 18487         MOVE -1                  TO BMAINTL
 18488     ELSE
 18489         MOVE -1                  TO CMAINTL.
 18490
 18491     GO TO 8100-SEND-INITIAL-MAP.
 18492
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 339
* EL6311.cbl
 18494
 18495***************************************************************
 18496*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18497*                                                             *
 18498*      1. START BROWSE WITH                                   *
 18499*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18500*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18501*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18502*                                                             *
 18503*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18504*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18505*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18506*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18507*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18508*               AND IS IT TO BE DISPLAYED.                    *
 18509*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18510*               DISPLAYED.                                    *
 18511*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18512*               DISPLAYED.                                    *
 18513*                                                             *
 18514*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18515*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18516***************************************************************
 18517
 18518 4000-BROWSE-DETAIL-FORWARD.
 18519     IF FIRST-TIME
 18520        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18521     ELSE
 18522        IF SHOW-RECORD
 18523           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18524           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18525           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18526           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18527           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18528        ELSE
 18529           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18530
 18531
 18532* EXEC CICS HANDLE CONDITION
 18533*         NOTFND   (4050-END-RECORDS)
 18534*         ENDFILE  (4050-END-RECORDS)
 18535*    END-EXEC.
 18536*    MOVE '"$I''                  ! D #00016023' TO DFHEIV0
 18537     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18538     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18539     MOVE X'4420233030303136303233' TO DFHEIV0(25:11)
 18540     CALL 'kxdfhei1' USING DFHEIV0
 18541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18542
 18543
 18544
 18545* EXEC CICS STARTBR
 18546*         DATASET   (FILE-ID-ERPNDB2)
 18547*         RIDFLD    (ERPNDB-ALT-KEY)
 18548*    END-EXEC.
 18549     MOVE 0
 18550       TO DFHEIV11
 18551*    MOVE '&,         G          &   #00016028' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 340
* EL6311.cbl
 18552     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18553     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18554     MOVE X'2020233030303136303238' TO DFHEIV0(25:11)
 18555     CALL 'kxdfhei1' USING DFHEIV0,
 18556           FILE-ID-ERPNDB2,
 18557           ERPNDB-ALT-KEY,
 18558           DFHEIV99,
 18559           DFHEIV11,
 18560           DFHEIV99
 18561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18562
 18563
 18564     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18565
 18566     IF FIRST-TIME OR SHOW-RECORD
 18567        MOVE SPACE               TO WS-FIRST-TIME-SW
 18568        GO TO 4005-READ-NEXT-RECORD.
 18569
 18570
 18571* EXEC CICS READNEXT
 18572*         DATASET    (FILE-ID-ERPNDB2)
 18573*         SET        (ADDRESS OF PENDING-BUSINESS)
 18574*         RIDFLD     (ERPNDB-ALT-KEY)
 18575*    END-EXEC.
 18576     MOVE 0
 18577       TO DFHEIV11
 18578*    MOVE '&.S                   )   #00016039' TO DFHEIV0
 18579     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18580     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18581     MOVE X'2020233030303136303339' TO DFHEIV0(25:11)
 18582     CALL 'kxdfhei1' USING DFHEIV0,
 18583           FILE-ID-ERPNDB2,
 18584           DFHEIV20,
 18585           DFHEIV99,
 18586           ERPNDB-ALT-KEY,
 18587           DFHEIV99,
 18588           DFHEIV11,
 18589           DFHEIV99,
 18590           DFHEIV99
 18591     SET ADDRESS OF PENDING-BUSINESS TO
 18592         DFHEIV20
 18593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18594
 18595
 18596 4005-READ-NEXT-RECORD.
 18597
 18598* EXEC CICS READNEXT
 18599*         DATASET    (FILE-ID-ERPNDB2)
 18600*         SET        (ADDRESS OF PENDING-BUSINESS)
 18601*         RIDFLD     (ERPNDB-ALT-KEY)
 18602*    END-EXEC.
 18603     MOVE 0
 18604       TO DFHEIV11
 18605*    MOVE '&.S                   )   #00016046' TO DFHEIV0
 18606     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18607     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18608     MOVE X'2020233030303136303436' TO DFHEIV0(25:11)
 18609     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 341
* EL6311.cbl
 18610           FILE-ID-ERPNDB2,
 18611           DFHEIV20,
 18612           DFHEIV99,
 18613           ERPNDB-ALT-KEY,
 18614           DFHEIV99,
 18615           DFHEIV11,
 18616           DFHEIV99,
 18617           DFHEIV99
 18618     SET ADDRESS OF PENDING-BUSINESS TO
 18619         DFHEIV20
 18620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18621
 18622
 18623     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18624
 18625     IF WS-BATCH-PREFIX = '#CL'
 18626        GO TO 4005-READ-NEXT-RECORD.
 18627
 18628     IF SHOW-RECORD
 18629        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18630           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18631           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18632           PB-STATE         NOT = PI-PB-STATE          OR
 18633           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18634           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18635           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18636           GO TO 4050-END-RECORDS
 18637        ELSE
 18638           GO TO 4010-CHECK-REC-TYPE.
 18639
 18640     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18641        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18642        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18643        PB-STATE            NOT = PI-PB-STATE          OR
 18644        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18645        GO TO 4050-END-RECORDS.
 18646
 18647     IF PB-BATCH-TRAILER
 18648        GO TO 4005-READ-NEXT-RECORD.
 18649
 18650     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18651        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18652           GO TO 4005-READ-NEXT-RECORD
 18653        ELSE
 18654           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18655              GO TO 4010-CHECK-REC-TYPE
 18656           ELSE
 18657              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18658                 GO TO 4010-CHECK-REC-TYPE
 18659              ELSE
 18660                 GO TO 4005-READ-NEXT-RECORD.
 18661
 18662     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18663        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18664           GO TO 4005-READ-NEXT-RECORD.
 18665
 18666 4010-CHECK-REC-TYPE.
 18667     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 342
* EL6311.cbl
 18668         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18669             NEXT SENTENCE
 18670         ELSE
 18671             GO TO 4005-READ-NEXT-RECORD.
 18672
 18673     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18674         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18675             NEXT SENTENCE
 18676        ELSE
 18677             GO TO 4005-READ-NEXT-RECORD.
 18678
 18679     IF NOT DISPLAY-CHANGE-RECORDS AND
 18680            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18681        GO TO 4005-READ-NEXT-RECORD.
 18682
 18683     IF DISPLAY-HOLD-RECORDS AND
 18684        NOT PB-RECORD-ON-HOLD
 18685          GO TO 4005-READ-NEXT-RECORD.
 18686
 18687     IF PB-ISSUE
 18688        IF DISPLAY-CHK-REQ-RECORDS
 18689            GO TO 4005-READ-NEXT-RECORD.
 18690
 18691     IF PB-ISSUE
 18692        IF ISSUE-WITH-WARNING
 18693           IF PB-WARNING-ERRORS
 18694              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18695                  GO TO 4005-READ-NEXT-RECORD
 18696              ELSE
 18697                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18698                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18699                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18700                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18701                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18702                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18703                 GO TO 7000-DISPLAY-ISSUES
 18704           ELSE
 18705              GO TO 4005-READ-NEXT-RECORD.
 18706
 18707     IF PB-ISSUE
 18708        IF (ISSUES-IN-ERROR AND
 18709            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18710            ALL-ISSUES
 18711            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18712            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18713            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18714            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18715            MOVE PB-SV-STATE            TO PI-SV-STATE
 18716            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18717            GO TO 7000-DISPLAY-ISSUES
 18718        ELSE
 18719            GO TO 4005-READ-NEXT-RECORD.
 18720
 18721     IF PB-CANCELLATION
 18722        IF DISPLAY-CHK-REQ-RECORDS
 18723           IF PB-C-REFUND-REQUESTED
 18724              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18725              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 343
* EL6311.cbl
 18726              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18727              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18728              MOVE PB-SV-STATE            TO PI-SV-STATE
 18729              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18730              GO TO 7100-DISPLAY-CANCELS
 18731           ELSE
 18732               GO TO 4005-READ-NEXT-RECORD.
 18733
 18734     IF PB-CANCELLATION
 18735        IF CANCEL-WITH-WARNING
 18736           IF PB-WARNING-ERRORS
 18737              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18738                  GO TO 4005-READ-NEXT-RECORD
 18739              ELSE
 18740                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18741                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18742                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18743                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18744                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18745                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18746                 GO TO 7100-DISPLAY-CANCELS
 18747           ELSE
 18748              GO TO 4005-READ-NEXT-RECORD.
 18749
 18750     IF PB-CANCELLATION
 18751        IF (CANCEL-IN-ERROR  AND
 18752            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18753            ALL-CANCELS
 18754            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18755            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18756            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18757            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18758            MOVE PB-SV-STATE            TO PI-SV-STATE
 18759            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18760            GO TO 7100-DISPLAY-CANCELS.
 18761
 18762     GO TO 4005-READ-NEXT-RECORD.
 18763
 18764 4050-END-RECORDS.
 18765******************************************************************
 18766*                                                                *
 18767*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18768*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18769*         PROGRAM.                                               *
 18770*                                                                *
 18771******************************************************************
 18772
 18773     IF BROWSE-STARTED
 18774        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18775
 18776* EXEC CICS ENDBR
 18777*            DATASET  (FILE-ID-ERPNDB2)
 18778*       END-EXEC.
 18779     MOVE 0
 18780       TO DFHEIV11
 18781*    MOVE '&2                    $   #00016204' TO DFHEIV0
 18782     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18783     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 344
* EL6311.cbl
 18784     MOVE X'2020233030303136323034' TO DFHEIV0(25:11)
 18785     CALL 'kxdfhei1' USING DFHEIV0,
 18786           FILE-ID-ERPNDB2,
 18787           DFHEIV11,
 18788           DFHEIV99
 18789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18790
 18791
 18792     IF  EIBTRNID NOT = TRANS-EXB1
 18793         IF PENDING-BUS-RECS-FOUND
 18794             NEXT SENTENCE
 18795           ELSE
 18796             MOVE '9'            TO PI-BROWSE-SW
 18797             GO TO 9400-CLEAR.
 18798
 18799     IF SHOW-RECORD
 18800        MOVE ER-2253            TO EMI-ERROR
 18801       ELSE
 18802        MOVE ER-2254            TO EMI-ERROR.
 18803
 18804     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18805
 18806     IF PI-MAP-NAME = SPACES
 18807        MOVE -1                  TO DPFENTRL
 18808        MOVE EL631D               TO PI-MAP-NAME
 18809        GO TO 8100-SEND-INITIAL-MAP.
 18810
 18811     IF PI-MAP-NAME = EL631B
 18812        MOVE -1                  TO BMAINTL
 18813     ELSE
 18814        IF PI-MAP-NAME = EL631C
 18815           MOVE -1               TO CMAINTL
 18816        ELSE
 18817           MOVE -1               TO DPFENTRL.
 18818
 18819     GO TO 8200-SEND-DATAONLY.
 18820
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 345
* EL6311.cbl
 18822
 18823***************************************************************
 18824*                                                             *
 18825*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18826*                                                             *
 18827*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18828*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18829*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18830*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18831*                                                             *
 18832*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18833*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18834*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18835*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18836*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18837*                AND IS IT TO BE DISPLAYED.                   *
 18838*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18839*                DISPLAYED.                                   *
 18840*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18841*                DISPLAYED.                                   *
 18842*                                                             *
 18843*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18844*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18845*                                                             *
 18846*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18847*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18848*                THEY ARE NOT TO BE DISPLAYED.                *
 18849*                                                             *
 18850***************************************************************
 18851
 18852 4100-BROWSE-PRIMARY-FORWARD.
 18853     IF FIRST-TIME  OR SHOW-RECORD
 18854        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18855        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18856        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18857     ELSE
 18858        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18859        IF ERPNDB-BATCH-SEQ-NO = +9999
 18860           GO TO 4150-END-BATCH
 18861        ELSE
 18862           IF DISPLAY-CHANGE-RECORDS
 18863              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18864           ELSE
 18865              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18866              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18867
 18868     IF FIRST-TIME
 18869         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18870            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18871              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18872
 18873
 18874* EXEC CICS HANDLE CONDITION
 18875*         ENDFILE  (4150-END-BATCH)
 18876*    END-EXEC.
 18877*    MOVE '"$''                   ! E #00016289' TO DFHEIV0
 18878     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18879     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 346
* EL6311.cbl
 18880     MOVE X'4520233030303136323839' TO DFHEIV0(25:11)
 18881     CALL 'kxdfhei1' USING DFHEIV0
 18882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18883
 18884
 18885 4105-READ-NEXT.
 18886
 18887* EXEC CICS HANDLE CONDITION
 18888*         NOTFND    (4150-END-BATCH)
 18889*    END-EXEC.
 18890*    MOVE '"$I                   ! F #00016294' TO DFHEIV0
 18891     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18893     MOVE X'4620233030303136323934' TO DFHEIV0(25:11)
 18894     CALL 'kxdfhei1' USING DFHEIV0
 18895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18896
 18897
 18898     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18899
 18900     IF PI-DISPLAY-ORIGINAL-BATCH
 18901        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18902     ELSE
 18903        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18904
 18905
 18906* EXEC CICS READ
 18907*         DATASET   (FILE-ID)
 18908*         SET       (ADDRESS OF PENDING-BUSINESS)
 18909*         RIDFLD    (ERPNDB-KEY)
 18910*         GTEQ
 18911*    END-EXEC.
 18912*    MOVE '&"S        G          (   #00016305' TO DFHEIV0
 18913     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18914     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18915     MOVE X'2020233030303136333035' TO DFHEIV0(25:11)
 18916     CALL 'kxdfhei1' USING DFHEIV0,
 18917           FILE-ID,
 18918           DFHEIV20,
 18919           DFHEIV99,
 18920           ERPNDB-KEY,
 18921           DFHEIV99,
 18922           DFHEIV99,
 18923           DFHEIV99
 18924     SET ADDRESS OF PENDING-BUSINESS TO
 18925         DFHEIV20
 18926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18927
 18928
 18929     IF PI-DISPLAY-ORIGINAL-BATCH
 18930        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18931           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18932           GO TO 4150-END-BATCH
 18933        ELSE
 18934           IF PB-BATCH-TRAILER
 18935              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18936              GO TO 4105-READ-NEXT
 18937           ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 347
* EL6311.cbl
 18938              NEXT SENTENCE
 18939     ELSE
 18940        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18941           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18942           GO TO 4150-END-BATCH.
 18943
 18944     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18945
 18946     IF WS-BATCH-PREFIX = '#CL'
 18947         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18948         GO TO 4105-READ-NEXT.
 18949
 18950     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18951     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18952     MOVE PB-STATE               TO PI-PB-STATE.
 18953     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18954
 18955     IF PB-BATCH-TRAILER
 18956        IF SHOW-RECORD
 18957           GO TO 4150-END-BATCH
 18958        ELSE
 18959           MOVE ER-2251         TO EMI-ERROR
 18960           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18961           MOVE 1               TO PI-BROWSE-TYPE
 18962           GO TO 7200-DISPLAY-BATCHES.
 18963
 18964     IF SHOW-RECORD
 18965           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18966              GO TO 4110-BUMP-SEQ
 18967           ELSE
 18968              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18969                 GO TO 4110-BUMP-SEQ
 18970              ELSE
 18971                 GO TO 4107-CHECK-REC-TYPE.
 18972
 18973     IF NOT  PI-PRIMARY-WITH-SELECT
 18974        GO TO 4107-CHECK-REC-TYPE.
 18975
 18976     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18977        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18978           GO TO 4110-BUMP-SEQ
 18979        ELSE
 18980           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18981              GO TO 4107-CHECK-REC-TYPE
 18982           ELSE
 18983              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18984                 GO TO 4107-CHECK-REC-TYPE
 18985              ELSE
 18986                 GO TO 4110-BUMP-SEQ.
 18987
 18988     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18989        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18990           GO TO 4110-BUMP-SEQ.
 18991
 18992 4107-CHECK-REC-TYPE.
 18993     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18994         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18995             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 348
* EL6311.cbl
 18996           ELSE
 18997             GO TO 4110-BUMP-SEQ.
 18998
 18999     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19000         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19001             NEXT SENTENCE
 19002           ELSE
 19003             GO TO 4110-BUMP-SEQ.
 19004
 19005     IF NOT DISPLAY-CHANGE-RECORDS AND
 19006        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19007           GO TO 4110-BUMP-SEQ.
 19008
 19009     IF DISPLAY-HOLD-RECORDS AND
 19010        NOT PB-RECORD-ON-HOLD
 19011          GO TO 4110-BUMP-SEQ.
 19012
 19013     IF PB-ISSUE
 19014        IF DISPLAY-CHK-REQ-RECORDS
 19015            GO TO 4110-BUMP-SEQ.
 19016
 19017     IF PB-ISSUE
 19018        IF ISSUE-WITH-WARNING
 19019           IF PB-WARNING-ERRORS
 19020              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19021                  GO TO 4110-BUMP-SEQ
 19022              ELSE
 19023                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19024                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19025                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19026                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19027                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19028                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19029                 GO TO 7000-DISPLAY-ISSUES
 19030        ELSE
 19031            GO TO 4110-BUMP-SEQ.
 19032
 19033     IF PB-ISSUE
 19034        IF (ISSUES-IN-ERROR AND
 19035            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19036            ALL-ISSUES
 19037            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19038            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19039            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19040            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19041            MOVE PB-SV-STATE            TO PI-SV-STATE
 19042            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19043            GO TO 7000-DISPLAY-ISSUES
 19044        ELSE
 19045            GO TO 4110-BUMP-SEQ.
 19046
 19047     IF PB-CANCELLATION
 19048        IF DISPLAY-CHK-REQ-RECORDS
 19049           IF PB-C-REFUND-REQUESTED
 19050              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19051              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19052              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19053              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 349
* EL6311.cbl
 19054              MOVE PB-SV-STATE            TO PI-SV-STATE
 19055              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19056              GO TO 7100-DISPLAY-CANCELS
 19057           ELSE
 19058              GO TO 4110-BUMP-SEQ.
 19059
 19060     IF PB-CANCELLATION
 19061        IF CANCEL-WITH-WARNING
 19062           IF PB-WARNING-ERRORS
 19063              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19064                  GO TO 4110-BUMP-SEQ
 19065              ELSE
 19066                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19067                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19068                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19069                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19070                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19071                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19072                 GO TO 7100-DISPLAY-CANCELS
 19073           ELSE
 19074              GO TO 4110-BUMP-SEQ.
 19075
 19076     IF PB-CANCELLATION
 19077        IF (CANCEL-IN-ERROR  AND
 19078            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19079            ALL-CANCELS
 19080            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19081            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19082            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19083            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19084            MOVE PB-SV-STATE            TO PI-SV-STATE
 19085            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19086            GO TO 7100-DISPLAY-CANCELS.
 19087
 19088 4110-BUMP-SEQ.
 19089     IF NOT DISPLAY-CHANGE-RECORDS
 19090        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19091        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19092     ELSE
 19093        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19094           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19095           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19096        ELSE
 19097           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19098           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19099
 19100     GO TO 4105-READ-NEXT.
 19101
 19102 4150-END-BATCH.
 19103******************************************************************
 19104*                                                                *
 19105*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19106*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19107*         PROGRAM.                                               *
 19108*                                                                *
 19109******************************************************************
 19110
 19111     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 350
* EL6311.cbl
 19112         IF PENDING-BUS-RECS-FOUND
 19113             NEXT SENTENCE
 19114           ELSE
 19115             MOVE '9'            TO PI-BROWSE-SW
 19116             GO TO 9400-CLEAR.
 19117
 19118     IF SHOW-RECORD
 19119        MOVE ER-2253             TO EMI-ERROR
 19120     ELSE
 19121        MOVE ER-2251             TO EMI-ERROR.
 19122
 19123     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19124
 19125     IF PI-MAP-NAME = SPACES
 19126        MOVE -1                  TO BMAINTL
 19127        MOVE EL631B              TO PI-MAP-NAME
 19128        GO TO 8100-SEND-INITIAL-MAP.
 19129
 19130     IF PI-MAP-NAME = EL631B
 19131        MOVE -1                  TO BMAINTL
 19132     ELSE
 19133        IF PI-MAP-NAME = EL631C
 19134           MOVE -1               TO CMAINTL
 19135        ELSE
 19136           MOVE -1               TO DPFENTRL.
 19137
 19138     GO TO 8200-SEND-DATAONLY.
 19139
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 351
* EL6311.cbl
 19141
 19142***************************************************************
 19143*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19144*                                                             *
 19145*      1. START BROWSE WITH                                   *
 19146*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19147*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19148*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19149*                                                             *
 19150*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19151*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19152*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19153*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19154*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19155*               AND IS IT TO BE DISPLAYED.                    *
 19156*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19157*               DISPLAYED.                                    *
 19158*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19159*               DISPLAYED.                                    *
 19160*                                                             *
 19161*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19162*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19163***************************************************************
 19164
 19165 4200-BROWSE-CSR-FORWARD.
 19166
 19167     IF FIRST-TIME
 19168        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19169     ELSE
 19170        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19171
 19172
 19173* EXEC CICS HANDLE CONDITION
 19174*         NOTFND   (4250-END-RECORDS)
 19175*         ENDFILE  (4250-END-RECORDS)
 19176*    END-EXEC.
 19177*    MOVE '"$I''                  ! G #00016555' TO DFHEIV0
 19178     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19180     MOVE X'4720233030303136353535' TO DFHEIV0(25:11)
 19181     CALL 'kxdfhei1' USING DFHEIV0
 19182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19183
 19184
 19185
 19186* EXEC CICS STARTBR
 19187*         DATASET   (FILE-ID-ERPNDB4)
 19188*         RIDFLD    (ERPNDB-CSR-KEY)
 19189*    END-EXEC.
 19190     MOVE 0
 19191       TO DFHEIV11
 19192*    MOVE '&,         G          &   #00016560' TO DFHEIV0
 19193     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19194     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19195     MOVE X'2020233030303136353630' TO DFHEIV0(25:11)
 19196     CALL 'kxdfhei1' USING DFHEIV0,
 19197           FILE-ID-ERPNDB4,
 19198           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 352
* EL6311.cbl
 19199           DFHEIV99,
 19200           DFHEIV11,
 19201           DFHEIV99
 19202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19203
 19204
 19205     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19206
 19207     IF FIRST-TIME
 19208        MOVE SPACE               TO WS-FIRST-TIME-SW
 19209        GO TO 4205-READ-NEXT-RECORD.
 19210
 19211
 19212* EXEC CICS READNEXT
 19213*         DATASET    (FILE-ID-ERPNDB4)
 19214*         SET        (ADDRESS OF PENDING-BUSINESS)
 19215*         RIDFLD     (ERPNDB-CSR-KEY)
 19216*    END-EXEC.
 19217     MOVE 0
 19218       TO DFHEIV11
 19219*    MOVE '&.S                   )   #00016571' TO DFHEIV0
 19220     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19221     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19222     MOVE X'2020233030303136353731' TO DFHEIV0(25:11)
 19223     CALL 'kxdfhei1' USING DFHEIV0,
 19224           FILE-ID-ERPNDB4,
 19225           DFHEIV20,
 19226           DFHEIV99,
 19227           ERPNDB-CSR-KEY,
 19228           DFHEIV99,
 19229           DFHEIV11,
 19230           DFHEIV99,
 19231           DFHEIV99
 19232     SET ADDRESS OF PENDING-BUSINESS TO
 19233         DFHEIV20
 19234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19235
 19236
 19237 4205-READ-NEXT-RECORD.
 19238
 19239
 19240* EXEC CICS READNEXT
 19241*         DATASET    (FILE-ID-ERPNDB4)
 19242*         SET        (ADDRESS OF PENDING-BUSINESS)
 19243*         RIDFLD     (ERPNDB-CSR-KEY)
 19244*    END-EXEC.
 19245     MOVE 0
 19246       TO DFHEIV11
 19247*    MOVE '&.S                   )   #00016579' TO DFHEIV0
 19248     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19249     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19250     MOVE X'2020233030303136353739' TO DFHEIV0(25:11)
 19251     CALL 'kxdfhei1' USING DFHEIV0,
 19252           FILE-ID-ERPNDB4,
 19253           DFHEIV20,
 19254           DFHEIV99,
 19255           ERPNDB-CSR-KEY,
 19256           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 353
* EL6311.cbl
 19257           DFHEIV11,
 19258           DFHEIV99,
 19259           DFHEIV99
 19260     SET ADDRESS OF PENDING-BUSINESS TO
 19261         DFHEIV20
 19262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19263
 19264
 19265     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19266
 19267     IF WS-BATCH-PREFIX = '#CL'
 19268        GO TO 4205-READ-NEXT-RECORD.
 19269
 19270     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19271        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19272        GO TO 4250-END-RECORDS.
 19273
 19274     IF PB-BATCH-TRAILER
 19275        GO TO 4205-READ-NEXT-RECORD.
 19276
 19277     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19278        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19279           GO TO 4205-READ-NEXT-RECORD
 19280        ELSE
 19281           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19282              GO TO 4210-CHECK-REC-TYPE
 19283           ELSE
 19284              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19285                 GO TO 4210-CHECK-REC-TYPE
 19286              ELSE
 19287                 GO TO 4205-READ-NEXT-RECORD.
 19288
 19289     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19290        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19291           GO TO 4205-READ-NEXT-RECORD.
 19292
 19293 4210-CHECK-REC-TYPE.
 19294     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19295         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19296             NEXT SENTENCE
 19297         ELSE
 19298             GO TO 4205-READ-NEXT-RECORD.
 19299
 19300     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19301         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19302             NEXT SENTENCE
 19303        ELSE
 19304             GO TO 4205-READ-NEXT-RECORD.
 19305
 19306     IF NOT DISPLAY-CHANGE-RECORDS AND
 19307            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19308        GO TO 4205-READ-NEXT-RECORD.
 19309
 19310     IF DISPLAY-HOLD-RECORDS AND
 19311        NOT PB-RECORD-ON-HOLD
 19312          GO TO 4205-READ-NEXT-RECORD.
 19313
 19314     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 354
* EL6311.cbl
 19315        IF DISPLAY-CHK-REQ-RECORDS
 19316            GO TO 4205-READ-NEXT-RECORD.
 19317
 19318     IF PB-ISSUE
 19319        IF ISSUE-WITH-WARNING
 19320           IF PB-WARNING-ERRORS
 19321              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19322                  GO TO 4205-READ-NEXT-RECORD
 19323              ELSE
 19324                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19325                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19326                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19327                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19328                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19329                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19330                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19331                 GO TO 7000-DISPLAY-ISSUES
 19332           ELSE
 19333              GO TO 4205-READ-NEXT-RECORD.
 19334
 19335     IF PB-ISSUE
 19336        IF (ISSUES-IN-ERROR AND
 19337            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19338            ALL-ISSUES
 19339            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19340            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19341            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19342            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19343            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19344            MOVE PB-SV-STATE            TO PI-SV-STATE
 19345            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19346            GO TO 7000-DISPLAY-ISSUES
 19347        ELSE
 19348            GO TO 4205-READ-NEXT-RECORD.
 19349
 19350     IF PB-CANCELLATION
 19351        IF DISPLAY-CHK-REQ-RECORDS
 19352           IF PB-C-REFUND-REQUESTED
 19353              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19354              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19355              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19356              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19357              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19358              MOVE PB-SV-STATE            TO PI-SV-STATE
 19359              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19360              GO TO 7100-DISPLAY-CANCELS
 19361           ELSE
 19362               GO TO 4205-READ-NEXT-RECORD.
 19363
 19364     IF PB-CANCELLATION
 19365        IF CANCEL-WITH-WARNING
 19366           IF PB-WARNING-ERRORS
 19367              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19368                  GO TO 4205-READ-NEXT-RECORD
 19369              ELSE
 19370                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19371                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19372                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 355
* EL6311.cbl
 19373                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19374                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19375                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19376                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19377                 GO TO 7100-DISPLAY-CANCELS
 19378           ELSE
 19379              GO TO 4205-READ-NEXT-RECORD.
 19380
 19381     IF PB-CANCELLATION
 19382        IF (CANCEL-IN-ERROR  AND
 19383            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19384            ALL-CANCELS
 19385            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19386            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19387            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19388            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19389            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19390            MOVE PB-SV-STATE            TO PI-SV-STATE
 19391            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19392            GO TO 7100-DISPLAY-CANCELS.
 19393
 19394     GO TO 4205-READ-NEXT-RECORD.
 19395
 19396 4250-END-RECORDS.
 19397******************************************************************
 19398*                                                                *
 19399*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19400*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19401*         PROGRAM.                                               *
 19402*                                                                *
 19403******************************************************************
 19404
 19405     IF BROWSE-STARTED
 19406        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19407
 19408* EXEC CICS ENDBR
 19409*            DATASET  (FILE-ID-ERPNDB4)
 19410*       END-EXEC.
 19411     MOVE 0
 19412       TO DFHEIV11
 19413*    MOVE '&2                    $   #00016727' TO DFHEIV0
 19414     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19415     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19416     MOVE X'2020233030303136373237' TO DFHEIV0(25:11)
 19417     CALL 'kxdfhei1' USING DFHEIV0,
 19418           FILE-ID-ERPNDB4,
 19419           DFHEIV11,
 19420           DFHEIV99
 19421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19422
 19423
 19424     IF  EIBTRNID NOT = TRANS-EXB1
 19425         IF PENDING-BUS-RECS-FOUND
 19426             NEXT SENTENCE
 19427           ELSE
 19428             MOVE '9'            TO PI-BROWSE-SW
 19429             GO TO 9400-CLEAR.
 19430
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 356
* EL6311.cbl
 19431     IF SHOW-RECORD
 19432        MOVE ER-2253            TO EMI-ERROR
 19433       ELSE
 19434        MOVE ER-2254            TO EMI-ERROR.
 19435
 19436     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19437
 19438     IF PI-MAP-NAME = SPACES
 19439        MOVE -1                  TO DPFENTRL
 19440        MOVE EL631D               TO PI-MAP-NAME
 19441        GO TO 8100-SEND-INITIAL-MAP.
 19442
 19443     IF PI-MAP-NAME = EL631B
 19444        MOVE -1                  TO BMAINTL
 19445     ELSE
 19446        IF PI-MAP-NAME = EL631C
 19447           MOVE -1               TO CMAINTL
 19448        ELSE
 19449           MOVE -1               TO DPFENTRL.
 19450
 19451     GO TO 8200-SEND-DATAONLY.
 19452
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 357
* EL6311.cbl
 19454
 19455***************************************************************
 19456*                                                             *
 19457*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19458*                                                             *
 19459*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19460*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19461*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19462*                                                             *
 19463*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19464*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19465*          A. IS IT WITHIN THE SAME COMPANY                   *
 19466*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19467*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19468*                AND IS IT TO BE DISPLAYED.                   *
 19469*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19470*                DISPLAYED.                                   *
 19471*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19472*                DISPLAYED.                                   *
 19473*                                                             *
 19474*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19475*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19476*                                                             *
 19477*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19478*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19479*                THEY ARE NOT TO BE DISPLAYED.                *
 19480*                                                             *
 19481***************************************************************
 19482
 19483 4300-BROWSE-FILE-FORWARD.
 19484     IF FIRST-TIME OR SHOW-RECORD
 19485        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19486        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19487        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19488     ELSE
 19489        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19490        IF ERPNDB-BATCH-SEQ-NO = +9999
 19491           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19492        ELSE
 19493           IF DISPLAY-CHANGE-RECORDS
 19494              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19495           ELSE
 19496              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19497              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19498
 19499
 19500* EXEC CICS HANDLE CONDITION
 19501*         ENDFILE  (4350-END-BATCH)
 19502*         NOTFND   (4350-END-BATCH)
 19503*    END-EXEC.
 19504*    MOVE '"$''I                  ! H #00016806' TO DFHEIV0
 19505     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19506     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19507     MOVE X'4820233030303136383036' TO DFHEIV0(25:11)
 19508     CALL 'kxdfhei1' USING DFHEIV0
 19509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19510
 19511
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 358
* EL6311.cbl
 19512 4305-READ-NEXT.
 19513     IF PI-DISPLAY-ORIGINAL-BATCH
 19514        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19515     ELSE
 19516        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19517
 19518
 19519* EXEC CICS READ
 19520*         DATASET   (FILE-ID)
 19521*         SET       (ADDRESS OF PENDING-BUSINESS)
 19522*         RIDFLD    (ERPNDB-KEY)
 19523*         GTEQ
 19524*    END-EXEC.
 19525*    MOVE '&"S        G          (   #00016817' TO DFHEIV0
 19526     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19527     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19528     MOVE X'2020233030303136383137' TO DFHEIV0(25:11)
 19529     CALL 'kxdfhei1' USING DFHEIV0,
 19530           FILE-ID,
 19531           DFHEIV20,
 19532           DFHEIV99,
 19533           ERPNDB-KEY,
 19534           DFHEIV99,
 19535           DFHEIV99,
 19536           DFHEIV99
 19537     SET ADDRESS OF PENDING-BUSINESS TO
 19538         DFHEIV20
 19539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19540
 19541
 19542     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19543        GO TO 4350-END-BATCH.
 19544
 19545     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19546                                    WS-BATCH-NO.
 19547
 19548     IF  WS-BATCH-PREFIX = '#CL'
 19549         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19550         GO TO 4305-READ-NEXT.
 19551
 19552     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19553     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19554     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19555     MOVE PB-STATE               TO PI-PB-STATE.
 19556     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19557
 19558     IF PB-BATCH-TRAILER
 19559        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19560        GO TO 4305-READ-NEXT.
 19561
 19562     IF SHOW-RECORD
 19563           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19564              GO TO 4310-BUMP-SEQ
 19565           ELSE
 19566              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19567                 GO TO 4310-BUMP-SEQ
 19568              ELSE
 19569                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 359
* EL6311.cbl
 19570
 19571     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19572        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19573           GO TO 4310-BUMP-SEQ
 19574        ELSE
 19575           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19576              GO TO 4307-CHECK-REC-TYPE
 19577           ELSE
 19578              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19579                 GO TO 4307-CHECK-REC-TYPE
 19580              ELSE
 19581                 GO TO 4310-BUMP-SEQ.
 19582
 19583     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19584        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19585           GO TO 4310-BUMP-SEQ.
 19586
 19587 4307-CHECK-REC-TYPE.
 19588     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19589         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19590             NEXT SENTENCE
 19591         ELSE
 19592             GO TO 4310-BUMP-SEQ.
 19593
 19594     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19595         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19596             NEXT SENTENCE
 19597        ELSE
 19598             GO TO 4310-BUMP-SEQ.
 19599
 19600     IF NOT DISPLAY-CHANGE-RECORDS AND
 19601            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19602        GO TO 4310-BUMP-SEQ.
 19603
 19604     IF DISPLAY-HOLD-RECORDS AND
 19605        NOT PB-RECORD-ON-HOLD
 19606          GO TO 4310-BUMP-SEQ.
 19607
 19608     IF PB-ISSUE
 19609        IF DISPLAY-CHK-REQ-RECORDS
 19610           GO TO 4310-BUMP-SEQ.
 19611
 19612     IF PB-ISSUE
 19613        IF ISSUE-WITH-WARNING
 19614           IF PB-WARNING-ERRORS
 19615              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19616                  GO TO 4310-BUMP-SEQ
 19617              ELSE
 19618                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19619                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19620                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19621                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19622                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19623                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19624                 GO TO 7000-DISPLAY-ISSUES
 19625           ELSE
 19626              GO TO 4310-BUMP-SEQ.
 19627
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 360
* EL6311.cbl
 19628     IF PB-ISSUE
 19629        IF (ISSUES-IN-ERROR AND
 19630            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19631            ALL-ISSUES
 19632            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19633            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19634            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19635            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19636            MOVE PB-SV-STATE            TO PI-SV-STATE
 19637            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19638            GO TO 7000-DISPLAY-ISSUES
 19639        ELSE
 19640            GO TO 4310-BUMP-SEQ.
 19641
 19642     IF PB-CANCELLATION
 19643        IF DISPLAY-CHK-REQ-RECORDS
 19644           IF PB-C-REFUND-REQUESTED
 19645              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19646              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19647              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19648              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19649              MOVE PB-SV-STATE            TO PI-SV-STATE
 19650              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19651              GO TO 7100-DISPLAY-CANCELS
 19652           ELSE
 19653              GO TO 4310-BUMP-SEQ.
 19654
 19655     IF PB-CANCELLATION
 19656        IF CANCEL-WITH-WARNING
 19657           IF PB-WARNING-ERRORS
 19658              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19659                  GO TO 4310-BUMP-SEQ
 19660              ELSE
 19661                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19662                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19663                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19664                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19665                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19666                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19667                 GO TO 7100-DISPLAY-CANCELS
 19668           ELSE
 19669              GO TO 4310-BUMP-SEQ.
 19670
 19671     IF PB-CANCELLATION
 19672        IF (CANCEL-IN-ERROR  AND
 19673            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19674            ALL-CANCELS
 19675            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19676            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19677            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19678            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19679            MOVE PB-SV-STATE            TO PI-SV-STATE
 19680            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19681            GO TO 7100-DISPLAY-CANCELS.
 19682
 19683 4310-BUMP-SEQ.
 19684     IF NOT DISPLAY-CHANGE-RECORDS
 19685        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 361
* EL6311.cbl
 19686        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19687     ELSE
 19688        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19689           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19690           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19691        ELSE
 19692           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19693           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19694
 19695     GO TO 4305-READ-NEXT.
 19696
 19697 4350-END-BATCH.
 19698
 19699******************************************************************
 19700*                                                                *
 19701*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19702*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19703*         PROGRAM.                                               *
 19704*                                                                *
 19705******************************************************************
 19706
 19707     IF  EIBTRNID NOT = TRANS-EXB1
 19708         IF PENDING-BUS-RECS-FOUND
 19709             NEXT SENTENCE
 19710           ELSE
 19711             MOVE '9'            TO PI-BROWSE-SW
 19712             GO TO 9400-CLEAR.
 19713
 19714     IF SHOW-RECORD
 19715        MOVE ER-2253            TO EMI-ERROR
 19716     ELSE
 19717        MOVE ER-2251            TO EMI-ERROR.
 19718
 19719     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19720
 19721     IF PI-MAP-NAME = SPACES
 19722        MOVE -1                  TO BMAINTL
 19723        MOVE EL631B               TO PI-MAP-NAME
 19724        GO TO 8100-SEND-INITIAL-MAP.
 19725
 19726     IF PI-MAP-NAME = EL631B
 19727        MOVE -1                  TO BMAINTL
 19728     ELSE
 19729        IF PI-MAP-NAME = EL631C
 19730           MOVE -1               TO CMAINTL
 19731        ELSE
 19732           MOVE -1               TO DPFENTRL.
 19733
 19734     GO TO 8200-SEND-DATAONLY.
 19735
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 362
* EL6311.cbl
 19737
 19738******************************************************************
 19739*                                                                *
 19740*        B R O W S E   D E T A I L   B A C K W A R D             *
 19741*                                                                *
 19742******************************************************************
 19743
 19744 4500-BROWSE-DETAIL-BACKWARD.
 19745
 19746     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19747
 19748
 19749* EXEC CICS HANDLE CONDITION
 19750*         NOTFND   (4570-NOT-FOUND)
 19751*         ENDFILE  (4550-END-RECORDS)
 19752*    END-EXEC
 19753*    MOVE '"$I''                  ! I #00017030' TO DFHEIV0
 19754     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19755     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19756     MOVE X'4920233030303137303330' TO DFHEIV0(25:11)
 19757     CALL 'kxdfhei1' USING DFHEIV0
 19758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19759
 19760
 19761* EXEC CICS STARTBR
 19762*         DATASET   (FILE-ID-ERPNDB2)
 19763*         RIDFLD    (ERPNDB-ALT-KEY)
 19764*    END-EXEC.
 19765     MOVE 0
 19766       TO DFHEIV11
 19767*    MOVE '&,         G          &   #00017035' TO DFHEIV0
 19768     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19769     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19770     MOVE X'2020233030303137303335' TO DFHEIV0(25:11)
 19771     CALL 'kxdfhei1' USING DFHEIV0,
 19772           FILE-ID-ERPNDB2,
 19773           ERPNDB-ALT-KEY,
 19774           DFHEIV99,
 19775           DFHEIV11,
 19776           DFHEIV99
 19777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19778
 19779
 19780     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19781                                    WS-FIRST-TIME-SW.
 19782
 19783 4505-READ-PREV-RECORD.
 19784
 19785* EXEC CICS READPREV
 19786*         DATASET    (FILE-ID-ERPNDB2)
 19787*         SET        (ADDRESS OF PENDING-BUSINESS)
 19788*         RIDFLD     (ERPNDB-ALT-KEY)
 19789*    END-EXEC.
 19790     MOVE 0
 19791       TO DFHEIV11
 19792*    MOVE '&0S                   )   #00017044' TO DFHEIV0
 19793     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19794     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 363
* EL6311.cbl
 19795     MOVE X'2020233030303137303434' TO DFHEIV0(25:11)
 19796     CALL 'kxdfhei1' USING DFHEIV0,
 19797           FILE-ID-ERPNDB2,
 19798           DFHEIV20,
 19799           DFHEIV99,
 19800           ERPNDB-ALT-KEY,
 19801           DFHEIV99,
 19802           DFHEIV11,
 19803           DFHEIV99,
 19804           DFHEIV99
 19805     SET ADDRESS OF PENDING-BUSINESS TO
 19806         DFHEIV20
 19807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19808
 19809
 19810     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19811
 19812     IF WS-BATCH-PREFIX = '#CL'
 19813         GO TO 4505-READ-PREV-RECORD.
 19814
 19815     IF FIRST-TIME
 19816         MOVE SPACE               TO WS-FIRST-TIME-SW
 19817         GO TO 4505-READ-PREV-RECORD.
 19818
 19819     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19820        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19821        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19822        PB-STATE         NOT = PI-PB-STATE    OR
 19823        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19824          GO TO 4550-END-RECORDS.
 19825
 19826
 19827     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19828
 19829     IF PB-BATCH-TRAILER
 19830        GO TO 4505-READ-PREV-RECORD.
 19831
 19832     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19833
 19834     IF  WS-BATCH-PREFIX = '#CL'
 19835         GO TO 4505-READ-PREV-RECORD.
 19836
 19837     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19838        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19839           GO TO 4505-READ-PREV-RECORD
 19840        ELSE
 19841           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19842              GO TO 4510-CHECK-REC-TYPE
 19843           ELSE
 19844              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19845                 GO TO 4510-CHECK-REC-TYPE
 19846              ELSE
 19847                 GO TO 4505-READ-PREV-RECORD.
 19848
 19849     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19850        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19851           GO TO 4505-READ-PREV-RECORD.
 19852
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 364
* EL6311.cbl
 19853 4510-CHECK-REC-TYPE.
 19854     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19855         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19856             NEXT SENTENCE
 19857         ELSE
 19858             GO TO 4505-READ-PREV-RECORD.
 19859
 19860     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19861         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19862             NEXT SENTENCE
 19863        ELSE
 19864             GO TO 4505-READ-PREV-RECORD.
 19865
 19866     IF NOT DISPLAY-CHANGE-RECORDS AND
 19867            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19868        GO TO 4505-READ-PREV-RECORD.
 19869
 19870     IF DISPLAY-HOLD-RECORDS AND
 19871        NOT PB-RECORD-ON-HOLD
 19872          GO TO 4505-READ-PREV-RECORD.
 19873
 19874     IF PB-ISSUE
 19875        IF DISPLAY-CHK-REQ-RECORDS
 19876           GO TO 4505-READ-PREV-RECORD.
 19877
 19878     IF PB-ISSUE
 19879        IF ISSUE-WITH-WARNING
 19880           IF PB-WARNING-ERRORS
 19881              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19882                  GO TO 4505-READ-PREV-RECORD
 19883              ELSE
 19884                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19885                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19886                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19887                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19888                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19889                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19890                 GO TO 7000-DISPLAY-ISSUES
 19891           ELSE
 19892              GO TO 4505-READ-PREV-RECORD.
 19893
 19894     IF PB-ISSUE
 19895        IF (ISSUES-IN-ERROR AND
 19896            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19897            ALL-ISSUES
 19898            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19899            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19900            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19901            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19902            MOVE PB-SV-STATE            TO PI-SV-STATE
 19903            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19904            GO TO 7000-DISPLAY-ISSUES
 19905        ELSE
 19906            GO TO 4505-READ-PREV-RECORD.
 19907
 19908     IF PB-CANCELLATION
 19909        IF DISPLAY-CHK-REQ-RECORDS
 19910           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 365
* EL6311.cbl
 19911              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19912              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19913              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19914              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19915              MOVE PB-SV-STATE            TO PI-SV-STATE
 19916              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19917              GO TO 7100-DISPLAY-CANCELS
 19918           ELSE
 19919              GO TO 4505-READ-PREV-RECORD.
 19920
 19921     IF PB-CANCELLATION
 19922        IF CANCEL-WITH-WARNING
 19923           IF PB-WARNING-ERRORS
 19924              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19925                  GO TO 4505-READ-PREV-RECORD
 19926              ELSE
 19927                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19928                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19929                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19930                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19931                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19932                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19933                 GO TO 7100-DISPLAY-CANCELS
 19934           ELSE
 19935              GO TO 4505-READ-PREV-RECORD.
 19936
 19937     IF PB-CANCELLATION
 19938        IF (CANCEL-IN-ERROR  AND
 19939            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19940            ALL-CANCELS
 19941            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19942            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19943            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19944            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19945            MOVE PB-SV-STATE            TO PI-SV-STATE
 19946            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19947            GO TO 7100-DISPLAY-CANCELS.
 19948
 19949     GO TO 4505-READ-PREV-RECORD.
 19950
 19951 4550-END-RECORDS.
 19952     IF PI-MAP-NAME = EL631B
 19953        MOVE -1                  TO BMAINTL
 19954     ELSE
 19955        IF PI-MAP-NAME = EL631C
 19956           MOVE -1               TO CMAINTL
 19957        ELSE
 19958           MOVE -1               TO DPFENTRL.
 19959
 19960     MOVE ER-2255               TO EMI-ERROR.
 19961     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19962     GO TO 8200-SEND-DATAONLY.
 19963
 19964 4570-NOT-FOUND.
 19965
 19966******************************************************************
 19967*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19968******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 366
* EL6311.cbl
 19969
 19970
 19971* EXEC CICS RESETBR
 19972*         DATASET    (FILE-ID-ERPNDB2)
 19973*         RIDFLD     (ERPNDB-ALT-KEY)
 19974*    END-EXEC.
 19975     MOVE 0
 19976       TO DFHEIV11
 19977*    MOVE '&4         G          &   #00017210' TO DFHEIV0
 19978     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19979     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19980     MOVE X'2020233030303137323130' TO DFHEIV0(25:11)
 19981     CALL 'kxdfhei1' USING DFHEIV0,
 19982           FILE-ID-ERPNDB2,
 19983           ERPNDB-ALT-KEY,
 19984           DFHEIV99,
 19985           DFHEIV11,
 19986           DFHEIV99
 19987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19988
 19989
 19990
 19991* EXEC CICS READNEXT
 19992*         DATASET    (FILE-ID-ERPNDB2)
 19993*         SET        (ADDRESS OF PENDING-BUSINESS)
 19994*         RIDFLD     (ERPNDB-ALT-KEY)
 19995*    END-EXEC.
 19996     MOVE 0
 19997       TO DFHEIV11
 19998*    MOVE '&.S                   )   #00017215' TO DFHEIV0
 19999     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20000     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20001     MOVE X'2020233030303137323135' TO DFHEIV0(25:11)
 20002     CALL 'kxdfhei1' USING DFHEIV0,
 20003           FILE-ID-ERPNDB2,
 20004           DFHEIV20,
 20005           DFHEIV99,
 20006           ERPNDB-ALT-KEY,
 20007           DFHEIV99,
 20008           DFHEIV11,
 20009           DFHEIV99,
 20010           DFHEIV99
 20011     SET ADDRESS OF PENDING-BUSINESS TO
 20012         DFHEIV20
 20013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20014
 20015
 20016
 20017* EXEC CICS READPREV
 20018*         DATASET    (FILE-ID-ERPNDB2)
 20019*         SET        (ADDRESS OF PENDING-BUSINESS)
 20020*         RIDFLD     (ERPNDB-ALT-KEY)
 20021*    END-EXEC.
 20022     MOVE 0
 20023       TO DFHEIV11
 20024*    MOVE '&0S                   )   #00017221' TO DFHEIV0
 20025     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20026     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 367
* EL6311.cbl
 20027     MOVE X'2020233030303137323231' TO DFHEIV0(25:11)
 20028     CALL 'kxdfhei1' USING DFHEIV0,
 20029           FILE-ID-ERPNDB2,
 20030           DFHEIV20,
 20031           DFHEIV99,
 20032           ERPNDB-ALT-KEY,
 20033           DFHEIV99,
 20034           DFHEIV11,
 20035           DFHEIV99,
 20036           DFHEIV99
 20037     SET ADDRESS OF PENDING-BUSINESS TO
 20038         DFHEIV20
 20039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20040
 20041
 20042 4580-READ-PREV-RECORD.
 20043
 20044* EXEC CICS READPREV
 20045*         DATASET    (FILE-ID-ERPNDB2)
 20046*         SET        (ADDRESS OF PENDING-BUSINESS)
 20047*         RIDFLD     (ERPNDB-ALT-KEY)
 20048*    END-EXEC.
 20049     MOVE 0
 20050       TO DFHEIV11
 20051*    MOVE '&0S                   )   #00017228' TO DFHEIV0
 20052     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20053     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20054     MOVE X'2020233030303137323238' TO DFHEIV0(25:11)
 20055     CALL 'kxdfhei1' USING DFHEIV0,
 20056           FILE-ID-ERPNDB2,
 20057           DFHEIV20,
 20058           DFHEIV99,
 20059           ERPNDB-ALT-KEY,
 20060           DFHEIV99,
 20061           DFHEIV11,
 20062           DFHEIV99,
 20063           DFHEIV99
 20064     SET ADDRESS OF PENDING-BUSINESS TO
 20065         DFHEIV20
 20066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20067
 20068
 20069     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20070
 20071     IF WS-BATCH-PREFIX = '#CL'
 20072        GO TO 4580-READ-PREV-RECORD.
 20073
 20074     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20075     GO TO 4505-READ-PREV-RECORD.
 20076
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 368
* EL6311.cbl
 20078
 20079******************************************************************
 20080*                                                                *
 20081*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20082*                                                                *
 20083******************************************************************
 20084
 20085 4600-BROWSE-PRIMARY-BACKWARD.
 20086        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20087
 20088     IF ERPNDB-BATCH-SEQ-NO = +9999
 20089        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20090
 20091        IF ERPNDB-BATCH-SEQ-NO = +0000
 20092           GO TO 4650-END-BATCH
 20093        ELSE
 20094           IF PI-MAP-NAME NOT = EL631D
 20095              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20096                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20097              ELSE
 20098                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20099                 IF DISPLAY-CHANGE-RECORDS
 20100                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20101                 ELSE
 20102                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20103
 20104
 20105* EXEC CICS HANDLE CONDITION
 20106*         NOTFND    (4680-NOT-FOUND)
 20107*         ENDFILE   (4680-NOT-FOUND)
 20108*    END-EXEC.
 20109*    MOVE '"$I''                  ! J #00017269' TO DFHEIV0
 20110     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20111     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20112     MOVE X'4A20233030303137323639' TO DFHEIV0(25:11)
 20113     CALL 'kxdfhei1' USING DFHEIV0
 20114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20115
 20116
 20117 4605-READ-NEXT.
 20118     IF ERPNDB-BATCH-SEQ-NO = +0000
 20119        GO TO 4650-END-BATCH.
 20120
 20121     IF PI-DISPLAY-ORIGINAL-BATCH
 20122        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20123     ELSE
 20124        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20125
 20126
 20127* EXEC CICS READ
 20128*         DATASET   (FILE-ID)
 20129*         SET       (ADDRESS OF PENDING-BUSINESS)
 20130*         RIDFLD    (ERPNDB-KEY)
 20131*    END-EXEC.
 20132*    MOVE '&"S        E          (   #00017283' TO DFHEIV0
 20133     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20134     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20135     MOVE X'2020233030303137323833' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 369
* EL6311.cbl
 20136     CALL 'kxdfhei1' USING DFHEIV0,
 20137           FILE-ID,
 20138           DFHEIV20,
 20139           DFHEIV99,
 20140           ERPNDB-KEY,
 20141           DFHEIV99,
 20142           DFHEIV99,
 20143           DFHEIV99
 20144     SET ADDRESS OF PENDING-BUSINESS TO
 20145         DFHEIV20
 20146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20147
 20148
 20149     IF NOT  PI-PRIMARY-WITH-SELECT
 20150        GO TO 4607-CHECK-REC-TYPE.
 20151
 20152     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20153
 20154     IF  WS-BATCH-PREFIX = '#CL'
 20155         GO TO 4610-BUMP-SEQ.
 20156
 20157     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20158        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20159           GO TO 4610-BUMP-SEQ
 20160        ELSE
 20161           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20162              GO TO 4607-CHECK-REC-TYPE
 20163           ELSE
 20164              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20165                 GO TO 4607-CHECK-REC-TYPE
 20166              ELSE
 20167                 GO TO 4610-BUMP-SEQ.
 20168
 20169     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20170        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20171           GO TO 4610-BUMP-SEQ.
 20172
 20173 4607-CHECK-REC-TYPE.
 20174     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20175         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20176             NEXT SENTENCE
 20177         ELSE
 20178             GO TO 4610-BUMP-SEQ.
 20179
 20180     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20181         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20182             NEXT SENTENCE
 20183        ELSE
 20184             GO TO 4610-BUMP-SEQ.
 20185
 20186     IF NOT DISPLAY-CHANGE-RECORDS AND
 20187            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20188        GO TO 4610-BUMP-SEQ.
 20189
 20190     IF DISPLAY-HOLD-RECORDS AND
 20191        NOT PB-RECORD-ON-HOLD
 20192          GO TO 4610-BUMP-SEQ.
 20193
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 370
* EL6311.cbl
 20194     IF PB-ISSUE
 20195        IF DISPLAY-CHK-REQ-RECORDS
 20196           GO TO 4610-BUMP-SEQ.
 20197
 20198     IF PB-ISSUE
 20199        IF ISSUE-WITH-WARNING
 20200           IF PB-WARNING-ERRORS
 20201              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20202                  GO TO 4610-BUMP-SEQ
 20203              ELSE
 20204                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20205                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20206                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20207                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20208                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20209                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20210                 GO TO 7000-DISPLAY-ISSUES
 20211           ELSE
 20212              GO TO 4610-BUMP-SEQ.
 20213
 20214     IF PB-ISSUE
 20215        IF (ISSUES-IN-ERROR AND
 20216            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20217            ALL-ISSUES
 20218            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20219            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20220            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20221            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20222            MOVE PB-SV-STATE            TO PI-SV-STATE
 20223            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20224            GO TO 7000-DISPLAY-ISSUES
 20225        ELSE
 20226            GO TO 4610-BUMP-SEQ.
 20227
 20228     IF PB-CANCELLATION
 20229        IF DISPLAY-CHK-REQ-RECORDS
 20230           IF PB-C-REFUND-REQUESTED
 20231              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20232              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20233              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20234              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20235              MOVE PB-SV-STATE            TO PI-SV-STATE
 20236              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20237              GO TO 7100-DISPLAY-CANCELS
 20238           ELSE
 20239              GO TO 4610-BUMP-SEQ.
 20240
 20241     IF PB-CANCELLATION
 20242        IF CANCEL-WITH-WARNING
 20243           IF PB-WARNING-ERRORS
 20244              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20245                  GO TO 4610-BUMP-SEQ
 20246              ELSE
 20247                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20248                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20249                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20250                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20251                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 371
* EL6311.cbl
 20252                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20253                 GO TO 7100-DISPLAY-CANCELS
 20254           ELSE
 20255              GO TO 4610-BUMP-SEQ.
 20256
 20257     IF PB-CANCELLATION
 20258        IF (CANCEL-IN-ERROR  AND
 20259            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20260            ALL-CANCELS
 20261            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20262            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20263            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20264            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20265            MOVE PB-SV-STATE            TO PI-SV-STATE
 20266            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20267            GO TO 7100-DISPLAY-CANCELS.
 20268
 20269 4610-BUMP-SEQ.
 20270     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20271        GO TO 4650-END-BATCH.
 20272
 20273     IF DISPLAY-CHANGE-RECORDS
 20274        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20275           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20276        ELSE
 20277           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20278           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20279        ELSE
 20280           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20281           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20282
 20283        GO TO 4605-READ-NEXT.
 20284
 20285 4650-END-BATCH.
 20286     IF PI-MAP-NAME = EL631B
 20287        MOVE -1                  TO BMAINTL
 20288     ELSE
 20289        IF PI-MAP-NAME = EL631C
 20290           MOVE -1               TO CMAINTL
 20291        ELSE
 20292           MOVE -1               TO DPFENTRL.
 20293
 20294     MOVE ER-2252               TO EMI-ERROR.
 20295     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20296     GO TO 8200-SEND-DATAONLY.
 20297
 20298 4680-NOT-FOUND.
 20299     IF DISPLAY-CHANGE-RECORDS
 20300        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20301           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20302        ELSE
 20303           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20304           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20305     ELSE
 20306        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20307
 20308     GO TO 4605-READ-NEXT.
 20309
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 372
* EL6311.cbl
 20311
 20312******************************************************************
 20313*                                                                *
 20314*        B R O W S E   F I L E   B A C K W A R D S               *
 20315*                                                                *
 20316******************************************************************
 20317
 20318 4800-BROWSE-FILE-BACKWARD.
 20319
 20320* EXEC CICS HANDLE CONDITION
 20321*         NOTFND   (4860-NOT-FOUND)
 20322*         ENDFILE  (4850-END-RECORDS)
 20323*    END-EXEC.
 20324*    MOVE '"$I''                  ! K #00017459' TO DFHEIV0
 20325     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20326     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20327     MOVE X'4B20233030303137343539' TO DFHEIV0(25:11)
 20328     CALL 'kxdfhei1' USING DFHEIV0
 20329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20330
 20331
 20332     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20333
 20334     IF PI-DISPLAY-ORIGINAL-BATCH
 20335        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20336     ELSE
 20337        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20338
 20339
 20340* EXEC CICS STARTBR
 20341*         DATASET   (FILE-ID)
 20342*         RIDFLD    (ERPNDB-KEY)
 20343*    END-EXEC.
 20344     MOVE 0
 20345       TO DFHEIV11
 20346*    MOVE '&,         G          &   #00017471' TO DFHEIV0
 20347     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20348     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20349     MOVE X'2020233030303137343731' TO DFHEIV0(25:11)
 20350     CALL 'kxdfhei1' USING DFHEIV0,
 20351           FILE-ID,
 20352           ERPNDB-KEY,
 20353           DFHEIV99,
 20354           DFHEIV11,
 20355           DFHEIV99
 20356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20357
 20358
 20359     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20360
 20361
 20362* EXEC CICS READPREV
 20363*         DATASET    (FILE-ID-ERPNDB)
 20364*         SET        (ADDRESS OF PENDING-BUSINESS)
 20365*         RIDFLD     (ERPNDB-KEY)
 20366*    END-EXEC.
 20367     MOVE 0
 20368       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 373
* EL6311.cbl
 20369*    MOVE '&0S                   )   #00017478' TO DFHEIV0
 20370     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20371     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20372     MOVE X'2020233030303137343738' TO DFHEIV0(25:11)
 20373     CALL 'kxdfhei1' USING DFHEIV0,
 20374           FILE-ID-ERPNDB,
 20375           DFHEIV20,
 20376           DFHEIV99,
 20377           ERPNDB-KEY,
 20378           DFHEIV99,
 20379           DFHEIV11,
 20380           DFHEIV99,
 20381           DFHEIV99
 20382     SET ADDRESS OF PENDING-BUSINESS TO
 20383         DFHEIV20
 20384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20385
 20386
 20387 4810-READ-PREV-RECORD.
 20388
 20389* EXEC CICS READPREV
 20390*         DATASET    (FILE-ID-ERPNDB)
 20391*         SET        (ADDRESS OF PENDING-BUSINESS)
 20392*         RIDFLD     (ERPNDB-KEY)
 20393*    END-EXEC.
 20394     MOVE 0
 20395       TO DFHEIV11
 20396*    MOVE '&0S                   )   #00017485' TO DFHEIV0
 20397     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20398     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20399     MOVE X'2020233030303137343835' TO DFHEIV0(25:11)
 20400     CALL 'kxdfhei1' USING DFHEIV0,
 20401           FILE-ID-ERPNDB,
 20402           DFHEIV20,
 20403           DFHEIV99,
 20404           ERPNDB-KEY,
 20405           DFHEIV99,
 20406           DFHEIV11,
 20407           DFHEIV99,
 20408           DFHEIV99
 20409     SET ADDRESS OF PENDING-BUSINESS TO
 20410         DFHEIV20
 20411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20412
 20413
 20414     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20415        GO TO 4850-END-RECORDS.
 20416
 20417     IF PB-BATCH-TRAILER
 20418        GO TO 4810-READ-PREV-RECORD.
 20419
 20420     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20421
 20422     IF  WS-BATCH-PREFIX = '#CL'
 20423         GO TO 4810-READ-PREV-RECORD.
 20424
 20425     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20426        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 374
* EL6311.cbl
 20427           GO TO 4810-READ-PREV-RECORD
 20428        ELSE
 20429           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20430              GO TO 4820-CHECK-REC-TYPE
 20431           ELSE
 20432              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20433                 GO TO 4820-CHECK-REC-TYPE
 20434              ELSE
 20435                 GO TO 4810-READ-PREV-RECORD.
 20436
 20437     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20438        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20439           GO TO 4810-READ-PREV-RECORD.
 20440
 20441 4820-CHECK-REC-TYPE.
 20442     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20443         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20444             NEXT SENTENCE
 20445         ELSE
 20446             GO TO 4810-READ-PREV-RECORD.
 20447
 20448     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20449         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20450             NEXT SENTENCE
 20451        ELSE
 20452             GO TO 4810-READ-PREV-RECORD.
 20453
 20454     IF NOT DISPLAY-CHANGE-RECORDS AND
 20455            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20456        GO TO 4810-READ-PREV-RECORD.
 20457
 20458     IF DISPLAY-HOLD-RECORDS AND
 20459        NOT PB-RECORD-ON-HOLD
 20460          GO TO 4810-READ-PREV-RECORD.
 20461
 20462     IF PB-ISSUE
 20463        IF DISPLAY-CHK-REQ-RECORDS
 20464           GO TO 4810-READ-PREV-RECORD.
 20465
 20466     IF PB-ISSUE
 20467        IF ISSUE-WITH-WARNING
 20468           IF PB-WARNING-ERRORS
 20469              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20470                  GO TO 4810-READ-PREV-RECORD
 20471              ELSE
 20472                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20473                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20474                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20475                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20476                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20477                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20478                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20479                 GO TO 7000-DISPLAY-ISSUES
 20480           ELSE
 20481              GO TO 4810-READ-PREV-RECORD.
 20482
 20483     IF PB-ISSUE
 20484        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 375
* EL6311.cbl
 20485            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20486            ALL-ISSUES
 20487            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20488            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20489            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20490            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20491            MOVE PB-SV-STATE            TO PI-SV-STATE
 20492            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20493            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20494            GO TO 7000-DISPLAY-ISSUES
 20495        ELSE
 20496            GO TO 4810-READ-PREV-RECORD.
 20497
 20498     IF PB-CANCELLATION
 20499        IF DISPLAY-CHK-REQ-RECORDS
 20500           IF PB-C-REFUND-REQUESTED
 20501              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20502              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20503              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20504              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20505              MOVE PB-SV-STATE            TO PI-SV-STATE
 20506              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20507              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20508              GO TO 7100-DISPLAY-CANCELS
 20509           ELSE
 20510              GO TO 4810-READ-PREV-RECORD.
 20511
 20512     IF PB-CANCELLATION
 20513        IF CANCEL-WITH-WARNING
 20514           IF PB-WARNING-ERRORS
 20515              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20516                  GO TO 4810-READ-PREV-RECORD
 20517              ELSE
 20518                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20519                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20520                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20521                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20522                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20523                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20524                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20525                 GO TO 7100-DISPLAY-CANCELS
 20526           ELSE
 20527              GO TO 4810-READ-PREV-RECORD.
 20528
 20529     IF PB-CANCELLATION
 20530        IF (CANCEL-IN-ERROR  AND
 20531            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20532            ALL-CANCELS
 20533            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20534            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20535            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20536            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20537            MOVE PB-SV-STATE            TO PI-SV-STATE
 20538            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20539            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20540            GO TO 7100-DISPLAY-CANCELS.
 20541
 20542     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 376
* EL6311.cbl
 20543
 20544 4850-END-RECORDS.
 20545     MOVE ER-2252                TO EMI-ERROR.
 20546     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20547
 20548     IF PI-MAP-NAME = EL631B
 20549        MOVE -1                  TO BPFENTRL
 20550     ELSE
 20551        MOVE -1                  TO CPFENTRL.
 20552
 20553     GO TO 8200-SEND-DATAONLY.
 20554
 20555 4860-NOT-FOUND.
 20556
 20557******************************************************************
 20558*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20559******************************************************************
 20560
 20561
 20562* EXEC CICS RESETBR
 20563*         DATASET    (FILE-ID-ERPNDB)
 20564*         RIDFLD     (ERPNDB-KEY)
 20565*     END-EXEC.
 20566     MOVE 0
 20567       TO DFHEIV11
 20568*    MOVE '&4         G          &   #00017638' TO DFHEIV0
 20569     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20570     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20571     MOVE X'2020233030303137363338' TO DFHEIV0(25:11)
 20572     CALL 'kxdfhei1' USING DFHEIV0,
 20573           FILE-ID-ERPNDB,
 20574           ERPNDB-KEY,
 20575           DFHEIV99,
 20576           DFHEIV11,
 20577           DFHEIV99
 20578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20579
 20580
 20581
 20582* EXEC CICS READNEXT
 20583*         DATASET    (FILE-ID-ERPNDB)
 20584*         SET        (ADDRESS OF PENDING-BUSINESS)
 20585*         RIDFLD     (ERPNDB-KEY)
 20586*    END-EXEC.
 20587     MOVE 0
 20588       TO DFHEIV11
 20589*    MOVE '&.S                   )   #00017643' TO DFHEIV0
 20590     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20591     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20592     MOVE X'2020233030303137363433' TO DFHEIV0(25:11)
 20593     CALL 'kxdfhei1' USING DFHEIV0,
 20594           FILE-ID-ERPNDB,
 20595           DFHEIV20,
 20596           DFHEIV99,
 20597           ERPNDB-KEY,
 20598           DFHEIV99,
 20599           DFHEIV11,
 20600           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 377
* EL6311.cbl
 20601           DFHEIV99
 20602     SET ADDRESS OF PENDING-BUSINESS TO
 20603         DFHEIV20
 20604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20605
 20606
 20607
 20608* EXEC CICS READPREV
 20609*         DATASET    (FILE-ID-ERPNDB)
 20610*         SET        (ADDRESS OF PENDING-BUSINESS)
 20611*         RIDFLD     (ERPNDB-KEY)
 20612*    END-EXEC.
 20613     MOVE 0
 20614       TO DFHEIV11
 20615*    MOVE '&0S                   )   #00017649' TO DFHEIV0
 20616     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20617     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20618     MOVE X'2020233030303137363439' TO DFHEIV0(25:11)
 20619     CALL 'kxdfhei1' USING DFHEIV0,
 20620           FILE-ID-ERPNDB,
 20621           DFHEIV20,
 20622           DFHEIV99,
 20623           ERPNDB-KEY,
 20624           DFHEIV99,
 20625           DFHEIV11,
 20626           DFHEIV99,
 20627           DFHEIV99
 20628     SET ADDRESS OF PENDING-BUSINESS TO
 20629         DFHEIV20
 20630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20631
 20632
 20633     GO TO 4810-READ-PREV-RECORD.
 20634
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 378
* EL6311.cbl
 20636
 20637******************************************************************
 20638*                                                                *
 20639*           B R O W S E   C S R   B A C K W A R D                *
 20640*                                                                *
 20641******************************************************************
 20642
 20643 4900-BROWSE-CSR-BACKWARD.
 20644
 20645     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20646
 20647
 20648* EXEC CICS HANDLE CONDITION
 20649*         NOTFND   (4970-NOT-FOUND)
 20650*         ENDFILE  (4950-END-RECORDS)
 20651*    END-EXEC
 20652*    MOVE '"$I''                  ! L #00017669' TO DFHEIV0
 20653     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20655     MOVE X'4C20233030303137363639' TO DFHEIV0(25:11)
 20656     CALL 'kxdfhei1' USING DFHEIV0
 20657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20658
 20659
 20660* EXEC CICS STARTBR
 20661*         DATASET   (FILE-ID-ERPNDB4)
 20662*         RIDFLD    (ERPNDB-CSR-KEY)
 20663*    END-EXEC.
 20664     MOVE 0
 20665       TO DFHEIV11
 20666*    MOVE '&,         G          &   #00017674' TO DFHEIV0
 20667     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20668     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20669     MOVE X'2020233030303137363734' TO DFHEIV0(25:11)
 20670     CALL 'kxdfhei1' USING DFHEIV0,
 20671           FILE-ID-ERPNDB4,
 20672           ERPNDB-CSR-KEY,
 20673           DFHEIV99,
 20674           DFHEIV11,
 20675           DFHEIV99
 20676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20677
 20678
 20679     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20680                                    WS-FIRST-TIME-SW.
 20681
 20682 4905-READ-PREV-RECORD.
 20683
 20684* EXEC CICS READPREV
 20685*         DATASET    (FILE-ID-ERPNDB4)
 20686*         SET        (ADDRESS OF PENDING-BUSINESS)
 20687*         RIDFLD     (ERPNDB-CSR-KEY)
 20688*    END-EXEC.
 20689     MOVE 0
 20690       TO DFHEIV11
 20691*    MOVE '&0S                   )   #00017683' TO DFHEIV0
 20692     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20693     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 379
* EL6311.cbl
 20694     MOVE X'2020233030303137363833' TO DFHEIV0(25:11)
 20695     CALL 'kxdfhei1' USING DFHEIV0,
 20696           FILE-ID-ERPNDB4,
 20697           DFHEIV20,
 20698           DFHEIV99,
 20699           ERPNDB-CSR-KEY,
 20700           DFHEIV99,
 20701           DFHEIV11,
 20702           DFHEIV99,
 20703           DFHEIV99
 20704     SET ADDRESS OF PENDING-BUSINESS TO
 20705         DFHEIV20
 20706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20707
 20708
 20709     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20710
 20711     IF WS-BATCH-PREFIX = '#CL'
 20712         GO TO 4905-READ-PREV-RECORD.
 20713
 20714     IF FIRST-TIME
 20715         MOVE SPACE               TO WS-FIRST-TIME-SW
 20716         GO TO 4905-READ-PREV-RECORD.
 20717
 20718     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20719        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20720        GO TO 4950-END-RECORDS.
 20721
 20722     IF PB-BATCH-TRAILER
 20723        GO TO 4905-READ-PREV-RECORD.
 20724
 20725     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20726
 20727     IF  WS-BATCH-PREFIX = '#CL'
 20728         GO TO 4905-READ-PREV-RECORD.
 20729
 20730     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20731        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20732           GO TO 4905-READ-PREV-RECORD
 20733        ELSE
 20734           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20735              GO TO 4910-CHECK-REC-TYPE
 20736           ELSE
 20737              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20738                 GO TO 4910-CHECK-REC-TYPE
 20739              ELSE
 20740                 GO TO 4905-READ-PREV-RECORD.
 20741
 20742     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20743        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20744           GO TO 4905-READ-PREV-RECORD.
 20745
 20746 4910-CHECK-REC-TYPE.
 20747     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20748         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20749             NEXT SENTENCE
 20750         ELSE
 20751             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 380
* EL6311.cbl
 20752
 20753     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20754         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20755             NEXT SENTENCE
 20756        ELSE
 20757             GO TO 4905-READ-PREV-RECORD.
 20758
 20759     IF NOT DISPLAY-CHANGE-RECORDS AND
 20760            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20761        GO TO 4905-READ-PREV-RECORD.
 20762
 20763     IF DISPLAY-HOLD-RECORDS AND
 20764        NOT PB-RECORD-ON-HOLD
 20765          GO TO 4905-READ-PREV-RECORD.
 20766
 20767     IF PB-ISSUE
 20768        IF DISPLAY-CHK-REQ-RECORDS
 20769           GO TO 4905-READ-PREV-RECORD.
 20770
 20771     IF PB-ISSUE
 20772        IF ISSUE-WITH-WARNING
 20773           IF PB-WARNING-ERRORS
 20774              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20775                  GO TO 4505-READ-PREV-RECORD
 20776              ELSE
 20777                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20778                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20779                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20780                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20781                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20782                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20783                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20784                 GO TO 7000-DISPLAY-ISSUES
 20785           ELSE
 20786              GO TO 4905-READ-PREV-RECORD.
 20787
 20788     IF PB-ISSUE
 20789        IF (ISSUES-IN-ERROR AND
 20790            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20791            ALL-ISSUES
 20792            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20793            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20794            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20795            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20796            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20797            MOVE PB-SV-STATE            TO PI-SV-STATE
 20798            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20799            GO TO 7000-DISPLAY-ISSUES
 20800        ELSE
 20801            GO TO 4905-READ-PREV-RECORD.
 20802
 20803     IF PB-CANCELLATION
 20804        IF DISPLAY-CHK-REQ-RECORDS
 20805           IF PB-C-REFUND-REQUESTED
 20806              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20807              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20808              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20809              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 381
* EL6311.cbl
 20810              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20811              MOVE PB-SV-STATE            TO PI-SV-STATE
 20812              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20813              GO TO 7100-DISPLAY-CANCELS
 20814           ELSE
 20815              GO TO 4905-READ-PREV-RECORD.
 20816
 20817     IF PB-CANCELLATION
 20818        IF CANCEL-WITH-WARNING
 20819           IF PB-WARNING-ERRORS
 20820              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20821                  GO TO 4505-READ-PREV-RECORD
 20822              ELSE
 20823                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20824                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20825                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20826                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20827                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20828                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20829                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20830                 GO TO 7100-DISPLAY-CANCELS
 20831           ELSE
 20832              GO TO 4905-READ-PREV-RECORD.
 20833
 20834     IF PB-CANCELLATION
 20835        IF (CANCEL-IN-ERROR  AND
 20836            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20837            ALL-CANCELS
 20838            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20839            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20840            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20841            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20842            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20843            MOVE PB-SV-STATE            TO PI-SV-STATE
 20844            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20845            GO TO 7100-DISPLAY-CANCELS.
 20846
 20847     GO TO 4905-READ-PREV-RECORD.
 20848
 20849 4950-END-RECORDS.
 20850     IF PI-MAP-NAME = EL631B
 20851        MOVE -1                  TO BMAINTL
 20852     ELSE
 20853        IF PI-MAP-NAME = EL631C
 20854           MOVE -1               TO CMAINTL
 20855        ELSE
 20856           MOVE -1               TO DPFENTRL.
 20857
 20858     MOVE ER-2255               TO EMI-ERROR.
 20859     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20860     GO TO 8200-SEND-DATAONLY.
 20861
 20862 4970-NOT-FOUND.
 20863
 20864******************************************************************
 20865*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20866******************************************************************
 20867
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 382
* EL6311.cbl
 20868
 20869* EXEC CICS RESETBR
 20870*         DATASET    (FILE-ID-ERPNDB4)
 20871*         RIDFLD     (ERPNDB-CSR-KEY)
 20872*    END-EXEC.
 20873     MOVE 0
 20874       TO DFHEIV11
 20875*    MOVE '&4         G          &   #00017848' TO DFHEIV0
 20876     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20877     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20878     MOVE X'2020233030303137383438' TO DFHEIV0(25:11)
 20879     CALL 'kxdfhei1' USING DFHEIV0,
 20880           FILE-ID-ERPNDB4,
 20881           ERPNDB-CSR-KEY,
 20882           DFHEIV99,
 20883           DFHEIV11,
 20884           DFHEIV99
 20885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20886
 20887
 20888
 20889* EXEC CICS READNEXT
 20890*         DATASET    (FILE-ID-ERPNDB4)
 20891*         SET        (ADDRESS OF PENDING-BUSINESS)
 20892*         RIDFLD     (ERPNDB-CSR-KEY)
 20893*    END-EXEC.
 20894     MOVE 0
 20895       TO DFHEIV11
 20896*    MOVE '&.S                   )   #00017853' TO DFHEIV0
 20897     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20898     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20899     MOVE X'2020233030303137383533' TO DFHEIV0(25:11)
 20900     CALL 'kxdfhei1' USING DFHEIV0,
 20901           FILE-ID-ERPNDB4,
 20902           DFHEIV20,
 20903           DFHEIV99,
 20904           ERPNDB-CSR-KEY,
 20905           DFHEIV99,
 20906           DFHEIV11,
 20907           DFHEIV99,
 20908           DFHEIV99
 20909     SET ADDRESS OF PENDING-BUSINESS TO
 20910         DFHEIV20
 20911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20912
 20913
 20914
 20915* EXEC CICS READPREV
 20916*         DATASET    (FILE-ID-ERPNDB4)
 20917*         SET        (ADDRESS OF PENDING-BUSINESS)
 20918*         RIDFLD     (ERPNDB-CSR-KEY)
 20919*    END-EXEC.
 20920     MOVE 0
 20921       TO DFHEIV11
 20922*    MOVE '&0S                   )   #00017859' TO DFHEIV0
 20923     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20924     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20925     MOVE X'2020233030303137383539' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 383
* EL6311.cbl
 20926     CALL 'kxdfhei1' USING DFHEIV0,
 20927           FILE-ID-ERPNDB4,
 20928           DFHEIV20,
 20929           DFHEIV99,
 20930           ERPNDB-CSR-KEY,
 20931           DFHEIV99,
 20932           DFHEIV11,
 20933           DFHEIV99,
 20934           DFHEIV99
 20935     SET ADDRESS OF PENDING-BUSINESS TO
 20936         DFHEIV20
 20937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20938
 20939
 20940 4980-READ-PREV-RECORD.
 20941
 20942* EXEC CICS READPREV
 20943*         DATASET    (FILE-ID-ERPNDB4)
 20944*         SET        (ADDRESS OF PENDING-BUSINESS)
 20945*         RIDFLD     (ERPNDB-CSR-KEY)
 20946*    END-EXEC.
 20947     MOVE 0
 20948       TO DFHEIV11
 20949*    MOVE '&0S                   )   #00017866' TO DFHEIV0
 20950     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20951     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20952     MOVE X'2020233030303137383636' TO DFHEIV0(25:11)
 20953     CALL 'kxdfhei1' USING DFHEIV0,
 20954           FILE-ID-ERPNDB4,
 20955           DFHEIV20,
 20956           DFHEIV99,
 20957           ERPNDB-CSR-KEY,
 20958           DFHEIV99,
 20959           DFHEIV11,
 20960           DFHEIV99,
 20961           DFHEIV99
 20962     SET ADDRESS OF PENDING-BUSINESS TO
 20963         DFHEIV20
 20964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20965
 20966
 20967     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20968
 20969     IF WS-BATCH-PREFIX = '#CL'
 20970        GO TO 4980-READ-PREV-RECORD.
 20971
 20972     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20973     GO TO 4905-READ-PREV-RECORD.
 20974
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 384
* EL6311.cbl
 20976
 20977
 20978******************************************************************
 20979*                                                                *
 20980*        B R O W S E   B A T C H   H E A D E R S                 *
 20981*                                                                *
 20982******************************************************************
 20983
 20984 5000-BROWSE-BATCH-HEADERS.
 20985
 20986     IF EIBTRNID NOT = TRANS-EXB1
 20987        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20988        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20989        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20990        GO TO 5010-READ-NEXT-RECORD.
 20991
 20992     IF EIBAID = DFHPF4
 20993        MOVE '0'                TO PI-EDIT-SW
 20994        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20995        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20996        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20997        GO TO 5010-READ-NEXT-RECORD.
 20998
 20999     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21000     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21001     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21002
 21003
 21004* EXEC CICS HANDLE CONDITION
 21005*         ENDFILE  (5050-NOT-FOUND)
 21006*    END-EXEC.
 21007*    MOVE '"$''                   ! M #00017908' TO DFHEIV0
 21008     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21009     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21010     MOVE X'4D20233030303137393038' TO DFHEIV0(25:11)
 21011     CALL 'kxdfhei1' USING DFHEIV0
 21012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21013
 21014
 21015 5010-READ-NEXT-RECORD.
 21016
 21017* EXEC CICS HANDLE CONDITION
 21018*         NOTFND    (5050-NOT-FOUND)
 21019*    END-EXEC.
 21020*    MOVE '"$I                   ! N #00017913' TO DFHEIV0
 21021     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21022     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21023     MOVE X'4E20233030303137393133' TO DFHEIV0(25:11)
 21024     CALL 'kxdfhei1' USING DFHEIV0
 21025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21026
 21027
 21028
 21029* EXEC CICS READ
 21030*         DATASET   (FILE-ID-ERPNDB)
 21031*         SET       (ADDRESS OF PENDING-BUSINESS)
 21032*         RIDFLD    (ERPNDB-KEY)
 21033*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 385
* EL6311.cbl
 21034*    END-EXEC.
 21035*    MOVE '&"S        G          (   #00017917' TO DFHEIV0
 21036     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21037     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21038     MOVE X'2020233030303137393137' TO DFHEIV0(25:11)
 21039     CALL 'kxdfhei1' USING DFHEIV0,
 21040           FILE-ID-ERPNDB,
 21041           DFHEIV20,
 21042           DFHEIV99,
 21043           ERPNDB-KEY,
 21044           DFHEIV99,
 21045           DFHEIV99,
 21046           DFHEIV99
 21047     SET ADDRESS OF PENDING-BUSINESS TO
 21048         DFHEIV20
 21049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21050
 21051
 21052     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21053         GO TO 5050-NOT-FOUND.
 21054
 21055     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21056
 21057     IF WS-BATCH-PREFIX = '#CL'
 21058         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21059         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21060         GO TO 5010-READ-NEXT-RECORD.
 21061
 21062     IF NOT PB-BATCH-TRAILER
 21063         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21064         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21065         GO TO 5010-READ-NEXT-RECORD.
 21066
 21067     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21068         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21069             NEXT SENTENCE
 21070         ELSE
 21071             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21072             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21073             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21074             GO TO 5010-READ-NEXT-RECORD.
 21075
 21076     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21077         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21078             NEXT SENTENCE
 21079        ELSE
 21080             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21081             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21082             GO TO 5010-READ-NEXT-RECORD.
 21083
 21084     IF EIBAID = DFHPF4
 21085        MOVE '0'                TO PI-EDIT-SW
 21086        GO TO 7200-DISPLAY-BATCHES.
 21087
 21088     IF PI-CSR-BROWSE
 21089        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21090           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21091           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 386
* EL6311.cbl
 21092           GO TO 5010-READ-NEXT-RECORD.
 21093
 21094     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21095       IF PI-PB-CARRIER    = SPACES AND
 21096          PI-PB-GROUPING   = SPACES AND
 21097          PI-PB-STATE      = SPACES AND
 21098          PI-PB-ACCOUNT    = SPACES
 21099            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21100            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21101            GO TO 7200-DISPLAY-BATCHES
 21102         ELSE
 21103           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21104              PI-PB-GROUPING   = PB-GROUPING AND
 21105              PI-PB-STATE      = PB-STATE    AND
 21106              PI-PB-ACCOUNT    = PB-ACCOUNT
 21107              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21108              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21109              GO TO 7200-DISPLAY-BATCHES.
 21110
 21111     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21112     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21113
 21114
 21115* EXEC CICS HANDLE CONDITION
 21116*         NOTFND    (5050-NOT-FOUND)
 21117*    END-EXEC.
 21118*    MOVE '"$I                   ! O #00017986' TO DFHEIV0
 21119     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21120     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21121     MOVE X'4F20233030303137393836' TO DFHEIV0(25:11)
 21122     CALL 'kxdfhei1' USING DFHEIV0
 21123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21124
 21125
 21126
 21127* EXEC CICS READ
 21128*         DATASET   (FILE-ID-ERPNDB)
 21129*         SET       (ADDRESS OF PENDING-BUSINESS)
 21130*         RIDFLD    (ERPNDB-KEY)
 21131*         GTEQ
 21132*    END-EXEC.
 21133*    MOVE '&"S        G          (   #00017990' TO DFHEIV0
 21134     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21135     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21136     MOVE X'2020233030303137393930' TO DFHEIV0(25:11)
 21137     CALL 'kxdfhei1' USING DFHEIV0,
 21138           FILE-ID-ERPNDB,
 21139           DFHEIV20,
 21140           DFHEIV99,
 21141           ERPNDB-KEY,
 21142           DFHEIV99,
 21143           DFHEIV99,
 21144           DFHEIV99
 21145     SET ADDRESS OF PENDING-BUSINESS TO
 21146         DFHEIV20
 21147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21148
 21149
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 387
* EL6311.cbl
 21150     GO TO 5010-READ-NEXT-RECORD.
 21151
 21152 5050-NOT-FOUND.
 21153
 21154******************************************************************
 21155*                                                                *
 21156*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21157*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21158*         PROGRAM.                                               *
 21159*                                                                *
 21160******************************************************************
 21161
 21162     IF EIBTRNID NOT = TRANS-EXB1
 21163        IF PENDING-BUS-RECS-FOUND
 21164            NEXT SENTENCE
 21165          ELSE
 21166            MOVE '9'            TO PI-BROWSE-SW
 21167            GO TO 9400-CLEAR.
 21168
 21169     MOVE ER-2256                TO EMI-ERROR.
 21170     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21171
 21172     IF PI-MAP-NAME = SPACES
 21173        MOVE EL631D              TO PI-MAP-NAME
 21174        MOVE -1                  TO DPFENTRL
 21175        GO TO 8100-SEND-INITIAL-MAP.
 21176
 21177     IF PI-MAP-NAME = EL631B
 21178        MOVE -1                  TO BMAINTL
 21179     ELSE
 21180        IF PI-MAP-NAME = EL631C
 21181           MOVE -1               TO CMAINTL
 21182        ELSE
 21183           MOVE -1               TO DPFENTRL
 21184           GO TO 8200-SEND-DATAONLY.
 21185
 21186     GO TO 8100-SEND-INITIAL-MAP.
 21187
 21188     .
 21189 5100-PROCESS-POL-RESC.
 21190     MOVE ZEROS                  TO CG-LF-BENCD
 21191                                    CG-AH-BENCD
 21192                                    CG-LF-CAN-AMT
 21193                                    CG-AH-CAN-AMT
 21194     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21195                                    CG-AH-CAN-DT
 21196     MOVE SPACES                 TO CG-BATCH-NO
 21197     MOVE '4'                    TO CG-OPTION-CODE
 21198     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21199     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21200     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21201     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21202     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21203     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21204     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21205     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21206     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21207     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 388
* EL6311.cbl
 21208     MOVE PI-PREV-ALT-KEY (1:33)
 21209                                 TO CG-CERT-KEY
 21210     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21211     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21212                                    CG-AH-CAN-AMT
 21213     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21214                                    CG-AH-CAN-DT
 21215     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21216     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21217      display 'about to cancel ' cg-cert-key
 21218
 21219* EXEC CICS LINK
 21220*        PROGRAM  ('ELCANC')
 21221*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21222*    END-EXEC
 21223     MOVE LENGTH OF
 21224      CANCEL-GEN-PASS-AREA
 21225       TO DFHEIV11
 21226     MOVE 'ELCANC' TO DFHEIV1
 21227*    MOVE '."C                   (   #00018065' TO DFHEIV0
 21228     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21229     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21230     MOVE X'2020233030303138303635' TO DFHEIV0(25:11)
 21231     CALL 'kxdfhei1' USING DFHEIV0,
 21232           DFHEIV1,
 21233           CANCEL-GEN-PASS-AREA,
 21234           DFHEIV11,
 21235           DFHEIV99,
 21236           DFHEIV99,
 21237           DFHEIV99,
 21238           DFHEIV99
 21239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21240     IF CG-SUCCESS
 21241        CONTINUE
 21242     ELSE
 21243        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21244        MOVE '3'                 TO EMI-SWITCH1
 21245        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21246        EVALUATE TRUE
 21247           WHEN CG-DATE-ERROR
 21248             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21249           WHEN CG-CERT-NOT-FOUND
 21250             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21251           WHEN CG-AMOUNT-ERROR
 21252             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21253           WHEN CG-OPTION-ERROR
 21254             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21255           WHEN CG-PREV-CAN
 21256             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21257           WHEN CG-INVALID-DATA
 21258             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21259           WHEN CG-NO-ACCT-MSTR
 21260             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21261           WHEN CG-SFX-A-EXIST
 21262             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21263           WHEN CG-MISC-ERROR
 21264             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21265           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 389
* EL6311.cbl
 21266             MOVE ' ERROR - ELCANC - RETURN '
 21267                                 TO EMI-ERROR-TEXT (1) (12:25)
 21268        END-EVALUATE
 21269        GO TO 8200-SEND-DATAONLY
 21270     END-IF
 21271
 21272* EXEC CICS GETMAIN
 21273*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 21274*        LENGTH  (ELCRTT-RECORD-LENGTH)
 21275*        INITIMG (GETMAIN-SPACE)
 21276*    END-EXEC
 21277*    MOVE ',"IL                  $   #00018100' TO DFHEIV0
 21278     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21279     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21280     MOVE X'2020233030303138313030' TO DFHEIV0(25:11)
 21281     CALL 'kxdfhei1' USING DFHEIV0,
 21282           DFHEIV20,
 21283           ELCRTT-RECORD-LENGTH,
 21284           GETMAIN-SPACE
 21285     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 21286         DFHEIV20
 21287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21288
 21289     move ' '                    to ws-elcrtt-update-sw
 21290     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTT-PRIMARY
 21291     MOVE 'C'                    TO ELCRTT-REC-TYPE
 21292
 21293
 21294* EXEC CICS READ
 21295*        UPDATE
 21296*        DATASET  (CRTT-ID)
 21297*        RIDFLD   (ELCRTT-KEY)
 21298*        INTO     (CERTIFICATE-TRAILERS)
 21299*        resp     (ws-response)
 21300*    END-EXEC
 21301     MOVE LENGTH OF
 21302      CERTIFICATE-TRAILERS
 21303       TO DFHEIV11
 21304*    MOVE '&"IL       EU         (  N#00018110' TO DFHEIV0
 21305     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21306     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21307     MOVE X'204E233030303138313130' TO DFHEIV0(25:11)
 21308     CALL 'kxdfhei1' USING DFHEIV0,
 21309           CRTT-ID,
 21310           CERTIFICATE-TRAILERS,
 21311           DFHEIV11,
 21312           ELCRTT-KEY,
 21313           DFHEIV99,
 21314           DFHEIV99,
 21315           DFHEIV99
 21316     MOVE EIBRESP  TO ws-response
 21317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21318
 21319     if resp-normal
 21320        if cs-claim-verification-status = 'B' or 'C' or 'D' or
 21321                  'E' or 'F' or 'G'
 21322           move 'J'              to cs-claim-verification-status
 21323           set update-elcrtt to true
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 390
* EL6311.cbl
 21324        end-if
 21325        if update-elcrtt
 21326
 21327* EXEC CICS REWRITE
 21328*             DATASET    (crtt-ID)
 21329*             FROM       (CERTIFICATE-TRAILERS)
 21330*          END-EXEC
 21331     MOVE LENGTH OF
 21332      CERTIFICATE-TRAILERS
 21333       TO DFHEIV11
 21334*    MOVE '&& L                  %   #00018125' TO DFHEIV0
 21335     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21336     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21337     MOVE X'2020233030303138313235' TO DFHEIV0(25:11)
 21338     CALL 'kxdfhei1' USING DFHEIV0,
 21339           crtt-ID,
 21340           CERTIFICATE-TRAILERS,
 21341           DFHEIV11,
 21342           DFHEIV99
 21343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21344        else
 21345
 21346* exec cics unlock
 21347*             dataset    (crtt-ID)
 21348*          end-exec
 21349*    MOVE '&*                    #   #00018130' TO DFHEIV0
 21350     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21351     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21352     MOVE X'2020233030303138313330' TO DFHEIV0(25:11)
 21353     CALL 'kxdfhei1' USING DFHEIV0,
 21354           crtt-ID,
 21355           DFHEIV99
 21356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21357        end-if
 21358     end-if
 21359     .
 21360 5100-EXIT.
 21361     EXIT.
 21362
 21363******************************************************************
 21364*                                                                *
 21365*        B R O W S E   B A T C H   B A C K W A R D S             *
 21366*                                                                *
 21367******************************************************************
 21368
 21369 5500-BROWSE-BATCH-BACKWARD.
 21370
 21371* EXEC CICS HANDLE CONDITION
 21372*         NOTFND   (5550-END-RECORDS)
 21373*         ENDFILE  (5550-END-RECORDS)
 21374*    END-EXEC.
 21375*    MOVE '"$I''                  ! P #00018146' TO DFHEIV0
 21376     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21377     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21378     MOVE X'5020233030303138313436' TO DFHEIV0(25:11)
 21379     CALL 'kxdfhei1' USING DFHEIV0
 21380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21381
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 391
* EL6311.cbl
 21382
 21383 5505-START-BROWSE.
 21384     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21385     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21386     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21387
 21388
 21389* EXEC CICS STARTBR
 21390*         DATASET   (FILE-ID-ERPNDB)
 21391*         RIDFLD    (ERPNDB-ALT-KEY)
 21392*    END-EXEC.
 21393     MOVE 0
 21394       TO DFHEIV11
 21395*    MOVE '&,         G          &   #00018156' TO DFHEIV0
 21396     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21397     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21398     MOVE X'2020233030303138313536' TO DFHEIV0(25:11)
 21399     CALL 'kxdfhei1' USING DFHEIV0,
 21400           FILE-ID-ERPNDB,
 21401           ERPNDB-ALT-KEY,
 21402           DFHEIV99,
 21403           DFHEIV11,
 21404           DFHEIV99
 21405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21406
 21407
 21408     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21409
 21410
 21411* EXEC CICS READNEXT
 21412*         DATASET    (FILE-ID-ERPNDB)
 21413*         SET        (ADDRESS OF PENDING-BUSINESS)
 21414*         RIDFLD     (ERPNDB-KEY)
 21415*    END-EXEC.
 21416     MOVE 0
 21417       TO DFHEIV11
 21418*    MOVE '&.S                   )   #00018163' TO DFHEIV0
 21419     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21420     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21421     MOVE X'2020233030303138313633' TO DFHEIV0(25:11)
 21422     CALL 'kxdfhei1' USING DFHEIV0,
 21423           FILE-ID-ERPNDB,
 21424           DFHEIV20,
 21425           DFHEIV99,
 21426           ERPNDB-KEY,
 21427           DFHEIV99,
 21428           DFHEIV11,
 21429           DFHEIV99,
 21430           DFHEIV99
 21431     SET ADDRESS OF PENDING-BUSINESS TO
 21432         DFHEIV20
 21433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21434
 21435
 21436
 21437* EXEC CICS READPREV
 21438*         DATASET    (FILE-ID-ERPNDB)
 21439*         SET        (ADDRESS OF PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 392
* EL6311.cbl
 21440*         RIDFLD     (ERPNDB-KEY)
 21441*    END-EXEC.
 21442     MOVE 0
 21443       TO DFHEIV11
 21444*    MOVE '&0S                   )   #00018169' TO DFHEIV0
 21445     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21446     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21447     MOVE X'2020233030303138313639' TO DFHEIV0(25:11)
 21448     CALL 'kxdfhei1' USING DFHEIV0,
 21449           FILE-ID-ERPNDB,
 21450           DFHEIV20,
 21451           DFHEIV99,
 21452           ERPNDB-KEY,
 21453           DFHEIV99,
 21454           DFHEIV11,
 21455           DFHEIV99,
 21456           DFHEIV99
 21457     SET ADDRESS OF PENDING-BUSINESS TO
 21458         DFHEIV20
 21459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21460
 21461
 21462
 21463* EXEC CICS READPREV
 21464*         DATASET    (FILE-ID-ERPNDB)
 21465*         SET        (ADDRESS OF PENDING-BUSINESS)
 21466*         RIDFLD     (ERPNDB-KEY)
 21467*    END-EXEC.
 21468     MOVE 0
 21469       TO DFHEIV11
 21470*    MOVE '&0S                   )   #00018175' TO DFHEIV0
 21471     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21472     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21473     MOVE X'2020233030303138313735' TO DFHEIV0(25:11)
 21474     CALL 'kxdfhei1' USING DFHEIV0,
 21475           FILE-ID-ERPNDB,
 21476           DFHEIV20,
 21477           DFHEIV99,
 21478           ERPNDB-KEY,
 21479           DFHEIV99,
 21480           DFHEIV11,
 21481           DFHEIV99,
 21482           DFHEIV99
 21483     SET ADDRESS OF PENDING-BUSINESS TO
 21484         DFHEIV20
 21485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21486
 21487
 21488     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21489        GO TO 5550-END-RECORDS.
 21490
 21491     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21492
 21493     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21494
 21495     IF  WS-BATCH-PREFIX = '#CL'
 21496             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21497
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 393
* EL6311.cbl
 21498* EXEC CICS ENDBR
 21499*                 DATASET  (FILE-ID-ERPNDB)
 21500*            END-EXEC
 21501     MOVE 0
 21502       TO DFHEIV11
 21503*    MOVE '&2                    $   #00018190' TO DFHEIV0
 21504     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21505     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21506     MOVE X'2020233030303138313930' TO DFHEIV0(25:11)
 21507     CALL 'kxdfhei1' USING DFHEIV0,
 21508           FILE-ID-ERPNDB,
 21509           DFHEIV11,
 21510           DFHEIV99
 21511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21512         GO TO 5505-START-BROWSE.
 21513
 21514     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21515         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21516             NEXT SENTENCE
 21517         ELSE
 21518             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21519
 21520* EXEC CICS ENDBR
 21521*                 DATASET  (FILE-ID-ERPNDB)
 21522*            END-EXEC
 21523     MOVE 0
 21524       TO DFHEIV11
 21525*    MOVE '&2                    $   #00018200' TO DFHEIV0
 21526     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21527     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21528     MOVE X'2020233030303138323030' TO DFHEIV0(25:11)
 21529     CALL 'kxdfhei1' USING DFHEIV0,
 21530           FILE-ID-ERPNDB,
 21531           DFHEIV11,
 21532           DFHEIV99
 21533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21534             GO TO 5505-START-BROWSE.
 21535
 21536
 21537     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21538         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21539             NEXT SENTENCE
 21540        ELSE
 21541             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21542
 21543* EXEC CICS ENDBR
 21544*                 DATASET  (FILE-ID-ERPNDB)
 21545*            END-EXEC
 21546     MOVE 0
 21547       TO DFHEIV11
 21548*    MOVE '&2                    $   #00018211' TO DFHEIV0
 21549     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21550     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21551     MOVE X'2020233030303138323131' TO DFHEIV0(25:11)
 21552     CALL 'kxdfhei1' USING DFHEIV0,
 21553           FILE-ID-ERPNDB,
 21554           DFHEIV11,
 21555           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 394
* EL6311.cbl
 21556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21557             GO TO 5505-START-BROWSE.
 21558
 21559     IF NOT PB-BATCH-TRAILER
 21560        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21561
 21562* EXEC CICS ENDBR
 21563*            DATASET  (FILE-ID-ERPNDB)
 21564*       END-EXEC
 21565     MOVE 0
 21566       TO DFHEIV11
 21567*    MOVE '&2                    $   #00018218' TO DFHEIV0
 21568     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21569     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21570     MOVE X'2020233030303138323138' TO DFHEIV0(25:11)
 21571     CALL 'kxdfhei1' USING DFHEIV0,
 21572           FILE-ID-ERPNDB,
 21573           DFHEIV11,
 21574           DFHEIV99
 21575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21576        GO TO 5505-START-BROWSE.
 21577
 21578     IF PI-CSR-BROWSE
 21579        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21580           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21581
 21582* EXEC CICS ENDBR
 21583*               DATASET  (FILE-ID-ERPNDB)
 21584*          END-EXEC
 21585     MOVE 0
 21586       TO DFHEIV11
 21587*    MOVE '&2                    $   #00018226' TO DFHEIV0
 21588     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21589     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21590     MOVE X'2020233030303138323236' TO DFHEIV0(25:11)
 21591     CALL 'kxdfhei1' USING DFHEIV0,
 21592           FILE-ID-ERPNDB,
 21593           DFHEIV11,
 21594           DFHEIV99
 21595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21596           GO TO 5505-START-BROWSE.
 21597
 21598     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21599        IF PI-PB-CARRIER    = SPACES AND
 21600           PI-PB-GROUPING   = SPACES AND
 21601           PI-PB-STATE      = SPACES AND
 21602           PI-PB-ACCOUNT    = SPACES
 21603             GO TO 7200-DISPLAY-BATCHES
 21604          ELSE
 21605            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21606               PI-PB-GROUPING   = PB-GROUPING AND
 21607               PI-PB-STATE      = PB-STATE    AND
 21608               PI-PB-ACCOUNT    = PB-ACCOUNT
 21609                 GO TO 7200-DISPLAY-BATCHES.
 21610
 21611     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21612
 21613
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 395
* EL6311.cbl
 21614* EXEC CICS ENDBR
 21615*         DATASET  (FILE-ID-ERPNDB)
 21616*    END-EXEC.
 21617     MOVE 0
 21618       TO DFHEIV11
 21619*    MOVE '&2                    $   #00018246' TO DFHEIV0
 21620     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21621     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21622     MOVE X'2020233030303138323436' TO DFHEIV0(25:11)
 21623     CALL 'kxdfhei1' USING DFHEIV0,
 21624           FILE-ID-ERPNDB,
 21625           DFHEIV11,
 21626           DFHEIV99
 21627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21628
 21629
 21630     GO TO 5505-START-BROWSE.
 21631
 21632 5550-END-RECORDS.
 21633     MOVE ER-2257                TO EMI-ERROR.
 21634     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21635     MOVE -1                     TO DPFENTRL.
 21636
 21637     GO TO 8200-SEND-DATAONLY.
 21638
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 396
* EL6311.cbl
 21640
 21641******************************************************************
 21642*                                                                *
 21643*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21644*                                                                *
 21645******************************************************************
 21646
 21647 6000-CREATE-TEMP-STORAGE.
 21648
 21649
 21650* EXEC CICS HANDLE CONDITION
 21651*        QIDERR  (6050-QID-ERROR)
 21652*    END-EXEC.
 21653*    MOVE '"$N                   ! Q #00018269' TO DFHEIV0
 21654     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21655     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21656     MOVE X'5120233030303138323639' TO DFHEIV0(25:11)
 21657     CALL 'kxdfhei1' USING DFHEIV0
 21658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21659
 21660
 21661
 21662* EXEC CICS WRITEQ TS
 21663*        QUEUE    (QID)
 21664*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21665*        LENGTH   (WS-COMM-LENGTH)
 21666*        ITEM     (W-ONE)
 21667*    END-EXEC.
 21668*    MOVE '*" I   L              ''   #00018273' TO DFHEIV0
 21669     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 21670     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21671     MOVE X'2020233030303138323733' TO DFHEIV0(25:11)
 21672     CALL 'kxdfhei1' USING DFHEIV0,
 21673           QID,
 21674           PROGRAM-INTERFACE-BLOCK,
 21675           WS-COMM-LENGTH,
 21676           W-ONE,
 21677           DFHEIV99,
 21678           DFHEIV99
 21679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21680
 21681
 21682 6000-EXIT.
 21683      EXIT.
 21684
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 397
* EL6311.cbl
 21686
 21687******************************************************************
 21688*                                                                *
 21689*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21690*                                                                *
 21691******************************************************************
 21692
 21693 6050-RECOVER-TEMP-STORAGE.
 21694     IF PGM-NAME = XCTL-EL6312
 21695        GO TO 6050-EXIT.
 21696
 21697     IF PGM-NAME = XCTL-EL6313
 21698        GO TO 6050-EXIT.
 21699
 21700     IF PGM-NAME = XCTL-EL6315
 21701         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21702     END-IF
 21703
 21704     IF PGM-NAME = XCTL-EL6316
 21705         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21706     END-IF
 21707
 21708
 21709* EXEC CICS HANDLE CONDITION
 21710*        QIDERR  (6050-QID-ERROR)
 21711*    END-EXEC.
 21712*    MOVE '"$N                   ! R #00018306' TO DFHEIV0
 21713     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21714     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21715     MOVE X'5220233030303138333036' TO DFHEIV0(25:11)
 21716     CALL 'kxdfhei1' USING DFHEIV0
 21717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21718
 21719
 21720
 21721* EXEC CICS READQ TS
 21722*         QUEUE   (QID)
 21723*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21724*         LENGTH  (WS-COMM-LENGTH)
 21725*         ITEM    (W-ONE)
 21726*     END-EXEC.
 21727*    MOVE '*$II   L              ''   #00018310' TO DFHEIV0
 21728     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21729     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21730     MOVE X'2020233030303138333130' TO DFHEIV0(25:11)
 21731     CALL 'kxdfhei1' USING DFHEIV0,
 21732           QID,
 21733           PROGRAM-INTERFACE-BLOCK,
 21734           WS-COMM-LENGTH,
 21735           W-ONE,
 21736           DFHEIV99,
 21737           DFHEIV99
 21738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21739
 21740
 21741 6050-DELETE-TEMP-STORAGE.
 21742
 21743
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 398
* EL6311.cbl
 21744* EXEC CICS DELETEQ TS
 21745*        QUEUE   (QID)
 21746*    END-EXEC.
 21747*    MOVE '*&                    #   #00018319' TO DFHEIV0
 21748     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21749     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21750     MOVE X'2020233030303138333139' TO DFHEIV0(25:11)
 21751     CALL 'kxdfhei1' USING DFHEIV0,
 21752           QID,
 21753           DFHEIV99
 21754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21755
 21756
 21757     GO TO 6050-EXIT.
 21758
 21759 6050-QID-ERROR.
 21760     MOVE ER-0033                TO EMI-ERROR
 21761     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21762
 21763 6050-EXIT.
 21764      EXIT.
 21765
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 399
* EL6311.cbl
 21767
 21768******************************************************************
 21769*                                                                *
 21770*            T E R M   C O N V E R S I O N                       *
 21771*                                                                *
 21772******************************************************************
 21773
 21774 6100-TERM-CONVERSION.
 21775
 21776     IF PI-BPMTS = ZERO
 21777         GO TO 6199-EXIT.
 21778
 21779     IF PI-BMODE = ' ' OR 'M'
 21780         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21781         GO TO 6105-ROUND-TERM.
 21782
 21783     IF PI-BMODE = 'S'
 21784         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21785         GO TO 6105-ROUND-TERM.
 21786
 21787     IF PI-BMODE = 'W'
 21788         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21789         GO TO 6105-ROUND-TERM.
 21790
 21791     IF PI-BMODE = 'B'
 21792         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21793         GO TO 6105-ROUND-TERM.
 21794
 21795     IF PI-BMODE = 'T'
 21796         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21797
 21798 6105-ROUND-TERM.
 21799
 21800     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21801         ADD +1                  TO WS-CALC-TERM-WHOLE
 21802         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21803
 21804     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21805         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21806
 21807     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21808         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21809                                      WS-BTERM    (WS-SUB1)
 21810         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21811
 21812     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21813         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21814             MOVE -1               TO BMODEL
 21815             MOVE ER-2593          TO EMI-ERROR
 21816             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21817             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21818
 21819 6124-CHECK-BENEFIT.
 21820
 21821     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21822        GO TO 6126-COMPUTE-BENEFIT.
 21823
 21824     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 400
* EL6311.cbl
 21825
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 401
* EL6311.cbl
 21827******************************************************************
 21828**         COMPUTE TERM AND BENEFIT
 21829******************************************************************
 21830 6125-COMPUTE-TERM-BENEFIT.
 21831
 21832     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21833        PI-BPMTAMT = ZERO
 21834         GO TO 6199-EXIT.
 21835
 21836     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21837                                     WS-BTERM  (WS-SUB1).
 21838     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21839
 21840 6126-COMPUTE-BENEFIT.
 21841
 21842     IF PI-BMODE = 'M' OR  ' '
 21843         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21844
 21845     IF PI-BMODE = 'W'
 21846         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21847
 21848     IF PI-BMODE = 'S'
 21849         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21850
 21851     IF PI-BMODE = 'B'
 21852         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21853
 21854     IF PI-BMODE = 'T'
 21855         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21856
 21857     IF WS-SUB1 = +1
 21858        COMPUTE WS-BBEN (WS-SUB1) =
 21859                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21860
 21861     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21862     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21863     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21864
 21865 6199-EXIT.
 21866     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 402
* EL6311.cbl
 21868
 21869******************************************************************
 21870*                                                                *
 21871*             D I S P L A Y   I S S U E S                        *
 21872*                                                                *
 21873******************************************************************
 21874
 21875 6200-CREATE-VADS.
 21876     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21877     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21878     MOVE SPACES                 TO WS-PASS-VADS-REC
 21879
 21880* EXEC CICS GETMAIN
 21881*       SET      (ADDRESS OF PENDING-BUSINESS)
 21882*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21883*       INITIMG  (GETMAIN-SPACE)
 21884*       RESP     (WS-RESPONSE)
 21885*    END-EXEC
 21886*    MOVE ',"IL                  $  N#00018445' TO DFHEIV0
 21887     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21888     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21889     MOVE X'204E233030303138343435' TO DFHEIV0(25:11)
 21890     CALL 'kxdfhei1' USING DFHEIV0,
 21891           DFHEIV20,
 21892           ERPNDB-RECORD-LENGTH,
 21893           GETMAIN-SPACE
 21894     SET ADDRESS OF PENDING-BUSINESS TO
 21895         DFHEIV20
 21896     MOVE EIBRESP  TO WS-RESPONSE
 21897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21898
 21899* EXEC CICS READ
 21900*       INTO    (PENDING-BUSINESS)
 21901*       DATASET (FILE-ID-ERPNDB)
 21902*       RIDFLD  (ERPNDB-KEY)
 21903*       RESP    (WS-RESPONSE)
 21904*    END-EXEC
 21905     MOVE LENGTH OF
 21906      PENDING-BUSINESS
 21907       TO DFHEIV11
 21908*    MOVE '&"IL       E          (  N#00018451' TO DFHEIV0
 21909     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21910     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21911     MOVE X'204E233030303138343531' TO DFHEIV0(25:11)
 21912     CALL 'kxdfhei1' USING DFHEIV0,
 21913           FILE-ID-ERPNDB,
 21914           PENDING-BUSINESS,
 21915           DFHEIV11,
 21916           ERPNDB-KEY,
 21917           DFHEIV99,
 21918           DFHEIV99,
 21919           DFHEIV99
 21920     MOVE EIBRESP  TO WS-RESPONSE
 21921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21922     IF RESP-NORMAL
 21923        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21924        IF (RESP-NORMAL)
 21925           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 403
* EL6311.cbl
 21926              AM-CONTROL-PRIMARY (1:20))
 21927           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21928        ELSE
 21929           MOVE 'ACCOUNT NOT FOUND'
 21930                                 TO VD-ACCOUNT-NAME
 21931        END-IF
 21932        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21933                                    TO M1
 21934        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21935        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21936           (A2 > M1)
 21937           OR (WS-WORK-FIELD (A2:1) = '*')
 21938           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21939           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21940        END-PERFORM
 21941        IF A2 > M1
 21942           CONTINUE
 21943        ELSE
 21944           MOVE WS-WORK-FIELD (1:A2 - 1)
 21945                                    TO VD-ACCOUNT-NAME
 21946        END-IF
 21947        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21948        MOVE PB-CARRIER          TO VD-CARRIER
 21949        MOVE PB-GROUPING         TO VD-GROUPING
 21950        MOVE PB-STATE            TO VD-STATE
 21951        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21952        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21953        MOVE PB-CERT-NO          TO VD-CERT-NO
 21954        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21955        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21956        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21957        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21958        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21959        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21960        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21961        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21962        MOVE PB-CSR-ID           TO VD-CSR-ID
 21963        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21964        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21965        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21966        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21967        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21968        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21969        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21970        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21971        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21972        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21973        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21974        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21975        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21976     END-IF
 21977     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21978
 21979
 21980* EXEC CICS GETMAIN
 21981*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21982*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21983*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 404
* EL6311.cbl
 21984*       RESP     (WS-RESPONSE)
 21985*    END-EXEC
 21986*    MOVE ',"IL                  $  N#00018514' TO DFHEIV0
 21987     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21988     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21989     MOVE X'204E233030303138353134' TO DFHEIV0(25:11)
 21990     CALL 'kxdfhei1' USING DFHEIV0,
 21991           DFHEIV20,
 21992           ERPNDM-RECORD-LENGTH,
 21993           GETMAIN-SPACE
 21994     SET ADDRESS OF PENDING-MAILING-DATA TO
 21995         DFHEIV20
 21996     MOVE EIBRESP  TO WS-RESPONSE
 21997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21998
 21999
 22000* EXEC CICS READ
 22001*       INTO    (PENDING-MAILING-DATA)
 22002*       DATASET (FILE-ID-ERPNDM)
 22003*       RIDFLD  (ERPNDM-KEY)
 22004*       RESP    (WS-RESPONSE)
 22005*    END-EXEC
 22006     MOVE LENGTH OF
 22007      PENDING-MAILING-DATA
 22008       TO DFHEIV11
 22009*    MOVE '&"IL       E          (  N#00018521' TO DFHEIV0
 22010     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22011     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22012     MOVE X'204E233030303138353231' TO DFHEIV0(25:11)
 22013     CALL 'kxdfhei1' USING DFHEIV0,
 22014           FILE-ID-ERPNDM,
 22015           PENDING-MAILING-DATA,
 22016           DFHEIV11,
 22017           ERPNDM-KEY,
 22018           DFHEIV99,
 22019           DFHEIV99,
 22020           DFHEIV99
 22021     MOVE EIBRESP  TO WS-RESPONSE
 22022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22023
 22024     IF RESP-NORMAL
 22025        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22026        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22027        MOVE PM-CITY              TO VD-INSURED-CITY
 22028        MOVE PM-STATE             TO VD-INSURED-STATE
 22029        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22030     END-IF
 22031
 22032     MOVE 'VAC1'                  TO VD-LETTER-ID
 22033     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22034     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22035     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22036     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22037     MOVE +0                      TO VD-ARCHIVE-NO
 22038     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22039     .
 22040 6200-EXIT.
 22041     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 405
* EL6311.cbl
 22042 6210-READ-ERACCT.
 22043     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22044     MOVE LOW-VALUES             TO ERACCT-FILL
 22045
 22046* EXEC CICS READ
 22047*         DATASET   ('ERACCT')
 22048*         INTO      (ACCOUNT-MASTER)
 22049*         RIDFLD    (ERACCT-KEY)
 22050*         GTEQ
 22051*         RESP      (WS-RESPONSE)
 22052*    END-EXEC
 22053     MOVE LENGTH OF
 22054      ACCOUNT-MASTER
 22055       TO DFHEIV11
 22056     MOVE 'ERACCT' TO DFHEIV1
 22057*    MOVE '&"IL       G          (  N#00018549' TO DFHEIV0
 22058     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22059     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22060     MOVE X'204E233030303138353439' TO DFHEIV0(25:11)
 22061     CALL 'kxdfhei1' USING DFHEIV0,
 22062           DFHEIV1,
 22063           ACCOUNT-MASTER,
 22064           DFHEIV11,
 22065           ERACCT-KEY,
 22066           DFHEIV99,
 22067           DFHEIV99,
 22068           DFHEIV99
 22069     MOVE EIBRESP  TO WS-RESPONSE
 22070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22071     .
 22072 6210-EXIT.
 22073     EXIT.
 22074
 22075 6220-READ-ERMAIL.
 22076
 22077     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22078     MOVE ' '                    TO WS-ERMAIL-SW
 22079
 22080
 22081* EXEC CICS READ
 22082*       DATASET   (FILE-ID-ERMAIL)
 22083*       SET       (ADDRESS OF MAILING-DATA)
 22084*       RIDFLD    (ERMAIL-KEY)
 22085*       RESP      (WS-RESPONSE)
 22086*    END-EXEC
 22087*    MOVE '&"S        E          (  N#00018565' TO DFHEIV0
 22088     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22089     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22090     MOVE X'204E233030303138353635' TO DFHEIV0(25:11)
 22091     CALL 'kxdfhei1' USING DFHEIV0,
 22092           FILE-ID-ERMAIL,
 22093           DFHEIV20,
 22094           DFHEIV99,
 22095           ERMAIL-KEY,
 22096           DFHEIV99,
 22097           DFHEIV99,
 22098           DFHEIV99
 22099     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 406
* EL6311.cbl
 22100         DFHEIV20
 22101     MOVE EIBRESP  TO WS-RESPONSE
 22102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22103
 22104     IF RESP-NORMAL
 22105        SET ERMAIL-FOUND TO TRUE
 22106     END-IF
 22107     .
 22108 6220-EXIT.
 22109     EXIT.
 22110
 22111 6400-CHECK-FOR-RES-REF-CLAIM.
 22112     display 'made it to 6400- for ' pi-cert-no
 22113     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22114
 22115     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22116                                    W-CL-COMP-CD.
 22117     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22118                                    W-CL-CERT-NO.
 22119     MOVE SPACES                 TO MSTR-CERT-SFX.
 22120
 22121
 22122* EXEC CICS HANDLE CONDITION
 22123*        NOTFND  (6400-CONTINUE)
 22124*        ENDFILE (6400-CONTINUE)
 22125*    END-EXEC.
 22126*    MOVE '"$I''                  ! S #00018589' TO DFHEIV0
 22127     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22128     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22129     MOVE X'5320233030303138353839' TO DFHEIV0(25:11)
 22130     CALL 'kxdfhei1' USING DFHEIV0
 22131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22132
 22133
 22134
 22135* EXEC CICS IGNORE CONDITION
 22136*        DUPKEY
 22137*    END-EXEC.
 22138*    MOVE '"*$                   !   #00018594' TO DFHEIV0
 22139     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22140     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22141     MOVE X'2020233030303138353934' TO DFHEIV0(25:11)
 22142     CALL 'kxdfhei1' USING DFHEIV0
 22143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22144
 22145
 22146
 22147* EXEC CICS STARTBR
 22148*        DATASET   (CLMS-ID)
 22149*        RIDFLD    (ELMSTR-KEY)
 22150*        GENERIC   EQUAL
 22151*        KEYLENGTH (ELMSTR-LENGTH)
 22152*    END-EXEC.
 22153     MOVE 0
 22154       TO DFHEIV11
 22155*    MOVE '&,   KG    E          &   #00018598' TO DFHEIV0
 22156     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22157     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 407
* EL6311.cbl
 22158     MOVE X'2020233030303138353938' TO DFHEIV0(25:11)
 22159     CALL 'kxdfhei1' USING DFHEIV0,
 22160           CLMS-ID,
 22161           ELMSTR-KEY,
 22162           ELMSTR-LENGTH,
 22163           DFHEIV11,
 22164           DFHEIV99
 22165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22166
 22167
 22168     display 'browse started'
 22169     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22170
 22171 6400-NEXT-CLAIM.
 22172
 22173
 22174* EXEC CICS READNEXT
 22175*        DATASET   (CLMS-ID)
 22176*        RIDFLD    (ELMSTR-KEY)
 22177*        SET       (ADDRESS OF CLAIM-MASTER)
 22178*    END-EXEC.
 22179     MOVE 0
 22180       TO DFHEIV11
 22181*    MOVE '&.S                   )   #00018610' TO DFHEIV0
 22182     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22183     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22184     MOVE X'2020233030303138363130' TO DFHEIV0(25:11)
 22185     CALL 'kxdfhei1' USING DFHEIV0,
 22186           CLMS-ID,
 22187           DFHEIV20,
 22188           DFHEIV99,
 22189           ELMSTR-KEY,
 22190           DFHEIV99,
 22191           DFHEIV11,
 22192           DFHEIV99,
 22193           DFHEIV99
 22194     SET ADDRESS OF CLAIM-MASTER TO
 22195         DFHEIV20
 22196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22197
 22198
 22199     display 'read claim for ' mstr-cert-no
 22200     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22201        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22202         GO TO 6400-CONTINUE
 22203     END-IF.
 22204
 22205     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22206        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22207        PI-STATE       NOT = CL-CERT-STATE     OR
 22208        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22209        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22210         GO TO 6400-NEXT-CLAIM
 22211     END-IF.
 22212
 22213     display 'found claim ' cl-claim-no
 22214        ' with denial type ' cl-denial-type
 22215     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 408
* EL6311.cbl
 22216         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22217         GO TO 6400-CONTINUE
 22218     END-IF.
 22219
 22220     GO TO 6400-NEXT-CLAIM.
 22221
 22222 6400-CONTINUE.
 22223
 22224     IF WS-BROWSE-STARTED-SW = 'Y'
 22225
 22226* EXEC CICS ENDBR
 22227*            DATASET   (CLMS-ID)
 22228*        END-EXEC
 22229     MOVE 0
 22230       TO DFHEIV11
 22231*    MOVE '&2                    $   #00018642' TO DFHEIV0
 22232     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22233     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22234     MOVE X'2020233030303138363432' TO DFHEIV0(25:11)
 22235     CALL 'kxdfhei1' USING DFHEIV0,
 22236           CLMS-ID,
 22237           DFHEIV11,
 22238           DFHEIV99
 22239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22240         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22241     END-IF.
 22242
 22243 6400-EXIT.
 22244     EXIT.
 22245
 22246 7000-DISPLAY-ISSUES.
 22247
 22248     IF PI-DISPLAY-ORIGINAL-BATCH
 22249        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22250        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22251     ELSE
 22252        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22253
 22254     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22255
 22256     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22257     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22258
 22259     MOVE LOW-VALUES                 TO EL631BI.
 22260     MOVE ZEROS                      TO PI-BPMTAMT
 22261                                        PI-BPMTS.
 22262     MOVE SPACE                      TO PI-BMODE
 22263                                        PI-BTYPE (1)
 22264                                        PI-BTYPE (2).
 22265     MOVE EL631B                     TO PI-MAP-NAME.
 22266     MOVE 'Y'                        TO PI-BROWSE-SW.
 22267     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22268                                        PI-HIGH-SEQ-NO.
 22269
 22270     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22271        MOVE AL-SABOF                TO BCHGTA
 22272        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22273        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 409
* EL6311.cbl
 22274     ELSE
 22275        MOVE AL-SADOF                TO BCHGTA
 22276                                        BCHGA
 22277        MOVE PB-CHG-COUNT            TO BCHGO.
 22278
 22279     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22280     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22281     MOVE WS-HR-MINS                 TO BMANTATO.
 22282
 22283     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22284        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22285        MOVE SPACE                   TO DC-OPTION-CODE
 22286        PERFORM 9700-DATE-LINK
 22287        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22288        MOVE 'INACTIVE'              TO BMOENDTO
 22289     ELSE
 22290        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22291        MOVE SPACE                   TO DC-OPTION-CODE
 22292        PERFORM 9700-DATE-LINK
 22293        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22294        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22295        MOVE SPACE                   TO DC-OPTION-CODE
 22296        PERFORM 9700-DATE-LINK
 22297        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22298
 22299*    MOVE PB-I-REFERENCE             TO BREFO.
 22300
 22301*    IF PI-COMPANY-ID EQUAL 'HER'
 22302*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22303*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22304*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22305*                MOVE WS-MEMBER-NO-1-8
 22306*                                TO  BMICRNOO.
 22307
 22308*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22309*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22310*            MOVE PB-I-MICROFILM-NO
 22311*                                TO  BMICRNOO.
 22312     IF PB-I-VIN NOT = SPACES
 22313        MOVE PB-I-VIN            TO BVINO
 22314     END-IF
 22315     MOVE PB-I-LETTER-REQD           TO LETRREQO
 22316
 22317
 22318     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22319     MOVE PB-CERT-SFX                TO BSUFIXO.
 22320     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22321     MOVE SPACE                      TO DC-OPTION-CODE.
 22322     PERFORM 9700-DATE-LINK.
 22323     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22324
 22325     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22326     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22327     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22328     MOVE PB-I-INSURED-SEX           TO BSEXO
 22329
 22330     IF PB-I-AGE NOT = ZEROS
 22331         MOVE PB-I-AGE               TO BAGEO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 410
* EL6311.cbl
 22332
 22333     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22334                                 TO ELCERT-KEY
 22335     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22336     IF NOT CERT-TRL-REC-NOT-FOUND
 22337         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22338             MOVE 'AGE*'             TO BAGEDEFO
 22339         ELSE
 22340             MOVE 'AGE '             TO BAGEDEFO
 22341         END-IF
 22342     ELSE
 22343         MOVE 'AGE '             TO BAGEDEFO
 22344     END-IF
 22345
 22346     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22347         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22348         MOVE SPACE                  TO DC-OPTION-CODE
 22349         PERFORM 9700-DATE-LINK
 22350         IF NO-CONVERSION-ERROR
 22351            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22352
 22353     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22354         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22355         MOVE SPACE                  TO DC-OPTION-CODE
 22356         PERFORM 9700-DATE-LINK
 22357         IF NO-CONVERSION-ERROR
 22358            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22359
 22360     IF PB-I-EXTENTION-DAYS NUMERIC
 22361        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22362           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22363        ELSE
 22364           IF PB-I-TERM-IN-DAYS NUMERIC
 22365              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22366                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22367
 22368     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22369        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22370
 22371     MOVE PB-FORCE-CODE              TO BFORCEO.
 22372     MOVE PB-I-TERM-TYPE             TO BMODEO
 22373                                        PI-BMODE.
 22374
 22375     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22376        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22377
 22378     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22379         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22380                                        PI-BPMTS.
 22381
 22382     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22383         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22384           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22385                                        PI-BPMTAMT.
 22386
 22387     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22388     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22389     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 411
* EL6311.cbl
 22390     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22391     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
 22392     MOVE PB-I-SIG-SW                TO BSIGO.
 22393     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22394     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22395     MOVE PB-RECORD-BILL             TO BBILCDO.
 22396     MOVE PB-FORCE-CODE              TO BFORCEO.
 22397
 22398     IF (PB-I-LIVES NUMERIC)
 22399        AND (PB-I-LIVES > ZEROS)
 22400        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22401        IF (RESP-NORMAL)
 22402           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22403           CONTINUE
 22404        ELSE
 22405           MOVE PB-I-LIVES       TO BLIVESO
 22406        END-IF
 22407     END-IF
 22408
 22409     IF PB-I-NUM-BILLED NUMERIC AND
 22410        PB-I-NUM-BILLED GREATER THAN ZEROS
 22411        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22412*    ELSE
 22413*       MOVE ZEROS                   TO BBILLEDO.
 22414
 22415     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22416
 22417     IF PB-I-LOAN-APR NOT = +99.9999
 22418        MOVE PB-I-LOAN-APR           TO BAPRO.
 22419
 22420     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22421        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22422
 22423     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22424        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22425           MOVE AL-SANOF                TO BORIGHDA
 22426           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22427           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22428
 22429     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22430
 22431     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22432        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22433
 22434     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22435        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22436                                        PI-BTYPE (1).
 22437
 22438     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22439        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22440
 22441     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22442        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22443
 22444     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22445        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22446
 22447     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 412
* EL6311.cbl
 22448        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22449
 22450     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22451        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22452
 22453     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22454         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22455         MOVE SPACE                  TO DC-OPTION-CODE
 22456         PERFORM 9700-DATE-LINK
 22457         IF NO-CONVERSION-ERROR
 22458            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22459
 22460     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22461        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22462        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22463        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22464        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22465                 GIVING BDIFFO (1)
 22466     ELSE
 22467        MOVE SPACES                  TO BBEN-CD     (1)
 22468                                        BBEN-ABBR   (1).
 22469
 22470     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22471        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22472        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22473                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22474
 22475     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22476       IF PB-RECORD-ON-HOLD
 22477          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22478
 22479     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22480       IF PB-RECORD-RETURNED
 22481          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22482
 22483     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22484        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22485             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22486
 22487     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22488
 22489     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22490        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22491
 22492     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22493        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22494                                        PI-BTYPE (2).
 22495
 22496     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22497        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22498
 22499     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22500        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22501
 22502     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22503        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22504
 22505     IF PB-I-TOT-FEES NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 413
* EL6311.cbl
 22506        MOVE ZEROS               TO PB-I-TOT-FEES
 22507     END-IF
 22508     IF PB-I-TOT-FEES > ZEROS
 22509        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22510
 22511     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22512         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22513         MOVE SPACE                  TO DC-OPTION-CODE
 22514         PERFORM 9700-DATE-LINK
 22515         IF NO-CONVERSION-ERROR
 22516            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22517
 22518     IF PB-I-TOT-FEES > ZEROS
 22519        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22520        SUBTRACT PB-I-TOT-FEES FROM
 22521                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22522
 22523     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22524        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22525        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22526        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22527        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22528                 GIVING BDIFFO (2)
 22529     ELSE
 22530        MOVE SPACES                  TO BBEN-CD     (2)
 22531                                        BBEN-ABBR   (2).
 22532
 22533     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22534       IF PB-RECORD-ON-HOLD
 22535          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22536
 22537     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22538       IF PB-RECORD-RETURNED
 22539          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22540
 22541     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22542        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22543             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22544
 22545     MOVE PB-CSR-ID                  TO BCSRO.
 22546
 22547     IF PI-COMPANY-ID  =  'DMD'
 22548        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22549            NEXT SENTENCE
 22550        ELSE
 22551            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22552               MOVE 'NEW CERT'       TO BNCERTLI
 22553               MOVE EC-NEW-CERT      TO BNCERTO.
 22554
 22555     IF PI-COMPANY-ID  =  'DMD'
 22556        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22557            NEXT SENTENCE
 22558        ELSE
 22559           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22560               MOVE 'NEW STATE'      TO BNSTATLI
 22561               MOVE EC-NEW-STATE     TO BNSTATO.
 22562
 22563 7000-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 414
* EL6311.cbl
 22564     MOVE 'C'                        TO BMAINTI.
 22565     MOVE AL-UANON                   TO BMAINTA.
 22566
 22567     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22568        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22569
 22570     IF ARCHIVE-LETTER-RELEASED
 22571        PERFORM 7050-UPDATE-PENDING THRU 7050-EXIT
 22572     END-IF
 22573     IF PI-6315-FINALIZED = 'Y'   AND
 22574        PB-UNFORCED-ERRORS
 22575          MOVE -1                TO BFORCEL
 22576          MOVE  1                TO SET-CURSOR-SW
 22577     END-IF
 22578
 22579     IF NO-CURSOR-SET
 22580        MOVE -1                      TO BMAINTL.
 22581
 22582     GO TO 8100-SEND-INITIAL-MAP.
 22583
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 415
* EL6311.cbl
 22585
 22586 7050-UPDATE-PENDING.
 22587
 22588* EXEC CICS READ
 22589*        DATASET (FILE-ID-ERPNDB)
 22590*        INTO    (PENDING-BUSINESS)
 22591*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 22592*        UPDATE
 22593*    END-EXEC.
 22594     MOVE LENGTH OF
 22595      PENDING-BUSINESS
 22596       TO DFHEIV11
 22597*    MOVE '&"IL       EU         (   #00018992' TO DFHEIV0
 22598     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22599     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22600     MOVE X'2020233030303138393932' TO DFHEIV0(25:11)
 22601     CALL 'kxdfhei1' USING DFHEIV0,
 22602           FILE-ID-ERPNDB,
 22603           PENDING-BUSINESS,
 22604           DFHEIV11,
 22605           PI-PREV-CONTROL-PRIMARY,
 22606           DFHEIV99,
 22607           DFHEIV99,
 22608           DFHEIV99
 22609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22610
 22611
 22612     MOVE 'C' TO PB-I-LETTER-REQD
 22613     MOVE PB-I-LETTER-REQD       TO LETRREQO
 22614     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 22615     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 22616     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 22617     MOVE '5'                    TO DC-OPTION-CODE.
 22618     PERFORM 9700-DATE-LINK
 22619     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 22620
 22621
 22622* EXEC CICS REWRITE
 22623*        DATASET (FILE-ID-ERPNDB)
 22624*        FROM    (PENDING-BUSINESS)
 22625*    END-EXEC.
 22626     MOVE LENGTH OF
 22627      PENDING-BUSINESS
 22628       TO DFHEIV11
 22629*    MOVE '&& L                  %   #00019008' TO DFHEIV0
 22630     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22631     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22632     MOVE X'2020233030303139303038' TO DFHEIV0(25:11)
 22633     CALL 'kxdfhei1' USING DFHEIV0,
 22634           FILE-ID-ERPNDB,
 22635           PENDING-BUSINESS,
 22636           DFHEIV11,
 22637           DFHEIV99
 22638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22639
 22640
 22641 7050-EXIT.
 22642      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 416
* EL6311.cbl
 22643
 22644******************************************************************
 22645*                                                                *
 22646*             D I S P L A Y   C A N C E L S                      *
 22647*                                                                *
 22648******************************************************************
 22649
 22650 7100-DISPLAY-CANCELS.
 22651     IF PI-DISPLAY-ORIGINAL-BATCH
 22652        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22653        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22654     ELSE
 22655        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22656
 22657     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22658
 22659     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22660     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22661
 22662     MOVE LOW-VALUES                 TO EL631CI.
 22663     MOVE EL631C                     TO PI-MAP-NAME.
 22664     MOVE 'Y'                        TO PI-BROWSE-SW.
 22665     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22666                                        PI-HIGH-SEQ-NO.
 22667
 22668     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22669        MOVE AL-SABOF                TO CCHGTA
 22670        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22671        MOVE AL-SANON                TO CCHGA
 22672      ELSE
 22673        MOVE AL-SADOF                TO CCHGTA
 22674                                        CCHGA
 22675        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22676
 22677*    MOVE PB-C-REFERENCE             TO CREFO.
 22678
 22679*    IF PB-C-MICROFILM-NO IS NUMERIC
 22680*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22681*          MOVE PB-C-MICROFILM-NO
 22682*                                TO CMICRNOO
 22683*          MOVE AL-UNNON         TO CMICRNOA
 22684*       END-IF
 22685*    END-IF
 22686     IF PB-C-INT-ON-REFS NUMERIC
 22687        IF PB-C-INT-ON-REFS NOT = ZEROS
 22688           MOVE PB-C-INT-ON-REFS
 22689                                 TO CNHINTO
 22690           MOVE AL-SANOF         TO CNHINTA
 22691        END-IF
 22692     END-IF
 22693     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22694     MOVE PB-CERT-SFX                TO CSUFIXO.
 22695     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22696     MOVE SPACE                      TO DC-OPTION-CODE.
 22697     PERFORM 9700-DATE-LINK.
 22698     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22699
 22700     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 417
* EL6311.cbl
 22701        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22702        MOVE SPACE                   TO DC-OPTION-CODE
 22703        PERFORM 9700-DATE-LINK
 22704        IF NO-CONVERSION-ERROR
 22705           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22706
 22707     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22708        NEXT SENTENCE
 22709     ELSE
 22710        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22711
 22712     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22713        NEXT SENTENCE
 22714     ELSE
 22715        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22716
 22717     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22718        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22719        MOVE SPACE                   TO DC-OPTION-CODE
 22720        PERFORM 9700-DATE-LINK
 22721        IF NO-CONVERSION-ERROR
 22722           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22723
 22724     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22725         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22726
 22727     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22728         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22729
 22730     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22731        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22732        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22733                 GIVING CDRFND1O.
 22734
 22735     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22736        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22737        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22738                 GIVING CDRFND2O.
 22739
 22740     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22741       IF PB-RECORD-ON-HOLD
 22742          MOVE 'ON HOLD'             TO CBILIT1O.
 22743
 22744     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22745       IF PB-RECORD-RETURNED
 22746          MOVE 'RETURNED'            TO CBILIT1O.
 22747
 22748     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22749        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22750             MOVE 'OVERRIDE'         TO CBILIT1O.
 22751
 22752     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22753       IF PB-RECORD-ON-HOLD
 22754          MOVE 'ON HOLD'             TO CBILIT2O.
 22755
 22756     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22757       IF PB-RECORD-RETURNED
 22758          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 418
* EL6311.cbl
 22759
 22760     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22761        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22762             MOVE 'OVERRIDE'         TO CBILIT2O.
 22763
 22764     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22765     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22766     MOVE PB-FORCE-CODE              TO CFORCEO.
 22767     MOVE PB-RECORD-BILL             TO CBILCDO.
 22768     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22769     MOVE SPACES                     TO CINITSO.
 22770     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22771         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22772     ELSE
 22773         MOVE PB-CI-INITIALS         TO CINITSO
 22774     END-IF.
 22775
 22776     IF PB-CI-CANCEL-FEE NUMERIC
 22777        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22778        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22779     ELSE
 22780        MOVE ZEROES                  TO W-CANCEL-FEE.
 22781
 22782     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22783
 22784     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22785        ADD PB-CI-LF-PREMIUM-AMT
 22786             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22787
 22788     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22789        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22790
 22791     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22792     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22793     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22794     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22795
 22796     IF PB-C-LIVES NUMERIC
 22797        MOVE PB-C-LIVES              TO CLIVESO.
 22798
 22799     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22800        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22801
 22802     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22803        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22804        MOVE SPACE                   TO DC-OPTION-CODE
 22805        PERFORM 9700-DATE-LINK
 22806        IF NO-CONVERSION-ERROR
 22807           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22808
 22809     IF  PB-C-REFUND-CREATED
 22810         MOVE 'YES'                  TO CRFNDSWO
 22811     ELSE
 22812         IF PB-C-REFUND-REQUESTED
 22813            MOVE 'REQ'               TO CRFNDSWO
 22814         ELSE
 22815            MOVE 'NO'                TO CRFNDSWO.
 22816
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 419
* EL6311.cbl
 22817     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22818     MOVE SPACE                      TO DC-OPTION-CODE.
 22819     PERFORM 9700-DATE-LINK.
 22820     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22821     MOVE PB-INPUT-BY                TO CENTBYO.
 22822
 22823     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22824        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22825        MOVE SPACE                   TO DC-OPTION-CODE
 22826        PERFORM 9700-DATE-LINK
 22827        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22828        MOVE 'INACTIVE'              TO CMOENDTO
 22829     ELSE
 22830        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22831        MOVE SPACE                   TO DC-OPTION-CODE
 22832        PERFORM 9700-DATE-LINK
 22833        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22834        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22835        MOVE SPACE                   TO DC-OPTION-CODE
 22836        PERFORM 9700-DATE-LINK
 22837        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22838
 22839     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22840
 22841     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22842     MOVE WS-HR-MINS                 TO CMANTATO.
 22843
 22844     EVALUATE PB-LF-REFUND-TYPE
 22845        WHEN '1'
 22846           MOVE 'RULE78'            TO CLFREFNO
 22847        WHEN '2'
 22848           MOVE 'PRORAT'            TO CLFREFNO
 22849        WHEN '3'
 22850           MOVE 'CALIF'             TO CLFREFNO
 22851        WHEN '4'
 22852           MOVE 'IRREG'             TO CLFREFNO
 22853        WHEN '5'
 22854           MOVE 'NETPAY'            TO CLFREFNO
 22855        WHEN '6'
 22856           MOVE 'ATCP'              TO CLFREFNO
 22857        WHEN '7'
 22858           MOVE 'UTAH'              TO CLFREFNO
 22859        WHEN '8'
 22860           MOVE 'MEAN'              TO CLFREFNO
 22861        WHEN '9'
 22862           MOVE 'SUM '              TO CLFREFNO
 22863        WHEN 'B'
 22864           MOVE 'BALN'              TO CLFREFNO
 22865     END-EVALUATE.
 22866
 22867     EVALUATE TRUE
 22868        WHEN PB-AH-REFUND-TYPE =  '1'
 22869           MOVE 'RULE78'            TO CAHREFNO
 22870        WHEN PB-AH-REFUND-TYPE =  '2'
 22871           MOVE 'PRORAT'            TO CAHREFNO
 22872        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22873           MOVE 'CALIF'             TO CAHREFNO
 22874        WHEN PB-AH-REFUND-TYPE =  '4'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 420
* EL6311.cbl
 22875           MOVE 'IRREG'             TO CAHREFNO
 22876        WHEN PB-AH-REFUND-TYPE =  '5'
 22877           MOVE 'NETPAY'            TO CAHREFNO
 22878        WHEN PB-AH-REFUND-TYPE =  '6'
 22879           MOVE 'ATCP'              TO CAHREFNO
 22880        WHEN PB-AH-REFUND-TYPE =  '7'
 22881           MOVE 'UTAH'              TO CAHREFNO
 22882        WHEN PB-AH-REFUND-TYPE =  '8'
 22883           MOVE 'MEAN'              TO CAHREFNO
 22884        WHEN PB-AH-REFUND-TYPE =  '9'
 22885           MOVE 'SUM '              TO CAHREFNO
 22886        WHEN PB-AH-REFUND-TYPE =  'B'
 22887           MOVE 'BALN'              TO CAHREFNO
 22888     END-EVALUATE.
 22889
 22890     MOVE PB-REIN-CD                 TO CREINCDO.
 22891
 22892     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22893        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22894        MOVE SPACE                   TO DC-OPTION-CODE
 22895        PERFORM 9700-DATE-LINK
 22896        IF NO-CONVERSION-ERROR
 22897           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22898
 22899     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22900        MOVE 999999                  TO WS-EXP-DT-EDIT
 22901        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22902        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22903     ELSE
 22904        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22905           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22906           MOVE SPACE                   TO DC-OPTION-CODE
 22907           PERFORM 9700-DATE-LINK
 22908           IF NO-CONVERSION-ERROR
 22909              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22910
 22911     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22912        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22913           MOVE AL-SANOF                TO CORIGHDA
 22914           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22915           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22916
 22917     MOVE PB-CSR-ID              TO CCSRO.
 22918
 22919     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22920     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22921     MOVE 'N'                    TO ACTSPCO
 22922     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACNT-KEY
 22923     MOVE '2'                    TO ERACNT-REC-TYPE
 22924     MOVE +3                     TO ERACNT-SEQ-NO
 22925
 22926
 22927* EXEC CICS READ
 22928*         DATASET   ('ERACNT')
 22929*         INTO      (NOTE-FILE)
 22930*         RIDFLD    (ERACNT-KEY)
 22931*         RESP      (WS-RESPONSE)
 22932*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 421
* EL6311.cbl
 22933     MOVE LENGTH OF
 22934      NOTE-FILE
 22935       TO DFHEIV11
 22936     MOVE 'ERACNT' TO DFHEIV1
 22937*    MOVE '&"IL       E          (  N#00019298' TO DFHEIV0
 22938     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22939     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22940     MOVE X'204E233030303139323938' TO DFHEIV0(25:11)
 22941     CALL 'kxdfhei1' USING DFHEIV0,
 22942           DFHEIV1,
 22943           NOTE-FILE,
 22944           DFHEIV11,
 22945           ERACNT-KEY,
 22946           DFHEIV99,
 22947           DFHEIV99,
 22948           DFHEIV99
 22949     MOVE EIBRESP  TO WS-RESPONSE
 22950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22951
 22952     IF RESP-NORMAL
 22953        IF NT-account-special = 'Y'
 22954           MOVE 'Y'              TO actspcO
 22955           MOVE ER-1762          TO EMI-ERROR
 22956           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22957        END-IF
 22958     END-IF
 22959     MOVE 'C'                    TO CMAINTI.
 22960     MOVE AL-UANON               TO CMAINTA.
 22961
 22962     IF PI-6316-FINALIZED = 'Y'  AND
 22963        PB-UNFORCED-ERRORS
 22964          MOVE -1                TO CFORCEL
 22965          MOVE  1                TO SET-CURSOR-SW
 22966     END-IF
 22967
 22968     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22969        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22970
 22971     IF NO-CURSOR-SET
 22972        MOVE -1                  TO CMAINTL.
 22973
 22974     GO TO 8100-SEND-INITIAL-MAP.
 22975
 22976
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 422
* EL6311.cbl
 22978***************************************************************
 22979*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22980*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22981***************************************************************
 22982
 22983 7200-DISPLAY-BATCHES.
 22984     MOVE EL631D                 TO PI-MAP-NAME.
 22985     MOVE LOW-VALUES             TO EL631DI.
 22986
 22987     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22988
 22989
 22990* EXEC CICS HANDLE CONDITION
 22991*         NOTFND   (3690-NOT-FOUND)
 22992*    END-EXEC.
 22993*    MOVE '"$I                   ! T #00019342' TO DFHEIV0
 22994     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22995     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22996     MOVE X'5420233030303139333432' TO DFHEIV0(25:11)
 22997     CALL 'kxdfhei1' USING DFHEIV0
 22998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22999
 23000
 23001     IF PI-DISPLAY-SCREEN
 23002        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 23003     ELSE
 23004        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 23005
 23006     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 23007     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 23008
 23009
 23010* EXEC CICS READ
 23011*         DATASET   (FILE-ID-ERPNDB)
 23012*         RIDFLD    (ERPNDB-KEY)
 23013*         SET       (ADDRESS OF PENDING-BUSINESS)
 23014*    END-EXEC.
 23015*    MOVE '&"S        E          (   #00019354' TO DFHEIV0
 23016     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23017     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23018     MOVE X'2020233030303139333534' TO DFHEIV0(25:11)
 23019     CALL 'kxdfhei1' USING DFHEIV0,
 23020           FILE-ID-ERPNDB,
 23021           DFHEIV20,
 23022           DFHEIV99,
 23023           ERPNDB-KEY,
 23024           DFHEIV99,
 23025           DFHEIV99,
 23026           DFHEIV99
 23027     SET ADDRESS OF PENDING-BUSINESS TO
 23028         DFHEIV20
 23029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23030
 23031
 23032     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 23033     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 23034     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 23035     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 423
* EL6311.cbl
 23036     MOVE PB-SV-STATE            TO PI-SV-STATE.
 23037
 23038     MOVE EL631D                 TO PI-MAP-NAME.
 23039     MOVE LOW-VALUES             TO EL631DI.
 23040     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 23041
 23042*    IF PI-AR-PROCESSING
 23043*       MOVE PB-REFERENCE        TO DREFO.
 23044
 23045     MOVE PB-CSR-ID              TO DCSRO.
 23046
 23047     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23048        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 23049        MOVE SPACE               TO DC-OPTION-CODE
 23050        PERFORM 9700-DATE-LINK
 23051        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 23052        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 23053        MOVE 'INACTIVE'          TO DLDATEO
 23054     ELSE
 23055        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 23056        MOVE SPACE               TO DC-OPTION-CODE
 23057        PERFORM 9700-DATE-LINK
 23058        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 23059
 23060     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 23061     MOVE SPACE                  TO DC-OPTION-CODE.
 23062     PERFORM 9700-DATE-LINK.
 23063     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 23064
 23065     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 23066        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 23067     ELSE
 23068        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 23069        MOVE SPACE               TO DC-OPTION-CODE
 23070        PERFORM 9700-DATE-LINK
 23071        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 23072
 23073     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 23074     MOVE SPACE                  TO DC-OPTION-CODE.
 23075     PERFORM 9700-DATE-LINK.
 23076     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 23077
 23078     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 23079     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 23080
 23081     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 23082        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 23083                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 23084
 23085     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 23086     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 23087     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 23088
 23089     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 23090        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 23091                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 23092
 23093     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 424
* EL6311.cbl
 23094     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 23095     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 23096
 23097     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 23098        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 23099                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 23100
 23101     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 23102     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 23103
 23104     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 23105        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 23106                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 23107
 23108     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23109     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23110     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23111
 23112     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23113        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23114                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23115
 23116     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23117     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23118     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23119
 23120     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23121        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23122                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23123
 23124     MOVE -1                     TO DPFENTRL.
 23125     GO TO 8100-SEND-INITIAL-MAP.
 23126
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 425
* EL6311.cbl
 23128
 23129***************************************************************
 23130*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23131*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23132*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23133*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23134*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23135*     ARE THEN SET ACCORDINGLY.                               *
 23136*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23137*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23138*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23139***************************************************************
 23140
 23141******************************************************************
 23142*                                                                *
 23143*            E R R O R   A N A L Y S I S                         *
 23144*                                                                *
 23145******************************************************************
 23146
 23147******************************************************************
 23148*                                                                *
 23149*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23150*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23151*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23152*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23153*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23154*                                                                *
 23155*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23156*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23157*                                                                *
 23158******************************************************************
 23159
 23160 7300-FORMAT-ERRORS.
 23161     MOVE ' '                    TO PI-ERRORS-SW
 23162     IF PB-COMMON-ERRORS = LOW-VALUES
 23163        IF PB-FATAL-ERRORS
 23164           MOVE ER-2695          TO EMI-ERROR
 23165           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23166           GO TO 7399-EXIT.
 23167
 23168     MOVE +0                     TO WS-SUB4
 23169     move +0                     to pi-6311-fatal-ctr
 23170     .
 23171 7310-ERROR-LOOP.
 23172
 23173     ADD +1                      TO WS-SUB4.
 23174
 23175     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23176        GO TO 7350-SET-ERROR-FLAGS.
 23177
 23178     IF PI-COMPANY-ID = 'UCL'
 23179         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23180             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23181             MOVE ' '                   TO DC-OPTION-CODE
 23182             PERFORM 9700-DATE-LINK
 23183             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23184
 23185     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 426
* EL6311.cbl
 23186     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23187     if (emi-fatal)
 23188        and (emi-error not = 1753 and 1754 and 1757 and
 23189                             1758 and 1759 and 1760)
 23190        add +1                   to pi-6311-fatal-ctr
 23191     end-if
 23192     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23193
 23194     GO TO 7310-ERROR-LOOP.
 23195
 23196
 23197 7350-SET-ERROR-FLAGS.
 23198
 23199     IF EMI-FATAL-CTR NOT = ZEROS
 23200        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23201        MOVE 'X'                 TO PB-FATAL-FLAG
 23202                                    PI-ERRORS-SW
 23203        GO TO 7355-SET-ERROR-FLAGS.
 23204
 23205     move ' ' to pi-unforced-sw
 23206     IF EMI-FORCABLE-CTR NOT = ZEROS
 23207        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23208        IF PB-ISSUE
 23209           IF PB-ISSUE-FORCE
 23210              MOVE 'F'           TO PB-FORCE-ER-CD
 23211              MOVE ER-2600       TO EMI-ERROR
 23212              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23213             ELSE
 23214              MOVE 'X'           TO PB-FORCE-ER-CD
 23215*                                   PI-ERRORS-SW
 23216          ELSE
 23217           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23218              MOVE 'F'           TO PB-FORCE-ER-CD
 23219                                    pi-unforced-sw
 23220              MOVE ER-2600       TO EMI-ERROR
 23221              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23222             ELSE
 23223              MOVE 'X'           TO PB-FORCE-ER-CD
 23224                                    pi-unforced-sw.
 23225*                                   PI-ERRORS-SW.
 23226
 23227     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23228     IF PB-ISSUE
 23229         MOVE 'I'                TO ENDT-RECORD-TYPE
 23230     ELSE
 23231         MOVE 'C'                TO ENDT-RECORD-TYPE
 23232     END-IF
 23233     MOVE +0                     TO ENDT-SEQ-NO
 23234
 23235
 23236* EXEC CICS READ
 23237*        DATASET   (FILE-ID-ERENDT)
 23238*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23239*        RIDFLD    (ERENDT-KEY)
 23240*        RESP      (WS-RESPONSE)
 23241*        GTEQ
 23242*    END-EXEC
 23243*    MOVE '&"S        G          (  N#00019563' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 427
* EL6311.cbl
 23244     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23245     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23246     MOVE X'204E233030303139353633' TO DFHEIV0(25:11)
 23247     CALL 'kxdfhei1' USING DFHEIV0,
 23248           FILE-ID-ERENDT,
 23249           DFHEIV20,
 23250           DFHEIV99,
 23251           ERENDT-KEY,
 23252           DFHEIV99,
 23253           DFHEIV99,
 23254           DFHEIV99
 23255     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23256         DFHEIV20
 23257     MOVE EIBRESP  TO WS-RESPONSE
 23258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23259
 23260     IF RESP-NORMAL
 23261        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23262        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23263            MOVE ER-0280          TO EMI-ERROR
 23264            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23265            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23266            IF CALLED-FROM-6315
 23267               MOVE 'Y' TO WS-ARCHIVE-LETTER-SW
 23268            END-IF
 23269            EVALUATE TRUE
 23270              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23271                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23272              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23273                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23274              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23275                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23276            END-EVALUATE
 23277        END-IF
 23278     END-IF
 23279
 23280
 23281
 23282     IF FIRST-ENTRY OR
 23283        EIBAID = DFHPF1 OR DFHPF2
 23284        MOVE '0'                TO PI-EDIT-SW
 23285        GO TO 7399-EXIT.
 23286
 23287 7355-SET-ERROR-FLAGS.
 23288
 23289     IF EMI-WARNING-CTR NOT = ZEROS
 23290        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23291        MOVE 'W'                 TO PB-WARN-ER-CD.
 23292
 23293     IF PB-UNFORCED-ERRORS OR
 23294        PB-FATAL-ERRORS    OR
 23295        PB-RECORD-ON-HOLD  OR
 23296        PB-RECORD-RETURNED OR
 23297        PB-CANCELLATION
 23298          NEXT SENTENCE
 23299        ELSE
 23300          GO TO 7399-EXIT.
 23301
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 428
* EL6311.cbl
 23302
 23303* EXEC CICS  HANDLE CONDITION
 23304*           NOTFND   (7399-EXIT)
 23305*    END-EXEC.
 23306*    MOVE '"$I                   ! U #00019613' TO DFHEIV0
 23307     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23308     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23309     MOVE X'5520233030303139363133' TO DFHEIV0(25:11)
 23310     CALL 'kxdfhei1' USING DFHEIV0
 23311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23312
 23313
 23314     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23315     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23316     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23317     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23318
 23319
 23320* EXEC CICS READ
 23321*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23322*        DATASET (FILE-ID-ELCERT)
 23323*        RIDFLD  (ELCERT-KEY)
 23324*        UPDATE
 23325*    END-EXEC.
 23326*    MOVE '&"S        EU         (   #00019622' TO DFHEIV0
 23327     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23328     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23329     MOVE X'2020233030303139363232' TO DFHEIV0(25:11)
 23330     CALL 'kxdfhei1' USING DFHEIV0,
 23331           FILE-ID-ELCERT,
 23332           DFHEIV20,
 23333           DFHEIV99,
 23334           ELCERT-KEY,
 23335           DFHEIV99,
 23336           DFHEIV99,
 23337           DFHEIV99
 23338     SET ADDRESS OF CERTIFICATE-MASTER TO
 23339         DFHEIV20
 23340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23341
 23342
 23343
 23344     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23345     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23346
 23347     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23348        GO TO 7360-REWRITE-CERT-MASTER.
 23349
 23350     IF PB-ISSUE
 23351        IF PB-RECORD-RETURNED
 23352            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23353            GO TO 7360-REWRITE-CERT-MASTER
 23354        ELSE
 23355            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23356            GO TO 7360-REWRITE-CERT-MASTER.
 23357
 23358     IF PB-RECORD-RETURNED
 23359         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 429
* EL6311.cbl
 23360         GO TO 7360-REWRITE-CERT-MASTER.
 23361
 23362     IF (PB-C-LF-CANCEL-VOIDED)
 23363        or (pb-c-ah-cancel-voided)
 23364        IF (PB-UNFORCED-ERRORS OR
 23365            PB-FATAL-ERRORS    OR
 23366            PB-RECORD-ON-HOLD)
 23367            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23368            GO TO 7360-REWRITE-CERT-MASTER
 23369        ELSE
 23370            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23371            GO TO 7360-REWRITE-CERT-MASTER.
 23372
 23373     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23374                            OR PB-RECORD-ON-HOLD)
 23375        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23376     ELSE
 23377        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23378
 23379 7360-REWRITE-CERT-MASTER.
 23380
 23381     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23382        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23383
 23384* EXEC CICS UNLOCK
 23385*            DATASET    (FILE-ID-ELCERT)
 23386*       END-EXEC
 23387*    MOVE '&*                    #   #00019669' TO DFHEIV0
 23388     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23389     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23390     MOVE X'2020233030303139363639' TO DFHEIV0(25:11)
 23391     CALL 'kxdfhei1' USING DFHEIV0,
 23392           FILE-ID-ELCERT,
 23393           DFHEIV99
 23394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23395        GO TO 7399-EXIT.
 23396
 23397
 23398* EXEC CICS REWRITE
 23399*         DATASET    (FILE-ID-ELCERT)
 23400*         FROM       (CERTIFICATE-MASTER)
 23401*    END-EXEC.
 23402     MOVE LENGTH OF
 23403      CERTIFICATE-MASTER
 23404       TO DFHEIV11
 23405*    MOVE '&& L                  %   #00019674' TO DFHEIV0
 23406     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23407     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23408     MOVE X'2020233030303139363734' TO DFHEIV0(25:11)
 23409     CALL 'kxdfhei1' USING DFHEIV0,
 23410           FILE-ID-ELCERT,
 23411           CERTIFICATE-MASTER,
 23412           DFHEIV11,
 23413           DFHEIV99
 23414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23415
 23416
 23417 7399-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 430
* EL6311.cbl
 23418      EXIT.
 23419
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 431
* EL6311.cbl
 23421
 23422*************************************************************
 23423*                                                           *
 23424*              S E T   A T T R I B U T E S                  *
 23425*                                                           *
 23426*************************************************************
 23427
 23428 7400-SET-ATTRIBUTES.
 23429
 23430     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23431        GO TO 7499-EXIT.
 23432
 23433**2601**
 23434
 23435     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23436        IF PB-ISSUE
 23437           MOVE AL-UABON         TO BEFFDTA
 23438           GO TO 7499-EXIT
 23439         ELSE
 23440           MOVE AL-UABON         TO CEFFDTA
 23441           GO TO 7499-EXIT.
 23442
 23443**2604**
 23444
 23445     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23446        IF PB-ISSUE
 23447           MOVE AL-UABON         TO BTYPE1A
 23448           MOVE -1               TO BTYPE1L
 23449           MOVE  1               TO SET-CURSOR-SW
 23450           GO TO 7499-EXIT.
 23451
 23452**2605**
 23453
 23454     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23455        IF PB-ISSUE
 23456           MOVE AL-UABON         TO BTYPE2A
 23457           MOVE -1               TO BTYPE2L
 23458           MOVE  1               TO SET-CURSOR-SW
 23459           GO TO 7499-EXIT.
 23460
 23461**2606**
 23462
 23463     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23464        IF PB-ISSUE
 23465           MOVE AL-UABON         TO BSIGA
 23466           MOVE -1               TO BSIGL
 23467           MOVE  1               TO SET-CURSOR-SW
 23468           GO TO 7499-EXIT.
 23469
 23470**2607**
 23471
 23472     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23473        IF PB-ISSUE
 23474           MOVE AL-UABON         TO BSIGA
 23475           MOVE -1               TO BSIGL
 23476           MOVE  1               TO SET-CURSOR-SW
 23477           GO TO 7499-EXIT.
 23478
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 432
* EL6311.cbl
 23479**2615**
 23480
 23481     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23482        IF PB-ISSUE
 23483           MOVE AL-UABOF         TO BREINA
 23484           MOVE -1               TO BREINL
 23485           GO TO 7499-EXIT.
 23486
 23487**2622**
 23488
 23489     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23490        IF PB-ISSUE
 23491           MOVE AL-UABON         TO BEFFDTA
 23492           GO TO 7499-EXIT
 23493        ELSE
 23494           MOVE AL-UABON         TO CEFFDTA
 23495           GO TO 7499-EXIT.
 23496
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 433
* EL6311.cbl
 23498
 23499*************************************************************
 23500*                                                           *
 23501*              I S S U E   E R R O R S                      *
 23502*                                                           *
 23503*************************************************************
 23504
 23505 7420-ISSUE-ERRORS.
 23506
 23507     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1577
 23508        MOVE -1                  TO LETRREQL
 23509        MOVE AL-UABOF            TO LETRREQA
 23510        MOVE  1                  TO SET-CURSOR-SW
 23511        GO TO 7499-EXIT.
 23512
 23513     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1584
 23514        MOVE AL-UABOF            TO LETRREQA
 23515        GO TO 7499-EXIT.
 23516
 23517**2626**
 23518
 23519     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23520        MOVE AL-UABON            TO BCERTNOA
 23521        GO TO 7499-EXIT.
 23522
 23523**2627**
 23524
 23525     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23526        MOVE AL-UNBON            TO BAGEA
 23527        MOVE -1                  TO BAGEL
 23528        MOVE  1                  TO SET-CURSOR-SW
 23529        GO TO 7499-EXIT.
 23530
 23531**2628**
 23532
 23533     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23534        MOVE AL-UNBON            TO BAGEA
 23535        MOVE -1                  TO BAGEL
 23536        MOVE  1                  TO SET-CURSOR-SW
 23537        GO TO 7499-EXIT.
 23538
 23539**2629**
 23540
 23541     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23542        MOVE AL-UABON            TO BSEXA
 23543        MOVE -1                  TO BSEXL
 23544        MOVE  1                  TO SET-CURSOR-SW
 23545        GO TO 7499-EXIT.
 23546
 23547**2630**
 23548
 23549     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23550        MOVE -1                  TO BTYPE1L
 23551        MOVE  1                  TO SET-CURSOR-SW
 23552        GO TO 7499-EXIT.
 23553
 23554**2631**
 23555
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 434
* EL6311.cbl
 23556     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23557        MOVE -1                  TO BTYPE1L
 23558        MOVE  1                  TO SET-CURSOR-SW
 23559        GO TO 7499-EXIT.
 23560
 23561**2632**
 23562
 23563     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23564        MOVE AL-UNBON            TO BBEN1A
 23565        MOVE -1                  TO BBEN1L
 23566        MOVE  1                  TO SET-CURSOR-SW
 23567        GO TO 7499-EXIT.
 23568
 23569**2633**
 23570
 23571     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23572        MOVE AL-UNBON            TO BPREM1A
 23573        MOVE -1                  TO BPREM1L
 23574        MOVE  1                  TO SET-CURSOR-SW
 23575        GO TO 7499-EXIT.
 23576
 23577**2634**
 23578
 23579     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23580        MOVE -1                  TO BTYPE2L
 23581        MOVE  1                  TO SET-CURSOR-SW
 23582        GO TO 7499-EXIT.
 23583
 23584**2635**
 23585
 23586     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23587        MOVE AL-UNBON            TO BBEN2A
 23588        MOVE -1                  TO BBEN2L
 23589        MOVE  1                  TO SET-CURSOR-SW
 23590        GO TO 7499-EXIT.
 23591
 23592**2636**
 23593
 23594     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23595        MOVE AL-UNBON            TO BPREM2A
 23596        MOVE -1                  TO BPREM2L
 23597        MOVE  1                  TO SET-CURSOR-SW
 23598        GO TO 7499-EXIT.
 23599
 23600**2639**
 23601
 23602     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23603        MOVE AL-UNBON            TO BBEN1A
 23604        MOVE -1                  TO BBEN1L
 23605        MOVE  1                  TO SET-CURSOR-SW
 23606        GO TO 7499-EXIT.
 23607
 23608**2640**
 23609
 23610     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23611        MOVE AL-UNBON            TO BBEN2A
 23612        MOVE -1                  TO BBEN2L
 23613        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 435
* EL6311.cbl
 23614        GO TO 7499-EXIT.
 23615
 23616**2647**
 23617
 23618     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23619        MOVE AL-UNBON            TO BTERM1A
 23620        MOVE -1                  TO BTERM1L
 23621        MOVE  1                  TO SET-CURSOR-SW
 23622        GO TO 7499-EXIT.
 23623
 23624**2648**
 23625
 23626     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23627              or er-3070
 23628        MOVE AL-UNBON            TO BLNTRMA
 23629        MOVE -1                  TO BLNTRML
 23630        MOVE  1                  TO SET-CURSOR-SW
 23631        GO TO 7499-EXIT.
 23632
 23633**2649**
 23634
 23635     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23636        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23637            MOVE AL-UNBON            TO BPREM1A
 23638            MOVE -1                  TO BPREM1L
 23639            MOVE  1                  TO SET-CURSOR-SW
 23640            GO TO 7499-EXIT
 23641     ELSE
 23642        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23643           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23644            MOVE AL-UNBON            TO BPREM2A
 23645            MOVE -1                  TO BPREM2L
 23646            MOVE  1                  TO SET-CURSOR-SW
 23647            GO TO 7499-EXIT.
 23648
 23649**2650**
 23650
 23651     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23652        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23653            MOVE AL-UNBON        TO BPREM1A
 23654            MOVE -1              TO BPREM1L
 23655            MOVE  1              TO SET-CURSOR-SW
 23656            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23657                MOVE AL-UNBON        TO BPREM2A
 23658                MOVE -1              TO BPREM2L
 23659                MOVE  1              TO SET-CURSOR-SW
 23660                GO TO 7499-EXIT
 23661            ELSE
 23662                GO TO 7499-EXIT
 23663        ELSE
 23664            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23665                MOVE AL-UNBON        TO BPREM2A
 23666                MOVE -1              TO BPREM2L
 23667                MOVE  1              TO SET-CURSOR-SW
 23668                GO TO 7499-EXIT
 23669            ELSE
 23670                GO TO 7499-EXIT.
 23671
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 436
* EL6311.cbl
 23672**2651**
 23673
 23674     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2651
 23675        MOVE AL-UABON            TO BSIGA
 23676        MOVE -1                  TO BSIGL
 23677        MOVE  1                  TO SET-CURSOR-SW
 23678        GO TO 7499-EXIT.
 23679
 23680**2653**
 23681
 23682     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
 23683        MOVE AL-UABON            TO BFREQA
 23684        MOVE -1                  TO BFREQL
 23685        MOVE  1                  TO SET-CURSOR-SW
 23686        GO TO 7499-EXIT.
 23687
 23688**2654**
 23689
 23690     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23691        MOVE AL-UABON            TO BFREQA
 23692        MOVE -1                  TO BFREQL
 23693        MOVE  1                  TO SET-CURSOR-SW
 23694        GO TO 7499-EXIT.
 23695
 23696**2655**
 23697
 23698     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23699        MOVE AL-UABON            TO BFREQA
 23700        MOVE -1                  TO BFREQL
 23701        MOVE  1                  TO SET-CURSOR-SW
 23702        GO TO 7499-EXIT.
 23703
 23704**2656**
 23705
 23706     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23707        MOVE AL-UNBON            TO BAPRA
 23708        MOVE -1                  TO BAPRL
 23709        MOVE  1                  TO SET-CURSOR-SW
 23710        GO TO 7499-EXIT.
 23711
 23712**2657**
 23713
 23714     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23715        MOVE AL-UNBON            TO BAPRA
 23716        MOVE -1                  TO BAPRL
 23717        MOVE  1                  TO SET-CURSOR-SW
 23718        GO TO 7499-EXIT.
 23719
 23720**2658**
 23721
 23722     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23723        MOVE AL-UNBON            TO BTERM2A
 23724        MOVE -1                  TO BTERM2L
 23725        MOVE  1                  TO SET-CURSOR-SW
 23726        GO TO 7499-EXIT.
 23727
 23728**2660**
 23729
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 437
* EL6311.cbl
 23730     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23731        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23732        MOVE -1                  TO BLSTNML
 23733        MOVE  1                  TO SET-CURSOR-SW
 23734        GO TO 7499-EXIT.
 23735
 23736
 23737**2662**
 23738
 23739     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23740        MOVE AL-UNBON            TO BAGEA
 23741        MOVE -1                  TO BAGEL
 23742        MOVE  1                  TO SET-CURSOR-SW
 23743        GO TO 7499-EXIT.
 23744
 23745**2663**
 23746
 23747     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23748        MOVE AL-UNBON            TO BAGEA
 23749        MOVE -1                  TO BAGEL
 23750        MOVE  1                  TO SET-CURSOR-SW
 23751        GO TO 7499-EXIT.
 23752
 23753**2664**
 23754
 23755     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23756        MOVE AL-UABON            TO BREINA
 23757        MOVE -1                  TO BREINL
 23758        MOVE  1                  TO SET-CURSOR-SW
 23759        GO TO 7499-EXIT.
 23760
 23761**2667**
 23762
 23763     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23764        MOVE AL-UNBON            TO BBEN2A
 23765        MOVE -1                  TO BBEN2L
 23766        MOVE  1                  TO SET-CURSOR-SW
 23767        GO TO 7499-EXIT.
 23768
 23769**2668**
 23770
 23771     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23772        MOVE AL-UABON            TO BEFFDTA
 23773        GO TO 7499-EXIT.
 23774
 23775**2669**
 23776
 23777     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23778       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23779       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23780        MOVE AL-UNBON            TO BAGEA
 23781        MOVE -1                  TO BAGEL
 23782        MOVE  1                  TO SET-CURSOR-SW
 23783        GO TO 7499-EXIT.
 23784
 23785**2670**
 23786
 23787     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 438
* EL6311.cbl
 23788        MOVE AL-UABON            TO BFORCEA
 23789        MOVE -1                  TO BFORCEL
 23790        MOVE  1                  TO SET-CURSOR-SW
 23791        GO TO 7499-EXIT.
 23792
 23793**2671**
 23794
 23795     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23796        MOVE AL-UABON            TO BEFFDTA
 23797        GO TO 7499-EXIT.
 23798
 23799**2672**
 23800
 23801     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23802        MOVE AL-UABON            TO BEFFDTA
 23803        GO TO 7499-EXIT.
 23804
 23805**2673**
 23806
 23807     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23808        MOVE AL-UABON            TO BEFFDTA
 23809        GO TO 7499-EXIT.
 23810
 23811**2674**
 23812
 23813     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23814        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23815        MOVE -1                  TO BTYPE1L
 23816        MOVE  1                  TO SET-CURSOR-SW
 23817        GO TO 7499-EXIT.
 23818
 23819**2677**
 23820
 23821     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23822        MOVE AL-UNBON            TO BTERM1A
 23823        MOVE -1                  TO BTERM1L
 23824        MOVE  1                  TO SET-CURSOR-SW
 23825        GO TO 7499-EXIT.
 23826
 23827**2678**
 23828
 23829     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23830        MOVE AL-UNBON            TO BTERM2A
 23831        MOVE -1                  TO BTERM2L
 23832        MOVE  1                  TO SET-CURSOR-SW
 23833        GO TO 7499-EXIT.
 23834
 23835**2679**
 23836
 23837     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23838        MOVE AL-UABON            TO BTYPE1A
 23839        MOVE -1                  TO BTYPE1L
 23840        MOVE  1                  TO SET-CURSOR-SW
 23841        GO TO 7499-EXIT.
 23842
 23843**2680**
 23844
 23845     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 439
* EL6311.cbl
 23846        MOVE AL-UABOF            TO B1STPMTA
 23847        MOVE -1                  TO B1STPMTL
 23848        MOVE  1                  TO SET-CURSOR-SW
 23849        GO TO 7499-EXIT.
 23850
 23851**2681**
 23852
 23853     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23854        MOVE AL-UABON            TO BDAYSA
 23855        MOVE -1                  TO BDAYSL
 23856        MOVE  1                  TO SET-CURSOR-SW
 23857        GO TO 7499-EXIT.
 23858
 23859**2682**
 23860
 23861     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23862        MOVE AL-UABON            TO BTERM1A
 23863        MOVE -1                  TO BTERM1L
 23864        MOVE  1                  TO SET-CURSOR-SW
 23865        GO TO 7499-EXIT.
 23866
 23867**2683**
 23868
 23869     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23870        MOVE AL-UABON            TO BSKPCDA
 23871        MOVE -1                  TO BSKPCDL
 23872        MOVE  1                  TO SET-CURSOR-SW
 23873        GO TO 7499-EXIT.
 23874
 23875**2684**
 23876
 23877     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23878        MOVE AL-UABON            TO BTYPE2A
 23879        MOVE -1                  TO BTYPE2L
 23880        MOVE  1                  TO SET-CURSOR-SW
 23881        GO TO 7499-EXIT.
 23882
 23883**2686**
 23884
 23885     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23886        MOVE AL-UABON            TO BTYPE2A
 23887        MOVE -1                  TO BTYPE2L
 23888        MOVE  1                  TO SET-CURSOR-SW
 23889        GO TO 7499-EXIT.
 23890
 23891**2689**
 23892
 23893     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23894        MOVE AL-UABON            TO BSIGA
 23895        MOVE -1                  TO BSIGL
 23896        MOVE  1                  TO SET-CURSOR-SW
 23897        GO TO 7499-EXIT.
 23898
 23899**2690**
 23900
 23901     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23902        MOVE AL-UABOF            TO BLNOFCRA
 23903        MOVE -1                  TO BLNOFCRL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 440
* EL6311.cbl
 23904        MOVE  1                  TO SET-CURSOR-SW
 23905        GO TO 7499-EXIT.
 23906
 23907**2693**
 23908
 23909     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23910        MOVE AL-UABOF            TO BLNOFCRA
 23911        MOVE AL-UNBON            TO BBEN1A
 23912        MOVE -1                  TO BBEN1L
 23913        MOVE  1                  TO SET-CURSOR-SW
 23914        GO TO 7499-EXIT.
 23915
 23916**2720**
 23917
 23918     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23919        MOVE AL-UNBON            TO BBEN1A
 23920        MOVE -1                  TO BBEN1L
 23921        MOVE  1                  TO SET-CURSOR-SW
 23922        GO TO 7499-EXIT.
 23923
 23924**2709**
 23925
 23926*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23927*       MOVE AL-UNBON            TO BBEN1A
 23928*       MOVE -1                  TO BBEN1L
 23929*       MOVE  1                  TO SET-CURSOR-SW
 23930*       GO TO 7499-EXIT.
 23931
 23932*************************************************************
 23933*                                                           *
 23934*            C A N C E L   E R R O R S                      *
 23935*                                                           *
 23936*************************************************************
 23937
 23938**2726**
 23939
 23940     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23941        MOVE AL-UABON            TO CCERTNOA
 23942        GO TO 7499-EXIT.
 23943
 23944**2728**
 23945
 23946     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23947        MOVE AL-UABON            TO CCERTNOA
 23948        GO TO 7499-EXIT.
 23949
 23950**2729**
 23951
 23952     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23953        MOVE AL-UABON            TO CCERTNOA
 23954        GO TO 7499-EXIT.
 23955
 23956**2730**
 23957
 23958     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23959        MOVE AL-UABON            TO CCERTNOA
 23960        GO TO 7499-EXIT.
 23961
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 441
* EL6311.cbl
 23962**2731**
 23963
 23964     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23965        MOVE AL-UABON            TO CCANDT1A
 23966        MOVE -1                  TO CCANDT1L
 23967        MOVE  1                  TO SET-CURSOR-SW
 23968        GO TO 7499-EXIT.
 23969
 23970**2732**
 23971
 23972     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
 23973        MOVE AL-UABON            TO CCANDT1A
 23974        MOVE -1                  TO CCANDT1L
 23975        MOVE  1                  TO SET-CURSOR-SW
 23976        GO TO 7499-EXIT.
 23977
 23978**2733**
 23979
 23980     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23981        MOVE AL-UABON            TO CCANDT1A
 23982        MOVE -1                  TO CCANDT1L
 23983        MOVE  1                  TO SET-CURSOR-SW
 23984        GO TO 7499-EXIT.
 23985
 23986**2734**
 23987
 23988     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23989        MOVE AL-UNBON            TO CREFND1A
 23990        MOVE -1                  TO CREFND1L
 23991        MOVE  1                  TO SET-CURSOR-SW
 23992        GO TO 7499-EXIT.
 23993
 23994**2735**
 23995
 23996     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23997        MOVE AL-UABON            TO CCANDT2A
 23998        MOVE -1                  TO CCANDT2L
 23999        MOVE  1                  TO SET-CURSOR-SW
 24000        GO TO 7499-EXIT.
 24001
 24002**2736**
 24003
 24004     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24005        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24006            MOVE AL-UNBON        TO CREFND1A
 24007            MOVE -1              TO CREFND1L
 24008            MOVE  1              TO SET-CURSOR-SW
 24009            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24010                MOVE AL-UNBON        TO CREFND2A
 24011                MOVE -1              TO CREFND2L
 24012                MOVE  1              TO SET-CURSOR-SW
 24013                GO TO 7499-EXIT
 24014            ELSE
 24015                GO TO 7499-EXIT
 24016        ELSE
 24017            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24018                MOVE AL-UNBON        TO CREFND2A
 24019                MOVE -1              TO CREFND2L
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 442
* EL6311.cbl
 24020                MOVE  1              TO SET-CURSOR-SW
 24021                GO TO 7499-EXIT
 24022            ELSE
 24023                GO TO 7499-EXIT.
 24024
 24025**2738**
 24026
 24027     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24028        MOVE -1                  TO CREFND2L
 24029        MOVE  1                  TO SET-CURSOR-SW
 24030        GO TO 7499-EXIT.
 24031
 24032**2739**
 24033
 24034     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24035        MOVE -1                  TO CREFND1L
 24036        MOVE  1                  TO SET-CURSOR-SW
 24037        GO TO 7499-EXIT.
 24038
 24039**2741**
 24040
 24041     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24042        MOVE -1                  TO CREFND1L
 24043        MOVE  1                  TO SET-CURSOR-SW
 24044        GO TO 7499-EXIT.
 24045
 24046**2743**
 24047
 24048     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 24049        MOVE AL-UNBON            TO CCANDT1A
 24050        MOVE -1                  TO CCANDT1L
 24051        MOVE  1                  TO SET-CURSOR-SW
 24052        GO TO 7499-EXIT.
 24053
 24054**2744**
 24055
 24056     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 24057        MOVE AL-UNBON            TO CCANDT2A
 24058        MOVE -1                  TO CCANDT2L
 24059        MOVE  1                  TO SET-CURSOR-SW
 24060        GO TO 7499-EXIT.
 24061
 24062**2747**
 24063
 24064     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 24065        MOVE AL-UABON            TO CLSTNMA
 24066        MOVE -1                  TO CLSTNML
 24067        MOVE  1                  TO SET-CURSOR-SW
 24068        GO TO 7499-EXIT.
 24069
 24070**2749**
 24071
 24072     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 24073        MOVE AL-UABON            TO CFORCEA
 24074        MOVE -1                  TO CFORCEL
 24075        MOVE  1                  TO SET-CURSOR-SW
 24076        GO TO 7499-EXIT.
 24077
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 443
* EL6311.cbl
 24078**2753**
 24079
 24080     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 24081        MOVE AL-UNBON            TO CCANDT1A
 24082        MOVE -1                  TO CCANDT1L
 24083        MOVE  1                  TO SET-CURSOR-SW
 24084        GO TO 7499-EXIT.
 24085
 24086**2755**
 24087
 24088     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
 24089        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24090            MOVE AL-UNBON        TO CREFND1A
 24091            MOVE -1              TO CREFND1L
 24092            MOVE  1              TO SET-CURSOR-SW
 24093            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24094                MOVE AL-UNBON        TO CREFND2A
 24095                MOVE -1              TO CREFND2L
 24096                MOVE  1              TO SET-CURSOR-SW
 24097                GO TO 7499-EXIT
 24098            ELSE
 24099                GO TO 7499-EXIT
 24100        ELSE
 24101            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24102                MOVE AL-UNBON        TO CREFND2A
 24103                MOVE -1              TO CREFND2L
 24104                MOVE  1              TO SET-CURSOR-SW
 24105            ELSE
 24106                GO TO 7499-EXIT.
 24107
 24108**2757**
 24109
 24110     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 24111        MOVE AL-UNBON            TO CLIVESA
 24112        MOVE -1                  TO CLIVESL
 24113        MOVE  1                  TO SET-CURSOR-SW
 24114        GO TO 7499-EXIT.
 24115
 24116**2771**
 24117
 24118     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 24119        MOVE AL-UABON            TO CCANDT2A
 24120        MOVE -1                  TO CCANDT2L
 24121        MOVE  1                  TO SET-CURSOR-SW
 24122        GO TO 7499-EXIT.
 24123
 24124**2774**
 24125
 24126     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 24127        MOVE AL-UABON            TO CCANDT1A
 24128        MOVE -1                  TO CCANDT1L
 24129        MOVE  1                  TO SET-CURSOR-SW
 24130        GO TO 7499-EXIT.
 24131
 24132**2775**
 24133
 24134     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24135        MOVE AL-UABON            TO CCANDT2A
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 444
* EL6311.cbl
 24136        MOVE -1                  TO CCANDT2L
 24137        MOVE  1                  TO SET-CURSOR-SW
 24138        GO TO 7499-EXIT.
 24139
 24140**2776**
 24141
 24142     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24143        MOVE AL-UABON            TO CCANDT1A
 24144        MOVE -1                  TO CCANDT1L
 24145        MOVE  1                  TO SET-CURSOR-SW
 24146        GO TO 7499-EXIT.
 24147
 24148
 24149**2777**
 24150
 24151     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24152        MOVE AL-UABON            TO CCANDT2A
 24153        MOVE -1                  TO CCANDT2L
 24154        MOVE  1                  TO SET-CURSOR-SW
 24155        GO TO 7499-EXIT.
 24156
 24157**2794**
 24158
 24159     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24160        MOVE AL-UABON            TO CFORCEA
 24161        MOVE -1                  TO CFORCEL
 24162        MOVE  1                  TO SET-CURSOR-SW
 24163        GO TO 7499-EXIT.
 24164
 24165**2799**
 24166
 24167     IF PI-COMPANY-ID = 'UCL'
 24168         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24169             MOVE AL-UNBON            TO BEFFDTA
 24170             MOVE -1                  TO BEFFDTL
 24171             MOVE  1                  TO SET-CURSOR-SW
 24172             GO TO 7499-EXIT.
 24173
 24174 7499-EXIT.
 24175      EXIT.
 24176
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 445
* EL6311.cbl
 24178
 24179 7500-READ-ERLOFC.
 24180     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24181                                     ERLOFC-KEY.
 24182
 24183     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24184
 24185     IF ST-ACCNT-CNTL
 24186         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24187
 24188     IF CARR-GROUP-ST-ACCNT-CNTL
 24189         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24190         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24191         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24192
 24193     IF CARR-ST-ACCNT-CNTL
 24194         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24195         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24196
 24197     IF CARR-ACCNT-CNTL
 24198         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24199
 24200     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24201
 24202     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24203
 24204
 24205* EXEC CICS HANDLE CONDITION
 24206*        NOTFND   (7550-OFFICER-NOTFND)
 24207*    END-EXEC.
 24208*    MOVE '"$I                   ! V #00020466' TO DFHEIV0
 24209     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24210     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24211     MOVE X'5620233030303230343636' TO DFHEIV0(25:11)
 24212     CALL 'kxdfhei1' USING DFHEIV0
 24213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24214
 24215
 24216
 24217* EXEC CICS READ
 24218*        DATASET   (FILE-ID-ERLOFC)
 24219*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24220*        RIDFLD    (ERLOFC-KEY)
 24221*        EQUAL
 24222*    END-EXEC.
 24223*    MOVE '&"S        E          (   #00020470' TO DFHEIV0
 24224     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24225     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24226     MOVE X'2020233030303230343730' TO DFHEIV0(25:11)
 24227     CALL 'kxdfhei1' USING DFHEIV0,
 24228           FILE-ID-ERLOFC,
 24229           DFHEIV20,
 24230           DFHEIV99,
 24231           ERLOFC-KEY,
 24232           DFHEIV99,
 24233           DFHEIV99,
 24234           DFHEIV99
 24235     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 446
* EL6311.cbl
 24236         DFHEIV20
 24237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24238
 24239
 24240     GO TO 7599-EXIT.
 24241
 24242 7550-OFFICER-NOTFND.
 24243     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24244
 24245 7599-EXIT.
 24246      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 447
* EL6311.cbl
 24248******************************************************************
 24249*                                                                *
 24250*            S  E N D    I N I T I A L   M A P                   *
 24251*                                                                *
 24252******************************************************************
 24253
 24254 8100-SEND-INITIAL-MAP.
 24255     MOVE EIBTIME                TO TIME-IN.
 24256
 24257     IF EIBAID = DFHPF11
 24258        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24259        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24260
 24261
 24262     IF PI-COMPANY-ID = CLIENT-GIC
 24263        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24264                                       BCPREM-ATTRB (2).
 24265
 24266     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24267                         CLIENT-PEM OR
 24268                         CLIENT-CSO)
 24269        AND PI-DISPLAY-ORIGINAL-BATCH
 24270          IF PI-MAP-NAME = EL631B
 24271             MOVE AL-SADOF               TO BPF5HDRA
 24272                                            BPF4HDRA
 24273          ELSE
 24274             IF PI-MAP-NAME = EL631C
 24275                MOVE AL-SADOF            TO CPF5HDRA
 24276                                            CPF4HDRA.
 24277
 24278     IF PI-MAP-NAME = EL631B
 24279        MOVE AL-SADOF               TO BPF5HDRA
 24280     ELSE
 24281        MOVE AL-SADOF               TO CPF5HDRA
 24282     END-IF
 24283
 24284*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24285     IF PI-MAP-NAME = EL631B
 24286          IF PI-COMPANY-ID NOT = 'DMD'
 24287             MOVE AL-SANOF            TO BBILLEDA
 24288             MOVE AL-SADOF            TO DMDBILA.
 24289*DMD CUSTOM CODING*************END
 24290
 24291     IF PI-PROCESSOR-ID = 'LGXX'
 24292        IF PI-MAP-NAME = EL631B
 24293           MOVE AL-SABOF                    TO BREFHDGA
 24294           MOVE AL-SANOF                    TO BREFA
 24295        ELSE
 24296           IF PI-MAP-NAME = EL631C
 24297              MOVE AL-SABOF                 TO CREFHDGA
 24298              MOVE AL-SANOF                 TO CREFA.
 24299
 24300     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 24301        continue
 24302     ELSE
 24303        IF PI-MAP-NAME = EL631C
 24304           MOVE AL-SADOF         TO CCANTXTA
 24305                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 448
* EL6311.cbl
 24306        end-if
 24307     end-if
 24308     IF PI-MAP-NAME = EL631D
 24309        IF PI-AR-PROCESSING
 24310           MOVE AL-SANOF            TO DREFHDGA
 24311        ELSE
 24312           MOVE AL-SADOF            TO DREFHDGA.
 24313
 24314     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 24315        AND (PI-MAP-NAME = EL631B)
 24316        MOVE AL-SADOF            TO BVINHA
 24317                                    BVINA
 24318     END-IF
 24319     IF PI-MAP-NAME = EL631B
 24320        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24321        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24322                                 TO BREGIONO
 24323        MOVE PI-PROCESSOR-ID     TO BUSERO
 24324        IF CSR-EDIT-SESSION
 24325           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24326                                 TO BHEADO
 24327           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24328        ELSE
 24329           MOVE AL-SADOF         TO BF15HDRA
 24330           MOVE '4=B-HDR      '  TO BPF4HDRO
 24331        END-IF
 24332        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24333        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24334        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24335        MOVE WS-CURRENT-DT          TO BDATEO
 24336        MOVE TIME-OUT               TO BTIMEO
 24337        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24338        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24339        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24340        IF   WS-DISPLAY-SCREEN
 24341             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24342             MOVE PB-SV-CARRIER     TO BCARRO
 24343             MOVE PB-SV-GROUPING    TO BGROUPO
 24344             MOVE PB-SV-STATE       TO BSTATEO
 24345             MOVE PB-ACCOUNT        TO BACCTO
 24346        ELSE
 24347             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24348     ELSE
 24349        IF PI-MAP-NAME = EL631C
 24350           MOVE '4=B-HDR      '     TO CPF4HDRO
 24351           IF CSR-EDIT-SESSION
 24352              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24353                                 TO CHEADO
 24354           ELSE
 24355              MOVE AL-SADOF      TO CF15HDRA
 24356           END-IF
 24357           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24358           MOVE WS-CURRENT-DT          TO CDATEO
 24359           MOVE TIME-OUT               TO CTIMEO
 24360           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24361           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24362           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24363           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 449
* EL6311.cbl
 24364           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24365           MOVE WS-C-HDG               TO CAHHDGO
 24366           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24367           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24368           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24369           IF   WS-DISPLAY-SCREEN
 24370                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24371                MOVE PB-SV-CARRIER     TO CCARRO
 24372                MOVE PB-SV-GROUPING    TO CGROUPO
 24373                MOVE PB-SV-STATE       TO CSTATEO
 24374                MOVE PB-ACCOUNT        TO CACCTO
 24375           ELSE
 24376                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24377        ELSE
 24378           MOVE WS-CURRENT-DT          TO DDATEO
 24379           MOVE TIME-OUT               TO DTIMEO
 24380           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24381                                          WS-REFUND-HDG-OVERRIDE
 24382           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24383           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24384           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24385                                          WS-REFUND-HDG-OVERRIDE
 24386           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24387           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24388           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24389           IF CSR-EDIT-SESSION
 24390              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24391                                 TO DHEADO
 24392           END-IF
 24393           IF  WS-DISPLAY-SCREEN
 24394               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24395               MOVE PB-CARRIER         TO DCARRO
 24396               MOVE PB-GROUPING        TO DGROUPO
 24397               MOVE PB-STATE           TO DSTATEO
 24398               MOVE PB-ACCOUNT         TO DACCTO
 24399               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24400           ELSE
 24401               MOVE EL631D             TO PI-MAP-NAME
 24402               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24403               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24404
 24405     MOVE SPACE                        TO WS-DISPLAY-SW.
 24406
 24407
 24408* EXEC CICS SEND
 24409*        MAP      (PI-MAP-NAME)
 24410*        MAPSET   (MAPSET-EL6311S)
 24411*        FROM     (EL631BI)
 24412*        ERASE
 24413*        CURSOR
 24414*    END-EXEC.
 24415     MOVE LENGTH OF
 24416      EL631BI
 24417       TO DFHEIV12
 24418     MOVE -1
 24419       TO DFHEIV11
 24420*    MOVE '8$     CT  E    H L F ,   #00020644' TO DFHEIV0
 24421     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 450
* EL6311.cbl
 24422     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24423     MOVE X'2020233030303230363434' TO DFHEIV0(25:11)
 24424     CALL 'kxdfhei1' USING DFHEIV0,
 24425           PI-MAP-NAME,
 24426           EL631BI,
 24427           DFHEIV12,
 24428           MAPSET-EL6311S,
 24429           DFHEIV99,
 24430           DFHEIV99,
 24431           DFHEIV99,
 24432           DFHEIV11,
 24433           DFHEIV99,
 24434           DFHEIV99,
 24435           DFHEIV99
 24436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24437
 24438
 24439     GO TO 9100-RETURN-TRAN.
 24440
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 451
* EL6311.cbl
 24442
 24443******************************************************************
 24444*                                                                *
 24445*              S E N D    D A T A O N L Y                        *
 24446*                                                                *
 24447******************************************************************
 24448
 24449 8200-SEND-DATAONLY.
 24450     MOVE EIBTIME                TO TIME-IN.
 24451
 24452     IF PI-COMPANY-ID = CLIENT-GIC
 24453        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24454                                       BCPREM-ATTRB (2).
 24455
 24456     IF PI-MAP-NAME = EL631B
 24457        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24458        MOVE WS-CURRENT-DT          TO BDATEO
 24459        MOVE TIME-OUT               TO BTIMEO
 24460        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24461        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24462        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24463        MOVE SPACES                 TO BPFENTRO
 24464        MOVE AL-UANOF               TO BPFENTRA
 24465
 24466*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24467        IF PI-COMPANY-ID NOT = 'DMD'
 24468             MOVE AL-SANOF            TO BBILLEDA
 24469             MOVE AL-SADOF            TO DMDBILA
 24470         ELSE
 24471            NEXT SENTENCE
 24472*DMD CUSTOM CODING*************END
 24473     ELSE
 24474        IF PI-MAP-NAME = EL631C
 24475           MOVE WS-CURRENT-DT          TO CDATEO
 24476           MOVE TIME-OUT               TO CTIMEO
 24477           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24478           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24479           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24480           MOVE SPACES                 TO CPFENTRO
 24481           MOVE AL-UANOF               TO CPFENTRA
 24482        ELSE
 24483           MOVE WS-CURRENT-DT          TO DDATEO
 24484           MOVE TIME-OUT               TO DTIMEO
 24485           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24486
 24487
 24488* EXEC CICS SEND
 24489*        MAP      (PI-MAP-NAME)
 24490*        MAPSET   (MAPSET-EL6311S)
 24491*        FROM     (EL631BI)
 24492*        DATAONLY
 24493*        CURSOR
 24494*    END-EXEC.
 24495     MOVE LENGTH OF
 24496      EL631BI
 24497       TO DFHEIV12
 24498     MOVE -1
 24499       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 452
* EL6311.cbl
 24500*    MOVE '8$D    CT       H L F ,   #00020700' TO DFHEIV0
 24501     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24502     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24503     MOVE X'2020233030303230373030' TO DFHEIV0(25:11)
 24504     CALL 'kxdfhei1' USING DFHEIV0,
 24505           PI-MAP-NAME,
 24506           EL631BI,
 24507           DFHEIV12,
 24508           MAPSET-EL6311S,
 24509           DFHEIV99,
 24510           DFHEIV99,
 24511           DFHEIV99,
 24512           DFHEIV11,
 24513           DFHEIV99,
 24514           DFHEIV99,
 24515           DFHEIV99
 24516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24517
 24518
 24519     GO TO 9100-RETURN-TRAN.
 24520
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 453
* EL6311.cbl
 24522
 24523******************************************************************
 24524*                                                                *
 24525*           U T I L I T Y   R O U T I N E S                      *
 24526*                                                                *
 24527******************************************************************
 24528
 24529 8300-SEND-TEXT.
 24530
 24531* EXEC CICS SEND TEXT
 24532*        FROM     (LOGOFF-TEXT)
 24533*        LENGTH   (LOGOFF-LENGTH)
 24534*        ERASE
 24535*        FREEKB
 24536*    END-EXEC.
 24537*    MOVE '8&      T  E F  H   F -   #00020719' TO DFHEIV0
 24538     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24539     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24540     MOVE X'2020233030303230373139' TO DFHEIV0(25:11)
 24541     CALL 'kxdfhei1' USING DFHEIV0,
 24542           LOGOFF-TEXT,
 24543           LOGOFF-LENGTH,
 24544           DFHEIV99,
 24545           DFHEIV99,
 24546           DFHEIV99,
 24547           DFHEIV99,
 24548           DFHEIV99,
 24549           DFHEIV99,
 24550           DFHEIV99,
 24551           DFHEIV99,
 24552           DFHEIV99,
 24553           DFHEIV99
 24554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24555
 24556
 24557
 24558* EXEC CICS RETURN
 24559*    END-EXEC.
 24560*    MOVE '.(                    ''   #00020726' TO DFHEIV0
 24561     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24562     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24563     MOVE X'2020233030303230373236' TO DFHEIV0(25:11)
 24564     CALL 'kxdfhei1' USING DFHEIV0,
 24565           DFHEIV99,
 24566           DFHEIV99,
 24567           DFHEIV99,
 24568           DFHEIV99,
 24569           DFHEIV99,
 24570           DFHEIV99
 24571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24572
 24573
 24574 8400-LOG-JOURNAL-RECORD.
 24575
 24576     if (pi-journal-file-id > 0)
 24577        and (jp-file-id = file-id-erpndb)
 24578        move eibdate             to jp-date
 24579        move eibtime             to jp-time
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 454
* EL6311.cbl
 24580*       move FILE-ID-ERPNDB      TO JP-FILE-ID
 24581        MOVE PI-PROCESSOR-ID     TO JP-USER-ID
 24582        MOVE 03                  TO PI-JOURNAL-FILE-ID
 24583        if csr-edit-session
 24584           move 'EL6311C'        to jp-program-id
 24585        else
 24586           MOVE THIS-PGM         TO JP-PROGRAM-ID
 24587        end-if
 24588
 24589**      length is 585 plus 30 extra for jrnl stuff
 24590**      system already accounts for the 34
 24591
 24592
 24593* EXEC CICS JOURNAL
 24594*          JFILEID   (PI-JOURNAL-FILE-ID)
 24595*          JTYPEID   ('EL')
 24596*          FROM      (JOURNAL-RECORD)
 24597*          LENGTH    (615)
 24598*          resp      (ws-response)
 24599*       END-EXEC
 24600     MOVE 'EL' TO DFHEIV7
 24601     MOVE 615
 24602       TO DFHEIV11
 24603*    MOVE '4"LF                  (  N#00020747' TO DFHEIV0
 24604     MOVE X'34224C462020202020202020' TO DFHEIV0(1:12)
 24605     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24606     MOVE X'204E233030303230373437' TO DFHEIV0(25:11)
 24607     CALL 'kxdfhei1' USING DFHEIV0,
 24608           PI-JOURNAL-FILE-ID,
 24609           DFHEIV7,
 24610           JOURNAL-RECORD,
 24611           DFHEIV11,
 24612           DFHEIV99,
 24613           DFHEIV99,
 24614           DFHEIV99
 24615     MOVE EIBRESP  TO ws-response
 24616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 24617
 24618        if resp-normal
 24619           continue
 24620        else
 24621           display ' error-el6311-journal ' ws-response
 24622        end-if
 24623     end-if
 24624
 24625*    EXEC CICS JOURNAL
 24626*        JFILEID     (PI-JOURNAL-FILE-ID)
 24627*        JTYPEID     ('EL')
 24628*        FROM        (JOURNAL-RECORD)
 24629*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24630*    END-EXEC.
 24631     .
 24632 8400-exit.
 24633     exit.
 24634 8600-DEEDIT.
 24635
 24636* EXEC CICS BIF DEEDIT
 24637*         FIELD   (DEEDIT-FIELD)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 455
* EL6311.cbl
 24638*         LENGTH  (15)
 24639*    END-EXEC.
 24640     MOVE 15
 24641       TO DFHEIV11
 24642*    MOVE '@"L                   #   #00020772' TO DFHEIV0
 24643     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24644     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24645     MOVE X'2020233030303230373732' TO DFHEIV0(25:11)
 24646     CALL 'kxdfhei1' USING DFHEIV0,
 24647           DEEDIT-FIELD,
 24648           DFHEIV11
 24649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24650
 24651
 24652 8800-UNAUTHORIZED-ACCESS.
 24653     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24654     GO TO 8300-SEND-TEXT.
 24655
 24656 8810-PF23.
 24657     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24658     MOVE XCTL-EL005             TO PGM-NAME.
 24659     GO TO 9300-XCTL.
 24660
 24661 9100-RETURN-TRAN.
 24662     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24663
 24664     IF  PI-MAP-NAME =  EL631B
 24665         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24666
 24667     IF  PI-MAP-NAME =  EL631C
 24668         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24669
 24670     IF  PI-MAP-NAME =  EL631D
 24671         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24672
 24673
 24674* EXEC CICS RETURN
 24675*        TRANSID    (TRANS-EXB1)
 24676*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24677*        LENGTH     (1300)
 24678*    END-EXEC.
 24679     MOVE 1300
 24680       TO DFHEIV11
 24681*    MOVE '.(CT                  ''   #00020798' TO DFHEIV0
 24682     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24683     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24684     MOVE X'2020233030303230373938' TO DFHEIV0(25:11)
 24685     CALL 'kxdfhei1' USING DFHEIV0,
 24686           TRANS-EXB1,
 24687           PROGRAM-INTERFACE-BLOCK,
 24688           DFHEIV11,
 24689           DFHEIV99,
 24690           DFHEIV99,
 24691           DFHEIV99
 24692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24693
 24694
 24695 9200-RETURN-MAIN-MENU.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 456
* EL6311.cbl
 24696     MOVE XCTL-EL626             TO PGM-NAME.
 24697     GO TO 9300-XCTL.
 24698
 24699 9300-XCTL.
 24700
 24701* EXEC CICS XCTL
 24702*        PROGRAM    (PGM-NAME)
 24703*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24704*        LENGTH     (PI-COMM-LENGTH)
 24705*    END-EXEC.
 24706*    MOVE '.$C                   %   #00020809' TO DFHEIV0
 24707     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24708     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24709     MOVE X'2020233030303230383039' TO DFHEIV0(25:11)
 24710     CALL 'kxdfhei1' USING DFHEIV0,
 24711           PGM-NAME,
 24712           PROGRAM-INTERFACE-BLOCK,
 24713           PI-COMM-LENGTH,
 24714           DFHEIV99
 24715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24716
 24717
 24718 9400-CLEAR.
 24719     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24720     GO TO 9300-XCTL.
 24721
 24722 9500-PF12.
 24723     MOVE XCTL-EL010             TO PGM-NAME.
 24724     GO TO 9300-XCTL.
 24725
 24726 9600-PGMID-ERROR.
 24727
 24728* EXEC CICS HANDLE CONDITION
 24729*        PGMIDERR    (8300-SEND-TEXT)
 24730*    END-EXEC.
 24731*    MOVE '"$L                   ! W #00020824' TO DFHEIV0
 24732     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24733     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24734     MOVE X'5720233030303230383234' TO DFHEIV0(25:11)
 24735     CALL 'kxdfhei1' USING DFHEIV0
 24736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24737
 24738
 24739     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24740     MOVE ' '                    TO PI-ENTRY-CD-1.
 24741     MOVE XCTL-EL005             TO PGM-NAME.
 24742     MOVE PGM-NAME               TO LOGOFF-PGM.
 24743     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24744     GO TO 9300-XCTL.
 24745
 24746 9700-DATE-LINK.
 24747     MOVE LINK-ELDATCV           TO PGM-NAME.
 24748
 24749* EXEC CICS LINK
 24750*        PROGRAM    (PGM-NAME)
 24751*        COMMAREA   (DATE-CONVERSION-DATA)
 24752*        LENGTH     (DC-COMM-LENGTH)
 24753*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 457
* EL6311.cbl
 24754*    MOVE '."C                   (   #00020837' TO DFHEIV0
 24755     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24756     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24757     MOVE X'2020233030303230383337' TO DFHEIV0(25:11)
 24758     CALL 'kxdfhei1' USING DFHEIV0,
 24759           PGM-NAME,
 24760           DATE-CONVERSION-DATA,
 24761           DC-COMM-LENGTH,
 24762           DFHEIV99,
 24763           DFHEIV99,
 24764           DFHEIV99,
 24765           DFHEIV99
 24766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24767
 24768
 24769 9800-LINK-PENDING-EDIT.
 24770     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24771     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24772
 24773     MOVE LINK-EL050             TO PGM-NAME
 24774     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24775     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24776                                    WK-CO-TOL-CLAIM
 24777                                    WK-CO-TOL-PREM
 24778                                    WK-CO-TOL-REFUND
 24779                                    WK-CO-TOL-PREM-PCT
 24780                                    WK-CO-TOL-REFUND-PCT
 24781                                    WK-REFUND-OVS-AMT
 24782                                    WK-REFUND-OVS-PCT
 24783                                    WK-ACCT-ADDR
 24784                                    WK-LIFE-EDIT-ADDR
 24785                                    WK-AH-EDIT-ADDR
 24786                                    WK-LIFE-BEN-ADDR
 24787                                    WK-AH-BEN-ADDR
 24788                                    WK-STATE-ADDR
 24789                                    WK-PLAN-ADDR
 24790                                    WK-FORM-ADDR
 24791     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24792
 24793     MOVE '6'                    TO WK-ENTRY-SW.
 24794
 24795     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24796
 24797     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24798                                    EC-AM-EXPIRATION-DT
 24799                                    EC-AM-EFFECTIVE-DT
 24800                                    EC-CM-LF-CANCEL-DT
 24801                                    EC-CM-AH-CANCEL-DT
 24802                                    EC-CM-DEATH-DT.
 24803
 24804     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24805                                    EC-CO-TOL-REFUND
 24806                                    EC-CO-MIN-AGE
 24807                                    EC-CO-MIN-PREMIUM
 24808                                    EC-CO-MIN-TERM
 24809                                    EC-CO-MAX-TERM
 24810                                    EC-ST-TOL-PREM
 24811                                    EC-ST-TOL-REFUND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 458
* EL6311.cbl
 24812                                    EC-AM-LF-TOL-PREM
 24813                                    EC-AM-AH-TOL-PREM
 24814                                    EC-AM-LF-MAX-ATT-AGE
 24815                                    EC-AM-LF-MAX-AGE
 24816                                    EC-AM-LF-MAX-TERM
 24817                                    EC-AM-LF-MAX-TOT-BEN
 24818                                    EC-AM-AH-MAX-ATT-AGE
 24819                                    EC-AM-AH-MAX-AGE
 24820                                    EC-AM-AH-MAX-TERM
 24821                                    EC-AM-AH-MAX-TOT-BEN
 24822                                    EC-AM-AH-MAX-MON-BEN
 24823                                    EC-RT-LF-MAX-ATT-AGE
 24824                                    EC-RT-LF-MAX-AGE
 24825                                    EC-RT-LF-MAX-TERM
 24826                                    EC-RT-LF-MAX-TOT-BEN
 24827                                    EC-RT-AH-MAX-ATT-AGE
 24828                                    EC-RT-AH-MAX-AGE
 24829                                    EC-RT-AH-MAX-TERM
 24830                                    EC-RT-AH-MAX-TOT-BEN
 24831                                    EC-RT-AH-MAX-MON-BEN
 24832                                    EC-RT-AH-RATE
 24833                                    EC-RT-LF-RATE
 24834                                    EC-RT-LF-NSP-RATE
 24835                                    EC-RT-AH-NSP-RATE
 24836                                    EC-CM-LF-PRIOR-REFUND
 24837                                    EC-CM-AH-PRIOR-REFUND.
 24838
 24839     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24840                                    EC-ST-TOL-PREM-PCT
 24841                                    EC-AM-LF-TOL-REFUND
 24842                                    EC-AM-LF-DEV-PERCENT
 24843                                    EC-CO-TOL-REFUND-PCT
 24844                                    EC-ST-TOL-REFUND-PCT
 24845                                    EC-AM-AH-TOL-REFUND
 24846                                    EC-AM-AH-DEV-PERCENT.
 24847
 24848
 24849* EXEC CICS LINK
 24850*         PROGRAM   (PGM-NAME)
 24851*         COMMAREA  (PASSED-RECORD)
 24852*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24853*    END-EXEC.
 24854*    MOVE '."C                   (   #00020922' TO DFHEIV0
 24855     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24856     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24857     MOVE X'2020233030303230393232' TO DFHEIV0(25:11)
 24858     CALL 'kxdfhei1' USING DFHEIV0,
 24859           PGM-NAME,
 24860           PASSED-RECORD,
 24861           WS-EDIT-PASS-LENGTH,
 24862           DFHEIV99,
 24863           DFHEIV99,
 24864           DFHEIV99,
 24865           DFHEIV99
 24866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24867
 24868
 24869     MOVE '1'                    TO PI-EDIT-SW.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 459
* EL6311.cbl
 24870     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24871
 24872     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24873
 24874     IF PI-COMPANY-ID = 'UCL'
 24875         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24876
 24877     IF VALID-PB-ID
 24878        GO TO 9800-EXIT.
 24879
 24880     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24881
 24882     IF PI-MAP-NAME = EL631B
 24883        MOVE -1                  TO BMAINTL
 24884       ELSE
 24885        MOVE -1                  TO CMAINTL.
 24886
 24887     GO TO 8200-SEND-DATAONLY.
 24888
 24889 9800-EXIT.
 24890      EXIT.
 24891
 24892 9900-ERROR-FORMAT.
 24893
 24894     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24895
 24896     IF NOT EMI-ERRORS-COMPLETE
 24897         MOVE LINK-EL001         TO PGM-NAME
 24898
 24899* EXEC CICS LINK
 24900*            PROGRAM    (PGM-NAME)
 24901*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24902*            LENGTH     (EMI-COMM-LENGTH)
 24903*        END-EXEC.
 24904*    MOVE '."C                   (   #00020957' TO DFHEIV0
 24905     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24906     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24907     MOVE X'2020233030303230393537' TO DFHEIV0(25:11)
 24908     CALL 'kxdfhei1' USING DFHEIV0,
 24909           PGM-NAME,
 24910           ERROR-MESSAGE-INTERFACE-BLOCK,
 24911           EMI-COMM-LENGTH,
 24912           DFHEIV99,
 24913           DFHEIV99,
 24914           DFHEIV99,
 24915           DFHEIV99
 24916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24917
 24918
 24919 9900-EXIT.
 24920     EXIT.
 24921
 24922 9990-ABEND.
 24923     MOVE LINK-EL004             TO PGM-NAME.
 24924     MOVE DFHEIBLK               TO EMI-LINE1.
 24925
 24926* EXEC CICS LINK
 24927*        PROGRAM   (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 460
* EL6311.cbl
 24928*        COMMAREA  (EMI-LINE1)
 24929*        LENGTH    (72)
 24930*    END-EXEC.
 24931     MOVE 72
 24932       TO DFHEIV11
 24933*    MOVE '."C                   (   #00020969' TO DFHEIV0
 24934     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24935     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24936     MOVE X'2020233030303230393639' TO DFHEIV0(25:11)
 24937     CALL 'kxdfhei1' USING DFHEIV0,
 24938           PGM-NAME,
 24939           EMI-LINE1,
 24940           DFHEIV11,
 24941           DFHEIV99,
 24942           DFHEIV99,
 24943           DFHEIV99,
 24944           DFHEIV99
 24945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24946
 24947
 24948     IF PI-MAP-NAME = EL631B
 24949        MOVE -1                  TO BMAINTL
 24950       ELSE
 24951        MOVE -1                  TO CMAINTL.
 24952
 24953     IF EIBTRNID NOT = TRANS-EXB1
 24954        GO TO 8100-SEND-INITIAL-MAP
 24955       ELSE
 24956        GO TO 8200-SEND-DATAONLY.
 24957
 24958 9995-SECURITY-VIOLATION.
 24959*                            COPY ELCSCTP.
 24960******************************************************************
 24961*                                                                *
 24962*                            ELCSCTP                             *
 24963*                            VMOD=2.001                          *
 24964*                                                                *
 24965*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24966******************************************************************
 24967
 24968
 24969     MOVE EIBDATE          TO SM-JUL-DATE.
 24970     MOVE EIBTRMID         TO SM-TERMID.
 24971     MOVE THIS-PGM         TO SM-PGM.
 24972     MOVE EIBTIME          TO TIME-IN.
 24973     MOVE TIME-OUT         TO SM-TIME.
 24974     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24975
 24976
 24977* EXEC CICS LINK
 24978*         PROGRAM  ('EL003')
 24979*         COMMAREA (SECURITY-MESSAGE)
 24980*         LENGTH   (80)
 24981*    END-EXEC.
 24982     MOVE 'EL003' TO DFHEIV1
 24983     MOVE 80
 24984       TO DFHEIV11
 24985*    MOVE '."C                   (   #00021003' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 461
* EL6311.cbl
 24986     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24987     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24988     MOVE X'2020233030303231303033' TO DFHEIV0(25:11)
 24989     CALL 'kxdfhei1' USING DFHEIV0,
 24990           DFHEIV1,
 24991           SECURITY-MESSAGE,
 24992           DFHEIV11,
 24993           DFHEIV99,
 24994           DFHEIV99,
 24995           DFHEIV99,
 24996           DFHEIV99
 24997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24998
 24999
 25000******************************************************************
 25001
 25002
 25003 9999-DFHBACK SECTION.
 25004     MOVE '9%                    "   ' TO DFHEIV0
 25005     MOVE 'EL6311' TO DFHEIV1
 25006     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25007     GOBACK.
 25008 9999-DFHEXIT.
 25009     IF DFHEIGDJ EQUAL 0001
 25010         NEXT SENTENCE
 25011     ELSE IF DFHEIGDJ EQUAL 2
 25012         GO TO 9600-PGMID-ERROR,
 25013               9990-ABEND,
 25014               9990-ABEND,
 25015               0010-MAIN-LOGIC
 25016         DEPENDING ON DFHEIGDI
 25017     ELSE IF DFHEIGDJ EQUAL 3
 25018         GO TO 1280-BATCH-HDR-NOT-FOUND
 25019         DEPENDING ON DFHEIGDI
 25020     ELSE IF DFHEIGDJ EQUAL 4
 25021         GO TO 1290-DUPLICATE-ALT-INDEX
 25022         DEPENDING ON DFHEIGDI
 25023     ELSE IF DFHEIGDJ EQUAL 5
 25024         GO TO 1295-CERT-TRL-REC-NOTFND
 25025         DEPENDING ON DFHEIGDI
 25026     ELSE IF DFHEIGDJ EQUAL 6
 25027         GO TO 1380-BATCH-HDR-NOT-FOUND
 25028         DEPENDING ON DFHEIGDI
 25029     ELSE IF DFHEIGDJ EQUAL 7
 25030         GO TO 1385-REC-NOT-FOUND
 25031         DEPENDING ON DFHEIGDI
 25032     ELSE IF DFHEIGDJ EQUAL 8
 25033         GO TO 1386-NOTFND
 25034         DEPENDING ON DFHEIGDI
 25035     ELSE IF DFHEIGDJ EQUAL 9
 25036         GO TO 1399-EXIT
 25037         DEPENDING ON DFHEIGDI
 25038     ELSE IF DFHEIGDJ EQUAL 10
 25039         GO TO 1480-BATCH-HDR-NOT-FOUND
 25040         DEPENDING ON DFHEIGDI
 25041     ELSE IF DFHEIGDJ EQUAL 11
 25042         GO TO 1490-RECORD-NOT-FOUND
 25043         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 462
* EL6311.cbl
 25044     ELSE IF DFHEIGDJ EQUAL 12
 25045         GO TO 1405-DELETE-CERTIFICATE
 25046         DEPENDING ON DFHEIGDI
 25047     ELSE IF DFHEIGDJ EQUAL 13
 25048         GO TO 1420-CONTINUE-DELETE
 25049         DEPENDING ON DFHEIGDI
 25050     ELSE IF DFHEIGDJ EQUAL 14
 25051         GO TO 1406-DELETE-ERNOTE
 25052         DEPENDING ON DFHEIGDI
 25053     ELSE IF DFHEIGDJ EQUAL 15
 25054         GO TO 1407-DELETE-MAILING
 25055         DEPENDING ON DFHEIGDI
 25056     ELSE IF DFHEIGDJ EQUAL 16
 25057         GO TO 1420-CONTINUE-DELETE
 25058         DEPENDING ON DFHEIGDI
 25059     ELSE IF DFHEIGDJ EQUAL 17
 25060         GO TO 1480-BATCH-HDR-NOT-FOUND
 25061         DEPENDING ON DFHEIGDI
 25062     ELSE IF DFHEIGDJ EQUAL 18
 25063         GO TO 1475-DELETE-FINISHED
 25064         DEPENDING ON DFHEIGDI
 25065     ELSE IF DFHEIGDJ EQUAL 19
 25066         GO TO 2280-BATCH-HDR-NOT-FOUND
 25067         DEPENDING ON DFHEIGDI
 25068     ELSE IF DFHEIGDJ EQUAL 20
 25069         GO TO 2290-DUPLICATE-ALT-INDEX
 25070         DEPENDING ON DFHEIGDI
 25071     ELSE IF DFHEIGDJ EQUAL 21
 25072         GO TO 2380-BATCH-HDR-NOT-FOUND
 25073         DEPENDING ON DFHEIGDI
 25074     ELSE IF DFHEIGDJ EQUAL 22
 25075         GO TO 2385-REC-NOT-FOUND
 25076         DEPENDING ON DFHEIGDI
 25077     ELSE IF DFHEIGDJ EQUAL 23
 25078         GO TO 2380-BATCH-HDR-NOT-FOUND
 25079         DEPENDING ON DFHEIGDI
 25080     ELSE IF DFHEIGDJ EQUAL 24
 25081         GO TO 2485-BATCH-HDR-NOT-FOUND
 25082         DEPENDING ON DFHEIGDI
 25083     ELSE IF DFHEIGDJ EQUAL 25
 25084         GO TO 2490-RECORD-NOT-FOUND
 25085         DEPENDING ON DFHEIGDI
 25086     ELSE IF DFHEIGDJ EQUAL 26
 25087         GO TO 2475-CONTINUE-DELETE
 25088         DEPENDING ON DFHEIGDI
 25089     ELSE IF DFHEIGDJ EQUAL 27
 25090         GO TO 2485-BATCH-HDR-NOT-FOUND
 25091         DEPENDING ON DFHEIGDI
 25092     ELSE IF DFHEIGDJ EQUAL 28
 25093         GO TO 2480-DELETE-FINISHED
 25094         DEPENDING ON DFHEIGDI
 25095     ELSE IF DFHEIGDJ EQUAL 29
 25096         GO TO 2920-PROCESS-REWRITE
 25097         DEPENDING ON DFHEIGDI
 25098     ELSE IF DFHEIGDJ EQUAL 30
 25099         GO TO 2985-RECORD-MISSING
 25100         DEPENDING ON DFHEIGDI
 25101     ELSE IF DFHEIGDJ EQUAL 31
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 463
* EL6311.cbl
 25102         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 25103         DEPENDING ON DFHEIGDI
 25104     ELSE IF DFHEIGDJ EQUAL 32
 25105         GO TO 2990-DUPLICATE-RECORD
 25106         DEPENDING ON DFHEIGDI
 25107     ELSE IF DFHEIGDJ EQUAL 33
 25108         GO TO 3590-NOT-FOUND
 25109         DEPENDING ON DFHEIGDI
 25110     ELSE IF DFHEIGDJ EQUAL 34
 25111         GO TO 3690-NOT-FOUND
 25112         DEPENDING ON DFHEIGDI
 25113     ELSE IF DFHEIGDJ EQUAL 35
 25114         GO TO 3990-NOT-FOUND
 25115         DEPENDING ON DFHEIGDI
 25116     ELSE IF DFHEIGDJ EQUAL 36
 25117         GO TO 4050-END-RECORDS,
 25118               4050-END-RECORDS
 25119         DEPENDING ON DFHEIGDI
 25120     ELSE IF DFHEIGDJ EQUAL 37
 25121         GO TO 4150-END-BATCH
 25122         DEPENDING ON DFHEIGDI
 25123     ELSE IF DFHEIGDJ EQUAL 38
 25124         GO TO 4150-END-BATCH
 25125         DEPENDING ON DFHEIGDI
 25126     ELSE IF DFHEIGDJ EQUAL 39
 25127         GO TO 4250-END-RECORDS,
 25128               4250-END-RECORDS
 25129         DEPENDING ON DFHEIGDI
 25130     ELSE IF DFHEIGDJ EQUAL 40
 25131         GO TO 4350-END-BATCH,
 25132               4350-END-BATCH
 25133         DEPENDING ON DFHEIGDI
 25134     ELSE IF DFHEIGDJ EQUAL 41
 25135         GO TO 4570-NOT-FOUND,
 25136               4550-END-RECORDS
 25137         DEPENDING ON DFHEIGDI
 25138     ELSE IF DFHEIGDJ EQUAL 42
 25139         GO TO 4680-NOT-FOUND,
 25140               4680-NOT-FOUND
 25141         DEPENDING ON DFHEIGDI
 25142     ELSE IF DFHEIGDJ EQUAL 43
 25143         GO TO 4860-NOT-FOUND,
 25144               4850-END-RECORDS
 25145         DEPENDING ON DFHEIGDI
 25146     ELSE IF DFHEIGDJ EQUAL 44
 25147         GO TO 4970-NOT-FOUND,
 25148               4950-END-RECORDS
 25149         DEPENDING ON DFHEIGDI
 25150     ELSE IF DFHEIGDJ EQUAL 45
 25151         GO TO 5050-NOT-FOUND
 25152         DEPENDING ON DFHEIGDI
 25153     ELSE IF DFHEIGDJ EQUAL 46
 25154         GO TO 5050-NOT-FOUND
 25155         DEPENDING ON DFHEIGDI
 25156     ELSE IF DFHEIGDJ EQUAL 47
 25157         GO TO 5050-NOT-FOUND
 25158         DEPENDING ON DFHEIGDI
 25159     ELSE IF DFHEIGDJ EQUAL 48
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page 464
* EL6311.cbl
 25160         GO TO 5550-END-RECORDS,
 25161               5550-END-RECORDS
 25162         DEPENDING ON DFHEIGDI
 25163     ELSE IF DFHEIGDJ EQUAL 49
 25164         GO TO 6050-QID-ERROR
 25165         DEPENDING ON DFHEIGDI
 25166     ELSE IF DFHEIGDJ EQUAL 50
 25167         GO TO 6050-QID-ERROR
 25168         DEPENDING ON DFHEIGDI
 25169     ELSE IF DFHEIGDJ EQUAL 51
 25170         GO TO 6400-CONTINUE,
 25171               6400-CONTINUE
 25172         DEPENDING ON DFHEIGDI
 25173     ELSE IF DFHEIGDJ EQUAL 52
 25174         GO TO 3690-NOT-FOUND
 25175         DEPENDING ON DFHEIGDI
 25176     ELSE IF DFHEIGDJ EQUAL 53
 25177         GO TO 7399-EXIT
 25178         DEPENDING ON DFHEIGDI
 25179     ELSE IF DFHEIGDJ EQUAL 54
 25180         GO TO 7550-OFFICER-NOTFND
 25181         DEPENDING ON DFHEIGDI
 25182     ELSE IF DFHEIGDJ EQUAL 55
 25183         GO TO 8300-SEND-TEXT
 25184         DEPENDING ON DFHEIGDI.
 25185     MOVE '9%                    "   ' TO DFHEIV0
 25186     MOVE 'EL6311' TO DFHEIV1
 25187     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25188     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       16636     Code:       99285
