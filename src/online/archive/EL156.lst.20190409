* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59* 110515  IR2015103000001  TANA  Check app level for 3550 message
    60* 120115  CR2015082700002  PEMA  ADD JNT BORROWER PROCESSING
    61* 012016  IR2016011800003  PEMA  FIXED LENGTH OF PAYEE NAME
    62* 050616  CR2015030200004  TANA  Additional pmt Pd thru exp date
    63* 013017  CR2016053100001  PEMA  ACH PROCESSING
    64* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    65* 102617    2017101800003  TANA  Fix family leave auth level
    66* 022718    2017100200004  TANA  Set hold & pays > than 30 days
    67* 031218    2018030800002  TANA  Handle offline pmts w/ hold & pay
    68* 082218  CR2018051400001  TANA  Hold and Pay
    69* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    70* 112018  CR2018102900001  TANA  REQUIRE EOB NOTE STARTING WITH F
    71******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page   3
* EL156.cbl
    72
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page   4
* EL156.cbl
    74 ENVIRONMENT DIVISION.
    75
    76 DATA DIVISION.
    77
    78 WORKING-STORAGE SECTION.
    79 01  DFH-START PIC X(04).
    80
    81 77  FILLER  PIC X(32)  VALUE '********************************'.
    82 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    83 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    84 77  WS-SSN  PIC X(9) VALUE ZEROS.
    85 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    86 77  C0                          PIC S999 COMP-3 VALUE +0.
    87 77  C1                          PIC S999 COMP-3 VALUE +0.
    88 77  C2                          PIC S999 COMP-3 VALUE +0.
    89 77  C3                          PIC S999 COMP-3 VALUE +0.
    90 77  s1                          PIC S999 COMP-3 VALUE +0.
    91 77  s2                          pic s999 comp-3 value +0.
    92 77  P1                          PIC S999 COMP-3 VALUE +0.
    93 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    94 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    95 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    96 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    97 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    98 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    99 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   100 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   101 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
   102 77  ws-max-bens                 pic s999 comp-3 value +0.
   103 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
   104 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
   105 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
   106 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
   107 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
   108 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
   109
   110*    COPY ELCSCTM.
   111******************************************************************
   112*                                                                *
   113*                                                                *
   114*                            ELCSCTM                             *
   115*                            VMOD=2.001                          *
   116*                                                                *
   117*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   118*                                                                *
   119******************************************************************
   120 01  SECURITY-MESSAGE.
   121     12  FILLER                          PIC X(30)
   122            VALUE '** LOGIC SECURITY VIOLATION -'.
   123     12  SM-READ                         PIC X(6).
   124     12  FILLER                          PIC X(5)
   125            VALUE ' PGM='.
   126     12  SM-PGM                          PIC X(6).
   127     12  FILLER                          PIC X(5)
   128            VALUE ' OPR='.
   129     12  SM-PROCESSOR-ID                 PIC X(4).
   130     12  FILLER                          PIC X(6)
   131            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page   5
* EL156.cbl
   132     12  SM-TERMID                       PIC X(4).
   133     12  FILLER                          PIC XX   VALUE SPACE.
   134     12  SM-JUL-DATE                     PIC 9(5).
   135     12  FILLER                          PIC X    VALUE SPACE.
   136     12  SM-TIME                         PIC 99.99.
   137
   138
   139*    COPY ELCSCRTY.
   140******************************************************************
   141*                                                                *
   142*                                                                *
   143*                            ELCSCRTY                            *
   144*                            VMOD=2.001                          *
   145*                                                                *
   146*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   147*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   148*        SAVED IN PI-SECURITY-ADDRESS.                           *
   149*                                                                *
   150******************************************************************
   151 01  SECURITY-CONTROL.
   152     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   153     12  FILLER                       PIC XX    VALUE 'SC'.
   154     12  SC-CREDIT-CODES.
   155         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   156             20  SC-CREDIT-DISPLAY    PIC X.
   157             20  SC-CREDIT-UPDATE     PIC X.
   158     12  SC-CLAIMS-CODES.
   159         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   160             20  SC-CLAIMS-DISPLAY    PIC X.
   161             20  SC-CLAIMS-UPDATE     PIC X.
   162
   163 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   164 01  WS-DATE-AREA.
   165     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   166     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   167     12  SAVE-DATE-CCYYMMDD.
   168         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   169         16  SAVE-DATE-YMD.
   170             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   171             20  FILLER              PIC X(04)   VALUE SPACES.
   172
   173 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   174 01  STANDARD-AREAS.
   175     12  WS-RESPONSE         PIC S9(8)   COMP.
   176         88  WS-RESP-NORMAL              VALUE +00.
   177         88  WS-RESP-ERROR               VALUE +01.
   178         88  WS-RESP-NOTFND              VALUE +13.
   179         88  WS-RESP-DUPREC              VALUE +14.
   180         88  WS-RESP-ENDFILE             VALUE +20.
   181     12  PMT-HEAD-A.
   182         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   183         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   184         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   185-        '     RESERVES  TYPE    AMOUNT'.
   186     12  PMT-HEAD-B.
   187         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   188         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   189         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page   6
* EL156.cbl
   190     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   191     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   192     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   193     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   194     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   195     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   196     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   197     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   198     12  PGM-NAME            PIC X(8).
   199     12  TIME-IN             PIC S9(7).
   200     12  TIME-OUT-R  REDEFINES TIME-IN.
   201         16  FILLER          PIC X.
   202         16  TIME-OUT        PIC 99V99.
   203         16  FILLER          PIC XX.
   204     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   205     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   206     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   207     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   208     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   209     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   210     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   211     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   212     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   213     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   214     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   215     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   216     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   217     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   218     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   219     12  WS-BLANK            PIC X       VALUE ' '.
   220
   221 01  MISC-WORK-AREAS.
   222     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   223     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   224     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   225     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   226     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   227     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   228     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   229     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   230     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   231     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   232     12  W-CALLED-NAME           PIC X(08).
   233     12  W-EOB-CODES.
   234         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   235             20  W-EOB-CODE      PIC XXX.
   236             20  W-EOB-FILLER    PIC X.
   237     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   238     12  W-NAME-LAST             PIC X(15).
   239     12  W-NAME-FIRST            PIC X(15).
   240     12  W-NAME-MIDDLE.
   241         16  FILLER              PIC X.
   242         16  W-NAME-MIDDLE-2     PIC X.
   243         16  FILLER              PIC X(13).
   244     12  W-DMD-CHECK-NO.
   245         16  W-DMD-CHECK-NO-1    PIC X(4).
   246         16  W-DMD-CHECK-NO-2    PIC X.
   247         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page   7
* EL156.cbl
   248
   249     12  WS-COMPUTE-FROM-DT  PIC XX.
   250     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   251     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   252     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   253     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   254     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   255     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   256         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   257         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   258     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   259         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   260     12  WS-UPDATE-SW        PIC X VALUE ' '.
   261     12  WS-GROUPING.
   262         16  WS-GROUP-1      PIC X VALUE SPACES.
   263         16  FILLER          PIC X(05) VALUE SPACES.
   264     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   265     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   266     12  WS-WORK-STATE-ACCT.
   267         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   268         16  FILLER          PIC X       VALUE '/'.
   269         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   270     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   271     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   272     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   273     12  QID.
   274         16  QID-TERM        PIC X(4)    VALUE SPACES.
   275         16  FILLER          PIC X(4)    VALUE '156A'.
   276     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   277     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   278     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   279     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   280     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   281     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   282     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   283     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   284     12  WS-STATUS           PIC X       VALUE SPACES.
   285     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   286     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   287     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   288     12  ws-extended-exp-dt  pic xx      value low-values.
   289     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   290     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   291     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   292     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   293     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   294     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   295     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   296     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   297     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   298     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   299     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   300     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   301     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   302     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   303     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   304     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   305     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page   8
* EL156.cbl
   306     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   307     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   308     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   309     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   310     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   311     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   312     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   313     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   314     12  WORK-DATE-FROM.
   315         16  WDF-MONTH       PIC 99        VALUE ZERO.
   316         16  WDF-DAY         PIC 99        VALUE ZERO.
   317         16  WDF-YEAR        PIC 99        VALUE ZERO.
   318     12  WORK-DATE-THRU.
   319         16  WDT-MONTH       PIC 99        VALUE ZERO.
   320         16  WDT-DAY         PIC 99        VALUE ZERO.
   321         16  WDT-YEAR        PIC 99        VALUE ZERO.
   322     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   323     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   324     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   325     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   326     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   327     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   328     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   329     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   330     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   331     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   332     12  WS-PY-WK REDEFINES WS-PY-WORK.
   333         16  WS-PY-NUM       PIC S9(7)V99.
   334         16  WS-PY-SIGN      PIC X.
   335     12  WS-DY-WORK          PIC S9(5).
   336     12  WS-DY-WK REDEFINES WS-DY-WORK.
   337         16  WS-DY-NUM       PIC S9(4).
   338         16  WS-DY-SIGN      PIC X.
   339     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   340         88  COMP-REC-FOUND              VALUE 'Y'.
   341     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   342         88  BENEFIT-FOUND       VALUE 'Y'.
   343         88  NO-BENEFIT-FOUND    VALUE 'N'.
   344     12  WS-TERMS.
   345         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   346         16  FILLER          PIC X       VALUE '/'.
   347         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   348         16  WST-REM-DAYS-GRP.
   349             20  WST-SLASH   PIC X       VALUE '/'.
   350             20  WST-REM-DAYS
   351                             PIC --9.
   352     12  WS-ACCESS.
   353         16  FILLER          PIC XX      VALUE SPACES.
   354         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   355     12  WS-STATE-ACCESS.
   356         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   357         16  FILLER          PIC XX      VALUE SPACES.
   358     12  WS-CARR-ACCESS.
   359         16  FILLER          PIC X(3)    VALUE SPACES.
   360         16  WS-CARR         PIC X       VALUE SPACES.
   361     12  DATE-WORK.
   362         16  FILLER          PIC XX      VALUE SPACES.
   363         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page   9
* EL156.cbl
   364     12  WS-SAVE-INPUT.
   365         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   366         16  WS-PAYEE        PIC XX      VALUE SPACE.
   367         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   368         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   369         16  WS-OFFLINE      PIC X       VALUE SPACE.
   370         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   371         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   372         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   373         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   374         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   375         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   376         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   377         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   378         16  WS-ETYPE        PIC X       VALUE SPACE.
   379         16  WS-CASH         PIC X       VALUE SPACE.
   380         16  WS-GROUPED      PIC X       VALUE SPACE.
   381         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   382         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   383         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   384         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   385         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   386         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   387         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   388         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   389         16  ws-int-to-rem-borr pic x value spaces.
   390     12  LAST-ERROR-LINE.
   391         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   392         16  FILLER              PIC X(30)
   393             VALUE ' FATAL ERRORS ENCOUNTERED'.
   394         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   395         16  FILLER              PIC X(28)
   396             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   397     12  WS-CHECK-AREA.
   398         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   399         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   400     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   401     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   402         16  FILLER              PIC XX.
   403         16  WS-A-CHECK-NUM-5    PIC 9(5).
   404     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   405         16  FILLER              PIC X.
   406         16  WS-A-CHECK-NUM-6    PIC 9(6).
   407     12  OPTION-1-SAVE-AREA.
   408         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   409         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   410     12  WS-WORK-ZIP.
   411         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   412         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   413     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   414                                 PIC 9(9).
   415     12  WS-FLI-PMTNOTE.
   416         16  WS-PMTOPTION        PIC XX.
   417         16  WS-DOCNAME          PIC X(28).
   418         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   419             20  WS-AMOUNT       PIC X(8).
   420             20  FILLER          PIC X(20).
   421         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  10
* EL156.cbl
   422             20  WS-NUM-AMT      PIC 9(6)V99.
   423             20  FILLER          PIC X(20).
   424
   425     12  WS-HAN-PMTNOTE.
   426         16  WS-HAN-PMT-CODE     PIC X.
   427         16  WS-HAN-PMT-NOTE     PIC X(39).
   428
   429     12  WS-NCL-PMT-OPTION       PIC XX.
   430         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   431
   432     12  WS-CLAIM-SEQUENCE.
   433         16  FILLER              PIC X VALUE '('.
   434         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   435         16  FILLER              PIC X(04) VALUE ' OF '.
   436         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   437         16  FILLER              PIC X VALUE ')'.
   438
   439     12  WS-REFUND-AMT           PIC Z(7).99.
   440     12  WS-CALC-INT             PIC S9(7)V99.
   441     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   442
   443     12  SUB                     PIC 99 VALUE ZEROS.
   444
   445     12  WS-BOANOTE1.
   446         16  WS-BOANOTE1-DESC    PIC X(11).
   447         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   448         16  FILLER              PIC X(17).
   449     12  WS-BOANOTE2.
   450         16  WS-BOANOTE2-DESC    PIC X(11).
   451         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   452         16  FILLER              PIC X(17).
   453
   454     12  WS-NCLNOTE1.
   455         16  WS-NCLNOTE1-DESC    PIC X(11).
   456         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   457         16  FILLER              PIC X(17).
   458     12  WS-NCLNOTE2.
   459         16  WS-NCLNOTE2-DESC    PIC X(11).
   460         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   461         16  FILLER              PIC X(17).
   462
   463     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   464     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   465     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   466     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   467     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   468     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   469     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   470     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   471     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   472     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   473
   474     12  WS-AIG-WORK-AREAS.
   475         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   476             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   477         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   478             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   479         16  WS-FROM-DATE-MDY.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  11
* EL156.cbl
   480             20  WS-FROM-MO      PIC 99.
   481             20  WS-FROM-DA      PIC 99.
   482             20  WS-FROM-YR      PIC 99.
   483         16  WS-TEMP-DATE-MDY.
   484             20  WS-TEMP-MO      PIC 99.
   485             20  WS-TEMP-DA      PIC 99.
   486             20  WS-TEMP-YR      PIC 99.
   487         16  WS-BIN-FROM-DT      PIC XX.
   488         16  WS-TEMP-INC-MDY.
   489             20  WS-TEMP-INC-MO  PIC 99.
   490             20  WS-TEMP-INC-DA  PIC 99.
   491             20  WS-TEMP-INC-YR  PIC 99.
   492         16  WS-PMT-DUE-MDY.
   493             20  WS-PMT-DUE-MO   PIC 99.
   494             20  WS-PMT-DUE-DA   PIC 99.
   495             20  WS-PMT-DUE-YR   PIC 99.
   496         16  WS-PMT-DUE-DT       PIC XX.
   497         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   498         16  WS-RETRO-ELIM-DT    PIC XX.
   499         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   500             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   501         16  WS-SAVE-DUE-DA      PIC 99.
   502         16  WS-CDAYS            PIC S9(05).
   503         16  WS-DAYS-OFF         PIC S9(05).
   504         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   505             88  ELIM-SATISFIED            VALUE 'Y'.
   506         16  WS-AIG-CHECKNO.
   507             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   508             20  WS-A-CHECKNO-3-7.
   509                 24  FILLER              PIC X(3)    VALUE SPACES.
   510                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   511                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   512         16  WS-AIG-GROUPING.
   513             20  WS-A-BENE               PIC XXX.
   514             20  FILLER                  PIC XXX.
   515         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   516             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   517             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   518         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   519                 VALUE 'UNEMPLOYMENT PAYMENT'.
   520         16  WS-CHK-THRU-DT              PIC XX.
   521         16  WS-HOLD-BIN-DATE-1          PIC XX.
   522
   523 01  MISC-CSO-AREA.
   524     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   525     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   526     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   527         88  APPROVAL-NEEDED                        VALUE 'Y'.
   528     12  WS-APPROV-NOTE                  PIC X(43)
   529         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   530     12  WS-3550-APPROV-NOTE             PIC X(43)
   531         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   532     12  WS-REAUDIT-NOTE                 PIC X(43)
   533         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   534     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   535     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   536     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   537     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  12
* EL156.cbl
   538     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   539     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   540     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   541         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   542     12  WS-PAYEE-CITY-STATE     PIC X(30).
   543     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   544         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   545     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   546     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   547     12  WS-WORK-NAME            PIC X(30).
   548     12  FILLER  REDEFINES WS-WORK-NAME.
   549         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   550     12  WS-INSURED-NAME         PIC X(30).
   551     12  FILLER  REDEFINES WS-INSURED-NAME.
   552         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   553     12  WS-PAYEE-NAME           PIC X(30).
   554     12  FILLER  REDEFINES WS-PAYEE-NAME.
   555         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   556     12  WS-HOLD-UNTIL-SW        PIC X VALUE SPACES.
   557         88  HOLD-UNTIL-CHK            VALUE 'Y'.
   558         88  HOLD-UNTIL-PMT            VALUE 'P'.
   559     12  WS-HOLD-UNTIL-DT        PIC X(02) VALUE ZERO.
   560
   561 01  ERROR-MESSAGES.
   562     12  ER-0000                 PIC X(4)  VALUE '0000'.
   563     12  ER-0004                 PIC X(4)  VALUE '0004'.
   564     12  ER-0008                 PIC X(4)  VALUE '0008'.
   565     12  ER-0019                 PIC X(4)  VALUE '0019'.
   566     12  ER-0029                 PIC X(4)  VALUE '0029'.
   567     12  ER-0042                 PIC X(4)  VALUE '0042'.
   568     12  ER-0070                 PIC X(4)  VALUE '0070'.
   569     12  ER-0130                 PIC X(4)  VALUE '0130'.
   570     12  ER-0149                 PIC X(4)  VALUE '0149'.
   571     12  ER-0154                 PIC X(4)  VALUE '0154'.
   572     12  ER-0168                 PIC X(4)  VALUE '0168'.
   573     12  ER-0169                 PIC X(4)  VALUE '0169'.
   574     12  ER-0172                 PIC X(4)  VALUE '0174'.
   575     12  ER-0198                 PIC X(4)  VALUE '0198'.
   576     12  ER-0204                 PIC X(4)  VALUE '0204'.
   577     12  ER-0206                 PIC X(4)  VALUE '0206'.
   578     12  ER-0252                 PIC X(4)  VALUE '0252'.
   579     12  ER-0254                 PIC X(4)  VALUE '0254'.
   580     12  ER-0282                 PIC X(4)  VALUE '0282'.
   581     12  ER-0283                 PIC X(4)  VALUE '0283'.
   582     12  ER-0294                 PIC X(4)  VALUE '0294'.
   583     12  ER-0338                 PIC X(4)  VALUE '0338'.
   584     12  ER-0419                 PIC X(4)  VALUE '0419'.
   585     12  ER-0420                 PIC X(4)  VALUE '0420'.
   586     12  ER-0421                 PIC X(4)  VALUE '0421'.
   587     12  ER-0422                 PIC X(4)  VALUE '0422'.
   588     12  ER-0433                 PIC X(4)  VALUE '0433'.
   589     12  ER-0436                 PIC X(4)  VALUE '0436'.
   590     12  ER-0437                 PIC X(4)  VALUE '0437'.
   591     12  ER-0438                 PIC X(4)  VALUE '0438'.
   592     12  ER-0439                 PIC X(4)  VALUE '0439'.
   593     12  ER-0440                 PIC X(4)  VALUE '0440'.
   594     12  ER-0441                 PIC X(4)  VALUE '0441'.
   595     12  ER-0442                 PIC X(4)  VALUE '0442'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  13
* EL156.cbl
   596     12  ER-0443                 PIC X(4)  VALUE '0443'.
   597     12  ER-0444                 PIC X(4)  VALUE '0444'.
   598     12  ER-0445                 PIC X(4)  VALUE '0445'.
   599     12  ER-0446                 PIC X(4)  VALUE '0446'.
   600     12  ER-0447                 PIC X(4)  VALUE '0447'.
   601     12  ER-0448                 PIC X(4)  VALUE '0448'.
   602     12  ER-0449                 PIC X(4)  VALUE '0449'.
   603     12  ER-0452                 PIC X(4)  VALUE '0452'.
   604     12  ER-0458                 PIC X(4)  VALUE '0458'.
   605     12  ER-0459                 PIC X(4)  VALUE '0459'.
   606     12  ER-0460                 PIC X(4)  VALUE '0460'.
   607     12  ER-0461                 PIC X(4)  VALUE '0461'.
   608     12  ER-0462                 PIC X(4)  VALUE '0462'.
   609     12  ER-0463                 PIC X(4)  VALUE '0463'.
   610     12  ER-0464                 PIC X(4)  VALUE '0464'.
   611     12  ER-0465                 PIC X(4)  VALUE '0465'.
   612     12  ER-0466                 PIC X(4)  VALUE '0466'.
   613     12  ER-0467                 PIC X(4)  VALUE '0467'.
   614     12  ER-0468                 PIC X(4)  VALUE '0468'.
   615     12  ER-0469                 PIC X(4)  VALUE '0469'.
   616     12  ER-0473                 PIC X(4)  VALUE '0473'.
   617     12  ER-0474                 PIC X(4)  VALUE '0474'.
   618     12  ER-0475                 PIC X(4)  VALUE '0475'.
   619     12  ER-0476                 PIC X(4)  VALUE '0476'.
   620     12  ER-0477                 PIC X(4)  VALUE '0477'.
   621     12  ER-0478                 PIC X(4)  VALUE '0478'.
   622     12  ER-0479                 PIC X(4)  VALUE '0479'.
   623     12  ER-0481                 PIC X(4)  VALUE '0481'.
   624     12  ER-0491                 PIC X(4)  VALUE '0491'.
   625     12  ER-0492                 PIC X(4)  VALUE '0492'.
   626     12  ER-0493                 PIC X(4)  VALUE '0493'.
   627     12  ER-0494                 PIC X(4)  VALUE '0494'.
   628     12  ER-0495                 PIC X(4)  VALUE '0495'.
   629     12  ER-0499                 PIC X(4)  VALUE '0499'.
   630     12  ER-0500                 PIC X(4)  VALUE '0500'.
   631     12  ER-0501                 PIC X(4)  VALUE '0501'.
   632     12  ER-0502                 PIC X(4)  VALUE '0502'.
   633     12  ER-0508                 PIC X(4)  VALUE '0508'.
   634     12  ER-0513                 PIC X(4)  VALUE '0513'.
   635     12  ER-0518                 PIC X(4)  VALUE '0518'.
   636     12  ER-0524                 PIC X(4)  VALUE '0524'.
   637     12  ER-0525                 PIC X(4)  VALUE '0525'.
   638     12  ER-0526                 PIC X(4)  VALUE '0526'.
   639     12  ER-0530                 PIC X(4)  VALUE '0530'.
   640     12  ER-0540                 PIC X(4)  VALUE '0540'.
   641     12  ER-0541                 PIC X(4)  VALUE '0541'.
   642     12  ER-0542                 PIC X(4)  VALUE '0542'.
   643     12  ER-0543                 PIC X(4)  VALUE '0543'.
   644     12  ER-0545                 PIC X(4)  VALUE '0545'.
   645     12  ER-0552                 PIC X(4)  VALUE '0552'.
   646     12  ER-0555                 PIC X(4)  VALUE '0555'.
   647     12  ER-0556                 PIC X(4)  VALUE '0556'.
   648     12  ER-0557                 PIC X(4)  VALUE '0557'.
   649     12  ER-0572                 PIC X(4)  VALUE '0572'.
   650     12  ER-0573                 PIC X(4)  VALUE '0573'.
   651     12  ER-0594                 PIC X(4)  VALUE '0594'.
   652     12  ER-0616                 PIC X(4)  VALUE '0616'.
   653     12  ER-0617                 PIC X(4)  VALUE '0617'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  14
* EL156.cbl
   654     12  ER-0618                 PIC X(4)  VALUE '0618'.
   655     12  ER-0657                 PIC X(4)  VALUE '0657'.
   656     12  ER-0658                 PIC X(4)  VALUE '0658'.
   657     12  ER-0699                 PIC X(4)  VALUE '0699'.
   658     12  ER-0730                 PIC X(4)  VALUE '0730'.
   659     12  ER-0737                 PIC X(4)  VALUE '0737'.
   660     12  ER-0760                 PIC X(4)  VALUE '0760'.
   661     12  ER-0768                 PIC X(4)  VALUE '0768'.
   662     12  ER-0769                 PIC X(4)  VALUE '0769'.
   663     12  ER-0770                 PIC X(4)  VALUE '0770'.
   664     12  ER-0802                 PIC X(4)  VALUE '0802'.
   665     12  ER-0803                 PIC X(4)  VALUE '0803'.
   666     12  ER-0819                 PIC X(4)  VALUE '0819'.
   667     12  ER-0834                 PIC X(4)  VALUE '0834'.
   668     12  ER-0836                 PIC X(4)  VALUE '0836'.
   669     12  ER-0844                 PIC X(4)  VALUE '0844'.
   670     12  ER-0845                 PIC X(4)  VALUE '0845'.
   671     12  ER-0846                 PIC X(4)  VALUE '0846'.
   672     12  ER-0849                 PIC X(4)  VALUE '0849'.
   673     12  ER-0851                 PIC X(4)  VALUE '0851'.
   674     12  ER-0872                 PIC X(4)  VALUE '0872'.
   675     12  ER-0873                 PIC X(4)  VALUE '0873'.
   676     12  ER-0874                 PIC X(4)  VALUE '0874'.
   677     12  ER-0879                 PIC X(4)  VALUE '0879'.
   678     12  ER-0919                 PIC X(4)  VALUE '0919'.
   679     12  ER-0921                 PIC X(4)  VALUE '0921'.
   680     12  ER-0923                 PIC X(4)  VALUE '0923'.
   681     12  ER-0925                 PIC X(4)  VALUE '0925'.
   682     12  ER-0944                 PIC X(4)  VALUE '0944'.
   683     12  ER-0945                 PIC X(4)  VALUE '0945'.
   684     12  ER-0946                 PIC X(4)  VALUE '0946'.
   685     12  ER-0947                 PIC X(4)  VALUE '0947'.
   686     12  ER-0948                 PIC X(4)  VALUE '0948'.
   687     12  ER-0949                 PIC X(4)  VALUE '0949'.
   688     12  ER-0950                 PIC X(4)  VALUE '0950'.
   689     12  ER-0951                 PIC X(4)  VALUE '0951'.
   690     12  ER-0954                 PIC X(4)  VALUE '0954'.
   691     12  ER-0956                 PIC X(4)  VALUE '0956'.
   692     12  ER-0967                 PIC X(4)  VALUE '0967'.
   693     12  ER-0968                 PIC X(4)  VALUE '0968'.
   694     12  ER-0974                 PIC X(4)  VALUE '0974'.
   695     12  ER-0975                 PIC X(4)  VALUE '0975'.
   696     12  ER-1561                 PIC X(4)  VALUE '1561'.
   697     12  ER-1566                 PIC X(4)  VALUE '1566'.
   698     12  ER-1567                 PIC X(4)  VALUE '1567'.
   699     12  ER-1569                 PIC X(4)  VALUE '1569'.
   700     12  er-1582                 pic x(4)  value '1582'.
   701     12  er-1657                 pic x(4)  value '1657'.
   702     12  er-1658                 pic x(4)  value '1658'.
   703     12  er-1667                 pic x(4)  value '1667'.
   704     12  er-1670                 pic x(4)  value '1670'.
   705     12  er-1671                 pic x(4)  value '1671'.
   706     12  er-1672                 pic x(4)  value '1672'.
   707     12  er-1673                 pic x(4)  value '1673'.
   708     12  er-1674                 pic x(4)  value '1674'.
   709     12  er-1677                 pic x(4)  value '1677'.
   710     12  ER-1775                 PIC X(4)  VALUE '1775'.
   711     12  ER-1880                 PIC X(4)  VALUE '1880'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  15
* EL156.cbl
   712     12  ER-1930                 PIC X(4)  VALUE '1930'.
   713     12  ER-2044                 PIC X(4)  VALUE '2044'.
   714     12  ER-3140                 PIC X(4)  VALUE '3140'.
   715     12  ER-3141                 PIC X(4)  VALUE '3141'.
   716     12  ER-3255                 PIC X(4)  VALUE '3255'.
   717     12  ER-3272                 PIC X(4)  VALUE '3272'.
   718     12  ER-3516                 PIC X(4)  VALUE '3516'.
   719     12  ER-3527                 PIC X(4)  VALUE '3527'.
   720     12  ER-3528                 PIC X(4)  VALUE '3528'.
   721     12  ER-3529                 PIC X(4)  VALUE '3529'.
   722     12  ER-3530                 PIC X(4)  VALUE '3530'.
   723     12  ER-3531                 PIC X(4)  VALUE '3531'.
   724     12  ER-3532                 PIC X(4)  VALUE '3532'.
   725     12  ER-3533                 PIC X(4)  VALUE '3533'.
   726     12  ER-3534                 PIC X(4)  VALUE '3534'.
   727     12  ER-3535                 PIC X(4)  VALUE '3535'.
   728     12  ER-3536                 PIC X(4)  VALUE '3536'.
   729     12  ER-3537                 PIC X(4)  VALUE '3537'.
   730     12  ER-3538                 PIC X(4)  VALUE '3538'.
   731     12  ER-3539                 PIC X(4)  VALUE '3539'.
   732     12  ER-3540                 PIC X(4)  VALUE '3540'.
   733     12  ER-3541                 PIC X(4)  VALUE '3541'.
   734     12  ER-3542                 PIC X(4)  VALUE '3542'.
   735     12  ER-3543                 PIC X(4)  VALUE '3543'.
   736     12  ER-3546                 PIC X(4)  VALUE '3546'.
   737     12  ER-3549                 PIC X(4)  VALUE '3549'.
   738     12  ER-3551                 PIC X(4)  VALUE '3551'.
   739     12  ER-3818                 PIC X(4)  VALUE '3818'.
   740     12  ER-7540                 PIC X(4)  VALUE '7540'.
   741     12  ER-7576                 PIC X(4)  VALUE '7576'.
   742     12  ER-7579                 PIC X(4)  VALUE '7579'.
   743     12  ER-7580                 PIC X(4)  VALUE '7580'.
   744     12  ER-7583                 PIC X(4)  VALUE '7583'.
   745     12  ER-7585                 PIC X(4)  VALUE '7585'.
   746     12  ER-7830                 PIC X(4)  VALUE '7830'.
   747     12  ER-7831                 PIC X(4)  VALUE '7831'.
   748     12  ER-7832                 PIC X(4)  VALUE '7832'.
   749     12  ER-7833                 PIC X(4)  VALUE '7833'.
   750     12  ER-7834                 PIC X(4)  VALUE '7834'.
   751     12  ER-7835                 PIC X(4)  VALUE '7835'.
   752     12  ER-7836                 PIC X(4)  VALUE '7836'.
   753     12  ER-7837                 PIC X(4)  VALUE '7837'.
   754     12  ER-7838                 PIC X(4)  VALUE '7838'.
   755     12  ER-7841                 PIC X(4)  VALUE '7841'.
   756     12  ER-7844                 PIC X(4)  VALUE '7844'.
   757     12  ER-7845                 PIC X(4)  VALUE '7845'.
   758     12  ER-8000                 PIC X(4)  VALUE '8000'.
   759     12  ER-8051                 PIC X(4)  VALUE '8051'.
   760     12  ER-8052                 PIC X(4)  VALUE '8052'.
   761     12  ER-8053                 PIC X(4)  VALUE '8053'.
   762     12  ER-8054                 PIC X(4)  VALUE '8054'.
   763     12  ER-8055                 PIC X(4)  VALUE '8055'.
   764     12  ER-8056                 PIC X(4)  VALUE '8056'.
   765     12  ER-8057                 PIC X(4)  VALUE '8057'.
   766     12  ER-8058                 PIC X(4)  VALUE '8058'.
   767     12  ER-8059                 PIC X(4)  VALUE '8059'.
   768     12  ER-8060                 PIC X(4)  VALUE '8060'.
   769     12  ER-8061                 PIC X(4)  VALUE '8061'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  16
* EL156.cbl
   770     12  ER-8062                 PIC X(4)  VALUE '8062'.
   771     12  ER-8063                 PIC X(4)  VALUE '8063'.
   772     12  ER-8064                 PIC X(4)  VALUE '8064'.
   773     12  ER-8065                 PIC X(4)  VALUE '8065'.
   774     12  ER-8066                 PIC X(4)  VALUE '8066'.
   775     12  ER-8146                 PIC X(4)  VALUE '8146'.
   776     12  ER-8147                 PIC X(4)  VALUE '8147'.
   777     12  ER-8152                 PIC X(4)  VALUE '8152'.
   778     12  ER-8153                 PIC X(4)  VALUE '8153'.
   779     12  ER-8154                 PIC X(4)  VALUE '8154'.
   780     12  ER-8155                 PIC X(4)  VALUE '8155'.
   781     12  ER-8310                 PIC X(4)  VALUE '8310'.
   782     12  ER-8311                 PIC X(4)  VALUE '8311'.
   783     12  ER-8312                 PIC X(4)  VALUE '8312'.
   784     12  ER-8313                 PIC X(4)  VALUE '8313'.
   785     12  ER-8314                 PIC X(4)  VALUE '8314'.
   786     12  ER-8315                 PIC X(4)  VALUE '8315'.
   787     12  ER-8316                 PIC X(4)  VALUE '8316'.
   788     12  ER-8317                 PIC X(4)  VALUE '8317'.
   789
   790 01  CSO-WORK-FIELDS.
   791     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   792       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   793
   794     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   795     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   796         88  CERT-NOTE-ADDED           VALUE 'Y'.
   797     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   798         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   799     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   800
   801     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   802
   803 01  SC-NP6-CERT-NOTE.
   804     12  FILLER                  PIC X(12)
   805               VALUE 'REM BENEFIT '.
   806     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   807     12  SC-NP6-COMM             PIC X(8)
   808               VALUE ' + 6 MO '.
   809     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   810     12  FILLER                  PIC X(12)
   811               VALUE ' = AMT PAID '.
   812     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   813
   814 01  SC-NP6-ORIG-NOTE.
   815     12  FILLER                  PIC X(63)  VALUE
   816         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   817 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   818     88  PDEF-FOUND                   VALUE 'Y'.
   819 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   820     88  ACCT-FOUND                   VALUE 'Y'.
   821 01  CTBL-KEY-SAVE               PIC X(5).
   822 01  CTBL-KEY.
   823     05  CTBL-COMPANY-CD         PIC X.
   824     05  CTBL-TABLE              PIC XXX.
   825     05  CTBL-BEN-TYPE           PIC X.
   826     05  CTBL-BEN-CODE           PIC XX.
   827 01  ERPDEF-KEY-SAVE             PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  17
* EL156.cbl
   828 01  ERPDEF-KEY.
   829     12  ERPDEF-COMPANY-CD       PIC X.
   830     12  ERPDEF-STATE            PIC XX.
   831     12  ERPDEF-PROD-CD          PIC XXX.
   832     12  F                       PIC X(7).
   833     12  ERPDEF-BEN-TYPE         PIC X.
   834     12  ERPDEF-BEN-CODE         PIC XX.
   835     12  ERPDEF-EXP-DT           PIC XX.
   836 01  ELCRTT-KEY.
   837     05  CTRLR-COMP-CD       PIC X.
   838     05  CTRLR-CARRIER       PIC X.
   839     05  CTRLR-GROUPING      PIC X(6).
   840     05  CTRLR-STATE         PIC X(2).
   841     05  CTRLR-ACCOUNT       PIC X(10).
   842     05  CTRLR-EFF-DT        PIC XX.
   843     05  CTRLR-CERT-NO       PIC X(11).
   844     05  CTRLR-REC-TYPE      PIC X.
   845 01  ACCESS-KEYS.
   846     12  ELARCH-KEY.
   847         16  ARCH-CO             PIC X.
   848         16  ARCH-NUMBER         PIC S9(08) COMP.
   849         16  ARCH-REC-TYPE       PIC X.
   850         16  ARCH-SEQ            PIC S9(04) COMP.
   851     12  ELMSTR-KEY.
   852         16  MSTR-COMP-CD        PIC X.
   853         16  MSTR-CARRIER        PIC X.
   854         16  MSTR-CLAIM-NO       PIC X(7).
   855         16  MSTR-CERT-NO        PIC X(11).
   856     12  ELCNTL-KEY.
   857         16  CNTL-COMP-ID        PIC X(3).
   858         16  CNTL-REC-TYPE       PIC X.
   859         16  CNTL-ACCESS         PIC X(4).
   860         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   861     12  ELCERT-KEY.
   862         16  CERT-COMP-CD        PIC X.
   863         16  CERT-CARRIER        PIC X.
   864         16  CERT-GROUPING       PIC X(6).
   865         16  CERT-STATE          PIC XX.
   866         16  CERT-ACCOUNT        PIC X(10).
   867         16  CERT-EFF-DT         PIC XX.
   868         16  CERT-CERT-NO        PIC X(11).
   869     12  ELTRLR-KEY.
   870         16  TRLR-COMP-CD        PIC X.
   871         16  TRLR-CARRIER        PIC X.
   872         16  TRLR-CLAIM-NO       PIC X(7).
   873         16  TRLR-CERT-NO        PIC X(11).
   874         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   875     12  ELACTQ-KEY.
   876         16  ACTQ-COMP-CD        PIC X.
   877         16  ACTQ-CARRIER        PIC X.
   878         16  ACTQ-CLAIM-NO       PIC X(7).
   879         16  ACTQ-CERT-NO        PIC X(11).
   880     12  W-NOTE-KEY.
   881         16  W-NOTE-COMP-CD      PIC X.
   882         16  W-NOTE-CERT-KEY.
   883             20  W-NOTE-CARRIER  PIC X.
   884             20  W-NOTE-GROUPING PIC X(6).
   885             20  W-NOTE-STATE    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  18
* EL156.cbl
   886             20  W-NOTE-ACCOUNT  PIC X(10).
   887             20  W-NOTE-EFF-DT   PIC XX.
   888             20  W-NOTE-CERT-NO  PIC X(11).
   889     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   890     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   891     12  ERACCT-KEY.
   892         16  ERACCT-PARTIAL-KEY.
   893             20  ACCT-COMP-CD    PIC X.
   894             20  ACCT-CARRIER    PIC X.
   895             20  ACCT-GROUPING   PIC X(6).
   896             20  ACCT-STATE      PIC XX.
   897             20  ACCT-ACCOUNT    PIC X(10).
   898         16  ACCT-EXP-DT         PIC XX.
   899         16  FILLER              PIC X(4) VALUE SPACES.
   900     12  ELCHKQ-KEY.
   901         16  CHKQ-COMP-CD        PIC X.
   902         16  CHKQ-CONTROL        PIC S9(8) COMP.
   903         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   904     12  ELBENE-KEY.
   905         16  BENE-COMP-CD         PIC X.
   906         16  BENE-RECORD-TYPE     PIC X.
   907         16  BENE-NUMBER          PIC X(10).
   908     12  ERCOMP-KEY.
   909         16  COMP-COMP-CD        PIC X.
   910         16  COMP-CARRIER        PIC X.
   911         16  COMP-GROUP          PIC X(06).
   912         16  COMP-FIN-RESP       PIC X(10).
   913         16  COMP-ACCOUNT        PIC X(10).
   914         16  COMP-TYPE           PIC X.
   915
   916     12  DLO035-KEY.
   917         16  DL35-PROCESS-TYPE   PIC X.
   918         16  DL35-CREDIT-CARD    PIC X(20).
   919         16  DL35-BEN-TYPE       PIC XX.
   920         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   921         16  DL35-RETURN-CODE    PIC XX.
   922
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  19
* EL156.cbl
   924*    COPY ELCDATE.
   925******************************************************************
   926*                                                                *
   927*                                                                *
   928*                            ELCDATE.                            *
   929*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   930*                            VMOD=2.003
   931*                                                                *
   932*                                                                *
   933*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   934*                 LENGTH = 200                                   *
   935******************************************************************
   936
   937 01  DATE-CONVERSION-DATA.
   938     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   939     12  DC-OPTION-CODE                PIC X.
   940         88  BIN-TO-GREG                VALUE ' '.
   941         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   942         88  EDIT-GREG-TO-BIN           VALUE '2'.
   943         88  YMD-GREG-TO-BIN            VALUE '3'.
   944         88  MDY-GREG-TO-BIN            VALUE '4'.
   945         88  JULIAN-TO-BIN              VALUE '5'.
   946         88  BIN-PLUS-ELAPSED           VALUE '6'.
   947         88  FIND-CENTURY               VALUE '7'.
   948         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   949         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   950         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   951         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   952         88  JULIAN-TO-BIN-3            VALUE 'C'.
   953         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   954         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   955         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   956         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   957         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   958         88  CHECK-LEAP-YEAR            VALUE 'H'.
   959         88  BIN-3-TO-GREG              VALUE 'I'.
   960         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   961         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   962         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   963         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   964         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   965         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   966         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   967         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   968         88  THREE-CHARACTER-BIN
   969                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   970         88  GREGORIAN-TO-BIN
   971                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   972         88  BIN-TO-GREGORIAN
   973                  VALUES ' ' '1' 'I' '8' 'G'.
   974         88  JULIAN-TO-BINARY
   975                  VALUES '5' 'C' 'E' 'F'.
   976     12  DC-ERROR-CODE                 PIC X.
   977         88  NO-CONVERSION-ERROR        VALUE ' '.
   978         88  DATE-CONVERSION-ERROR
   979                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   980         88  DATE-IS-ZERO               VALUE '1'.
   981         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  20
* EL156.cbl
   982         88  DATE-IS-INVALID            VALUE '3'.
   983         88  DATE1-GREATER-DATE2        VALUE '4'.
   984         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   985         88  DATE-INVALID-OPTION        VALUE '9'.
   986         88  INVALID-CENTURY            VALUE 'A'.
   987         88  ONLY-CENTURY               VALUE 'B'.
   988         88  ONLY-LEAP-YEAR             VALUE 'C'.
   989         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   990     12  DC-END-OF-MONTH               PIC X.
   991         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   992     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   993         88  USE-NORMAL-PROCESS         VALUE ' '.
   994         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   995         88  ADJUST-UP-100-YRS          VALUE '2'.
   996     12  FILLER                        PIC X.
   997     12  DC-CONVERSION-DATES.
   998         16  DC-BIN-DATE-1             PIC XX.
   999         16  DC-BIN-DATE-2             PIC XX.
  1000         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1001         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1002                       DC-GREG-DATE-1-EDIT.
  1003             20  DC-EDIT1-MONTH        PIC 99.
  1004             20  SLASH1-1              PIC X.
  1005             20  DC-EDIT1-DAY          PIC 99.
  1006             20  SLASH1-2              PIC X.
  1007             20  DC-EDIT1-YEAR         PIC 99.
  1008         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1009         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1010                     DC-GREG-DATE-2-EDIT.
  1011             20  DC-EDIT2-MONTH        PIC 99.
  1012             20  SLASH2-1              PIC X.
  1013             20  DC-EDIT2-DAY          PIC 99.
  1014             20  SLASH2-2              PIC X.
  1015             20  DC-EDIT2-YEAR         PIC 99.
  1016         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1017         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1018                     DC-GREG-DATE-1-YMD.
  1019             20  DC-YMD-YEAR           PIC 99.
  1020             20  DC-YMD-MONTH          PIC 99.
  1021             20  DC-YMD-DAY            PIC 99.
  1022         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1023         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1024                      DC-GREG-DATE-1-MDY.
  1025             20  DC-MDY-MONTH          PIC 99.
  1026             20  DC-MDY-DAY            PIC 99.
  1027             20  DC-MDY-YEAR           PIC 99.
  1028         16  DC-GREG-DATE-1-ALPHA.
  1029             20  DC-ALPHA-MONTH        PIC X(10).
  1030             20  DC-ALPHA-DAY          PIC 99.
  1031             20  FILLER                PIC XX.
  1032             20  DC-ALPHA-CENTURY.
  1033                 24 DC-ALPHA-CEN-N     PIC 99.
  1034             20  DC-ALPHA-YEAR         PIC 99.
  1035         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1036         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1037         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1038         16  DC-JULIAN-DATE            PIC 9(05).
  1039         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  21
* EL156.cbl
  1040                                       PIC 9(05).
  1041         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1042             20  DC-JULIAN-YEAR        PIC 99.
  1043             20  DC-JULIAN-DAYS        PIC 999.
  1044         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1045         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1046         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1047     12  DATE-CONVERSION-VARIBLES.
  1048         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1049         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1050             20  FILLER                PIC 9(3).
  1051             20  HOLD-CEN-1-CCYY.
  1052                 24  HOLD-CEN-1-CC     PIC 99.
  1053                 24  HOLD-CEN-1-YY     PIC 99.
  1054             20  HOLD-CEN-1-MO         PIC 99.
  1055             20  HOLD-CEN-1-DA         PIC 99.
  1056         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1057             20  HOLD-CEN-1-R-MO       PIC 99.
  1058             20  HOLD-CEN-1-R-DA       PIC 99.
  1059             20  HOLD-CEN-1-R-CCYY.
  1060                 24  HOLD-CEN-1-R-CC   PIC 99.
  1061                 24  HOLD-CEN-1-R-YY   PIC 99.
  1062             20  FILLER                PIC 9(3).
  1063         16  HOLD-CENTURY-1-X.
  1064             20  FILLER                PIC X(3)  VALUE SPACES.
  1065             20  HOLD-CEN-1-X-CCYY.
  1066                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1067                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1068             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1069             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1070         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1071             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1072             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1073             20  HOLD-CEN-1-R-X-CCYY.
  1074                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1075                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1076             20  FILLER                PIC XXX.
  1077         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1078         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1079         16  DC-JULIAN-DATE-1          PIC 9(07).
  1080         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1081             20  DC-JULIAN-1-CCYY.
  1082                 24  DC-JULIAN-1-CC    PIC 99.
  1083                 24  DC-JULIAN-1-YR    PIC 99.
  1084             20  DC-JULIAN-DA-1        PIC 999.
  1085         16  DC-JULIAN-DATE-2          PIC 9(07).
  1086         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1087             20  DC-JULIAN-2-CCYY.
  1088                 24  DC-JULIAN-2-CC    PIC 99.
  1089                 24  DC-JULIAN-2-YR    PIC 99.
  1090             20  DC-JULIAN-DA-2        PIC 999.
  1091         16  DC-GREG-DATE-A-EDIT.
  1092             20  DC-EDITA-MONTH        PIC 99.
  1093             20  SLASHA-1              PIC X VALUE '/'.
  1094             20  DC-EDITA-DAY          PIC 99.
  1095             20  SLASHA-2              PIC X VALUE '/'.
  1096             20  DC-EDITA-CCYY.
  1097                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  22
* EL156.cbl
  1098                 24  DC-EDITA-YEAR     PIC 99.
  1099         16  DC-GREG-DATE-B-EDIT.
  1100             20  DC-EDITB-MONTH        PIC 99.
  1101             20  SLASHB-1              PIC X VALUE '/'.
  1102             20  DC-EDITB-DAY          PIC 99.
  1103             20  SLASHB-2              PIC X VALUE '/'.
  1104             20  DC-EDITB-CCYY.
  1105                 24  DC-EDITB-CENT     PIC 99.
  1106                 24  DC-EDITB-YEAR     PIC 99.
  1107         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1108         16  DC-GREG-DATE-CYMD-R REDEFINES
  1109                              DC-GREG-DATE-CYMD.
  1110             20  DC-CYMD-CEN           PIC 99.
  1111             20  DC-CYMD-YEAR          PIC 99.
  1112             20  DC-CYMD-MONTH         PIC 99.
  1113             20  DC-CYMD-DAY           PIC 99.
  1114         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1115         16  DC-GREG-DATE-MDCY-R REDEFINES
  1116                              DC-GREG-DATE-MDCY.
  1117             20  DC-MDCY-MONTH         PIC 99.
  1118             20  DC-MDCY-DAY           PIC 99.
  1119             20  DC-MDCY-CEN           PIC 99.
  1120             20  DC-MDCY-YEAR          PIC 99.
  1121    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1122        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1123    12  DC-EL310-DATE                  PIC X(21).
  1124    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  23
* EL156.cbl
  1126*    COPY ELCLOGOF.
  1127******************************************************************
  1128*                                                                *
  1129*                                                                *
  1130*                            ELCLOGOF.                           *
  1131*                            VMOD=2.001                          *
  1132*                                                                *
  1133*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1134*                                                                *
  1135******************************************************************
  1136 01  CLASIC-LOGOFF.
  1137     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1138     12  LOGOFF-TEXT.
  1139         16  FILLER          PIC X(5)    VALUE SPACES.
  1140         16  LOGOFF-MSG.
  1141             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1142             20  FILLER      PIC X       VALUE SPACES.
  1143             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1144         16  FILLER          PIC X(80)
  1145           VALUE '* YOU ARE NOW LOGGED OFF'.
  1146         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1147         16  FILLER          PIC X       VALUE QUOTE.
  1148         16  LOGOFF-SYS-MSG  PIC X(17)
  1149           VALUE 'S CLAS-IC SYSTEM '.
  1150     12  TEXT-MESSAGES.
  1151         16  UNACCESS-MSG    PIC X(29)
  1152             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1153         16  PGMIDERR-MSG    PIC X(17)
  1154             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  24
* EL156.cbl
  1156*    COPY ELCCALC.
  1157******************************************************************
  1158*                                                                *
  1159*                           ELCCALC.                            *
  1160*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1161*                            VMOD=2.025                          *
  1162*                                                                *
  1163*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1164*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1165*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1166*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1167*                                                                *
  1168*  PASSED TO ELRTRM                                              *
  1169*  -----------------                                             *
  1170*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1171*  ORIGINAL TERM                                                 *
  1172*  BEGINNING DATE                                                *
  1173*  ENDING DATE                                                   *
  1174*  COMPANY I.D.                                                  *
  1175*  ACCOUNT MASTER USER FIELD                                     *
  1176*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1177*  FREE LOOK DAYS                                                *
  1178*                                                                *
  1179*  RETURNED FROM ELRTRM                                          *
  1180*  ---------------------                                         *
  1181*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1182*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1183*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1184*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1185*----------------------------------------------------------------*
  1186*  PASSED TO ELRAMT                                              *
  1187*  ----------------                                              *
  1188*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1189*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1190*  ORIGINAL AMOUNT                                               *
  1191*  ALTERNATE BENEFIT (BALLON)                                    *
  1192*  A.P.R. - NET PAY ONLY                                         *
  1193*  METHOD
  1194*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1195*  COMPANY I.D.                                                  *
  1196*  BENEFIT TYPE                                                  *
  1197*                                                                *
  1198*  RETURNED FROM ELRAMT                                          *
  1199*  --------------------                                          *
  1200*  REMAINING AMOUNT 1 - CURRENT                                  *
  1201*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1202*  REMAINING AMOUNT FACTOR
  1203*----------------------------------------------------------------*
  1204*  PASSED TO ELRESV                                              *
  1205*  -----------------                                             *
  1206*  CERTIFICATE EFFECTIVE DATE                                    *
  1207*  VALUATION DATE                                                *
  1208*  PAID THRU DATE                                                *
  1209*  BENEFIT                                                       *
  1210*  INCURRED DATE                                                 *
  1211*  REPORTED DATE                                                 *
  1212*  ISSUE AGE                                                     *
  1213*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  25
* EL156.cbl
  1214*  CDT PERCENT                                                   *
  1215*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1216* *CLAIM TYPE (LIFE, A/H)                                        *
  1217* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1218* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1219*                                                                *
  1220*  RETURNED FROM ELRESV                                          *
  1221*  --------------------                                          *
  1222*  CDT TABLE USED                                                *
  1223*  CDT FACTOR USED                                               *
  1224*  PAY TO CURRENT RESERVE                                        *
  1225*  I.B.N.R. - A/H ONLY                                           *
  1226*  FUTURE (ACCRUED) AH ONLY                                      *
  1227*----------------------------------------------------------------*
  1228*  PASSED TO ELRATE                                              *
  1229*  ----------------                                              *
  1230*  CERT ISSUE DATE                                               *
  1231*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1232*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1233*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1234*  STATE CODE (CLIENT DEFINED)                                   *
  1235*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1236*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1237*  DEVIATION CODE                                                *
  1238*  ISSUE AGE                                                     *
  1239*  ORIGINAL BENEFIT AMOUNT                                       *
  1240*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1241*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1242*  BENEFIT KIND (LIFE OR A/H)                                    *
  1243*  A.P.R.                                                        *
  1244*  METHOD
  1245*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1246*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1247*  COMPANY I.D. (3 CHARACTER)                                    *
  1248*  BENEFIT CODE                                                  *
  1249*  BENEFIT OVERRIDE CODE                                         *
  1250*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1251*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1252*  JOINT INDICATOR (CSL ONLY)                                    *
  1253*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1254*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1255*                                                                *
  1256*  RETURNED FROM ELRATE                                          *
  1257*  --------------------                                          *
  1258*  CALCULATED PREMIUM                                            *
  1259*  PREMIUM RATE                                                  *
  1260*  MORTALITY CODE                                                *
  1261*  MAX ATTAINED AGE                                              *
  1262*  MAX AGE                                                       *
  1263*  MAX TERM                                                      *
  1264*  MAX MONTHLY BENEFIT                                           *
  1265*  MAX TOTAL BENIFIT                                             *
  1266*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1267*----------------------------------------------------------------*
  1268*  PASSED TO ELRFND                                              *
  1269*  ----------------                                              *
  1270*  CERT ISSUE DATE                                               *
  1271*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  26
* EL156.cbl
  1272*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1273*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1274*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1275*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1276*  STATE CODE (CLIENT DEFINED)                                   *
  1277*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1278*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1279*  DEVIATION CODE                                                *
  1280*  ISSUE AGE                                                     *
  1281*  ORIGINAL BENEFIT AMOUNT                                       *
  1282*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1283*  PROCESS TYPE (CANCEL)                                         *
  1284*  BENEFIT KIND (LIFE OR A/H)                                    *
  1285*  A.P.R.                                                        *
  1286*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1287*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1288*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1289*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1290*  COMPANY I.D. (3 CHARACTER)                                    *
  1291*  BENEFIT CODE                                                  *
  1292*  BENEFIT OVERRIDE CODE                                         *
  1293*                                                                *
  1294*  RETURNED FROM ELRFND                                          *
  1295*  --------------------                                          *
  1296*  CALCULATED REFUND                                             *
  1297*----------------------------------------------------------------*
  1298*  PASSED TO ELEARN                                              *
  1299*  ----------------                                              *
  1300*  CERT ISSUE DATE                                               *
  1301*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1302*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1303*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1304*  STATE CODE (CLIENT DEFINED)                                   *
  1305*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1306*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1307*  DEVIATION CODE                                                *
  1308*  ISSUE AGE                                                     *
  1309*  ORIGINAL BENEFIT AMOUNT                                       *
  1310*  BENEFIT KIND (LIFE OR A/H)                                    *
  1311*  A.P.R.                                                        *
  1312*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1313*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1314*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1315*  COMPANY I.D. (3 CHARACTER)                                    *
  1316*  BENEFIT CODE                                                  *
  1317*  BENEFIT OVERRIDE CODE                                         *
  1318*                                                                *
  1319*  RETURNED FROM ELEARN                                          *
  1320*  --------------------                                          *
  1321*  INDICATED  EARNINGS                                           *
  1322*----------------------------------------------------------------*
  1323*                 LENGTH = 450                                   *
  1324*                                                                *
  1325******************************************************************
  1326******************************************************************
  1327*                   C H A N G E   L O G
  1328*
  1329* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  27
* EL156.cbl
  1330*-----------------------------------------------------------------
  1331*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1332* EFFECTIVE    NUMBER
  1333*-----------------------------------------------------------------
  1334* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1335* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1336* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1337* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1338* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1339* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1340* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1341* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1342* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1343* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1344* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1345******************************************************************
  1346
  1347 01  CALCULATION-PASS-AREA.
  1348     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1349                                     COMP.
  1350
  1351     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1352       88  NO-CP-ERROR                             VALUE ZERO.
  1353       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1354                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1355       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1356       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1357       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1358       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1359       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1360       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1361       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1362       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1363       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1364       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1365       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1366       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1367       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1368       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1369       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1370       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1371       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1372
  1373     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1374       88  NO-CP-ERROR-2                           VALUE ZERO.
  1375***********************  INPUT AREAS ****************************
  1376
  1377     12  CP-CALCULATION-AREA.
  1378         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1379         16  CP-CERT-EFF-DT        PIC XX.
  1380         16  CP-VALUATION-DT       PIC XX.
  1381         16  CP-PAID-THRU-DT       PIC XX.
  1382         16  CP-BENEFIT-TYPE       PIC X.
  1383           88  CP-AH                               VALUE 'A' 'D'
  1384                                                   'I' 'U'.
  1385           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1386           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1387         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  28
* EL156.cbl
  1388         16  CP-REPORTED-DT        PIC XX.
  1389         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1390         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1391         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1392                                     COMP-3.
  1393         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1394                                     COMP-3.
  1395         16  CP-CDT-METHOD         PIC X.
  1396           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1397           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1398           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1399         16  CP-CLAIM-TYPE         PIC X.
  1400           88  CP-AH-CLAIM                         VALUE 'A'.
  1401           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1402         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1403                                     COMP-3.
  1404         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1405                                     COMP-3.
  1406         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1407                                     COMP-3.
  1408         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1409                                     COMP-3.
  1410         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1411                                     COMP-3.
  1412         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1413                                     COMP-3.
  1414         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1415                                     COMP-3.
  1416         16  CP-REM-TERM-METHOD    PIC X.
  1417           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1418           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1419           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1420           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1421           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1422           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1423           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1424         16  CP-EARNING-METHOD     PIC X.
  1425           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1426           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1427           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1428           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1429           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1430           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1431           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1432           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1433           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1434           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1435           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1436           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1437           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1438           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1439         16  CP-PROCESS-TYPE       PIC X.
  1440           88  CP-CLAIM                            VALUE '1'.
  1441           88  CP-CANCEL                           VALUE '2'.
  1442           88  CP-ISSUE                            VALUE '3'.
  1443         16  CP-SPECIAL-CALC-CD    PIC X.
  1444           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1445           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  29
* EL156.cbl
  1446           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1447           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1448           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1449           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1450           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1451           88  CP-FARM-PLAN                    VALUE 'F'.
  1452           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1453           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1454           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1455           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1456           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1457           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1458           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1459           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1460           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1461           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1462                                                     'W' 'X'.
  1463           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1464           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1465           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1466           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1467           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1468           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1469           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1470           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1471           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1472           88  CP-CSL-METH-1                   VALUE '5'.
  1473           88  CP-CSL-METH-2                   VALUE '6'.
  1474           88  CP-CSL-METH-3                   VALUE '7'.
  1475           88  CP-CSL-METH-4                   VALUE '8'.
  1476
  1477         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1478                                     COMP-3.
  1479         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1480         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1481         16  CP-STATE              PIC XX          VALUE SPACE.
  1482         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1483         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1484           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1485               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1486         16  CP-R78-OPTION         PIC X.
  1487           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1488           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1489
  1490         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1491         16  CP-IBNR-RESERVE-SW    PIC X.
  1492         16  CP-CLAIM-STATUS       PIC X.
  1493         16  CP-RATE-FILE          PIC X.
  1494         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1495                                     COMP-3.
  1496
  1497         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1498         16  CP-AH-OVERRIDE-CODE   PIC X.
  1499
  1500         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1501                                     COMP-3.
  1502         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1503                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  30
* EL156.cbl
  1504         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1505                                     COMP-3.
  1506         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1507                                     COMP-3.
  1508         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1509                                     COMP-3.
  1510         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1511                                  PIC S9(7)V99 COMP-3.
  1512
  1513         16  CP-PAID-FROM-DATE     PIC X(02).
  1514         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1515         16  CP-EXT-DAYS-CALC      PIC X.
  1516           88  CP-EXT-NO-CHG                   VALUE ' '.
  1517           88  CP-EXT-CHG-LF                   VALUE '1'.
  1518           88  CP-EXT-CHG-AH                   VALUE '2'.
  1519           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1520         16  CP-DOMICILE-STATE     PIC XX.
  1521         16  CP-CARRIER            PIC X.
  1522         16  CP-REIN-FLAG          PIC X.
  1523         16  CP-REM-TRM-CALC-OPTION PIC X.
  1524           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1525                      '2' '3' '4' '5'.
  1526           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1527           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1528           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1529           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1530           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1531           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1532           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1533           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1534         16  CP-SIG-SWITCH         PIC X.
  1535         16  CP-RATING-METHOD      PIC X.
  1536           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1537           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1538           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1539           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1540           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1541           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1542           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1543           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1544           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1545         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1546                                     COMP-3.
  1547         16  CP-BEN-CATEGORY       PIC X.
  1548         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1549         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1550                                   PIC S99V9(5) COMP-3.
  1551         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1552         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1553                                   PIC S99V9(5) COMP-3.
  1554         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1555         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1556         16  CP-EXPIRE-DT          PIC XX.
  1557         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1558         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1559         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1560         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1561         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  31
* EL156.cbl
  1562             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1563             88  CP-CALC-CLP              VALUE 'C'.
  1564         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1565         16  CP-CANCEL-REASON      PIC X.
  1566         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1567         16  CP-PMT-MODE           PIC X.
  1568         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1569         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1570         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1571         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1572         16  FILLER                PIC X.
  1573
  1574***************    OUTPUT FROM ELRESV   ************************
  1575
  1576         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1577
  1578         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1579                                     COMP-3.
  1580         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1581                                     COMP-3.
  1582         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1583                                     COMP-3.
  1584         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1585                                     COMP-3.
  1586         16  FILLER                PIC X(09).
  1587***************    OUTPUT FROM ELRTRM   *************************
  1588
  1589         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1590                                     COMP-3.
  1591         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1592                                     COMP-3.
  1593         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1594                                     COMP-3.
  1595         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1596                                     COMP-3.
  1597         16  FILLER                PIC X(12).
  1598
  1599***************    OUTPUT FROM ELRAMT   *************************
  1600
  1601         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1602                                     COMP-3.
  1603         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1604                                     COMP-3.
  1605         16  FILLER                PIC X(12).
  1606
  1607***************    OUTPUT FROM ELRATE   *************************
  1608
  1609         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1610                                     COMP-3.
  1611         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1612                                     COMP-3.
  1613         16  CP-MORTALITY-CODE     PIC X(4).
  1614         16  CP-RATE-EDIT-FLAG     PIC X.
  1615             88  CP-RATES-NEED-APR                  VALUE '1'.
  1616         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1617                                     COMP-3.
  1618         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1619         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  32
* EL156.cbl
  1620         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1621                                   PIC S9(7)V99 COMP-3.
  1622         16  FILLER                PIC X(07).
  1623
  1624***************    OUTPUT FROM ELRFND   *************************
  1625
  1626         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1627                                     COMP-3.
  1628         16  CP-REFUND-TYPE-USED   PIC X.
  1629           88  CP-R-AS-R78                         VALUE '1'.
  1630           88  CP-R-AS-PRORATA                     VALUE '2'.
  1631           88  CP-R-AS-CALIF                       VALUE '3'.
  1632           88  CP-R-AS-TEXAS                       VALUE '4'.
  1633           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1634           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1635           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1636           88  CP-R-AS-MEAN                        VALUE '8'.
  1637           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1638           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1639           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1640           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1641           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1642           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1643         16  FILLER                PIC X(12).
  1644
  1645***************    OUTPUT FROM ELEARN   *************************
  1646
  1647         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1648                                     COMP-3.
  1649         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1650                                     COMP-3.
  1651         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1652                                     COMP-3.
  1653         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1654                                     COMP-3.
  1655         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1656                                     COMP-3.
  1657         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1658                                     COMP-3.
  1659         16  CP-EARNING-TYPE-USED  PIC X.
  1660           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1661           88  CP-E-AS-R78                         VALUE '1'.
  1662           88  CP-E-AS-PRORATA                     VALUE '2'.
  1663           88  CP-E-AS-TEXAS                       VALUE '4'.
  1664           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1665           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1666           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1667           88  CP-E-AS-MEAN                        VALUE '8'.
  1668           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1669         16  FILLER                PIC X(12).
  1670
  1671***************    OUTPUT FROM ELPMNT   *************************
  1672
  1673         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1674                                     COMP-3.
  1675         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1676                                     COMP-3.
  1677         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  33
* EL156.cbl
  1678
  1679***************   MISC WORK AREAS    *****************************
  1680         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1681                                     COMP-3.
  1682         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1683                                     COMP-3.
  1684         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1685                                     COMP-3.
  1686         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1687                                     COMP-3.
  1688         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1689                                     COMP-3.
  1690         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1691                                     COMP-3.
  1692         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1693             88  OPEN-RATE-FILE                   VALUE 'O'.
  1694             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1695             88  IO-ERROR                         VALUE 'E'.
  1696
  1697         16  CP-FIRST-PAY-DATE     PIC XX.
  1698
  1699         16  CP-JOINT-INDICATOR    PIC X.
  1700
  1701         16  CP-RESERVE-REMAINING-TERM
  1702                                   PIC S9(4)V9    VALUE ZERO
  1703                                     COMP-3.
  1704
  1705         16  CP-INSURED-BIRTH-DT   PIC XX.
  1706
  1707         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1708                                     COMP-3.
  1709
  1710         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1711                                     COMP-3.
  1712
  1713         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1714                                     COMP-3.
  1715
  1716         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1717                                     COMP-3.
  1718
  1719         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1720                                     COMP-3.
  1721
  1722         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1723                                     COMP-3.
  1724
  1725         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1726                                     COMP-3.
  1727
  1728         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1729             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1730
  1731         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1732                                     COMP-3.
  1733         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1734                                     COMP-3.
  1735         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  34
* EL156.cbl
  1736         16  cp-extra-periods      pic 9 value zeros.
  1737         16  cp-net-only-state     pic x value spaces.
  1738         16  FILLER                PIC X(13).
  1739******************************************************************
  1740*    COPY ELCICALC.
  1741******************************************************************
  1742*                                                                *
  1743*                           ELCCICALC.                           *
  1744*                            VMOD=2.001                          *
  1745*                                                                *
  1746*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1747*                 CALCULATION MODULE                             *
  1748*                                                                *
  1749*  PASSED TO ELCLMI                                              *
  1750*  -----------------                                             *
  1751*  STATE                                                         *
  1752*  PRODUCT                                                       *
  1753*  COVERAGE                                                      *
  1754*  EFFECTIVE DATE                                                *
  1755*  INCURRED DATE                                                 *
  1756*  ESTABLISHED DATE                                              *
  1757*  LAST PAID DATE                                                *
  1758*  REPORTED DATE                                                 *
  1759*  CLAIM PAYMENT AMOUNT                                          *
  1760*                                                                *
  1761*  RETURNED FROM ELRTRM                                          *
  1762*  ---------------------                                         *
  1763*  RETURN CODE                                                   *
  1764*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1765*  CLAIM INTEREST AMOUNT                                         *
  1766*----------------------------------------------------------------*
  1767*----------------------------------------------------------------*
  1768*                 LENGTH = 100                                   *
  1769*                                                                *
  1770******************************************************************
  1771******************************************************************
  1772*                   C H A N G E   L O G
  1773*
  1774* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1775*-----------------------------------------------------------------
  1776*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1777* EFFECTIVE    NUMBER
  1778*-----------------------------------------------------------------
  1779* 120905    2004040700004  PEMA  NEW COPYBOOK
  1780* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1781******************************************************************
  1782
  1783 01  CLAIM-INT-PASS-AREA.
  1784     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1785                                     COMP.
  1786
  1787     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1788       88  NO-CI-ERROR                             VALUE ZERO.
  1789       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1790       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1791       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1792       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1793       88  CP-AMT-LT-5000                          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  35
* EL156.cbl
  1794       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1795       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1796       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1797       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1798***********************  INPUT AREAS ****************************
  1799
  1800     12  CP-CALCULATION-AREA.
  1801         16  CP-COMPANY-CD         PIC X.
  1802         16  CP-STATE              PIC XX.
  1803         16  CP-PRODUCT            PIC XX.
  1804         16  CP-COVERAGE           PIC XX.
  1805         16  CP-INC-DT             PIC XX.
  1806         16  CP-EST-DT             PIC XX.
  1807         16  CP-LSTPD-DT           PIC XX.
  1808         16  CP-RPT-DT             PIC XX.
  1809         16  CP-PRF-DT             PIC XX.
  1810         16  CP-EFF-DT             PIC XX.
  1811         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1812         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1813         16  FILLER                PIC X(37).
  1814
  1815***************    OUTPUT FROM ELCLMI   ************************
  1816
  1817         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1818
  1819         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1820         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1821         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1822         16  FILLER                PIC X(19).
  1823******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  36
* EL156.cbl
  1825*    COPY ELCATTR.
  1826******************************************************************
  1827*                                                                *
  1828*                            ELCATTR.                            *
  1829*                            VMOD=2.001                          *
  1830*                                                                *
  1831*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1832*                                                                *
  1833*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1834*                                                                *
  1835*                   POS 1   P=PROTECTED                          *
  1836*                           U=UNPROTECTED                        *
  1837*                           S=ASKIP                              *
  1838*                   POS 2   A=ALPHA/NUMERIC                      *
  1839*                           N=NUMERIC                            *
  1840*                   POS 3   N=NORMAL                             *
  1841*                           B=BRIGHT                             *
  1842*                           D=DARK                               *
  1843*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1844*                           OF=MODIFIED DATA TAG OFF             *
  1845*                                                                *
  1846*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1847******************************************************************
  1848 01  ATTRIBUTE-LIST.
  1849     12  AL-PABOF            PIC X       VALUE 'Y'.
  1850     12  AL-PABON            PIC X       VALUE 'Z'.
  1851     12  AL-PADOF            PIC X       VALUE '%'.
  1852     12  AL-PADON            PIC X       VALUE '_'.
  1853     12  AL-PANOF            PIC X       VALUE '-'.
  1854     12  AL-PANON            PIC X       VALUE '/'.
  1855     12  AL-SABOF            PIC X       VALUE '8'.
  1856     12  AL-SABON            PIC X       VALUE '9'.
  1857     12  AL-SADOF            PIC X       VALUE '@'.
  1858     12  AL-SADON            PIC X       VALUE QUOTE.
  1859     12  AL-SANOF            PIC X       VALUE '0'.
  1860     12  AL-SANON            PIC X       VALUE '1'.
  1861     12  AL-UABOF            PIC X       VALUE 'H'.
  1862     12  AL-UABON            PIC X       VALUE 'I'.
  1863     12  AL-UADOF            PIC X       VALUE '<'.
  1864     12  AL-UADON            PIC X       VALUE '('.
  1865     12  AL-UANOF            PIC X       VALUE ' '.
  1866     12  AL-UANON            PIC X       VALUE 'A'.
  1867     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1868     12  AL-UNBON            PIC X       VALUE 'R'.
  1869     12  AL-UNDOF            PIC X       VALUE '*'.
  1870     12  AL-UNDON            PIC X       VALUE ')'.
  1871     12  AL-UNNOF            PIC X       VALUE '&'.
  1872     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  37
* EL156.cbl
  1874*    COPY ELCEMIB.
  1875******************************************************************
  1876*                                                                *
  1877*                                                                *
  1878*                            ELCEMIB.                            *
  1879*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1880*                            VMOD=2.005                          *
  1881*                                                                *
  1882*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1883*                                                                *
  1884******************************************************************
  1885 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1886     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1887     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1888     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1889     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1890     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1891     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1892     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1893     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1894     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1895         88  EMI-NO-ERRORS                    VALUE '1'.
  1896         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1897         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1898     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1899         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1900     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1901         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1902         88  EMI-AREA1-FULL                   VALUE '2'.
  1903     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1904         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1905         88  EMI-AREA2-FULL                   VALUE '2'.
  1906     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1907         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1908         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1909         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1910         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1911         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1912     12  EMI-ERROR-LINES.
  1913         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1914         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1915         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1916         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1917             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1918                 24  EMI-ERR-NUM         PIC X(4).
  1919                 24  EMI-FILLER          PIC X.
  1920                 24  EMI-SEV             PIC X.
  1921                 24  FILLER              PIC X.
  1922             20  FILLER                  PIC X(02).
  1923     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1924         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1925             20  EMI-ERROR-NUMBER    PIC X(4).
  1926             20  EMI-FILL            PIC X.
  1927             20  EMI-SEVERITY        PIC X.
  1928             20  FILLER              PIC X.
  1929             20  EMI-ERROR-TEXT.
  1930                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1931                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  38
* EL156.cbl
  1932     12  EMI-SEVERITY-SAVE           PIC X.
  1933         88  EMI-NOTE                    VALUE 'N'.
  1934         88  EMI-WARNING                 VALUE 'W'.
  1935         88  EMI-FORCABLE                VALUE 'F'.
  1936         88  EMI-FATAL                   VALUE 'X'.
  1937     12  EMI-MESSAGE-FLAG            PIC X.
  1938         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1939         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1940     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1941     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1942         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1943         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1944         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1945     12  emi-claim-no                pic x(7).
  1946     12  emi-claim-type              pic x(6).
  1947     12  FILLER                      PIC X(124)  VALUE SPACES.
  1948     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1949     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1950     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1951     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  39
* EL156.cbl
  1953*    COPY ELCLNKLT.
  1954******************************************************************
  1955*                                                                *
  1956*                                                                *
  1957*                           ELCLNKLT                             *
  1958*                            VMOD=2.003                          *
  1959*                                                                *
  1960*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1961*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1962*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1963*                                                                *
  1964*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1965*   COMPLETING THE REQUIRED FIELDS.                              *
  1966*                                                                *
  1967*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1968*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1969*                              9999 INDICATES AN UNKNOWN ABEND   *
  1970*                                   WAS DETECTED.                *
  1971*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1972*                              CODES FOUND IN THE ERROR FILE.    *
  1973******************************************************************
  1974 01  W-1523-LINKDATA.
  1975     12  W-1523-COMMON-PI-DATA.
  1976         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1977         16  FILLER              PIC  X(67).
  1978         16  W-1523-COMPANY-CD   PIC  X(01).
  1979         16  FILLER              PIC  X(10).
  1980         16  W-1523-CONTROL-IN-PROGRESS.
  1981             20  W-1523-CARRIER  PIC  X(01).
  1982             20  W-1523-GROUPING PIC  X(06).
  1983             20  W-1523-STATE    PIC  X(02).
  1984             20  W-1523-ACCOUNT  PIC  X(10).
  1985             20  W-1523-CLAIM-CERT-GRP.
  1986                 24  W-1523-CLAIM-NO
  1987                                 PIC  X(07).
  1988                 24  W-1523-CERT-NO.
  1989                     28  W-1523-CERT-PRIME
  1990                                 PIC  X(10).
  1991                     28  W-1523-CERT-SFX
  1992                                 PIC  X(01).
  1993                 24  W-1523-CERT-EFF-DT
  1994                                 PIC  X(02).
  1995         16  FILLER              PIC X(265).
  1996
  1997     12  W-1523-WORK-AREA.
  1998         16  W-1523-FORM-NUMBER  PIC  X(04).
  1999         16  W-1523-NUMBER-COPIES
  2000                                 PIC  9(01).
  2001         16  W-1523-ADDR-TYPE    PIC  X(02).
  2002         16  W-1523-FOLLOW-UP-DATE
  2003                                 PIC  X(02).
  2004         16  W-1523-RESEND-DATE  PIC  X(02).
  2005         16  W-1523-ERROR-CODE   PIC  9(04).
  2006             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  2007             88  W-1523-FATAL-ERROR
  2008                                    VALUES  0006 0013 0042
  2009                                            0154 0168 0169
  2010                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  40
* EL156.cbl
  2011                                            0179 0186 0281
  2012                                            0332 2055 3697
  2013                                            3698 3699 3770
  2014                                            3771 3772 7675
  2015                                            9106 9808 9883
  2016                                            9887.
  2017             88  W-1523-STOP-ERRORS
  2018                                    VALUES  0013 0042 0154
  2019                                            0168 0169 0172
  2020                                            0281 0332 2055
  2021                                            3698 3699 7675
  2022                                            9106 9808 9883
  2023                                            9999.
  2024         16  W-1523-REASON       PIC  X(70).
  2025         16  W-1523-ARCHIVE-NUMBER
  2026                                 PIC  9(08).
  2027     12  W-1523-POINTER-AREA.
  2028         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2029         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2030         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2031         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2032         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  41
* EL156.cbl
  2034*    COPY ELCNWA.
  2035*****************************************************************
  2036*                                                               *
  2037*                                                               *
  2038*                            ELCNWA.                            *
  2039*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2040*                            VMOD=2.003                         *
  2041*                                                               *
  2042*            M O V E   N A M E   W O R K   A R E A.             *
  2043*                                                               *
  2044*****************************************************************.
  2045
  2046 01  WS-NAME-WORK-AREA.
  2047     05  WS-INSURED-LAST-NAME        PIC X(15).
  2048     05  WS-INSURED-1ST-NAME         PIC X(12).
  2049     05  WS-INSURED-MID-INIT         PIC X.
  2050
  2051     05  WS-NAME-WORK.
  2052         10  WS-NW                   PIC X
  2053             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2054
  2055     05  WS-NAME-WORK2.
  2056         10  WS-NW2                  PIC X
  2057             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2058                                        NWA-INDEX0.
  2059
  2060     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2061                                     COMP-3.
  2062
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  42
* EL156.cbl
  2064*    COPY ELCDMO.
  2065******************************************************************
  2066*                                                                *
  2067*                                                                *
  2068*                            ELCDMO.                             *
  2069*                            VMOD=2.004                          *
  2070*                                                                *
  2071*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2072*        COMMUNICATION AREA                                      *
  2073*   FILE TYPE = NA                                               *
  2074*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2075*                                                                *
  2076******************************************************************
  2077 01  DMO-COMMUNICATION-AREA.
  2078     12  DM-RECORD-TYPE                  PIC  X(02).
  2079             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2080             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2081             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2082     12  DM-DIST-CODE                    PIC  X(04).
  2083     12  DM-MAIL-CODE                    PIC  X(05).
  2084     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2085     12  DM-INSURED-NAME                 PIC  X(30).
  2086     12  DM-CLAIM-NO                     PIC  X(07).
  2087     12  DM-CLAIM-TYPE                   PIC  X.
  2088
  2089     12  DM-STATUS-DATA-AREA.
  2090         16  DM-CLAIM-STATUS             PIC  X.
  2091             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2092             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2093             88  DM-CLOSED                        VALUE '3'.
  2094             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2095             88  DM-DEFAULT                       VALUE '9'.
  2096         16  DM-STATUS-DATE              PIC  X(08).
  2097******YYYYMMDD
  2098         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2099             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2100             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2101             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2102             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2103             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2104             88  DM-RE-OPENED                     VALUE 'R'.
  2105             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2106             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2107             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2108         16  DM-STAT-CARRIER             PIC X.
  2109
  2110     12  DM-DRAFT-DATA-AREA.
  2111         16  DM-PAYMENT-TYPE             PIC  X.
  2112             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2113         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2114         16  DM-PAYMENT-DATE             PIC  X(08).
  2115******YYYYMMDD
  2116         16  DM-CERT-NO                  PIC  X(11).
  2117         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2118         16  DM-CARRIER                  PIC  X.
  2119
  2120     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  43
* EL156.cbl
  2122*    COPY ELCDMDCD.
  2123******************************************************************
  2124*                                                                *
  2125*                                                                *
  2126*                            ELCDMDCD.                           *
  2127*                            VMOD=2.001                          *
  2128*                                                                *
  2129*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2130*       COMMUNICATIONS AREA                                      *
  2131*                                                                *
  2132******************************************************************
  2133 01  CD-COMMUNICATION-AREA.
  2134     12  CD-SYSTEM-ID            PIC  X(02).
  2135         88 CD-CLAIMS                      VALUE 'CL'.
  2136         88 CD-CREDIT                      VALUE 'CR'.
  2137     12  CD-RECORD-TYPE          PIC  X(02).
  2138         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2139         88 CD-EOB-CODE                    VALUE 'EO'.
  2140         88 CD-ICD9-CODE                   VALUE 'I9'.
  2141         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2142         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2143         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2144         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2145         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2146     12  CD-RECORD-KEY           PIC  X(06).
  2147         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2148     12  CD-RETURN-CODE          PIC  X(02).
  2149     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2150     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2151     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2152     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  44
* EL156.cbl
  2154*    COPY ELCDCTB.
  2155******************************************************************
  2156*                                                                *
  2157*                                                                *
  2158*                            ELCDCTB.                            *
  2159*                            VMOD=2.002                          *
  2160*                                                                *
  2161*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2162*       COMMUNICATIONS AREA                                      *
  2163*                                                                *
  2164******************************************************************
  2165 01  DCT-COMMUNICATION-AREA.
  2166     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2167     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2168     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2169     12  DCT-PRODUCT-CODE         PIC  X(02).
  2170     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2171     12  DCT-RETURN-CODE          PIC  X(02).
  2172     12  DCT-MAIL-CODE            PIC  X(05).
  2173     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2174     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  45
* EL156.cbl
  2176 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2177 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2178 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2179 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  46
* EL156.cbl
  2181*    COPY ELCINTF.
  2182******************************************************************
  2183*                                                                *
  2184*                                                                *
  2185*                            ELCINTF.                            *
  2186*                            VMOD=2.017                          *
  2187*                                                                *
  2188*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2189*                                                                *
  2190*       LENGTH = 1024                                            *
  2191*                                                                *
  2192******************************************************************
  2193*                   C H A N G E   L O G
  2194*
  2195* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2196*-----------------------------------------------------------------
  2197*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2198* EFFECTIVE    NUMBER
  2199*-----------------------------------------------------------------
  2200* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2201******************************************************************
  2202 01  PROGRAM-INTERFACE-BLOCK.
  2203     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2204     12  PI-CALLING-PROGRAM              PIC X(8).
  2205     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2206     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2207     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2208     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2209     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2210     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2211     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2212     12  PI-COMPANY-ID                   PIC XXX.
  2213     12  PI-COMPANY-CD                   PIC X.
  2214
  2215     12  PI-COMPANY-PASSWORD             PIC X(8).
  2216
  2217     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2218
  2219     12  PI-CONTROL-IN-PROGRESS.
  2220         16  PI-CARRIER                  PIC X.
  2221         16  PI-GROUPING                 PIC X(6).
  2222         16  PI-STATE                    PIC XX.
  2223         16  PI-ACCOUNT                  PIC X(10).
  2224         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2225                                         PIC X(10).
  2226         16  PI-CLAIM-CERT-GRP.
  2227             20  PI-CLAIM-NO             PIC X(7).
  2228             20  PI-CERT-NO.
  2229                 25  PI-CERT-PRIME       PIC X(10).
  2230                 25  PI-CERT-SFX         PIC X.
  2231             20  PI-CERT-EFF-DT          PIC XX.
  2232         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2233             20  PI-PLAN-CODE            PIC X(2).
  2234             20  PI-REVISION-NUMBER      PIC X(3).
  2235             20  PI-PLAN-EFF-DT          PIC X(2).
  2236             20  PI-PLAN-EXP-DT          PIC X(2).
  2237             20  FILLER                  PIC X(11).
  2238         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  47
* EL156.cbl
  2239             20  PI-OE-REFERENCE-1.
  2240                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2241                 25  PI-OE-REF-1-SUFF    PIC XX.
  2242
  2243     12  PI-SESSION-IN-PROGRESS          PIC X.
  2244         88  CLAIM-SESSION                   VALUE '1'.
  2245         88  CREDIT-SESSION                  VALUE '2'.
  2246         88  WARRANTY-SESSION                VALUE '3'.
  2247         88  MORTGAGE-SESSION                VALUE '4'.
  2248         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2249
  2250
  2251*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2252
  2253     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2254     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2255
  2256     12  PI-CREDIT-USER                  PIC X.
  2257         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2258         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2259
  2260     12  PI-CLAIM-USER                   PIC X.
  2261         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2262         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2263
  2264     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2265         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2266         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2267         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2268         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2269         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2270
  2271     12  PI-PROCESSOR-ID                 PIC X(4).
  2272
  2273     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2274
  2275     12  PI-MEMBER-CAPTION               PIC X(10).
  2276
  2277     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2278         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2279
  2280     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2281     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2282     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2283     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2284
  2285     12  PI-AH-OVERRIDE-L1               PIC X.
  2286     12  PI-AH-OVERRIDE-L2               PIC XX.
  2287     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2288     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2289
  2290     12  PI-NEW-SYSTEM                   PIC X(2).
  2291
  2292     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2293     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2294         88  PI-USES-PAID-TO                 VALUE '1'.
  2295     12  PI-CRDTCRD-SYSTEM.
  2296         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  48
* EL156.cbl
  2297             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2298             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2299         16  PI-CC-MONTH-END-DT          PIC XX.
  2300     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2301
  2302     12  PI-OE-REFERENCE-2.
  2303         16  PI-OE-REF-2-PRIME           PIC X(10).
  2304         16  PI-OE-REF-2-SUFF            PIC X.
  2305
  2306     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2307
  2308     12  PI-LANGUAGE-TYPE                PIC X.
  2309             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2310             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2311             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2312
  2313     12  PI-POLICY-LINKAGE-IND           PIC X.
  2314         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2315         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2316                                                   LOW-VALUES.
  2317
  2318     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2319     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2320         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2321         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2322
  2323     12  PI-PROCESSOR-CSR-IND            PIC X.
  2324         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2325         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2326
  2327     12  FILLER                          PIC X(3).
  2328
  2329     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2330
  2331     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2332         PI-SYSTEM-LEVEL.
  2333
  2334         16  PI-ENTRY-CODES.
  2335             20  PI-ENTRY-CD-1           PIC X.
  2336             20  PI-ENTRY-CD-2           PIC X.
  2337
  2338         16  PI-RETURN-CODES.
  2339             20  PI-RETURN-CD-1          PIC X.
  2340             20  PI-RETURN-CD-2          PIC X.
  2341
  2342         16  PI-UPDATE-STATUS-SAVE.
  2343             20  PI-UPDATE-BY            PIC X(4).
  2344             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2345
  2346         16  PI-LOWER-CASE-LETTERS       PIC X.
  2347             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2348
  2349*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2350*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2351*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2352
  2353         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2354             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  49
* EL156.cbl
  2355             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2356             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2357             88  ACCNT-CNTL                  VALUE '3'.
  2358             88  CARR-ACCNT-CNTL             VALUE '4'.
  2359
  2360         16  PI-PROCESSOR-CAP-LIST.
  2361             20  PI-SYSTEM-CONTROLS.
  2362                24 PI-SYSTEM-DISPLAY     PIC X.
  2363                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2364                24 PI-SYSTEM-MODIFY      PIC X.
  2365                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2366             20  FILLER                  PIC XX.
  2367             20  PI-DISPLAY-CAP          PIC X.
  2368                 88  DISPLAY-CAP             VALUE 'Y'.
  2369             20  PI-MODIFY-CAP           PIC X.
  2370                 88  MODIFY-CAP              VALUE 'Y'.
  2371             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2372                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2373             20  PI-FORCE-CAP            PIC X.
  2374                 88  FORCE-CAP               VALUE 'Y'.
  2375
  2376         16  PI-PROGRAM-CONTROLS.
  2377             20  PI-PGM-PRINT-OPT        PIC X.
  2378             20  PI-PGM-FORMAT-OPT       PIC X.
  2379             20  PI-PGM-PROCESS-OPT      PIC X.
  2380             20  PI-PGM-TOTALS-OPT       PIC X.
  2381
  2382         16  PI-HELP-INTERFACE.
  2383             20  PI-LAST-ERROR-NO        PIC X(4).
  2384             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2385
  2386         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2387             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2388
  2389         16  PI-CR-CONTROL-IN-PROGRESS.
  2390             20  PI-CR-CARRIER           PIC X.
  2391             20  PI-CR-GROUPING          PIC X(6).
  2392             20  PI-CR-STATE             PIC XX.
  2393             20  PI-CR-ACCOUNT           PIC X(10).
  2394             20  PI-CR-FIN-RESP          PIC X(10).
  2395             20  PI-CR-TYPE              PIC X.
  2396
  2397         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2398
  2399         16  PI-CR-MONTH-END-DT          PIC XX.
  2400
  2401         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2402             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2403             88  PI-ZERO-CARRIER             VALUE '1'.
  2404             88  PI-ZERO-GROUPING            VALUE '2'.
  2405             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2406
  2407         16  PI-CARRIER-SECURITY         PIC X.
  2408             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2409
  2410         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2411             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2412             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  50
* EL156.cbl
  2413
  2414         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2415             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2416                                         INDEXED BY PI-ACCESS-NDX
  2417                                         PIC X.
  2418
  2419         16  PI-GA-BILLING-CONTROL       PIC X.
  2420             88  PI-GA-BILLING               VALUE '1'.
  2421
  2422         16  PI-MAIL-PROCESSING          PIC X.
  2423             88  PI-MAIL-YES                 VALUE 'Y'.
  2424
  2425         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2426
  2427         16  PI-AR-SYSTEM.
  2428             20  PI-AR-PROCESSING-CNTL   PIC X.
  2429                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2430             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2431             20  PI-AR-MONTH-END-DT      PIC XX.
  2432
  2433         16  PI-MP-SYSTEM.
  2434             20  PI-MORTGAGE-USER            PIC X.
  2435                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2436                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2437             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2438                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2439                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2440                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2441                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2442                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2443             20  PI-MP-MONTH-END-DT          PIC XX.
  2444             20  PI-MP-REFERENCE-NO.
  2445                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2446                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2447
  2448         16  PI-LABEL-CONTROL            PIC X(01).
  2449             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2450             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2451
  2452         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2453             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2454
  2455         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2456             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2457             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2458
  2459         16  FILLER                      PIC X(14).
  2460
  2461     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2462******************************************************************
  2463     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2464         16  PI-SAVE-FORM        PIC X(12).
  2465         16  PI-ACCT-KEY         PIC X(26).
  2466         16  PI-PAYEE-NAME       PIC X(30).
  2467         16  PI-DAILY-RATE       PIC S9(3)V99.
  2468         16  PI-MONTH-END-SAVE   PIC XX.
  2469         16  PI-BENEFIT-SAVE.
  2470             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  51
* EL156.cbl
  2471             20  PI-BEN-TYPE     PIC X.
  2472         16  PI-MANUAL-SW        PIC 9.
  2473         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2474         16  PI-PASS-SW          PIC X.
  2475         16  PI-PFKEY-USED       PIC X.
  2476         16  PI-CK-ASSIGN        PIC X.
  2477         16  PI-FATAL-COUNT      PIC 99.
  2478         16  PI-FORCE-COUNT      PIC 99.
  2479         16  PI-SAVE-INPUT.
  2480             20  PI-PMTTYPE      PIC X.
  2481             20  PI-PAYEE.
  2482                 24  PI-PAYEE-TYPE PIC X.
  2483                 24  PI-PAYEE-SEQ  PIC X.
  2484                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2485                   PI-PAYEE-SEQ    PIC S9.
  2486             20  PI-PMTNOTE1     PIC X(60).
  2487             20  PI-PMTNOTE2     PIC X(60).
  2488             20  PI-OFFLINE      PIC X.
  2489             20  PI-ECHECKNO     PIC X(7).
  2490             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2491                 28  PI-ECHECKNO-N     PIC X.
  2492                 28  PI-ECHECKNO-6     PIC X(6).
  2493             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2494                 24  PI-ECHECKNO-CR    PIC XX.
  2495                 24  PI-ECHECKNO-5     PIC X(5).
  2496             20  PI-HOLDTIL      PIC 9(6).
  2497             20  PI-EPYFROM      PIC 9(6).
  2498             20  PI-EPYTHRU      PIC 9(6).
  2499             20  PI-EDAYS        PIC S9(5).
  2500             20  PI-EPYAMT       PIC S9(7)V99.
  2501             20  PI-ERESV        PIC S9(7)V99.
  2502             20  PI-EEXPENS      PIC 9(6)V99.
  2503             20  PI-ETYPE        PIC X.
  2504             20  PI-CASH         PIC X.
  2505             20  PI-GROUPED      PIC X.
  2506             20  PI-INT-RATE     PIC S99V9(5).
  2507             20  PI-AIGFROM      PIC 9(6).
  2508             20  PI-LOAN-NO      PIC X(20).
  2509             20  PI-PROOF-DATE   PIC 9(6).
  2510             20  PI-PRINT-EOB-YN PIC X.
  2511             20  PI-PRINT-CLM-FRM-YN PIC X.
  2512             20  PI-PRINT-SURVEY-YN PIC X.
  2513             20  PI-SPECIAL-RELEASE-YN PIC X.
  2514             20  pi-int-to-rem-borr pic x.
  2515         16  PI-SAVE-COMPUTED.
  2516             20  PI-CCHECKNO     PIC X(7).
  2517             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2518                 28  PI-CCHECKNO-N     PIC X.
  2519                 28  PI-CCHECKNO-6     PIC X(6).
  2520             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2521                 24  PI-CCHECKNO-CR    PIC XX.
  2522                 24  PI-CCHECKNO-5     PIC X(5).
  2523             20  PI-CPYFROM      PIC XX.
  2524             20  PI-CPYTHRU      PIC XX.
  2525             20  PI-CDAYS        PIC S9(5).
  2526             20  PI-CPYAMT       PIC S9(7)V99.
  2527             20  PI-CRESV        PIC 9(6)V99.
  2528             20  PI-CEXPENS      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  52
* EL156.cbl
  2529             20  PI-PMT-APPR-SW  PIC X.
  2530                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2531                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2532                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2533         16  PI-PREV-CLMNO       PIC X(7).
  2534         16  PI-LF-COVERAGE-TYPE PIC X.
  2535         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2536         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2537         16  PI-PROVISIONAL-IND  PIC X.
  2538             88 PI-PROV-PMT      VALUE 'P'.
  2539         16  PI-PREV-TRLR-KEY    PIC X(22).
  2540         16  PI-SPLIT-PMT-SW     PIC X.
  2541         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2542         16  PI-ACTIVITY-CODE    PIC 99.
  2543         16  PI-RESET-SW         PIC X.
  2544         16  PI-SPECIAL-BEN-SW   PIC X.
  2545             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2546         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2547         16  PI-EXP-DT           PIC XX.
  2548         16  PI-LOAN-DUE-DAY     PIC 99.
  2549         16  PI-3RD-PARTY-SW     PIC X.
  2550         16  PI-LOAN-UPDATE-SW   PIC X.
  2551
  2552         16  PI-DMD-DATA.
  2553             20  PI-SV-CERT-KEY       PIC X(21).
  2554             20  PI-SV-CERT-NO        PIC X(11).
  2555             20  PI-SV-BEN            PIC X(10).
  2556             20  PI-SV-CCN            PIC X(16).
  2557             20  PI-INTEREST-PAID-IND PIC X.
  2558                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2559             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2560             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2561             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2562             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2563         16  PI-AT-EOB-CODES.
  2564             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2565         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2566         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2567         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2568         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2569         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2570         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2571         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2572         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2573         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2574         16  PI-LF-BENEFIT-CD         PIC X(2).
  2575         16  PI-EOB-CODES-EXIST PIC X.
  2576         16  PI-SET-NOTE2-MDT   PIC X.
  2577         16  PI-VFY-2ND-BENE          PIC X.
  2578         16  PI-CLM-TYPE              PIC X.
  2579         16  PI-APPROVAL-LEVEL        PIC X.
  2580         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2581         16  PI-REAUDIT-NEEDED        PIC X.
  2582         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2583         16  PI-AH-BENEFIT-CD         PIC XX.
  2584         16  pi-ah-term               pic s999 comp-3.
  2585         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2586         16  pi-max-ext               pic 999.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  53
* EL156.cbl
  2587         16  pi-max-ext-used          pic x.
  2588         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2589         16  PI-JOINT-COV-IND         PIC X.
  2590             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2591             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2592         16  PI-JOINT-INSURED-IND     PIC X.
  2593             88  PI-JOINT-INSURED        VALUE 'Y'.
  2594             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2595         16  pi-int-payees-name       pic x(30).
  2596         16  PI-RB-JOINT-COV-IND      PIC X.
  2597             88  PI-RB-JOINT-COVERAGE    VALUE 'J'.
  2598             88  PI-RB-SINGLE-COVERAGE   VALUE ' '.
  2599         16  pi-ach-payment           pic x.
  2600*00781          16  FILLER                   PIC X(176).
  2601*052506         16  FILLER                   PIC X(161).
  2602*031808         16  FILLER                   PIC X(154).
  2603*091808         16  FILLER                   PIC X(152).
  2604*041710         16  FILLER                   PIC X(94).
  2605         16  FILLER                   PIC X(34).
  2606
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  54
* EL156.cbl
  2608*    COPY ELCJPFX.
  2609******************************************************************
  2610*                                                                *
  2611*                                                                *
  2612*                            ELCJPFX.                            *
  2613*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2614*                            VMOD=2.002                          *
  2615*                                                                *
  2616*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2617*                                                                *
  2618*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2619*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2620*        ELCNTL - CONTROL FILE                                   *
  2621*        ELMSTR - CLAIM MASTERS                                  *
  2622*        ELTRLR - ACTIVITY TRAILERS                              *
  2623*        ELCHKQ - CHECK QUE                                      *
  2624******************************************************************
  2625 01  JOURNAL-RECORD.
  2626     12  jp-date                     pic s9(5) comp-3.
  2627     12  jp-time                     pic s9(7) comp-3.
  2628     12  JP-USER-ID                  PIC X(4).
  2629     12  JP-FILE-ID                  PIC X(8).
  2630     12  JP-PROGRAM-ID               PIC X(8).
  2631     12  JP-RECORD-TYPE              PIC X.
  2632         88 JP-ADD              VALUE 'A'.
  2633         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2634         88 JP-AFTER-CHANGE     VALUE 'C'.
  2635         88 JP-DELETE           VALUE 'D'.
  2636         88 JP-GENERIC-DELETE   VALUE 'G'.
  2637         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2638         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2639     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2640     12  JP-RECORD-AREA
  2641
  2642
  2643                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  55
* EL156.cbl
  2645*    COPY ELCAID.
  2646******************************************************************
  2647*                                                                *
  2648*                            ELCAID.                             *
  2649*                            VMOD=2.001                          *
  2650*                                                                *
  2651*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2652*                                                                *
  2653*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2654*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2655******************************************************************
  2656
  2657 01  DFHAID.
  2658   02  DFHNULL   PIC  X  VALUE  ' '.
  2659   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2660   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2661   02  DFHPEN    PIC  X  VALUE  '='.
  2662   02  DFHOPID   PIC  X  VALUE  'W'.
  2663   02  DFHPA1    PIC  X  VALUE  '%'.
  2664   02  DFHPA2    PIC  X  VALUE  '>'.
  2665   02  DFHPA3    PIC  X  VALUE  ','.
  2666   02  DFHPF1    PIC  X  VALUE  '1'.
  2667   02  DFHPF2    PIC  X  VALUE  '2'.
  2668   02  DFHPF3    PIC  X  VALUE  '3'.
  2669   02  DFHPF4    PIC  X  VALUE  '4'.
  2670   02  DFHPF5    PIC  X  VALUE  '5'.
  2671   02  DFHPF6    PIC  X  VALUE  '6'.
  2672   02  DFHPF7    PIC  X  VALUE  '7'.
  2673   02  DFHPF8    PIC  X  VALUE  '8'.
  2674   02  DFHPF9    PIC  X  VALUE  '9'.
  2675   02  DFHPF10   PIC  X  VALUE  ':'.
  2676   02  DFHPF11   PIC  X  VALUE  '#'.
  2677   02  DFHPF12   PIC  X  VALUE  '@'.
  2678   02  DFHPF13   PIC  X  VALUE  'A'.
  2679   02  DFHPF14   PIC  X  VALUE  'B'.
  2680   02  DFHPF15   PIC  X  VALUE  'C'.
  2681   02  DFHPF16   PIC  X  VALUE  'D'.
  2682   02  DFHPF17   PIC  X  VALUE  'E'.
  2683   02  DFHPF18   PIC  X  VALUE  'F'.
  2684   02  DFHPF19   PIC  X  VALUE  'G'.
  2685   02  DFHPF20   PIC  X  VALUE  'H'.
  2686   02  DFHPF21   PIC  X  VALUE  'I'.
  2687*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2688   02  DFHPF22   PIC  X  VALUE  '['.
  2689   02  DFHPF23   PIC  X  VALUE  '.'.
  2690   02  DFHPF24   PIC  X  VALUE  '<'.
  2691   02  DFHMSRE   PIC  X  VALUE  'X'.
  2692   02  DFHSTRF   PIC  X  VALUE  'h'.
  2693   02  DFHTRIG   PIC  X  VALUE  '"'.
  2694 01  FILLER    REDEFINES DFHAID.
  2695     12  FILLER              PIC X(8).
  2696     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  56
* EL156.cbl
  2698*    COPY EL156S.
  2699 01  EL156AI.
  2700     05  FILLER            PIC  X(0012).
  2701*    -------------------------------
  2702     05  RUNDTEAL PIC S9(0004) COMP.
  2703     05  RUNDTEAF PIC  X(0001).
  2704     05  FILLER REDEFINES RUNDTEAF.
  2705         10  RUNDTEAA PIC  X(0001).
  2706     05  RUNDTEAI PIC  X(0008).
  2707*    -------------------------------
  2708     05  RUNTIMAL PIC S9(0004) COMP.
  2709     05  RUNTIMAF PIC  X(0001).
  2710     05  FILLER REDEFINES RUNTIMAF.
  2711         10  RUNTIMAA PIC  X(0001).
  2712     05  RUNTIMAI PIC  X(0005).
  2713*    -------------------------------
  2714     05  SEQUL PIC S9(0004) COMP.
  2715     05  SEQUF PIC  X(0001).
  2716     05  FILLER REDEFINES SEQUF.
  2717         10  SEQUA PIC  X(0001).
  2718     05  SEQUI PIC  X(0010).
  2719*    -------------------------------
  2720     05  CLMNOL PIC S9(0004) COMP.
  2721     05  CLMNOF PIC  X(0001).
  2722     05  FILLER REDEFINES CLMNOF.
  2723         10  CLMNOA PIC  X(0001).
  2724     05  CLMNOI PIC  X(0007).
  2725*    -------------------------------
  2726     05  CARRL PIC S9(0004) COMP.
  2727     05  CARRF PIC  X(0001).
  2728     05  FILLER REDEFINES CARRF.
  2729         10  CARRA PIC  X(0001).
  2730     05  CARRI PIC  X(0001).
  2731*    -------------------------------
  2732     05  CERTNOL PIC S9(0004) COMP.
  2733     05  CERTNOF PIC  X(0001).
  2734     05  FILLER REDEFINES CERTNOF.
  2735         10  CERTNOA PIC  X(0001).
  2736     05  CERTNOI PIC  X(0010).
  2737*    -------------------------------
  2738     05  SUFXL PIC S9(0004) COMP.
  2739     05  SUFXF PIC  X(0001).
  2740     05  FILLER REDEFINES SUFXF.
  2741         10  SUFXA PIC  X(0001).
  2742     05  SUFXI PIC  X(0001).
  2743*    -------------------------------
  2744     05  CLMTYPL PIC S9(0004) COMP.
  2745     05  CLMTYPF PIC  X(0001).
  2746     05  FILLER REDEFINES CLMTYPF.
  2747         10  CLMTYPA PIC  X(0001).
  2748     05  CLMTYPI PIC  X(0006).
  2749*    -------------------------------
  2750     05  CLMSTATL PIC S9(0004) COMP.
  2751     05  CLMSTATF PIC  X(0001).
  2752     05  FILLER REDEFINES CLMSTATF.
  2753         10  CLMSTATA PIC  X(0001).
  2754     05  CLMSTATI PIC  X(0006).
  2755*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  57
* EL156.cbl
  2756     05  LSTNMEL PIC S9(0004) COMP.
  2757     05  LSTNMEF PIC  X(0001).
  2758     05  FILLER REDEFINES LSTNMEF.
  2759         10  LSTNMEA PIC  X(0001).
  2760     05  LSTNMEI PIC  X(0015).
  2761*    -------------------------------
  2762     05  FSTNMEL PIC S9(0004) COMP.
  2763     05  FSTNMEF PIC  X(0001).
  2764     05  FILLER REDEFINES FSTNMEF.
  2765         10  FSTNMEA PIC  X(0001).
  2766     05  FSTNMEI PIC  X(0012).
  2767*    -------------------------------
  2768     05  MINITL PIC S9(0004) COMP.
  2769     05  MINITF PIC  X(0001).
  2770     05  FILLER REDEFINES MINITF.
  2771         10  MINITA PIC  X(0001).
  2772     05  MINITI PIC  X(0001).
  2773*    -------------------------------
  2774     05  PRIMHDGL PIC S9(0004) COMP.
  2775     05  PRIMHDGF PIC  X(0001).
  2776     05  FILLER REDEFINES PRIMHDGF.
  2777         10  PRIMHDGA PIC  X(0001).
  2778     05  PRIMHDGI PIC  X(0012).
  2779*    -------------------------------
  2780     05  PCERTNOL PIC S9(0004) COMP.
  2781     05  PCERTNOF PIC  X(0001).
  2782     05  FILLER REDEFINES PCERTNOF.
  2783         10  PCERTNOA PIC  X(0001).
  2784     05  PCERTNOI PIC  X(0010).
  2785*    -------------------------------
  2786     05  PSUFXL PIC S9(0004) COMP.
  2787     05  PSUFXF PIC  X(0001).
  2788     05  FILLER REDEFINES PSUFXF.
  2789         10  PSUFXA PIC  X(0001).
  2790     05  PSUFXI PIC  X(0001).
  2791*    -------------------------------
  2792     05  STATUSL PIC S9(0004) COMP.
  2793     05  STATUSF PIC  X(0001).
  2794     05  FILLER REDEFINES STATUSF.
  2795         10  STATUSA PIC  X(0001).
  2796     05  STATUSI PIC  X(0010).
  2797*    -------------------------------
  2798     05  LOANHL PIC S9(0004) COMP.
  2799     05  LOANHF PIC  X(0001).
  2800     05  FILLER REDEFINES LOANHF.
  2801         10  LOANHA PIC  X(0001).
  2802     05  LOANHI PIC  X(0014).
  2803*    -------------------------------
  2804     05  LOANNOL PIC S9(0004) COMP.
  2805     05  LOANNOF PIC  X(0001).
  2806     05  FILLER REDEFINES LOANNOF.
  2807         10  LOANNOA PIC  X(0001).
  2808     05  LOANNOI PIC  X(0025).
  2809*    -------------------------------
  2810     05  DUEDAYHL PIC S9(0004) COMP.
  2811     05  DUEDAYHF PIC  X(0001).
  2812     05  FILLER REDEFINES DUEDAYHF.
  2813         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  58
* EL156.cbl
  2814     05  DUEDAYHI PIC  X(0008).
  2815*    -------------------------------
  2816     05  DUEDAYL PIC S9(0004) COMP.
  2817     05  DUEDAYF PIC  X(0001).
  2818     05  FILLER REDEFINES DUEDAYF.
  2819         10  DUEDAYA PIC  X(0001).
  2820     05  DUEDAYI PIC  X(0002).
  2821*    -------------------------------
  2822     05  ZINTHL PIC S9(0004) COMP.
  2823     05  ZINTHF PIC  X(0001).
  2824     05  FILLER REDEFINES ZINTHF.
  2825         10  ZINTHA PIC  X(0001).
  2826     05  ZINTHI PIC  X(0009).
  2827*    -------------------------------
  2828     05  ZINTL PIC S9(0004) COMP.
  2829     05  ZINTF PIC  X(0001).
  2830     05  FILLER REDEFINES ZINTF.
  2831         10  ZINTA PIC  X(0001).
  2832     05  ZINTI PIC  99V99999.
  2833*    -------------------------------
  2834     05  PTHRHDGL PIC S9(0004) COMP.
  2835     05  PTHRHDGF PIC  X(0001).
  2836     05  FILLER REDEFINES PTHRHDGF.
  2837         10  PTHRHDGA PIC  X(0001).
  2838     05  PTHRHDGI PIC  X(0014).
  2839*    -------------------------------
  2840     05  PDTHRUL PIC S9(0004) COMP.
  2841     05  PDTHRUF PIC  X(0001).
  2842     05  FILLER REDEFINES PDTHRUF.
  2843         10  PDTHRUA PIC  X(0001).
  2844     05  PDTHRUI PIC  X(0008).
  2845*    -------------------------------
  2846     05  TOTPAIDL PIC S9(0004) COMP.
  2847     05  TOTPAIDF PIC  X(0001).
  2848     05  FILLER REDEFINES TOTPAIDF.
  2849         10  TOTPAIDA PIC  X(0001).
  2850     05  TOTPAIDI PIC  X(0010).
  2851*    -------------------------------
  2852     05  COVERL PIC S9(0004) COMP.
  2853     05  COVERF PIC  X(0001).
  2854     05  FILLER REDEFINES COVERF.
  2855         10  COVERA PIC  X(0001).
  2856     05  COVERI PIC  X(0010).
  2857*    -------------------------------
  2858     05  INCURL PIC S9(0004) COMP.
  2859     05  INCURF PIC  X(0001).
  2860     05  FILLER REDEFINES INCURF.
  2861         10  INCURA PIC  X(0001).
  2862     05  INCURI PIC  X(0008).
  2863*    -------------------------------
  2864     05  LSTDTEL PIC S9(0004) COMP.
  2865     05  LSTDTEF PIC  X(0001).
  2866     05  FILLER REDEFINES LSTDTEF.
  2867         10  LSTDTEA PIC  X(0001).
  2868     05  LSTDTEI PIC  X(0008).
  2869*    -------------------------------
  2870     05  CRTSTATL PIC S9(0004) COMP.
  2871     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  59
* EL156.cbl
  2872     05  FILLER REDEFINES CRTSTATF.
  2873         10  CRTSTATA PIC  X(0001).
  2874     05  CRTSTATI PIC  X(0010).
  2875*    -------------------------------
  2876     05  EFFECTL PIC S9(0004) COMP.
  2877     05  EFFECTF PIC  X(0001).
  2878     05  FILLER REDEFINES EFFECTF.
  2879         10  EFFECTA PIC  X(0001).
  2880     05  EFFECTI PIC  X(0008).
  2881*    -------------------------------
  2882     05  TERMSL PIC S9(0004) COMP.
  2883     05  TERMSF PIC  X(0001).
  2884     05  FILLER REDEFINES TERMSF.
  2885         10  TERMSA PIC  X(0001).
  2886     05  TERMSI PIC  X(0011).
  2887*    -------------------------------
  2888     05  STACCTL PIC S9(0004) COMP.
  2889     05  STACCTF PIC  X(0001).
  2890     05  FILLER REDEFINES STACCTF.
  2891         10  STACCTA PIC  X(0001).
  2892     05  STACCTI PIC  X(0013).
  2893*    -------------------------------
  2894     05  EXPDTEHL PIC S9(0004) COMP.
  2895     05  EXPDTEHF PIC  X(0001).
  2896     05  FILLER REDEFINES EXPDTEHF.
  2897         10  EXPDTEHA PIC  X(0001).
  2898     05  EXPDTEHI PIC  X(0014).
  2899*    -------------------------------
  2900     05  EXPDTEL PIC S9(0004) COMP.
  2901     05  EXPDTEF PIC  X(0001).
  2902     05  FILLER REDEFINES EXPDTEF.
  2903         10  EXPDTEA PIC  X(0001).
  2904     05  EXPDTEI PIC  X(0008).
  2905*    -------------------------------
  2906     05  BENECAPL PIC S9(0004) COMP.
  2907     05  BENECAPF PIC  X(0001).
  2908     05  FILLER REDEFINES BENECAPF.
  2909         10  BENECAPA PIC  X(0001).
  2910     05  BENECAPI PIC  X(0013).
  2911*    -------------------------------
  2912     05  BENEL PIC S9(0004) COMP.
  2913     05  BENEF PIC  X(0001).
  2914     05  FILLER REDEFINES BENEF.
  2915         10  BENEA PIC  X(0001).
  2916     05  BENEI PIC  X(0009).
  2917*    -------------------------------
  2918     05  FORMTYPL PIC S9(0004) COMP.
  2919     05  FORMTYPF PIC  X(0001).
  2920     05  FILLER REDEFINES FORMTYPF.
  2921         10  FORMTYPA PIC  X(0001).
  2922     05  FORMTYPI PIC  X(0001).
  2923*    -------------------------------
  2924     05  PMTTYPEL PIC S9(0004) COMP.
  2925     05  PMTTYPEF PIC  X(0001).
  2926     05  FILLER REDEFINES PMTTYPEF.
  2927         10  PMTTYPEA PIC  X(0001).
  2928     05  PMTTYPEI PIC  X(0001).
  2929*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  60
* EL156.cbl
  2930     05  PAYEEL PIC S9(0004) COMP.
  2931     05  PAYEEF PIC  X(0001).
  2932     05  FILLER REDEFINES PAYEEF.
  2933         10  PAYEEA PIC  X(0001).
  2934     05  PAYEEI PIC  X(0002).
  2935*    -------------------------------
  2936     05  CHECKNOL PIC S9(0004) COMP.
  2937     05  CHECKNOF PIC  X(0001).
  2938     05  FILLER REDEFINES CHECKNOF.
  2939         10  CHECKNOA PIC  X(0001).
  2940     05  CHECKNOI PIC  X(0007).
  2941*    -------------------------------
  2942     05  OFFLINEL PIC S9(0004) COMP.
  2943     05  OFFLINEF PIC  X(0001).
  2944     05  FILLER REDEFINES OFFLINEF.
  2945         10  OFFLINEA PIC  X(0001).
  2946     05  OFFLINEI PIC  X(0001).
  2947*    -------------------------------
  2948     05  HOLDTILL PIC S9(0004) COMP.
  2949     05  HOLDTILF PIC  X(0001).
  2950     05  FILLER REDEFINES HOLDTILF.
  2951         10  HOLDTILA PIC  X(0001).
  2952     05  HOLDTILI PIC  X(0008).
  2953*    -------------------------------
  2954     05  NOTE1L PIC S9(0004) COMP.
  2955     05  NOTE1F PIC  X(0001).
  2956     05  FILLER REDEFINES NOTE1F.
  2957         10  NOTE1A PIC  X(0001).
  2958     05  NOTE1I PIC  X(0060).
  2959*    -------------------------------
  2960     05  ITRB1L PIC S9(0004) COMP.
  2961     05  ITRB1F PIC  X(0001).
  2962     05  FILLER REDEFINES ITRB1F.
  2963         10  ITRB1A PIC  X(0001).
  2964     05  ITRB1I PIC  X(0008).
  2965*    -------------------------------
  2966     05  NOTE2L PIC S9(0004) COMP.
  2967     05  NOTE2F PIC  X(0001).
  2968     05  FILLER REDEFINES NOTE2F.
  2969         10  NOTE2A PIC  X(0001).
  2970     05  NOTE2I PIC  X(0060).
  2971*    -------------------------------
  2972     05  ITRB2L PIC S9(0004) COMP.
  2973     05  ITRB2F PIC  X(0001).
  2974     05  FILLER REDEFINES ITRB2F.
  2975         10  ITRB2A PIC  X(0001).
  2976     05  ITRB2I PIC  X(0010).
  2977*    -------------------------------
  2978     05  EOBYNL PIC S9(0004) COMP.
  2979     05  EOBYNF PIC  X(0001).
  2980     05  FILLER REDEFINES EOBYNF.
  2981         10  EOBYNA PIC  X(0001).
  2982     05  EOBYNI PIC  X(0001).
  2983*    -------------------------------
  2984     05  CLMFMYNL PIC S9(0004) COMP.
  2985     05  CLMFMYNF PIC  X(0001).
  2986     05  FILLER REDEFINES CLMFMYNF.
  2987         10  CLMFMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  61
* EL156.cbl
  2988     05  CLMFMYNI PIC  X(0001).
  2989*    -------------------------------
  2990     05  SURVYYNL PIC S9(0004) COMP.
  2991     05  SURVYYNF PIC  X(0001).
  2992     05  FILLER REDEFINES SURVYYNF.
  2993         10  SURVYYNA PIC  X(0001).
  2994     05  SURVYYNI PIC  X(0001).
  2995*    -------------------------------
  2996     05  SPRELYNL PIC S9(0004) COMP.
  2997     05  SPRELYNF PIC  X(0001).
  2998     05  FILLER REDEFINES SPRELYNF.
  2999         10  SPRELYNA PIC  X(0001).
  3000     05  SPRELYNI PIC  X(0001).
  3001*    -------------------------------
  3002     05  PINTHL PIC S9(0004) COMP.
  3003     05  PINTHF PIC  X(0001).
  3004     05  FILLER REDEFINES PINTHF.
  3005         10  PINTHA PIC  X(0001).
  3006     05  PINTHI PIC  X(0004).
  3007*    -------------------------------
  3008     05  PINTL PIC S9(0004) COMP.
  3009     05  PINTF PIC  X(0001).
  3010     05  FILLER REDEFINES PINTF.
  3011         10  PINTA PIC  X(0001).
  3012     05  PINTI PIC  X(0008).
  3013*    -------------------------------
  3014     05  ITRBYNL PIC S9(0004) COMP.
  3015     05  ITRBYNF PIC  X(0001).
  3016     05  FILLER REDEFINES ITRBYNF.
  3017         10  ITRBYNA PIC  X(0001).
  3018     05  ITRBYNI PIC  X(0001).
  3019*    -------------------------------
  3020     05  PROOFDTL PIC S9(0004) COMP.
  3021     05  PROOFDTF PIC  X(0001).
  3022     05  FILLER REDEFINES PROOFDTF.
  3023         10  PROOFDTA PIC  X(0001).
  3024     05  PROOFDTI PIC  X(0008).
  3025*    -------------------------------
  3026     05  AIGFRMHL PIC S9(0004) COMP.
  3027     05  AIGFRMHF PIC  X(0001).
  3028     05  FILLER REDEFINES AIGFRMHF.
  3029         10  AIGFRMHA PIC  X(0001).
  3030     05  AIGFRMHI PIC  X(0012).
  3031*    -------------------------------
  3032     05  AIGFROML PIC S9(0004) COMP.
  3033     05  AIGFROMF PIC  X(0001).
  3034     05  FILLER REDEFINES AIGFROMF.
  3035         10  AIGFROMA PIC  X(0001).
  3036     05  AIGFROMI PIC  X(0008).
  3037*    -------------------------------
  3038     05  PMTHDGAL PIC S9(0004) COMP.
  3039     05  PMTHDGAF PIC  X(0001).
  3040     05  FILLER REDEFINES PMTHDGAF.
  3041         10  PMTHDGAA PIC  X(0001).
  3042     05  PMTHDGAI PIC  X(0066).
  3043*    -------------------------------
  3044     05  EPYFROML PIC S9(0004) COMP.
  3045     05  EPYFROMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  62
* EL156.cbl
  3046     05  FILLER REDEFINES EPYFROMF.
  3047         10  EPYFROMA PIC  X(0001).
  3048     05  EPYFROMI PIC  X(0008).
  3049*    -------------------------------
  3050     05  EPYTHRUL PIC S9(0004) COMP.
  3051     05  EPYTHRUF PIC  X(0001).
  3052     05  FILLER REDEFINES EPYTHRUF.
  3053         10  EPYTHRUA PIC  X(0001).
  3054     05  EPYTHRUI PIC  X(0008).
  3055*    -------------------------------
  3056     05  EDAYSL PIC S9(0004) COMP.
  3057     05  EDAYSF PIC  X(0001).
  3058     05  FILLER REDEFINES EDAYSF.
  3059         10  EDAYSA PIC  X(0001).
  3060     05  EDAYSI PIC  S9(6).
  3061*    -------------------------------
  3062     05  EPYAMTL PIC S9(0004) COMP.
  3063     05  EPYAMTF PIC  X(0001).
  3064     05  FILLER REDEFINES EPYAMTF.
  3065         10  EPYAMTA PIC  X(0001).
  3066     05  EPYAMTI PIC  S9(8)V99.
  3067*    -------------------------------
  3068     05  ERESVL PIC S9(0004) COMP.
  3069     05  ERESVF PIC  X(0001).
  3070     05  FILLER REDEFINES ERESVF.
  3071         10  ERESVA PIC  X(0001).
  3072     05  ERESVI PIC  S9(7)V99.
  3073*    -------------------------------
  3074     05  ETYPEL PIC S9(0004) COMP.
  3075     05  ETYPEF PIC  X(0001).
  3076     05  FILLER REDEFINES ETYPEF.
  3077         10  ETYPEA PIC  X(0001).
  3078     05  ETYPEI PIC  X(0001).
  3079*    -------------------------------
  3080     05  EEXPENSL PIC S9(0004) COMP.
  3081     05  EEXPENSF PIC  X(0001).
  3082     05  FILLER REDEFINES EEXPENSF.
  3083         10  EEXPENSA PIC  X(0001).
  3084     05  EEXPENSI PIC  9(6)V99.
  3085*    -------------------------------
  3086     05  CPYFROML PIC S9(0004) COMP.
  3087     05  CPYFROMF PIC  X(0001).
  3088     05  FILLER REDEFINES CPYFROMF.
  3089         10  CPYFROMA PIC  X(0001).
  3090     05  CPYFROMI PIC  X(0008).
  3091*    -------------------------------
  3092     05  CPYTHRUL PIC S9(0004) COMP.
  3093     05  CPYTHRUF PIC  X(0001).
  3094     05  FILLER REDEFINES CPYTHRUF.
  3095         10  CPYTHRUA PIC  X(0001).
  3096     05  CPYTHRUI PIC  X(0008).
  3097*    -------------------------------
  3098     05  CDAYSL PIC S9(0004) COMP.
  3099     05  CDAYSF PIC  X(0001).
  3100     05  FILLER REDEFINES CDAYSF.
  3101         10  CDAYSA PIC  X(0001).
  3102     05  CDAYSI PIC  9(6).
  3103*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  63
* EL156.cbl
  3104     05  CPYAMTL PIC S9(0004) COMP.
  3105     05  CPYAMTF PIC  X(0001).
  3106     05  FILLER REDEFINES CPYAMTF.
  3107         10  CPYAMTA PIC  X(0001).
  3108     05  CPYAMTI PIC  S9(8)V99.
  3109*    -------------------------------
  3110     05  CRESVL PIC S9(0004) COMP.
  3111     05  CRESVF PIC  X(0001).
  3112     05  FILLER REDEFINES CRESVF.
  3113         10  CRESVA PIC  X(0001).
  3114     05  CRESVI PIC  9(6)V99.
  3115*    -------------------------------
  3116     05  CEXPENSL PIC S9(0004) COMP.
  3117     05  CEXPENSF PIC  X(0001).
  3118     05  FILLER REDEFINES CEXPENSF.
  3119         10  CEXPENSA PIC  X(0001).
  3120     05  CEXPENSI PIC  9(6)V99.
  3121*    -------------------------------
  3122     05  ERRMSG0L PIC S9(0004) COMP.
  3123     05  ERRMSG0F PIC  X(0001).
  3124     05  FILLER REDEFINES ERRMSG0F.
  3125         10  ERRMSG0A PIC  X(0001).
  3126     05  ERRMSG0I PIC  X(0072).
  3127*    -------------------------------
  3128     05  ERRMSG1L PIC S9(0004) COMP.
  3129     05  ERRMSG1F PIC  X(0001).
  3130     05  FILLER REDEFINES ERRMSG1F.
  3131         10  ERRMSG1A PIC  X(0001).
  3132     05  ERRMSG1I PIC  X(0072).
  3133*    -------------------------------
  3134     05  ERRMSG2L PIC S9(0004) COMP.
  3135     05  ERRMSG2F PIC  X(0001).
  3136     05  FILLER REDEFINES ERRMSG2F.
  3137         10  ERRMSG2A PIC  X(0001).
  3138     05  ERRMSG2I PIC  X(0072).
  3139*    -------------------------------
  3140     05  ENTERPFL PIC S9(0004) COMP.
  3141     05  ENTERPFF PIC  X(0001).
  3142     05  FILLER REDEFINES ENTERPFF.
  3143         10  ENTERPFA PIC  X(0001).
  3144     05  ENTERPFI PIC  99.
  3145*    -------------------------------
  3146     05  PF6TITL PIC S9(0004) COMP.
  3147     05  PF6TITF PIC  X(0001).
  3148     05  FILLER REDEFINES PF6TITF.
  3149         10  PF6TITA PIC  X(0001).
  3150     05  PF6TITI PIC  X(0016).
  3151 01  EL156AO REDEFINES EL156AI.
  3152     05  FILLER            PIC  X(0012).
  3153*    -------------------------------
  3154     05  FILLER            PIC  X(0003).
  3155     05  RUNDTEAO PIC  X(0008).
  3156*    -------------------------------
  3157     05  FILLER            PIC  X(0003).
  3158     05  RUNTIMAO PIC  99.99.
  3159*    -------------------------------
  3160     05  FILLER            PIC  X(0003).
  3161     05  SEQUO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  64
* EL156.cbl
  3162*    -------------------------------
  3163     05  FILLER            PIC  X(0003).
  3164     05  CLMNOO PIC  X(0007).
  3165*    -------------------------------
  3166     05  FILLER            PIC  X(0003).
  3167     05  CARRO PIC  X(0001).
  3168*    -------------------------------
  3169     05  FILLER            PIC  X(0003).
  3170     05  CERTNOO PIC  X(0010).
  3171*    -------------------------------
  3172     05  FILLER            PIC  X(0003).
  3173     05  SUFXO PIC  X(0001).
  3174*    -------------------------------
  3175     05  FILLER            PIC  X(0003).
  3176     05  CLMTYPO PIC  X(0006).
  3177*    -------------------------------
  3178     05  FILLER            PIC  X(0003).
  3179     05  CLMSTATO PIC  X(0006).
  3180*    -------------------------------
  3181     05  FILLER            PIC  X(0003).
  3182     05  LSTNMEO PIC  X(0015).
  3183*    -------------------------------
  3184     05  FILLER            PIC  X(0003).
  3185     05  FSTNMEO PIC  X(0012).
  3186*    -------------------------------
  3187     05  FILLER            PIC  X(0003).
  3188     05  MINITO PIC  X(0001).
  3189*    -------------------------------
  3190     05  FILLER            PIC  X(0003).
  3191     05  PRIMHDGO PIC  X(0012).
  3192*    -------------------------------
  3193     05  FILLER            PIC  X(0003).
  3194     05  PCERTNOO PIC  X(0010).
  3195*    -------------------------------
  3196     05  FILLER            PIC  X(0003).
  3197     05  PSUFXO PIC  X(0001).
  3198*    -------------------------------
  3199     05  FILLER            PIC  X(0003).
  3200     05  STATUSO PIC  X(0010).
  3201*    -------------------------------
  3202     05  FILLER            PIC  X(0003).
  3203     05  LOANHO PIC  X(0014).
  3204*    -------------------------------
  3205     05  FILLER            PIC  X(0003).
  3206     05  LOANNOO PIC  X(0025).
  3207*    -------------------------------
  3208     05  FILLER            PIC  X(0003).
  3209     05  DUEDAYHO PIC  X(0008).
  3210*    -------------------------------
  3211     05  FILLER            PIC  X(0003).
  3212     05  DUEDAYO PIC  X(0002).
  3213*    -------------------------------
  3214     05  FILLER            PIC  X(0003).
  3215     05  ZINTHO PIC  X(0009).
  3216*    -------------------------------
  3217     05  FILLER            PIC  X(0003).
  3218     05  ZINTO PIC  9.99999.
  3219*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  65
* EL156.cbl
  3220     05  FILLER            PIC  X(0003).
  3221     05  PTHRHDGO PIC  X(0014).
  3222*    -------------------------------
  3223     05  FILLER            PIC  X(0003).
  3224     05  PDTHRUO PIC  X(0008).
  3225*    -------------------------------
  3226     05  FILLER            PIC  X(0003).
  3227     05  TOTPAIDO PIC  Z(6).99-.
  3228*    -------------------------------
  3229     05  FILLER            PIC  X(0003).
  3230     05  COVERO PIC  X(0010).
  3231*    -------------------------------
  3232     05  FILLER            PIC  X(0003).
  3233     05  INCURO PIC  X(0008).
  3234*    -------------------------------
  3235     05  FILLER            PIC  X(0003).
  3236     05  LSTDTEO PIC  X(0008).
  3237*    -------------------------------
  3238     05  FILLER            PIC  X(0003).
  3239     05  CRTSTATO PIC  X(0010).
  3240*    -------------------------------
  3241     05  FILLER            PIC  X(0003).
  3242     05  EFFECTO PIC  X(0008).
  3243*    -------------------------------
  3244     05  FILLER            PIC  X(0003).
  3245     05  TERMSO PIC  X(0011).
  3246*    -------------------------------
  3247     05  FILLER            PIC  X(0003).
  3248     05  STACCTO PIC  X(0013).
  3249*    -------------------------------
  3250     05  FILLER            PIC  X(0003).
  3251     05  EXPDTEHO PIC  X(0014).
  3252*    -------------------------------
  3253     05  FILLER            PIC  X(0003).
  3254     05  EXPDTEO PIC  X(0008).
  3255*    -------------------------------
  3256     05  FILLER            PIC  X(0003).
  3257     05  BENECAPO PIC  X(0013).
  3258*    -------------------------------
  3259     05  FILLER            PIC  X(0003).
  3260     05  BENEO PIC  Z(6).99.
  3261*    -------------------------------
  3262     05  FILLER            PIC  X(0003).
  3263     05  FORMTYPO PIC  X(0001).
  3264*    -------------------------------
  3265     05  FILLER            PIC  X(0003).
  3266     05  PMTTYPEO PIC  X(0001).
  3267*    -------------------------------
  3268     05  FILLER            PIC  X(0003).
  3269     05  PAYEEO PIC  X(0002).
  3270*    -------------------------------
  3271     05  FILLER            PIC  X(0003).
  3272     05  CHECKNOO PIC  X(0007).
  3273*    -------------------------------
  3274     05  FILLER            PIC  X(0003).
  3275     05  OFFLINEO PIC  X(0001).
  3276*    -------------------------------
  3277     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  66
* EL156.cbl
  3278     05  HOLDTILO PIC  99B99B99.
  3279*    -------------------------------
  3280     05  FILLER            PIC  X(0003).
  3281     05  NOTE1O PIC  X(0060).
  3282*    -------------------------------
  3283     05  FILLER            PIC  X(0003).
  3284     05  ITRB1O PIC  X(0008).
  3285*    -------------------------------
  3286     05  FILLER            PIC  X(0003).
  3287     05  NOTE2O PIC  X(0060).
  3288*    -------------------------------
  3289     05  FILLER            PIC  X(0003).
  3290     05  ITRB2O PIC  X(0010).
  3291*    -------------------------------
  3292     05  FILLER            PIC  X(0003).
  3293     05  EOBYNO PIC  X(0001).
  3294*    -------------------------------
  3295     05  FILLER            PIC  X(0003).
  3296     05  CLMFMYNO PIC  X(0001).
  3297*    -------------------------------
  3298     05  FILLER            PIC  X(0003).
  3299     05  SURVYYNO PIC  X(0001).
  3300*    -------------------------------
  3301     05  FILLER            PIC  X(0003).
  3302     05  SPRELYNO PIC  X(0001).
  3303*    -------------------------------
  3304     05  FILLER            PIC  X(0003).
  3305     05  PINTHO PIC  X(0004).
  3306*    -------------------------------
  3307     05  FILLER            PIC  X(0003).
  3308     05  PINTO PIC  Z,ZZ9.99.
  3309*    -------------------------------
  3310     05  FILLER            PIC  X(0003).
  3311     05  ITRBYNO PIC  X(0001).
  3312*    -------------------------------
  3313     05  FILLER            PIC  X(0003).
  3314     05  PROOFDTO PIC  99B99B99.
  3315*    -------------------------------
  3316     05  FILLER            PIC  X(0003).
  3317     05  AIGFRMHO PIC  X(0012).
  3318*    -------------------------------
  3319     05  FILLER            PIC  X(0003).
  3320     05  AIGFROMO PIC  99B99B99.
  3321*    -------------------------------
  3322     05  FILLER            PIC  X(0003).
  3323     05  PMTHDGAO PIC  X(0066).
  3324*    -------------------------------
  3325     05  FILLER            PIC  X(0003).
  3326     05  EPYFROMO PIC  99B99B99.
  3327*    -------------------------------
  3328     05  FILLER            PIC  X(0003).
  3329     05  EPYTHRUO PIC  99B99B99.
  3330*    -------------------------------
  3331     05  FILLER            PIC  X(0003).
  3332     05  EDAYSO PIC  Z(4)9-.
  3333*    -------------------------------
  3334     05  FILLER            PIC  X(0003).
  3335     05  EPYAMTO PIC  Z(6).99-.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  67
* EL156.cbl
  3336*    -------------------------------
  3337     05  FILLER            PIC  X(0003).
  3338     05  ERESVO PIC  Z(5).99-.
  3339*    -------------------------------
  3340     05  FILLER            PIC  X(0003).
  3341     05  ETYPEO PIC  X(0001).
  3342*    -------------------------------
  3343     05  FILLER            PIC  X(0003).
  3344     05  EEXPENSO PIC  Z(5).99.
  3345*    -------------------------------
  3346     05  FILLER            PIC  X(0003).
  3347     05  CPYFROMO PIC  99B99B99.
  3348*    -------------------------------
  3349     05  FILLER            PIC  X(0003).
  3350     05  CPYTHRUO PIC  99B99B99.
  3351*    -------------------------------
  3352     05  FILLER            PIC  X(0003).
  3353     05  CDAYSO PIC  Z(4)9-.
  3354*    -------------------------------
  3355     05  FILLER            PIC  X(0003).
  3356     05  CPYAMTO PIC  Z(6).99-.
  3357*    -------------------------------
  3358     05  FILLER            PIC  X(0003).
  3359     05  CRESVO PIC  Z(5).99.
  3360*    -------------------------------
  3361     05  FILLER            PIC  X(0003).
  3362     05  CEXPENSO PIC  Z(5).99.
  3363*    -------------------------------
  3364     05  FILLER            PIC  X(0003).
  3365     05  ERRMSG0O PIC  X(0072).
  3366*    -------------------------------
  3367     05  FILLER            PIC  X(0003).
  3368     05  ERRMSG1O PIC  X(0072).
  3369*    -------------------------------
  3370     05  FILLER            PIC  X(0003).
  3371     05  ERRMSG2O PIC  X(0072).
  3372*    -------------------------------
  3373     05  FILLER            PIC  X(0003).
  3374     05  ENTERPFO PIC  X(0002).
  3375*    -------------------------------
  3376     05  FILLER            PIC  X(0003).
  3377     05  PF6TITO PIC  X(0016).
  3378*    -------------------------------
  3379 01  EL156BI REDEFINES EL156AI.
  3380     05  FILLER            PIC  X(0012).
  3381*    -------------------------------
  3382     05  RUNDTEBL PIC S9(0004) COMP.
  3383     05  RUNDTEBF PIC  X(0001).
  3384     05  FILLER REDEFINES RUNDTEBF.
  3385         10  RUNDTEBA PIC  X(0001).
  3386     05  RUNDTEBI PIC  X(0008).
  3387*    -------------------------------
  3388     05  RUNTIMBL PIC S9(0004) COMP.
  3389     05  RUNTIMBF PIC  X(0001).
  3390     05  FILLER REDEFINES RUNTIMBF.
  3391         10  RUNTIMBA PIC  X(0001).
  3392     05  RUNTIMBI PIC  X(0005).
  3393*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  68
* EL156.cbl
  3394     05  PAYDTBL PIC S9(0004) COMP.
  3395     05  PAYDTBF PIC  X(0001).
  3396     05  FILLER REDEFINES PAYDTBF.
  3397         10  PAYDTBA PIC  X(0001).
  3398     05  PAYDTBI PIC  X(0008).
  3399*    -------------------------------
  3400     05  PAYTYPBL PIC S9(0004) COMP.
  3401     05  PAYTYPBF PIC  X(0001).
  3402     05  FILLER REDEFINES PAYTYPBF.
  3403         10  PAYTYPBA PIC  X(0001).
  3404     05  PAYTYPBI PIC  X(0015).
  3405*    -------------------------------
  3406     05  PAYAMTBL PIC S9(0004) COMP.
  3407     05  PAYAMTBF PIC  X(0001).
  3408     05  FILLER REDEFINES PAYAMTBF.
  3409         10  PAYAMTBA PIC  X(0001).
  3410     05  PAYAMTBI PIC  X(0011).
  3411*    -------------------------------
  3412     05  LOANHBL PIC S9(0004) COMP.
  3413     05  LOANHBF PIC  X(0001).
  3414     05  FILLER REDEFINES LOANHBF.
  3415         10  LOANHBA PIC  X(0001).
  3416     05  LOANHBI PIC  X(0012).
  3417*    -------------------------------
  3418     05  LOANNBL PIC S9(0004) COMP.
  3419     05  LOANNBF PIC  X(0001).
  3420     05  FILLER REDEFINES LOANNBF.
  3421         10  LOANNBA PIC  X(0001).
  3422     05  LOANNBI PIC  X(0025).
  3423*    -------------------------------
  3424     05  CKNUMHDL PIC S9(0004) COMP.
  3425     05  CKNUMHDF PIC  X(0001).
  3426     05  FILLER REDEFINES CKNUMHDF.
  3427         10  CKNUMHDA PIC  X(0001).
  3428     05  CKNUMHDI PIC  X(0012).
  3429*    -------------------------------
  3430     05  CKNUMBL PIC S9(0004) COMP.
  3431     05  CKNUMBF PIC  X(0001).
  3432     05  FILLER REDEFINES CKNUMBF.
  3433         10  CKNUMBA PIC  X(0001).
  3434     05  CKNUMBI PIC  X(0007).
  3435*    -------------------------------
  3436     05  AGTHDGL PIC S9(0004) COMP.
  3437     05  AGTHDGF PIC  X(0001).
  3438     05  FILLER REDEFINES AGTHDGF.
  3439         10  AGTHDGA PIC  X(0001).
  3440     05  AGTHDGI PIC  X(0016).
  3441*    -------------------------------
  3442     05  NAMEBL PIC S9(0004) COMP.
  3443     05  NAMEBF PIC  X(0001).
  3444     05  FILLER REDEFINES NAMEBF.
  3445         10  NAMEBA PIC  X(0001).
  3446     05  NAMEBI PIC  X(0030).
  3447*    -------------------------------
  3448     05  NAMEB2L PIC S9(0004) COMP.
  3449     05  NAMEB2F PIC  X(0001).
  3450     05  FILLER REDEFINES NAMEB2F.
  3451         10  NAMEB2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  69
* EL156.cbl
  3452     05  NAMEB2I PIC  X(0030).
  3453*    -------------------------------
  3454     05  ADDR1BL PIC S9(0004) COMP.
  3455     05  ADDR1BF PIC  X(0001).
  3456     05  FILLER REDEFINES ADDR1BF.
  3457         10  ADDR1BA PIC  X(0001).
  3458     05  ADDR1BI PIC  X(0030).
  3459*    -------------------------------
  3460     05  ADDR1B2L PIC S9(0004) COMP.
  3461     05  ADDR1B2F PIC  X(0001).
  3462     05  FILLER REDEFINES ADDR1B2F.
  3463         10  ADDR1B2A PIC  X(0001).
  3464     05  ADDR1B2I PIC  X(0030).
  3465*    -------------------------------
  3466     05  ADDR2BL PIC S9(0004) COMP.
  3467     05  ADDR2BF PIC  X(0001).
  3468     05  FILLER REDEFINES ADDR2BF.
  3469         10  ADDR2BA PIC  X(0001).
  3470     05  ADDR2BI PIC  X(0030).
  3471*    -------------------------------
  3472     05  ADDR2B2L PIC S9(0004) COMP.
  3473     05  ADDR2B2F PIC  X(0001).
  3474     05  FILLER REDEFINES ADDR2B2F.
  3475         10  ADDR2B2A PIC  X(0001).
  3476     05  ADDR2B2I PIC  X(0030).
  3477*    -------------------------------
  3478     05  CITYSTBL PIC S9(0004) COMP.
  3479     05  CITYSTBF PIC  X(0001).
  3480     05  FILLER REDEFINES CITYSTBF.
  3481         10  CITYSTBA PIC  X(0001).
  3482     05  CITYSTBI PIC  X(0030).
  3483*    -------------------------------
  3484     05  CITYST2L PIC S9(0004) COMP.
  3485     05  CITYST2F PIC  X(0001).
  3486     05  FILLER REDEFINES CITYST2F.
  3487         10  CITYST2A PIC  X(0001).
  3488     05  CITYST2I PIC  X(0030).
  3489*    -------------------------------
  3490     05  ZIPBL PIC S9(0004) COMP.
  3491     05  ZIPBF PIC  X(0001).
  3492     05  FILLER REDEFINES ZIPBF.
  3493         10  ZIPBA PIC  X(0001).
  3494     05  ZIPBI PIC  X(0009).
  3495*    -------------------------------
  3496     05  ZIPB2L PIC S9(0004) COMP.
  3497     05  ZIPB2F PIC  X(0001).
  3498     05  FILLER REDEFINES ZIPB2F.
  3499         10  ZIPB2A PIC  X(0001).
  3500     05  ZIPB2I PIC  X(0009).
  3501*    -------------------------------
  3502     05  INTHDBL PIC S9(0004) COMP.
  3503     05  INTHDBF PIC  X(0001).
  3504     05  FILLER REDEFINES INTHDBF.
  3505         10  INTHDBA PIC  X(0001).
  3506     05  INTHDBI PIC  X(0012).
  3507*    -------------------------------
  3508     05  INTAMTBL PIC S9(0004) COMP.
  3509     05  INTAMTBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  70
* EL156.cbl
  3510     05  FILLER REDEFINES INTAMTBF.
  3511         10  INTAMTBA PIC  X(0001).
  3512     05  INTAMTBI PIC  X(0011).
  3513*    -------------------------------
  3514     05  PMTHDGBL PIC S9(0004) COMP.
  3515     05  PMTHDGBF PIC  X(0001).
  3516     05  FILLER REDEFINES PMTHDGBF.
  3517         10  PMTHDGBA PIC  X(0001).
  3518     05  PMTHDGBI PIC  X(0034).
  3519*    -------------------------------
  3520     05  CLMNOBL PIC S9(0004) COMP.
  3521     05  CLMNOBF PIC  X(0001).
  3522     05  FILLER REDEFINES CLMNOBF.
  3523         10  CLMNOBA PIC  X(0001).
  3524     05  CLMNOBI PIC  X(0007).
  3525*    -------------------------------
  3526     05  CARRBL PIC S9(0004) COMP.
  3527     05  CARRBF PIC  X(0001).
  3528     05  FILLER REDEFINES CARRBF.
  3529         10  CARRBA PIC  X(0001).
  3530     05  CARRBI PIC  X(0001).
  3531*    -------------------------------
  3532     05  CERTNOBL PIC S9(0004) COMP.
  3533     05  CERTNOBF PIC  X(0001).
  3534     05  FILLER REDEFINES CERTNOBF.
  3535         10  CERTNOBA PIC  X(0001).
  3536     05  CERTNOBI PIC  X(0010).
  3537*    -------------------------------
  3538     05  SUFXBL PIC S9(0004) COMP.
  3539     05  SUFXBF PIC  X(0001).
  3540     05  FILLER REDEFINES SUFXBF.
  3541         10  SUFXBA PIC  X(0001).
  3542     05  SUFXBI PIC  X(0001).
  3543*    -------------------------------
  3544     05  CLMTYPBL PIC S9(0004) COMP.
  3545     05  CLMTYPBF PIC  X(0001).
  3546     05  FILLER REDEFINES CLMTYPBF.
  3547         10  CLMTYPBA PIC  X(0001).
  3548     05  CLMTYPBI PIC  X(0006).
  3549*    -------------------------------
  3550     05  INCURBL PIC S9(0004) COMP.
  3551     05  INCURBF PIC  X(0001).
  3552     05  FILLER REDEFINES INCURBF.
  3553         10  INCURBA PIC  X(0001).
  3554     05  INCURBI PIC  X(0008).
  3555*    -------------------------------
  3556     05  PYFROMBL PIC S9(0004) COMP.
  3557     05  PYFROMBF PIC  X(0001).
  3558     05  FILLER REDEFINES PYFROMBF.
  3559         10  PYFROMBA PIC  X(0001).
  3560     05  PYFROMBI PIC  X(0008).
  3561*    -------------------------------
  3562     05  PYTHRUBL PIC S9(0004) COMP.
  3563     05  PYTHRUBF PIC  X(0001).
  3564     05  FILLER REDEFINES PYTHRUBF.
  3565         10  PYTHRUBA PIC  X(0001).
  3566     05  PYTHRUBI PIC  X(0008).
  3567*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  71
* EL156.cbl
  3568     05  DAYSBL PIC S9(0004) COMP.
  3569     05  DAYSBF PIC  X(0001).
  3570     05  FILLER REDEFINES DAYSBF.
  3571         10  DAYSBA PIC  X(0001).
  3572     05  DAYSBI PIC  X(0005).
  3573*    -------------------------------
  3574     05  BYBL PIC S9(0004) COMP.
  3575     05  BYBF PIC  X(0001).
  3576     05  FILLER REDEFINES BYBF.
  3577         10  BYBA PIC  X(0001).
  3578     05  BYBI PIC  X(0004).
  3579*    -------------------------------
  3580     05  PROOFDBL PIC S9(0004) COMP.
  3581     05  PROOFDBF PIC  X(0001).
  3582     05  FILLER REDEFINES PROOFDBF.
  3583         10  PROOFDBA PIC  X(0001).
  3584     05  PROOFDBI PIC  X(0008).
  3585*    -------------------------------
  3586     05  ACCTBL PIC S9(0004) COMP.
  3587     05  ACCTBF PIC  X(0001).
  3588     05  FILLER REDEFINES ACCTBF.
  3589         10  ACCTBA PIC  X(0001).
  3590     05  ACCTBI PIC  X(0010).
  3591*    -------------------------------
  3592     05  STATEBL PIC S9(0004) COMP.
  3593     05  STATEBF PIC  X(0001).
  3594     05  FILLER REDEFINES STATEBF.
  3595         10  STATEBA PIC  X(0001).
  3596     05  STATEBI PIC  X(0002).
  3597*    -------------------------------
  3598     05  GROUPBL PIC S9(0004) COMP.
  3599     05  GROUPBF PIC  X(0001).
  3600     05  FILLER REDEFINES GROUPBF.
  3601         10  GROUPBA PIC  X(0001).
  3602     05  GROUPBI PIC  X(0006).
  3603*    -------------------------------
  3604     05  ACARRBL PIC S9(0004) COMP.
  3605     05  ACARRBF PIC  X(0001).
  3606     05  FILLER REDEFINES ACARRBF.
  3607         10  ACARRBA PIC  X(0001).
  3608     05  ACARRBI PIC  X(0001).
  3609*    -------------------------------
  3610     05  ACCTNMBL PIC S9(0004) COMP.
  3611     05  ACCTNMBF PIC  X(0001).
  3612     05  FILLER REDEFINES ACCTNMBF.
  3613         10  ACCTNMBA PIC  X(0001).
  3614     05  ACCTNMBI PIC  X(0030).
  3615*    -------------------------------
  3616     05  UNDISBL PIC S9(0004) COMP.
  3617     05  UNDISBF PIC  X(0001).
  3618     05  FILLER REDEFINES UNDISBF.
  3619         10  UNDISBA PIC  X(0001).
  3620     05  UNDISBI PIC  X(0010).
  3621*    -------------------------------
  3622     05  RATEBL PIC S9(0004) COMP.
  3623     05  RATEBF PIC  X(0001).
  3624     05  FILLER REDEFINES RATEBF.
  3625         10  RATEBA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  72
* EL156.cbl
  3626     05  RATEBI PIC  X(0006).
  3627*    -------------------------------
  3628     05  ERMSG1BL PIC S9(0004) COMP.
  3629     05  ERMSG1BF PIC  X(0001).
  3630     05  FILLER REDEFINES ERMSG1BF.
  3631         10  ERMSG1BA PIC  X(0001).
  3632     05  ERMSG1BI PIC  X(0072).
  3633*    -------------------------------
  3634     05  ENTPFBL PIC S9(0004) COMP.
  3635     05  ENTPFBF PIC  X(0001).
  3636     05  FILLER REDEFINES ENTPFBF.
  3637         10  ENTPFBA PIC  X(0001).
  3638     05  ENTPFBI PIC  99.
  3639 01  EL156BO REDEFINES EL156AI.
  3640     05  FILLER            PIC  X(0012).
  3641*    -------------------------------
  3642     05  FILLER            PIC  X(0003).
  3643     05  RUNDTEBO PIC  X(0008).
  3644*    -------------------------------
  3645     05  FILLER            PIC  X(0003).
  3646     05  RUNTIMBO PIC  99.99.
  3647*    -------------------------------
  3648     05  FILLER            PIC  X(0003).
  3649     05  PAYDTBO PIC  99B99B99.
  3650*    -------------------------------
  3651     05  FILLER            PIC  X(0003).
  3652     05  PAYTYPBO PIC  X(0015).
  3653*    -------------------------------
  3654     05  FILLER            PIC  X(0003).
  3655     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3656*    -------------------------------
  3657     05  FILLER            PIC  X(0003).
  3658     05  LOANHBO PIC  X(0012).
  3659*    -------------------------------
  3660     05  FILLER            PIC  X(0003).
  3661     05  LOANNBO PIC  X(0025).
  3662*    -------------------------------
  3663     05  FILLER            PIC  X(0003).
  3664     05  CKNUMHDO PIC  X(0012).
  3665*    -------------------------------
  3666     05  FILLER            PIC  X(0003).
  3667     05  CKNUMBO PIC  X(0007).
  3668*    -------------------------------
  3669     05  FILLER            PIC  X(0003).
  3670     05  AGTHDGO PIC  X(0016).
  3671*    -------------------------------
  3672     05  FILLER            PIC  X(0003).
  3673     05  NAMEBO PIC  X(0030).
  3674*    -------------------------------
  3675     05  FILLER            PIC  X(0003).
  3676     05  NAMEB2O PIC  X(0030).
  3677*    -------------------------------
  3678     05  FILLER            PIC  X(0003).
  3679     05  ADDR1BO PIC  X(0030).
  3680*    -------------------------------
  3681     05  FILLER            PIC  X(0003).
  3682     05  ADDR1B2O PIC  X(0030).
  3683*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  73
* EL156.cbl
  3684     05  FILLER            PIC  X(0003).
  3685     05  ADDR2BO PIC  X(0030).
  3686*    -------------------------------
  3687     05  FILLER            PIC  X(0003).
  3688     05  ADDR2B2O PIC  X(0030).
  3689*    -------------------------------
  3690     05  FILLER            PIC  X(0003).
  3691     05  CITYSTBO PIC  X(0030).
  3692*    -------------------------------
  3693     05  FILLER            PIC  X(0003).
  3694     05  CITYST2O PIC  X(0030).
  3695*    -------------------------------
  3696     05  FILLER            PIC  X(0003).
  3697     05  ZIPBO PIC  ZZZZ99999.
  3698*    -------------------------------
  3699     05  FILLER            PIC  X(0003).
  3700     05  ZIPB2O PIC  ZZZZZZZZZ.
  3701*    -------------------------------
  3702     05  FILLER            PIC  X(0003).
  3703     05  INTHDBO PIC  X(0012).
  3704*    -------------------------------
  3705     05  FILLER            PIC  X(0003).
  3706     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3707*    -------------------------------
  3708     05  FILLER            PIC  X(0003).
  3709     05  PMTHDGBO PIC  X(0034).
  3710*    -------------------------------
  3711     05  FILLER            PIC  X(0003).
  3712     05  CLMNOBO PIC  X(0007).
  3713*    -------------------------------
  3714     05  FILLER            PIC  X(0003).
  3715     05  CARRBO PIC  X(0001).
  3716*    -------------------------------
  3717     05  FILLER            PIC  X(0003).
  3718     05  CERTNOBO PIC  X(0010).
  3719*    -------------------------------
  3720     05  FILLER            PIC  X(0003).
  3721     05  SUFXBO PIC  X(0001).
  3722*    -------------------------------
  3723     05  FILLER            PIC  X(0003).
  3724     05  CLMTYPBO PIC  X(0006).
  3725*    -------------------------------
  3726     05  FILLER            PIC  X(0003).
  3727     05  INCURBO PIC  X(0008).
  3728*    -------------------------------
  3729     05  FILLER            PIC  X(0003).
  3730     05  PYFROMBO PIC  99B99B99.
  3731*    -------------------------------
  3732     05  FILLER            PIC  X(0003).
  3733     05  PYTHRUBO PIC  99B99B99.
  3734*    -------------------------------
  3735     05  FILLER            PIC  X(0003).
  3736     05  DAYSBO PIC  X(0005).
  3737*    -------------------------------
  3738     05  FILLER            PIC  X(0003).
  3739     05  BYBO PIC  X(0004).
  3740*    -------------------------------
  3741     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  74
* EL156.cbl
  3742     05  PROOFDBO PIC  99B99B99.
  3743*    -------------------------------
  3744     05  FILLER            PIC  X(0003).
  3745     05  ACCTBO PIC  X(0010).
  3746*    -------------------------------
  3747     05  FILLER            PIC  X(0003).
  3748     05  STATEBO PIC  X(0002).
  3749*    -------------------------------
  3750     05  FILLER            PIC  X(0003).
  3751     05  GROUPBO PIC  X(0006).
  3752*    -------------------------------
  3753     05  FILLER            PIC  X(0003).
  3754     05  ACARRBO PIC  X(0001).
  3755*    -------------------------------
  3756     05  FILLER            PIC  X(0003).
  3757     05  ACCTNMBO PIC  X(0030).
  3758*    -------------------------------
  3759     05  FILLER            PIC  X(0003).
  3760     05  UNDISBO PIC  ZZZ,Z99.99.
  3761*    -------------------------------
  3762     05  FILLER            PIC  X(0003).
  3763     05  RATEBO PIC  ZZZ.99.
  3764*    -------------------------------
  3765     05  FILLER            PIC  X(0003).
  3766     05  ERMSG1BO PIC  X(0072).
  3767*    -------------------------------
  3768     05  FILLER            PIC  X(0003).
  3769     05  ENTPFBO PIC  X(0002).
  3770*    -------------------------------
  3771****************************************************************
  3772*
  3773* Copyright (c) 2007-2013 Dell Inc.
  3774* All rights reserved.
  3775*
  3776****************************************************************
  3777 01  DFHEIV.
  3778   02  DFHEIV0               PIC X(35).
  3779   02  DFHEIV1               PIC X(08).
  3780   02  DFHEIV2               PIC X(08).
  3781   02  DFHEIV3               PIC X(08).
  3782   02  DFHEIV4               PIC X(06).
  3783   02  DFHEIV5               PIC X(04).
  3784   02  DFHEIV6               PIC X(04).
  3785   02  DFHEIV7               PIC X(02).
  3786   02  DFHEIV8               PIC X(02).
  3787   02  DFHEIV9               PIC X(01).
  3788   02  DFHEIV10              PIC S9(7) COMP-3.
  3789   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3790   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3791   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3792   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3793   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3794   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3795   02  DFHEIV17              PIC X(04).
  3796   02  DFHEIV18              PIC X(04).
  3797   02  DFHEIV19              PIC X(04).
  3798   02  DFHEIV20              USAGE IS POINTER.
  3799   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  75
* EL156.cbl
  3800   02  DFHEIV22              USAGE IS POINTER.
  3801   02  DFHEIV23              USAGE IS POINTER.
  3802   02  DFHEIV24              USAGE IS POINTER.
  3803   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3804   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3805   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3806   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3807   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3808   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3809   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3810   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3811   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3812   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3813   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3814   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3815   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3816   02  FILLER                PIC X(02).
  3817   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3818   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3819   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3820   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3821   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3822   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3823   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3824 LINKAGE  SECTION.
  3825*****************************************************************
  3826*                                                               *
  3827* Copyright (c) 2007-2013 Dell Inc.                             *
  3828* All rights reserved.                                          *
  3829*                                                               *
  3830*****************************************************************
  3831 01  dfheiblk.
  3832     02  eibtime          pic s9(7) comp-3.
  3833     02  eibdate          pic s9(7) comp-3.
  3834     02  eibtrnid         pic x(4).
  3835     02  eibtaskn         pic s9(7) comp-3.
  3836     02  eibtrmid         pic x(4).
  3837     02  dfheigdi         pic s9(4) comp.
  3838     02  eibcposn         pic s9(4) comp.
  3839     02  eibcalen         pic s9(4) comp.
  3840     02  eibaid           pic x(1).
  3841     02  eibfiller1       pic x(1).
  3842     02  eibfn            pic x(2).
  3843     02  eibfiller2       pic x(2).
  3844     02  eibrcode         pic x(6).
  3845     02  eibfiller3       pic x(2).
  3846     02  eibds            pic x(8).
  3847     02  eibreqid         pic x(8).
  3848     02  eibrsrce         pic x(8).
  3849     02  eibsync          pic x(1).
  3850     02  eibfree          pic x(1).
  3851     02  eibrecv          pic x(1).
  3852     02  eibsend          pic x(1).
  3853     02  eibatt           pic x(1).
  3854     02  eibeoc           pic x(1).
  3855     02  eibfmh           pic x(1).
  3856     02  eibcompl         pic x(1).
  3857     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  76
* EL156.cbl
  3858     02  eibconf          pic x(1).
  3859     02  eiberr           pic x(1).
  3860     02  eibrldbk         pic x(1).
  3861     02  eiberrcd         pic x(4).
  3862     02  eibsynrb         pic x(1).
  3863     02  eibnodat         pic x(1).
  3864     02  eibfiller5       pic x(2).
  3865     02  eibresp          pic s9(8) comp.
  3866     02  eibresp2         pic s9(8) comp.
  3867     02  dfheigdj         pic s9(4) comp.
  3868     02  dfheigdk         pic s9(4) comp.
  3869 01  DFHCOMMAREA             PIC X(1024).
  3870
  3871*    COPY ELCMSTR.
  3872******************************************************************
  3873*                                                                *
  3874*                            ELCMSTR.                            *
  3875*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3876*                            VMOD=2.012                          *
  3877*                                                                *
  3878*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3879*                                                                *
  3880*   FILE TYPE = VSAM,KSDS                                        *
  3881*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3882*                                                                *
  3883*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3884*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3885*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3886*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3887*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3888*                                                 RKP=75,LEN=21  *
  3889*                                                                *
  3890*   **** NOTE ****                                               *
  3891*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3892*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3893*                                                                *
  3894*   LOG = YES                                                    *
  3895*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3896******************************************************************
  3897*                   C H A N G E   L O G
  3898*
  3899* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3900*-----------------------------------------------------------------
  3901*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3902* EFFECTIVE    NUMBER
  3903*-----------------------------------------------------------------
  3904* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3905* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3906* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3907* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3908* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3909* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3910* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3911******************************************************************
  3912 01  CLAIM-MASTER.
  3913     12  CL-RECORD-ID                PIC XX.
  3914         88  VALID-CL-ID         VALUE 'CL'.
  3915
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  77
* EL156.cbl
  3916     12  CL-CONTROL-PRIMARY.
  3917         16  CL-COMPANY-CD           PIC X.
  3918         16  CL-CARRIER              PIC X.
  3919         16  CL-CLAIM-NO             PIC X(7).
  3920         16  CL-CERT-NO.
  3921             20  CL-CERT-PRIME       PIC X(10).
  3922             20  CL-CERT-SFX         PIC X.
  3923
  3924     12  CL-CONTROL-BY-NAME.
  3925         16  CL-COMPANY-CD-A1        PIC X.
  3926         16  CL-INSURED-LAST-NAME    PIC X(15).
  3927         16  CL-INSURED-NAME.
  3928             20  CL-INSURED-1ST-NAME PIC X(12).
  3929             20  CL-INSURED-MID-INIT PIC X.
  3930
  3931     12  CL-CONTROL-BY-SSN.
  3932         16  CL-COMPANY-CD-A2        PIC X.
  3933         16  CL-SOC-SEC-NO.
  3934             20  CL-SSN-STATE        PIC XX.
  3935             20  CL-SSN-ACCOUNT      PIC X(6).
  3936             20  CL-SSN-LN3          PIC X(3).
  3937
  3938     12  CL-CONTROL-BY-CERT-NO.
  3939         16  CL-COMPANY-CD-A4        PIC X.
  3940         16  CL-CERT-NO-A4.
  3941             20  CL-CERT-A4-PRIME    PIC X(10).
  3942             20  CL-CERT-A4-SFX      PIC X.
  3943
  3944     12  CL-CONTROL-BY-CCN.
  3945         16  CL-COMPANY-CD-A5        PIC X.
  3946         16  CL-CCN-A5.
  3947             20  CL-CCN.
  3948                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3949                 24  CL-CCN-PRIME-A5 PIC X(12).
  3950             20  CL-CCN-FILLER-A5    PIC X(4).
  3951
  3952     12  CL-INSURED-PROFILE-DATA.
  3953         16  CL-INSURED-BIRTH-DT     PIC XX.
  3954         16  CL-INSURED-SEX-CD       PIC X.
  3955             88  INSURED-IS-MALE        VALUE 'M'.
  3956             88  INSURED-IS-FEMALE      VALUE 'F'.
  3957             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3958         16  CL-INSURED-OCC-CD       PIC X(6).
  3959         16  FILLER                  PIC X(5).
  3960
  3961     12  CL-PROCESSING-INFO.
  3962         16  CL-PROCESSOR-ID         PIC X(4).
  3963         16  CL-CLAIM-STATUS         PIC X.
  3964             88  CLAIM-IS-OPEN          VALUE 'O'.
  3965             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3966         16  CL-CLAIM-TYPE           PIC X.
  3967*            88  AH-CLAIM               VALUE 'A'.
  3968*            88  LIFE-CLAIM             VALUE 'L'.
  3969*            88  PROPERTY-CLAIM         VALUE 'P'.
  3970*            88  IUI-CLAIM              VALUE 'I'.
  3971*            88  GAP-CLAIM              VALUE 'G'.
  3972*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3973*            88  OTHER-CLAIM            VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  78
* EL156.cbl
  3974         16  CL-CLAIM-PREM-TYPE      PIC X.
  3975             88  SINGLE-PREMIUM         VALUE '1'.
  3976             88  O-B-COVERAGE           VALUE '2'.
  3977             88  OPEN-END-COVERAGE      VALUE '3'.
  3978         16  CL-INCURRED-DT          PIC XX.
  3979         16  CL-REPORTED-DT          PIC XX.
  3980         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3981         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3982         16  CL-LAST-PMT-DT          PIC XX.
  3983         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3984         16  CL-PAID-THRU-DT         PIC XX.
  3985         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3986         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3987         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3988         16  CL-PMT-CALC-METHOD      PIC X.
  3989             88  CL-360-DAY-YR          VALUE '1'.
  3990             88  CL-365-DAY-YR          VALUE '2'.
  3991             88  CL-FULL-MONTHS         VALUE '3'.
  3992         16  CL-CAUSE-CD             PIC X(6).
  3993
  3994         16  CL-PRIME-CERT-NO.
  3995             20  CL-PRIME-CERT-PRIME PIC X(10).
  3996             20  CL-PRIME-CERT-SFX   PIC X.
  3997
  3998         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3999             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  4000             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  4001
  4002         16  CL-MICROFILM-NO         PIC X(10).
  4003         16  FILLER REDEFINES CL-MICROFILM-NO.
  4004             20  CL-BENEFIT-PERIOD   PIC 99.
  4005             20  FILLER              PIC X(8).
  4006         16  CL-PROG-FORM-TYPE       PIC X.
  4007         16  CL-LAST-ADD-ON-DT       PIC XX.
  4008
  4009         16  CL-LAST-REOPEN-DT       PIC XX.
  4010         16  CL-LAST-CLOSE-DT        PIC XX.
  4011         16  CL-LAST-CLOSE-REASON    PIC X(01).
  4012             88  FINAL-PAID             VALUE '1'.
  4013             88  CLAIM-DENIED           VALUE '2'.
  4014             88  AUTO-CLOSE             VALUE '3'.
  4015             88  MANUAL-CLOSE           VALUE '4'.
  4016             88  BENEFITS-CHANGED       VALUE 'C'.
  4017             88  SETUP-ERRORS           VALUE 'E'.
  4018         16  CL-ASSOC-CERT-SEQU      PIC S99.
  4019         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  4020         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  4021             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  4022         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  4023         16  FILLER                  PIC X.
  4024
  4025     12  CL-CERTIFICATE-DATA.
  4026         16  CL-CERT-ORIGIN          PIC X.
  4027             88  CERT-WAS-ONLINE        VALUE '1'.
  4028             88  CERT-WAS-CREATED       VALUE '2'.
  4029             88  COVERAGE-WAS-ADDED     VALUE '3'.
  4030         16  CL-CERT-KEY-DATA.
  4031             20  CL-CERT-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  79
* EL156.cbl
  4032             20  CL-CERT-GROUPING    PIC X(6).
  4033             20  CL-CERT-STATE       PIC XX.
  4034             20  CL-CERT-ACCOUNT.
  4035                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  4036                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  4037             20  CL-CERT-EFF-DT      PIC XX.
  4038
  4039     12  CL-STATUS-CONTROLS.
  4040         16  CL-PRIORITY-CD          PIC X.
  4041             88  CONFIDENTIAL-DATA      VALUE '8'.
  4042             88  HIGHEST-PRIORITY       VALUE '9'.
  4043         16  CL-SUPV-ATTN-CD         PIC X.
  4044             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  4045             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  4046         16  CL-PURGED-DT            PIC XX.
  4047         16  CL-RESTORED-DT          PIC XX.
  4048         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  4049         16  CL-NEXT-RESEND-DT       PIC XX.
  4050         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  4051         16  CL-CRITICAL-PERIOD      PIC 99.
  4052*        16  FILLER                  PIC XX.
  4053         16  CL-LAST-MAINT-DT        PIC XX.
  4054         16  CL-LAST-MAINT-USER      PIC X(4).
  4055         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  4056         16  CL-LAST-MAINT-TYPE      PIC X.
  4057             88  CLAIM-SET-UP           VALUE ' '.
  4058             88  PAYMENT-MADE           VALUE '1'.
  4059             88  LETTER-SENT            VALUE '2'.
  4060             88  MASTER-WAS-ALTERED     VALUE '3'.
  4061             88  MASTER-WAS-RESTORED    VALUE '4'.
  4062             88  INCURRED-DATE-CHANGED  VALUE '5'.
  4063             88  FILE-CONVERTED         VALUE '6'.
  4064             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  4065             88  ERROR-CORRECTION       VALUE 'E'.
  4066         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4067         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4068         16  CL-BENEFICIARY          PIC X(10).
  4069         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4070         16  CL-DENIAL-TYPE          PIC X.
  4071             88  CL-TYPE-DENIAL          VALUE '1'.
  4072             88  CL-TYPE-RESCISSION      VALUE '2'.
  4073             88  CL-TYPE-REFORMATION     VALUE '3'.
  4074             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4075             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4076         16  CL-NO-OF-EXTENSIONS     PIC 99.
  4077         16  filler                  pic x(3).
  4078*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4079*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4080*        16  CL-RTW-DT               PIC XX.
  4081
  4082     12  CL-TRAILER-CONTROLS.
  4083         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4084             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4085             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4086             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4087         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4088         16  FILLER                  PIC XX.
  4089         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  80
* EL156.cbl
  4090         16  CL-ADDRESS-TRAILER-CNT.
  4091             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4092                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4093             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4094                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4095             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4096                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4097             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4098                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4099             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4100                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4101             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4102                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4103             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4104                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4105
  4106     12  CL-CV-REFERENCE-NO.
  4107         16  CL-CV-REFNO-PRIME       PIC X(18).
  4108         16  CL-CV-REFNO-SFX         PIC XX.
  4109
  4110     12  CL-FILE-LOCATION            PIC X(4).
  4111
  4112     12  CL-PROCESS-ERRORS.
  4113         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4114             88  NO-FATAL-ERRORS        VALUE ZERO.
  4115         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4116             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4117
  4118     12  CL-PRODUCT-CD               PIC X.
  4119
  4120     12  CL-CURRENT-KEY-DATA.
  4121         16  CL-CURRENT-CARRIER      PIC X.
  4122         16  CL-CURRENT-GROUPING     PIC X(6).
  4123         16  CL-CURRENT-STATE        PIC XX.
  4124         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4125
  4126     12  CL-ASSOCIATES               PIC X.
  4127         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4128         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4129         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4130         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4131
  4132     12  CL-ACTIVITY-CODE            PIC 99.
  4133     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4134     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4135
  4136     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4137     12  CL-LAG-REPORT-CODE          PIC 9.
  4138     12  CL-LOAN-TYPE                PIC XX.
  4139     12  CL-LEGAL-STATE              PIC XX.
  4140
  4141     12  CL-YESNOSW                  PIC X.
  4142     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4143         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4144         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4145         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4146     12  cl-insured-type             pic x.
  4147         88  cl-claim-on-primary         value 'P'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  81
* EL156.cbl
  4148         88  cl-claim-on-co-borrower     value 'C'.
  4149     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  82
* EL156.cbl
  4151*    COPY ELCCNTL.
  4152******************************************************************
  4153*                                                                *
  4154*                                                                *
  4155*                            ELCCNTL.                            *
  4156*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4157*                            VMOD=2.059                          *
  4158*                                                                *
  4159*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4160*                                                                *
  4161*   FILE TYPE = VSAM,KSDS                                        *
  4162*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4163*                                                                *
  4164*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4165*       ALTERNATE INDEX = NONE                                   *
  4166*                                                                *
  4167*   LOG = YES                                                    *
  4168*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4169******************************************************************
  4170*                   C H A N G E   L O G
  4171*
  4172* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4173*-----------------------------------------------------------------
  4174*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4175* EFFECTIVE    NUMBER
  4176*-----------------------------------------------------------------
  4177* 082503                   PEMA  ADD BENEFIT GROUP
  4178* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4179* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4180* 092705    2005050300006  PEMA  ADD SPP LEASES
  4181* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4182* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4183* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4184* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4185* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4186* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4187* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4188* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4189* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4190* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4191* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  4192******************************************************************
  4193*
  4194 01  CONTROL-FILE.
  4195     12  CF-RECORD-ID                       PIC XX.
  4196         88  VALID-CF-ID                        VALUE 'CF'.
  4197
  4198     12  CF-CONTROL-PRIMARY.
  4199         16  CF-COMPANY-ID                  PIC XXX.
  4200         16  CF-RECORD-TYPE                 PIC X.
  4201             88  CF-COMPANY-MASTER              VALUE '1'.
  4202             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4203             88  CF-STATE-MASTER                VALUE '3'.
  4204             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4205             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4206             88  CF-CARRIER-MASTER              VALUE '6'.
  4207             88  CF-MORTALITY-MASTER            VALUE '7'.
  4208             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  83
* EL156.cbl
  4209             88  CF-TERMINAL-MASTER             VALUE '9'.
  4210             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4211             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4212             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4213             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4214             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4215             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4216             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4217             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4218             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4219         16  CF-ACCESS-CD-GENL              PIC X(4).
  4220         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4221             20  CF-PROCESSOR               PIC X(4).
  4222         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4223             20  CF-STATE-CODE              PIC XX.
  4224             20  FILLER                     PIC XX.
  4225         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4226             20  FILLER                     PIC XX.
  4227             20  CF-HI-BEN-IN-REC           PIC XX.
  4228         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4229             20  FILLER                     PIC XXX.
  4230             20  CF-CARRIER-CNTL            PIC X.
  4231         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4232             20  FILLER                     PIC XX.
  4233             20  CF-HI-TYPE-IN-REC          PIC 99.
  4234         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4235             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4236                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4237             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4238             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4239         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4240             20  FILLER                     PIC X.
  4241             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4242         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4243             20  FILLER                     PIC XX.
  4244             20  CF-MORTGAGE-PLAN           PIC XX.
  4245         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4246
  4247     12  CF-LAST-MAINT-DT                   PIC XX.
  4248     12  CF-LAST-MAINT-BY                   PIC X(4).
  4249     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4250
  4251     12  CF-RECORD-BODY                     PIC X(728).
  4252
  4253
  4254****************************************************************
  4255*             COMPANY MASTER RECORD                            *
  4256****************************************************************
  4257
  4258     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4259         16  CF-COMPANY-ADDRESS.
  4260             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4261             20  CF-CL-IN-CARE-OF           PIC X(30).
  4262             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4263             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4264             20  CF-CL-CITY-STATE           PIC X(30).
  4265             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4266             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  84
* EL156.cbl
  4267         16  CF-COMPANY-CD                  PIC X.
  4268         16  CF-COMPANY-PASSWORD            PIC X(8).
  4269         16  CF-SECURITY-OPTION             PIC X.
  4270             88  ALL-SECURITY                   VALUE '1'.
  4271             88  COMPANY-VERIFY                 VALUE '2'.
  4272             88  PROCESSOR-VERIFY               VALUE '3'.
  4273             88  NO-SECURITY                    VALUE '4'.
  4274             88  ALL-BUT-TERM                   VALUE '5'.
  4275         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4276             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4277         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4278             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4279         16  CF-INFORCE-LOCATION            PIC X.
  4280             88  CERTS-ARE-ONLINE               VALUE '1'.
  4281             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4282             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4283         16  CF-LOWER-CASE-LETTERS          PIC X.
  4284         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4285             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4286             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4287             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4288             88  CF-ACCNT-CNTL                  VALUE '3'.
  4289             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4290
  4291         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4292         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4293
  4294         16  CF-LGX-CREDIT-USER             PIC X.
  4295             88  CO-IS-NOT-USER                 VALUE 'N'.
  4296             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4297
  4298         16 CF-CREDIT-CALC-CODES.
  4299             20  CF-CR-REM-TERM-CALC PIC X.
  4300               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4301               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4302               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4303               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4304               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4305               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4306               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4307             20  CF-CR-R78-METHOD           PIC X.
  4308               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4309               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4310
  4311         16  CF-CLAIM-CONTROL-COUNTS.
  4312             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4313                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4314
  4315             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4316                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4317
  4318             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4319                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4320
  4321             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4322                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4323
  4324         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  85
* EL156.cbl
  4325
  4326         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4327             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4328             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4329             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4330             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4331                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4332                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4333             20  CF-CO-PREM-REJECT-SW       PIC X.
  4334                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4335                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4336             20  CF-CO-REF-REJECT-SW        PIC X.
  4337                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4338                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4339
  4340         16  CF-CO-REPORTING-DT             PIC XX.
  4341         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4342         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4343           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4344           88  CF-CO-MONTH-END                  VALUE '1'.
  4345
  4346         16  CF-LGX-CLAIM-USER              PIC X.
  4347             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4348             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4349
  4350         16  CF-CREDIT-EDIT-CONTROLS.
  4351             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4352             20  CF-MIN-AGE                 PIC 99.
  4353             20  CF-DEFAULT-AGE             PIC 99.
  4354             20  CF-MIN-TERM                PIC S999      COMP-3.
  4355             20  CF-MAX-TERM                PIC S999      COMP-3.
  4356             20  CF-DEFAULT-SEX             PIC X.
  4357             20  CF-JOINT-AGE-INPUT         PIC X.
  4358                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4359             20  CF-BIRTH-DATE-INPUT        PIC X.
  4360                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4361             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4362                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4363                 88  CF-ZERO-CARRIER            VALUE '1'.
  4364                 88  CF-ZERO-GROUPING           VALUE '2'.
  4365                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4366             20  CF-EDIT-SW                 PIC X.
  4367                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4368             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4369             20  CF-CR-PR-METHOD            PIC X.
  4370               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4371               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4372             20  FILLER                     PIC X.
  4373
  4374         16  CF-CREDIT-MISC-CONTROLS.
  4375             20  CF-REIN-TABLE-SW           PIC X.
  4376                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4377             20  CF-COMP-TABLE-SW           PIC X.
  4378                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4379             20  CF-EXPERIENCE-RETENTION-AGE
  4380                                            PIC S9        COMP-3.
  4381             20  CF-CONVERSION-DT           PIC XX.
  4382             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  86
* EL156.cbl
  4383             20  CF-RUN-FREQUENCY-SW        PIC X.
  4384                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4385                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4386
  4387             20  CF-CR-CHECK-NO-CONTROL.
  4388                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4389                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4390                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4391                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4392                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4393                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4394
  4395                 24  CF-CR-CHECK-COUNT       REDEFINES
  4396                     CF-CR-CHECK-COUNTER      PIC X(4).
  4397
  4398                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4399                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4400
  4401                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4402                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4403                 24  CF-MAIL-PROCESSING       PIC X.
  4404                     88  MAIL-PROCESSING          VALUE 'Y'.
  4405
  4406         16  CF-MISC-SYSTEM-CONTROL.
  4407             20  CF-SYSTEM-C                 PIC X.
  4408                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4409             20  CF-SYSTEM-D                 PIC X.
  4410                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4411             20  CF-SOC-SEC-NO-SW            PIC X.
  4412                 88  SOC-SEC-NO-USED             VALUE '1'.
  4413             20  CF-MEMBER-NO-SW             PIC X.
  4414                 88  MEMBER-NO-USED              VALUE '1'.
  4415             20  CF-TAX-ID-NUMBER            PIC X(11).
  4416             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4417             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4418                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4419                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4420                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4421                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4422             20  CF-SYSTEM-E                 PIC X.
  4423                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4424
  4425         16  CF-LGX-LIFE-USER               PIC X.
  4426             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4427             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4428
  4429         16  CF-CR-MONTH-END-DT             PIC XX.
  4430
  4431         16  CF-FILE-MAINT-DATES.
  4432             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4433                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4434             20  CF-LAST-BATCH       REDEFINES
  4435                 CF-LAST-BATCH-NO               PIC X(4).
  4436             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4437             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4438             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4439             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4440             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  87
* EL156.cbl
  4441             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4442             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4443             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4444             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4445             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4446
  4447         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4448         16  FILLER                         PIC X.
  4449
  4450         16  CF-ALT-MORT-CODE               PIC X(4).
  4451         16  CF-MEMBER-CAPTION              PIC X(10).
  4452
  4453         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4454             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4455             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4456             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4457             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4458             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4459
  4460         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4461
  4462         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4463         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4464         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4465         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4466
  4467         16  CF-AH-OVERRIDE-L1              PIC X.
  4468         16  CF-AH-OVERRIDE-L2              PIC XX.
  4469         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4470         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4471
  4472         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4473         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4474
  4475         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4476         16  CF-AR-LAST-EL860-DT            PIC XX.
  4477         16  CF-MP-MONTH-END-DT             PIC XX.
  4478
  4479         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4480         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4481             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4482
  4483         16  CF-AR-MONTH-END-DT             PIC XX.
  4484
  4485         16  CF-CRDTCRD-USER                PIC X.
  4486             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4487             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4488
  4489         16  CF-CC-MONTH-END-DT             PIC XX.
  4490
  4491         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4492
  4493         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4494             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4495             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4496             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4497         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4498         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  88
* EL156.cbl
  4499         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4500         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4501             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4502             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4503         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4504         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4505         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4506             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4507         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4508
  4509         16  CF-CL-ZIP-CODE.
  4510             20  CF-CL-ZIP-PRIME.
  4511                 24  CF-CL-ZIP-1ST          PIC X.
  4512                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4513                 24  FILLER                 PIC X(4).
  4514             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4515         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4516             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4517             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4518             20  FILLER                     PIC XXX.
  4519
  4520         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4521         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4522         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4523         16  CF-CO-OPTION-START-DATE        PIC XX.
  4524         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4525           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4526                                                      '3' '4'.
  4527           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4528           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4529           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4530           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4531           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4532           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4533
  4534         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4535
  4536         16  CF-PAYMENT-APPROVAL-LEVELS.
  4537             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4538             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4539             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4540             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4541             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4542             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4543
  4544         16  CF-END-USER-REPORTING-USER     PIC X.
  4545             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4546             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4547
  4548         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4549             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4550             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4551
  4552         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4553
  4554         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4555         16  FILLER                         PIC X.
  4556
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  89
* EL156.cbl
  4557         16  CF-CREDIT-ARCHIVE-CNTL.
  4558             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4559             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4560             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4561
  4562         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4563
  4564         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4565             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4566             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4567
  4568         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4569             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4570             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4571
  4572         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4573
  4574         16  CF-CO-ACH-ID-CODE              PIC  X.
  4575             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4576             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4577             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4578         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4579         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4580         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4581         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4582         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4583         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4584         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4585         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4586         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4587                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4588         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4589                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4590
  4591         16  CF-CO-OVER-SHORT.
  4592             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4593             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4594
  4595*         16  FILLER                         PIC X(102).
  4596         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4597             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4598             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4599
  4600         16  CF-AH-APPROVAL-DAYS.
  4601             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4602             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4603             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4604             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4605
  4606         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4607
  4608         16  CF-APPROV-LEV-5.
  4609             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4610             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4611             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4612
  4613         16  FILLER                         PIC X(68).
  4614****************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  90
* EL156.cbl
  4615*             PROCESSOR/USER RECORD                            *
  4616****************************************************************
  4617
  4618     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4619         16  CF-PROCESSOR-NAME              PIC X(30).
  4620         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4621         16  CF-PROCESSOR-TITLE             PIC X(26).
  4622         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4623                 88  MESSAGE-YES                VALUE 'Y'.
  4624                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4625
  4626*****************************************************
  4627****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4628****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4629****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4630****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4631*****************************************************
  4632
  4633         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4634             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4635             20  CF-APPLICATION-FORCE       PIC X.
  4636             20  CF-INDIVIDUAL-APP.
  4637                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4638                     28  CF-BROWSE-APP      PIC X.
  4639                     28  CF-UPDATE-APP      PIC X.
  4640
  4641         16  CF-CURRENT-TERM-ON             PIC X(4).
  4642         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4643             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4644             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4645             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4646             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4647             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4648             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4649             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4650         16  CF-PROCESSOR-CARRIER           PIC X.
  4651             88  NO-CARRIER-SECURITY            VALUE ' '.
  4652         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4653             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4654         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4655             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4656         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4657             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4658
  4659         16  CF-PROC-SYS-ACCESS-SW.
  4660             20  CF-PROC-CREDIT-CLAIMS-SW.
  4661                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4662                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4663                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4664                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4665             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4666                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4667                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4668             20  CF-PROC-LIFE-GNRLDGR-SW.
  4669                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4670                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4671                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4672                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  91
* EL156.cbl
  4673             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4674                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4675                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4676         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4677             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4678             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4679         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4680
  4681         16  CF-APPROVAL-LEVEL                  PIC X.
  4682             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4683             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4684             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4685             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4686             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4687
  4688         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4689
  4690         16  CF-LANGUAGE-TYPE                   PIC X.
  4691             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4692             88  CF-LANG-IS-FR                      VALUE 'F'.
  4693
  4694         16  CF-CSR-IND                         PIC X.
  4695         16  FILLER                             PIC X(239).
  4696
  4697****************************************************************
  4698*             PROCESSOR/REMINDERS RECORD                       *
  4699****************************************************************
  4700
  4701     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4702         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4703             20  CF-START-REMIND-DT         PIC XX.
  4704             20  CF-END-REMIND-DT           PIC XX.
  4705             20  CF-REMINDER-TEXT           PIC X(50).
  4706         16  FILLER                         PIC X(296).
  4707
  4708
  4709****************************************************************
  4710*             STATE MASTER RECORD                              *
  4711****************************************************************
  4712
  4713     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4714         16  CF-STATE-ABBREVIATION          PIC XX.
  4715         16  CF-STATE-NAME                  PIC X(25).
  4716         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4717         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4718             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4719             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4720             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4721             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4722                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4723                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4724             20  CF-ST-PREM-REJECT-SW       PIC X.
  4725                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4726                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4727             20  CF-ST-REF-REJECT-SW        PIC X.
  4728                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4729                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4730         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  92
* EL156.cbl
  4731         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4732         16  CF-ST-REFUND-RULES.
  4733             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4734             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4735             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4736         16  CF-ST-FST-PMT-EXTENSION.
  4737             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4738             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4739                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4740                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4741                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4742                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4743         16  CF-ST-STATE-CALL.
  4744             20  CF-ST-CALL-UNEARNED        PIC X.
  4745             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4746             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4747         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4748             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4749             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4750         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4751         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4752         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4753         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4754         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4755         16  FILLER                         PIC X.
  4756         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4757             20  CF-ST-BENEFIT-CD           PIC XX.
  4758             20  CF-ST-BENEFIT-KIND         PIC X.
  4759                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4760                 88  CF-ST-AH-KIND              VALUE 'A'.
  4761             20  CF-ST-REM-TERM-CALC        PIC X.
  4762                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4763                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4764                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4765                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4766                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4767                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4768                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4769                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4770
  4771             20  CF-ST-REFUND-CALC          PIC X.
  4772                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4773                 88  ST-REFD-BY-R78             VALUE '1'.
  4774                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4775                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4776                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4777                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4778                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4779                 88  ST-REFD-UTAH               VALUE '7'.
  4780                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4781                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4782                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4783
  4784             20  CF-ST-EARNING-CALC         PIC X.
  4785                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4786                 88  ST-EARN-BY-R78             VALUE '1'.
  4787                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4788                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  93
* EL156.cbl
  4789                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4790                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4791                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4792                 88  ST-EARN-MEAN               VALUE '8'.
  4793                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4794
  4795             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4796                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4797                 88  ST-OVRD-BY-R78             VALUE '1'.
  4798                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4799                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4800                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4801                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4802                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4803                 88  ST-OVRD-MEAN               VALUE '8'.
  4804                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4805             20  cf-st-extra-periods        pic 9.
  4806*            20  FILLER                     PIC X.
  4807
  4808         16  CF-ST-COMMISSION-CAPS.
  4809             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4810             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4811             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4812             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4813         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4814                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4815                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4816                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4817
  4818         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4819
  4820         16  CF-ST-STATUTORY-INTEREST.
  4821             20  CF-ST-STAT-DATE-FROM       PIC X.
  4822                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4823                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4824             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4825             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4826             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4827             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4828             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4829
  4830         16  CF-ST-OVER-SHORT.
  4831             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4832             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4833
  4834         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4835
  4836         16  CF-ST-RT-CALC                  PIC X.
  4837
  4838         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4839         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4840         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4841         16  CF-ST-RF-LR-CALC               PIC X.
  4842         16  CF-ST-RF-LL-CALC               PIC X.
  4843         16  CF-ST-RF-LN-CALC               PIC X.
  4844         16  CF-ST-RF-AH-CALC               PIC X.
  4845         16  CF-ST-RF-CP-CALC               PIC X.
  4846*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  94
* EL156.cbl
  4847*CIDMOD         16  FILLER                         PIC X(192).
  4848         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4849             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4850         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4851         16  CF-ST-VFY-2ND-BENE             PIC X.
  4852         16  CF-ST-CAUSAL-STATE             PIC X.
  4853         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4854         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4855         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4856             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4857         16  CF-ST-NET-ONLY-STATE           PIC X.
  4858             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4859         16  cf-commission-cap-required     pic x.
  4860         16  CF-ST-GA-COMMISSION-CAPS.
  4861             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4862             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4863             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4864             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4865         16  CF-ST-TOT-COMMISSION-CAPS.
  4866             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4867             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4868             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4869             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4870         16  FILLER                         PIC X(156).
  4871
  4872****************************************************************
  4873*             BENEFIT MASTER RECORD                            *
  4874****************************************************************
  4875
  4876     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4877         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4878             20  CF-BENEFIT-CODE            PIC XX.
  4879             20  CF-BENEFIT-NUMERIC  REDEFINES
  4880                 CF-BENEFIT-CODE            PIC XX.
  4881             20  CF-BENEFIT-ALPHA           PIC XXX.
  4882             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4883             20  CF-BENEFIT-COMMENT         PIC X(10).
  4884
  4885             20  CF-LF-COVERAGE-TYPE        PIC X.
  4886                 88  CF-REDUCING                VALUE 'R'.
  4887                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4888
  4889             20  CF-SPECIAL-CALC-CD         PIC X.
  4890                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4891                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4892                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4893                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4894                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4895                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4896                 88  CF-FARM-PLAN               VALUE 'F'.
  4897                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4898                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4899                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4900                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4901                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4902                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4903                 88  CF-PRUDENTIAL              VALUE 'P'.
  4904                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  95
* EL156.cbl
  4905                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4906                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4907                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4908                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4909                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4910
  4911             20  CF-JOINT-INDICATOR         PIC X.
  4912                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4913
  4914*            20  FILLER                     PIC X(12).
  4915             20  cf-maximum-benefits        pic s999 comp-3.
  4916             20  FILLER                     PIC X(09).
  4917             20  CF-BENEFIT-CATEGORY        PIC X.
  4918             20  CF-LOAN-TYPE               PIC X(8).
  4919
  4920             20  CF-CO-REM-TERM-CALC        PIC X.
  4921                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4922                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4923                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4924                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4925                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4926
  4927             20  CF-CO-EARNINGS-CALC        PIC X.
  4928                 88  CO-EARN-BY-R78             VALUE '1'.
  4929                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4930                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4931                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4932                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4933                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4934                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4935                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4936
  4937             20  CF-CO-REFUND-CALC          PIC X.
  4938                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4939                 88  CO-REFD-BY-R78             VALUE '1'.
  4940                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4941                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4942                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4943                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4944                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4945                 88  CO-REFD-MEAN               VALUE '8'.
  4946                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4947                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4948                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4949
  4950             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4951                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4952                 88  CO-OVRD-BY-R78             VALUE '1'.
  4953                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4954                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4955                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4956                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4957                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4958                 88  CO-OVRD-MEAN               VALUE '8'.
  4959                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4960
  4961             20  CF-CO-BEN-I-G-CD           PIC X.
  4962                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  96
* EL156.cbl
  4963                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4964                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4965
  4966         16  FILLER                         PIC X(304).
  4967
  4968
  4969****************************************************************
  4970*             CARRIER MASTER RECORD                            *
  4971****************************************************************
  4972
  4973     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4974         16  CF-ADDRESS-DATA.
  4975             20  CF-MAIL-TO-NAME            PIC X(30).
  4976             20  CF-IN-CARE-OF              PIC X(30).
  4977             20  CF-ADDRESS-LINE-1          PIC X(30).
  4978             20  CF-ADDRESS-LINE-2          PIC X(30).
  4979             20  CF-CITY-STATE              PIC X(30).
  4980             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4981             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4982
  4983         16  CF-CLAIM-NO-CONTROL.
  4984             20  CF-CLAIM-NO-METHOD         PIC X.
  4985                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4986                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4987                 88  CLAIM-NO-SEQ               VALUE '3'.
  4988                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4989             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4990                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4991                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4992                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4993
  4994         16  CF-CHECK-NO-CONTROL.
  4995             20  CF-CHECK-NO-METHOD         PIC X.
  4996                 88  CHECK-NO-MANUAL            VALUE '1'.
  4997                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4998                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4999                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5000             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5001                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5002
  5003         16  CF-DOMICILE-STATE              PIC XX.
  5004
  5005         16  CF-EXPENSE-CONTROLS.
  5006             20  CF-EXPENSE-METHOD          PIC X.
  5007                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5008                 88  DOLLARS-PER-PMT            VALUE '2'.
  5009                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5010                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5011             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5012             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5013
  5014         16  CF-CORRESPONDENCE-CONTROL.
  5015             20  CF-LETTER-RESEND-OPT       PIC X.
  5016                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5017                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5018             20  FILLER                     PIC X(4).
  5019
  5020         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  97
* EL156.cbl
  5021             20  CF-MANUAL-SW               PIC X.
  5022                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5023             20  CF-FUTURE-SW               PIC X.
  5024                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5025             20  CF-PTC-SW                  PIC X.
  5026                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5027             20  CF-IBNR-SW                 PIC X.
  5028                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5029             20  CF-PTC-LF-SW               PIC X.
  5030                 88  CF-LF-PTC-USED             VALUE '1'.
  5031             20  CF-CDT-ACCESS-METHOD       PIC X.
  5032                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5033                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5034                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5035             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5036
  5037         16  CF-CLAIM-CALC-METHOD           PIC X.
  5038             88  360-PLUS-MONTHS                VALUE '1'.
  5039             88  365-PLUS-MONTHS                VALUE '2'.
  5040             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5041             88  360-DAILY                      VALUE '4'.
  5042             88  365-DAILY                      VALUE '5'.
  5043
  5044         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5045         16  FILLER                         PIC X(11).
  5046
  5047         16  CF-LIMIT-AMOUNTS.
  5048             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5049             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5050             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5051             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5052             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5053             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5054             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5055             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5056             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5057             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5058
  5059         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5060         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5061         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5062
  5063         16  CF-ZIP-CODE.
  5064             20  CF-ZIP-PRIME.
  5065                 24  CF-ZIP-1ST             PIC X.
  5066                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5067                 24  FILLER                 PIC X(4).
  5068             20  CF-ZIP-PLUS4               PIC X(4).
  5069         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5070             20  CF-CAN-POSTAL-1            PIC XXX.
  5071             20  CF-CAN-POSTAL-2            PIC XXX.
  5072             20  FILLER                     PIC XXX.
  5073
  5074         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5075         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5076         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5077
  5078         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  98
* EL156.cbl
  5079             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5080             88  CF-NO-RATING                   VALUE 'N'.
  5081
  5082         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5083
  5084         16  CF-CARRIER-OVER-SHORT.
  5085             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5086             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5087
  5088         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5089         16  CF-SECPAY-SWITCH               PIC X.
  5090             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5091             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5092         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5093         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5094         16  FILLER                         PIC X(444).
  5095*        16  FILLER                         PIC X(452).
  5096
  5097
  5098****************************************************************
  5099*             MORTALITY MASTER RECORD                          *
  5100****************************************************************
  5101
  5102     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5103         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5104                                INDEXED BY CF-MORT-NDX.
  5105             20  CF-MORT-TABLE              PIC X(5).
  5106             20  CF-MORT-TABLE-TYPE         PIC X.
  5107                 88  CF-MORT-JOINT              VALUE 'J'.
  5108                 88  CF-MORT-SINGLE             VALUE 'S'.
  5109                 88  CF-MORT-COMBINED           VALUE 'C'.
  5110                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5111                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5112             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5113             20  CF-MORT-AGE-METHOD         PIC XX.
  5114                 88  CF-AGE-LAST                VALUE 'AL'.
  5115                 88  CF-AGE-NEAR                VALUE 'AN'.
  5116             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5117             20  CF-MORT-ADJUSTMENT-DIRECTION
  5118                                            PIC X.
  5119                 88  CF-MINUS                   VALUE '-'.
  5120                 88  CF-PLUS                    VALUE '+'.
  5121             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5122             20  CF-MORT-JOINT-CODE         PIC X.
  5123                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5124             20  CF-MORT-PC-Q               PIC X.
  5125                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5126             20  CF-MORT-TABLE-CODE         PIC X(4).
  5127             20  CF-MORT-COMMENTS           PIC X(15).
  5128             20  FILLER                     PIC X(14).
  5129
  5130         16  FILLER                         PIC X(251).
  5131
  5132
  5133****************************************************************
  5134*             BUSSINESS TYPE MASTER RECORD                     *
  5135****************************************************************
  5136
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page  99
* EL156.cbl
  5137     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5138* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5139* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5140* AND RECORD 05 IS TYPES 81-99
  5141         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5142             20  CF-BUSINESS-TITLE          PIC  X(19).
  5143             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5144                                            PIC S9V9(4) COMP-3.
  5145             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5146             20  FILLER                     PIC  X.
  5147         16  FILLER                         PIC  X(248).
  5148
  5149
  5150****************************************************************
  5151*             TERMINAL MASTER RECORD                           *
  5152****************************************************************
  5153
  5154     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5155
  5156         16  CF-COMPANY-TERMINALS.
  5157             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5158                                  PIC X(4).
  5159         16  FILLER               PIC X(248).
  5160
  5161
  5162****************************************************************
  5163*             LIFE EDIT MASTER RECORD                          *
  5164****************************************************************
  5165
  5166     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5167         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5168             20  CF-LIFE-CODE-IN            PIC XX.
  5169             20  CF-LIFE-CODE-OUT           PIC XX.
  5170         16  FILLER                         PIC X(248).
  5171
  5172
  5173****************************************************************
  5174*             AH EDIT MASTER RECORD                            *
  5175****************************************************************
  5176
  5177     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5178         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5179             20  CF-AH-CODE-IN              PIC XXX.
  5180             20  CF-AH-CODE-OUT             PIC XX.
  5181         16  FILLER                         PIC X(248).
  5182
  5183
  5184****************************************************************
  5185*             CREDIBILITY TABLES                               *
  5186****************************************************************
  5187
  5188     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5189         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5190                             INDEXED BY CF-CRDB-NDX.
  5191             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5192             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5193             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5194         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 100
* EL156.cbl
  5195
  5196
  5197****************************************************************
  5198*             REPORT CUSTOMIZATION RECORD                      *
  5199****************************************************************
  5200
  5201     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5202         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5203             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5204             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5205             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5206**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5207****       A T-TRANSFER.                                   ****
  5208             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5209
  5210         16  FILLER                         PIC XX.
  5211
  5212         16  CF-CARRIER-CNTL-OPT.
  5213             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5214                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5215                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5216             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5217                                            PIC X.
  5218         16  CF-GROUP-CNTL-OPT.
  5219             20  CF-GROUP-OPT-SEQ           PIC 9.
  5220                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5221                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5222             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5223                                            PIC X(6).
  5224         16  CF-STATE-CNTL-OPT.
  5225             20  CF-STATE-OPT-SEQ           PIC 9.
  5226                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5227                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5228             20  CF-STATE-SELECT OCCURS 3 TIMES
  5229                                            PIC XX.
  5230         16  CF-ACCOUNT-CNTL-OPT.
  5231             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5232                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5233                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5234             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5235                                            PIC X(10).
  5236         16  CF-BUS-TYP-CNTL-OPT.
  5237             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5238                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5239                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5240             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5241                                            PIC XX.
  5242         16  CF-LF-TYP-CNTL-OPT.
  5243             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5244                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5245                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5246             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5247                                            PIC XX.
  5248         16  CF-AH-TYP-CNTL-OPT.
  5249             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5250                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5251                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5252             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 101
* EL156.cbl
  5253                                            PIC XX.
  5254         16  CF-REPTCD1-CNTL-OPT.
  5255             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5256                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5257                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5258             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5259                                            PIC X(10).
  5260         16  CF-REPTCD2-CNTL-OPT.
  5261             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5262                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5263                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5264             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5265                                            PIC X(10).
  5266         16  CF-USER1-CNTL-OPT.
  5267             20  CF-USER1-OPT-SEQ           PIC 9.
  5268                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5269                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5270             20  CF-USER1-SELECT OCCURS 3 TIMES
  5271                                            PIC X(10).
  5272         16  CF-USER2-CNTL-OPT.
  5273             20  CF-USER2-OPT-SEQ           PIC 9.
  5274                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5275                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5276             20  CF-USER2-SELECT OCCURS 3 TIMES
  5277                                            PIC X(10).
  5278         16  CF-USER3-CNTL-OPT.
  5279             20  CF-USER3-OPT-SEQ           PIC 9.
  5280                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5281                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5282             20  CF-USER3-SELECT OCCURS 3 TIMES
  5283                                            PIC X(10).
  5284         16  CF-USER4-CNTL-OPT.
  5285             20  CF-USER4-OPT-SEQ           PIC 9.
  5286                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5287                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5288             20  CF-USER4-SELECT OCCURS 3 TIMES
  5289                                            PIC X(10).
  5290         16  CF-USER5-CNTL-OPT.
  5291             20  CF-USER5-OPT-SEQ           PIC 9.
  5292                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5293                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5294             20  CF-USER5-SELECT OCCURS 3 TIMES
  5295                                            PIC X(10).
  5296         16  CF-REINS-CNTL-OPT.
  5297             20  CF-REINS-OPT-SEQ           PIC 9.
  5298                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5299                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5300             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5301                 24  CF-REINS-PRIME         PIC XXX.
  5302                 24  CF-REINS-SUB           PIC XXX.
  5303
  5304         16  CF-AGENT-CNTL-OPT.
  5305             20  CF-AGENT-OPT-SEQ           PIC 9.
  5306                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5307                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5308             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5309                                            PIC X(10).
  5310
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 102
* EL156.cbl
  5311         16  FILLER                         PIC X(43).
  5312
  5313         16  CF-LOSS-RATIO-SELECT.
  5314             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5315             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5316         16  CF-ENTRY-DATE-SELECT.
  5317             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5318             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5319         16  CF-EFFECTIVE-DATE-SELECT.
  5320             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5321             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5322
  5323         16  CF-EXCEPTION-LIST-IND          PIC X.
  5324             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5325
  5326         16  FILLER                         PIC X(318).
  5327
  5328****************************************************************
  5329*                  EXCEPTION REPORTING RECORD                  *
  5330****************************************************************
  5331
  5332     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5333         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5334             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5335
  5336         16  CF-COMBINED-LIFE-AH-OPT.
  5337             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5338             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5339             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5340             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5341
  5342         16  CF-LIFE-OPT.
  5343             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5344             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5345             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5346             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5347             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5348             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5349             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5350             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5351             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5352             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5353
  5354         16  CF-AH-OPT.
  5355             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5356             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5357             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5358             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5359             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5360             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5361             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5362             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5363             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5364             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5365
  5366         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5367             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5368             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 103
* EL156.cbl
  5369             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5370
  5371         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5372
  5373         16  FILLER                         PIC X(673).
  5374
  5375
  5376****************************************************************
  5377*             MORTGAGE SYSTEM PLAN RECORD                      *
  5378****************************************************************
  5379
  5380     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5381         16  CF-PLAN-TYPE                   PIC X.
  5382             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5383             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5384             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5385         16  CF-PLAN-ABBREV                 PIC XXX.
  5386         16  CF-PLAN-DESCRIPT               PIC X(10).
  5387         16  CF-PLAN-NOTES                  PIC X(20).
  5388         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5389         16  CF-PLAN-UNDERWRITING.
  5390             20  CF-PLAN-TERM-DATA.
  5391                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5392                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5393             20  CF-PLAN-AGE-DATA.
  5394                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5395                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5396                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5397             20  CF-PLAN-BENEFIT-DATA.
  5398                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5399                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5400                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5401                                            PIC S9(7)V99  COMP-3.
  5402         16  CF-PLAN-POLICY-FORMS.
  5403             20  CF-POLICY-FORM             PIC X(12).
  5404             20  CF-MASTER-APPLICATION      PIC X(12).
  5405             20  CF-MASTER-POLICY           PIC X(12).
  5406         16  CF-PLAN-RATING.
  5407             20  CF-RATE-CODE               PIC X(5).
  5408             20  CF-SEX-RATING              PIC X.
  5409                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5410                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5411             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5412             20  CF-SUB-STD-TYPE            PIC X.
  5413                 88  CF-PCT-OF-PREM            VALUE '1'.
  5414                 88  CF-PCT-OF-BENE            VALUE '2'.
  5415         16  CF-PLAN-PREM-TOLERANCES.
  5416             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5417             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5418         16  CF-PLAN-PYMT-TOLERANCES.
  5419             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5420             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5421         16  CF-PLAN-MISC-DATA.
  5422             20  FILLER                     PIC X.
  5423             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5424             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5425         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5426         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 104
* EL156.cbl
  5427             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5428                                                     '1'.
  5429             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5430                                                     '2'.
  5431         16  CF-MIB-SEARCH-SW               PIC X.
  5432             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5433             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5434             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5435             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5436         16  CF-ALPHA-SEARCH-SW             PIC X.
  5437             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5438             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5439             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5440             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5441             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5442             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5443             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5444             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5445             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5446             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5447                                                     'A' 'B' 'C'
  5448                                                     'X' 'Y' 'Z'.
  5449         16  CF-EFF-DT-RULE-SW              PIC X.
  5450             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5451             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5452             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5453             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5454             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5455         16  FILLER                         PIC X(4).
  5456         16  CF-HEALTH-QUESTIONS            PIC X.
  5457             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5458         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5459         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5460         16  CF-PLAN-SNGL-JNT               PIC X.
  5461             88  CF-COMBINED-PLAN              VALUE 'C'.
  5462             88  CF-JNT-PLAN                   VALUE 'J'.
  5463             88  CF-SNGL-PLAN                  VALUE 'S'.
  5464         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5465         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5466         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5467         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5468         16  CF-RERATE-CNTL                 PIC  X.
  5469             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5470             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5471             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5472             88  CF-AUTO-RECALC                 VALUE '4'.
  5473         16  CF-BENEFIT-TYPE                PIC  X.
  5474             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5475             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5476         16  CF-POLICY-FEE                  PIC S999V99
  5477                                                    COMP-3.
  5478         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5479         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5480         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5481         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5482         16  FILLER                         PIC  X(32).
  5483         16  CF-TERMINATION-FORM            PIC  X(04).
  5484         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 105
* EL156.cbl
  5485         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5486                                                       COMP-3.
  5487         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5488         16  CF-ISSUE-LETTER                PIC  X(4).
  5489         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5490         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5491             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5492             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5493         16  CF-MP-REFUND-CALC              PIC X.
  5494             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5495             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5496             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5497             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5498             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5499             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5500             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5501             88  CF-MP-REFD-MEAN                VALUE '8'.
  5502         16  CF-ALT-RATE-CODE               PIC  X(5).
  5503
  5504
  5505         16  FILLER                         PIC X(498).
  5506****************************************************************
  5507*             MORTGAGE COMPANY MASTER RECORD                   *
  5508****************************************************************
  5509
  5510     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5511         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5512         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5513             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5514             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5515             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5516             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5517             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5518
  5519         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5520         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5521         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5522         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5523         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5524
  5525         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5526             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5527         16  CF-MP-RECON-USE-IND            PIC X(1).
  5528             88  CF-MP-USE-RECON             VALUE 'Y'.
  5529         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5530             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5531         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5532             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5533             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5534         16  FILLER                         PIC X(1).
  5535         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5536             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5537         16  CF-MORTG-MIB-VERSION           PIC X.
  5538             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5539             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5540             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5541         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5542             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 106
* EL156.cbl
  5543                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5544             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5545                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5546             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5547                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5548             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5549                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5550             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5551                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5552             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5553                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5554         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5555         16  FILLER                         PIC X(7).
  5556         16  CF-MORTG-DESTINATION-SYMBOL.
  5557             20  CF-MORTG-MIB-COMM          PIC X(5).
  5558             20  CF-MORTG-MIB-TERM          PIC X(5).
  5559         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5560             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5561         16  FILLER                         PIC X(03).
  5562         16  CF-MP-CHECK-NO-CONTROL.
  5563             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5564                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5565                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5566                                                ' ' LOW-VALUES.
  5567                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5568                                               VALUE '3'.
  5569         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5570         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5571         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5572             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5573                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5574             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5575                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5576             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5577                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5578             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5579                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5580             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5581                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5582             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5583                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5584         16  CF-MORTG-BILLING-AREA.
  5585             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5586                                            PIC X.
  5587         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5588         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5589         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5590         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5591             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5592             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5593         16  FILLER                         PIC X.
  5594         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5595             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5596             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5597         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5598         16  FILLER                         PIC X(8).
  5599         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5600         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 107
* EL156.cbl
  5601         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5602         16  CF-ACH-COMPANY-ID.
  5603             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5604                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5605                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5606                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5607             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5608         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5609             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5610         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5611             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5612             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5613         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5614         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5615         16  FILLER                         PIC X(536).
  5616
  5617****************************************************************
  5618*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5619****************************************************************
  5620
  5621     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5622         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5623             20  CF-FEMALE-HEIGHT.
  5624                 24  CF-FEMALE-FT           PIC 99.
  5625                 24  CF-FEMALE-IN           PIC 99.
  5626             20  CF-FEMALE-MIN-WT           PIC 999.
  5627             20  CF-FEMALE-MAX-WT           PIC 999.
  5628         16  FILLER                         PIC X(428).
  5629
  5630     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5631         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5632             20  CF-MALE-HEIGHT.
  5633                 24  CF-MALE-FT             PIC 99.
  5634                 24  CF-MALE-IN             PIC 99.
  5635             20  CF-MALE-MIN-WT             PIC 999.
  5636             20  CF-MALE-MAX-WT             PIC 999.
  5637         16  FILLER                         PIC X(428).
  5638******************************************************************
  5639*             AUTOMATIC ACTIVITY RECORD                          *
  5640******************************************************************
  5641     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5642         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5643             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5644             20  CF-SYS-LETTER-ID           PIC X(04).
  5645             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5646             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5647             20  CF-SYS-RESET-SW            PIC X(01).
  5648             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5649             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5650
  5651         16  FILLER                         PIC X(50).
  5652
  5653         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5654             20  CF-USER-ACTIVE-SW          PIC X(01).
  5655             20  CF-USER-LETTER-ID          PIC X(04).
  5656             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5657             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5658             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 108
* EL156.cbl
  5659             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5660             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5661             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5662
  5663         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 109
* EL156.cbl
  5665*    COPY ELCCERT.
  5666******************************************************************
  5667*                                                                *
  5668*                            ELCCERT.                            *
  5669*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5670*                            VMOD=2.013                          *
  5671*                                                                *
  5672*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5673*                                                                *
  5674*   FILE TYPE = VSAM,KSDS                                        *
  5675*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5676*                                                                *
  5677*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5678*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5679*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5680*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5681*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5682*                                                                *
  5683*   LOG = YES                                                    *
  5684*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5685******************************************************************
  5686*                   C H A N G E   L O G
  5687*
  5688* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5689*-----------------------------------------------------------------
  5690*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5691* EFFECTIVE    NUMBER
  5692*-----------------------------------------------------------------
  5693* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5694* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5695* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5696* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5697* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5698* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5699* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5700* 032612  CR2011110200001  PEMA  AHL CHANGES
  5701* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5702* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5703* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  5704******************************************************************
  5705
  5706 01  CERTIFICATE-MASTER.
  5707     12  CM-RECORD-ID                      PIC XX.
  5708         88  VALID-CM-ID                      VALUE 'CM'.
  5709
  5710     12  CM-CONTROL-PRIMARY.
  5711         16  CM-COMPANY-CD                 PIC X.
  5712         16  CM-CARRIER                    PIC X.
  5713         16  CM-GROUPING.
  5714             20  CM-GROUPING-PREFIX        PIC X(3).
  5715             20  CM-GROUPING-PRIME         PIC X(3).
  5716         16  CM-STATE                      PIC XX.
  5717         16  CM-ACCOUNT.
  5718             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5719             20  CM-ACCOUNT-PRIME          PIC X(6).
  5720         16  CM-CERT-EFF-DT                PIC XX.
  5721         16  CM-CERT-NO.
  5722             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 110
* EL156.cbl
  5723             20  CM-CERT-SFX               PIC X.
  5724
  5725     12  CM-CONTROL-BY-NAME.
  5726         16  CM-COMPANY-CD-A1              PIC X.
  5727         16  CM-INSURED-LAST-NAME          PIC X(15).
  5728         16  CM-INSURED-INITIALS.
  5729             20  CM-INSURED-INITIAL1       PIC X.
  5730             20  CM-INSURED-INITIAL2       PIC X.
  5731
  5732     12  CM-CONTROL-BY-SSN.
  5733         16  CM-COMPANY-CD-A2              PIC X.
  5734         16  CM-SOC-SEC-NO.
  5735             20  CM-SSN-STATE              PIC XX.
  5736             20  CM-SSN-ACCOUNT            PIC X(6).
  5737             20  CM-SSN-LN3.
  5738                 25  CM-INSURED-INITIALS-A2.
  5739                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5740                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5741                 25 CM-PART-LAST-NAME-A2         PIC X.
  5742
  5743     12  CM-CONTROL-BY-CERT-NO.
  5744         16  CM-COMPANY-CD-A4              PIC X.
  5745         16  CM-CERT-NO-A4                 PIC X(11).
  5746
  5747     12  CM-CONTROL-BY-MEMB.
  5748         16  CM-COMPANY-CD-A5              PIC X.
  5749         16  CM-MEMBER-NO.
  5750             20  CM-MEMB-STATE             PIC XX.
  5751             20  CM-MEMB-ACCOUNT           PIC X(6).
  5752             20  CM-MEMB-LN4.
  5753                 25  CM-INSURED-INITIALS-A5.
  5754                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5755                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5756                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5757
  5758     12  CM-INSURED-PROFILE-DATA.
  5759         16  CM-INSURED-FIRST-NAME.
  5760             20  CM-INSURED-1ST-INIT       PIC X.
  5761             20  FILLER                    PIC X(9).
  5762         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5763         16  CM-INSURED-SEX                PIC X.
  5764             88  CM-SEX-MALE                  VALUE 'M'.
  5765             88  CM-SEX-FEMAL                 VALUE 'F'.
  5766         16  CM-INSURED-JOINT-AGE          PIC 99.
  5767         16  CM-JOINT-INSURED-NAME.
  5768             20  CM-JT-LAST-NAME           PIC X(15).
  5769             20  CM-JT-FIRST-NAME.
  5770                 24  CM-JT-1ST-INIT        PIC X.
  5771                 24  FILLER                PIC X(9).
  5772             20  CM-JT-INITIAL             PIC X.
  5773
  5774     12  CM-LIFE-DATA.
  5775         16  CM-LF-BENEFIT-CD              PIC XX.
  5776         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5777         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5778         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5779         16  CM-LF-DEV-CODE                PIC XXX.
  5780         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 111
* EL156.cbl
  5781         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5782         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5783         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5784         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5785         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5786         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5787         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5788         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5789         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5790         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5791         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5792         16  cm-temp-epiq                  pic xx.
  5793             88  EPIQ-CLASS                  value 'EQ'.
  5794*        16  FILLER                        PIC XX.
  5795
  5796     12  CM-AH-DATA.
  5797         16  CM-AH-BENEFIT-CD              PIC XX.
  5798         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5799         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5800         16  CM-AH-DEV-CODE                PIC XXX.
  5801         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5802         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5803         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5804         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5805         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5806         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5807         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5808         16  CM-AH-PAID-THRU-DT            PIC XX.
  5809             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5810         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5811         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5812         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5813         16  FILLER                        PIC X.
  5814
  5815     12  CM-LOAN-INFORMATION.
  5816         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5817         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5818                                           PIC S9(5)V99  COMP-3.
  5819         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5820         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5821         16  CM-PAY-FREQUENCY              PIC S99.
  5822         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5823         16  CM-RATE-CLASS                 PIC XX.
  5824         16  CM-BENEFICIARY                PIC X(25).
  5825         16  CM-POLICY-FORM-NO             PIC X(12).
  5826         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5827         16  CM-LAST-ADD-ON-DT             PIC XX.
  5828         16  CM-DEDUCTIBLE-AMOUNTS.
  5829             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5830             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5831         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5832             20  CM-RESIDENT-STATE         PIC XX.
  5833             20  CM-RATE-CODE              PIC X(4).
  5834             20  FILLER                    PIC XX.
  5835         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5836             20  CM-LOAN-OFFICER           PIC X(5).
  5837             20  FILLER                    PIC XXX.
  5838         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 112
* EL156.cbl
  5839         16  CM-UNDERWRITING-CODE          PIC X.
  5840             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5841         16  CM-POST-CARD-IND              PIC X.
  5842         16  CM-REF-INTERFACE-SW           PIC X.
  5843         16  CM-PREMIUM-TYPE               PIC X.
  5844             88  CM-SING-PRM                  VALUE '1'.
  5845             88  CM-O-B-COVERAGE              VALUE '2'.
  5846             88  CM-OPEN-END                  VALUE '3'.
  5847         16  CM-IND-GRP-TYPE               PIC X.
  5848             88  CM-INDIVIDUAL                VALUE 'I'.
  5849             88  CM-GROUP                     VALUE 'G'.
  5850         16  CM-SKIP-CODE                  PIC X.
  5851             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5852             88  SKIP-JULY                    VALUE '1'.
  5853             88  SKIP-AUGUST                  VALUE '2'.
  5854             88  SKIP-SEPTEMBER               VALUE '3'.
  5855             88  SKIP-JULY-AUG                VALUE '4'.
  5856             88  SKIP-AUG-SEPT                VALUE '5'.
  5857             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5858             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5859             88  SKIP-JUNE                    VALUE '8'.
  5860             88  SKIP-JUNE-JULY               VALUE '9'.
  5861             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5862             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5863         16  CM-PAYMENT-MODE               PIC X.
  5864             88  PAY-MONTHLY                  VALUE SPACE.
  5865             88  PAY-WEEKLY                   VALUE '1'.
  5866             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5867             88  PAY-BI-WEEKLY                VALUE '3'.
  5868             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5869         16  CM-LOAN-NUMBER                PIC X(8).
  5870         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5871         16  CM-OLD-LOF                    PIC XXX.
  5872*        16  CM-LOAN-OFFICER               PIC XXX.
  5873         16  CM-REIN-TABLE                 PIC XXX.
  5874         16  CM-SPECIAL-REIN-CODE          PIC X.
  5875         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5876         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5877         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5878
  5879     12  CM-STATUS-DATA.
  5880         16  CM-ENTRY-STATUS               PIC X.
  5881         16  CM-ENTRY-DT                   PIC XX.
  5882
  5883         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5884         16  CM-LF-CANCEL-DT               PIC XX.
  5885         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5886
  5887         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5888         16  CM-LF-DEATH-DT                PIC XX.
  5889         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5890
  5891         16  CM-LF-CURRENT-STATUS          PIC X.
  5892             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5893                                                'M' '4' '5' '9'.
  5894             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5895             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5896             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 113
* EL156.cbl
  5897             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5898             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5899             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5900             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5901             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5902             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5903             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5904             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5905             88  CM-LF-DECLINED               VALUE 'D'.
  5906             88  CM-LF-VOIDED                 VALUE 'V'.
  5907
  5908         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5909         16  CM-AH-CANCEL-DT               PIC XX.
  5910         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5911
  5912         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5913         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5914         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5915
  5916         16  CM-AH-CURRENT-STATUS          PIC X.
  5917             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5918                                                'M' '4' '5' '9'.
  5919             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5920             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5921             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5922             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5923             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5924             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5925             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5926             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5927             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5928             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5929             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5930             88  CM-AH-DECLINED               VALUE 'D'.
  5931             88  CM-AH-VOIDED                 VALUE 'V'.
  5932
  5933         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5934             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5935             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5936             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5937         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5938
  5939         16  CM-ENTRY-BATCH                PIC X(6).
  5940         16  CM-LF-EXIT-BATCH              PIC X(6).
  5941         16  CM-AH-EXIT-BATCH              PIC X(6).
  5942         16  CM-LAST-MONTH-END             PIC XX.
  5943
  5944     12  CM-NOTE-SW                        PIC X.
  5945         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5946         88  CERT-NOTES-PRESENT               VALUE '1'.
  5947         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5948         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5949         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5950         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5951         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5952         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5953     12  CM-COMP-EXCP-SW                   PIC X.
  5954         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 114
* EL156.cbl
  5955         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5956     12  CM-INSURED-ADDRESS-SW             PIC X.
  5957         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5958         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5959
  5960*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5961     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5962     12  FILLER                            PIC X.
  5963
  5964*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5965     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5966     12  FILLER                            PIC X.
  5967*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5968     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  5969
  5970     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5971         88  CERT-ADDED-BATCH                 VALUE ' '.
  5972         88  CERT-ADDED-ONLINE                VALUE '1'.
  5973         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5974         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5975         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5976     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5977         88  CERT-AS-LOADED                   VALUE ' '.
  5978         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5979         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5980         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5981         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5982         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5983         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5984         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5985
  5986     12  CM-ACCOUNT-COMM-PCTS.
  5987         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5988         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5989
  5990     12  CM-USER-FIELD                     PIC X.
  5991     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5992     12  CM-CLP-STATE                      PIC XX.
  5993     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5994     12  CM-USER-RESERVED                  PIC XXX.
  5995     12  FILLER REDEFINES CM-USER-RESERVED.
  5996         16  CM-AH-CLASS-CD                PIC XX.
  5997         16  F                             PIC X.
  5998******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 115
* EL156.cbl
  6000*    COPY ELCTRLR.
  6001******************************************************************
  6002*                                                                *
  6003*                            ELCTRLR.                            *
  6004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6005*                            VMOD=2.014                          *
  6006*                                                                *
  6007*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  6008*                                                                *
  6009*   FILE TYPE = VSAM,KSDS                                        *
  6010*   RECORD SIZE = 200    RECFORM = FIXED                         *
  6011*                                                                *
  6012*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  6013*       ALTERNATE INDEX = NONE                                   *
  6014*                                                                *
  6015*   LOG = YES                                                    *
  6016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6017******************************************************************
  6018*                   C H A N G E   L O G
  6019*
  6020* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6021*-----------------------------------------------------------------
  6022*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6023* EFFECTIVE    NUMBER
  6024*-----------------------------------------------------------------
  6025* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  6026* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  6027* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  6028* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  6029* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  6030* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  6031* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  6032* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  6033* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  6034* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  6035* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  6036* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  6037* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  6038* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  6039* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  6040* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  6041* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  6042* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  6043* 040814    2014030500002  AJRA  ADD ICD CODES
  6044* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  6045* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6046* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  6047* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  6048* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
  6049******************************************************************
  6050 01  ACTIVITY-TRAILERS.
  6051     12  AT-RECORD-ID                    PIC XX.
  6052         88  VALID-AT-ID                       VALUE 'AT'.
  6053
  6054     12  AT-CONTROL-PRIMARY.
  6055         16  AT-COMPANY-CD               PIC X.
  6056         16  AT-CARRIER                  PIC X.
  6057         16  AT-CLAIM-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 116
* EL156.cbl
  6058         16  AT-CERT-NO.
  6059             20  AT-CERT-PRIME           PIC X(10).
  6060             20  AT-CERT-SFX             PIC X.
  6061         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  6062             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  6063             88  AT-LAST-TRL-AVAIL            VALUE +100.
  6064             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  6065             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  6066             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  6067             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  6068             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  6069             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  6070             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  6071             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  6072             88  AT-DIAGNOSIS-TRL             VALUE +90.
  6073             88  AT-BENEFICIARY-TRL           VALUE +91.
  6074             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  6075             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  6076             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  6077             88  AT-ERROR-MSGS-TRL            VALUE +95.
  6078
  6079     12  AT-TRAILER-TYPE                 PIC X.
  6080         88  RESERVE-EXPENSE-TR               VALUE '1'.
  6081         88  PAYMENT-TR                       VALUE '2'.
  6082         88  AUTO-PAY-TR                      VALUE '3'.
  6083         88  CORRESPONDENCE-TR                VALUE '4'.
  6084         88  ADDRESS-TR                       VALUE '5'.
  6085         88  GENERAL-INFO-TR                  VALUE '6'.
  6086         88  AUTO-PROMPT-TR                   VALUE '7'.
  6087         88  DENIAL-TR                        VALUE '8'.
  6088         88  INCURRED-CHG-TR                  VALUE '9'.
  6089         88  FORM-CONTROL-TR                  VALUE 'A'.
  6090
  6091     12  AT-RECORDED-DT                  PIC XX.
  6092     12  AT-RECORDED-BY                  PIC X(4).
  6093     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  6094
  6095     12  AT-TRAILER-BODY                 PIC X(165).
  6096
  6097     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  6098         16  AT-RESERVE-CONTROLS.
  6099             20  AT-MANUAL-SW            PIC X.
  6100                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6101             20  AT-FUTURE-SW            PIC X.
  6102                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6103             20  AT-PTC-SW               PIC X.
  6104                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6105             20  AT-IBNR-SW              PIC X.
  6106                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6107             20  AT-PTC-LF-SW            PIC X.
  6108                 88  AT-LF-PTC-USED          VALUE '1'.
  6109             20  AT-CDT-ACCESS-METHOD    PIC X.
  6110                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6111                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6112                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6113             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6114         16  AT-LAST-COMPUTED-DT         PIC XX.
  6115         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 117
* EL156.cbl
  6116         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6117         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6118         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6119         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6120         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6121         16  AT-EXPENSE-CONTROLS.
  6122             20  AT-EXPENSE-METHOD       PIC X.
  6123                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6124                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6125                 88  PERCENT-OF-PMT           VALUE '3'.
  6126                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6127             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6128             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6129         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6130         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6131
  6132         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6133         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6134
  6135*        16  FILLER                      PIC X(53).
  6136         16  FILLER                      PIC X(47).
  6137
  6138         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6139         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6140
  6141         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6142             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6143             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6144*                    C = CLOSED
  6145*                    O = OPEN
  6146             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6147*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6148
  6149     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6150         16  AT-PAYMENT-TYPE             PIC X.
  6151             88  PARTIAL-PAYMENT                VALUE '1'.
  6152             88  FINAL-PAYMENT                  VALUE '2'.
  6153             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6154             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6155             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6156             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6157             88  VOIDED-PAYMENT                 VALUE '9'.
  6158             88  TRANSFER                       VALUE 'T'.
  6159             88  LIFE-INTEREST                  VALUE 'I'.
  6160
  6161         16  AT-CLAIM-TYPE               PIC X.
  6162             88  PAID-FOR-AH                    VALUE 'A'.
  6163             88  PAID-FOR-LIFE                  VALUE 'L'.
  6164             88  PAID-FOR-IUI                   VALUE 'I'.
  6165             88  PAID-FOR-GAP                   VALUE 'G'.
  6166             88  PAID-FOR-FAM                   VALUE 'F'.
  6167             88  PAID-FOR-OTH                   VALUE 'O'.
  6168         16  AT-CLAIM-PREM-TYPE          PIC X.
  6169             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6170             88  AT-O-B-COVERAGE                VALUE '2'.
  6171             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6172         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6173         16  AT-CHECK-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 118
* EL156.cbl
  6174         16  AT-PAID-FROM-DT             PIC XX.
  6175         16  AT-PAID-THRU-DT             PIC XX.
  6176         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6177         16  AT-ACH-PAYMENT              PIC X.
  6178*        16  FILLER                      PIC X.
  6179         16  AT-PAYEES-NAME              PIC X(30).
  6180         16  AT-PAYMENT-ORIGIN           PIC X.
  6181             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6182             88  ONLINE-AUTO-PMT                VALUE '2'.
  6183             88  OFFLINE-PMT                    VALUE '3'.
  6184         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6185         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6186         16  AT-VOID-DATA.
  6187             20  AT-VOID-DT              PIC XX.
  6188*00144       20  AT-VOID-REASON          PIC X(30).
  6189             20  AT-VOID-REASON          PIC X(26).
  6190         16  AT-PMT-APPROVED-BY          PIC X(04).
  6191         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6192         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6193         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6194                                         PIC S99V9(5)  COMP-3.
  6195         16  AT-CREDIT-INTERFACE.
  6196             20  AT-PMT-SELECT-DT        PIC XX.
  6197                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6198             20  AT-PMT-ACCEPT-DT        PIC XX.
  6199                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6200             20  AT-VOID-SELECT-DT       PIC XX.
  6201                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6202             20  AT-VOID-ACCEPT-DT       PIC XX.
  6203                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6204
  6205         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6206                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6207                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6208         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6209
  6210         16  AT-FORCE-CONTROL            PIC X.
  6211             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6212         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6213         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6214         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6215         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6216         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6217         16  AT-BENEFIT-TYPE             PIC X.
  6218
  6219         16  AT-EXPENSE-TYPE             PIC X.
  6220         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6221
  6222         16  AT-PAYEE-TYPE-CD.
  6223             20  AT-PAYEE-TYPE           PIC X.
  6224                 88  INSURED-PAID           VALUE 'I'.
  6225                 88  BENEFICIARY-PAID       VALUE 'B'.
  6226                 88  ACCOUNT-PAID           VALUE 'A'.
  6227                 88  OTHER-1-PAID           VALUE 'O'.
  6228                 88  OTHER-2-PAID           VALUE 'Q'.
  6229                 88  DOCTOR-PAID            VALUE 'P'.
  6230                 88  EMPLOYER-PAID          VALUE 'E'.
  6231             20  AT-PAYEE-SEQ            PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 119
* EL156.cbl
  6232
  6233         16  AT-CASH-PAYMENT             PIC X.
  6234         16  AT-GROUPED-PAYMENT          PIC X.
  6235         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6236         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6237         16  AT-APPROVED-LEVEL           PIC X.
  6238         16  AT-VOID-TYPE                PIC X.
  6239             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6240             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6241         16  AT-AIG-UNEMP-IND            PIC X.
  6242             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6243         16  AT-ASSOCIATES               PIC X.
  6244             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6245             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6246
  6247         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6248         16  AT-CV-PMT-CODE              PIC X.
  6249             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6250             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6251             88  FULL-ADD-PAYMENT           VALUE '3'.
  6252             88  HALF-ADD-PAYMENT           VALUE '4'.
  6253             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6254             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6255             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6256             88  ADDL-PAYMENT               VALUE '8'.
  6257
  6258         16  AT-EOB-CODE1                PIC XXX.
  6259         16  AT-EOB-CODE2                PIC XXX.
  6260         16  AT-EOB-CODE3                PIC XXX.
  6261         16  FILLER REDEFINES AT-EOB-CODE3.
  6262             20  AT-PRINT-CLM-FORM       PIC X.
  6263             20  AT-PRINT-SURVEY         PIC X.
  6264             20  AT-SPECIAL-RELEASE      PIC X.
  6265         16  AT-EOB-CODE4                PIC XXX.
  6266         16  FILLER REDEFINES AT-EOB-CODE4.
  6267             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6268             20  FILLER                  PIC X.
  6269         16  AT-EOB-CODE5                PIC XXX.
  6270         16  FILLER REDEFINES AT-EOB-CODE5.
  6271             20  AT-PMT-PROOF-DT         PIC XX.
  6272             20  FILLER                  PIC X.
  6273
  6274         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6275             88  AT-PRINT-EOB            VALUE 'Y'.
  6276
  6277         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6278         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6279
  6280     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6281         16  AT-SCHEDULE-START-DT        PIC XX.
  6282         16  AT-SCHEDULE-END-DT          PIC XX.
  6283         16  AT-TERMINATED-DT            PIC XX.
  6284         16  AT-LAST-PMT-TYPE            PIC X.
  6285             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6286             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6287         16  AT-FIRST-PMT-DATA.
  6288             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6289             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 120
* EL156.cbl
  6290             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6291         16  AT-REGULAR-PMT-DATA.
  6292             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6293             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6294             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6295         16  AT-AUTO-PAYEE-CD.
  6296             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6297                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6298                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6299                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6300                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6301                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6302             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6303         16  AT-AUTO-PAY-DAY             PIC 99.
  6304         16  AT-AUTO-CASH                PIC X.
  6305             88  AT-CASH                      VALUE 'Y'.
  6306             88  AT-NON-CASH                  VALUE 'N'.
  6307*        16  FILLER                      PIC X(129).
  6308         16  AT-AUTO-END-LETTER          PIC X(4).
  6309         16  FILLER                      PIC X(125).
  6310
  6311         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6312         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6313
  6314     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6315         16  AT-LETTER-SENT-DT           PIC XX.
  6316         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6317         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6318         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6319         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6320         16  AT-LETTER-ORIGIN            PIC X.
  6321             88  ONLINE-CREATION              VALUE '1' '3'.
  6322             88  OFFLINE-CREATION             VALUE '2' '4'.
  6323             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6324             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6325         16  AT-STD-LETTER-FORM          PIC X(4).
  6326         16  AT-REASON-TEXT              PIC X(70).
  6327         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6328         16  AT-ADDRESEE-TYPE            PIC X.
  6329              88  INSURED-ADDRESEE            VALUE 'I'.
  6330              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6331              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6332              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6333              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6334              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6335              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6336         16  AT-ADDRESSEE-NAME           PIC X(30).
  6337         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6338         16  AT-RESEND-PRINT-DATE        PIC XX.
  6339         16  AT-CORR-SOL-UNSOL           PIC X.
  6340         16  AT-LETTER-PURGED-DT         PIC XX.
  6341*
  6342*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6343*
  6344         16  AT-CSO-REDEFINITION.
  6345             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6346             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6347             20  AT-LETTER-TO-BENE       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 121
* EL156.cbl
  6348             20  AT-STOP-LETTER-DT       PIC X(2).
  6349             20  AT-AUTH-RCVD            PIC X(1).
  6350             20  FILLER                  PIC X(18).
  6351*             20  FILLER                  PIC X(27).
  6352             20  AT-CSO-LETTER-STATUS    PIC X.
  6353                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6354                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6355                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6356             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6357             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6358*
  6359*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6360*
  6361*        16  FILLER                      PIC X(26).
  6362*
  6363*        16  AT-DMD-BSR-CODE             PIC X.
  6364*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6365*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6366*
  6367*        16  AT-DMD-LETTER-STATUS        PIC X.
  6368*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6369*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6370*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6371*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6372*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6373
  6374         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6375         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6376
  6377     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6378         16  AT-ADDRESS-TYPE             PIC X.
  6379             88  INSURED-ADDRESS               VALUE 'I'.
  6380             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6381             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6382             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6383             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6384             88  OTHER-ADDRESS-1               VALUE 'O'.
  6385             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6386         16  AT-MAIL-TO-NAME             PIC X(30).
  6387         16  AT-ADDRESS-LINE-1           PIC X(30).
  6388         16  AT-ADDRESS-LINE-2           PIC X(30).
  6389         16  AT-CITY-STATE.
  6390             20  AT-CITY                 PIC X(28).
  6391             20  AT-STATE                PIC XX.
  6392         16  AT-ZIP.
  6393             20  AT-ZIP-CODE.
  6394                 24  AT-ZIP-1ST          PIC X.
  6395                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6396                 24  FILLER              PIC X(4).
  6397             20  AT-ZIP-PLUS4            PIC X(4).
  6398         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6399             20  AT-CAN-POSTAL-1         PIC XXX.
  6400             20  AT-CAN-POSTAL-2         PIC XXX.
  6401             20  FILLER                  PIC XXX.
  6402         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6403*         16  FILLER                      PIC X(23).
  6404         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6405         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 122
* EL156.cbl
  6406         16  FILLER                      PIC X(13).
  6407         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6408         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6409
  6410     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6411         16  AT-INFO-LINE-1              PIC X(60).
  6412         16  FILLER REDEFINES AT-INFO-LINE-1.
  6413             20  AT-NOTE-ERROR-NO OCCURS 15
  6414                                         PIC X(4).
  6415         16  AT-INFO-LINE-2              PIC X(60).
  6416         16  FILLER REDEFINES AT-INFO-LINE-2.
  6417             20  AT-ICD-CODE-1           PIC X(8).
  6418             20  AT-ICD-CODE-2           PIC X(8).
  6419             20  FILLER                  PIC X(44).
  6420         16  AT-INFO-TRAILER-TYPE        PIC X.
  6421             88  AT-ERRORS-NOTE          VALUE 'E'.
  6422             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6423             88  AT-CALL-NOTE            VALUE 'C'.
  6424             88  AT-MAINT-NOTE           VALUE 'M'.
  6425             88  AT-CERT-CHANGE          VALUE 'X'.
  6426             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6427             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6428             88  AT-CERT-CANCELLED       VALUE 'T'.
  6429         16  AT-CALL-TYPE                PIC X.
  6430             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6431             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  6432             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6433         16  AT-NOTE-CONTINUATION        PIC X.
  6434             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6435         16  AT-EOB-CODES-EXIST          PIC X.
  6436             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6437         16  FILLER                      PIC X(35).
  6438         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6439         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6440
  6441     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6442         16  AT-PROMPT-LINE-1            PIC X(60).
  6443         16  AT-PROMPT-LINE-2            PIC X(60).
  6444         16  AT-PROMPT-START-DT          PIC XX.
  6445         16  AT-PROMPT-END-DT            PIC XX.
  6446         16  FILLER                      PIC X(35).
  6447         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6448         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6449
  6450     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6451         16  AT-DENIAL-INFO-1            PIC X(60).
  6452         16  AT-DENIAL-INFO-2            PIC X(60).
  6453         16  AT-DENIAL-DT                PIC XX.
  6454         16  AT-RETRACTION-DT            PIC XX.
  6455         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6456*         16  FILLER                      PIC X(31).
  6457         16  AT-DENIAL-PROOF-DT          PIC XX.
  6458         16  FILLER                      PIC X(29).
  6459         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6460         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6461
  6462     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6463         16  AT-OLD-INCURRED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 123
* EL156.cbl
  6464         16  AT-OLD-REPORTED-DT          PIC XX.
  6465         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6466         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6467         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6468         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6469         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6470         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6471         16  FILLER                      PIC X(26).
  6472         16  AT-OLD-DIAG-CODE            PIC X(6).
  6473         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6474         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6475         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6476         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6477         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6478         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6479         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6480         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6481         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6482         16  FILLER                      PIC X(9).
  6483         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6484
  6485     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6486         16  AT-FORM-SEND-ON-DT          PIC XX.
  6487         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6488         16  AT-FORM-RE-SEND-DT          PIC XX.
  6489         16  AT-FORM-ANSWERED-DT         PIC XX.
  6490         16  AT-FORM-PRINTED-DT          PIC XX.
  6491         16  AT-FORM-REPRINT-DT          PIC XX.
  6492         16  AT-FORM-TYPE                PIC X.
  6493             88  INITIAL-FORM                  VALUE '1'.
  6494             88  PROGRESS-FORM                 VALUE '2'.
  6495         16  AT-INSTRUCT-LN-1            PIC X(28).
  6496         16  AT-INSTRUCT-LN-2            PIC X(28).
  6497         16  AT-INSTRUCT-LN-3            PIC X(28).
  6498         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6499         16  AT-FORM-ADDRESS             PIC X.
  6500             88  FORM-TO-INSURED              VALUE 'I'.
  6501             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6502             88  FORM-TO-OTHER-1              VALUE 'O'.
  6503             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6504         16  AT-RELATED-1.
  6505             20 AT-REL-CARR-1            PIC X.
  6506             20 AT-REL-CLAIM-1           PIC X(7).
  6507             20 AT-REL-CERT-1            PIC X(11).
  6508         16  AT-RELATED-2.
  6509             20 AT-REL-CARR-2            PIC X.
  6510             20 AT-REL-CLAIM-2           PIC X(7).
  6511             20 AT-REL-CERT-2            PIC X(11).
  6512         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6513         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6514         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6515         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6516         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6517         16  AT-STOP-FORM-DT             PIC X(2).
  6518
  6519         16  FILLER                      PIC X(09).
  6520         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6521         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 124
* EL156.cbl
  6522******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 125
* EL156.cbl
  6524*    COPY ELCACTQ.
  6525******************************************************************
  6526*                                                                *
  6527*                            ELCACTQ.                            *
  6528*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6529*                            VMOD=2.004                          *
  6530*                                                                *
  6531*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6532*                                                                *
  6533*   FILE TYPE = VSAM,KSDS                                        *
  6534*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6535*                                                                *
  6536*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6537*       ALTERNATE INDEX = NONE                                   *
  6538*                                                                *
  6539*   LOG = YES                                                    *
  6540*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6541*                                                                *
  6542*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6543******************************************************************
  6544
  6545 01  ACTIVITY-QUE.
  6546     12  AQ-RECORD-ID                PIC XX.
  6547         88  VALID-AQ-ID                VALUE 'AQ'.
  6548
  6549     12  AQ-CONTROL-PRIMARY.
  6550         16  AQ-COMPANY-CD           PIC X.
  6551         16  AQ-CARRIER              PIC X.
  6552         16  AQ-CLAIM-NO             PIC X(7).
  6553         16  AQ-CERT-NO.
  6554             20  AQ-CERT-PRIME       PIC X(10).
  6555             20  AQ-CERT-SFX         PIC X.
  6556
  6557     12  AQ-PENDING-ACTIVITY-FLAGS.
  6558         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6559         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6560             88  PENDING-PAYMENTS       VALUE '1'.
  6561         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6562             88  PENDING-FULL-PRINT     VALUE '1'.
  6563             88  PENDING-PART-PRINT     VALUE '2'.
  6564         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6565             88  PENDING-LETTERS        VALUE '1'.
  6566         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6567             88  PENDING-RESTORE        VALUE 'C'.
  6568             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6569
  6570     12  FILLER                      PIC X(20).
  6571
  6572     12  AQ-RESEND-DATE              PIC XX.
  6573     12  AQ-FOLLOWUP-DATE            PIC XX.
  6574     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6575     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6576     12  AQ-AUTO-LETTER              PIC X(4).
  6577     12  FILLER                      PIC XX.
  6578     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6579*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 126
* EL156.cbl
  6581*    COPY ERCACCT.
  6582******************************************************************
  6583*                                                                *
  6584*                                                                *
  6585*                            ERCACCT                             *
  6586*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6587*                            VMOD=2.031                          *
  6588*                                                                *
  6589*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6590*                                                                *
  6591*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6592*   VSAM ACCOUNT MASTER FILES.                                   *
  6593*                                                                *
  6594*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6595*                                                                *
  6596*   FILE TYPE = VSAM,KSDS                                        *
  6597*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6598*                                                                *
  6599*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6600*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6601*                                                                *
  6602*   LOG = NO                                                     *
  6603*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6604*                                                                *
  6605*                                                                *
  6606******************************************************************
  6607*                   C H A N G E   L O G
  6608*
  6609* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6610*-----------------------------------------------------------------
  6611*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6612* EFFECTIVE    NUMBER
  6613*-----------------------------------------------------------------
  6614* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6615* 092705    2005050300006  PEMA  ADD SPP LEASES
  6616* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6617* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6618* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6619* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6620* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6621* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6622******************************************************************
  6623
  6624 01  ACCOUNT-MASTER.
  6625     12  AM-RECORD-ID                      PIC XX.
  6626         88  VALID-AM-ID                      VALUE 'AM'.
  6627
  6628     12  AM-CONTROL-PRIMARY.
  6629         16  AM-COMPANY-CD                 PIC X.
  6630         16  AM-MSTR-CNTRL.
  6631             20  AM-CONTROL-A.
  6632                 24  AM-CARRIER            PIC X.
  6633                 24  AM-GROUPING.
  6634                     28 AM-GROUPING-PREFIX PIC XXX.
  6635                     28 AM-GROUPING-PRIME  PIC XXX.
  6636                 24  AM-STATE              PIC XX.
  6637                 24  AM-ACCOUNT.
  6638                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 127
* EL156.cbl
  6639                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6640             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6641                                           PIC X(19).
  6642             20  AM-CNTRL-B.
  6643                 24  AM-EXPIRATION-DT      PIC XX.
  6644                 24  FILLER                PIC X(4).
  6645             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6646                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6647
  6648     12  AM-CONTROL-BY-VAR-GRP.
  6649         16  AM-COMPANY-CD-A1              PIC X.
  6650         16  AM-VG-CARRIER                 PIC X.
  6651         16  AM-VG-GROUPING                PIC X(6).
  6652         16  AM-VG-STATE                   PIC XX.
  6653         16  AM-VG-ACCOUNT                 PIC X(10).
  6654         16  AM-VG-DATE.
  6655             20  AM-VG-EXPIRATION-DT       PIC XX.
  6656             20  FILLER                    PIC X(4).
  6657         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6658                                           PIC 9(11)      COMP-3.
  6659     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6660         16  FILLER                        PIC X(10).
  6661         16  AM-VG-KEY3.
  6662             20  AM-VG3-ACCOUNT            PIC X(10).
  6663             20  AM-VG3-EXP-DT             PIC XX.
  6664         16  FILLER                        PIC X(4).
  6665     12  AM-MAINT-INFORMATION.
  6666         16  AM-LAST-MAINT-DT              PIC XX.
  6667         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6668         16  AM-LAST-MAINT-USER            PIC X(4).
  6669         16  FILLER                        PIC XX.
  6670
  6671     12  AM-EFFECTIVE-DT                   PIC XX.
  6672     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6673
  6674     12  AM-PREV-DATES  COMP-3.
  6675         16  AM-PREV-EXP-DT                PIC 9(11).
  6676         16  AM-PREV-EFF-DT                PIC 9(11).
  6677
  6678     12  AM-REPORT-CODE-1                  PIC X(10).
  6679     12  AM-REPORT-CODE-2                  PIC X(10).
  6680
  6681     12  AM-CITY-CODE                      PIC X(4).
  6682     12  AM-COUNTY-PARISH                  PIC X(6).
  6683
  6684     12  AM-NAME                           PIC X(30).
  6685     12  AM-PERSON                         PIC X(30).
  6686     12  AM-ADDRS                          PIC X(30).
  6687     12  AM-CITY.
  6688         16  AM-ADDR-CITY                  PIC X(28).
  6689         16  AM-ADDR-STATE                 PIC XX.
  6690     12  AM-ZIP.
  6691         16  AM-ZIP-PRIME.
  6692             20  AM-ZIP-PRI-1ST            PIC X.
  6693                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6694             20  FILLER                    PIC X(4).
  6695         16  AM-ZIP-PLUS4                  PIC X(4).
  6696     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 128
* EL156.cbl
  6697         16  AM-CAN-POSTAL-1               PIC XXX.
  6698         16  AM-CAN-POSTAL-2               PIC XXX.
  6699         16  FILLER                        PIC XXX.
  6700     12  AM-TEL-NO.
  6701         16  AM-AREA-CODE                  PIC 999.
  6702         16  AM-TEL-PRE                    PIC 999.
  6703         16  AM-TEL-NBR                    PIC 9(4).
  6704     12  AM-TEL-LOC                        PIC X.
  6705         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6706         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6707
  6708     12  AM-COMM-STRUCTURE.
  6709         16  AM-DEFN-1.
  6710             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6711                 24  AM-AGT.
  6712                     28  AM-AGT-PREFIX     PIC X(4).
  6713                     28  AM-AGT-PRIME      PIC X(6).
  6714                 24  AM-COM-TYP            PIC X.
  6715                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6716                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6717                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6718                 24  AM-RECALC-LV-INDIC    PIC X.
  6719                 24  AM-RETRO-LV-INDIC     PIC X.
  6720                 24  AM-GL-CODES           PIC X.
  6721                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6722                 24  FILLER                PIC X(01).
  6723         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6724             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6725                 24  FILLER                PIC X(11).
  6726                 24  AM-L-COMA             PIC XXX.
  6727                 24  AM-J-COMA             PIC XXX.
  6728                 24  AM-A-COMA             PIC XXX.
  6729                 24  FILLER                PIC X(6).
  6730
  6731     12  AM-COMM-CHANGE-STATUS             PIC X.
  6732         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6733
  6734     12  AM-CSR-CODE                       PIC X(4).
  6735
  6736     12  AM-BILLING-STATUS                 PIC X.
  6737         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6738         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6739     12  AM-AUTO-REFUND-SW                 PIC X.
  6740         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6741         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6742     12  AM-GPCD                           PIC 99.
  6743     12  AM-IG                             PIC X.
  6744         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6745         88  AM-HAS-GROUP                     VALUE '2'.
  6746     12  AM-STATUS                         PIC X.
  6747         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6748         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6749         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6750         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6751         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6752         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6753         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6754         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 129
* EL156.cbl
  6755         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6756         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6757     12  AM-REMIT-TO                       PIC 99.
  6758     12  AM-ID-NO                          PIC X(11).
  6759
  6760     12  AM-CAL-TABLE                      PIC XX.
  6761     12  AM-LF-DEVIATION                   PIC XXX.
  6762     12  AM-AH-DEVIATION                   PIC XXX.
  6763     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6764     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6765     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6766     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6767     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6768     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6769
  6770     12  AM-USER-FIELDS.
  6771         16  AM-FLD-1                      PIC XX.
  6772         16  AM-FLD-2                      PIC XX.
  6773         16  AM-FLD-3                      PIC XX.
  6774         16  AM-FLD-4                      PIC XX.
  6775         16  AM-FLD-5                      PIC XX.
  6776
  6777     12  AM-1ST-PROD-DATE.
  6778         16  AM-1ST-PROD-YR                PIC XX.
  6779         16  AM-1ST-PROD-MO                PIC XX.
  6780         16  AM-1ST-PROD-DA                PIC XX.
  6781     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6782     12  AM-CERTS-PURGED-DATE.
  6783         16  AM-PUR-YR                     PIC XX.
  6784         16  AM-PUR-MO                     PIC XX.
  6785         16  AM-PUR-DA                     PIC XX.
  6786     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6787     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6788     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6789     12  AM-INACTIVE-DATE.
  6790         16  AM-INA-MO                     PIC 99.
  6791         16  AM-INA-DA                     PIC 99.
  6792         16  AM-INA-YR                     PIC 99.
  6793     12  AM-AR-HI-CERT-DATE                PIC XX.
  6794
  6795     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6796     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6797
  6798     12  AM-OB-PAYMENT-MODE                PIC X.
  6799         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6800         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6801         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6802         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6803
  6804     12  AM-AH-ONLY-INDICATOR              PIC X.
  6805         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6806         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6807
  6808     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6809
  6810     12  AM-OVER-SHORT.
  6811         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6812         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 130
* EL156.cbl
  6813
  6814     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6815     12  AM-DCC-CLP-STATE                  PIC XX.
  6816
  6817     12  AM-RECALC-COMM                    PIC X.
  6818     12  AM-RECALC-REIN                    PIC X.
  6819
  6820     12  AM-REI-TABLE                      PIC XXX.
  6821     12  AM-REI-ET-LF                      PIC X.
  6822     12  AM-REI-ET-AH                      PIC X.
  6823     12  AM-REI-PE-LF                      PIC X.
  6824     12  AM-REI-PE-AH                      PIC X.
  6825     12  AM-REI-PRT-ST                     PIC X.
  6826     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6827     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6828     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6829     12  AM-REI-GROUP-A                    PIC X(6).
  6830     12  AM-REI-MORT                       PIC X(4).
  6831     12  AM-REI-PRT-OW                     PIC X.
  6832     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6833     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6834     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6835     12  AM-REI-GROUP-B                    PIC X(6).
  6836
  6837     12  AM-TRUST-TYPE                     PIC X(2).
  6838
  6839     12  AM-EMPLOYER-STMT-USED             PIC X.
  6840     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6841
  6842     12  AM-STD-AH-TYPE                    PIC XX.
  6843     12  AM-EARN-METHODS.
  6844         16  AM-EARN-METHOD-R              PIC X.
  6845             88 AM-REF-RL-R78                 VALUE 'R'.
  6846             88 AM-REF-RL-PR                  VALUE 'P'.
  6847             88 AM-REF-RL-MEAN                VALUE 'M'.
  6848             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6849         16  AM-EARN-METHOD-L              PIC X.
  6850             88 AM-REF-LL-R78                 VALUE 'R'.
  6851             88 AM-REF-LL-PR                  VALUE 'P'.
  6852             88 AM-REF-LL-MEAN                VALUE 'M'.
  6853             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6854         16  AM-EARN-METHOD-A              PIC X.
  6855             88 AM-REF-AH-R78                 VALUE 'R'.
  6856             88 AM-REF-AH-PR                  VALUE 'P'.
  6857             88 AM-REF-AH-MEAN                VALUE 'M'.
  6858             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6859             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6860             88 AM-REF-AH-NET                 VALUE 'N'.
  6861
  6862     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6863     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6864     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6865
  6866     12  AM-RET-Y-N                        PIC X.
  6867     12  AM-RET-P-E                        PIC X.
  6868     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6869     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6870     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 131
* EL156.cbl
  6871     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6872         16  AM-POOL-PRIME                 PIC XXX.
  6873         16  AM-POOL-SUB                   PIC XXX.
  6874     12  AM-RETRO-EARNINGS.
  6875         16  AM-RET-EARN-R                 PIC X.
  6876         16  AM-RET-EARN-L                 PIC X.
  6877         16  AM-RET-EARN-A                 PIC X.
  6878     12  AM-RET-ST-TAX-USE                 PIC X.
  6879         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6880         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6881     12  AM-RETRO-BEG-EARNINGS.
  6882         16  AM-RET-BEG-EARN-R             PIC X.
  6883         16  AM-RET-BEG-EARN-L             PIC X.
  6884         16  AM-RET-BEG-EARN-A             PIC X.
  6885     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6886     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6887
  6888     12  AM-USER-SELECT-OPTIONS.
  6889         16  AM-USER-SELECT-1              PIC X(10).
  6890         16  AM-USER-SELECT-2              PIC X(10).
  6891         16  AM-USER-SELECT-3              PIC X(10).
  6892         16  AM-USER-SELECT-4              PIC X(10).
  6893         16  AM-USER-SELECT-5              PIC X(10).
  6894
  6895     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6896
  6897     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6898
  6899     12  AM-RPT045A-SWITCH                 PIC X.
  6900         88  RPT045A-OFF                   VALUE 'N'.
  6901
  6902     12  AM-INSURANCE-LIMITS.
  6903         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6904         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6905
  6906     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6907         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6908
  6909     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6910         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6911         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6912
  6913     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6914
  6915     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6916     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6917     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6918     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6919     12  AM-DCC-UEF-STATE                  PIC XX.
  6920     12  FILLER                            PIC XXX.
  6921     12  AM-REPORT-CODE-3                  PIC X(10).
  6922*    12  FILLER                            PIC X(22).
  6923
  6924     12  AM-RESERVE-DATE.
  6925         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6926         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6927         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6928
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 132
* EL156.cbl
  6929     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6930     12  AM-NOTIFICATION-TYPES.
  6931         16  AM-NOTIF-OF-LETTERS           PIC X.
  6932         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6933         16  AM-NOTIF-OF-REPORTS           PIC X.
  6934         16  AM-NOTIF-OF-STATUS            PIC X.
  6935
  6936     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6937         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6938         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6939         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6940         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6941
  6942     12  AM-BENEFIT-CONTROLS.
  6943         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6944             20  AM-BENEFIT-CODE           PIC XX.
  6945             20  AM-BENEFIT-TYPE           PIC X.
  6946             20  AM-BENEFIT-REVISION       PIC XXX.
  6947             20  AM-BENEFIT-REM-TERM       PIC X.
  6948             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6949             20  FILLER                    PIC XX.
  6950         16  FILLER                        PIC X(80).
  6951
  6952     12  AM-TRANSFER-DATA.
  6953         16  AM-TRANSFERRED-FROM.
  6954             20  AM-TRNFROM-CARRIER        PIC X.
  6955             20  AM-TRNFROM-GROUPING.
  6956                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6957                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6958             20  AM-TRNFROM-STATE          PIC XX.
  6959             20  AM-TRNFROM-ACCOUNT.
  6960                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6961                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6962             20  AM-TRNFROM-DTE            PIC XX.
  6963         16  AM-TRANSFERRED-TO.
  6964             20  AM-TRNTO-CARRIER          PIC X.
  6965             20  AM-TRNTO-GROUPING.
  6966                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6967                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6968             20  AM-TRNTO-STATE            PIC XX.
  6969             20  AM-TRNTO-ACCOUNT.
  6970                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6971                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6972             20  AM-TRNTO-DTE              PIC XX.
  6973         16  FILLER                        PIC X(10).
  6974
  6975     12  AM-SAVED-REMIT-TO                 PIC 99.
  6976
  6977     12  AM-COMM-STRUCTURE-SAVED.
  6978         16  AM-DEFN-1-SAVED.
  6979             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6980                 24  AM-AGT-SV             PIC X(10).
  6981                 24  AM-COM-TYP-SV         PIC X.
  6982                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6983                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6984                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6985                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6986                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 133
* EL156.cbl
  6987                 24  AM-GL-CODES-SV        PIC X.
  6988                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6989                 24  FILLER                PIC X.
  6990         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6991             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6992                 24  FILLER                PIC X(11).
  6993                 24  AM-L-COMA-SV          PIC XXX.
  6994                 24  AM-J-COMA-SV          PIC XXX.
  6995                 24  AM-A-COMA-SV          PIC XXX.
  6996                 24  FILLER                PIC X(6).
  6997
  6998     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6999         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7000            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7001            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7002            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7003
  7004     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7005     12  FILLER                            PIC X(120).
  7006
  7007     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7008         16  AM-CONTROL-NAME               PIC X(30).
  7009         16  AM-EXECUTIVE-ONE.
  7010             20  AM-EXEC1-NAME             PIC X(15).
  7011             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7012                                                          COMP-3.
  7013             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7014                                                          COMP-3.
  7015         16  AM-EXECUTIVE-TWO.
  7016             20  AM-EXEC2-NAME             PIC X(15).
  7017             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7018                                                          COMP-3.
  7019             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7020                                                          COMP-3.
  7021
  7022     12  AM-RETRO-ADDITIONAL-DATA.
  7023         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7024         16  AM-RETRO-PREM-P-E             PIC X.
  7025         16  AM-RETRO-CLMS-P-I             PIC X.
  7026         16  AM-RETRO-RET-BRACKET-LF.
  7027             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7028                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7029                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7030             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7031                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7032                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7033             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7034                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7035                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7036         16  AM-RETRO-RET-BRACKET-AH.
  7037             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7038                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7039                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7040                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7041             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7042                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7043                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7044             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 134
* EL156.cbl
  7045                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7046                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7047
  7048     12  AM-COMMENTS.
  7049         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7050
  7051     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7052         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7053         16  AM-FLI-BILLING-CODE           PIC X.
  7054         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7055         16  AM-FLI-UNITED-IDENT           PIC X.
  7056         16  AM-FLI-INTEREST-LOST-DATA.
  7057             20  AM-FLI-BANK-NO            PIC X(5).
  7058             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7059             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7060             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7061         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7062             20  AM-FLI-AGT                PIC X(9).
  7063             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7064             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7065         16  FILLER                        PIC X(102).
  7066
  7067     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7068         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7069             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7070             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7071             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7072             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7073             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7074         16  FILLER                          PIC X(10).
  7075******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 135
* EL156.cbl
  7077*    COPY ELCCHKQ.
  7078******************************************************************
  7079*                                                                *
  7080*                                                                *
  7081*                            ELCCHKQ.                            *
  7082*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7083*                            VMOD=2.007                          *
  7084*                                                                *
  7085*   FILE DESCRIPTION = CHECK QUE FILE                            *
  7086*                                                                *
  7087*   FILE TYPE = VSAM,KSDS                                        *
  7088*   RECORD SIZE = 100  RECFORM = FIXED                           *
  7089*                                                                *
  7090*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  7091*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  7092*                                                                *
  7093*   LOG = YES                                                    *
  7094*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7095******************************************************************
  7096 01  CHECK-QUE.
  7097     12  CQ-RECORD-ID                PIC XX.
  7098         88  VALID-CQ-ID         VALUE 'CQ'.
  7099
  7100     12  CQ-CONTROL-PRIMARY.
  7101         16  CQ-COMPANY-CD           PIC X.
  7102         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  7103         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  7104
  7105     12  CQ-CONTROL-BY-PAYEE.
  7106         16  CQ-CONTROL-BY-NUMBER.
  7107             20  CQ-COMPANY-CD-A1     PIC X.
  7108             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7109         16  CQ-PAYEE-CARRIER        PIC X.
  7110         16  CQ-PAYEE-GROUPING       PIC X(6).
  7111         16  CQ-PAYEE-STATE          PIC XX.
  7112         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7113         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7114
  7115     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7116         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7117         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7118         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7119         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7120         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7121         16  FILLER                  PIC X(3).
  7122
  7123     12  CQ-ENTRY-TYPE               PIC X.
  7124             88  CHECK-ON-QUE           VALUE 'Q'.
  7125             88  ALIGNMENT-CHECK        VALUE 'A'.
  7126             88  SPOILED-CHECK          VALUE 'S'.
  7127             88  PAYMENT-ABORTED        VALUE 'X'.
  7128
  7129     12  CQ-CLAIM-MAST-CNTL.
  7130         16  CQ-CARRIER              PIC X.
  7131         16  CQ-CLAIM-NO             PIC X(7).
  7132         16  CQ-CERT-NO.
  7133             20  CQ-CERT-PRIME       PIC X(10).
  7134             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 136
* EL156.cbl
  7135         16  CQ-CLAIM-TYPE           PIC X.
  7136             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7137             88  CQ-AH-CLAIM            VALUE 'A'.
  7138         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7139             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7140             88  CQ-O-B-COVERAGE        VALUE '2'.
  7141             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7142
  7143     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7144     12  CQ-CHECK-NUMBER             PIC X(7).
  7145     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7146     12  CQ-PAYMENT-TYPE             PIC X.
  7147             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7148             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7149             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7150             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7151             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7152             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7153             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7154             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7155     12  CQ-VOID-INDICATOR           PIC X.
  7156             88  CHECK-IS-STOPPED          VALUE 'S'.
  7157             88  CHECK-IS-VOID             VALUE 'V'.
  7158     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7159     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7160     12  CQ-CHECK-BY-USER            PIC X(4).
  7161     12  CQ-PRE-NUMBERING-SW         PIC X.
  7162       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7163       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7164
  7165     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7166     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7167     12  CQ-LEDGER-FLAG              PIC X(01).
  7168     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7169     12  CQ-LAST-UPDATED-DT          PIC XX.
  7170     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7171     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7172
  7173     12  FILLER                      PIC X(04).
  7174
  7175******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 137
* EL156.cbl
  7177*    COPY ELCBENE.
  7178******************************************************************
  7179*                                                                *
  7180*                            ELCBENE.                            *
  7181*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7182*                            VMOD=2.006                          *
  7183*                                                                *
  7184*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7185*                                                                *
  7186*   FILE TYPE = VSAM,KSDS                                        *
  7187*   RECORD SIZE = 500   RECFORM = FIX                            *
  7188*                                                                *
  7189*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7190*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7191*                                                                *
  7192*   LOG = YES                                                    *
  7193*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7194*                                                                *
  7195*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7196******************************************************************
  7197*                   C H A N G E   L O G
  7198*
  7199* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7200*-----------------------------------------------------------------
  7201*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7202* EFFECTIVE    NUMBER
  7203*-----------------------------------------------------------------
  7204* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7205* 082317  CR2017082100003  PEMA  Add sub type
  7206******************************************************************
  7207
  7208 01  BENEFICIARY-MASTER.
  7209     12  BE-RECORD-ID                PIC XX.
  7210         88  VALID-BE-ID                VALUE 'BE'.
  7211
  7212     12  BE-CONTROL-PRIMARY.
  7213         16  BE-COMPANY-CD           PIC X.
  7214         16  BE-RECORD-TYPE          PIC X.
  7215             88  BENEFICIARY-RECORD  VALUE 'B'.
  7216             88  ADJUSTOR-RECORD     VALUE 'A'.
  7217         16  BE-BENEFICIARY          PIC X(10).
  7218     12  BE-CONTROL-BY-NAME.
  7219         16  BE-COMPANY-CD-A1        PIC X.
  7220         16  BE-RECORD-TYPE-A1       PIC X.
  7221         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7222         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7223
  7224     12  BE-LAST-MAINT-DT            PIC XX.
  7225     12  BE-LAST-MAINT-BY            PIC X(4).
  7226     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7227
  7228     12  BE-ADDRESS-DATA.
  7229         16  BE-MAIL-TO-NAME         PIC X(30).
  7230         16  BE-ADDRESS-LINE-1       PIC X(30).
  7231         16  BE-ADDRESS-LINE-2       PIC X(30).
  7232         16  BE-ADDRESS-LINE-3       PIC X(30).
  7233         16  BE-CITY-STATE.
  7234             20  BE-CITY             PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 138
* EL156.cbl
  7235             20  BE-STATE            PIC XX.
  7236         16  BE-ZIP-CODE.
  7237             20  BE-ZIP-PRIME.
  7238                 24  BE-ZIP-1ST      PIC X.
  7239                     88  BE-CANADIAN-POST-CODE
  7240                                         VALUE 'A' THRU 'Z'.
  7241                 24  FILLER          PIC X(4).
  7242             20  BE-ZIP-PLUS4        PIC X(4).
  7243         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7244             20  BE-CAN-POSTAL-1     PIC XXX.
  7245             20  BE-CAN-POSTAL-2     PIC XXX.
  7246             20  FILLER              PIC XXX.
  7247         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7248         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7249
  7250******************************************************************
  7251*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7252*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7253******************************************************************
  7254     12  BE-CARRIER                  PIC X.
  7255
  7256     12  BE-ADDRESS-DATA2.
  7257         16  BE-MAIL-TO-NAME2        PIC X(30).
  7258         16  BE-ADDRESS-LINE-12      PIC X(30).
  7259         16  BE-ADDRESS-LINE-22      PIC X(30).
  7260         16  BE-ADDRESS-LINE-32      PIC X(30).
  7261         16  BE-CITY-STATE2.
  7262             20  BE-CITY2            PIC X(28).
  7263             20  BE-STATE2           PIC XX.
  7264         16  BE-ZIP-CODE2.
  7265             20  BE-ZIP-PRIME2.
  7266                 24  BE-ZIP-1ST2     PIC X.
  7267                     88  BE-CANADIAN-POST-CODE2
  7268                                         VALUE 'A' THRU 'Z'.
  7269                 24  FILLER          PIC X(4).
  7270             20  BE-ZIP-PLUS42       PIC X(4).
  7271         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7272             20  BE-CAN-POSTAL-12    PIC XXX.
  7273             20  BE-CAN-POSTAL-22    PIC XXX.
  7274             20  FILLER              PIC XXX.
  7275         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7276         16  BE-ACH-DATA.
  7277             20  BE-ACH-YES-OR-NO    PIC X.
  7278                 88  BE-ON-ACH       VALUE 'Y'.
  7279                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7280             20  BE-ACH-ABA-ROUTING-NUMBER
  7281                                     PIC X(15).
  7282             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7283                                     PIC X(20).
  7284             20  BE-ACH-SUB-TYPE     PIC XX.
  7285             20  FILLER              PIC X(23).
  7286         16  BE-BILLING-STMT-DATA.
  7287*            20  BE-BSR              PIC X.
  7288*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7289*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7290*            20  BE-BSR-FROM         PIC X(30).
  7291*            20  BE-BSR-DEPT         PIC X(30).
  7292             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 139
* EL156.cbl
  7293             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7294             20  BE-OUTPUT-TYPE      PIC X.
  7295                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7296                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7297
  7298     12  FILLER                      PIC X(28).
  7299******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 140
* EL156.cbl
  7301*    COPY ELCARCH.
  7302******************************************************************
  7303*                                                                *
  7304*                            ELCARCH.                            *
  7305*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7306*                            VMOD=2.007                          *
  7307*                                                                *
  7308*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7309*                                                                *
  7310*   FILE TYPE = VSAM,KSDS                                        *
  7311*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7312*                                                                *
  7313*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7314*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7315*                                                                *
  7316*   LOG = NO                                                     *
  7317*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7318*                                                                *
  7319*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7320******************************************************************
  7321 01  LETTER-ARCHIVE.
  7322     12  LA-RECORD-ID                PIC XX.
  7323         88  VALID-LA-ID                VALUE 'LA'.
  7324
  7325     12  LA-CONTROL-PRIMARY.
  7326         16  LA-COMPANY-CD           PIC X.
  7327         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7328         16  LA-RECORD-TYPE          PIC X.
  7329             88  LA-HEADER-DATA         VALUE '1'.
  7330             88  LA-ADDRESS-DATA        VALUE '2'.
  7331             88  LA-TEXT-DATA           VALUE '3'.
  7332             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7333         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7334
  7335     12  LA-CONTROL-BY-TYPE.
  7336         16  LA-COMPANY-CD-A1        PIC X.
  7337         16  LA-RECORD-TYPE-A1       PIC X.
  7338         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7339         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7340
  7341     12  LA-TEXT-RECORD.
  7342         16  LA-SKIP-CONTROL         PIC XX.
  7343             88  NO-LINES-SKIPPED       VALUE SPACES.
  7344             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7345         16  LA-TEXT-LINE            PIC X(70).
  7346
  7347     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7348         16  FILLER                  PIC XX.
  7349         16  LA-ADDRESS-LINE         PIC X(30).
  7350         16  FILLER                  PIC X(40).
  7351
  7352     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7353         16  FILLER                  PIC XX.
  7354         16  LA-CARRIER              PIC X.
  7355         16  LA-CLAIM-NO             PIC X(7).
  7356         16  LA-CERT-NO.
  7357             20  LA-CERT-PRIME       PIC X(10).
  7358             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 141
* EL156.cbl
  7359         16  LA-NO-OF-COPIES         PIC S9.
  7360         16  LA-RESEND-DATE          PIC XX.
  7361         16  LA-PROCESSOR-CD         PIC X(4).
  7362         16  LA-CREATION-DT          PIC XX.
  7363         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7364         16  LA-RESEND-PRINT-DATE    PIC XX.
  7365         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7366         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7367*
  7368* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7369*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7370*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7371*   I        20  LA-DMD-RES-ST           PIC XX.
  7372*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7373*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7374*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7375*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7376*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7377*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7378*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7379*   I        20  LA-DMD-UND-CODE         PIC XX.
  7380*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7381*   V    16  FILLER                  PIC X(15).
  7382* -----
  7383*
  7384* REINSERTED  CSO  MODS
  7385*
  7386         16  FILLER.
  7387             20  FILLER                  PIC X(29).
  7388             20  LA-CSO-LETTER-STATUS    PIC X.
  7389                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7390                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7391                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7392             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7393             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7394*
  7395
  7396     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7397         16  FILLER                  PIC XX.
  7398         16  LA4-CARRIER             PIC X.
  7399         16  LA4-CLAIM-NO            PIC X(7).
  7400         16  LA4-CERT-NO.
  7401             20  LA4-CERT-PRIME      PIC X(10).
  7402             20  LA4-CERT-SFX        PIC X.
  7403         16  LA4-NO-OF-COPIES        PIC S9.
  7404         16  LA4-RESEND-DATE         PIC XX.
  7405         16  LA4-PROCESSOR-CD        PIC X(4).
  7406         16  LA4-CREATION-DT         PIC XX.
  7407         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7408         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7409         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7410         16  LA4-FORM-TYPE           PIC X.
  7411             88  LA4-INITIAL-FORM    VALUE '1'.
  7412             88  LA4-PROGRESS-FORM   VALUE '2'.
  7413         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7414         16  LA4-STATE               PIC X(02).
  7415         16  FILLER                  PIC X(31).
  7416******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 142
* EL156.cbl
  7418*    COPY ELCDAR.
  7419******************************************************************
  7420*                                                                *
  7421*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7422*   FILE TYPE = VSAM,KSDS                                        *
  7423*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7424*   BASE CLUSTER = DLYACTV                                       *
  7425*   LOG = YES                                                    *
  7426*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7427*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7428*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7429*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7430*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7431*               BY PROGRAM "LGINFCE".                            *
  7432*                                                                *
  7433******************************************************************
  7434 01  DAILY-ACTIVITY-RECORD.
  7435     05  DA-KEY.
  7436         10  DA-COMP-CD          PIC X.
  7437         10  DA-CARRIER          PIC X.
  7438         10  DA-CLAIM-NO         PIC X(7).
  7439         10  DA-CERT-NO.
  7440             15  DA-CERT-PRIME   PIC X(10).
  7441             15  DA-CERT-SFX     PIC X.
  7442     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7443     05  DA-RECORD-TYPE          PIC X.
  7444     05  FILLER                  PIC X(2).
  7445******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 143
* EL156.cbl
  7447*    COPY ERCCOMP.
  7448******************************************************************
  7449*                                                                *
  7450*                                                                *
  7451*                            ERCCOMP                             *
  7452*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7453*                            VMOD=2.019                          *
  7454*                                                                *
  7455*   ONLINE CREDIT SYSTEM                                         *
  7456*                                                                *
  7457*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7458*                                                                *
  7459*   FILE TYPE = VSAM,KSDS                                        *
  7460*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7461*                                                                *
  7462*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7463*       ALTERNATE PATH = NONE                                    *
  7464*                                                                *
  7465*   LOG = NO                                                     *
  7466*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7467*                                                                *
  7468******************************************************************
  7469*                   C H A N G E   L O G
  7470*
  7471* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7472*-----------------------------------------------------------------
  7473*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7474* EFFECTIVE    NUMBER
  7475*-----------------------------------------------------------------
  7476* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7477* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7478* 092205    2005050300006  PEMA  ADD LEASE FEE
  7479* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7480* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7481* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7482* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7483* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7484* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7485******************************************************************
  7486
  7487 01  COMPENSATION-MASTER.
  7488     12  CO-RECORD-ID                          PIC XX.
  7489         88  VALID-CO-ID                          VALUE 'CO'.
  7490
  7491     12  CO-CONTROL-PRIMARY.
  7492         16  CO-COMPANY-CD                     PIC X.
  7493         16  CO-CONTROL.
  7494             20  CO-CTL-1.
  7495                 24  CO-CARR-GROUP.
  7496                     28  CO-CARRIER            PIC X.
  7497                     28  CO-GROUPING.
  7498                         32  CO-GROUP-PREFIX   PIC XXX.
  7499                         32  CO-GROUP-PRIME    PIC XXX.
  7500                 24  CO-RESP-NO.
  7501                     28  CO-RESP-PREFIX        PIC X(4).
  7502                     28  CO-RESP-PRIME         PIC X(6).
  7503             20  CO-CTL-2.
  7504                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 144
* EL156.cbl
  7505                     28  CO-ACCT-PREFIX        PIC X(4).
  7506                     28  CO-ACCT-PRIME         PIC X(6).
  7507         16  CO-TYPE                           PIC X.
  7508             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7509             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7510             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7511
  7512     12  CO-MAINT-INFORMATION.
  7513         16  CO-LAST-MAINT-DT                  PIC XX.
  7514         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7515         16  CO-LAST-MAINT-USER                PIC X(4).
  7516     12  FILLER                                PIC XX.
  7517     12  CO-STMT-TYPE                          PIC XXX.
  7518     12  CO-COMP-TYPE                          PIC X.
  7519         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7520     12  CO-STMT-OWNER                         PIC X(4).
  7521     12  CO-BALANCE-CONTROL                    PIC X.
  7522         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7523         88  CO-NO-BALANCE                        VALUE 'N'.
  7524
  7525     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7526         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7527         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7528         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7529
  7530     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7531         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7532         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7533
  7534     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7535     12  CO-GA-DIRECT-DEP                      PIC X.
  7536     12  CO-FUTURE-SPACE                       PIC X.
  7537         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7538
  7539     12  CO-ACCT-NAME                          PIC X(30).
  7540     12  CO-MAIL-NAME                          PIC X(30).
  7541     12  CO-ADDR-1                             PIC X(30).
  7542     12  CO-ADDR-2                             PIC X(30).
  7543     12  CO-ADDR-3.
  7544         16  CO-ADDR-CITY                      PIC X(27).
  7545         16  CO-ADDR-STATE                     PIC XX.
  7546     12  CO-CSO-1099                           PIC X.
  7547     12  CO-ZIP.
  7548         16  CO-ZIP-PRIME.
  7549             20  CO-ZIP-PRI-1ST                PIC X.
  7550                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7551             20  FILLER                        PIC X(4).
  7552         16  CO-ZIP-PLUS4                      PIC X(4).
  7553     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7554         16  CO-CAN-POSTAL-1                   PIC XXX.
  7555         16  CO-CAN-POSTAL-2                   PIC XXX.
  7556         16  FILLER                            PIC XXX.
  7557     12  CO-SOC-SEC                            PIC X(13).
  7558     12  CO-TELEPHONE.
  7559         16  CO-AREA-CODE                      PIC XXX.
  7560         16  CO-PREFIX                         PIC XXX.
  7561         16  CO-PHONE                          PIC X(4).
  7562
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 145
* EL156.cbl
  7563     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7564
  7565     12  CO-AR-BAL-LEVEL                       PIC X.
  7566         88  CO-AR-REF-LVL                        VALUE '1'.
  7567         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7568         88  CO-AR-BILL-LVL                       VALUE '2'.
  7569         88  CO-AR-AGT-LVL                        VALUE '3'.
  7570         88  CO-AR-FR-LVL                         VALUE '4'.
  7571
  7572     12  CO-AR-NORMAL-PRINT                    PIC X.
  7573         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7574         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7575
  7576     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7577
  7578     12  CO-AR-REPORTING                       PIC X.
  7579         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7580         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7581
  7582     12  CO-AR-PULL-CHECK                      PIC X.
  7583         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7584         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7585
  7586     12  CO-AR-BALANCE-PRINT                   PIC X.
  7587         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7588
  7589     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7590         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7591         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7592         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7593
  7594     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7595
  7596     12  CO-USER-CODE                          PIC X.
  7597     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7598
  7599******************************************************************
  7600*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7601*    THE LAST MONTH END RUN.
  7602******************************************************************
  7603
  7604     12  CO-LAST-ACTIVITY-DATE.
  7605         16  CO-ACT-YEAR                       PIC 99.
  7606         16  CO-ACT-MONTH                      PIC 99.
  7607         16  CO-ACT-DAY                        PIC 99.
  7608
  7609     12  CO-LAST-STMT-DT.
  7610         16  CO-LAST-STMT-YEAR                 PIC 99.
  7611         16  CO-LAST-STMT-MONTH                PIC 99.
  7612         16  CO-LAST-STMT-DAY                  PIC 99.
  7613
  7614     12  CO-MO-END-TOTALS.
  7615         16  CO-MONTHLY-TOTALS.
  7616             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7617             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7618             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7619             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7620             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 146
* EL156.cbl
  7621
  7622         16  CO-AGING-TOTALS.
  7623             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7624             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7625             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7626             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7627
  7628         16  CO-YTD-TOTALS.
  7629             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7630             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7631
  7632         16  CO-OVER-UNDER-TOTALS.
  7633             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7634             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7635
  7636     12  CO-MISCELLANEOUS-TOTALS.
  7637         16  CO-FICA-TOTALS.
  7638             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7639             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7640
  7641         16  CO-CLAIM-TOTALS.
  7642             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7643             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7644
  7645******************************************************************
  7646*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7647*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7648******************************************************************
  7649
  7650     12  CO-CURRENT-TOTALS.
  7651         16  CO-CURRENT-LAST-STMT-DT.
  7652             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7653             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7654             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7655
  7656         16  CO-CURRENT-MONTHLY-TOTALS.
  7657             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7658             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7659             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7660             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7661             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7662
  7663         16  CO-CURRENT-AGING-TOTALS.
  7664             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7665             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7666             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7667             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7668
  7669         16  CO-CURRENT-YTD-TOTALS.
  7670             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7671             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7672
  7673     12  CO-PAID-COMM-TOTALS.
  7674         16  CO-YTD-PAID-COMMS.
  7675             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7676             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7677
  7678     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 147
* EL156.cbl
  7679         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7680         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7681
  7682     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7683         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7684         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7685         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7686         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7687         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7688         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7689         88  CO-FINAL-LETTER                  VALUE 'F'.
  7690         88  CO-RECONCILING                   VALUE 'R'.
  7691         88  CO-PHONE-CALL                    VALUE 'P'.
  7692         88  CO-LEGAL                         VALUE 'L'.
  7693         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7694         88  CO-WRITE-OFF                     VALUE 'W'.
  7695         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7696
  7697     12  CO-CSR-CODE                       PIC X(4).
  7698
  7699     12  CO-GA-STATUS-INFO.
  7700         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7701         16  CO-GA-TERMINATION-DT          PIC XX.
  7702         16  CO-GA-STATUS-CODE             PIC X.
  7703             88  CO-GA-ACTIVE                 VALUE 'A'.
  7704             88  CO-GA-INACTIVE               VALUE 'I'.
  7705             88  CO-GA-PENDING                VALUE 'P'.
  7706         16  CO-GA-COMMENTS.
  7707             20  CO-GA-COMMENT-1           PIC X(40).
  7708             20  CO-GA-COMMENT-2           PIC X(40).
  7709             20  CO-GA-COMMENT-3           PIC X(40).
  7710             20  CO-GA-COMMENT-4           PIC X(40).
  7711
  7712     12  CO-RPTCD2                         PIC X(10).
  7713     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7714         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7715         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7716
  7717     12  CO-TYPE-AGENT                     PIC X(01).
  7718         88  CO-CORPORATION                   VALUE 'C'.
  7719         88  CO-PARTNERSHIP                   VALUE 'P'.
  7720         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7721         88  CO-TRUST                         VALUE 'T'.
  7722         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7723
  7724     12  CO-FAXNO.
  7725         16  CO-FAX-AREA-CODE                  PIC XXX.
  7726         16  CO-FAX-PREFIX                     PIC XXX.
  7727         16  CO-FAX-PHONE                      PIC X(4).
  7728
  7729     12  CO-BANK-INFORMATION.
  7730         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7731         16  CO-BANK-TRANSIT-NON REDEFINES
  7732             CO-BANK-TRANSIT-NO                PIC 9(8).
  7733
  7734         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7735     12  CO-MISC-DEDUCT-INFO REDEFINES
  7736                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 148
* EL156.cbl
  7737         16  CO-MD-GL-ACCT                     PIC X(10).
  7738         16  CO-MD-DIV                         PIC XX.
  7739         16  CO-MD-CENTER                      PIC X(4).
  7740         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7741         16  CO-CREATE-AP-CHECK                PIC X.
  7742         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7743         16  FILLER                            PIC XXX.
  7744     12  CO-ACH-STATUS                         PIC X.
  7745         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7746         88  CO-ACH-PENDING                        VALUE 'P'.
  7747
  7748     12  CO-BILL-SW                            PIC X.
  7749     12  CO-CONTROL-NAME                       PIC X(30).
  7750     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7751     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7752     12  CO-CLP-STATE                          PIC XX.
  7753     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7754     12  CO-SPP-REFUND-EDIT                    PIC X.
  7755
  7756******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 149
* EL156.cbl
  7758*    COPY ERCDMDNT.
  7759******************************************************************
  7760*                                                                *
  7761*                            ERCDMDNT                            *
  7762*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7763*                            VMOD=2.005                          *
  7764*                                                                *
  7765*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7766*                                                                *
  7767*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7768*                                                                *
  7769*        FILE TYPE= VSAM,KSDS                                    *
  7770*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7771*                                                                *
  7772*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7773*                                                                *
  7774*        LOG = YES                                               *
  7775*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7776*                                                                *
  7777******************************************************************
  7778
  7779 01  CERTIFICATE-NOTE.
  7780     12  CN-RECORD-ID                     PIC  XX.
  7781         88  VALID-CN-ID                      VALUE 'CN'.
  7782
  7783     12  CN-CONTROL-PRIMARY.
  7784         16  CN-COMPANY-CD                PIC X.
  7785         16  CN-CERT-KEY.
  7786             20  CN-CARRIER               PIC X.
  7787             20  CN-GROUPING.
  7788                 24  CN-GROUPING-PREFIX   PIC XXX.
  7789                 24  CN-GROUPING-PRIME    PIC XXX.
  7790             20  CN-STATE                 PIC XX.
  7791             20  CN-ACCOUNT.
  7792                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7793                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7794             20  CN-CERT-EFF-DT           PIC XX.
  7795             20  CN-CERT-NO.
  7796                 24  CN-CERT-PRIME        PIC X(10).
  7797                 24  CN-CERT-SFX          PIC X.
  7798
  7799     12  CN-BILLING-START-LINE-NO         PIC 99.
  7800     12  CN-BILLING-END-LINE-NO           PIC 99.
  7801
  7802     12  CN-LINES.
  7803         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7804
  7805     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7806         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7807         16  CN-CSI-GENERAL-DATA-AREA.
  7808             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7809
  7810         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7811             CN-CSI-GENERAL-DATA-AREA.
  7812             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7813             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7814             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7815             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 150
* EL156.cbl
  7816             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7817             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7818             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7819             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7820             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7821             20  FILLER                       PIC XX.
  7822             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7823             20  FILLER                       PIC X(38).
  7824
  7825         16  CN-CSI-PRODUCT-DATA-AREA.
  7826             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7827
  7828         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7829             CN-CSI-PRODUCT-DATA-AREA.
  7830             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7831             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7832             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7833             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7834             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7835             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7836             20  FILLER                   PIC XX.
  7837             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7838             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7839             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7840             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7841             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7842             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7843             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7844             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7845             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7846             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7847             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7848             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7849             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7850             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7851             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7852             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7853             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7854             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7855             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7856             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7857             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7858             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7859             20  FILLER                   PIC X(25).
  7860
  7861         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7862             CN-CSI-CREDIT-CARD-DATA.
  7863             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7864             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7865             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7866             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7867             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7868             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7869             20  FILLER                   PIC XX.
  7870             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7871             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7872             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7873             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 151
* EL156.cbl
  7874             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7875             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7876             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7877             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7878             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7879             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7880             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7881             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7882             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7883             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7884             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7885             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7886             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7887             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7888             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7889             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7890             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7891             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7892             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7893             20  FILLER                   PIC X(17).
  7894
  7895         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7896             CN-CSI-FAMILY-LEAVE-DATA.
  7897             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7898             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7899             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7900             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7901             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7902             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7903             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7904             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7905             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7906             20  CN-CSI-SL-INT-ON-PROCEEDS
  7907                                          PIC S9(5)V99  COMP-3.
  7908             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7909             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7910             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7911             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7912             20  CN-CSI-SL-POLICY-BENEFITS
  7913                                          PIC S9(5)V99  COMP-3.
  7914             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7915             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7916             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7917             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7918             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7919             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7920             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7921             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7922             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7923             20  CN-CSI-SL-STATE-NOT      PIC X.
  7924             20  FILLER                   PIC XX.
  7925
  7926         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7927             CN-CSI-SENIOR-LIFE-DATA.
  7928             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7929             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7930             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7931                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 152
* EL156.cbl
  7932             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7933             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7934             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7935             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7936             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7937             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7938             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7939             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7940             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7941             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7942             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7943             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7944             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7945             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7946             20  CN-CSI-PP-REPAIR         PIC X.
  7947             20  CN-CSI-PP-REPLACE        PIC X.
  7948             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7949             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7950             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7951             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7952             20  FILLER                   PIC X(5).
  7953
  7954         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7955             CN-CSI-PURCH-PROP-DATA.
  7956             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7957             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7958             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7959             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7960             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7961             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7962             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7963             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7964             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7965             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7966             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7967             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7968             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7969             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7970             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7971             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7972             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7973             20  CN-CSI-EW-REPLACE        PIC X.
  7974             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7975             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7976             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7977             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7978             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7979             20  FILLER                   PIC X(4).
  7980
  7981     12  CN-LAST-MAINT-DT                 PIC XX.
  7982     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7983     12  CN-LAST-MAINT-USER               PIC X(4).
  7984     12  FILLER                           PIC X(6).
  7985
  7986******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 153
* EL156.cbl
  7988*    COPY ERCCNOT.
  7989******************************************************************
  7990*                                                                *
  7991*                            ERCCNOT                             *
  7992*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7993*                            VMOD=2.003                          *
  7994*                                                                *
  7995*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7996*                                                                *
  7997*        FILE TYPE= VSAM,KSDS                                    *
  7998*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7999*                                                                *
  8000*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  8001*                                                                *
  8002*        LOG = YES                                               *
  8003*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  8004*                                                                *
  8005******************************************************************
  8006*                   C H A N G E   L O G
  8007*
  8008* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8009*-----------------------------------------------------------------
  8010*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8011* EFFECTIVE    NUMBER
  8012*-----------------------------------------------------------------
  8013* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  8014******************************************************************
  8015
  8016 01  CERT-NOTE-FILE.
  8017     12  CZ-RECORD-ID                PIC  XX.
  8018         88  VALID-CZ-ID                  VALUE 'CZ'.
  8019
  8020     12  CZ-CONTROL-PRIMARY.
  8021         16  CZ-COMPANY-CD           PIC X.
  8022         16  CZ-CARRIER              PIC X.
  8023         16  CZ-GROUPING.
  8024             20 CZ-GROUPING-PREFIX   PIC XXX.
  8025             20 CZ-GROUPING-PRIME    PIC XXX.
  8026         16  CZ-STATE                PIC XX.
  8027         16  CZ-ACCOUNT.
  8028             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  8029             20 CZ-ACCOUNT-PRIME     PIC X(6).
  8030         16  CZ-CERT-EFF-DT          PIC XX.
  8031         16  CZ-CERT-NO.
  8032             20  CZ-CERT-PRIME       PIC X(10).
  8033             20  CZ-CERT-SFX         PIC X.
  8034         16  CZ-RECORD-TYPE          PIC X.
  8035             88  CERT-NOTE           VALUE '1'.
  8036             88  CLAIM-CERT-NOTE     VALUE '2'.
  8037         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  8038
  8039     12  CZ-LAST-MAINT-DT            PIC XX.
  8040     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8041     12  CZ-LAST-MAINT-USER          PIC X(4).
  8042
  8043     12  CZ-NOTE-INFORMATION.
  8044         16  CZ-NOTE                 PIC X(63).
  8045         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 154
* EL156.cbl
  8046******************************************************************
  8047*                            COPY ERCPDEF.
  8048******************************************************************
  8049*                                                                *
  8050*                                                                *
  8051*                            ERCPDEF.                            *
  8052*                                                                *
  8053*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  8054*                                                                *
  8055*    FILE TYPE = VSAM,KSDS                                       *
  8056*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  8057*                                                                *
  8058*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  8059*                                                                *
  8060*    LOG = YES                                                   *
  8061*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8062******************************************************************
  8063*                   C H A N G E   L O G
  8064*
  8065* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8066*-----------------------------------------------------------------
  8067*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8068* EFFECTIVE    NUMBER
  8069*-----------------------------------------------------------------
  8070* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8071* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8072* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  8073* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8074******************************************************************
  8075 01  PRODUCT-MASTER.
  8076    12  PD-RECORD-ID                 PIC X(02).
  8077        88  VALID-PD-ID                  VALUE 'PD'.
  8078    12  PD-CONTROL-PRIMARY.
  8079        16  PD-COMPANY-CD            PIC X.
  8080        16  PD-STATE                 PIC XX.
  8081        16  PD-PRODUCT-CD            PIC XXX.
  8082        16  PD-FILLER                PIC X(7).
  8083        16  PD-BEN-TYPE              PIC X.
  8084        16  PD-BEN-CODE              PIC XX.
  8085        16  PD-PROD-EXP-DT           PIC XX.
  8086    12  FILLER                       PIC X(50).
  8087    12  PD-PRODUCT-DATA OCCURS 8.
  8088        16  PD-PROD-CODE             PIC X.
  8089            88  PD-PROD-LIFE           VALUE 'L'.
  8090            88  PD-PROD-PROP           VALUE 'P'.
  8091            88  PD-PROD-AH             VALUE 'A'.
  8092            88  PD-PROD-IU             VALUE 'I'.
  8093            88  PD-PROD-GAP            VALUE 'G'.
  8094            88  PD-PROD-FAML           VALUE 'F'.
  8095            88  PD-PROD-OTH            VALUE 'O'.
  8096        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  8097        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  8098        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  8099        16  PD-MAX-TERM              PIC S999        COMP-3.
  8100        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  8101        16  FILLER                   PIC X.
  8102        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  8103        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 155
* EL156.cbl
  8104        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  8105        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  8106        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  8107        16  PD-REC-CRIT-PERIOD       PIC 99.
  8108        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  8109            20  PD-RECURRING-YN      PIC X.
  8110            20  FILLER               PIC X.
  8111        16  PD-RTW-MOS               PIC 99.
  8112        16  PD-MAX-EXTENSION         PIC 99.
  8113        16  pd-ben-pct               pic sv999 comp-3.
  8114*       16  FILLER                   PIC XX.
  8115    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  8116    12  PD-TERM-LIMITS OCCURS 15.
  8117        16  PD-LOW-TERM              PIC S999        COMP-3.
  8118        16  PD-HI-TERM               PIC S999        COMP-3.
  8119*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  8120    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  8121        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  8122        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  8123    12  PD-EARN-FACTORS.
  8124        16  FILLER OCCURS 15.
  8125            20  FILLER OCCURS 15.
  8126                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  8127    12  PD-PRODUCT-DESC              PIC X(80).
  8128    12  PD-TRUNCATED                 PIC X.
  8129    12  FILLER                       PIC X(59).
  8130    12  PD-MAINT-INFORMATION.
  8131        16  PD-LAST-MAINT-DT         PIC X(02).
  8132        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8133        16  PD-LAST-MAINT-BY         PIC X(04).
  8134*                            COPY ELCCRTT.
  8135******************************************************************
  8136*                                                                *
  8137*                            ELCCRTT.                            *
  8138*                                                                *
  8139*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8140*                                                                *
  8141*   FILE TYPE = VSAM,KSDS                                        *
  8142*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8143*                                                                *
  8144*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8145*                                                                *
  8146*   LOG = YES                                                    *
  8147*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8148******************************************************************
  8149*                   C H A N G E   L O G
  8150*
  8151* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8152*-----------------------------------------------------------------
  8153*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8154* EFFECTIVE    NUMBER
  8155*-----------------------------------------------------------------
  8156* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8157* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8158* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8159* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8160* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8161* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 156
* EL156.cbl
  8162* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8163* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8164* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8165* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8166* 091318  CR2018073000001  PEMA  ADD Refund methods
  8167* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8168******************************************************************
  8169
  8170 01  CERTIFICATE-TRAILERS.
  8171     12  CS-RECORD-ID                      PIC XX.
  8172         88  VALID-CS-ID                      VALUE 'CS'.
  8173
  8174     12  CS-CONTROL-PRIMARY.
  8175         16  CS-COMPANY-CD                 PIC X.
  8176         16  CS-CARRIER                    PIC X.
  8177         16  CS-GROUPING                   PIC X(6).
  8178         16  CS-STATE                      PIC XX.
  8179         16  CS-ACCOUNT                    PIC X(10).
  8180         16  CS-CERT-EFF-DT                PIC XX.
  8181         16  CS-CERT-NO.
  8182             20  CS-CERT-PRIME             PIC X(10).
  8183             20  CS-CERT-SFX               PIC X.
  8184         16  CS-TRAILER-TYPE               PIC X.
  8185             88  COMM-TRLR           VALUE 'A'.
  8186             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8187             88  CERT-DATA-TRLR      VALUE 'C'.
  8188
  8189     12  CS-DATA-AREA                      PIC X(516).
  8190
  8191     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8192         16  CS-BANK-COMMISSION-AREA.
  8193             20  CS-BANK-COMMS       OCCURS 10.
  8194                 24  CS-AGT                PIC X(10).
  8195                 24  CS-COM-TYP            PIC X.
  8196                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8197                 24  CS-RECALC-LV-INDIC    PIC X.
  8198                 24  FILLER                PIC X(10).
  8199         16  FILLER                        PIC X(256).
  8200
  8201     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8202****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8203         16  CS-MB-CLAIM-DATA OCCURS 24.
  8204             20  CS-CLAIM-NO               PIC X(7).
  8205             20  CS-CLAIM-TYPE             PIC X.
  8206                 88  CS-AH-CLM               VALUE 'A'.
  8207                 88  CS-IU-CLM               VALUE 'I'.
  8208                 88  CS-GP-CLM               VALUE 'G'.
  8209                 88  CS-LF-CLM               VALUE 'L'.
  8210                 88  CS-PR-CLM               VALUE 'P'.
  8211                 88  CS-FL-CLM               VALUE 'F'.
  8212                 88  CS-OT-CLM               VALUE 'O'.
  8213             20  CS-INSURED-TYPE           PIC X.
  8214                 88  CS-PRIM-INSURED          VALUE 'P'.
  8215                 88  CS-CO-BORROWER           VALUE 'C'.
  8216             20  CS-BENEFIT-PERIOD         PIC 99.
  8217             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8218             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8219             20  CS-REMAINING-BENS         PIC S999 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 157
* EL156.cbl
  8220         16  FILLER                        PIC X(12).
  8221     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8222         16  CS-VIN-NUMBER                 PIC X(17).
  8223         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8224         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8225         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8226         16  cs-agent-name.
  8227             20  cs-agent-fname            pic x(20).
  8228             20  cs-agent-mi               pic x.
  8229             20  cs-agent-lname            pic x(25).
  8230         16  cs-license-no                 pic x(15).
  8231         16  cs-npn-number                 pic x(10).
  8232         16  cs-agent-edit-status          pic x.
  8233             88  cs-ae-refer-to-manager      value 'M'.
  8234             88  cs-ae-cover-sheet           value 'C'.
  8235             88  cs-ae-sig-form              value 'S'.
  8236             88  cs-ae-verified              value 'V'.
  8237             88  cs-unidentified-signature   value 'U'.
  8238             88  cs-cert-returned            value 'R'.
  8239             88  cs-accept-no-commission     value 'N'.
  8240         16  cs-year                       pic 9999.
  8241         16  cs-make                       pic x(20).
  8242         16  cs-model                      pic x(20).
  8243         16  cs-future                     pic x(20).
  8244         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8245         16  cs-claim-verification-status  pic x.
  8246             88  cs-clm-ver-eligible         value 'A'.
  8247             88  cs-clm-ver-partial-elig     value 'B'.
  8248             88  cs-clm-ver-not-eligible     value 'C'.
  8249             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8250             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8251             88  cs-clm-ver-ND-CERT          value 'F'.
  8252             88  cs-clm-ver-spec-other       value 'G'.
  8253             88  cs-clam-ver-pratial-corrected
  8254                                             value 'H'.
  8255             88  cs-clm-ver-no-matches       value 'I'.
  8256             88  cs-clm-ver-not-elig-corrected
  8257                                             value 'J'.
  8258             88  cs-clm-ver-needs-review     value 'R'.
  8259             88  cs-clm-ver-sent-to-claims   value 'W'.
  8260         16  CS-LF-REFUND-METHOD           PIC X.
  8261         16  CS-AH-REFUND-METHOD           PIC X.
  8262         16  FILLER                        PIC X(353). *> was 420
  8263*        16  FILLER                        PIC X(496).
  8264 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8265                          CONTROL-FILE CERTIFICATE-MASTER
  8266                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8267                          ACCOUNT-MASTER CHECK-QUE
  8268                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8269                          DAILY-ACTIVITY-RECORD
  8270                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8271                          CERT-NOTE-FILE PRODUCT-MASTER
  8272                          CERTIFICATE-TRAILERS.
  8273 0000-DFHEXIT SECTION.
  8274     MOVE '9#                    $   ' TO DFHEIV0.
  8275     MOVE 'EL156' TO DFHEIV1.
  8276     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8277
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 158
* EL156.cbl
  8278     IF EIBCALEN = 0
  8279         GO TO 8800-UNAUTHORIZED-ACCESS.
  8280
  8281     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8282     MOVE EIBTRMID               TO QID-TERM.
  8283     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8284     MOVE '2'                    TO EMI-SWITCH2.
  8285     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8286     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8287
  8288     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8289     MOVE '5'                    TO DC-OPTION-CODE.
  8290     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8291     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8292                                    SAVE-BIN-DATE.
  8293     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8294     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8295
  8296     IF SAVE-DATE-YY > 70
  8297         MOVE 19                 TO SAVE-DATE-CC
  8298     ELSE
  8299         MOVE 20                 TO SAVE-DATE-CC.
  8300
  8301     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8302         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8303     END-IF.
  8304
  8305     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8306        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8307     ELSE
  8308        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8309     END-IF
  8310
  8311     IF PI-PRINT-CLM-FRM-YN = 'N'
  8312         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8313     ELSE
  8314         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8315     END-IF
  8316
  8317     IF PI-PRINT-SURVEY-YN = 'N'
  8318         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8319     ELSE
  8320         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8321     END-IF
  8322
  8323     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8324         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8325     ELSE
  8326         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8327     END-IF
  8328
  8329* EXEC CICS HANDLE CONDITION
  8330*        NOTOPEN   (9990-ABEND)
  8331*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8332*        MAPFAIL   (0400-FIRST-TIME)
  8333*        DUPREC    (6180-DUPREC)
  8334*        ERROR     (9990-ABEND)
  8335*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 159
* EL156.cbl
  8336*    MOVE '"$JL?%.               ! " #00008324' TO DFHEIV0
  8337     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8338     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8339     MOVE X'2220233030303038333234' TO DFHEIV0(25:11)
  8340     CALL 'kxdfhei1' USING DFHEIV0
  8341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8342
  8343
  8344     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8345         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8346
  8347     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8348         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8349             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8350             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8351             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8352             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8353             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8354             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8355             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8356             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8357             MOVE LOW-VALUES           TO EL156AI
  8358             MOVE 'Y'                  TO FIRST-ENTRY
  8359         ELSE
  8360             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8361             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8362             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8363             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8364             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8365             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8366             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8367             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8368
  8369     IF RETURNED-FROM NOT = SPACES
  8370        IF (RETURNED-FROM = 'EL614')
  8371           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8372           IF WS-SAVED-EOB-CODES NOT = SPACES
  8373              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8374           ELSE
  8375              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8376           END-IF
  8377        END-IF
  8378         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8379            MOVE 'Y'             TO FIRST-ENTRY
  8380            IF RETURNED-FROM = 'EL614'
  8381               AND (PI-PASS-SW NOT = 'C')
  8382               IF WS-SAVED-EOB-CODES NOT = SPACES
  8383                  MOVE WS-SAVED-EOB-CODES
  8384                                 TO PI-PMTNOTE2
  8385                                    WS-PMTNOTE2
  8386                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8387               ELSE
  8388                  MOVE SPACES    TO PI-PMTNOTE2
  8389                                    WS-PMTNOTE2
  8390                                    PI-EOB-CODES-EXIST
  8391               END-IF
  8392            END-IF
  8393            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 160
* EL156.cbl
  8394            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8395            IF RETURNED-FROM = 'EL614'
  8396               GO TO 1000-EDIT-DATA
  8397            END-IF
  8398            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8399               (PAYEEI   = LOW-VALUES OR SPACES)
  8400               GO TO 8100-SEND-INITIAL-MAP
  8401            ELSE
  8402               GO TO 1000-EDIT-DATA.
  8403
  8404     IF EIBTRNID NOT = TRANS-ID
  8405         GO TO 0400-FIRST-TIME.
  8406
  8407     IF EIBAID = DFHCLEAR
  8408        IF PI-PASS-SW = 'C'
  8409           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8410           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8411           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8412           MOVE 'Y'            TO RETURNED-FROM-B
  8413           GO TO 1000-EDIT-DATA
  8414        ELSE
  8415           GO TO 9400-CLEAR.
  8416
  8417     IF PI-PASS-SW = 'C'
  8418         MOVE MAP-NAMEB          TO MAP-NAME
  8419         IF EIBAID = DFHPF1 OR DFHPF13
  8420             GO TO 5000-UPDATE
  8421           ELSE
  8422             IF EIBAID NOT = DFHENTER
  8423                 MOVE LOW-VALUES TO EL156BI
  8424                 MOVE MAP-NAMEB  TO MAP-NAME
  8425                 MOVE ER-0029    TO EMI-ERROR
  8426                 MOVE -1         TO  ENTPFBL
  8427                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8428                 GO TO 8200-SEND-DATAONLY.
  8429
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 161
* EL156.cbl
  8431 0200-RECEIVE.
  8432     MOVE LOW-VALUES             TO EL156AI.
  8433     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8434         MOVE ER-0008            TO EMI-ERROR
  8435         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8436         IF PI-PASS-SW = 'C'
  8437             MOVE -1             TO ENTPFBL
  8438             GO TO 8200-SEND-DATAONLY
  8439         ELSE
  8440             MOVE -1             TO PMTTYPEL
  8441             GO TO 8200-SEND-DATAONLY.
  8442
  8443     IF PI-COMPANY-ID = 'DMD'
  8444         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8445
  8446     IF PI-PASS-SW = 'C'
  8447         MOVE MAP-NAMEB          TO MAP-NAME.
  8448
  8449
  8450* EXEC CICS RECEIVE
  8451*        MAP   (MAP-NAME)
  8452*        MAPSET(MAPSET-NAME)
  8453*        ASIS
  8454*        INTO  (EL156AI)
  8455*    END-EXEC.
  8456     MOVE LENGTH OF
  8457      EL156AI
  8458       TO DFHEIV11
  8459*    MOVE '8"TAI  L              ''   #00008437' TO DFHEIV0
  8460     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8461     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8462     MOVE X'2020233030303038343337' TO DFHEIV0(25:11)
  8463     CALL 'kxdfhei1' USING DFHEIV0,
  8464           MAP-NAME,
  8465           EL156AI,
  8466           DFHEIV11,
  8467           MAPSET-NAME,
  8468           DFHEIV99,
  8469           DFHEIV99
  8470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8471
  8472
  8473     IF PI-PASS-SW NOT = 'C'
  8474         GO TO 0250-MAPA.
  8475
  8476     IF ENTPFBL NOT > ZERO
  8477         MOVE MAP-NAMEB          TO MAP-NAME
  8478         MOVE ER-0029            TO EMI-ERROR
  8479         MOVE -1                 TO  ENTPFBL
  8480         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8481         GO TO 8200-SEND-DATAONLY.
  8482
  8483     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8484         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8485       ELSE
  8486         MOVE MAP-NAMEB           TO MAP-NAME
  8487         MOVE ER-0029             TO EMI-ERROR
  8488         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 162
* EL156.cbl
  8489         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8490         GO TO 8200-SEND-DATAONLY.
  8491
  8492     IF EIBAID = DFHPF1 OR DFHPF13
  8493         IF MODIFY-CAP
  8494            GO TO 5000-UPDATE
  8495          ELSE
  8496            MOVE 'UPDATE'           TO SM-READ
  8497            PERFORM 9995-SECURITY-VIOLATION
  8498            MOVE MAP-NAMEB          TO MAP-NAME
  8499            MOVE ER-0070            TO EMI-ERROR
  8500            MOVE -1                 TO  ENTPFBL
  8501            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8502            GO TO 8200-SEND-DATAONLY.
  8503
  8504 0250-MAPA.
  8505     IF ENTERPFL = 0
  8506         GO TO 0300-CHECK-PFKEYS.
  8507
  8508     IF EIBAID NOT = DFHENTER
  8509         MOVE ER-0004            TO EMI-ERROR
  8510         GO TO 0320-INPUT-ERROR.
  8511
  8512     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8513         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8514     ELSE
  8515         MOVE ER-0029            TO EMI-ERROR
  8516         GO TO 0320-INPUT-ERROR.
  8517
  8518 0300-CHECK-PFKEYS.
  8519     IF EIBAID = DFHPF7 OR DFHPF8
  8520         GO TO 8820-PF7-8.
  8521
  8522     IF EIBAID = DFHPF23
  8523         GO TO 8810-PF23.
  8524
  8525     IF EIBAID = DFHPF24
  8526         GO TO 9200-RETURN-MAIN-MENU.
  8527
  8528     IF EIBAID = DFHPF12
  8529         GO TO 9500-PF12.
  8530
  8531     IF EIBAID = DFHPF1
  8532        IF PI-PASS-SW = 'A' OR 'B'
  8533          GO TO 0330-BROWSE-FORWARD.
  8534
  8535     IF EIBAID = DFHPF2
  8536        IF PI-PASS-SW = 'A' OR 'B'
  8537          GO TO 0350-BROWSE-BACKWARD.
  8538
  8539     IF EIBAID = DFHPF6
  8540        IF PI-EOB-CODES-EXIST = 'Y'
  8541           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8542        ELSE
  8543           MOVE SPACES              TO WS-PMTNOTE2
  8544        END-IF
  8545         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8546         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 163
* EL156.cbl
  8547            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8548         END-IF
  8549         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8550         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  8551             MOVE 'EL614'        TO PGM-NAME
  8552             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8553             GO TO 9300-XCTL
  8554         ELSE
  8555             MOVE XCTL-157       TO PGM-NAME
  8556             GO TO 9300-XCTL.
  8557
  8558     IF EIBAID = DFHPF9
  8559        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8560        MOVE XCTL-141            TO PGM-NAME
  8561        GO TO 9300-XCTL.
  8562
  8563     IF EIBAID = DFHPF10
  8564        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8565        MOVE XCTL-155            TO PGM-NAME
  8566        GO TO 9300-XCTL.
  8567
  8568     MOVE SPACES                 TO ERRMSG0O
  8569                                    ERRMSG1O
  8570                                    ERRMSG2O.
  8571
  8572     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8573         IF PI-PASS-SW NOT = 'B'
  8574             MOVE ER-0422        TO EMI-ERROR
  8575             GO TO 0320-INPUT-ERROR
  8576           ELSE
  8577             GO TO 0700-TEST-FOR-CHANGES.
  8578
  8579     IF EIBAID = DFHPF11
  8580        IF PI-PASS-SW = 'C'
  8581           MOVE ER-0029          TO EMI-ERROR
  8582           GO TO 0320-INPUT-ERROR.
  8583
  8584     IF EIBAID = DFHENTER OR DFHPF11
  8585        NEXT SENTENCE
  8586     ELSE
  8587        MOVE ER-0029             TO EMI-ERROR
  8588        GO TO 0320-INPUT-ERROR.
  8589
  8590     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8591
  8592     if pi-epyfrom not = zeros
  8593        if pi-epyfrom not = ws-epyfrom
  8594           move zeros        to ws-edays
  8595        end-if
  8596     end-if
  8597
  8598     if pi-epythru not = zeros
  8599        if pi-epythru not = ws-epythru
  8600           move zeros        to ws-edays
  8601        end-if
  8602     end-if
  8603
  8604     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 164
* EL156.cbl
  8605         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8606         GO TO 1000-EDIT-DATA
  8607     ELSE
  8608         IF PI-FATAL-COUNT NOT = 0 OR
  8609            PI-FORCE-COUNT NOT = 0
  8610             GO TO 1000-EDIT-DATA
  8611         ELSE
  8612             GO TO 2000-EDIT-DONE.
  8613
  8614 0320-INPUT-ERROR.
  8615     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8616
  8617     IF ENTERPFL = 0
  8618         MOVE -1                 TO PMTTYPEL
  8619     ELSE
  8620         MOVE AL-UNBON           TO ENTERPFA
  8621         MOVE -1                 TO ENTERPFL.
  8622
  8623     GO TO 8200-SEND-DATAONLY.
  8624
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 165
* EL156.cbl
  8626 0330-BROWSE-FORWARD.
  8627
  8628     MOVE CLMNOI            TO PI-CLAIM-NO.
  8629     MOVE CARRI             TO PI-CARRIER.
  8630     MOVE CERTNOI           TO PI-CERT-PRIME.
  8631     MOVE SUFXI             TO PI-CERT-SFX.
  8632
  8633     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8634     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8635     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8636     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8637
  8638     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8639
  8640
  8641* EXEC CICS HANDLE CONDITION
  8642*         NOTFND   (0380-CLAIM-END-FILE)
  8643*         ENDFILE  (0380-CLAIM-END-FILE)
  8644*    END-EXEC.
  8645*    MOVE '"$I''                  ! # #00008611' TO DFHEIV0
  8646     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8647     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8648     MOVE X'2320233030303038363131' TO DFHEIV0(25:11)
  8649     CALL 'kxdfhei1' USING DFHEIV0
  8650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8651
  8652
  8653
  8654* EXEC CICS STARTBR
  8655*         DATASET    ('ELMSTR')
  8656*         RIDFLD     (ELMSTR-KEY)
  8657*         GTEQ
  8658*    END-EXEC.
  8659     MOVE 'ELMSTR' TO DFHEIV1
  8660     MOVE 0
  8661       TO DFHEIV11
  8662*    MOVE '&,         G          &   #00008616' TO DFHEIV0
  8663     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8664     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8665     MOVE X'2020233030303038363136' TO DFHEIV0(25:11)
  8666     CALL 'kxdfhei1' USING DFHEIV0,
  8667           DFHEIV1,
  8668           ELMSTR-KEY,
  8669           DFHEIV99,
  8670           DFHEIV11,
  8671           DFHEIV99
  8672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8673
  8674
  8675     MOVE 'Y' TO WS-BROWSE-START-SW.
  8676
  8677 0335-READNEXT.
  8678
  8679
  8680* EXEC CICS READNEXT
  8681*         DATASET    ('ELMSTR')
  8682*         RIDFLD     (ELMSTR-KEY)
  8683*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 166
* EL156.cbl
  8684*    END-EXEC.
  8685     MOVE 'ELMSTR' TO DFHEIV1
  8686     MOVE 0
  8687       TO DFHEIV11
  8688*    MOVE '&.S                   )   #00008626' TO DFHEIV0
  8689     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8690     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8691     MOVE X'2020233030303038363236' TO DFHEIV0(25:11)
  8692     CALL 'kxdfhei1' USING DFHEIV0,
  8693           DFHEIV1,
  8694           DFHEIV20,
  8695           DFHEIV99,
  8696           ELMSTR-KEY,
  8697           DFHEIV99,
  8698           DFHEIV11,
  8699           DFHEIV99,
  8700           DFHEIV99
  8701     SET ADDRESS OF CLAIM-MASTER TO
  8702         DFHEIV20
  8703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8704
  8705
  8706     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8707        GO TO 0380-CLAIM-END-FILE.
  8708
  8709     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8710        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8711        GO TO 0335-READNEXT.
  8712
  8713     IF PI-COMPANY-ID = 'CRI'
  8714         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8715            GO TO 0380-CLAIM-END-FILE.
  8716
  8717     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8718         GO TO 0335-READNEXT.
  8719
  8720     IF PI-CARRIER-SECURITY > SPACES
  8721         IF CL-CARRIER = PI-CARRIER-SECURITY
  8722             NEXT SENTENCE
  8723         ELSE
  8724             GO TO 0335-READNEXT.
  8725
  8726     IF PI-ACCOUNT-SECURITY > SPACES
  8727         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8728             NEXT SENTENCE
  8729         ELSE
  8730             GO TO 0335-READNEXT.
  8731
  8732     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8733     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8734     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8735
  8736     GO TO 0400-FIRST-TIME.
  8737
  8738 0350-BROWSE-BACKWARD.
  8739
  8740     MOVE CLMNOI            TO PI-CLAIM-NO
  8741                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 167
* EL156.cbl
  8742     MOVE CARRI             TO PI-CARRIER.
  8743     MOVE CERTNOI           TO PI-CERT-PRIME.
  8744     MOVE SUFXI             TO PI-CERT-SFX.
  8745
  8746     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8747
  8748     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8749     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8750     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8751
  8752
  8753* EXEC CICS HANDLE CONDITION
  8754*         NOTFND   (0380-CLAIM-END-FILE)
  8755*         ENDFILE  (0380-CLAIM-END-FILE)
  8756*    END-EXEC.
  8757*    MOVE '"$I''                  ! $ #00008678' TO DFHEIV0
  8758     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8759     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8760     MOVE X'2420233030303038363738' TO DFHEIV0(25:11)
  8761     CALL 'kxdfhei1' USING DFHEIV0
  8762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8763
  8764
  8765
  8766* EXEC CICS STARTBR
  8767*         DATASET    ('ELMSTR')
  8768*         RIDFLD     (ELMSTR-KEY)
  8769*         GTEQ
  8770*    END-EXEC.
  8771     MOVE 'ELMSTR' TO DFHEIV1
  8772     MOVE 0
  8773       TO DFHEIV11
  8774*    MOVE '&,         G          &   #00008683' TO DFHEIV0
  8775     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8776     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8777     MOVE X'2020233030303038363833' TO DFHEIV0(25:11)
  8778     CALL 'kxdfhei1' USING DFHEIV0,
  8779           DFHEIV1,
  8780           ELMSTR-KEY,
  8781           DFHEIV99,
  8782           DFHEIV11,
  8783           DFHEIV99
  8784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8785
  8786
  8787     MOVE 'Y' TO WS-BROWSE-START-SW.
  8788
  8789
  8790* EXEC CICS READNEXT
  8791*         DATASET    ('ELMSTR')
  8792*         RIDFLD     (ELMSTR-KEY)
  8793*         SET        (ADDRESS OF CLAIM-MASTER)
  8794*    END-EXEC.
  8795     MOVE 'ELMSTR' TO DFHEIV1
  8796     MOVE 0
  8797       TO DFHEIV11
  8798*    MOVE '&.S                   )   #00008691' TO DFHEIV0
  8799     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 168
* EL156.cbl
  8800     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8801     MOVE X'2020233030303038363931' TO DFHEIV0(25:11)
  8802     CALL 'kxdfhei1' USING DFHEIV0,
  8803           DFHEIV1,
  8804           DFHEIV20,
  8805           DFHEIV99,
  8806           ELMSTR-KEY,
  8807           DFHEIV99,
  8808           DFHEIV11,
  8809           DFHEIV99,
  8810           DFHEIV99
  8811     SET ADDRESS OF CLAIM-MASTER TO
  8812         DFHEIV20
  8813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8814
  8815
  8816
  8817* EXEC CICS READPREV
  8818*         DATASET    ('ELMSTR')
  8819*         RIDFLD     (ELMSTR-KEY)
  8820*         SET        (ADDRESS OF CLAIM-MASTER)
  8821*    END-EXEC.
  8822     MOVE 'ELMSTR' TO DFHEIV1
  8823     MOVE 0
  8824       TO DFHEIV11
  8825*    MOVE '&0S                   )   #00008697' TO DFHEIV0
  8826     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8827     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8828     MOVE X'2020233030303038363937' TO DFHEIV0(25:11)
  8829     CALL 'kxdfhei1' USING DFHEIV0,
  8830           DFHEIV1,
  8831           DFHEIV20,
  8832           DFHEIV99,
  8833           ELMSTR-KEY,
  8834           DFHEIV99,
  8835           DFHEIV11,
  8836           DFHEIV99,
  8837           DFHEIV99
  8838     SET ADDRESS OF CLAIM-MASTER TO
  8839         DFHEIV20
  8840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8841
  8842
  8843 0360-BROWSE-BACKWARD.
  8844
  8845
  8846* EXEC CICS READPREV
  8847*         DATASET    ('ELMSTR')
  8848*         RIDFLD     (ELMSTR-KEY)
  8849*         SET        (ADDRESS OF CLAIM-MASTER)
  8850*    END-EXEC.
  8851     MOVE 'ELMSTR' TO DFHEIV1
  8852     MOVE 0
  8853       TO DFHEIV11
  8854*    MOVE '&0S                   )   #00008705' TO DFHEIV0
  8855     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8856     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8857     MOVE X'2020233030303038373035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 169
* EL156.cbl
  8858     CALL 'kxdfhei1' USING DFHEIV0,
  8859           DFHEIV1,
  8860           DFHEIV20,
  8861           DFHEIV99,
  8862           ELMSTR-KEY,
  8863           DFHEIV99,
  8864           DFHEIV11,
  8865           DFHEIV99,
  8866           DFHEIV99
  8867     SET ADDRESS OF CLAIM-MASTER TO
  8868         DFHEIV20
  8869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8870
  8871
  8872     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8873        GO TO 0380-CLAIM-END-FILE.
  8874
  8875     IF PI-COMPANY-ID = 'CRI'
  8876         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8877            GO TO 0380-CLAIM-END-FILE.
  8878
  8879     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8880         GO TO 0360-BROWSE-BACKWARD.
  8881
  8882     IF PI-CARRIER-SECURITY > SPACES
  8883         IF CL-CARRIER = PI-CARRIER-SECURITY
  8884             NEXT SENTENCE
  8885         ELSE
  8886             GO TO 0360-BROWSE-BACKWARD.
  8887
  8888     IF PI-ACCOUNT-SECURITY > SPACES
  8889         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8890             NEXT SENTENCE
  8891         ELSE
  8892             GO TO 0360-BROWSE-BACKWARD.
  8893
  8894     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8895     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8896     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8897
  8898     GO TO 0400-FIRST-TIME.
  8899
  8900 0380-CLAIM-END-FILE.
  8901
  8902     MOVE ER-0130     TO EMI-ERROR.
  8903     MOVE -1          TO CLMNOL.
  8904     MOVE AL-UABON    TO CARRA
  8905                         CLMNOA
  8906                         CERTNOA
  8907                         SUFXA.
  8908
  8909     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8910
  8911     GO TO 8200-SEND-DATAONLY.
  8912
  8913 0400-FIRST-TIME.
  8914
  8915     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 170
* EL156.cbl
  8916        MOVE 'N'         TO WS-BROWSE-START-SW
  8917
  8918* EXEC CICS ENDBR
  8919*            DATASET    ('ELMSTR')
  8920*       END-EXEC.
  8921     MOVE 'ELMSTR' TO DFHEIV1
  8922     MOVE 0
  8923       TO DFHEIV11
  8924*    MOVE '&2                    $   #00008756' TO DFHEIV0
  8925     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8926     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8927     MOVE X'2020233030303038373536' TO DFHEIV0(25:11)
  8928     CALL 'kxdfhei1' USING DFHEIV0,
  8929           DFHEIV1,
  8930           DFHEIV11,
  8931           DFHEIV99
  8932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8933
  8934
  8935     IF PI-PROCESSOR-ID = 'LGXX'
  8936         NEXT SENTENCE
  8937     ELSE
  8938
  8939* EXEC CICS READQ TS
  8940*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8941*            INTO    (SECURITY-CONTROL)
  8942*            LENGTH  (SC-COMM-LENGTH)
  8943*            ITEM    (SC-ITEM)
  8944*        END-EXEC
  8945*    MOVE '*$II   L              ''   #00008763' TO DFHEIV0
  8946     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8947     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8948     MOVE X'2020233030303038373633' TO DFHEIV0(25:11)
  8949     CALL 'kxdfhei1' USING DFHEIV0,
  8950           PI-SECURITY-TEMP-STORE-ID,
  8951           SECURITY-CONTROL,
  8952           SC-COMM-LENGTH,
  8953           SC-ITEM,
  8954           DFHEIV99,
  8955           DFHEIV99
  8956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8957         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8958         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8959
  8960     MOVE LOW-VALUES             TO EL156AI.
  8961     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8962     MOVE 'Y'                    TO FIRST-ENTRY.
  8963     GO TO 7000-SHOW-CLAIM.
  8964
  8965 0500-CREATE-TEMP-STORAGE.
  8966     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8967
  8968
  8969* EXEC CICS WRITEQ TS
  8970*        QUEUE (QID)
  8971*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8972*        LENGTH(PI-COMM-LENGTH)
  8973*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 171
* EL156.cbl
  8974*    MOVE '*"     L              ''   #00008780' TO DFHEIV0
  8975     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8976     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8977     MOVE X'2020233030303038373830' TO DFHEIV0(25:11)
  8978     CALL 'kxdfhei1' USING DFHEIV0,
  8979           QID,
  8980           PROGRAM-INTERFACE-BLOCK,
  8981           PI-COMM-LENGTH,
  8982           DFHEIV99,
  8983           DFHEIV99,
  8984           DFHEIV99
  8985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8986
  8987
  8988
  8989* EXEC CICS WRITEQ TS
  8990*        QUEUE (QID)
  8991*        FROM  (EL156AI)
  8992*        LENGTH(MAP-LENGTH)
  8993*    END-EXEC.
  8994*    MOVE '*"     L              ''   #00008786' TO DFHEIV0
  8995     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8996     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8997     MOVE X'2020233030303038373836' TO DFHEIV0(25:11)
  8998     CALL 'kxdfhei1' USING DFHEIV0,
  8999           QID,
  9000           EL156AI,
  9001           MAP-LENGTH,
  9002           DFHEIV99,
  9003           DFHEIV99,
  9004           DFHEIV99
  9005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9006
  9007
  9008 0599-EXIT.
  9009      EXIT.
  9010
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 172
* EL156.cbl
  9012 0600-RECOVER-TEMP-STORAGE.
  9013
  9014* EXEC CICS READQ TS
  9015*        QUEUE (QID)
  9016*        INTO  (PROGRAM-INTERFACE-BLOCK)
  9017*        LENGTH(PI-COMM-LENGTH)
  9018*    END-EXEC.
  9019*    MOVE '*$I    L              ''   #00008797' TO DFHEIV0
  9020     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9021     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9022     MOVE X'2020233030303038373937' TO DFHEIV0(25:11)
  9023     CALL 'kxdfhei1' USING DFHEIV0,
  9024           QID,
  9025           PROGRAM-INTERFACE-BLOCK,
  9026           PI-COMM-LENGTH,
  9027           DFHEIV99,
  9028           DFHEIV99,
  9029           DFHEIV99
  9030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9031
  9032
  9033
  9034* EXEC CICS READQ TS
  9035*        QUEUE (QID)
  9036*        INTO  (EL156AI)
  9037*        LENGTH(MAP-LENGTH)
  9038*    END-EXEC.
  9039*    MOVE '*$I    L              ''   #00008803' TO DFHEIV0
  9040     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9041     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9042     MOVE X'2020233030303038383033' TO DFHEIV0(25:11)
  9043     CALL 'kxdfhei1' USING DFHEIV0,
  9044           QID,
  9045           EL156AI,
  9046           MAP-LENGTH,
  9047           DFHEIV99,
  9048           DFHEIV99,
  9049           DFHEIV99
  9050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9051
  9052
  9053     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  9054
  9055     IF PMTTYPEI NOT = LOW-VALUES
  9056         MOVE AL-UANON           TO PMTTYPEA.
  9057
  9058     IF PAYEEI NOT = LOW-VALUES
  9059         MOVE AL-UANON           TO PAYEEA.
  9060
  9061     IF NOTE1I NOT = LOW-VALUES
  9062         MOVE AL-UANON           TO NOTE1A.
  9063
  9064     IF (RETURNED-FROM = 'EL614')
  9065        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  9066     END-IF
  9067*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  9068*       AND (PI-EOB-CODES-EXIST = 'Y')
  9069*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 173
* EL156.cbl
  9070*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  9071     IF PI-SET-NOTE2-MDT = 'Y'
  9072         MOVE AL-SANON           TO NOTE2A
  9073     END-IF
  9074
  9075     IF OFFLINEI NOT = LOW-VALUES
  9076         MOVE AL-UANON           TO OFFLINEA.
  9077
  9078*    IF GROUPEDI NOT = LOW-VALUES
  9079*        MOVE AL-UANON           TO GROUPEDA.
  9080
  9081*    IF CASHI NOT = LOW-VALUES
  9082*        MOVE AL-UANON           TO CASHA.
  9083
  9084     IF CHECKNOI NOT = LOW-VALUES
  9085         MOVE AL-UANON           TO CHECKNOA.
  9086
  9087     IF HOLDTILI NOT = LOW-VALUES
  9088         MOVE AL-UANON           TO HOLDTILA.
  9089
  9090     IF EPYFROMI NOT = LOW-VALUES
  9091         MOVE AL-UANON           TO EPYFROMA.
  9092
  9093     IF AIGFROMI NOT = LOW-VALUES
  9094         MOVE AL-UANON           TO AIGFROMA.
  9095
  9096     IF EPYTHRUI NOT = LOW-VALUES
  9097         MOVE AL-UANON           TO EPYTHRUA.
  9098
  9099     IF EDAYSI NOT = LOW-VALUES
  9100         MOVE AL-UNNON           TO EDAYSA.
  9101
  9102     IF EPYAMTL NOT = +0
  9103         MOVE AL-UNNON           TO EPYAMTA.
  9104
  9105     IF ERESVL NOT = +0
  9106         MOVE AL-UNNON           TO ERESVA.
  9107
  9108     IF EEXPENSL NOT = +0
  9109         MOVE AL-UNNON           TO EEXPENSA.
  9110
  9111     IF ETYPEI NOT = LOW-VALUES
  9112         MOVE AL-UNNON           TO ETYPEA.
  9113
  9114     IF PROOFDTI NOT = 0
  9115         MOVE AL-UNNON           TO PROOFDTA.
  9116
  9117     IF EOBYNI = 'Y' OR 'N' OR 'S'
  9118        MOVE AL-UANON            TO EOBYNA
  9119     END-IF
  9120     IF CLMFMYNI = 'Y' OR 'N'
  9121        MOVE AL-UANON            TO CLMFMYNA
  9122     END-IF
  9123
  9124     IF SURVYYNI = 'Y' OR 'N'
  9125        IF PI-APPROVAL-LEVEL = '4' OR '5'
  9126           MOVE AL-UANON         TO SURVYYNA
  9127        END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 174
* EL156.cbl
  9128     END-IF
  9129
  9130     IF SPRELYNI = 'Y' OR 'N'
  9131        MOVE AL-UANON            TO SPRELYNA
  9132     END-IF
  9133
  9134     .
  9135 0699-EXIT.
  9136      EXIT.
  9137
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 175
* EL156.cbl
  9139 0700-TEST-FOR-CHANGES.
  9140     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  9141         MOVE ER-0433            TO EMI-ERROR
  9142         GO TO 0750-FUNCTION-ERROR.
  9143
  9144     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  9145
  9146     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  9147         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  9148         MOVE 'A'                TO PI-PASS-SW
  9149         GO TO 1000-EDIT-DATA.
  9150
  9151     IF PI-FATAL-COUNT NOT = 0
  9152         MOVE ER-0499            TO EMI-ERROR
  9153         GO TO 0750-FUNCTION-ERROR.
  9154
  9155     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  9156         MOVE ER-0500            TO EMI-ERROR
  9157         GO TO 0750-FUNCTION-ERROR.
  9158
  9159     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  9160        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  9161           MOVE ER-0542          TO EMI-ERROR
  9162           MOVE -1               TO EPYAMTL
  9163           GO TO 0750-FUNCTION-ERROR.
  9164
  9165     IF PI-OFFLINE = 'Y'  OR
  9166        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  9167        MOVE EIBAID              TO PI-PFKEY-USED
  9168        GO TO 5000-UPDATE.
  9169
  9170     GO TO 6000-BUILD-SCREEN-B.
  9171
  9172 0750-FUNCTION-ERROR.
  9173     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9174
  9175     IF ENTERPFL > 0
  9176         MOVE -1                 TO ENTERPFL
  9177         MOVE AL-UNBON           TO ENTERPFA
  9178         GO TO 8200-SEND-DATAONLY
  9179     ELSE
  9180         MOVE -1                 TO ENTERPFL
  9181         MOVE AL-UNNOF           TO ENTERPFA
  9182         GO TO 8200-SEND-DATAONLY.
  9183
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 176
* EL156.cbl
  9185 0800-DELETE-TS.
  9186
  9187* EXEC CICS HANDLE CONDITION
  9188*        QIDERR(0800-EXIT)
  9189*    END-EXEC.
  9190*    MOVE '"$N                   ! % #00008942' TO DFHEIV0
  9191     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9193     MOVE X'2520233030303038393432' TO DFHEIV0(25:11)
  9194     CALL 'kxdfhei1' USING DFHEIV0
  9195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9196
  9197
  9198
  9199* EXEC CICS DELETEQ TS
  9200*        QUEUE(QID)
  9201*    END-EXEC.
  9202*    MOVE '*&                    #   #00008946' TO DFHEIV0
  9203     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9204     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9205     MOVE X'2020233030303038393436' TO DFHEIV0(25:11)
  9206     CALL 'kxdfhei1' USING DFHEIV0,
  9207           QID,
  9208           DFHEIV99
  9209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9210
  9211
  9212 0800-EXIT.
  9213      EXIT.
  9214 0900-GET-DDF-LIMITS.
  9215
  9216     if cm-clp-state = zeros or spaces or low-values
  9217        move cm-state            to cm-clp-state
  9218     end-if
  9219     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9220     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9221     MOVE cm-clp-state           TO ERPDEF-STATE
  9222     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9223     evaluate true
  9224        when (cl-claim-type = 'L' or 'P')
  9225           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9226             and 'CU')
  9227           move 'L'              to erpdef-ben-type
  9228           move pi-lf-benefit-cd to erpdef-ben-code
  9229        when (cl-claim-type not = 'L' and 'P')
  9230           and (pi-ah-benefit-cd not = '00' and '  ')
  9231           move 'A'              to erpdef-ben-type
  9232           move pi-ah-benefit-cd to erpdef-ben-code
  9233        when (cl-claim-type not = 'L' and 'P')
  9234           and (pi-ah-benefit-cd = '00' or '  ')
  9235           move 'L'              to erpdef-ben-type
  9236           move pi-lf-benefit-cd to erpdef-ben-code
  9237        when (cl-claim-type = 'L' or 'P')
  9238           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9239           move 'A'              to erpdef-ben-type
  9240           move pi-ah-benefit-cd to erpdef-ben-code
  9241        when other
  9242           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 177
* EL156.cbl
  9243           move pi-ah-benefit-cd to erpdef-ben-code
  9244     end-evaluate
  9245*    if (cl-claim-type = 'L' or 'P')
  9246*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9247*          and 'CU')
  9248*       move 'L'                 to erpdef-ben-type
  9249*       move pi-lf-benefit-cd    to erpdef-ben-code
  9250*    else
  9251*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9252*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9253*    end-if
  9254     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9255
  9256     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9257
  9258
  9259* EXEC CICS STARTBR
  9260*        DATASET  ('ERPDEF')
  9261*        RIDFLD   (ERPDEF-KEY)
  9262*        GTEQ
  9263*        RESP     (WS-RESPONSE)
  9264*    END-EXEC
  9265     MOVE 'ERPDEF' TO DFHEIV1
  9266     MOVE 0
  9267       TO DFHEIV11
  9268*    MOVE '&,         G          &  N#00008996' TO DFHEIV0
  9269     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9270     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9271     MOVE X'204E233030303038393936' TO DFHEIV0(25:11)
  9272     CALL 'kxdfhei1' USING DFHEIV0,
  9273           DFHEIV1,
  9274           ERPDEF-KEY,
  9275           DFHEIV99,
  9276           DFHEIV11,
  9277           DFHEIV99
  9278     MOVE EIBRESP  TO WS-RESPONSE
  9279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9280
  9281     IF NOT WS-RESP-NORMAL
  9282        GO TO 0900-EXIT
  9283     END-IF
  9284
  9285     .
  9286 0900-READNEXT.
  9287
  9288
  9289* EXEC CICS READNEXT
  9290*       DATASET  ('ERPDEF')
  9291*       SET      (ADDRESS OF PRODUCT-MASTER)
  9292*       RIDFLD   (ERPDEF-KEY)
  9293*       RESP     (WS-RESPONSE)
  9294*    END-EXEC
  9295     MOVE 'ERPDEF' TO DFHEIV1
  9296     MOVE 0
  9297       TO DFHEIV11
  9298*    MOVE '&.S                   )  N#00009010' TO DFHEIV0
  9299     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9300     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 178
* EL156.cbl
  9301     MOVE X'204E233030303039303130' TO DFHEIV0(25:11)
  9302     CALL 'kxdfhei1' USING DFHEIV0,
  9303           DFHEIV1,
  9304           DFHEIV20,
  9305           DFHEIV99,
  9306           ERPDEF-KEY,
  9307           DFHEIV99,
  9308           DFHEIV11,
  9309           DFHEIV99,
  9310           DFHEIV99
  9311     SET ADDRESS OF PRODUCT-MASTER TO
  9312         DFHEIV20
  9313     MOVE EIBRESP  TO WS-RESPONSE
  9314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9315
  9316     IF NOT WS-RESP-NORMAL
  9317        GO TO 0900-ENDBR
  9318     END-IF
  9319
  9320     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9321        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9322           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9323        ELSE
  9324           GO TO 0900-READNEXT
  9325        END-IF
  9326     ELSE
  9327        GO TO 0900-ENDBR
  9328     END-IF
  9329
  9330     IF CM-LOAN-TERM = ZEROS
  9331        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9332     END-IF
  9333
  9334     .
  9335 0900-ENDBR.
  9336
  9337
  9338* EXEC CICS ENDBR
  9339*       DATASET  ('ERPDEF')
  9340*    END-EXEC
  9341     MOVE 'ERPDEF' TO DFHEIV1
  9342     MOVE 0
  9343       TO DFHEIV11
  9344*    MOVE '&2                    $   #00009038' TO DFHEIV0
  9345     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9346     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9347     MOVE X'2020233030303039303338' TO DFHEIV0(25:11)
  9348     CALL 'kxdfhei1' USING DFHEIV0,
  9349           DFHEIV1,
  9350           DFHEIV11,
  9351           DFHEIV99
  9352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9353
  9354     .
  9355 0900-EXIT.
  9356     EXIT.
  9357 1000-EDIT-DATA.
  9358
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 179
* EL156.cbl
  9359     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9360         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9361         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9362
  9363     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9364
  9365     IF NOT MODIFY-CAP
  9366         MOVE ER-0070            TO EMI-ERROR
  9367         MOVE -1                 TO PMTTYPEL
  9368         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9369         GO TO 2000-EDIT-DONE.
  9370
  9371     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9372                         '5' AND '6'
  9373         MOVE ER-0420            TO EMI-ERROR
  9374         MOVE -1                 TO PMTTYPEL
  9375         MOVE AL-UABON           TO PMTTYPEA
  9376         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9377     ELSE
  9378         MOVE AL-UANON           TO PMTTYPEA.
  9379
  9380*    IF PI-OFFLINE = 'Y'
  9381*       IF PI-GROUPED = 'Y'
  9382*          MOVE ER-1880         TO EMI-ERROR
  9383*          MOVE -1              TO GROUPEDL
  9384*          MOVE AL-UABON        TO GROUPEDA
  9385*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9386*
  9387*    IF GROUPEDL > +0
  9388*       IF PI-GROUPED = 'Y' OR 'N'
  9389*          MOVE AL-UANON TO GROUPEDA
  9390*       ELSE
  9391*          MOVE ER-3140            TO EMI-ERROR
  9392*          MOVE -1                 TO GROUPEDL
  9393*          MOVE AL-UABON           TO GROUPEDA
  9394*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9395*
  9396*    IF CASHL > +0
  9397*       IF PI-CASH = 'Y' OR 'N'
  9398*          MOVE AL-UANON           TO CASHA
  9399*       ELSE
  9400*          MOVE ER-3141            TO EMI-ERROR
  9401*          MOVE -1                 TO CASHL
  9402*          MOVE AL-UABON           TO CASHA
  9403*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9404
  9405     IF LOANNOL > +0
  9406         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9407
  9408 1000-EDIT-PAYEE.
  9409
  9410     IF PI-PAYEE-SEQ NOT NUMERIC
  9411         MOVE ER-0294            TO  EMI-ERROR
  9412         MOVE -1                 TO  PAYEEL
  9413         MOVE AL-UABON           TO  PAYEEA
  9414         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9415         GO TO 1000-CONT-EDIT.
  9416
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 180
* EL156.cbl
  9417     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9418                         'E' OR 'O' OR 'Q'
  9419         NEXT SENTENCE
  9420     ELSE
  9421         MOVE ER-0294            TO  EMI-ERROR
  9422         MOVE -1                 TO  PAYEEL
  9423         MOVE AL-UABON           TO  PAYEEA
  9424         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9425         GO TO 1000-CONT-EDIT.
  9426
  9427     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9428        (PI-PAYEE-SEQ NOT < '1' AND
  9429         PI-PAYEE-SEQ NOT > '9'))
  9430      OR
  9431        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9432         (PI-PAYEE-SEQ NOT > '9'))
  9433         MOVE AL-UANON            TO PAYEEA
  9434     ELSE
  9435         MOVE ER-0294            TO EMI-ERROR
  9436         MOVE -1                 TO PAYEEL
  9437         MOVE AL-UABON           TO PAYEEA
  9438         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9439
  9440     IF PI-COMPANY-ID = 'DMD'
  9441         IF PI-PAYEE-TYPE = 'B' AND
  9442            PI-PAYEE-SEQ NOT = '0'
  9443               MOVE ER-7841            TO EMI-ERROR
  9444               MOVE -1                 TO PAYEEL
  9445               MOVE AL-UABON           TO PAYEEA
  9446               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9447
  9448     IF PI-COMPANY-ID = 'JHL'
  9449         IF PI-PAYEE = 'B0'
  9450             NEXT SENTENCE
  9451           ELSE
  9452
  9453* EXEC CICS HANDLE CONDITION
  9454*            ENDFILE(1950-NOT-FOUND)
  9455*            NOTFND (1950-NOT-FOUND)
  9456*        END-EXEC
  9457*    MOVE '"$''I                  ! & #00009140' TO DFHEIV0
  9458     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9459     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9460     MOVE X'2620233030303039313430' TO DFHEIV0(25:11)
  9461     CALL 'kxdfhei1' USING DFHEIV0
  9462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9463         MOVE 'N'                    TO FOUND-TOL-SW
  9464         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9465         MOVE '2'                    TO CNTL-REC-TYPE
  9466         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9467         MOVE +0                     TO CNTL-SEQ-NO
  9468         MOVE 'PROC'                 TO FILE-SWITCH
  9469         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9470         IF PI-PAYEE = 'I1' AND
  9471            APPROVAL-LEVEL-2
  9472             NEXT SENTENCE
  9473           ELSE
  9474         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 181
* EL156.cbl
  9475             MOVE ER-3546        TO EMI-ERROR
  9476             MOVE -1             TO PAYEEL
  9477             MOVE AL-UABON       TO PAYEEA
  9478             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9479
  9480     IF PI-PAYEE-TYPE = 'E'
  9481        IF PI-PMTTYPE = '5' OR '6'
  9482            NEXT SENTENCE
  9483        ELSE
  9484            MOVE ER-3539            TO EMI-ERROR
  9485            MOVE -1                 TO PAYEEL
  9486            MOVE AL-UABON           TO PAYEEA
  9487            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9488
  9489 1000-CONT-EDIT.
  9490
  9491     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9492        IF PI-EPYAMT NOT NEGATIVE
  9493            MOVE ER-0421         TO EMI-ERROR
  9494            MOVE -1              TO OFFLINEL
  9495            MOVE AL-UABON        TO OFFLINEA
  9496            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9497        ELSE
  9498            MOVE AL-UANON        TO OFFLINEA.
  9499
  9500     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  9501        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9502           CONTINUE
  9503        ELSE
  9504           IF PI-PRINT-EOB-YN = 'S' AND
  9505              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
  9506                CONTINUE
  9507           ELSE
  9508              MOVE ER-1561       TO EMI-ERROR
  9509              MOVE -1            TO EOBYNL
  9510              MOVE AL-UABON      TO EOBYNA
  9511              PERFORM 9900-ERROR-FORMAT
  9512                                 THRU 9900-EXIT
  9513           END-IF
  9514        END-IF
  9515
  9516        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9517            MOVE ER-1566        TO EMI-ERROR
  9518            MOVE -1             TO CLMFMYNL
  9519            MOVE AL-UABON       TO CLMFMYNA
  9520            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9521        END-IF
  9522
  9523        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9524            MOVE ER-1567        TO EMI-ERROR
  9525            MOVE -1             TO SURVYYNL
  9526            MOVE AL-UABON       TO SURVYYNA
  9527            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9528        END-IF
  9529
  9530        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9531            MOVE ER-1569        TO EMI-ERROR
  9532            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 182
* EL156.cbl
  9533            MOVE AL-UABON       TO SPRELYNA
  9534            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9535        END-IF
  9536
  9537     END-IF
  9538     IF PI-EPYAMT IS NEGATIVE
  9539         IF PI-OFFLINE NOT = 'Y'
  9540             MOVE ER-0836        TO  EMI-ERROR
  9541             MOVE -1             TO  OFFLINEL
  9542             MOVE AL-UABON       TO  OFFLINEA
  9543             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9544
  9545     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9546        MOVE ER-0872             TO EMI-ERROR
  9547        MOVE -1                  TO PROOFDTL
  9548        MOVE AL-UABON            TO PROOFDTA
  9549        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9550     ELSE
  9551        MOVE '4'                TO DC-OPTION-CODE
  9552        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9553        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9554        IF DATE-CONVERSION-ERROR
  9555            MOVE ER-0873        TO EMI-ERROR
  9556            MOVE -1                  TO PROOFDTL
  9557            MOVE AL-UABON            TO PROOFDTA
  9558            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9559        ELSE
  9560            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9561            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9562                MOVE ER-0873    TO EMI-ERROR
  9563                MOVE -1                  TO PROOFDTL
  9564                MOVE AL-UABON            TO PROOFDTA
  9565                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9566            END-IF
  9567        END-IF
  9568     END-IF.
  9569
  9570     IF PI-COMPANY-ID = 'DMD'
  9571        IF NOTE1L NOT = ZEROS
  9572            MOVE ER-7844        TO  EMI-ERROR
  9573            MOVE -1             TO  NOTE1L
  9574            MOVE AL-UABON       TO  NOTE1A
  9575            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9576
  9577     IF PI-COMPANY-ID = 'DMD'
  9578        IF NOTE2L NOT = ZEROS
  9579          GO TO 1004-DMD-EOB-CHECKS.
  9580
  9581     IF NOTE1L NOT > +0
  9582         GO TO 1005-CHECK-ERRORS.
  9583
  9584     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9585         GO TO 1005-CHECK-ERRORS.
  9586
  9587     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9588         GO TO 1003-HAN-PMT-NOTES.
  9589
  9590     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 183
* EL156.cbl
  9591
  9592     IF WS-PMTOPTION NUMERIC
  9593        IF WS-PMTOPTION > '00' AND < '17'
  9594           NEXT SENTENCE
  9595        ELSE
  9596           MOVE ER-0618          TO EMI-ERROR
  9597           MOVE -1               TO NOTE1L
  9598           MOVE AL-UABON         TO NOTE1A
  9599           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9600     ELSE
  9601        GO TO 1005-CHECK-ERRORS.
  9602
  9603     IF WS-PMTOPTION = '05' AND
  9604        WS-DOCNAME = SPACES
  9605          MOVE ER-0616             TO EMI-ERROR
  9606          MOVE -1                  TO NOTE1L
  9607          MOVE AL-UABON            TO NOTE1A
  9608          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9609
  9610     IF WS-PMTOPTION = '15' OR '16'
  9611
  9612* EXEC CICS BIF DEEDIT
  9613*            FIELD (WS-AMOUNT)
  9614*            LENGTH(08)
  9615*        END-EXEC
  9616     MOVE 08
  9617       TO DFHEIV11
  9618*    MOVE '@"L                   #   #00009292' TO DFHEIV0
  9619     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9620     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9621     MOVE X'2020233030303039323932' TO DFHEIV0(25:11)
  9622     CALL 'kxdfhei1' USING DFHEIV0,
  9623           WS-AMOUNT,
  9624           DFHEIV11
  9625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9626        IF (WS-NUM-AMT = ZEROS) OR
  9627           (WS-AMOUNT NOT NUMERIC)
  9628           MOVE ER-0617          TO EMI-ERROR
  9629           MOVE -1               TO NOTE1L
  9630           MOVE AL-UABON         TO NOTE1A
  9631           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9632
  9633     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9634
  9635     GO TO 1005-CHECK-ERRORS.
  9636
  9637 1003-HAN-PMT-NOTES.
  9638
  9639     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9640
  9641     IF WS-HAN-PMT-CODE = SPACE
  9642         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9643     ELSE
  9644     IF WS-HAN-PMT-CODE = 'A'
  9645         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9646                                 TO WS-HAN-PMT-NOTE
  9647     ELSE
  9648     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 184
* EL156.cbl
  9649         MOVE ':FINAL PAYMENT / DECEASED'
  9650                                 TO WS-HAN-PMT-NOTE
  9651     ELSE
  9652     IF WS-HAN-PMT-CODE = 'C'
  9653         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9654                                 TO WS-HAN-PMT-NOTE
  9655     ELSE
  9656     IF WS-HAN-PMT-CODE = 'D'
  9657         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9658                                 TO WS-HAN-PMT-NOTE
  9659     ELSE
  9660     IF WS-HAN-PMT-CODE = 'E'
  9661         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9662                                 TO WS-HAN-PMT-NOTE
  9663     ELSE
  9664     IF WS-HAN-PMT-CODE = 'F'
  9665         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9666                                 TO WS-HAN-PMT-NOTE
  9667     ELSE
  9668     IF WS-HAN-PMT-CODE = 'P'
  9669         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9670
  9671     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9672     GO TO 1005-CHECK-ERRORS.
  9673
  9674 1004-DMD-EOB-CHECKS.
  9675
  9676     INITIALIZE PI-AT-EOB-CODES.
  9677
  9678     IF NOTE2I (20:21) > SPACES
  9679         MOVE ER-7845          TO EMI-ERROR
  9680         MOVE -1               TO NOTE2L
  9681         MOVE AL-UABON         TO NOTE2A
  9682         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9683         GO TO 1005-CHECK-ERRORS
  9684      ELSE
  9685         MOVE NOTE2I             TO W-EOB-CODES.
  9686
  9687     MOVE +1                     TO W-EOB-NDX.
  9688
  9689 1004-CHECK-EACH-EOB.
  9690
  9691     IF W-EOB-NDX > +5
  9692             OR
  9693        W-EOB-CODE (W-EOB-NDX) = SPACES
  9694         GO TO 1004-CHECK-DUP-EOB.
  9695
  9696     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9697         MOVE ER-0956            TO EMI-ERROR
  9698         MOVE -1                 TO NOTE2L
  9699         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9700         GO TO 1005-CHECK-ERRORS.
  9701
  9702     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9703     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9704     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9705     MOVE 'DLO023'               TO PGM-NAME.
  9706
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 185
* EL156.cbl
  9707
  9708* EXEC CICS LINK
  9709*        PROGRAM    (PGM-NAME)
  9710*        COMMAREA   (CD-COMMUNICATION-AREA)
  9711*        LENGTH     (CD-RCRD-LENGTH)
  9712*    END-EXEC.
  9713*    MOVE '."C                   (   #00009377' TO DFHEIV0
  9714     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9715     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9716     MOVE X'2020233030303039333737' TO DFHEIV0(25:11)
  9717     CALL 'kxdfhei1' USING DFHEIV0,
  9718           PGM-NAME,
  9719           CD-COMMUNICATION-AREA,
  9720           CD-RCRD-LENGTH,
  9721           DFHEIV99,
  9722           DFHEIV99,
  9723           DFHEIV99,
  9724           DFHEIV99
  9725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9726
  9727
  9728     IF CD-RETURN-CODE = 'OK'
  9729         GO TO 1004-CONT.
  9730
  9731     MOVE -1                     TO NOTE2L.
  9732
  9733     IF CD-RETURN-CODE = '01'
  9734         MOVE ER-8310            TO EMI-ERROR
  9735         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9736         GO TO 1005-CHECK-ERRORS.
  9737
  9738     IF CD-RETURN-CODE = '02'
  9739         MOVE ER-8311            TO EMI-ERROR
  9740         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9741         GO TO 1005-CHECK-ERRORS.
  9742
  9743     IF CD-RETURN-CODE = '03'
  9744         MOVE ER-8312            TO EMI-ERROR
  9745         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9746         GO TO 1005-CHECK-ERRORS.
  9747
  9748     IF CD-RETURN-CODE = '04'
  9749         MOVE ER-8313            TO EMI-ERROR
  9750         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9751         GO TO 1005-CHECK-ERRORS.
  9752
  9753     IF CD-RETURN-CODE = '05'
  9754         MOVE ER-8314            TO EMI-ERROR
  9755         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9756         GO TO 1005-CHECK-ERRORS.
  9757
  9758     IF CD-RETURN-CODE = '06'
  9759         MOVE ER-8315            TO EMI-ERROR
  9760         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9761         GO TO 1005-CHECK-ERRORS.
  9762
  9763     IF CD-RETURN-CODE = 'E1'
  9764         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 186
* EL156.cbl
  9765         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9766         GO TO 1005-CHECK-ERRORS.
  9767
  9768     IF CD-RETURN-CODE = 'N1'
  9769         MOVE ER-8317            TO EMI-ERROR
  9770         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9771         GO TO 1005-CHECK-ERRORS.
  9772
  9773 1004-CONT.
  9774     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9775
  9776     ADD +1 TO W-EOB-NDX.
  9777     GO TO 1004-CHECK-EACH-EOB.
  9778
  9779 1004-CHECK-DUP-EOB.
  9780     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9781         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9782                               PI-AT-EOB-CODE (3) OR
  9783                               PI-AT-EOB-CODE (4) OR
  9784                               PI-AT-EOB-CODE (5)))
  9785                  OR
  9786        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9787         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9788                               PI-AT-EOB-CODE (4) OR
  9789                               PI-AT-EOB-CODE (5)))
  9790                  OR
  9791        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9792         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9793                               PI-AT-EOB-CODE (5)))
  9794                  OR
  9795        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9796         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9797            MOVE ER-8000            TO EMI-ERROR
  9798            MOVE AL-UABON           TO NOTE2A
  9799            MOVE -1                 TO NOTE2L
  9800            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9801            GO TO 1005-CHECK-ERRORS.
  9802
  9803 1005-CHECK-ERRORS.
  9804*    IF PI-COMPANY-ID NOT = 'DMD'
  9805        GO TO 1006-CHECK-ERRORS.
  9806
  9807*********  DMD CODE START ******************
  9808*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9809*       GO TO 1006-CHECK-ERRORS.
  9810*
  9811*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9812*
  9813*    COMPUTE W-PAYMENT-TOTAL
  9814*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9815*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9816*               AND
  9817*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9818*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9819*          MOVE ER-0967    TO EMI-ERROR
  9820*          MOVE -1         TO PMTTYPEL
  9821*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9822*
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 187
* EL156.cbl
  9823*    GO TO 1006-CHECK-ERRORS.
  9824*********  DMD CODE END ******************
  9825
  9826 1006-CHECK-ERRORS.
  9827     if emi-forcable-ctr = zeros
  9828        and emi-fatal-ctr = zeros
  9829        continue
  9830     else
  9831        IF NOT EMI-NO-ERRORS
  9832           GO TO 2000-EDIT-DONE
  9833        end-if
  9834     end-if
  9835
  9836* EXEC CICS HANDLE CONDITION
  9837*        NOTFND(1950-NOT-FOUND)
  9838*    END-EXEC.
  9839*    MOVE '"$I                   ! '' #00009490' TO DFHEIV0
  9840     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9841     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9842     MOVE X'2720233030303039343930' TO DFHEIV0(25:11)
  9843     CALL 'kxdfhei1' USING DFHEIV0
  9844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9845
  9846
  9847     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9848     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9849     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9850     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9851     MOVE 'MSTR'                 TO FILE-SWITCH.
  9852
  9853     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9854
  9855     IF PI-COMPANY-ID = 'DMD'
  9856         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9857
  9858     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9859        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9860           MOVE ER-0873    TO EMI-ERROR
  9861           MOVE -1                  TO PROOFDTL
  9862           MOVE AL-UABON            TO PROOFDTA
  9863           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9864        END-IF
  9865     END-IF
  9866     if cl-benefit-period = zeros
  9867        move er-1667             to emi-error
  9868        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9869     end-if
  9870     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9871     MOVE +95                    TO TRLR-SEQ-NO
  9872
  9873* EXEC CICS READ
  9874*       DATASET  ('ELTRLR')
  9875*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9876*       RIDFLD   (ELTRLR-KEY)
  9877*       RESP     (WS-RESPONSE)
  9878*    END-EXEC
  9879     MOVE 'ELTRLR' TO DFHEIV1
  9880*    MOVE '&"S        E          (  N#00009519' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 188
* EL156.cbl
  9881     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9882     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9883     MOVE X'204E233030303039353139' TO DFHEIV0(25:11)
  9884     CALL 'kxdfhei1' USING DFHEIV0,
  9885           DFHEIV1,
  9886           DFHEIV20,
  9887           DFHEIV99,
  9888           ELTRLR-KEY,
  9889           DFHEIV99,
  9890           DFHEIV99,
  9891           DFHEIV99
  9892     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9893         DFHEIV20
  9894     MOVE EIBRESP  TO WS-RESPONSE
  9895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9896
  9897     if ws-resp-normal
  9898        perform varying s1 from +1 by +1 until
  9899           at-note-error-no (s1) = spaces
  9900           if at-note-error-no (s1) = '1662'
  9901              continue
  9902           else
  9903              move at-note-error-no (s1)
  9904                                 to emi-error
  9905              if at-note-error-no (s1) = '1653'
  9906                 evaluate true
  9907                    when cl-claim-type = 'L'
  9908                       move '  LF  '
  9909                                 to emi-claim-type
  9910                    when cl-claim-type = 'I'
  9911                       move '  IU  '
  9912                                 to emi-claim-type
  9913                    when cl-claim-type = 'A'
  9914                       move '  AH  '
  9915                                 to emi-claim-type
  9916                    when cl-claim-type = 'O'
  9917                       move '  OT  '
  9918                                 to emi-claim-type
  9919                    when other
  9920                       move ' FMLA '
  9921                                 to emi-claim-type
  9922                 end-evaluate
  9923              end-if
  9924              PERFORM 9900-ERROR-FORMAT
  9925                                 THRU 9900-EXIT
  9926           end-if
  9927        end-perform
  9928     end-if
  9929     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9930         IF PI-PMTTYPE = '5' OR '6'
  9931             NEXT SENTENCE
  9932         ELSE
  9933             MOVE ER-0555             TO EMI-ERROR
  9934             MOVE -1                  TO PMTTYPEL
  9935             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9936
  9937     IF CL-LAST-CLOSE-REASON = '2'
  9938         IF CL-CLAIM-STATUS = 'C'
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 189
* EL156.cbl
  9939             MOVE ER-0760        TO  EMI-ERROR
  9940             MOVE -1             TO  PMTTYPEL
  9941             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9942
  9943     IF PI-ACTIVITY-CODE = 9
  9944         MOVE ER-3538            TO  EMI-ERROR
  9945         MOVE -1                 TO  PMTTYPEL
  9946         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9947
  9948     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9949         GO TO 1008-READ-CERT.
  9950**********************AIG LOGIC STARTS *********************
  9951     IF CL-CERT-PRIME = 'INCOMPLETE'
  9952         MOVE ER-3540            TO  EMI-ERROR
  9953         MOVE -1                 TO  PMTTYPEL
  9954         MOVE AL-UABON           TO  PMTTYPEA
  9955         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9956         GO TO 2000-EDIT-DONE.
  9957
  9958     IF PI-PMTTYPE = '4'
  9959         IF PI-EPYAMT IS NEGATIVE
  9960             IF PI-ECHECKNO-CR = 'CR'
  9961                 NEXT SENTENCE
  9962             ELSE
  9963                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9964
  9965     IF PI-PMTTYPE = '4'
  9966         IF PI-ECHECKNO-CR = 'CR'
  9967             IF PI-EPYAMT IS NEGATIVE
  9968                 NEXT SENTENCE
  9969             ELSE
  9970                 MOVE ER-0834    TO  EMI-ERROR
  9971                 MOVE -1         TO  EPYAMTL
  9972                 MOVE AL-UNBON   TO  EPYAMTA
  9973                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9974
  9975     IF PI-PMTTYPE = '4'
  9976         IF PI-EPYAMT IS NEGATIVE
  9977             IF PI-OFFLINE = 'Y'
  9978                 NEXT SENTENCE
  9979             ELSE
  9980                 MOVE 'Y'        TO  PI-OFFLINE
  9981                                     WS-OFFLINE
  9982                                     OFFLINEO
  9983                 MOVE AL-UANON   TO  OFFLINEA.
  9984
  9985*    IF PI-PMTTYPE = '4'
  9986*        IF PI-EPYAMT IS NEGATIVE
  9987*            IF PI-CASH = 'Y'
  9988*                NEXT SENTENCE
  9989*            ELSE
  9990*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9991*                MOVE AL-UANON   TO  CASHA
  9992*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9993*
  9994*    IF PI-CASH NOT = 'Y' AND 'N'
  9995*         IF PI-OFFLINE = 'Y'  AND
  9996*            PI-ECHECKNO-CR = 'CR'
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 190
* EL156.cbl
  9997*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9998*              MOVE AL-UANON     TO  CASHA
  9999*              GO TO 1007-DEFAULT-AIG-CHECKNO.
 10000*
 10001*    IF PI-CASH NOT = 'Y' AND 'N'
 10002*        IF PI-PMTTYPE = '5' OR '6'
 10003*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
 10004*            MOVE AL-UANON       TO  CASHA
 10005*            GO TO 1007-DEFAULT-AIG-CHECKNO.
 10006*
 10007*    IF PI-CASH NOT = 'Y' AND 'N'
 10008*       IF CL-ASSOCIATES = 'N' OR 'A'
 10009*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
 10010*           MOVE AL-UANON        TO  CASHA
 10011*       ELSE
 10012*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
 10013*           MOVE AL-UANON        TO  CASHA.
 10014*
 10015*    IF PI-PMTTYPE = '5' OR '6'
 10016*        IF PI-CASH = 'N'
 10017*            MOVE ER-0819        TO  EMI-ERROR
 10018*            MOVE AL-UANON       TO  CASHA
 10019*            MOVE -1             TO  CASHL
 10020*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10021*
 10022*    IF CL-ASSOCIATES = 'N' OR 'A'
 10023*       IF CASHI = 'N'
 10024*        MOVE ER-3537            TO  EMI-ERROR
 10025*        MOVE AL-UANON           TO  CASHA
 10026*        MOVE -1                 TO  CASHL
 10027*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10028
 10029 1007-DEFAULT-AIG-CHECKNO.
 10030
 10031     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
 10032         MOVE ER-3532            TO  EMI-ERROR
 10033         MOVE -1                 TO  PMTTYPEL
 10034         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10035**********************AIG LOGIC ENDS ***********************
 10036
 10037 1008-READ-CERT.
 10038
 10039     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 10040     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 10041     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 10042     MOVE CL-CERT-STATE          TO CERT-STATE.
 10043     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 10044     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 10045     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 10046     MOVE 'CERT'                 TO FILE-SWITCH.
 10047
 10048     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 10049
 10050     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10051        MOVE CM-LF-LOAN-EXPIRE-DT
 10052                                 TO WS-EXP-DT PI-EXP-DT
 10053                                    ws-extended-exp-dt
 10054     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 191
* EL156.cbl
 10055        MOVE CM-AH-LOAN-EXPIRE-DT
 10056                                 TO WS-EXP-DT PI-EXP-DT
 10057                                    ws-extended-exp-dt
 10058     end-if
 10059     MOVE '6'           TO DC-OPTION-CODE
 10060     if pi-dcc-product-code not = spaces
 10061        move cm-ah-benefit-cd    to pi-ah-benefit-cd
 10062        move cm-lf-benefit-cd    to pi-lf-benefit-cd
 10063        PERFORM 0900-GET-DDF-limits
 10064                                 THRU 0900-EXIT
 10065        IF PDEF-FOUND
 10066         AND CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 10067           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10068              (P1 > +8)
 10069              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 10070           END-PERFORM
 10071           IF P1 < +9
 10072              MOVE '6'           TO DC-OPTION-CODE
 10073              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10074              IF CL-NO-OF-EXTENSIONS NUMERIC
 10075               display ' 156 - no of ext ' CL-NO-OF-EXTENSIONS
 10076                 MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10077                                             PI-MAX-EXT
 10078              ELSE
 10079                 MOVE PD-MAX-EXTENSION (P1)
 10080                                 TO DC-ELAPSED-MONTHS
 10081              END-IF
 10082              PERFORM 9700-LINK-DATE-CONVERT
 10083                                 THRU 9700-EXIT
 10084              if no-conversion-error
 10085                 move dc-bin-date-2 to ws-extended-exp-dt
 10086              end-if
 10087           else
 10088              move er-1674       to emi-error
 10089              PERFORM 9900-ERROR-FORMAT
 10090                                 THRU 9900-EXIT
 10091           end-if
 10092        ELSE
 10093           IF CL-NO-OF-EXTENSIONS NUMERIC
 10094              MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10095                                          PI-MAX-EXT
 10096           ELSE
 10097              MOVE ZERO  TO DC-ELAPSED-MONTHS
 10098           END-IF
 10099           MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10100           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10101           if no-conversion-error
 10102              move dc-bin-date-2 to ws-extended-exp-dt
 10103           end-if
 10104        end-if
 10105     ELSE
 10106        IF CL-NO-OF-EXTENSIONS NUMERIC
 10107           MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10108                                       PI-MAX-EXT
 10109        ELSE
 10110           MOVE ZERO  TO DC-ELAPSED-MONTHS
 10111        END-IF
 10112        MOVE WS-EXP-DT     TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 192
* EL156.cbl
 10113        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10114        if no-conversion-error
 10115           move dc-bin-date-2 to ws-extended-exp-dt
 10116        end-if
 10117     end-if
 10118*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10119*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
 10120
 10121     IF CL-INCURRED-DT < CM-CERT-EFF-DT
 10122         MOVE ER-0458            TO EMI-ERROR
 10123         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10124
 10125     IF (CL-INCURRED-DT > WS-EXP-DT)
 10126        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
 10127        MOVE ER-1677             TO EMI-ERROR
 10128        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
 10129     END-IF
 10130     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
 10131     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
 10132         MOVE ER-0459            TO EMI-ERROR
 10133         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10134
 10135     IF CL-REPORTED-DT = LOW-VALUES
 10136        MOVE ER-0530             TO EMI-ERROR
 10137        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10138
 10139     IF PI-COMPANY-ID = 'NCL'
 10140        IF CM-CREDIT-INTERFACE-SW-1 = '2'
 10141            MOVE ER-0770            TO EMI-ERROR
 10142            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10143
 10144     IF PI-COMPANY-ID = 'NCL'
 10145        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
 10146            MOVE ER-0737            TO EMI-ERROR
 10147            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10148
 10149     IF CM-ENTRY-STATUS = 'D' OR 'V'
 10150         MOVE ER-0768            TO  EMI-ERROR
 10151         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10152
 10153     IF CM-CREDIT-INTERFACE-SW-1 = '4'
 10154         MOVE ER-0769            TO  EMI-ERROR
 10155         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10156
 10157     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10158         GO TO 1020-DO-LIFE-EDITS
 10159     ELSE
 10160         GO TO 1030-DO-AH-EDITS.
 10161
 10162 1010-GENERAL-ERROR.
 10163     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10164
 10165     IF EMI-MESSAGE-FORMATTED
 10166         MOVE -1                 TO PMTTYPEL.
 10167
 10168 1010-EXIT.
 10169     EXIT.
 10170
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 193
* EL156.cbl
 10172 1020-DO-LIFE-EDITS.
 10173     IF CM-LF-BENEFIT-CD = '00'
 10174         IF PI-PMTTYPE = '5' OR '6'
 10175             MOVE ER-0658        TO EMI-ERROR
 10176             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10177         ELSE
 10178            if (pi-company-id = 'DCC' or 'VPP')
 10179               and (pi-dcc-product-code not = spaces)
 10180               continue
 10181            else
 10182               MOVE ER-1775      TO EMI-ERROR
 10183               PERFORM 1040-PMTTYPE-ERROR
 10184                                 THRU 1040-EXIT
 10185            end-if
 10186         end-if
 10187     end-if
 10188
 10189     move cm-ah-benefit-cd to pi-ah-benefit-cd
 10190     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10191         MOVE ER-0460            TO EMI-ERROR
 10192         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10193
 10194     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
 10195     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
 10196     MOVE WS-ACCESS              TO  CNTL-ACCESS.
 10197     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 10198     MOVE '4'                    TO  CNTL-REC-TYPE.
 10199     MOVE ZEROS                  TO  CNTL-SEQ-NO.
 10200     MOVE 'BENE'                 TO  FILE-SWITCH.
 10201     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10202     IF NO-BENEFIT-FOUND
 10203         GO TO 1950-NOT-FOUND.
 10204
 10205     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
 10206
 10207     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
 10208       AND NOT CM-LF-LUMP-SUM-DISAB
 10209         IF PI-PMTTYPE = '4'
 10210             IF (PI-LIFE-OVERRIDE-L1 = 'P' OR
 10211                PI-LF-COVERAGE-TYPE = 'P')
 10212               AND NOT CM-LF-LUMP-SUM-DISAB
 10213                 NEXT SENTENCE
 10214             ELSE
 10215                 MOVE ER-0461        TO EMI-ERROR
 10216                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10217         ELSE
 10218            NEXT SENTENCE
 10219     ELSE
 10220         IF PI-PMTTYPE = '2'
 10221            IF NOT CM-O-B-COVERAGE
 10222              AND CM-LF-CURRENT-STATUS = '7'
 10223                MOVE ER-0462     TO EMI-ERROR
 10224                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10225
 10226     IF PI-PMTTYPE = '2'
 10227         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10228            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10229             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 194
* EL156.cbl
 10230             MOVE ER-0730            TO  EMI-ERROR
 10231             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10232             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10233
 10234     IF PI-PMTTYPE = '2'
 10235         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10236            PI-LF-COVERAGE-TYPE = 'P'
 10237             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10238                 MOVE ER-0462    TO  EMI-ERROR
 10239                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10240
 10241     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10242       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10243         MOVE ER-0466            TO EMI-ERROR
 10244         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10245
 10246     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10247         IF PI-PMTTYPE = '3'
 10248             MOVE 0436           TO EMI-ERROR
 10249             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10250             GO TO 1045-EDIT-PAYEE-ADDR
 10251         ELSE
 10252             GO TO 1045-EDIT-PAYEE-ADDR.
 10253
 10254     IF CL-CLAIM-TYPE = 'O'
 10255         IF PI-PMTTYPE = '1' OR '2'
 10256             MOVE ER-1930          TO EMI-ERROR
 10257             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10258         END-IF
 10259     ELSE
 10260     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10261        PI-LF-COVERAGE-TYPE = 'P'
 10262         IF PI-PMTTYPE = '3'
 10263             MOVE ER-0436          TO  EMI-ERROR
 10264             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10265         ELSE
 10266             NEXT SENTENCE
 10267     ELSE
 10268         IF PI-PMTTYPE = '1' OR '3'
 10269             MOVE ER-0436            TO EMI-ERROR
 10270             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10271*
 10272     IF PI-COMPANY-ID = 'CID' AND
 10273        CL-CERT-STATE = 'SC'  AND
 10274        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10275           MOVE ER-0879    TO  EMI-ERROR
 10276           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10277           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10278     END-IF.
 10279     IF PI-COMPANY-ID = 'AHL'
 10280        evaluate true
 10281           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10282              MOVE ER-0879       TO  EMI-ERROR
 10283              PERFORM 1040-PMTTYPE-ERROR
 10284                                 THRU 1040-EXIT
 10285              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10286           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10287                 '6D' OR '6H' OR '6R'
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 195
* EL156.cbl
 10288              MOVE ER-0879       TO  EMI-ERROR
 10289              PERFORM 1040-PMTTYPE-ERROR
 10290                                 THRU 1040-EXIT
 10291              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10292           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10293              MOVE ER-0879       TO  EMI-ERROR
 10294              PERFORM 1040-PMTTYPE-ERROR
 10295                                 THRU 1040-EXIT
 10296              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10297        end-evaluate
 10298     END-IF
 10299     GO TO 1045-EDIT-PAYEE-ADDR.
 10300
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 196
* EL156.cbl
 10302 1030-DO-AH-EDITS.
 10303     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10304     IF CM-AH-BENEFIT-CD = '00'
 10305         IF PI-PMTTYPE = '5' OR '6'
 10306             MOVE ER-0658        TO EMI-ERROR
 10307             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10308         ELSE
 10309             MOVE ER-1775        TO EMI-ERROR
 10310             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10311
 10312     IF CL-TOTAL-PAID-AMT = ZEROS
 10313         IF PI-PMTTYPE = '4'
 10314             MOVE ER-0438        TO EMI-ERROR
 10315             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10316
 10317     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10318         IF PI-PMTTYPE = '3'
 10319             MOVE ER-0463        TO EMI-ERROR
 10320             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10321         ELSE
 10322             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10323              AND CM-LF-CURRENT-STATUS = '7'
 10324                 MOVE ER-0465    TO EMI-ERROR
 10325                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10326
 10327     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10328         IF PI-PMTTYPE = '3'
 10329             MOVE ER-0464        TO EMI-ERROR
 10330             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10331         ELSE
 10332             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10333                 MOVE ER-0469    TO EMI-ERROR
 10334                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10335
 10336     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10337         IF PI-PMTTYPE = '3'
 10338             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10339                 MOVE ER-0467    TO EMI-ERROR
 10340                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10341             ELSE
 10342                 NEXT SENTENCE
 10343         ELSE
 10344             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10345                 MOVE ER-0468    TO EMI-ERROR
 10346                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10347
 10348     IF PI-PMTTYPE = '2'
 10349        PERFORM WITH TEST AFTER
 10350         VARYING SUB FROM +1 BY +5
 10351          UNTIL SUB > +60
 10352            OR PI-PMTNOTE2(SUB:1) = 'F'
 10353            OR PI-PMTNOTE2(SUB:1) NOT > SPACES
 10354        END-PERFORM
 10355        IF PI-PMTNOTE2(SUB:1) NOT = 'F'
 10356           MOVE ER-3551    TO EMI-ERROR
 10357           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10358        END-IF
 10359     END-IF.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 197
* EL156.cbl
 10360     GO TO 1045-EDIT-PAYEE-ADDR.
 10361
 10362 1040-PMTTYPE-ERROR.
 10363     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10364
 10365     IF EMI-MESSAGE-FORMATTED
 10366         MOVE -1                 TO PMTTYPEL
 10367         MOVE AL-UABON           TO PMTTYPEA.
 10368
 10369 1040-EXIT.
 10370     EXIT.
 10371
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 198
* EL156.cbl
 10373 1045-EDIT-PAYEE-ADDR.
 10374
 10375     IF PI-OFFLINE = 'N' AND
 10376        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10377           < PI-PAYEE-SEQ-NUM)
 10378        OR
 10379         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10380         (PI-PAYEE-TYPE = 'B')                 AND
 10381         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10382        OR
 10383         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10384           < PI-PAYEE-SEQ-NUM)
 10385        OR
 10386         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10387           < PI-PAYEE-SEQ-NUM)
 10388        OR
 10389         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10390           < PI-PAYEE-SEQ-NUM)
 10391        OR
 10392         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10393           < PI-PAYEE-SEQ-NUM)
 10394        OR
 10395         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10396           < PI-PAYEE-SEQ-NUM))
 10397             MOVE ER-0437        TO EMI-ERROR
 10398             MOVE -1             TO PAYEEL
 10399             MOVE AL-UABON       TO PAYEEA
 10400             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10401
 10402     IF PI-OFFLINE    = 'N' AND
 10403        PI-PAYEE-TYPE = 'B' AND
 10404        PI-PAYEE-SEQ  = '0'
 10405         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10406         IF BENE-FOUND-SW = 'N'
 10407             MOVE ER-0437        TO EMI-ERROR
 10408             MOVE -1             TO PAYEEL
 10409             MOVE AL-UABON       TO PAYEEA
 10410             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10411
 10412     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10413        IF PI-OFFLINE    = 'N'  AND
 10414           PI-PAYEE-TYPE = 'B'  AND
 10415           PI-PAYEE-SEQ  = '9'
 10416             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10417             IF BENE-FOUND-SW = 'N'
 10418                MOVE ER-0437        TO EMI-ERROR
 10419                MOVE -1             TO PAYEEL
 10420                MOVE AL-UABON       TO PAYEEA
 10421                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10422
 10423*    IF PI-COMPANY-ID = 'CRI'
 10424*        IF CL-CLAIM-TYPE = 'L'
 10425*            MOVE 'N'                TO  WS-GROUPED
 10426*                                        PI-GROUPED
 10427*                                        GROUPEDI
 10428*            MOVE AL-UANON           TO  GROUPEDA
 10429*            GO TO 1050-EDIT-CHECK-NO
 10430*        ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 199
* EL156.cbl
 10431*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10432*            IF WS-GROUP-1 = 'C'
 10433*                NEXT SENTENCE
 10434*            ELSE
 10435*                MOVE 'N'            TO  WS-GROUPED
 10436*                                        PI-GROUPED
 10437*                                        GROUPEDI
 10438*                MOVE AL-UANON       TO  GROUPEDA
 10439*                GO TO 1050-EDIT-CHECK-NO.
 10440
 10441*     IF PI-GROUPED = 'Y'
 10442*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10443*           NEXT SENTENCE
 10444*        ELSE
 10445*           MOVE ER-0437        TO EMI-ERROR
 10446*           MOVE -1             TO PAYEEL
 10447**02180            MOVE AL-UABON       TO PAYEEA
 10448*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10449*
 10450*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10451*        (PI-GROUPED    = ' ')
 10452*        NEXT SENTENCE
 10453*     ELSE
 10454*
 10455     GO TO 1050-EDIT-CHECK-NO.
 10456*     IF PI-COMPANY-ID = 'CRI'
 10457*        MOVE 'N'           TO GROUPEDI
 10458*                              PI-GROUPED
 10459*                              WS-GROUPED
 10460*        MOVE AL-UANON      TO GROUPEDA.
 10461*
 10462*     IF PI-COMPANY-ID = 'CRI'
 10463*        IF PI-PAYEE-TYPE = 'B'
 10464*           IF BENE-FOUND-SW = 'Y'
 10465*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10466*                 MOVE 'Y'           TO GROUPEDI
 10467*                                       PI-GROUPED
 10468*                                       WS-GROUPED
 10469*                 MOVE AL-UANON      TO GROUPEDA
 10470*              ELSE
 10471*                 NEXT SENTENCE
 10472*           ELSE
 10473*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10474*              IF BENE-FOUND-SW = 'Y'
 10475*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10476*                    MOVE 'Y'      TO GROUPEDI
 10477*                                     PI-GROUPED
 10478*                                     WS-GROUPED
 10479*                    MOVE AL-UANON TO GROUPEDA.
 10480*
 10481
 10482     IF PI-COMPANY-ID NOT = 'CRI'
 10483        GO TO 1050-EDIT-CHECK-NO.
 10484
 10485*************** CRI CODE START ******************
 10486     IF PI-PAYEE-TYPE NOT = 'A'
 10487        GO TO 1050-EDIT-CHECK-NO.
 10488
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 200
* EL156.cbl
 10489     MOVE LOW-VALUES             TO ERACCT-KEY.
 10490     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10491     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10492     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10493     MOVE PI-STATE               TO ACCT-STATE.
 10494     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10495     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10496     MOVE 'ACCT'                 TO FILE-SWITCH.
 10497
 10498     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10499     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10500
 10501
 10502* EXEC CICS HANDLE CONDITION
 10503*         NOTFND   (1950-NOT-FOUND)
 10504*         ENDFILE  (1950-NOT-FOUND)
 10505*    END-EXEC.
 10506*    MOVE '"$I''                  ! ( #00010130' TO DFHEIV0
 10507     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10508     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10509     MOVE X'2820233030303130313330' TO DFHEIV0(25:11)
 10510     CALL 'kxdfhei1' USING DFHEIV0
 10511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10512
 10513
 10514
 10515* EXEC CICS STARTBR
 10516*         DATASET   ('ERACCT')
 10517*         RIDFLD    (ERACCT-KEY)
 10518*         GTEQ
 10519*    END-EXEC.
 10520     MOVE 'ERACCT' TO DFHEIV1
 10521     MOVE 0
 10522       TO DFHEIV11
 10523*    MOVE '&,         G          &   #00010135' TO DFHEIV0
 10524     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10525     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10526     MOVE X'2020233030303130313335' TO DFHEIV0(25:11)
 10527     CALL 'kxdfhei1' USING DFHEIV0,
 10528           DFHEIV1,
 10529           ERACCT-KEY,
 10530           DFHEIV99,
 10531           DFHEIV11,
 10532           DFHEIV99
 10533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10534
 10535
 10536 1046-READNEXT-ERACCT.
 10537
 10538
 10539* EXEC CICS READNEXT
 10540*         DATASET   ('ERACCT')
 10541*         RIDFLD    (ERACCT-KEY)
 10542*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10543*    END-EXEC.
 10544     MOVE 'ERACCT' TO DFHEIV1
 10545     MOVE 0
 10546       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 201
* EL156.cbl
 10547*    MOVE '&.S                   )   #00010143' TO DFHEIV0
 10548     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10549     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10550     MOVE X'2020233030303130313433' TO DFHEIV0(25:11)
 10551     CALL 'kxdfhei1' USING DFHEIV0,
 10552           DFHEIV1,
 10553           DFHEIV20,
 10554           DFHEIV99,
 10555           ERACCT-KEY,
 10556           DFHEIV99,
 10557           DFHEIV11,
 10558           DFHEIV99,
 10559           DFHEIV99
 10560     SET ADDRESS OF ACCOUNT-MASTER TO
 10561         DFHEIV20
 10562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10563
 10564
 10565     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10566        IF WS-ERACCT-HOLD-RECORD = SPACES
 10567           GO TO 1950-NOT-FOUND
 10568        ELSE
 10569           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10570           GO TO 1048-CONTINUE.
 10571
 10572     IF ACCT-EXP-DT = HIGH-VALUES
 10573        NEXT SENTENCE
 10574     ELSE
 10575        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10576        GO TO 1046-READNEXT-ERACCT.
 10577
 10578 1048-CONTINUE.
 10579
 10580*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10581*       MOVE 'Y'                 TO GROUPEDI
 10582*                                   PI-GROUPED
 10583*                                   WS-GROUPED
 10584*       MOVE AL-UANON            TO GROUPEDA.
 10585*************** CRI CODE END ******************
 10586
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 202
* EL156.cbl
 10588 1050-EDIT-CHECK-NO.
 10589
 10590     IF PI-OFFLINE = 'Y'
 10591         IF PI-ECHECKNO = SPACES
 10592              MOVE ER-0439        TO EMI-ERROR
 10593              GO TO 1090-CHECK-NO-ERROR
 10594           ELSE
 10595*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10596*           IF PI-ECHECKNO-N = 'N' AND
 10597*              PI-CASH       = 'Y'
 10598*                MOVE ER-3535        TO EMI-ERROR
 10599*                GO TO 1090-CHECK-NO-ERROR
 10600*             ELSE
 10601*                MOVE AL-UANON    TO CHECKNOA
 10602*                GO TO 1100-EDIT-HOLDTIL
 10603*         ELSE
 10604            MOVE AL-UANON    TO CHECKNOA
 10605            GO TO 1100-EDIT-HOLDTIL.
 10606
 10607     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10608     MOVE '6'                    TO CNTL-REC-TYPE.
 10609
 10610     IF CONTROL-IS-ACTUAL-CARRIER
 10611         MOVE PI-CARRIER         TO WS-CARR
 10612     ELSE
 10613         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10614
 10615     IF PI-COMPANY-ID = 'FIA'
 10616         MOVE PI-CARRIER         TO WS-CARR.
 10617
 10618     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10619     MOVE 0                      TO CNTL-SEQ-NO.
 10620     MOVE 'CARR'                 TO FILE-SWITCH.
 10621
 10622     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10623
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 203
* EL156.cbl
 10625     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10626         GO TO 1051-EDIT-CHECKNO-CONT.
 10627
 10628**********************AIG LOGIC STARTS**********************
 10629     IF PI-ECHECKNO = SPACES
 10630         IF CHECK-NO-MANUAL
 10631             MOVE ER-0441        TO EMI-ERROR
 10632             GO TO 1090-CHECK-NO-ERROR
 10633         ELSE
 10634             MOVE AL-UANOF       TO CHECKNOA
 10635             GO TO 1100-EDIT-HOLDTIL.
 10636
 10637     IF PI-ECHECKNO NOT = SPACES
 10638         IF CHECK-NO-MANUAL
 10639             MOVE AL-UANON       TO CHECKNOA
 10640             GO TO 1100-EDIT-HOLDTIL.
 10641
 10642     IF PI-ECHECKNO-CR = 'CR'
 10643        IF PI-OFFLINE = 'Y'
 10644            MOVE AL-UANON       TO CHECKNOA
 10645            GO TO 1100-EDIT-HOLDTIL
 10646        ELSE
 10647            MOVE ER-3534        TO EMI-ERROR
 10648            GO TO 1090-CHECK-NO-ERROR.
 10649
 10650     IF PI-ECHECKNO-N = 'N'
 10651        IF PI-CASH = 'N'
 10652            MOVE AL-UANON       TO CHECKNOA
 10653            GO TO 1100-EDIT-HOLDTIL
 10654        ELSE
 10655            MOVE ER-3535          TO EMI-ERROR
 10656            GO TO 1090-CHECK-NO-ERROR.
 10657
 10658     MOVE ER-0442        TO EMI-ERROR
 10659     GO TO 1090-CHECK-NO-ERROR.
 10660**********************AIG LOGIC ENDS************************
 10661
 10662 1051-EDIT-CHECKNO-CONT.
 10663
 10664     IF PI-COMPANY-ID = 'DMD'
 10665        IF PI-ECHECKNO NOT = SPACES
 10666           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10667              MOVE ER-0442        TO EMI-ERROR
 10668              GO TO 1090-CHECK-NO-ERROR
 10669            ELSE
 10670              GO TO 1100-EDIT-HOLDTIL
 10671          ELSE
 10672           GO TO 1100-EDIT-HOLDTIL.
 10673
 10674     IF PI-ECHECKNO = SPACES
 10675         IF CHECK-NO-MANUAL
 10676             MOVE ER-0441        TO EMI-ERROR
 10677             GO TO 1090-CHECK-NO-ERROR
 10678         ELSE
 10679             MOVE AL-UANOF       TO CHECKNOA
 10680             GO TO 1100-EDIT-HOLDTIL
 10681     ELSE
 10682         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 204
* EL156.cbl
 10683             MOVE AL-UANON       TO CHECKNOA
 10684             GO TO 1100-EDIT-HOLDTIL
 10685         ELSE
 10686             MOVE ER-0442        TO EMI-ERROR
 10687             GO TO 1090-CHECK-NO-ERROR.
 10688
 10689 1090-CHECK-NO-ERROR.
 10690     MOVE -1                     TO CHECKNOL.
 10691     MOVE AL-UABON               TO CHECKNOA.
 10692     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10693
 10694     GO TO 2000-EDIT-DONE.
 10695
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 205
* EL156.cbl
 10697 1100-EDIT-HOLDTIL.
 10698     MOVE AL-UANON               TO HOLDTILA.
 10699
 10700     IF PI-HOLDTIL = ZEROS
 10701        IF PI-OFFLINE = 'Y'
 10702           MOVE ER-0572          TO EMI-ERROR
 10703           GO TO 1105-HOLDTIL-ERROR
 10704        ELSE
 10705           GO TO 1110-EDIT-PAID-FROM.
 10706
 10707     MOVE '4'                    TO DC-OPTION-CODE.
 10708     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10709     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10710
 10711     IF DATE-CONVERSION-ERROR
 10712         MOVE ER-0446            TO EMI-ERROR
 10713         GO TO 1105-HOLDTIL-ERROR
 10714     END-IF
 10715     IF PI-OFFLINE = 'Y'
 10716        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10717           MOVE ER-0446            TO EMI-ERROR
 10718           GO TO 1105-HOLDTIL-ERROR
 10719        END-IF
 10720     END-IF
 10721
 10722     IF PI-OFFLINE = 'Y'
 10723        GO TO 1110-EDIT-PAID-FROM.
 10724
 10725     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10726     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10727     MOVE '1'                    TO DC-OPTION-CODE.
 10728     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10729
 10730*    IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10731     IF DC-ELAPSED-DAYS > 60 OR DATE-CONVERSION-ERROR
 10732         MOVE ER-0447            TO EMI-ERROR
 10733         GO TO 1105-HOLDTIL-ERROR.
 10734
 10735     GO TO 1110-EDIT-PAID-FROM.
 10736
 10737 1105-HOLDTIL-ERROR.
 10738     MOVE -1                     TO HOLDTILL.
 10739     MOVE AL-UNBON               TO HOLDTILA.
 10740     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10741
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 206
* EL156.cbl
 10743 1110-EDIT-PAID-FROM.
 10744     MOVE AL-UANON               TO EPYFROMA.
 10745
 10746     IF PI-EPYFROM = ZEROS
 10747         GO TO 1120-CALCULATE-PAID-FROM.
 10748
 10749     IF PI-PMTTYPE = '5' OR '6'
 10750         MOVE ER-0448            TO EMI-ERROR
 10751         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10752         MOVE AL-UNBON           TO EPYFROMA
 10753         MOVE -1                 TO EPYFROML
 10754         GO TO 1150-EDIT-PAID-THRU.
 10755
 10756     MOVE '4'                    TO DC-OPTION-CODE.
 10757     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10758     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10759
 10760     IF DATE-CONVERSION-ERROR
 10761         MOVE ER-0449            TO EMI-ERROR
 10762         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10763         MOVE AL-UNBON           TO EPYFROMA
 10764         MOVE -1                 TO EPYFROML
 10765     ELSE
 10766         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10767
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 207
* EL156.cbl
 10769 1120-CALCULATE-PAID-FROM.
 10770     IF PI-PMTTYPE = '5' OR '6'
 10771         GO TO 1150-EDIT-PAID-THRU.
 10772
 10773*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10774*       IF PI-PMTTYPE = '4'
 10775*         GO TO 1150-EDIT-PAID-THRU.
 10776
 10777     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10778         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10779         MOVE ' '                TO DC-OPTION-CODE
 10780         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10781         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10782         GO TO 1145-TEST-PAID-FROM.
 10783
 10784     IF PI-PMTTYPE = '4'
 10785        GO TO 1150-EDIT-PAID-THRU.
 10786
 10787     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10788     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10789     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10790     MOVE '5'                    TO CNTL-REC-TYPE.
 10791     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10792     MOVE 'BENE'                 TO FILE-SWITCH.
 10793
 10794     IF WS-BEN-CD = ZEROS
 10795         GO TO 1950-NOT-FOUND.
 10796
 10797     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10798
 10799     IF NO-BENEFIT-FOUND
 10800         GO TO 1950-NOT-FOUND.
 10801
 10802     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10803     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10804
 10805     IF PI-BEN-DAYS NOT NUMERIC
 10806        MOVE ZEROS               TO PI-BEN-DAYS.
 10807
 10808     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10809
 10810     SET HOLD-UNTIL-CHK TO TRUE
 10811     MOVE CL-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 10812     PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10813     MOVE SPACE TO WS-HOLD-UNTIL-SW
 10814     IF WS-HOLD-UNTIL-DT > CL-PAID-THRU-DT
 10815         MOVE WS-HOLD-UNTIL-DT     TO DC-BIN-DATE-1
 10816         MOVE '6'                 TO DC-OPTION-CODE
 10817         MOVE +0                  TO DC-ELAPSED-MONTHS
 10818         MOVE +1                  TO DC-ELAPSED-DAYS
 10819         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10820         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10821         GO TO 1145-TEST-PAID-FROM.
 10822
 10823     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10824        (CL-TOTAL-PAID-AMT > ZEROS)
 10825         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10826         MOVE '6'                 TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 208
* EL156.cbl
 10827         MOVE +0                  TO DC-ELAPSED-MONTHS
 10828         MOVE +1                  TO DC-ELAPSED-DAYS
 10829         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10830         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10831         GO TO 1145-TEST-PAID-FROM.
 10832
 10833******************************************************************
 10834****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10835****** SPECIAL ENTERED DATE.
 10836******************************************************************
 10837
 10838     IF PI-AIGFROM = ZEROS
 10839         GO TO 1130-CONTINUE-PAID-FROM.
 10840
 10841     MOVE AL-UANON TO AIGFROMA.
 10842
 10843     MOVE '4'                    TO DC-OPTION-CODE.
 10844     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10845     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10846
 10847     IF DATE-CONVERSION-ERROR
 10848         MOVE ER-0449            TO EMI-ERROR
 10849         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10850         MOVE AL-UNBON           TO AIGFROMA
 10851         MOVE -1                 TO AIGFROML
 10852         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10853     ELSE
 10854         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10855         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10856
 10857     GO TO 1140-CONTINUE-PAID-FROM.
 10858
 10859 1130-CONTINUE-PAID-FROM.
 10860
 10861     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10862        (CL-TOTAL-PAID-AMT = ZEROS)
 10863           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10864
 10865 1140-CONTINUE-PAID-FROM.
 10866
 10867     IF PI-BEN-TYPE = 'R'
 10868         IF PI-BEN-DAYS = ZEROS
 10869             NEXT SENTENCE
 10870         ELSE
 10871         IF PI-COMPANY-ID NOT = 'DMD'
 10872             SUBTRACT 1 FROM PI-BEN-DAYS.
 10873
 10874     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10875
 10876     IF PI-COMPANY-ID = 'DMD'
 10877         MOVE -1                 TO DC-ELAPSED-DAYS
 10878         MOVE +0                 TO DC-ELAPSED-MONTHS
 10879         MOVE '6'                TO DC-OPTION-CODE
 10880         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10881         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10882         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10883                               REMAINDER DC-ELAPSED-DAYS
 10884      ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 209
* EL156.cbl
 10885         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10886         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10887
 10888     MOVE '6'                    TO DC-OPTION-CODE.
 10889     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10890     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10891
 10892     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10893
 10894     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10895         MOVE ER-0541            TO EMI-ERROR
 10896         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10897         MOVE -1                 TO EPYFROML
 10898         MOVE AL-UNBON           TO EPYFROMA.
 10899
 10900     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10901        (PI-BENEFIT-SAVE = '60E')
 10902        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10903           (CL-TOTAL-PAID-AMT = ZEROS)
 10904             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10905             MOVE 30                  TO DC-ELAPSED-DAYS
 10906             MOVE +0                  TO DC-ELAPSED-MONTHS
 10907             MOVE '6'                 TO DC-OPTION-CODE
 10908             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10909
 10910     IF PI-BEN-TYPE = 'R'
 10911         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10912     ELSE
 10913         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10914         IF WS-SV-EPYFROM = LOW-VALUES
 10915            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10916
 10917     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10918         IF WS-USE-AIG-PAYFROM   OR
 10919            WS-AIG-RECALC-PAYFROM
 10920              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10921                                      DC-BIN-DATE-1
 10922              MOVE ' '            TO  DC-OPTION-CODE
 10923              MOVE +0             TO  DC-ELAPSED-MONTHS
 10924                                      DC-ELAPSED-DAYS
 10925              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10926              IF NO-CONVERSION-ERROR
 10927                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10928
 10929     IF PI-CPYFROM < CL-INCURRED-DT
 10930        MOVE -1                  TO EPYFROML
 10931        MOVE ER-3542             TO EMI-ERROR
 10932        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10933
 10934     IF CM-ENTRY-DT < CL-INCURRED-DT
 10935        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10936        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10937        MOVE +0                     TO DC-ELAPSED-DAYS
 10938        MOVE +0                     TO DC-ELAPSED-MONTHS
 10939        MOVE '1'                    TO DC-OPTION-CODE
 10940        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10941        ELSE
 10942        MOVE ZEROS TO DC-ELAPSED-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 210
* EL156.cbl
 10943
 10944     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10945         NEXT SENTENCE
 10946     ELSE
 10947         IF DC-ELAPSED-MONTHS < 2
 10948             MOVE ER-3255        TO EMI-ERROR
 10949             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10950
 10951 1145-TEST-PAID-FROM.
 10952     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10953         GO TO 1150-EDIT-PAID-THRU.
 10954
 10955     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10956         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10957         MOVE ' '                TO DC-OPTION-CODE
 10958         MOVE +0                 TO DC-ELAPSED-MONTHS
 10959                                    DC-ELAPSED-DAYS
 10960         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10961         IF NO-CONVERSION-ERROR
 10962             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10963         ELSE
 10964             MOVE SPACES             TO EMI-DATE-FIELD.
 10965
 10966     IF PI-HOLDTIL NOT = ZEROS
 10967        CONTINUE
 10968     ELSE
 10969     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10970         IF CL-TOTAL-PAID-AMT = ZEROS
 10971             MOVE ER-3543            TO EMI-ERROR
 10972             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10973             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10974             IF EMI-MESSAGE-FORMATTED
 10975                MOVE -1             TO EPYFROML
 10976                MOVE AL-UNBON       TO EPYFROMA
 10977             ELSE
 10978                NEXT SENTENCE
 10979         ELSE
 10980             MOVE ER-0452            TO EMI-ERROR
 10981             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10982             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10983             IF EMI-MESSAGE-FORMATTED
 10984                MOVE -1             TO EPYFROML
 10985                MOVE AL-UNBON       TO EPYFROMA.
 10986
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 211
* EL156.cbl
 10988 1150-EDIT-PAID-THRU.
 10989
 10990     MOVE AL-UANON               TO EPYTHRUA.
 10991
 10992     IF PI-EPYTHRU = ZEROS
 10993*        IF PI-PMTTYPE = '4' OR '5' OR '6'
 10994         IF PI-PMTTYPE = '5' OR '6'
 10995           OR (CL-CLAIM-TYPE NOT = 'L' AND 'O'
 10996             AND PI-PMTTYPE = '4')
 10997             GO TO 1200-EDIT-FIND-TOLERANCES
 10998         ELSE
 10999            IF (PI-PMTTYPE = '3') OR (PI-PMTTYPE = '4') OR
 11000               (PI-PMTTYPE = '2' AND
 11001                 CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')
 11002               GO TO 1152-CHECK-TYPE
 11003            ELSE
 11004               MOVE ER-0473      TO EMI-ERROR
 11005               GO TO 1170-PAID-THRU-FATAL-ERROR
 11006     ELSE
 11007         IF PI-PMTTYPE = '5' OR '6'
 11008             MOVE ER-0474        TO EMI-ERROR
 11009             GO TO 1170-PAID-THRU-FATAL-ERROR.
 11010
 11011     MOVE '4'                    TO DC-OPTION-CODE.
 11012     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 11013     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11014
 11015     IF DATE-CONVERSION-ERROR
 11016         MOVE ER-0475            TO EMI-ERROR
 11017         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11018
 11019     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 11020
 11021     IF PI-COMPANY-ID = 'DMD'
 11022         IF PI-PMTTYPE NOT = '2'
 11023                 AND
 11024            WS-EXP-DT > WS-SV-EPYTHRU
 11025             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 11026             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 11027             MOVE '1'              TO DC-OPTION-CODE
 11028             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11029             IF DATE-CONVERSION-ERROR
 11030                 MOVE ER-0944      TO EMI-ERROR
 11031                 GO TO 1170-PAID-THRU-FATAL-ERROR
 11032             ELSE
 11033                 IF DC-ELAPSED-MONTHS = ZEROS AND
 11034                    DC-ELAPSED-DAYS   = 1
 11035                     MOVE ER-0945  TO EMI-ERROR
 11036                     MOVE -1       TO EPYTHRUL
 11037                     MOVE AL-UABON TO EPYTHRUA
 11038                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11039
 11040     IF PI-PMTTYPE = '4'
 11041         NEXT SENTENCE
 11042     ELSE
 11043         IF WS-SV-EPYTHRU = WS-EXP-DT
 11044             IF PI-PMTTYPE NOT = '2' AND '3'
 11045                 MOVE ER-3541    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 212
* EL156.cbl
 11046                 MOVE -1         TO PMTTYPEL
 11047                 MOVE AL-UABON   TO PMTTYPEA
 11048                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11049
 11050     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 11051         MOVE ER-0501            TO EMI-ERROR
 11052         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11053
 11054     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 11055        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 11056*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11057*              MOVE ER-0540         TO EMI-ERROR
 11058*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11059*              MOVE -1              TO EPYTHRUL
 11060*              MOVE AL-UNBON        TO EPYTHRUA
 11061*          ELSE
 11062*          IF PI-COMPANY-ID = 'DMD'
 11063*              MOVE ER-7540         TO EMI-ERROR
 11064*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11065*              MOVE -1              TO EPYTHRUL
 11066*              MOVE AL-UNBON        TO EPYTHRUA
 11067*          ELSE
 11068               IF PI-PMTTYPE NOT = '2' AND '3'
 11069                  IF PI-COMPANY-ID = '???'
 11070                      MOVE ER-7540  TO EMI-ERROR
 11071                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11072                      MOVE -1       TO EPYTHRUL
 11073                      MOVE AL-UNBON TO EPYTHRUA
 11074                  ELSE
 11075                      MOVE ER-0540  TO EMI-ERROR
 11076                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11077                      MOVE -1       TO EPYTHRUL
 11078                      MOVE AL-UNBON TO EPYTHRUA.
 11079
 11080     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11081            OR
 11082        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 11083         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11084            OR
 11085        (PI-CPYFROM NOT = LOW-VALUES AND
 11086         PI-CPYFROM < CL-PAID-THRU-DT)
 11087        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 11088
 11089 1152-CHECK-TYPE.
 11090     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11091        OR (PI-PMTTYPE = '5' OR '6')
 11092         GO TO 1160-EDIT-PAID-THRU-AH.
 11093
 11094 1155-EDIT-PAID-THRU-LIFE.
 11095     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11096     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11097     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11098     MOVE '4'                    TO CNTL-REC-TYPE.
 11099     MOVE ZEROS                  TO CNTL-SEQ-NO.
 11100     MOVE 'BENE'                 TO FILE-SWITCH.
 11101
 11102     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11103
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 213
* EL156.cbl
 11104     IF NO-BENEFIT-FOUND
 11105         GO TO 1950-NOT-FOUND.
 11106
 11107     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 11108
 11109     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 11110
 11111     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11112        PI-LF-COVERAGE-TYPE = 'P'
 11113         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 11114         GO TO 1200-EDIT-FIND-TOLERANCES.
 11115
 11116     IF PI-EPYTHRU = ZEROS
 11117        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 11118
 11119     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11120         MOVE ER-0476            TO EMI-ERROR
 11121         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11122
 11123     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 11124*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 11125     move cl-critical-period    to dc-elapsed-months
 11126     MOVE +0                    TO DC-ELAPSED-DAYS.
 11127     MOVE '6'                   TO DC-OPTION-CODE.
 11128     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11129
 11130     IF (NO-CONVERSION-ERROR AND
 11131         WS-SPECIAL-CALC-CD = 'C')
 11132        IF CL-INCURRED-DT > DC-BIN-DATE-2
 11133            MOVE ER-0657 TO EMI-ERROR
 11134            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11135
 11136     IF PI-COMPANY-ID = 'NCL'
 11137         IF WS-SPECIAL-CALC-CD = 'C' AND
 11138            cl-critical-period = zeros
 11139*           CM-LF-CRITICAL-PERIOD = +0
 11140             MOVE ER-0844       TO EMI-ERROR
 11141             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11142
 11143     GO TO 1200-EDIT-FIND-TOLERANCES.
 11144
 11145 1160-EDIT-PAID-THRU-AH.
 11146     IF PI-EPYTHRU = ZEROS
 11147        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11148                                    WS-SV-EPYTHRU
 11149     ELSE
 11150        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 11151
 11152     IF WS-SV-EPYTHRU < PI-CPYFROM
 11153         MOVE ER-0508            TO EMI-ERROR
 11154         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11155
 11156     perform 7975-read-acct      thru 7975-exit
 11157     move zeros                  to pi-max-ext
 11158     if PI-DCC-PRODUCT-CODE NOT = SPACES
 11159        PERFORM 0900-GET-DDF-LIMITS
 11160                                 THRU 0900-EXIT
 11161        IF PDEF-FOUND
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 214
* EL156.cbl
 11162           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11163              (P1 > +8)
 11164              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11165           END-PERFORM
 11166           IF P1 < +9
 11167              MOVE PD-MAX-extension (P1)
 11168                                 TO pi-max-ext
 11169           else
 11170              move er-1674       to emi-error
 11171              PERFORM 9900-ERROR-FORMAT
 11172                                 THRU 9900-EXIT
 11173           END-IF
 11174        else
 11175           move er-1672          to emi-error
 11176           PERFORM 9900-ERROR-FORMAT
 11177                                 THRU 9900-EXIT
 11178        END-IF
 11179     end-if
 11180     move spaces                 to pi-max-ext-used
 11181     IF PI-PMTTYPE = '3'
 11182        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11183        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11184           MOVE ER-0477          TO EMI-ERROR
 11185           PERFORM 1165-PAID-THRU-ERROR
 11186                                 THRU 1165-EXIT
 11187        ELSE
 11188           continue
 11189        end-if
 11190     ELSE
 11191        IF WS-SV-EPYTHRU > WS-EXP-DT
 11192         IF PI-DCC-PRODUCT-CODE NOT > SPACES
 11193           move ws-exp-dt        to dc-bin-date-1
 11194           move ws-sv-epythru    to dc-bin-date-2
 11195           MOVE '1'              TO DC-OPTION-CODE
 11196           MOVE +0               TO DC-ELAPSED-DAYS
 11197                                    DC-ELAPSED-MONTHS
 11198           PERFORM 9700-LINK-DATE-CONVERT
 11199                                 THRU 9700-EXIT
 11200           if no-conversion-error
 11201              if dc-elapsed-days > zeros
 11202                 add +1 to dc-elapsed-months
 11203              end-if
 11204              if dc-elapsed-months > pi-max-ext
 11205                 MOVE ER-0557    TO EMI-ERROR
 11206                 PERFORM 1165-PAID-THRU-ERROR
 11207                                 THRU 1165-EXIT
 11208              else
 11209                 move 'Y'        to pi-max-ext-used
 11210                 move er-1670    to emi-error
 11211                 perform 9900-error-format
 11212                                 thru 9900-exit
 11213              end-if
 11214           end-if
 11215         ELSE
 11216            MOVE ER-0557    TO EMI-ERROR
 11217            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 11218         END-IF
 11219        end-if
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 215
* EL156.cbl
 11220     end-if
 11221
 11222     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 11223         PI-PMTTYPE NOT = '3'
 11224         MOVE ER-0541        TO EMI-ERROR
 11225         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11226
 11227     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 11228        (PI-PMTTYPE NOT = '3')
 11229         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 11230             MOVE ER-0478        TO EMI-ERROR
 11231             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11232
 11233     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 11234        (PI-PMTTYPE NOT = '4')
 11235         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 11236             MOVE ER-0479        TO EMI-ERROR
 11237             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11238
 11239     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 11240         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 11241             MOVE ER-0545        TO EMI-ERROR
 11242             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11243
 11244     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 11245         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 11246             MOVE ER-0481        TO EMI-ERROR
 11247             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11248
 11249*    IF PI-COMPANY-ID = 'NCL'
 11250*        IF WS-SPECIAL-CALC-CD = 'C' AND
 11251*           CM-AH-CRITICAL-PERIOD = +0
 11252*            MOVE ER-0844        TO  EMI-ERROR
 11253*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11254
 11255*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 11256     if (cl-critical-period = zeros)
 11257        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11258          GO TO 1200-EDIT-FIND-TOLERANCES.
 11259
 11260     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11261     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 11262     MOVE '1'        TO DC-OPTION-CODE.
 11263     MOVE +0         TO DC-ELAPSED-DAYS
 11264                        DC-ELAPSED-MONTHS.
 11265     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11266
 11267*    IF NO-CONVERSION-ERROR
 11268*       COMPUTE ws-benefits-paid =
 11269*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11270*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11271*           MOVE ER-0657 TO EMI-ERROR
 11272*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11273
 11274     GO TO 1200-EDIT-FIND-TOLERANCES.
 11275
 11276 1165-PAID-THRU-ERROR.
 11277     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 216
* EL156.cbl
 11278
 11279     IF EMI-MESSAGE-FORMATTED
 11280         MOVE -1                 TO EPYTHRUL
 11281         MOVE AL-UNBON           TO EPYTHRUA.
 11282
 11283 1165-EXIT.
 11284     EXIT.
 11285
 11286 1166-CHECK-ALL-TRLRS.
 11287
 11288     IF PI-PMTTYPE = '4'
 11289        GO TO 1166-TRLR-EXIT.
 11290
 11291     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11292
 11293     IF HOLD-UNTIL-CHK
 11294        CONTINUE
 11295     ELSE
 11296     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11297        WS-SV-EPYFROM = LOW-VALUES
 11298          GO TO 1166-END-CHECK.
 11299
 11300
 11301* EXEC CICS HANDLE CONDITION
 11302*        ENDFILE   (1166-END-CHECK)
 11303*        NOTFND    (1166-END-CHECK)
 11304*    END-EXEC.
 11305*    MOVE '"$''I                  ! ) #00010884' TO DFHEIV0
 11306     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11307     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11308     MOVE X'2920233030303130383834' TO DFHEIV0(25:11)
 11309     CALL 'kxdfhei1' USING DFHEIV0
 11310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11311
 11312
 11313     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11314     MOVE +100                   TO TRLR-SEQ-NO.
 11315
 11316
 11317* EXEC CICS STARTBR
 11318*         DATASET    ('ELTRLR')
 11319*         RIDFLD     (ELTRLR-KEY)
 11320*         GTEQ
 11321*    END-EXEC.
 11322     MOVE 'ELTRLR' TO DFHEIV1
 11323     MOVE 0
 11324       TO DFHEIV11
 11325*    MOVE '&,         G          &   #00010892' TO DFHEIV0
 11326     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11327     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11328     MOVE X'2020233030303130383932' TO DFHEIV0(25:11)
 11329     CALL 'kxdfhei1' USING DFHEIV0,
 11330           DFHEIV1,
 11331           ELTRLR-KEY,
 11332           DFHEIV99,
 11333           DFHEIV11,
 11334           DFHEIV99
 11335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 217
* EL156.cbl
 11336
 11337
 11338     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11339
 11340 1166-READ-TRLR-NEXT.
 11341
 11342
 11343* EXEC CICS READNEXT
 11344*         DATASET    ('ELTRLR')
 11345*         RIDFLD     (ELTRLR-KEY)
 11346*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11347*    END-EXEC.
 11348     MOVE 'ELTRLR' TO DFHEIV1
 11349     MOVE 0
 11350       TO DFHEIV11
 11351*    MOVE '&.S                   )   #00010902' TO DFHEIV0
 11352     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11353     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11354     MOVE X'2020233030303130393032' TO DFHEIV0(25:11)
 11355     CALL 'kxdfhei1' USING DFHEIV0,
 11356           DFHEIV1,
 11357           DFHEIV20,
 11358           DFHEIV99,
 11359           ELTRLR-KEY,
 11360           DFHEIV99,
 11361           DFHEIV11,
 11362           DFHEIV99,
 11363           DFHEIV99
 11364     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11365         DFHEIV20
 11366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11367
 11368
 11369     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11370        TRLR-CARRIER  = MSTR-CARRIER  AND
 11371        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11372        TRLR-CERT-NO  = MSTR-CERT-NO
 11373          NEXT SENTENCE
 11374      ELSE
 11375          GO TO 1166-END-CHECK.
 11376
 11377* **  BYPASS ALL NON-PAYMENT TRAILERS
 11378
 11379     IF AT-TRAILER-TYPE = '2'
 11380        NEXT SENTENCE
 11381     ELSE
 11382        GO TO 1166-READ-TRLR-NEXT.
 11383
 11384* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11385
 11386     IF AT-PAYMENT-TYPE = '1' OR '2'
 11387        NEXT SENTENCE
 11388     ELSE
 11389        GO TO 1166-READ-TRLR-NEXT.
 11390
 11391* **  BYPASS ALL VOID PAYMENTS
 11392
 11393     IF AT-VOID-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 218
* EL156.cbl
 11394        GO TO 1166-READ-TRLR-NEXT.
 11395
 11396     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11397        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11398          GO TO 1166-READ-TRLR-NEXT.
 11399     IF HOLD-UNTIL-CHK
 11400        IF AT-PAID-THRU-DT > WS-HOLD-UNTIL-DT
 11401          AND AT-TO-BE-WRITTEN-DT > ZERO
 11402           MOVE AT-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 11403        END-IF
 11404     END-IF
 11405
 11406     IF HOLD-UNTIL-CHK
 11407        CONTINUE
 11408     ELSE
 11409     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11410         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11411            OR
 11412        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11413         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 11414        NEXT SENTENCE
 11415     ELSE
 11416         IF CL-TOTAL-PAID-AMT > ZEROS
 11417             MOVE ER-0502            TO EMI-ERROR
 11418             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11419             MOVE -1                 TO EPYTHRUL
 11420             MOVE AL-UNBON           TO EPYTHRUA.
 11421
 11422     GO TO 1166-READ-TRLR-NEXT.
 11423
 11424 1166-END-CHECK.
 11425
 11426     IF WS-BROWSE-TRLR-SW = 'Y'
 11427
 11428* EXEC CICS ENDBR
 11429*            DATASET   ('ELTRLR')
 11430*       END-EXEC.
 11431     MOVE 'ELTRLR' TO DFHEIV1
 11432     MOVE 0
 11433       TO DFHEIV11
 11434*    MOVE '&2                    $   #00010966' TO DFHEIV0
 11435     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11436     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11437     MOVE X'2020233030303130393636' TO DFHEIV0(25:11)
 11438     CALL 'kxdfhei1' USING DFHEIV0,
 11439           DFHEIV1,
 11440           DFHEIV11,
 11441           DFHEIV99
 11442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11443
 11444
 11445     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11446
 11447 1166-TRLR-EXIT.
 11448     EXIT.
 11449
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 219
* EL156.cbl
 11451 1170-PAID-THRU-FATAL-ERROR.
 11452     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11453
 11454     MOVE -1                     TO EPYTHRUL.
 11455     MOVE AL-UNBON               TO EPYTHRUA.
 11456
 11457 1200-EDIT-FIND-TOLERANCES.
 11458
 11459* EXEC CICS HANDLE CONDITION
 11460*        ENDFILE(1950-NOT-FOUND)
 11461*        NOTFND (1950-NOT-FOUND)
 11462*    END-EXEC.
 11463*    MOVE '"$''I                  ! * #00010983' TO DFHEIV0
 11464     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11466     MOVE X'2A20233030303130393833' TO DFHEIV0(25:11)
 11467     CALL 'kxdfhei1' USING DFHEIV0
 11468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11469
 11470
 11471     IF PI-PROCESSOR-ID = 'LGXX'
 11472        GO TO 1240-FIND-ACCT-TOLERANCES.
 11473
 11474     MOVE 'N'                    TO FOUND-TOL-SW.
 11475     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11476     MOVE '2'                    TO CNTL-REC-TYPE.
 11477     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11478     MOVE +0                     TO CNTL-SEQ-NO.
 11479     MOVE 'PROC'                 TO FILE-SWITCH.
 11480
 11481     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11482
 11483     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11484     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11485                                    PI-MAX-PMT-TOL.
 11486     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11487
 11488     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11489         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11490
 11491     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11492     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11493                                    PI-MAX-LF-PMT-TOL.
 11494
 11495     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11496         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11497
 11498     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11499                                    PI-MAX-EXP-PMT.
 11500
 11501 1240-FIND-ACCT-TOLERANCES.
 11502
 11503     IF WS-PMT-TOL NOT = +0
 11504         MOVE 'Y'                TO FOUND-TOL-SW.
 11505
 11506     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11507         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11508         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 220
* EL156.cbl
 11509         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11510         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11511         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11512         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11513     ELSE
 11514         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11515         MOVE PI-CARRIER             TO ACCT-CARRIER
 11516         MOVE PI-GROUPING            TO ACCT-GROUPING
 11517         MOVE PI-STATE               TO ACCT-STATE
 11518         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11519         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11520
 11521     MOVE 'ACCT'                 TO FILE-SWITCH.
 11522
 11523     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11524     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11525
 11526
 11527* EXEC CICS HANDLE CONDITION
 11528*         NOTFND   (1950-NOT-FOUND)
 11529*         ENDFILE  (1950-NOT-FOUND)
 11530*    END-EXEC.
 11531*    MOVE '"$I''                  ! + #00011043' TO DFHEIV0
 11532     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11534     MOVE X'2B20233030303131303433' TO DFHEIV0(25:11)
 11535     CALL 'kxdfhei1' USING DFHEIV0
 11536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11537
 11538
 11539
 11540* EXEC CICS STARTBR
 11541*        DATASET('ERACCT')
 11542*        RIDFLD (ERACCT-KEY)
 11543*        GTEQ
 11544*    END-EXEC.
 11545     MOVE 'ERACCT' TO DFHEIV1
 11546     MOVE 0
 11547       TO DFHEIV11
 11548*    MOVE '&,         G          &   #00011048' TO DFHEIV0
 11549     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11550     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11551     MOVE X'2020233030303131303438' TO DFHEIV0(25:11)
 11552     CALL 'kxdfhei1' USING DFHEIV0,
 11553           DFHEIV1,
 11554           ERACCT-KEY,
 11555           DFHEIV99,
 11556           DFHEIV11,
 11557           DFHEIV99
 11558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11559
 11560
 11561 1245-FIND-ACCT-TOLERANCES-LOOP.
 11562
 11563
 11564* EXEC CICS READNEXT
 11565*        DATASET('ERACCT')
 11566*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 221
* EL156.cbl
 11567*        RIDFLD (ERACCT-KEY)
 11568*    END-EXEC.
 11569     MOVE 'ERACCT' TO DFHEIV1
 11570     MOVE 0
 11571       TO DFHEIV11
 11572*    MOVE '&.S                   )   #00011056' TO DFHEIV0
 11573     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11574     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11575     MOVE X'2020233030303131303536' TO DFHEIV0(25:11)
 11576     CALL 'kxdfhei1' USING DFHEIV0,
 11577           DFHEIV1,
 11578           DFHEIV20,
 11579           DFHEIV99,
 11580           ERACCT-KEY,
 11581           DFHEIV99,
 11582           DFHEIV11,
 11583           DFHEIV99,
 11584           DFHEIV99
 11585     SET ADDRESS OF ACCOUNT-MASTER TO
 11586         DFHEIV20
 11587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11588
 11589
 11590     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11591        IF WS-ERACCT-HOLD-RECORD = SPACES
 11592           GO TO 1950-NOT-FOUND
 11593        ELSE
 11594           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11595           GO TO 1250-CONTINUE.
 11596
 11597     IF ACCT-EXP-DT = HIGH-VALUES
 11598        NEXT SENTENCE
 11599     ELSE
 11600        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11601        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11602
 11603 1250-CONTINUE.
 11604
 11605     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11606
 11607     IF FOUND-TOL-SW = 'N'
 11608         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11609
 11610********* 1260-FIND-STATE-TOLERANCES.
 11611
 11612     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11613     MOVE PI-STATE               TO WS-ST-ACCESS.
 11614     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11615     MOVE '3'                    TO CNTL-REC-TYPE.
 11616     MOVE +0                     TO CNTL-SEQ-NO.
 11617     MOVE 'STAT'                 TO FILE-SWITCH.
 11618
 11619     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11620
 11621     IF WS-PMT-TOL = +0
 11622         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11623
 11624     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 222
* EL156.cbl
 11625     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11626     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11627     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11628     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11629
 11630****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11631****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11632     IF PI-PAYEE-TYPE <> 'B'
 11633           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11634     END-IF.
 11635
 11636     IF PI-PMTTYPE      = '2'  AND
 11637        PI-SPLIT-PMT-SW = 'Y'  AND
 11638        (CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1 OR 'O')
 11639          MOVE ER-3530                TO EMI-ERROR
 11640          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11641
 11642********* 1280-FIND-BENEFIT-TOLERANCES.
 11643
 11644     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11645        OR (PI-PMTTYPE = '5' OR '6')
 11646         GO TO 1300-FIND-CARR-TOLERANCES.
 11647
 11648     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11649     MOVE '4'                    TO CNTL-REC-TYPE.
 11650     MOVE +0                     TO CNTL-SEQ-NO.
 11651     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11652     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11653     MOVE 'BENE'                 TO FILE-SWITCH.
 11654
 11655     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11656
 11657     IF NO-BENEFIT-FOUND
 11658         GO TO 1950-NOT-FOUND.
 11659
 11660     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11661     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11662     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11663
 11664
 11665* EXEC CICS HANDLE CONDITION
 11666*        NOTFND(1950-NOT-FOUND)
 11667*    END-EXEC.
 11668*    MOVE '"$I                   ! , #00011136' TO DFHEIV0
 11669     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11670     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11671     MOVE X'2C20233030303131313336' TO DFHEIV0(25:11)
 11672     CALL 'kxdfhei1' USING DFHEIV0
 11673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11674
 11675
 11676 1300-FIND-CARR-TOLERANCES.
 11677     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11678     MOVE '6'                    TO CNTL-REC-TYPE.
 11679
 11680     IF CONTROL-IS-ACTUAL-CARRIER
 11681         MOVE PI-CARRIER               TO WS-CARR
 11682     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 223
* EL156.cbl
 11683         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11684
 11685     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11686     MOVE +0                     TO CNTL-SEQ-NO.
 11687     MOVE 'CARR'                 TO FILE-SWITCH.
 11688
 11689     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11690
 11691     IF WS-DAYS-TOL = +0
 11692         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11693
 11694     IF WS-PMT-TOL = +0
 11695         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11696
 11697     IF WS-MAX-DAYS-TOL = +0
 11698         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11699
 11700     IF WS-MAX-PMT-TOL = +0
 11701         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11702                                    PI-MAX-PMT-TOL.
 11703
 11704     IF WS-MAX-LF-PMT-TOL = +0
 11705        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11706                                    PI-MAX-LF-PMT-TOL.
 11707
 11708     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11709
 11710********* 1320-FIND-COMP-TOLERANCES.
 11711
 11712     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11713     MOVE '1'                    TO CNTL-REC-TYPE.
 11714     MOVE SPACES                 TO CNTL-ACCESS.
 11715     MOVE +0                     TO CNTL-SEQ-NO.
 11716     MOVE 'COMP'                 TO FILE-SWITCH.
 11717
 11718     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11719
 11720     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11721     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11722
 11723     IF WS-PMT-TOL NOT = +0
 11724        IF WS-TOL-SEVERITY NOT = ' '
 11725         GO TO 1360-EDIT-DAYS.
 11726
 11727     IF WS-PMT-TOL = +0
 11728         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11729
 11730     IF WS-TOL-SEVERITY = ' '
 11731         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11732
 11733 1360-EDIT-DAYS.
 11734     IF PI-PMTTYPE NOT = '4'
 11735        IF PI-EDAYS NEGATIVE OR
 11736           PI-EPYAMT NEGATIVE
 11737          MOVE ER-0513             TO EMI-ERROR
 11738          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11739          MOVE -1                  TO PMTTYPEL.
 11740
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 224
* EL156.cbl
 11741     IF PI-PMTTYPE = '5' OR '6'
 11742        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11743
 11744     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11745        IF PI-PMTTYPE = '4'
 11746          MOVE PI-EDAYS          TO PI-CDAYS.
 11747
 11748     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 11749         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11750
 11751     IF PI-PMTTYPE = '4'
 11752        MOVE PI-EDAYS            TO PI-CDAYS
 11753        GO TO 1400-EDIT-PAYMENT.
 11754
 11755     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11756        GO TO 1500-EDIT-EXPENSES.
 11757
 11758*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11759*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11760*          CM-AH-BENEFIT-CD = '23'              AND
 11761*          CL-CERT-STATE    = '04'              AND
 11762*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11763*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11764*            GO TO 1362-CHECK-MAX-DAYS.
 11765
 11766     IF PI-EDAYS = ZEROS
 11767*        IF PI-COMPANY-ID = 'DMD'
 11768*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11769*            MOVE -1             TO DC-ELAPSED-DAYS
 11770*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11771*            MOVE '6'            TO DC-OPTION-CODE
 11772*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11773*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11774*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11775*            MOVE '1'            TO DC-OPTION-CODE
 11776*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11777*            IF NO-CONVERSION-ERROR
 11778*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11779*                                 + DC-ODD-DAYS-OVER
 11780*               MOVE 6           TO EDAYSL
 11781*               MOVE AL-UNNON    TO EDAYSA
 11782*            ELSE
 11783*                NEXT SENTENCE
 11784*       ELSE
 11785            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11786            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11787            MOVE '1'             TO DC-OPTION-CODE
 11788            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11789            IF NO-CONVERSION-ERROR
 11790                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11791                ADD 1                 TO PI-EDAYS
 11792                MOVE AL-UNNON         TO EDAYSA.
 11793
 11794*    IF PI-COMPANY-ID = 'DMD'
 11795*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11796*        MOVE -1                 TO DC-ELAPSED-DAYS
 11797*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11798*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 225
* EL156.cbl
 11799*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11800*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11801*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11802*        MOVE '1'                TO DC-OPTION-CODE
 11803*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11804*    ELSE
 11805         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11806         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11807         MOVE '1'                TO DC-OPTION-CODE.
 11808         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11809
 11810     IF NO-CONVERSION-ERROR
 11811        IF PI-COMPANY-ID = 'DMD'
 11812            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11813                             + DC-ODD-DAYS-OVER
 11814        ELSE
 11815            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11816            ADD 1                TO PI-CDAYS.
 11817
 11818     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11819        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11820        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11821
 11822     IF PI-EDAYS NOT NUMERIC
 11823         MOVE ER-0491            TO EMI-ERROR
 11824         GO TO 1370-DAYS-ERROR.
 11825
 11826     IF CL-NO-OF-PMTS-MADE = 0
 11827        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11828        AND CL-CERT-STATE = 'MI'
 11829        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11830            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11831     END-IF.
 11832
 11833 1362-CHECK-MAX-DAYS.
 11834
 11835     IF WS-MAX-DAYS-TOL = +999
 11836         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11837
 11838     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11839         IF PI-EDAYS = ZEROS
 11840             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11841         ELSE
 11842             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11843
 11844     IF WS-MAX-DAYS-TOL NOT = ZERO
 11845        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11846           PI-CDAYS > WS-MAX-DAYS-TOL
 11847             MOVE ER-0492          TO EMI-ERROR
 11848             GO TO 1370-DAYS-ERROR.
 11849
 11850 1365-SKIP-MAX-DAYS-EDIT.
 11851     IF PI-EDAYS = ZEROS
 11852        GO TO 1400-EDIT-PAYMENT.
 11853
 11854     IF WS-DAYS-TOL NOT = ZERO
 11855        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11856           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 226
* EL156.cbl
 11857                MOVE ER-0493     TO EMI-ERROR
 11858                GO TO 1370-DAYS-ERROR.
 11859
 11860     GO TO 1400-EDIT-PAYMENT.
 11861
 11862 1370-DAYS-ERROR.
 11863     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11864
 11865     IF EMI-MESSAGE-FORMATTED
 11866         MOVE -1                 TO EDAYSL
 11867         MOVE AL-UABON           TO EDAYSA.
 11868
 11869     GO TO 1400-EDIT-PAYMENT.
 11870
 11871 1380-EDIT-EXPENSE-PMT-AMT.
 11872     IF PI-PMTTYPE = '5' OR '6'
 11873         NEXT SENTENCE
 11874     ELSE
 11875         GO TO 1400-EDIT-PAYMENT.
 11876
 11877     IF WS-MAX-EXP-PMT NOT = ZEROS
 11878        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11879            MOVE ER-3529            TO EMI-ERROR
 11880            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11881
 11882     GO TO 1500-EDIT-EXPENSES.
 11883
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 227
* EL156.cbl
 11885
 11886 1390-CHECK-PAYMENT-DAYS.
 11887
 11888     IF PI-EDAYS = 0
 11889         MOVE PI-CDAYS TO WS-PD-DAYS
 11890     ELSE
 11891         MOVE PI-EDAYS TO WS-PD-DAYS
 11892     END-IF.
 11893
 11894     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11895         IF WS-PD-DAYS = 14
 11896            GO TO 1390-EXIT
 11897         END-IF
 11898     END-IF.
 11899
 11900     IF PI-COMPANY-ID = 'AHL'  AND
 11901        CM-AH-BENEFIT-CD = '1K'
 11902         IF WS-PD-DAYS = 14
 11903            GO TO 1390-EXIT
 11904         END-IF
 11905     END-IF.
 11906
 11907     IF WS-PD-DAYS < 30
 11908         MOVE ER-3549              TO EMI-ERROR
 11909         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11910     END-IF.
 11911
 11912 1390-EXIT.
 11913      EXIT.
 11914
 11915 1400-EDIT-PAYMENT.
 11916*    IF PI-COMPANY-ID = 'DMD'
 11917*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11918*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11919
 11920     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 11921        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11922        MOVE PI-CARRIER          TO ACCT-CARRIER
 11923        MOVE PI-GROUPING         TO ACCT-GROUPING
 11924        MOVE PI-STATE            TO ACCT-STATE
 11925        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11926        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11927        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11928        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11929
 11930
 11931* EXEC CICS READ
 11932*          DATASET ('ERACCT')
 11933*          RIDFLD  (ERACCT-KEY)
 11934*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11935*          GTEQ
 11936*          resp    (WS-RESPONSE)
 11937*       END-EXEC
 11938     MOVE 'ERACCT' TO DFHEIV1
 11939*    MOVE '&"S        G          (  N#00011394' TO DFHEIV0
 11940     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11942     MOVE X'204E233030303131333934' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 228
* EL156.cbl
 11943     CALL 'kxdfhei1' USING DFHEIV0,
 11944           DFHEIV1,
 11945           DFHEIV20,
 11946           DFHEIV99,
 11947           ERACCT-KEY,
 11948           DFHEIV99,
 11949           DFHEIV99,
 11950           DFHEIV99
 11951     SET ADDRESS OF ACCOUNT-MASTER TO
 11952         DFHEIV20
 11953     MOVE EIBRESP  TO WS-RESPONSE
 11954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11955        IF WS-RESP-NORMAL
 11956           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11957           and pi-cert-eff-dt < am-expiration-dt
 11958           and pi-cert-eff-dt >= am-effective-dt
 11959           move am-dcc-product-code to pi-dcc-product-code
 11960        else
 11961           move spaces           to pi-dcc-product-code
 11962        end-if
 11963        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11964           PERFORM 0900-GET-DDF-LIMITS
 11965                                 THRU 0900-EXIT
 11966           IF PDEF-FOUND
 11967              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11968                 (P1 > +8)
 11969                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11970              END-PERFORM
 11971              IF P1 < +9
 11972                 if pd-ben-pct (p1) not numeric
 11973                    move zeros   to pd-ben-pct (p1)
 11974                 end-if
 11975                 if pd-ben-pct (p1) = zeros
 11976                    move +1      to ws-work-ben-pct
 11977                 else
 11978                    move pd-ben-pct (p1)
 11979                                 to ws-work-ben-pct
 11980                 end-if
 11981                 compute cm-ah-benefit-amt =
 11982                    cm-ah-benefit-amt * ws-work-ben-pct
 11983                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11984                    move pd-max-amt (p1) to cm-ah-benefit-amt
 11985                 end-if
 11986              else
 11987                 move er-1674    to emi-error
 11988                 PERFORM 9900-ERROR-FORMAT
 11989                                 THRU 9900-EXIT
 11990              END-IF
 11991           else
 11992              move er-1672       to emi-error
 11993              PERFORM 9900-ERROR-FORMAT
 11994                                 THRU 9900-EXIT
 11995           END-IF
 11996        end-if
 11997     END-IF
 11998     IF PI-PMTTYPE NOT = '4'
 11999        GO TO 1405-CALC-PAYMENT.
 12000     IF PI-EDAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 229
* EL156.cbl
 12001         MOVE PI-EPYAMT           TO PI-CPYAMT
 12002         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 12003         GO TO 1430-CHECK-AH-TOLERANCE.
 12004
 12005*    IF PI-COMPANY-ID = 'FIA'
 12006*       IF CERT-ACCOUNT = '0000011043'
 12007*        COMPUTE PI-DAILY-RATE ROUNDED =
 12008*                      (CM-AH-BENEFIT-AMT * 13) / 365
 12009*        COMPUTE PI-CPYAMT ROUNDED =
 12010*                          PI-DAILY-RATE * PI-EDAYS
 12011*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 12012*        GO TO 1430-CHECK-AH-TOLERANCE.
 12013
 12014     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 12015         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12016         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 12017         GO TO 1420-CHECK-AIG-BENEFIT.
 12018
 12019     IF WS-CALC-METHOD = '2' OR  '5'
 12020         COMPUTE PI-DAILY-RATE ROUNDED =
 12021                        (CM-AH-BENEFIT-AMT * 12) / 365
 12022         COMPUTE PI-CPYAMT ROUNDED =
 12023                           PI-DAILY-RATE * PI-EDAYS
 12024        GO TO 1420-CHECK-AIG-BENEFIT.
 12025
 12026     IF WS-CALC-METHOD = '3'
 12027         COMPUTE PI-DAILY-RATE =
 12028                         (CM-AH-BENEFIT-AMT * 12) / 365
 12029         COMPUTE PI-CPYAMT ROUNDED =
 12030                           PI-DAILY-RATE * PI-EDAYS
 12031        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 230
* EL156.cbl
 12033*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 12034
 12035****************************************************************
 12036****************************************************************
 12037*                  CALCULATED FROM      PAYMENT      PAYMENT
 12038*   DATES           DATE ROUTINE        OPT  1       OPT  6
 12039* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 12040*1-01-83  1-15-83    0    15     15        15           15
 12041*1-01-83  1-30-83    0    30     30        30           30
 12042*1-01-83  1-31-83    1     0     31        30           30
 12043*1-01-83  2-01-83    1     1     32        31           31
 12044*1-01-83  2-15-83    1    15     46        45           45
 12045*1-01-83  2-28-83    2     0     59        60           60
 12046*1-01-83  3-01-83    2     1     60        61           61
 12047*1-01-83  3-31-83    3     0     90        90           90
 12048*1-15-83  1-31-83    0    17     17        17           16
 12049*1-15-83  2-01-83    0    18     18        18           17
 12050*1-15-83  2-28-83    1    14     45        44           46
 12051*1-21-83  3-09-83    1    20     48        50           49
 12052*2-05-83  3-06-83    1     2     30        32           32
 12053*2-05-83  3-23-83    1    19     47        49           49
 12054*2-15-83  2-28-83    0    14     14        14           16
 12055*2-15-83  3-01-83    0    15     15        15           17
 12056*2-21-83  3-19-83    0    27     27        27           29
 12057*2-21-83  3-20-83    1     0     28        30           30
 12058*2-21-83  4-10-83    1    18     49        30           50
 12059*2-21-83  5-19-83    2    27     88        87           89
 12060*2-21-83  5-22-83    3     2     91        92           92
 12061*3-21-83  5-19-83    1    30     60        60           59
 12062****************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 231
* EL156.cbl
 12064 1405-CALC-PAYMENT.
 12065     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12066     MOVE ' '                    TO DC-OPTION-CODE.
 12067     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12068     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 12069     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 12070
 12071     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12072     MOVE ' '                    TO DC-OPTION-CODE.
 12073     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12074     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 12075     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 12076
 12077     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12078     MOVE -1                     TO DC-ELAPSED-DAYS.
 12079     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 12080     MOVE '6'                    TO DC-OPTION-CODE.
 12081     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12082     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 12083
 12084     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 12085     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 12086     MOVE '1'                    TO DC-OPTION-CODE.
 12087     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12088
 12089     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 12090     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 12091     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 12092
 12093******************************************************************
 12094*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 12095*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 12096*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 12097******************************************************************
 12098
 12099     IF WS-CALC-METHOD = '1'           AND
 12100        DC-ELAPSED-MONTHS > ZERO AND
 12101        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 12102        WDF-DAY > WDT-DAY
 12103          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 12104          MOVE ZEROS               TO DC-ELAPSED-DAYS
 12105          MOVE -1                  TO DC-ELAPSED-MONTHS
 12106          MOVE '6'                 TO DC-OPTION-CODE
 12107          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12108          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 12109          COMPUTE WS-SAVE-ODD-DAYS =
 12110          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 12111          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 12112
 12113     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 12114     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 12115     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 12116
 12117     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 12118     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 12119
 12120*    IF PI-COMPANY-ID = 'FIA'
 12121*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 232
* EL156.cbl
 12122*        COMPUTE PI-DAILY-RATE ROUNDED =
 12123*                          (CM-AH-BENEFIT-AMT * 13) / 365
 12124*        COMPUTE PI-CPYAMT ROUNDED =
 12125*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 12126*        GO TO 1420-CHECK-AIG-BENEFIT.
 12127
 12128*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12129*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 12130*          CM-AH-BENEFIT-CD = '23'               AND
 12131*          CL-CERT-STATE    = '04'               AND
 12132*         (PI-PMTTYPE = '1' OR '2' OR '3')
 12133*            COMPUTE WS-DAILY-RATE ROUNDED =
 12134*                               CM-AH-BENEFIT-AMT / 30
 12135*            COMPUTE PI-CPYAMT ROUNDED =
 12136*                               (WS-DAILY-RATE * PI-CDAYS)
 12137*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12138*            GO TO 1420-CHECK-AIG-BENEFIT.
 12139
 12140     IF WS-CALC-METHOD = '1'
 12141         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12142         COMPUTE PI-CPYAMT ROUNDED =
 12143             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12144             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12145         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 12146         GO TO 1420-CHECK-AIG-BENEFIT.
 12147
 12148     IF WS-CALC-METHOD = '2'
 12149         COMPUTE PI-DAILY-RATE ROUNDED =
 12150                          (CM-AH-BENEFIT-AMT * 12) / 365
 12151         COMPUTE PI-CPYAMT ROUNDED =
 12152             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12153             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12154         GO TO 1420-CHECK-AIG-BENEFIT.
 12155
 12156     IF WS-CALC-METHOD = '4'
 12157         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 12158         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 12159         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12160         COMPUTE PI-CPYAMT ROUNDED =
 12161                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 12162         GO TO 1420-CHECK-AIG-BENEFIT.
 12163
 12164     IF WS-CALC-METHOD = '5'
 12165         COMPUTE PI-DAILY-RATE ROUNDED =
 12166                            (CM-AH-BENEFIT-AMT * 12) / 365
 12167         COMPUTE PI-CPYAMT ROUNDED =
 12168                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 12169         GO TO 1420-CHECK-AIG-BENEFIT.
 12170
 12171     IF WS-CALC-METHOD NOT = '3'
 12172        GO TO 1410-CHECK-PAYMENT.
 12173
 12174******   CALCULATION METHOD  3  ROUTINE
 12175     COMPUTE PI-DAILY-RATE =
 12176                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 12177
 12178******CHECK TO SEE IF WITHIN SAME MONTH
 12179     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 233
* EL156.cbl
 12180        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 12181                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 12182         GO TO 1420-CHECK-AIG-BENEFIT.
 12183
 12184******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 12185     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 12186             SAVE-ODD-DAYS-OVER = ZEROS
 12187      COMPUTE PI-CPYAMT  ROUNDED =
 12188                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 12189      GO TO 1420-CHECK-AIG-BENEFIT.
 12190
 12191******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 12192******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 12193     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12194        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 12195        IF WDF-MONTH > 12
 12196           ADD 1                 TO WDF-YEAR
 12197           SUBTRACT 12         FROM WDF-MONTH.
 12198
 12199******CONVERT THE NEW FROM MONTH TO BINARY
 12200     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12201        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 12202        MOVE '4'              TO DC-OPTION-CODE
 12203        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12204        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 12205
 12206     IF WDF-MONTH = WDT-MONTH AND
 12207        WDF-YEAR  = WDT-YEAR
 12208          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 12209                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 12210                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 12211        ELSE
 12212          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 12213          MOVE WDT-DAY              TO THRU-PMT-DAYS
 12214          COMPUTE PI-CPYAMT ROUNDED =
 12215       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 12216       +
 12217       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 12218       +
 12219       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 12220
 12221     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 234
* EL156.cbl
 12223 1410-CHECK-PAYMENT.
 12224******PAYMENT OPTION 6
 12225******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 12226     IF SAVE-ELAPSED-MONTHS > ZERO
 12227        IF SAVE-ODD-DAYS-OVER = ZEROS
 12228           GO TO 1412-CHECK-TO-DAY
 12229        ELSE
 12230           IF WDF-DAY > WDT-DAY
 12231              IF WDF-MONTH = 02
 12232                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12233                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 12234                  GO TO 1412-CHECK-TO-DAY
 12235              ELSE
 12236                  IF FROM-DAYS-IN-MONTH = 31
 12237                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 12238                     GO TO 1412-CHECK-TO-DAY
 12239                  ELSE
 12240                     GO TO 1412-CHECK-TO-DAY
 12241           ELSE
 12242               GO TO 1412-CHECK-TO-DAY.
 12243
 12244     IF WDF-MONTH NOT = WDT-MONTH
 12245        IF WDF-MONTH = 02
 12246           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12247           IF WDF-DAY = 29
 12248              ADD 1              TO SAVE-ODD-DAYS-OVER
 12249           ELSE
 12250              ADD 2              TO SAVE-ODD-DAYS-OVER
 12251        ELSE
 12252           IF FROM-DAYS-IN-MONTH = 31
 12253              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12254
 12255 1412-CHECK-TO-DAY.
 12256        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 12257           IF WDT-DAY = 28
 12258              ADD 2              TO SAVE-ODD-DAYS-OVER
 12259           ELSE
 12260              IF WDT-DAY = 29
 12261                 ADD 1           TO SAVE-ODD-DAYS-OVER
 12262              ELSE
 12263                 NEXT SENTENCE
 12264        ELSE
 12265           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 12266              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12267
 12268     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12269     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12270     COMPUTE PI-CPYAMT ROUNDED =
 12271         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12272         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12273
 12274     GO TO 1420-CHECK-AIG-BENEFIT.
 12275
 12276 1415-CHECK-LEAP-YEAR.
 12277     IF FROM-DAYS-IN-MONTH = 29
 12278        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12279
 12280 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 235
* EL156.cbl
 12281     EXIT.
 12282
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 236
* EL156.cbl
 12284 1420-CHECK-AIG-BENEFIT.
 12285
 12286     IF WS-SPECIAL-CALC-CD = 'Q'
 12287         GO TO 1425-CHECK-WHOLE-MONTH.
 12288
 12289*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12290*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12291*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12292*       (PI-PMTTYPE = '1' OR '2')
 12293*        NEXT SENTENCE
 12294*    ELSE
 12295         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12296         GO TO 1430-CHECK-AH-TOLERANCE.
 12297
 12298******************AIG LOGIC STARTS**********************
 12299*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12300*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12301*    MOVE ER-3533      TO EMI-ERROR.
 12302*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12303*    GO TO 1430-CHECK-AH-TOLERANCE.
 12304******************AIG LOGIC ENDS************************
 12305
 12306 1425-CHECK-WHOLE-MONTH.
 12307******************************************************************
 12308****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12309****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12310****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12311****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12312****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12313****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12314****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12315****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12316****          PAID * MONTHLY BENEFIT.                         ****
 12317******************************************************************
 12318
 12319     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12320
 12321     IF CL-NO-OF-PMTS-MADE > +0
 12322         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12323
 12324     IF PI-CDAYS < WS-BEN-DAYS
 12325         GO TO 1430-CHECK-AH-TOLERANCE.
 12326
 12327     IF PI-CDAYS = WS-BEN-DAYS
 12328         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12329         GO TO 1430-CHECK-AH-TOLERANCE.
 12330
 12331*    IF PI-COMPANY-ID = 'ACM'
 12332*       NEXT SENTENCE
 12333*    ELSE
 12334        GO TO 1425-NOT-ACM-W15C.
 12335
 12336*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12337*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12338*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12339*    MOVE '6'                    TO  DC-OPTION-CODE.
 12340*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12341*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 237
* EL156.cbl
 12342*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12343*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12344*       MOVE '1'                 TO  DC-OPTION-CODE
 12345*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12346*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12347*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12348*       IF NO-CONVERSION-ERROR
 12349*          IF (DC-ELAPSED-MONTHS > +0) OR
 12350*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12351*             NEXT SENTENCE
 12352*          ELSE
 12353*             MOVE +0            TO  PI-CPYAMT
 12354*             MOVE ER-0846       TO  EMI-ERROR
 12355*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12356*             GO TO 1430-CHECK-AH-TOLERANCE
 12357*       ELSE
 12358*           MOVE ER-0846         TO  EMI-ERROR
 12359*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12360*           GO TO 1430-CHECK-AH-TOLERANCE.
 12361*
 12362*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12363*       ADD +1 TO DC-ELAPSED-MONTHS.
 12364*
 12365*    COMPUTE PI-CPYAMT ROUNDED =
 12366*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12367*
 12368*    GO TO 1430-CHECK-AH-TOLERANCE.
 12369
 12370 1425-NOT-ACM-W15C.
 12371
 12372     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12373     MOVE '6'                        TO  DC-OPTION-CODE.
 12374     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12375     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12376
 12377     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12378     IF NO-CONVERSION-ERROR
 12379         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12380     ELSE
 12381         MOVE ER-0846                TO  EMI-ERROR
 12382         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12383         GO TO 1430-CHECK-AH-TOLERANCE.
 12384
 12385     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12386     MOVE '1'                        TO  DC-OPTION-CODE.
 12387     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12388     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12389     IF NO-CONVERSION-ERROR
 12390         IF DC-ODD-DAYS-OVER = +0
 12391             NEXT SENTENCE
 12392         ELSE
 12393             MOVE ER-0846            TO  EMI-ERROR
 12394             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12395             GO TO 1430-CHECK-AH-TOLERANCE
 12396     ELSE
 12397         MOVE ER-0846                TO  EMI-ERROR
 12398         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12399         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 238
* EL156.cbl
 12400
 12401     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12402         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12403
 12404     GO TO 1430-CHECK-AH-TOLERANCE.
 12405
 12406 1425-CONT-WHOLE-MONTH-PMTS.
 12407******************************************************************
 12408****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12409****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12410****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12411******************************************************************
 12412
 12413     IF PI-COMPANY-ID = 'ACM'
 12414        NEXT SENTENCE
 12415     ELSE
 12416        IF DC-ODD-DAYS-OVER = +0
 12417            NEXT SENTENCE
 12418        ELSE
 12419            MOVE ER-0845            TO  EMI-ERROR
 12420            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12421            GO TO 1430-CHECK-AH-TOLERANCE.
 12422
 12423     COMPUTE PI-CPYAMT ROUNDED =
 12424                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12425
 12426 1430-CHECK-AH-TOLERANCE.
 12427     IF PI-PMT-APPR-SW = 'G'
 12428         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12429
 12430*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12431*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12432*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12433*
 12434*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12435*      IF WDF-MONTH = 02
 12436*        IF SAVE-ELAPSED-MONTHS = 0
 12437*          NEXT SENTENCE
 12438*        ELSE
 12439*          IF SAVE-ODD-DAYS-OVER > 0
 12440*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12441*            COMPUTE WS-PMT-MOS ROUNDED =
 12442*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12443*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12444*                                     WS-PMT-MOS
 12445*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12446*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12447*          ELSE
 12448*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12449*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12450*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12451*                                     WS-PMT-MOS.
 12452
 12453     IF WS-MAX-PMT-TOL NOT = ZERO
 12454        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12455           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12456            MOVE ER-0494         TO  EMI-ERROR
 12457            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 239
* EL156.cbl
 12458            GO TO 1500-EDIT-EXPENSES.
 12459
 12460 1430-CONT-CHECK-AH-TOLERANCE.
 12461
 12462     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12463        GO TO 1500-EDIT-EXPENSES.
 12464
 12465     IF CM-O-B-COVERAGE
 12466        GO TO 1500-EDIT-EXPENSES.
 12467
 12468     IF PI-COMPANY-ID = 'NCL'
 12469       IF FOUND-TOL-SW = 'Y'
 12470         IF WS-PMT-TOL NOT = ZERO
 12471           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12472              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12473                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12474                  IF WS-NCL-PMT-OPTION = SPACES
 12475                      MOVE ER-0699 TO EMI-ERROR
 12476                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12477                  ELSE
 12478                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12479                      NEXT SENTENCE
 12480                  ELSE
 12481                  IF NOT WS-VALID-NCL-OPTION
 12482                      MOVE ER-0699 TO EMI-ERROR
 12483                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12484
 12485     IF WS-PMT-TOL NOT = ZERO
 12486        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12487           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12488           MOVE ER-0495          TO EMI-ERROR
 12489           PERFORM 1490-PAYMENT-ERROR
 12490                                 THRU 1490-EXIT
 12491        end-if
 12492     end-if
 12493
 12494     GO TO 1500-EDIT-EXPENSES.
 12495
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 240
* EL156.cbl
 12497 1440-COMPUTE-LIFE-REMAINING.
 12498
 12499     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12500        IF PI-PMTTYPE = '4'
 12501          MOVE PI-EPYAMT TO PI-CPYAMT
 12502          GO TO 1460-TEST-TYPE.
 12503
 12504     IF WS-LF-COVERAGE-TYPE = 'L'
 12505        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12506                          - CL-TOTAL-PAID-AMT
 12507        GO TO 1450-CHECK-MAX.
 12508
 12509     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12510        PI-LF-COVERAGE-TYPE = 'P'
 12511          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12512                              CM-LF-ITD-DEATH-AMT
 12513          GO TO 1450-CHECK-MAX.
 12514
 12515     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12516     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12517     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12518     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12519     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12520     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12521     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12522     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12523     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12524
 12525     PERFORM 9800-LINK-REM-TERM.
 12526
 12527     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12528     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12529     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12530     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12531     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12532     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12533     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12534     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12535     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12536     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12537     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12538     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12539     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12540     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12541     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12542     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12543     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 12544        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12545        MOVE PI-CARRIER          TO ACCT-CARRIER
 12546        MOVE PI-GROUPING         TO ACCT-GROUPING
 12547        MOVE PI-STATE            TO ACCT-STATE
 12548        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12549        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12550        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12551        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12552
 12553
 12554* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 241
* EL156.cbl
 12555*          DATASET ('ERACCT')
 12556*          RIDFLD  (ERACCT-KEY)
 12557*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12558*          GTEQ
 12559*          resp    (WS-RESPONSE)
 12560*       END-EXEC
 12561     MOVE 'ERACCT' TO DFHEIV1
 12562*    MOVE '&"S        G          (  N#00011999' TO DFHEIV0
 12563     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12564     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12565     MOVE X'204E233030303131393939' TO DFHEIV0(25:11)
 12566     CALL 'kxdfhei1' USING DFHEIV0,
 12567           DFHEIV1,
 12568           DFHEIV20,
 12569           DFHEIV99,
 12570           ERACCT-KEY,
 12571           DFHEIV99,
 12572           DFHEIV99,
 12573           DFHEIV99
 12574     SET ADDRESS OF ACCOUNT-MASTER TO
 12575         DFHEIV20
 12576     MOVE EIBRESP  TO WS-RESPONSE
 12577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12578        IF WS-RESP-NORMAL
 12579           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12580           and (pi-cert-eff-dt < am-expiration-dt)
 12581           and (pi-cert-eff-dt >= am-effective-dt)
 12582           move am-dcc-product-code to pi-dcc-product-code
 12583        else
 12584           move spaces           to pi-dcc-product-code
 12585        end-if
 12586        if pi-dcc-product-code not = spaces
 12587           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12588           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12589           PERFORM 0900-GET-DDF-limits
 12590                                 THRU 0900-EXIT
 12591           IF PDEF-FOUND
 12592              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12593                 (P1 > +8)
 12594                 OR (PD-PROD-CODE (P1) = 'L')
 12595              END-PERFORM
 12596              IF P1 < +9
 12597                 MOVE PD-MAX-AMT (P1)
 12598                                 TO CP-R-MAX-TOT-BEN
 12599              else
 12600                 move er-1674    to emi-error
 12601                 PERFORM 9900-ERROR-FORMAT
 12602                                 THRU 9900-EXIT
 12603              END-IF
 12604           else
 12605              move er-1672       to emi-error
 12606              PERFORM 9900-ERROR-FORMAT
 12607                                 THRU 9900-EXIT
 12608           END-IF
 12609        end-if
 12610     END-IF
 12611
 12612* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 242
* EL156.cbl
 12613*       PROGRAM  (LINK-REMAMT)
 12614*       COMMAREA (CALCULATION-PASS-AREA)
 12615*       LENGTH   (CP-COMM-LENGTH)
 12616*    END-EXEC.
 12617*    MOVE '."C                   (   #00012039' TO DFHEIV0
 12618     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12619     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12620     MOVE X'2020233030303132303339' TO DFHEIV0(25:11)
 12621     CALL 'kxdfhei1' USING DFHEIV0,
 12622           LINK-REMAMT,
 12623           CALCULATION-PASS-AREA,
 12624           CP-COMM-LENGTH,
 12625           DFHEIV99,
 12626           DFHEIV99,
 12627           DFHEIV99,
 12628           DFHEIV99
 12629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12630
 12631
 12632     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12633
 12634     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12635     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12636
 12637     IF PI-COMPANY-ID = 'BOA' AND
 12638        PI-PMTTYPE    = '2'   AND
 12639        PI-OFFLINE    = 'N'
 12640           GO TO 1441-COMPUTE-BOA-INTEREST.
 12641
 12642     IF PI-COMPANY-ID = 'NCL' AND
 12643        PI-PMTTYPE    = '2'   AND
 12644        PI-OFFLINE    = 'N'
 12645          GO TO 1442-COMPUTE-NCL-INTEREST
 12646       ELSE
 12647          GO TO 1445-CONTINUE.
 12648
 12649 1441-COMPUTE-BOA-INTEREST.
 12650     MOVE +0             TO WS-CALC-INT.
 12651
 12652     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12653     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12654     MOVE +0             TO DC-ELAPSED-MONTHS
 12655                            DC-ELAPSED-DAYS.
 12656     MOVE '1'            TO DC-OPTION-CODE.
 12657     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12658     IF NO-CONVERSION-ERROR
 12659         NEXT SENTENCE
 12660     ELSE
 12661         GO TO 1445-CONTINUE.
 12662
 12663     IF (PI-INT-RATE NOT > ZEROS)  AND
 12664        (DC-ELAPSED-DAYS > +30)
 12665         MOVE ER-3531            TO EMI-ERROR
 12666         MOVE -1                 TO PINTL
 12667         MOVE AL-UNBON           TO PINTA
 12668         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12669
 12670     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 243
* EL156.cbl
 12671         GO TO 1445-CONTINUE.
 12672
 12673     IF (PI-INT-RATE NOT > ZEROS)  OR
 12674        (DC-ELAPSED-DAYS NOT > +30)
 12675         MOVE PI-EPYAMT TO PI-CPYAMT
 12676         GO TO 1441-FORMAT-NOTE.
 12677
 12678     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12679                                 *  PI-INT-RATE
 12680                                 *  DC-ELAPSED-DAYS
 12681                                 /  365
 12682                                 /  100.
 12683
 12684     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12685
 12686 1441-FORMAT-NOTE.
 12687
 12688     MOVE SPACES        TO WS-BOANOTE1.
 12689     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12690     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12691     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12692     MOVE AL-UANON      TO NOTE1A.
 12693
 12694     IF WS-CALC-INT > ZEROS
 12695         MOVE SPACES        TO WS-BOANOTE2
 12696         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12697         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12698         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12699         MOVE AL-UANON      TO NOTE2A.
 12700
 12701     GO TO 1445-CONTINUE.
 12702
 12703 1442-COMPUTE-NCL-INTEREST.
 12704     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12705     MOVE PI-STATE               TO WS-ST-ACCESS.
 12706     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12707     MOVE '3'                    TO CNTL-REC-TYPE.
 12708     MOVE +0                     TO CNTL-SEQ-NO.
 12709     MOVE 'STAT'                 TO FILE-SWITCH.
 12710
 12711     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12712
 12713     MOVE +0                 TO WS-CALC-INT.
 12714
 12715     IF ST-STAT-FROM-INCURRED
 12716         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12717       ELSE
 12718     IF ST-STAT-FROM-REPORTED
 12719         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12720       ELSE
 12721         GO TO 1445-CONTINUE.
 12722
 12723     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12724     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12725     MOVE +0                 TO DC-ELAPSED-MONTHS
 12726                                DC-ELAPSED-DAYS.
 12727     MOVE '1'                TO DC-OPTION-CODE.
 12728     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 244
* EL156.cbl
 12729     IF NO-CONVERSION-ERROR
 12730         NEXT SENTENCE
 12731     ELSE
 12732         GO TO 1445-CONTINUE.
 12733
 12734     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12735        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12736         GO TO 1445-CONTINUE.
 12737
 12738     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12739                                 *  CF-ST-STAT-INTEREST.
 12740
 12741     MOVE SPACES              TO WS-NCLNOTE1.
 12742     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12743     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12744     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12745                                 PI-PMTNOTE1
 12746                                 NOTE1I.
 12747     MOVE AL-UANON            TO NOTE1A.
 12748
 12749     IF WS-CALC-INT > ZEROS
 12750         MOVE SPACES          TO WS-NCLNOTE2
 12751         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12752         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12753         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12754                                 PI-PMTNOTE2
 12755                                 NOTE2I
 12756         MOVE AL-UANON        TO NOTE2A.
 12757
 12758     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12759
 12760 1445-CONTINUE.
 12761
 12762     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12763        GO TO 1460-TEST-TYPE.
 12764
 12765     IF CM-O-B-COVERAGE
 12766        GO TO 1460-TEST-TYPE.
 12767
 12768     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12769         GO TO 1450-CHECK-MAX.
 12770
 12771     if (pi-company-id = 'DCC' or 'VPP')
 12772        and (pdef-found)
 12773        if pi-epyamt > pd-max-amt (p1)
 12774           move er-1657          to emi-error
 12775           perform 1490-payment-error
 12776                                 thru 1490-exit
 12777           go to 1460-test-type
 12778        end-if
 12779     else
 12780        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12781           > PI-EPYAMT)
 12782                         OR
 12783           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12784           < PI-EPYAMT)
 12785           MOVE ER-0594          TO EMI-ERROR
 12786           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 245
* EL156.cbl
 12787                                 THRU 1490-EXIT
 12788           GO TO 1460-TEST-TYPE
 12789        end-if
 12790     end-if
 12791     .
 12792 1450-CHECK-MAX.
 12793
 12794     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12795        PI-LF-COVERAGE-TYPE = 'P'
 12796         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12797                                   CM-LF-ITD-DEATH-AMT
 12798     ELSE
 12799         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12800                                   CL-TOTAL-PAID-AMT.
 12801
 12802     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12803          MOVE ER-0543           TO EMI-ERROR
 12804          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12805
 12806 1460-TEST-TYPE.
 12807
 12808     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12809        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 12810           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12811                                   CM-LF-ALT-BENEFIT-AMT -
 12812                                   CL-TOTAL-PAID-AMT
 12813           IF PI-EPYAMT > WS-LF-BEN-AMT
 12814               MOVE ER-0543      TO EMI-ERROR
 12815               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12816           END-IF
 12817        END-IF
 12818     END-IF
 12819
 12820     IF PI-PMT-APPR-SW = 'G'
 12821       NEXT SENTENCE
 12822     ELSE
 12823       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12824         IF PI-EPYAMT = ZERO
 12825             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12826                 MOVE ER-0494    TO  EMI-ERROR
 12827                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12828                 GO TO 1500-EDIT-EXPENSES
 12829             ELSE
 12830                 NEXT SENTENCE
 12831         ELSE
 12832             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12833                 MOVE ER-0494    TO  EMI-ERROR
 12834                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12835                 GO TO 1500-EDIT-EXPENSES.
 12836
 12837     IF PI-PMTTYPE NOT = '2' OR
 12838        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12839         GO TO 1500-EDIT-EXPENSES.
 12840
 12841     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12842     MOVE ER-0526                TO EMI-ERROR.
 12843     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12844
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 246
* EL156.cbl
 12845     IF EMI-ERROR-NUMBER (1) = '0526'
 12846        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12847
 12848     IF EMI-ERROR-NUMBER (2) = '0526'
 12849        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12850
 12851     GO TO 1500-EDIT-EXPENSES.
 12852
 12853 1490-PAYMENT-ERROR.
 12854     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12855
 12856     IF EMI-MESSAGE-FORMATTED
 12857         MOVE -1                 TO EPYAMTL
 12858         MOVE AL-UNBON           TO EPYAMTA.
 12859
 12860 1490-EXIT.
 12861      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 247
* EL156.cbl
 12863 1500-EDIT-EXPENSES.
 12864     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12865         GO TO 1500-SKIP-ERROR-0556.
 12866
 12867 1500-CONTINUE-ON.
 12868
 12869     IF CM-O-B-COVERAGE
 12870        MOVE ER-0556             TO EMI-ERROR
 12871        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12872
 12873 1500-SKIP-ERROR-0556.
 12874     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12875        IF PI-EEXPENS NOT = ZEROS
 12876           MOVE ER-0524          TO EMI-ERROR
 12877           GO TO 1590-EXPENSE-ERROR
 12878        ELSE
 12879           GO TO 1600-EDIT-RESERVES.
 12880
 12881     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12882     MOVE '6'                    TO CNTL-REC-TYPE.
 12883
 12884     IF CONTROL-IS-ACTUAL-CARRIER
 12885         MOVE PI-CARRIER         TO WS-CARR
 12886     ELSE
 12887         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12888
 12889     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12890     MOVE +0                     TO CNTL-SEQ-NO.
 12891     MOVE 'CARR'                 TO FILE-SWITCH.
 12892
 12893     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12894
 12895     IF EXPENSE-CALC-MANUAL
 12896        GO TO 1600-EDIT-RESERVES.
 12897
 12898     IF DOLLARS-PER-PMT
 12899        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12900        GO TO 1600-EDIT-RESERVES.
 12901
 12902     IF DOLLARS-PER-MONTH AND
 12903        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12904       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12905       GO TO 1600-EDIT-RESERVES.
 12906
 12907     IF PERCENT-OF-PAYMENT
 12908        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12909
 12910     GO TO 1600-EDIT-RESERVES.
 12911
 12912 1590-EXPENSE-ERROR.
 12913     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12914
 12915     IF EMI-MESSAGE-FORMATTED
 12916        MOVE -1                  TO EEXPENSL
 12917        MOVE AL-UNBON            TO EEXPENSA.
 12918
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 248
* EL156.cbl
 12920 1600-EDIT-RESERVES.
 12921     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12922        IF PI-ERESV = ZEROS
 12923           GO TO 1700-EDIT-EXPENSE-TYPE
 12924        ELSE
 12925           MOVE ER-0525          TO EMI-ERROR
 12926           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12927           GO TO 1700-EDIT-EXPENSE-TYPE.
 12928
 12929     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12930     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12931     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12932
 12933     IF NOT AT-MANUAL-RESERVES-USED
 12934        IF PI-ERESV NOT = ZEROS
 12935           MOVE ER-0518          TO EMI-ERROR
 12936           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12937
 12938     IF AT-MANUAL-RESERVES-USED
 12939        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12940        GO TO 1700-EDIT-EXPENSE-TYPE.
 12941
 12942     IF AT-FUTURE-RESERVES-USED
 12943        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12944
 12945     IF AT-FUTURE-RESERVES-USED
 12946        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12947
 12948     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12949        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12950
 12951     IF AT-IBNR-RESERVES-USED
 12952        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12953
 12954     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12955     GO TO 1700-EDIT-EXPENSE-TYPE.
 12956
 12957 1690-RESERVE-ERROR.
 12958     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12959
 12960     IF EMI-MESSAGE-FORMATTED
 12961        MOVE AL-UNBON            TO ERESVA
 12962        MOVE -1                  TO ERESVL.
 12963
 12964 1690-EXIT.
 12965      EXIT.
 12966
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 249
* EL156.cbl
 12968 1700-EDIT-EXPENSE-TYPE.
 12969     IF PI-PMTTYPE NOT = '5' AND '6'
 12970        GO TO 2000-EDIT-DONE.
 12971
 12972     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12973                   '6' OR '7' OR '8' OR '9'
 12974        GO TO 2000-EDIT-DONE.
 12975
 12976 1705-EXPENSE-ERROR.
 12977     MOVE ER-0573                TO EMI-ERROR.
 12978     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12979
 12980     IF EMI-MESSAGE-FORMATTED
 12981        MOVE AL-UABON            TO ETYPEA
 12982        MOVE -1                  TO ETYPEL.
 12983
 12984     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 250
* EL156.cbl
 12986 1950-NOT-FOUND.
 12987     IF FILE-SWITCH = 'MSTR'
 12988        MOVE ER-0204             TO EMI-ERROR.
 12989
 12990     IF FILE-SWITCH = 'CARR'
 12991        MOVE ER-0252             TO EMI-ERROR.
 12992
 12993     IF FILE-SWITCH = 'COMP'
 12994        MOVE ER-0254             TO EMI-ERROR.
 12995
 12996     IF FILE-SWITCH = 'STAT'
 12997        MOVE ER-0149             TO EMI-ERROR.
 12998
 12999     IF FILE-SWITCH = 'PROC'
 13000        MOVE ER-0019             TO EMI-ERROR.
 13001
 13002     IF FILE-SWITCH = 'ACCT'
 13003        MOVE ER-0198             TO EMI-ERROR.
 13004
 13005     IF FILE-SWITCH = 'BENE'
 13006        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 13007           MOVE ER-0282          TO EMI-ERROR
 13008        ELSE
 13009           MOVE ER-0283          TO EMI-ERROR.
 13010
 13011     MOVE -1                     TO PMTTYPEL.
 13012     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13013
 13014     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 13015                                     WS-FORCE-CTR.
 13016
 13017     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 13018                                     WS-FATAL-CTR.
 13019
 13020     GO TO 8200-SEND-DATAONLY.
 13021
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 251
* EL156.cbl
 13023 2000-EDIT-DONE.
 13024     perform 2210-dcc-max-benes thru 2210-exit
 13025     if pi-company-id not = 'DCC' and 'VPP'
 13026        IF (WS-SPECIAL-CALC-CD = 'C')
 13027           and (cl-critical-period > 0)
 13028           IF CM-AH-BENEFIT-AMT NOT = ZERO
 13029              IF PI-EPYAMT > ZEROS
 13030                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 13031                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 13032              ELSE
 13033                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 13034                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 13035              END-IF
 13036              if ws-benefits-paid > cl-critical-period
 13037                 MOVE ER-0657          TO EMI-ERROR
 13038                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13039              END-IF
 13040           END-IF
 13041        END-IF
 13042     end-if
 13043     IF PI-HOLDTIL NOT = ZEROS
 13044        MOVE PI-HOLDTIL          TO HOLDTILO
 13045        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'
 13046        MOVE ER-3272          TO EMI-ERROR
 13047        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13048     END-IF
 13049
 13050     IF PI-EPYFROM NOT = ZEROS
 13051        MOVE PI-EPYFROM          TO EPYFROMO
 13052        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 13053
 13054     IF PI-EPYTHRU NOT = ZEROS
 13055        MOVE PI-EPYTHRU            TO EPYTHRUO
 13056        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 13057        IF PI-USES-PAID-TO
 13058           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13059           MOVE '4'                TO DC-OPTION-CODE
 13060           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13061           IF NO-CONVERSION-ERROR
 13062              MOVE +1              TO DC-ELAPSED-DAYS
 13063              MOVE +0              TO DC-ELAPSED-MONTHS
 13064              MOVE '6'             TO DC-OPTION-CODE
 13065              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13066              IF NO-CONVERSION-ERROR
 13067                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13068
 13069     MOVE PI-EDAYS               TO EDAYSO.
 13070
 13071     IF PI-AIGFROM NOT = ZEROS
 13072        MOVE PI-AIGFROM          TO AIGFROMO
 13073        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13074
 13075     MOVE PI-EPYAMT              TO EPYAMTO.
 13076     MOVE PI-ERESV               TO ERESVO.
 13077     MOVE PI-EEXPENS             TO EEXPENSO.
 13078
 13079     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13080     MOVE SPACES                 TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 252
* EL156.cbl
 13081     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13082
 13083     IF DATE-CONVERSION-ERROR
 13084        MOVE SPACES              TO CPYFROMI
 13085     ELSE
 13086        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 13087        IF PI-EPYFROM = ZEROS
 13088           MOVE AL-UANON             TO EPYFROMA
 13089           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 13090           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 13091
 13092     IF PI-USES-PAID-TO
 13093        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 13094        MOVE +1                            TO DC-ELAPSED-DAYS
 13095        MOVE +0                            TO DC-ELAPSED-MONTHS
 13096        MOVE '6'                           TO DC-OPTION-CODE
 13097        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13098        IF NO-CONVERSION-ERROR
 13099           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 13100           IF PI-EPYTHRU = ZEROS
 13101              MOVE AL-UANON                TO EPYTHRUA
 13102              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 13103              MOVE ' '                     TO DC-OPTION-CODE
 13104              MOVE +0                      TO DC-ELAPSED-DAYS
 13105                                              DC-ELAPSED-MONTHS
 13106              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13107              IF NO-CONVERSION-ERROR
 13108                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 13109                  GO TO 2001-CONTINUE
 13110              ELSE
 13111                  GO TO 2001-CONTINUE
 13112           ELSE
 13113              GO TO 2001-CONTINUE.
 13114
 13115     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13116     MOVE SPACES                 TO DC-OPTION-CODE.
 13117     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13118
 13119     IF DATE-CONVERSION-ERROR
 13120        MOVE SPACES              TO CPYTHRUI
 13121     ELSE
 13122        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13123        IF PI-EPYTHRU = ZEROS
 13124           MOVE AL-UANON TO EPYTHRUA
 13125           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 13126           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 13127
 13128 2001-CONTINUE.
 13129
 13130     MOVE PI-CDAYS               TO CDAYSO.
 13131
 13132     IF PI-EDAYS = ZEROS
 13133        MOVE AL-UNNON TO EDAYSA
 13134        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 13135
 13136     MOVE PI-CPYAMT              TO CPYAMTO.
 13137
 13138     IF PI-EPYAMT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 253
* EL156.cbl
 13139        MOVE AL-UNNON            TO EPYAMTA
 13140        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 13141
 13142     MOVE PI-CRESV               TO CRESVO.
 13143     MOVE PI-CEXPENS             TO CEXPENSO.
 13144
 13145     IF PI-EEXPENS = ZEROS
 13146        MOVE AL-UNNON TO EEXPENSA
 13147        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 13148
 13149     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13150        AND (CL-CLAIM-TYPE = 'L')
 13151        AND (PI-OFFLINE NOT EQUAL 'Y')
 13152        IF PI-PMTTYPE = '2' OR '4'
 13153           PERFORM 2200-CALC-INTEREST
 13154                                 THRU 2200-EXIT
 13155        END-IF
 13156     END-IF
 13157     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 13158     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 13159     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 13160
 13161     IF EMI-FATAL-CTR = ZEROS
 13162        MOVE 'B'                 TO PI-PASS-SW.
 13163
 13164     IF NOT EMI-MESSAGE-FORMATTED
 13165         MOVE -1                 TO EPYFROML
 13166     ELSE
 13167         IF EMI-ERROR-NUMBER (1) = '0526' AND
 13168            EMI-ERROR-NUMBER (2) = SPACES
 13169             MOVE -1             TO EPYFROML.
 13170
 13171     GO TO 8200-SEND-DATAONLY.
 13172
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 254
* EL156.cbl
 13174 2200-CALC-INTEREST.
 13175     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 13176        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 13177        MOVE '4'                 TO DC-OPTION-CODE
 13178        PERFORM 9700-LINK-DATE-CONVERT
 13179        IF DATE-CONVERSION-ERROR
 13180            MOVE LOW-VALUES      TO CP-PRF-DT
 13181        ELSE
 13182           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 13183        END-IF
 13184     END-IF
 13185     if (pi-int-to-rem-borr <> 'Y' and 'N')
 13186        if pi-rb-joint-coverage
 13187           move 'Y'              to pi-int-to-rem-borr
 13188        end-if
 13189     end-if
 13190     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 13191        IN CLAIM-INT-PASS-AREA
 13192     MOVE CL-CERT-STATE          TO CP-STATE
 13193        IN CLAIM-INT-PASS-AREA
 13194     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 13195     MOVE 'LF'                   TO CP-COVERAGE
 13196     MOVE CL-INCURRED-DT         TO CP-INC-DT
 13197     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 13198     MOVE LOW-VALUES             TO CP-LSTPD-DT
 13199     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 13200     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 13201     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 13202
 13203* EXEC CICS LINK
 13204*       PROGRAM   ('ELCLMI')
 13205*       COMMAREA  (CLAIM-INT-PASS-AREA)
 13206*       LENGTH    (CP-CLAIM-LENGTH)
 13207*    END-EXEC
 13208     MOVE 'ELCLMI' TO DFHEIV1
 13209*    MOVE '."C                   (   #00012615' TO DFHEIV0
 13210     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13211     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13212     MOVE X'2020233030303132363135' TO DFHEIV0(25:11)
 13213     CALL 'kxdfhei1' USING DFHEIV0,
 13214           DFHEIV1,
 13215           CLAIM-INT-PASS-AREA,
 13216           CP-CLAIM-LENGTH,
 13217           DFHEIV99,
 13218           DFHEIV99,
 13219           DFHEIV99,
 13220           DFHEIV99
 13221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13222     MOVE AL-PANOF               TO PINTHA
 13223                                    PINTA
 13224     if cp-clm-int-amt = zeros
 13225        move ' ' to pi-int-to-rem-borr
 13226     end-if
 13227     IF NO-CI-ERROR
 13228        MOVE CP-CLM-INT-AMT      TO PINTO
 13229                                    PI-INT-AMT
 13230        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 13231        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 255
* EL156.cbl
 13232        MOVE AL-PANOF            TO PINTHA
 13233                                    PINTA
 13234        if pi-rb-joint-coverage
 13235           and pi-int-amt > zeros
 13236           move '  INT TO'       to itrb1o
 13237           move ' REM BORR?'     to itrb2o
 13238           move pi-int-to-rem-borr
 13239                                 to itrbyno
 13240           move al-uanon         to itrbyna
 13241           move +1               to itrbynl
 13242        else
 13243           move ' '              to pi-int-to-rem-borr
 13244        end-if
 13245     ELSE
 13246        IF CI-RETURN-CODE = '8'
 13247           MOVE ER-3818          TO EMI-ERROR
 13248           MOVE -1               TO ZINTL
 13249           PERFORM 9900-ERROR-FORMAT
 13250                                 THRU 9900-EXIT
 13251           GO TO 2200-EXIT
 13252        ELSE
 13253           MOVE ZEROS            TO PINTO
 13254                                    PI-INT-AMT
 13255                                    PI-INT-DAYS
 13256                                    PI-INT-RATE-USED
 13257        END-IF
 13258     END-IF
 13259     IF PI-INT-AMT NOT = ZEROS
 13260        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 13261           AND (CL-SOC-SEC-NO NOT = ZEROS)
 13262           CONTINUE
 13263        ELSE
 13264           MOVE CL-SOC-SEC-NO (1:3)
 13265                                 TO WS-SSN (1:3)
 13266           MOVE CL-SOC-SEC-NO (5:2)
 13267                                 TO WS-SSN (4:2)
 13268           MOVE CL-SOC-SEC-NO (8:4)
 13269                                 TO WS-SSN (6:4)
 13270           IF (WS-SSN NUMERIC)
 13271              AND (WS-SSN NOT = ZEROS)
 13272              CONTINUE
 13273           ELSE
 13274              MOVE ER-2044       TO EMI-ERROR
 13275              PERFORM 9900-ERROR-FORMAT
 13276                                 THRU 9900-EXIT
 13277           END-IF
 13278        END-IF
 13279        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 13280        if pi-int-to-rem-borr = 'Y'
 13281           move +61              to trlr-seq-no
 13282        else
 13283           MOVE +51              TO TRLR-SEQ-NO
 13284        end-if
 13285
 13286* EXEC CICS READ
 13287*          DATASET  ('ELTRLR')
 13288*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13289*          RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 256
* EL156.cbl
 13290*          RESP     (WS-RESPONSE)
 13291*       END-EXEC
 13292     MOVE 'ELTRLR' TO DFHEIV1
 13293*    MOVE '&"S        E          (  N#00012683' TO DFHEIV0
 13294     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13295     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13296     MOVE X'204E233030303132363833' TO DFHEIV0(25:11)
 13297     CALL 'kxdfhei1' USING DFHEIV0,
 13298           DFHEIV1,
 13299           DFHEIV20,
 13300           DFHEIV99,
 13301           ELTRLR-KEY,
 13302           DFHEIV99,
 13303           DFHEIV99,
 13304           DFHEIV99
 13305     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13306         DFHEIV20
 13307     MOVE EIBRESP  TO WS-RESPONSE
 13308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13309        IF (NOT WS-RESP-NORMAL)
 13310                    OR
 13311           ((WS-RESP-NORMAL)
 13312           AND ((AT-ADDRESS-LINE-1 = SPACES)
 13313           OR (AT-CITY-STATE = SPACES)))
 13314           MOVE ER-0874          TO EMI-ERROR
 13315           if pi-rb-joint-coverage
 13316              move -1            to itrbynl
 13317           end-if
 13318           PERFORM 9900-ERROR-FORMAT
 13319                                 THRU 9900-EXIT
 13320        else
 13321           move at-mail-to-name  to pi-int-payees-name
 13322        END-IF
 13323     END-IF
 13324     .
 13325 2200-EXIT.
 13326     EXIT.
 13327 2210-dcc-max-benes.
 13328
 13329     move pi-ah-term             to ws-max-bens
 13330     if cl-critical-period not = zeros and spaces
 13331        move cl-critical-period  to ws-max-bens
 13332     end-if
 13333     move cm-ah-benefit-amt      to ws-monthly-benefit
 13334     if pdef-found
 13335        and (pd-max-amt (p1) not = zeros)
 13336        if pd-ben-pct (p1) not numeric
 13337           move zeros            to pd-ben-pct (p1)
 13338        end-if
 13339        if pd-ben-pct (p1) = zeros
 13340           move +1               to ws-work-ben-pct
 13341        else
 13342           move pd-ben-pct (p1)  to ws-work-ben-pct
 13343        end-if
 13344*       compute ws-monthly-benefit =
 13345*          ws-monthly-benefit * ws-work-ben-pct
 13346*       if ws-monthly-benefit > pd-max-amt (p1)
 13347*          move pd-max-amt (p1) to ws-monthly-benefit
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 257
* EL156.cbl
 13348*       end-if
 13349     end-if
 13350
 13351     move cl-cert-key-data       to elcrtt-key (2:21)
 13352     move cl-company-cd          to ctrlr-comp-cd
 13353     move cl-cert-no             to ctrlr-cert-no
 13354     move 'B'                    to ctrlr-rec-type
 13355
 13356
 13357* EXEC CICS READ
 13358*       DATASET  ('ELCRTT')
 13359*       set      (address of CERTIFICATE-TRAILERS)
 13360*       RIDFLD   (ELCRTT-KEY)
 13361*       RESP     (WS-RESPONSE)
 13362*    END-EXEC
 13363     MOVE 'ELCRTT' TO DFHEIV1
 13364*    MOVE '&"S        E          (  N#00012736' TO DFHEIV0
 13365     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13366     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13367     MOVE X'204E233030303132373336' TO DFHEIV0(25:11)
 13368     CALL 'kxdfhei1' USING DFHEIV0,
 13369           DFHEIV1,
 13370           DFHEIV20,
 13371           DFHEIV99,
 13372           ELCRTT-KEY,
 13373           DFHEIV99,
 13374           DFHEIV99,
 13375           DFHEIV99
 13376     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13377         DFHEIV20
 13378     MOVE EIBRESP  TO WS-RESPONSE
 13379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13380     IF not WS-RESP-NORMAL
 13381        go to 2210-exit
 13382     end-if
 13383
 13384*    if instypei = 'P'
 13385*       move +1 to s1
 13386*    else
 13387*       MOVE +2 to s1
 13388*    end-if
 13389
 13390*    move +1 to s1
 13391*    evaluate cl-claim-type
 13392*       when 'A'
 13393*          move +1 to s2
 13394*       when 'I'
 13395*          move +2 to s2
 13396*       when 'G'
 13397*          move +3 to s2
 13398*       when 'L'
 13399*          move +4 to s2
 13400*       when 'P'
 13401*          move +5 to s2
 13402*    end-evaluate
 13403
 13404     move zeros                  to ws-prev-days-paid
 13405                                    ws-benefits-paid
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 258
* EL156.cbl
 13406                                    ws-prev-amt-paid
 13407     perform varying s1 from +1 by +1 until
 13408        (s1 > +24)
 13409        or (cs-claim-type (s1) = spaces)
 13410        if pi-company-id not = 'DCC' and 'VPP'
 13411           if cs-claim-type (s1) = cl-claim-type
 13412              compute ws-prev-days-paid =
 13413                 ws-prev-days-paid + cs-days-paid (s1)
 13414              compute ws-prev-amt-paid =
 13415                 ws-prev-amt-paid + cs-total-paid (s1)
 13416           end-if
 13417        else
 13418           if (cs-claim-type (s1) = cl-claim-type)
 13419              and (cs-benefit-period (s1) = cl-benefit-period)
 13420              and (cs-insured-type (s1) = cl-insured-type)
 13421              compute ws-prev-days-paid =
 13422                 ws-prev-days-paid + cs-days-paid (s1)
 13423              compute ws-prev-amt-paid =
 13424                 ws-prev-amt-paid + cs-total-paid (s1)
 13425           end-if
 13426        end-if
 13427     end-perform
 13428     if pi-epyamt > zeros
 13429        compute ws-benefits-paid =
 13430           (ws-prev-amt-paid + pi-epyamt)
 13431           / ws-monthly-benefit
 13432     else
 13433        compute ws-benefits-paid =
 13434           (ws-prev-amt-paid + pi-cpyamt)
 13435           / ws-monthly-benefit
 13436     end-if
 13437*    if pi-company-id = 'DCC'
 13438     if cl-claim-type not = 'L' and 'O' and 'P'
 13439        if ws-benefits-paid > ws-max-bens
 13440           move er-1658          to emi-error
 13441           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13442        end-if
 13443     end-if
 13444*    end-if
 13445*     if s1 < +25
 13446*        if pi-epyamt > zeros
 13447*           compute ws-benefits-paid =
 13448*              (cs-total-paid (s1) + PI-EPYAMT)
 13449*              / ws-monthly-benefit
 13450*        else
 13451*           compute ws-benefits-paid =
 13452*              (cs-total-paid (s1) + PI-CPYAMT)
 13453*              / ws-monthly-benefit
 13454*        end-if
 13455
 13456*       if ws-benefits-paid > pd-crit-period (p1)
 13457*        if ws-benefits-paid > ws-max-bens
 13458*           move er-1658          to emi-error
 13459*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13460*        end-if
 13461*     end-if
 13462     .
 13463 2210-exit.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 259
* EL156.cbl
 13464     exit.
 13465
 13466 2220-update-elcrtt.
 13467
 13468
 13469* EXEC CICS GETMAIN
 13470*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13471*       LENGTH   (ELCRTT-LENGTH)
 13472*       INITIMG  (GETMAIN-SPACE)
 13473*    END-EXEC
 13474*    MOVE ',"IL                  $   #00012830' TO DFHEIV0
 13475     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13476     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13477     MOVE X'2020233030303132383330' TO DFHEIV0(25:11)
 13478     CALL 'kxdfhei1' USING DFHEIV0,
 13479           DFHEIV20,
 13480           ELCRTT-LENGTH,
 13481           GETMAIN-SPACE
 13482     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13483         DFHEIV20
 13484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13485
 13486     move cl-cert-key-data       to elcrtt-key (2:21)
 13487     move cl-company-cd          to ctrlr-comp-cd
 13488     move cl-cert-no             to ctrlr-cert-no
 13489     move 'B'                    to ctrlr-rec-type
 13490
 13491
 13492* EXEC CICS READ
 13493*       UPDATE
 13494*       DATASET  (ELCRTT-DSID)
 13495*       into     (CERTIFICATE-TRAILERS)
 13496*       RIDFLD   (ELCRTT-KEY)
 13497*       RESP     (WS-RESPONSE)
 13498*    END-EXEC
 13499     MOVE LENGTH OF
 13500      CERTIFICATE-TRAILERS
 13501       TO DFHEIV11
 13502*    MOVE '&"IL       EU         (  N#00012841' TO DFHEIV0
 13503     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13504     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13505     MOVE X'204E233030303132383431' TO DFHEIV0(25:11)
 13506     CALL 'kxdfhei1' USING DFHEIV0,
 13507           ELCRTT-DSID,
 13508           CERTIFICATE-TRAILERS,
 13509           DFHEIV11,
 13510           ELCRTT-KEY,
 13511           DFHEIV99,
 13512           DFHEIV99,
 13513           DFHEIV99
 13514     MOVE EIBRESP  TO WS-RESPONSE
 13515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13516
 13517     IF WS-RESP-NORMAL
 13518        perform 2225-upd-crt-trlr thru 2225-exit
 13519
 13520* EXEC CICS REWRITE
 13521*          DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 260
* EL156.cbl
 13522*          from     (CERTIFICATE-TRAILERS)
 13523*          RESP     (WS-RESPONSE)
 13524*       END-EXEC
 13525     MOVE LENGTH OF
 13526      CERTIFICATE-TRAILERS
 13527       TO DFHEIV11
 13528*    MOVE '&& L                  %  N#00012851' TO DFHEIV0
 13529     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13530     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13531     MOVE X'204E233030303132383531' TO DFHEIV0(25:11)
 13532     CALL 'kxdfhei1' USING DFHEIV0,
 13533           ELCRTT-DSID,
 13534           CERTIFICATE-TRAILERS,
 13535           DFHEIV11,
 13536           DFHEIV99
 13537     MOVE EIBRESP  TO WS-RESPONSE
 13538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13539     else
 13540        if ws-resp-notfnd
 13541           move 'CS'             to certificate-trailers
 13542           move cl-company-cd    to cs-company-cd
 13543           move cl-cert-key-data to cs-control-primary (2:21)
 13544           move cl-cert-no       to cs-cert-no
 13545           move 'B'              to cs-trailer-type
 13546           perform varying s1 from +1 by +1 until s1 > +24
 13547              move zeros         to cs-benefit-period (s1)
 13548                                    cs-days-paid (s1)
 13549                                    cs-total-paid (s1)
 13550                                    cs-remaining-bens (s1)
 13551           end-perform
 13552           perform 2225-upd-crt-trlr
 13553                                 thru 2225-exit
 13554
 13555* EXEC CICS WRITE
 13556*             DATASET  (ELCRTT-DSID)
 13557*             from     (CERTIFICATE-TRAILERS)
 13558*             RIDFLD   (cs-control-primary)
 13559*             RESP     (WS-RESPONSE)
 13560*          END-EXEC
 13561     MOVE LENGTH OF
 13562      CERTIFICATE-TRAILERS
 13563       TO DFHEIV11
 13564*    MOVE '&$ L                  ''  N#00012871' TO DFHEIV0
 13565     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13566     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13567     MOVE X'204E233030303132383731' TO DFHEIV0(25:11)
 13568     CALL 'kxdfhei1' USING DFHEIV0,
 13569           ELCRTT-DSID,
 13570           CERTIFICATE-TRAILERS,
 13571           DFHEIV11,
 13572           cs-control-primary,
 13573           DFHEIV99,
 13574           DFHEIV99
 13575     MOVE EIBRESP  TO WS-RESPONSE
 13576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13577        end-if
 13578     END-IF
 13579
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 261
* EL156.cbl
 13580     .
 13581 2220-exit.
 13582     exit.
 13583
 13584 2225-upd-crt-trlr.
 13585
 13586*    if instypei = 'P'
 13587*       move +1 to s1
 13588*    else
 13589*       MOVE +2 to s1
 13590*    end-if
 13591
 13592*    move +1 to s1
 13593*    evaluate cl-claim-type
 13594*       when 'A'
 13595*          move +1 to s2
 13596*       when 'I'
 13597*          move +2 to s2
 13598*       when 'G'
 13599*          move +3 to s2
 13600*       when 'L'
 13601*          move +4 to s2
 13602*       when 'P'
 13603*          move +5 to s2
 13604*    end-evaluate
 13605     perform varying s1 from +1 by +1 until
 13606        (s1 > +24)
 13607        or (cl-claim-no = cs-claim-no (s1))
 13608     end-perform
 13609     if s1 < +25
 13610        compute cs-total-paid (s1) =
 13611           cs-total-paid (s1) + at-amount-paid
 13612        compute cs-days-paid (s1) =
 13613           cs-days-paid (s1) +  at-days-in-period
 13614*       compute cs-remaining-bens (s1) =
 13615*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13616        perform 2230-accum-bens-paid thru 2230-exit
 13617     end-if
 13618
 13619     .
 13620 2225-exit.
 13621     exit.
 13622 2230-accum-bens-paid.
 13623     if cl-claim-type not = 'L' and 'O' and 'P'
 13624        move pi-ah-term          to ws-max-bens
 13625        if cl-critical-period not = zeros and spaces
 13626           move cl-critical-period
 13627                                 to ws-max-bens
 13628        end-if
 13629     else
 13630        move 01                  to ws-max-bens
 13631     end-if
 13632     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13633     perform varying s2 from +1 by +1 until
 13634        (s2 > +24)
 13635        or (cs-claim-no (s2) = spaces)
 13636        if pi-company-id not = 'DCC' and 'VPP'
 13637           if cs-claim-type (s2) = cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 262
* EL156.cbl
 13638              compute ws-tot-days-paid =
 13639                 ws-tot-days-paid + cs-days-paid (s2)
 13640              compute ws-tot-amt-paid =
 13641                 ws-tot-amt-paid + cs-total-paid (s2)
 13642           end-if
 13643        else
 13644           if (cs-benefit-period (s2) = cl-benefit-period)
 13645              and (cs-claim-type (s2) = cl-claim-type)
 13646              and (cs-insured-type (s2) = cl-insured-type)
 13647              compute ws-tot-days-paid =
 13648                 ws-tot-days-paid + cs-days-paid (s2)
 13649              compute ws-tot-amt-paid =
 13650                 ws-tot-amt-paid + cs-total-paid (s2)
 13651           end-if
 13652        end-if
 13653     end-perform
 13654     if cl-claim-type = 'L' or 'P' or 'O'
 13655        if ws-tot-amt-paid > zeros
 13656           move zeros            to cs-remaining-bens (s1)
 13657        else
 13658           move 01               to cs-remaining-bens (s1)
 13659        end-if
 13660     else
 13661        compute ws-pd-bens rounded =
 13662           ws-tot-amt-paid / pi-ah-benefit-amt
 13663        compute cs-remaining-bens (s1) =
 13664           ws-max-bens - ws-pd-bens
 13665        if cs-remaining-bens (s1) < zeros
 13666           move zeros            to cs-remaining-bens (s1)
 13667        end-if
 13668     end-if
 13669     .
 13670 2230-exit.
 13671     exit.
 13672 3000-MOVE-INPUT-TO-SAVE-AREA.
 13673     IF PMTTYPEL > 0
 13674         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13675
 13676     if ws-pmttype = '4'
 13677        if pi-rb-joint-coverage
 13678           if payeel = +0
 13679              move +2            to payeel
 13680              move al-uanon      to payeea
 13681              move 'Q1'          to payeeo
 13682           else
 13683              if payeei not = 'Q1' and 'q1'
 13684                 move er-1582    to emi-error
 13685                 PERFORM 9900-ERROR-FORMAT thru 9900-exit
 13686              end-if
 13687           end-if
 13688        end-if
 13689     end-if
 13690     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13691
 13692     IF WS-PMTTYPE = '9'
 13693         MOVE 'P'                TO PI-PROVISIONAL-IND
 13694         MOVE '1'                TO WS-PMTTYPE.
 13695
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 263
* EL156.cbl
 13696     IF PAYEEL > 0
 13697         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13698         MOVE PAYEEI             TO WS-PAYEE.
 13699
 13700     IF NOTE1L > +0
 13701         MOVE NOTE1I             TO WS-PMTNOTE1
 13702                                    WS-FLI-PMTNOTE
 13703                                    WS-HAN-PMTNOTE.
 13704
 13705     IF NOTE2L > +0
 13706         MOVE NOTE2I             TO WS-PMTNOTE2.
 13707
 13708     IF OFFLINEL > 0
 13709         MOVE OFFLINEI           TO WS-OFFLINE.
 13710
 13711     IF PROOFDTL > 0
 13712         MOVE PROOFDTI            TO DATE-WORK
 13713         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13714         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13715         MOVE '4'                 TO DC-OPTION-CODE
 13716         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13717         IF NO-CONVERSION-ERROR
 13718            MOVE NUM-WORK         TO PROOFDTO
 13719            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13720            MOVE NUM-WORK         TO WS-PROOF-DATE
 13721         ELSE
 13722            MOVE ZEROS            TO WS-PROOF-DATE
 13723         END-IF
 13724     END-IF.
 13725
 13726     IF EOBYNL > +0
 13727         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13728         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13729     END-IF
 13730
 13731     IF CLMFMYNL > +0
 13732         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13733         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13734     END-IF
 13735
 13736     IF SURVYYNL > +0
 13737         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13738         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13739     END-IF
 13740
 13741     IF SPRELYNL > +0
 13742         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13743         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13744     END-IF
 13745     if itrbynl <> +0
 13746        move function upper-case(itrbyni) to itrbyni
 13747        move itrbyni             to ws-int-to-rem-borr
 13748     end-if
 13749*    IF GROUPEDL > +0
 13750*        MOVE GROUPEDI           TO WS-GROUPED.
 13751*
 13752*    IF CASHL > +0
 13753*       MOVE CASHI               TO WS-CASH.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 264
* EL156.cbl
 13754     IF LOANNOL > +0
 13755         MOVE LOANNOI            TO WS-LOAN-NO.
 13756
 13757     IF CHECKNOL > 0
 13758         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13759
 13760     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13761         IF WS-AIG-CREDIT-ENTERED
 13762             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13763             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13764             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13765             MOVE AL-UANON         TO CHECKNOA.
 13766
 13767     IF HOLDTILL > 0
 13768         MOVE HOLDTILI           TO DATE-WORK
 13769         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13770         MOVE NUM-WORK           TO WS-HOLDTIL.
 13771
 13772     IF ZINTL > +0
 13773
 13774* EXEC CICS BIF DEEDIT
 13775*           FIELD   (ZINTI)
 13776*           LENGTH  (07)
 13777*       END-EXEC
 13778     MOVE 07
 13779       TO DFHEIV11
 13780*    MOVE '@"L                   #   #00013073' TO DFHEIV0
 13781     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13782     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13783     MOVE X'2020233030303133303733' TO DFHEIV0(25:11)
 13784     CALL 'kxdfhei1' USING DFHEIV0,
 13785           ZINTI,
 13786           DFHEIV11
 13787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13788        IF ZINTI NOT NUMERIC
 13789           MOVE ER-0419          TO EMI-ERROR
 13790           PERFORM 9900-ERROR-FORMAT
 13791           MOVE AL-UABON         TO ZINTA
 13792           MOVE -1               TO ZINTL
 13793        ELSE
 13794           MOVE ZINTI            TO CP-INT-RATE
 13795                                    WS-INT-RATE
 13796           MOVE CP-INT-RATE      TO ZINTO
 13797           MOVE AL-UNNON         TO ZINTA
 13798        END-IF
 13799     ELSE
 13800        MOVE ZEROS               TO CP-INT-RATE
 13801     END-IF
 13802     IF EPYFROML > 0
 13803         MOVE EPYFROMI           TO DATE-WORK
 13804         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13805         MOVE NUM-WORK           TO WS-EPYFROM.
 13806
 13807     IF AIGFROML > 0
 13808         MOVE AIGFROMI           TO DATE-WORK
 13809         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13810         MOVE NUM-WORK           TO WS-AIGFROM
 13811     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 265
* EL156.cbl
 13812         IF (AIGFROMI = LOW-VALUES) AND
 13813            (PI-AIGFROM NOT = ZEROS)
 13814              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13815
 13816     IF EPYTHRUL > +0
 13817        MOVE EPYTHRUI           TO DATE-WORK
 13818        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13819        MOVE NUM-WORK           TO WS-EPYTHRU
 13820        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13821        MOVE '4'                TO DC-OPTION-CODE
 13822        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13823        IF NO-CONVERSION-ERROR
 13824           IF PI-USES-PAID-TO
 13825              MOVE '6'                TO DC-OPTION-CODE
 13826              MOVE -1                 TO DC-ELAPSED-DAYS
 13827              MOVE +0                 TO DC-ELAPSED-MONTHS
 13828              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13829              IF NO-CONVERSION-ERROR
 13830                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13831                 MOVE ' '             TO DC-OPTION-CODE
 13832                 MOVE +0              TO DC-ELAPSED-DAYS
 13833                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13834              IF NO-CONVERSION-ERROR
 13835                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13836
 13837*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13838*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13839     IF EDAYSL > 0
 13840
 13841* EXEC CICS BIF DEEDIT
 13842*            FIELD(EDAYSI)
 13843*            LENGTH(6)
 13844*        END-EXEC
 13845     MOVE 6
 13846       TO DFHEIV11
 13847*    MOVE '@"L                   #   #00013129' TO DFHEIV0
 13848     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13849     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13850     MOVE X'2020233030303133313239' TO DFHEIV0(25:11)
 13851     CALL 'kxdfhei1' USING DFHEIV0,
 13852           EDAYSI,
 13853           DFHEIV11
 13854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13855         MOVE EDAYSI             TO WS-DY-WORK
 13856         IF WS-DY-SIGN = SPACES
 13857            MOVE WS-DY-NUM       TO WS-EDAYS
 13858            ADD 0                TO WS-EDAYS
 13859         ELSE
 13860            MOVE EDAYSI          TO WS-EDAYS
 13861            ADD 0                TO WS-EDAYS.
 13862
 13863*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13864*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13865     IF EPYAMTL > 0
 13866
 13867* EXEC CICS BIF DEEDIT
 13868*            FIELD(EPYAMTI)
 13869*            LENGTH(10)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 266
* EL156.cbl
 13870*        END-EXEC
 13871     MOVE 10
 13872       TO DFHEIV11
 13873*    MOVE '@"L                   #   #00013144' TO DFHEIV0
 13874     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13875     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13876     MOVE X'2020233030303133313434' TO DFHEIV0(25:11)
 13877     CALL 'kxdfhei1' USING DFHEIV0,
 13878           EPYAMTI,
 13879           DFHEIV11
 13880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13881         MOVE EPYAMTI            TO WS-PY-WORK
 13882         IF WS-PY-SIGN = SPACES
 13883            MOVE WS-PY-NUM       TO WS-EPYAMT
 13884            ADD 0                TO WS-EPYAMT
 13885         ELSE
 13886            MOVE EPYAMTI         TO WS-EPYAMT
 13887            ADD 0                TO WS-EPYAMT.
 13888
 13889     IF ERESVL > 0
 13890
 13891* EXEC CICS BIF DEEDIT
 13892*            FIELD(ERESVI)
 13893*            LENGTH(9)
 13894*        END-EXEC
 13895     MOVE 9
 13896       TO DFHEIV11
 13897*    MOVE '@"L                   #   #00013157' TO DFHEIV0
 13898     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13899     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13900     MOVE X'2020233030303133313537' TO DFHEIV0(25:11)
 13901     CALL 'kxdfhei1' USING DFHEIV0,
 13902           ERESVI,
 13903           DFHEIV11
 13904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13905         MOVE ERESVI TO WS-ERESV.
 13906
 13907     IF EEXPENSL > 0
 13908
 13909* EXEC CICS BIF DEEDIT
 13910*            FIELD(EEXPENSI)
 13911*            LENGTH(8)
 13912*        END-EXEC
 13913     MOVE 8
 13914       TO DFHEIV11
 13915*    MOVE '@"L                   #   #00013164' TO DFHEIV0
 13916     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13917     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13918     MOVE X'2020233030303133313634' TO DFHEIV0(25:11)
 13919     CALL 'kxdfhei1' USING DFHEIV0,
 13920           EEXPENSI,
 13921           DFHEIV11
 13922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13923         MOVE EEXPENSI           TO WS-EEXPENS.
 13924
 13925     IF ETYPEL > ZEROS
 13926         MOVE ETYPEI             TO WS-ETYPE.
 13927
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 267
* EL156.cbl
 13928     IF PI-COMPANY-ID = 'BOA'
 13929        IF PINTL > ZEROS
 13930
 13931* EXEC CICS BIF DEEDIT
 13932*            FIELD (PINTI)
 13933*            LENGTH(05)
 13934*          END-EXEC
 13935     MOVE 05
 13936       TO DFHEIV11
 13937*    MOVE '@"L                   #   #00013175' TO DFHEIV0
 13938     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13939     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13940     MOVE X'2020233030303133313735' TO DFHEIV0(25:11)
 13941     CALL 'kxdfhei1' USING DFHEIV0,
 13942           PINTI,
 13943           DFHEIV11
 13944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13945           IF PINTI NUMERIC
 13946               MOVE AL-UNNON     TO PINTA
 13947               MOVE PINTI        TO WS-INT-RATE
 13948               MOVE WS-INT-RATE  TO PINTO.
 13949
 13950 3000-EXIT.
 13951     EXIT.
 13952
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 268
* EL156.cbl
 13954 3050-REBUILD-ENTERED.
 13955
 13956     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13957
 13958     IF PI-PROV-PMT
 13959         MOVE '9'           TO PMTTYPEO
 13960     ELSE
 13961         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13962
 13963     MOVE PI-PAYEE          TO PAYEEO.
 13964     MOVE PI-PMTNOTE1       TO NOTE1O.
 13965     MOVE PI-PMTNOTE2       TO NOTE2O.
 13966     MOVE PI-OFFLINE        TO OFFLINEO.
 13967     IF PI-PROOF-DATE NOT = ZEROS
 13968         MOVE PI-PROOF-DATE TO PROOFDTO
 13969         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13970     END-IF.
 13971*    MOVE PI-GROUPED        TO GROUPEDO.
 13972
 13973*    MOVE PI-CASH           TO CASHO.
 13974
 13975     IF PI-INT-RATE > ZEROS
 13976        MOVE PI-INT-RATE         TO PINTO
 13977     end-if
 13978     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13979        IF PI-INT-AMT > ZEROS
 13980           MOVE PI-INT-AMT       TO PINTO
 13981           MOVE AL-PANOF         TO PINTA
 13982                                    PINTHA
 13983           if pi-rb-joint-coverage
 13984              move '  INT TO'    to itrb1o
 13985              move ' REM BORR?'  to itrb2o
 13986              move 'Y'           to itrbyno
 13987              move al-uanon      to itrbyna
 13988              move +1            to itrbynl
 13989           end-if
 13990        END-IF
 13991     END-IF
 13992     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13993     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13994     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13995     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13996     IF PI-HOLDTIL NOT = ZEROS
 13997        MOVE PI-HOLDTIL          TO HOLDTILO
 13998        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13999
 14000     IF PI-EPYFROM NOT = ZEROS
 14001        MOVE PI-EPYFROM          TO EPYFROMO
 14002        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 14003
 14004     IF PI-AIGFROM NOT = ZEROS
 14005        MOVE PI-AIGFROM          TO AIGFROMO
 14006        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 14007
 14008     IF PI-EPYTHRU NOT = ZEROS
 14009        MOVE PI-EPYTHRU          TO EPYTHRUO
 14010        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 14011        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 269
* EL156.cbl
 14012           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 14013           MOVE '4'                TO DC-OPTION-CODE
 14014           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14015           IF NO-CONVERSION-ERROR
 14016              MOVE +1 TO DC-ELAPSED-DAYS
 14017              MOVE +0 TO DC-ELAPSED-MONTHS
 14018              MOVE '6' TO DC-OPTION-CODE
 14019              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14020              IF NO-CONVERSION-ERROR
 14021                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 14022
 14023     IF PI-EDAYS NOT = ZEROS
 14024        MOVE PI-EDAYS TO EDAYSO.
 14025
 14026     IF PI-EPYAMT NOT = ZEROS
 14027        MOVE PI-EPYAMT TO EPYAMTO.
 14028
 14029     IF PI-ERESV NOT = ZEROS
 14030        MOVE PI-ERESV TO ERESVO.
 14031
 14032     IF PI-EEXPENS NOT = ZEROS
 14033        MOVE PI-EEXPENS TO EEXPENSO.
 14034
 14035     MOVE PI-ETYPE TO ETYPEO.
 14036
 14037     IF PI-ECHECKNO NOT = SPACES
 14038        MOVE PI-ECHECKNO         TO CHECKNOO
 14039     ELSE
 14040        MOVE PI-CCHECKNO         TO CHECKNOO.
 14041
 14042     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 14043     MOVE SPACES                 TO DC-OPTION-CODE.
 14044     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14045
 14046     IF DATE-CONVERSION-ERROR
 14047        MOVE SPACES              TO CPYFROMI
 14048     ELSE
 14049        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 14050
 14051     IF PI-USES-PAID-TO
 14052        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 14053        MOVE +1                  TO DC-ELAPSED-DAYS
 14054        MOVE +0                  TO DC-ELAPSED-MONTHS
 14055        MOVE '6'                 TO DC-OPTION-CODE
 14056        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14057        IF NO-CONVERSION-ERROR
 14058           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 14059           GO TO 3051-CONTINUE.
 14060
 14061     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 14062     MOVE SPACES                 TO DC-OPTION-CODE.
 14063     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14064
 14065     IF DATE-CONVERSION-ERROR
 14066        MOVE SPACES              TO CPYTHRUI
 14067     ELSE
 14068        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 14069
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 270
* EL156.cbl
 14070 3051-CONTINUE.
 14071
 14072     IF PI-CDAYS NOT = ZEROS
 14073        MOVE PI-CDAYS TO CDAYSO.
 14074
 14075     IF PI-CPYAMT NOT = ZEROS
 14076        MOVE PI-CPYAMT TO CPYAMTO.
 14077
 14078     IF PI-CRESV NOT = ZEROS
 14079        MOVE PI-CRESV TO CRESVO.
 14080
 14081     IF PI-CEXPENS NOT = ZEROS
 14082        MOVE PI-CEXPENS TO CEXPENSO.
 14083
 14084 3059-EXIT.
 14085     EXIT.
 14086
 14087 3100-DEEDIT-DATE.
 14088
 14089* EXEC CICS BIF DEEDIT
 14090*        FIELD(DATE-WORK)
 14091*        LENGTH(8)
 14092*    END-EXEC.
 14093     MOVE 8
 14094       TO DFHEIV11
 14095*    MOVE '@"L                   #   #00013322' TO DFHEIV0
 14096     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14097     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14098     MOVE X'2020233030303133333232' TO DFHEIV0(25:11)
 14099     CALL 'kxdfhei1' USING DFHEIV0,
 14100           DATE-WORK,
 14101           DFHEIV11
 14102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14103
 14104
 14105 3100-EXIT.
 14106     EXIT.
 14107
 14108 3200-CALC-AIG-DAYS.
 14109
 14110     MOVE 'N'                    TO WS-DUE-DAY-SW.
 14111
 14112     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14113     MOVE ' '                    TO DC-OPTION-CODE.
 14114     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14115     IF NO-CONVERSION-ERROR
 14116         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 14117     ELSE
 14118         GO TO 3290-ERROR.
 14119
 14120     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14121         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14122                                WS-BIN-FROM-DT
 14123     ELSE
 14124         IF CL-TOTAL-PAID-AMT > ZEROS
 14125             IF WS-SV-EPYFROM = LOW-VALUES
 14126                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14127                                        WS-BIN-FROM-DT
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 271
* EL156.cbl
 14128             ELSE
 14129                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14130                                        WS-BIN-FROM-DT
 14131         ELSE
 14132             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14133                                        WS-BIN-FROM-DT.
 14134
 14135 3210-CONTINUE.
 14136
 14137     MOVE ' '                    TO DC-OPTION-CODE.
 14138     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14139     IF DATE-CONVERSION-ERROR
 14140         GO TO 3290-ERROR.
 14141
 14142     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 14143
 14144     IF PI-LOAN-DUE-DAY = 31
 14145         MOVE 30              TO WS-PMT-DUE-DA
 14146                                 WS-SAVE-DUE-DA
 14147     ELSE
 14148         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 14149                                 WS-SAVE-DUE-DA.
 14150
 14151     IF (PI-LOAN-DUE-DAY > 28) AND
 14152        (WS-PMT-DUE-MO = 2)
 14153         MOVE 'Y'                TO WS-DUE-DAY-SW
 14154         MOVE 28                 TO WS-PMT-DUE-DA.
 14155
 14156     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 14157     MOVE '4'                    TO DC-OPTION-CODE.
 14158     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14159     IF NO-CONVERSION-ERROR
 14160         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 14161     ELSE
 14162         GO TO 3290-ERROR.
 14163
 14164*--------------------------------------------------------------*
 14165*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 14166*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 14167*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 14168*                                                              *
 14169*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 14170*             INCURRED DATE      - 04/15/91                    *
 14171*             PMT DUE DATE       - 04/03/91                    *
 14172*             PMT DUE DATE       - 05/03/91                    *
 14173*--------------------------------------------------------------*
 14174
 14175     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14176        (WS-SV-AIGFROM = LOW-VALUES)
 14177         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 14178            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 14179             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14180             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14181             IF NO-CONVERSION-ERROR
 14182                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14183                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14184             ELSE
 14185                 GO TO 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 272
* EL156.cbl
 14186
 14187     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14188        (WS-SV-AIGFROM = LOW-VALUES)
 14189         GO TO 3205-CONT-CALC-PMT.
 14190
 14191     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 14192     MOVE ' '                    TO DC-OPTION-CODE.
 14193     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14194     IF NO-CONVERSION-ERROR
 14195         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 14196     ELSE
 14197         GO TO 3290-ERROR.
 14198
 14199     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 14200        (WS-PMT-DUE-DA < WS-FROM-DA)
 14201          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14202          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14203          IF NO-CONVERSION-ERROR
 14204              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14205              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14206          ELSE
 14207              GO TO 3290-ERROR.
 14208
 14209 3205-CONT-CALC-PMT.
 14210
 14211*--------------------------------------------------------------*
 14212*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 14213*    BETWEEN THE PAY FROM / THRU DATES.                        *
 14214*--------------------------------------------------------------*
 14215
 14216     IF CL-TOTAL-PAID-AMT = ZEROS AND
 14217        PI-PMTTYPE = '2'
 14218          NEXT SENTENCE
 14219     ELSE
 14220        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 14221           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 14222             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 14223             MOVE ER-3527            TO EMI-ERROR
 14224             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14225             MOVE -1                 TO EPYTHRUL
 14226             MOVE AL-UNBON           TO EPYTHRUA
 14227                                        EPYFROMA
 14228             GO TO 3299-EXIT.
 14229
 14230*--------------------------------------------------------------*
 14231*    CALCULATE RETRO ELIMINATION DATE                          *
 14232*--------------------------------------------------------------*
 14233
 14234     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14235         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14236     ELSE
 14237         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 14238
 14239     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 14240     MOVE +0             TO DC-ELAPSED-MONTHS.
 14241     MOVE '6'            TO DC-OPTION-CODE.
 14242     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14243     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 273
* EL156.cbl
 14244         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 14245     ELSE
 14246         GO TO 3290-ERROR.
 14247
 14248 3210-CHECK-PMT-DATE.
 14249
 14250*--------------------------------------------------------------*
 14251*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 14252*    THE ENTERED PAY FROM DATE                                 *
 14253*--------------------------------------------------------------*
 14254
 14255     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 14256         NEXT SENTENCE
 14257     ELSE
 14258         GO TO 3220-COMPUTE-DAYS.
 14259
 14260     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 14261     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14262     IF NO-CONVERSION-ERROR
 14263         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14264         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14265         GO TO 3210-CHECK-PMT-DATE
 14266     ELSE
 14267         GO TO 3290-ERROR.
 14268
 14269 3220-COMPUTE-DAYS.
 14270
 14271     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 14272     MOVE ZEROS         TO WS-CDAYS.
 14273     MOVE 'N'           TO WS-ELIMINATION-SW.
 14274
 14275*--------------------------------------------------------------*
 14276*    COMPUTE CALIFORNIA DUE DAYS                               *
 14277*--------------------------------------------------------------*
 14278
 14279     IF CL-TOTAL-PAID-AMT > ZEROS
 14280         MOVE 'Y' TO WS-ELIMINATION-SW
 14281         GO TO 3240-FIRST-PMT-DUE
 14282     ELSE
 14283        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 14284            NEXT SENTENCE
 14285        ELSE
 14286            GO TO 3240-FIRST-PMT-DUE.
 14287
 14288 3230-NEXT-PMT-DUE.
 14289
 14290     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 14291     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14292     IF NO-CONVERSION-ERROR
 14293         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 14294         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14295     ELSE
 14296         GO TO 3290-ERROR.
 14297
 14298 3240-FIRST-PMT-DUE.
 14299
 14300     IF CL-TOTAL-PAID-AMT > ZEROS
 14301         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 274
* EL156.cbl
 14302     ELSE
 14303        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 14304            GO TO 3230-NEXT-PMT-DUE.
 14305
 14306     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 14307         GO TO 3250-VERIFY-ELIMINATION.
 14308
 14309     ADD +30 TO WS-CDAYS.
 14310     MOVE 'Y' TO WS-ELIMINATION-SW.
 14311     GO TO 3230-NEXT-PMT-DUE.
 14312
 14313 3250-VERIFY-ELIMINATION.
 14314
 14315     IF ELIM-SATISFIED
 14316         GO TO 3260-END-CALC.
 14317
 14318     IF PI-PMTTYPE = '1'
 14319         MOVE ZEROS TO WS-CDAYS
 14320         GO TO 3260-END-CALC.
 14321
 14322     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14323         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14324     ELSE
 14325         IF CL-TOTAL-PAID-AMT > ZEROS
 14326             IF WS-SV-EPYFROM = LOW-VALUES
 14327                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14328             ELSE
 14329                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14330         ELSE
 14331             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14332
 14333     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14334     MOVE '1'                    TO DC-OPTION-CODE.
 14335     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14336     IF NO-CONVERSION-ERROR
 14337         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14338     ELSE
 14339         GO TO 3290-ERROR.
 14340
 14341     IF CL-TOTAL-PAID-AMT > ZEROS
 14342         MOVE WS-DAYS-OFF TO WS-CDAYS
 14343     ELSE
 14344         IF PI-BEN-DAYS > WS-DAYS-OFF
 14345             MOVE ZEROS TO WS-CDAYS
 14346         ELSE
 14347             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14348
 14349 3260-END-CALC.
 14350
 14351     MOVE WS-CDAYS TO PI-CDAYS.
 14352
 14353     IF PI-EDAYS = ZEROS
 14354         MOVE PI-CDAYS TO PI-EDAYS
 14355         MOVE AL-UNNON TO EDAYSA.
 14356
 14357     GO TO 3299-EXIT.
 14358
 14359 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 275
* EL156.cbl
 14360
 14361     MOVE ER-3528            TO EMI-ERROR.
 14362     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14363     MOVE -1                 TO CDAYSL.
 14364     MOVE AL-UNBON           TO CDAYSA.
 14365
 14366 3299-EXIT.
 14367     EXIT.
 14368
 14369 3300-BUMP-DATE.
 14370
 14371     IF WS-RESTORE-DUE-DAY
 14372         MOVE 'N'              TO WS-DUE-DAY-SW
 14373         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14374         ADD 1                 TO WS-PMT-DUE-MO
 14375         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14376         MOVE '4'              TO DC-OPTION-CODE
 14377         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14378         IF NO-CONVERSION-ERROR
 14379             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14380             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14381             GO TO 3399-EXIT
 14382         ELSE
 14383             MOVE '9'          TO DC-ERROR-CODE
 14384             GO TO 3399-EXIT.
 14385
 14386     IF (WS-PMT-DUE-MO = 1) AND
 14387        (WS-SAVE-DUE-DA > 28)
 14388           MOVE 'Y' TO WS-DUE-DAY-SW.
 14389
 14390     MOVE +0                 TO DC-ELAPSED-DAYS.
 14391     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14392     MOVE '6'                TO DC-OPTION-CODE.
 14393     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14394
 14395 3399-EXIT.
 14396     EXIT.
 14397
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 276
* EL156.cbl
 14399 3400-COMPUTE-EXPIRY.
 14400
 14401     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14402     MOVE +0                    TO DC-ELAPSED-DAYS
 14403                                   DC-ODD-DAYS-OVER.
 14404     MOVE '1'                   TO DC-END-OF-MONTH.
 14405     MOVE '6'                   TO DC-OPTION-CODE.
 14406
 14407     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 14408         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14409     ELSE
 14410         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14411
 14412     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14413     IF NO-CONVERSION-ERROR
 14414         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14415     ELSE
 14416         GO TO 3390-CONTINUE.
 14417
 14418     IF CL-CLAIM-TYPE NOT = (PI-LIFE-OVERRIDE-L1 OR 'O')
 14419         GO TO 3390-CONTINUE.
 14420
 14421     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14422     MOVE '4'                    TO CNTL-REC-TYPE.
 14423     MOVE +0                     TO CNTL-SEQ-NO.
 14424     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14425     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14426     MOVE 'BENE'                 TO FILE-SWITCH.
 14427
 14428     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14429
 14430     IF NO-BENEFIT-FOUND
 14431         GO TO 3390-CONTINUE.
 14432
 14433     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 14434        IF (PI-OFFLINE = 'Y') OR
 14435           (PI-PMTTYPE = '7')
 14436           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14437                                     THRU 9870-EXIT
 14438           IF ERROR-ON-OUTPUT
 14439             MOVE -1                 TO ENTERPFL
 14440             MOVE AL-UANON           TO ENTERPFA
 14441             MOVE MAP-NAMEA          TO MAP-NAME
 14442             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14443             GO TO 8200-SEND-DATAONLY.
 14444
 14445     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')  AND
 14446        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14447        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14448          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14449          MOVE +0        TO DC-ELAPSED-DAYS
 14450          MOVE +1        TO DC-ELAPSED-MONTHS
 14451          MOVE 6         TO DC-OPTION-CODE
 14452          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14453          IF NO-CONVERSION-ERROR
 14454              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14455
 14456 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 277
* EL156.cbl
 14457
 14458      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14459         MOVE CM-AH-LOAN-EXPIRE-DT
 14460                                 TO DC-BIN-DATE-1
 14461      ELSE
 14462         MOVE CM-LF-LOAN-EXPIRE-DT
 14463                                 TO DC-BIN-DATE-1
 14464      END-IF
 14465
 14466      MOVE ' '                    TO DC-OPTION-CODE.
 14467      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14468      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14469      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14470
 14471 3499-EXIT.
 14472     EXIT.
 14473
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 278
* EL156.cbl
 14475
 14476 3600-CHECK-VERIFICATION.
 14477
 14478     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14479
 14480     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14481
 14482     IF PI-PAYEE-TYPE = 'I'
 14483        GO TO 3600-READ-TRAILER.
 14484
 14485     IF PI-PAYEE-TYPE = 'B'
 14486        ADD +10                  TO TRLR-SEQ-NO
 14487        GO TO 3600-READ-TRAILER.
 14488
 14489     IF PI-PAYEE-TYPE = 'A'
 14490        ADD +20                  TO TRLR-SEQ-NO
 14491        GO TO 3600-READ-TRAILER.
 14492
 14493     IF PI-PAYEE-TYPE = 'O'
 14494        ADD +50                  TO TRLR-SEQ-NO
 14495        GO TO 3600-READ-TRAILER.
 14496
 14497     IF PI-PAYEE-TYPE = 'Q'
 14498        ADD +60                  TO TRLR-SEQ-NO
 14499        GO TO 3600-READ-TRAILER.
 14500
 14501     IF PI-PAYEE-TYPE = 'P'
 14502        ADD +30                  TO TRLR-SEQ-NO
 14503        GO TO 3600-READ-TRAILER.
 14504
 14505     IF PI-PAYEE-TYPE = 'E'
 14506        ADD +40                  TO TRLR-SEQ-NO.
 14507
 14508 3600-READ-TRAILER.
 14509
 14510
 14511* EXEC CICS HANDLE CONDITION
 14512*         NOTFND(3600-CONTINUE)
 14513*    END-EXEC.
 14514*    MOVE '"$I                   ! - #00013732' TO DFHEIV0
 14515     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14516     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14517     MOVE X'2D20233030303133373332' TO DFHEIV0(25:11)
 14518     CALL 'kxdfhei1' USING DFHEIV0
 14519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14520
 14521
 14522     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14523
 14524 3600-CONTINUE.
 14525
 14526     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 14527         GO TO 3600-AH-VERIFY
 14528     END-IF.
 14529
 14530     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14531       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14532         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 279
* EL156.cbl
 14533           MOVE ER-7576            TO EMI-ERROR
 14534           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14535           MOVE -1                 TO PAYEEL
 14536           MOVE AL-UABON           TO PAYEEA
 14537           GO TO 3600-EXIT
 14538         END-IF
 14539       END-IF
 14540     END-IF.
 14541
 14542     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14543     MOVE 1 TO WS-SUB2
 14544     MOVE SPACES TO WS-PAYEE-NAME
 14545     PERFORM VARYING WS-SUB FROM 1 BY 1
 14546             UNTIL WS-SUB > 30
 14547         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14548            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14549                 WS-PAYEE-NAME-X (WS-SUB2)
 14550            ADD +1 TO WS-SUB2
 14551         END-IF
 14552     END-PERFORM.
 14553
 14554     STRING CL-INSURED-1ST-NAME
 14555            CL-INSURED-MID-INIT
 14556            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14557     MOVE 1 TO WS-SUB2
 14558     MOVE SPACES TO WS-INSURED-NAME
 14559     PERFORM VARYING WS-SUB FROM 1 BY 1
 14560             UNTIL WS-SUB > 30
 14561         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14562            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14563                 WS-INSURED-NAME-X (WS-SUB2)
 14564            ADD +1 TO WS-SUB2
 14565         END-IF
 14566     END-PERFORM.
 14567
 14568     IF CL-CLAIM-TYPE = 'O'
 14569        IF WS-PAYEE-NAME (1:6) = 'ESTATE'
 14570           MOVE ER-7585            TO EMI-ERROR
 14571           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14572           MOVE -1                 TO PAYEEL
 14573           MOVE AL-UABON           TO PAYEEA
 14574        ELSE
 14575           GO TO 3600-EXIT
 14576        END-IF
 14577     END-IF.
 14578     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14579        MOVE ER-7579            TO EMI-ERROR
 14580        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14581        MOVE -1                 TO PAYEEL
 14582        MOVE AL-UABON           TO PAYEEA
 14583     END-IF.
 14584
 14585     IF PI-PMTTYPE = '4'  AND
 14586        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14587        PI-PAYEE-TYPE <> 'I'
 14588          MOVE ER-7580          TO EMI-ERROR
 14589          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14590          MOVE -1               TO PAYEEL
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 280
* EL156.cbl
 14591          MOVE AL-UABON         TO PAYEEA
 14592     END-IF.
 14593
 14594     GO TO 3600-EXIT.
 14595
 14596 3600-AH-VERIFY.
 14597
 14598     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14599        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14600           MOVE ER-7583            TO EMI-ERROR
 14601           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14602           MOVE -1                 TO PAYEEL
 14603           MOVE AL-UABON           TO PAYEEA
 14604        END-IF
 14605     END-IF.
 14606
 14607
 14608 3600-EXIT.
 14609     EXIT.
 14610
 14611 5000-UPDATE.
 14612
 14613     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14614
 14615     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14616
 14617     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14618        PI-OFFLINE = 'Y'
 14619        NEXT SENTENCE
 14620     ELSE
 14621        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14622
 14623*    IF PI-COMPANY-ID = 'CRI'
 14624*       IF PI-PMTTYPE = '1' OR  '2'
 14625*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14626*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14627*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14628
 14629*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14630*       IF PI-PMTTYPE = '1'
 14631*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14632*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14633
 14634     IF PI-PMTTYPE      = '2' AND
 14635        PI-SPLIT-PMT-SW = 'Y' AND
 14636        (CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1 OR 'O')
 14637          MOVE ER-3530                TO EMI-ERROR
 14638          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14639
 14640     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14641        AND (CL-CLAIM-TYPE = 'L' OR 'O')
 14642        IF PI-PMTTYPE = '2' OR '4'
 14643           IF PI-INT-AMT NOT = ZEROS
 14644              PERFORM 7110-BUILD-PMT-TRLR
 14645                                 THRU 7130-EXIT
 14646           ELSE
 14647              IF PI-PMTTYPE = '2'
 14648                 PERFORM 7140-BUILD-NOTE-TRLR
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 281
* EL156.cbl
 14649                                 THRU 7170-EXIT
 14650              END-IF
 14651           END-IF
 14652        END-IF
 14653     END-IF
 14654*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14655*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14656*            MOVE 'N'                 TO  WS-LETTER-SW.
 14657
 14658*    IF PI-COMPANY-ID = 'DMD'
 14659*        IF CL-NO-OF-PMTS-MADE = +1
 14660*                OR
 14661*           PI-PMTTYPE = '2'
 14662*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14663
 14664     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14665
 14666*    IF PI-COMPANY-ID = 'DMD'
 14667*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14668*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14669
 14670
 14671* EXEC CICS REWRITE
 14672*         DATASET('ELMSTR')
 14673*         FROM(CLAIM-MASTER)
 14674*     END-EXEC.
 14675     MOVE LENGTH OF
 14676      CLAIM-MASTER
 14677       TO DFHEIV11
 14678     MOVE 'ELMSTR' TO DFHEIV1
 14679*    MOVE '&& L                  %   #00013884' TO DFHEIV0
 14680     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14681     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14682     MOVE X'2020233030303133383834' TO DFHEIV0(25:11)
 14683     CALL 'kxdfhei1' USING DFHEIV0,
 14684           DFHEIV1,
 14685           CLAIM-MASTER,
 14686           DFHEIV11,
 14687           DFHEIV99
 14688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14689
 14690
 14691     IF WS-LETTER-SW = 'N'
 14692         GO TO 5000-END-UPDATE.
 14693
 14694 5000-GENERATE-AUTO-LETTER.
 14695
 14696
 14697* EXEC CICS LINK
 14698*        PROGRAM    (LINK-1523)
 14699*        COMMAREA   (W-1523-LINKDATA)
 14700*        LENGTH     (W-1523-COMM-LENGTH)
 14701*    END-EXEC.
 14702*    MOVE '."C                   (   #00013894' TO DFHEIV0
 14703     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14704     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14705     MOVE X'2020233030303133383934' TO DFHEIV0(25:11)
 14706     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 282
* EL156.cbl
 14707           LINK-1523,
 14708           W-1523-LINKDATA,
 14709           W-1523-COMM-LENGTH,
 14710           DFHEIV99,
 14711           DFHEIV99,
 14712           DFHEIV99,
 14713           DFHEIV99
 14714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14715
 14716
 14717     IF W-1523-FATAL-ERROR
 14718         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14719         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14720         MOVE ER-0802                TO  EMI-ERROR
 14721         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14722
 14723     IF W-1523-ERROR-CODE = 0191
 14724         MOVE ER-0803                TO  EMI-ERROR
 14725         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14726
 14727     IF PI-COMPANY-ID      = 'HAN' AND
 14728        PI-PMTTYPE         = '1'   AND
 14729        PI-3RD-PARTY-SW    = 'Y'   AND
 14730        W-1523-FORM-NUMBER = 'EOB1'
 14731           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14732           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14733           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14734           GO TO 5000-GENERATE-AUTO-LETTER.
 14735
 14736 5000-END-UPDATE.
 14737
 14738     MOVE ER-0000                TO EMI-ERROR.
 14739     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14740     GO TO 7000-SHOW-CLAIM.
 14741
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 283
* EL156.cbl
 14743 5000-MOVE-NAME.
 14744     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14745     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14746     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14747
 14748 5000-EXIT.
 14749     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 284
* EL156.cbl
 14751 5300-CREATE-DMO.
 14752
 14753     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14754     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14755     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14756
 14757
 14758* EXEC CICS HANDLE CONDITION
 14759*         NOTFND   (5300-NOTE-NOT-FOUND)
 14760*    END-EXEC.
 14761*    MOVE '"$I                   ! . #00013940' TO DFHEIV0
 14762     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14763     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14764     MOVE X'2E20233030303133393430' TO DFHEIV0(25:11)
 14765     CALL 'kxdfhei1' USING DFHEIV0
 14766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14767
 14768
 14769
 14770* EXEC CICS READ
 14771*         DATASET('ERNOTE')
 14772*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14773*         RIDFLD (W-NOTE-KEY)
 14774*    END-EXEC.
 14775     MOVE 'ERNOTE' TO DFHEIV1
 14776*    MOVE '&"S        E          (   #00013944' TO DFHEIV0
 14777     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14778     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14779     MOVE X'2020233030303133393434' TO DFHEIV0(25:11)
 14780     CALL 'kxdfhei1' USING DFHEIV0,
 14781           DFHEIV1,
 14782           DFHEIV20,
 14783           DFHEIV99,
 14784           W-NOTE-KEY,
 14785           DFHEIV99,
 14786           DFHEIV99,
 14787           DFHEIV99
 14788     SET ADDRESS OF CERTIFICATE-NOTE TO
 14789         DFHEIV20
 14790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14791
 14792
 14793     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14794     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14795     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14796
 14797     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14798         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14799     ELSE
 14800         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14801
 14802     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14803     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14804     MOVE 'DLO006'               TO PGM-NAME.
 14805
 14806
 14807* EXEC CICS LINK
 14808*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 285
* EL156.cbl
 14809*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14810*        LENGTH     (DCT-RCRD-LENGTH)
 14811*    END-EXEC.
 14812*    MOVE '."C                   (   #00013963' TO DFHEIV0
 14813     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14814     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14815     MOVE X'2020233030303133393633' TO DFHEIV0(25:11)
 14816     CALL 'kxdfhei1' USING DFHEIV0,
 14817           PGM-NAME,
 14818           DCT-COMMUNICATION-AREA,
 14819           DCT-RCRD-LENGTH,
 14820           DFHEIV99,
 14821           DFHEIV99,
 14822           DFHEIV99,
 14823           DFHEIV99
 14824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14825
 14826
 14827     IF DCT-RETURN-CODE = 'OK'
 14828         GO TO 5300-CONT.
 14829
 14830     IF DCT-RETURN-CODE = '01' OR '02'
 14831         GO TO 5300-EXIT.
 14832
 14833     IF DCT-RETURN-CODE = '03'
 14834         MOVE ER-0951            TO EMI-ERROR
 14835         GO TO 5300-BAD-EXIT.
 14836
 14837     IF DCT-RETURN-CODE = '04'
 14838         MOVE ER-0946            TO EMI-ERROR
 14839         GO TO 5300-BAD-EXIT.
 14840
 14841     IF DCT-RETURN-CODE = '05'
 14842         MOVE ER-0947            TO EMI-ERROR
 14843         GO TO 5300-BAD-EXIT.
 14844
 14845     IF DCT-RETURN-CODE = '06'
 14846         MOVE ER-0921            TO EMI-ERROR
 14847         GO TO 5300-BAD-EXIT.
 14848
 14849     IF DCT-RETURN-CODE = '07'
 14850         MOVE ER-0849            TO EMI-ERROR
 14851         GO TO 5300-BAD-EXIT.
 14852
 14853     IF DCT-RETURN-CODE = '08'
 14854         MOVE ER-0948            TO EMI-ERROR
 14855         GO TO 5300-BAD-EXIT.
 14856
 14857     IF DCT-RETURN-CODE = 'N1'
 14858         MOVE ER-0950            TO EMI-ERROR
 14859         GO TO 5300-BAD-EXIT.
 14860
 14861     IF DCT-RETURN-CODE = 'E1'
 14862         MOVE ER-0974            TO EMI-ERROR
 14863         GO TO 5300-BAD-EXIT.
 14864
 14865     IF DCT-RETURN-CODE = 'E2'
 14866         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 286
* EL156.cbl
 14867         GO TO 5300-BAD-EXIT.
 14868
 14869     IF DCT-RETURN-CODE NOT = 'OK'
 14870         MOVE ER-0949            TO EMI-ERROR
 14871         GO TO 5300-BAD-EXIT.
 14872
 14873 5300-CONT.
 14874
 14875     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14876     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14877     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14878     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14879     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14880     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14881     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14882     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14883
 14884     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14885     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14886     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14887     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14888     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14889
 14890     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14891
 14892     IF PI-PMTTYPE = '2'
 14893         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14894         MOVE '4'                TO DM-CLAIM-STATUS
 14895     ELSE
 14896         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14897         MOVE '2'                TO DM-CLAIM-STATUS.
 14898
 14899     MOVE 'DLO025'               TO PGM-NAME.
 14900
 14901
 14902* EXEC CICS LINK
 14903*        PROGRAM    (PGM-NAME)
 14904*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14905*        LENGTH     (DM-DMO-LENGTH)
 14906*    END-EXEC.
 14907*    MOVE '."C                   (   #00014043' TO DFHEIV0
 14908     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14909     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14910     MOVE X'2020233030303134303433' TO DFHEIV0(25:11)
 14911     CALL 'kxdfhei1' USING DFHEIV0,
 14912           PGM-NAME,
 14913           DMO-COMMUNICATION-AREA,
 14914           DM-DMO-LENGTH,
 14915           DFHEIV99,
 14916           DFHEIV99,
 14917           DFHEIV99,
 14918           DFHEIV99
 14919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14920
 14921
 14922     IF DM-RETURN-CODE = 'OK'
 14923         GO TO 5300-EXIT.
 14924
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 287
* EL156.cbl
 14925     IF DM-RETURN-CODE = '01'
 14926         MOVE ER-8051            TO EMI-ERROR
 14927         GO TO 5300-BAD-EXIT.
 14928
 14929     IF DM-RETURN-CODE = '02'
 14930         MOVE ER-8052            TO EMI-ERROR
 14931         GO TO 5300-BAD-EXIT.
 14932
 14933     IF DM-RETURN-CODE = '03'
 14934         MOVE ER-8053            TO EMI-ERROR
 14935         GO TO 5300-BAD-EXIT.
 14936
 14937     IF DM-RETURN-CODE = '04'
 14938         MOVE ER-8054            TO EMI-ERROR
 14939         GO TO 5300-BAD-EXIT.
 14940
 14941     IF DM-RETURN-CODE = '05'
 14942         MOVE ER-8055            TO EMI-ERROR
 14943         GO TO 5300-BAD-EXIT.
 14944
 14945     IF DM-RETURN-CODE = '06'
 14946         MOVE ER-8056            TO EMI-ERROR
 14947         GO TO 5300-BAD-EXIT.
 14948
 14949     IF DM-RETURN-CODE = '07'
 14950         MOVE ER-8057            TO EMI-ERROR
 14951         GO TO 5300-BAD-EXIT.
 14952
 14953     IF DM-RETURN-CODE = '08'
 14954         MOVE ER-8058            TO EMI-ERROR
 14955         GO TO 5300-BAD-EXIT.
 14956
 14957     IF DM-RETURN-CODE = '09'
 14958         MOVE ER-8059            TO EMI-ERROR
 14959         GO TO 5300-BAD-EXIT.
 14960
 14961     IF DM-RETURN-CODE = '10'
 14962         MOVE ER-8060            TO EMI-ERROR
 14963         GO TO 5300-BAD-EXIT.
 14964
 14965     IF DM-RETURN-CODE = '11'
 14966         MOVE ER-8061            TO EMI-ERROR
 14967         GO TO 5300-BAD-EXIT.
 14968
 14969     IF DM-RETURN-CODE = '12'
 14970         MOVE ER-8062            TO EMI-ERROR
 14971         GO TO 5300-BAD-EXIT.
 14972
 14973     IF DM-RETURN-CODE = '13'
 14974         MOVE ER-8063            TO EMI-ERROR
 14975         GO TO 5300-BAD-EXIT.
 14976
 14977     IF DM-RETURN-CODE = '14'
 14978         MOVE ER-8064            TO EMI-ERROR
 14979         GO TO 5300-BAD-EXIT.
 14980
 14981     IF DM-RETURN-CODE = '15'
 14982         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 288
* EL156.cbl
 14983         GO TO 5300-BAD-EXIT.
 14984
 14985     IF DM-RETURN-CODE = '16'
 14986         MOVE ER-8154            TO EMI-ERROR
 14987         GO TO 5300-BAD-EXIT.
 14988
 14989     IF DM-RETURN-CODE = '17'
 14990         MOVE ER-8155            TO EMI-ERROR
 14991         GO TO 5300-BAD-EXIT.
 14992
 14993     IF DM-RETURN-CODE = 'N1'
 14994         MOVE ER-8152            TO EMI-ERROR
 14995         GO TO 5300-BAD-EXIT.
 14996
 14997     IF DM-RETURN-CODE = 'E1'
 14998         MOVE ER-8153            TO EMI-ERROR
 14999         GO TO 5300-BAD-EXIT.
 15000
 15001     MOVE ER-8066            TO EMI-ERROR.
 15002     GO TO 5300-BAD-EXIT.
 15003
 15004 5300-NOTE-NOT-FOUND.
 15005
 15006     MOVE ER-0954                TO EMI-ERROR.
 15007     GO TO 5300-BAD-EXIT.
 15008
 15009 5300-BAD-EXIT.
 15010
 15011* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15012*    MOVE '6"R                   !   #00014137' TO DFHEIV0
 15013     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15014     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15015     MOVE X'2020233030303134313337' TO DFHEIV0(25:11)
 15016     CALL 'kxdfhei1' USING DFHEIV0
 15017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15018
 15019     IF MAP-NAME = 'EL156A'
 15020         MOVE -1             TO ENTERPFL
 15021       ELSE
 15022         MOVE LOW-VALUES     TO EL156BI
 15023         MOVE -1             TO ENTPFBL.
 15024
 15025     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15026     GO TO 8200-SEND-DATAONLY.
 15027
 15028 5300-EXIT.
 15029     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 289
* EL156.cbl
 15031 5350-FORMAT-LAST-NAME-1ST.
 15032*****************************************************************
 15033*             M O V E   N A M E   R O U T I N E                 *
 15034*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15035*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15036*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15037*                  FIELD                   VALUE                *
 15038*           W-NAME-LAST    (CL15)      SMITH                    *
 15039*           W-NAME-FIRST   (CL15)      JOHN                     *
 15040*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 15041*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15042*     CONTAIN                                                   *
 15043*                SMITH, JOHN ALLEN                              *
 15044*     OR                                                        *
 15045*                SMITH, JOHN A.                                 *
 15046*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15047*     COPYBOOK, ELCNWA.                                         *
 15048*****************************************************************.
 15049
 15050     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 15051     MOVE ZERO                   TO  WS-NAME-SW.
 15052     SET NWA-INDEX               TO +1.
 15053
 15054     IF W-NAME-LAST   = SPACES AND
 15055        W-NAME-MIDDLE = SPACES
 15056         MOVE +1                 TO WS-NAME-SW.
 15057
 15058     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15059     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15060
 15061     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15062     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15063
 15064     SET NWA-INDEX UP BY +1.
 15065
 15066     IF W-NAME-MIDDLE NOT = SPACES
 15067         IF W-NAME-MIDDLE-2 = SPACES
 15068             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15069             SET NWA-INDEX UP BY +1
 15070             MOVE '.'            TO WS-NW (NWA-INDEX)
 15071             SET NWA-INDEX UP BY +2
 15072         ELSE
 15073             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15074             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15075
 15076 5350-EXIT.
 15077     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 290
* EL156.cbl
 15079 5360-MOVE-NAME.
 15080
 15081     IF WS-NAME-SW > +1
 15082         GO TO 5360-EXIT.
 15083
 15084     IF WS-NAME-WORK2 = SPACES
 15085         GO TO 5360-EXIT.
 15086
 15087     SET NWA-INDEX2            TO +1.
 15088     SET NWA-INDEX3            TO +2.
 15089
 15090 5360-MOVE-NAME-CYCLE.
 15091
 15092     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 15093
 15094     IF NWA-INDEX < +30
 15095         SET NWA-INDEX UP BY +1
 15096     ELSE
 15097         ADD +2                TO  WS-NAME-SW
 15098         GO TO 5360-EXIT.
 15099
 15100     IF NWA-INDEX2 < +20
 15101         SET NWA-INDEX3 UP BY +1
 15102         SET NWA-INDEX2 UP BY +1.
 15103
 15104     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 15105        WS-NW2 (NWA-INDEX3) = SPACES
 15106         IF WS-NAME-SW = ZERO
 15107             MOVE ','            TO  WS-NW (NWA-INDEX)
 15108             SET NWA-INDEX UP BY +2
 15109             MOVE +1             TO  WS-NAME-SW
 15110             GO TO 5360-EXIT
 15111         ELSE
 15112             GO TO 5360-EXIT.
 15113
 15114     GO TO 5360-MOVE-NAME-CYCLE.
 15115
 15116 5360-EXIT.
 15117     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 291
* EL156.cbl
 15119 6000-BUILD-SCREEN-B.
 15120     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15121     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15122     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15123     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15124
 15125     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 15126
 15127 6050-BUILD-SCREEN.
 15128     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 15129     MOVE LOW-VALUES             TO EL156BI.
 15130     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 15131
 15132     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 15133
 15134     IF PI-PAYEE-TYPE = 'I'
 15135        GO TO 6060-READ-TRAILER.
 15136
 15137     IF PI-PAYEE-TYPE = 'B'
 15138        ADD +10                  TO TRLR-SEQ-NO
 15139        GO TO 6060-READ-TRAILER.
 15140
 15141     IF PI-PAYEE-TYPE = 'A'
 15142        ADD +20                  TO TRLR-SEQ-NO
 15143        GO TO 6060-READ-TRAILER.
 15144
 15145     IF PI-PAYEE-TYPE = 'O'
 15146        ADD +50                  TO TRLR-SEQ-NO
 15147        GO TO 6060-READ-TRAILER.
 15148
 15149     IF PI-PAYEE-TYPE = 'Q'
 15150        ADD +60                  TO TRLR-SEQ-NO
 15151        GO TO 6060-READ-TRAILER.
 15152
 15153     IF PI-PAYEE-TYPE = 'P'
 15154        ADD +30                  TO TRLR-SEQ-NO
 15155        GO TO 6060-READ-TRAILER.
 15156
 15157     IF PI-PAYEE-TYPE = 'E'
 15158        ADD +40                  TO TRLR-SEQ-NO.
 15159
 15160 6060-READ-TRAILER.
 15161
 15162     IF PI-PAYEE-TYPE    = 'A' AND
 15163        PI-PAYEE-SEQ-NUM = 0
 15164          GO TO 6061-READ-ACCOUNT.
 15165
 15166     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 15167        (PI-PAYEE-TYPE    = 'B')             AND
 15168        (PI-PAYEE-SEQ-NUM = 9)
 15169          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15170          IF BENE-FOUND-SW = 'N'
 15171            GO TO 6065-NOT-FOUND
 15172          ELSE
 15173            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15174            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15175            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15176*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 292
* EL156.cbl
 15177            STRING BE-CITY ' ' BE-STATE
 15178               DELIMITED BY '  ' INTO CITYSTBO
 15179            END-STRING
 15180            MOVE BE-ZIP-CODE       TO ZIPBO
 15181            GO TO 6061-READ-ACCOUNT.
 15182
 15183     IF PI-PAYEE-TYPE    = 'B' AND
 15184        PI-PAYEE-SEQ-NUM = 0
 15185          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15186          IF BENE-FOUND-SW = 'N'
 15187            GO TO 6065-NOT-FOUND
 15188          ELSE
 15189            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15190            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15191            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15192*           MOVE BE-CITY-STATE     TO CITYSTBO
 15193            STRING BE-CITY ' ' BE-STATE
 15194               DELIMITED BY '  ' INTO CITYSTBO
 15195            END-STRING
 15196            MOVE BE-ZIP-CODE       TO ZIPBO
 15197            if be-ach-yes-or-no = 'Y'
 15198               move 'Y'          to pi-ach-payment
 15199            else
 15200               move 'N'          to pi-ach-payment
 15201            end-if
 15202            GO TO 6061-READ-ACCOUNT.
 15203
 15204
 15205* EXEC CICS HANDLE CONDITION
 15206*         NOTFND(6065-NOT-FOUND)
 15207*     END-EXEC.
 15208*    MOVE '"$I                   ! / #00014323' TO DFHEIV0
 15209     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15210     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15211     MOVE X'2F20233030303134333233' TO DFHEIV0(25:11)
 15212     CALL 'kxdfhei1' USING DFHEIV0
 15213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15214
 15215
 15216     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15217
 15218     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 15219     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 15220     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 15221     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 15222*    MOVE AT-CITY-STATE          TO CITYSTBO.
 15223     STRING AT-CITY ' ' AT-STATE
 15224        DELIMITED BY '  ' INTO CITYSTBO
 15225     END-STRING
 15226     MOVE AT-ZIP-CODE            TO ZIPBO.
 15227
 15228 6061-READ-ACCOUNT.
 15229
 15230* EXEC CICS HANDLE CONDITION
 15231*         NOTFND(6068-ACCT-NOT-FND)
 15232*     END-EXEC.
 15233*    MOVE '"$I                   ! 0 #00014340' TO DFHEIV0
 15234     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 293
* EL156.cbl
 15235     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15236     MOVE X'3020233030303134333430' TO DFHEIV0(25:11)
 15237     CALL 'kxdfhei1' USING DFHEIV0
 15238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15239
 15240
 15241
 15242* EXEC CICS READ
 15243*         DATASET('ERACCT')
 15244*         SET    (ADDRESS OF ACCOUNT-MASTER)
 15245*         RIDFLD (PI-ACCT-KEY)
 15246*     END-EXEC.
 15247     MOVE 'ERACCT' TO DFHEIV1
 15248*    MOVE '&"S        E          (   #00014344' TO DFHEIV0
 15249     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15250     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15251     MOVE X'2020233030303134333434' TO DFHEIV0(25:11)
 15252     CALL 'kxdfhei1' USING DFHEIV0,
 15253           DFHEIV1,
 15254           DFHEIV20,
 15255           DFHEIV99,
 15256           PI-ACCT-KEY,
 15257           DFHEIV99,
 15258           DFHEIV99,
 15259           DFHEIV99
 15260     SET ADDRESS OF ACCOUNT-MASTER TO
 15261         DFHEIV20
 15262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15263
 15264
 15265     MOVE AM-CARRIER             TO ACARRBO.
 15266     MOVE AM-GROUPING            TO GROUPBO.
 15267     MOVE AM-STATE               TO STATEBO.
 15268     MOVE AM-ACCOUNT             TO ACCTBO.
 15269     MOVE AM-NAME                TO ACCTNMBO.
 15270
 15271     IF PI-PAYEE-TYPE = 'A' AND
 15272        PI-PAYEE-SEQ-NUM = 0
 15273          MOVE AM-NAME             TO NAMEBO
 15274                                      PI-PAYEE-NAME
 15275          MOVE AM-ADDRS            TO ADDR1BO
 15276          MOVE SPACES              TO ADDR2BO
 15277*         MOVE AM-CITY             TO CITYSTBO
 15278          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 15279             DELIMITED BY '  ' INTO CITYSTBO
 15280          END-STRING
 15281          MOVE AM-ZIP-PRIME        TO WS-ZIP
 15282          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 15283          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 15284          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 15285
 15286***  We don't really need the code below because we don't do the
 15287***  AK thing anymore.  However, we may have a state special
 15288***  of some sort in the future so why not just leave it??
 15289     IF CITYSTBO EQUAL SPACES
 15290         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15291         GO TO 6070-FORMAT-DATA
 15292     END-IF.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 294
* EL156.cbl
 15293
 15294     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 15295     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 15296     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 15297     PERFORM VARYING WS-SUB FROM 30 BY -1
 15298          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 15299        IF WS-END-SUB = 0  AND
 15300           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
 15301              OR LOW-VALUES  OR '.')
 15302            CONTINUE
 15303        ELSE
 15304            IF WS-END-SUB = 0
 15305                MOVE WS-SUB TO WS-END-SUB
 15306            ELSE
 15307                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 15308                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 15309                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15310                END-IF
 15311            END-IF
 15312        END-IF
 15313        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 15314            COMPUTE WS-BEG-SUB = WS-SUB + 1
 15315            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15316        END-IF
 15317     END-PERFORM.
 15318
 15319     IF WS-BEG-SUB > 0
 15320         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 15321         IF WS-STATE-LENGTH = 2
 15322             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 15323                  TO PI-CHECK-STATE-FOR-AK
 15324         ELSE
 15325             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 15326                'ALASKA'
 15327                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 15328             ELSE
 15329                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15330             END-IF
 15331         END-IF
 15332     ELSE
 15333         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15334     END-IF.
 15335
 15336     GO TO 6070-FORMAT-DATA.
 15337
 15338 6065-NOT-FOUND.
 15339     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 15340     GO TO 6061-READ-ACCOUNT.
 15341
 15342 6068-ACCT-NOT-FND.
 15343     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15344
 15345 6070-FORMAT-DATA.
 15346     IF PI-HOLDTIL = ZEROS
 15347        MOVE SAVE-DATE           TO PAYDTBI
 15348       ELSE
 15349        MOVE PI-HOLDTIL          TO PAYDTBO
 15350        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 295
* EL156.cbl
 15351
 15352     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15353     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15354
 15355     IF EIBAID = DFHPF3 OR DFHPF4
 15356        NEXT SENTENCE
 15357     ELSE
 15358       GO TO 6071-CONTINUE.
 15359
 15360     MOVE PI-EPYFROM          TO PYFROMBO.
 15361     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15362
 15363     IF NOT PI-USES-PAID-TO
 15364        MOVE PI-EPYTHRU          TO PYTHRUBO
 15365        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15366     ELSE
 15367        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15368        MOVE '4'              TO DC-OPTION-CODE
 15369        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15370        IF NO-CONVERSION-ERROR
 15371           MOVE +1            TO DC-ELAPSED-DAYS
 15372           MOVE +0            TO DC-ELAPSED-MONTHS
 15373           MOVE '6'           TO DC-OPTION-CODE
 15374           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15375           IF NO-CONVERSION-ERROR
 15376              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15377
 15378     MOVE PI-EDAYS            TO DAYSBO.
 15379     MOVE PI-EPYAMT           TO PAYAMTBO.
 15380     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15381        IF PI-INT-AMT > ZEROS
 15382           MOVE PI-INT-AMT       TO INTAMTBO
 15383        END-IF
 15384     END-IF
 15385     GO TO 6072-SET-TYPE.
 15386
 15387 6071-CONTINUE.
 15388
 15389     IF PI-CPYFROM NOT = LOW-VALUES
 15390        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15391        MOVE SPACES              TO DC-OPTION-CODE
 15392        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15393        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15394
 15395     IF PI-CPYTHRU NOT = LOW-VALUES
 15396        IF NOT PI-USES-PAID-TO
 15397           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15398           MOVE SPACES             TO DC-OPTION-CODE
 15399           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15400           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15401        ELSE
 15402           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15403           MOVE '6'                TO DC-OPTION-CODE
 15404           MOVE +1                 TO DC-ELAPSED-DAYS
 15405           MOVE +0                 TO DC-ELAPSED-MONTHS
 15406           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15407           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15408
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 296
* EL156.cbl
 15409     MOVE PI-CDAYS               TO DAYSBO.
 15410     MOVE PI-CPYAMT              TO PAYAMTBO.
 15411     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15412        IF PI-INT-AMT > ZEROS
 15413           MOVE PI-INT-AMT       TO INTAMTBO
 15414        END-IF
 15415     END-IF
 15416     .
 15417 6072-SET-TYPE.
 15418     IF PI-PMTTYPE = '1'
 15419        MOVE 'PARTIAL'           TO PAYTYPBO.
 15420
 15421     IF PI-PMTTYPE = '2'
 15422        MOVE 'FINAL'             TO PAYTYPBO.
 15423
 15424     IF PI-PMTTYPE = '3'
 15425        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15426
 15427     IF PI-PMTTYPE = '4'
 15428        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15429
 15430     IF PI-PMTTYPE = '5'
 15431        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15432
 15433     IF PI-PMTTYPE = '6'
 15434        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15435
 15436     IF PI-PROV-PMT
 15437        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15438
 15439     IF PI-ECHECKNO NOT = SPACES
 15440        MOVE PI-ECHECKNO         TO CKNUMBO
 15441     ELSE
 15442        MOVE PI-CCHECKNO         TO CKNUMBO.
 15443
 15444     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 15445        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15446        MOVE +91                 TO  TRLR-SEQ-NO
 15447
 15448* EXEC CICS READ
 15449*           DATASET  ('ELTRLR')
 15450*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15451*           RIDFLD   (ELTRLR-KEY)
 15452*           RESP     (WS-RESPONSE)
 15453*       END-EXEC
 15454     MOVE 'ELTRLR' TO DFHEIV1
 15455*    MOVE '&"S        E          (  N#00014532' TO DFHEIV0
 15456     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15457     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15458     MOVE X'204E233030303134353332' TO DFHEIV0(25:11)
 15459     CALL 'kxdfhei1' USING DFHEIV0,
 15460           DFHEIV1,
 15461           DFHEIV20,
 15462           DFHEIV99,
 15463           ELTRLR-KEY,
 15464           DFHEIV99,
 15465           DFHEIV99,
 15466           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 297
* EL156.cbl
 15467     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15468         DFHEIV20
 15469     MOVE EIBRESP  TO WS-RESPONSE
 15470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15471
 15472        IF WS-RESP-NORMAL
 15473           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15474        ELSE
 15475           MOVE SPACES           TO  LOANNBO
 15476        END-IF
 15477     END-IF
 15478
 15479*       MOVE PI-LOAN-NO          TO LOANNBO
 15480
 15481     IF CKNUMBO = SPACES
 15482         MOVE SPACES             TO CKNUMHDO.
 15483
 15484     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15485     MOVE CL-CARRIER             TO CARRBO.
 15486     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15487     MOVE CL-CERT-SFX            TO SUFXBO.
 15488
 15489     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15490        EVALUATE CL-CLAIM-TYPE
 15491           WHEN 'I'
 15492              MOVE '  IU  '      TO CLMTYPBO
 15493           WHEN 'G'
 15494              MOVE ' GAP  '      TO CLMTYPBO
 15495           WHEN 'F'
 15496              MOVE ' FMLA '      TO CLMTYPBO
 15497           WHEN OTHER
 15498              MOVE PI-AH-OVERRIDE-L6
 15499                                 TO CLMTYPBO
 15500        END-EVALUATE
 15501        MOVE ZEROS               TO UNDISBO
 15502*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15503        IF PI-PMTTYPE = '5' OR '6'
 15504           GO TO 6073-GET-NOTIFY-DATA
 15505        ELSE
 15506           MOVE PI-DAILY-RATE    TO RATEBO
 15507           GO TO 6073-GET-NOTIFY-DATA.
 15508
 15509     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15510
 15511     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15512        MOVE ZEROS               TO UNDISBO
 15513     ELSE
 15514        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15515
 15516 6073-GET-NOTIFY-DATA.
 15517
 15518     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15519
 15520     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15521         MOVE SPACES             TO  NAMEB2O
 15522                                     ADDR1B2O
 15523                                     ADDR2B2O
 15524                                     CITYST2O
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 298
* EL156.cbl
 15525                                     AGTHDGO
 15526         MOVE ZEROS              TO  ZIPB2O
 15527         GO TO 6080-SET-INCURRED.
 15528
 15529     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15530     MOVE +29                    TO  TRLR-SEQ-NO.
 15531
 15532
 15533* EXEC CICS HANDLE CONDITION
 15534*        NOTFND   (6074-GET-COMP-DATA)
 15535*    END-EXEC.
 15536*    MOVE '"$I                   ! 1 #00014599' TO DFHEIV0
 15537     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15538     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15539     MOVE X'3120233030303134353939' TO DFHEIV0(25:11)
 15540     CALL 'kxdfhei1' USING DFHEIV0
 15541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15542
 15543
 15544     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15545
 15546     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15547     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15548     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15549*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15550     STRING AT-CITY ' ' AT-STATE
 15551        DELIMITED BY '  ' INTO CITYST2O
 15552     END-STRING
 15553     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15554     GO TO 6080-SET-INCURRED.
 15555
 15556 6074-GET-COMP-DATA.
 15557
 15558     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15559         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15560
 15561     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15562         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15563                                         ADDR1B2O
 15564                                         ADDR2B2O
 15565                                         CITYST2O
 15566         MOVE ZEROS                  TO  ZIPB2O
 15567         GO TO 6080-SET-INCURRED.
 15568
 15569     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15570     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15571     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15572     MOVE AM-GROUPING            TO  COMP-GROUP.
 15573     MOVE 'A'                    TO  COMP-TYPE.
 15574     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15575                                 TO  COMP-FIN-RESP.
 15576
 15577     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15578         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15579                                       'G' OR 'B' or 'S'
 15580             MOVE 'G'            TO  COMP-TYPE
 15581             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15582         ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 299
* EL156.cbl
 15583             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15584                                 TO  COMP-ACCOUNT
 15585     ELSE
 15586         MOVE 'G'                TO  COMP-TYPE
 15587         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15588
 15589     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15590
 15591     IF COMP-REC-FOUND
 15592         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15593         MOVE CO-ADDR-1          TO  ADDR1B2O
 15594         MOVE CO-ADDR-2          TO  ADDR2B2O
 15595*        MOVE CO-ADDR-3          TO  CITYST2O
 15596         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15597            DELIMITED BY '  ' INTO CITYST2O
 15598         END-STRING
 15599         MOVE CO-ZIP             TO  ZIPB2O
 15600     ELSE
 15601         MOVE 'NO COMP ADDRESS AVAILABLE'
 15602                                 TO  NAMEB2O
 15603                                     ADDR1B2O
 15604                                     ADDR2B2O
 15605                                     CITYST2O
 15606         MOVE ZEROS               TO ZIPB2O.
 15607
 15608 6080-SET-INCURRED.
 15609     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15610     MOVE SPACES                 TO DC-OPTION-CODE.
 15611     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15612     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15613     MOVE PI-PROCESSOR-ID        TO BYBO.
 15614     MOVE MAP-NAMEB              TO MAP-NAME.
 15615     MOVE 'C'                    TO PI-PASS-SW.
 15616     MOVE EIBAID                 TO PI-PFKEY-USED.
 15617     MOVE -1                     TO ENTPFBL.
 15618     GO TO 8100-SEND-INITIAL-MAP.
 15619
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 300
* EL156.cbl
 15621 6100-BUILD-PAYMENT-TRAILER.
 15622
 15623     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15624     MOVE '6'                    TO CNTL-REC-TYPE.
 15625
 15626     IF CONTROL-IS-ACTUAL-CARRIER
 15627         MOVE PI-CARRIER         TO WS-CARR
 15628     ELSE
 15629         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15630
 15631     IF PI-COMPANY-ID = 'FIA'
 15632         MOVE PI-CARRIER         TO  WS-CARR.
 15633
 15634     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15635     MOVE 0                      TO CNTL-SEQ-NO.
 15636     MOVE 'CARR'                 TO FILE-SWITCH.
 15637
 15638     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15639
 15640     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15641         IF PI-OFFLINE     = 'Y' AND
 15642            PI-ECHECKNO-CR = 'CR'
 15643              GO TO 6110-READ-CONTROL
 15644         ELSE
 15645            IF PI-CASH = 'N'
 15646                GO TO 6110-READ-CONTROL.
 15647
 15648     IF CHECK-NO-MANUAL    OR
 15649        CHECK-NO-AT-PRINT  OR
 15650        PI-OFFLINE = 'Y'
 15651          GO TO 6130-BUILD-TRAILER.
 15652     IF PI-COMPANY-ID = 'FIA'
 15653         NEXT SENTENCE
 15654     ELSE
 15655         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15656             GO TO 6110-READ-CONTROL.
 15657
 15658     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15659
 15660     IF CHECK-CNT-RESET-VALUE
 15661        MOVE +1                  TO CF-CHECK-COUNTER
 15662     ELSE
 15663        ADD +1                   TO CF-CHECK-COUNTER.
 15664
 15665     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15666
 15667     IF CHECK-NO-CARR-SEQ
 15668        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15669
 15670     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15671
 15672     MOVE 'N' TO PI-REAUDIT-NEEDED.
 15673     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15674        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15675         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15676         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15677            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15678         MOVE WRK-NEXT-AUDIT-CHK-NO TO
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 301
* EL156.cbl
 15679                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15680     END-IF.
 15681
 15682     GO TO 6120-REWRITE.
 15683
 15684 6105-STATE-CHECK-NUMBER.
 15685     IF CHECK-NO-MANUAL    OR
 15686        CHECK-NO-AT-PRINT  OR
 15687        PI-OFFLINE = 'Y'
 15688           GO TO 6130-BUILD-TRAILER
 15689     END-IF.
 15690
 15691     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15692     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15693     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15694     MOVE '3'                TO CNTL-REC-TYPE.
 15695     MOVE +0                 TO CNTL-SEQ-NO.
 15696     MOVE 'STAT'             TO FILE-SWITCH.
 15697     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15698
 15699     IF CF-ST-CHECK-CNT-RESET
 15700         MOVE +1             TO CF-ST-CHECK-COUNTER
 15701     ELSE
 15702         ADD +1              TO CF-ST-CHECK-COUNTER
 15703     END-IF.
 15704
 15705     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15706     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15707     GO TO 6120-REWRITE.
 15708
 15709 6110-READ-CONTROL.
 15710     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15711     MOVE '1'                    TO CNTL-REC-TYPE.
 15712     MOVE SPACES                 TO CNTL-ACCESS.
 15713     MOVE 0                      TO CNTL-SEQ-NO.
 15714
 15715     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15716
 15717     IF CO-CHECK-COUNT-RESET
 15718        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15719     ELSE
 15720        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15721
 15722     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15723
 15724     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15725         IF PI-OFFLINE     = 'Y'  AND
 15726            PI-ECHECKNO-CR = 'CR'
 15727              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15728              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15729              MOVE AL-UANON           TO CHECKNOA
 15730              GO TO 6120-REWRITE
 15731         ELSE
 15732         IF PI-CASH = 'N'
 15733             MOVE 'N'                TO PI-ECHECKNO-N
 15734             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15735             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15736             MOVE AL-UANON           TO CHECKNOA
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 302
* EL156.cbl
 15737             GO TO 6120-REWRITE.
 15738
 15739     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15740
 15741 6120-REWRITE.
 15742
 15743* EXEC CICS REWRITE
 15744*         DATASET('ELCNTL')
 15745*         FROM(CONTROL-FILE)
 15746*     END-EXEC.
 15747     MOVE LENGTH OF
 15748      CONTROL-FILE
 15749       TO DFHEIV11
 15750     MOVE 'ELCNTL' TO DFHEIV1
 15751*    MOVE '&& L                  %   #00014801' TO DFHEIV0
 15752     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15753     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15754     MOVE X'2020233030303134383031' TO DFHEIV0(25:11)
 15755     CALL 'kxdfhei1' USING DFHEIV0,
 15756           DFHEIV1,
 15757           CONTROL-FILE,
 15758           DFHEIV11,
 15759           DFHEIV99
 15760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15761
 15762
 15763     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15764
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 303
* EL156.cbl
 15766 6130-BUILD-TRAILER.
 15767
 15768
 15769* EXEC CICS GETMAIN
 15770*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15771*         LENGTH    (200)
 15772*         INITIMG   (GETMAIN-SPACE)
 15773*     END-EXEC.
 15774     MOVE 200
 15775       TO DFHEIV11
 15776*    MOVE ',"IL                  $   #00014811' TO DFHEIV0
 15777     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15778     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15779     MOVE X'2020233030303134383131' TO DFHEIV0(25:11)
 15780     CALL 'kxdfhei1' USING DFHEIV0,
 15781           DFHEIV20,
 15782           DFHEIV11,
 15783           GETMAIN-SPACE
 15784     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15785         DFHEIV20
 15786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15787
 15788
 15789     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15790                                    AT-PREV-PAID-THRU-DT.
 15791     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15792     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15793     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15794     MOVE 'AT'                   TO AT-RECORD-ID.
 15795     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15796
 15797     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15798        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15799           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15800     ELSE
 15801           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15802           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15803
 15804     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15805         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15806             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15807             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15808           ELSE
 15809             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15810             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15811
 15812     MOVE '2'                    TO AT-TRAILER-TYPE.
 15813     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15814                                    AT-PAYMENT-LAST-MAINT-DT.
 15815     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15816                                    AT-PAYMENT-LAST-UPDATED-BY.
 15817     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15818     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15819     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15820     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15821
 15822     IF PI-PMT-APPROVED
 15823        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 304
* EL156.cbl
 15824           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15825
 15826     IF PI-PFKEY-USED = DFHPF5
 15827        GO TO 6140-PF5-ENTERED.
 15828
 15829     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15830     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15831
 15832     IF PI-AIG-SPECIAL-BENEFIT
 15833         IF WS-1ST-SPECIAL-PMT
 15834             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15835             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15836                                        AT-AMOUNT-PAID
 15837         ELSE
 15838             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15839
 15840     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15841
 15842     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15843     MOVE '4'                    TO DC-OPTION-CODE.
 15844     PERFORM 9700-LINK-DATE-CONVERT.
 15845
 15846     IF DATE-CONVERSION-ERROR
 15847        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15848     ELSE
 15849        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15850
 15851     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15852     MOVE '4'                    TO DC-OPTION-CODE.
 15853     PERFORM 9700-LINK-DATE-CONVERT.
 15854
 15855     IF DATE-CONVERSION-ERROR
 15856        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15857     ELSE
 15858        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15859
 15860     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD
 15861     move pi-ach-payment         to at-ach-payment
 15862     GO TO 6150-FINISH-MOVE.
 15863
 15864 6140-PF5-ENTERED.
 15865     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15866     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15867
 15868     IF PI-AIG-SPECIAL-BENEFIT
 15869         IF WS-1ST-SPECIAL-PMT
 15870             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15871             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15872                                        AT-AMOUNT-PAID
 15873         ELSE
 15874             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15875
 15876     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15877     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15878     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15879
 15880 6150-FINISH-MOVE.
 15881
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 305
* EL156.cbl
 15882     IF PI-ECHECKNO = SPACES
 15883         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15884     ELSE
 15885         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15886
 15887     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15888     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15889
 15890*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15891*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15892
 15893     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15894         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15895
 15896     IF PI-OFFLINE = 'N'
 15897        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15898        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15899     ELSE
 15900        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15901        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15902
 15903     move pi-ach-payment         to at-ach-payment
 15904     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15905
 15906     IF WS-2ND-SPECIAL-PMT
 15907         MOVE 'Y'                TO AT-CASH-PAYMENT
 15908         MOVE SPACES             TO AT-CHECK-NO
 15909         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15910         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15911         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15912         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15913
 15914     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15915                                    AT-TO-BE-WRITTEN-DT.
 15916
 15917     IF PI-HOLDTIL NOT = ZEROS
 15918        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15919        MOVE '4'                 TO DC-OPTION-CODE
 15920        PERFORM 9700-LINK-DATE-CONVERT
 15921        IF PI-OFFLINE = 'N'
 15922           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15923           MOVE 'P'              TO WS-HOLD-UNTIL-SW
 15924        ELSE
 15925           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15926
 15927     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15928     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15929                                    AT-CHECK-QUE-SEQUENCE.
 15930
 15931     IF PI-PFKEY-USED = DFHPF4
 15932        MOVE '1'                 TO AT-FORCE-CONTROL.
 15933
 15934     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15935        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15936        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15937        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15938
 15939     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 306
* EL156.cbl
 15940                                    AT-VOID-SELECT-DT
 15941                                    AT-VOID-ACCEPT-DT
 15942                                    AT-VOID-DT.
 15943     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 15944        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15945        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15946        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15947        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15948     ELSE
 15949        MOVE ZEROS               TO AT-DAILY-RATE
 15950                                    AT-ELIMINATION-DAYS
 15951        MOVE SPACES              TO AT-BENEFIT-TYPE
 15952     END-IF
 15953     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15954     MOVE '4'                    TO DC-OPTION-CODE.
 15955     PERFORM 9700-LINK-DATE-CONVERT.
 15956     IF DATE-CONVERSION-ERROR
 15957         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15958     ELSE
 15959         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15960     END-IF.
 15961     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15962     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15963     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15964     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15965     IF (PI-REAUDIT-NEEDED = 'Y')
 15966        or (pi-max-ext-used = 'Y')
 15967        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15968         PERFORM 6155-READ-CONTROL
 15969         PERFORM 6157-SET-APP-LEVEL
 15970         IF AT-APPROVAL-LEVEL-REQD < '4'
 15971            MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15972         END-IF
 15973         MOVE 'Y' TO WS-NEED-APPROVAL
 15974         GO TO 6170-WRITE
 15975     END-IF.
 15976*******************************************************
 15977     IF NOT PI-PMT-GRADUATED
 15978         GO TO 6170-WRITE.
 15979     PERFORM 6155-READ-CONTROL.
 15980
 15981     IF PAID-FOR-LIFE
 15982         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15983             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15984                                     WS-PMT-APPROVAL-SW
 15985             GO TO 6170-WRITE.
 15986
 15987*05999      IF PAID-FOR-AH
 15988     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15989         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15990             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15991                                     WS-PMT-APPROVAL-SW
 15992             GO TO 6170-WRITE.
 15993
 15994     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15995
 15996     PERFORM 6157-SET-APP-LEVEL.
 15997
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 307
* EL156.cbl
 15998     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15999
 16000     IF NOT PI-PMT-GRADUATED
 16001         GO TO 6170-WRITE.
 16002
 16003
 16004* EXEC CICS HANDLE CONDITION
 16005*        NOTFND   (6170-WRITE)
 16006*    END-EXEC.
 16007*    MOVE '"$I                   ! 2 #00015031' TO DFHEIV0
 16008     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16009     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16010     MOVE X'3220233030303135303331' TO DFHEIV0(25:11)
 16011     CALL 'kxdfhei1' USING DFHEIV0
 16012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16013
 16014
 16015     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16016     MOVE '2'                    TO CNTL-REC-TYPE.
 16017     MOVE +0                     TO CNTL-SEQ-NO.
 16018     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 16019
 16020
 16021* EXEC CICS READ
 16022*         DATASET  ('ELCNTL')
 16023*         SET      (ADDRESS OF CONTROL-FILE)
 16024*         RIDFLD   (ELCNTL-KEY)
 16025*    END-EXEC.
 16026     MOVE 'ELCNTL' TO DFHEIV1
 16027*    MOVE '&"S        E          (   #00015040' TO DFHEIV0
 16028     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16029     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16030     MOVE X'2020233030303135303430' TO DFHEIV0(25:11)
 16031     CALL 'kxdfhei1' USING DFHEIV0,
 16032           DFHEIV1,
 16033           DFHEIV20,
 16034           DFHEIV99,
 16035           ELCNTL-KEY,
 16036           DFHEIV99,
 16037           DFHEIV99,
 16038           DFHEIV99
 16039     SET ADDRESS OF CONTROL-FILE TO
 16040         DFHEIV20
 16041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16042
 16043
 16044     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 16045
 16046     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 16047                         OR '4' OR '5'
 16048         NEXT SENTENCE
 16049     ELSE
 16050         MOVE 'Y' TO WS-NEED-APPROVAL
 16051         GO TO 6170-WRITE.
 16052
 16053     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 16054         MOVE 'Y' TO WS-NEED-APPROVAL
 16055         IF WS-APPROVAL-LEVEL = '1'
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 308
* EL156.cbl
 16056             MOVE '2'        TO  AT-APPROVED-LEVEL
 16057                            WS-SAVE-APPROVED-LEVEL
 16058             GO TO 6170-WRITE
 16059         ELSE
 16060             IF WS-APPROVAL-LEVEL = '2'
 16061                 MOVE '3'        TO  AT-APPROVED-LEVEL
 16062                                WS-SAVE-APPROVED-LEVEL
 16063                 GO TO 6170-WRITE
 16064             ELSE IF WS-APPROVAL-LEVEL = '3'
 16065                 MOVE '4'        TO  AT-APPROVED-LEVEL
 16066                                WS-SAVE-APPROVED-LEVEL
 16067                 GO TO 6170-WRITE
 16068             ELSE IF WS-APPROVAL-LEVEL = '4'
 16069                 MOVE '5'        TO  AT-APPROVED-LEVEL
 16070                                WS-SAVE-APPROVED-LEVEL
 16071                 GO TO 6170-WRITE.
 16072
 16073     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 16074                             WS-PMT-APPROVAL-SW.
 16075     MOVE SPACES         TO  AT-APPROVED-LEVEL
 16076                             AT-APPROVAL-LEVEL-REQD.
 16077
 16078*******************************************************
 16079 6155-READ-CONTROL.
 16080     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16081     MOVE '1'                    TO CNTL-REC-TYPE.
 16082     MOVE SPACES                 TO CNTL-ACCESS.
 16083     MOVE +0                     TO CNTL-SEQ-NO.
 16084     MOVE 'COMP'                 TO FILE-SWITCH.
 16085
 16086     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 16087 6157-SET-APP-LEVEL.
 16088******A&H Limits are set as a monthly payment.  Calculate the mont
 16089******equivalent of the amount paid today
 16090     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 16091        PI-SAVE-ODD-DAYS-OVER > 0
 16092           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 16093                               / 30) + PI-SAVE-ELAPSED-MONTHS
 16094           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 16095                                  WS-CALC-PMT-MONTHS
 16096     ELSE
 16097           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 16098     END-IF.
 16099*06007      IF ((PAID-FOR-AH) AND
 16100     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16101           OR PAID-FOR-FAM) AND
 16102*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16103        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 16104              OR
 16105        ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16106        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16107            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16108       ELSE
 16109*06014      IF ((PAID-FOR-AH)  AND
 16110         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16111           OR PAID-FOR-FAM) AND
 16112*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 16113           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 309
* EL156.cbl
 16114              OR
 16115        ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16116        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 16117            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16118         ELSE
 16119*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 16120           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16121                OR PAID-FOR-FAM) AND
 16122               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 16123              OR
 16124          ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16125          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 16126            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16127       ELSE
 16128           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16129                OR PAID-FOR-FAM) AND
 16130               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 16131              OR
 16132          ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16133          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 16134            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16135       ELSE
 16136            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16137
 16138     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16139           OR PAID-FOR-FAM) AND
 16140        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 16141        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 16142            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16143        END-IF
 16144     ELSE
 16145     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16146           OR PAID-FOR-FAM) AND
 16147        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 16148        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 16149            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16150        END-IF
 16151     ELSE
 16152     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16153           OR PAID-FOR-FAM) AND
 16154        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 16155        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 16156            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16157        END-IF
 16158     ELSE
 16159     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16160           OR PAID-FOR-FAM) AND
 16161        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 16162        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 16163            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16164        END-IF
 16165     ELSE
 16166     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16167           OR PAID-FOR-FAM)
 16168            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16169
 16170 6170-WRITE.
 16171
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 310
* EL156.cbl
 16172     if pi-company-id = 'DCC' or 'VPP'
 16173        PERFORM 0900-GET-DDF-limits
 16174                                 THRU 0900-EXIT
 16175     end-if
 16176     perform 2220-update-elcrtt  thru 2220-exit
 16177     IF PI-COMPANY-ID = 'DMD'
 16178        IF PI-AT-EOB-CODES NOT = SPACES
 16179           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16180           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16181           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16182           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16183           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16184
 16185
 16186* EXEC CICS HANDLE CONDITION
 16187*        DUPREC    (6180-DUPREC)
 16188*    END-EXEC.
 16189*    MOVE '"$%                   ! 3 #00015187' TO DFHEIV0
 16190     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16191     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16192     MOVE X'3320233030303135313837' TO DFHEIV0(25:11)
 16193     CALL 'kxdfhei1' USING DFHEIV0
 16194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16195
 16196
 16197
 16198* EXEC CICS WRITE
 16199*         DATASET       ('ELTRLR')
 16200*         FROM          (ACTIVITY-TRAILERS)
 16201*         RIDFLD        (AT-CONTROL-PRIMARY)
 16202*     END-EXEC.
 16203     MOVE LENGTH OF
 16204      ACTIVITY-TRAILERS
 16205       TO DFHEIV11
 16206     MOVE 'ELTRLR' TO DFHEIV1
 16207*    MOVE '&$ L                  ''   #00015191' TO DFHEIV0
 16208     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16209     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16210     MOVE X'2020233030303135313931' TO DFHEIV0(25:11)
 16211     CALL 'kxdfhei1' USING DFHEIV0,
 16212           DFHEIV1,
 16213           ACTIVITY-TRAILERS,
 16214           DFHEIV11,
 16215           AT-CONTROL-PRIMARY,
 16216           DFHEIV99,
 16217           DFHEIV99
 16218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16219
 16220
 16221     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 16222        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 16223*06088           GO TO 6199-EXIT.
 16224           GO TO 6176-APPROVAL-NOTE.
 16225
 16226
 16227* EXEC CICS GETMAIN
 16228*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16229*         LENGTH    (200)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 311
* EL156.cbl
 16230*         INITIMG   (GETMAIN-SPACE)
 16231*     END-EXEC.
 16232     MOVE 200
 16233       TO DFHEIV11
 16234*    MOVE ',"IL                  $   #00015202' TO DFHEIV0
 16235     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16236     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16237     MOVE X'2020233030303135323032' TO DFHEIV0(25:11)
 16238     CALL 'kxdfhei1' USING DFHEIV0,
 16239           DFHEIV20,
 16240           DFHEIV11,
 16241           GETMAIN-SPACE
 16242     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16243         DFHEIV20
 16244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16245
 16246
 16247     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16248
 16249     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 16250     MOVE 'AT'                   TO AT-RECORD-ID.
 16251     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16252     MOVE '6'                    TO AT-TRAILER-TYPE.
 16253     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16254                                    AT-GEN-INFO-LAST-MAINT-DT
 16255     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16256                                    AT-GEN-INFO-LAST-UPDATED-BY
 16257     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16258
 16259     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 16260     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 16261     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 16262
 16263     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 16264
 16265 6175-WRITE.
 16266
 16267
 16268* EXEC CICS HANDLE CONDITION
 16269*        DUPREC    (6190-DUPREC)
 16270*    END-EXEC.
 16271*    MOVE '"$%                   ! 4 #00015228' TO DFHEIV0
 16272     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16273     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16274     MOVE X'3420233030303135323238' TO DFHEIV0(25:11)
 16275     CALL 'kxdfhei1' USING DFHEIV0
 16276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16277
 16278
 16279
 16280* EXEC CICS WRITE
 16281*         DATASET     ('ELTRLR')
 16282*         FROM        (ACTIVITY-TRAILERS)
 16283*         RIDFLD      (AT-CONTROL-PRIMARY)
 16284*     END-EXEC.
 16285     MOVE LENGTH OF
 16286      ACTIVITY-TRAILERS
 16287       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 312
* EL156.cbl
 16288     MOVE 'ELTRLR' TO DFHEIV1
 16289*    MOVE '&$ L                  ''   #00015232' TO DFHEIV0
 16290     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16291     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16292     MOVE X'2020233030303135323332' TO DFHEIV0(25:11)
 16293     CALL 'kxdfhei1' USING DFHEIV0,
 16294           DFHEIV1,
 16295           ACTIVITY-TRAILERS,
 16296           DFHEIV11,
 16297           AT-CONTROL-PRIMARY,
 16298           DFHEIV99,
 16299           DFHEIV99
 16300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16301
 16302
 16303 6176-APPROVAL-NOTE.
 16304
 16305     IF NOT APPROVAL-NEEDED
 16306         GO TO 6199-EXIT.
 16307
 16308
 16309* EXEC CICS GETMAIN
 16310*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16311*        LENGTH    (200)
 16312*        INITIMG   (GETMAIN-SPACE)
 16313*    END-EXEC.
 16314     MOVE 200
 16315       TO DFHEIV11
 16316*    MOVE ',"IL                  $   #00015243' TO DFHEIV0
 16317     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16318     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16319     MOVE X'2020233030303135323433' TO DFHEIV0(25:11)
 16320     CALL 'kxdfhei1' USING DFHEIV0,
 16321           DFHEIV20,
 16322           DFHEIV11,
 16323           GETMAIN-SPACE
 16324     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16325         DFHEIV20
 16326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16327
 16328
 16329     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 16330
 16331     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 16332     MOVE 'AT'               TO AT-RECORD-ID
 16333     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 16334     MOVE '6'                TO AT-TRAILER-TYPE
 16335     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 16336                                AT-GEN-INFO-LAST-MAINT-DT
 16337     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 16338                                AT-GEN-INFO-LAST-UPDATED-BY
 16339     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 16340
 16341     IF PI-REAUDIT-NEEDED = 'Y'
 16342         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 16343     ELSE
 16344         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 16345     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 313
* EL156.cbl
 16346     IF PI-APPROVAL-3550-NEEDED = 'Y'
 16347         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 16348     END-IF
 16349     MOVE SPACES             TO AT-INFO-LINE-2
 16350
 16351     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 16352 6177-WRITE.
 16353
 16354
 16355* EXEC CICS HANDLE CONDITION
 16356*        DUPREC    (6185-DUPREC)
 16357*    END-EXEC.
 16358*    MOVE '"$%                   ! 5 #00015274' TO DFHEIV0
 16359     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16360     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16361     MOVE X'3520233030303135323734' TO DFHEIV0(25:11)
 16362     CALL 'kxdfhei1' USING DFHEIV0
 16363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16364
 16365
 16366
 16367* EXEC CICS WRITE
 16368*         DATASET     ('ELTRLR')
 16369*         FROM        (ACTIVITY-TRAILERS)
 16370*         RIDFLD      (AT-CONTROL-PRIMARY)
 16371*     END-EXEC.
 16372     MOVE LENGTH OF
 16373      ACTIVITY-TRAILERS
 16374       TO DFHEIV11
 16375     MOVE 'ELTRLR' TO DFHEIV1
 16376*    MOVE '&$ L                  ''   #00015278' TO DFHEIV0
 16377     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16378     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16379     MOVE X'2020233030303135323738' TO DFHEIV0(25:11)
 16380     CALL 'kxdfhei1' USING DFHEIV0,
 16381           DFHEIV1,
 16382           ACTIVITY-TRAILERS,
 16383           DFHEIV11,
 16384           AT-CONTROL-PRIMARY,
 16385           DFHEIV99,
 16386           DFHEIV99
 16387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16388
 16389
 16390
 16391     GO TO 6199-EXIT.
 16392
 16393 6180-DUPREC.
 16394
 16395     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16396     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16397     GO TO 6170-WRITE.
 16398
 16399 6185-DUPREC.
 16400     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16401     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16402     GO TO 6177-WRITE.
 16403
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 314
* EL156.cbl
 16404 6190-DUPREC.
 16405     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16406     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16407     GO TO 6175-WRITE.
 16408
 16409 6199-EXIT.
 16410      EXIT.
 16411
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 315
* EL156.cbl
 16413 6200-UPDATE-CLAIM-MSTR.
 16414     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16415     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16416     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16417     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16418
 16419     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16420
 16421     MOVE ZEROS                  TO W-INTEREST.
 16422
 16423     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 16424        IF (PI-OFFLINE = 'Y') OR
 16425           (PI-PMTTYPE = '7')
 16426           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16427                                 THRU 9870-EXIT
 16428        END-IF
 16429     END-IF
 16430     IF NOT ERROR-ON-OUTPUT
 16431        CONTINUE
 16432     ELSE
 16433
 16434* EXEC CICS REWRITE
 16435*          DATASET('ELMSTR')
 16436*          FROM(CLAIM-MASTER)
 16437*       END-EXEC
 16438     MOVE LENGTH OF
 16439      CLAIM-MASTER
 16440       TO DFHEIV11
 16441     MOVE 'ELMSTR' TO DFHEIV1
 16442*    MOVE '&& L                  %   #00015327' TO DFHEIV0
 16443     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16444     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16445     MOVE X'2020233030303135333237' TO DFHEIV0(25:11)
 16446     CALL 'kxdfhei1' USING DFHEIV0,
 16447           DFHEIV1,
 16448           CLAIM-MASTER,
 16449           DFHEIV11,
 16450           DFHEIV99
 16451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16452
 16453        MOVE -1                  TO ENTPFBL
 16454        MOVE AL-UANON            TO ENTPFBA
 16455        MOVE MAP-NAMEB           TO MAP-NAME
 16456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16457        GO TO 8200-SEND-DATAONLY
 16458     END-IF
 16459
 16460     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16461
 16462     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16463
 16464     IF PI-AIG-SPECIAL-BENEFIT
 16465         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16466
 16467     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16468
 16469     IF PI-SPECIAL-BEN-SW = 'Y'
 16470         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 316
* EL156.cbl
 16471         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16472
 16473     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16474         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16475     ELSE
 16476         IF PI-PMTTYPE NOT = '4'
 16477            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16478
 16479     IF PI-PMTTYPE = '5' OR '6'
 16480        GO TO  6250-SET-MAINT.
 16481
 16482     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16483                                         CL-LAG-REPORT-CODE.
 16484
 16485     IF CL-ACTIVITY-CODE = 09
 16486         GO TO 6200-CONT-UPDATE.
 16487
 16488     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16489         IF CL-ACTIVITY-CODE = 11
 16490             GO TO 6200-CONT-UPDATE.
 16491
 16492     IF WS-ACT-REC-FOUND-SW = 'N'
 16493         GO TO 6200-CONT-UPDATE.
 16494
 16495     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16496         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16497         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16498         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16499
 16500     IF WS-UPDATE-SW = 'Y'
 16501         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16502                                         CL-NEXT-FOLLOWUP-DT.
 16503
 16504 6200-CONT-UPDATE.
 16505
 16506     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16507       IF CLAIM-IS-CLOSED
 16508         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16509           IF WS-OPEN-CLOSE-SW = '2'
 16510             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16511                                        CL-LAST-CLOSE-DT.
 16512
 16513     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16514        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16515        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16516
 16517     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16518        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16519        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16520        MOVE 'C'                 TO CL-CLAIM-STATUS
 16521        IF PI-PMTTYPE = '2'
 16522           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16523              or 'F')
 16524           CONTINUE
 16525        ELSE
 16526           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16527        END-IF
 16528     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 317
* EL156.cbl
 16529        IF PI-PMTTYPE = '2' OR '3'
 16530           IF PI-PMTTYPE = '2' AND
 16531              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16532                 or 'F')
 16533              CONTINUE
 16534           ELSE
 16535              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16536           END-IF
 16537        END-IF
 16538     END-IF
 16539
 16540     IF PI-PMTTYPE = '4'
 16541        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16542
 16543     IF PI-COMPANY-ID = 'CVL'
 16544         IF PI-LOAN-UPDATE-SW = 'Y'
 16545             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16546             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16547             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16548             MOVE CL-CERT-STATE      TO  CERT-STATE
 16549             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16550             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16551             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16552             MOVE 'CERT'             TO  FILE-SWITCH
 16553             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16554             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16555             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16556
 16557     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16558        GO TO 6220-USE-COMPUTED.
 16559
 16560     IF (PI-PMTTYPE = '4')  AND
 16561        (PI-EPYAMT < ZEROS)
 16562          COMPUTE CL-NO-OF-DAYS-PAID =
 16563                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16564          IF CL-NO-OF-DAYS-PAID < +0
 16565              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16566          ELSE
 16567              NEXT SENTENCE
 16568     ELSE
 16569          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16570
 16571     IF HOLD-UNTIL-PMT
 16572        CONTINUE
 16573     ELSE
 16574     IF PI-PROCESSOR-ID = 'FIX '
 16575        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16576           NEXT SENTENCE
 16577        ELSE
 16578           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16579     ELSE
 16580        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16581
 16582     IF PI-PMTTYPE = '4'
 16583        GO TO 6250-SET-MAINT.
 16584
 16585     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16586     MOVE '4'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 318
* EL156.cbl
 16587     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16588     IF HOLD-UNTIL-PMT
 16589        CONTINUE
 16590     ELSE
 16591     IF DATE-CONVERSION-ERROR
 16592        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16593     ELSE
 16594        ADD 1                 TO CL-NO-OF-PMTS-MADE
 16595        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16596           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16597           IF PI-AIG-SPECIAL-BENEFIT
 16598               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16599           ELSE
 16600               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16601
 16602     GO TO 6250-SET-MAINT.
 16603
 16604 6220-USE-COMPUTED.
 16605
 16606     IF (PI-PMTTYPE = '4')  AND
 16607        (PI-CPYAMT < ZEROS)
 16608          COMPUTE CL-NO-OF-DAYS-PAID =
 16609                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16610          IF CL-NO-OF-DAYS-PAID < +0
 16611              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16612          ELSE
 16613              NEXT SENTENCE
 16614     ELSE
 16615          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16616
 16617     IF NOT HOLD-UNTIL-PMT
 16618        ADD 1                    TO CL-NO-OF-PMTS-MADE
 16619        ADD PI-CPYAMT            TO CL-TOTAL-PAID-AMT.
 16620
 16621     IF PI-PMTTYPE = '4'
 16622        GO TO 6250-SET-MAINT.
 16623
 16624     IF PI-AIG-SPECIAL-BENEFIT
 16625         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16626     ELSE
 16627         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16628
 16629     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16630       AND NOT HOLD-UNTIL-PMT
 16631        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16632
 16633 6250-SET-MAINT.
 16634     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16635
 16636     IF PI-PROCESSOR-ID = 'FIX '
 16637        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16638           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16639        ELSE
 16640           NEXT SENTENCE
 16641     ELSE
 16642        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16643
 16644     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 319
* EL156.cbl
 16645     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16646     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16647
 16648 6299-EXIT.
 16649      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 320
* EL156.cbl
 16651 6300-UPDATE-CERT.
 16652
 16653*  ADD CERTNOTE FOR SC NP+6
 16654     IF PI-COMPANY-ID = 'CID' AND
 16655       (PI-PMTTYPE = '2' OR '3') AND
 16656        CL-CERT-STATE = 'SC'  AND
 16657        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16658           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16659     END-IF.
 16660
 16661     IF PI-COMPANY-ID = 'AHL' AND
 16662       (PI-PMTTYPE = '2' OR '3') AND
 16663        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16664           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16665           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16666     END-IF.
 16667
 16668     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16669     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16670     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16671     MOVE CL-CERT-STATE    TO CERT-STATE.
 16672     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16673     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16674     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16675     MOVE 'CERT'           TO FILE-SWITCH.
 16676
 16677     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16678
 16679     IF CERT-NOTE-ADDED
 16680        IF CM-NOTE-SW = ' '
 16681           MOVE '4'             TO CM-NOTE-SW
 16682        ELSE
 16683           IF CM-NOTE-SW = '1'
 16684               MOVE '5'           TO CM-NOTE-SW
 16685           ELSE
 16686              IF CM-NOTE-SW = '2'
 16687                 MOVE '6'         TO CM-NOTE-SW
 16688              ELSE
 16689                 IF CM-NOTE-SW = '3'
 16690                    MOVE '7'      TO CM-NOTE-SW
 16691                 END-IF
 16692              END-IF
 16693           END-IF
 16694        END-IF
 16695     END-IF.
 16696
 16697     IF PI-COMPANY-ID = 'CVL'
 16698         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16699         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16700
 16701     IF PI-PMTTYPE NOT = '4'
 16702        GO TO 6340-UPDATE-CERT.
 16703
 16704     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16705        IF PI-PFKEY-USED = DFHPF5
 16706           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16707        ELSE
 16708           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 321
* EL156.cbl
 16709
 16710*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16711*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16712*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16713*               PI-LF-COVERAGE-TYPE = 'P'
 16714*                GO TO 6350-REWRITE-CERT.
 16715
 16716     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16717       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16718          PI-LF-COVERAGE-TYPE = 'P'
 16719           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16720                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16721                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16722                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16723                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16724                GO TO 6350-REWRITE-CERT
 16725            ELSE
 16726                GO TO 6350-REWRITE-CERT.
 16727
 16728     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16729         GO TO 6350-REWRITE-CERT.
 16730
 16731     IF NOT CM-AH-LUMP-SUM-DISAB
 16732        GO TO 6380-UNLOCK-CERT.
 16733
 16734     IF PI-PFKEY-USED = DFHPF5
 16735        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16736                                    CM-AH-ITD-AH-PMT
 16737        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16738        GO TO 6350-REWRITE-CERT
 16739     ELSE
 16740        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16741                                    CM-AH-ITD-AH-PMT
 16742        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16743        GO TO 6350-REWRITE-CERT.
 16744
 16745 6340-UPDATE-CERT.
 16746
 16747     IF CL-CLAIM-TYPE = 'L' OR 'O'
 16748         IF PI-PFKEY-USED = DFHPF5
 16749             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16750         ELSE
 16751             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16752
 16753     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16754         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16755             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16756                PI-LF-COVERAGE-TYPE = 'P'
 16757                 GO TO 6350-REWRITE-CERT.
 16758
 16759     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16760       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16761          PI-LF-COVERAGE-TYPE = 'P'
 16762           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16763                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16764                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16765                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16766                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 322
* EL156.cbl
 16767                GO TO 6350-REWRITE-CERT.
 16768
 16769     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16770         IF PI-LIFE-OVERRIDE-L1 = ('L' OR 'O') AND
 16771            PI-LF-COVERAGE-TYPE NOT = 'P'
 16772             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16773             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16774             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16775             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16776             GO TO 6350-REWRITE-CERT.
 16777
 16778     IF CL-CLAIM-TYPE = 'O'
 16779         IF PI-LIFE-OVERRIDE-L1 = ('L' OR 'O') AND
 16780            PI-LF-COVERAGE-TYPE NOT = 'P'
 16781             MOVE CL-INCURRED-DT         TO CM-LF-CANCEL-DT
 16782             MOVE PI-MONTH-END-SAVE      TO CM-LF-CANCEL-EXIT-DT
 16783             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-CANCEL
 16784             MOVE '6'            TO CM-LF-CURRENT-STATUS
 16785             GO TO 6350-REWRITE-CERT.
 16786
 16787     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16788         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16789         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16790         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16791         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16792         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16793         IF PI-PFKEY-USED = DFHPF5
 16794             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16795                                        CM-AH-ITD-AH-PMT
 16796             GO TO 6350-REWRITE-CERT
 16797         ELSE
 16798             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16799                                        CM-AH-ITD-AH-PMT
 16800             GO TO 6350-REWRITE-CERT.
 16801
 16802 6350-REWRITE-CERT.
 16803
 16804
 16805* EXEC CICS REWRITE
 16806*         DATASET  ('ELCERT')
 16807*         FROM(CERTIFICATE-MASTER)
 16808*     END-EXEC.
 16809     MOVE LENGTH OF
 16810      CERTIFICATE-MASTER
 16811       TO DFHEIV11
 16812     MOVE 'ELCERT' TO DFHEIV1
 16813*    MOVE '&& L                  %   #00015683' TO DFHEIV0
 16814     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16815     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16816     MOVE X'2020233030303135363833' TO DFHEIV0(25:11)
 16817     CALL 'kxdfhei1' USING DFHEIV0,
 16818           DFHEIV1,
 16819           CERTIFICATE-MASTER,
 16820           DFHEIV11,
 16821           DFHEIV99
 16822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16823
 16824
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 323
* EL156.cbl
 16825     GO TO 6399-EXIT.
 16826
 16827 6380-UNLOCK-CERT.
 16828
 16829* EXEC CICS UNLOCK
 16830*         DATASET  ('ELCERT')
 16831*     END-EXEC.
 16832     MOVE 'ELCERT' TO DFHEIV1
 16833*    MOVE '&*                    #   #00015691' TO DFHEIV0
 16834     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16835     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16836     MOVE X'2020233030303135363931' TO DFHEIV0(25:11)
 16837     CALL 'kxdfhei1' USING DFHEIV0,
 16838           DFHEIV1,
 16839           DFHEIV99
 16840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16841
 16842
 16843 6399-EXIT.
 16844      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 324
* EL156.cbl
 16846 6400-UPDATE-ZERO-TRAILER.
 16847     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16848     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16849
 16850     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16851
 16852     IF PI-EPYAMT NOT = ZEROS
 16853         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16854     ELSE
 16855         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16856
 16857     IF PI-ERESV NOT = ZEROS
 16858        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16859
 16860     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16861        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16862
 16863     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16864        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16865     ELSE
 16866        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16867
 16868     IF PI-PMTTYPE = '5'
 16869        IF PI-EPYAMT = ZEROS
 16870           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16871        ELSE
 16872           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16873
 16874     IF PI-PMTTYPE = '6'
 16875        IF PI-EPYAMT = ZEROS
 16876           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16877        ELSE
 16878           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16879
 16880 6420-CHECK-OPEN-CLOSE.
 16881     IF PI-PMTTYPE = '5' OR '6'
 16882        GO TO 6450-REWRITE.
 16883
 16884     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16885         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16886             IF CLAIM-IS-CLOSED
 16887                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16888                 MOVE 1          TO  SUB-1
 16889                 GO TO 6440-AIG-LOOP.
 16890
 16891     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16892        GO TO 6450-REWRITE.
 16893
 16894     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16895        GO TO 6450-REWRITE.
 16896
 16897     MOVE 1                      TO SUB-1.
 16898
 16899 6430-LOOP.
 16900     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16901        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16902        IF PI-PMTTYPE = '1' OR '4'
 16903           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 325
* EL156.cbl
 16904           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16905           GO TO 6450-REWRITE
 16906        ELSE
 16907           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16908           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16909           GO TO 6450-REWRITE.
 16910
 16911     IF SUB-1 = 6
 16912      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16913      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16914      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16915      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16916      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16917      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16918      GO TO 6430-LOOP.
 16919
 16920     ADD 1                       TO SUB-1.
 16921     GO TO 6430-LOOP.
 16922
 16923
 16924 6440-AIG-LOOP.
 16925
 16926     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16927       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16928       IF WS-OPEN-CLOSE-SW = '1'
 16929         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16930         IF PI-PMTTYPE = '2'
 16931           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16932           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16933         ELSE
 16934           IF PI-PMTTYPE = '3'
 16935             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16936             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16937           ELSE
 16938             IF PI-PMTTYPE = '4'
 16939               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16940               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16941             ELSE
 16942               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16943               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16944       ELSE
 16945         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16946         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16947         GO TO 6450-REWRITE.
 16948
 16949     IF SUB-1 = 6
 16950      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16951      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16952      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16953      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16954      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16955      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16956      GO TO 6440-AIG-LOOP.
 16957
 16958     ADD 1                       TO SUB-1.
 16959     GO TO 6440-AIG-LOOP.
 16960
 16961 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 326
* EL156.cbl
 16962     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16963     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16964     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16965
 16966     IF PI-COMPANY-ID = 'DMD'
 16967         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16968         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16969         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16970         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16971         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16972
 16973
 16974* EXEC CICS REWRITE
 16975*         DATASET  ('ELTRLR')
 16976*         FROM     (ACTIVITY-TRAILERS)
 16977*     END-EXEC.
 16978     MOVE LENGTH OF
 16979      ACTIVITY-TRAILERS
 16980       TO DFHEIV11
 16981     MOVE 'ELTRLR' TO DFHEIV1
 16982*    MOVE '&& L                  %   #00015825' TO DFHEIV0
 16983     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16984     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16985     MOVE X'2020233030303135383235' TO DFHEIV0(25:11)
 16986     CALL 'kxdfhei1' USING DFHEIV0,
 16987           DFHEIV1,
 16988           ACTIVITY-TRAILERS,
 16989           DFHEIV11,
 16990           DFHEIV99
 16991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16992
 16993
 16994 6499-EXIT.
 16995      EXIT.
 16996
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 327
* EL156.cbl
 16998 6500-READ-DLO035.
 16999     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 17000     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 17001     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 17002     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 17003
 17004
 17005* EXEC CICS LINK
 17006*        PROGRAM    ('DLO035')
 17007*        COMMAREA   (DLO035-KEY)
 17008*        LENGTH     (DL35-LENGTH)
 17009*    END-EXEC.
 17010     MOVE 'DLO035' TO DFHEIV1
 17011*    MOVE '."C                   (   #00015840' TO DFHEIV0
 17012     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17013     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17014     MOVE X'2020233030303135383430' TO DFHEIV0(25:11)
 17015     CALL 'kxdfhei1' USING DFHEIV0,
 17016           DFHEIV1,
 17017           DLO035-KEY,
 17018           DL35-LENGTH,
 17019           DFHEIV99,
 17020           DFHEIV99,
 17021           DFHEIV99,
 17022           DFHEIV99
 17023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17024
 17025
 17026     IF DL35-RETURN-CODE = 'OK'
 17027         GO TO 6500-EXIT.
 17028
 17029     IF DL35-RETURN-CODE = '01'
 17030         MOVE ER-7830            TO EMI-ERROR
 17031         GO TO 6500-BAD-EXIT.
 17032
 17033     IF DL35-RETURN-CODE = '02'
 17034         MOVE ER-7831            TO EMI-ERROR
 17035         GO TO 6500-BAD-EXIT.
 17036
 17037     IF DL35-RETURN-CODE = '03'
 17038         MOVE ER-7832            TO EMI-ERROR
 17039         GO TO 6500-BAD-EXIT.
 17040
 17041     IF DL35-RETURN-CODE = '04'
 17042         MOVE ER-7833            TO EMI-ERROR
 17043         GO TO 6500-BAD-EXIT.
 17044
 17045     IF DL35-RETURN-CODE = '05'
 17046         MOVE ER-7834            TO EMI-ERROR
 17047         GO TO 6500-BAD-EXIT.
 17048
 17049     IF DL35-RETURN-CODE = '06'
 17050         MOVE ER-7835            TO EMI-ERROR
 17051         GO TO 6500-BAD-EXIT.
 17052
 17053     IF DL35-RETURN-CODE = '07'
 17054         MOVE ER-7836            TO EMI-ERROR
 17055         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 328
* EL156.cbl
 17056
 17057     IF DL35-RETURN-CODE = 'E1'
 17058         MOVE ER-7837            TO EMI-ERROR
 17059         GO TO 6500-BAD-EXIT.
 17060
 17061     IF DL35-RETURN-CODE NOT = 'OK'
 17062         MOVE ER-7838            TO EMI-ERROR
 17063         GO TO 6500-BAD-EXIT.
 17064
 17065 6500-EXIT.
 17066      EXIT.
 17067
 17068 6500-BAD-EXIT.
 17069
 17070* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 17071*    MOVE '6"R                   !   #00015889' TO DFHEIV0
 17072     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17074     MOVE X'2020233030303135383839' TO DFHEIV0(25:11)
 17075     CALL 'kxdfhei1' USING DFHEIV0
 17076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17077
 17078     MOVE -1                 TO PMTTYPEL.
 17079     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17080     GO TO 8200-SEND-DATAONLY.
 17081
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 329
* EL156.cbl
 17083 6600-UPDATE-DLO035.
 17084     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 17085     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 17086     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 17087     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 17088
 17089
 17090* EXEC CICS LINK
 17091*        PROGRAM    ('DLO035')
 17092*        COMMAREA   (DLO035-KEY)
 17093*        LENGTH     (DL35-LENGTH)
 17094*    END-EXEC.
 17095     MOVE 'DLO035' TO DFHEIV1
 17096*    MOVE '."C                   (   #00015901' TO DFHEIV0
 17097     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17098     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17099     MOVE X'2020233030303135393031' TO DFHEIV0(25:11)
 17100     CALL 'kxdfhei1' USING DFHEIV0,
 17101           DFHEIV1,
 17102           DLO035-KEY,
 17103           DL35-LENGTH,
 17104           DFHEIV99,
 17105           DFHEIV99,
 17106           DFHEIV99,
 17107           DFHEIV99
 17108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17109
 17110
 17111     IF DL35-RETURN-CODE = 'OK'
 17112         GO TO 6600-EXIT.
 17113
 17114     IF DL35-RETURN-CODE = '01'
 17115         MOVE ER-7830            TO EMI-ERROR
 17116         GO TO 6500-BAD-EXIT.
 17117
 17118     IF DL35-RETURN-CODE = '02'
 17119         MOVE ER-7831            TO EMI-ERROR
 17120         GO TO 6500-BAD-EXIT.
 17121
 17122     IF DL35-RETURN-CODE = '03'
 17123         MOVE ER-7832            TO EMI-ERROR
 17124         GO TO 6500-BAD-EXIT.
 17125
 17126     IF DL35-RETURN-CODE = '04'
 17127         MOVE ER-7833            TO EMI-ERROR
 17128         GO TO 6500-BAD-EXIT.
 17129
 17130     IF DL35-RETURN-CODE = '05'
 17131         MOVE ER-7834            TO EMI-ERROR
 17132         GO TO 6500-BAD-EXIT.
 17133
 17134     IF DL35-RETURN-CODE = '06'
 17135         MOVE ER-7835            TO EMI-ERROR
 17136         GO TO 6500-BAD-EXIT.
 17137
 17138     IF DL35-RETURN-CODE = '07'
 17139         MOVE ER-7836            TO EMI-ERROR
 17140         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 330
* EL156.cbl
 17141
 17142     IF DL35-RETURN-CODE = 'E1'
 17143         MOVE ER-7837            TO EMI-ERROR
 17144         GO TO 6500-BAD-EXIT.
 17145
 17146     IF DL35-RETURN-CODE NOT = 'OK'
 17147         MOVE ER-7838            TO EMI-ERROR
 17148         GO TO 6500-BAD-EXIT.
 17149
 17150 6600-EXIT.
 17151      EXIT.
 17152
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 331
* EL156.cbl
 17154 6700-UPDATE-ACTQ.
 17155***************************************************************
 17156*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 17157*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 17158*    ONE ALREADY THERE.                                       *
 17159***************************************************************
 17160
 17161
 17162* EXEC CICS HANDLE CONDITION
 17163*         NOTFND(6720-BUILD-NEW-RECORD)
 17164*     END-EXEC.
 17165*    MOVE '"$I                   ! 6 #00015957' TO DFHEIV0
 17166     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17167     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17168     MOVE X'3620233030303135393537' TO DFHEIV0(25:11)
 17169     CALL 'kxdfhei1' USING DFHEIV0
 17170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17171
 17172
 17173
 17174* EXEC CICS READ
 17175*         DATASET('ELACTQ')
 17176*         RIDFLD (ELMSTR-KEY)
 17177*         SET    (ADDRESS OF ACTIVITY-QUE)
 17178*         UPDATE
 17179*     END-EXEC.
 17180     MOVE 'ELACTQ' TO DFHEIV1
 17181*    MOVE '&"S        EU         (   #00015961' TO DFHEIV0
 17182     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17183     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17184     MOVE X'2020233030303135393631' TO DFHEIV0(25:11)
 17185     CALL 'kxdfhei1' USING DFHEIV0,
 17186           DFHEIV1,
 17187           DFHEIV20,
 17188           DFHEIV99,
 17189           ELMSTR-KEY,
 17190           DFHEIV99,
 17191           DFHEIV99,
 17192           DFHEIV99
 17193     SET ADDRESS OF ACTIVITY-QUE TO
 17194         DFHEIV20
 17195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17196
 17197
 17198     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17199
 17200     IF PI-AIG-SPECIAL-BENEFIT AND
 17201        PI-CASH = 'Y'
 17202         ADD 2                   TO AQ-PAYMENT-COUNTER
 17203     ELSE
 17204         ADD 1                   TO AQ-PAYMENT-COUNTER.
 17205
 17206     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 17207         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 17208
 17209     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 17210
 17211     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 332
* EL156.cbl
 17212         IF WS-PMT-APPROVAL-SW = 'A'
 17213             NEXT SENTENCE
 17214         ELSE
 17215            IF PI-AIG-SPECIAL-BENEFIT AND
 17216               PI-CASH = 'Y'
 17217                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17218                                     WS-PMT-UNAPPROVED-CNT
 17219            ELSE
 17220                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17221                                     WS-PMT-UNAPPROVED-CNT
 17222     ELSE
 17223         IF PI-PMT-APPR-SW = 'Y'
 17224            IF PI-AIG-SPECIAL-BENEFIT AND
 17225               PI-CASH = 'Y'
 17226                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17227                                     WS-PMT-UNAPPROVED-CNT
 17228            ELSE
 17229                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17230                                     WS-PMT-UNAPPROVED-CNT.
 17231
 17232     IF WS-PMT-UNAPPROVED-CNT > ZERO
 17233         MOVE ER-3536 TO EMI-ERROR
 17234         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17235
 17236     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 17237
 17238
 17239* EXEC CICS REWRITE
 17240*         DATASET('ELACTQ')
 17241*         FROM   (ACTIVITY-QUE)
 17242*     END-EXEC.
 17243     MOVE LENGTH OF
 17244      ACTIVITY-QUE
 17245       TO DFHEIV11
 17246     MOVE 'ELACTQ' TO DFHEIV1
 17247*    MOVE '&& L                  %   #00016008' TO DFHEIV0
 17248     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17249     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17250     MOVE X'2020233030303136303038' TO DFHEIV0(25:11)
 17251     CALL 'kxdfhei1' USING DFHEIV0,
 17252           DFHEIV1,
 17253           ACTIVITY-QUE,
 17254           DFHEIV11,
 17255           DFHEIV99
 17256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17257
 17258
 17259     GO TO 6799-EXIT.
 17260
 17261 6720-BUILD-NEW-RECORD.
 17262
 17263* EXEC CICS GETMAIN
 17264*         SET    (ADDRESS OF ACTIVITY-QUE)
 17265*         LENGTH (60)
 17266*         INITIMG(GETMAIN-SPACE)
 17267*     END-EXEC.
 17268     MOVE 60
 17269       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 333
* EL156.cbl
 17270*    MOVE ',"IL                  $   #00016016' TO DFHEIV0
 17271     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17272     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17273     MOVE X'2020233030303136303136' TO DFHEIV0(25:11)
 17274     CALL 'kxdfhei1' USING DFHEIV0,
 17275           DFHEIV20,
 17276           DFHEIV11,
 17277           GETMAIN-SPACE
 17278     SET ADDRESS OF ACTIVITY-QUE TO
 17279         DFHEIV20
 17280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17281
 17282
 17283     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 17284
 17285     IF PI-AIG-SPECIAL-BENEFIT AND
 17286        PI-CASH = 'Y'
 17287         MOVE 2                  TO AQ-PAYMENT-COUNTER
 17288     ELSE
 17289         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 17290
 17291     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 17292     MOVE 'AQ'                   TO AQ-RECORD-ID.
 17293     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 17294     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 17295                                    AQ-FOLLOWUP-DATE.
 17296     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 17297     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17298
 17299     IF PI-PMT-GRADUATED
 17300         IF WS-PMT-APPROVAL-SW = 'A'
 17301             NEXT SENTENCE
 17302         ELSE
 17303            IF PI-AIG-SPECIAL-BENEFIT AND
 17304               PI-CASH = 'Y'
 17305                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17306            ELSE
 17307                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17308     ELSE
 17309         IF PI-PMT-APPR-SW = 'Y'
 17310            IF PI-AIG-SPECIAL-BENEFIT AND
 17311               PI-CASH = 'Y'
 17312                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17313            ELSE
 17314                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 17315
 17316     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 17317         MOVE ER-3536 TO EMI-ERROR
 17318         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17319
 17320
 17321* EXEC CICS WRITE
 17322*         DATASET('ELACTQ')
 17323*         RIDFLD (ELMSTR-KEY)
 17324*         FROM   (ACTIVITY-QUE)
 17325*     END-EXEC.
 17326     MOVE LENGTH OF
 17327      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 334
* EL156.cbl
 17328       TO DFHEIV11
 17329     MOVE 'ELACTQ' TO DFHEIV1
 17330*    MOVE '&$ L                  ''   #00016059' TO DFHEIV0
 17331     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17332     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17333     MOVE X'2020233030303136303539' TO DFHEIV0(25:11)
 17334     CALL 'kxdfhei1' USING DFHEIV0,
 17335           DFHEIV1,
 17336           ACTIVITY-QUE,
 17337           DFHEIV11,
 17338           ELMSTR-KEY,
 17339           DFHEIV99,
 17340           DFHEIV99
 17341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17342
 17343
 17344 6799-EXIT.
 17345      EXIT.
 17346
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 335
* EL156.cbl
 17348 6800-BUILD-FORM-TRAILER.
 17349
 17350
 17351* EXEC CICS GETMAIN
 17352*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17353*         LENGTH   (200)
 17354*         INITIMG  (GETMAIN-SPACE)
 17355*    END-EXEC.
 17356     MOVE 200
 17357       TO DFHEIV11
 17358*    MOVE ',"IL                  $   #00016071' TO DFHEIV0
 17359     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17360     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17361     MOVE X'2020233030303136303731' TO DFHEIV0(25:11)
 17362     CALL 'kxdfhei1' USING DFHEIV0,
 17363           DFHEIV20,
 17364           DFHEIV11,
 17365           GETMAIN-SPACE
 17366     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17367         DFHEIV20
 17368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17369
 17370
 17371     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17372
 17373     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17374     MOVE 'AT'                   TO AT-RECORD-ID.
 17375     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17376
 17377     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17378     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17379                                    AT-FORM-LAST-MAINT-DT
 17380                                    AT-FORM-SEND-ON-DT.
 17381     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17382                                    AT-FORM-LAST-UPDATED-BY.
 17383     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17384     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17385     MOVE '6'                    TO DC-OPTION-CODE.
 17386     MOVE +29                    TO DC-ELAPSED-DAYS.
 17387     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17388     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17389     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17390
 17391     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17392         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17393
 17394     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17395                                    AT-FORM-RE-SEND-DT
 17396                                    AT-EMP-FORM-ANSWERED-DT
 17397                                    AT-PHY-FORM-ANSWERED-DT
 17398                                    AT-EMP-FORM-SEND-ON-DT
 17399                                    AT-PHY-FORM-SEND-ON-DT
 17400                                    AT-FORM-PRINTED-DT
 17401                                    AT-FORM-REPRINT-DT.
 17402     MOVE '2'                    TO AT-FORM-TYPE.
 17403
 17404     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17405     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 336
* EL156.cbl
 17406
 17407     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17408         NEXT SENTENCE
 17409     ELSE
 17410         IF CL-PROG-FORM-TYPE NOT = 'S'
 17411            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17412
 17413
 17414* EXEC CICS WRITE
 17415*         DATASET  ('ELTRLR')
 17416*         FROM     (ACTIVITY-TRAILERS)
 17417*         RIDFLD   (AT-CONTROL-PRIMARY)
 17418*     END-EXEC.
 17419     MOVE LENGTH OF
 17420      ACTIVITY-TRAILERS
 17421       TO DFHEIV11
 17422     MOVE 'ELTRLR' TO DFHEIV1
 17423*    MOVE '&$ L                  ''   #00016119' TO DFHEIV0
 17424     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17425     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17426     MOVE X'2020233030303136313139' TO DFHEIV0(25:11)
 17427     CALL 'kxdfhei1' USING DFHEIV0,
 17428           DFHEIV1,
 17429           ACTIVITY-TRAILERS,
 17430           DFHEIV11,
 17431           AT-CONTROL-PRIMARY,
 17432           DFHEIV99,
 17433           DFHEIV99
 17434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17435
 17436
 17437 6899-EXIT.
 17438      EXIT.
 17439
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 337
* EL156.cbl
 17441 6900-BUILD-ARCHIVE-HEADER.
 17442
 17443     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17444     MOVE '1'                    TO CNTL-REC-TYPE.
 17445     MOVE +0                     TO CNTL-SEQ-NO.
 17446     MOVE SPACES                 TO CNTL-ACCESS.
 17447
 17448
 17449* EXEC CICS READ
 17450*         DATASET  ('ELCNTL')
 17451*         SET      (ADDRESS OF CONTROL-FILE)
 17452*         RIDFLD   (ELCNTL-KEY)
 17453*         UPDATE
 17454*    END-EXEC.
 17455     MOVE 'ELCNTL' TO DFHEIV1
 17456*    MOVE '&"S        EU         (   #00016136' TO DFHEIV0
 17457     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17458     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17459     MOVE X'2020233030303136313336' TO DFHEIV0(25:11)
 17460     CALL 'kxdfhei1' USING DFHEIV0,
 17461           DFHEIV1,
 17462           DFHEIV20,
 17463           DFHEIV99,
 17464           ELCNTL-KEY,
 17465           DFHEIV99,
 17466           DFHEIV99,
 17467           DFHEIV99
 17468     SET ADDRESS OF CONTROL-FILE TO
 17469         DFHEIV20
 17470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17471
 17472
 17473     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17474     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17475
 17476
 17477* EXEC CICS REWRITE
 17478*         FROM     (CONTROL-FILE)
 17479*         DATASET  ('ELCNTL')
 17480*    END-EXEC.
 17481     MOVE LENGTH OF
 17482      CONTROL-FILE
 17483       TO DFHEIV11
 17484     MOVE 'ELCNTL' TO DFHEIV1
 17485*    MOVE '&& L                  %   #00016146' TO DFHEIV0
 17486     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17487     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17488     MOVE X'2020233030303136313436' TO DFHEIV0(25:11)
 17489     CALL 'kxdfhei1' USING DFHEIV0,
 17490           DFHEIV1,
 17491           CONTROL-FILE,
 17492           DFHEIV11,
 17493           DFHEIV99
 17494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17495
 17496
 17497
 17498* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 338
* EL156.cbl
 17499*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17500*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17501*    END-EXEC.
 17502*    MOVE '"$$%                  ! 7 #00016151' TO DFHEIV0
 17503     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17504     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17505     MOVE X'3720233030303136313531' TO DFHEIV0(25:11)
 17506     CALL 'kxdfhei1' USING DFHEIV0
 17507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17508
 17509
 17510
 17511* EXEC CICS GETMAIN
 17512*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17513*         LENGTH  (ELARCH-LENGTH)
 17514*         INITIMG (GETMAIN-SPACE)
 17515*    END-EXEC.
 17516*    MOVE ',"IL                  $   #00016156' TO DFHEIV0
 17517     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17518     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17519     MOVE X'2020233030303136313536' TO DFHEIV0(25:11)
 17520     CALL 'kxdfhei1' USING DFHEIV0,
 17521           DFHEIV20,
 17522           ELARCH-LENGTH,
 17523           GETMAIN-SPACE
 17524     SET ADDRESS OF LETTER-ARCHIVE TO
 17525         DFHEIV20
 17526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17527
 17528
 17529     MOVE 'LA'                   TO LA-RECORD-ID.
 17530     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17531                                    LA-ARCHIVE-NO-A1.
 17532     MOVE '4'                    TO LA-RECORD-TYPE
 17533                                    LA-RECORD-TYPE-A1.
 17534     MOVE +0                     TO LA-LINE-SEQ-NO
 17535                                    LA-LINE-SEQ-NO-A1.
 17536     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17537                                    LA-COMPANY-CD-A1.
 17538     MOVE CL-CARRIER             TO LA4-CARRIER.
 17539     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17540     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17541     MOVE CL-CERT-STATE          TO LA4-STATE.
 17542     MOVE +0                     TO LA4-NO-OF-COPIES.
 17543     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17544     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17545     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17546                                    LA4-INITIAL-PRINT-DATE
 17547                                    LA4-RESEND-PRINT-DATE
 17548                                    LA4-FORM-REM-PRINT-DT.
 17549     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17550     MOVE '2'                    TO LA4-FORM-TYPE.
 17551
 17552
 17553* EXEC CICS WRITE
 17554*         DATASET  ('ELARCH')
 17555*         FROM     (LETTER-ARCHIVE)
 17556*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 339
* EL156.cbl
 17557*    END-EXEC.
 17558     MOVE LENGTH OF
 17559      LETTER-ARCHIVE
 17560       TO DFHEIV11
 17561     MOVE 'ELARCH' TO DFHEIV1
 17562*    MOVE '&$ L                  ''   #00016185' TO DFHEIV0
 17563     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17564     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17565     MOVE X'2020233030303136313835' TO DFHEIV0(25:11)
 17566     CALL 'kxdfhei1' USING DFHEIV0,
 17567           DFHEIV1,
 17568           LETTER-ARCHIVE,
 17569           DFHEIV11,
 17570           LA-CONTROL-PRIMARY,
 17571           DFHEIV99,
 17572           DFHEIV99
 17573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17574
 17575
 17576 6999-EXIT.
 17577      EXIT.
 17578
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 340
* EL156.cbl
 17580 7000-SHOW-CLAIM.
 17581     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17582     MOVE 'A'                    TO PI-PASS-SW.
 17583     MOVE LOW-VALUES             TO PI-CPYFROM
 17584                                    PI-MONTH-END-SAVE
 17585                                    PI-CPYTHRU.
 17586
 17587     MOVE ZEROS                  TO PI-FATAL-COUNT
 17588                                    PI-DAILY-RATE
 17589                                    PI-BEN-DAYS
 17590                                    PI-MANUAL-SW
 17591                                    PI-SAVE-CURSOR
 17592                                    PI-FORCE-COUNT
 17593                                    PI-HOLDTIL
 17594                                    PI-EPYFROM
 17595                                    PI-EPYTHRU
 17596                                    PI-EDAYS
 17597                                    PI-EPYAMT
 17598                                    PI-ERESV
 17599                                    PI-EEXPENS
 17600                                    PI-CDAYS
 17601                                    PI-CPYAMT
 17602                                    PI-CRESV
 17603                                    PI-CEXPENS
 17604                                    PI-INT-RATE
 17605                                    PI-AIGFROM.
 17606     MOVE ZEROS                  TO PI-PROOF-DATE.
 17607     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17608                                    PI-REM-BEN-AMT
 17609                                    PI-MO-BEN-AMT
 17610                                    pi-ah-term.
 17611
 17612     MOVE LOW-VALUES             TO EL156AI.
 17613     MOVE MAP-NAMEA              TO MAP-NAME.
 17614
 17615* EXEC CICS HANDLE CONDITION
 17616*        NOTFND   (7010-BUILD-MAP)
 17617*    END-EXEC.
 17618*    MOVE '"$I                   ! 8 #00016229' TO DFHEIV0
 17619     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17620     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17621     MOVE X'3820233030303136323239' TO DFHEIV0(25:11)
 17622     CALL 'kxdfhei1' USING DFHEIV0
 17623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17624
 17625
 17626     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17627     MOVE '2'                    TO CNTL-REC-TYPE.
 17628     MOVE +0                     TO CNTL-SEQ-NO.
 17629     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17630
 17631
 17632* EXEC CICS READ
 17633*         DATASET  ('ELCNTL')
 17634*         SET      (ADDRESS OF CONTROL-FILE)
 17635*         RIDFLD   (ELCNTL-KEY)
 17636*    END-EXEC.
 17637     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 341
* EL156.cbl
 17638*    MOVE '&"S        E          (   #00016238' TO DFHEIV0
 17639     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17640     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17641     MOVE X'2020233030303136323338' TO DFHEIV0(25:11)
 17642     CALL 'kxdfhei1' USING DFHEIV0,
 17643           DFHEIV1,
 17644           DFHEIV20,
 17645           DFHEIV99,
 17646           ELCNTL-KEY,
 17647           DFHEIV99,
 17648           DFHEIV99,
 17649           DFHEIV99
 17650     SET ADDRESS OF CONTROL-FILE TO
 17651         DFHEIV20
 17652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17653
 17654
 17655     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17656
 17657     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17658         MOVE AL-UANON      TO SURVYYNA
 17659     END-IF.
 17660
 17661
 17662     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17663     MOVE '1'                    TO CNTL-REC-TYPE.
 17664     MOVE SPACES                 TO CNTL-ACCESS.
 17665     MOVE +0                     TO CNTL-SEQ-NO.
 17666
 17667
 17668* EXEC CICS READ
 17669*         DATASET  ('ELCNTL')
 17670*         SET      (ADDRESS OF CONTROL-FILE)
 17671*         RIDFLD   (ELCNTL-KEY)
 17672*    END-EXEC.
 17673     MOVE 'ELCNTL' TO DFHEIV1
 17674*    MOVE '&"S        E          (   #00016256' TO DFHEIV0
 17675     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17676     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17677     MOVE X'2020233030303136323536' TO DFHEIV0(25:11)
 17678     CALL 'kxdfhei1' USING DFHEIV0,
 17679           DFHEIV1,
 17680           DFHEIV20,
 17681           DFHEIV99,
 17682           ELCNTL-KEY,
 17683           DFHEIV99,
 17684           DFHEIV99,
 17685           DFHEIV99
 17686     SET ADDRESS OF CONTROL-FILE TO
 17687         DFHEIV20
 17688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17689
 17690
 17691     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17692
 17693 7010-BUILD-MAP.
 17694
 17695
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 342
* EL156.cbl
 17696* EXEC CICS HANDLE CONDITION
 17697*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17698*    END-EXEC.
 17699*    MOVE '"$I                   ! 9 #00016266' TO DFHEIV0
 17700     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17701     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17702     MOVE X'3920233030303136323636' TO DFHEIV0(25:11)
 17703     CALL 'kxdfhei1' USING DFHEIV0
 17704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17705
 17706
 17707     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17708     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17709     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17710     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17711     MOVE 'MSTR'                 TO FILE-SWITCH.
 17712
 17713     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17714
 17715     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17716     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17717     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17718     MOVE CL-CCN                 TO PI-SV-CCN.
 17719
 17720     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17721     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17722     MOVE CL-CLAIM-NO            TO CLMNOO.
 17723     MOVE CL-CARRIER             TO CARRO.
 17724     MOVE CL-CERT-PRIME          TO CERTNOO.
 17725     MOVE CL-CERT-SFX            TO SUFXO.
 17726
 17727     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17728        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')
 17729        CONTINUE
 17730     ELSE
 17731        MOVE AL-SADOF            TO ZINTHA
 17732                                    ZINTA
 17733                                    PINTHA
 17734                                    PINTA
 17735     END-IF
 17736     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17737     EVALUATE TRUE
 17738     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17739         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17740     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17741         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17742
 17743     WHEN CL-CLAIM-TYPE = 'I'
 17744         MOVE '  IU  '           TO CLMTYPO
 17745     WHEN CL-CLAIM-TYPE = 'G'
 17746         MOVE ' GAP  '           TO CLMTYPO
 17747     WHEN CL-CLAIM-TYPE = 'F'
 17748         MOVE ' FMLA '           TO CLMTYPO
 17749     WHEN CL-CLAIM-TYPE = 'O'
 17750         MOVE ' OTH '           TO CLMTYPO
 17751     END-EVALUATE.
 17752     IF CL-CLAIM-TYPE = 'O'
 17753        MOVE 'S' TO EOBYNO
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 343
* EL156.cbl
 17754                    PI-PRINT-EOB-YN
 17755                    WS-PRINT-EOB-YN
 17756     END-IF
 17757     IF CLAIM-IS-OPEN
 17758         MOVE ' OPEN'            TO CLMSTATO
 17759     ELSE
 17760         MOVE 'CLOSED'           TO CLMSTATO.
 17761
 17762     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17763
 17764     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17765         MOVE SPACES             TO  PCERTNOO
 17766                                     PSUFXO
 17767                                     PRIMHDGO
 17768                                     SEQUO
 17769         MOVE AL-SADOF           TO  PCERTNOA
 17770                                     PSUFXA
 17771                                     PRIMHDGA
 17772                                     SEQUA
 17773     ELSE
 17774         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17775         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17776         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17777         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17778         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17779         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17780         MOVE AL-SANON               TO  PCERTNOA
 17781                                         PSUFXA
 17782                                         PRIMHDGA
 17783         MOVE AL-SABON               TO  SEQUA.
 17784
 17785     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17786
 17787     IF CL-NO-OF-PMTS-MADE = 0 AND
 17788        CL-TOTAL-PAID-AMT = 0
 17789         NEXT SENTENCE
 17790     ELSE
 17791         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17792             IF NOT PI-USES-PAID-TO
 17793                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17794                 MOVE ' '                 TO DC-OPTION-CODE
 17795                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17796                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17797             ELSE
 17798                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17799                 MOVE '6'                 TO DC-OPTION-CODE
 17800                 MOVE +1                  TO DC-ELAPSED-DAYS
 17801                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17802                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17803                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17804
 17805     IF MAP-NAME = 'EL156A'
 17806        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17807           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17808             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17809           end-if
 17810        end-if
 17811     end-if
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 344
* EL156.cbl
 17812     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17813         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17814         MOVE ' '                TO DC-OPTION-CODE
 17815         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17816         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17817
 17818     IF CL-INCURRED-DT NOT = LOW-VALUES
 17819         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17820         MOVE ' '                TO DC-OPTION-CODE
 17821         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17822         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17823
 17824     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17825
 17826     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17827         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17828         MOVE ' '                TO DC-OPTION-CODE
 17829         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17830         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17831
 17832     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17833         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17834         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17835     ELSE
 17836         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17837         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17838
 17839     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17840     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17841     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17842     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17843                                    PI-GROUPING.
 17844     MOVE CL-CERT-STATE          TO CERT-STATE
 17845                                    PI-STATE.
 17846     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17847                                    PI-ACCOUNT.
 17848     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17849     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17850     MOVE 'CERT'                 TO FILE-SWITCH.
 17851
 17852     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17853     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17854        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17855        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17856            MOVE 'N' TO PI-JOINT-INSURED-IND
 17857     ELSE
 17858            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17859     END-IF.
 17860
 17861     perform 7975-read-acct      thru 7975-exit
 17862     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17863     MOVE PI-STATE               TO WS-ST-ACCESS.
 17864     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17865     MOVE '3'                    TO CNTL-REC-TYPE.
 17866     MOVE +0                     TO CNTL-SEQ-NO.
 17867     MOVE 'STAT'                 TO FILE-SWITCH.
 17868
 17869     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 345
* EL156.cbl
 17870
 17871     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17872     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17873
 17874     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17875        GO TO 7020-BYPASS-BENEFIT.
 17876
 17877     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17878     MOVE '4'                    TO CNTL-REC-TYPE.
 17879     MOVE +0                     TO CNTL-SEQ-NO.
 17880     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17881     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17882     MOVE 'BENE'                 TO FILE-SWITCH.
 17883
 17884     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17885
 17886     IF NO-BENEFIT-FOUND
 17887        GO TO 7020-BYPASS-BENEFIT.
 17888
 17889     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17890     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17891     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17892
 17893 7020-BYPASS-BENEFIT.
 17894
 17895*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17896*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17897*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17898
 17899     move zeros                  to PI-MAX-BENEFIT-AMT
 17900     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17901     move cm-ah-orig-term        to pi-ah-term
 17902     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17903     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17904          'G' and 'F'
 17905         GO TO 7021-GO-TO-LIFE.
 17906
 17907     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 17908        and (acct-found)
 17909        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17910        PERFORM 0900-GET-DDF-limits
 17911                                 THRU 0900-EXIT
 17912        IF PDEF-FOUND
 17913           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17914              (P1 > +8)
 17915              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17916           END-PERFORM
 17917           IF P1 < +9
 17918              if pd-ben-pct (p1) not numeric
 17919                 move zeros      to pd-ben-pct (p1)
 17920              end-if
 17921              if pd-ben-pct (p1) = zeros
 17922                 move +1         to ws-work-ben-pct
 17923              else
 17924                 move pd-ben-pct (p1)
 17925                                 to ws-work-ben-pct
 17926              end-if
 17927              compute cm-ah-benefit-amt =
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 346
* EL156.cbl
 17928                 cm-ah-benefit-amt * ws-work-ben-pct
 17929              move pd-max-amt (p1) to pi-max-benefit-amt
 17930           END-IF
 17931        END-IF
 17932     end-if
 17933     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17934     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 17935     if (pi-max-benefit-amt not = zeros)
 17936        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17937        move pi-max-benefit-amt  to beneo
 17938     else
 17939        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17940     end-if
 17941     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17942     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17943                                    CP-ORIGINAL-TERM.
 17944     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17945
 17946*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17947*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17948*    ELSE
 17949         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17950
 17951     MOVE ' '                    TO DC-OPTION-CODE.
 17952     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17953     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17954
 17955     IF PI-COMPANY-ID = 'DMD'
 17956         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17957         GO TO 7023-BYPASS-REMAINING-TERM.
 17958
 17959     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17960     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17961     GO TO 7022-AROUND-LIFE.
 17962
 17963 7021-GO-TO-LIFE.
 17964
 17965     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17966     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17967     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17968                                    CP-ORIGINAL-TERM.
 17969     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17970     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17971     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17972     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17973
 17974     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17975         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17976     ELSE
 17977         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17978
 17979     MOVE ' '                    TO DC-OPTION-CODE.
 17980     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17981     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17982
 17983 7022-AROUND-LIFE.
 17984
 17985     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 347
* EL156.cbl
 17986     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17987     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17988     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17989     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17990     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17991     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17992
 17993     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17994
 17995     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17996        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17997           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17998
 17999     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 18000        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 18001           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 18002
 18003 7023-BYPASS-REMAINING-TERM.
 18004     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 18005       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 18006          MOVE ZEROS                  TO BENEO
 18007       ELSE
 18008          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 18009          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 18010          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 18011          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 18012          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 18013          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 18014          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 18015          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 18016          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 18017          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 18018          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 18019          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 18020          IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 18021             AND (PI-DCC-PRODUCT-CODE not = '   ')
 18022             PERFORM 0900-GET-DDF-limits
 18023                                 THRU 0900-EXIT
 18024             IF PDEF-FOUND
 18025                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 18026                   (P1 > +8)
 18027                   OR (PD-PROD-CODE (P1) = 'L')
 18028                END-PERFORM
 18029                IF P1 < +9
 18030                   MOVE PD-MAX-AMT (P1)
 18031                                 TO CP-R-MAX-TOT-BEN
 18032                END-IF
 18033             END-IF
 18034          END-IF
 18035
 18036* EXEC CICS LINK
 18037*            PROGRAM  (LINK-REMAMT)
 18038*            COMMAREA (CALCULATION-PASS-AREA)
 18039*            LENGTH   (CP-COMM-LENGTH)
 18040*         END-EXEC
 18041*    MOVE '."C                   (   #00016598' TO DFHEIV0
 18042     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18043     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 348
* EL156.cbl
 18044     MOVE X'2020233030303136353938' TO DFHEIV0(25:11)
 18045     CALL 'kxdfhei1' USING DFHEIV0,
 18046           LINK-REMAMT,
 18047           CALCULATION-PASS-AREA,
 18048           CP-COMM-LENGTH,
 18049           DFHEIV99,
 18050           DFHEIV99,
 18051           DFHEIV99,
 18052           DFHEIV99
 18053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18054          MOVE CP-REMAINING-AMT       TO BENEO
 18055       end-if
 18056     end-if
 18057     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18058     MOVE +95                    TO TRLR-SEQ-NO
 18059
 18060* EXEC CICS READ
 18061*       DATASET  ('ELTRLR')
 18062*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18063*       RIDFLD   (ELTRLR-KEY)
 18064*       RESP     (WS-RESPONSE)
 18065*    END-EXEC
 18066     MOVE 'ELTRLR' TO DFHEIV1
 18067*    MOVE '&"S        E          (  N#00016608' TO DFHEIV0
 18068     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18069     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18070     MOVE X'204E233030303136363038' TO DFHEIV0(25:11)
 18071     CALL 'kxdfhei1' USING DFHEIV0,
 18072           DFHEIV1,
 18073           DFHEIV20,
 18074           DFHEIV99,
 18075           ELTRLR-KEY,
 18076           DFHEIV99,
 18077           DFHEIV99,
 18078           DFHEIV99
 18079     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18080         DFHEIV20
 18081     MOVE EIBRESP  TO WS-RESPONSE
 18082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18083
 18084     if ws-resp-normal
 18085        perform varying s1 from +1 by +1 until
 18086           at-note-error-no (s1) = spaces
 18087           move at-note-error-no (s1)
 18088                                 to emi-error
 18089           if at-note-error-no (s1) = '1653'
 18090              evaluate true
 18091                 when cl-claim-type = 'L'
 18092                    move '  LF  '
 18093                                 to emi-claim-type
 18094                 when cl-claim-type = 'I'
 18095                    move '  IU  '
 18096                                 to emi-claim-type
 18097                 when cl-claim-type = 'F'
 18098                    move ' FMLA '
 18099                                 to emi-claim-type
 18100                 when cl-claim-type = 'O'
 18101                    move ' OTH '
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 349
* EL156.cbl
 18102                                 to emi-claim-type
 18103                 when other
 18104                    move '  AH  '
 18105                                 to emi-claim-type
 18106              end-evaluate
 18107           end-if
 18108           PERFORM 9900-ERROR-FORMAT
 18109                                 THRU 9900-EXIT
 18110        end-perform
 18111     end-if
 18112    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 18113         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 18114            WS-LF-COVERAGE-TYPE = 'P'
 18115             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 18116                                        CM-LF-ITD-DEATH-AMT
 18117             MOVE WS-REMAINING-AMT  TO  BENEO.
 18118
 18119     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 18120     MOVE BENEO                  TO PI-REM-BEN-AMT.
 18121     MOVE WS-TERMS               TO TERMSO.
 18122
 18123     IF WS-STATUS = '6' OR '7' OR '8'
 18124         MOVE AL-SABOF           TO CRTSTATA.
 18125
 18126     IF WS-STATUS = '1' OR '4'
 18127        IF CP-REMAINING-TERM-3 = ZEROS
 18128           MOVE 'EXPIRED'        TO CRTSTATO
 18129        ELSE
 18130           MOVE 'ACTIVE  '       TO CRTSTATO.
 18131
 18132     IF WS-STATUS = '2'
 18133         MOVE 'PEND    '         TO CRTSTATO.
 18134
 18135     IF WS-STATUS = '3'
 18136         MOVE 'RESTORE '         TO CRTSTATO.
 18137
 18138     IF WS-STATUS = '5'
 18139         MOVE 'REISSUE '         TO CRTSTATO.
 18140
 18141     IF WS-STATUS = '6'
 18142         MOVE 'LMP DIS'          TO CRTSTATO.
 18143
 18144     IF WS-STATUS = '7'
 18145         MOVE 'DEATH'            TO CRTSTATO.
 18146
 18147     IF WS-STATUS = '8'
 18148         MOVE 'CANCEL'           TO CRTSTATO.
 18149
 18150     IF WS-STATUS = '9'
 18151         MOVE 'RE-ONLY '         TO CRTSTATO.
 18152
 18153     IF WS-STATUS = 'V'
 18154         MOVE 'VOID  '           TO CRTSTATO.
 18155
 18156     IF WS-STATUS = 'D'
 18157         MOVE 'DECLINE '         TO CRTSTATO.
 18158
 18159     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 350
* EL156.cbl
 18160         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 18161         MOVE '5'                TO CNTL-REC-TYPE
 18162     ELSE
 18163         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 18164         MOVE '4'                TO CNTL-REC-TYPE.
 18165
 18166     MOVE '** NONE **'           TO COVERO.
 18167     MOVE AL-SABON               TO COVERA.
 18168
 18169     IF PI-COMPANY-ID = 'CVL'
 18170         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 18171             MOVE CM-BENEFICIARY TO LOANNOO
 18172             MOVE AL-UANON       TO LOANNOA.
 18173
 18174     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 18175        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 18176        MOVE +91                 TO  TRLR-SEQ-NO
 18177
 18178* EXEC CICS READ
 18179*           DATASET  ('ELTRLR')
 18180*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18181*           RIDFLD   (ELTRLR-KEY)
 18182*           RESP     (WS-RESPONSE)
 18183*       END-EXEC
 18184     MOVE 'ELTRLR' TO DFHEIV1
 18185*    MOVE '&"S        E          (  N#00016708' TO DFHEIV0
 18186     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18187     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18188     MOVE X'204E233030303136373038' TO DFHEIV0(25:11)
 18189     CALL 'kxdfhei1' USING DFHEIV0,
 18190           DFHEIV1,
 18191           DFHEIV20,
 18192           DFHEIV99,
 18193           ELTRLR-KEY,
 18194           DFHEIV99,
 18195           DFHEIV99,
 18196           DFHEIV99
 18197     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18198         DFHEIV20
 18199     MOVE EIBRESP  TO WS-RESPONSE
 18200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18201
 18202        IF WS-RESP-NORMAL
 18203           MOVE AT-INFO-LINE-1   TO  LOANNOO
 18204        ELSE
 18205           MOVE SPACES           TO  LOANNOO
 18206        END-IF
 18207*052506
 18208*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 18209*052506
 18210     END-IF
 18211
 18212     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 18213        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 18214
 18215     IF WS-BEN-CD = ZEROS
 18216         GO TO 7050-SHOW-CONTINUE.
 18217
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 351
* EL156.cbl
 18218     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 18219     MOVE WS-ACCESS              TO CNTL-ACCESS.
 18220     MOVE +0                     TO CNTL-SEQ-NO.
 18221     MOVE 'BENE'                 TO FILE-SWITCH.
 18222
 18223     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 18224     IF BENEFIT-FOUND
 18225        MOVE CF-JOINT-INDICATOR (SUB-1)
 18226                                 TO PI-JOINT-COV-IND
 18227                                    PI-RB-JOINT-COV-IND
 18228        MOVE CF-BENEFIT-DESCRIP (SUB-1)
 18229                                 TO COVERO
 18230        MOVE AL-SANON            TO COVERA
 18231     END-IF
 18232     if (cntl-rec-type = '4')   *> Life claim
 18233        and (cm-ah-benefit-cd not = zeros) *> AH coverage
 18234        MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
 18235        MOVE CM-AH-BENEFIT-CD TO WS-BEN-CD
 18236        MOVE '5'              TO CNTL-REC-TYPE
 18237        MOVE WS-ACCESS        TO CNTL-ACCESS
 18238        MOVE +0               TO CNTL-SEQ-NO
 18239        MOVE 'BENE'           TO FILE-SWITCH
 18240        PERFORM 7200-FIND-BENEFIT
 18241                              THRU 7200-EXIT
 18242        IF (BENEFIT-FOUND)
 18243           and (pi-rb-joint-cov-ind) not = 'J'
 18244           MOVE CF-JOINT-INDICATOR (SUB-1)
 18245                              TO PI-rb-JOINT-COV-IND
 18246        end-if
 18247     end-if
 18248     .
 18249 7050-SHOW-CONTINUE.
 18250
 18251     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 18252        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 18253            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 18254     END-IF
 18255
 18256     IF PI-COMPANY-ID = 'DMD'
 18257         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 18258
 18259     MOVE -1                     TO PMTTYPEL.
 18260     GO TO 8100-SEND-INITIAL-MAP.
 18261
 18262 7100-SHOW-RECORD-NOT-FOUND.
 18263     IF FILE-SWITCH = 'MSTR'
 18264         MOVE ER-0204            TO EMI-ERROR.
 18265
 18266     IF FILE-SWITCH = 'CERT'
 18267         MOVE ER-0206            TO EMI-ERROR.
 18268
 18269     IF FILE-SWITCH = 'STAT'
 18270         MOVE ER-0149            TO EMI-ERROR.
 18271
 18272     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18273
 18274     MOVE -1                     TO PMTTYPEL.
 18275     GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 352
* EL156.cbl
 18276
 18277     .
 18278 7110-BUILD-PMT-TRLR.
 18279     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18280     MOVE +51                    TO TRLR-SEQ-NO
 18281
 18282* EXEC CICS READ
 18283*        DATASET  ('ELTRLR')
 18284*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18285*        RIDFLD   (ELTRLR-KEY)
 18286*        RESP     (WS-RESPONSE)
 18287*    END-EXEC
 18288     MOVE 'ELTRLR' TO DFHEIV1
 18289*    MOVE '&"S        E          (  N#00016794' TO DFHEIV0
 18290     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18291     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18292     MOVE X'204E233030303136373934' TO DFHEIV0(25:11)
 18293     CALL 'kxdfhei1' USING DFHEIV0,
 18294           DFHEIV1,
 18295           DFHEIV20,
 18296           DFHEIV99,
 18297           ELTRLR-KEY,
 18298           DFHEIV99,
 18299           DFHEIV99,
 18300           DFHEIV99
 18301     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18302         DFHEIV20
 18303     MOVE EIBRESP  TO WS-RESPONSE
 18304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18305     IF WS-RESP-NORMAL
 18306        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 18307     END-IF
 18308     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 18309
 18310* EXEC CICS GETMAIN
 18311*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18312*         LENGTH    (200)
 18313*         INITIMG   (GETMAIN-SPACE)
 18314*     END-EXEC
 18315     MOVE 200
 18316       TO DFHEIV11
 18317*    MOVE ',"IL                  $   #00016804' TO DFHEIV0
 18318     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18319     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18320     MOVE X'2020233030303136383034' TO DFHEIV0(25:11)
 18321     CALL 'kxdfhei1' USING DFHEIV0,
 18322           DFHEIV20,
 18323           DFHEIV11,
 18324           GETMAIN-SPACE
 18325     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18326         DFHEIV20
 18327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18328     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 18329                                    AT-PREV-PAID-THRU-DT
 18330     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 18331     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18332     MOVE 'AT'                   TO AT-RECORD-ID
 18333     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 353
* EL156.cbl
 18334     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 18335     MOVE '2'                    TO AT-TRAILER-TYPE
 18336     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18337                                    AT-PAYMENT-LAST-MAINT-DT
 18338     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18339                                    AT-PAYMENT-LAST-UPDATED-BY
 18340     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18341     MOVE 'I'                    TO AT-PAYMENT-TYPE
 18342     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 18343     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 18344     MOVE +0                     TO AT-EXPENSE-PER-PMT
 18345     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 18346     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 18347     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 18348     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 18349     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 18350     if pi-int-to-rem-borr = 'Y'
 18351        move 'Q1'                to at-payee-type-cd
 18352     else
 18353        MOVE 'O1'                TO AT-PAYEE-TYPE-CD
 18354     end-if
 18355     MOVE PI-int-payees-name     TO AT-PAYEES-NAME
 18356     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 18357     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 18358     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 18359     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 18360                                    AT-TO-BE-WRITTEN-DT
 18361     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 18362                                    AT-CHECK-QUE-SEQUENCE
 18363                                    AT-ADDL-RESERVE
 18364     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 18365                                    AT-VOID-SELECT-DT
 18366                                    AT-VOID-ACCEPT-DT
 18367                                    AT-VOID-DT
 18368                                    AT-PMT-PROOF-DT
 18369                                    AT-INT-PMT-SELECT-DT
 18370     MOVE ZEROS                  TO AT-DAILY-RATE
 18371                                    AT-ELIMINATION-DAYS
 18372     MOVE SPACES                 TO AT-BENEFIT-TYPE
 18373*    EXEC CICS HANDLE CONDITION
 18374*        DUPREC    (7120-DUPREC)
 18375*    END-EXEC
 18376     .
 18377 7115-WRITE-INT-TRLR.
 18378
 18379* EXEC CICS WRITE
 18380*         DATASET       ('ELTRLR')
 18381*         FROM          (ACTIVITY-TRAILERS)
 18382*         RIDFLD        (AT-CONTROL-PRIMARY)
 18383*         RESP          (WS-RESPONSE)
 18384*     END-EXEC
 18385     MOVE LENGTH OF
 18386      ACTIVITY-TRAILERS
 18387       TO DFHEIV11
 18388     MOVE 'ELTRLR' TO DFHEIV1
 18389*    MOVE '&$ L                  ''  N#00016859' TO DFHEIV0
 18390     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18391     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 354
* EL156.cbl
 18392     MOVE X'204E233030303136383539' TO DFHEIV0(25:11)
 18393     CALL 'kxdfhei1' USING DFHEIV0,
 18394           DFHEIV1,
 18395           ACTIVITY-TRAILERS,
 18396           DFHEIV11,
 18397           AT-CONTROL-PRIMARY,
 18398           DFHEIV99,
 18399           DFHEIV99
 18400     MOVE EIBRESP  TO WS-RESPONSE
 18401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18402      IF WS-RESP-DUPREC
 18403         GO TO 7120-DUPREC
 18404      END-IF
 18405     GO TO 7130-EXIT
 18406     .
 18407 7120-DUPREC.
 18408     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18409     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18410     GO TO 7115-WRITE-INT-TRLR
 18411     .
 18412 7130-EXIT.
 18413      EXIT.
 18414 7140-BUILD-NOTE-TRLR.
 18415
 18416
 18417* EXEC CICS GETMAIN
 18418*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18419*         LENGTH    (200)
 18420*         INITIMG   (GETMAIN-SPACE)
 18421*     END-EXEC
 18422     MOVE 200
 18423       TO DFHEIV11
 18424*    MOVE ',"IL                  $   #00016879' TO DFHEIV0
 18425     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18426     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18427     MOVE X'2020233030303136383739' TO DFHEIV0(25:11)
 18428     CALL 'kxdfhei1' USING DFHEIV0,
 18429           DFHEIV20,
 18430           DFHEIV11,
 18431           GETMAIN-SPACE
 18432     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18433         DFHEIV20
 18434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18435     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18436     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18437     MOVE 'AT'                   TO AT-RECORD-ID
 18438     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18439     MOVE '6'                    TO AT-TRAILER-TYPE
 18440     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18441                                    AT-GEN-INFO-LAST-MAINT-DT
 18442     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18443                                    AT-GEN-INFO-LAST-UPDATED-BY
 18444     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18445     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18446     .
 18447 7150-WRITE.
 18448
 18449* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 355
* EL156.cbl
 18450*        DUPREC    (7160-DUPREC)
 18451*    END-EXEC
 18452*    MOVE '"$%                   ! : #00016897' TO DFHEIV0
 18453     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18454     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18455     MOVE X'3A20233030303136383937' TO DFHEIV0(25:11)
 18456     CALL 'kxdfhei1' USING DFHEIV0
 18457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18458
 18459* EXEC CICS WRITE
 18460*         DATASET     ('ELTRLR')
 18461*         FROM        (ACTIVITY-TRAILERS)
 18462*         RIDFLD      (AT-CONTROL-PRIMARY)
 18463*         RESP        (WS-RESPONSE)
 18464*     END-EXEC
 18465     MOVE LENGTH OF
 18466      ACTIVITY-TRAILERS
 18467       TO DFHEIV11
 18468     MOVE 'ELTRLR' TO DFHEIV1
 18469*    MOVE '&$ L                  ''  N#00016900' TO DFHEIV0
 18470     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18471     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18472     MOVE X'204E233030303136393030' TO DFHEIV0(25:11)
 18473     CALL 'kxdfhei1' USING DFHEIV0,
 18474           DFHEIV1,
 18475           ACTIVITY-TRAILERS,
 18476           DFHEIV11,
 18477           AT-CONTROL-PRIMARY,
 18478           DFHEIV99,
 18479           DFHEIV99
 18480     MOVE EIBRESP  TO WS-RESPONSE
 18481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18482      IF WS-RESP-DUPREC
 18483         GO TO 7160-DUPREC
 18484      END-IF
 18485     GO TO 7170-EXIT
 18486     .
 18487 7160-DUPREC.
 18488     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18489     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18490     GO TO 7150-WRITE
 18491     .
 18492 7170-EXIT.
 18493      EXIT.
 18494
 18495 7180-ADD-CERT-NOTE.
 18496*ADD CERT NOTE FOR SC NP+6
 18497
 18498
 18499* EXEC CICS GETMAIN
 18500*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18501*         LENGTH    (150)
 18502*         INITIMG   (GETMAIN-SPACE)
 18503*     END-EXEC.
 18504     MOVE 150
 18505       TO DFHEIV11
 18506*    MOVE ',"IL                  $   #00016922' TO DFHEIV0
 18507     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 356
* EL156.cbl
 18508     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18509     MOVE X'2020233030303136393232' TO DFHEIV0(25:11)
 18510     CALL 'kxdfhei1' USING DFHEIV0,
 18511           DFHEIV20,
 18512           DFHEIV11,
 18513           GETMAIN-SPACE
 18514     SET ADDRESS OF CERT-NOTE-FILE TO
 18515         DFHEIV20
 18516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18517
 18518
 18519     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18520     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18521     MOVE +1                     TO WRK-NOTE-SEQ.
 18522     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18523     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18524     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18525     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18526     MOVE CL-CERT-STATE          TO CZ-STATE.
 18527     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18528     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18529     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18530     MOVE '2'                    TO CZ-RECORD-TYPE.
 18531     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18532     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18533     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18534     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18535     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18536     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18537     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18538     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18539     IF PI-COMPANY-ID = 'AHL'
 18540        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18541           CONTINUE
 18542        ELSE
 18543           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18544              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18545           ELSE
 18546              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18547           END-IF
 18548        END-IF
 18549     END-IF
 18550     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18551     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18552
 18553 7181-WRITE.
 18554
 18555
 18556* EXEC CICS WRITE
 18557*         DATASET     ('ERCNOT')
 18558*         FROM        (CERT-NOTE-FILE)
 18559*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18560*         RESP        (WS-RESPONSE)
 18561*    END-EXEC.
 18562     MOVE LENGTH OF
 18563      CERT-NOTE-FILE
 18564       TO DFHEIV11
 18565     MOVE 'ERCNOT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 357
* EL156.cbl
 18566*    MOVE '&$ L                  ''  N#00016964' TO DFHEIV0
 18567     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18568     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18569     MOVE X'204E233030303136393634' TO DFHEIV0(25:11)
 18570     CALL 'kxdfhei1' USING DFHEIV0,
 18571           DFHEIV1,
 18572           CERT-NOTE-FILE,
 18573           DFHEIV11,
 18574           CZ-CONTROL-PRIMARY,
 18575           DFHEIV99,
 18576           DFHEIV99
 18577     MOVE EIBRESP  TO WS-RESPONSE
 18578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18579
 18580
 18581     IF WS-RESP-DUPREC
 18582         GO TO 7182-DUPREC
 18583     END-IF.
 18584
 18585     SET CERT-NOTE-ADDED TO TRUE.
 18586
 18587     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18588         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18589     END-IF.
 18590
 18591     GO TO 7189-EXIT.
 18592
 18593 7182-DUPREC.
 18594
 18595     ADD +1                      TO  WRK-NOTE-SEQ.
 18596     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18597     GO TO 7181-WRITE.
 18598
 18599 7189-EXIT.
 18600      EXIT.
 18601
 18602 7190-ADD-ORIG-NOTE.
 18603
 18604
 18605* EXEC CICS GETMAIN
 18606*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18607*         LENGTH    (150)
 18608*         INITIMG   (GETMAIN-SPACE)
 18609*     END-EXEC.
 18610     MOVE 150
 18611       TO DFHEIV11
 18612*    MOVE ',"IL                  $   #00016994' TO DFHEIV0
 18613     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18614     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18615     MOVE X'2020233030303136393934' TO DFHEIV0(25:11)
 18616     CALL 'kxdfhei1' USING DFHEIV0,
 18617           DFHEIV20,
 18618           DFHEIV11,
 18619           GETMAIN-SPACE
 18620     SET ADDRESS OF CERT-NOTE-FILE TO
 18621         DFHEIV20
 18622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18623
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 358
* EL156.cbl
 18624
 18625     ADD +1                      TO WRK-NOTE-SEQ.
 18626     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18627     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18628     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18629     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18630     MOVE CL-CERT-STATE          TO CZ-STATE.
 18631     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18632     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18633     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18634     MOVE '2'                    TO CZ-RECORD-TYPE.
 18635     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18636     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18637     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18638     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18639     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18640     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18641
 18642 7191-WRITE.
 18643
 18644
 18645* EXEC CICS WRITE
 18646*         DATASET     ('ERCNOT')
 18647*         FROM        (CERT-NOTE-FILE)
 18648*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18649*         RESP        (WS-RESPONSE)
 18650*    END-EXEC.
 18651     MOVE LENGTH OF
 18652      CERT-NOTE-FILE
 18653       TO DFHEIV11
 18654     MOVE 'ERCNOT' TO DFHEIV1
 18655*    MOVE '&$ L                  ''  N#00017019' TO DFHEIV0
 18656     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18657     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18658     MOVE X'204E233030303137303139' TO DFHEIV0(25:11)
 18659     CALL 'kxdfhei1' USING DFHEIV0,
 18660           DFHEIV1,
 18661           CERT-NOTE-FILE,
 18662           DFHEIV11,
 18663           CZ-CONTROL-PRIMARY,
 18664           DFHEIV99,
 18665           DFHEIV99
 18666     MOVE EIBRESP  TO WS-RESPONSE
 18667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18668
 18669
 18670     IF WS-RESP-DUPREC
 18671         GO TO 7192-DUPREC
 18672     END-IF.
 18673
 18674     GO TO 7199-EXIT.
 18675
 18676 7192-DUPREC.
 18677
 18678     ADD +1                      TO  WRK-NOTE-SEQ.
 18679     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18680     GO TO 7191-WRITE.
 18681
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 359
* EL156.cbl
 18682 7199-EXIT.
 18683      EXIT.
 18684 7200-FIND-BENEFIT.
 18685     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18686
 18687
 18688* EXEC CICS HANDLE CONDITION
 18689*        ENDFILE(7200-EXIT)
 18690*        NOTFND(7200-EXIT)
 18691*    END-EXEC.
 18692*    MOVE '"$''I                  ! ; #00017043' TO DFHEIV0
 18693     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18694     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18695     MOVE X'3B20233030303137303433' TO DFHEIV0(25:11)
 18696     CALL 'kxdfhei1' USING DFHEIV0
 18697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18698
 18699
 18700
 18701* EXEC CICS READ
 18702*        DATASET('ELCNTL')
 18703*        SET(ADDRESS OF CONTROL-FILE)
 18704*        RIDFLD(ELCNTL-KEY)
 18705*        GTEQ
 18706*    END-EXEC.
 18707     MOVE 'ELCNTL' TO DFHEIV1
 18708*    MOVE '&"S        G          (   #00017048' TO DFHEIV0
 18709     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18710     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18711     MOVE X'2020233030303137303438' TO DFHEIV0(25:11)
 18712     CALL 'kxdfhei1' USING DFHEIV0,
 18713           DFHEIV1,
 18714           DFHEIV20,
 18715           DFHEIV99,
 18716           ELCNTL-KEY,
 18717           DFHEIV99,
 18718           DFHEIV99,
 18719           DFHEIV99
 18720     SET ADDRESS OF CONTROL-FILE TO
 18721         DFHEIV20
 18722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18723
 18724
 18725     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18726        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18727           GO TO 7200-EXIT.
 18728
 18729     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18730         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18731            ((SUB-1 > 8) OR
 18732            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18733
 18734     IF SUB-1 NOT = 9
 18735         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18736
 18737     GO TO 7200-EXIT.
 18738
 18739 7200-BENEFIT-DUMMY.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 360
* EL156.cbl
 18740
 18741 7200-DUMMY-EXIT.
 18742     EXIT.
 18743
 18744 7200-EXIT.
 18745     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 361
* EL156.cbl
 18747*052506
 18748*052506 7250-FIND-LETTER-TRLR.
 18749*052506     EXEC CICS HANDLE CONDITION
 18750*052506         ENDFILE  (7250-END)
 18751*052506         NOTFND   (7250-END)
 18752*052506     END-EXEC.
 18753*052506
 18754*052506     EXEC CICS STARTBR
 18755*052506         DATASET   ('ELTRLR')
 18756*052506         RIDFLD    (ELTRLR-KEY)
 18757*052506         GTEQ
 18758*052506     END-EXEC.
 18759*052506
 18760*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18761*052506
 18762*052506 7250-FIND-LOOP.
 18763*052506     EXEC CICS READNEXT
 18764*052506         DATASET   ('ELTRLR')
 18765*052506         RIDFLD    (ELTRLR-KEY)
 18766*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18767*052506     END-EXEC.
 18768*052506
 18769*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18770*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18771*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18772*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18773*052506        GO TO 7250-END
 18774*052506     END-IF.
 18775*052506
 18776*052506     IF AT-TRAILER-TYPE NOT = '4'
 18777*052506         GO TO 7250-FIND-LOOP
 18778*052506     END-IF.
 18779*052506
 18780*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18781*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18782*052506     END-IF.
 18783*052506
 18784*052506     GO TO 7250-FIND-LOOP.
 18785*052506
 18786*052506 7250-END.
 18787*052506
 18788*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18789*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18790*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18791*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18792*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18793*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18794*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18795*052506     END-IF.
 18796*052506
 18797*052506     EXEC CICS ENDBR
 18798*052506          DATASET    ('ELTRLR')
 18799*052506     END-EXEC.
 18800*052506
 18801*052506 7250-EXIT.
 18802*052506     EXIT.
 18803*052506     EJECT
 18804*052506
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 362
* EL156.cbl
 18805 7300-CHECK-AUTO-ACTIVITY.
 18806
 18807     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18808         NEXT SENTENCE
 18809     ELSE
 18810         GO TO 7399-EXIT.
 18811
 18812     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18813
 18814     IF WS-ACT-REC-FOUND-SW = 'N'
 18815         GO TO 7399-EXIT.
 18816
 18817     IF PI-ACTIVITY-CODE = 09
 18818         GO TO 7300-CONT-AUTO-ACTIVITY.
 18819
 18820     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18821        (PI-ACTIVITY-CODE = 11)
 18822         GO TO 7300-CONT-AUTO-ACTIVITY.
 18823
 18824     IF PI-PROVISIONAL-IND = 'P'
 18825         IF PI-PMTTYPE = '1'
 18826             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18827                 MOVE 'N'    TO  PI-RESET-SW
 18828                 GO TO 7399-EXIT.
 18829
 18830     IF PI-PMTTYPE = '1'
 18831         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18832             MOVE 'N'        TO  PI-RESET-SW
 18833             GO TO 7399-EXIT.
 18834
 18835     IF PI-PMTTYPE = '2' OR '3'
 18836         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18837             MOVE 'N'        TO  PI-RESET-SW
 18838             GO TO 7399-EXIT.
 18839
 18840     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18841         IF PI-PROVISIONAL-IND = 'P'
 18842             NEXT SENTENCE
 18843         ELSE
 18844             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18845
 18846 7300-CONT-AUTO-ACTIVITY.
 18847
 18848     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18849         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18850         MOVE '4'            TO DC-OPTION-CODE
 18851         MOVE +0             TO DC-ELAPSED-DAYS
 18852                                DC-ELAPSED-MONTHS
 18853         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18854         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18855         IF PI-USES-PAID-TO
 18856             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18857             IF NO-CONVERSION-ERROR
 18858                 MOVE +1     TO DC-ELAPSED-DAYS
 18859                 MOVE +0     TO DC-ELAPSED-MONTHS
 18860                 MOVE '6'    TO DC-OPTION-CODE
 18861                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18862                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 363
* EL156.cbl
 18863                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18864
 18865     IF PI-PFKEY-USED = DFHPF5
 18866         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18867         IF PI-USES-PAID-TO
 18868             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18869             MOVE +1                  TO DC-ELAPSED-DAYS
 18870             MOVE +0                  TO DC-ELAPSED-MONTHS
 18871             MOVE '6'                 TO DC-OPTION-CODE
 18872             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18873             IF NO-CONVERSION-ERROR
 18874                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18875
 18876     IF WS-CHK-THRU-DT < PI-EXP-DT
 18877         NEXT SENTENCE
 18878     ELSE
 18879         MOVE 03                     TO  WS-ACTIVITY-CODE
 18880         GO TO 7390-PROCESS-ACTIVITY.
 18881
 18882     IF PI-PROV-PMT
 18883         MOVE 09                     TO  WS-ACTIVITY-CODE
 18884     ELSE
 18885        IF PI-PMTTYPE = '1'
 18886            MOVE 02                  TO  WS-ACTIVITY-CODE
 18887        ELSE
 18888        IF PI-PMTTYPE = '2' OR '3'
 18889            MOVE 07                  TO  WS-ACTIVITY-CODE
 18890        ELSE
 18891        IF PI-PMTTYPE = '4'
 18892            MOVE 00                  TO  WS-ACTIVITY-CODE
 18893        ELSE
 18894            MOVE 'N'                 TO  PI-RESET-SW
 18895            GO TO 7399-EXIT.
 18896
 18897 7390-PROCESS-ACTIVITY.
 18898
 18899     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18900
 18901 7399-EXIT.
 18902     EXIT.
 18903
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 364
* EL156.cbl
 18905 7400-CHECK-AUTO-ACTIVITY.
 18906
 18907
 18908* EXEC CICS HANDLE CONDITION
 18909*        NOTFND   (7400-NOT-FOUND)
 18910*    END-EXEC.
 18911*    MOVE '"$I                   ! < #00017237' TO DFHEIV0
 18912     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18913     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18914     MOVE X'3C20233030303137323337' TO DFHEIV0(25:11)
 18915     CALL 'kxdfhei1' USING DFHEIV0
 18916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18917
 18918
 18919     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18920     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18921     MOVE SPACES                 TO  CNTL-ACCESS.
 18922     MOVE +0                     TO  CNTL-SEQ-NO.
 18923
 18924
 18925* EXEC CICS READ
 18926*        DATASET   ('ELCNTL')
 18927*        RIDFLD    (ELCNTL-KEY)
 18928*        SET       (ADDRESS OF CONTROL-FILE)
 18929*    END-EXEC.
 18930     MOVE 'ELCNTL' TO DFHEIV1
 18931*    MOVE '&"S        E          (   #00017246' TO DFHEIV0
 18932     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18933     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18934     MOVE X'2020233030303137323436' TO DFHEIV0(25:11)
 18935     CALL 'kxdfhei1' USING DFHEIV0,
 18936           DFHEIV1,
 18937           DFHEIV20,
 18938           DFHEIV99,
 18939           ELCNTL-KEY,
 18940           DFHEIV99,
 18941           DFHEIV99,
 18942           DFHEIV99
 18943     SET ADDRESS OF CONTROL-FILE TO
 18944         DFHEIV20
 18945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18946
 18947
 18948     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18949     GO TO 7400-EXIT.
 18950
 18951 7400-NOT-FOUND.
 18952     MOVE 'N'                        TO  PI-RESET-SW
 18953                                         WS-LETTER-SW
 18954                                         WS-ACT-REC-FOUND-SW.
 18955
 18956     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18957
 18958 7400-EXIT.
 18959     EXIT.
 18960
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 365
* EL156.cbl
 18962 7450-FORMAT-AUTO-LETTER.
 18963
 18964     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18965         MOVE 'Y'                    TO PI-RESET-SW
 18966         GO TO 7450-CONTINUE-PROCESS.
 18967
 18968     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18969
 18970     IF SUB > 9
 18971         SUBTRACT 9 FROM SUB
 18972         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18973     ELSE
 18974         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18975
 18976 7450-CONTINUE-PROCESS.
 18977
 18978     IF WS-ACTIVITY-CODE = ZEROS
 18979         MOVE 'N'                    TO  WS-LETTER-SW
 18980         GO TO 7450-EXIT.
 18981
 18982     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18983
 18984     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18985         MOVE 'N'                    TO  PI-RESET-SW
 18986                                         WS-LETTER-SW
 18987         GO TO 7450-EXIT.
 18988
 18989     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18990         MOVE 'N'                    TO  WS-LETTER-SW
 18991         GO TO 7450-EXIT.
 18992
 18993     MOVE 'Y'                        TO  WS-LETTER-SW.
 18994     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18995     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18996
 18997     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18998
 18999     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 19000         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 19001         MOVE '6'                    TO  DC-OPTION-CODE
 19002         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 19003         MOVE +0                     TO  DC-ELAPSED-MONTHS
 19004         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 19005         IF NO-CONVERSION-ERROR
 19006             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 19007         ELSE
 19008              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 19009
 19010     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 19011         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 19012         MOVE '6'                    TO  DC-OPTION-CODE
 19013         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 19014         MOVE +0                     TO  DC-ELAPSED-MONTHS
 19015         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 19016         IF NO-CONVERSION-ERROR
 19017             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 19018         ELSE
 19019             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 366
* EL156.cbl
 19020
 19021 7450-EXIT.
 19022     EXIT.
 19023
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 367
* EL156.cbl
 19025 7500-RESET-AUTO-ACTIVITY.
 19026
 19027     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 19028     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 19029     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 19030     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 19031     MOVE +100                   TO  TRLR-SEQ-NO.
 19032
 19033 7500-STARTBR-TRLR.
 19034
 19035
 19036* EXEC CICS HANDLE CONDITION
 19037*        ENDFILE  (7590-END)
 19038*        NOTFND   (7590-END)
 19039*    END-EXEC.
 19040*    MOVE '"$''I                  ! = #00017339' TO DFHEIV0
 19041     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19042     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19043     MOVE X'3D20233030303137333339' TO DFHEIV0(25:11)
 19044     CALL 'kxdfhei1' USING DFHEIV0
 19045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19046
 19047
 19048
 19049* EXEC CICS STARTBR
 19050*        DATASET   ('ELTRLR')
 19051*        RIDFLD    (ELTRLR-KEY)
 19052*        GTEQ
 19053*    END-EXEC.
 19054     MOVE 'ELTRLR' TO DFHEIV1
 19055     MOVE 0
 19056       TO DFHEIV11
 19057*    MOVE '&,         G          &   #00017344' TO DFHEIV0
 19058     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19059     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19060     MOVE X'2020233030303137333434' TO DFHEIV0(25:11)
 19061     CALL 'kxdfhei1' USING DFHEIV0,
 19062           DFHEIV1,
 19063           ELTRLR-KEY,
 19064           DFHEIV99,
 19065           DFHEIV11,
 19066           DFHEIV99
 19067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19068
 19069
 19070     MOVE 'Y'                        TO  WS-BROWSE-SW.
 19071
 19072 7500-READ-NEXT.
 19073
 19074
 19075* EXEC CICS READNEXT
 19076*        DATASET   ('ELTRLR')
 19077*        RIDFLD    (ELTRLR-KEY)
 19078*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19079*    END-EXEC.
 19080     MOVE 'ELTRLR' TO DFHEIV1
 19081     MOVE 0
 19082       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 368
* EL156.cbl
 19083*    MOVE '&.S                   )   #00017354' TO DFHEIV0
 19084     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19085     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19086     MOVE X'2020233030303137333534' TO DFHEIV0(25:11)
 19087     CALL 'kxdfhei1' USING DFHEIV0,
 19088           DFHEIV1,
 19089           DFHEIV20,
 19090           DFHEIV99,
 19091           ELTRLR-KEY,
 19092           DFHEIV99,
 19093           DFHEIV11,
 19094           DFHEIV99,
 19095           DFHEIV99
 19096     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19097         DFHEIV20
 19098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19099
 19100
 19101     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 19102        PI-CARRIER    NOT = TRLR-CARRIER  OR
 19103        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 19104        PI-CERT-NO    NOT = TRLR-CERT-NO
 19105         GO TO 7590-END.
 19106
 19107     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 19108         GO TO 7500-READ-NEXT.
 19109
 19110     IF AT-TRAILER-TYPE NOT = '4'
 19111         GO TO 7500-READ-NEXT.
 19112
 19113     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 19114         GO TO 7500-READ-NEXT.
 19115
 19116     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 19117        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 19118         GO TO 7500-READ-NEXT.
 19119
 19120     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 19121        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 19122        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 19123         GO TO 7500-READ-NEXT.
 19124
 19125     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 19126                         AND
 19127        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 19128                         AND
 19129        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 19130            GO TO 7500-READ-NEXT.
 19131
 19132     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 19133
 19134
 19135* EXEC CICS ENDBR
 19136*        DATASET   ('ELTRLR')
 19137*    END-EXEC.
 19138     MOVE 'ELTRLR' TO DFHEIV1
 19139     MOVE 0
 19140       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 369
* EL156.cbl
 19141*    MOVE '&2                    $   #00017393' TO DFHEIV0
 19142     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19143     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19144     MOVE X'2020233030303137333933' TO DFHEIV0(25:11)
 19145     CALL 'kxdfhei1' USING DFHEIV0,
 19146           DFHEIV1,
 19147           DFHEIV11,
 19148           DFHEIV99
 19149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19150
 19151
 19152     MOVE 'N'                        TO  WS-BROWSE-SW.
 19153
 19154
 19155* EXEC CICS READ
 19156*        DATASET   ('ELTRLR')
 19157*        RIDFLD    (ELTRLR-KEY)
 19158*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19159*        UPDATE
 19160*    END-EXEC.
 19161     MOVE 'ELTRLR' TO DFHEIV1
 19162*    MOVE '&"S        EU         (   #00017399' TO DFHEIV0
 19163     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19164     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19165     MOVE X'2020233030303137333939' TO DFHEIV0(25:11)
 19166     CALL 'kxdfhei1' USING DFHEIV0,
 19167           DFHEIV1,
 19168           DFHEIV20,
 19169           DFHEIV99,
 19170           ELTRLR-KEY,
 19171           DFHEIV99,
 19172           DFHEIV99,
 19173           DFHEIV99
 19174     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19175         DFHEIV20
 19176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19177
 19178
 19179     MOVE 'Y'                        TO  WS-UPDATE-SW.
 19180
 19181     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 19182         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 19183     ELSE
 19184         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 19185             NEXT SENTENCE
 19186         ELSE
 19187             GO TO 7500-REWRITE-TRLR.
 19188
 19189     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 19190
 19191     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 19192     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 19193     MOVE '1'                        TO  ARCH-REC-TYPE.
 19194     MOVE +0                         TO  ARCH-SEQ.
 19195
 19196     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 19197
 19198 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 370
* EL156.cbl
 19199
 19200
 19201* EXEC CICS REWRITE
 19202*        DATASET   ('ELTRLR')
 19203*        FROM      (ACTIVITY-TRAILERS)
 19204*    END-EXEC.
 19205     MOVE LENGTH OF
 19206      ACTIVITY-TRAILERS
 19207       TO DFHEIV11
 19208     MOVE 'ELTRLR' TO DFHEIV1
 19209*    MOVE '&& L                  %   #00017427' TO DFHEIV0
 19210     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19211     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19212     MOVE X'2020233030303137343237' TO DFHEIV0(25:11)
 19213     CALL 'kxdfhei1' USING DFHEIV0,
 19214           DFHEIV1,
 19215           ACTIVITY-TRAILERS,
 19216           DFHEIV11,
 19217           DFHEIV99
 19218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19219
 19220
 19221     GO TO 7500-STARTBR-TRLR.
 19222
 19223 7590-END.
 19224
 19225     IF WS-BROWSE-SW = 'Y'
 19226         MOVE 'N'                    TO  WS-BROWSE-SW
 19227
 19228* EXEC CICS ENDBR
 19229*            DATASET   ('ELTRLR')
 19230*        END-EXEC.
 19231     MOVE 'ELTRLR' TO DFHEIV1
 19232     MOVE 0
 19233       TO DFHEIV11
 19234*    MOVE '&2                    $   #00017438' TO DFHEIV0
 19235     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19236     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19237     MOVE X'2020233030303137343338' TO DFHEIV0(25:11)
 19238     CALL 'kxdfhei1' USING DFHEIV0,
 19239           DFHEIV1,
 19240           DFHEIV11,
 19241           DFHEIV99
 19242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19243
 19244
 19245 7599-EXIT.
 19246     EXIT.
 19247
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 371
* EL156.cbl
 19249 7600-READ-ARCH-UPDATE.
 19250
 19251
 19252* EXEC CICS HANDLE CONDITION
 19253*        NOTFND   (7699-EXIT)
 19254*    END-EXEC.
 19255*    MOVE '"$I                   ! > #00017448' TO DFHEIV0
 19256     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19258     MOVE X'3E20233030303137343438' TO DFHEIV0(25:11)
 19259     CALL 'kxdfhei1' USING DFHEIV0
 19260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19261
 19262
 19263
 19264* EXEC CICS READ
 19265*        DATASET   ('ELARCH')
 19266*        RIDFLD    (ELARCH-KEY)
 19267*        SET       (ADDRESS OF LETTER-ARCHIVE)
 19268*        UPDATE
 19269*    END-EXEC.
 19270     MOVE 'ELARCH' TO DFHEIV1
 19271*    MOVE '&"S        EU         (   #00017452' TO DFHEIV0
 19272     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19273     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19274     MOVE X'2020233030303137343532' TO DFHEIV0(25:11)
 19275     CALL 'kxdfhei1' USING DFHEIV0,
 19276           DFHEIV1,
 19277           DFHEIV20,
 19278           DFHEIV99,
 19279           ELARCH-KEY,
 19280           DFHEIV99,
 19281           DFHEIV99,
 19282           DFHEIV99
 19283     SET ADDRESS OF LETTER-ARCHIVE TO
 19284         DFHEIV20
 19285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19286
 19287
 19288     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 19289
 19290
 19291* EXEC CICS REWRITE
 19292*        DATASET   ('ELARCH')
 19293*        FROM      (LETTER-ARCHIVE)
 19294*    END-EXEC.
 19295     MOVE LENGTH OF
 19296      LETTER-ARCHIVE
 19297       TO DFHEIV11
 19298     MOVE 'ELARCH' TO DFHEIV1
 19299*    MOVE '&& L                  %   #00017461' TO DFHEIV0
 19300     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19301     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19302     MOVE X'2020233030303137343631' TO DFHEIV0(25:11)
 19303     CALL 'kxdfhei1' USING DFHEIV0,
 19304           DFHEIV1,
 19305           LETTER-ARCHIVE,
 19306           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 372
* EL156.cbl
 19307           DFHEIV99
 19308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19309
 19310
 19311 7699-EXIT.
 19312     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 373
* EL156.cbl
 19314 7700-GET-DCT.
 19315
 19316     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 19317     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 19318     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 19319     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 19320                                    PI-MAX-BENEFIT-AMT
 19321                                    PI-MAX-BENEFIT-PYMT
 19322                                    PI-MIN-PAYMENT-AMT
 19323                                    PI-TIME-OF-LOSS-BAL.
 19324
 19325
 19326* EXEC CICS HANDLE CONDITION
 19327*         NOTFND (5300-NOTE-NOT-FOUND)
 19328*     END-EXEC.
 19329*    MOVE '"$I                   ! ? #00017480' TO DFHEIV0
 19330     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19332     MOVE X'3F20233030303137343830' TO DFHEIV0(25:11)
 19333     CALL 'kxdfhei1' USING DFHEIV0
 19334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19335
 19336
 19337
 19338* EXEC CICS READ
 19339*         DATASET('ERNOTE')
 19340*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 19341*         RIDFLD (W-NOTE-KEY)
 19342*     END-EXEC.
 19343     MOVE 'ERNOTE' TO DFHEIV1
 19344*    MOVE '&"S        E          (   #00017484' TO DFHEIV0
 19345     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19346     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19347     MOVE X'2020233030303137343834' TO DFHEIV0(25:11)
 19348     CALL 'kxdfhei1' USING DFHEIV0,
 19349           DFHEIV1,
 19350           DFHEIV20,
 19351           DFHEIV99,
 19352           W-NOTE-KEY,
 19353           DFHEIV99,
 19354           DFHEIV99,
 19355           DFHEIV99
 19356     SET ADDRESS OF CERTIFICATE-NOTE TO
 19357         DFHEIV20
 19358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19359
 19360
 19361     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 19362     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 19363     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 19364     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 19365     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 19366
 19367     IF PI-PAYEE-TYPE NOT = 'B'
 19368         GO TO 7700-EXIT.
 19369
 19370     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 19371     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 374
* EL156.cbl
 19372     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 19373
 19374     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 19375         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 19376     ELSE
 19377         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 19378
 19379     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 19380     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 19381     MOVE 'DLO006'               TO PGM-NAME.
 19382
 19383
 19384* EXEC CICS LINK
 19385*        PROGRAM    (PGM-NAME)
 19386*        COMMAREA   (DCT-COMMUNICATION-AREA)
 19387*        LENGTH     (DCT-RCRD-LENGTH)
 19388*    END-EXEC.
 19389*    MOVE '."C                   (   #00017512' TO DFHEIV0
 19390     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19391     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19392     MOVE X'2020233030303137353132' TO DFHEIV0(25:11)
 19393     CALL 'kxdfhei1' USING DFHEIV0,
 19394           PGM-NAME,
 19395           DCT-COMMUNICATION-AREA,
 19396           DCT-RCRD-LENGTH,
 19397           DFHEIV99,
 19398           DFHEIV99,
 19399           DFHEIV99,
 19400           DFHEIV99
 19401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19402
 19403
 19404     IF DCT-RETURN-CODE = 'OK'
 19405         GO TO 7700-CONT.
 19406
 19407     IF DCT-RETURN-CODE = '01' OR '02'
 19408         GO TO 7700-SET-TO-YES.
 19409
 19410     IF DCT-RETURN-CODE = '03'
 19411
 19412* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19413*    MOVE '6"R                   !   #00017525' TO DFHEIV0
 19414     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19415     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19416     MOVE X'2020233030303137353235' TO DFHEIV0(25:11)
 19417     CALL 'kxdfhei1' USING DFHEIV0
 19418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19419         MOVE ER-0951            TO EMI-ERROR
 19420         MOVE -1                 TO PMTTYPEL
 19421         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19422         GO TO 8200-SEND-DATAONLY.
 19423
 19424     IF DCT-RETURN-CODE = '04'
 19425
 19426* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19427*    MOVE '6"R                   !   #00017532' TO DFHEIV0
 19428     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 375
* EL156.cbl
 19430     MOVE X'2020233030303137353332' TO DFHEIV0(25:11)
 19431     CALL 'kxdfhei1' USING DFHEIV0
 19432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19433         MOVE ER-0946            TO EMI-ERROR
 19434         MOVE -1                 TO PMTTYPEL
 19435         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19436         GO TO 8200-SEND-DATAONLY.
 19437
 19438     IF DCT-RETURN-CODE = '05'
 19439
 19440* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19441*    MOVE '6"R                   !   #00017539' TO DFHEIV0
 19442     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19443     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19444     MOVE X'2020233030303137353339' TO DFHEIV0(25:11)
 19445     CALL 'kxdfhei1' USING DFHEIV0
 19446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19447         MOVE ER-0947            TO EMI-ERROR
 19448         MOVE -1                 TO PMTTYPEL
 19449         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19450         GO TO 8200-SEND-DATAONLY.
 19451
 19452     IF DCT-RETURN-CODE = '06'
 19453
 19454* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19455*    MOVE '6"R                   !   #00017546' TO DFHEIV0
 19456     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19457     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19458     MOVE X'2020233030303137353436' TO DFHEIV0(25:11)
 19459     CALL 'kxdfhei1' USING DFHEIV0
 19460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19461         MOVE ER-0921            TO EMI-ERROR
 19462         MOVE -1                 TO PMTTYPEL
 19463         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19464         GO TO 8200-SEND-DATAONLY.
 19465
 19466     IF DCT-RETURN-CODE = '07'
 19467
 19468* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19469*    MOVE '6"R                   !   #00017553' TO DFHEIV0
 19470     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19471     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19472     MOVE X'2020233030303137353533' TO DFHEIV0(25:11)
 19473     CALL 'kxdfhei1' USING DFHEIV0
 19474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19475         MOVE ER-0919            TO EMI-ERROR
 19476         MOVE -1                 TO PMTTYPEL
 19477         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19478         GO TO 8200-SEND-DATAONLY.
 19479
 19480     IF DCT-RETURN-CODE = '08'
 19481
 19482* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19483*    MOVE '6"R                   !   #00017560' TO DFHEIV0
 19484     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19485     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19486     MOVE X'2020233030303137353630' TO DFHEIV0(25:11)
 19487     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 376
* EL156.cbl
 19488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19489         MOVE ER-0948            TO EMI-ERROR
 19490         MOVE -1                 TO PMTTYPEL
 19491         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19492         GO TO 8200-SEND-DATAONLY.
 19493
 19494     IF DCT-RETURN-CODE = 'N1'
 19495
 19496* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19497*    MOVE '6"R                   !   #00017567' TO DFHEIV0
 19498     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19499     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19500     MOVE X'2020233030303137353637' TO DFHEIV0(25:11)
 19501     CALL 'kxdfhei1' USING DFHEIV0
 19502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19503         MOVE ER-0950            TO EMI-ERROR
 19504         MOVE -1                 TO PMTTYPEL
 19505         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19506         GO TO 8200-SEND-DATAONLY.
 19507
 19508     IF DCT-RETURN-CODE = 'E1'
 19509
 19510* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19511*    MOVE '6"R                   !   #00017574' TO DFHEIV0
 19512     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19513     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19514     MOVE X'2020233030303137353734' TO DFHEIV0(25:11)
 19515     CALL 'kxdfhei1' USING DFHEIV0
 19516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19517         MOVE ER-0974            TO EMI-ERROR
 19518         MOVE -1                 TO PMTTYPEL
 19519         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19520         GO TO 8200-SEND-DATAONLY.
 19521
 19522     IF DCT-RETURN-CODE = 'E2'
 19523
 19524* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19525*    MOVE '6"R                   !   #00017581' TO DFHEIV0
 19526     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19527     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19528     MOVE X'2020233030303137353831' TO DFHEIV0(25:11)
 19529     CALL 'kxdfhei1' USING DFHEIV0
 19530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19531         MOVE ER-0975            TO EMI-ERROR
 19532         MOVE -1                 TO PMTTYPEL
 19533         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19534         GO TO 8200-SEND-DATAONLY.
 19535
 19536     IF DCT-RETURN-CODE NOT = 'OK'
 19537
 19538* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19539*    MOVE '6"R                   !   #00017588' TO DFHEIV0
 19540     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19541     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19542     MOVE X'2020233030303137353838' TO DFHEIV0(25:11)
 19543     CALL 'kxdfhei1' USING DFHEIV0
 19544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19545         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 377
* EL156.cbl
 19546         MOVE -1                 TO PMTTYPEL
 19547         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19548         GO TO 8200-SEND-DATAONLY.
 19549
 19550 7700-CONT.
 19551
 19552*    MOVE 'N'                    TO CASHO.
 19553*    MOVE +1                     TO CASHL.
 19554*    MOVE AL-UANON               TO CASHA.
 19555
 19556     IF PI-OFFLINE = 'Y'
 19557         GO TO 7700-EXIT.
 19558
 19559     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19560     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19561     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19562     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19563     MOVE +7                     TO CHECKNOL.
 19564     MOVE AL-UANON               TO CHECKNOA.
 19565     GO TO 7700-EXIT.
 19566
 19567 7700-SET-TO-YES.
 19568
 19569*    MOVE 'Y'                    TO CASHO.
 19570*    MOVE +1                     TO CASHL.
 19571*    MOVE AL-UANON               TO CASHA.
 19572
 19573 7700-EXIT.
 19574     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 378
* EL156.cbl
 19576 7800-READ-COMP-MSTR.
 19577
 19578
 19579* EXEC CICS HANDLE CONDITION
 19580*        NOTFND   (7800-COMP-NOTFND)
 19581*    END-EXEC.
 19582*    MOVE '"$I                   ! @ #00017622' TO DFHEIV0
 19583     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19585     MOVE X'4020233030303137363232' TO DFHEIV0(25:11)
 19586     CALL 'kxdfhei1' USING DFHEIV0
 19587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19588
 19589
 19590
 19591* EXEC CICS READ
 19592*        DATASET   ('ERCOMP')
 19593*        RIDFLD    (ERCOMP-KEY)
 19594*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19595*    END-EXEC.
 19596     MOVE 'ERCOMP' TO DFHEIV1
 19597*    MOVE '&"S        E          (   #00017626' TO DFHEIV0
 19598     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19599     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19600     MOVE X'2020233030303137363236' TO DFHEIV0(25:11)
 19601     CALL 'kxdfhei1' USING DFHEIV0,
 19602           DFHEIV1,
 19603           DFHEIV20,
 19604           DFHEIV99,
 19605           ERCOMP-KEY,
 19606           DFHEIV99,
 19607           DFHEIV99,
 19608           DFHEIV99
 19609     SET ADDRESS OF COMPENSATION-MASTER TO
 19610         DFHEIV20
 19611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19612
 19613
 19614     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19615     GO TO 7800-COMP-EXIT.
 19616
 19617 7800-COMP-NOTFND.
 19618     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19619
 19620 7800-COMP-EXIT.
 19621     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 379
* EL156.cbl
 19623 7900-READ-CLAIM.
 19624
 19625* EXEC CICS READ
 19626*        DATASET  ('ELMSTR')
 19627*        SET      (ADDRESS OF CLAIM-MASTER)
 19628*        RIDFLD   (ELMSTR-KEY)
 19629*    END-EXEC.
 19630     MOVE 'ELMSTR' TO DFHEIV1
 19631*    MOVE '&"S        E          (   #00017642' TO DFHEIV0
 19632     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19633     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19634     MOVE X'2020233030303137363432' TO DFHEIV0(25:11)
 19635     CALL 'kxdfhei1' USING DFHEIV0,
 19636           DFHEIV1,
 19637           DFHEIV20,
 19638           DFHEIV99,
 19639           ELMSTR-KEY,
 19640           DFHEIV99,
 19641           DFHEIV99,
 19642           DFHEIV99
 19643     SET ADDRESS OF CLAIM-MASTER TO
 19644         DFHEIV20
 19645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19646
 19647
 19648 7900-EXIT.
 19649      EXIT.
 19650
 19651 7910-READ-CLAIM-UPDATE.
 19652
 19653* EXEC CICS READ
 19654*        DATASET  ('ELMSTR')
 19655*        SET      (ADDRESS OF CLAIM-MASTER)
 19656*        RIDFLD   (ELMSTR-KEY)
 19657*        UPDATE
 19658*    END-EXEC.
 19659     MOVE 'ELMSTR' TO DFHEIV1
 19660*    MOVE '&"S        EU         (   #00017652' TO DFHEIV0
 19661     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19662     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19663     MOVE X'2020233030303137363532' TO DFHEIV0(25:11)
 19664     CALL 'kxdfhei1' USING DFHEIV0,
 19665           DFHEIV1,
 19666           DFHEIV20,
 19667           DFHEIV99,
 19668           ELMSTR-KEY,
 19669           DFHEIV99,
 19670           DFHEIV99,
 19671           DFHEIV99
 19672     SET ADDRESS OF CLAIM-MASTER TO
 19673         DFHEIV20
 19674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19675
 19676
 19677 7910-EXIT.
 19678      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 380
* EL156.cbl
 19680 7920-READ-BENE.
 19681     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19682     MOVE 'B'                TO BENE-RECORD-TYPE.
 19683     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19684
 19685     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19686        IF PI-PAYEE-TYPE    = 'B' AND
 19687           PI-PAYEE-SEQ-NUM = 9
 19688             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19689             MOVE WS-A-BENE           TO BENE-NUMBER.
 19690
 19691
 19692* EXEC CICS HANDLE CONDITION
 19693*        NOTFND   (7920-NOT-FOUND)
 19694*    END-EXEC.
 19695*    MOVE '"$I                   ! A #00017673' TO DFHEIV0
 19696     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19697     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19698     MOVE X'4120233030303137363733' TO DFHEIV0(25:11)
 19699     CALL 'kxdfhei1' USING DFHEIV0
 19700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19701
 19702
 19703
 19704* EXEC CICS READ
 19705*        DATASET  ('ELBENE')
 19706*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19707*        RIDFLD   (ELBENE-KEY)
 19708*    END-EXEC.
 19709     MOVE 'ELBENE' TO DFHEIV1
 19710*    MOVE '&"S        E          (   #00017677' TO DFHEIV0
 19711     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19712     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19713     MOVE X'2020233030303137363737' TO DFHEIV0(25:11)
 19714     CALL 'kxdfhei1' USING DFHEIV0,
 19715           DFHEIV1,
 19716           DFHEIV20,
 19717           DFHEIV99,
 19718           ELBENE-KEY,
 19719           DFHEIV99,
 19720           DFHEIV99,
 19721           DFHEIV99
 19722     SET ADDRESS OF BENEFICIARY-MASTER TO
 19723         DFHEIV20
 19724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19725
 19726
 19727     MOVE 'Y' TO BENE-FOUND-SW.
 19728     GO TO 7920-EXIT.
 19729
 19730 7920-NOT-FOUND.
 19731     MOVE 'N'                    TO BENE-FOUND-SW.
 19732
 19733 7920-EXIT.
 19734      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 381
* EL156.cbl
 19736 7930-READ-CONTROL.
 19737
 19738* EXEC CICS READ
 19739*        DATASET  ('ELCNTL')
 19740*        SET      (ADDRESS OF CONTROL-FILE)
 19741*        RIDFLD   (ELCNTL-KEY)
 19742*    END-EXEC.
 19743     MOVE 'ELCNTL' TO DFHEIV1
 19744*    MOVE '&"S        E          (   #00017693' TO DFHEIV0
 19745     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19746     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19747     MOVE X'2020233030303137363933' TO DFHEIV0(25:11)
 19748     CALL 'kxdfhei1' USING DFHEIV0,
 19749           DFHEIV1,
 19750           DFHEIV20,
 19751           DFHEIV99,
 19752           ELCNTL-KEY,
 19753           DFHEIV99,
 19754           DFHEIV99,
 19755           DFHEIV99
 19756     SET ADDRESS OF CONTROL-FILE TO
 19757         DFHEIV20
 19758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19759
 19760
 19761 7930-EXIT.
 19762      EXIT.
 19763
 19764 7940-READ-CONTROL-UPDATE.
 19765
 19766* EXEC CICS READ
 19767*        DATASET  ('ELCNTL')
 19768*        SET      (ADDRESS OF CONTROL-FILE)
 19769*        RIDFLD   (ELCNTL-KEY)
 19770*        UPDATE
 19771*    END-EXEC.
 19772     MOVE 'ELCNTL' TO DFHEIV1
 19773*    MOVE '&"S        EU         (   #00017703' TO DFHEIV0
 19774     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19775     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19776     MOVE X'2020233030303137373033' TO DFHEIV0(25:11)
 19777     CALL 'kxdfhei1' USING DFHEIV0,
 19778           DFHEIV1,
 19779           DFHEIV20,
 19780           DFHEIV99,
 19781           ELCNTL-KEY,
 19782           DFHEIV99,
 19783           DFHEIV99,
 19784           DFHEIV99
 19785     SET ADDRESS OF CONTROL-FILE TO
 19786         DFHEIV20
 19787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19788
 19789
 19790 7940-EXIT.
 19791      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 382
* EL156.cbl
 19793 7950-READ-TRAILER.
 19794
 19795* EXEC CICS READ
 19796*        DATASET  ('ELTRLR')
 19797*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19798*        RIDFLD   (ELTRLR-KEY)
 19799*    END-EXEC.
 19800     MOVE 'ELTRLR' TO DFHEIV1
 19801*    MOVE '&"S        E          (   #00017714' TO DFHEIV0
 19802     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19803     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19804     MOVE X'2020233030303137373134' TO DFHEIV0(25:11)
 19805     CALL 'kxdfhei1' USING DFHEIV0,
 19806           DFHEIV1,
 19807           DFHEIV20,
 19808           DFHEIV99,
 19809           ELTRLR-KEY,
 19810           DFHEIV99,
 19811           DFHEIV99,
 19812           DFHEIV99
 19813     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19814         DFHEIV20
 19815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19816
 19817
 19818 7950-EXIT.
 19819      EXIT.
 19820
 19821 7960-READ-TRAILER-UPDATE.
 19822
 19823* EXEC CICS READ
 19824*        DATASET  ('ELTRLR')
 19825*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19826*        RIDFLD   (ELTRLR-KEY)
 19827*        UPDATE
 19828*    END-EXEC.
 19829     MOVE 'ELTRLR' TO DFHEIV1
 19830*    MOVE '&"S        EU         (   #00017724' TO DFHEIV0
 19831     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19832     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19833     MOVE X'2020233030303137373234' TO DFHEIV0(25:11)
 19834     CALL 'kxdfhei1' USING DFHEIV0,
 19835           DFHEIV1,
 19836           DFHEIV20,
 19837           DFHEIV99,
 19838           ELTRLR-KEY,
 19839           DFHEIV99,
 19840           DFHEIV99,
 19841           DFHEIV99
 19842     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19843         DFHEIV20
 19844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19845
 19846
 19847 7960-EXIT.
 19848      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 383
* EL156.cbl
 19850 7970-READ-CERT.
 19851
 19852* EXEC CICS READ
 19853*        DATASET  ('ELCERT')
 19854*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19855*        RIDFLD   (ELCERT-KEY)
 19856*    END-EXEC.
 19857     MOVE 'ELCERT' TO DFHEIV1
 19858*    MOVE '&"S        E          (   #00017735' TO DFHEIV0
 19859     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19860     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19861     MOVE X'2020233030303137373335' TO DFHEIV0(25:11)
 19862     CALL 'kxdfhei1' USING DFHEIV0,
 19863           DFHEIV1,
 19864           DFHEIV20,
 19865           DFHEIV99,
 19866           ELCERT-KEY,
 19867           DFHEIV99,
 19868           DFHEIV99,
 19869           DFHEIV99
 19870     SET ADDRESS OF CERTIFICATE-MASTER TO
 19871         DFHEIV20
 19872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19873
 19874
 19875 7970-EXIT.
 19876      EXIT.
 19877 7975-read-acct.
 19878
 19879     move spaces              to WS-ACCT-RECORD-SW
 19880                                 pi-dcc-product-code
 19881
 19882     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19883     MOVE PI-CARRIER          TO ACCT-CARRIER
 19884     MOVE PI-GROUPING         TO ACCT-GROUPING
 19885     MOVE PI-STATE            TO ACCT-STATE
 19886     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19887     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19888     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19889     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19890
 19891
 19892* EXEC CICS READ
 19893*       DATASET ('ERACCT')
 19894*       RIDFLD  (ERACCT-KEY)
 19895*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19896*       GTEQ
 19897*       resp    (WS-RESPONSE)
 19898*    END-EXEC
 19899     MOVE 'ERACCT' TO DFHEIV1
 19900*    MOVE '&"S        G          (  N#00017757' TO DFHEIV0
 19901     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19902     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19903     MOVE X'204E233030303137373537' TO DFHEIV0(25:11)
 19904     CALL 'kxdfhei1' USING DFHEIV0,
 19905           DFHEIV1,
 19906           DFHEIV20,
 19907           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 384
* EL156.cbl
 19908           ERACCT-KEY,
 19909           DFHEIV99,
 19910           DFHEIV99,
 19911           DFHEIV99
 19912     SET ADDRESS OF ACCOUNT-MASTER TO
 19913         DFHEIV20
 19914     MOVE EIBRESP  TO WS-RESPONSE
 19915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19916     IF WS-RESP-NORMAL
 19917        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19918        and pi-cert-eff-dt < am-expiration-dt
 19919        and pi-cert-eff-dt >= am-effective-dt
 19920        move am-dcc-product-code to pi-dcc-product-code
 19921        set acct-found to true
 19922     end-if
 19923
 19924     .
 19925 7975-exit.
 19926     exit.
 19927 7980-READ-CERT-UPDATE.
 19928
 19929* EXEC CICS READ
 19930*        DATASET  ('ELCERT')
 19931*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19932*        RIDFLD   (ELCERT-KEY)
 19933*        UPDATE
 19934*    END-EXEC.
 19935     MOVE 'ELCERT' TO DFHEIV1
 19936*    MOVE '&"S        EU         (   #00017776' TO DFHEIV0
 19937     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19938     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19939     MOVE X'2020233030303137373736' TO DFHEIV0(25:11)
 19940     CALL 'kxdfhei1' USING DFHEIV0,
 19941           DFHEIV1,
 19942           DFHEIV20,
 19943           DFHEIV99,
 19944           ELCERT-KEY,
 19945           DFHEIV99,
 19946           DFHEIV99,
 19947           DFHEIV99
 19948     SET ADDRESS OF CERTIFICATE-MASTER TO
 19949         DFHEIV20
 19950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19951
 19952
 19953 7980-EXIT.
 19954      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 385
* EL156.cbl
 19956 8000-LOAD-ERROR-MESSAGES.
 19957     IF PI-PASS-SW = 'C'
 19958        MOVE EMI-LINE1           TO ERMSG1BO
 19959     ELSE
 19960        MOVE EMI-LINE1           TO ERRMSG1O
 19961        MOVE EMI-LINE2           TO ERRMSG2O.
 19962
 19963 8000-EXIT.
 19964     EXIT.
 19965
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 386
* EL156.cbl
 19967
 19968 8010-DMD-ERROR-CHECKS.
 19969     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19970
 19971     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19972         GO TO 8051-ISSUE-ERROR.
 19973
 19974     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19975     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19976     MOVE '3'                    TO DC-OPTION-CODE.
 19977     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19978     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19979         GO TO 8051-ISSUE-ERROR.
 19980
 19981     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19982       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19983                           OR
 19984          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19985           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19986             MOVE ER-0851         TO EMI-ERROR
 19987             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19988       END-IF
 19989       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19990             MOVE ER-8147         TO EMI-ERROR
 19991             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19992
 19993     GO TO 8090-EXIT.
 19994
 19995 8051-ISSUE-ERROR.
 19996     MOVE ER-8146            TO EMI-ERROR.
 19997     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19998     GO TO 8090-EXIT.
 19999
 20000 8090-EXIT.
 20001      EXIT.
 20002
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 387
* EL156.cbl
 20004 8100-SEND-INITIAL-MAP.
 20005
 20006     MOVE SAVE-DATE              TO RUNDTEAO.
 20007     MOVE EIBTIME                TO TIME-IN.
 20008     MOVE TIME-OUT               TO RUNTIMAO.
 20009     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 20010
 20011     IF MAP-NAME = 'EL156A'
 20012        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 20013           MOVE 'PF6=EOB CODES'  TO PF6TITO
 20014        END-IF
 20015        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 20016           MOVE 'N'     TO SURVYYNO
 20017        END-IF
 20018     END-IF
 20019*    IF MAP-NAME = 'EL156A'
 20020*       IF PI-COMPANY-ID = 'CRI'
 20021*          NEXT SENTENCE
 20022*       ELSE
 20023*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 20024
 20025     IF MAP-NAME = 'EL156A'
 20026        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 20027           NEXT SENTENCE
 20028        ELSE
 20029           MOVE AL-SADOF TO  PINTA    PINTHA.
 20030
 20031     IF MAP-NAME = 'EL156A'
 20032        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 20033            NEXT SENTENCE
 20034        ELSE
 20035           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 20036
 20037*    IF MAP-NAME = 'EL156A'
 20038*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 20039*          NEXT SENTENCE
 20040*       ELSE
 20041*          MOVE AL-SADOF TO CASHHA CASHA.
 20042
 20043     IF MAP-NAME = 'EL156A'
 20044        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 20045                        or 'VPP'
 20046           NEXT SENTENCE
 20047        ELSE
 20048           MOVE AL-SADOF        TO  LOANHA
 20049                                    LOANNOA.
 20050
 20051     IF MAP-NAME = 'EL156A'
 20052        MOVE -1                 TO  ENTERPFL
 20053        IF PI-USES-PAID-TO
 20054           MOVE 'PAID TO DATE :' TO PTHRHDGO
 20055           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 20056           MOVE PMT-HEAD-A      TO  PMTHDGAO
 20057        ELSE
 20058           NEXT SENTENCE
 20059     ELSE
 20060        IF MAP-NAME = 'EL156B'
 20061           IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 388
* EL156.cbl
 20062              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 20063              MOVE PMT-HEAD-B     TO PMTHDGBO.
 20064
 20065
 20066* EXEC CICS SEND
 20067*        MAP   (MAP-NAME)
 20068*        MAPSET(MAPSET-NAME)
 20069*        FROM  (EL156AI)
 20070*        ERASE
 20071*        CURSOR
 20072*    END-EXEC.
 20073     MOVE LENGTH OF
 20074      EL156AI
 20075       TO DFHEIV12
 20076     MOVE -1
 20077       TO DFHEIV11
 20078*    MOVE '8$     CT  E    H L F ,   #00017895' TO DFHEIV0
 20079     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 20080     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20081     MOVE X'2020233030303137383935' TO DFHEIV0(25:11)
 20082     CALL 'kxdfhei1' USING DFHEIV0,
 20083           MAP-NAME,
 20084           EL156AI,
 20085           DFHEIV12,
 20086           MAPSET-NAME,
 20087           DFHEIV99,
 20088           DFHEIV99,
 20089           DFHEIV99,
 20090           DFHEIV11,
 20091           DFHEIV99,
 20092           DFHEIV99,
 20093           DFHEIV99
 20094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20095
 20096
 20097     GO TO 9100-RETURN-TRAN.
 20098
 20099 8200-SEND-DATAONLY.
 20100
 20101     IF FIRST-ENTRY = 'Y'
 20102         GO TO 8100-SEND-INITIAL-MAP.
 20103
 20104     IF RETURNED-FROM-B = 'Y'
 20105         GO TO 8100-SEND-INITIAL-MAP.
 20106
 20107     MOVE SAVE-DATE              TO RUNDTEAO.
 20108     MOVE EIBTIME                TO TIME-IN.
 20109     MOVE TIME-OUT               TO RUNTIMAO.
 20110
 20111     IF EIBAID = DFHPF11
 20112        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 20113        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20114        MOVE 'EL001   '          TO RETURNED-FROM
 20115        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 20116        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 20117        GO TO 8100-SEND-INITIAL-MAP.
 20118
 20119     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 389
* EL156.cbl
 20120
 20121     IF MAP-NAME =  'EL156A'
 20122        MOVE -1                 TO  ENTERPFL
 20123        IF PI-USES-PAID-TO
 20124           MOVE 'PAID TO DATE :' TO PTHRHDGO
 20125           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 20126           MOVE PMT-HEAD-A      TO  PMTHDGAO
 20127        ELSE
 20128           NEXT SENTENCE
 20129     ELSE
 20130        IF MAP-NAME = 'EL156B'
 20131           IF PI-USES-PAID-TO
 20132              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 20133              MOVE PMT-HEAD-B     TO PMTHDGBO.
 20134
 20135     IF MAP-NAME =  'EL156A'
 20136        IF PI-COMPANY-ID = 'BOA'
 20137            IF PI-INT-RATE NUMERIC
 20138                MOVE PI-INT-RATE TO PINTO.
 20139     IF MAP-NAME = 'EL156A'
 20140        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 20141           MOVE 'PF6=EOB CODES'  TO PF6TITO
 20142*          MOVE 'Y'              TO EOBYNO
 20143        END-IF
 20144     END-IF
 20145
 20146
 20147* EXEC CICS SEND
 20148*        MAP   (MAP-NAME)
 20149*        MAPSET(MAPSET-NAME)
 20150*        FROM  (EL156AI)
 20151*        DATAONLY
 20152*        CURSOR
 20153*    END-EXEC.
 20154     MOVE LENGTH OF
 20155      EL156AI
 20156       TO DFHEIV12
 20157     MOVE -1
 20158       TO DFHEIV11
 20159*    MOVE '8$D    CT       H L F ,   #00017952' TO DFHEIV0
 20160     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 20161     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20162     MOVE X'2020233030303137393532' TO DFHEIV0(25:11)
 20163     CALL 'kxdfhei1' USING DFHEIV0,
 20164           MAP-NAME,
 20165           EL156AI,
 20166           DFHEIV12,
 20167           MAPSET-NAME,
 20168           DFHEIV99,
 20169           DFHEIV99,
 20170           DFHEIV99,
 20171           DFHEIV11,
 20172           DFHEIV99,
 20173           DFHEIV99,
 20174           DFHEIV99
 20175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20176
 20177
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 390
* EL156.cbl
 20178     GO TO 9100-RETURN-TRAN.
 20179
 20180 8300-SEND-TEXT.
 20181
 20182* EXEC CICS SEND TEXT
 20183*        FROM(LOGOFF-TEXT)
 20184*        LENGTH(LOGOFF-LENGTH)
 20185*        ERASE
 20186*        FREEKB
 20187*    END-EXEC.
 20188*    MOVE '8&      T  E F  H   F -   #00017963' TO DFHEIV0
 20189     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 20190     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 20191     MOVE X'2020233030303137393633' TO DFHEIV0(25:11)
 20192     CALL 'kxdfhei1' USING DFHEIV0,
 20193           LOGOFF-TEXT,
 20194           LOGOFF-LENGTH,
 20195           DFHEIV99,
 20196           DFHEIV99,
 20197           DFHEIV99,
 20198           DFHEIV99,
 20199           DFHEIV99,
 20200           DFHEIV99,
 20201           DFHEIV99,
 20202           DFHEIV99,
 20203           DFHEIV99,
 20204           DFHEIV99
 20205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20206
 20207
 20208
 20209* EXEC CICS RETURN
 20210*    END-EXEC.
 20211*    MOVE '.(                    ''   #00017970' TO DFHEIV0
 20212     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20213     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20214     MOVE X'2020233030303137393730' TO DFHEIV0(25:11)
 20215     CALL 'kxdfhei1' USING DFHEIV0,
 20216           DFHEIV99,
 20217           DFHEIV99,
 20218           DFHEIV99,
 20219           DFHEIV99,
 20220           DFHEIV99,
 20221           DFHEIV99
 20222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20223
 20224
 20225 8500-FILE-NOTOPEN.
 20226     IF FILE-SWITCH = 'MSTR'
 20227         MOVE ER-0154            TO EMI-ERROR.
 20228     IF FILE-SWITCH = 'TRLR'
 20229         MOVE ER-0172            TO EMI-ERROR.
 20230     IF FILE-SWITCH = 'CERT'
 20231         MOVE ER-0169            TO EMI-ERROR.
 20232     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 20233                      'PROC' OR 'STAT'
 20234         MOVE ER-0042            TO EMI-ERROR.
 20235     IF FILE-SWITCH = 'ACTQ'
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 391
* EL156.cbl
 20236         MOVE ER-0338            TO EMI-ERROR.
 20237     IF FILE-SWITCH = 'ACCT'
 20238         MOVE ER-0168            TO EMI-ERROR.
 20239
 20240     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20241     MOVE -1                     TO PMTTYPEL.
 20242
 20243     IF FIRST-ENTRY = 'Y'
 20244         GO TO 8100-SEND-INITIAL-MAP.
 20245
 20246     GO TO 8200-SEND-DATAONLY.
 20247
 20248 8600-PGRM-NOT-FOUND.
 20249
 20250     MOVE ER-0923                TO EMI-ERROR.
 20251     MOVE -1                     TO ENTPFBL.
 20252     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20253
 20254     IF FIRST-ENTRY = 'Y'
 20255         GO TO 8100-SEND-INITIAL-MAP
 20256     ELSE
 20257         GO TO 8200-SEND-DATAONLY.
 20258
 20259 8800-UNAUTHORIZED-ACCESS.
 20260     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 20261     GO TO 8300-SEND-TEXT.
 20262
 20263 8810-PF23.
 20264     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 20265     MOVE XCTL-005               TO PGM-NAME.
 20266     GO TO 9300-XCTL.
 20267
 20268 8820-PF7-8.
 20269     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 20270     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 20271                                    PI-SAVED-PROGRAM-2
 20272                                    PI-SAVED-PROGRAM-3
 20273                                    PI-SAVED-PROGRAM-4
 20274                                    PI-SAVED-PROGRAM-5
 20275                                    PI-SAVED-PROGRAM-6
 20276                                    PI-RETURN-TO-PROGRAM.
 20277     IF EIBAID = DFHPF8
 20278        MOVE XCTL-132            TO PGM-NAME
 20279     ELSE
 20280        MOVE XCTL-130            TO PGM-NAME.
 20281
 20282     GO TO 9300-XCTL.
 20283
 20284 9100-RETURN-TRAN.
 20285     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 20286     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 20287
 20288
 20289* EXEC CICS RETURN
 20290*        TRANSID(TRANS-ID)
 20291*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20292*        LENGTH(PI-COMM-LENGTH)
 20293*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 392
* EL156.cbl
 20294*    MOVE '.(CT                  ''   #00018036' TO DFHEIV0
 20295     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 20296     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20297     MOVE X'2020233030303138303336' TO DFHEIV0(25:11)
 20298     CALL 'kxdfhei1' USING DFHEIV0,
 20299           TRANS-ID,
 20300           PROGRAM-INTERFACE-BLOCK,
 20301           PI-COMM-LENGTH,
 20302           DFHEIV99,
 20303           DFHEIV99,
 20304           DFHEIV99
 20305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20306
 20307
 20308 9200-RETURN-MAIN-MENU.
 20309     MOVE XCTL-126               TO PGM-NAME.
 20310     GO TO 9300-XCTL.
 20311
 20312 9300-XCTL.
 20313
 20314* EXEC CICS XCTL
 20315*        PROGRAM(PGM-NAME)
 20316*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20317*        LENGTH(PI-COMM-LENGTH)
 20318*    END-EXEC.
 20319*    MOVE '.$C                   %   #00018047' TO DFHEIV0
 20320     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 20321     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20322     MOVE X'2020233030303138303437' TO DFHEIV0(25:11)
 20323     CALL 'kxdfhei1' USING DFHEIV0,
 20324           PGM-NAME,
 20325           PROGRAM-INTERFACE-BLOCK,
 20326           PI-COMM-LENGTH,
 20327           DFHEIV99
 20328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20329
 20330
 20331 9400-CLEAR.
 20332     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 20333     GO TO 9300-XCTL.
 20334
 20335 9500-PF12.
 20336     MOVE XCTL-010               TO PGM-NAME.
 20337     GO TO 9300-XCTL.
 20338
 20339 9700-LINK-DATE-CONVERT.
 20340     MOVE LINK-ELDATCV           TO PGM-NAME.
 20341
 20342* EXEC CICS LINK
 20343*        PROGRAM   (PGM-NAME)
 20344*        COMMAREA  (DATE-CONVERSION-DATA)
 20345*        LENGTH    (DC-COMM-LENGTH)
 20346*    END-EXEC.
 20347*    MOVE '."C                   (   #00018063' TO DFHEIV0
 20348     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20349     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20350     MOVE X'2020233030303138303633' TO DFHEIV0(25:11)
 20351     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 393
* EL156.cbl
 20352           PGM-NAME,
 20353           DATE-CONVERSION-DATA,
 20354           DC-COMM-LENGTH,
 20355           DFHEIV99,
 20356           DFHEIV99,
 20357           DFHEIV99,
 20358           DFHEIV99
 20359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20360
 20361
 20362 9700-EXIT.
 20363     EXIT.
 20364
 20365 9800-LINK-REM-TERM.
 20366     MOVE LINK-REMTERM TO PGM-NAME.
 20367
 20368
 20369* EXEC CICS LINK
 20370*        PROGRAM   (PGM-NAME)
 20371*        COMMAREA  (CALCULATION-PASS-AREA)
 20372*        LENGTH    (CP-COMM-LENGTH)
 20373*    END-EXEC.
 20374*    MOVE '."C                   (   #00018075' TO DFHEIV0
 20375     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20376     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20377     MOVE X'2020233030303138303735' TO DFHEIV0(25:11)
 20378     CALL 'kxdfhei1' USING DFHEIV0,
 20379           PGM-NAME,
 20380           CALCULATION-PASS-AREA,
 20381           CP-COMM-LENGTH,
 20382           DFHEIV99,
 20383           DFHEIV99,
 20384           DFHEIV99,
 20385           DFHEIV99
 20386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20387
 20388
 20389 9800-EXIT.
 20390     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 394
* EL156.cbl
 20392 9830-DMD-REMAINING-TERM.
 20393
 20394     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 20395         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 20396
 20397     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 20398                              CM-PMT-EXTENSION-DAYS.
 20399
 20400     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 20401                                  CL-NO-OF-DAYS-PAID.
 20402
 20403     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20404         GIVING W-REM REMAINDER W-REM-DAYS.
 20405
 20406     MOVE W-REM                  TO WST-REM.
 20407
 20408     IF W-REM-DAYS > ZEROS
 20409         MOVE '/'                TO WST-SLASH
 20410         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20411     ELSE
 20412         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20413
 20414 9830-EXIT.
 20415     EXIT.
 20416
 20417 9870-OUTPUT-ACTIVITY-RECORD.
 20418
 20419
 20420* EXEC CICS GETMAIN
 20421*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20422*         LENGTH(25)
 20423*         INITIMG(WS-BLANK)
 20424*    END-EXEC.
 20425     MOVE 25
 20426       TO DFHEIV11
 20427*    MOVE ',"IL                  $   #00018111' TO DFHEIV0
 20428     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20429     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20430     MOVE X'2020233030303138313131' TO DFHEIV0(25:11)
 20431     CALL 'kxdfhei1' USING DFHEIV0,
 20432           DFHEIV20,
 20433           DFHEIV11,
 20434           WS-BLANK
 20435     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20436         DFHEIV20
 20437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20438
 20439
 20440     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20441     MOVE ELMSTR-KEY             TO DA-KEY.
 20442     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20443
 20444     IF PI-PMTTYPE EQUAL '7'
 20445         MOVE 'V'                TO DA-RECORD-TYPE
 20446     ELSE
 20447         MOVE 'P'                TO DA-RECORD-TYPE.
 20448
 20449
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 395
* EL156.cbl
 20450* EXEC CICS HANDLE CONDITION
 20451*         NOTOPEN(9870-NOTOPEN)
 20452*         DUPREC(9870-EXIT)
 20453*    END-EXEC.
 20454*    MOVE '"$J%                  ! B #00018126' TO DFHEIV0
 20455     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20456     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20457     MOVE X'4220233030303138313236' TO DFHEIV0(25:11)
 20458     CALL 'kxdfhei1' USING DFHEIV0
 20459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20460
 20461
 20462
 20463* EXEC CICS WRITE
 20464*         DATASET('DLYACTV')
 20465*         RIDFLD(DA-KEY)
 20466*         FROM(DAILY-ACTIVITY-RECORD)
 20467*         LENGTH(25)
 20468*    END-EXEC.
 20469     MOVE 'DLYACTV' TO DFHEIV1
 20470     MOVE 25
 20471       TO DFHEIV11
 20472*    MOVE '&$ L                  ''   #00018131' TO DFHEIV0
 20473     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20474     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20475     MOVE X'2020233030303138313331' TO DFHEIV0(25:11)
 20476     CALL 'kxdfhei1' USING DFHEIV0,
 20477           DFHEIV1,
 20478           DAILY-ACTIVITY-RECORD,
 20479           DFHEIV11,
 20480           DA-KEY,
 20481           DFHEIV99,
 20482           DFHEIV99
 20483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20484
 20485     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20486     GO TO 9870-EXIT.
 20487
 20488 9870-NOTOPEN.
 20489
 20490     MOVE '2955'                 TO EMI-ERROR.
 20491     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20492
 20493 9870-EXIT.
 20494     EXIT.
 20495
 20496 9900-ERROR-FORMAT.
 20497
 20498     IF EMI-ERROR = ER-0923
 20499         MOVE PGM-NAME           TO W-CALLED-NAME.
 20500
 20501     MOVE LINK-001      TO PGM-NAME.
 20502     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20503
 20504
 20505* EXEC CICS LINK
 20506*        PROGRAM (PGM-NAME)
 20507*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 396
* EL156.cbl
 20508*        LENGTH  (EMI-COMM-LENGTH)
 20509*    END-EXEC.
 20510*    MOVE '."C                   (   #00018156' TO DFHEIV0
 20511     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20512     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20513     MOVE X'2020233030303138313536' TO DFHEIV0(25:11)
 20514     CALL 'kxdfhei1' USING DFHEIV0,
 20515           PGM-NAME,
 20516           ERROR-MESSAGE-INTERFACE-BLOCK,
 20517           EMI-COMM-LENGTH,
 20518           DFHEIV99,
 20519           DFHEIV99,
 20520           DFHEIV99,
 20521           DFHEIV99
 20522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20523
 20524
 20525     IF EMI-ERROR = ER-0923
 20526         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20527
 20528 9900-EXIT.
 20529     EXIT.
 20530
 20531 9990-ABEND.
 20532     MOVE LINK-004               TO PGM-NAME.
 20533     MOVE DFHEIBLK               TO EMI-LINE1.
 20534
 20535* EXEC CICS LINK
 20536*        PROGRAM   (PGM-NAME)
 20537*        COMMAREA  (EMI-LINE1)
 20538*        LENGTH    (64)
 20539*    END-EXEC.
 20540     MOVE 64
 20541       TO DFHEIV11
 20542*    MOVE '."C                   (   #00018171' TO DFHEIV0
 20543     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20544     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20545     MOVE X'2020233030303138313731' TO DFHEIV0(25:11)
 20546     CALL 'kxdfhei1' USING DFHEIV0,
 20547           PGM-NAME,
 20548           EMI-LINE1,
 20549           DFHEIV11,
 20550           DFHEIV99,
 20551           DFHEIV99,
 20552           DFHEIV99,
 20553           DFHEIV99
 20554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20555
 20556
 20557     MOVE 'EL156A'               TO  MAP-NAME.
 20558     MOVE LOW-VALUES             TO  EL156AO.
 20559     GO TO 8100-SEND-INITIAL-MAP.
 20560
 20561 9995-SECURITY-VIOLATION.
 20562*    COPY ELCSCTP.
 20563******************************************************************
 20564*                                                                *
 20565*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 397
* EL156.cbl
 20566*                            VMOD=2.001                          *
 20567*                                                                *
 20568*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20569******************************************************************
 20570
 20571
 20572     MOVE EIBDATE          TO SM-JUL-DATE.
 20573     MOVE EIBTRMID         TO SM-TERMID.
 20574     MOVE THIS-PGM         TO SM-PGM.
 20575     MOVE EIBTIME          TO TIME-IN.
 20576     MOVE TIME-OUT         TO SM-TIME.
 20577     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20578
 20579
 20580* EXEC CICS LINK
 20581*         PROGRAM  ('EL003')
 20582*         COMMAREA (SECURITY-MESSAGE)
 20583*         LENGTH   (80)
 20584*    END-EXEC.
 20585     MOVE 'EL003' TO DFHEIV1
 20586     MOVE 80
 20587       TO DFHEIV11
 20588*    MOVE '."C                   (   #00018199' TO DFHEIV0
 20589     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20590     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20591     MOVE X'2020233030303138313939' TO DFHEIV0(25:11)
 20592     CALL 'kxdfhei1' USING DFHEIV0,
 20593           DFHEIV1,
 20594           SECURITY-MESSAGE,
 20595           DFHEIV11,
 20596           DFHEIV99,
 20597           DFHEIV99,
 20598           DFHEIV99,
 20599           DFHEIV99
 20600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20601
 20602
 20603******************************************************************
 20604
 20605
 20606
 20607 9999-DFHBACK SECTION.
 20608     MOVE '9%                    "   ' TO DFHEIV0
 20609     MOVE 'EL156' TO DFHEIV1
 20610     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20611     GOBACK.
 20612 9999-DFHEXIT.
 20613     IF DFHEIGDJ EQUAL 0001
 20614         NEXT SENTENCE
 20615     ELSE IF DFHEIGDJ EQUAL 2
 20616         GO TO 9990-ABEND,
 20617               8600-PGRM-NOT-FOUND,
 20618               0400-FIRST-TIME,
 20619               6180-DUPREC,
 20620               9990-ABEND
 20621         DEPENDING ON DFHEIGDI
 20622     ELSE IF DFHEIGDJ EQUAL 3
 20623         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 398
* EL156.cbl
 20624               0380-CLAIM-END-FILE
 20625         DEPENDING ON DFHEIGDI
 20626     ELSE IF DFHEIGDJ EQUAL 4
 20627         GO TO 0380-CLAIM-END-FILE,
 20628               0380-CLAIM-END-FILE
 20629         DEPENDING ON DFHEIGDI
 20630     ELSE IF DFHEIGDJ EQUAL 5
 20631         GO TO 0800-EXIT
 20632         DEPENDING ON DFHEIGDI
 20633     ELSE IF DFHEIGDJ EQUAL 6
 20634         GO TO 1950-NOT-FOUND,
 20635               1950-NOT-FOUND
 20636         DEPENDING ON DFHEIGDI
 20637     ELSE IF DFHEIGDJ EQUAL 7
 20638         GO TO 1950-NOT-FOUND
 20639         DEPENDING ON DFHEIGDI
 20640     ELSE IF DFHEIGDJ EQUAL 8
 20641         GO TO 1950-NOT-FOUND,
 20642               1950-NOT-FOUND
 20643         DEPENDING ON DFHEIGDI
 20644     ELSE IF DFHEIGDJ EQUAL 9
 20645         GO TO 1166-END-CHECK,
 20646               1166-END-CHECK
 20647         DEPENDING ON DFHEIGDI
 20648     ELSE IF DFHEIGDJ EQUAL 10
 20649         GO TO 1950-NOT-FOUND,
 20650               1950-NOT-FOUND
 20651         DEPENDING ON DFHEIGDI
 20652     ELSE IF DFHEIGDJ EQUAL 11
 20653         GO TO 1950-NOT-FOUND,
 20654               1950-NOT-FOUND
 20655         DEPENDING ON DFHEIGDI
 20656     ELSE IF DFHEIGDJ EQUAL 12
 20657         GO TO 1950-NOT-FOUND
 20658         DEPENDING ON DFHEIGDI
 20659     ELSE IF DFHEIGDJ EQUAL 13
 20660         GO TO 3600-CONTINUE
 20661         DEPENDING ON DFHEIGDI
 20662     ELSE IF DFHEIGDJ EQUAL 14
 20663         GO TO 5300-NOTE-NOT-FOUND
 20664         DEPENDING ON DFHEIGDI
 20665     ELSE IF DFHEIGDJ EQUAL 15
 20666         GO TO 6065-NOT-FOUND
 20667         DEPENDING ON DFHEIGDI
 20668     ELSE IF DFHEIGDJ EQUAL 16
 20669         GO TO 6068-ACCT-NOT-FND
 20670         DEPENDING ON DFHEIGDI
 20671     ELSE IF DFHEIGDJ EQUAL 17
 20672         GO TO 6074-GET-COMP-DATA
 20673         DEPENDING ON DFHEIGDI
 20674     ELSE IF DFHEIGDJ EQUAL 18
 20675         GO TO 6170-WRITE
 20676         DEPENDING ON DFHEIGDI
 20677     ELSE IF DFHEIGDJ EQUAL 19
 20678         GO TO 6180-DUPREC
 20679         DEPENDING ON DFHEIGDI
 20680     ELSE IF DFHEIGDJ EQUAL 20
 20681         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 20-Nov-18 13:08 Page 399
* EL156.cbl
 20682         DEPENDING ON DFHEIGDI
 20683     ELSE IF DFHEIGDJ EQUAL 21
 20684         GO TO 6185-DUPREC
 20685         DEPENDING ON DFHEIGDI
 20686     ELSE IF DFHEIGDJ EQUAL 22
 20687         GO TO 6720-BUILD-NEW-RECORD
 20688         DEPENDING ON DFHEIGDI
 20689     ELSE IF DFHEIGDJ EQUAL 23
 20690         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20691               6900-BUILD-ARCHIVE-HEADER
 20692         DEPENDING ON DFHEIGDI
 20693     ELSE IF DFHEIGDJ EQUAL 24
 20694         GO TO 7010-BUILD-MAP
 20695         DEPENDING ON DFHEIGDI
 20696     ELSE IF DFHEIGDJ EQUAL 25
 20697         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20698         DEPENDING ON DFHEIGDI
 20699     ELSE IF DFHEIGDJ EQUAL 26
 20700         GO TO 7160-DUPREC
 20701         DEPENDING ON DFHEIGDI
 20702     ELSE IF DFHEIGDJ EQUAL 27
 20703         GO TO 7200-EXIT,
 20704               7200-EXIT
 20705         DEPENDING ON DFHEIGDI
 20706     ELSE IF DFHEIGDJ EQUAL 28
 20707         GO TO 7400-NOT-FOUND
 20708         DEPENDING ON DFHEIGDI
 20709     ELSE IF DFHEIGDJ EQUAL 29
 20710         GO TO 7590-END,
 20711               7590-END
 20712         DEPENDING ON DFHEIGDI
 20713     ELSE IF DFHEIGDJ EQUAL 30
 20714         GO TO 7699-EXIT
 20715         DEPENDING ON DFHEIGDI
 20716     ELSE IF DFHEIGDJ EQUAL 31
 20717         GO TO 5300-NOTE-NOT-FOUND
 20718         DEPENDING ON DFHEIGDI
 20719     ELSE IF DFHEIGDJ EQUAL 32
 20720         GO TO 7800-COMP-NOTFND
 20721         DEPENDING ON DFHEIGDI
 20722     ELSE IF DFHEIGDJ EQUAL 33
 20723         GO TO 7920-NOT-FOUND
 20724         DEPENDING ON DFHEIGDI
 20725     ELSE IF DFHEIGDJ EQUAL 34
 20726         GO TO 9870-NOTOPEN,
 20727               9870-EXIT
 20728         DEPENDING ON DFHEIGDI.
 20729     MOVE '9%                    "   ' TO DFHEIV0
 20730     MOVE 'EL156' TO DFHEIV1
 20731     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20732     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12788     Code:       77375
