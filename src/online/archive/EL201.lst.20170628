* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page   1
* EL201.cbl
* Options: int("EL201.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL201.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL201.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL201.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 identification division.
     9 program-id. EL201.
    10*
    11*AUTHOR.    Pablo.
    12*           Colleyville, TEXAS.
    13*REMARKS.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page   2
* EL201.cbl
    14***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
    15***                                                            ***
    16***  Post check number and check written date to refund checks ***
    17***                                                            ***
    18***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 011714  CR2013053000001  PEMA  NEW PROGRAM
    28* 022014  IR2014022000001  PEMA  chg process when file is empty
    29* 082014  IR2014081400001  PEMA  bypass manual request checks
    30* 082014  IR2015082100001  PEMA  bypass more manual request checks
    31* 092215  IR2015092200001  PEMA  modify determination of manual ch
    32* 091615  CR2015082000001  PEMA  Add Endorsement check processing
    33* 020816  IR2016020500001  PEMA  Add env to unikix cmd for cid1p
    34* 042517  IR2017042500001  PEMA  Reduce number of print lines per
    35 environment division.
    36 INPUT-OUTPUT SECTION.
    37 FILE-CONTROL.
    38 SELECT CPS-WRITTEN-IN ASSIGN TO dynamic ws-written-in
    39    FILE STATUS IS WRITTEN-STATUS
    40                            ORGANIZATION IS LINE SEQUENTIAL.
    41 SELECT CPS-WRITTEN-RPT ASSIGN TO dynamic ws-written-rpt
    42    FILE STATUS IS WRITRPT-STATUS
    43                            ORGANIZATION IS LINE SEQUENTIAL.
    44 data division.
    45 FILE SECTION.
    46 FD  CPS-WRITTEN-IN
    47     BLOCK CONTAINS 0
    48     RECORDING MODE F.
    49 01  CPS-WRITTEN-IN-REC          pic x(200).
    50 FD  CPS-WRITTEN-RPT
    51     BLOCK CONTAINS 0
    52     RECORDING MODE F.
    53 01  CPS-WRITTEN-RPT-REC         pic x(132).
    54 working-storage section.
    55 01  DFH-START PIC X(04).
    56 77  ws-process-sw               pic x value ' '.
    57     88  process-cashed            value 'C'.
    58     88  process-written           value 'W'.
    59 77  ws-writ-cnt                 pic 9(5) value zeros.
    60 77  ws-tot-writ-amt             pic s9(9)v99 comp-3 value +0.
    61 77  s1                          pic s999 comp-3 value +0.
    62 77  s2                          pic s999 comp-3 value +0.
    63 77  i1                          pic s999 comp-3 value +0.
    64 77  o1                          pic s999 comp-3 value +0.
    65 77  ws-bin-cashed-dt            pic xx  value low-values.
    66 77  ws-bin-check-dt             pic xx  value low-values.
    67 77  ws-page-cntr                pic 999  value zeros.
    68 77  ws-line-cntr                pic 999  value 070.
    69 77  ws-max-lines                pic 999  value 055.
    70 77  ws-erchek-sw                pic x    value spaces.
    71     88  erchek-found              value 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page   3
* EL201.cbl
    72 77  ws-table-sw                 pic x    value spaces.
    73     88  table-found               value 'Y'.
    74 77  ws-continue-sw              pic x  value 'Y'.
    75     88  ok-to-continue            value 'Y'.
    76     88  not-ok-to-continue        value 'N'.
    77 77  ws-in-recs                  pic 9(5) value zeros.
    78 77  ws-eof-sw                   pic x  value spaces.
    79     88  end-of-input                  value 'Y'.
    80 77  ws-sql-code                 pic s9(7) value zeros.
    81 77  ws-dis-sql-code             pic -9999999 value zeros.
    82 01  ws-work-dynamic.
    83     05  ws-work-dir             pic x(27) value spaces.
    84     05  ws-work-env             pic x(8)  value spaces.
    85     05  ws-work-comp-id         pic xxx   value spaces.
    86     05  ws-work-file-in         pic x(16) value spaces.
    87     05  ws-work-rpt-out         pic x(13) value spaces.
    88     05  ws-work-job-name        pic x(8)  value spaces.
    89 01  ws-written-in               pic x(58).
    90 01  ws-written-rpt              pic x(58).
    91 01  P pointer.
    92 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    93 01  var-ptr pointer.
    94 01  env-var-len                 pic 9(4)  binary.
    95 01  rc                          pic 9(9)  binary.
    96
    97 01  WS-KIXSYS.
    98     05  WS-KIX-FIL1             PIC X(10).
    99     05  WS-KIX-APPS             PIC X(10).
   100     05  WS-KIX-ENV              PIC X(10).
   101     05  WS-KIX-MYENV            PIC X(10).
   102     05  WS-KIX-SYS              PIC X(10).
*  103 EXEC SQL
*  104    INCLUDE SQLDA
*  105 END-EXEC
   106 01 SQLDA sync.
   107    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   108    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   109    05 SQLN                  PIC S9(4) COMP-5 value 0.
   110    05 SQLD                  PIC S9(4) COMP-5 value 0.
   111    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   112       10 SQLTYPE            PIC S9(4) COMP-5.
   113       10 SQLLEN             PIC S9(4) COMP-5.
   114$IF P64 SET
   115X      *> For 64-bit environments, ensure that SQLDATA is
   116X      *> aligned on an 8-byte boundary.
   117X      10 FILLER             PIC S9(9) COMP-5.
   118$END
   119       10 SQLDATA            USAGE POINTER.
   120       10 SQLIND             USAGE POINTER.
   121       10 SQLNAME.
   122          15 SQLNAMEL        PIC S9(4) COMP-5.
   123          15 SQLNAMEC        PIC X(30).
   124
   125* Values for SQLTYPE
   126
   127 78  ESQL-DATE-CHAR              VALUE 384.
   128 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   129 78  ESQL-DATE-REC               VALUE 386.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page   4
* EL201.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-DATE-REC-NULL          VALUE 387.
   131 78  ESQL-TIME-CHAR              VALUE 388.
   132 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   133 78  ESQL-TIME-REC               VALUE 390.
   134 78  ESQL-TIME-REC-NULL          VALUE 391.
   135 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   136 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   137 78  ESQL-TIMESTAMP-REC          VALUE 394.
   138 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   139 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   140 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   141 78  ESQL-TS-OFFSET-REC          VALUE 398.
   142 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   143 78  ESQL-LONGVARBINARY          VALUE 404.
   144 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   145 78  ESQL-LONGVARCHAR            VALUE 408.
   146 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   147 78  ESQL-BINARY                 VALUE 444.
   148 78  ESQL-BINARY-NULL            VALUE 445.
   149 78  ESQL-VARBINARY              VALUE 446.
   150 78  ESQL-VARBINARY-NULL         VALUE 447.
   151 78  ESQL-VARCHAR                VALUE 448.
   152 78  ESQL-VARCHAR-NULL           VALUE 449.
   153
   154 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   155 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   156
   157 78  ESQL-CHAR                   VALUE 452.
   158 78  ESQL-CHAR-NULL              VALUE 453.
   159
   160 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   161 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   162
   163 78  ESQL-DOUBLE                 VALUE 480.
   164 78  ESQL-DOUBLE-NULL            VALUE 481.
   165 78  ESQL-REAL                   VALUE 482.
   166 78  ESQL-REAL-NULL              VALUE 483.
   167 78  ESQL-DECIMAL                VALUE 484.
   168 78  ESQL-DECIMAL-NULL           VALUE 485.
   169 78  ESQL-INTEGER                VALUE 496.
   170 78  ESQL-INTEGER-NULL           VALUE 497.
   171 78  ESQL-SMALLINT               VALUE 500.
   172 78  ESQL-SMALLINT-NULL          VALUE 501.
   173 78  ESQL-TINYINT                VALUE 502.
   174 78  ESQL-TINYINT-NULL           VALUE 503.
*  175 EXEC SQL
*  176    INCLUDE SQLCA
*  177 END-EXEC
   178 01 SQLCA.
   179     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   180     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   181     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   182     05  SQLERRM.
   183         49  SQLERRML    PIC S9(4) COMP-5.
   184         49  SQLERRMC    PIC X(70).
   185     05  SQLERRP         PIC X(8).
   186     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   187     05  SQLWARN.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page   5
* EL201.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188         10  SQLWARN0    PIC X.
   189         10  SQLWARN1    PIC X.
   190         10  SQLWARN2    PIC X.
   191         10  SQLWARN3    PIC X.
   192         10  SQLWARN4    PIC X.
   193         10  SQLWARN5    PIC X.
   194         10  SQLWARN6    PIC X.
   195         10  SQLWARN7    PIC X.
   196     05  SQLEXT.
   197         10  SQLWARN8    PIC X.
   198         10  SQLWARN9    PIC X.
   199         10  SQLWARN10   PIC X.
   200         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   201     05  SQLSTATE    PIC X(5).
   202 EXEC SQL
   203    BEGIN DECLARE SECTION
   204 END-EXEC
   205 01  ws-key-stuff.
   206     05  ws-check-key            pic 9(7).
   207     05  ws-check-no             pic x(7).
   208     05  ws-compid               pic xxx.
   209     05  ws-carrier              pic x.
   210     05  ws-grouping             pic x(6).
   211     05  ws-state                pic xx.
   212     05  ws-account              pic x(10).
   213     05  ws-eff-date             pic x(10).
   214     05  ws-certificate          pic x(10).
   215     05  ws-cert-sfx             pic x.
   216     05  ws-seq-no               pic 999.
   217     05  ws-type                 pic 999.
   218 01  sqlcmd                      pic x(1024).
   219 01  WS-MOE-DATE                 pic x(10).
   220 01  svr                         pic x(32).
   221 01  usr                         pic x(32).
   222 01  pass                        pic x(32).
   223 01  usr-pass                    pic x(64).
   224 01  ws-disp-code                pic s9(11).
   225***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   226***                                                            ***
   227***  These indicators are used to determine if a variable      ***
   228***  is passed nulls from sql. The indicator will be -1        ***
   229***  if the value on sql is nulls and +0 if the value is       ***
   230***  something other than nulls. Here is an example on how     ***
   231***  to use the indicator variables.                           ***
   232***                                                            ***
   233***     EXEC SQL                                               ***
   234***        fetch checkapp into                                 ***
   235***           :db-app-status :nu-app-status,                   ***
   236***           :db-app-by     :nu-app-by,                       ***
   237***           :db-app-date   :nu-app-date,                     ***
   238***           :db-app-batch  :nu-app-batch                     ***
   239***     END-EXEC                                               ***
   240***                                                            ***
   241***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   242 01  indicator-vaiables-for-nulls.
   243     05  nu-app-status           pic s9(4) comp value +0.
   244     05  nu-app-by               pic s9(4) comp value +0.
   245     05  nu-app-date             pic s9(4) comp value +0.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page   6
* EL201.cbl
   246     05  nu-app-batch            pic s9(4) comp value +0.
   247     05  nu-fincar               pic s9(4) comp value +0.
   248     05  nu-checkno              pic s9(4) comp value +0.
   249 01  daily-check-request-rec.
   250     05  db-checkkey             pic x(7).
   251     05  db-compid               pic xxx.
   252     05  db-carrier              pic x.
   253     05  db-grouping             pic x(6).
   254     05  db-state                pic xx.
   255     05  db-account              pic x(10).
   256     05  db-effdate              pic x(24).
   257     05  db-certificate          pic x(10).
   258     05  db-cert-sfx             pic x.
   259     05  db-seq-no               pic x(7).
   260     05  db-type                 pic x(7).
   261     05  db-amount               pic x(10).
   262     05  db-amount-n redefines
   263         db-amount               pic 9(7).99.
   264     05  db-checkno              pic x(15).
   265     05  db-checkdate            pic x(10).
   266     05  db-checkstatus          pic 9(5).
   267     05  db-releasebatch         pic 9(5).
   268     05  db-releasedt            pic x(10).
   269     05  db-releaseby            pic x(4).
   270     05  db-payeename1           pic x(30).
   271     05  db-payeename2           pic x(30).
   272     05  db-payeeaddr1           pic x(30).
   273     05  db-payeeaddr2           pic x(30).
   274     05  db-payeecity            pic x(30).
   275     05  db-payeest              pic xx.
   276     05  db-payeezip             pic x(10).
   277     05  db-fincar               pic x.
   278     05  db-fingrp               pic x(6).
   279     05  db-finresp              pic x(10).
   280     05  db-finacct              pic x(10).
   281     05  db-preparer             pic x(4).
   282     05  db-app-status           pic x(9).
   283     05  dp-app-status-n redefines db-app-status
   284                                 pic 9(9).
   285     05  db-app-by               pic x(20).
   286     05  db-app-date             pic x(30).
   287     05  db-app-batch            pic x(10).
   288     05  db-return-to            pic x(30).
   289     05  db-check-sub-type       pic x.
   290 EXEC SQL
   291    END DECLARE SECTION
   292 END-EXEC
   293 01  FILE-KEYS.
   294     12  ELCNTL-KEY.
   295         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   296         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   297         16 ELCNTL-ACCESS.
   298             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   299             20  FILLER              PIC X       VALUE SPACES.
   300             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   301         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   302 01  f.
   303     05  ws-connect-sw               pic x  value ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page   7
* EL201.cbl
   304         88  connected-to-db             value 'Y'.
   305     05  written-status          pic xx.
   306     05  writrpt-status          pic xx.
   307     05  ws-comp-id              pic xxx.
   308     05  ws-comp-cd              pic x.
   309 01  ws-raw-record.
   310     05  raw-check-no            pic x(20).
   311     05  raw-check-dt            pic x(20).
   312     05  raw-check-amt           pic x(15).
   313     05  raw-vendor-id           pic x(20).
   314     05  raw-user-defined        pic x(30).
   315     05  raw-voucher-ref         pic x(35).
   316 01  ws-written-rec.
   317     05  wsw-check-no            pic x(20).
   318     05  wsw-check-dt            pic x(20).
   319     05  wsw-check-amt           pic x(15).
   320     05  wsw-vendor-id           pic x(20).
   321     05  wsw-user-defined        pic x(30).
   322     05  wsw-voucher-ref         pic x(35).
   323 01  filler.
   324     05  wsw-check-key           pic x(7).
   325     05  wsw-check-key-num redefines wsw-check-key
   326                                 pic 9(7).
   327 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   328     88  RESP-NORMAL                    VALUE +0.
   329     88  resp-file-notfnd               value +12.
   330     88  RESP-NOTFND                    VALUE +13.
   331     88  resp-duprec                    value +14.
   332     88  resp-dupkey                    value +15.
   333     88  resp-invreq                    value +16.
   334     88  RESP-NOTOPEN                   VALUE +19.
   335     88  RESP-ENDFILE                   VALUE +20.
   336     88  resp-lengtherr                 value +22.
   337 01  ws-work-amt-alpha           pic x(10).
   338 01  ws-work-amt-num redefines ws-work-amt-alpha
   339                                 pic 9(8)v99.
   340 01  ws-qry-string               pic x(80) value spaces.
   341 01  ws-qrystr-len               pic s9(8) comp value +60.
   342 01  ws-seq-alpha                pic x(5).
   343 01  ws-seq-no-num redefines ws-seq-alpha
   344                                 pic 9(5).
   345*                                copy ERCCHEK.
   346******************************************************************
   347*                                                                *
   348*                                                                *
   349*                            ERCCHEK                             *
   350*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   351*                            VMOD=2.008                          *
   352*                                                                *
   353*   FILE DESCRIPTION = CHECK RECORDS                             *
   354*                                                                *
   355*   FILE TYPE = VSAM,KSDS                                        *
   356*   RECORD SIZE = 600    RECFORM = FIXED                         *
   357*                                                                *
   358*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
   359*       ALTERNATE INDEX = NONE                                   *
   360*                                                                *
   361*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page   8
* EL201.cbl
   362*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   363******************************************************************
   364*                   C H A N G E   L O G
   365*
   366* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   367*-----------------------------------------------------------------
   368*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   369* EFFECTIVE    NUMBER
   370*-----------------------------------------------------------------
   371* 021414    2003053000001  PEMA  changes for auto chk request
   372******************************************************************
   373 01  CHECK-RECORDS.
   374     12  CH-RECORD-ID                      PIC XX.
   375         88  VALID-CH-ID                      VALUE 'CH'.
   376
   377     12  CH-CONTROL-PRIMARY.
   378         16  CH-COMPANY-CD                 PIC X.
   379         16  CH-CARRIER                    PIC X.
   380         16  CH-GROUPING                   PIC X(6).
   381         16  CH-STATE                      PIC XX.
   382         16  CH-ACCOUNT                    PIC X(10).
   383         16  CH-CERT-EFF-DT                PIC XX.
   384         16  CH-CERT-NO.
   385             20  CH-CERT-PRIME             PIC X(10).
   386             20  CH-CERT-SFX               PIC X.
   387         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
   388
   389     12  CH-RECORDED-DT                    PIC XX.
   390     12  CH-RECORDED-BY                    PIC X(4).
   391     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
   392
   393     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
   394     12  CH-CHECK-NO                       PIC X(7).
   395     12  CH-REASON-FOR-CHECK               PIC X(25).
   396     12  CH-CHECK-WRITTEN-DT               PIC XX.
   397     12  FILLER                            PIC X.
   398
   399     12  CH-PAYEE-INFO.
   400         16  CH-PAYEE-NAME-1               PIC X(30).
   401         16  CH-PAYEE-NAME-2               PIC X(30).
   402         16  CH-PAYEE-ADDRESS-1            PIC X(30).
   403         16  CH-PAYEE-ADDRESS-2            PIC X(30).
   404         16  CH-PAYEE-CITY-ST.
   405             20  CH-PAYEE-CITY             PIC X(28).
   406             20  CH-PAYEE-STATE            PIC XX.
   407         16  CH-PAYEE-ZIP-CODE.
   408             20  CH-PAYEE-ZIP.
   409                 24  CH-ZIP-PRI-1ST        PIC X.
   410                     88  CH-CANADIAN-POST-CODE
   411                                           VALUES 'A' THRU 'Z'.
   412                 24  FILLER                PIC X(4).
   413             20  CH-PAYEE-ZIP-EXT          PIC X(4).
   414         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
   415             20  CH-CAN-POSTAL-1           PIC XXX.
   416             20  CH-CAN-POSTAL-2           PIC XXX.
   417             20  FILLER                    PIC XXX.
   418
   419     12  CH-CHECK-STUB-TEXT.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page   9
* EL201.cbl
   420         16  CH-STUB-LINE-1                PIC X(30).
   421         16  CH-TEXT-LINE-1                PIC X(50).
   422         16  CH-TEXT-LINE-2                PIC X(50).
   423         16  CH-TEXT-LINE-3                PIC X(40).
   424     12  CH-RETURN-TO                      PIC X(30).
   425
   426     12  CH-COMPENSATION-CONTROL.
   427         16  CH-COMP-CARRIER               PIC X.
   428         16  CH-COMP-GROUPING              PIC X(6).
   429         16  CH-COMP-FIN-RESP              PIC X(10).
   430         16  CH-COMP-ACCOUNT               PIC X(10).
   431
   432     12  CH-CREDIT-SELECT-DT               PIC XX.
   433     12  CH-CREDIT-ACCEPT-DT               PIC XX.
   434     12  CH-PAYEE-CODE                     PIC X(6).
   435
   436     12  CH-VOID-DATA.
   437         20  CH-VOID-DT                    PIC XX.
   438         20  CH-VOID-BY                    PIC X(4).
   439         20  CH-VOID-REASON                PIC X(25).
   440
   441     12  CH-APPROVAL-DATA.
   442         20  CH-APPROVAL-DT                PIC XX.
   443         20  CH-APPROVAL-STATUS            PIC X.
   444             88  CH-IN-LIMBO                  VALUE ' '.
   445             88  CH-APPROV-PENDING            VALUE 'P' '2'.
   446             88  CH-APPROVED                  VALUE 'A'.
   447             88  CH-DENIED                    VALUE 'D'.
   448         20  CH-APPROVED-BY                PIC XXXX.
   449     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
   450             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   451     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
   452
   453     12  ch-released-dt                    pic xx.
   454     12  ch-check-cashed-dt                pic xx.
   455     12  FILLER                            PIC X.
   456*    12  CH-CHECK-REFERENCE                PIC X(12).
   457     12  CH-CHECK-ORIGIN-SW                PIC X.
   458             88  CH-REFUND-CHECK              VALUE 'R'.
   459             88  CH-MAINT-CHECK               VALUE 'M'.
   460
   461     12  CH-CANC-DT                        PIC XX.
   462     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
   463     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
   464
   465     12  CH-INSURED-NAME                   PIC X(28).
   466
   467     12  ch-released-by                    pic x(4).
   468     12  ch-csr                            pic x(4).
   469     12  ch-deduct-commission              pic x.
   470         88  ch-deduct-comm                  value 'Y'.
   471         88  ch-do-not-deduct-comm           value 'N'.
   472
   473     12  FILLER                            PIC X(11).
   474*    12  CH-LETTER-TABLE.
   475*        16  CH-LETTERS OCCURS 3 TIMES
   476*                       INDEXED BY CH-LT-NDX
   477*                                          PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  10
* EL201.cbl
   478
   479     12  FILLER                            PIC X(07).
   480
   481*                                copy ELCFUNDT.
   482*****************************************************************
   483*                                                               *
   484*                            ELCFUNDT.                          *
   485*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   486*                            VMOD=2.001                         *
   487*                                                               *
   488*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   489*                                                               *
   490*****************************************************************
   491
   492
   493 01  FUNCTION-DATE.
   494     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   495     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   496         10  WS-FN-CCYR            PIC 9(4).
   497         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   498             15  WS-FN-CC          PIC 99.
   499             15  WS-FN-YR          PIC 99.
   500         10  WS-FN-MO              PIC 99.
   501         10  WS-FN-DA              PIC 99.
   502     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   503     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   504     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   505     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   506     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   507         88  WS-BEHIND-GMT                     VALUE '-'.
   508         88  WS-AFTER-GMT                      VALUE '+'.
   509         88  WS-NO-GMT                         VALUE ZERO.
   510     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   511     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   512*                                COPY ELCDATE.
   513******************************************************************
   514*                                                                *
   515*                                                                *
   516*                            ELCDATE.                            *
   517*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   518*                            VMOD=2.003
   519*                                                                *
   520*                                                                *
   521*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   522*                 LENGTH = 200                                   *
   523******************************************************************
   524
   525 01  DATE-CONVERSION-DATA.
   526     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   527     12  DC-OPTION-CODE                PIC X.
   528         88  BIN-TO-GREG                VALUE ' '.
   529         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   530         88  EDIT-GREG-TO-BIN           VALUE '2'.
   531         88  YMD-GREG-TO-BIN            VALUE '3'.
   532         88  MDY-GREG-TO-BIN            VALUE '4'.
   533         88  JULIAN-TO-BIN              VALUE '5'.
   534         88  BIN-PLUS-ELAPSED           VALUE '6'.
   535         88  FIND-CENTURY               VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  11
* EL201.cbl
   536         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   537         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   538         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   539         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   540         88  JULIAN-TO-BIN-3            VALUE 'C'.
   541         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   542         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   543         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   544         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   545         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   546         88  CHECK-LEAP-YEAR            VALUE 'H'.
   547         88  BIN-3-TO-GREG              VALUE 'I'.
   548         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   549         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   550         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   551         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   552         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   553         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   554         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   555         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   556         88  THREE-CHARACTER-BIN
   557                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   558         88  GREGORIAN-TO-BIN
   559                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   560         88  BIN-TO-GREGORIAN
   561                  VALUES ' ' '1' 'I' '8' 'G'.
   562         88  JULIAN-TO-BINARY
   563                  VALUES '5' 'C' 'E' 'F'.
   564     12  DC-ERROR-CODE                 PIC X.
   565         88  NO-CONVERSION-ERROR        VALUE ' '.
   566         88  DATE-CONVERSION-ERROR
   567                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   568         88  DATE-IS-ZERO               VALUE '1'.
   569         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   570         88  DATE-IS-INVALID            VALUE '3'.
   571         88  DATE1-GREATER-DATE2        VALUE '4'.
   572         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   573         88  DATE-INVALID-OPTION        VALUE '9'.
   574         88  INVALID-CENTURY            VALUE 'A'.
   575         88  ONLY-CENTURY               VALUE 'B'.
   576         88  ONLY-LEAP-YEAR             VALUE 'C'.
   577         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   578     12  DC-END-OF-MONTH               PIC X.
   579         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   580     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   581         88  USE-NORMAL-PROCESS         VALUE ' '.
   582         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   583         88  ADJUST-UP-100-YRS          VALUE '2'.
   584     12  FILLER                        PIC X.
   585     12  DC-CONVERSION-DATES.
   586         16  DC-BIN-DATE-1             PIC XX.
   587         16  DC-BIN-DATE-2             PIC XX.
   588         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   589         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   590                       DC-GREG-DATE-1-EDIT.
   591             20  DC-EDIT1-MONTH        PIC 99.
   592             20  SLASH1-1              PIC X.
   593             20  DC-EDIT1-DAY          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  12
* EL201.cbl
   594             20  SLASH1-2              PIC X.
   595             20  DC-EDIT1-YEAR         PIC 99.
   596         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   597         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   598                     DC-GREG-DATE-2-EDIT.
   599             20  DC-EDIT2-MONTH        PIC 99.
   600             20  SLASH2-1              PIC X.
   601             20  DC-EDIT2-DAY          PIC 99.
   602             20  SLASH2-2              PIC X.
   603             20  DC-EDIT2-YEAR         PIC 99.
   604         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   605         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   606                     DC-GREG-DATE-1-YMD.
   607             20  DC-YMD-YEAR           PIC 99.
   608             20  DC-YMD-MONTH          PIC 99.
   609             20  DC-YMD-DAY            PIC 99.
   610         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   611         16  DC-GREG-DATE-1-MDY-R REDEFINES
   612                      DC-GREG-DATE-1-MDY.
   613             20  DC-MDY-MONTH          PIC 99.
   614             20  DC-MDY-DAY            PIC 99.
   615             20  DC-MDY-YEAR           PIC 99.
   616         16  DC-GREG-DATE-1-ALPHA.
   617             20  DC-ALPHA-MONTH        PIC X(10).
   618             20  DC-ALPHA-DAY          PIC 99.
   619             20  FILLER                PIC XX.
   620             20  DC-ALPHA-CENTURY.
   621                 24 DC-ALPHA-CEN-N     PIC 99.
   622             20  DC-ALPHA-YEAR         PIC 99.
   623         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   624         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   625         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   626         16  DC-JULIAN-DATE            PIC 9(05).
   627         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   628                                       PIC 9(05).
   629         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   630             20  DC-JULIAN-YEAR        PIC 99.
   631             20  DC-JULIAN-DAYS        PIC 999.
   632         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   633         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   634         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   635     12  DATE-CONVERSION-VARIBLES.
   636         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   637         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   638             20  FILLER                PIC 9(3).
   639             20  HOLD-CEN-1-CCYY.
   640                 24  HOLD-CEN-1-CC     PIC 99.
   641                 24  HOLD-CEN-1-YY     PIC 99.
   642             20  HOLD-CEN-1-MO         PIC 99.
   643             20  HOLD-CEN-1-DA         PIC 99.
   644         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   645             20  HOLD-CEN-1-R-MO       PIC 99.
   646             20  HOLD-CEN-1-R-DA       PIC 99.
   647             20  HOLD-CEN-1-R-CCYY.
   648                 24  HOLD-CEN-1-R-CC   PIC 99.
   649                 24  HOLD-CEN-1-R-YY   PIC 99.
   650             20  FILLER                PIC 9(3).
   651         16  HOLD-CENTURY-1-X.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  13
* EL201.cbl
   652             20  FILLER                PIC X(3)  VALUE SPACES.
   653             20  HOLD-CEN-1-X-CCYY.
   654                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   655                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   656             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   657             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   658         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   659             20  HOLD-CEN-1-R-X-MO     PIC XX.
   660             20  HOLD-CEN-1-R-X-DA     PIC XX.
   661             20  HOLD-CEN-1-R-X-CCYY.
   662                 24  HOLD-CEN-1-R-X-CC PIC XX.
   663                 24  HOLD-CEN-1-R-X-YY PIC XX.
   664             20  FILLER                PIC XXX.
   665         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   666         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   667         16  DC-JULIAN-DATE-1          PIC 9(07).
   668         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   669             20  DC-JULIAN-1-CCYY.
   670                 24  DC-JULIAN-1-CC    PIC 99.
   671                 24  DC-JULIAN-1-YR    PIC 99.
   672             20  DC-JULIAN-DA-1        PIC 999.
   673         16  DC-JULIAN-DATE-2          PIC 9(07).
   674         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   675             20  DC-JULIAN-2-CCYY.
   676                 24  DC-JULIAN-2-CC    PIC 99.
   677                 24  DC-JULIAN-2-YR    PIC 99.
   678             20  DC-JULIAN-DA-2        PIC 999.
   679         16  DC-GREG-DATE-A-EDIT.
   680             20  DC-EDITA-MONTH        PIC 99.
   681             20  SLASHA-1              PIC X VALUE '/'.
   682             20  DC-EDITA-DAY          PIC 99.
   683             20  SLASHA-2              PIC X VALUE '/'.
   684             20  DC-EDITA-CCYY.
   685                 24  DC-EDITA-CENT     PIC 99.
   686                 24  DC-EDITA-YEAR     PIC 99.
   687         16  DC-GREG-DATE-B-EDIT.
   688             20  DC-EDITB-MONTH        PIC 99.
   689             20  SLASHB-1              PIC X VALUE '/'.
   690             20  DC-EDITB-DAY          PIC 99.
   691             20  SLASHB-2              PIC X VALUE '/'.
   692             20  DC-EDITB-CCYY.
   693                 24  DC-EDITB-CENT     PIC 99.
   694                 24  DC-EDITB-YEAR     PIC 99.
   695         16  DC-GREG-DATE-CYMD         PIC 9(08).
   696         16  DC-GREG-DATE-CYMD-R REDEFINES
   697                              DC-GREG-DATE-CYMD.
   698             20  DC-CYMD-CEN           PIC 99.
   699             20  DC-CYMD-YEAR          PIC 99.
   700             20  DC-CYMD-MONTH         PIC 99.
   701             20  DC-CYMD-DAY           PIC 99.
   702         16  DC-GREG-DATE-MDCY         PIC 9(08).
   703         16  DC-GREG-DATE-MDCY-R REDEFINES
   704                              DC-GREG-DATE-MDCY.
   705             20  DC-MDCY-MONTH         PIC 99.
   706             20  DC-MDCY-DAY           PIC 99.
   707             20  DC-MDCY-CEN           PIC 99.
   708             20  DC-MDCY-YEAR          PIC 99.
   709    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  14
* EL201.cbl
   710        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   711    12  DC-EL310-DATE                  PIC X(21).
   712    12  FILLER                         PIC X(28).
   713*                                COPY ELCCNTL.
   714******************************************************************
   715*                                                                *
   716*                                                                *
   717*                            ELCCNTL.                            *
   718*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   719*                            VMOD=2.059                          *
   720*                                                                *
   721*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   722*                                                                *
   723*   FILE TYPE = VSAM,KSDS                                        *
   724*   RECORD SIZE = 750  RECFORM = FIXED                           *
   725*                                                                *
   726*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   727*       ALTERNATE INDEX = NONE                                   *
   728*                                                                *
   729*   LOG = YES                                                    *
   730*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   731******************************************************************
   732*                   C H A N G E   L O G
   733*
   734* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   735*-----------------------------------------------------------------
   736*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   737* EFFECTIVE    NUMBER
   738*-----------------------------------------------------------------
   739* 082503                   PEMA  ADD BENEFIT GROUP
   740* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   741* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   742* 092705    2005050300006  PEMA  ADD SPP LEASES
   743* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   744* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   745* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   746* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   747* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   748* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   749* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   750* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   751* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   752* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   753******************************************************************
   754*
   755 01  CONTROL-FILE.
   756     12  CF-RECORD-ID                       PIC XX.
   757         88  VALID-CF-ID                        VALUE 'CF'.
   758
   759     12  CF-CONTROL-PRIMARY.
   760         16  CF-COMPANY-ID                  PIC XXX.
   761         16  CF-RECORD-TYPE                 PIC X.
   762             88  CF-COMPANY-MASTER              VALUE '1'.
   763             88  CF-PROCESSOR-MASTER            VALUE '2'.
   764             88  CF-STATE-MASTER                VALUE '3'.
   765             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   766             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   767             88  CF-CARRIER-MASTER              VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  15
* EL201.cbl
   768             88  CF-MORTALITY-MASTER            VALUE '7'.
   769             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   770             88  CF-TERMINAL-MASTER             VALUE '9'.
   771             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   772             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   773             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   774             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   775             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   776             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   777             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   778             88  CF-REMINDERS-MASTER            VALUE 'R'.
   779             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   780         16  CF-ACCESS-CD-GENL              PIC X(4).
   781         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   782             20  CF-PROCESSOR               PIC X(4).
   783         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   784             20  CF-STATE-CODE              PIC XX.
   785             20  FILLER                     PIC XX.
   786         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   787             20  FILLER                     PIC XX.
   788             20  CF-HI-BEN-IN-REC           PIC XX.
   789         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   790             20  FILLER                     PIC XXX.
   791             20  CF-CARRIER-CNTL            PIC X.
   792         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   793             20  FILLER                     PIC XX.
   794             20  CF-HI-TYPE-IN-REC          PIC 99.
   795         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   796             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   797                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   798             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   799             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   800         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   801             20  FILLER                     PIC X.
   802             20  CF-CUSTOM-REPORT-NO        PIC 999.
   803         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   804             20  FILLER                     PIC XX.
   805             20  CF-MORTGAGE-PLAN           PIC XX.
   806         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   807
   808     12  CF-LAST-MAINT-DT                   PIC XX.
   809     12  CF-LAST-MAINT-BY                   PIC X(4).
   810     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   811
   812     12  CF-RECORD-BODY                     PIC X(728).
   813
   814
   815****************************************************************
   816*             COMPANY MASTER RECORD                            *
   817****************************************************************
   818
   819     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   820         16  CF-COMPANY-ADDRESS.
   821             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   822             20  CF-CL-IN-CARE-OF           PIC X(30).
   823             20  CF-CL-ADDR-LINE-1          PIC X(30).
   824             20  CF-CL-ADDR-LINE-2          PIC X(30).
   825             20  CF-CL-CITY-STATE           PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  16
* EL201.cbl
   826             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   827             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   828         16  CF-COMPANY-CD                  PIC X.
   829         16  CF-COMPANY-PASSWORD            PIC X(8).
   830         16  CF-SECURITY-OPTION             PIC X.
   831             88  ALL-SECURITY                   VALUE '1'.
   832             88  COMPANY-VERIFY                 VALUE '2'.
   833             88  PROCESSOR-VERIFY               VALUE '3'.
   834             88  NO-SECURITY                    VALUE '4'.
   835             88  ALL-BUT-TERM                   VALUE '5'.
   836         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   837             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   838         16  CF-LGX-INTERFACE-CNTL          PIC X.
   839             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   840         16  CF-INFORCE-LOCATION            PIC X.
   841             88  CERTS-ARE-ONLINE               VALUE '1'.
   842             88  CERTS-ARE-OFFLINE              VALUE '2'.
   843             88  NO-CERTS-AVAILABLE             VALUE '3'.
   844         16  CF-LOWER-CASE-LETTERS          PIC X.
   845         16  CF-CERT-ACCESS-CONTROL         PIC X.
   846             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   847             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   848             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   849             88  CF-ACCNT-CNTL                  VALUE '3'.
   850             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   851
   852         16  CF-FORMS-PRINTER-ID            PIC X(4).
   853         16  CF-CHECK-PRINTER-ID            PIC X(4).
   854
   855         16  CF-LGX-CREDIT-USER             PIC X.
   856             88  CO-IS-NOT-USER                 VALUE 'N'.
   857             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   858
   859         16 CF-CREDIT-CALC-CODES.
   860             20  CF-CR-REM-TERM-CALC PIC X.
   861               88  CR-EARN-AFTER-15TH           VALUE '1'.
   862               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   863               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   864               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   865               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   866               88  CR-EARN-AFTER-14TH           VALUE '6'.
   867               88  CR-EARN-AFTER-16TH           VALUE '7'.
   868             20  CF-CR-R78-METHOD           PIC X.
   869               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   870               88  DONT-USE-PLUS-ONE            VALUE '1'.
   871
   872         16  CF-CLAIM-CONTROL-COUNTS.
   873             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   874                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   875
   876             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   877                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   878
   879             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   880                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   881
   882             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   883                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  17
* EL201.cbl
   884
   885         16  CF-CURRENT-MONTH-END           PIC XX.
   886
   887         16  CF-CO-CALC-QUOTE-TOLERANCE.
   888             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   889             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   890             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   891             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   892                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   893                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   894             20  CF-CO-PREM-REJECT-SW       PIC X.
   895                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   896                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   897             20  CF-CO-REF-REJECT-SW        PIC X.
   898                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   899                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   900
   901         16  CF-CO-REPORTING-DT             PIC XX.
   902         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   903         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   904           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   905           88  CF-CO-MONTH-END                  VALUE '1'.
   906
   907         16  CF-LGX-CLAIM-USER              PIC X.
   908             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   909             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   910
   911         16  CF-CREDIT-EDIT-CONTROLS.
   912             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   913             20  CF-MIN-AGE                 PIC 99.
   914             20  CF-DEFAULT-AGE             PIC 99.
   915             20  CF-MIN-TERM                PIC S999      COMP-3.
   916             20  CF-MAX-TERM                PIC S999      COMP-3.
   917             20  CF-DEFAULT-SEX             PIC X.
   918             20  CF-JOINT-AGE-INPUT         PIC X.
   919                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   920             20  CF-BIRTH-DATE-INPUT        PIC X.
   921                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   922             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   923                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   924                 88  CF-ZERO-CARRIER            VALUE '1'.
   925                 88  CF-ZERO-GROUPING           VALUE '2'.
   926                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   927             20  CF-EDIT-SW                 PIC X.
   928                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   929             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   930             20  CF-CR-PR-METHOD            PIC X.
   931               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   932               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   933             20  FILLER                     PIC X.
   934
   935         16  CF-CREDIT-MISC-CONTROLS.
   936             20  CF-REIN-TABLE-SW           PIC X.
   937                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   938             20  CF-COMP-TABLE-SW           PIC X.
   939                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   940             20  CF-EXPERIENCE-RETENTION-AGE
   941                                            PIC S9        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  18
* EL201.cbl
   942             20  CF-CONVERSION-DT           PIC XX.
   943             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   944             20  CF-RUN-FREQUENCY-SW        PIC X.
   945                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   946                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   947
   948             20  CF-CR-CHECK-NO-CONTROL.
   949                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   950                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   951                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   952                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   953                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   954                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   955
   956                 24  CF-CR-CHECK-COUNT       REDEFINES
   957                     CF-CR-CHECK-COUNTER      PIC X(4).
   958
   959                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   960                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   961
   962                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   963                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   964                 24  CF-MAIL-PROCESSING       PIC X.
   965                     88  MAIL-PROCESSING          VALUE 'Y'.
   966
   967         16  CF-MISC-SYSTEM-CONTROL.
   968             20  CF-SYSTEM-C                 PIC X.
   969                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   970             20  CF-SYSTEM-D                 PIC X.
   971                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   972             20  CF-SOC-SEC-NO-SW            PIC X.
   973                 88  SOC-SEC-NO-USED             VALUE '1'.
   974             20  CF-MEMBER-NO-SW             PIC X.
   975                 88  MEMBER-NO-USED              VALUE '1'.
   976             20  CF-TAX-ID-NUMBER            PIC X(11).
   977             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   978             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   979                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   980                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   981                 88  CF-ALL-APPROVED             VALUE 'Y'.
   982                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   983             20  CF-SYSTEM-E                 PIC X.
   984                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   985
   986         16  CF-LGX-LIFE-USER               PIC X.
   987             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   988             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   989
   990         16  CF-CR-MONTH-END-DT             PIC XX.
   991
   992         16  CF-FILE-MAINT-DATES.
   993             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   994                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   995             20  CF-LAST-BATCH       REDEFINES
   996                 CF-LAST-BATCH-NO               PIC X(4).
   997             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   998             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   999             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  19
* EL201.cbl
  1000             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1001             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1002             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1003             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1004             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1005             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1006             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1007
  1008         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1009         16  FILLER                         PIC X.
  1010
  1011         16  CF-ALT-MORT-CODE               PIC X(4).
  1012         16  CF-MEMBER-CAPTION              PIC X(10).
  1013
  1014         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1015             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1016             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1017             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1018             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1019             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1020
  1021         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1022
  1023         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1024         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1025         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1026         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1027
  1028         16  CF-AH-OVERRIDE-L1              PIC X.
  1029         16  CF-AH-OVERRIDE-L2              PIC XX.
  1030         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1031         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1032
  1033         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1034         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1035
  1036         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1037         16  CF-AR-LAST-EL860-DT            PIC XX.
  1038         16  CF-MP-MONTH-END-DT             PIC XX.
  1039
  1040         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1041         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1042             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1043
  1044         16  CF-AR-MONTH-END-DT             PIC XX.
  1045
  1046         16  CF-CRDTCRD-USER                PIC X.
  1047             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1048             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1049
  1050         16  CF-CC-MONTH-END-DT             PIC XX.
  1051
  1052         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1053
  1054         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1055             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1056             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1057             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  20
* EL201.cbl
  1058         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1059         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1060         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1061         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1062             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1063             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1064         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1065         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1066         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1067             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1068         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1069
  1070         16  CF-CL-ZIP-CODE.
  1071             20  CF-CL-ZIP-PRIME.
  1072                 24  CF-CL-ZIP-1ST          PIC X.
  1073                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1074                 24  FILLER                 PIC X(4).
  1075             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1076         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1077             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1078             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1079             20  FILLER                     PIC XXX.
  1080
  1081         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1082         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1083         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1084         16  CF-CO-OPTION-START-DATE        PIC XX.
  1085         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1086           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1087                                                      '3' '4'.
  1088           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1089           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1090           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1091           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1092           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1093           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1094
  1095         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1096
  1097         16  CF-PAYMENT-APPROVAL-LEVELS.
  1098             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1099             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1100             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1101             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1102             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1103             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1104
  1105         16  CF-END-USER-REPORTING-USER     PIC X.
  1106             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1107             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1108
  1109         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1110             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1111             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1112
  1113         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1114
  1115         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  21
* EL201.cbl
  1116         16  FILLER                         PIC X.
  1117
  1118         16  CF-CREDIT-ARCHIVE-CNTL.
  1119             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1120             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1121             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1122
  1123         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1124
  1125         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1126             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1127             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1128
  1129         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1130             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1131             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1132
  1133         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1134
  1135         16  CF-CO-ACH-ID-CODE              PIC  X.
  1136             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1137             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1138             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1139         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1140         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1141         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1142         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1143         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1144         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1145         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1146         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1147         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1148                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1149         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1150                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1151
  1152         16  CF-CO-OVER-SHORT.
  1153             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1154             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1155
  1156*         16  FILLER                         PIC X(102).
  1157         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1158             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1159             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1160
  1161         16  CF-AH-APPROVAL-DAYS.
  1162             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1163             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1164             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1165             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1166
  1167         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1168
  1169         16  CF-APPROV-LEV-5.
  1170             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1171             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1172             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1173
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  22
* EL201.cbl
  1174         16  FILLER                         PIC X(68).
  1175****************************************************************
  1176*             PROCESSOR/USER RECORD                            *
  1177****************************************************************
  1178
  1179     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1180         16  CF-PROCESSOR-NAME              PIC X(30).
  1181         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1182         16  CF-PROCESSOR-TITLE             PIC X(26).
  1183         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1184                 88  MESSAGE-YES                VALUE 'Y'.
  1185                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1186
  1187*****************************************************
  1188****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1189****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1190****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1191****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1192*****************************************************
  1193
  1194         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1195             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1196             20  CF-APPLICATION-FORCE       PIC X.
  1197             20  CF-INDIVIDUAL-APP.
  1198                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1199                     28  CF-BROWSE-APP      PIC X.
  1200                     28  CF-UPDATE-APP      PIC X.
  1201
  1202         16  CF-CURRENT-TERM-ON             PIC X(4).
  1203         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1204             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1205             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1206             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1207             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1208             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1209             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1210             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1211         16  CF-PROCESSOR-CARRIER           PIC X.
  1212             88  NO-CARRIER-SECURITY            VALUE ' '.
  1213         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1214             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1215         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1216             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1217         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1218             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1219
  1220         16  CF-PROC-SYS-ACCESS-SW.
  1221             20  CF-PROC-CREDIT-CLAIMS-SW.
  1222                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1223                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1224                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1225                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1226             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1227                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1228                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1229             20  CF-PROC-LIFE-GNRLDGR-SW.
  1230                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1231                     88  ACCESS-TO-LIFE             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  23
* EL201.cbl
  1232                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1233                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1234             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1235                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1236                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1237         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1238             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1239             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1240         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1241
  1242         16  CF-APPROVAL-LEVEL                  PIC X.
  1243             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1244             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1245             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1246             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1247             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1248
  1249         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1250
  1251         16  CF-LANGUAGE-TYPE                   PIC X.
  1252             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1253             88  CF-LANG-IS-FR                      VALUE 'F'.
  1254
  1255         16  CF-CSR-IND                         PIC X.
  1256         16  FILLER                             PIC X(239).
  1257
  1258****************************************************************
  1259*             PROCESSOR/REMINDERS RECORD                       *
  1260****************************************************************
  1261
  1262     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1263         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1264             20  CF-START-REMIND-DT         PIC XX.
  1265             20  CF-END-REMIND-DT           PIC XX.
  1266             20  CF-REMINDER-TEXT           PIC X(50).
  1267         16  FILLER                         PIC X(296).
  1268
  1269
  1270****************************************************************
  1271*             STATE MASTER RECORD                              *
  1272****************************************************************
  1273
  1274     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1275         16  CF-STATE-ABBREVIATION          PIC XX.
  1276         16  CF-STATE-NAME                  PIC X(25).
  1277         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1278         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1279             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1280             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1281             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1282             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1283                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1284                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1285             20  CF-ST-PREM-REJECT-SW       PIC X.
  1286                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1287                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1288             20  CF-ST-REF-REJECT-SW        PIC X.
  1289                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  24
* EL201.cbl
  1290                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1291         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1292         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1293         16  CF-ST-REFUND-RULES.
  1294             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1295             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1296             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1297         16  CF-ST-FST-PMT-EXTENSION.
  1298             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1299             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1300                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1301                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1302                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1303                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1304         16  CF-ST-STATE-CALL.
  1305             20  CF-ST-CALL-UNEARNED        PIC X.
  1306             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1307             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1308         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1309             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1310             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1311         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1312         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1313         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1314         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1315         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1316         16  FILLER                         PIC X.
  1317         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1318             20  CF-ST-BENEFIT-CD           PIC XX.
  1319             20  CF-ST-BENEFIT-KIND         PIC X.
  1320                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1321                 88  CF-ST-AH-KIND              VALUE 'A'.
  1322             20  CF-ST-REM-TERM-CALC        PIC X.
  1323                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1324                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1325                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1326                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1327                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1328                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1329                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1330                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1331
  1332             20  CF-ST-REFUND-CALC          PIC X.
  1333                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1334                 88  ST-REFD-BY-R78             VALUE '1'.
  1335                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1336                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1337                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1338                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1339                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1340                 88  ST-REFD-UTAH               VALUE '7'.
  1341                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1342                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1343                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1344
  1345             20  CF-ST-EARNING-CALC         PIC X.
  1346                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1347                 88  ST-EARN-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  25
* EL201.cbl
  1348                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1349                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1350                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1351                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1352                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1353                 88  ST-EARN-MEAN               VALUE '8'.
  1354                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1355
  1356             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1357                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1358                 88  ST-OVRD-BY-R78             VALUE '1'.
  1359                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1360                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1361                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1362                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1363                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1364                 88  ST-OVRD-MEAN               VALUE '8'.
  1365                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1366             20  cf-st-extra-periods        pic 9.
  1367*            20  FILLER                     PIC X.
  1368
  1369         16  CF-ST-COMMISSION-CAPS.
  1370             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1371             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1372             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1373             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1374         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1375                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1376
  1377         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1378
  1379         16  CF-ST-STATUTORY-INTEREST.
  1380             20  CF-ST-STAT-DATE-FROM       PIC X.
  1381                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1382                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1383             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1384             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1385             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1386             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1387             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1388
  1389         16  CF-ST-OVER-SHORT.
  1390             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1391             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1392
  1393         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1394
  1395         16  CF-ST-RT-CALC                  PIC X.
  1396
  1397         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1398         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1399         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1400         16  CF-ST-RF-LR-CALC               PIC X.
  1401         16  CF-ST-RF-LL-CALC               PIC X.
  1402         16  CF-ST-RF-LN-CALC               PIC X.
  1403         16  CF-ST-RF-AH-CALC               PIC X.
  1404         16  CF-ST-RF-CP-CALC               PIC X.
  1405*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  26
* EL201.cbl
  1406*CIDMOD         16  FILLER                         PIC X(192).
  1407         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1408             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1409         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1410         16  CF-ST-VFY-2ND-BENE             PIC X.
  1411         16  CF-ST-CAUSAL-STATE             PIC X.
  1412         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1413         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1414         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1415             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1416         16  CF-ST-NET-ONLY-STATE           PIC X.
  1417             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1418         16  FILLER                         PIC X(181).
  1419
  1420****************************************************************
  1421*             BENEFIT MASTER RECORD                            *
  1422****************************************************************
  1423
  1424     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1425         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1426             20  CF-BENEFIT-CODE            PIC XX.
  1427             20  CF-BENEFIT-NUMERIC  REDEFINES
  1428                 CF-BENEFIT-CODE            PIC XX.
  1429             20  CF-BENEFIT-ALPHA           PIC XXX.
  1430             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1431             20  CF-BENEFIT-COMMENT         PIC X(10).
  1432
  1433             20  CF-LF-COVERAGE-TYPE        PIC X.
  1434                 88  CF-REDUCING                VALUE 'R'.
  1435                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1436
  1437             20  CF-SPECIAL-CALC-CD         PIC X.
  1438                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1439                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1440                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1441                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1442                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1443                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1444                 88  CF-FARM-PLAN               VALUE 'F'.
  1445                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1446                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1447                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1448                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1449                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1450                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1451                 88  CF-PRUDENTIAL              VALUE 'P'.
  1452                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1453                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1454                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1455                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1456                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1457                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1458
  1459             20  CF-JOINT-INDICATOR         PIC X.
  1460                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1461
  1462*            20  FILLER                     PIC X(12).
  1463             20  cf-maximum-benefits        pic s999 comp-3.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  27
* EL201.cbl
  1464             20  FILLER                     PIC X(09).
  1465             20  CF-BENEFIT-CATEGORY        PIC X.
  1466             20  CF-LOAN-TYPE               PIC X(8).
  1467
  1468             20  CF-CO-REM-TERM-CALC        PIC X.
  1469                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1470                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1471                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1472                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1473                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1474
  1475             20  CF-CO-EARNINGS-CALC        PIC X.
  1476                 88  CO-EARN-BY-R78             VALUE '1'.
  1477                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1478                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1479                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1480                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1481                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1482                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1483                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1484
  1485             20  CF-CO-REFUND-CALC          PIC X.
  1486                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1487                 88  CO-REFD-BY-R78             VALUE '1'.
  1488                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1489                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1490                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1491                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1492                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1493                 88  CO-REFD-MEAN               VALUE '8'.
  1494                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1495                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1496                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1497
  1498             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1499                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1500                 88  CO-OVRD-BY-R78             VALUE '1'.
  1501                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1502                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1503                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1504                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1505                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1506                 88  CO-OVRD-MEAN               VALUE '8'.
  1507                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1508
  1509             20  CF-CO-BEN-I-G-CD           PIC X.
  1510                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1511                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1512                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1513
  1514         16  FILLER                         PIC X(304).
  1515
  1516
  1517****************************************************************
  1518*             CARRIER MASTER RECORD                            *
  1519****************************************************************
  1520
  1521     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  28
* EL201.cbl
  1522         16  CF-ADDRESS-DATA.
  1523             20  CF-MAIL-TO-NAME            PIC X(30).
  1524             20  CF-IN-CARE-OF              PIC X(30).
  1525             20  CF-ADDRESS-LINE-1          PIC X(30).
  1526             20  CF-ADDRESS-LINE-2          PIC X(30).
  1527             20  CF-CITY-STATE              PIC X(30).
  1528             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1529             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1530
  1531         16  CF-CLAIM-NO-CONTROL.
  1532             20  CF-CLAIM-NO-METHOD         PIC X.
  1533                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1534                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1535                 88  CLAIM-NO-SEQ               VALUE '3'.
  1536                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1537             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1538                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1539                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1540                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1541
  1542         16  CF-CHECK-NO-CONTROL.
  1543             20  CF-CHECK-NO-METHOD         PIC X.
  1544                 88  CHECK-NO-MANUAL            VALUE '1'.
  1545                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1546                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1547                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1548             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1549                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1550
  1551         16  CF-DOMICILE-STATE              PIC XX.
  1552
  1553         16  CF-EXPENSE-CONTROLS.
  1554             20  CF-EXPENSE-METHOD          PIC X.
  1555                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1556                 88  DOLLARS-PER-PMT            VALUE '2'.
  1557                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1558                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1559             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1560             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1561
  1562         16  CF-CORRESPONDENCE-CONTROL.
  1563             20  CF-LETTER-RESEND-OPT       PIC X.
  1564                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1565                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1566             20  FILLER                     PIC X(4).
  1567
  1568         16  CF-RESERVE-CONTROLS.
  1569             20  CF-MANUAL-SW               PIC X.
  1570                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1571             20  CF-FUTURE-SW               PIC X.
  1572                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1573             20  CF-PTC-SW                  PIC X.
  1574                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1575             20  CF-IBNR-SW                 PIC X.
  1576                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1577             20  CF-PTC-LF-SW               PIC X.
  1578                 88  CF-LF-PTC-USED             VALUE '1'.
  1579             20  CF-CDT-ACCESS-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  29
* EL201.cbl
  1580                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1581                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1582                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1583             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1584
  1585         16  CF-CLAIM-CALC-METHOD           PIC X.
  1586             88  360-PLUS-MONTHS                VALUE '1'.
  1587             88  365-PLUS-MONTHS                VALUE '2'.
  1588             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1589             88  360-DAILY                      VALUE '4'.
  1590             88  365-DAILY                      VALUE '5'.
  1591
  1592         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1593         16  FILLER                         PIC X(11).
  1594
  1595         16  CF-LIMIT-AMOUNTS.
  1596             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1597             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1598             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1599             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1600             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1601             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1602             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1603             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1604             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1605             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1606
  1607         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1608         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1609         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1610
  1611         16  CF-ZIP-CODE.
  1612             20  CF-ZIP-PRIME.
  1613                 24  CF-ZIP-1ST             PIC X.
  1614                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1615                 24  FILLER                 PIC X(4).
  1616             20  CF-ZIP-PLUS4               PIC X(4).
  1617         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1618             20  CF-CAN-POSTAL-1            PIC XXX.
  1619             20  CF-CAN-POSTAL-2            PIC XXX.
  1620             20  FILLER                     PIC XXX.
  1621
  1622         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1623         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1624         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1625
  1626         16  CF-RATING-SWITCH               PIC X.
  1627             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1628             88  CF-NO-RATING                   VALUE 'N'.
  1629
  1630         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1631
  1632         16  CF-CARRIER-OVER-SHORT.
  1633             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1634             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1635
  1636         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1637         16  CF-SECPAY-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  30
* EL201.cbl
  1638             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1639             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1640         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1641         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1642         16  FILLER                         PIC X(444).
  1643*        16  FILLER                         PIC X(452).
  1644
  1645
  1646****************************************************************
  1647*             MORTALITY MASTER RECORD                          *
  1648****************************************************************
  1649
  1650     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1651         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1652                                INDEXED BY CF-MORT-NDX.
  1653             20  CF-MORT-TABLE              PIC X(5).
  1654             20  CF-MORT-TABLE-TYPE         PIC X.
  1655                 88  CF-MORT-JOINT              VALUE 'J'.
  1656                 88  CF-MORT-SINGLE             VALUE 'S'.
  1657                 88  CF-MORT-COMBINED           VALUE 'C'.
  1658                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1659                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1660             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1661             20  CF-MORT-AGE-METHOD         PIC XX.
  1662                 88  CF-AGE-LAST                VALUE 'AL'.
  1663                 88  CF-AGE-NEAR                VALUE 'AN'.
  1664             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1665             20  CF-MORT-ADJUSTMENT-DIRECTION
  1666                                            PIC X.
  1667                 88  CF-MINUS                   VALUE '-'.
  1668                 88  CF-PLUS                    VALUE '+'.
  1669             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1670             20  CF-MORT-JOINT-CODE         PIC X.
  1671                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1672             20  CF-MORT-PC-Q               PIC X.
  1673                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1674             20  CF-MORT-TABLE-CODE         PIC X(4).
  1675             20  CF-MORT-COMMENTS           PIC X(15).
  1676             20  FILLER                     PIC X(14).
  1677
  1678         16  FILLER                         PIC X(251).
  1679
  1680
  1681****************************************************************
  1682*             BUSSINESS TYPE MASTER RECORD                     *
  1683****************************************************************
  1684
  1685     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1686* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1687* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1688* AND RECORD 05 IS TYPES 81-99
  1689         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1690             20  CF-BUSINESS-TITLE          PIC  X(19).
  1691             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1692                                            PIC S9V9(4) COMP-3.
  1693             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1694             20  FILLER                     PIC  X.
  1695         16  FILLER                         PIC  X(248).
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  31
* EL201.cbl
  1696
  1697
  1698****************************************************************
  1699*             TERMINAL MASTER RECORD                           *
  1700****************************************************************
  1701
  1702     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1703
  1704         16  CF-COMPANY-TERMINALS.
  1705             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1706                                  PIC X(4).
  1707         16  FILLER               PIC X(248).
  1708
  1709
  1710****************************************************************
  1711*             LIFE EDIT MASTER RECORD                          *
  1712****************************************************************
  1713
  1714     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1715         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1716             20  CF-LIFE-CODE-IN            PIC XX.
  1717             20  CF-LIFE-CODE-OUT           PIC XX.
  1718         16  FILLER                         PIC X(248).
  1719
  1720
  1721****************************************************************
  1722*             AH EDIT MASTER RECORD                            *
  1723****************************************************************
  1724
  1725     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1726         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1727             20  CF-AH-CODE-IN              PIC XXX.
  1728             20  CF-AH-CODE-OUT             PIC XX.
  1729         16  FILLER                         PIC X(248).
  1730
  1731
  1732****************************************************************
  1733*             CREDIBILITY TABLES                               *
  1734****************************************************************
  1735
  1736     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1737         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1738                             INDEXED BY CF-CRDB-NDX.
  1739             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1740             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1741             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1742         16  FILLER                         PIC  X(332).
  1743
  1744
  1745****************************************************************
  1746*             REPORT CUSTOMIZATION RECORD                      *
  1747****************************************************************
  1748
  1749     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1750         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1751             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1752             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1753             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  32
* EL201.cbl
  1754**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1755****       A T-TRANSFER.                                   ****
  1756             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1757
  1758         16  FILLER                         PIC XX.
  1759
  1760         16  CF-CARRIER-CNTL-OPT.
  1761             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1762                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1763                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1764             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1765                                            PIC X.
  1766         16  CF-GROUP-CNTL-OPT.
  1767             20  CF-GROUP-OPT-SEQ           PIC 9.
  1768                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1769                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1770             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1771                                            PIC X(6).
  1772         16  CF-STATE-CNTL-OPT.
  1773             20  CF-STATE-OPT-SEQ           PIC 9.
  1774                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1775                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1776             20  CF-STATE-SELECT OCCURS 3 TIMES
  1777                                            PIC XX.
  1778         16  CF-ACCOUNT-CNTL-OPT.
  1779             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1780                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1781                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1782             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1783                                            PIC X(10).
  1784         16  CF-BUS-TYP-CNTL-OPT.
  1785             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1786                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1787                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1788             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1789                                            PIC XX.
  1790         16  CF-LF-TYP-CNTL-OPT.
  1791             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1792                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1793                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1794             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1795                                            PIC XX.
  1796         16  CF-AH-TYP-CNTL-OPT.
  1797             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1798                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1799                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1800             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1801                                            PIC XX.
  1802         16  CF-REPTCD1-CNTL-OPT.
  1803             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1804                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1805                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1806             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1807                                            PIC X(10).
  1808         16  CF-REPTCD2-CNTL-OPT.
  1809             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1810                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1811                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  33
* EL201.cbl
  1812             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1813                                            PIC X(10).
  1814         16  CF-USER1-CNTL-OPT.
  1815             20  CF-USER1-OPT-SEQ           PIC 9.
  1816                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1817                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1818             20  CF-USER1-SELECT OCCURS 3 TIMES
  1819                                            PIC X(10).
  1820         16  CF-USER2-CNTL-OPT.
  1821             20  CF-USER2-OPT-SEQ           PIC 9.
  1822                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1823                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1824             20  CF-USER2-SELECT OCCURS 3 TIMES
  1825                                            PIC X(10).
  1826         16  CF-USER3-CNTL-OPT.
  1827             20  CF-USER3-OPT-SEQ           PIC 9.
  1828                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1829                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1830             20  CF-USER3-SELECT OCCURS 3 TIMES
  1831                                            PIC X(10).
  1832         16  CF-USER4-CNTL-OPT.
  1833             20  CF-USER4-OPT-SEQ           PIC 9.
  1834                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1835                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1836             20  CF-USER4-SELECT OCCURS 3 TIMES
  1837                                            PIC X(10).
  1838         16  CF-USER5-CNTL-OPT.
  1839             20  CF-USER5-OPT-SEQ           PIC 9.
  1840                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1841                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1842             20  CF-USER5-SELECT OCCURS 3 TIMES
  1843                                            PIC X(10).
  1844         16  CF-REINS-CNTL-OPT.
  1845             20  CF-REINS-OPT-SEQ           PIC 9.
  1846                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1847                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1848             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1849                 24  CF-REINS-PRIME         PIC XXX.
  1850                 24  CF-REINS-SUB           PIC XXX.
  1851
  1852         16  CF-AGENT-CNTL-OPT.
  1853             20  CF-AGENT-OPT-SEQ           PIC 9.
  1854                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1855                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1856             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1857                                            PIC X(10).
  1858
  1859         16  FILLER                         PIC X(43).
  1860
  1861         16  CF-LOSS-RATIO-SELECT.
  1862             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1863             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1864         16  CF-ENTRY-DATE-SELECT.
  1865             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1866             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1867         16  CF-EFFECTIVE-DATE-SELECT.
  1868             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1869             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  34
* EL201.cbl
  1870
  1871         16  CF-EXCEPTION-LIST-IND          PIC X.
  1872             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1873
  1874         16  FILLER                         PIC X(318).
  1875
  1876****************************************************************
  1877*                  EXCEPTION REPORTING RECORD                  *
  1878****************************************************************
  1879
  1880     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1881         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1882             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1883
  1884         16  CF-COMBINED-LIFE-AH-OPT.
  1885             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1886             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1887             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1888             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1889
  1890         16  CF-LIFE-OPT.
  1891             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1892             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1893             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1894             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1895             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1896             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1897             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1898             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1899             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1900             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1901
  1902         16  CF-AH-OPT.
  1903             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1904             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1905             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1906             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1907             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1908             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1909             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1910             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1911             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1912             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1913
  1914         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1915             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1916             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1917             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1918
  1919         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1920
  1921         16  FILLER                         PIC X(673).
  1922
  1923
  1924****************************************************************
  1925*             MORTGAGE SYSTEM PLAN RECORD                      *
  1926****************************************************************
  1927
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  35
* EL201.cbl
  1928     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1929         16  CF-PLAN-TYPE                   PIC X.
  1930             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1931             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1932             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1933         16  CF-PLAN-ABBREV                 PIC XXX.
  1934         16  CF-PLAN-DESCRIPT               PIC X(10).
  1935         16  CF-PLAN-NOTES                  PIC X(20).
  1936         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1937         16  CF-PLAN-UNDERWRITING.
  1938             20  CF-PLAN-TERM-DATA.
  1939                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1940                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1941             20  CF-PLAN-AGE-DATA.
  1942                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1943                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1944                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1945             20  CF-PLAN-BENEFIT-DATA.
  1946                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1947                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1948                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1949                                            PIC S9(7)V99  COMP-3.
  1950         16  CF-PLAN-POLICY-FORMS.
  1951             20  CF-POLICY-FORM             PIC X(12).
  1952             20  CF-MASTER-APPLICATION      PIC X(12).
  1953             20  CF-MASTER-POLICY           PIC X(12).
  1954         16  CF-PLAN-RATING.
  1955             20  CF-RATE-CODE               PIC X(5).
  1956             20  CF-SEX-RATING              PIC X.
  1957                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1958                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1959             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1960             20  CF-SUB-STD-TYPE            PIC X.
  1961                 88  CF-PCT-OF-PREM            VALUE '1'.
  1962                 88  CF-PCT-OF-BENE            VALUE '2'.
  1963         16  CF-PLAN-PREM-TOLERANCES.
  1964             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1965             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1966         16  CF-PLAN-PYMT-TOLERANCES.
  1967             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1968             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1969         16  CF-PLAN-MISC-DATA.
  1970             20  FILLER                     PIC X.
  1971             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1972             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1973         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1974         16  CF-PLAN-IND-GRP                PIC X.
  1975             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1976                                                     '1'.
  1977             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1978                                                     '2'.
  1979         16  CF-MIB-SEARCH-SW               PIC X.
  1980             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1981             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1982             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1983             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1984         16  CF-ALPHA-SEARCH-SW             PIC X.
  1985             88  CF-MIB-ALPHA-ALL              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  36
* EL201.cbl
  1986             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1987             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1988             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1989             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1990             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1991             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1992             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1993             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1994             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1995                                                     'A' 'B' 'C'
  1996                                                     'X' 'Y' 'Z'.
  1997         16  CF-EFF-DT-RULE-SW              PIC X.
  1998             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1999             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2000             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2001             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2002             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2003         16  FILLER                         PIC X(4).
  2004         16  CF-HEALTH-QUESTIONS            PIC X.
  2005             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2006         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2007         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2008         16  CF-PLAN-SNGL-JNT               PIC X.
  2009             88  CF-COMBINED-PLAN              VALUE 'C'.
  2010             88  CF-JNT-PLAN                   VALUE 'J'.
  2011             88  CF-SNGL-PLAN                  VALUE 'S'.
  2012         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2013         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2014         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2015         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2016         16  CF-RERATE-CNTL                 PIC  X.
  2017             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2018             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2019             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2020             88  CF-AUTO-RECALC                 VALUE '4'.
  2021         16  CF-BENEFIT-TYPE                PIC  X.
  2022             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2023             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2024         16  CF-POLICY-FEE                  PIC S999V99
  2025                                                    COMP-3.
  2026         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2027         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2028         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2029         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2030         16  FILLER                         PIC  X(32).
  2031         16  CF-TERMINATION-FORM            PIC  X(04).
  2032         16  FILLER                         PIC  X(08).
  2033         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2034                                                       COMP-3.
  2035         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2036         16  CF-ISSUE-LETTER                PIC  X(4).
  2037         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2038         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2039             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2040             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2041         16  CF-MP-REFUND-CALC              PIC X.
  2042             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2043             88  CF-MP-REFD-BY-R78              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  37
* EL201.cbl
  2044             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2045             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2046             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2047             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2048             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2049             88  CF-MP-REFD-MEAN                VALUE '8'.
  2050         16  CF-ALT-RATE-CODE               PIC  X(5).
  2051
  2052
  2053         16  FILLER                         PIC X(498).
  2054****************************************************************
  2055*             MORTGAGE COMPANY MASTER RECORD                   *
  2056****************************************************************
  2057
  2058     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2059         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2060         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2061             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2062             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2063             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2064             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2065             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2066
  2067         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2068         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2069         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2070         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2071         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2072
  2073         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2074             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2075         16  CF-MP-RECON-USE-IND            PIC X(1).
  2076             88  CF-MP-USE-RECON             VALUE 'Y'.
  2077         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2078             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2079         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2080             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2081             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2082         16  FILLER                         PIC X(1).
  2083         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2084             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2085         16  CF-MORTG-MIB-VERSION           PIC X.
  2086             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2087             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2088             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2089         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2090             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2091                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2092             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2093                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2094             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2095                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2096             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2097                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2098             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2099                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2100             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2101                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  38
* EL201.cbl
  2102         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2103         16  FILLER                         PIC X(7).
  2104         16  CF-MORTG-DESTINATION-SYMBOL.
  2105             20  CF-MORTG-MIB-COMM          PIC X(5).
  2106             20  CF-MORTG-MIB-TERM          PIC X(5).
  2107         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2108             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2109         16  FILLER                         PIC X(03).
  2110         16  CF-MP-CHECK-NO-CONTROL.
  2111             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2112                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2113                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2114                                                ' ' LOW-VALUES.
  2115                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2116                                               VALUE '3'.
  2117         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2118         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2119         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2120             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2121                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2122             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2123                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2124             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2125                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2126             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2127                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2128             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2129                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2130             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2131                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2132         16  CF-MORTG-BILLING-AREA.
  2133             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2134                                            PIC X.
  2135         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2136         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2137         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2138         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2139             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2140             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2141         16  FILLER                         PIC X.
  2142         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2143             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2144             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2145         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2146         16  FILLER                         PIC X(8).
  2147         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2148         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2149         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2150         16  CF-ACH-COMPANY-ID.
  2151             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2152                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2153                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2154                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2155             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2156         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2157             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2158         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2159             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  39
* EL201.cbl
  2160             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2161         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2162         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2163         16  FILLER                         PIC X(536).
  2164
  2165****************************************************************
  2166*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2167****************************************************************
  2168
  2169     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2170         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2171             20  CF-FEMALE-HEIGHT.
  2172                 24  CF-FEMALE-FT           PIC 99.
  2173                 24  CF-FEMALE-IN           PIC 99.
  2174             20  CF-FEMALE-MIN-WT           PIC 999.
  2175             20  CF-FEMALE-MAX-WT           PIC 999.
  2176         16  FILLER                         PIC X(428).
  2177
  2178     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2179         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2180             20  CF-MALE-HEIGHT.
  2181                 24  CF-MALE-FT             PIC 99.
  2182                 24  CF-MALE-IN             PIC 99.
  2183             20  CF-MALE-MIN-WT             PIC 999.
  2184             20  CF-MALE-MAX-WT             PIC 999.
  2185         16  FILLER                         PIC X(428).
  2186******************************************************************
  2187*             AUTOMATIC ACTIVITY RECORD                          *
  2188******************************************************************
  2189     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2190         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2191             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2192             20  CF-SYS-LETTER-ID           PIC X(04).
  2193             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2194             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2195             20  CF-SYS-RESET-SW            PIC X(01).
  2196             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2197             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2198
  2199         16  FILLER                         PIC X(50).
  2200
  2201         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2202             20  CF-USER-ACTIVE-SW          PIC X(01).
  2203             20  CF-USER-LETTER-ID          PIC X(04).
  2204             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2205             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2206             20  CF-USER-RESET-SW           PIC X(01).
  2207             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2208             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2209             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2210
  2211         16  FILLER                         PIC X(246).
  2212 01  ws-heading1.
  2213     05  ws-head1                pic x(120)  value '
  2214-     '                                   DAILY CHECK RECONCILIATI
  2215-     'ON                                            '.
  2216     05  ws-h1-rpt-id            pic x(6)  value 'EL201A'.
  2217 01  ws-heading2.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  40
* EL201.cbl
  2218     05  filler                  pic x(51) value spaces.
  2219     05  WS-H2-CLIENT-NAME       PIC X(59) VALUE SPACES.
  2220     05  WS-H2-DATE              PIC X(10).
  2221     05  ws-h2-time              pic x(8).
  2222 01  ws-heading3.
  2223     05  filler                  pic x(53) value spaces.
  2224     05  WS-H3-DATE              PIC X(67) VALUE SPACES.
  2225     05  FILLER                  PIC X(5)  VALUE 'PAGE '.
  2226     05  WS-H3-PAGE              PIC ZZ,ZZ9.
  2227 01  ws-heading4.
  2228     05  filler                  pic x(117)   value ' CAR  GROUP
  2229-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2230-        '  CHECK CASHED DT   PREPARER   AMOUNT    MESSAGE'.
  2231 01  ws-hd1-written.
  2232     05  filler                  pic x(120)  value '
  2233-     '                                   DAILY WRITTEN CHECKS REP
  2234-     'ORT                                           '.
  2235 01  ws-hd4-written.
  2236     05  filler                  pic x(117)   value ' CAR  GROUP
  2237-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2238-        '  CHECK WRITTEN DT  PREPARER   AMOUNT    MESSAGE'.
  2239 01  ws-detail1.
  2240     05  filler                  pic xx value '  '.
  2241     05  ws-d1-carr              pic x(4) value spaces.
  2242     05  ws-d1-grp               pic x(7) value spaces.
  2243     05  ws-d1-state             pic x(4) value spaces.
  2244     05  ws-d1-account           pic x(12) value spaces.
  2245     05  ws-d1-eff-dt            pic x(12) value spaces.
  2246     05  ws-d1-cert-no           pic x(14) value spaces.
  2247     05  ws-d1-chk-type          pic x(5) value spaces.
  2248     05  ws-d1-chk-no            pic x(12) value spaces.
  2249     05  f                       pic xx value spaces.
  2250     05  ws-d1-writ-cash-dt      pic x(16) value spaces.
  2251     05  ws-d1-preparer          pic x(8) value spaces.
  2252     05  ws-d1-chk-amt-a         pic x(10) value spaces.
  2253     05  ws-d1-chk-amt redefines
  2254         ws-d1-chk-amt-a         pic $$$,$$9.99.
  2255     05  filler                  pic xx value spaces.
  2256     05  ws-d1-message           pic x(20) value spaces.
  2257 01  ws-detail2.
  2258     05  filler                  pic x(12) value '    PAYEE - '.
  2259     05  ws-d2-addr-line         pic x(120) value spaces.
  2260 01  ws-total1.
  2261     05  filler                  pic x(5) value '     '.
  2262     05  ws-t1-cnt               pic zzzz9  value zeros.
  2263     05  ws-t1-chks              pic x(24)  value spaces.
  2264     05  ws-t1-amount            pic $$,$$$,$$9.99 value zeros.
  2265 01  w-doctoken                  pic x(16).
  2266 01 output-data.
  2267    05  filler                   pic x(6) value "TITLE=".
  2268    05  output-title             pic x(26) value 'Check Posting'.
  2269    05  filler                   pic x(8) value "&COMPID=".
  2270    05  out-comp-id              pic xxx.
  2271    05  filler                   pic x(5) value "&MSG=".
  2272    05  output-msg               pic x(50).
  2273 01  tran-data-line1             pic x(80) value spaces.
  2274 01  tran-data-line2             pic x(80) value spaces.
  2275* 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  41
* EL201.cbl
  2276**    'cd /apps/prod/cid1p/jcl'.
  2277*      'cd /apps/test/ahltst/jcl'.
  2278* 01  TRAN-DATA-LINE2.
  2279*     05  filler                  pic x(10) value 'unikixjob '.
  2280*     05  tdl2-job                pic x(8) value 'cilg201b'.
  2281**    05  filler                  pic x(9) value ' -k cid1p'.
  2282*     05  filler                  pic x(10) value ' -k ahltst'.
  2283*     05  filler                  pic x(50) value spaces.
  2284****************************************************************
  2285*
  2286* Copyright (c) 2007-2013 Dell Inc.
  2287* All rights reserved.
  2288*
  2289****************************************************************
  2290 01  DFHEIV.
  2291   02  DFHEIV0               PIC X(35).
  2292   02  DFHEIV1               PIC X(08).
  2293   02  DFHEIV2               PIC X(08).
  2294   02  DFHEIV3               PIC X(08).
  2295   02  DFHEIV4               PIC X(06).
  2296   02  DFHEIV5               PIC X(04).
  2297   02  DFHEIV6               PIC X(04).
  2298   02  DFHEIV7               PIC X(02).
  2299   02  DFHEIV8               PIC X(02).
  2300   02  DFHEIV9               PIC X(01).
  2301   02  DFHEIV10              PIC S9(7) COMP-3.
  2302   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2303   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2304   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2305   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2306   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2307   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2308   02  DFHEIV17              PIC X(04).
  2309   02  DFHEIV18              PIC X(04).
  2310   02  DFHEIV19              PIC X(04).
  2311   02  DFHEIV20              USAGE IS POINTER.
  2312   02  DFHEIV21              USAGE IS POINTER.
  2313   02  DFHEIV22              USAGE IS POINTER.
  2314   02  DFHEIV23              USAGE IS POINTER.
  2315   02  DFHEIV24              USAGE IS POINTER.
  2316   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2317   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2318   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2319   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2320   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2321   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2322   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2323   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2324   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2325   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2326   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2327   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2328   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2329   02  FILLER                PIC X(02).
  2330   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2331   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2332   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2333   02  DFHEIVL2              PIC X(48) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  42
* EL201.cbl
  2334   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2335   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2336   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2337 LINKAGE  SECTION.
  2338*****************************************************************
  2339*                                                               *
  2340* Copyright (c) 2007-2013 Dell Inc.                             *
  2341* All rights reserved.                                          *
  2342*                                                               *
  2343*****************************************************************
  2344 01  dfheiblk.
  2345     02  eibtime          pic s9(7) comp-3.
  2346     02  eibdate          pic s9(7) comp-3.
  2347     02  eibtrnid         pic x(4).
  2348     02  eibtaskn         pic s9(7) comp-3.
  2349     02  eibtrmid         pic x(4).
  2350     02  dfheigdi         pic s9(4) comp.
  2351     02  eibcposn         pic s9(4) comp.
  2352     02  eibcalen         pic s9(4) comp.
  2353     02  eibaid           pic x(1).
  2354     02  eibfiller1       pic x(1).
  2355     02  eibfn            pic x(2).
  2356     02  eibfiller2       pic x(2).
  2357     02  eibrcode         pic x(6).
  2358     02  eibfiller3       pic x(2).
  2359     02  eibds            pic x(8).
  2360     02  eibreqid         pic x(8).
  2361     02  eibrsrce         pic x(8).
  2362     02  eibsync          pic x(1).
  2363     02  eibfree          pic x(1).
  2364     02  eibrecv          pic x(1).
  2365     02  eibsend          pic x(1).
  2366     02  eibatt           pic x(1).
  2367     02  eibeoc           pic x(1).
  2368     02  eibfmh           pic x(1).
  2369     02  eibcompl         pic x(1).
  2370     02  eibsig           pic x(1).
  2371     02  eibconf          pic x(1).
  2372     02  eiberr           pic x(1).
  2373     02  eibrldbk         pic x(1).
  2374     02  eiberrcd         pic x(4).
  2375     02  eibsynrb         pic x(1).
  2376     02  eibnodat         pic x(1).
  2377     02  eibfiller5       pic x(2).
  2378     02  eibresp          pic s9(8) comp.
  2379     02  eibresp2         pic s9(8) comp.
  2380     02  dfheigdj         pic s9(4) comp.
  2381     02  dfheigdk         pic s9(4) comp.
  2382 01  DFHCOMMAREA       PIC X(01).
  2383 01  VAR                         PIC X(30).
  2384 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  2385 0000-DFHEXIT SECTION.
  2386     MOVE '9#                    $   ' TO DFHEIV0.
  2387     MOVE 'EL201' TO DFHEIV1.
  2388     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2389***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2390***                                                            ***
  2391***  Even though this program is using WEB Servies we don't    ***
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  43
* EL201.cbl
  2392***  have any form fields to browse through, we are getting    ***
  2393***  the information we need through the variables that are    ***
  2394***  included in the URL. These variables are retrieved by     ***
  2395***  the           exec cics web extract                       ***
  2396***                   querystring  (data-value)                ***
  2397***                   querystrlen  (data-value)                ***
  2398***                end-exec                                    ***
  2399***  BTW, you must provide the length it isn't passed to you.  ***
  2400***  Allow for extra on the length or you will get a length    ***
  2401***  error instead of just truncation.                         ***
  2402***                                                            ***
  2403***  This program is expecting                                 ***
  2404*** http://slunikix:7001/cics/cwba/EL201?comp=CID&file=written***
  2405*** http://slunikix:7003/cics/cwba/EL201?comp=CID&file=written***
  2406*** http://logictest:6007/cics/cwba/EL201?comp=CID&file=written***
  2407***                                                            ***
  2408***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2409     display ' Entering program EL201 '
  2410     set P to address of KIXSYS
  2411     CALL "getenv" using by value P returning var-ptr
  2412     if var-ptr = null then
  2413        display ' kixsys not set '
  2414     else
  2415        set address of var to var-ptr
  2416        move 0 to env-var-len
  2417        inspect var tallying env-var-len
  2418          for characters before X'00'
  2419        unstring var (1:env-var-len) delimited by '/'
  2420           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2421              WS-KIX-SYS
  2422        end-unstring
  2423     end-if
  2424     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  2425     move ws-fn-cymd             to dc-greg-date-cymd
  2426     move 'L'                    to dc-option-code
  2427     perform 9700-date-convert   thru 9700-exit
  2428     if no-conversion-error
  2429        move dc-greg-date-1-alpha to ws-h3-date
  2430        move dc-greg-date-1-edit to ws-h2-date
  2431     else
  2432        display ' error current dt invalid ' dc-error-code
  2433     end-if
  2434     string ws-fn-hours   ':'
  2435            ws-fn-minutes ':'
  2436            ws-fn-seconds
  2437        delimited by size into ws-h2-time
  2438     end-string
  2439
  2440* exec cics web extract
  2441*       querystring  (ws-qry-string)
  2442*       querystrlen  (ws-qrystr-len)
  2443*    end-exec
  2444*    MOVE 'X0  QL                .   #00002342' TO DFHEIV0
  2445     MOVE X'58302020514C202020202020' TO DFHEIV0(1:12)
  2446     MOVE X'202020202020202020202E20' TO DFHEIV0(13:12)
  2447     MOVE X'2020233030303032333432' TO DFHEIV0(25:11)
  2448     CALL 'kxdfhei1' USING DFHEIV0,
  2449           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  44
* EL201.cbl
  2450           DFHEIV99,
  2451           ws-qry-string,
  2452           ws-qrystr-len,
  2453           DFHEIV99,
  2454           DFHEIV99,
  2455           DFHEIV99,
  2456           DFHEIV99,
  2457           DFHEIV99,
  2458           DFHEIV99,
  2459           DFHEIV99,
  2460           DFHEIV99,
  2461           DFHEIV99
  2462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2463     move ws-qry-string (6:3)    to ws-comp-id
  2464                                    out-comp-id
  2465     move 'Successful Run   '    to output-msg
  2466     move ws-comp-id             to elcntl-key
  2467     move '1'                    to elcntl-rec-type
  2468     move +0                     to elcntl-seq
  2469
  2470* exec cics read
  2471*       dataset  ('ELCNTL')
  2472*       into     (control-file)
  2473*       ridfld   (elcntl-key)
  2474*       resp     (ws-response)
  2475*    end-exec
  2476     MOVE LENGTH OF
  2477      control-file
  2478       TO DFHEIV11
  2479     MOVE 'ELCNTL' TO DFHEIV1
  2480*    MOVE '&"IL       E          (  N#00002352' TO DFHEIV0
  2481     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2482     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2483     MOVE X'204E233030303032333532' TO DFHEIV0(25:11)
  2484     CALL 'kxdfhei1' USING DFHEIV0,
  2485           DFHEIV1,
  2486           control-file,
  2487           DFHEIV11,
  2488           elcntl-key,
  2489           DFHEIV99,
  2490           DFHEIV99,
  2491           DFHEIV99
  2492     MOVE EIBRESP  TO ws-response
  2493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2494     if resp-normal
  2495        move cf-cl-mail-to-name  to ws-h2-client-name
  2496        move cf-company-cd       to ws-comp-cd
  2497     else
  2498        move 'Company Rec not found ' to ws-h2-client-name
  2499                                         output-msg
  2500        display ' error elcntl read ' ws-response ' '
  2501           elcntl-key (1:8)
  2502        go to 0000-return
  2503     end-if
  2504     evaluate true
  2505        when ws-qry-string (15:7) = 'written' or 'WRITTEN'
  2506           set process-written      to true
  2507           perform 2000-process-written
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  45
* EL201.cbl
  2508                                 thru 2000-exit
  2509        when other
  2510           move 'Invalid File ' to output-msg
  2511     end-evaluate
  2512     if connected-to-db
  2513        EXEC SQL
  2514            commit work release
  2515        END-EXEC
  2516        if sqlcode not = 0
  2517           move ' Failed to Commit DB '
  2518                                 to output-msg
  2519           display "Error: commit release "
  2520           display ' sql return code ' sqlcode
  2521           display ' sql err mess    ' sqlerrmc
  2522        end-if
  2523     end-if
  2524     .
  2525 0000-return.
  2526     perform 1030-send-form      thru 1030-exit
  2527
  2528* exec cics
  2529*       return
  2530*    end-exec
  2531*    MOVE '.(                    ''   #00002391' TO DFHEIV0
  2532     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2533     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2534     MOVE X'2020233030303032333931' TO DFHEIV0(25:11)
  2535     CALL 'kxdfhei1' USING DFHEIV0,
  2536           DFHEIV99,
  2537           DFHEIV99,
  2538           DFHEIV99,
  2539           DFHEIV99,
  2540           DFHEIV99,
  2541           DFHEIV99
  2542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2543     .
  2544 1000-CONNECT-DB.
  2545     string
  2546         usr delimited space
  2547         "." delimited size
  2548         pass delimited space into usr-pass
  2549     end-string
  2550     EXEC SQL
  2551        CONNECT TO :svr USER :usr-pass
  2552     END-EXEC
  2553     if sqlcode not = 0
  2554        display "Error: cannot connect "
  2555        display sqlcode
  2556        display sqlerrmc
  2557        move 'Failed to connect to DB'
  2558                                 to output-msg
  2559        go to 0000-return
  2560     else
  2561        set connected-to-db to true
  2562     end-if
  2563     .
  2564 1000-EXIT.
  2565     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  46
* EL201.cbl
  2566 1020-read-erchek.
  2567     move ws-comp-cd             to ch-company-cd
  2568     move db-carrier             to ch-carrier
  2569     move db-grouping            to ch-grouping
  2570     move db-state               to ch-state
  2571     move db-account             to ch-account
  2572     move db-certificate         to ch-cert-prime
  2573     move db-cert-sfx            to ch-cert-sfx
  2574     string db-effdate (1:4)
  2575            db-effdate (6:2)
  2576            db-effdate (9:2)
  2577        delimited by size into dc-greg-date-cymd-r
  2578     end-string
  2579     move 'L'                    to dc-option-code
  2580     perform 9700-date-convert   thru 9700-exit
  2581     if no-conversion-error
  2582        move dc-bin-date-1       to ch-cert-eff-dt
  2583     else
  2584        display ' error cvtdte eff dt ' db-effdate ' '
  2585           dc-error-code
  2586     end-if
  2587     move zeros                  to ws-seq-alpha
  2588     move +5                     to s2
  2589     perform varying s1 from +5 by -1 until s1 < +1
  2590        if db-seq-no (s1:1) numeric
  2591           move db-seq-no (s1:1) to ws-seq-alpha (s2:1)
  2592           subtract +1 from s2
  2593        end-if
  2594     end-perform
  2595     move ws-seq-no-num          to ch-sequence-no
  2596*    display ' dte   **' db-effdate '**'
  2597*    display ' carrier ' ch-carrier
  2598*    display ' group   ' ch-grouping
  2599*    display ' state   ' ch-state
  2600*    display ' acct    ' ch-account
  2601*    display ' cert  **' ch-cert-no '**'
  2602*    display ' seq     ' ch-sequence-no
  2603
  2604* exec cics read
  2605*       update
  2606*       dataset    ('ERCHEK')
  2607*       into       (check-records)
  2608*       ridfld     (ch-control-primary)
  2609*       resp       (ws-response)
  2610*    end-exec
  2611     MOVE LENGTH OF
  2612      check-records
  2613       TO DFHEIV11
  2614     MOVE 'ERCHEK' TO DFHEIV1
  2615*    MOVE '&"IL       EU         (  N#00002454' TO DFHEIV0
  2616     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2617     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2618     MOVE X'204E233030303032343534' TO DFHEIV0(25:11)
  2619     CALL 'kxdfhei1' USING DFHEIV0,
  2620           DFHEIV1,
  2621           check-records,
  2622           DFHEIV11,
  2623           ch-control-primary,
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  47
* EL201.cbl
  2624           DFHEIV99,
  2625           DFHEIV99,
  2626           DFHEIV99
  2627     MOVE EIBRESP  TO ws-response
  2628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2629     .
  2630 1020-exit.
  2631     exit.
  2632 1030-send-form.
  2633
  2634* exec cics document create
  2635*       doctoken   (w-doctoken)
  2636*       template   ('WCHECKS')
  2637*       symbollist (output-data)
  2638*       listlength (length of output-data)
  2639*    end-exec
  2640     MOVE 'WCHECKS' TO DFHEIV1
  2641     MOVE LENGTH OF
  2642      output-data TO DFHEIV16
  2643*    MOVE '\"D tSL               )   #00002465' TO DFHEIV0
  2644     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  2645     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2646     MOVE X'2020233030303032343635' TO DFHEIV0(25:11)
  2647     CALL 'kxdfhei1' USING DFHEIV0,
  2648           w-doctoken,
  2649           DFHEIV99,
  2650           DFHEIV1,
  2651           output-data,
  2652           DFHEIV16,
  2653           DFHEIV99,
  2654           DFHEIV99,
  2655           DFHEIV99
  2656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2657
  2658* exec cics web send
  2659*       doctoken(w-doctoken)
  2660*    end-exec
  2661*    MOVE 'X$D                   *   #00002471' TO DFHEIV0
  2662     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  2663     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  2664     MOVE X'2020233030303032343731' TO DFHEIV0(25:11)
  2665     CALL 'kxdfhei1' USING DFHEIV0,
  2666           w-doctoken,
  2667           DFHEIV99,
  2668           DFHEIV99,
  2669           DFHEIV99,
  2670           DFHEIV99,
  2671           DFHEIV99,
  2672           DFHEIV99,
  2673           DFHEIV99,
  2674           DFHEIV99
  2675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2676     .
  2677 1030-exit.
  2678     exit.
  2679 1050-disconnect.
  2680     if connected-to-db
  2681        EXEC SQL
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  48
* EL201.cbl
  2682            disconnect all
  2683        END-EXEC
  2684        move ' ' to ws-connect-sw
  2685     end-if
  2686     .
  2687 1050-exit.
  2688     exit.
  2689 2000-process-written.
  2690     perform 2010-open-files     thru 2010-exit
  2691     perform 2020-init           thru 2020-exit
  2692     perform 2050-process-input  thru 2050-exit until
  2693        end-of-input
  2694     if ws-writ-cnt > zeros
  2695        move ws-writ-cnt         to ws-t1-cnt
  2696        move ' Written '         to ws-t1-chks
  2697        move ws-tot-writ-amt     to ws-t1-amount
  2698     else
  2699        perform 4010-write-headings
  2700                                 thru 4010-exit
  2701        move spaces              to ws-total1
  2702        string ' No checks for '
  2703           ws-work-comp-id
  2704           ' today. ' delimited by size into ws-total1
  2705        end-string
  2706     end-if
  2707     move spaces                 to cps-written-rpt-rec
  2708     perform 4020-write-a-line   thru 4020-exit
  2709     move ws-total1              to cps-written-rpt-rec
  2710     perform 4020-write-a-line   thru 4020-exit
  2711     perform 2500-close-files    thru 2500-exit
  2712     perform 5000-submit-job     thru 5000-exit
  2713     .
  2714 2000-exit.
  2715     exit.
  2716 2010-open-files.
  2717     if ws-kix-myenv = 'cid1p'
  2718        move 'NTCSO2_ChkApprv'   to svr
  2719        move 'sa'                to usr
  2720        move 'ntcso2'            to pass
  2721        move '/data/seqfiles/'   to ws-work-dir
  2722        move 'cd /apps/prod/cid1p/jcl'
  2723                                 to tran-data-line1
  2724        move ws-kix-myenv        to ws-work-env
  2725     else
  2726        move 'NTSQLTST2_Logic'   to svr
  2727        move 'sa'                to usr
  2728        move 'sql2008r2'         to pass
  2729        move ws-kix-myenv        to ws-work-env
  2730        string
  2731           '/data/test/' delimited by size
  2732           ws-work-env   delimited by space
  2733           '/seqfiles/'  delimited by size
  2734              into ws-work-dir
  2735        end-string
  2736        string
  2737           'cd /apps/test/' delimited by size
  2738           ws-work-env      delimited by space
  2739           '/jcl'           delimited by size
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  49
* EL201.cbl
  2740              into tran-data-line1
  2741        end-string
  2742     end-if
  2743     move function upper-case(ws-comp-id)
  2744                                 to ws-work-comp-id
  2745     move 'miscpymts.csv'        to ws-work-file-in
  2746     move 'cilg201b'             to ws-work-job-name
  2747     if ws-work-comp-id = 'AHL'
  2748        move 'miscpymtsahl.csv'  to ws-work-file-in
  2749        move 'ahlg201b'          to ws-work-job-name
  2750     end-if
  2751     move spaces                 to ws-written-in
  2752                                    ws-written-rpt
  2753     string
  2754        ws-work-dir delimited by space
  2755        ws-work-file-in delimited by space
  2756           into ws-written-in
  2757     end-string
  2758     move 'miscpymts.rpt'        to ws-work-rpt-out
  2759     string
  2760        ws-work-dir delimited by space
  2761        ws-work-comp-id delimited by size
  2762        ws-work-rpt-out delimited by size
  2763           into ws-written-rpt
  2764     end-string
  2765     string
  2766        'unikixjob '     delimited by size
  2767        ws-work-job-name delimited by size
  2768        ' -k '           delimited by size
  2769        ws-work-env      delimited by space
  2770           into tran-data-line2
  2771     end-string
  2772*     display ' svr    ' svr
  2773*     display ' user   ' usr
  2774*     display ' pw     ' pass
  2775*     display ' input  ' ws-written-in
  2776*     display ' output ' ws-written-rpt
  2777*     display ' line 1 ' tran-data-line1
  2778*     display ' line 2 ' tran-data-line2
  2779     open input CPS-WRITTEN-IN
  2780         output CPS-WRITTEN-RPT
  2781     if written-status not = '00'
  2782        display 'error written open ' written-status
  2783        move ' Invalid or missing file '
  2784                                 to output-msg
  2785        go to 0000-return
  2786     end-if
  2787     .
  2788 2010-exit.
  2789     exit.
  2790 2020-init.
  2791     move spaces                 to ws-detail1
  2792     move ws-hd1-written         to ws-head1
  2793     move 'EL201B'               to ws-h1-rpt-id
  2794     move ws-hd4-written         to ws-heading4
  2795     move 'Posting of Written Checks '
  2796                                 to output-title
  2797*    if ws-comp-id = 'AHL'
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  50
* EL201.cbl
  2798*       move 'ahlg201b'          to tdl2-job
  2799*    else
  2800*       move 'cilg201b'          to tdl2-job
  2801*    end-if
  2802     if not connected-to-db
  2803        perform 1000-connect-db  thru 1000-exit
  2804     end-if
  2805***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2806***                                                            ***
  2807**     I do 2 reads to bypass the header record                ***
  2808***                                                            ***
  2809***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2810     perform 2040-read-input     thru 2040-exit
  2811     perform 2040-read-input     thru 2040-exit
  2812     .
  2813 2020-exit.
  2814     exit.
  2815 2040-read-input.
  2816     read CPS-WRITTEN-IN at end
  2817        set end-of-input   to true
  2818     end-read
  2819     if not end-of-input
  2820        add 1 to ws-in-recs
  2821     end-if
  2822     .
  2823 2040-exit.
  2824     exit.
  2825 2050-process-input.
  2826     move spaces                 to ws-raw-record
  2827                                    ws-written-rec
  2828     unstring cps-written-in-rec
  2829        delimited by ',' into
  2830           raw-check-no
  2831           raw-check-dt
  2832           raw-check-amt
  2833           raw-vendor-id
  2834           raw-user-defined
  2835           raw-voucher-ref
  2836     end-unstring
  2837*    display ' chk no    **' wsw-check-no '**'
  2838*    display ' chk dt    **' wsw-check-dt '**'
  2839*    display ' chk amt   **' wsw-check-amt '**'
  2840*    display ' vend id   **' wsw-vendor-id '**'
  2841*    display ' user def  **' wsw-user-defined '**'
  2842*    display ' vouch ref **' wsw-voucher-ref '**'
  2843***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2844***                                                            ***
  2845***    Every now and then I get bogus records with quotes      ***
  2846***  so I am just going to remove them.  These are normally    ***
  2847***  a result of a manual process that should not be included  ***
  2848***  in this file.                                             ***
  2849***                                                            ***
  2850***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2851
  2852     move +1                     to o1
  2853     perform varying i1 from +1 by +1 until i1 > +20
  2854        if raw-check-no (i1:1) <> '"'
  2855           move raw-check-no (i1:1)
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  51
* EL201.cbl
  2856                                 to wsw-check-no (o1:1)
  2857           add +1 to o1
  2858        end-if
  2859     end-perform
  2860
  2861     move +1                     to o1
  2862     perform varying i1 from +1 by +1 until i1 > +20
  2863        if raw-check-dt (i1:1) <> '"'
  2864           move raw-check-dt (i1:1)
  2865                                 to wsw-check-dt (o1:1)
  2866           add +1 to o1
  2867        end-if
  2868     end-perform
  2869
  2870     move +1                     to o1
  2871     perform varying i1 from +1 by +1 until i1 > +15
  2872        if raw-check-amt (i1:1) <> '"'
  2873           move raw-check-amt (i1:1)
  2874                                 to wsw-check-amt (o1:1)
  2875           add +1 to o1
  2876        end-if
  2877     end-perform
  2878
  2879     move +1                     to o1
  2880     perform varying i1 from +1 by +1 until i1 > +20
  2881        if raw-vendor-id (i1:1) <> '"'
  2882           move raw-vendor-id (i1:1)
  2883                                 to wsw-vendor-id (o1:1)
  2884           add +1 to o1
  2885        end-if
  2886     end-perform
  2887
  2888     move +1                     to o1
  2889     perform varying i1 from +1 by +1 until i1 > +30
  2890        if raw-user-defined (i1:1) <> '"'
  2891           move raw-user-defined (i1:1)
  2892                                 to wsw-user-defined (o1:1)
  2893           add +1 to o1
  2894        end-if
  2895     end-perform
  2896
  2897     move +1                     to o1
  2898     perform varying i1 from +1 by +1 until i1 > +35
  2899        if raw-voucher-ref (i1:1) <> '"'
  2900           move raw-voucher-ref (i1:1)
  2901                                 to wsw-voucher-ref (o1:1)
  2902           add +1 to o1
  2903        end-if
  2904     end-perform
  2905     if (wsw-check-no = spaces)
  2906        and (wsw-check-dt = spaces)
  2907        and (wsw-check-amt = spaces)
  2908        display ' empty record ' cps-written-in-rec
  2909        go to 2050-read
  2910     end-if
  2911     string wsw-check-dt (1:4)
  2912            wsw-check-dt (6:2)
  2913            wsw-check-dt (9:2)
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  52
* EL201.cbl
  2914        delimited by size into dc-greg-date-cymd-r
  2915     end-string
  2916     move 'L'                    to dc-option-code
  2917     perform 9700-date-convert   thru 9700-exit
  2918     if no-conversion-error
  2919        move dc-bin-date-1       to ws-bin-check-dt
  2920     else
  2921        display ' error cvtdte chek dt ' wsw-check-dt ' '
  2922           dc-error-code
  2923     end-if
  2924     perform varying s1 from +1 by +1 until
  2925        (s1 > +28)
  2926        or (wsw-voucher-ref (s1:6) = 'REF DI' or 'REFUND' or
  2927          'CANCEL')
  2928     end-perform
  2929     if s1 < +29
  2930        move 'Bypass- Manual Entry'    to ws-d1-message
  2931        move ' '                 to ws-table-sw
  2932        go to 2050-continue
  2933     end-if
  2934*    if wsw-user-defined (1:3) not numeric
  2935*       move 'Bypass- Manual Entry'
  2936*                                to ws-d1-message
  2937*       move ' '                 to ws-table-sw
  2938*       go to 2050-continue
  2939*    end-if
  2940     perform varying s1 from +1 by +1 until
  2941        (s1 > +30)
  2942        or (wsw-user-defined (s1:1) = ' ')
  2943     end-perform
  2944     if (s1 < +12)
  2945        and (s1 > +8)
  2946        continue
  2947     else
  2948        move 'Bypass- Manual Entry'
  2949                                 to ws-d1-message
  2950        move ' '                 to ws-table-sw
  2951        go to 2050-continue
  2952     end-if
  2953     move spaces                 to wsw-check-key
  2954     perform varying s1 from +30 by -1 until
  2955        (s1 < +1)
  2956        or (wsw-user-defined (s1:1) numeric)
  2957     end-perform
  2958     if s1 > +7
  2959        move wsw-user-defined (s1 - 6:7)
  2960                                 to wsw-check-key
  2961     else
  2962        move 'Invalid Input CK-KEY'    to ws-d1-message
  2963        go to 2050-continue
  2964     end-if
  2965*    go to 2050-read
  2966     move ' '                    to ws-erchek-sw
  2967                                    ws-table-sw
  2968     perform 2200-get-tbl-row    thru 2200-exit
  2969     if sqlcode = 0
  2970        set table-found          to true
  2971        perform 1020-read-erchek thru 1020-exit
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  53
* EL201.cbl
  2972        if resp-normal
  2973           set erchek-found to true
  2974           perform 2310-upd-erchek
  2975                                 thru 2310-exit
  2976           perform 2320-upd-table thru 2320-exit
  2977        else
  2978           display ' erchek not fnd ' ch-carrier ' ' ch-state ' '
  2979              ch-account ' ' db-effdate (1:10) ' ' db-certificate
  2980              ' ' ws-response
  2981           move ' chk rec not found ' to ws-d1-message
  2982        end-if
  2983     else
  2984        move ' tbl row not found ' to ws-d1-message
  2985     end-if
  2986     .
  2987 2050-continue.
  2988     perform 2400-build-print-line thru 2400-exit
  2989     .
  2990 2050-read.
  2991     perform 2040-read-input     thru 2040-exit
  2992     .
  2993 2050-exit.
  2994     exit.
  2995 2200-get-tbl-row.
  2996***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2997***                                                            ***
  2998***  I'm only expecting one row so no cursor is declared       ***
  2999***                                                            ***
  3000***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3001     move ws-comp-id             to ws-compid
  3002     move wsw-check-key-num      to ws-check-key
  3003     move 1                      to ws-type
  3004     exec sql
  3005        SELECT
  3006           CheckKey,
  3007           Company,
  3008           CertCarrier,
  3009           CertGroup,
  3010           CertState,
  3011           CertAccount,
  3012           CertEffDate,
  3013           CertNumber,
  3014           CertNumberSuf,
  3015           CheckSeqNbr,
  3016           CheckType,
  3017           CheckAmount,
  3018           Preparer,
  3019           CheckSubType
  3020        INTO
  3021           :db-checkkey,
  3022           :db-compid,
  3023           :db-carrier,
  3024           :db-grouping,
  3025           :db-state,
  3026           :db-account,
  3027           :db-effdate,
  3028           :db-certificate,
  3029           :db-cert-sfx,
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  54
* EL201.cbl
  3030           :db-seq-no,
  3031           :db-type,
  3032           :db-amount,
  3033           :db-preparer,
  3034           :db-check-sub-type
  3035        FROM
  3036           ChkApp_Check
  3037        WHERE
  3038           (CheckKey    = :ws-check-key)
  3039           and (Company = :ws-compid)
  3040     end-exec
  3041     if sqlcode not = 0
  3042        move sqlcode to ws-sql-code
  3043        move ws-sql-code to ws-dis-sql-code
  3044        display ' dis sql code ' ws-dis-sql-code
  3045        display "Error: cannot read row "
  3046        display ' sql return code ' sqlcode
  3047        display ' sql err mess    ' sqlerrmc
  3048     end-if
  3049     .
  3050 2200-exit.
  3051     exit.
  3052 2310-upd-erchek.
  3053     move ws-bin-check-dt        to ch-check-written-dt
  3054     if wsw-check-no (1:1) = '"'
  3055        move wsw-check-no (5:7)  to ch-check-no
  3056     else
  3057        move wsw-check-no (4:7)  to ch-check-no
  3058     end-if
  3059*    move zeros                  to ws-response
  3060
  3061* exec cics rewrite
  3062*       dataset     ('ERCHEK')
  3063*       from        (check-records)
  3064*       resp        (ws-response)
  3065*    end-exec
  3066     MOVE LENGTH OF
  3067      check-records
  3068       TO DFHEIV11
  3069     MOVE 'ERCHEK' TO DFHEIV1
  3070*    MOVE '&& L                  %  N#00002859' TO DFHEIV0
  3071     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3072     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3073     MOVE X'204E233030303032383539' TO DFHEIV0(25:11)
  3074     CALL 'kxdfhei1' USING DFHEIV0,
  3075           DFHEIV1,
  3076           check-records,
  3077           DFHEIV11,
  3078           DFHEIV99
  3079     MOVE EIBRESP  TO ws-response
  3080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3081     if resp-normal
  3082        add 1 to ws-writ-cnt
  3083        compute ws-tot-writ-amt =
  3084           ws-tot-writ-amt + ch-amount-paid
  3085        move 'Successful Post '  to ws-d1-message
  3086     else
  3087        move '*** ERROR - NOT POSTED ***' TO ws-d1-message
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  55
* EL201.cbl
  3088     end-if
  3089     .
  3090 2310-exit.
  3091     exit.
  3092 2320-upd-table.
  3093     string wsw-check-dt (6:2) '/'
  3094            wsw-check-dt (9:2) '/'
  3095            wsw-check-dt (1:4)
  3096        delimited by size into db-checkdate
  3097     move ch-check-no            to db-checkno
  3098*    move zeros to sqlcode
  3099     EXEC SQL
  3100        UPDATE
  3101           ChkApp_Check
  3102        SET
  3103           CheckNumber = :db-checkno,
  3104           CheckDate = :db-checkdate
  3105        WHERE
  3106           CheckKey = :db-checkkey
  3107     END-EXEC
  3108     if sqlcode not = 0
  3109        move 'Table not updated ' to ws-d1-message
  3110        display "Error: cannot update table   "
  3111        display ' sql retrun code ' sqlcode
  3112        display ' sql err mess    ' sqlerrmc
  3113     end-if
  3114     .
  3115 2320-exit.
  3116     exit.
  3117 2400-build-print-line.
  3118     if table-found
  3119        move db-carrier          to ws-d1-carr
  3120        move db-grouping         to ws-d1-grp
  3121        move db-state            to ws-d1-state
  3122        move db-account          to ws-d1-account
  3123        string
  3124           db-effdate (6:2)   '/'
  3125           db-effdate (9:2)   '/'
  3126           db-effdate (1:4)
  3127           delimited by size into ws-d1-eff-dt
  3128        end-string
  3129        move db-certificate      to ws-d1-cert-no
  3130        move db-cert-sfx         to ws-d1-cert-no (11:1)
  3131        if db-check-sub-type = '2'
  3132           move 'COR'            to ws-d1-chk-type
  3133        else
  3134           move 'REF'            to ws-d1-chk-type
  3135        end-if
  3136        move +10                 to s2
  3137        move zeros               to ws-work-amt-alpha
  3138        perform varying s1 from +10 by -1 until s1 < +1
  3139           if db-amount (s1:1) numeric
  3140              move db-amount (s1:1)
  3141                                 to ws-work-amt-alpha (s2:1)
  3142              subtract +1 from s2
  3143           end-if
  3144        end-perform
  3145        move ws-work-amt-num     to ws-d1-chk-amt
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  56
* EL201.cbl
  3146        move db-preparer         to ws-d1-preparer
  3147        move db-checkno          to ws-d1-chk-no
  3148        move db-checkdate        to ws-d1-writ-cash-dt
  3149     else
  3150        move wsw-check-no        to ws-d1-chk-no
  3151     end-if
  3152     perform 4000-write-report   thru 4000-exit
  3153     move spaces                 to ws-detail1
  3154     .
  3155 2400-exit.
  3156     exit.
  3157 2500-close-files.
  3158     close cps-written-in cps-written-rpt
  3159     .
  3160 2500-exit.
  3161     exit.
  3162 4000-write-report.
  3163     if ws-line-cntr > ws-max-lines
  3164        move zeros               to ws-line-cntr
  3165        perform 4010-write-headings thru 4010-exit
  3166     end-if
  3167     move ws-detail1             to cps-written-rpt-rec
  3168     perform 4020-write-a-line   thru 4020-exit
  3169     .
  3170 4000-exit.
  3171     exit.
  3172 4010-write-headings.
  3173     add 1 to ws-page-cntr
  3174     move ws-page-cntr           to ws-h3-page
  3175     move ws-heading1            to cps-written-rpt-rec
  3176     perform 4020-write-a-line   thru 4020-exit
  3177     move ws-heading2            to cps-written-rpt-rec
  3178     perform 4020-write-a-line   thru 4020-exit
  3179     move ws-heading3            to cps-written-rpt-rec
  3180     perform 4020-write-a-line   thru 4020-exit
  3181     move spaces                 to cps-written-rpt-rec
  3182     perform 4020-write-a-line   thru 4020-exit
  3183     move spaces                 to cps-written-rpt-rec
  3184     perform 4020-write-a-line   thru 4020-exit
  3185     move ws-heading4            to cps-written-rpt-rec
  3186     perform 4020-write-a-line   thru 4020-exit
  3187     move spaces                 to cps-written-rpt-rec
  3188     perform 4020-write-a-line   thru 4020-exit
  3189     .
  3190 4010-exit.
  3191     exit.
  3192 4020-write-a-line.
  3193     write cps-written-rpt-rec
  3194     add 1 to ws-line-cntr
  3195     .
  3196 4020-exit.
  3197     exit.
  3198 5000-submit-job.
  3199
  3200* EXEC CICS WRITEQ TD
  3201*       QUEUE ('BTCH')
  3202*       FROM (TRAN-DATA-LINE1)
  3203*       LENGTH (80)
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  57
* EL201.cbl
  3204*    END-EXEC
  3205     MOVE 80
  3206       TO DFHEIV11
  3207     MOVE 'BTCH' TO DFHEIV5
  3208*    MOVE '(" L   L              &   #00002982' TO DFHEIV0
  3209     MOVE X'2822204C2020204C20202020' TO DFHEIV0(1:12)
  3210     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3211     MOVE X'2020233030303032393832' TO DFHEIV0(25:11)
  3212     CALL 'kxdfhei1' USING DFHEIV0,
  3213           DFHEIV5,
  3214           TRAN-DATA-LINE1,
  3215           DFHEIV11,
  3216           DFHEIV99,
  3217           DFHEIV99
  3218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3219
  3220* EXEC CICS WRITEQ TD
  3221*       QUEUE ('BTCH')
  3222*       FROM (TRAN-DATA-LINE2)
  3223*       LENGTH (80)
  3224*    END-EXEC
  3225     MOVE 80
  3226       TO DFHEIV11
  3227     MOVE 'BTCH' TO DFHEIV5
  3228*    MOVE '(" L   L              &   #00002987' TO DFHEIV0
  3229     MOVE X'2822204C2020204C20202020' TO DFHEIV0(1:12)
  3230     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3231     MOVE X'2020233030303032393837' TO DFHEIV0(25:11)
  3232     CALL 'kxdfhei1' USING DFHEIV0,
  3233           DFHEIV5,
  3234           TRAN-DATA-LINE2,
  3235           DFHEIV11,
  3236           DFHEIV99,
  3237           DFHEIV99
  3238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3239     .
  3240 5000-exit.
  3241     exit.
  3242 9700-DATE-CONVERT.
  3243
  3244* EXEC CICS LINK
  3245*         PROGRAM  ('ELDATCV')
  3246*         COMMAREA (DATE-CONVERSION-DATA)
  3247*         LENGTH   (DC-COMM-LENGTH)
  3248*    END-EXEC.
  3249     MOVE 'ELDATCV' TO DFHEIV1
  3250*    MOVE '."C                   (   #00002996' TO DFHEIV0
  3251     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3252     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3253     MOVE X'2020233030303032393936' TO DFHEIV0(25:11)
  3254     CALL 'kxdfhei1' USING DFHEIV0,
  3255           DFHEIV1,
  3256           DATE-CONVERSION-DATA,
  3257           DC-COMM-LENGTH,
  3258           DFHEIV99,
  3259           DFHEIV99,
  3260           DFHEIV99,
  3261           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-Apr-17 13:52 Page  58
* EL201.cbl
  3262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3263
  3264 9700-EXIT.
  3265      EXIT.
  3266
  3267 9999-DFHBACK SECTION.
  3268     MOVE '9%                    "   ' TO DFHEIV0
  3269     MOVE 'EL201' TO DFHEIV1
  3270     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3271     GOBACK.
  3272 9999-DFHEXIT.
  3273     IF DFHEIGDJ EQUAL 0001
  3274         NEXT SENTENCE.
  3275     MOVE '9%                    "   ' TO DFHEIV0
  3276     MOVE 'EL201' TO DFHEIV1
  3277     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3278     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      140212     Code:       10696
